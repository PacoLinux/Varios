VERSION E05

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:1    
        1        1        /*M* IRN$RCVRIO - DO ALL OUTSTANDING DISK I/O AT THE TIME OF A SCREECH */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        IRN$RCVRIO: PROC;
        8        8        /**/
        9        9        %INCLUDE B_SEGIDS_C;
       10      548        %INCLUDE N_FC_C;
       11      585        %INCLUDE NI$TABLES;
       12      801        %INCLUDE N$REQ;
       13      875        %INCLUDE NI_DATA_C;
       14      988        %INCLUDE S$WSPTD;
       15      997        %INCLUDE B$MAP;
       16     1096        %INCLUDE FT$DDT;
       17     1157        %INCLUDE B_STRINGS_C;
       18     1286        %INCLUDE IT_SUBS_C;
       19     1553        /**/
       20     1554    1   DCL IRN$MINIQ ENTRY(7) ALTRET;
       21     1555    1   DCL IRR$FLUSHIQ ENTRY;
       22     1556    1   DCL IRR$MAP  ENTRY;
       23     1557    1   DCL IRR$TYPE6M ENTRY(2);
       24     1558    1   DCL IRR$TYPE6 ENTRY(2);
       25     1559        /**/
       26     1560        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
       27     1568        %NI$PARTITION (NAME=IT$PARTITION, STCLASS=BASED);
       28     1576    1   DCL PART$ PTR;
       29     1577    1   DCL MAXDCT SBIN;
       30     1578    1   DCL MAXDQH SBIN;
       31     1579    1   DCL MAXIOM SBIN;
       32     1580    1   DCL NI$DVT$ PTR SYMREF;
       33     1581    1   DCL DVT$$ PTR;
       34     1582    1   DCL DVT$(0:0) PTR BASED(DVT$$);
       35     1583    1   DCL CURDVT$ PTR;
       36     1584        %NI$DVT (NAME=DVT,STCLASS="BASED(CURDVT$)");
       37     1591        /**/
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:2    
       38     1592    1   DCL N$DCT$$ PTR SYMREF;
       39     1593    1   DCL DCT$$ PTR;
       40     1594    1   DCL DCT$(0:0) PTR BASED(DCT$$);
       41     1595    1   DCL CURDCT$ PTR;
       42     1596        %NI$DCT (NAME=DCT,STCLASS="BASED(CURDCT$)");
       43     1644        /**/
       44     1645    1   DCL CURDQH$ PTR;
       45     1646        %NI$DQH (NAME=DQH,STCLASS="BASED(CURDQH$)");
       46     1669    1   DCL CURCHT$ PTR;
       47     1670        %NI$CHT (NAME=CHT,STCLASS="(0:0) BASED(CURCHT$)");
       48     1673    1   DCL NI$CHT$ PTR SYMREF;
       49     1674    1   DCL CURIOM$$ PTR;
       50     1675    1   DCL NI$IOM$ PTR SYMREF;
       51     1676    1   DCL IOM$(0:0) PTR BASED(CURIOM$$);
       52     1677    1   DCL CURIOM$ PTR;
       53     1678        %NI$IOM (NAME=IOM, STCLASS="BASED(CURIOM$)");
       54     1683        /**/
       55     1684    1   DCL CURSQH$ PTR;
       56     1685        %NI$SQH (NAME=SQH,STCLASS="BASED(CURSQH$)");
       57     1698    1   DCL CURMPC$ PTR;
       58     1699        /**/
       59     1700    1   DCL REQ$ PTR;
       60     1701        %N$REQ (NAME=REQ,STCLASS="BASED(REQ$)");
       61     1759        %NI$REQ (NAME=NI$REQ,STCLASS=BASED);
       62     1784        /**/
       63     1785    1   DCL CURDDT$ PTR;
       64     1786        /**/
       65     1787    1   DCL IOM# SBIN;
       66     1788    1   DCL CHAN# SBIN;
       67     1789    1   DCL DEV# SBIN;
       68     1790    1   DCL GRAN# SBIN;
       69     1791    1   DCL NSPG# SBIN;
       70     1792    1   DCL MIRDCTX UBIN(36) STATIC  INIT(0);
       71     1793    1   DCL MIRDCT$ PTR STATIC ;
       72     1794    1   DCL MIRDQH$ PTR STATIC;
       73     1795    1   DCL MIRSQH$ PTR STATIC;
       74     1796    1   DCL MIR_FLAG BIT(1) ALIGNED AUTO ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:3    
       75     1797    1   DCL MTUNLOAD BIT(1);
       76     1798    1   DCL I SBIN;
       77     1799    1   DCL BUFSIZE SBIN;
       78     1800    1   DCL ARS SBIN;
       79     1801    1   DCL BUFFER CHAR(ARS) BASED;
       80     1802    1   DCL P$ PTR;
       81     1803    1   DCL SV_MONPT4 BIT(36);
       82     1804        /**/
       83     1805    1   DCL PTR$ PTR BASED;
       84     1806    1   DCL 1 P BASED ALIGNED,
       85     1807    1           2 W UBIN(18) UNAL,
       86     1808    1           2 C UBIN(2) UNAL,
       87     1809    1           2 B UBIN(4) UNAL,
       88     1810    1           2 SEGID BIT(12) UNAL;
       89     1811    1   DCL SBIN36 SBIN WORD BASED;
       90     1812        /**/
       91     1813    1   DCL POBUF CHAR(4096) SYMREF;
       92     1814    1   DCL POBUFA(0:4095) REDEF POBUF CHAR(1);
       93     1815    1   DCL 1 DESCRV4 DALIGNED SYMREF,
       94     1816    1           2 BOUND UBIN(20) UNAL,
       95     1817    1           2 F BIT(3),
       96     1818    1           2 WSQ UBIN(9) UNAL,
       97     1819    1           2 T UBIN(4) UNAL,
       98     1820    1           2 BASE UBIN WORD;
       99     1821    1   DCL I$RV1$ PTR SYMREF;
      100     1822    1   DCL I$RV4$ PTR SYMREF;
      101     1823    1   DCL I$REAL$ PTR SYMREF;
      102     1824    1   DCL I$MONIS$ PTR SYMREF;
      103     1825    1   DCL I$JIT$ PTR SYMREF;
      104     1826        /**/
      105     1827    1   DCL NK_MXLOCAL SBIN SYMREF;
      106     1828    1   DCL NI_IOMS SBIN SYMREF;
      107     1829    1   DCL XA_MODE BIT(1) ALIGNED SYMREF;
      108     1830    1   DCL RPM_FLG BIT(1) ALIGNED SYMREF;
      109     1831    1   DCL 1 RVF_DEBUG UBIN ALIGNED SYMREF ;
      110     1832    1   DCL 1 MSG_IOERR ALIGNED STATIC SYMDEF,
      111     1833    1         2 NAME    CHAR(4)  CALIGNED INIT(' '),
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:4    
      112     1834    1         2 TYPE    CHAR(12) CALIGNED INIT(' UNMIRRORED '),
      113     1835    1         2 *       CHAR(28) CALIGNED INIT('DISK I/O ERROR IN RECOVERY  ') ;
      114     1836    1   DCL 1 MSG_PART  ALIGNED STATIC SYMDEF,
      115     1837    1         2 NAME    CHAR(4) CALIGNED INIT(' '),
      116     1838    1         2 *       CHAR(0) CALIGNED INIT(' PARTITIONED BY RECOVERY') ;
      117     1839        %EQU  DEBUG = '1'B ;
      118     1840        %IF   DEBUG ;
      119     1841    1   DCL 1 MSG_DCTX  ALIGNED STATIC,
      120     1842    1         2 *       CHAR(09) CALIGNED INIT('DISK DCT '),
      121     1843    1         2 DCTX    CHAR(03) CALIGNED INIT('XXX'),
      122     1844    1         2 *       CHAR(10) CALIGNED INIT('  MIRFLAG '),
      123     1845    1         2 MIRFLAG CHAR(01) CALIGNED INIT('X'),
      124     1846    1         2 *       CHAR(10) CALIGNED INIT('  MIRDCT '),
      125     1847    1         2 MIRDCTX CHAR(03) CALIGNED INIT('XXX') ;
      126     1848    1   DCL 1 MSG_CVT   ALIGNED STATIC,
      127     1849    1         2 *       CHAR(09) CALIGNED INIT('DOCVTPTR '),
      128     1850    1         2 CVTPTR  CHAR(01) CALIGNED INIT('X'),
      129     1851    1         2 *       CHAR(02) CALIGNED INIT('  ') ;
      130     1852    1   DCL 1 MSG_DCT1  ALIGNED STATIC,
      131     1853    1         2 *       CHAR(11) CALIGNED INIT('DCT.DQH$  .'),
      132     1854    1         2 DQH$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      133     1855    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      134     1856    1   DCL 1 MSG_DQH   ALIGNED STATIC,
      135     1857    1         2 *       CHAR(11) CALIGNED INIT('DQH.IO$   .'),
      136     1858    1         2 IO$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      137     1859    1         2 *       CHAR(01) CALIGNED INIT(' ');
      138     1860    1   DCL 1 MSG_DCT2  ALIGNED STATIC,
      139     1861    1         2 *       CHAR(11) CALIGNED INIT('DCT.SQ$   .'),
      140     1862    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      141     1863    1         2 *       CHAR(12) CALIGNED INIT('  DCT..BQ$ .'),
      142     1864    1         2 BQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      143     1865    1         2 *       CHAR(12) CALIGNED INIT('  DCT..LQ$ .'),
      144     1866    1         2 LQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      145     1867    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      146     1868    1   DCL 1 MSG_MDCT1 ALIGNED STATIC,
      147     1869    1         2 *       CHAR(11) CALIGNED INIT('MDCT.DQH$ .'),
      148     1870    1         2 DQH$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:5    
      149     1871    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      150     1872    1   DCL 1 MSG_MDQH  ALIGNED STATIC,
      151     1873    1         2 *       CHAR(11) CALIGNED INIT('MDQH.IO$  .'),
      152     1874    1         2 IO$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      153     1875    1         2 *       CHAR(01) CALIGNED INIT(' ');
      154     1876    1   DCL 1 MSG_MDCT2 ALIGNED STATIC,
      155     1877    1         2 *       CHAR(11) CALIGNED INIT('MDCT.SQ$  .'),
      156     1878    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      157     1879    1         2 *       CHAR(12) CALIGNED INIT(' MDCT..BQ$ .'),
      158     1880    1         2 BQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      159     1881    1         2 *       CHAR(12) CALIGNED INIT(' MDCT..LQ$ .'),
      160     1882    1         2 LQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      161     1883    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      162     1884    1   DCL 1 MSG_PROC  ALIGNED STATIC,
      163     1885    1         2 *       CHAR(11) CALIGNED INIT('PROC SQ$  .'),
      164     1886    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      165     1887    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      166     1888    1   DCL 1 MSG_DISK  ALIGNED STATIC,
      167     1889    1         2 *       CHAR(11) CALIGNED INIT('DISK REQ$ .'),
      168     1890    1         2 REQ$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      169     1891    1         2 *       CHAR(12) CALIGNED INIT('       DLA .'),
      170     1892    1         2 DLA     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      171     1893    1         2 *       CHAR(1) CALIGNED INIT(' ') ;
      172     1894    1   DCL 1 MSG_MINI  ALIGNED STATIC,
      173     1895    1         2 *       CHAR(12) CALIGNED INIT('MINI ICCCDD '),
      174     1896    1         2 I       CHAR(01) CALIGNED INIT('X'),
      175     1897    1         2 *       CHAR(01) CALIGNED INIT('-'),
      176     1898    1         2 CCC     CHAR(03) CALIGNED INIT('XXX'),
      177     1899    1         2 *       CHAR(01) CALIGNED INIT('-'),
      178     1900    1         2 DD      CHAR(02) CALIGNED INIT('XX'),
      179     1901    1         2 *       CHAR(08) CALIGNED INIT( '  GRAN# '),
      180     1902    1         2 GRAN#   CHAR(06) CALIGNED INIT('XXXXXX'),
      181     1903    1         2 *       CHAR(02) CALIGNED INIT('  ') ;
      182     1904    1   DCL 1 MSG_BUF   ALIGNED STATIC,
      183     1905    1         2 *       CHAR(11) CALIGNED INIT('     BUF$ .'),
      184     1906    1         2 BUF$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      185     1907    1         2 *       CHAR(12) CALIGNED INIT('   DESCRV4 .'),
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:6    
      186     1908    1         2 DESC1   CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      187     1909    1         2 DESC2   CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      188     1910    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      189     1911        %ENDIF ;
      190     1912        /**/
      191     1913        %SUB FOREVER="WHILE('1'B)";
      192     1914        %SUB NEVER="WHILE('0'B)";
      193     1915        /**/
      194     1916        %SUB DISK_WRITE=1;
      195     1917        %SUB DISK_READ=2;
      196     1918        %SUB TAPE_UNLOAD=3;
      197     1919        %SUB TAPE_WRPER=4;
      198     1920        %SUB TAPE_WRFM=5;
      199     1921        %SUB TAPE_WRBIN=6;
      200     1922        %SUB TAPE_WRASC=7;
      201     1923        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:7    
      202     1924    1      MTUNLOAD = '0'B;
      203     1925    1      GOTO IRN_CONTINUE;
      204     1926
      205     1927    1   IRN$RCVR_MTUNLOAD: ENTRY;
      206     1928    1      MTUNLOAD = '1'B;
      207     1929
      208     1930    1   IRN_CONTINUE: ;
      209     1931
      210     1932    1           CALL CVTPTR(ADDR(NK_MXLOCAL),P$);
      211     1933    1           MAXDCT=P$->SBIN36;
      212     1934    1           CALL CVTPTR(ADDR(NI$DVT$),DVT$$);
      213     1935    1           CALL CVTPTR(ADDR(N$DCT$$),DCT$$);
      214     1936    1           CALL CVTPTR(DCT$$->PTR$,DCT$$);
      215     1937    1           SV_MONPT4=I$JIT$->B$MAP(4);
      216     1938    1           I$JIT$->B$MAP.CTRL(4)='64'O;
      217     1939    2           DO I=1 TO MAXDCT;
      218     1940    3              IF DCT$(I)~=ADDR(NIL) THEN DO;
      219     1941    3                 CALL CVTPTR(DCT$(I),CURDCT$);
      220     1942    3                 IF DCT.STATUS.DOWN THEN GOTO LOOP;
      221     1943    3                 CALL CVTPTR(DCT.DVT$,CURDVT$);
      222     1944    3                 CALL CVTPTR(DCT.SQH$,CURSQH$);
      223     1945    3                 IF  SQH.CQ$ = ADDR(NIL)  THEN
      224     1946    3                     CALL CVTPTR ( DCT.DQH$, CURDQH$ ) ;
      225     1947    3                 ELSE
      226     1948    3                     CALL CVTPTR ( SQH.CQ$,  CURDQH$ ) ;
      227     1949    3                 CALL CVTPTR(DQH.IO$, REQ$ ) ;
      228     1950    3                 IF  DCT.TYPE = %DV_DP
      229     1951    3                 AND DCT.DP.MIRROR.FLAG
      230     1952    4                 THEN DO ;
      231     1953    4                     MIR_FLAG = '1'B ;
      232     1954    4                     MIRDCTX = DCT.DP.MIRROR.DCTX ;
      233     1955    4                     CALL CVTPTR ( DCT$(MIRDCTX), MIRDCT$ ) ;
      234     1956    4                     CALL CVTPTR ( MIRDCT$->DCT.SQH$, MIRSQH$ ) ;
      235     1957    4                     IF  MIRSQH$->SQH.CQ$ = ADDR(NIL)
      236     1958    4                     THEN
      237     1959    4                         CALL CVTPTR ( MIRDCT$->DCT.DQH$, MIRDQH$ ) ;
      238     1960    4                     ELSE
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:8    
      239     1961    4                         CALL CVTPTR ( MIRSQH$->SQH.CQ$,  MIRDQH$ ) ;
      240     1962    4                     MSG_IOERR.TYPE = ' MIRRORED ' ;
      241     1963    4                     END ;
      242     1964    4                 ELSE DO ;
      243     1965    4                     MIR_FLAG  = '0'B ;
      244     1966    4                     MIRDCTX   = 0 ;
      245     1967    4                     MSG_IOERR.TYPE = ' UNMIRRORED ' ;
      246     1968    4                     END ;
      247     1969    3                 DEV#=DCT.DVN;
      248     1970    3                 IOM#=DQH.IOCHAN.IOM;
      249     1971    3                 CHAN#=DQH.IOCHAN.CHANNEL;
      250     1972    3                 NSPG#=DVT.GRANSIZE;
      251     1973    4                 DO CASE(DVT.TYPE);
      252     1974    4                  CASE(%DV_DP);
      253     1975    4                   IF NOT MTUNLOAD
      254     1976    4                    THEN CALL DISK_RUNDOWN;
      255     1977    4                  CASE(%DV_MT);
      256     1978    4                    CALL CVTPTR(DCT.DDT$,CURDDT$);
      257     1979    4                   IF MTUNLOAD
      258     1980    4                    THEN CALL TAPE_DISM;
      259     1981    4                    ELSE CALL TAPE_RUNDOWN;
      260     1982    4                  END;
      261     1983    3                 END;
      262     1984    2   LOOP:      END;
      263     1985    1           IF NOT MTUNLOAD THEN
      264     1986    1              CALL IRR$FLUSHIQ;
      265     1987    1           I$JIT$->B$MAP(4)=SV_MONPT4;
      266     1988    1           RETURN;
      267     1989        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:9    
      268     1990    1   IRN$PART: ENTRY;
      269     1991
      270     1992    1         CALL CVTPTR (ADDR(NK_MXLOCAL),P$);
      271     1993    1         MAXDCT=P$->SBIN36;
      272     1994    1         CALL CVTPTR(ADDR(N$DCT$$),DCT$$);
      273     1995    1         CALL CVTPTR(DCT$$->PTR$,DCT$$);
      274     1996    1         SV_MONPT4=I$JIT$->B$MAP(4);
      275     1997    1         I$JIT$->B$MAP.CTRL(4)='64'O;
      276     1998    1         CALL CVTPTR (ADDR(IT_PARTITION),PART$);
      277     1999    2         DO I = 1 TO MAXDCT;
      278     2000    3            IF DCT$(I)~=ADDR(NIL) THEN DO;
      279     2001    3               CALL CVTPTR(DCT$(I),CURDCT$);
      280     2002    3               IF DCT.STATUS.SYSCON_PART THEN
      281     2003    3                  PART$->IT$PARTITION.DEVICE(I) = '1'B;
      282     2004    3               ELSE
      283     2005    3                  PART$->IT$PARTITION.DEVICE(I) = '0'B;
      284     2006    3               IF DCT.STATUS.MSOS_PART THEN
      285     2007    3                  PART$->IT$PARTITION.MSOS_DEVICE(I) = '1'B;
      286     2008    3               ELSE
      287     2009    3                  PART$->IT$PARTITION.MSOS_DEVICE(I) = '0'B;
      288     2010    3               END;
      289     2011    2            END;
      290     2012
      291     2013    1         CALL CVTPTR(ADDR(NI_IOMS),P$);
      292     2014    1         CALL CVTPTR(ADDR(NI$CHT$),CURCHT$);
      293     2015    1         CALL CVTPTR(CURCHT$->PTR$,CURCHT$);
      294     2016    1         MAXIOM = P$->SBIN36;
      295     2017    1         MAXDQH = MAXIOM*%N_MAXCHANS-1;
      296     2018    2         DO I = 0 TO MAXDQH;
      297     2019    3            IF CHT.DQH$(I) ~= ADDR(NIL) THEN DO;
      298     2020    3               CALL CVTPTR (CHT.DQH$(I), CURDQH$);
      299     2021    3               IF DQH.STATUS.SYSCON_PART THEN
      300     2022    3                  PART$->IT$PARTITION.IOCHAN(I) = '1'B;
      301     2023    3               ELSE
      302     2024    3                  PART$->IT$PARTITION.IOCHAN(I) = '0'B;
      303     2025    3               IF DQH.STATUS.MSOS_PART THEN
      304     2026    3                  PART$->IT$PARTITION.MSOS_IOCHAN(I) = '1'B;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:10   
      305     2027    3               ELSE
      306     2028    3                  PART$->IT$PARTITION.MSOS_IOCHAN(I) = '0'B;
      307     2029    3               END;
      308     2030    2            END;
      309     2031
      310     2032    1         CALL CVTPTR (ADDR(NI$IOM$),CURIOM$$);
      311     2033    2         DO I = 0 TO MAXIOM-1;
      312     2034    2            CALL CVTPTR (CURIOM$$->IOM$(I), CURIOM$);
      313     2035    2            IF IOM.STATUS.SYSCON_PART THEN /* Sleaze part'd ioms in channel 0 */
      314     2036    2               PART$->IT$PARTITION.IOCHAN(I*%N_MAXCHANS) = '1'B;
      315     2037    2            ELSE
      316     2038    2               PART$->IT$PARTITION.IOCHAN(I*%N_MAXCHANS) = '0'B;
      317     2039    2            IF IOM.STATUS.MSOS_PART THEN /* Sleaze part'd ioms in channel 0 */
      318     2040    2               PART$->IT$PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS) = '1'B;
      319     2041    2            ELSE
      320     2042    2               PART$->IT$PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS) = '0'B;
      321     2043    2            END;
      322     2044
      323     2045        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:11   
      324     2046    1   DISK_RUNDOWN: PROC;
      325     2047
      326     2048    2   DCL 1 DOCVTPTR  BIT(1) ALIGNED AUTO ;
      327     2049
      328     2050                %IF  DEBUG ;
      329     2051    2           IF  RVF_DEBUG ~= 0
      330     2052    3           THEN DO ;
      331     2053    3               CALL BINCHAR    ( MSG_DCTX.DCTX,    DCT.DCTX ) ;
      332     2054    3               CALL BINCHAR    ( MSG_DCTX.MIRFLAG, BITBIN(MIR_FLAG) ) ;
      333     2055    3               CALL BINCHAR    ( MSG_DCTX.MIRDCTX, MIRDCTX ) ;
      334     2056    3               CALL IRR$TYPE6M ( MSG_DCTX, SIZEW(MSG_DCTX) ) ;
      335     2057    3               END ;
      336     2058                %ENDIF ;
      337     2059    2           IF  DCT.STATE = %ASSIGNED
      338     2060    2           OR  DCT.STATE = %BUSY
      339     2061    3           THEN DO ;
      340     2062                    %IF  DEBUG ;
      341     2063    3               IF  RVF_DEBUG ~= 0
      342     2064    4               THEN DO ;
      343     2065    4                   CALL BINOCTAL   ( MSG_DCT1.DQH$, DCT.DQH$ ) ;
      344     2066    4                   CALL IRR$TYPE6M ( MSG_DCT1, SIZEW(MSG_DCT1) ) ;
      345     2067    4                   END ;
      346     2068                    %ENDIF ;
      347     2069    3               CALL CVTPTR ( DCT.DQH$, CURDQH$ ) ;
      348     2070                    %IF  DEBUG ;
      349     2071    3               IF  RVF_DEBUG ~= 0
      350     2072    4               THEN DO ;
      351     2073    4                   CALL BINOCTAL   ( MSG_DQH.IO$, DQH.IO$ ) ;
      352     2074    4                   CALL IRR$TYPE6M ( MSG_DQH, SIZEW(MSG_DQH) ) ;
      353     2075    4                   END ;
      354     2076                    %ENDIF ;
      355     2077    3               CALL CVTPTR ( DQH.IO$,  REQ$    )
      356     2078    4               WHENRETURN DO ;
      357     2079    4                   CALL DISKIO ( REQ ) ;
      358     2080    4                   END ;
      359     2081    3               END ;
      360     2082    2               IF  MIR_FLAG
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:12   
      361     2083    2               AND DCT.DCTX > MIRDCTX
      362     2084    2               THEN
      363     2085    2                   DOCVTPTR = '0'B ;
      364     2086    2               ELSE
      365     2087    2                   DOCVTPTR = '1'B ;
      366     2088                %IF  DEBUG ;
      367     2089    2           IF  RVF_DEBUG ~= 0
      368     2090    3           THEN DO ;
      369     2091    3               CALL BINCHAR    ( MSG_CVT.CVTPTR, BITBIN(DOCVTPTR) ) ;
      370     2092    3               CALL IRR$TYPE6M ( MSG_CVT, SIZEW(MSG_CVT) ) ;
      371     2093    3               CALL BINOCTAL   ( MSG_DCT2.SQ$, DCT.SQ$ ) ;
      372     2094    3               CALL BINOCTAL   ( MSG_DCT2.BQ$, DCT.DP.BQ$ ) ;
      373     2095    3               CALL BINOCTAL   ( MSG_DCT2.LQ$, DCT.DP.MIRROR.LQ$ ) ;
      374     2096    3               CALL IRR$TYPE6M ( MSG_DCT2, SIZEW(MSG_DCT2) ) ;
      375     2097    3               END ;
      376     2098                %ENDIF ;
      377     2099    2           CALL PROCESS_SQ ( DCT.SQ$,    '1'B, DOCVTPTR ) ;
      378     2100    2           CALL PROCESS_SQ ( DCT.DP.BQ$, '1'B, DOCVTPTR ) ;
      379     2101    2           IF  MIR_FLAG
      380     2102    3           THEN DO ;
      381     2103    3               CALL PROCESS_SQ ( DCT.DP.MIRROR.LQ$, '1'B, DOCVTPTR ) ;
      382     2104    3               IF  MIRDCT$->DCT.STATE = %ASSIGNED
      383     2105    3               OR  MIRDCT$->DCT.STATE = %BUSY
      384     2106    4               THEN DO ;
      385     2107                        %IF  DEBUG ;
      386     2108    4                   IF  RVF_DEBUG ~= 0
      387     2109    5                   THEN DO ;
      388     2110    5                       CALL BINOCTAL   ( MSG_MDCT1.DQH$, MIRDCT$->DCT.DQH$ ) ;
      389     2111    5                       CALL IRR$TYPE6M ( MSG_MDCT1, SIZEW(MSG_MDCT1) ) ;
      390     2112    5                       END ;
      391     2113                        %ENDIF ;
      392     2114    4                   CALL CVTPTR ( MIRDCT$->DCT.DQH$, MIRDQH$ ) ;
      393     2115                        %IF  DEBUG ;
      394     2116    4                   IF  RVF_DEBUG ~= 0
      395     2117    5                   THEN DO ;
      396     2118    5                       CALL BINOCTAL   ( MSG_MDQH.IO$, MIRDCT$->DQH.IO$ ) ;
      397     2119    5                       CALL IRR$TYPE6M ( MSG_MDQH, SIZEW(MSG_MDQH) ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:13   
      398     2120    5                       END ;
      399     2121                        %ENDIF ;
      400     2122    4                   CALL CVTPTR ( MIRDQH$->DQH.IO$,  REQ$    )
      401     2123    5                   WHENRETURN DO ;
      402     2124    5                       IF  REQ.DOMIR
      403     2125    5                       THEN
      404     2126    5                           CALL DISKIO ( REQ ) ;
      405     2127    5                       END ;
      406     2128    4                   END ;
      407     2129                    %IF  DEBUG ;
      408     2130    3               IF  RVF_DEBUG ~= 0
      409     2131    4               THEN DO ;
      410     2132    4                   CALL BINOCTAL   ( MSG_MDCT2.SQ$, MIRDCT$->DCT.SQ$ ) ;
      411     2133    4                   CALL BINOCTAL   ( MSG_MDCT2.BQ$, MIRDCT$->DCT.DP.BQ$ ) ;
      412     2134    4                   CALL BINOCTAL   ( MSG_MDCT2.LQ$, MIRDCT$->DCT.DP.MIRROR.LQ$ ) ;
      413     2135    4                   CALL IRR$TYPE6M ( MSG_MDCT2, SIZEW(MSG_MDCT2) ) ;
      414     2136    4                   END ;
      415     2137                    %ENDIF ;
      416     2138    3               CALL PROCESS_SQ ( MIRDCT$->DCT.SQ$,           '0'B, DOCVTPTR ) ;
      417     2139    3               CALL PROCESS_SQ ( MIRDCT$->DCT.DP.BQ$,        '0'B, DOCVTPTR ) ;
      418     2140    3               CALL PROCESS_SQ ( MIRDCT$->DCT.DP.MIRROR.LQ$, '0'B, DOCVTPTR ) ;
      419     2141    3               END ;
      420     2142    2           RETURN;
      421     2143        /**/
      422     2144        /**/
      423     2145        /**/
      424     2146    2   PROCESS_SQ:  PROC ( SQ$, DOALWAYS, DOCVTPTR ) ;
      425     2147    3   DCL 1 DOALWAYS  BIT(1) ALIGNED PARAM ;
      426     2148    3   DCL 1 DOCVTPTR  BIT(1) ALIGNED PARAM ;
      427     2149    3   DCL 1 SAVE$     PTR ALIGNED AUTO ;
      428     2150    3   DCL 1 SQ$       PTR ALIGNED PARAM ;
      429     2151        /**/
      430     2152                %IF  DEBUG ;
      431     2153    3           IF  RVF_DEBUG ~= 0
      432     2154    4           THEN DO ;
      433     2155    4               CALL BINOCTAL   ( MSG_PROC.SQ$, SQ$ ) ;
      434     2156    4               CALL IRR$TYPE6M ( MSG_PROC, SIZEW(MSG_PROC) ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:14   
      435     2157    4               END ;
      436     2158                %ENDIF ;
      437     2159    3           SAVE$ = ADDR(NIL) ;
      438     2160    4           DO  FOREVER ;
      439     2161    4               CALL DEQUEUE ( SQ$, REQ$, DOCVTPTR ) ALTRET ( END_SQ ) ;
      440     2162                    %IF  DEBUG ;
      441     2163    4               IF  RVF_DEBUG ~= 0
      442     2164    5               THEN DO ;
      443     2165    5                   CALL BINOCTAL   ( MSG_PROC.SQ$, SQ$ ) ;
      444     2166    5                   CALL IRR$TYPE6M ( MSG_PROC, SIZEW(MSG_PROC) ) ;
      445     2167    5                   END ;
      446     2168                    %ENDIF ;
      447     2169    4               IF  DOALWAYS
      448     2170    4               OR  REQ.DOMIR
      449     2171    4               THEN
      450     2172    4                   CALL DISKIO ( REQ ) ;
      451     2173    4               CALL ENQUEUE ( SAVE$, REQ$ ) ;
      452     2174    4               END ;
      453     2175    3   END_SQ: SQ$ = SAVE$ ;
      454     2176    3           RETURN ;
      455     2177    3   END PROCESS_SQ;
      456     2178        /**/
      457     2179        /**/
      458     2180        /**/
      459     2181    2   DISKIO: PROC(REQ);
      460     2182        %N$REQ  (NAME=REQ,STCLASS="");
      461     2240    3   DCL BUF$ PTR;
      462     2241        /**/
      463     2242                %IF  DEBUG ;
      464     2243    3           IF  RVF_DEBUG ~= 0
      465     2244    4           THEN DO ;
      466     2245    4               CALL BINOCTAL   ( MSG_DISK.REQ$, ADDR(REQ) ) ;
      467     2246    4               CALL BINOCTAL   ( MSG_DISK.DLA,  REQ.DLA ) ;
      468     2247    4               CALL IRR$TYPE6M ( MSG_DISK, SIZEW(MSG_DISK) ) ;
      469     2248    4               END ;
      470     2249                %ENDIF ;
      471     2250    3           CALL GET_BUF(REQ,BUF$);
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:15   
      472     2251                %IF  DEBUG ;
      473     2252    3           IF  RVF_DEBUG ~= 0
      474     2253    4           THEN DO ;
      475     2254    4               CALL BINOCTAL   ( MSG_BUF.BUF$,  BUF$ ) ;
      476     2255    4               CALL BINOCTAL   ( MSG_BUF.DESC1, DESCRV4 ) ;
      477     2256    4               CALL BINOCTAL   ( MSG_BUF.DESC2, PINCRW(ADDR(DESCRV4),1)->PTR$ ) ;
      478     2257    4               CALL IRR$TYPE6M ( MSG_BUF, SIZEW(MSG_BUF) ) ;
      479     2258    4               END ;
      480     2259                %ENDIF ;
      481     2260    3           GRAN#=REQ.DLA.DRELADDR;
      482     2261    3           BUFSIZE=REQ.BUFSIZE;
      483     2262    4           DO CASE(REQ.FC);
      484     2263    4            CASE(%N_WRBIN,%N_WRCMP);
      485     2264    5              DO WHILE(BUFSIZE>0);
      486     2265    5                 IF BUFSIZE>4096 THEN ARS=4096;
      487     2266    5                 ELSE ARS=BUFSIZE;
      488     2267    5                 POBUF=BUF$->BUFFER;
      489     2268    5                 IF  ( NOT MIR_FLAG )
      490     2269    5                 OR  ( MIR_FLAG AND DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER )
      491     2270    6                 THEN DO ;
      492     2271                          %IF  DEBUG ;
      493     2272    6                     IF  RVF_DEBUG ~= 0
      494     2273    7                     THEN DO ;
      495     2274    7                         CALL BINCHAR    ( MSG_MINI.I     , IOM# ) ;
      496     2275    7                         CALL BINCHAR    ( MSG_MINI.CCC   , CHAN# ) ;
      497     2276    7                         CALL BINCHAR    ( MSG_MINI.DD    , DEV# ) ;
      498     2277    7                         CALL BINCHAR    ( MSG_MINI.GRAN# , GRAN# ) ;
      499     2278    7                         CALL IRR$TYPE6M ( MSG_MINI, SIZEW(MSG_MINI) ) ;
      500     2279    7                         END ;
      501     2280                          %ENDIF ;
      502     2281    6                     CALL IRN$MINIQ ( IOM#, CHAN#, DEV#, GRAN#, NSPG#, ARS, DISK_WRITE
              2281                              )
      503     2282    7                     WHENALTRETURN DO ;
      504     2283    7                         MSG_IOERR.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;
      505     2284    7                         CALL IRR$TYPE6 ( MSG_IOERR, SIZEW(MSG_IOERR) ) ;
      506     2285    7                         IF  MIR_FLAG
      507     2286    7                         AND MIRDCT$->DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:16   
      508     2287    8                         THEN DO ;
      509     2288    8                             DCT.DP.MIRROR.STATE = %NI_MIRROR_FAIL ;
      510     2289    8                             DCT.STATUS.DOWN     = '1'B ;
      511     2290    8                             MSG_PART.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;
      512     2291    8                             CALL IRR$TYPE6 ( MSG_PART, SIZEW(MSG_PART) ) ;
      513     2292    8                             END ;
      514     2293    7                         ELSE
      515     2294    7                             ;
      516     2295    7                         END ;
      517     2296    6                     END ;
      518     2297    5                 BUF$=PINCRC(BUF$,ARS);
      519     2298    5                 GRAN#=GRAN#+1;
      520     2299    5                 BUFSIZE=BUFSIZE-ARS;
      521     2300    5                 END;
      522     2301    4            CASE(%N_WRZERO);
      523     2302    4              POBUFA='0'B;
      524     2303    5              DO WHILE(BUFSIZE>0);
      525     2304    5                 IF BUFSIZE>4096 THEN ARS=4096;
      526     2305    5                 ELSE ARS=BUFSIZE;
      527     2306    5                 IF  ( NOT MIR_FLAG )
      528     2307    5                 OR  ( MIR_FLAG AND DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER )
      529     2308    6                 THEN DO ;
      530     2309                          %IF  DEBUG ;
      531     2310    6                     IF  RVF_DEBUG ~= 0
      532     2311    7                     THEN DO ;
      533     2312    7                         CALL BINCHAR    ( MSG_MINI.I     , IOM# ) ;
      534     2313    7                         CALL BINCHAR    ( MSG_MINI.CCC   , CHAN# ) ;
      535     2314    7                         CALL BINCHAR    ( MSG_MINI.DD    , DEV# ) ;
      536     2315    7                         CALL BINCHAR    ( MSG_MINI.GRAN# , GRAN# ) ;
      537     2316    7                         CALL IRR$TYPE6M ( MSG_MINI, SIZEW(MSG_MINI) ) ;
      538     2317    7                         END ;
      539     2318                          %ENDIF ;
      540     2319    6                     CALL IRN$MINIQ ( IOM#, CHAN#, DEV#, GRAN#, NSPG#, ARS, DISK_WRITE
              2319                              )
      541     2320    7                     WHENALTRETURN DO ;
      542     2321    7                         MSG_IOERR.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;
      543     2322    7                         CALL IRR$TYPE6 ( MSG_IOERR, SIZEW(MSG_IOERR) ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:17   
      544     2323    7                         IF  MIR_FLAG
      545     2324    7                         AND MIRDCT$->DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER
      546     2325    8                         THEN DO ;
      547     2326    8                             DCT.DP.MIRROR.STATE = %NI_MIRROR_FAIL ;
      548     2327    8                             DCT.STATUS.DOWN     = '1'B ;
      549     2328    8                             MSG_PART.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;
      550     2329    8                             CALL IRR$TYPE6 ( MSG_PART, SIZEW(MSG_PART) ) ;
      551     2330    8                             END ;
      552     2331    7                         ELSE
      553     2332    7                             ;
      554     2333    7                         END ;
      555     2334    6                     END ;
      556     2335    5                 GRAN#=GRAN#+1;
      557     2336    5                 BUFSIZE=BUFSIZE-ARS;
      558     2337    5                 END;
      559     2338    4            END;
      560     2339    3           RETURN;
      561     2340    3   END DISKIO;
      562     2341    2   END DISK_RUNDOWN;
      563     2342        /**/
      564     2343        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:18   
      565     2344    1   TAPE_RUNDOWN: PROC;
      566     2345    3           IF DCT.STATE=%ASSIGNED OR DCT.STATE=%BUSY THEN DO;
      567     2346    3              CALL CVTPTR(DCT.DQH$,CURDQH$);
      568     2347    3              CALL CVTPTR(DQH.IO$,REQ$) ALTRET(FIN_DQH);
      569     2348    3              CALL TAPEIO(REQ);
      570     2349    3              END;
      571     2350    2   FIN_DQH:;
      572     2351    2           CALL PROCESS_SQ(DCT.SQ$);
      573     2352    2           RETURN;
      574     2353        /**/
      575     2354        /**/
      576     2355        /**/
      577     2356    2   PROCESS_SQ: PROC(SQ$);
      578     2357    3   DCL SQ$ PTR;
      579     2358    3   DCL I SBIN;
      580     2359        /**/
      581     2360    4           DO FOREVER;
      582     2361    4              CALL DEQUEUE ( SQ$, REQ$, '1'B ) ALTRET ( END_SQ ) ;
      583     2362    4              CALL TAPEIO(REQ);
      584     2363    4              END;
      585     2364    3   END_SQ: RETURN;
      586     2365    3   END PROCESS_SQ;
      587     2366        /**/
      588     2367        /**/
      589     2368        /**/
      590     2369    2   TAPEIO: PROC(REQ);
      591     2370        %N$REQ  (NAME=REQ,STCLASS="");
      592     2428    3   DCL BUF$ PTR;
      593     2429        /**/
      594     2430    3           CALL GET_BUF(REQ,BUF$);
      595     2431    3           BUFSIZE=REQ.BUFSIZE;
      596     2432    4           DO CASE(REQ.FC);
      597     2433    4            CASE(%N_WRBIN);
      598     2434    4                 IF BUFSIZE>4096 THEN RETURN;
      599     2435    4                 POBUF=BUF$->BUFFER;
      600     2436    4                 CALL IRN$MINIQ(IOM#,CHAN#,DEV#,,,BUFSIZE,TAPE_WRBIN);
      601     2437    4            CASE(%N_WRASC);
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:19   
      602     2438    4                 IF BUFSIZE>4096 THEN RETURN;
      603     2439    4                 POBUF=BUF$->BUFFER;
      604     2440    4                 CALL IRN$MINIQ(IOM#,CHAN#,DEV#,,,BUFSIZE,TAPE_WRASC);
      605     2441    4            END;
      606     2442    3           RETURN;
      607     2443    3   END TAPEIO;
      608     2444    2   END TAPE_RUNDOWN;
      609     2445        /**/
      610     2446    1   TAPE_DISM: PROC;
      611     2447        /**/
      612     2448    2      IF CURDDT$->FT$DDT.FMNEEDED
      613     2449    3       THEN DO;                            /* Supply file marks        */
      614     2450    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRPER );
      615     2451    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );
      616     2452    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );
      617     2453    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );
      618     2454    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );
      619     2455    3         END;
      620     2456    2      CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_UNLOAD );
      621     2457    2      RETURN;
      622     2458
      623     2459    2   END TAPE_DISM;
      624     2460        /**/
      625     2461    1   DEQUEUE:        PROC ( Q$, R$, DOCVTPTR ) ALTRET ;
      626     2462
      627     2463    2   DCL 1 DOCVTPTR          BIT(1) ALIGNED PARAM ;
      628     2464    2   DCL 1 CQ$               PTR ALIGNED AUTO ;
      629     2465    2   DCL 1 Q$                PTR ALIGNED PARAM ;
      630     2466    2   DCL 1 R$                PTR ALIGNED PARAM ;
      631     2467
      632     2468    2           IF  Q$ = ADDR(NIL)
      633     2469    2           THEN
      634     2470    2               ALTRETURN ;
      635     2471
      636     2472    2           IF  DOCVTPTR
      637     2473    2           THEN
      638     2474    2               CALL CVTPTR ( Q$, CQ$ ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:20   
      639     2475    2           ELSE
      640     2476    2               CQ$ = Q$ ;
      641     2477
      642     2478    2           R$ = CQ$->PTR$ ;
      643     2479    2           IF  DOCVTPTR
      644     2480    2           THEN
      645     2481    2               CALL CVTPTR ( R$, R$ ) ;
      646     2482
      647     2483    2           IF  R$ = CQ$
      648     2484    2           THEN
      649     2485    2               Q$ = ADDR(NIL) ;
      650     2486    2           ELSE
      651     2487    2               CQ$->PTR$ = R$->PTR$ ;
      652     2488
      653     2489    2           RETURN ;
      654     2490
      655     2491    2   END DEQUEUE ;
      656     2492
      657     2493    1   ENQUEUE:        PROC ( Q$, P$ ) ;
      658     2494
      659     2495    2   DCL 1 P$                PTR ALIGNED PARAM ;
      660     2496    2   DCL 1 Q$                PTR ALIGNED PARAM ;
      661     2497
      662     2498    2           IF  Q$ = ADDR(NIL)
      663     2499    3           THEN DO ;
      664     2500    3               P$->PTR$ = P$ ;
      665     2501    3               END ;
      666     2502    3           ELSE DO ;
      667     2503    3               P$->PTR$ = Q$->PTR$ ;
      668     2504    3               Q$->PTR$ = P$ ;
      669     2505    3               END ;
      670     2506
      671     2507    2           Q$ = P$ ;
      672     2508
      673     2509    2           RETURN ;
      674     2510
      675     2511    2   END ENQUEUE ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:21   
      676     2512
      677     2513        %IF  DEBUG ;
      678     2514    1   BINOCTAL:         PROC ( OCT, BIN ) ;
      679     2515
      680     2516    2   DCL 1 BIN(0:12) UBIN(3) UNAL PARAM ;
      681     2517    2   DCL 1 I         SBIN WORD ALIGNED AUTO ;
      682     2518    2   DCL 1 OCT(0:12) CHAR(1) CALIGNED PARAM ;
      683     2519
      684     2520    3   DO  I = 0 TO 11 ;
      685     2521    3       OCT(I)   = BINASC(BIN(I)+48) ;
      686     2522    3       END ;
      687     2523
      688     2524    2   RETURN ;
      689     2525
      690     2526    2   END BINOCTAL ;
      691     2527        %ENDIF ;
      692     2528        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:22   
      693     2529    1   CVTPTR: PROC(IP$,OP$) ALTRET;
      694     2530    2   DCL 1 IP$ ALIGNED,
      695     2531    2           2 ADR UBIN(24) UNAL,
      696     2532    2           2 SEGID BIT(12) UNAL;
      697     2533    2   DCL 1 OP$ ALIGNED,
      698     2534    2           2 ADR UBIN(24) UNAL,
      699     2535    2           2 SEGID BIT(12) UNAL;
      700     2536    2   DCL OP$$ REDEF OP$ PTR;
      701     2537    2   DCL I SBIN;
      702     2538        %SUB SEGNUM# =10;
      703     2539    2   DCL 1 SEGTAB(0:SEGNUM#) SYMREF ALIGNED,
      704     2540    2           2 MONSID BIT(12) ALIGNED,
      705     2541    2           2 RV$ PTR ;
      706     2542        /**/
      707     2543    3           DO I=0 TO SEGNUM#;
      708     2544    3              IF IP$.SEGID=SEGTAB.MONSID(I) THEN GOTO FOUNDIT;
      709     2545    3              END;
      710     2546    2           OP$$=ADDR(NIL);
      711     2547    2           ALTRETURN;
      712     2548    2   FOUNDIT: ;
      713     2549    2           OP$=IP$;
      714     2550    2           OP$.SEGID=SEGTAB.RV$(I)->P.SEGID;
      715     2551    2           RETURN;
      716     2552    2   END CVTPTR;
      717     2553        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:23   
      718     2554        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:24   
      719     2555    1   GET_BUF: PROC(REQ,BUF$);
      720     2556        %N$REQ (NAME=REQ,STCLASS="");
      721     2614    2   DCL BUF$ PTR;
      722     2615    2   DCL 1 CONDESC DALIGNED CONSTANT,
      723     2616    2           2 BOUND UBIN(20) UNAL,
      724     2617    2           2 F BIT(3) INIT('111'B),
      725     2618    2           2 WSQ UBIN(9) UNAL INIT(%USERWSQ),
      726     2619    2           2 T UBIN(4) UNAL INIT(2),
      727     2620    2           2 BASE UBIN WORD;
      728     2621    2   DCL 1 DESC DALIGNED,
      729     2622    2           2 BOUND UBIN(20) UNAL,
      730     2623    2           2 F BIT(3),
      731     2624    2           2 WSQ UBIN(9) UNAL,
      732     2625    2           2 T UBIN(4) UNAL,
      733     2626    2           2 BASE UBIN;
      734     2627    2   DCL 1 RDESC DALIGNED CONSTANT,
      735     2628    2           2 BOUND UBIN(20) UNAL INIT(4095),
      736     2629    2           2 F BIT(3) INIT('111'B),
      737     2630    2           2 WSQ UBIN(9) UNAL INIT(0),
      738     2631    2           2 T UBIN(4) UNAL INIT(2),
      739     2632    2           2 BASE UBIN WORD INIT(0);
      740     2633        /**/
      741     2634        /*N*    The following codes looks like an error.  If the IO system
      742     2635                can't get the IOP go to REAL IO above 16MW, then RECOVERY
      743     2636                certainly can't either.  If it was REAL IO converted to
      744     2637                PAGED IO, it should be done as PAGED IO.  This needs to be
      745     2638                checked out on a DPS 90 with > 16MW of memory.  To check this
      746     2639                out, an REQ packet with REQ.IOP.BUFREL_CVRT set must be on
      747     2640                the DQH.IO$, DCT.SQ$, DCT.DP.BQ$, or DCT.DP.MIRROR.LQ$ of
      748     2641                a disk device when a screech is done.  RCVRIO will then
      749     2642                attempt to do the IO.  After the recovery is done, the
      750     2643                contents of the granule written must be checked against what
      751     2644                was in memory at the time of the screech.
      752     2645        *N*/
      753     2646    3           IF REQ.IOP_BUFREAL_CVRT THEN DO;
      754     2647                   /* IOP CAN'T DO NON-PAGED IO ADDR > 16MW, CONVERT BACK TO REAL IO */
      755     2648    3              REQ.PTP=0;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:25   
      756     2649    3              REQ.BUFADDR=BITBIN(REQ.BUFREAL_SV);
      757     2650    3              REQ.IOP_BUFREAL_CVRT='0'B;
      758     2651    3              END;
      759     2652    3           IF REQ.PTP=0 THEN DO;
      760     2653    3              DESCRV4=RDESC;
      761     2654    3              BUF$=I$RV4$;
      762     2655    3              DESCRV4.BASE=REQ.BUFADDR;
      763     2656    3              DESCRV4.BOUND=REQ.BUFSIZE-1;
      764     2657    3              END;
      765     2658    3           ELSE DO;
      766     2659    3              DESC=CONDESC;
      767     2660    3              DESC.BASE=REQ.BUFVIRT.BASE*8;
      768     2661    3              IF  RPM_FLG
      769     2662    3              THEN
      770     2663        /*             Add in page offset within PTP for IMX.              */
      771     2664    3                  DESC.BASE = DESC.BASE + ( MOD(REQ.PTP,1024) * 4096 ) ;
      772     2665    3              DESC.BOUND=REQ.BUFSIZE+REQ.BUFVIRT.BYT-1;
      773     2666    3              DESC.BOUND=DESC.BOUND+(7-MOD(DESC.BOUND,8));
      774     2667    3              BUF$=PINCRC(I$RV4$,REQ.BUFVIRT.BYT);
      775     2668    3              DESCRV4=DESC;
      776     2669    3              IF RPM_FLG THEN
      777     2670    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ) = REQ.PTP/1024;
      778     2671    3              ELSE IF XA_MODE THEN
      779     2672    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ) = REQ.PTP/16;
      780     2673    3              ELSE
      781     2674    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ)=REQ.PTP;
      782     2675    3              END;
      783     2676    2           CALL IRR$MAP;
      784     2677    2           RETURN;
      785     2678    2   END GET_BUF;
      786     2679    1           I$JIT$->B$MAP(4) = SV_MONPT4;
      787     2680    1   END IRN$RCVRIO;
      788     2681        %EOD;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:26   
--  Include file information  --

   IT_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   S$WSPTD.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IRN$RCVRIO.

   Procedure IRN$RCVRIO requires 1508 words for executable code.
   Procedure IRN$RCVRIO requires 68 words of local(AUTO) storage.

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:27   

 Object Unit name= IRN$RCVRIO                                 File name= IRN$RCVRIO.:E05TOU
 UTS= JUL 29 '97 22:47:05.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   136    210  IRN$RCVRIO
    1  RoData even  UTS     10     12  IRN$RCVRIO
    2   Proc  even  none  1508   2744  IRN$RCVRIO
    3  RoData even  none    68    104  IRN$RCVRIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  IRN$RCVRIO
     2      4                  yes      Std        0  IRN$RCVR_MTUNLOAD
     2    333                  yes      Std        0  IRN$PART

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      4  MSG_IOERR                          0     17  MSG_PART
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:28   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 IRR$FLUSHIQ
         yes           Std       2 IRR$TYPE6M
 yes     yes           Std       7 IRN$MINIQ
         yes           Std       2 IRR$TYPE6
         yes           Std       0 IRR$MAP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     IT_PARTITION                          NI$DVT$                               N$DCT$$
     NI$CHT$                               NI$IOM$                               POBUF
     DESCRV4                               I$RV4$                                I$MONIS$
     I$JIT$                                NK_MXLOCAL                            NI_IOMS
     XA_MODE                               RPM_FLG                               RVF_DEBUG
     SEGTAB                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:29   


        1        1        /*M* IRN$RCVRIO - DO ALL OUTSTANDING DISK I/O AT THE TIME OF A SCREECH */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        IRN$RCVRIO: PROC;

      7  2 000000   000000 700200 xent  IRN$RCVRIO   TSX0  ! X66_AUTO_0
         2 000001   000104 000000                    ZERO    68,0

        8        8        /**/
        9        9        %INCLUDE B_SEGIDS_C;
       10      548        %INCLUDE N_FC_C;
       11      585        %INCLUDE NI$TABLES;
       12      801        %INCLUDE N$REQ;
       13      875        %INCLUDE NI_DATA_C;
       14      988        %INCLUDE S$WSPTD;
       15      997        %INCLUDE B$MAP;
       16     1096        %INCLUDE FT$DDT;
       17     1157        %INCLUDE B_STRINGS_C;
       18     1286        %INCLUDE IT_SUBS_C;
       19     1553        /**/
       20     1554    1   DCL IRN$MINIQ ENTRY(7) ALTRET;
       21     1555    1   DCL IRR$FLUSHIQ ENTRY;
       22     1556    1   DCL IRR$MAP  ENTRY;
       23     1557    1   DCL IRR$TYPE6M ENTRY(2);
       24     1558    1   DCL IRR$TYPE6 ENTRY(2);
       25     1559        /**/
       26     1560        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
       27     1568        %NI$PARTITION (NAME=IT$PARTITION, STCLASS=BASED);
       28     1576    1   DCL PART$ PTR;
       29     1577    1   DCL MAXDCT SBIN;
       30     1578    1   DCL MAXDQH SBIN;
       31     1579    1   DCL MAXIOM SBIN;
       32     1580    1   DCL NI$DVT$ PTR SYMREF;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:30   
       33     1581    1   DCL DVT$$ PTR;
       34     1582    1   DCL DVT$(0:0) PTR BASED(DVT$$);
       35     1583    1   DCL CURDVT$ PTR;
       36     1584        %NI$DVT (NAME=DVT,STCLASS="BASED(CURDVT$)");
       37     1591        /**/
       38     1592    1   DCL N$DCT$$ PTR SYMREF;
       39     1593    1   DCL DCT$$ PTR;
       40     1594    1   DCL DCT$(0:0) PTR BASED(DCT$$);
       41     1595    1   DCL CURDCT$ PTR;
       42     1596        %NI$DCT (NAME=DCT,STCLASS="BASED(CURDCT$)");
       43     1644        /**/
       44     1645    1   DCL CURDQH$ PTR;
       45     1646        %NI$DQH (NAME=DQH,STCLASS="BASED(CURDQH$)");
       46     1669    1   DCL CURCHT$ PTR;
       47     1670        %NI$CHT (NAME=CHT,STCLASS="(0:0) BASED(CURCHT$)");
       48     1673    1   DCL NI$CHT$ PTR SYMREF;
       49     1674    1   DCL CURIOM$$ PTR;
       50     1675    1   DCL NI$IOM$ PTR SYMREF;
       51     1676    1   DCL IOM$(0:0) PTR BASED(CURIOM$$);
       52     1677    1   DCL CURIOM$ PTR;
       53     1678        %NI$IOM (NAME=IOM, STCLASS="BASED(CURIOM$)");
       54     1683        /**/
       55     1684    1   DCL CURSQH$ PTR;
       56     1685        %NI$SQH (NAME=SQH,STCLASS="BASED(CURSQH$)");
       57     1698    1   DCL CURMPC$ PTR;
       58     1699        /**/
       59     1700    1   DCL REQ$ PTR;
       60     1701        %N$REQ (NAME=REQ,STCLASS="BASED(REQ$)");
       61     1759        %NI$REQ (NAME=NI$REQ,STCLASS=BASED);
       62     1784        /**/
       63     1785    1   DCL CURDDT$ PTR;
       64     1786        /**/
       65     1787    1   DCL IOM# SBIN;
       66     1788    1   DCL CHAN# SBIN;
       67     1789    1   DCL DEV# SBIN;
       68     1790    1   DCL GRAN# SBIN;
       69     1791    1   DCL NSPG# SBIN;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:31   
       70     1792    1   DCL MIRDCTX UBIN(36) STATIC  INIT(0);
       71     1793    1   DCL MIRDCT$ PTR STATIC ;
       72     1794    1   DCL MIRDQH$ PTR STATIC;
       73     1795    1   DCL MIRSQH$ PTR STATIC;
       74     1796    1   DCL MIR_FLAG BIT(1) ALIGNED AUTO ;
       75     1797    1   DCL MTUNLOAD BIT(1);
       76     1798    1   DCL I SBIN;
       77     1799    1   DCL BUFSIZE SBIN;
       78     1800    1   DCL ARS SBIN;
       79     1801    1   DCL BUFFER CHAR(ARS) BASED;
       80     1802    1   DCL P$ PTR;
       81     1803    1   DCL SV_MONPT4 BIT(36);
       82     1804        /**/
       83     1805    1   DCL PTR$ PTR BASED;
       84     1806    1   DCL 1 P BASED ALIGNED,
       85     1807    1           2 W UBIN(18) UNAL,
       86     1808    1           2 C UBIN(2) UNAL,
       87     1809    1           2 B UBIN(4) UNAL,
       88     1810    1           2 SEGID BIT(12) UNAL;
       89     1811    1   DCL SBIN36 SBIN WORD BASED;
       90     1812        /**/
       91     1813    1   DCL POBUF CHAR(4096) SYMREF;
       92     1814    1   DCL POBUFA(0:4095) REDEF POBUF CHAR(1);
       93     1815    1   DCL 1 DESCRV4 DALIGNED SYMREF,
       94     1816    1           2 BOUND UBIN(20) UNAL,
       95     1817    1           2 F BIT(3),
       96     1818    1           2 WSQ UBIN(9) UNAL,
       97     1819    1           2 T UBIN(4) UNAL,
       98     1820    1           2 BASE UBIN WORD;
       99     1821    1   DCL I$RV1$ PTR SYMREF;
      100     1822    1   DCL I$RV4$ PTR SYMREF;
      101     1823    1   DCL I$REAL$ PTR SYMREF;
      102     1824    1   DCL I$MONIS$ PTR SYMREF;
      103     1825    1   DCL I$JIT$ PTR SYMREF;
      104     1826        /**/
      105     1827    1   DCL NK_MXLOCAL SBIN SYMREF;
      106     1828    1   DCL NI_IOMS SBIN SYMREF;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:32   
      107     1829    1   DCL XA_MODE BIT(1) ALIGNED SYMREF;
      108     1830    1   DCL RPM_FLG BIT(1) ALIGNED SYMREF;
      109     1831    1   DCL 1 RVF_DEBUG UBIN ALIGNED SYMREF ;
      110     1832    1   DCL 1 MSG_IOERR ALIGNED STATIC SYMDEF,
      111     1833    1         2 NAME    CHAR(4)  CALIGNED INIT(' '),
      112     1834    1         2 TYPE    CHAR(12) CALIGNED INIT(' UNMIRRORED '),
      113     1835    1         2 *       CHAR(28) CALIGNED INIT('DISK I/O ERROR IN RECOVERY  ') ;
      114     1836    1   DCL 1 MSG_PART  ALIGNED STATIC SYMDEF,
      115     1837    1         2 NAME    CHAR(4) CALIGNED INIT(' '),
      116     1838    1         2 *       CHAR(0) CALIGNED INIT(' PARTITIONED BY RECOVERY') ;
      117     1839        %EQU  DEBUG = '1'B ;
      118     1840        %IF   DEBUG ;
      119     1841    1   DCL 1 MSG_DCTX  ALIGNED STATIC,
      120     1842    1         2 *       CHAR(09) CALIGNED INIT('DISK DCT '),
      121     1843    1         2 DCTX    CHAR(03) CALIGNED INIT('XXX'),
      122     1844    1         2 *       CHAR(10) CALIGNED INIT('  MIRFLAG '),
      123     1845    1         2 MIRFLAG CHAR(01) CALIGNED INIT('X'),
      124     1846    1         2 *       CHAR(10) CALIGNED INIT('  MIRDCT '),
      125     1847    1         2 MIRDCTX CHAR(03) CALIGNED INIT('XXX') ;
      126     1848    1   DCL 1 MSG_CVT   ALIGNED STATIC,
      127     1849    1         2 *       CHAR(09) CALIGNED INIT('DOCVTPTR '),
      128     1850    1         2 CVTPTR  CHAR(01) CALIGNED INIT('X'),
      129     1851    1         2 *       CHAR(02) CALIGNED INIT('  ') ;
      130     1852    1   DCL 1 MSG_DCT1  ALIGNED STATIC,
      131     1853    1         2 *       CHAR(11) CALIGNED INIT('DCT.DQH$  .'),
      132     1854    1         2 DQH$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      133     1855    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      134     1856    1   DCL 1 MSG_DQH   ALIGNED STATIC,
      135     1857    1         2 *       CHAR(11) CALIGNED INIT('DQH.IO$   .'),
      136     1858    1         2 IO$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      137     1859    1         2 *       CHAR(01) CALIGNED INIT(' ');
      138     1860    1   DCL 1 MSG_DCT2  ALIGNED STATIC,
      139     1861    1         2 *       CHAR(11) CALIGNED INIT('DCT.SQ$   .'),
      140     1862    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      141     1863    1         2 *       CHAR(12) CALIGNED INIT('  DCT..BQ$ .'),
      142     1864    1         2 BQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      143     1865    1         2 *       CHAR(12) CALIGNED INIT('  DCT..LQ$ .'),
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:33   
      144     1866    1         2 LQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      145     1867    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      146     1868    1   DCL 1 MSG_MDCT1 ALIGNED STATIC,
      147     1869    1         2 *       CHAR(11) CALIGNED INIT('MDCT.DQH$ .'),
      148     1870    1         2 DQH$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      149     1871    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      150     1872    1   DCL 1 MSG_MDQH  ALIGNED STATIC,
      151     1873    1         2 *       CHAR(11) CALIGNED INIT('MDQH.IO$  .'),
      152     1874    1         2 IO$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      153     1875    1         2 *       CHAR(01) CALIGNED INIT(' ');
      154     1876    1   DCL 1 MSG_MDCT2 ALIGNED STATIC,
      155     1877    1         2 *       CHAR(11) CALIGNED INIT('MDCT.SQ$  .'),
      156     1878    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      157     1879    1         2 *       CHAR(12) CALIGNED INIT(' MDCT..BQ$ .'),
      158     1880    1         2 BQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      159     1881    1         2 *       CHAR(12) CALIGNED INIT(' MDCT..LQ$ .'),
      160     1882    1         2 LQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      161     1883    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      162     1884    1   DCL 1 MSG_PROC  ALIGNED STATIC,
      163     1885    1         2 *       CHAR(11) CALIGNED INIT('PROC SQ$  .'),
      164     1886    1         2 SQ$     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      165     1887    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      166     1888    1   DCL 1 MSG_DISK  ALIGNED STATIC,
      167     1889    1         2 *       CHAR(11) CALIGNED INIT('DISK REQ$ .'),
      168     1890    1         2 REQ$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      169     1891    1         2 *       CHAR(12) CALIGNED INIT('       DLA .'),
      170     1892    1         2 DLA     CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      171     1893    1         2 *       CHAR(1) CALIGNED INIT(' ') ;
      172     1894    1   DCL 1 MSG_MINI  ALIGNED STATIC,
      173     1895    1         2 *       CHAR(12) CALIGNED INIT('MINI ICCCDD '),
      174     1896    1         2 I       CHAR(01) CALIGNED INIT('X'),
      175     1897    1         2 *       CHAR(01) CALIGNED INIT('-'),
      176     1898    1         2 CCC     CHAR(03) CALIGNED INIT('XXX'),
      177     1899    1         2 *       CHAR(01) CALIGNED INIT('-'),
      178     1900    1         2 DD      CHAR(02) CALIGNED INIT('XX'),
      179     1901    1         2 *       CHAR(08) CALIGNED INIT( '  GRAN# '),
      180     1902    1         2 GRAN#   CHAR(06) CALIGNED INIT('XXXXXX'),
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:34   
      181     1903    1         2 *       CHAR(02) CALIGNED INIT('  ') ;
      182     1904    1   DCL 1 MSG_BUF   ALIGNED STATIC,
      183     1905    1         2 *       CHAR(11) CALIGNED INIT('     BUF$ .'),
      184     1906    1         2 BUF$    CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      185     1907    1         2 *       CHAR(12) CALIGNED INIT('   DESCRV4 .'),
      186     1908    1         2 DESC1   CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      187     1909    1         2 DESC2   CHAR(12) CALIGNED INIT('XXXXXXXXXXXX'),
      188     1910    1         2 *       CHAR(01) CALIGNED INIT(' ') ;
      189     1911        %ENDIF ;
      190     1912        /**/
      191     1913        %SUB FOREVER="WHILE('1'B)";
      192     1914        %SUB NEVER="WHILE('0'B)";
      193     1915        /**/
      194     1916        %SUB DISK_WRITE=1;
      195     1917        %SUB DISK_READ=2;
      196     1918        %SUB TAPE_UNLOAD=3;
      197     1919        %SUB TAPE_WRPER=4;
      198     1920        %SUB TAPE_WRFM=5;
      199     1921        %SUB TAPE_WRBIN=6;
      200     1922        %SUB TAPE_WRASC=7;
      201     1923        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:35   
      202     1924    1      MTUNLOAD = '0'B;

   1924  2 000002   200031 450100                    STZ     MTUNLOAD,,AUTO

      203     1925    1      GOTO IRN_CONTINUE;

   1925  2 000003   000010 710000 2                  TRA     IRN_CONTINUE

      204     1926
      205     1927    1   IRN$RCVR_MTUNLOAD: ENTRY;

   1927  2 000004   000000 700200 xent  IRN$RCVR_MT* TSX0  ! X66_AUTO_0
         2 000005   000104 000000                    ZERO    68,0

      206     1928    1      MTUNLOAD = '1'B;

   1928  2 000006   400000 236003                    LDQ     -131072,DU
         2 000007   200031 756100                    STQ     MTUNLOAD,,AUTO

   1928  2 000010                       IRN_CONTINUE null
      207     1929
      208     1930    1   IRN_CONTINUE: ;
      209     1931
      210     1932    1           CALL CVTPTR(ADDR(NK_MXLOCAL),P$);

   1932  2 000010   000000 236000 3                  LDQ     0
         2 000011   200071 756100                    STQ     I+8,,AUTO
         2 000012   200035 630500                    EPPR0   P$,,AUTO
         2 000013   200060 450500                    STP0    @IP$+1,,AUTO
         2 000014   200071 631500                    EPPR1   I+8,,AUTO
         2 000015   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000016   002542 701000 2                  TSX1    CVTPTR
         2 000017   000000 011000                    NOP     0

      211     1933    1           MAXDCT=P$->SBIN36;

   1933  2 000020   200035 470500                    LDP0    P$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:36   
         2 000021   000000 235100                    LDA     0,,PR0
         2 000022   200004 755100                    STA     MAXDCT,,AUTO

      212     1934    1           CALL CVTPTR(ADDR(NI$DVT$),DVT$$);

   1934  2 000023   000001 236000 3                  LDQ     1
         2 000024   200072 756100                    STQ     I+9,,AUTO
         2 000025   200007 631500                    EPPR1   DVT$$,,AUTO
         2 000026   200060 451500                    STP1    @IP$+1,,AUTO
         2 000027   200072 633500                    EPPR3   I+9,,AUTO
         2 000030   200057 453500                    STP3    @BUF$+1,,AUTO
         2 000031   002542 701000 2                  TSX1    CVTPTR
         2 000032   000000 011000                    NOP     0

      213     1935    1           CALL CVTPTR(ADDR(N$DCT$$),DCT$$);

   1935  2 000033   000002 236000 3                  LDQ     2
         2 000034   200073 756100                    STQ     I+10,,AUTO
         2 000035   200011 630500                    EPPR0   DCT$$,,AUTO
         2 000036   200060 450500                    STP0    @IP$+1,,AUTO
         2 000037   200073 631500                    EPPR1   I+10,,AUTO
         2 000040   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000041   002542 701000 2                  TSX1    CVTPTR
         2 000042   000000 011000                    NOP     0

      214     1936    1           CALL CVTPTR(DCT$$->PTR$,DCT$$);

   1936  2 000043   200011 630500                    EPPR0   DCT$$,,AUTO
         2 000044   200060 450500                    STP0    @IP$+1,,AUTO
         2 000045   200011 236100                    LDQ     DCT$$,,AUTO
         2 000046   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000047   002542 701000 2                  TSX1    CVTPTR
         2 000050   000000 011000                    NOP     0

      215     1937    1           SV_MONPT4=I$JIT$->B$MAP(4);

   1937  2 000051   000000 470400 xsym               LDP0    I$JIT$
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:37   
         2 000052   000004 236100                    LDQ     4,,PR0
         2 000053   200036 756100                    STQ     SV_MONPT4,,AUTO

      216     1938    1           I$JIT$->B$MAP.CTRL(4)='64'O;

   1938  2 000054   000064 236007                    LDQ     52,DL
         2 000055   000004 752101                    STCQ    4,'01'O,PR0

      217     1939    2           DO I=1 TO MAXDCT;

   1939  2 000056   000001 235007                    LDA     1,DL
         2 000057   200032 755100                    STA     I,,AUTO
         2 000060   000317 710000 2                  TRA     LOOP+1

      218     1940    3              IF DCT$(I)~=ADDR(NIL) THEN DO;

   1940  2 000061   200011 470500                    LDP0    DCT$$,,AUTO
         2 000062   200032 720100                    LXL0    I,,AUTO
         2 000063   000000 236110                    LDQ     0,X0,PR0
         2 000064   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000065   000316 600000 2                  TZE     LOOP

      219     1941    3                 CALL CVTPTR(DCT$(I),CURDCT$);

   1941  2 000066   200012 631500                    EPPR1   CURDCT$,,AUTO
         2 000067   200060 451500                    STP1    @IP$+1,,AUTO
         2 000070   200032 236100                    LDQ     I,,AUTO
         2 000071   000022 736000                    QLS     18
         2 000072   200011 036100                    ADLQ    DCT$$,,AUTO
         2 000073   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000074   002542 701000 2                  TSX1    CVTPTR
         2 000075   000000 011000                    NOP     0

      220     1942    3                 IF DCT.STATUS.DOWN THEN GOTO LOOP;

   1942  2 000076   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000077   000027 234100                    SZN     23,,PR0
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:38   
         2 000100   000316 604000 2                  TMI     LOOP

      221     1943    3                 CALL CVTPTR(DCT.DVT$,CURDVT$);

   1943  2 000101   200010 631500                    EPPR1   CURDVT$,,AUTO
         2 000102   200060 451500                    STP1    @IP$+1,,AUTO
         2 000103   200012 236100                    LDQ     CURDCT$,,AUTO
         2 000104   000024 036003                    ADLQ    20,DU
         2 000105   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000106   002542 701000 2                  TSX1    CVTPTR
         2 000107   000000 011000                    NOP     0

      222     1944    3                 CALL CVTPTR(DCT.SQH$,CURSQH$);

   1944  2 000110   200017 630500                    EPPR0   CURSQH$,,AUTO
         2 000111   200060 450500                    STP0    @IP$+1,,AUTO
         2 000112   200012 236100                    LDQ     CURDCT$,,AUTO
         2 000113   000022 036003                    ADLQ    18,DU
         2 000114   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000115   002542 701000 2                  TSX1    CVTPTR
         2 000116   000000 011000                    NOP     0

      223     1945    3                 IF  SQH.CQ$ = ADDR(NIL)  THEN

   1945  2 000117   200017 470500                    LDP0    CURSQH$,,AUTO
         2 000120   000004 236100                    LDQ     4,,PR0
         2 000121   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000122   000133 601000 2                  TNZ     s:1948

      224     1946    3                     CALL CVTPTR ( DCT.DQH$, CURDQH$ ) ;

   1946  2 000123   200013 631500                    EPPR1   CURDQH$,,AUTO
         2 000124   200060 451500                    STP1    @IP$+1,,AUTO
         2 000125   200012 236100                    LDQ     CURDCT$,,AUTO
         2 000126   000023 036003                    ADLQ    19,DU
         2 000127   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000130   002542 701000 2                  TSX1    CVTPTR
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:39   
         2 000131   000000 011000                    NOP     0
         2 000132   000142 710000 2                  TRA     s:1949

      225     1947    3                 ELSE
      226     1948    3                     CALL CVTPTR ( SQH.CQ$,  CURDQH$ ) ;

   1948  2 000133   200013 631500                    EPPR1   CURDQH$,,AUTO
         2 000134   200060 451500                    STP1    @IP$+1,,AUTO
         2 000135   200017 236100                    LDQ     CURSQH$,,AUTO
         2 000136   000004 036003                    ADLQ    4,DU
         2 000137   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000140   002542 701000 2                  TSX1    CVTPTR
         2 000141   000000 011000                    NOP     0

      227     1949    3                 CALL CVTPTR(DQH.IO$, REQ$ ) ;

   1949  2 000142   200021 630500                    EPPR0   REQ$,,AUTO
         2 000143   200060 450500                    STP0    @IP$+1,,AUTO
         2 000144   200013 236100                    LDQ     CURDQH$,,AUTO
         2 000145   000014 036003                    ADLQ    12,DU
         2 000146   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000147   002542 701000 2                  TSX1    CVTPTR
         2 000150   000000 011000                    NOP     0

      228     1950    3                 IF  DCT.TYPE = %DV_DP

   1950  2 000151   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000152   000007 236100                    LDQ     7,,PR0
         2 000153   007700 376007                    ANQ     4032,DL
         2 000154   000600 116007                    CMPQ    384,DL
         2 000155   000233 601000 2                  TNZ     s:1965
         2 000156   000036 234100                    SZN     30,,PR0
         2 000157   000233 605000 2                  TPL     s:1965

      229     1951    3                 AND DCT.DP.MIRROR.FLAG
      230     1952    4                 THEN DO ;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:40   
      231     1953    4                     MIR_FLAG = '1'B ;

   1953  2 000160   400000 236003                    LDQ     -131072,DU
         2 000161   200030 756100                    STQ     MIR_FLAG,,AUTO

      232     1954    4                     MIRDCTX = DCT.DP.MIRROR.DCTX ;

   1954  2 000162   000037 236100                    LDQ     31,,PR0
         2 000163   000022 772000                    QRL     18
         2 000164   000000 756000 0                  STQ     MIRDCTX

      233     1955    4                     CALL CVTPTR ( DCT$(MIRDCTX), MIRDCT$ ) ;

   1955  2 000165   000003 236000 3                  LDQ     3
         2 000166   200060 756100                    STQ     @IP$+1,,AUTO
         2 000167   000000 236000 0                  LDQ     MIRDCTX
         2 000170   000022 736000                    QLS     18
         2 000171   200011 036100                    ADLQ    DCT$$,,AUTO
         2 000172   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000173   002542 701000 2                  TSX1    CVTPTR
         2 000174   000000 011000                    NOP     0

      234     1956    4                     CALL CVTPTR ( MIRDCT$->DCT.SQH$, MIRSQH$ ) ;

   1956  2 000175   000004 236000 3                  LDQ     4
         2 000176   200060 756100                    STQ     @IP$+1,,AUTO
         2 000177   000001 236000 0                  LDQ     MIRDCT$
         2 000200   000022 036003                    ADLQ    18,DU
         2 000201   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000202   002542 701000 2                  TSX1    CVTPTR
         2 000203   000000 011000                    NOP     0

      235     1957    4                     IF  MIRSQH$->SQH.CQ$ = ADDR(NIL)

   1957  2 000204   000003 470400 0                  LDP0    MIRSQH$
         2 000205   000004 236100                    LDQ     4,,PR0
         2 000206   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:41   
         2 000207   000220 601000 2                  TNZ     s:1961

      236     1958    4                     THEN
      237     1959    4                         CALL CVTPTR ( MIRDCT$->DCT.DQH$, MIRDQH$ ) ;

   1959  2 000210   000005 236000 3                  LDQ     5
         2 000211   200060 756100                    STQ     @IP$+1,,AUTO
         2 000212   000001 236000 0                  LDQ     MIRDCT$
         2 000213   000023 036003                    ADLQ    19,DU
         2 000214   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000215   002542 701000 2                  TSX1    CVTPTR
         2 000216   000000 011000                    NOP     0
         2 000217   000227 710000 2                  TRA     s:1962

      238     1960    4                     ELSE
      239     1961    4                         CALL CVTPTR ( MIRSQH$->SQH.CQ$,  MIRDQH$ ) ;

   1961  2 000220   000005 236000 3                  LDQ     5
         2 000221   200060 756100                    STQ     @IP$+1,,AUTO
         2 000222   000003 236000 0                  LDQ     MIRSQH$
         2 000223   000004 036003                    ADLQ    4,DU
         2 000224   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000225   002542 701000 2                  TSX1    CVTPTR
         2 000226   000000 011000                    NOP     0

      240     1962    4                     MSG_IOERR.TYPE = ' MIRRORED ' ;

   1962  2 000227   040000 100400                    MLR     fill='040'O
         2 000230   000004 000012 1                  ADSC9   RDESC+2                  cn=0,n=10
         2 000231   000005 000014 0                  ADSC9   MSG_IOERR+1              cn=0,n=12

      241     1963    4                     END ;

   1963  2 000232   000240 710000 2                  TRA     s:1969

      242     1964    4                 ELSE DO ;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:42   
      243     1965    4                     MIR_FLAG  = '0'B ;

   1965  2 000233   200030 450100                    STZ     MIR_FLAG,,AUTO

      244     1966    4                     MIRDCTX   = 0 ;

   1966  2 000234   000000 450000 0                  STZ     MIRDCTX

      245     1967    4                     MSG_IOERR.TYPE = ' UNMIRRORED ' ;

   1967  2 000235   040000 100400                    MLR     fill='040'O
         2 000236   000007 000014 1                  ADSC9   RDESC+5                  cn=0,n=12
         2 000237   000005 000014 0                  ADSC9   MSG_IOERR+1              cn=0,n=12

      246     1968    4                     END ;

      247     1969    3                 DEV#=DCT.DVN;

   1969  2 000240   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000241   000007 236100                    LDQ     7,,PR0
         2 000242   000030 772000                    QRL     24
         2 000243   000077 376007                    ANQ     63,DL
         2 000244   200025 756100                    STQ     DEV#,,AUTO

      248     1970    3                 IOM#=DQH.IOCHAN.IOM;

   1970  2 000245   200013 471500                    LDP1    CURDQH$,,AUTO
         2 000246   100001 236100                    LDQ     1,,PR1
         2 000247   000031 772000                    QRL     25
         2 000250   000003 376007                    ANQ     3,DL
         2 000251   200023 756100                    STQ     IOM#,,AUTO

      249     1971    3                 CHAN#=DQH.IOCHAN.CHANNEL;

   1971  2 000252   100001 236100                    LDQ     1,,PR1
         2 000253   000022 772000                    QRL     18
         2 000254   000177 376007                    ANQ     127,DL
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:43   
         2 000255   200024 756100                    STQ     CHAN#,,AUTO

      250     1972    3                 NSPG#=DVT.GRANSIZE;

   1972  2 000256   200010 473500                    LDP3    CURDVT$,,AUTO
         2 000257   300053 236100                    LDQ     43,,PR3
         2 000260   000777 376007                    ANQ     511,DL
         2 000261   200027 756100                    STQ     NSPG#,,AUTO

      251     1973    4                 DO CASE(DVT.TYPE);

   1973  2 000262   300053 236100                    LDQ     43,,PR3
         2 000263   000033 772000                    QRL     27
         2 000264   000004 136007                    SBLQ    4,DL
         2 000265   000003 116007                    CMPQ    3,DL
         2 000266   000270 602006 2                  TNC     s:1973+6,QL
         2 000267   000316 710000 2                  TRA     LOOP
         2 000270   000300 710000 2                  TRA     s:1978
         2 000271   000316 710000 2                  TRA     LOOP
         2 000272   000273 710000 2                  TRA     s:1975

      252     1974    4                  CASE(%DV_DP);

      253     1975    4                   IF NOT MTUNLOAD

   1975  2 000273   200031 234100                    SZN     MTUNLOAD,,AUTO
         2 000274   000316 604000 2                  TMI     LOOP

      254     1976    4                    THEN CALL DISK_RUNDOWN;

   1976  2 000275   000723 701000 2                  TSX1    DISK_RUNDOWN
         2 000276   000000 011000                    NOP     0
         2 000277   000316 710000 2                  TRA     LOOP

      255     1977    4                  CASE(%DV_MT);

      256     1978    4                    CALL CVTPTR(DCT.DDT$,CURDDT$);
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:44   

   1978  2 000300   200022 634500                    EPPR4   CURDDT$,,AUTO
         2 000301   200060 454500                    STP4    @IP$+1,,AUTO
         2 000302   200012 236100                    LDQ     CURDCT$,,AUTO
         2 000303   000004 036003                    ADLQ    4,DU
         2 000304   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000305   002542 701000 2                  TSX1    CVTPTR
         2 000306   000000 011000                    NOP     0

      257     1979    4                   IF MTUNLOAD

   1979  2 000307   200031 234100                    SZN     MTUNLOAD,,AUTO
         2 000310   000314 605000 2                  TPL     s:1981

      258     1980    4                    THEN CALL TAPE_DISM;

   1980  2 000311   002231 701000 2                  TSX1    TAPE_DISM
         2 000312   000000 011000                    NOP     0
         2 000313   000316 710000 2                  TRA     LOOP

      259     1981    4                    ELSE CALL TAPE_RUNDOWN;

   1981  2 000314   002031 701000 2                  TSX1    TAPE_RUNDOWN
         2 000315   000000 011000                    NOP     0

      260     1982    4                  END;

      261     1983    3                 END;

      262     1984    2   LOOP:      END;

   1984  2 000316   200032 054100       LOOP         AOS     I,,AUTO
         2 000317   200032 236100                    LDQ     I,,AUTO
         2 000320   200004 116100                    CMPQ    MAXDCT,,AUTO
         2 000321   000061 604400 2                  TMOZ    s:1940

      263     1985    1           IF NOT MTUNLOAD THEN
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:45   

   1985  2 000322   200031 234100                    SZN     MTUNLOAD,,AUTO
         2 000323   000327 604000 2                  TMI     s:1987

      264     1986    1              CALL IRR$FLUSHIQ;

   1986  2 000324   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000325   000000 701000 xent               TSX1    IRR$FLUSHIQ
         2 000326   000000 011000                    NOP     0

      265     1987    1           I$JIT$->B$MAP(4)=SV_MONPT4;

   1987  2 000327   200036 236100                    LDQ     SV_MONPT4,,AUTO
         2 000330   000000 470400 xsym               LDP0    I$JIT$
         2 000331   000004 756100                    STQ     4,,PR0

      266     1988    1           RETURN;

   1988  2 000332   000000 702200 xent               TSX2  ! X66_ARET

      267     1989        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:46   
      268     1990    1   IRN$PART: ENTRY;

   1990  2 000333   000000 700200 xent  IRN$PART     TSX0  ! X66_AUTO_0
         2 000334   000104 000000                    ZERO    68,0

      269     1991
      270     1992    1         CALL CVTPTR (ADDR(NK_MXLOCAL),P$);

   1992  2 000335   000000 236000 3                  LDQ     0
         2 000336   200074 756100                    STQ     I+11,,AUTO
         2 000337   200035 630500                    EPPR0   P$,,AUTO
         2 000340   200060 450500                    STP0    @IP$+1,,AUTO
         2 000341   200074 631500                    EPPR1   I+11,,AUTO
         2 000342   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000343   002542 701000 2                  TSX1    CVTPTR
         2 000344   000000 011000                    NOP     0

      271     1993    1         MAXDCT=P$->SBIN36;

   1993  2 000345   200035 470500                    LDP0    P$,,AUTO
         2 000346   000000 235100                    LDA     0,,PR0
         2 000347   200004 755100                    STA     MAXDCT,,AUTO

      272     1994    1         CALL CVTPTR(ADDR(N$DCT$$),DCT$$);

   1994  2 000350   000002 236000 3                  LDQ     2
         2 000351   200075 756100                    STQ     I+12,,AUTO
         2 000352   200011 631500                    EPPR1   DCT$$,,AUTO
         2 000353   200060 451500                    STP1    @IP$+1,,AUTO
         2 000354   200075 633500                    EPPR3   I+12,,AUTO
         2 000355   200057 453500                    STP3    @BUF$+1,,AUTO
         2 000356   002542 701000 2                  TSX1    CVTPTR
         2 000357   000000 011000                    NOP     0

      273     1995    1         CALL CVTPTR(DCT$$->PTR$,DCT$$);

   1995  2 000360   200011 630500                    EPPR0   DCT$$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:47   
         2 000361   200060 450500                    STP0    @IP$+1,,AUTO
         2 000362   200011 236100                    LDQ     DCT$$,,AUTO
         2 000363   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000364   002542 701000 2                  TSX1    CVTPTR
         2 000365   000000 011000                    NOP     0

      274     1996    1         SV_MONPT4=I$JIT$->B$MAP(4);

   1996  2 000366   000000 470400 xsym               LDP0    I$JIT$
         2 000367   000004 236100                    LDQ     4,,PR0
         2 000370   200036 756100                    STQ     SV_MONPT4,,AUTO

      275     1997    1         I$JIT$->B$MAP.CTRL(4)='64'O;

   1997  2 000371   000064 236007                    LDQ     52,DL
         2 000372   000004 752101                    STCQ    4,'01'O,PR0

      276     1998    1         CALL CVTPTR (ADDR(IT_PARTITION),PART$);

   1998  2 000373   000006 236000 3                  LDQ     6
         2 000374   200076 756100                    STQ     I+13,,AUTO
         2 000375   200003 631500                    EPPR1   PART$,,AUTO
         2 000376   200060 451500                    STP1    @IP$+1,,AUTO
         2 000377   200076 633500                    EPPR3   I+13,,AUTO
         2 000400   200057 453500                    STP3    @BUF$+1,,AUTO
         2 000401   002542 701000 2                  TSX1    CVTPTR
         2 000402   000000 011000                    NOP     0

      277     1999    2         DO I = 1 TO MAXDCT;

   1999  2 000403   000001 235007                    LDA     1,DL
         2 000404   200032 755100                    STA     I,,AUTO
         2 000405   000472 710000 2                  TRA     s:2011+1

      278     2000    3            IF DCT$(I)~=ADDR(NIL) THEN DO;

   2000  2 000406   200011 470500                    LDP0    DCT$$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:48   
         2 000407   200032 720100                    LXL0    I,,AUTO
         2 000410   000000 236110                    LDQ     0,X0,PR0
         2 000411   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000412   000471 600000 2                  TZE     s:2011

      279     2001    3               CALL CVTPTR(DCT$(I),CURDCT$);

   2001  2 000413   200012 631500                    EPPR1   CURDCT$,,AUTO
         2 000414   200060 451500                    STP1    @IP$+1,,AUTO
         2 000415   200032 236100                    LDQ     I,,AUTO
         2 000416   000022 736000                    QLS     18
         2 000417   200011 036100                    ADLQ    DCT$$,,AUTO
         2 000420   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000421   002542 701000 2                  TSX1    CVTPTR
         2 000422   000000 011000                    NOP     0

      280     2002    3               IF DCT.STATUS.SYSCON_PART THEN

   2002  2 000423   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000424   000027 236100                    LDQ     23,,PR0
         2 000425   004000 316003                    CANQ    2048,DU
         2 000426   000437 600000 2                  TZE     s:2005

      281     2003    3                  PART$->IT$PARTITION.DEVICE(I) = '1'B;

   2003  2 000427   200032 235100                    LDA     I,,AUTO
         2 000430   000432 605000 2                  TPL     s:2003+3
         2 000431   000044 035003                    ADLA    36,DU
         2 000432   200003 471500                    LDP1    PART$,,AUTO
         2 000433   003105 060400                    CSL     bolr='003'O
         2 000434   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000435   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1
         2 000436   000446 710000 2                  TRA     s:2006

      282     2004    3               ELSE
      283     2005    3                  PART$->IT$PARTITION.DEVICE(I) = '0'B;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:49   
   2005  2 000437   200032 235100                    LDA     I,,AUTO
         2 000440   000442 605000 2                  TPL     s:2005+3
         2 000441   000044 035003                    ADLA    36,DU
         2 000442   200003 471500                    LDP1    PART$,,AUTO
         2 000443   003105 060400                    CSL     bolr='003'O
         2 000444   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000445   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

      284     2006    3               IF DCT.STATUS.MSOS_PART THEN

   2006  2 000446   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000447   000027 236100                    LDQ     23,,PR0
         2 000450   002000 316003                    CANQ    1024,DU
         2 000451   000462 600000 2                  TZE     s:2009

      285     2007    3                  PART$->IT$PARTITION.MSOS_DEVICE(I) = '1'B;

   2007  2 000452   200032 235100                    LDA     I,,AUTO
         2 000453   000455 605000 2                  TPL     s:2007+3
         2 000454   000044 035003                    ADLA    36,DU
         2 000455   200003 471500                    LDP1    PART$,,AUTO
         2 000456   003105 060400                    CSL     bolr='003'O
         2 000457   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000460   100031 000001                    BDSC    25,A,PR1                 by=0,bit=0,n=1
         2 000461   000471 710000 2                  TRA     s:2011

      286     2008    3               ELSE
      287     2009    3                  PART$->IT$PARTITION.MSOS_DEVICE(I) = '0'B;

   2009  2 000462   200032 235100                    LDA     I,,AUTO
         2 000463   000465 605000 2                  TPL     s:2009+3
         2 000464   000044 035003                    ADLA    36,DU
         2 000465   200003 471500                    LDP1    PART$,,AUTO
         2 000466   003105 060400                    CSL     bolr='003'O
         2 000467   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000470   100031 000001                    BDSC    25,A,PR1                 by=0,bit=0,n=1

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:50   
      288     2010    3               END;

      289     2011    2            END;

   2011  2 000471   200032 054100                    AOS     I,,AUTO
         2 000472   200032 236100                    LDQ     I,,AUTO
         2 000473   200004 116100                    CMPQ    MAXDCT,,AUTO
         2 000474   000406 604400 2                  TMOZ    s:2000

      290     2012
      291     2013    1         CALL CVTPTR(ADDR(NI_IOMS),P$);

   2013  2 000475   000007 236000 3                  LDQ     7
         2 000476   200077 756100                    STQ     I+14,,AUTO
         2 000477   200035 630500                    EPPR0   P$,,AUTO
         2 000500   200060 450500                    STP0    @IP$+1,,AUTO
         2 000501   200077 631500                    EPPR1   I+14,,AUTO
         2 000502   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000503   002542 701000 2                  TSX1    CVTPTR
         2 000504   000000 011000                    NOP     0

      292     2014    1         CALL CVTPTR(ADDR(NI$CHT$),CURCHT$);

   2014  2 000505   000010 236000 3                  LDQ     8
         2 000506   200100 756100                    STQ     I+15,,AUTO
         2 000507   200014 630500                    EPPR0   CURCHT$,,AUTO
         2 000510   200060 450500                    STP0    @IP$+1,,AUTO
         2 000511   200100 631500                    EPPR1   I+15,,AUTO
         2 000512   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000513   002542 701000 2                  TSX1    CVTPTR
         2 000514   000000 011000                    NOP     0

      293     2015    1         CALL CVTPTR(CURCHT$->PTR$,CURCHT$);

   2015  2 000515   200014 630500                    EPPR0   CURCHT$,,AUTO
         2 000516   200060 450500                    STP0    @IP$+1,,AUTO
         2 000517   200014 236100                    LDQ     CURCHT$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:51   
         2 000520   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000521   002542 701000 2                  TSX1    CVTPTR
         2 000522   000000 011000                    NOP     0

      294     2016    1         MAXIOM = P$->SBIN36;

   2016  2 000523   200035 470500                    LDP0    P$,,AUTO
         2 000524   000000 235100                    LDA     0,,PR0
         2 000525   200006 755100                    STA     MAXIOM,,AUTO

      295     2017    1         MAXDQH = MAXIOM*%N_MAXCHANS-1;

   2017  2 000526   000007 735000                    ALS     7
         2 000527   000001 135007                    SBLA    1,DL
         2 000530   200005 755100                    STA     MAXDQH,,AUTO

      296     2018    2         DO I = 0 TO MAXDQH;

   2018  2 000531   200032 450100                    STZ     I,,AUTO
         2 000532   000617 710000 2                  TRA     s:2030+1

      297     2019    3            IF CHT.DQH$(I) ~= ADDR(NIL) THEN DO;

   2019  2 000533   200032 235100                    LDA     I,,AUTO
         2 000534   000001 735000                    ALS     1
         2 000535   200014 470500                    LDP0    CURCHT$,,AUTO
         2 000536   000000 236105                    LDQ     0,AL,PR0
         2 000537   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000540   000616 600000 2                  TZE     s:2030

      298     2020    3               CALL CVTPTR (CHT.DQH$(I), CURDQH$);

   2020  2 000541   200013 631500                    EPPR1   CURDQH$,,AUTO
         2 000542   200060 451500                    STP1    @IP$+1,,AUTO
         2 000543   200032 236100                    LDQ     I,,AUTO
         2 000544   000023 736000                    QLS     19
         2 000545   200014 036100                    ADLQ    CURCHT$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:52   
         2 000546   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000547   002542 701000 2                  TSX1    CVTPTR
         2 000550   000000 011000                    NOP     0

      299     2021    3               IF DQH.STATUS.SYSCON_PART THEN

   2021  2 000551   200013 470500                    LDP0    CURDQH$,,AUTO
         2 000552   000001 236100                    LDQ     1,,PR0
         2 000553   002000 316003                    CANQ    1024,DU
         2 000554   000565 600000 2                  TZE     s:2024

      300     2022    3                  PART$->IT$PARTITION.IOCHAN(I) = '1'B;

   2022  2 000555   200032 235100                    LDA     I,,AUTO
         2 000556   000560 605000 2                  TPL     s:2022+3
         2 000557   000044 035003                    ADLA    36,DU
         2 000560   200003 471500                    LDP1    PART$,,AUTO
         2 000561   003105 060400                    CSL     bolr='003'O
         2 000562   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000563   100012 000001                    BDSC    10,A,PR1                 by=0,bit=0,n=1
         2 000564   000574 710000 2                  TRA     s:2025

      301     2023    3               ELSE
      302     2024    3                  PART$->IT$PARTITION.IOCHAN(I) = '0'B;

   2024  2 000565   200032 235100                    LDA     I,,AUTO
         2 000566   000570 605000 2                  TPL     s:2024+3
         2 000567   000044 035003                    ADLA    36,DU
         2 000570   200003 471500                    LDP1    PART$,,AUTO
         2 000571   003105 060400                    CSL     bolr='003'O
         2 000572   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000573   100012 000001                    BDSC    10,A,PR1                 by=0,bit=0,n=1

      303     2025    3               IF DQH.STATUS.MSOS_PART THEN

   2025  2 000574   200013 470500                    LDP0    CURDQH$,,AUTO
         2 000575   000001 430100                    FSZN    1,,PR0
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:53   
         2 000576   000607 605000 2                  TPL     s:2028

      304     2026    3                  PART$->IT$PARTITION.MSOS_IOCHAN(I) = '1'B;

   2026  2 000577   200032 235100                    LDA     I,,AUTO
         2 000600   000602 605000 2                  TPL     s:2026+3
         2 000601   000044 035003                    ADLA    36,DU
         2 000602   200003 471500                    LDP1    PART$,,AUTO
         2 000603   003105 060400                    CSL     bolr='003'O
         2 000604   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000605   100043 000001                    BDSC    35,A,PR1                 by=0,bit=0,n=1
         2 000606   000616 710000 2                  TRA     s:2030

      305     2027    3               ELSE
      306     2028    3                  PART$->IT$PARTITION.MSOS_IOCHAN(I) = '0'B;

   2028  2 000607   200032 235100                    LDA     I,,AUTO
         2 000610   000612 605000 2                  TPL     s:2028+3
         2 000611   000044 035003                    ADLA    36,DU
         2 000612   200003 471500                    LDP1    PART$,,AUTO
         2 000613   003105 060400                    CSL     bolr='003'O
         2 000614   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000615   100043 000001                    BDSC    35,A,PR1                 by=0,bit=0,n=1

      307     2029    3               END;

      308     2030    2            END;

   2030  2 000616   200032 054100                    AOS     I,,AUTO
         2 000617   200032 236100                    LDQ     I,,AUTO
         2 000620   200005 116100                    CMPQ    MAXDQH,,AUTO
         2 000621   000533 604400 2                  TMOZ    s:2019

      309     2031
      310     2032    1         CALL CVTPTR (ADDR(NI$IOM$),CURIOM$$);

   2032  2 000622   000011 236000 3                  LDQ     9
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:54   
         2 000623   200101 756100                    STQ     I+16,,AUTO
         2 000624   200015 630500                    EPPR0   CURIOM$$,,AUTO
         2 000625   200060 450500                    STP0    @IP$+1,,AUTO
         2 000626   200101 631500                    EPPR1   I+16,,AUTO
         2 000627   200057 451500                    STP1    @BUF$+1,,AUTO
         2 000630   002542 701000 2                  TSX1    CVTPTR
         2 000631   000000 011000                    NOP     0

      311     2033    2         DO I = 0 TO MAXIOM-1;

   2033  2 000632   200032 450100                    STZ     I,,AUTO
         2 000633   000717 710000 2                  TRA     s:2043+1

      312     2034    2            CALL CVTPTR (CURIOM$$->IOM$(I), CURIOM$);

   2034  2 000634   200016 630500                    EPPR0   CURIOM$,,AUTO
         2 000635   200060 450500                    STP0    @IP$+1,,AUTO
         2 000636   200032 236100                    LDQ     I,,AUTO
         2 000637   000022 736000                    QLS     18
         2 000640   200015 036100                    ADLQ    CURIOM$$,,AUTO
         2 000641   200057 756100                    STQ     @BUF$+1,,AUTO
         2 000642   002542 701000 2                  TSX1    CVTPTR
         2 000643   000000 011000                    NOP     0

      313     2035    2            IF IOM.STATUS.SYSCON_PART THEN /* Sleaze part'd ioms in channel 0 */

   2035  2 000644   200016 470500                    LDP0    CURIOM$,,AUTO
         2 000645   000003 236100                    LDQ     3,,PR0
         2 000646   000020 316007                    CANQ    16,DL
         2 000647   000661 600000 2                  TZE     s:2038

      314     2036    2               PART$->IT$PARTITION.IOCHAN(I*%N_MAXCHANS) = '1'B;

   2036  2 000650   200032 235100                    LDA     I,,AUTO
         2 000651   000007 735000                    ALS     7
         2 000652   000654 605000 2                  TPL     s:2036+4
         2 000653   000044 035003                    ADLA    36,DU
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:55   
         2 000654   200003 471500                    LDP1    PART$,,AUTO
         2 000655   003105 060400                    CSL     bolr='003'O
         2 000656   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000657   100012 000001                    BDSC    10,A,PR1                 by=0,bit=0,n=1
         2 000660   000671 710000 2                  TRA     s:2039

      315     2037    2            ELSE
      316     2038    2               PART$->IT$PARTITION.IOCHAN(I*%N_MAXCHANS) = '0'B;

   2038  2 000661   200032 235100                    LDA     I,,AUTO
         2 000662   000007 735000                    ALS     7
         2 000663   000665 605000 2                  TPL     s:2038+4
         2 000664   000044 035003                    ADLA    36,DU
         2 000665   200003 471500                    LDP1    PART$,,AUTO
         2 000666   003105 060400                    CSL     bolr='003'O
         2 000667   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000670   100012 000001                    BDSC    10,A,PR1                 by=0,bit=0,n=1

      317     2039    2            IF IOM.STATUS.MSOS_PART THEN /* Sleaze part'd ioms in channel 0 */

   2039  2 000671   200016 470500                    LDP0    CURIOM$,,AUTO
         2 000672   000003 236100                    LDQ     3,,PR0
         2 000673   000010 316007                    CANQ    8,DL
         2 000674   000706 600000 2                  TZE     s:2042

      318     2040    2               PART$->IT$PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS) = '1'B;

   2040  2 000675   200032 235100                    LDA     I,,AUTO
         2 000676   000007 735000                    ALS     7
         2 000677   000701 605000 2                  TPL     s:2040+4
         2 000700   000044 035003                    ADLA    36,DU
         2 000701   200003 471500                    LDP1    PART$,,AUTO
         2 000702   003105 060400                    CSL     bolr='003'O
         2 000703   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000704   100043 000001                    BDSC    35,A,PR1                 by=0,bit=0,n=1
         2 000705   000716 710000 2                  TRA     s:2043

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:56   
      319     2041    2            ELSE
      320     2042    2               PART$->IT$PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS) = '0'B;

   2042  2 000706   200032 235100                    LDA     I,,AUTO
         2 000707   000007 735000                    ALS     7
         2 000710   000712 605000 2                  TPL     s:2042+4
         2 000711   000044 035003                    ADLA    36,DU
         2 000712   200003 471500                    LDP1    PART$,,AUTO
         2 000713   003105 060400                    CSL     bolr='003'O
         2 000714   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000715   100043 000001                    BDSC    35,A,PR1                 by=0,bit=0,n=1

      321     2043    2            END;

   2043  2 000716   200032 054100                    AOS     I,,AUTO
         2 000717   200032 236100                    LDQ     I,,AUTO
         2 000720   200006 116100                    CMPQ    MAXIOM,,AUTO
         2 000721   000634 604000 2                  TMI     s:2034
         2 000722   002740 710000 2                  TRA     s:2679

      322     2044
      323     2045        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:57   
      324     2046    1   DISK_RUNDOWN: PROC;

   2046  2 000723   200040 741300       DISK_RUNDOWN STX1  ! SV_MONPT4+2,,AUTO

      325     2047
      326     2048    2   DCL 1 DOCVTPTR  BIT(1) ALIGNED AUTO ;
      327     2049
      328     2050                %IF  DEBUG ;
      329     2051    2           IF  RVF_DEBUG ~= 0

   2051  2 000724   000000 235000 xsym               LDA     RVF_DEBUG
         2 000725   000757 600000 2                  TZE     s:2059

      330     2052    3           THEN DO ;

      331     2053    3               CALL BINCHAR    ( MSG_DCTX.DCTX,    DCT.DCTX ) ;

   2053  2 000726   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000727   000006 236100                    LDQ     6,,PR0
         2 000730   000025 772000                    QRL     21
         2 000731   000000 235003                    LDA     0,DU
         2 000732   200062 757100                    STAQ    I+1,,AUTO
         2 000733   000000 301500                    BTD
         2 000734   200062 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         2 000735   000030 230003 0                  NDSC9   MSG_DCTX+2               cn=1,s=nosgn,sf=0,n=3

      332     2054    3               CALL BINCHAR    ( MSG_DCTX.MIRFLAG, BITBIN(MIR_FLAG) ) ;

   2054  2 000736   200030 236100                    LDQ     MIR_FLAG,,AUTO
         2 000737   000043 772000                    QRL     35
         2 000740   000000 235003                    LDA     0,DU
         2 000741   200062 757100                    STAQ    I+1,,AUTO
         2 000742   000000 301500                    BTD
         2 000743   200062 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         2 000744   000033 430001 0                  NDSC9   MSG_DCTX+5               cn=2,s=nosgn,sf=0,n=1

      333     2055    3               CALL BINCHAR    ( MSG_DCTX.MIRDCTX, MIRDCTX ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:58   

   2055  2 000745   000000 236000 0                  LDQ     MIRDCTX
         2 000746   000000 235003                    LDA     0,DU
         2 000747   200062 757100                    STAQ    I+1,,AUTO
         2 000750   000000 301500                    BTD
         2 000751   200062 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         2 000752   000036 230003 0                  NDSC9   MSG_DCTX+8               cn=1,s=nosgn,sf=0,n=3

      334     2056    3               CALL IRR$TYPE6M ( MSG_DCTX, SIZEW(MSG_DCTX) ) ;

   2056  2 000753   000012 630400 3                  EPPR0   10
         2 000754   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000755   000000 701000 xent               TSX1    IRR$TYPE6M
         2 000756   000000 011000                    NOP     0

      335     2057    3               END ;

      336     2058                %ENDIF ;
      337     2059    2           IF  DCT.STATE = %ASSIGNED

   2059  2 000757   200012 470500                    LDP0    CURDCT$,,AUTO
         2 000760   000007 236100                    LDQ     7,,PR0
         2 000761   000077 376007                    ANQ     63,DL
         2 000762   000002 116007                    CMPQ    2,DL
         2 000763   000766 600000 2                  TZE     s:2063
         2 000764   000005 116007                    CMPQ    5,DL
         2 000765   001042 601000 2                  TNZ     s:2082

      338     2060    2           OR  DCT.STATE = %BUSY
      339     2061    3           THEN DO ;

      340     2062                    %IF  DEBUG ;
      341     2063    3               IF  RVF_DEBUG ~= 0

   2063  2 000766   000000 235000 xsym               LDA     RVF_DEBUG
         2 000767   001003 600000 2                  TZE     s:2069

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:59   
      342     2064    4               THEN DO ;

      343     2065    4                   CALL BINOCTAL   ( MSG_DCT1.DQH$, DCT.DQH$ ) ;

   2065  2 000770   200012 236100                    LDQ     CURDCT$,,AUTO
         2 000771   000023 036003                    ADLQ    19,DU
         2 000772   200056 756100                    STQ     @REQ+1,,AUTO
         2 000773   000014 236000 3                  LDQ     12
         2 000774   200055 756100                    STQ     CQ$+1,,AUTO
         2 000775   002507 701000 2                  TSX1    BINOCTAL
         2 000776   000000 011000                    NOP     0

      344     2066    4                   CALL IRR$TYPE6M ( MSG_DCT1, SIZEW(MSG_DCT1) ) ;

   2066  2 000777   000015 630400 3                  EPPR0   13
         2 001000   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001001   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001002   000000 011000                    NOP     0

      345     2067    4                   END ;

      346     2068                    %ENDIF ;
      347     2069    3               CALL CVTPTR ( DCT.DQH$, CURDQH$ ) ;

   2069  2 001003   200013 630500                    EPPR0   CURDQH$,,AUTO
         2 001004   200060 450500                    STP0    @IP$+1,,AUTO
         2 001005   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001006   000023 036003                    ADLQ    19,DU
         2 001007   200057 756100                    STQ     @BUF$+1,,AUTO
         2 001010   002542 701000 2                  TSX1    CVTPTR
         2 001011   000000 011000                    NOP     0

      348     2070                    %IF  DEBUG ;
      349     2071    3               IF  RVF_DEBUG ~= 0

   2071  2 001012   000000 235000 xsym               LDA     RVF_DEBUG
         2 001013   001027 600000 2                  TZE     s:2077
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:60   

      350     2072    4               THEN DO ;

      351     2073    4                   CALL BINOCTAL   ( MSG_DQH.IO$, DQH.IO$ ) ;

   2073  2 001014   200013 236100                    LDQ     CURDQH$,,AUTO
         2 001015   000014 036003                    ADLQ    12,DU
         2 001016   200056 756100                    STQ     @REQ+1,,AUTO
         2 001017   000017 236000 3                  LDQ     15
         2 001020   200055 756100                    STQ     CQ$+1,,AUTO
         2 001021   002507 701000 2                  TSX1    BINOCTAL
         2 001022   000000 011000                    NOP     0

      352     2074    4                   CALL IRR$TYPE6M ( MSG_DQH, SIZEW(MSG_DQH) ) ;

   2074  2 001023   000020 630400 3                  EPPR0   16
         2 001024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001025   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001026   000000 011000                    NOP     0

      353     2075    4                   END ;

      354     2076                    %ENDIF ;
      355     2077    3               CALL CVTPTR ( DQH.IO$,  REQ$    )

   2077  2 001027   200021 630500                    EPPR0   REQ$,,AUTO
         2 001030   200060 450500                    STP0    @IP$+1,,AUTO
         2 001031   200013 236100                    LDQ     CURDQH$,,AUTO
         2 001032   000014 036003                    ADLQ    12,DU
         2 001033   200057 756100                    STQ     @BUF$+1,,AUTO
         2 001034   002542 701000 2                  TSX1    CVTPTR
         2 001035   001042 702000 2                  TSX2    s:2082

      356     2078    4               WHENRETURN DO ;

      357     2079    4                   CALL DISKIO ( REQ ) ;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:61   
   2079  2 001036   200021 236100                    LDQ     REQ$,,AUTO
         2 001037   200051 756100                    STQ     BUF$+1,,AUTO
         2 001040   001430 701000 2                  TSX1    DISKIO
         2 001041   000000 011000                    NOP     0

      358     2080    4                   END ;

      359     2081    3               END ;

      360     2082    2               IF  MIR_FLAG

   2082  2 001042   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 001043   001054 605000 2                  TPL     s:2087
         2 001044   200012 470500                    LDP0    CURDCT$,,AUTO
         2 001045   000006 236100                    LDQ     6,,PR0
         2 001046   000025 772000                    QRL     21
         2 001047   000000 116000 0                  CMPQ    MIRDCTX
         2 001050   001054 602000 2                  TNC     s:2087
         2 001051   001054 600000 2                  TZE     s:2087

      361     2083    2               AND DCT.DCTX > MIRDCTX
      362     2084    2               THEN
      363     2085    2                   DOCVTPTR = '0'B ;

   2085  2 001052   200041 450100                    STZ     DOCVTPTR,,AUTO
         2 001053   001056 710000 2                  TRA     s:2089

      364     2086    2               ELSE
      365     2087    2                   DOCVTPTR = '1'B ;

   2087  2 001054   400000 236003                    LDQ     -131072,DU
         2 001055   200041 756100                    STQ     DOCVTPTR,,AUTO

      366     2088                %IF  DEBUG ;
      367     2089    2           IF  RVF_DEBUG ~= 0

   2089  2 001056   000000 235000 xsym               LDA     RVF_DEBUG
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:62   
         2 001057   001124 600000 2                  TZE     s:2099

      368     2090    3           THEN DO ;

      369     2091    3               CALL BINCHAR    ( MSG_CVT.CVTPTR, BITBIN(DOCVTPTR) ) ;

   2091  2 001060   200041 236100                    LDQ     DOCVTPTR,,AUTO
         2 001061   000043 772000                    QRL     35
         2 001062   000000 235003                    LDA     0,DU
         2 001063   200062 757100                    STAQ    I+1,,AUTO
         2 001064   000000 301500                    BTD
         2 001065   200062 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         2 001066   000041 230001 0                  NDSC9   MSG_CVT+2                cn=1,s=nosgn,sf=0,n=1

      370     2092    3               CALL IRR$TYPE6M ( MSG_CVT, SIZEW(MSG_CVT) ) ;

   2092  2 001067   000022 630400 3                  EPPR0   18
         2 001070   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001071   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001072   000000 011000                    NOP     0

      371     2093    3               CALL BINOCTAL   ( MSG_DCT2.SQ$, DCT.SQ$ ) ;

   2093  2 001073   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001074   000001 036003                    ADLQ    1,DU
         2 001075   200056 756100                    STQ     @REQ+1,,AUTO
         2 001076   000024 236000 3                  LDQ     20
         2 001077   200055 756100                    STQ     CQ$+1,,AUTO
         2 001100   002507 701000 2                  TSX1    BINOCTAL
         2 001101   000000 011000                    NOP     0

      372     2094    3               CALL BINOCTAL   ( MSG_DCT2.BQ$, DCT.DP.BQ$ ) ;

   2094  2 001102   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001103   000030 036003                    ADLQ    24,DU
         2 001104   200056 756100                    STQ     @REQ+1,,AUTO
         2 001105   000025 236000 3                  LDQ     21
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:63   
         2 001106   200055 756100                    STQ     CQ$+1,,AUTO
         2 001107   002507 701000 2                  TSX1    BINOCTAL
         2 001110   000000 011000                    NOP     0

      373     2095    3               CALL BINOCTAL   ( MSG_DCT2.LQ$, DCT.DP.MIRROR.LQ$ ) ;

   2095  2 001111   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001112   000042 036003                    ADLQ    34,DU
         2 001113   200056 756100                    STQ     @REQ+1,,AUTO
         2 001114   000026 236000 3                  LDQ     22
         2 001115   200055 756100                    STQ     CQ$+1,,AUTO
         2 001116   002507 701000 2                  TSX1    BINOCTAL
         2 001117   000000 011000                    NOP     0

      374     2096    3               CALL IRR$TYPE6M ( MSG_DCT2, SIZEW(MSG_DCT2) ) ;

   2096  2 001120   000030 630400 3                  EPPR0   24
         2 001121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001122   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001123   000000 011000                    NOP     0

      375     2097    3               END ;

      376     2098                %ENDIF ;
      377     2099    2           CALL PROCESS_SQ ( DCT.SQ$,    '1'B, DOCVTPTR ) ;

   2099  2 001124   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001125   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001126   000032 236000 3                  LDQ     26
         2 001127   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001130   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001131   000001 036003                    ADLQ    1,DU
         2 001132   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001133   001337 701000 2                  TSX1    PROCESS_SQ
         2 001134   000000 011000                    NOP     0

      378     2100    2           CALL PROCESS_SQ ( DCT.DP.BQ$, '1'B, DOCVTPTR ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:64   

   2100  2 001135   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001136   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001137   000032 236000 3                  LDQ     26
         2 001140   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001141   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001142   000030 036003                    ADLQ    24,DU
         2 001143   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001144   001337 701000 2                  TSX1    PROCESS_SQ
         2 001145   000000 011000                    NOP     0

      379     2101    2           IF  MIR_FLAG

   2101  2 001146   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 001147   001335 605000 2                  TPL     s:2142

      380     2102    3           THEN DO ;

      381     2103    3               CALL PROCESS_SQ ( DCT.DP.MIRROR.LQ$, '1'B, DOCVTPTR ) ;

   2103  2 001150   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001151   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001152   000032 236000 3                  LDQ     26
         2 001153   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001154   200012 236100                    LDQ     CURDCT$,,AUTO
         2 001155   000042 036003                    ADLQ    34,DU
         2 001156   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001157   001337 701000 2                  TSX1    PROCESS_SQ
         2 001160   000000 011000                    NOP     0

      382     2104    3               IF  MIRDCT$->DCT.STATE = %ASSIGNED

   2104  2 001161   000001 470400 0                  LDP0    MIRDCT$
         2 001162   000007 236100                    LDQ     7,,PR0
         2 001163   000077 376007                    ANQ     63,DL
         2 001164   000002 116007                    CMPQ    2,DL
         2 001165   001170 600000 2                  TZE     s:2108
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:65   
         2 001166   000005 116007                    CMPQ    5,DL
         2 001167   001247 601000 2                  TNZ     s:2130

      383     2105    3               OR  MIRDCT$->DCT.STATE = %BUSY
      384     2106    4               THEN DO ;

      385     2107                        %IF  DEBUG ;
      386     2108    4                   IF  RVF_DEBUG ~= 0

   2108  2 001170   000000 235000 xsym               LDA     RVF_DEBUG
         2 001171   001205 600000 2                  TZE     s:2114

      387     2109    5                   THEN DO ;

      388     2110    5                       CALL BINOCTAL   ( MSG_MDCT1.DQH$, MIRDCT$->DCT.DQH$ ) ;

   2110  2 001172   000001 236000 0                  LDQ     MIRDCT$
         2 001173   000023 036003                    ADLQ    19,DU
         2 001174   200056 756100                    STQ     @REQ+1,,AUTO
         2 001175   000033 236000 3                  LDQ     27
         2 001176   200055 756100                    STQ     CQ$+1,,AUTO
         2 001177   002507 701000 2                  TSX1    BINOCTAL
         2 001200   000000 011000                    NOP     0

      389     2111    5                       CALL IRR$TYPE6M ( MSG_MDCT1, SIZEW(MSG_MDCT1) ) ;

   2111  2 001201   000034 630400 3                  EPPR0   28
         2 001202   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001203   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001204   000000 011000                    NOP     0

      390     2112    5                       END ;

      391     2113                        %ENDIF ;
      392     2114    4                   CALL CVTPTR ( MIRDCT$->DCT.DQH$, MIRDQH$ ) ;

   2114  2 001205   000005 236000 3                  LDQ     5
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:66   
         2 001206   200060 756100                    STQ     @IP$+1,,AUTO
         2 001207   000001 236000 0                  LDQ     MIRDCT$
         2 001210   000023 036003                    ADLQ    19,DU
         2 001211   200057 756100                    STQ     @BUF$+1,,AUTO
         2 001212   002542 701000 2                  TSX1    CVTPTR
         2 001213   000000 011000                    NOP     0

      393     2115                        %IF  DEBUG ;
      394     2116    4                   IF  RVF_DEBUG ~= 0

   2116  2 001214   000000 235000 xsym               LDA     RVF_DEBUG
         2 001215   001231 600000 2                  TZE     s:2122

      395     2117    5                   THEN DO ;

      396     2118    5                       CALL BINOCTAL   ( MSG_MDQH.IO$, MIRDCT$->DQH.IO$ ) ;

   2118  2 001216   000001 236000 0                  LDQ     MIRDCT$
         2 001217   000014 036003                    ADLQ    12,DU
         2 001220   200056 756100                    STQ     @REQ+1,,AUTO
         2 001221   000036 236000 3                  LDQ     30
         2 001222   200055 756100                    STQ     CQ$+1,,AUTO
         2 001223   002507 701000 2                  TSX1    BINOCTAL
         2 001224   000000 011000                    NOP     0

      397     2119    5                       CALL IRR$TYPE6M ( MSG_MDQH, SIZEW(MSG_MDQH) ) ;

   2119  2 001225   000037 630400 3                  EPPR0   31
         2 001226   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001227   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001230   000000 011000                    NOP     0

      398     2120    5                       END ;

      399     2121                        %ENDIF ;
      400     2122    4                   CALL CVTPTR ( MIRDQH$->DQH.IO$,  REQ$    )

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:67   
   2122  2 001231   200021 630500                    EPPR0   REQ$,,AUTO
         2 001232   200060 450500                    STP0    @IP$+1,,AUTO
         2 001233   000002 236000 0                  LDQ     MIRDQH$
         2 001234   000014 036003                    ADLQ    12,DU
         2 001235   200057 756100                    STQ     @BUF$+1,,AUTO
         2 001236   002542 701000 2                  TSX1    CVTPTR
         2 001237   001247 702000 2                  TSX2    s:2130

      401     2123    5                   WHENRETURN DO ;

      402     2124    5                       IF  REQ.DOMIR

   2124  2 001240   200021 470500                    LDP0    REQ$,,AUTO
         2 001241   000034 234100                    SZN     28,,PR0
         2 001242   001247 605000 2                  TPL     s:2130

      403     2125    5                       THEN
      404     2126    5                           CALL DISKIO ( REQ ) ;

   2126  2 001243   200021 236100                    LDQ     REQ$,,AUTO
         2 001244   200051 756100                    STQ     BUF$+1,,AUTO
         2 001245   001430 701000 2                  TSX1    DISKIO
         2 001246   000000 011000                    NOP     0

      405     2127    5                       END ;

      406     2128    4                   END ;

      407     2129                    %IF  DEBUG ;
      408     2130    3               IF  RVF_DEBUG ~= 0

   2130  2 001247   000000 235000 xsym               LDA     RVF_DEBUG
         2 001250   001302 600000 2                  TZE     s:2138

      409     2131    4               THEN DO ;

      410     2132    4                   CALL BINOCTAL   ( MSG_MDCT2.SQ$, MIRDCT$->DCT.SQ$ ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:68   

   2132  2 001251   000001 236000 0                  LDQ     MIRDCT$
         2 001252   000001 036003                    ADLQ    1,DU
         2 001253   200056 756100                    STQ     @REQ+1,,AUTO
         2 001254   000041 236000 3                  LDQ     33
         2 001255   200055 756100                    STQ     CQ$+1,,AUTO
         2 001256   002507 701000 2                  TSX1    BINOCTAL
         2 001257   000000 011000                    NOP     0

      411     2133    4                   CALL BINOCTAL   ( MSG_MDCT2.BQ$, MIRDCT$->DCT.DP.BQ$ ) ;

   2133  2 001260   000001 236000 0                  LDQ     MIRDCT$
         2 001261   000030 036003                    ADLQ    24,DU
         2 001262   200056 756100                    STQ     @REQ+1,,AUTO
         2 001263   000042 236000 3                  LDQ     34
         2 001264   200055 756100                    STQ     CQ$+1,,AUTO
         2 001265   002507 701000 2                  TSX1    BINOCTAL
         2 001266   000000 011000                    NOP     0

      412     2134    4                   CALL BINOCTAL   ( MSG_MDCT2.LQ$, MIRDCT$->DCT.DP.MIRROR.LQ$ ) ;

   2134  2 001267   000001 236000 0                  LDQ     MIRDCT$
         2 001270   000042 036003                    ADLQ    34,DU
         2 001271   200056 756100                    STQ     @REQ+1,,AUTO
         2 001272   000043 236000 3                  LDQ     35
         2 001273   200055 756100                    STQ     CQ$+1,,AUTO
         2 001274   002507 701000 2                  TSX1    BINOCTAL
         2 001275   000000 011000                    NOP     0

      413     2135    4                   CALL IRR$TYPE6M ( MSG_MDCT2, SIZEW(MSG_MDCT2) ) ;

   2135  2 001276   000044 630400 3                  EPPR0   36
         2 001277   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001300   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001301   000000 011000                    NOP     0

      414     2136    4                   END ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:69   

      415     2137                    %ENDIF ;
      416     2138    3               CALL PROCESS_SQ ( MIRDCT$->DCT.SQ$,           '0'B, DOCVTPTR ) ;

   2138  2 001302   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001303   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001304   000046 236000 3                  LDQ     38
         2 001305   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001306   000001 236000 0                  LDQ     MIRDCT$
         2 001307   000001 036003                    ADLQ    1,DU
         2 001310   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001311   001337 701000 2                  TSX1    PROCESS_SQ
         2 001312   000000 011000                    NOP     0

      417     2139    3               CALL PROCESS_SQ ( MIRDCT$->DCT.DP.BQ$,        '0'B, DOCVTPTR ) ;

   2139  2 001313   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001314   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001315   000046 236000 3                  LDQ     38
         2 001316   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001317   000001 236000 0                  LDQ     MIRDCT$
         2 001320   000030 036003                    ADLQ    24,DU
         2 001321   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001322   001337 701000 2                  TSX1    PROCESS_SQ
         2 001323   000000 011000                    NOP     0

      418     2140    3               CALL PROCESS_SQ ( MIRDCT$->DCT.DP.MIRROR.LQ$, '0'B, DOCVTPTR ) ;

   2140  2 001324   200041 630500                    EPPR0   DOCVTPTR,,AUTO
         2 001325   200045 450500                    STP0    @DOALWAYS+1,,AUTO
         2 001326   000046 236000 3                  LDQ     38
         2 001327   200044 756100                    STQ     @SQ$+1,,AUTO
         2 001330   000001 236000 0                  LDQ     MIRDCT$
         2 001331   000042 036003                    ADLQ    34,DU
         2 001332   200043 756100                    STQ     DOCVTPTR+2,,AUTO
         2 001333   001337 701000 2                  TSX1    PROCESS_SQ
         2 001334   000000 011000                    NOP     0
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:70   

      419     2141    3               END ;

      420     2142    2           RETURN;

   2142  2 001335   200040 221300                    LDX1  ! SV_MONPT4+2,,AUTO
         2 001336   000001 702211                    TSX2  ! 1,X1

      421     2143        /**/
      422     2144        /**/
      423     2145        /**/
      424     2146    2   PROCESS_SQ:  PROC ( SQ$, DOALWAYS, DOCVTPTR ) ;

   2146  2 001337   200042 741300       PROCESS_SQ   STX1  ! DOCVTPTR+1,,AUTO

      425     2147    3   DCL 1 DOALWAYS  BIT(1) ALIGNED PARAM ;
      426     2148    3   DCL 1 DOCVTPTR  BIT(1) ALIGNED PARAM ;
      427     2149    3   DCL 1 SAVE$     PTR ALIGNED AUTO ;
      428     2150    3   DCL 1 SQ$       PTR ALIGNED PARAM ;
      429     2151        /**/
      430     2152                %IF  DEBUG ;
      431     2153    3           IF  RVF_DEBUG ~= 0

   2153  2 001340   000000 235000 xsym               LDA     RVF_DEBUG
         2 001341   001354 600000 2                  TZE     s:2159

      432     2154    4           THEN DO ;

      433     2155    4               CALL BINOCTAL   ( MSG_PROC.SQ$, SQ$ ) ;

   2155  2 001342   200043 236100                    LDQ     @SQ$,,AUTO
         2 001343   200056 756100                    STQ     @REQ+1,,AUTO
         2 001344   000047 236000 3                  LDQ     39
         2 001345   200055 756100                    STQ     CQ$+1,,AUTO
         2 001346   002507 701000 2                  TSX1    BINOCTAL
         2 001347   000000 011000                    NOP     0

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:71   
      434     2156    4               CALL IRR$TYPE6M ( MSG_PROC, SIZEW(MSG_PROC) ) ;

   2156  2 001350   000050 630400 3                  EPPR0   40
         2 001351   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001352   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001353   000000 011000                    NOP     0

      435     2157    4               END ;

      436     2158                %ENDIF ;
      437     2159    3           SAVE$ = ADDR(NIL) ;

   2159  2 001354   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001355   200046 756100                    STQ     SAVE$,,AUTO

      438     2160    4           DO  FOREVER ;

      439     2161    4               CALL DEQUEUE ( SQ$, REQ$, DOCVTPTR ) ALTRET ( END_SQ ) ;

   2161  2 001356   200045 236100                    LDQ     @DOCVTPTR,,AUTO
         2 001357   200053 756100                    STQ     @P$+1,,AUTO
         2 001360   200021 630500                    EPPR0   REQ$,,AUTO
         2 001361   200052 450500                    STP0    @Q$+1,,AUTO
         2 001362   200043 236100                    LDQ     @SQ$,,AUTO
         2 001363   200051 756100                    STQ     BUF$+1,,AUTO
         2 001364   002406 701000 2                  TSX1    DEQUEUE
         2 001365   001423 702000 2                  TSX2    END_SQ

      440     2162                    %IF  DEBUG ;
      441     2163    4               IF  RVF_DEBUG ~= 0

   2163  2 001366   000000 235000 xsym               LDA     RVF_DEBUG
         2 001367   001402 600000 2                  TZE     s:2169

      442     2164    5               THEN DO ;

      443     2165    5                   CALL BINOCTAL   ( MSG_PROC.SQ$, SQ$ ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:72   

   2165  2 001370   200043 236100                    LDQ     @SQ$,,AUTO
         2 001371   200056 756100                    STQ     @REQ+1,,AUTO
         2 001372   000047 236000 3                  LDQ     39
         2 001373   200055 756100                    STQ     CQ$+1,,AUTO
         2 001374   002507 701000 2                  TSX1    BINOCTAL
         2 001375   000000 011000                    NOP     0

      444     2166    5                   CALL IRR$TYPE6M ( MSG_PROC, SIZEW(MSG_PROC) ) ;

   2166  2 001376   000050 630400 3                  EPPR0   40
         2 001377   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001400   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001401   000000 011000                    NOP     0

      445     2167    5                   END ;

      446     2168                    %ENDIF ;
      447     2169    4               IF  DOALWAYS

   2169  2 001402   200044 470500                    LDP0    @DOALWAYS,,AUTO
         2 001403   000000 234100                    SZN     0,,PR0
         2 001404   001410 604000 2                  TMI     s:2172
         2 001405   200021 471500                    LDP1    REQ$,,AUTO
         2 001406   100034 234100                    SZN     28,,PR1
         2 001407   001414 605000 2                  TPL     s:2173

      448     2170    4               OR  REQ.DOMIR
      449     2171    4               THEN
      450     2172    4                   CALL DISKIO ( REQ ) ;

   2172  2 001410   200021 236100                    LDQ     REQ$,,AUTO
         2 001411   200051 756100                    STQ     BUF$+1,,AUTO
         2 001412   001430 701000 2                  TSX1    DISKIO
         2 001413   000000 011000                    NOP     0

      451     2173    4               CALL ENQUEUE ( SAVE$, REQ$ ) ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:73   

   2173  2 001414   200021 630500                    EPPR0   REQ$,,AUTO
         2 001415   200052 450500                    STP0    @Q$+1,,AUTO
         2 001416   200046 631500                    EPPR1   SAVE$,,AUTO
         2 001417   200051 451500                    STP1    BUF$+1,,AUTO
         2 001420   002461 701000 2                  TSX1    ENQUEUE
         2 001421   000000 011000                    NOP     0

      452     2174    4               END ;

   2174  2 001422   001356 710000 2                  TRA     s:2161

      453     2175    3   END_SQ: SQ$ = SAVE$ ;

   2175  2 001423   200046 236100       END_SQ       LDQ     SAVE$,,AUTO
         2 001424   200043 470500                    LDP0    @SQ$,,AUTO
         2 001425   000000 756100                    STQ     0,,PR0

      454     2176    3           RETURN ;

   2176  2 001426   200042 221300                    LDX1  ! DOCVTPTR+1,,AUTO
         2 001427   000001 702211                    TSX2  ! 1,X1

      455     2177    3   END PROCESS_SQ;
      456     2178        /**/
      457     2179        /**/
      458     2180        /**/
      459     2181    2   DISKIO: PROC(REQ);

   2181  2 001430   200050 741300       DISKIO       STX1  ! @REQ+1,,AUTO

      460     2182        %N$REQ  (NAME=REQ,STCLASS="");
      461     2240    3   DCL BUF$ PTR;
      462     2241        /**/
      463     2242                %IF  DEBUG ;
      464     2243    3           IF  RVF_DEBUG ~= 0

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:74   
   2243  2 001431   000000 235000 xsym               LDA     RVF_DEBUG
         2 001432   001456 600000 2                  TZE     s:2250

      465     2244    4           THEN DO ;

      466     2245    4               CALL BINOCTAL   ( MSG_DISK.REQ$, ADDR(REQ) ) ;

   2245  2 001433   200051 236100                    LDQ     @REQ,,AUTO
         2 001434   200102 756100                    STQ     I+17,,AUTO
         2 001435   200102 630500                    EPPR0   I+17,,AUTO
         2 001436   200056 450500                    STP0    @REQ+1,,AUTO
         2 001437   000052 236000 3                  LDQ     42
         2 001440   200055 756100                    STQ     CQ$+1,,AUTO
         2 001441   002507 701000 2                  TSX1    BINOCTAL
         2 001442   000000 011000                    NOP     0

      467     2246    4               CALL BINOCTAL   ( MSG_DISK.DLA,  REQ.DLA ) ;

   2246  2 001443   200051 236100                    LDQ     @REQ,,AUTO
         2 001444   000001 036003                    ADLQ    1,DU
         2 001445   200056 756100                    STQ     @REQ+1,,AUTO
         2 001446   000053 236000 3                  LDQ     43
         2 001447   200055 756100                    STQ     CQ$+1,,AUTO
         2 001450   002507 701000 2                  TSX1    BINOCTAL
         2 001451   000000 011000                    NOP     0

      468     2247    4               CALL IRR$TYPE6M ( MSG_DISK, SIZEW(MSG_DISK) ) ;

   2247  2 001452   000055 630400 3                  EPPR0   45
         2 001453   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001454   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001455   000000 011000                    NOP     0

      469     2248    4               END ;

      470     2249                %ENDIF ;
      471     2250    3           CALL GET_BUF(REQ,BUF$);
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:75   

   2250  2 001456   200052 630500                    EPPR0   BUF$,,AUTO
         2 001457   200056 450500                    STP0    @REQ+1,,AUTO
         2 001460   200051 236100                    LDQ     @REQ,,AUTO
         2 001461   200055 756100                    STQ     CQ$+1,,AUTO
         2 001462   002601 701000 2                  TSX1    GET_BUF
         2 001463   000000 011000                    NOP     0

      472     2251                %IF  DEBUG ;
      473     2252    3           IF  RVF_DEBUG ~= 0

   2252  2 001464   000000 235000 xsym               LDA     RVF_DEBUG
         2 001465   001514 600000 2                  TZE     s:2260

      474     2253    4           THEN DO ;

      475     2254    4               CALL BINOCTAL   ( MSG_BUF.BUF$,  BUF$ ) ;

   2254  2 001466   200052 630500                    EPPR0   BUF$,,AUTO
         2 001467   200056 450500                    STP0    @REQ+1,,AUTO
         2 001470   000057 236000 3                  LDQ     47
         2 001471   200055 756100                    STQ     CQ$+1,,AUTO
         2 001472   002507 701000 2                  TSX1    BINOCTAL
         2 001473   000000 011000                    NOP     0

      476     2255    4               CALL BINOCTAL   ( MSG_BUF.DESC1, DESCRV4 ) ;

   2255  2 001474   000060 236000 3                  LDQ     48
         2 001475   200056 756100                    STQ     @REQ+1,,AUTO
         2 001476   000061 236000 3                  LDQ     49
         2 001477   200055 756100                    STQ     CQ$+1,,AUTO
         2 001500   002507 701000 2                  TSX1    BINOCTAL
         2 001501   000000 011000                    NOP     0

      477     2256    4               CALL BINOCTAL   ( MSG_BUF.DESC2, PINCRW(ADDR(DESCRV4),1)->PTR$ ) ;

   2256  2 001502   000062 236000 3                  LDQ     50
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:76   
         2 001503   200056 756100                    STQ     @REQ+1,,AUTO
         2 001504   000063 236000 3                  LDQ     51
         2 001505   200055 756100                    STQ     CQ$+1,,AUTO
         2 001506   002507 701000 2                  TSX1    BINOCTAL
         2 001507   000000 011000                    NOP     0

      478     2257    4               CALL IRR$TYPE6M ( MSG_BUF, SIZEW(MSG_BUF) ) ;

   2257  2 001510   000065 630400 3                  EPPR0   53
         2 001511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001512   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001513   000000 011000                    NOP     0

      479     2258    4               END ;

      480     2259                %ENDIF ;
      481     2260    3           GRAN#=REQ.DLA.DRELADDR;

   2260  2 001514   200051 470500                    LDP0    @REQ,,AUTO
         2 001515   000001 236100                    LDQ     1,,PR0
         2 001516   000067 376000 3                  ANQ     55
         2 001517   200026 756100                    STQ     GRAN#,,AUTO

      482     2261    3           BUFSIZE=REQ.BUFSIZE;

   2261  2 001520   000004 236100                    LDQ     4,,PR0
         2 001521   000020 772000                    QRL     16
         2 001522   200033 756100                    STQ     BUFSIZE,,AUTO

      483     2262    4           DO CASE(REQ.FC);

   2262  2 001523   000003 720100                    LXL0    3,,PR0
         2 001524   000777 360003                    ANX0    511,DU
         2 001525   000014 100003                    CMPX0   12,DU
         2 001526   001530 602010 2                  TNC     s:2262+5,X0
         2 001527   002027 710000 2                  TRA     s:2339
         2 001530   002027 710000 2                  TRA     s:2339
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:77   
         2 001531   002027 710000 2                  TRA     s:2339
         2 001532   002027 710000 2                  TRA     s:2339
         2 001533   001544 710000 2                  TRA     s:2264
         2 001534   002027 710000 2                  TRA     s:2339
         2 001535   002027 710000 2                  TRA     s:2339
         2 001536   002027 710000 2                  TRA     s:2339
         2 001537   001544 710000 2                  TRA     s:2264
         2 001540   002027 710000 2                  TRA     s:2339
         2 001541   002027 710000 2                  TRA     s:2339
         2 001542   002027 710000 2                  TRA     s:2339
         2 001543   001701 710000 2                  TRA     s:2302

      484     2263    4            CASE(%N_WRBIN,%N_WRCMP);

      485     2264    5              DO WHILE(BUFSIZE>0);

   2264  2 001544   000000 116003                    CMPQ    0,DU
         2 001545   002027 604400 2                  TMOZ    s:2339

      486     2265    5                 IF BUFSIZE>4096 THEN ARS=4096;

   2265  2 001546   200033 235100                    LDA     BUFSIZE,,AUTO
         2 001547   010000 115007                    CMPA    4096,DL
         2 001550   001554 604400 2                  TMOZ    s:2266

   2265  2 001551   010000 236007                    LDQ     4096,DL
         2 001552   200034 756100                    STQ     ARS,,AUTO
         2 001553   001555 710000 2                  TRA     s:2267

      487     2266    5                 ELSE ARS=BUFSIZE;

   2266  2 001554   200034 755100                    STA     ARS,,AUTO

      488     2267    5                 POBUF=BUF$->BUFFER;

   2267  2 001555   200052 470500                    LDP0    BUF$,,AUTO
         2 001556   200034 720100                    LXL0    ARS,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:78   
         2 001557   010000 221003                    LDX1    4096,DU
         2 001560   040040 100540                    MLR     fill='040'O
         2 001561   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001562   000000 000011 xsym               ADSC9   POBUF                    cn=0,n=*X1

      489     2268    5                 IF  ( NOT MIR_FLAG )

   2268  2 001563   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 001564   001572 605000 2                  TPL     s:2272
         2 001565   001667 605000 2                  TPL     s:2297
         2 001566   200012 471500                    LDP1    CURDCT$,,AUTO
         2 001567   100036 236100                    LDQ     30,,PR1
         2 001570   007700 316003                    CANQ    4032,DU
         2 001571   001667 601000 2                  TNZ     s:2297

      490     2269    5                 OR  ( MIR_FLAG AND DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER )
      491     2270    6                 THEN DO ;

      492     2271                          %IF  DEBUG ;
      493     2272    6                     IF  RVF_DEBUG ~= 0

   2272  2 001572   000000 236000 xsym               LDQ     RVF_DEBUG
         2 001573   001614 600000 2                  TZE     s:2281

      494     2273    7                     THEN DO ;

      495     2274    7                         CALL BINCHAR    ( MSG_MINI.I     , IOM# ) ;

   2274  2 001574   000000 301500                    BTD
         2 001575   200023 000004                    NDSC9   IOM#,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001576   000163 030001 0                  NDSC9   MSG_MINI+3               cn=0,s=nosgn,sf=0,n=1

      496     2275    7                         CALL BINCHAR    ( MSG_MINI.CCC   , CHAN# ) ;

   2275  2 001577   000000 301500                    BTD
         2 001600   200024 000004                    NDSC9   CHAN#,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 001601   000163 430003 0                  NDSC9   MSG_MINI+3               cn=2,s=nosgn,sf=0,n=3
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:79   

      497     2276    7                         CALL BINCHAR    ( MSG_MINI.DD    , DEV# ) ;

   2276  2 001602   000000 301500                    BTD
         2 001603   200025 000004                    NDSC9   DEV#,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001604   000164 430002 0                  NDSC9   MSG_MINI+4               cn=2,s=nosgn,sf=0,n=2

      498     2277    7                         CALL BINCHAR    ( MSG_MINI.GRAN# , GRAN# ) ;

   2277  2 001605   000000 301500                    BTD
         2 001606   200026 000004                    NDSC9   GRAN#,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 001607   000167 030006 0                  NDSC9   MSG_MINI+7               cn=0,s=nosgn,sf=0,n=6

      499     2278    7                         CALL IRR$TYPE6M ( MSG_MINI, SIZEW(MSG_MINI) ) ;

   2278  2 001610   000070 630400 3                  EPPR0   56
         2 001611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001612   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001613   000000 011000                    NOP     0

      500     2279    7                         END ;

      501     2280                          %ENDIF ;
      502     2281    6                     CALL IRN$MINIQ ( IOM#, CHAN#, DEV#, GRAN#, NSPG#, ARS, DISK_WRITE
              2281                              )

   2281  2 001614   000072 236000 3                  LDQ     58
         2 001615   200070 756100                    STQ     I+7,,AUTO
         2 001616   200034 630500                    EPPR0   ARS,,AUTO
         2 001617   200067 450500                    STP0    I+6,,AUTO
         2 001620   200027 631500                    EPPR1   NSPG#,,AUTO
         2 001621   200066 451500                    STP1    I+5,,AUTO
         2 001622   200026 633500                    EPPR3   GRAN#,,AUTO
         2 001623   200065 453500                    STP3    I+4,,AUTO
         2 001624   200025 634500                    EPPR4   DEV#,,AUTO
         2 001625   200064 454500                    STP4    I+3,,AUTO
         2 001626   200024 635500                    EPPR5   CHAN#,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:80   
         2 001627   200063 455500                    STP5    I+2,,AUTO
         2 001630   200023 636500                    EPPR6   IOM#,,AUTO
         2 001631   200062 456500                    STP6    I+1,,AUTO
         2 001632   200062 630500                    EPPR0   I+1,,AUTO
         2 001633   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 001634   000000 701000 xent               TSX1    IRN$MINIQ
         2 001635   001637 702000 2                  TSX2    s:2283
         2 001636   001667 710000 2                  TRA     s:2297

      503     2282    7                     WHENALTRETURN DO ;

      504     2283    7                         MSG_IOERR.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;

   2283  2 001637   200012 470500                    LDP0    CURDCT$,,AUTO
         2 001640   000002 236100                    LDQ     2,,PR0
         2 001641   000004 756000 0                  STQ     MSG_IOERR

      505     2284    7                         CALL IRR$TYPE6 ( MSG_IOERR, SIZEW(MSG_IOERR) ) ;

   2284  2 001642   000073 630400 3                  EPPR0   59
         2 001643   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001644   000000 701000 xent               TSX1    IRR$TYPE6
         2 001645   000000 011000                    NOP     0

      506     2285    7                         IF  MIR_FLAG

   2285  2 001646   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 001647   001667 605000 2                  TPL     s:2297
         2 001650   000001 470400 0                  LDP0    MIRDCT$
         2 001651   000036 236100                    LDQ     30,,PR0
         2 001652   007700 316003                    CANQ    4032,DU
         2 001653   001667 601000 2                  TNZ     s:2297

      507     2286    7                         AND MIRDCT$->DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER
      508     2287    8                         THEN DO ;

      509     2288    8                             DCT.DP.MIRROR.STATE = %NI_MIRROR_FAIL ;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:81   

   2288  2 001654   200012 471500                    LDP1    CURDCT$,,AUTO
         2 001655   000100 236003                    LDQ     64,DU
         2 001656   100036 752120                    STCQ    30,'20'O,PR1

      510     2289    8                             DCT.STATUS.DOWN     = '1'B ;

   2289  2 001657   400000 236003                    LDQ     -131072,DU
         2 001660   100027 256100                    ORSQ    23,,PR1

      511     2290    8                             MSG_PART.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;

   2290  2 001661   100002 236100                    LDQ     2,,PR1
         2 001662   000017 756000 0                  STQ     MSG_PART

      512     2291    8                             CALL IRR$TYPE6 ( MSG_PART, SIZEW(MSG_PART) ) ;

   2291  2 001663   000075 630400 3                  EPPR0   61
         2 001664   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001665   000000 701000 xent               TSX1    IRR$TYPE6
         2 001666   000000 011000                    NOP     0

      513     2292    8                             END ;

      514     2293    7                         ELSE
      515     2294    7                             ;
      516     2295    7                         END ;

      517     2296    6                     END ;

      518     2297    5                 BUF$=PINCRC(BUF$,ARS);

   2297  2 001667   200034 236100                    LDQ     ARS,,AUTO
         2 001670   000020 736000                    QLS     16
         2 001671   200052 036100                    ADLQ    BUF$,,AUTO
         2 001672   200052 756100                    STQ     BUF$,,AUTO

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:82   
      519     2298    5                 GRAN#=GRAN#+1;

   2298  2 001673   200026 054100                    AOS     GRAN#,,AUTO

      520     2299    5                 BUFSIZE=BUFSIZE-ARS;

   2299  2 001674   200033 236100                    LDQ     BUFSIZE,,AUTO
         2 001675   200034 136100                    SBLQ    ARS,,AUTO
         2 001676   200033 756100                    STQ     BUFSIZE,,AUTO

      521     2300    5                 END;

   2300  2 001677   001546 605400 2                  TPNZ    s:2265
         2 001700   002027 710000 2                  TRA     s:2339

      522     2301    4            CASE(%N_WRZERO);

      523     2302    4              POBUFA='0'B;

   2302  2 001701   010000 221003                    LDX1    4096,DU
         2 001702   000040 100400                    MLR     fill='000'O
         2 001703   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001704   000000 000011 xsym               ADSC9   POBUF                    cn=0,n=*X1

      524     2303    5              DO WHILE(BUFSIZE>0);

   2303  2 001705   000000 116003                    CMPQ    0,DU
         2 001706   002027 604400 2                  TMOZ    s:2339

      525     2304    5                 IF BUFSIZE>4096 THEN ARS=4096;

   2304  2 001707   200033 235100                    LDA     BUFSIZE,,AUTO
         2 001710   010000 115007                    CMPA    4096,DL
         2 001711   001715 604400 2                  TMOZ    s:2305

   2304  2 001712   010000 236007                    LDQ     4096,DL
         2 001713   200034 756100                    STQ     ARS,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:83   
         2 001714   001716 710000 2                  TRA     s:2306

      526     2305    5                 ELSE ARS=BUFSIZE;

   2305  2 001715   200034 755100                    STA     ARS,,AUTO

      527     2306    5                 IF  ( NOT MIR_FLAG )

   2306  2 001716   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 001717   001725 605000 2                  TPL     s:2310
         2 001720   002022 605000 2                  TPL     s:2335
         2 001721   200012 470500                    LDP0    CURDCT$,,AUTO
         2 001722   000036 236100                    LDQ     30,,PR0
         2 001723   007700 316003                    CANQ    4032,DU
         2 001724   002022 601000 2                  TNZ     s:2335

      528     2307    5                 OR  ( MIR_FLAG AND DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER )
      529     2308    6                 THEN DO ;

      530     2309                          %IF  DEBUG ;
      531     2310    6                     IF  RVF_DEBUG ~= 0

   2310  2 001725   000000 236000 xsym               LDQ     RVF_DEBUG
         2 001726   001747 600000 2                  TZE     s:2319

      532     2311    7                     THEN DO ;

      533     2312    7                         CALL BINCHAR    ( MSG_MINI.I     , IOM# ) ;

   2312  2 001727   000000 301500                    BTD
         2 001730   200023 000004                    NDSC9   IOM#,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001731   000163 030001 0                  NDSC9   MSG_MINI+3               cn=0,s=nosgn,sf=0,n=1

      534     2313    7                         CALL BINCHAR    ( MSG_MINI.CCC   , CHAN# ) ;

   2313  2 001732   000000 301500                    BTD
         2 001733   200024 000004                    NDSC9   CHAN#,,AUTO              cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:84   
         2 001734   000163 430003 0                  NDSC9   MSG_MINI+3               cn=2,s=nosgn,sf=0,n=3

      535     2314    7                         CALL BINCHAR    ( MSG_MINI.DD    , DEV# ) ;

   2314  2 001735   000000 301500                    BTD
         2 001736   200025 000004                    NDSC9   DEV#,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001737   000164 430002 0                  NDSC9   MSG_MINI+4               cn=2,s=nosgn,sf=0,n=2

      536     2315    7                         CALL BINCHAR    ( MSG_MINI.GRAN# , GRAN# ) ;

   2315  2 001740   000000 301500                    BTD
         2 001741   200026 000004                    NDSC9   GRAN#,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         2 001742   000167 030006 0                  NDSC9   MSG_MINI+7               cn=0,s=nosgn,sf=0,n=6

      537     2316    7                         CALL IRR$TYPE6M ( MSG_MINI, SIZEW(MSG_MINI) ) ;

   2316  2 001743   000070 630400 3                  EPPR0   56
         2 001744   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001745   000000 701000 xent               TSX1    IRR$TYPE6M
         2 001746   000000 011000                    NOP     0

      538     2317    7                         END ;

      539     2318                          %ENDIF ;
      540     2319    6                     CALL IRN$MINIQ ( IOM#, CHAN#, DEV#, GRAN#, NSPG#, ARS, DISK_WRITE
              2319                              )

   2319  2 001747   000072 236000 3                  LDQ     58
         2 001750   200070 756100                    STQ     I+7,,AUTO
         2 001751   200034 630500                    EPPR0   ARS,,AUTO
         2 001752   200067 450500                    STP0    I+6,,AUTO
         2 001753   200027 631500                    EPPR1   NSPG#,,AUTO
         2 001754   200066 451500                    STP1    I+5,,AUTO
         2 001755   200026 633500                    EPPR3   GRAN#,,AUTO
         2 001756   200065 453500                    STP3    I+4,,AUTO
         2 001757   200025 634500                    EPPR4   DEV#,,AUTO
         2 001760   200064 454500                    STP4    I+3,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:85   
         2 001761   200024 635500                    EPPR5   CHAN#,,AUTO
         2 001762   200063 455500                    STP5    I+2,,AUTO
         2 001763   200023 636500                    EPPR6   IOM#,,AUTO
         2 001764   200062 456500                    STP6    I+1,,AUTO
         2 001765   200062 630500                    EPPR0   I+1,,AUTO
         2 001766   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 001767   000000 701000 xent               TSX1    IRN$MINIQ
         2 001770   001772 702000 2                  TSX2    s:2321
         2 001771   002022 710000 2                  TRA     s:2335

      541     2320    7                     WHENALTRETURN DO ;

      542     2321    7                         MSG_IOERR.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;

   2321  2 001772   200012 470500                    LDP0    CURDCT$,,AUTO
         2 001773   000002 236100                    LDQ     2,,PR0
         2 001774   000004 756000 0                  STQ     MSG_IOERR

      543     2322    7                         CALL IRR$TYPE6 ( MSG_IOERR, SIZEW(MSG_IOERR) ) ;

   2322  2 001775   000073 630400 3                  EPPR0   59
         2 001776   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001777   000000 701000 xent               TSX1    IRR$TYPE6
         2 002000   000000 011000                    NOP     0

      544     2323    7                         IF  MIR_FLAG

   2323  2 002001   200030 234100                    SZN     MIR_FLAG,,AUTO
         2 002002   002022 605000 2                  TPL     s:2335
         2 002003   000001 470400 0                  LDP0    MIRDCT$
         2 002004   000036 236100                    LDQ     30,,PR0
         2 002005   007700 316003                    CANQ    4032,DU
         2 002006   002022 601000 2                  TNZ     s:2335

      545     2324    7                         AND MIRDCT$->DCT.DP.MIRROR.STATE = %NI_MIRROR_OPER
      546     2325    8                         THEN DO ;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:86   
      547     2326    8                             DCT.DP.MIRROR.STATE = %NI_MIRROR_FAIL ;

   2326  2 002007   200012 471500                    LDP1    CURDCT$,,AUTO
         2 002010   000100 236003                    LDQ     64,DU
         2 002011   100036 752120                    STCQ    30,'20'O,PR1

      548     2327    8                             DCT.STATUS.DOWN     = '1'B ;

   2327  2 002012   400000 236003                    LDQ     -131072,DU
         2 002013   100027 256100                    ORSQ    23,,PR1

      549     2328    8                             MSG_PART.NAME = SUBSTR ( DCT.DEVNM, 0, 4 ) ;

   2328  2 002014   100002 236100                    LDQ     2,,PR1
         2 002015   000017 756000 0                  STQ     MSG_PART

      550     2329    8                             CALL IRR$TYPE6 ( MSG_PART, SIZEW(MSG_PART) ) ;

   2329  2 002016   000075 630400 3                  EPPR0   61
         2 002017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002020   000000 701000 xent               TSX1    IRR$TYPE6
         2 002021   000000 011000                    NOP     0

      551     2330    8                             END ;

      552     2331    7                         ELSE
      553     2332    7                             ;
      554     2333    7                         END ;

      555     2334    6                     END ;

      556     2335    5                 GRAN#=GRAN#+1;

   2335  2 002022   200026 054100                    AOS     GRAN#,,AUTO

      557     2336    5                 BUFSIZE=BUFSIZE-ARS;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:87   
   2336  2 002023   200033 236100                    LDQ     BUFSIZE,,AUTO
         2 002024   200034 136100                    SBLQ    ARS,,AUTO
         2 002025   200033 756100                    STQ     BUFSIZE,,AUTO

      558     2337    5                 END;

   2337  2 002026   001707 605400 2                  TPNZ    s:2304

      559     2338    4            END;

      560     2339    3           RETURN;

   2339  2 002027   200050 221300                    LDX1  ! @REQ+1,,AUTO
         2 002030   000001 702211                    TSX2  ! 1,X1

      561     2340    3   END DISKIO;
      562     2341    2   END DISK_RUNDOWN;
      563     2342        /**/
      564     2343        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:88   
      565     2344    1   TAPE_RUNDOWN: PROC;

   2344  2 002031   200040 741300       TAPE_RUNDOWN STX1  ! SV_MONPT4+2,,AUTO

      566     2345    3           IF DCT.STATE=%ASSIGNED OR DCT.STATE=%BUSY THEN DO;

   2345  2 002032   200012 470500                    LDP0    CURDCT$,,AUTO
         2 002033   000007 236100                    LDQ     7,,PR0
         2 002034   000077 376007                    ANQ     63,DL
         2 002035   000002 116007                    CMPQ    2,DL
         2 002036   002041 600000 2                  TZE     s:2346
         2 002037   000005 116007                    CMPQ    5,DL
         2 002040   002063 601000 2                  TNZ     FIN_DQH

      567     2346    3              CALL CVTPTR(DCT.DQH$,CURDQH$);

   2346  2 002041   200013 631500                    EPPR1   CURDQH$,,AUTO
         2 002042   200060 451500                    STP1    @IP$+1,,AUTO
         2 002043   200012 236100                    LDQ     CURDCT$,,AUTO
         2 002044   000023 036003                    ADLQ    19,DU
         2 002045   200057 756100                    STQ     @BUF$+1,,AUTO
         2 002046   002542 701000 2                  TSX1    CVTPTR
         2 002047   000000 011000                    NOP     0

      568     2347    3              CALL CVTPTR(DQH.IO$,REQ$) ALTRET(FIN_DQH);

   2347  2 002050   200021 630500                    EPPR0   REQ$,,AUTO
         2 002051   200060 450500                    STP0    @IP$+1,,AUTO
         2 002052   200013 236100                    LDQ     CURDQH$,,AUTO
         2 002053   000014 036003                    ADLQ    12,DU
         2 002054   200057 756100                    STQ     @BUF$+1,,AUTO
         2 002055   002542 701000 2                  TSX1    CVTPTR
         2 002056   002063 702000 2                  TSX2    FIN_DQH

      569     2348    3              CALL TAPEIO(REQ);

   2348  2 002057   200021 236100                    LDQ     REQ$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:89   
         2 002060   200047 756100                    STQ     SAVE$+1,,AUTO
         2 002061   002112 701000 2                  TSX1    TAPEIO
         2 002062   000000 011000                    NOP     0

      570     2349    3              END;

   2345  2 002063                       FIN_DQH      null
      571     2350    2   FIN_DQH:;
      572     2351    2           CALL PROCESS_SQ(DCT.SQ$);

   2351  2 002063   200012 236100                    LDQ     CURDCT$,,AUTO
         2 002064   000001 036003                    ADLQ    1,DU
         2 002065   200043 756100                    STQ     @SQ$,,AUTO
         2 002066   002072 701000 2                  TSX1    PROCESS_SQ
         2 002067   000000 011000                    NOP     0

      573     2352    2           RETURN;

   2352  2 002070   200040 221300                    LDX1  ! SV_MONPT4+2,,AUTO
         2 002071   000001 702211                    TSX2  ! 1,X1

      574     2353        /**/
      575     2354        /**/
      576     2355        /**/
      577     2356    2   PROCESS_SQ: PROC(SQ$);

   2356  2 002072   200042 741300       PROCESS_SQ   STX1  ! DOCVTPTR+1,,AUTO

      578     2357    3   DCL SQ$ PTR;
      579     2358    3   DCL I SBIN;
      580     2359        /**/
      581     2360    4           DO FOREVER;

      582     2361    4              CALL DEQUEUE ( SQ$, REQ$, '1'B ) ALTRET ( END_SQ ) ;

   2361  2 002073   000032 236000 3                  LDQ     26
         2 002074   200053 756100                    STQ     @P$+1,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:90   
         2 002075   200021 630500                    EPPR0   REQ$,,AUTO
         2 002076   200052 450500                    STP0    BUF$,,AUTO
         2 002077   200043 236100                    LDQ     @SQ$,,AUTO
         2 002100   200051 756100                    STQ     @REQ,,AUTO
         2 002101   002406 701000 2                  TSX1    DEQUEUE
         2 002102   002110 702000 2                  TSX2    END_SQ

      583     2362    4              CALL TAPEIO(REQ);

   2362  2 002103   200021 236100                    LDQ     REQ$,,AUTO
         2 002104   200047 756100                    STQ     SAVE$+1,,AUTO
         2 002105   002112 701000 2                  TSX1    TAPEIO
         2 002106   000000 011000                    NOP     0

      584     2363    4              END;

   2363  2 002107   002073 710000 2                  TRA     s:2361

      585     2364    3   END_SQ: RETURN;

   2364  2 002110   200042 221300       END_SQ       LDX1  ! DOCVTPTR+1,,AUTO
         2 002111   000001 702211                    TSX2  ! 1,X1

      586     2365    3   END PROCESS_SQ;
      587     2366        /**/
      588     2367        /**/
      589     2368        /**/
      590     2369    2   TAPEIO: PROC(REQ);

   2369  2 002112   200046 741300       TAPEIO       STX1  ! SAVE$,,AUTO

      591     2370        %N$REQ  (NAME=REQ,STCLASS="");
      592     2428    3   DCL BUF$ PTR;
      593     2429        /**/
      594     2430    3           CALL GET_BUF(REQ,BUF$);

   2430  2 002113   200050 630500                    EPPR0   BUF$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:91   
         2 002114   200056 450500                    STP0    @REQ+1,,AUTO
         2 002115   200047 236100                    LDQ     @REQ,,AUTO
         2 002116   200055 756100                    STQ     CQ$+1,,AUTO
         2 002117   002601 701000 2                  TSX1    GET_BUF
         2 002120   000000 011000                    NOP     0

      595     2431    3           BUFSIZE=REQ.BUFSIZE;

   2431  2 002121   200047 470500                    LDP0    @REQ,,AUTO
         2 002122   000004 236100                    LDQ     4,,PR0
         2 002123   000020 772000                    QRL     16
         2 002124   200033 756100                    STQ     BUFSIZE,,AUTO

      596     2432    4           DO CASE(REQ.FC);

   2432  2 002125   000003 720100                    LXL0    3,,PR0
         2 002126   000777 360003                    ANX0    511,DU
         2 002127   000006 100003                    CMPX0   6,DU
         2 002130   002132 602010 2                  TNC     s:2432+5,X0
         2 002131   002227 710000 2                  TRA     s:2442
         2 002132   002227 710000 2                  TRA     s:2442
         2 002133   002227 710000 2                  TRA     s:2442
         2 002134   002227 710000 2                  TRA     s:2442
         2 002135   002140 710000 2                  TRA     s:2434
         2 002136   002227 710000 2                  TRA     s:2442
         2 002137   002174 710000 2                  TRA     s:2438

      597     2433    4            CASE(%N_WRBIN);

      598     2434    4                 IF BUFSIZE>4096 THEN RETURN;

   2434  2 002140   010000 116007                    CMPQ    4096,DL
         2 002141   002144 604400 2                  TMOZ    s:2435

   2434  2 002142   200046 221300                    LDX1  ! SAVE$,,AUTO
         2 002143   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:92   
      599     2435    4                 POBUF=BUF$->BUFFER;

   2435  2 002144   200050 471500                    LDP1    BUF$,,AUTO
         2 002145   200034 721100                    LXL1    ARS,,AUTO
         2 002146   010000 222003                    LDX2    4096,DU
         2 002147   040040 100540                    MLR     fill='040'O
         2 002150   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         2 002151   000000 000012 xsym               ADSC9   POBUF                    cn=0,n=*X2

      600     2436    4                 CALL IRN$MINIQ(IOM#,CHAN#,DEV#,,,BUFSIZE,TAPE_WRBIN);

   2436  2 002152   000016 236000 3                  LDQ     14
         2 002153   200070 756100                    STQ     I+7,,AUTO
         2 002154   200033 633500                    EPPR3   BUFSIZE,,AUTO
         2 002155   200067 453500                    STP3    I+6,,AUTO
         2 002156   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002157   200066 756100                    STQ     I+5,,AUTO
         2 002160   200065 756100                    STQ     I+4,,AUTO
         2 002161   200025 634500                    EPPR4   DEV#,,AUTO
         2 002162   200064 454500                    STP4    I+3,,AUTO
         2 002163   200024 635500                    EPPR5   CHAN#,,AUTO
         2 002164   200063 455500                    STP5    I+2,,AUTO
         2 002165   200023 636500                    EPPR6   IOM#,,AUTO
         2 002166   200062 456500                    STP6    I+1,,AUTO
         2 002167   200062 630500                    EPPR0   I+1,,AUTO
         2 002170   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002171   000000 701000 xent               TSX1    IRN$MINIQ
         2 002172   000000 011000                    NOP     0
         2 002173   002227 710000 2                  TRA     s:2442

      601     2437    4            CASE(%N_WRASC);

      602     2438    4                 IF BUFSIZE>4096 THEN RETURN;

   2438  2 002174   010000 116007                    CMPQ    4096,DL
         2 002175   002200 604400 2                  TMOZ    s:2439

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:93   
   2438  2 002176   200046 221300                    LDX1  ! SAVE$,,AUTO
         2 002177   000001 702211                    TSX2  ! 1,X1

      603     2439    4                 POBUF=BUF$->BUFFER;

   2439  2 002200   200050 471500                    LDP1    BUF$,,AUTO
         2 002201   200034 721100                    LXL1    ARS,,AUTO
         2 002202   010000 222003                    LDX2    4096,DU
         2 002203   040040 100540                    MLR     fill='040'O
         2 002204   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         2 002205   000000 000012 xsym               ADSC9   POBUF                    cn=0,n=*X2

      604     2440    4                 CALL IRN$MINIQ(IOM#,CHAN#,DEV#,,,BUFSIZE,TAPE_WRASC);

   2440  2 002206   000076 236000 3                  LDQ     62
         2 002207   200070 756100                    STQ     I+7,,AUTO
         2 002210   200033 633500                    EPPR3   BUFSIZE,,AUTO
         2 002211   200067 453500                    STP3    I+6,,AUTO
         2 002212   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002213   200066 756100                    STQ     I+5,,AUTO
         2 002214   200065 756100                    STQ     I+4,,AUTO
         2 002215   200025 634500                    EPPR4   DEV#,,AUTO
         2 002216   200064 454500                    STP4    I+3,,AUTO
         2 002217   200024 635500                    EPPR5   CHAN#,,AUTO
         2 002220   200063 455500                    STP5    I+2,,AUTO
         2 002221   200023 636500                    EPPR6   IOM#,,AUTO
         2 002222   200062 456500                    STP6    I+1,,AUTO
         2 002223   200062 630500                    EPPR0   I+1,,AUTO
         2 002224   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002225   000000 701000 xent               TSX1    IRN$MINIQ
         2 002226   000000 011000                    NOP     0

      605     2441    4            END;

      606     2442    3           RETURN;

   2442  2 002227   200046 221300                    LDX1  ! SAVE$,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:94   
         2 002230   000001 702211                    TSX2  ! 1,X1

      607     2443    3   END TAPEIO;
      608     2444    2   END TAPE_RUNDOWN;
      609     2445        /**/
      610     2446    1   TAPE_DISM: PROC;

   2446  2 002231   200040 741300       TAPE_DISM    STX1  ! SV_MONPT4+2,,AUTO

      611     2447        /**/
      612     2448    2      IF CURDDT$->FT$DDT.FMNEEDED

   2448  2 002232   200022 470500                    LDP0    CURDDT$,,AUTO
         2 002233   000006 236100                    LDQ     6,,PR0
         2 002234   000200 316007                    CANQ    128,DL
         2 002235   002363 600000 2                  TZE     s:2456

      613     2449    3       THEN DO;                            /* Supply file marks        */

      614     2450    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRPER );

   2450  2 002236   000077 236000 3                  LDQ     63
         2 002237   200070 756100                    STQ     I+7,,AUTO
         2 002240   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002241   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002242   200066 757100                    STAQ    I+5,,AUTO
         2 002243   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002244   200065 756100                    STQ     I+4,,AUTO
         2 002245   200025 631500                    EPPR1   DEV#,,AUTO
         2 002246   200064 451500                    STP1    I+3,,AUTO
         2 002247   200024 633500                    EPPR3   CHAN#,,AUTO
         2 002250   200063 453500                    STP3    I+2,,AUTO
         2 002251   200023 634500                    EPPR4   IOM#,,AUTO
         2 002252   200062 454500                    STP4    I+1,,AUTO
         2 002253   200062 630500                    EPPR0   I+1,,AUTO
         2 002254   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002255   000000 701000 xent               TSX1    IRN$MINIQ
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:95   
         2 002256   000000 011000                    NOP     0

      615     2451    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );

   2451  2 002257   000100 236000 3                  LDQ     64
         2 002260   200070 756100                    STQ     I+7,,AUTO
         2 002261   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002262   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002263   200066 757100                    STAQ    I+5,,AUTO
         2 002264   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002265   200065 756100                    STQ     I+4,,AUTO
         2 002266   200025 630500                    EPPR0   DEV#,,AUTO
         2 002267   200064 450500                    STP0    I+3,,AUTO
         2 002270   200024 631500                    EPPR1   CHAN#,,AUTO
         2 002271   200063 451500                    STP1    I+2,,AUTO
         2 002272   200023 633500                    EPPR3   IOM#,,AUTO
         2 002273   200062 453500                    STP3    I+1,,AUTO
         2 002274   200062 630500                    EPPR0   I+1,,AUTO
         2 002275   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002276   000000 701000 xent               TSX1    IRN$MINIQ
         2 002277   000000 011000                    NOP     0

      616     2452    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );

   2452  2 002300   000100 236000 3                  LDQ     64
         2 002301   200070 756100                    STQ     I+7,,AUTO
         2 002302   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002303   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002304   200066 757100                    STAQ    I+5,,AUTO
         2 002305   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002306   200065 756100                    STQ     I+4,,AUTO
         2 002307   200025 630500                    EPPR0   DEV#,,AUTO
         2 002310   200064 450500                    STP0    I+3,,AUTO
         2 002311   200024 631500                    EPPR1   CHAN#,,AUTO
         2 002312   200063 451500                    STP1    I+2,,AUTO
         2 002313   200023 633500                    EPPR3   IOM#,,AUTO
         2 002314   200062 453500                    STP3    I+1,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:96   
         2 002315   200062 630500                    EPPR0   I+1,,AUTO
         2 002316   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002317   000000 701000 xent               TSX1    IRN$MINIQ
         2 002320   000000 011000                    NOP     0

      617     2453    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );

   2453  2 002321   000100 236000 3                  LDQ     64
         2 002322   200070 756100                    STQ     I+7,,AUTO
         2 002323   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002324   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002325   200066 757100                    STAQ    I+5,,AUTO
         2 002326   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002327   200065 756100                    STQ     I+4,,AUTO
         2 002330   200025 630500                    EPPR0   DEV#,,AUTO
         2 002331   200064 450500                    STP0    I+3,,AUTO
         2 002332   200024 631500                    EPPR1   CHAN#,,AUTO
         2 002333   200063 451500                    STP1    I+2,,AUTO
         2 002334   200023 633500                    EPPR3   IOM#,,AUTO
         2 002335   200062 453500                    STP3    I+1,,AUTO
         2 002336   200062 630500                    EPPR0   I+1,,AUTO
         2 002337   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002340   000000 701000 xent               TSX1    IRN$MINIQ
         2 002341   000000 011000                    NOP     0

      618     2454    3         CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_WRFM );

   2454  2 002342   000100 236000 3                  LDQ     64
         2 002343   200070 756100                    STQ     I+7,,AUTO
         2 002344   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002345   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002346   200066 757100                    STAQ    I+5,,AUTO
         2 002347   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002350   200065 756100                    STQ     I+4,,AUTO
         2 002351   200025 630500                    EPPR0   DEV#,,AUTO
         2 002352   200064 450500                    STP0    I+3,,AUTO
         2 002353   200024 631500                    EPPR1   CHAN#,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:97   
         2 002354   200063 451500                    STP1    I+2,,AUTO
         2 002355   200023 633500                    EPPR3   IOM#,,AUTO
         2 002356   200062 453500                    STP3    I+1,,AUTO
         2 002357   200062 630500                    EPPR0   I+1,,AUTO
         2 002360   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002361   000000 701000 xent               TSX1    IRN$MINIQ
         2 002362   000000 011000                    NOP     0

      619     2455    3         END;

      620     2456    2      CALL IRN$MINIQ( IOM#, CHAN#, DEV#, , , , TAPE_UNLOAD );

   2456  2 002363   000023 236000 3                  LDQ     19
         2 002364   200070 756100                    STQ     I+7,,AUTO
         2 002365   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002366   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002367   200066 757100                    STAQ    I+5,,AUTO
         2 002370   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002371   200065 756100                    STQ     I+4,,AUTO
         2 002372   200025 630500                    EPPR0   DEV#,,AUTO
         2 002373   200064 450500                    STP0    I+3,,AUTO
         2 002374   200024 631500                    EPPR1   CHAN#,,AUTO
         2 002375   200063 451500                    STP1    I+2,,AUTO
         2 002376   200023 633500                    EPPR3   IOM#,,AUTO
         2 002377   200062 453500                    STP3    I+1,,AUTO
         2 002400   200062 630500                    EPPR0   I+1,,AUTO
         2 002401   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 002402   000000 701000 xent               TSX1    IRN$MINIQ
         2 002403   000000 011000                    NOP     0

      621     2457    2      RETURN;

   2457  2 002404   200040 221300                    LDX1  ! SV_MONPT4+2,,AUTO
         2 002405   000001 702211                    TSX2  ! 1,X1

      622     2458
      623     2459    2   END TAPE_DISM;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:98   
      624     2460        /**/
      625     2461    1   DEQUEUE:        PROC ( Q$, R$, DOCVTPTR ) ALTRET ;

   2461  2 002406   200050 741300       DEQUEUE      STX1  ! BUF$,,AUTO

      626     2462
      627     2463    2   DCL 1 DOCVTPTR          BIT(1) ALIGNED PARAM ;
      628     2464    2   DCL 1 CQ$               PTR ALIGNED AUTO ;
      629     2465    2   DCL 1 Q$                PTR ALIGNED PARAM ;
      630     2466    2   DCL 1 R$                PTR ALIGNED PARAM ;
      631     2467
      632     2468    2           IF  Q$ = ADDR(NIL)

   2468  2 002407   200051 470500                    LDP0    @Q$,,AUTO
         2 002410   000000 236100                    LDQ     0,,PR0
         2 002411   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002412   002414 601000 2                  TNZ     s:2472

      633     2469    2           THEN
      634     2470    2               ALTRETURN ;

   2470  2 002413   000000 702211                    TSX2  ! 0,X1

      635     2471
      636     2472    2           IF  DOCVTPTR

   2472  2 002414   200053 471500                    LDP1    @DOCVTPTR,,AUTO
         2 002415   100000 234100                    SZN     0,,PR1
         2 002416   002426 605000 2                  TPL     s:2476

      637     2473    2           THEN
      638     2474    2               CALL CVTPTR ( Q$, CQ$ ) ;

   2474  2 002417   200054 633500                    EPPR3   CQ$,,AUTO
         2 002420   200060 453500                    STP3    @IP$+1,,AUTO
         2 002421   200051 236100                    LDQ     @Q$,,AUTO
         2 002422   200057 756100                    STQ     @BUF$+1,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:99   
         2 002423   002542 701000 2                  TSX1    CVTPTR
         2 002424   000000 011000                    NOP     0
         2 002425   002427 710000 2                  TRA     s:2478

      639     2475    2           ELSE
      640     2476    2               CQ$ = Q$ ;

   2476  2 002426   200054 756100                    STQ     CQ$,,AUTO

      641     2477
      642     2478    2           R$ = CQ$->PTR$ ;

   2478  2 002427   200054 470500                    LDP0    CQ$,,AUTO
         2 002430   000000 236100                    LDQ     0,,PR0
         2 002431   200052 471500                    LDP1    @R$,,AUTO
         2 002432   100000 756100                    STQ     0,,PR1

      643     2479    2           IF  DOCVTPTR

   2479  2 002433   200053 470500                    LDP0    @DOCVTPTR,,AUTO
         2 002434   000000 234100                    SZN     0,,PR0
         2 002435   002443 605000 2                  TPL     s:2483

      644     2480    2           THEN
      645     2481    2               CALL CVTPTR ( R$, R$ ) ;

   2481  2 002436   200052 236100                    LDQ     @R$,,AUTO
         2 002437   200060 756100                    STQ     @IP$+1,,AUTO
         2 002440   200057 756100                    STQ     @BUF$+1,,AUTO
         2 002441   002542 701000 2                  TSX1    CVTPTR
         2 002442   000000 011000                    NOP     0

      646     2482
      647     2483    2           IF  R$ = CQ$

   2483  2 002443   200052 470500                    LDP0    @R$,,AUTO
         2 002444   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:100  
         2 002445   200054 116100                    CMPQ    CQ$,,AUTO
         2 002446   002453 601000 2                  TNZ     s:2487

      648     2484    2           THEN
      649     2485    2               Q$ = ADDR(NIL) ;

   2485  2 002447   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002450   200051 471500                    LDP1    @Q$,,AUTO
         2 002451   100000 756100                    STQ     0,,PR1
         2 002452   002457 710000 2                  TRA     s:2489

      650     2486    2           ELSE
      651     2487    2               CQ$->PTR$ = R$->PTR$ ;

   2487  2 002453   000000 471500                    LDP1    0,,PR0
         2 002454   100000 236100                    LDQ     0,,PR1
         2 002455   200054 473500                    LDP3    CQ$,,AUTO
         2 002456   300000 756100                    STQ     0,,PR3

      652     2488
      653     2489    2           RETURN ;

   2489  2 002457   200050 221300                    LDX1  ! BUF$,,AUTO
         2 002460   000001 702211                    TSX2  ! 1,X1

      654     2490
      655     2491    2   END DEQUEUE ;
      656     2492
      657     2493    1   ENQUEUE:        PROC ( Q$, P$ ) ;

   2493  2 002461   200050 741300       ENQUEUE      STX1  ! BUF$,,AUTO

      658     2494
      659     2495    2   DCL 1 P$                PTR ALIGNED PARAM ;
      660     2496    2   DCL 1 Q$                PTR ALIGNED PARAM ;
      661     2497
      662     2498    2           IF  Q$ = ADDR(NIL)
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:101  

   2498  2 002462   200051 470500                    LDP0    @Q$,,AUTO
         2 002463   000000 236100                    LDQ     0,,PR0
         2 002464   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002465   002473 601000 2                  TNZ     s:2503

      663     2499    3           THEN DO ;

      664     2500    3               P$->PTR$ = P$ ;

   2500  2 002466   200052 471500                    LDP1    @P$,,AUTO
         2 002467   100000 473500                    LDP3    0,,PR1
         2 002470   100000 236100                    LDQ     0,,PR1
         2 002471   300000 756100                    STQ     0,,PR3

      665     2501    3               END ;

   2501  2 002472   002503 710000 2                  TRA     s:2507

      666     2502    3           ELSE DO ;

      667     2503    3               P$->PTR$ = Q$->PTR$ ;

   2503  2 002473   200052 471500                    LDP1    @P$,,AUTO
         2 002474   100000 473500                    LDP3    0,,PR1
         2 002475   000000 474500                    LDP4    0,,PR0
         2 002476   400000 236100                    LDQ     0,,PR4
         2 002477   300000 756100                    STQ     0,,PR3

      668     2504    3               Q$->PTR$ = P$ ;

   2504  2 002500   000000 473500                    LDP3    0,,PR0
         2 002501   100000 236100                    LDQ     0,,PR1
         2 002502   300000 756100                    STQ     0,,PR3

      669     2505    3               END ;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:102  
      670     2506
      671     2507    2           Q$ = P$ ;

   2507  2 002503   100000 236100                    LDQ     0,,PR1
         2 002504   000000 756100                    STQ     0,,PR0

      672     2508
      673     2509    2           RETURN ;

   2509  2 002505   200050 221300                    LDX1  ! BUF$,,AUTO
         2 002506   000001 702211                    TSX2  ! 1,X1

      674     2510
      675     2511    2   END ENQUEUE ;
      676     2512
      677     2513        %IF  DEBUG ;
      678     2514    1   BINOCTAL:         PROC ( OCT, BIN ) ;

   2514  2 002507   200054 741300       BINOCTAL     STX1  ! CQ$,,AUTO

      679     2515
      680     2516    2   DCL 1 BIN(0:12) UBIN(3) UNAL PARAM ;
      681     2517    2   DCL 1 I         SBIN WORD ALIGNED AUTO ;
      682     2518    2   DCL 1 OCT(0:12) CHAR(1) CALIGNED PARAM ;
      683     2519
      684     2520    3   DO  I = 0 TO 11 ;

   2520  2 002510   200057 450100                    STZ     I,,AUTO

      685     2521    3       OCT(I)   = BINASC(BIN(I)+48) ;

   2521  2 002511   200057 236100                    LDQ     I,,AUTO
         2 002512   000003 402007                    MPY     3,DL
         2 002513   000000 116003                    CMPQ    0,DU
         2 002514   002516 605000 2                  TPL     s:2521+5
         2 002515   000044 036003                    ADLQ    36,DU
         2 002516   200056 470500                    LDP0    @BIN,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:103  
         2 002517   003100 061506                    CSR     bolr='003'O
         2 002520   000000 000003                    BDSC    0,Q,PR0                  by=0,bit=0,n=3
         2 002521   200062 000044                    BDSC    I+1,,AUTO                by=0,bit=0,n=36
         2 002522   200062 236100                    LDQ     I+1,,AUTO
         2 002523   000060 036007                    ADLQ    48,DL
         2 002524   000033 736000                    QLS     27
         2 002525   000101 276000 3                  ORQ     65
         2 002526   200063 756100                    STQ     I+2,,AUTO
         2 002527   200055 471500                    LDP1    @OCT,,AUTO
         2 002530   200057 235100                    LDA     I,,AUTO
         2 002531   040105 100500                    MLR     fill='040'O
         2 002532   200063 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         2 002533   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      686     2522    3       END ;

   2522  2 002534   200057 054100                    AOS     I,,AUTO
         2 002535   200057 235100                    LDA     I,,AUTO
         2 002536   000013 115007                    CMPA    11,DL
         2 002537   002511 604400 2                  TMOZ    s:2521

      687     2523
      688     2524    2   RETURN ;

   2524  2 002540   200054 221300                    LDX1  ! CQ$,,AUTO
         2 002541   000001 702211                    TSX2  ! 1,X1

      689     2525
      690     2526    2   END BINOCTAL ;
      691     2527        %ENDIF ;
      692     2528        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:104  
      693     2529    1   CVTPTR: PROC(IP$,OP$) ALTRET;

   2529  2 002542   200056 741300       CVTPTR       STX1  ! @BIN,,AUTO

      694     2530    2   DCL 1 IP$ ALIGNED,
      695     2531    2           2 ADR UBIN(24) UNAL,
      696     2532    2           2 SEGID BIT(12) UNAL;
      697     2533    2   DCL 1 OP$ ALIGNED,
      698     2534    2           2 ADR UBIN(24) UNAL,
      699     2535    2           2 SEGID BIT(12) UNAL;
      700     2536    2   DCL OP$$ REDEF OP$ PTR;
      701     2537    2   DCL I SBIN;
      702     2538        %SUB SEGNUM# =10;
      703     2539    2   DCL 1 SEGTAB(0:SEGNUM#) SYMREF ALIGNED,
      704     2540    2           2 MONSID BIT(12) ALIGNED,
      705     2541    2           2 RV$ PTR ;
      706     2542        /**/
      707     2543    3           DO I=0 TO SEGNUM#;

   2543  2 002543   200061 450100                    STZ     I,,AUTO

      708     2544    3              IF IP$.SEGID=SEGTAB.MONSID(I) THEN GOTO FOUNDIT;

   2544  2 002544   200061 236100                    LDQ     I,,AUTO
         2 002545   000014 402007                    MPY     12,DL
         2 002546   000000 116003                    CMPQ    0,DU
         2 002547   002551 605000 2                  TPL     s:2544+5
         2 002550   000006 036003                    ADLQ    6,DU
         2 002551   200057 470500                    LDP0    @IP$,,AUTO
         2 002552   000006 106500                    CMPC    fill='000'O
         2 002553   000000 420002                    ADSC6   0,,PR0                   cn=4,n=2
         2 002554   000000 020002 xsym               ADSC6   SEGTAB,Q                 cn=0,n=2
         2 002555   002567 600000 2                  TZE     FOUNDIT

      709     2545    3              END;

   2545  2 002556   200061 054100                    AOS     I,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:105  
         2 002557   200061 235100                    LDA     I,,AUTO
         2 002560   000012 115007                    CMPA    10,DL
         2 002561   002544 604400 2                  TMOZ    s:2544

      710     2546    2           OP$$=ADDR(NIL);

   2546  2 002562   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002563   200060 471500                    LDP1    @OP$,,AUTO
         2 002564   100000 756100                    STQ     0,,PR1

      711     2547    2           ALTRETURN;

   2547  2 002565   200056 221300                    LDX1  ! @BIN,,AUTO
         2 002566   000000 702211                    TSX2  ! 0,X1

   2546  2 002567                       FOUNDIT      null
      712     2548    2   FOUNDIT: ;
      713     2549    2           OP$=IP$;

   2549  2 002567   000000 236100                    LDQ     0,,PR0
         2 002570   200060 471500                    LDP1    @OP$,,AUTO
         2 002571   100000 756100                    STQ     0,,PR1

      714     2550    2           OP$.SEGID=SEGTAB.RV$(I)->P.SEGID;

   2550  2 002572   200061 235100                    LDA     I,,AUTO
         2 002573   000001 735000                    ALS     1
         2 002574   000001 473405 xsym               LDP3    SEGTAB+1,AL
         2 002575   300000 236100                    LDQ     0,,PR3
         2 002576   100000 752103                    STCQ    0,'03'O,PR1

      715     2551    2           RETURN;

   2551  2 002577   200056 221300                    LDX1  ! @BIN,,AUTO
         2 002600   000001 702211                    TSX2  ! 1,X1

      716     2552    2   END CVTPTR;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:106  
      717     2553        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:107  
      718     2554        %EJECT;
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:108  
      719     2555    1   GET_BUF: PROC(REQ,BUF$);

   2555  2 002601   200054 741300       GET_BUF      STX1  ! CQ$,,AUTO

      720     2556        %N$REQ (NAME=REQ,STCLASS="");
      721     2614    2   DCL BUF$ PTR;
      722     2615    2   DCL 1 CONDESC DALIGNED CONSTANT,
      723     2616    2           2 BOUND UBIN(20) UNAL,
      724     2617    2           2 F BIT(3) INIT('111'B),
      725     2618    2           2 WSQ UBIN(9) UNAL INIT(%USERWSQ),
      726     2619    2           2 T UBIN(4) UNAL INIT(2),
      727     2620    2           2 BASE UBIN WORD;
      728     2621    2   DCL 1 DESC DALIGNED,
      729     2622    2           2 BOUND UBIN(20) UNAL,
      730     2623    2           2 F BIT(3),
      731     2624    2           2 WSQ UBIN(9) UNAL,
      732     2625    2           2 T UBIN(4) UNAL,
      733     2626    2           2 BASE UBIN;
      734     2627    2   DCL 1 RDESC DALIGNED CONSTANT,
      735     2628    2           2 BOUND UBIN(20) UNAL INIT(4095),
      736     2629    2           2 F BIT(3) INIT('111'B),
      737     2630    2           2 WSQ UBIN(9) UNAL INIT(0),
      738     2631    2           2 T UBIN(4) UNAL INIT(2),
      739     2632    2           2 BASE UBIN WORD INIT(0);
      740     2633        /**/
      741     2634        /*N*    The following codes looks like an error.  If the IO system
      742     2635                can't get the IOP go to REAL IO above 16MW, then RECOVERY
      743     2636                certainly can't either.  If it was REAL IO converted to
      744     2637                PAGED IO, it should be done as PAGED IO.  This needs to be
      745     2638                checked out on a DPS 90 with > 16MW of memory.  To check this
      746     2639                out, an REQ packet with REQ.IOP.BUFREL_CVRT set must be on
      747     2640                the DQH.IO$, DCT.SQ$, DCT.DP.BQ$, or DCT.DP.MIRROR.LQ$ of
      748     2641                a disk device when a screech is done.  RCVRIO will then
      749     2642                attempt to do the IO.  After the recovery is done, the
      750     2643                contents of the granule written must be checked against what
      751     2644                was in memory at the time of the screech.
      752     2645        *N*/
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:109  
      753     2646    3           IF REQ.IOP_BUFREAL_CVRT THEN DO;

   2646  2 002602   200055 470500                    LDP0    @REQ,,AUTO
         2 002603   000031 236100                    LDQ     25,,PR0
         2 002604   040000 316007                    CANQ    16384,DL
         2 002605   002613 600000 2                  TZE     s:2652

      754     2647                   /* IOP CAN'T DO NON-PAGED IO ADDR > 16MW, CONVERT BACK TO REAL IO */
      755     2648    3              REQ.PTP=0;

   2648  2 002606   000007 450100                    STZ     7,,PR0

      756     2649    3              REQ.BUFADDR=BITBIN(REQ.BUFREAL_SV);

   2649  2 002607   000032 235100                    LDA     26,,PR0
         2 002610   000006 755100                    STA     6,,PR0

      757     2650    3              REQ.IOP_BUFREAL_CVRT='0'B;

   2650  2 002611   000102 236000 3                  LDQ     66
         2 002612   000031 356100                    ANSQ    25,,PR0

      758     2651    3              END;

      759     2652    3           IF REQ.PTP=0 THEN DO;

   2652  2 002613   000007 235100                    LDA     7,,PR0
         2 002614   002634 601000 2                  TNZ     s:2659

      760     2653    3              DESCRV4=RDESC;

   2653  2 002615   000002 237000 1                  LDAQ    RDESC
         2 002616   000000 757000 xsym               STAQ    DESCRV4

      761     2654    3              BUF$=I$RV4$;

   2654  2 002617   000000 236000 xsym               LDQ     I$RV4$
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:110  
         2 002620   200056 471500                    LDP1    @BUF$,,AUTO
         2 002621   100000 756100                    STQ     0,,PR1

      762     2655    3              DESCRV4.BASE=REQ.BUFADDR;

   2655  2 002622   000006 235100                    LDA     6,,PR0
         2 002623   000001 755000 xsym               STA     DESCRV4+1

      763     2656    3              DESCRV4.BOUND=REQ.BUFSIZE-1;

   2656  2 002624   000004 236100                    LDQ     4,,PR0
         2 002625   000020 772000                    QRL     16
         2 002626   000001 136007                    SBLQ    1,DL
         2 002627   000020 736000                    QLS     16
         2 002630   000000 676000 xsym               ERQ     DESCRV4
         2 002631   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002632   000000 656000 xsym               ERSQ    DESCRV4

      764     2657    3              END;

   2657  2 002633   002733 710000 2                  TRA     s:2676

      765     2658    3           ELSE DO;

      766     2659    3              DESC=CONDESC;

   2659  2 002634   000000 237000 1                  LDAQ    CONDESC
         2 002635   200060 757100                    STAQ    DESC,,AUTO

      767     2660    3              DESC.BASE=REQ.BUFVIRT.BASE*8;

   2660  2 002636   000006 236100                    LDQ     6,,PR0
         2 002637   000103 376000 3                  ANQ     67
         2 002640   200061 756100                    STQ     I,,AUTO

      768     2661    3              IF  RPM_FLG

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:111  
   2661  2 002641   000000 234000 xsym               SZN     RPM_FLG
         2 002642   002651 605000 2                  TPL     s:2665

      769     2662    3              THEN
      770     2663        /*             Add in page offset within PTP for IMX.              */
      771     2664    3                  DESC.BASE = DESC.BASE + ( MOD(REQ.PTP,1024) * 4096 ) ;

   2664  2 002643   000007 236100                    LDQ     7,,PR0
         2 002644   002000 506007                    DIV     1024,DL
         2 002645   000044 733000                    LRS     36
         2 002646   000014 736000                    QLS     12
         2 002647   200061 036100                    ADLQ    I,,AUTO
         2 002650   200061 756100                    STQ     I,,AUTO

      772     2665    3              DESC.BOUND=REQ.BUFSIZE+REQ.BUFVIRT.BYT-1;

   2665  2 002651   000006 236100                    LDQ     6,,PR0
         2 002652   000007 376007                    ANQ     7,DL
         2 002653   200062 756100                    STQ     I+1,,AUTO
         2 002654   000004 236100                    LDQ     4,,PR0
         2 002655   000020 772000                    QRL     16
         2 002656   200062 036100                    ADLQ    I+1,,AUTO
         2 002657   000001 136007                    SBLQ    1,DL
         2 002660   000020 736000                    QLS     16
         2 002661   200060 676100                    ERQ     DESC,,AUTO
         2 002662   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002663   200060 656100                    ERSQ    DESC,,AUTO

      773     2666    3              DESC.BOUND=DESC.BOUND+(7-MOD(DESC.BOUND,8));

   2666  2 002664   200060 236100                    LDQ     DESC,,AUTO
         2 002665   000020 772000                    QRL     16
         2 002666   000007 376007                    ANQ     7,DL
         2 002667   200062 756100                    STQ     I+1,,AUTO
         2 002670   200060 236100                    LDQ     DESC,,AUTO
         2 002671   000020 772000                    QRL     16
         2 002672   200062 136100                    SBLQ    I+1,,AUTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:112  
         2 002673   000007 036007                    ADLQ    7,DL
         2 002674   000020 736000                    QLS     16
         2 002675   200060 676100                    ERQ     DESC,,AUTO
         2 002676   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002677   200060 656100                    ERSQ    DESC,,AUTO

      774     2667    3              BUF$=PINCRC(I$RV4$,REQ.BUFVIRT.BYT);

   2667  2 002700   000006 236100                    LDQ     6,,PR0
         2 002701   000007 376007                    ANQ     7,DL
         2 002702   000020 736000                    QLS     16
         2 002703   000000 036000 xsym               ADLQ    I$RV4$
         2 002704   200056 471500                    LDP1    @BUF$,,AUTO
         2 002705   100000 756100                    STQ     0,,PR1

      775     2668    3              DESCRV4=DESC;

   2668  2 002706   200060 237100                    LDAQ    DESC,,AUTO
         2 002707   000000 757000 xsym               STAQ    DESCRV4

      776     2669    3              IF RPM_FLG THEN

   2669  2 002710   000000 234000 xsym               SZN     RPM_FLG
         2 002711   002720 605000 2                  TPL     s:2671

      777     2670    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ) = REQ.PTP/1024;

   2670  2 002712   000007 236100                    LDQ     7,,PR0
         2 002713   002000 506007                    DIV     1024,DL
         2 002714   000000 620006                    EAX0    0,QL
         2 002715   000000 473400 xsym               LDP3    I$MONIS$
         2 002716   300010 740100                    STX0    8,,PR3
         2 002717   002733 710000 2                  TRA     s:2676

      778     2671    3              ELSE IF XA_MODE THEN

   2671  2 002720   000000 234000 xsym               SZN     XA_MODE
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:113  
         2 002721   002730 605000 2                  TPL     s:2674

      779     2672    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ) = REQ.PTP/16;

   2672  2 002722   000007 236100                    LDQ     7,,PR0
         2 002723   000020 506007                    DIV     16,DL
         2 002724   000000 620006                    EAX0    0,QL
         2 002725   000000 473400 xsym               LDP3    I$MONIS$
         2 002726   300010 740100                    STX0    8,,PR3
         2 002727   002733 710000 2                  TRA     s:2676

      780     2673    3              ELSE
      781     2674    3                 I$MONIS$->S$WSPTD.BLKNO(%USERWSQ)=REQ.PTP;

   2674  2 002730   000007 720100                    LXL0    7,,PR0
         2 002731   000000 473400 xsym               LDP3    I$MONIS$
         2 002732   300010 740100                    STX0    8,,PR3

      782     2675    3              END;

      783     2676    2           CALL IRR$MAP;

   2676  2 002733   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002734   000000 701000 xent               TSX1    IRR$MAP
         2 002735   000000 011000                    NOP     0

      784     2677    2           RETURN;

   2677  2 002736   200054 221300                    LDX1  ! CQ$,,AUTO
         2 002737   000001 702211                    TSX2  ! 1,X1

      785     2678    2   END GET_BUF;
      786     2679    1           I$JIT$->B$MAP(4) = SV_MONPT4;

   2679  2 002740   200036 236100                    LDQ     SV_MONPT4,,AUTO
         2 002741   000000 470400 xsym               LDP0    I$JIT$
         2 002742   000004 756100                    STQ     4,,PR0
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:114  

      787     2680    1   END IRN$RCVRIO;

   2680  2 002743   000000 702200 xent               TSX2  ! X66_ARET
      788     2681        %EOD;

PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:115  
--  Include file information  --

   IT_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   FT$DDT.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   S$WSPTD.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure IRN$RCVRIO.
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:116  

 **** Variables and constants ****

  ****  Section 000  Data  IRN$RCVRIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w PTR         r     1 MIRDCT$                    0-0-0/w UBIN        r     1 MIRDCTX
     2-0-0/w PTR         r     1 MIRDQH$                    3-0-0/w PTR         r     1 MIRSQH$
   171-0-0/w STRC(540)   r     1 MSG_BUF                   37-0-0/w STRC(108)   r     1 MSG_CVT
    42-0-0/w STRC(216)   r     1 MSG_DCT1                  56-0-0/w STRC(648)   r     1 MSG_DCT2
    26-0-0/w STRC(324)   r     1 MSG_DCTX                 144-0-0/w STRC(432)   r     1 MSG_DISK
    50-0-0/w STRC(216)   r     1 MSG_DQH                    4-0-0/w STRC(396)   r     1 MSG_IOERR
   100-0-0/w STRC(216)   r     1 MSG_MDCT1                114-0-0/w STRC(648)   r     1 MSG_MDCT2
   106-0-0/w STRC(216)   r     1 MSG_MDQH                 160-0-0/w STRC(324)   r     1 MSG_MINI
    17-0-0/w STRC(252)   r     1 MSG_PART                 136-0-0/w STRC(216)   r     1 MSG_PROC

  ****  Section 001 RoData IRN$RCVRIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 CONDESC                    2-0-0/d STRC(72)    r     1 RDESC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    56-0-0/w PTR         r     1 @BIN                      56-0-0/w PTR         r     1 @BUF$
    44-0-0/w PTR         r     1 @DOALWAYS                 45-0-0/w PTR         r     1 @DOCVTPTR
    53-0-0/w PTR         r     1 @DOCVTPTR                 57-0-0/w PTR         r     1 @IP$
    55-0-0/w PTR         r     1 @OCT                      60-0-0/w PTR         r     1 @OP$
    52-0-0/w PTR         r     1 @P$                       51-0-0/w PTR         r     1 @Q$
    51-0-0/w PTR         r     1 @Q$                       52-0-0/w PTR         r     1 @R$
    51-0-0/w PTR         r     1 @REQ                      47-0-0/w PTR         r     1 @REQ
    55-0-0/w PTR         r     1 @REQ                      43-0-0/w PTR         r     1 @SQ$
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:117  
    43-0-0/w PTR         r     1 @SQ$                      34-0-0/w SBIN        r     1 ARS
    *0-0-0/b UBIN(3)     r     1 BIN(0:12)                 52-0-0/w PTR         r     1 BUF$
    50-0-0/w PTR         r     1 BUF$                      *0-0-0/w PTR         r     1 BUF$
    33-0-0/w SBIN        r     1 BUFSIZE                   24-0-0/w SBIN        r     1 CHAN#
    54-0-0/w PTR         r     1 CQ$                       14-0-0/w PTR         r     1 CURCHT$
    12-0-0/w PTR         r     1 CURDCT$                   22-0-0/w PTR         r     1 CURDDT$
    13-0-0/w PTR         r     1 CURDQH$                   10-0-0/w PTR         r     1 CURDVT$
    16-0-0/w PTR         r     1 CURIOM$                   15-0-0/w PTR         r     1 CURIOM$$
    17-0-0/w PTR         r     1 CURSQH$                   11-0-0/w PTR         r     1 DCT$$
    60-0-0/d STRC(72)    r     1 DESC                      25-0-0/w SBIN        r     1 DEV#
    *0-0-0/w BIT         r     1 DOALWAYS                  41-0-0/w BIT         r     1 DOCVTPTR
    *0-0-0/w BIT         r     1 DOCVTPTR                  *0-0-0/w BIT         r     1 DOCVTPTR
     7-0-0/w PTR         r     1 DVT$$                     26-0-0/w SBIN        r     1 GRAN#
    32-0-0/w SBIN        r     1 I                         57-0-0/w SBIN        r     1 I
    61-0-0/w SBIN        r     1 I                         23-0-0/w SBIN        r     1 IOM#
    *0-0-0/w STRC        r     1 IP$                        4-0-0/w SBIN        r     1 MAXDCT
     5-0-0/w SBIN        r     1 MAXDQH                     6-0-0/w SBIN        r     1 MAXIOM
    30-0-0/w BIT         r     1 MIR_FLAG                  31-0-0/b BIT         r     1 MTUNLOAD
    27-0-0/w SBIN        r     1 NSPG#                     *0-0-0/c CHAR        r     1 OCT(0:12)
    *0-0-0/w STRC        r     1 OP$                       *0-0-0/w PTR         r     1 OP$$
    35-0-0/w PTR         r     1 P$                        *0-0-0/w PTR         r     1 P$
     3-0-0/w PTR         r     1 PART$                     *0-0-0/w PTR         r     1 Q$
    *0-0-0/w PTR         r     1 Q$                        *0-0-0/w PTR         r     1 R$
    *0-0-0/d STRC(1080)  r     1 REQ                       *0-0-0/d STRC(1080)  r     1 REQ
    *0-0-0/d STRC(1080)  r     1 REQ                       21-0-0/w PTR         r     1 REQ$
    46-0-0/w PTR         r     1 SAVE$                     *0-0-0/w PTR         r     1 SQ$
    *0-0-0/w PTR         r     1 SQ$                       36-0-0/b BIT         r     1 SV_MONPT4

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 DESCRV4                    0-0-0/w PTR         r     1 I$JIT$
     0-0-0/w PTR         r     1 I$MONIS$                   0-0-0/w PTR         r     1 I$RV4$
     0-0-0/w STRC(1800)  r     1 IT_PARTITION               0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 NI$CHT$                    0-0-0/w PTR         r     1 NI$DVT$
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:118  
     0-0-0/w PTR         r     1 NI$IOM$                    0-0-0/w SBIN        r     1 NI_IOMS
     0-0-0/w SBIN        r     1 NK_MXLOCAL                 0-0-0/c CHAR(4096)  r     1 POBUF
     0-0-0/c CHAR        r     1 POBUFA(0:4095)             0-0-0/w BIT         r     1 RPM_FLG
     0-0-0/w UBIN        r     1 RVF_DEBUG                  0-0-0/w STRC(72)    r     1 SEGTAB(0:10)
     0-0-0/w BIT         r     1 XA_MODE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 B$MAP(0:1023)              0-0-0/c ACHR        r     1 BUFFER
     0-0-0/w STRC(72)    r     1 CHT(0:0)                   0-0-0/w STRC(1332)  r     1 DCT
     0-0-0/w PTR         r     1 DCT$(0:0)                  0-0-0/w STRC(648)   r     1 DQH
     0-0-0/w STRC(2844)  r     1 DVT                        0-0-0/w STRC(288)   r     1 FT$DDT
     0-0-0/w STRC(252)   r     1 IOM                        0-0-0/w PTR         r     1 IOM$(0:0)
     0-0-0/w STRC(1800)  r     1 IT$PARTITION               0-0-0/w STRC        r     1 P
     0-0-0/w PTR         r     1 PTR$                       0-0-0/d STRC(1080)  r     1 REQ
     0-0-0/w STRC        r     1 S$WSPTD(0:28)              0-0-0/w SBIN        r     1 SBIN36
     0-0-0/w STRC(252)   r     1 SQH


   Procedure IRN$RCVRIO requires 1508 words for executable code.
   Procedure IRN$RCVRIO requires 68 words of local(AUTO) storage.
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:119  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:120  
          MINI XREF LISTING

ARS
      1800**DCL      1801--IMP-SIZ  2265<<ASSIGN   2266<<ASSIGN   2267>>ASSIGN   2281<>CALL     2297>>ASSIGN
      2299>>ASSIGN   2304<<ASSIGN   2305<<ASSIGN   2319<>CALL     2336>>ASSIGN   2435>>ASSIGN   2439>>ASSIGN
B$MAP
      1038**DCL      1937>>ASSIGN   1987<<ASSIGN   1996>>ASSIGN   2679<<ASSIGN
B$MAP.CTRL
      1043**DCL      1938<<ASSIGN   1997<<ASSIGN
B$MAP.SCTRL
      1040**DCL      1041--REDEF
BIN IN PROCEDURE BINOCTAL
      2516**DCL      2514--PROC     2521>>ASSIGN
BINOCTAL
      2514**PROC     2065--CALL     2073--CALL     2093--CALL     2094--CALL     2095--CALL     2110--CALL
      2118--CALL     2132--CALL     2133--CALL     2134--CALL     2155--CALL     2165--CALL     2245--CALL
      2246--CALL     2254--CALL     2255--CALL     2256--CALL
BUF$ IN PROCEDURE DISKIO
      2240**DCL      2250<>CALL     2254<>CALL     2267>>ASSIGN   2297<<ASSIGN   2297>>ASSIGN
BUF$ IN PROCEDURE GET_BUF
      2614**DCL      2555--PROC     2654<<ASSIGN   2667<<ASSIGN
BUF$ IN PROCEDURE TAPEIO
      2428**DCL      2430<>CALL     2435>>ASSIGN   2439>>ASSIGN
BUFFER
      1801**DCL      2267>>ASSIGN   2435>>ASSIGN   2439>>ASSIGN
BUFSIZE
      1799**DCL      2261<<ASSIGN   2264>>DOWHILE  2265>>IF       2266>>ASSIGN   2299<<ASSIGN   2299>>ASSIGN
      2303>>DOWHILE  2304>>IF       2305>>ASSIGN   2336<<ASSIGN   2336>>ASSIGN   2431<<ASSIGN   2434>>IF
      2436<>CALL     2438>>IF       2440<>CALL
CHAN#
      1788**DCL      1971<<ASSIGN   2275>>CALLBLT  2281<>CALL     2313>>CALLBLT  2319<>CALL     2436<>CALL
      2440<>CALL     2450<>CALL     2451<>CALL     2452<>CALL     2453<>CALL     2454<>CALL     2456<>CALL
CHT.DQH$
      1671**DCL      2019>>IF       2020<>CALL
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:121  
CONDESC IN PROCEDURE GET_BUF
      2615**DCL      2659>>ASSIGN
CQ$ IN PROCEDURE DEQUEUE
      2464**DCL      2474<>CALL     2476<<ASSIGN   2478>>ASSIGN   2483>>IF       2487>>ASSIGN
CURCHT$
      1669**DCL      1671--IMP-PTR  2014<>CALL     2015>>CALL     2015<>CALL     2019>>IF       2020>>CALL
CURDCT$
      1595**DCL      1605--IMP-PTR  1941<>CALL     1942>>IF       1943>>CALL     1944>>CALL     1946>>CALL
      1950>>IF       1950>>IF       1954>>ASSIGN   1969>>ASSIGN   1978>>CALL     2001<>CALL     2002>>IF
      2006>>IF       2053>>CALLBLT  2059>>IF       2059>>IF       2065>>CALL     2069>>CALL     2082>>IF
      2093>>CALL     2094>>CALL     2095>>CALL     2099>>CALL     2100>>CALL     2103>>CALL     2268>>IF
      2283>>ASSIGN   2288>>ASSIGN   2289>>ASSIGN   2290>>ASSIGN   2306>>IF       2321>>ASSIGN   2326>>ASSIGN
      2327>>ASSIGN   2328>>ASSIGN   2345>>IF       2345>>IF       2346>>CALL     2351>>CALL
CURDDT$
      1785**DCL      1978<>CALL     2448>>IF
CURDQH$
      1645**DCL      1655--IMP-PTR  1946<>CALL     1948<>CALL     1949>>CALL     1970>>ASSIGN   1971>>ASSIGN
      2020<>CALL     2021>>IF       2025>>IF       2069<>CALL     2073>>CALL     2077>>CALL     2346<>CALL
      2347>>CALL
CURDVT$
      1583**DCL      1585--IMP-PTR  1943<>CALL     1972>>ASSIGN   1973>>DOCASE
CURIOM$
      1677**DCL      1679--IMP-PTR  2034<>CALL     2035>>IF       2039>>IF
CURIOM$$
      1674**DCL      1676--IMP-PTR  2032<>CALL     2034>>CALL
CURSQH$
      1684**DCL      1694--IMP-PTR  1944<>CALL     1945>>IF       1948>>CALL
CVTPTR
      2529**PROC     1932--CALL     1934--CALL     1935--CALL     1936--CALL     1941--CALL     1943--CALL
      1944--CALL     1946--CALL     1948--CALL     1949--CALL     1955--CALL     1956--CALL     1959--CALL
      1961--CALL     1978--CALL     1992--CALL     1994--CALL     1995--CALL     1998--CALL     2001--CALL
      2013--CALL     2014--CALL     2015--CALL     2020--CALL     2032--CALL     2034--CALL     2069--CALL
      2077--CALL     2114--CALL     2122--CALL     2346--CALL     2347--CALL     2474--CALL     2481--CALL
DCT.DCTX
      1606**DCL      2053>>CALLBLT  2082>>IF
DCT.DDT$
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:122  
      1606**DCL      1978<>CALL
DCT.DEVNM
      1605**DCL      2283>>ASSIGN   2290>>ASSIGN   2321>>ASSIGN   2328>>ASSIGN
DCT.DP
      1625**DCL      1632--REDEF    1635--REDEF    1636--REDEF    1638--REDEF    1638--REDEF    1639--REDEF
      1640--REDEF    1640--REDEF
DCT.DP.BQ$
      1625**DCL      2094<>CALL     2100<>CALL     2133<>CALL     2139<>CALL
DCT.DP.MIRROR.DCTX
      1630**DCL      1954>>ASSIGN
DCT.DP.MIRROR.FLAG
      1627**DCL      1950>>IF
DCT.DP.MIRROR.LQ$
      1632**DCL      2095<>CALL     2103<>CALL     2134<>CALL     2140<>CALL
DCT.DP.MIRROR.STATE
      1629**DCL      2268>>IF       2285>>IF       2288<<ASSIGN   2306>>IF       2323>>IF       2326<<ASSIGN
DCT.DQH$
      1621**DCL      1946<>CALL     1959<>CALL     2065<>CALL     2069<>CALL     2110<>CALL     2114<>CALL
      2346<>CALL
DCT.DVN
      1614**DCL      1969>>ASSIGN
DCT.DVT$
      1621**DCL      1943<>CALL
DCT.MPC.IOCHANX
      1633**DCL      1633--REDEF
DCT.SQ$
      1605**DCL      2093<>CALL     2099<>CALL     2132<>CALL     2138<>CALL     2351<>CALL
DCT.SQH$
      1620**DCL      1944<>CALL     1956<>CALL
DCT.STATE
      1615**DCL      2059>>IF       2059>>IF       2104>>IF       2104>>IF       2345>>IF       2345>>IF
DCT.STATUS.DOWN
      1622**DCL      1942>>IF       2289<<ASSIGN   2327<<ASSIGN
DCT.STATUS.MSOS_PART
      1624**DCL      2006>>IF
DCT.STATUS.SYSCON_PART
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:123  
      1623**DCL      2002>>IF
DCT.TYPE
      1615**DCL      1950>>IF
DCT$
      1594**DCL      1940>>IF       1941<>CALL     1955<>CALL     2000>>IF       2001<>CALL
DCT$$
      1593**DCL      1594--IMP-PTR  1935<>CALL     1936>>CALL     1936<>CALL     1940>>IF       1941>>CALL
      1955>>CALL     1994<>CALL     1995>>CALL     1995<>CALL     2000>>IF       2001>>CALL
DEQUEUE
      2461**PROC     2161--CALL     2361--CALL
DESC IN PROCEDURE GET_BUF
      2621**DCL      2659<<ASSIGN   2668>>ASSIGN
DESC.BASE IN PROCEDURE GET_BUF
      2626**DCL      2660<<ASSIGN   2664<<ASSIGN   2664>>ASSIGN
DESC.BOUND IN PROCEDURE GET_BUF
      2622**DCL      2665<<ASSIGN   2666<<ASSIGN   2666>>ASSIGN   2666>>ASSIGN
DESCRV4
      1815**DCL      2255<>CALL     2256--CALL     2653<<ASSIGN   2668<<ASSIGN
DESCRV4.BASE
      1820**DCL      2655<<ASSIGN
DESCRV4.BOUND
      1816**DCL      2656<<ASSIGN
DEV#
      1789**DCL      1969<<ASSIGN   2276>>CALLBLT  2281<>CALL     2314>>CALLBLT  2319<>CALL     2436<>CALL
      2440<>CALL     2450<>CALL     2451<>CALL     2452<>CALL     2453<>CALL     2454<>CALL     2456<>CALL
DISKIO IN PROCEDURE DISK_RUNDOWN
      2181**PROC     2079--CALL     2126--CALL     2172--CALL
DISK_RUNDOWN
      2046**PROC     1976--CALL
DOALWAYS IN PROCEDURE PROCESS_SQ
      2147**DCL      2146--PROC     2169>>IF
DOCVTPTR IN PROCEDURE DEQUEUE
      2463**DCL      2461--PROC     2472>>IF       2479>>IF
DOCVTPTR IN PROCEDURE DISK_RUNDOWN
      2048**DCL      2085<<ASSIGN   2087<<ASSIGN   2091>>CALLBLT  2099<>CALL     2100<>CALL     2103<>CALL
      2138<>CALL     2139<>CALL     2140<>CALL
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:124  
DOCVTPTR IN PROCEDURE PROCESS_SQ
      2148**DCL      2146--PROC     2161<>CALL
DQH.IO$
      1662**DCL      1949<>CALL     2073<>CALL     2077<>CALL     2118<>CALL     2122<>CALL     2347<>CALL
DQH.IOCHAN.CHANNEL
      1658**DCL      1971>>ASSIGN
DQH.IOCHAN.IOM
      1658**DCL      1970>>ASSIGN
DQH.IOCHANX
      1657**DCL      1658--REDEF
DQH.MBX$
      1666**DCL      1667--REDEF
DQH.STATUS.MSOS_PART
      1657**DCL      2025>>IF
DQH.STATUS.SYSCON_PART
      1656**DCL      2021>>IF
DVT.GRANSIZE
      1586**DCL      1972>>ASSIGN
DVT.MPC
      1587**DCL      1588--REDEF
DVT.TYPE
      1585**DCL      1973>>DOCASE
DVT$$
      1581**DCL      1582--IMP-PTR  1934<>CALL
END_SQ IN PROCEDURE PROCESS_SQ
      2364**LABEL    2161--CALLALT  2361--CALLALT
ENQUEUE
      2493**PROC     2173--CALL
FIN_DQH IN PROCEDURE TAPE_RUNDOWN
      2345**LABEL    2347--CALLALT
FOUNDIT IN PROCEDURE CVTPTR
      2546**LABEL    2544--GOTO
FT$DDT.FMNEEDED
      1136**DCL      2448>>IF
GET_BUF
      2555**PROC     2250--CALL     2430--CALL
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:125  
GRAN#
      1790**DCL      2260<<ASSIGN   2277>>CALLBLT  2281<>CALL     2298<<ASSIGN   2298>>ASSIGN   2315>>CALLBLT
      2319<>CALL     2335<<ASSIGN   2335>>ASSIGN
I
      1798**DCL      1939<<DOINDEX  1940>>IF       1941>>CALL     1999<<DOINDEX  2000>>IF       2001>>CALL
      2003>>ASSIGN   2005>>ASSIGN   2007>>ASSIGN   2009>>ASSIGN   2018<<DOINDEX  2019>>IF       2020>>CALL
      2022>>ASSIGN   2024>>ASSIGN   2026>>ASSIGN   2028>>ASSIGN   2033<<DOINDEX  2034>>CALL     2036>>ASSIGN
      2038>>ASSIGN   2040>>ASSIGN   2042>>ASSIGN
I IN PROCEDURE BINOCTAL
      2517**DCL      2520<<DOINDEX  2521>>ASSIGN   2521>>ASSIGN
I IN PROCEDURE CVTPTR
      2537**DCL      2543<<DOINDEX  2544>>IF       2550>>ASSIGN
I$JIT$
      1825**DCL      1937>>ASSIGN   1938>>ASSIGN   1987>>ASSIGN   1996>>ASSIGN   1997>>ASSIGN   2679>>ASSIGN
I$MONIS$
      1824**DCL      2670>>ASSIGN   2672>>ASSIGN   2674>>ASSIGN
I$RV4$
      1822**DCL      2654>>ASSIGN   2667>>ASSIGN
IOM.STATUS.MSOS_PART
      1680**DCL      2039>>IF
IOM.STATUS.SYSCON_PART
      1680**DCL      2035>>IF
IOM#
      1787**DCL      1970<<ASSIGN   2274>>CALLBLT  2281<>CALL     2312>>CALLBLT  2319<>CALL     2436<>CALL
      2440<>CALL     2450<>CALL     2451<>CALL     2452<>CALL     2453<>CALL     2454<>CALL     2456<>CALL
IOM$
      1676**DCL      2034<>CALL
IP$ IN PROCEDURE CVTPTR
      2530**DCL      2529--PROC     2549>>ASSIGN
IP$.SEGID IN PROCEDURE CVTPTR
      2532**DCL      2544>>IF
IRN$MINIQ
      1554**DCL-ENT  2281--CALL     2319--CALL     2436--CALL     2440--CALL     2450--CALL     2451--CALL
      2452--CALL     2453--CALL     2454--CALL     2456--CALL
IRN_CONTINUE
      1928**LABEL    1925--GOTO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:126  
IRR$FLUSHIQ
      1555**DCL-ENT  1986--CALL
IRR$MAP
      1556**DCL-ENT  2676--CALL
IRR$TYPE6
      1558**DCL-ENT  2284--CALL     2291--CALL     2322--CALL     2329--CALL
IRR$TYPE6M
      1557**DCL-ENT  2056--CALL     2066--CALL     2074--CALL     2092--CALL     2096--CALL     2111--CALL
      2119--CALL     2135--CALL     2156--CALL     2166--CALL     2247--CALL     2257--CALL     2278--CALL
      2316--CALL
IT$PARTITION.DEVICE
      1574**DCL      2003<<ASSIGN   2005<<ASSIGN
IT$PARTITION.IOCHAN
      1574**DCL      2022<<ASSIGN   2024<<ASSIGN   2036<<ASSIGN   2038<<ASSIGN
IT$PARTITION.MSOS_DEVICE
      1574**DCL      2007<<ASSIGN   2009<<ASSIGN
IT$PARTITION.MSOS_IOCHAN
      1574**DCL      2026<<ASSIGN   2028<<ASSIGN   2040<<ASSIGN   2042<<ASSIGN
IT_PARTITION
      1562**DCL      1998--CALL
LOOP
      1984**LABEL    1942--GOTO
MAXDCT
      1577**DCL      1933<<ASSIGN   1939>>DOINDEX  1993<<ASSIGN   1999>>DOINDEX
MAXDQH
      1578**DCL      2017<<ASSIGN   2018>>DOINDEX
MAXIOM
      1579**DCL      2016<<ASSIGN   2017>>ASSIGN   2033>>DOINDEX
MIRDCT$
      1793**DCL      1955<>CALL     1956>>CALL     1959>>CALL     2104>>IF       2104>>IF       2110>>CALL
      2114>>CALL     2118>>CALL     2132>>CALL     2133>>CALL     2134>>CALL     2138>>CALL     2139>>CALL
      2140>>CALL     2285>>IF       2323>>IF
MIRDCTX
      1792**DCL      1954<<ASSIGN   1955>>CALL     1966<<ASSIGN   2055>>CALLBLT  2082>>IF
MIRDQH$
      1794**DCL      1959<>CALL     1961<>CALL     2114<>CALL     2122>>CALL
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:127  
MIRSQH$
      1795**DCL      1956<>CALL     1957>>IF       1961>>CALL
MIR_FLAG
      1796**DCL      1953<<ASSIGN   1965<<ASSIGN   2054>>CALLBLT  2082>>IF       2101>>IF       2268>>IF
      2268>>IF       2285>>IF       2306>>IF       2306>>IF       2323>>IF
MSG_BUF
      1904**DCL      2257<>CALL     2257--CALL
MSG_BUF.BUF$
      1906**DCL      2254<>CALL
MSG_BUF.DESC1
      1908**DCL      2255<>CALL
MSG_BUF.DESC2
      1909**DCL      2256<>CALL
MSG_CVT
      1848**DCL      2092<>CALL     2092--CALL
MSG_CVT.CVTPTR
      1850**DCL      2091<<CALLBLT
MSG_DCT1
      1852**DCL      2066<>CALL     2066--CALL
MSG_DCT1.DQH$
      1854**DCL      2065<>CALL
MSG_DCT2
      1860**DCL      2096<>CALL     2096--CALL
MSG_DCT2.BQ$
      1864**DCL      2094<>CALL
MSG_DCT2.LQ$
      1866**DCL      2095<>CALL
MSG_DCT2.SQ$
      1862**DCL      2093<>CALL
MSG_DCTX
      1841**DCL      2056<>CALL     2056--CALL
MSG_DCTX.DCTX
      1843**DCL      2053<<CALLBLT
MSG_DCTX.MIRDCTX
      1847**DCL      2055<<CALLBLT
MSG_DCTX.MIRFLAG
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:128  
      1845**DCL      2054<<CALLBLT
MSG_DISK
      1888**DCL      2247<>CALL     2247--CALL
MSG_DISK.DLA
      1892**DCL      2246<>CALL
MSG_DISK.REQ$
      1890**DCL      2245<>CALL
MSG_DQH
      1856**DCL      2074<>CALL     2074--CALL
MSG_DQH.IO$
      1858**DCL      2073<>CALL
MSG_IOERR
      1832**DCL      2284<>CALL     2284--CALL     2322<>CALL     2322--CALL
MSG_IOERR.NAME
      1833**DCL      2283<<ASSIGN   2321<<ASSIGN
MSG_IOERR.TYPE
      1834**DCL      1962<<ASSIGN   1967<<ASSIGN
MSG_MDCT1
      1868**DCL      2111<>CALL     2111--CALL
MSG_MDCT1.DQH$
      1870**DCL      2110<>CALL
MSG_MDCT2
      1876**DCL      2135<>CALL     2135--CALL
MSG_MDCT2.BQ$
      1880**DCL      2133<>CALL
MSG_MDCT2.LQ$
      1882**DCL      2134<>CALL
MSG_MDCT2.SQ$
      1878**DCL      2132<>CALL
MSG_MDQH
      1872**DCL      2119<>CALL     2119--CALL
MSG_MDQH.IO$
      1874**DCL      2118<>CALL
MSG_MINI
      1894**DCL      2278<>CALL     2278--CALL     2316<>CALL     2316--CALL
MSG_MINI.CCC
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:129  
      1898**DCL      2275<<CALLBLT  2313<<CALLBLT
MSG_MINI.DD
      1900**DCL      2276<<CALLBLT  2314<<CALLBLT
MSG_MINI.GRAN#
      1902**DCL      2277<<CALLBLT  2315<<CALLBLT
MSG_MINI.I
      1896**DCL      2274<<CALLBLT  2312<<CALLBLT
MSG_PART
      1836**DCL      2291<>CALL     2291--CALL     2329<>CALL     2329--CALL
MSG_PART.NAME
      1837**DCL      2290<<ASSIGN   2328<<ASSIGN
MSG_PROC
      1884**DCL      2156<>CALL     2156--CALL     2166<>CALL     2166--CALL
MSG_PROC.SQ$
      1886**DCL      2155<>CALL     2165<>CALL
MTUNLOAD
      1797**DCL      1924<<ASSIGN   1928<<ASSIGN   1975>>IF       1979>>IF       1985>>IF
N$DCT$$
      1592**DCL      1935--CALL     1994--CALL
NI$CHT$
      1673**DCL      2014--CALL
NI$DVT$
      1580**DCL      1934--CALL
NI$IOM$
      1675**DCL      2032--CALL
NI$REQ.DCW
      1770**DCL      1773--REDEF
NI$REQ.DCW.TALLY
      1771**DCL      1771--REDEF
NI$REQ.IDCW.EXTA
      1773**DCL      1773--REDEF
NI$REQ.PCW
      1775**DCL      1779--REDEF
NI$REQ.SEEK
      1780**DCL      1781--REDEF    1782--REDEF
NI_IOMS
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:130  
      1828**DCL      2013--CALL
NK_MXLOCAL
      1827**DCL      1932--CALL     1992--CALL
NSPG#
      1791**DCL      1972<<ASSIGN   2281<>CALL     2319<>CALL
OCT IN PROCEDURE BINOCTAL
      2518**DCL      2514--PROC     2521<<ASSIGN
OP$ IN PROCEDURE CVTPTR
      2533**DCL      2529--PROC     2536--REDEF    2549<<ASSIGN
OP$.SEGID IN PROCEDURE CVTPTR
      2535**DCL      2550<<ASSIGN
OP$$ IN PROCEDURE CVTPTR
      2536**DCL      2546<<ASSIGN
P.SEGID
      1810**DCL      2550>>ASSIGN
P$
      1802**DCL      1932<>CALL     1933>>ASSIGN   1992<>CALL     1993>>ASSIGN   2013<>CALL     2016>>ASSIGN
P$ IN PROCEDURE ENQUEUE
      2495**DCL      2493--PROC     2500>>ASSIGN   2500>>ASSIGN   2503>>ASSIGN   2504>>ASSIGN   2507>>ASSIGN
PART$
      1576**DCL      1998<>CALL     2003>>ASSIGN   2005>>ASSIGN   2007>>ASSIGN   2009>>ASSIGN   2022>>ASSIGN
      2024>>ASSIGN   2026>>ASSIGN   2028>>ASSIGN   2036>>ASSIGN   2038>>ASSIGN   2040>>ASSIGN   2042>>ASSIGN
POBUF
      1813**DCL      1814--REDEF    2267<<ASSIGN   2435<<ASSIGN   2439<<ASSIGN
POBUFA
      1814**DCL      2302<<ASSIGN
PROCESS_SQ IN PROCEDURE DISK_RUNDOWN
      2146**PROC     2099--CALL     2100--CALL     2103--CALL     2138--CALL     2139--CALL     2140--CALL
PROCESS_SQ IN PROCEDURE TAPE_RUNDOWN
      2356**PROC     2351--CALL
PTR$
      1805**DCL      1936<>CALL     1995<>CALL     2015<>CALL     2256<>CALL     2478>>ASSIGN   2487<<ASSIGN
      2487>>ASSIGN   2500<<ASSIGN   2503<<ASSIGN   2503>>ASSIGN   2504<<ASSIGN
Q$ IN PROCEDURE DEQUEUE
      2465**DCL      2461--PROC     2468>>IF       2474<>CALL     2476>>ASSIGN   2485<<ASSIGN
Q$ IN PROCEDURE ENQUEUE
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:131  
      2496**DCL      2493--PROC     2498>>IF       2503>>ASSIGN   2504>>ASSIGN   2507<<ASSIGN
R$ IN PROCEDURE DEQUEUE
      2466**DCL      2461--PROC     2478<<ASSIGN   2481<>CALL     2481<>CALL     2483>>IF       2487>>ASSIGN
RDESC IN PROCEDURE GET_BUF
      2627**DCL      2653>>ASSIGN
REQ
      1710**DCL      2079<>CALL     2126<>CALL     2172<>CALL     2348<>CALL     2362<>CALL
REQ.BUFADDR
      1719**DCL      1720--REDEF    1720--REDEF
REQ.DLA.DRELADDR
      1711**DCL      1711--REDEF
REQ.DOMIR
      1754**DCL      2124>>IF       2169>>IF
REQ.DVE.EOMCHAR
      1748**DCL      1749--REDEF
REQ.EAINFO
      1742**DCL      1742--REDEF
REQ.EAINFOX
      1742**DCL      1743--REDEF
REQ.EVNTINFO
      1743**DCL      1743--REDEF
REQ.STATUS
      1724**DCL      1730--REDEF
REQ IN PROCEDURE DISKIO
      2191**DCL      2181--PROC     2245--CALL     2250<>CALL
REQ.BUFADDR IN PROCEDURE DISKIO
      2200**DCL      2201--REDEF    2201--REDEF
REQ.BUFSIZE IN PROCEDURE DISKIO
      2194**DCL      2261>>ASSIGN
REQ.DLA IN PROCEDURE DISKIO
      2191**DCL      2246<>CALL
REQ.DLA.DRELADDR IN PROCEDURE DISKIO
      2192**DCL      2192--REDEF    2260>>ASSIGN
REQ.DVE.EOMCHAR IN PROCEDURE DISKIO
      2229**DCL      2230--REDEF
REQ.EAINFO IN PROCEDURE DISKIO
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:132  
      2223**DCL      2223--REDEF
REQ.EAINFOX IN PROCEDURE DISKIO
      2223**DCL      2224--REDEF
REQ.EVNTINFO IN PROCEDURE DISKIO
      2224**DCL      2224--REDEF
REQ.FC IN PROCEDURE DISKIO
      2194**DCL      2262>>DOCASE
REQ.STATUS IN PROCEDURE DISKIO
      2205**DCL      2211--REDEF
REQ IN PROCEDURE GET_BUF
      2565**DCL      2555--PROC
REQ.BUFADDR IN PROCEDURE GET_BUF
      2574**DCL      2575--REDEF    2575--REDEF    2649<<ASSIGN   2655>>ASSIGN
REQ.BUFREAL_SV IN PROCEDURE GET_BUF
      2607**DCL      2649>>ASSIGN
REQ.BUFSIZE IN PROCEDURE GET_BUF
      2568**DCL      2656>>ASSIGN   2665>>ASSIGN
REQ.BUFVIRT.BASE IN PROCEDURE GET_BUF
      2575**DCL      2660>>ASSIGN
REQ.BUFVIRT.BYT IN PROCEDURE GET_BUF
      2575**DCL      2665>>ASSIGN   2667>>ASSIGN
REQ.DLA.DRELADDR IN PROCEDURE GET_BUF
      2566**DCL      2566--REDEF
REQ.DVE.EOMCHAR IN PROCEDURE GET_BUF
      2603**DCL      2604--REDEF
REQ.EAINFO IN PROCEDURE GET_BUF
      2597**DCL      2597--REDEF
REQ.EAINFOX IN PROCEDURE GET_BUF
      2597**DCL      2598--REDEF
REQ.EVNTINFO IN PROCEDURE GET_BUF
      2598**DCL      2598--REDEF
REQ.IOP_BUFREAL_CVRT IN PROCEDURE GET_BUF
      2605**DCL      2646>>IF       2650<<ASSIGN
REQ.PTP IN PROCEDURE GET_BUF
      2576**DCL      2648<<ASSIGN   2652>>IF       2664>>ASSIGN   2670>>ASSIGN   2672>>ASSIGN   2674>>ASSIGN
REQ.STATUS IN PROCEDURE GET_BUF
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:133  
      2579**DCL      2585--REDEF
REQ IN PROCEDURE TAPEIO
      2379**DCL      2369--PROC     2430<>CALL
REQ.BUFADDR IN PROCEDURE TAPEIO
      2388**DCL      2389--REDEF    2389--REDEF
REQ.BUFSIZE IN PROCEDURE TAPEIO
      2382**DCL      2431>>ASSIGN
REQ.DLA.DRELADDR IN PROCEDURE TAPEIO
      2380**DCL      2380--REDEF
REQ.DVE.EOMCHAR IN PROCEDURE TAPEIO
      2417**DCL      2418--REDEF
REQ.EAINFO IN PROCEDURE TAPEIO
      2411**DCL      2411--REDEF
REQ.EAINFOX IN PROCEDURE TAPEIO
      2411**DCL      2412--REDEF
REQ.EVNTINFO IN PROCEDURE TAPEIO
      2412**DCL      2412--REDEF
REQ.FC IN PROCEDURE TAPEIO
      2382**DCL      2432>>DOCASE
REQ.STATUS IN PROCEDURE TAPEIO
      2393**DCL      2399--REDEF
REQ$
      1700**DCL      1710--IMP-PTR  1949<>CALL     2077<>CALL     2079>>CALL     2122<>CALL     2124>>IF
      2126>>CALL     2161<>CALL     2169>>IF       2172>>CALL     2173<>CALL     2347<>CALL     2348>>CALL
      2361<>CALL     2362>>CALL
RPM_FLG
      1830**DCL      2661>>IF       2669>>IF
RVF_DEBUG
      1831**DCL      2051>>IF       2063>>IF       2071>>IF       2089>>IF       2108>>IF       2116>>IF
      2130>>IF       2153>>IF       2163>>IF       2243>>IF       2252>>IF       2272>>IF       2310>>IF
S$WSPTD.BLKNO
       996**DCL      2670<<ASSIGN   2672<<ASSIGN   2674<<ASSIGN
SAVE$ IN PROCEDURE PROCESS_SQ
      2149**DCL      2159<<ASSIGN   2173<>CALL     2175>>ASSIGN
SBIN36
      1811**DCL      1933>>ASSIGN   1993>>ASSIGN   2016>>ASSIGN
PL6.E3A0      #001=IRN$RCVRIO File=IRN$RCVRIO.:E05TSI                            TUE 07/29/97 22:47 Page:134  
SEGTAB.MONSID IN PROCEDURE CVTPTR
      2540**DCL      2544>>IF
SEGTAB.RV$ IN PROCEDURE CVTPTR
      2541**DCL      2550>>ASSIGN
SQ$ IN PROCEDURE PROCESS_SQ
      2357**DCL      2146--PROC     2155<>CALL     2161<>CALL     2165<>CALL     2175<<ASSIGN   2356--PROC
      2361<>CALL
SQH.CQ$
      1695**DCL      1945>>IF       1948<>CALL     1957>>IF       1961<>CALL
SQH.DOOR
      1694**DCL      1694--REDEF
SV_MONPT4
      1803**DCL      1937<<ASSIGN   1987>>ASSIGN   1996<<ASSIGN   2679>>ASSIGN
TAPEIO IN PROCEDURE TAPE_RUNDOWN
      2369**PROC     2348--CALL     2362--CALL
TAPE_DISM
      2446**PROC     1980--CALL
TAPE_RUNDOWN
      2344**PROC     1981--CALL
XA_MODE
      1829**DCL      2671>>IF

PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:135  
      789        1        /*T***********************************************************/
      790        2        /*T*                                                         */
      791        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      792        4        /*T*                                                         */
      793        5        /*T***********************************************************/
      794        6        IRN$MINIQ: PROC(IOM,CHAN,DVN,GRAN,NSPG,ARS,FCN) ALTRET;
      795        7        /**/
      796        8    1   DCL IOM SBIN;
      797        9    1   DCL CHAN SBIN;
      798       10    1   DCL DVN SBIN;
      799       11    1   DCL GRAN SBIN;
      800       12    1   DCL NSPG SBIN;
      801       13    1   DCL ARS SBIN;
      802       14    1   DCL FCN SBIN;
      803       15        /**/
      804       16    1   DCL IRR$WPAGE ENTRY ALTRET;
      805       17    1   DCL IRR$RPAGE ENTRY;
      806       18    1   DCL IRR$UNLOAD ENTRY;
      807       19    1   DCL IRR$PERMIT ENTRY;
      808       20    1   DCL IRR$WRFM ENTRY;
      809       21    1   DCL IRR$WRBIN ENTRY(1);
      810       22    1   DCL IRR$WRASC ENTRY(1);
      811       23        /**/
      812       24    1   DCL RV_WDGRAN SBIN SYMREF;
      813       25    1   DCL 1 RV_DCTX SYMREF,
      814       26    1           2 CHAN UBIN(9) UNAL,
      815       27    1           2 DVN UBIN(6) UNAL,
      816       28    1           2 IOM UBIN(2) UNAL,
      817       29    1           2 * UBIN (19) UNAL;
      818       30    1   DCL RV_NSPG SBIN SYMREF;
      819       31        /**/
      820       32        %SUB FC_DPWR=1;
      821       33        %SUB FC_DPRD=2;
      822       34        %SUB FC_MTUN=3;
      823       35        %SUB FC_MTPR=4;
      824       36        %SUB FC_MTWF=5;
      825       37        %SUB FC_MTWB=6;
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:136  
      826       38        %SUB FC_MTWA=7;
      827       39        %EJECT;
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:137  
      828       40    1           IF ADDR(GRAN)~=ADDR(NIL) THEN RV_WDGRAN=GRAN;
      829       41    1           RV_DCTX.CHAN=CHAN;
      830       42    1           RV_DCTX.DVN=DVN;
      831       43    1           RV_DCTX.IOM=IOM;
      832       44    1           IF ADDR(NSPG)~=ADDR(NIL) THEN RV_NSPG=NSPG;
      833       45    2           DO CASE(FCN);
      834       46    2            CASE(FC_DPWR);
      835       47    3              CALL IRR$WPAGE WHENALTRETURN DO;
      836       48    3                 ALTRETURN;
      837       49    3                 END;
      838       50    2            CASE(FC_DPRD);
      839       51    2              CALL IRR$RPAGE;
      840       52    2           CASE(FC_MTUN);
      841       53    2             CALL IRR$UNLOAD;
      842       54    2            CASE(FC_MTPR);
      843       55    2              CALL IRR$PERMIT;
      844       56    2            CASE(FC_MTWF);
      845       57    2              CALL IRR$WRFM;
      846       58    2            CASE(FC_MTWB);
      847       59    2              CALL IRR$WRBIN(ARS);
      848       60    2            CASE(FC_MTWA);
      849       61    2              CALL IRR$WRASC(ARS);
      850       62    2            END;
      851       63    1           RETURN;
      852       64    1   END IRN$MINIQ;

PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:138  
      No diagnostics issued in procedure IRN$MINIQ.

   Procedure IRN$MINIQ requires 75 words for executable code.
   Procedure IRN$MINIQ requires 10 words of local(AUTO) storage.

    No errors detected in file IRN$RCVRIO.:E05TSI    .

PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:139  

 Object Unit name= IRN$MINIQ                                  File name= IRN$RCVRIO.:E05TOU
 UTS= JUL 29 '97 22:47:34.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    75    113  IRN$MINIQ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        7  IRN$MINIQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 IRR$WPAGE
         yes           Std       1 IRR$WRASC
         yes           Std       0 IRR$RPAGE
         yes           Std       0 IRR$WRFM
         yes           Std       1 IRR$WRBIN
         yes           Std       0 IRR$UNLOAD
         yes           Std       0 IRR$PERMIT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:140  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RV_WDGRAN                             RV_DCTX                               RV_NSPG
     B_VECTNIL
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:141  


      789        1        /*T***********************************************************/
      790        2        /*T*                                                         */
      791        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      792        4        /*T*                                                         */
      793        5        /*T***********************************************************/
      794        6        IRN$MINIQ: PROC(IOM,CHAN,DVN,GRAN,NSPG,ARS,FCN) ALTRET;

      6  0 000000   000000 700200 xent  IRN$MINIQ    TSX0  ! X66_AUTO_N
         0 000001   000012 000007                    ZERO    10,7

      795        7        /**/
      796        8    1   DCL IOM SBIN;
      797        9    1   DCL CHAN SBIN;
      798       10    1   DCL DVN SBIN;
      799       11    1   DCL GRAN SBIN;
      800       12    1   DCL NSPG SBIN;
      801       13    1   DCL ARS SBIN;
      802       14    1   DCL FCN SBIN;
      803       15        /**/
      804       16    1   DCL IRR$WPAGE ENTRY ALTRET;
      805       17    1   DCL IRR$RPAGE ENTRY;
      806       18    1   DCL IRR$UNLOAD ENTRY;
      807       19    1   DCL IRR$PERMIT ENTRY;
      808       20    1   DCL IRR$WRFM ENTRY;
      809       21    1   DCL IRR$WRBIN ENTRY(1);
      810       22    1   DCL IRR$WRASC ENTRY(1);
      811       23        /**/
      812       24    1   DCL RV_WDGRAN SBIN SYMREF;
      813       25    1   DCL 1 RV_DCTX SYMREF,
      814       26    1           2 CHAN UBIN(9) UNAL,
      815       27    1           2 DVN UBIN(6) UNAL,
      816       28    1           2 IOM UBIN(2) UNAL,
      817       29    1           2 * UBIN (19) UNAL;
      818       30    1   DCL RV_NSPG SBIN SYMREF;
      819       31        /**/
      820       32        %SUB FC_DPWR=1;
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:142  
      821       33        %SUB FC_DPRD=2;
      822       34        %SUB FC_MTUN=3;
      823       35        %SUB FC_MTPR=4;
      824       36        %SUB FC_MTWF=5;
      825       37        %SUB FC_MTWB=6;
      826       38        %SUB FC_MTWA=7;
      827       39        %EJECT;
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:143  
      828       40    1           IF ADDR(GRAN)~=ADDR(NIL) THEN RV_WDGRAN=GRAN;

     40  0 000002   200006 236100                    LDQ     @GRAN,,AUTO
         0 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000004   000010 600000 0                  TZE     s:41

     40  0 000005   200006 470500                    LDP0    @GRAN,,AUTO
         0 000006   000000 235100                    LDA     0,,PR0
         0 000007   000000 755000 xsym               STA     RV_WDGRAN

      829       41    1           RV_DCTX.CHAN=CHAN;

     41  0 000010   200004 470500                    LDP0    @CHAN,,AUTO
         0 000011   000000 236100                    LDQ     0,,PR0
         0 000012   000033 736000                    QLS     27
         0 000013   000000 552040 xsym               STBQ    RV_DCTX,'40'O

      830       42    1           RV_DCTX.DVN=DVN;

     42  0 000014   200005 471500                    LDP1    @DVN,,AUTO
         0 000015   100000 236100                    LDQ     0,,PR1
         0 000016   000025 736000                    QLS     21
         0 000017   000000 676000 xsym               ERQ     RV_DCTX
         0 000020   000770 376003                    ANQ     504,DU
         0 000021   000000 656000 xsym               ERSQ    RV_DCTX

      831       43    1           RV_DCTX.IOM=IOM;

     43  0 000022   200003 473500                    LDP3    @IOM,,AUTO
         0 000023   300000 236100                    LDQ     0,,PR3
         0 000024   000023 736000                    QLS     19
         0 000025   000000 676000 xsym               ERQ     RV_DCTX
         0 000026   000006 376003                    ANQ     6,DU
         0 000027   000000 656000 xsym               ERSQ    RV_DCTX

      832       44    1           IF ADDR(NSPG)~=ADDR(NIL) THEN RV_NSPG=NSPG;

PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:144  
     44  0 000030   200007 236100                    LDQ     @NSPG,,AUTO
         0 000031   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000032   000036 600000 0                  TZE     s:45

     44  0 000033   200007 474500                    LDP4    @NSPG,,AUTO
         0 000034   400000 235100                    LDA     0,,PR4
         0 000035   000000 755000 xsym               STA     RV_NSPG

      833       45    2           DO CASE(FCN);

     45  0 000036   200011 474500                    LDP4    @FCN,,AUTO
         0 000037   400000 235100                    LDA     0,,PR4
         0 000040   000010 115007                    CMPA    8,DL
         0 000041   000043 602005 0                  TNC     s:45+5,AL
         0 000042   000112 710000 0                  TRA     s:63
         0 000043   000112 710000 0                  TRA     s:63
         0 000044   000053 710000 0                  TRA     s:47
         0 000045   000061 710000 0                  TRA     s:51
         0 000046   000065 710000 0                  TRA     s:53
         0 000047   000071 710000 0                  TRA     s:55
         0 000050   000075 710000 0                  TRA     s:57
         0 000051   000101 710000 0                  TRA     s:59
         0 000052   000106 710000 0                  TRA     s:61

      834       46    2            CASE(FC_DPWR);

      835       47    3              CALL IRR$WPAGE WHENALTRETURN DO;

     47  0 000053   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000054   000000 701000 xent               TSX1    IRR$WPAGE
         0 000055   000057 702000 0                  TSX2    s:48
         0 000056   000060 710000 0                  TRA     s:48+1

      836       48    3                 ALTRETURN;

     48  0 000057   000000 702200 xent               TSX2  ! X66_AALT
         0 000060   000112 710000 0                  TRA     s:63
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:145  

      837       49    3                 END;
      838       50    2            CASE(FC_DPRD);

      839       51    2              CALL IRR$RPAGE;

     51  0 000061   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000062   000000 701000 xent               TSX1    IRR$RPAGE
         0 000063   000000 011000                    NOP     0
         0 000064   000112 710000 0                  TRA     s:63

      840       52    2           CASE(FC_MTUN);

      841       53    2             CALL IRR$UNLOAD;

     53  0 000065   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000066   000000 701000 xent               TSX1    IRR$UNLOAD
         0 000067   000000 011000                    NOP     0
         0 000070   000112 710000 0                  TRA     s:63

      842       54    2            CASE(FC_MTPR);

      843       55    2              CALL IRR$PERMIT;

     55  0 000071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000072   000000 701000 xent               TSX1    IRR$PERMIT
         0 000073   000000 011000                    NOP     0
         0 000074   000112 710000 0                  TRA     s:63

      844       56    2            CASE(FC_MTWF);

      845       57    2              CALL IRR$WRFM;

     57  0 000075   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000076   000000 701000 xent               TSX1    IRR$WRFM
         0 000077   000000 011000                    NOP     0
         0 000100   000112 710000 0                  TRA     s:63
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:146  

      846       58    2            CASE(FC_MTWB);

      847       59    2              CALL IRR$WRBIN(ARS);

     59  0 000101   200010 630500                    EPPR0   @ARS,,AUTO
         0 000102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000103   000000 701000 xent               TSX1    IRR$WRBIN
         0 000104   000000 011000                    NOP     0
         0 000105   000112 710000 0                  TRA     s:63

      848       60    2            CASE(FC_MTWA);

      849       61    2              CALL IRR$WRASC(ARS);

     61  0 000106   200010 630500                    EPPR0   @ARS,,AUTO
         0 000107   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000110   000000 701000 xent               TSX1    IRR$WRASC
         0 000111   000000 011000                    NOP     0

      850       62    2            END;

      851       63    1           RETURN;

     63  0 000112   000000 702200 xent               TSX2  ! X66_ARET
      852       64    1   END IRN$MINIQ;

PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:147  
      No diagnostics issued in procedure IRN$MINIQ.
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:148  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w PTR         r     1 @ARS                       4-0-0/w PTR         r     1 @CHAN
     5-0-0/w PTR         r     1 @DVN                      11-0-0/w PTR         r     1 @FCN
     6-0-0/w PTR         r     1 @GRAN                      3-0-0/w PTR         r     1 @IOM
     7-0-0/w PTR         r     1 @NSPG                     *0-0-0/w SBIN        r     1 ARS
    *0-0-0/w SBIN        r     1 CHAN                      *0-0-0/w SBIN        r     1 DVN
    *0-0-0/w SBIN        r     1 FCN                       *0-0-0/w SBIN        r     1 GRAN
    *0-0-0/w SBIN        r     1 IOM                       *0-0-0/w SBIN        r     1 NSPG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 RV_DCTX                    0-0-0/w SBIN        r     1 RV_NSPG
     0-0-0/w SBIN        r     1 RV_WDGRAN


   Procedure IRN$MINIQ requires 75 words for executable code.
   Procedure IRN$MINIQ requires 10 words of local(AUTO) storage.

    No errors detected in file IRN$RCVRIO.:E05TSI    .
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:149  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:150  
          MINI XREF LISTING

ARS
        13**DCL         6--PROC       59<>CALL       61<>CALL
CHAN
         9**DCL         6--PROC       41>>ASSIGN
DVN
        10**DCL         6--PROC       42>>ASSIGN
FCN
        14**DCL         6--PROC       45>>DOCASE
GRAN
        11**DCL         6--PROC       40--IF         40>>ASSIGN
IOM
         8**DCL         6--PROC       43>>ASSIGN
IRR$PERMIT
        19**DCL-ENT    55--CALL
IRR$RPAGE
        17**DCL-ENT    51--CALL
IRR$UNLOAD
        18**DCL-ENT    53--CALL
IRR$WPAGE
        16**DCL-ENT    47--CALL
IRR$WRASC
        22**DCL-ENT    61--CALL
IRR$WRBIN
        21**DCL-ENT    59--CALL
IRR$WRFM
        20**DCL-ENT    57--CALL
NSPG
        12**DCL         6--PROC       44--IF         44>>ASSIGN
RV_DCTX.CHAN
        26**DCL        41<<ASSIGN
RV_DCTX.DVN
        27**DCL        42<<ASSIGN
PL6.E3A0      #002=IRN$MINIQ File=IRN$RCVRIO.:E05TSI                             TUE 07/29/97 22:47 Page:151  
RV_DCTX.IOM
        28**DCL        43<<ASSIGN
RV_NSPG
        30**DCL        44<<ASSIGN
RV_WDGRAN
        24**DCL        40<<ASSIGN
