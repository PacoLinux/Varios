
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:1    
        1        1        /*M* ZIU$HASHFID     IDSII    FIND FID ENTRY IN HASH TABLE FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$HASHFID: PROC(INDX) ALTRET;
        8        8        /*
        9        9           This program provides two functions to the ROLL utility.
       10       10           1. To find the indx that a fid is stored into in the fid list table and
       11       11           2. To store a fid into the fid list table after finding were it goes.
       12       12        */
       13       13    1   DCL INDX SBIN;
       14       14
       15       15    1   DCL TEMP SBIN;
       16       16    1   DCL HASH_INDX SBIN;
       17       17    1   DCL 1 FID ALIGNED,
       18       18    1         2 N,
       19       19    1           3 L UBIN BYTE UNAL,
       20       20    1           3 C CHAR(31) UNAL,
       21       21    1         2 A CHAR(8) UNAL;
       22       22    1   DCL HASH (0:9) REDEF FID UBIN WORD UNAL;
       23       23
       24       24    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
       25       25    1   DCL DCB$ PTR;
       26       26    1   DCL B$TCB$ PTR SYMREF;
       27       27    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       28       28    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       29       29    1   DCL DE_QUE ENTRY(1);
       30       30
       31       31         %INCLUDE ZI$JRNL;
       32      139         %JRNL_REC;
       33      214         %INCLUDE ZI_DBU_ROLL;
       34      298         %ROLL_LIST;
       35      357         %ROLL_SUBS;
       36      376
       37      377         %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:2    
       38      917         %INCLUDE CP_6;
       39      998         %F$DCB;
       40     1055         %B$TCB;
       41     1058         %B$EXCFR;
       42     1076         %INCLUDE ZI_ERRORS_SUBS;
       43     1596         %INCLUDE ZI_GLOBAL_DBUTIL;
       44     1774         %SYS_FUNC;
       45     1866         %FPT_GETDCB(FPTN=GETROLLDCB_FPT,MERGE=YES,DCBNAME=ROLL_NAME);
       46     1881         %VLP_NAME(FPTN=ROLL_NAME,STCLASS=CONSTANT,NAME='ROLLACCT');
       47     1908    1   FIND_FID: ENTRY(INDX) ALTRET;
       48     1909
       49     1910        /*  A fixed DCB 'ROLLACCT' will be used to allow the user to change the
       50     1911            account of the database that DBUTIL will apply the journal to.
       51     1912            Thus if you want to roll forward a non_live database, you would
       52     1913            say !SET ROLLACCT .NEWACCOUNT and DBUTIL would find all the areas
       53     1914            in NEWACCOUNT instead of in the account that the areas were
       54     1915            originally in.     */
       55     1916
       56     1917    1       CALL M$GETDCB(GETROLLDCB_FPT) ALTRET(ALT_ERR);
       57     1918    1       DCBSF = GETROLLDCB_FPT.V.DCB#;
       58     1919    1       DCB$ = DCBADDR(DCBSF);
       59     1920    1       IF DCB$->F$DCB.ACCT# ~= ' '
       60     1921    1       THEN
       61     1922    1           FILE.ID.ACCT# = DCB$->F$DCB.ACCT#;
       62     1923    1       IF DCB$->F$DCB.PSN# ~= ' '
       63     1924    1       THEN
       64     1925    1           FILE.ID.PSN# = DCB$->F$DCB.PSN#;
       65     1926    1       CALL HASH_FID;
       66     1927    1       INDX = FID_INDXS(HASH_INDX);
       67     1928    1       IF INDX = -1 THEN
       68     1929    1           RETURN; /* Retrun with -1 meaning no entry for fid.*/
       69     1930    1       ELSE
       70     1931    2       DO FOREVER;
       71     1932    2           IF INDX = -1 THEN
       72     1933    2               RETURN;
       73     1934    2           IF FIDLIST.NAME(INDX) = FILE.ID.NAME# AND
       74     1935    2              FIDLIST.ACCNT#(INDX) = FILE.ID.ACCT# AND
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:3    
       75     1936    2              FIDLIST.PACK#(INDX) = FILE.ID.PSN# THEN
       76     1937    2               RETURN;
       77     1938    2           ELSE
       78     1939    2               INDX = FIDLIST.NXTFID(INDX);
       79     1940    2           END;
       80     1941
       81     1942    1   STORE_FID: ENTRY(INDX) ALTRET;
       82     1943    1       CALL HASH_FID;
       83     1944    1       INDX = FID_INDXS(HASH_INDX);
       84     1945
       85     1946    1       IF FID_INDXS(HASH_INDX) = -1 THEN
       86     1947    2       DO;
       87     1948    2           FID_INDXS(HASH_INDX) = NXT_AVIL_FIDSLOT;
       88     1949    2           INDX = NXT_AVIL_FIDSLOT;
       89     1950    2           END;
       90     1951    2       ELSE DO;
       91     1952    3           DO WHILE(INDX ~= -1);
       92     1953    3               TEMP = INDX;
       93     1954    3               INDX = FIDLIST.NXTFID(TEMP);
       94     1955    3               END;
       95     1956    2           FIDLIST.NXTFID(TEMP) = NXT_AVIL_FIDSLOT;
       96     1957    2           INDX = NXT_AVIL_FIDSLOT;
       97     1958    2           END;
       98     1959        /*
       99     1960              Increase NXT_AVIL_FIDSLOT by 1 checking you dont go over tbl size.
      100     1961        */
      101     1962    1       NXT_AVIL_FIDSLOT = NXT_AVIL_FIDSLOT + 1;
      102     1963    1       IF NXT_AVIL_FIDSLOT > MAX_FIDINDX THEN
      103     1964    2       DO;
      104     1965    2           CALL EXPAND_TBL_SEG(,FIDLST#) ALTRET(ALT_EXP);
      105     1966    2           MAX_FIDINDX = MAX_FIDINDX + 60;
      106     1967    2           END;
      107     1968        /*
      108     1969              Do actual storing of the Journal FID into fid FIDLIST.
      109     1970        */
      110     1971    1       FIDLIST.NAME(INDX) = FILE.ID.NAME#;
      111     1972    1       FIDLIST.ACCNT#(INDX) = FILE.ID.ACCT#;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:4    
      112     1973    1       FIDLIST.PASS#(INDX) = FILE.ID.PASS#;
      113     1974    1       FIDLIST.PACK#(INDX) = FILE.ID.PSN#;
      114     1975    1       FIDLIST.CRPT_B(INDX) = FILE.CRPT;
      115     1976    1       FIDLIST.DCB#(INDX) = 0;
      116     1977    1       FIDLIST.QUE.PRI(INDX) = -1;
      117     1978    1       FIDLIST.QUE.NXT(INDX) = -1;
      118     1979    1       FIDLIST.NXTFID(INDX) = -1;
      119     1980    1       IF FILE.KEYED = %YES# THEN
      120     1981    1           FIDLIST.ORG#(INDX) = %KEYED#;
      121     1982    1       ELSE IF FILE.INDEXED = %YES# THEN
      122     1983    1               FIDLIST.ORG#(INDX) = %INDEXED#;
      123     1984    1           ELSE IF FILE.COMGROUP = %YES# THEN
      124     1985    1                   FIDLIST.ORG#(INDX) = %CG#;
      125     1986    1               ELSE
      126     1987    1                   FIDLIST.ORG#(INDX) = %IDS#;
      127     1988    1       RETURN;
      128     1989
      129     1990    1   HASH_FID: PROC;
      130     1991    2       FID.N = FILE.ID.NAME#;
      131     1992    2       FID.A = FILE.ID.ACCT#;
      132     1993    2       HASH_INDX = MOD(BITBIN(BINBIT(HASH(0)+HASH(1)+HASH(2)+HASH(3)+
      133     1994    2          HASH(4)+HASH(5)+HASH(6)+HASH(7)+
      134     1995    2          HASH(8)+HASH(9),36)
      135     1996    2          & '377777777777'O),
      136     1997    2          NO.HASHFIDS);
      137     1998    2       RETURN;
      138     1999    2   END HASH_FID;
      139     2000
      140     2001    1   ALT_EXP:
      141     2002    1       ALTRETURN;
      142     2003    1   ALT_ERR:
      143     2004    1       MONITOR_ERR = B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;
      144     2005    1       INCL_ERR = %YES#;
      145     2006    1       CALL SYS_FUNC_ERRMSG;
      146     2007    1       CALL DE_QUE(FIDX);
      147     2008    1       FIDLIST.DCB#(FIDX) = 0;
      148     2009    1       CALL SYS_FUNC_RELDCB;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:5    
      149     2010    1       ALTRETURN;
      150     2011    1   END ZIU$HASHFID;

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:6    
--  Include file information  --

   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$HASHFID.

   Procedure ZIU$HASHFID requires 303 words for executable code.
   Procedure ZIU$HASHFID requires 22 words of local(AUTO) storage.

    No errors detected in file ZIU$HASHFID.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:7    

 Object Unit name= ZIU$HASHFID                                File name= ZIU$HASHFID.:ZIC0TOU
 UTS= SEP 05 '97 13:15:56.76 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     8     10  ZIU$HASHFID
    2  RoData even  UTS      4      4  ZIU$HASHFID
    3   Proc  even  none   303    457  ZIU$HASHFID
    4  RoData even  none    13     15  ZIU$HASHFID

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  ZIU$HASHFID
     3      3          yes     yes      Std        1  FIND_FID
     3    121          yes     yes      Std        1  STORE_FID

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 DE_QUE
 yes     yes           Std       0 SYS_FUNC_RELDCB
 yes     yes           Std       2 EXPAND_TBL_SEG
 yes     yes           Std       0 SYS_FUNC_ERRMSG
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$TCB$                                JRNL$                                 FID$
     DCBLIST$                              USER$                                 FID_INDXS$
     FID_INDXS                             NXT_AVIL_FIDSLOT                      NXT_AVIL_DCBSLOT
     LAST_UNUSED_DCBSLOT                   USER                                  NO
     FIRST                                 LAST                                  MAX_DCBINDX
     MAX_FIDINDX                           FIDX                                  DCBX
     BRK_ROLL                              M$UC                                  BLKLSF
     KEYLSF                                KEYXSF                                DCBSF
     ORGSF                                 KEYSF                                 KEYVSF
     ACSSF                                 NOTIMESF                              FUNSF
     ASNSF                                 TESTSF                                XTENSIZESF
     DISPSF                                WAITSF                                VFCSF
     FULLSF                                BKUPSF                                BUFLNSF
     BUFSF                                 SOURCESF                              DESTSF
     DATESF                                TIMESF                                UTSSF
     DAYSF                                 TSTAMPSF                              ENCRP_SEEDSF
     ERRCODESF                             MSGCODE                               INCL_ERR
     ERR_INSERT                            FIDSF_RD                              ACNT
     EXISTSF                               SHARESF                               DCBNMSF
     KEYRSF                                NO_KEYSF                              REASGNSF
     CARRY_ATTRIBUTESF                     SUBMESSF                              SPKY_OPNSF
     POSSF                                 ERRFLGSF                              MERGESF
     FSA_FLAG                              RELGSF                                UNUSED
     HELPCODE                              COUNTSF                               INDEXSF
     GAP                                   PSNSF                                 ACNTSF
     KEY_SHADWSF

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:9    


        1        1        /*M* ZIU$HASHFID     IDSII    FIND FID ENTRY IN HASH TABLE FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$HASHFID: PROC(INDX) ALTRET;

      7  3 000000   000000 700200 xent  ZIU$HASHFID  TSX0  ! X66_AUTO_1
         3 000001   000026 000001                    ZERO    22,1
         3 000002   000005 710000 3                  TRA     s:1917

        8        8        /*
        9        9           This program provides two functions to the ROLL utility.
       10       10           1. To find the indx that a fid is stored into in the fid list table and
       11       11           2. To store a fid into the fid list table after finding were it goes.
       12       12        */
       13       13    1   DCL INDX SBIN;
       14       14
       15       15    1   DCL TEMP SBIN;
       16       16    1   DCL HASH_INDX SBIN;
       17       17    1   DCL 1 FID ALIGNED,
       18       18    1         2 N,
       19       19    1           3 L UBIN BYTE UNAL,
       20       20    1           3 C CHAR(31) UNAL,
       21       21    1         2 A CHAR(8) UNAL;
       22       22    1   DCL HASH (0:9) REDEF FID UBIN WORD UNAL;
       23       23
       24       24    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
       25       25    1   DCL DCB$ PTR;
       26       26    1   DCL B$TCB$ PTR SYMREF;
       27       27    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       28       28    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       29       29    1   DCL DE_QUE ENTRY(1);
       30       30
       31       31         %INCLUDE ZI$JRNL;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:10   
       32      139         %JRNL_REC;
       33      214         %INCLUDE ZI_DBU_ROLL;
       34      298         %ROLL_LIST;
       35      357         %ROLL_SUBS;
       36      376
       37      377         %INCLUDE CP_6_SUBS;
       38      917         %INCLUDE CP_6;
       39      998         %F$DCB;
       40     1055         %B$TCB;
       41     1058         %B$EXCFR;
       42     1076         %INCLUDE ZI_ERRORS_SUBS;
       43     1596         %INCLUDE ZI_GLOBAL_DBUTIL;
       44     1774         %SYS_FUNC;
       45     1866         %FPT_GETDCB(FPTN=GETROLLDCB_FPT,MERGE=YES,DCBNAME=ROLL_NAME);
       46     1881         %VLP_NAME(FPTN=ROLL_NAME,STCLASS=CONSTANT,NAME='ROLLACCT');
       47     1908    1   FIND_FID: ENTRY(INDX) ALTRET;

   1908  3 000003   000000 700200 xent  FIND_FID     TSX0  ! X66_AUTO_1
         3 000004   000026 000001                    ZERO    22,1

       48     1909
       49     1910        /*  A fixed DCB 'ROLLACCT' will be used to allow the user to change the
       50     1911            account of the database that DBUTIL will apply the journal to.
       51     1912            Thus if you want to roll forward a non_live database, you would
       52     1913            say !SET ROLLACCT .NEWACCOUNT and DBUTIL would find all the areas
       53     1914            in NEWACCOUNT instead of in the account that the areas were
       54     1915            originally in.     */
       55     1916
       56     1917    1       CALL M$GETDCB(GETROLLDCB_FPT) ALTRET(ALT_ERR);

   1917  3 000005   000000 630400 1                  EPPR0   GETROLLDCB_FPT
         3 000006   460002 713400                    CLIMB   alt,+24578
         3 000007   401000 401760                    pmme    nvectors=3
         3 000010   000431 702000 3                  TSX2    ALT_ERR

       57     1918    1       DCBSF = GETROLLDCB_FPT.V.DCB#;

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:11   
   1918  3 000011   000006 220000 1                  LDX0    GETROLLDCB_FPT+6
         3 000012   000000 740000 xsym               STX0    DCBSF

       58     1919    1       DCB$ = DCBADDR(DCBSF);

   1919  3 000013   000000 470400 4                  LDP0    0
         3 000014   000000 471500                    LDP1    0,,PR0
         3 000015   100000 236110                    LDQ     0,X0,PR1
         3 000016   200020 756100                    STQ     DCB$,,AUTO

       59     1920    1       IF DCB$->F$DCB.ACCT# ~= ' '

   1920  3 000017   200020 473500                    LDP3    DCB$,,AUTO
         3 000020   300020 237100                    LDAQ    16,,PR3
         3 000021   000002 117000 4                  CMPAQ   2
         3 000022   000027 600000 3                  TZE     s:1923

       60     1921    1       THEN
       61     1922    1           FILE.ID.ACCT# = DCB$->F$DCB.ACCT#;

   1922  3 000023   000000 474400 xsym               LDP4    JRNL$
         3 000024   040100 100500                    MLR     fill='040'O
         3 000025   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8
         3 000026   400003 200010                    ADSC9   3,,PR4                   cn=1,n=8

       62     1923    1       IF DCB$->F$DCB.PSN# ~= ' '

   1923  3 000027   040000 106500                    CMPC    fill='040'O
         3 000030   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         3 000031   000002 000001 4                  ADSC9   2                        cn=0,n=1
         3 000032   000037 600000 3                  TZE     s:1926

       63     1924    1       THEN
       64     1925    1           FILE.ID.PSN# = DCB$->F$DCB.PSN#;

   1925  3 000033   000000 474400 xsym               LDP4    JRNL$
         3 000034   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:12   
         3 000035   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         3 000036   400007 200006                    ADSC9   7,,PR4                   cn=1,n=6

       65     1926    1       CALL HASH_FID;

   1926  3 000037   000371 701000 3                  TSX1    HASH_FID
         3 000040   000000 011000                    NOP     0

       66     1927    1       INDX = FID_INDXS(HASH_INDX);

   1927  3 000041   200005 235100                    LDA     HASH_INDX,,AUTO
         3 000042   000001 735000                    ALS     1
         3 000043   000100 100405                    MLR     fill='000'O
         3 000044   000000 000002 xsym               ADSC9   FID_INDXS,A              cn=0,n=2
         3 000045   200024 000004                    ADSC9   DCB$+4,,AUTO             cn=0,n=4
         3 000046   200024 236100                    LDQ     DCB$+4,,AUTO
         3 000047   000022 732000                    QRS     18
         3 000050   200003 470500                    LDP0    @INDX,,AUTO
         3 000051   000000 756100                    STQ     0,,PR0

       67     1928    1       IF INDX = -1 THEN

   1928  3 000052   000004 116000 4                  CMPQ    4
         3 000053   000055 601000 3                  TNZ     s:1932

       68     1929    1           RETURN; /* Retrun with -1 meaning no entry for fid.*/

   1929  3 000054   000000 702200 xent               TSX2  ! X66_ARET

       69     1930    1       ELSE
       70     1931    2       DO FOREVER;

       71     1932    2           IF INDX = -1 THEN

   1932  3 000055   200003 470500                    LDP0    @INDX,,AUTO
         3 000056   000000 235100                    LDA     0,,PR0
         3 000057   000004 115000 4                  CMPA    4
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:13   
         3 000060   000062 601000 3                  TNZ     s:1934

       72     1933    2               RETURN;

   1933  3 000061   000000 702200 xent               TSX2  ! X66_ARET

       73     1934    2           IF FIDLIST.NAME(INDX) = FILE.ID.NAME# AND

   1934  3 000062   000000 236100                    LDQ     0,,PR0
         3 000063   000021 402007                    MPY     17,DL
         3 000064   000002 736000                    QLS     2
         3 000065   000000 471400 xsym               LDP1    FID$
         3 000066   000000 473400 xsym               LDP3    JRNL$
         3 000067   000100 106506                    CMPC    fill='000'O
         3 000070   100000 000040                    ADSC9   0,Q,PR1                  cn=0,n=32
         3 000071   300010 600040                    ADSC9   8,,PR3                   cn=3,n=32
         3 000072   000112 601000 3                  TNZ     s:1939
         3 000073   000000 236100                    LDQ     0,,PR0
         3 000074   000021 402007                    MPY     17,DL
         3 000075   000002 736000                    QLS     2
         3 000076   040100 106506                    CMPC    fill='040'O
         3 000077   100010 000010                    ADSC9   8,Q,PR1                  cn=0,n=8
         3 000100   300003 200010                    ADSC9   3,,PR3                   cn=1,n=8
         3 000101   000112 601000 3                  TNZ     s:1939
         3 000102   000000 236100                    LDQ     0,,PR0
         3 000103   000021 402007                    MPY     17,DL
         3 000104   000002 736000                    QLS     2
         3 000105   040100 106506                    CMPC    fill='040'O
         3 000106   100014 000006                    ADSC9   12,Q,PR1                 cn=0,n=6
         3 000107   300007 200006                    ADSC9   7,,PR3                   cn=1,n=6
         3 000110   000112 601000 3                  TNZ     s:1939

       74     1935    2              FIDLIST.ACCNT#(INDX) = FILE.ID.ACCT# AND
       75     1936    2              FIDLIST.PACK#(INDX) = FILE.ID.PSN# THEN
       76     1937    2               RETURN;

   1937  3 000111   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:14   

       77     1938    2           ELSE
       78     1939    2               INDX = FIDLIST.NXTFID(INDX);

   1939  3 000112   000000 236100                    LDQ     0,,PR0
         3 000113   000021 402007                    MPY     17,DL
         3 000114   100020 236106                    LDQ     16,QL,PR1
         3 000115   000022 736000                    QLS     18
         3 000116   000022 732000                    QRS     18
         3 000117   000000 756100                    STQ     0,,PR0

       79     1940    2           END;

   1940  3 000120   000055 710000 3                  TRA     s:1932

       80     1941
       81     1942    1   STORE_FID: ENTRY(INDX) ALTRET;

   1942  3 000121   000000 700200 xent  STORE_FID    TSX0  ! X66_AUTO_1
         3 000122   000026 000001                    ZERO    22,1

       82     1943    1       CALL HASH_FID;

   1943  3 000123   000371 701000 3                  TSX1    HASH_FID
         3 000124   000000 011000                    NOP     0

       83     1944    1       INDX = FID_INDXS(HASH_INDX);

   1944  3 000125   200005 235100                    LDA     HASH_INDX,,AUTO
         3 000126   000001 735000                    ALS     1
         3 000127   000100 100405                    MLR     fill='000'O
         3 000130   000000 000002 xsym               ADSC9   FID_INDXS,A              cn=0,n=2
         3 000131   200024 000004                    ADSC9   DCB$+4,,AUTO             cn=0,n=4
         3 000132   200024 236100                    LDQ     DCB$+4,,AUTO
         3 000133   000022 732000                    QRS     18
         3 000134   200003 470500                    LDP0    @INDX,,AUTO
         3 000135   000000 756100                    STQ     0,,PR0
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:15   

       84     1945
       85     1946    1       IF FID_INDXS(HASH_INDX) = -1 THEN

   1946  3 000136   000100 100405                    MLR     fill='000'O
         3 000137   000000 000002 xsym               ADSC9   FID_INDXS,A              cn=0,n=2
         3 000140   200024 000004                    ADSC9   DCB$+4,,AUTO             cn=0,n=4
         3 000141   200024 236100                    LDQ     DCB$+4,,AUTO
         3 000142   000022 732000                    QRS     18
         3 000143   000004 116000 4                  CMPQ    4
         3 000144   000154 601000 3                  TNZ     s:1952

       86     1947    2       DO;

       87     1948    2           FID_INDXS(HASH_INDX) = NXT_AVIL_FIDSLOT;

   1948  3 000145   000005 100400                    MLR     fill='000'O
         3 000146   000000 000002 xsym               ADSC9   NXT_AVIL_FIDSLOT         cn=0,n=2
         3 000147   000000 000002 xsym               ADSC9   FID_INDXS,A              cn=0,n=2

       88     1949    2           INDX = NXT_AVIL_FIDSLOT;

   1949  3 000150   000000 236000 xsym               LDQ     NXT_AVIL_FIDSLOT
         3 000151   000022 732000                    QRS     18
         3 000152   000000 756100                    STQ     0,,PR0

       89     1950    2           END;

   1950  3 000153   000202 710000 3                  TRA     s:1962

       90     1951    2       ELSE DO;

       91     1952    3           DO WHILE(INDX ~= -1);

   1952  3 000154   000167 710000 3                  TRA     s:1955

       92     1953    3               TEMP = INDX;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:16   

   1953  3 000155   200003 470500                    LDP0    @INDX,,AUTO
         3 000156   000000 235100                    LDA     0,,PR0
         3 000157   200004 755100                    STA     TEMP,,AUTO

       93     1954    3               INDX = FIDLIST.NXTFID(TEMP);

   1954  3 000160   200004 236100                    LDQ     TEMP,,AUTO
         3 000161   000021 402007                    MPY     17,DL
         3 000162   000000 471400 xsym               LDP1    FID$
         3 000163   100020 236106                    LDQ     16,QL,PR1
         3 000164   000022 736000                    QLS     18
         3 000165   000022 732000                    QRS     18
         3 000166   000000 756100                    STQ     0,,PR0

       94     1955    3               END;

   1955  3 000167   000000 235100                    LDA     0,,PR0
         3 000170   000004 115000 4                  CMPA    4
         3 000171   000155 601000 3                  TNZ     s:1953

       95     1956    2           FIDLIST.NXTFID(TEMP) = NXT_AVIL_FIDSLOT;

   1956  3 000172   200004 236100                    LDQ     TEMP,,AUTO
         3 000173   000021 402007                    MPY     17,DL
         3 000174   000000 220000 xsym               LDX0    NXT_AVIL_FIDSLOT
         3 000175   000000 471400 xsym               LDP1    FID$
         3 000176   100020 440106                    SXL0    16,QL,PR1

       96     1957    2           INDX = NXT_AVIL_FIDSLOT;

   1957  3 000177   000000 235000 xsym               LDA     NXT_AVIL_FIDSLOT
         3 000200   000022 731000                    ARS     18
         3 000201   000000 755100                    STA     0,,PR0

       97     1958    2           END;

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:17   
       98     1959        /*
       99     1960              Increase NXT_AVIL_FIDSLOT by 1 checking you dont go over tbl size.
      100     1961        */
      101     1962    1       NXT_AVIL_FIDSLOT = NXT_AVIL_FIDSLOT + 1;

   1962  3 000202   000000 220000 xsym               LDX0    NXT_AVIL_FIDSLOT
         3 000203   000001 621010                    EAX1    1,X0
         3 000204   000000 741000 xsym               STX1    NXT_AVIL_FIDSLOT

      102     1963    1       IF NXT_AVIL_FIDSLOT > MAX_FIDINDX THEN

   1963  3 000205   000000 236000 xsym               LDQ     NXT_AVIL_FIDSLOT
         3 000206   000022 732000                    QRS     18
         3 000207   000000 116000 xsym               CMPQ    MAX_FIDINDX
         3 000210   000222 604400 3                  TMOZ    s:1971

      103     1964    2       DO;

      104     1965    2           CALL EXPAND_TBL_SEG(,FIDLST#) ALTRET(ALT_EXP);

   1965  3 000211   000010 236000 4                  LDQ     8
         3 000212   000006 235000 4                  LDA     6
         3 000213   200024 757100                    STAQ    DCB$+4,,AUTO
         3 000214   200024 630500                    EPPR0   DCB$+4,,AUTO
         3 000215   000005 631400 4                  EPPR1   5
         3 000216   000000 701000 xent               TSX1    EXPAND_TBL_SEG
         3 000217   000430 702000 3                  TSX2    ALT_EXP

      105     1966    2           MAX_FIDINDX = MAX_FIDINDX + 60;

   1966  3 000220   000074 236007                    LDQ     60,DL
         3 000221   000000 056000 xsym               ASQ     MAX_FIDINDX

      106     1967    2           END;

      107     1968        /*
      108     1969              Do actual storing of the Journal FID into fid FIDLIST.
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:18   
      109     1970        */
      110     1971    1       FIDLIST.NAME(INDX) = FILE.ID.NAME#;

   1971  3 000222   200003 470500                    LDP0    @INDX,,AUTO
         3 000223   000000 236100                    LDQ     0,,PR0
         3 000224   000021 402007                    MPY     17,DL
         3 000225   000002 736000                    QLS     2
         3 000226   000000 471400 xsym               LDP1    JRNL$
         3 000227   000000 473400 xsym               LDP3    FID$
         3 000230   000106 100500                    MLR     fill='000'O
         3 000231   100010 600040                    ADSC9   8,,PR1                   cn=3,n=32
         3 000232   300000 000040                    ADSC9   0,Q,PR3                  cn=0,n=32

      111     1972    1       FIDLIST.ACCNT#(INDX) = FILE.ID.ACCT#;

   1972  3 000233   000000 236100                    LDQ     0,,PR0
         3 000234   000021 402007                    MPY     17,DL
         3 000235   000002 736000                    QLS     2
         3 000236   000000 471400 xsym               LDP1    JRNL$
         3 000237   000000 473400 xsym               LDP3    FID$
         3 000240   040106 100500                    MLR     fill='040'O
         3 000241   100003 200010                    ADSC9   3,,PR1                   cn=1,n=8
         3 000242   300010 000010                    ADSC9   8,Q,PR3                  cn=0,n=8

      112     1973    1       FIDLIST.PASS#(INDX) = FILE.ID.PASS#;

   1973  3 000243   000000 236100                    LDQ     0,,PR0
         3 000244   000021 402007                    MPY     17,DL
         3 000245   000002 736000                    QLS     2
         3 000246   000000 471400 xsym               LDP1    JRNL$
         3 000247   000000 473400 xsym               LDP3    FID$
         3 000250   040106 100500                    MLR     fill='040'O
         3 000251   100005 200010                    ADSC9   5,,PR1                   cn=1,n=8
         3 000252   300012 000010                    ADSC9   10,Q,PR3                 cn=0,n=8

      113     1974    1       FIDLIST.PACK#(INDX) = FILE.ID.PSN#;

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:19   
   1974  3 000253   000000 236100                    LDQ     0,,PR0
         3 000254   000021 402007                    MPY     17,DL
         3 000255   000002 736000                    QLS     2
         3 000256   000000 471400 xsym               LDP1    JRNL$
         3 000257   000000 473400 xsym               LDP3    FID$
         3 000260   040106 100500                    MLR     fill='040'O
         3 000261   100007 200006                    ADSC9   7,,PR1                   cn=1,n=6
         3 000262   300014 000006                    ADSC9   12,Q,PR3                 cn=0,n=6

      114     1975    1       FIDLIST.CRPT_B(INDX) = FILE.CRPT;

   1975  3 000263   000000 236100                    LDQ     0,,PR0
         3 000264   000021 402007                    MPY     17,DL
         3 000265   000000 471400 xsym               LDP1    JRNL$
         3 000266   200024 756100                    STQ     DCB$+4,,AUTO
         3 000267   100002 236100                    LDQ     2,,PR1
         3 000270   000000 473400 xsym               LDP3    FID$
         3 000271   200024 720100                    LXL0    DCB$+4,,AUTO
         3 000272   300016 756110                    STQ     14,X0,PR3

      115     1976    1       FIDLIST.DCB#(INDX) = 0;

   1976  3 000273   000000 236100                    LDQ     0,,PR0
         3 000274   000021 402007                    MPY     17,DL
         3 000275   000000 220003                    LDX0    0,DU
         3 000276   000000 471400 xsym               LDP1    FID$
         3 000277   100017 740106                    STX0    15,QL,PR1

      116     1977    1       FIDLIST.QUE.PRI(INDX) = -1;

   1977  3 000300   000000 236100                    LDQ     0,,PR0
         3 000301   000021 402007                    MPY     17,DL
         3 000302   777777 221003                    LDX1    -1,DU
         3 000303   000000 471400 xsym               LDP1    FID$
         3 000304   100017 441106                    SXL1    15,QL,PR1

      117     1978    1       FIDLIST.QUE.NXT(INDX) = -1;
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:20   

   1978  3 000305   000000 236100                    LDQ     0,,PR0
         3 000306   000021 402007                    MPY     17,DL
         3 000307   000000 471400 xsym               LDP1    FID$
         3 000310   100020 741106                    STX1    16,QL,PR1

      118     1979    1       FIDLIST.NXTFID(INDX) = -1;

   1979  3 000311   000000 236100                    LDQ     0,,PR0
         3 000312   000021 402007                    MPY     17,DL
         3 000313   000000 471400 xsym               LDP1    FID$
         3 000314   100020 441106                    SXL1    16,QL,PR1

      119     1980    1       IF FILE.KEYED = %YES# THEN

   1980  3 000315   000000 471400 xsym               LDP1    JRNL$
         3 000316   100003 234100                    SZN     3,,PR1
         3 000317   000331 605000 3                  TPL     s:1982

      120     1981    1           FIDLIST.ORG#(INDX) = %KEYED#;

   1981  3 000320   000000 236100                    LDQ     0,,PR0
         3 000321   000021 402007                    MPY     17,DL
         3 000322   000000 473400 xsym               LDP3    FID$
         3 000323   000000 622006                    EAX2    0,QL
         3 000324   300015 236106                    LDQ     13,QL,PR3
         3 000325   000011 376000 4                  ANQ     9
         3 000326   002000 276007                    ORQ     1024,DL
         3 000327   300015 756112                    STQ     13,X2,PR3
         3 000330   000370 710000 3                  TRA     s:1988

      121     1982    1       ELSE IF FILE.INDEXED = %YES# THEN

   1982  3 000331   100003 236100                    LDQ     3,,PR1
         3 000332   040000 316003                    CANQ    16384,DU
         3 000333   000345 600000 3                  TZE     s:1984

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:21   
      122     1983    1               FIDLIST.ORG#(INDX) = %INDEXED#;

   1983  3 000334   000000 236100                    LDQ     0,,PR0
         3 000335   000021 402007                    MPY     17,DL
         3 000336   000000 473400 xsym               LDP3    FID$
         3 000337   000000 622006                    EAX2    0,QL
         3 000340   300015 236106                    LDQ     13,QL,PR3
         3 000341   000011 376000 4                  ANQ     9
         3 000342   006000 276007                    ORQ     3072,DL
         3 000343   300015 756112                    STQ     13,X2,PR3
         3 000344   000370 710000 3                  TRA     s:1988

      123     1984    1           ELSE IF FILE.COMGROUP = %YES# THEN

   1984  3 000345   020000 316003                    CANQ    8192,DU
         3 000346   000360 600000 3                  TZE     s:1987

      124     1985    1                   FIDLIST.ORG#(INDX) = %CG#;

   1985  3 000347   000000 236100                    LDQ     0,,PR0
         3 000350   000021 402007                    MPY     17,DL
         3 000351   000000 473400 xsym               LDP3    FID$
         3 000352   000000 622006                    EAX2    0,QL
         3 000353   300015 236106                    LDQ     13,QL,PR3
         3 000354   000011 376000 4                  ANQ     9
         3 000355   013000 276007                    ORQ     5632,DL
         3 000356   300015 756112                    STQ     13,X2,PR3
         3 000357   000370 710000 3                  TRA     s:1988

      125     1986    1               ELSE
      126     1987    1                   FIDLIST.ORG#(INDX) = %IDS#;

   1987  3 000360   000000 236100                    LDQ     0,,PR0
         3 000361   000021 402007                    MPY     17,DL
         3 000362   000000 473400 xsym               LDP3    FID$
         3 000363   000000 622006                    EAX2    0,QL
         3 000364   300015 236106                    LDQ     13,QL,PR3
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:22   
         3 000365   000011 376000 4                  ANQ     9
         3 000366   007000 276007                    ORQ     3584,DL
         3 000367   300015 756112                    STQ     13,X2,PR3

      127     1988    1       RETURN;

   1988  3 000370   000000 702200 xent               TSX2  ! X66_ARET

      128     1989
      129     1990    1   HASH_FID: PROC;

   1990  3 000371   200022 741300       HASH_FID     STX1  ! DCB$+2,,AUTO

      130     1991    2       FID.N = FILE.ID.NAME#;

   1991  3 000372   000000 470400 xsym               LDP0    JRNL$
         3 000373   000100 100500                    MLR     fill='000'O
         3 000374   000010 600040                    ADSC9   8,,PR0                   cn=3,n=32
         3 000375   200006 000040                    ADSC9   FID,,AUTO                cn=0,n=32

      131     1992    2       FID.A = FILE.ID.ACCT#;

   1992  3 000376   040100 100500                    MLR     fill='040'O
         3 000377   000003 200010                    ADSC9   3,,PR0                   cn=1,n=8
         3 000400   200016 000010                    ADSC9   FID+8,,AUTO              cn=0,n=8

      132     1993    2       HASH_INDX = MOD(BITBIN(BINBIT(HASH(0)+HASH(1)+HASH(2)+HASH(3)+

   1993  3 000401   200006 236100                    LDQ     FID,,AUTO
         3 000402   200007 036100                    ADLQ    FID+1,,AUTO
         3 000403   200010 036100                    ADLQ    FID+2,,AUTO
         3 000404   200011 036100                    ADLQ    FID+3,,AUTO
         3 000405   200012 036100                    ADLQ    FID+4,,AUTO
         3 000406   200013 036100                    ADLQ    FID+5,,AUTO
         3 000407   200014 036100                    ADLQ    FID+6,,AUTO
         3 000410   200015 036100                    ADLQ    FID+7,,AUTO
         3 000411   200016 036100                    ADLQ    FID+8,,AUTO
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:23   
         3 000412   200017 036100                    ADLQ    FID+9,,AUTO
         3 000413   000003 376000 2                  ANQ     ROLL_NAME+3
         3 000414   000425 605000 3                  TPL     s:1993+20
         3 000415   000001 235000 xsym               LDA     NO+1
         3 000416   000001 405007                    CMG     1,DL
         3 000417   000423 600000 3                  TZE     s:1993+18
         3 000420   000000 235003                    LDA     0,DU
         3 000421   000001 737000                    LLS     1
         3 000422   000001 507000 xsym               DVF     NO+1
         3 000423   000044 737000                    LLS     36
         3 000424   000426 710000 3                  TRA     s:1993+21
         3 000425   000001 506000 xsym               DIV     NO+1
         3 000426   200005 755100                    STA     HASH_INDX,,AUTO

      133     1994    2          HASH(4)+HASH(5)+HASH(6)+HASH(7)+
      134     1995    2          HASH(8)+HASH(9),36)
      135     1996    2          & '377777777777'O),
      136     1997    2          NO.HASHFIDS);
      137     1998    2       RETURN;

   1998  3 000427   000001 702211                    TSX2  ! 1,X1

      138     1999    2   END HASH_FID;
      139     2000
      140     2001    1   ALT_EXP:
      141     2002    1       ALTRETURN;

   2002  3 000430   000000 702200 xent  ALT_EXP      TSX2  ! X66_AALT

      142     2003    1   ALT_ERR:
      143     2004    1       MONITOR_ERR = B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;

   2004  3 000431   000000 470400 xsym  ALT_ERR      LDP0    B$TCB$
         3 000432   000000 471500                    LDP1    0,,PR0
         3 000433   100102 236100                    LDQ     66,,PR1
         3 000434   000000 756000 xsym               STQ     MSGCODE

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:24   
      144     2005    1       INCL_ERR = %YES#;

   2005  3 000435   400000 236003                    LDQ     -131072,DU
         3 000436   000000 756000 xsym               STQ     INCL_ERR

      145     2006    1       CALL SYS_FUNC_ERRMSG;

   2006  3 000437   000012 631400 4                  EPPR1   10
         3 000440   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         3 000441   000000 011000                    NOP     0

      146     2007    1       CALL DE_QUE(FIDX);

   2007  3 000442   000014 630400 4                  EPPR0   12
         3 000443   000013 631400 4                  EPPR1   11
         3 000444   000000 701000 xent               TSX1    DE_QUE
         3 000445   000000 011000                    NOP     0

      147     2008    1       FIDLIST.DCB#(FIDX) = 0;

   2008  3 000446   000000 236000 xsym               LDQ     FIDX
         3 000447   000021 402007                    MPY     17,DL
         3 000450   000000 220003                    LDX0    0,DU
         3 000451   000000 470400 xsym               LDP0    FID$
         3 000452   000017 740106                    STX0    15,QL,PR0

      148     2009    1       CALL SYS_FUNC_RELDCB;

   2009  3 000453   000012 631400 4                  EPPR1   10
         3 000454   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         3 000455   000000 011000                    NOP     0

      149     2010    1       ALTRETURN;

   2010  3 000456   000000 702200 xent               TSX2  ! X66_AALT

GETROLLDCB_FPT
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:25   
 Sect OctLoc
   1     000   000001 777640   000006 006000   000002 177640   000000 006000    ................
   1     004   000000 177640   000000 006014   000000 400000   000000 000000    ................

ROLL_NAME
 Sect OctLoc
   2     000   010122 117114   114101 103103   124*** ******                    .ROLLACCT...

(unnamed)
 Sect OctLoc
   2     003   377777 777777                                                    ....

(unnamed)
 Sect OctLoc
   4     000   000000 006003   000000 000000   040040 040040   040040 040040    ........
   4     004   777777 777777   000002 000000   000000 006014   000000 000001    ................
   4     010   000007 006000   777777 000777   000000 000000   000001 000000    ................
   4     014   000000 006000                                                    ....
      150     2011    1   END ZIU$HASHFID;

PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:26   
--  Include file information  --

   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$HASHFID.

   Procedure ZIU$HASHFID requires 303 words for executable code.
   Procedure ZIU$HASHFID requires 22 words of local(AUTO) storage.

    No errors detected in file ZIU$HASHFID.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:27   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:28   
          MINI XREF LISTING

ALT_ERR
      2004**LABEL    1917--CALLALT
ALT_EXP
      2002**LABEL    1965--CALLALT
B$EXCFR.ASL
      1059**DCL      1059--REDEF
B$EXCFR.ERR
      1073**DCL      2004>>ASSIGN
B$EXCFR.ERR.ERR#
      1073**DCL      1073--REDEF
B$EXCFR.EVID
      1072**DCL      1072--REDEF    1073--REDEF
B$EXCFR.IR
      1060**DCL      1060--REDEF
B$EXCFR.PREVSZ
      1059**DCL      1059--REDEF
B$EXCFR.SUBC
      1071**DCL      1071--REDEF    1072--REDEF    1072--REDEF
B$TCB.ALT$
      1056**DCL      2004>>ASSIGN
B$TCB$
        26**DCL      2004>>ASSIGN
BERC.DCB#
       182**DCL       183--REDEF
COUNTSF
      1855**DCL      1856--REDEF
DCB$
        25**DCL      1919<<ASSIGN   1920>>IF       1922>>ASSIGN   1923>>IF       1925>>ASSIGN
DCBLIST$
       306**DCL       329--IMP-PTR
DCBSF
      1784**DCL      1918<<ASSIGN   1919--ASSIGN
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:29   
DE_QUE
        29**DCL-ENT  2007--CALL
ENCRP_SEEDSF
      1813**DCL      1814--REDEF
ERRCODESF
      1815**DCL      1820--REDEF
EXPAND_TBL_SEG
        24**DCL-ENT  1965--CALL
F$DCB.ACCT#
      1015**DCL      1920>>IF       1922>>ASSIGN
F$DCB.ACTPOS
      1031**DCL      1031--REDEF
F$DCB.ARS#
      1005**DCL      1005--REDEF
F$DCB.ATTR
      1024**DCL      1025--REDEF
F$DCB.BORROW
      1039**DCL      1039--REDEF    1039--REDEF    1039--REDEF
F$DCB.DCBNAME.L
      1053**DCL      1053--IMP-SIZ
F$DCB.EOMCHAR#
      1009**DCL      1009--REDEF
F$DCB.FLDID
      1034**DCL      1034--REDEF
F$DCB.FORM$
      1028**DCL      1028--REDEF
F$DCB.FSECT
      1044**DCL      1044--REDEF
F$DCB.FSN#
      1021**DCL      1021--REDEF    1021--REDEF    1022--REDEF
F$DCB.HEADER$
      1027**DCL      1027--REDEF
F$DCB.IXTNSIZE#
      1025**DCL      1025--REDEF
F$DCB.LASTSTA$
      1014**DCL      1014--REDEF
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:30   
F$DCB.LVL
      1040**DCL      1040--REDEF
F$DCB.NAME#.C
      1015**DCL      1015--REDEF
F$DCB.NOEOF
      1037**DCL      1037--REDEF
F$DCB.NRECS#
      1026**DCL      1026--REDEF
F$DCB.NRECX
      1045**DCL      1045--REDEF
F$DCB.OHDR
      1037**DCL      1037--REDEF
F$DCB.ORG#
      1020**DCL      1020--REDEF
F$DCB.PRECNO
      1043**DCL      1043--REDEF
F$DCB.PSN#
      1015**DCL      1923>>IF       1925>>ASSIGN
F$DCB.RCSZ
      1049**DCL      1049--REDEF
F$DCB.RES#
      1016**DCL      1016--REDEF
F$DCB.SETX
      1028**DCL      1028--REDEF
F$DCB.TAB$
      1028**DCL      1028--REDEF
F$DCB.TDA
      1042**DCL      1043--REDEF
F$DCB.WSN#
      1016**DCL      1016--REDEF
FID
        17**DCL        22--REDEF
FID.A
        21**DCL      1992<<ASSIGN
FID.N
        18**DCL      1991<<ASSIGN
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:31   
FID$
       305**DCL       309--IMP-PTR  1934>>IF       1934>>IF       1934>>IF       1939>>ASSIGN   1954>>ASSIGN
      1956>>ASSIGN   1971>>ASSIGN   1972>>ASSIGN   1973>>ASSIGN   1974>>ASSIGN   1975>>ASSIGN   1976>>ASSIGN
      1977>>ASSIGN   1978>>ASSIGN   1979>>ASSIGN   1981>>ASSIGN   1983>>ASSIGN   1985>>ASSIGN   1987>>ASSIGN
      2008>>ASSIGN
FIDLIST.ACCNT#
       313**DCL      1934>>IF       1972<<ASSIGN
FIDLIST.CRPT
       318**DCL       319--REDEF
FIDLIST.CRPT_B
       319**DCL      1975<<ASSIGN
FIDLIST.DCB#
       320**DCL      1976<<ASSIGN   2008<<ASSIGN
FIDLIST.NAME
       310**DCL      1934>>IF       1971<<ASSIGN
FIDLIST.NXTFID
       324**DCL      1939>>ASSIGN   1954>>ASSIGN   1956<<ASSIGN   1979<<ASSIGN
FIDLIST.ORG#
       316**DCL      1981<<ASSIGN   1983<<ASSIGN   1985<<ASSIGN   1987<<ASSIGN
FIDLIST.PACK#
       315**DCL      1934>>IF       1974<<ASSIGN
FIDLIST.PASS#
       314**DCL      1973<<ASSIGN
FIDLIST.QUE.NXT
       323**DCL      1978<<ASSIGN
FIDLIST.QUE.PRI
       322**DCL      1977<<ASSIGN
FIDSF_RD
      1831**DCL      1832--REDEF
FIDX
       353**DCL      2007<>CALL     2008>>ASSIGN
FID_INDXS
       325**DCL      1927>>ASSIGN   1944>>ASSIGN   1946>>IF       1948<<ASSIGN
FILE.COMGROUP
       151**DCL      1984>>IF
FILE.CRPT
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:32   
       146**DCL      1975>>ASSIGN
FILE.ID.ACCT#
       155**DCL      1922<<ASSIGN   1934>>IF       1972>>ASSIGN   1992>>ASSIGN
FILE.ID.NAME#
       158**DCL      1934>>IF       1971>>ASSIGN   1991>>ASSIGN
FILE.ID.PASS#
       156**DCL      1973>>ASSIGN
FILE.ID.PSN#
       157**DCL      1925<<ASSIGN   1934>>IF       1974>>ASSIGN
FILE.INDEXED
       150**DCL      1982>>IF
FILE.KEYED
       147**DCL      1980>>IF
GETROLLDCB_FPT
      1877**DCL      1917<>CALL
GETROLLDCB_FPT.V
      1878**DCL      1877--DCLINIT
GETROLLDCB_FPT.V.DCB#
      1878**DCL      1918>>ASSIGN
HASH
        22**DCL      1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN
      1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN   1993>>ASSIGN
HASH_FID
      1990**PROC     1926--CALL     1943--CALL
HASH_INDX
        16**DCL      1927>>ASSIGN   1944>>ASSIGN   1946>>IF       1948>>ASSIGN   1993<<ASSIGN
HELPCODE
      1849**DCL      1854--REDEF
INCL_ERR
      1827**DCL      2005<<ASSIGN
INDX
        13**DCL         7--PROC     1908--ENTRY    1927<<ASSIGN   1928>>IF       1932>>IF       1934>>IF
      1934>>IF       1934>>IF       1939<<ASSIGN   1939>>ASSIGN   1942--ENTRY    1944<<ASSIGN   1949<<ASSIGN
      1952>>DOWHILE  1953>>ASSIGN   1954<<ASSIGN   1957<<ASSIGN   1971>>ASSIGN   1972>>ASSIGN   1973>>ASSIGN
      1974>>ASSIGN   1975>>ASSIGN   1976>>ASSIGN   1977>>ASSIGN   1978>>ASSIGN   1979>>ASSIGN   1981>>ASSIGN
      1983>>ASSIGN   1985>>ASSIGN   1987>>ASSIGN
PL6.E3A0      #001=ZIU$HASHFID File=ZIU$HASHFID.:ZIC0TSI                         FRI 09/05/97 13:15 Page:33   
JREC.LENGTH
       167**DCL       170--IMP-SIZ
JRNL$
       140**DCL       141--IMP-PTR   161--IMP-PTR   171--IMP-PTR   178--IMP-PTR   184--IMP-PTR  1922>>ASSIGN
      1925>>ASSIGN   1934>>IF       1934>>IF       1934>>IF       1971>>ASSIGN   1972>>ASSIGN   1973>>ASSIGN
      1974>>ASSIGN   1975>>ASSIGN   1980>>IF       1982>>IF       1984>>IF       1991>>ASSIGN   1992>>ASSIGN
KEYVSF
      1787**DCL      1792--REDEF
KEYVSF.WD_ONE
      1789**DCL      1790--REDEF
M$GETDCB
       932**DCL-ENT  1917--CALL
MAX_FIDINDX
       351**DCL      1963>>IF       1966<<ASSIGN   1966>>ASSIGN
MONITOR_ERR
      1822**DCL      2004<<ASSIGN
MSGCODE
      1821**DCL      1822--REDEF
NO.HASHFIDS
       343**DCL      1993>>ASSIGN
NXT_AVIL_FIDSLOT
       326**DCL      1948>>ASSIGN   1949>>ASSIGN   1956>>ASSIGN   1957>>ASSIGN   1962<<ASSIGN   1962>>ASSIGN
      1963>>IF
ROLL_NAME
      1906**DCL      1877--DCLINIT
SYS_FUNC_ERRMSG
        27**DCL-ENT  2006--CALL
SYS_FUNC_RELDCB
        28**DCL-ENT  2009--CALL
TEMP
        15**DCL      1953<<ASSIGN   1954>>ASSIGN   1956>>ASSIGN
