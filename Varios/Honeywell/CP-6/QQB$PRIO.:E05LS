VERSION E05

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:1    
        1        1        /*M* QQB$PRIO - Perform  PRIO  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$PRIO:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE XU_MACRO_C;
       16     3256        %INCLUDE QQ_SUBS_C;
       17     3448        %INCLUDE QQ_MACROS_C;
       18     3873        %INCLUDE QQ_DATA_R;
       19     4119        %INCLUDE QQ_PERR_C;
       20     4280        %INCLUDE Q_ERRCODE_C;
       21     4303        %PAGE(ARG="Externally defined routines");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                        Externally defined routines                      *
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328    1   DCL QQC$SCREECH ENTRY;
       23     4329    1   DCL QQC$BLDMSG_BLK ENTRY(1);
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:2    
       24     4330    1   DCL QQC$BLDMSG ENTRY(1);
       25     4331    1   DCL QQC$FINDSTA ENTRY(3);
       26     4332    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       27     4333        %PAGE(ARG="Symrefs");

              4350    1   /***************************************************************************
              4351    1    *                                                                         *
              4352    1    *                                  Symrefs                                *
              4353    1    *                                                                         *
              4354    1    ***************************************************************************/

       28     4358    1   DCL B$TCB$ PTR SYMREF;
       29     4359        %PAGE(ARG="DCBs");

              4376    1   /***************************************************************************
              4377    1    *                                                                         *
              4378    1    *                                    DCBs                                 *
              4379    1    *                                                                         *
              4380    1    ***************************************************************************/

       30     4384    1   DCL M$CG DCB;
       31     4385        %PAGE(ARG="Based");

              4402    1   /***************************************************************************
              4403    1    *                                                                         *
              4404    1    *                                   Based                                 *
              4405    1    *                                                                         *
              4406    1    ***************************************************************************/

       32     4410        %B$TCB;
       33     4413        %B$ALT;
       34     4421        %TP$STATION;
       35     4494        %PARSE$OUT(STCLASS=BASED);
       36     4539        %PARSE$SYM(STCLASS=BASED);
       37     4577        %PAGE(ARG="Auto");

              4594    1   /***************************************************************************
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:3    
              4595    1    *                                                                         *
              4596    1    *                                    Auto                                 *
              4597    1    *                                                                         *
              4598    1    ***************************************************************************/

       38     4602        %MSGBLK;
       39     4692
       40     4693    1   DCL STATION$ PTR;
       41     4694    1   DCL PRIO$ PTR;
       42     4695
       43     4696    1   DCL GROUP_FLAG BIT(1) ALIGNED;
       44     4697    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       45     4698
       46     4699    1   DCL MULTIPLIER SBIN WORD;
       47     4700    1   DCL DELTA UBIN WORD;
       48     4701    1   DCL I SBIN WORD;
       49     4702    1   DCL POS UBIN WORD;
       50     4703    1   DCL NEW_PRIO SBIN WORD;
       51     4704
       52     4705    1   DCL STATION CHAR(8);
       53     4706        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:4    
              4723    1   /***************************************************************************
              4724    1    *                                                                         *
              4725    1    *                                Error codes                              *
              4726    1    *                                                                         *
              4727    1    ***************************************************************************/

       54     4731        %ERRCODE(NAME=CODE_ONLYOU, CODE#=%E$ONLYOU, FCG#=%FCG_QQ, MID#=%MID_B);
       55     4738        %ERRCODE(NAME=CODE_NOTON, CODE#=%E$NOTON, FCG#=%FCG_QQ, MID#=%MID_B);
       56     4745        %ERRCODE(NAME=CODE_DFLT_PRIO, CODE#=%E$DFLT_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
       57     4752        %ERRCODE(NAME=CODE_BIGGEST_PRIO, CODE#=%E$BIGGEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
       58     4759        %ERRCODE(NAME=CODE_SMALLEST_PRIO, CODE#=%E$SMALLEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B)
              4759            ;
       59     4766
       60     4767        /*E*       ERROR: QQB-E$ONLYOU-C
       61     4768
       62     4769                 MESSAGE: You are not permitted to modify another station's
       63     4770                          priority.
       64     4771             DESCRIPTION: Non privileged and non MCT stations can only
       65     4772                          modify their own priority.
       66     4773        */
       67     4774        /*E*       ERROR: QQB-E$NOTON-C
       68     4775
       69     4776                 MESSAGE: That station is not logged on.  The DEFAULT
       70     4777                          or +- suboptions may only be specified for
       71     4778                          stations that are logged on.
       72     4779             DESCRIPTION: These two suboptions can't be used here
       73     4780                          because we do not know the default or current
       74     4781                          priority of stations that are not logged on.
       75     4782        */
       76     4783        /*E*       ERROR: QQB-E$DFLT_PRIO-C
       77     4784
       78     4785                 MESSAGE: As a non-privileged station you cannot change
       79     4786                          your priority so that it would be greater than
       80     4787                          your default priority.  Thus, your priority is
       81     4788                          now your default priority.
       82     4789             DESCRIPTION: A non privileged non MCT station tried to
       83     4790                          change his priority to be > than his default
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:5    
       84     4791                          priority.  His current priority is now his
       85     4792                          default priority.
       86     4793        */
       87     4794        /*E*       ERROR: QQB-E$BIGGEST_PRIO-C
       88     4795
       89     4796                 MESSAGE: The value for priority may not exceed 500.
       90     4797                          500 has been substituted.
       91     4798             DESCRIPTION: A specified value for priority was illegal.
       92     4799                          The largest permissible value was substituted.
       93     4800        */
       94     4801        /*E*       ERROR: QQB-E$SMALLEST_PRIO-C
       95     4802
       96     4803                 MESSAGE: The value for priority may not be less than 1.
       97     4804                          1 has been substituted.
       98     4805             DESCRIPTION: A specified value for priority was illegal.
       99     4806                          The smallest permissible value was substituted.
      100     4807        */
      101     4808        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:6    
              4825    1   /***************************************************************************
              4826    1    *                                                                         *
              4827    1    *                                    FPTs                                 *
              4828    1    *                                                                         *
              4829    1    ***************************************************************************/

      102     4833        %FPT_CGCTL(DCB=M$CG, STALIST=VLP_CGSTAL);
      103     4856        %PAGE(ARG="VLPs");

              4873    1   /***************************************************************************
              4874    1    *                                                                         *
              4875    1    *                                    VLPs                                 *
              4876    1    *                                                                         *
              4877    1    ***************************************************************************/

      104     4881        %VLP_CGSTAL;
      105     4906        %PAGE(ARG="QQB$PRIO", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:7    
              4923    1   /***************************************************************************
              4924    1    *                                                                         *
              4925    1    *                                  QQB$PRIO                               *
              4926    1    *                                                                         *
              4927    1    ***************************************************************************/

      106     4931    1           STATION$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0);
      107     4932    1           STATION = STATION$ -> OUT$SYM.TEXT;
      108     4933    1           PRIO$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(1);
      109     4934    1           GROUP_FLAG = '0'B;
      110     4935
      111     4936    1           CALL INDEX(POS, '?', STATION) ALTRET(NO_Q);
      112     4937    1           GROUP_FLAG = '1'B;
      113     4938
      114     4939    1   NO_Q:
      115     4940    1           IF NOT  QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND
      116     4941    1               (GROUP_FLAG OR QQ_CMDBLK.S$ -> TP$STATION.ID ~=
      117     4942    1               STATION) THEN
      118     4943    2             DO;
      119     4944    2               QQ_CMDBLK.MINOR_ERR = CODE_ONLYOU;
      120     4945    2               GOTO PRINT_ERR;
      121     4946    2             END;
      122     4947
      123     4948    1           IF NOT GROUP_FLAG THEN
      124     4949    2             DO;
      125     4950    2               CALL QQC$FINDSTA(STATION, S$, FOUND_FLAG);
      126     4951    2               IF NOT FOUND_FLAG THEN
      127     4952    3                 DO;
      128     4953    3                   S$ = ADDR(NIL);
      129     4954    3                 END;
      130     4955    2               VLP_CGSTAL.LIST.NAME#(0) = STATION;
      131     4956    2               CALL CHANGE_PRIO ALTRET(PRINT_ERR);
      132     4957    2             END;
      133     4958    1           ELSE
      134     4959    2             DO;
      135     4960    3               DO I = 1 TO QQ_GLOBAL.STATION_CNT;
      136     4961    3                 S$ = PINCRW(QQ_GLOBAL.STATION$, (I - 1) * SIZEW(TP$STATION));
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:8    
      137     4962    3                 CALL QQC$WILD_COMP(STATION, TP$STATION.ID) ALTRET(LOOP);
      138     4963    3                 VLP_CGSTAL.LIST.NAME#(0) = TP$STATION.ID;
      139     4964    3                 CALL CHANGE_PRIO ALTRET(PRINT_ERR);
      140     4965
      141     4966    3   LOOP:
      142     4967    3               END;
      143     4968    2             END;
      144     4969    1           GOTO RET;
      145     4970
      146     4971    1   PRINT_ERR:
      147     4972    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      148     4973    1           CALL QQC$BLDMSG(MSGBLK);
      149     4974
      150     4975    1   RET:
      151     4976    1           RETURN;
      152     4977                %PAGE(ARG="CHANGE_PRIO", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:9    
              4994    1   /***************************************************************************
              4995    1    *                                                                         *
              4996    1    *                                CHANGE_PRIO                              *
              4997    1    *                                                                         *
              4998    1    ***************************************************************************/

      153     5002    1   CHANGE_PRIO:
      154     5003    1           PROC ALTRET;
      155     5004
      156     5005    2           IF S$ = ADDR(NIL) AND
      157     5006    2               (PRIO$ -> OUT$SYM.CODE = 1 /* Default */ OR
      158     5007    2               PRIO$ -> OUT$BLK.NSUBLKS = 2) THEN
      159     5008    3             DO;
      160     5009    3               QQ_CMDBLK.MINOR_ERR = CODE_NOTON;
      161     5010    3               GOTO ALT;
      162     5011    3             END;
      163     5012
      164     5013    2           IF PRIO$ -> OUT$SYM.CODE = 1 /* Default */ THEN
      165     5014    3             DO;
      166     5015    3               NEW_PRIO = TP$STATION.DFLT_PRIO;
      167     5016    3               GOTO SET_PRIO;
      168     5017    3             END;
      169     5018
      170     5019    2           IF PRIO$ -> OUT$BLK.NSUBLKS = 1 THEN
      171     5020    3             DO;
      172     5021    3               CALL CHARBIN(NEW_PRIO, PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      173     5022    3               GOTO SET_PRIO;
      174     5023    3             END;
      175     5024
      176     5025    2           NEW_PRIO = TP$STATION.CURR_PRIO;
      177     5026    2           MULTIPLIER = 1;
      178     5027
      179     5028    2           IF PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN
      180     5029    3             DO;
      181     5030    3               MULTIPLIER = -1;
      182     5031    3             END;
      183     5032
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:10   
      184     5033    2           CALL CHARBIN(DELTA, PRIO$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      185     5034
      186     5035    2           NEW_PRIO = NEW_PRIO + DELTA * MULTIPLIER;
      187     5036
      188     5037    2   SET_PRIO:
      189     5038    2           IF NOT  QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND
      190     5039    2               NEW_PRIO > QQ_CMDBLK.S$ -> TP$STATION.DFLT_PRIO THEN
      191     5040    3             DO;
      192     5041    3               NEW_PRIO = QQ_CMDBLK.S$ -> TP$STATION.DFLT_PRIO;
      193     5042    3               QQ_CMDBLK.MINOR_ERR = CODE_DFLT_PRIO;
      194     5043    3               CALL QQC$BLDMSG_BLK(MSGBLK);
      195     5044    3               CALL QQC$BLDMSG(MSGBLK);
      196     5045    3             END;
      197     5046
      198     5047    2           IF NEW_PRIO > 500 THEN
      199     5048    3             DO;
      200     5049    3               NEW_PRIO = 500;
      201     5050    3               QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_PRIO;
      202     5051    3               CALL QQC$BLDMSG_BLK(MSGBLK);
      203     5052    3               CALL QQC$BLDMSG(MSGBLK);
      204     5053    3             END;
      205     5054
      206     5055    2           IF NEW_PRIO < 1 THEN
      207     5056    3             DO;
      208     5057    3               NEW_PRIO = 1;
      209     5058    3               QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_PRIO;
      210     5059    3               CALL QQC$BLDMSG_BLK(MSGBLK);
      211     5060    3               CALL QQC$BLDMSG(MSGBLK);
      212     5061    3             END;
      213     5062
      214     5063    2           VLP_CGSTAL.LIST.PRIO#(0) = NEW_PRIO;
      215     5064    2           CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);
      216     5065
      217     5066    2           IF S$ ~= ADDR(NIL) THEN
      218     5067    3             DO;
      219     5068    3               TP$STATION.CURR_PRIO = NEW_PRIO;
      220     5069    3             END;
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:11   
      221     5070
      222     5071    2           GOTO RET;
      223     5072
      224     5073    2   ALT:
      225     5074    2           ALTRETURN;
      226     5075
      227     5076    2   RET:
      228     5077    2           RETURN;
      229     5078
      230     5079    2   MON_ERR:
      231     5080    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      232     5081    2           CALL QQC$SCREECH;
      233     5082    2   END CHANGE_PRIO;
      234     5083    1   END QQB$PRIO;

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:12   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$PRIO.

   Procedure QQB$PRIO requires 240 words for executable code.
   Procedure QQB$PRIO requires 42 words of local(AUTO) storage.

    No errors detected in file QQB$PRIO.:E05TSI    .

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:13   

 Object Unit name= QQB$PRIO                                   File name= QQB$PRIO.:E05TOU
 UTS= JUL 30 '97 05:34:14.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2  RoData even  UTS      5      5  QQB$PRIO
    3   Data  even  none    62     76  QQB$PRIO
    4   Proc  even  none   240    360  QQB$PRIO
    5  RoData even  none     1      1  QQB$PRIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQB$PRIO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 QQC$FINDSTA
 yes     yes           Std       2 QQC$WILD_COMP
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       0 QQC$SCREECH
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     B$TCB$                                M$CG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:15   


        1        1        /*M* QQB$PRIO - Perform  PRIO  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$PRIO:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QQB$PRIO     TSX0  ! X66_AUTO_0
         4 000001   000052 000000                    ZERO    42,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE XU_MACRO_C;
       16     3256        %INCLUDE QQ_SUBS_C;
       17     3448        %INCLUDE QQ_MACROS_C;
       18     3873        %INCLUDE QQ_DATA_R;
       19     4119        %INCLUDE QQ_PERR_C;
       20     4280        %INCLUDE Q_ERRCODE_C;
       21     4303        %PAGE(ARG="Externally defined routines");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:16   
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328    1   DCL QQC$SCREECH ENTRY;
       23     4329    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       24     4330    1   DCL QQC$BLDMSG ENTRY(1);
       25     4331    1   DCL QQC$FINDSTA ENTRY(3);
       26     4332    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       27     4333        %PAGE(ARG="Symrefs");

              4350    1   /***************************************************************************
              4351    1    *                                                                         *
              4352    1    *                                  Symrefs                                *
              4353    1    *                                                                         *
              4354    1    ***************************************************************************/

       28     4358    1   DCL B$TCB$ PTR SYMREF;
       29     4359        %PAGE(ARG="DCBs");

              4376    1   /***************************************************************************
              4377    1    *                                                                         *
              4378    1    *                                    DCBs                                 *
              4379    1    *                                                                         *
              4380    1    ***************************************************************************/

       30     4384    1   DCL M$CG DCB;
       31     4385        %PAGE(ARG="Based");

              4402    1   /***************************************************************************
              4403    1    *                                                                         *
              4404    1    *                                   Based                                 *
              4405    1    *                                                                         *
              4406    1    ***************************************************************************/

       32     4410        %B$TCB;
       33     4413        %B$ALT;
       34     4421        %TP$STATION;
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:17   
       35     4494        %PARSE$OUT(STCLASS=BASED);
       36     4539        %PARSE$SYM(STCLASS=BASED);
       37     4577        %PAGE(ARG="Auto");

              4594    1   /***************************************************************************
              4595    1    *                                                                         *
              4596    1    *                                    Auto                                 *
              4597    1    *                                                                         *
              4598    1    ***************************************************************************/

       38     4602        %MSGBLK;
       39     4692
       40     4693    1   DCL STATION$ PTR;
       41     4694    1   DCL PRIO$ PTR;
       42     4695
       43     4696    1   DCL GROUP_FLAG BIT(1) ALIGNED;
       44     4697    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       45     4698
       46     4699    1   DCL MULTIPLIER SBIN WORD;
       47     4700    1   DCL DELTA UBIN WORD;
       48     4701    1   DCL I SBIN WORD;
       49     4702    1   DCL POS UBIN WORD;
       50     4703    1   DCL NEW_PRIO SBIN WORD;
       51     4704
       52     4705    1   DCL STATION CHAR(8);
       53     4706        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:18   
              4723    1   /***************************************************************************
              4724    1    *                                                                         *
              4725    1    *                                Error codes                              *
              4726    1    *                                                                         *
              4727    1    ***************************************************************************/

       54     4731        %ERRCODE(NAME=CODE_ONLYOU, CODE#=%E$ONLYOU, FCG#=%FCG_QQ, MID#=%MID_B);
       55     4738        %ERRCODE(NAME=CODE_NOTON, CODE#=%E$NOTON, FCG#=%FCG_QQ, MID#=%MID_B);
       56     4745        %ERRCODE(NAME=CODE_DFLT_PRIO, CODE#=%E$DFLT_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
       57     4752        %ERRCODE(NAME=CODE_BIGGEST_PRIO, CODE#=%E$BIGGEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
       58     4759       %ERRCODE(NAME=CODE_SMALLEST_PRIO, CODE#=%E$SMALLEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B)
              4759            ;
       59     4766
       60     4767        /*E*       ERROR: QQB-E$ONLYOU-C
       61     4768
       62     4769                 MESSAGE: You are not permitted to modify another station's
       63     4770                          priority.
       64     4771             DESCRIPTION: Non privileged and non MCT stations can only
       65     4772                          modify their own priority.
       66     4773        */
       67     4774        /*E*       ERROR: QQB-E$NOTON-C
       68     4775
       69     4776                 MESSAGE: That station is not logged on.  The DEFAULT
       70     4777                          or +- suboptions may only be specified for
       71     4778                          stations that are logged on.
       72     4779             DESCRIPTION: These two suboptions can't be used here
       73     4780                          because we do not know the default or current
       74     4781                          priority of stations that are not logged on.
       75     4782        */
       76     4783        /*E*       ERROR: QQB-E$DFLT_PRIO-C
       77     4784
       78     4785                 MESSAGE: As a non-privileged station you cannot change
       79     4786                          your priority so that it would be greater than
       80     4787                          your default priority.  Thus, your priority is
       81     4788                          now your default priority.
       82     4789             DESCRIPTION: A non privileged non MCT station tried to
       83     4790                          change his priority to be > than his default
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:19   
       84     4791                          priority.  His current priority is now his
       85     4792                          default priority.
       86     4793        */
       87     4794        /*E*       ERROR: QQB-E$BIGGEST_PRIO-C
       88     4795
       89     4796                 MESSAGE: The value for priority may not exceed 500.
       90     4797                          500 has been substituted.
       91     4798             DESCRIPTION: A specified value for priority was illegal.
       92     4799                          The largest permissible value was substituted.
       93     4800        */
       94     4801        /*E*       ERROR: QQB-E$SMALLEST_PRIO-C
       95     4802
       96     4803                 MESSAGE: The value for priority may not be less than 1.
       97     4804                          1 has been substituted.
       98     4805             DESCRIPTION: A specified value for priority was illegal.
       99     4806                          The smallest permissible value was substituted.
      100     4807        */
      101     4808        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:20   
              4825    1   /***************************************************************************
              4826    1    *                                                                         *
              4827    1    *                                    FPTs                                 *
              4828    1    *                                                                         *
              4829    1    ***************************************************************************/

      102     4833        %FPT_CGCTL(DCB=M$CG, STALIST=VLP_CGSTAL);
      103     4856        %PAGE(ARG="VLPs");

              4873    1   /***************************************************************************
              4874    1    *                                                                         *
              4875    1    *                                    VLPs                                 *
              4876    1    *                                                                         *
              4877    1    ***************************************************************************/

      104     4881        %VLP_CGSTAL;
      105     4906        %PAGE(ARG="QQB$PRIO", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:21   
              4923    1   /***************************************************************************
              4924    1    *                                                                         *
              4925    1    *                                  QQB$PRIO                               *
              4926    1    *                                                                         *
              4927    1    ***************************************************************************/

      106     4931    1           STATION$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0);

   4931  4 000002   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000003   000003 236100                    LDQ     3,,PR0
         4 000004   200031 756100                    STQ     STATION$,,AUTO

      107     4932    1           STATION = STATION$ -> OUT$SYM.TEXT;

   4932  4 000005   200031 471500                    LDP1    STATION$,,AUTO
         4 000006   100004 236100                    LDQ     4,,PR1
         4 000007   000033 772000                    QRL     27
         4 000010   000000 620006                    EAX0    0,QL
         4 000011   040100 100540                    MLR     fill='040'O
         4 000012   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000013   200042 000010                    ADSC9   STATION,,AUTO            cn=0,n=8

      108     4933    1           PRIO$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(1);

   4933  4 000014   000004 236100                    LDQ     4,,PR0
         4 000015   200032 756100                    STQ     PRIO$,,AUTO

      109     4934    1           GROUP_FLAG = '0'B;

   4934  4 000016   200033 450100                    STZ     GROUP_FLAG,,AUTO

      110     4935
      111     4936    1           CALL INDEX(POS, '?', STATION) ALTRET(NO_Q);

   4936  4 000017   000000 124500                    SCM     mask='000'O
         4 000020   200042 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000021   000000 000001 5                  ADSC9   0                        cn=0,n=1
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:22   
         4 000022   200040 000100                    ARG     POS,,AUTO
         4 000023   000026 606400 4                  TTN     NO_Q

      112     4937    1           GROUP_FLAG = '1'B;

   4937  4 000024   400000 236003                    LDQ     -131072,DU
         4 000025   200033 756100                    STQ     GROUP_FLAG,,AUTO

      113     4938
      114     4939    1   NO_Q:
      115     4940    1           IF NOT  QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND

   4940  4 000026   000004 470400 xsym  NO_Q         LDP0    QQ_CMDBLK+4
         4 000027   000022 234100                    SZN     18,,PR0
         4 000030   000042 604000 4                  TMI     s:4948
         4 000031   200033 234100                    SZN     GROUP_FLAG,,AUTO
         4 000032   000037 604000 4                  TMI     s:4944
         4 000033   040100 106500                    CMPC    fill='040'O
         4 000034   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000035   200042 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000036   000042 600000 4                  TZE     s:4948

      116     4941    1               (GROUP_FLAG OR QQ_CMDBLK.S$ -> TP$STATION.ID ~=
      117     4942    1               STATION) THEN
      118     4943    2             DO;

      119     4944    2               QQ_CMDBLK.MINOR_ERR = CODE_ONLYOU;

   4944  4 000037   000000 236000 2                  LDQ     CODE_ONLYOU
         4 000040   000001 756000 xsym               STQ     QQ_CMDBLK+1

      120     4945    2               GOTO PRINT_ERR;

   4945  4 000041   000123 710000 4                  TRA     PRINT_ERR

      121     4946    2             END;
      122     4947
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:23   
      123     4948    1           IF NOT GROUP_FLAG THEN

   4948  4 000042   200033 234100                    SZN     GROUP_FLAG,,AUTO
         4 000043   000070 604000 4                  TMI     s:4960

      124     4949    2             DO;

      125     4950    2               CALL QQC$FINDSTA(STATION, S$, FOUND_FLAG);

   4950  4 000044   200034 631500                    EPPR1   FOUND_FLAG,,AUTO
         4 000045   200050 451500                    STP1    STATION+6,,AUTO
         4 000046   200003 633500                    EPPR3   S$,,AUTO
         4 000047   200047 453500                    STP3    STATION+5,,AUTO
         4 000050   200042 634500                    EPPR4   STATION,,AUTO
         4 000051   200046 454500                    STP4    STATION+4,,AUTO
         4 000052   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000053   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000054   000000 701000 xent               TSX1    QQC$FINDSTA
         4 000055   000000 011000                    NOP     0

      126     4951    2               IF NOT FOUND_FLAG THEN

   4951  4 000056   200034 234100                    SZN     FOUND_FLAG,,AUTO
         4 000057   000062 604000 4                  TMI     s:4955

      127     4952    3                 DO;

      128     4953    3                   S$ = ADDR(NIL);

   4953  4 000060   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000061   200003 756100                    STQ     S$,,AUTO

      129     4954    3                 END;

      130     4955    2               VLP_CGSTAL.LIST.NAME#(0) = STATION;

   4955  4 000062   200042 237100                    LDAQ    STATION,,AUTO
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:24   
         4 000063   000065 755000 3                  STA     VLP_CGSTAL+1
         4 000064   000066 756000 3                  STQ     VLP_CGSTAL+2

      131     4956    2               CALL CHANGE_PRIO ALTRET(PRINT_ERR);

   4956  4 000065   000140 701000 4                  TSX1    CHANGE_PRIO
         4 000066   000123 702000 4                  TSX2    PRINT_ERR

      132     4957    2             END;

   4957  4 000067   000122 710000 4                  TRA     s:4969

      133     4958    1           ELSE
      134     4959    2             DO;

      135     4960    3               DO I = 1 TO QQ_GLOBAL.STATION_CNT;

   4960  4 000070   000001 235007                    LDA     1,DL
         4 000071   200037 755100                    STA     I,,AUTO
         4 000072   000116 710000 4                  TRA     LOOP+1

      136     4961    3                 S$ = PINCRW(QQ_GLOBAL.STATION$, (I - 1) * SIZEW(TP$STATION));

   4961  4 000073   200037 236100                    LDQ     I,,AUTO
         4 000074   000032 402003                    MPY     26,DU
         4 000075   000032 136003                    SBLQ    26,DU
         4 000076   000151 036000 xsym               ADLQ    QQ_GLOBAL+105
         4 000077   200003 756100                    STQ     S$,,AUTO

      137     4962    3                 CALL QQC$WILD_COMP(STATION, TP$STATION.ID) ALTRET(LOOP);

   4962  4 000100   200047 756100                    STQ     STATION+5,,AUTO
         4 000101   200042 630500                    EPPR0   STATION,,AUTO
         4 000102   200046 450500                    STP0    STATION+4,,AUTO
         4 000103   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000105   000000 701000 xent               TSX1    QQC$WILD_COMP
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:25   
         4 000106   000115 702000 4                  TSX2    LOOP

      138     4963    3                 VLP_CGSTAL.LIST.NAME#(0) = TP$STATION.ID;

   4963  4 000107   200003 470500                    LDP0    S$,,AUTO
         4 000110   040000 100500                    MLR     fill='040'O
         4 000111   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000112   000065 000010 3                  ADSC9   VLP_CGSTAL+1             cn=0,n=8

      139     4964    3                 CALL CHANGE_PRIO ALTRET(PRINT_ERR);

   4964  4 000113   000140 701000 4                  TSX1    CHANGE_PRIO
         4 000114   000123 702000 4                  TSX2    PRINT_ERR

      140     4965
      141     4966    3   LOOP:
      142     4967    3               END;

   4967  4 000115   200037 054100       LOOP         AOS     I,,AUTO
         4 000116   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         4 000117   000073 604000 4                  TMI     s:4961
         4 000120   200037 116100                    CMPQ    I,,AUTO
         4 000121   000073 605000 4                  TPL     s:4961

      143     4968    2             END;

      144     4969    1           GOTO RET;

   4969  4 000122   000137 710000 4                  TRA     RET

      145     4970
      146     4971    1   PRINT_ERR:
      147     4972    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   4972  4 000123   200004 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
         4 000124   200046 450500                    STP0    STATION+4,,AUTO
         4 000125   200046 630500                    EPPR0   STATION+4,,AUTO
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:26   
         4 000126   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000127   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000130   000000 011000                    NOP     0

      148     4973    1           CALL QQC$BLDMSG(MSGBLK);

   4973  4 000131   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000132   200046 450500                    STP0    STATION+4,,AUTO
         4 000133   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000134   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000135   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000136   000000 011000                    NOP     0

      149     4974
      150     4975    1   RET:
      151     4976    1           RETURN;

   4976  4 000137   000000 702200 xent  RET          TSX2  ! X66_ARET

      152     4977                %PAGE(ARG="CHANGE_PRIO", PAGE=YES);

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:27   
              4994    1   /***************************************************************************
              4995    1    *                                                                         *
              4996    1    *                                CHANGE_PRIO                              *
              4997    1    *                                                                         *
              4998    1    ***************************************************************************/

      153     5002    1   CHANGE_PRIO:

   5002  4 000140   200044 741300       CHANGE_PRIO  STX1  ! STATION+2,,AUTO

      154     5003    1           PROC ALTRET;
      155     5004
      156     5005    2           IF S$ = ADDR(NIL) AND

   5005  4 000141   200003 236100                    LDQ     S$,,AUTO
         4 000142   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000143   000156 601000 4                  TNZ     s:5013
         4 000144   200032 470500                    LDP0    PRIO$,,AUTO
         4 000145   000000 720100                    LXL0    0,,PR0
         4 000146   000001 100003                    CMPX0   1,DU
         4 000147   000153 600000 4                  TZE     s:5009
         4 000150   000001 222100                    LDX2    1,,PR0
         4 000151   000002 102003                    CMPX2   2,DU
         4 000152   000156 601000 4                  TNZ     s:5013

      157     5006    2               (PRIO$ -> OUT$SYM.CODE = 1 /* Default */ OR
      158     5007    2               PRIO$ -> OUT$BLK.NSUBLKS = 2) THEN
      159     5008    3             DO;

      160     5009    3               QQ_CMDBLK.MINOR_ERR = CODE_NOTON;

   5009  4 000153   000001 236000 2                  LDQ     CODE_NOTON
         4 000154   000001 756000 xsym               STQ     QQ_CMDBLK+1

      161     5010    3               GOTO ALT;

   5010  4 000155   000344 710000 4                  TRA     ALT
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:28   

      162     5011    3             END;
      163     5012
      164     5013    2           IF PRIO$ -> OUT$SYM.CODE = 1 /* Default */ THEN

   5013  4 000156   200032 470500                    LDP0    PRIO$,,AUTO
         4 000157   000000 720100                    LXL0    0,,PR0
         4 000160   000001 100003                    CMPX0   1,DU
         4 000161   000167 601000 4                  TNZ     s:5019

      165     5014    3             DO;

      166     5015    3               NEW_PRIO = TP$STATION.DFLT_PRIO;

   5015  4 000162   200003 471500                    LDP1    S$,,AUTO
         4 000163   100023 236100                    LDQ     19,,PR1
         4 000164   000777 376007                    ANQ     511,DL
         4 000165   200041 756100                    STQ     NEW_PRIO,,AUTO

      167     5016    3               GOTO SET_PRIO;

   5016  4 000166   000232 710000 4                  TRA     SET_PRIO

      168     5017    3             END;
      169     5018
      170     5019    2           IF PRIO$ -> OUT$BLK.NSUBLKS = 1 THEN

   5019  4 000167   000001 222100                    LDX2    1,,PR0
         4 000170   000001 102003                    CMPX2   1,DU
         4 000171   000202 601000 4                  TNZ     s:5025

      171     5020    3             DO;

      172     5021    3               CALL CHARBIN(NEW_PRIO, PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);

   5021  4 000172   000003 471500                    LDP1    3,,PR0
         4 000173   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:29   
         4 000174   000033 772000                    QRL     27
         4 000175   000000 623006                    EAX3    0,QL
         4 000176   000100 305540                    DTB
         4 000177   100004 230013                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X3
         4 000200   200041 000004                    NDSC9   NEW_PRIO,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      173     5022    3               GOTO SET_PRIO;

   5022  4 000201   000232 710000 4                  TRA     SET_PRIO

      174     5023    3             END;
      175     5024
      176     5025    2           NEW_PRIO = TP$STATION.CURR_PRIO;

   5025  4 000202   200003 471500                    LDP1    S$,,AUTO
         4 000203   100024 236100                    LDQ     20,,PR1
         4 000204   000033 772000                    QRL     27
         4 000205   200041 756100                    STQ     NEW_PRIO,,AUTO

      177     5026    2           MULTIPLIER = 1;

   5026  4 000206   000001 235007                    LDA     1,DL
         4 000207   200035 755100                    STA     MULTIPLIER,,AUTO

      178     5027
      179     5028    2           IF PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN

   5028  4 000210   000003 473500                    LDP3    3,,PR0
         4 000211   300000 723100                    LXL3    0,,PR3
         4 000212   000002 103003                    CMPX3   2,DU
         4 000213   000216 601000 4                  TNZ     s:5033

      180     5029    3             DO;

      181     5030    3               MULTIPLIER = -1;

   5030  4 000214   000001 335007                    LCA     1,DL
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:30   
         4 000215   200035 755100                    STA     MULTIPLIER,,AUTO

      182     5031    3             END;

      183     5032
      184     5033    2           CALL CHARBIN(DELTA, PRIO$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);

   5033  4 000216   000004 474500                    LDP4    4,,PR0
         4 000217   400004 236100                    LDQ     4,,PR4
         4 000220   000033 772000                    QRL     27
         4 000221   000000 624006                    EAX4    0,QL
         4 000222   000100 305540                    DTB
         4 000223   400004 230014                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X4
         4 000224   200046 000010                    NDSC9   STATION+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 000225   200047 236100                    LDQ     STATION+5,,AUTO
         4 000226   200036 756100                    STQ     DELTA,,AUTO

      185     5034
      186     5035    2           NEW_PRIO = NEW_PRIO + DELTA * MULTIPLIER;

   5035  4 000227   200035 402100                    MPY     MULTIPLIER,,AUTO
         4 000230   200041 036100                    ADLQ    NEW_PRIO,,AUTO
         4 000231   200041 756100                    STQ     NEW_PRIO,,AUTO

      187     5036
      188     5037    2   SET_PRIO:
      189     5038    2           IF NOT  QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND

   5038  4 000232   000004 471400 xsym  SET_PRIO     LDP1    QQ_CMDBLK+4
         4 000233   100022 234100                    SZN     18,,PR1
         4 000234   000260 604000 4                  TMI     s:5047
         4 000235   100023 236100                    LDQ     19,,PR1
         4 000236   000777 376007                    ANQ     511,DL
         4 000237   200041 116100                    CMPQ    NEW_PRIO,,AUTO
         4 000240   000260 605000 4                  TPL     s:5047

      190     5039    2               NEW_PRIO > QQ_CMDBLK.S$ -> TP$STATION.DFLT_PRIO THEN
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:31   
      191     5040    3             DO;

      192     5041    3               NEW_PRIO = QQ_CMDBLK.S$ -> TP$STATION.DFLT_PRIO;

   5041  4 000241   200041 756100                    STQ     NEW_PRIO,,AUTO

      193     5042    3               QQ_CMDBLK.MINOR_ERR = CODE_DFLT_PRIO;

   5042  4 000242   000002 236000 2                  LDQ     CODE_DFLT_PRIO
         4 000243   000001 756000 xsym               STQ     QQ_CMDBLK+1

      194     5043    3               CALL QQC$BLDMSG_BLK(MSGBLK);

   5043  4 000244   200004 633500                    EPPR3   MSGBLK,,AUTO
         4 000245   200046 453500                    STP3    STATION+4,,AUTO
         4 000246   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000247   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000250   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000251   000000 011000                    NOP     0

      195     5044    3               CALL QQC$BLDMSG(MSGBLK);

   5044  4 000252   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000253   200046 450500                    STP0    STATION+4,,AUTO
         4 000254   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000256   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000257   000000 011000                    NOP     0

      196     5045    3             END;

      197     5046
      198     5047    2           IF NEW_PRIO > 500 THEN

   5047  4 000260   200041 235100                    LDA     NEW_PRIO,,AUTO
         4 000261   000764 115007                    CMPA    500,DL
         4 000262   000303 604400 4                  TMOZ    s:5055
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:32   

      199     5048    3             DO;

      200     5049    3               NEW_PRIO = 500;

   5049  4 000263   000764 236007                    LDQ     500,DL
         4 000264   200041 756100                    STQ     NEW_PRIO,,AUTO

      201     5050    3               QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_PRIO;

   5050  4 000265   000003 236000 2                  LDQ     CODE_BIGGEST_PRIO
         4 000266   000001 756000 xsym               STQ     QQ_CMDBLK+1

      202     5051    3               CALL QQC$BLDMSG_BLK(MSGBLK);

   5051  4 000267   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000270   200046 450500                    STP0    STATION+4,,AUTO
         4 000271   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000272   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000273   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000274   000000 011000                    NOP     0

      203     5052    3               CALL QQC$BLDMSG(MSGBLK);

   5052  4 000275   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000276   200046 450500                    STP0    STATION+4,,AUTO
         4 000277   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000301   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000302   000000 011000                    NOP     0

      204     5053    3             END;

      205     5054
      206     5055    2           IF NEW_PRIO < 1 THEN

   5055  4 000303   200041 235100                    LDA     NEW_PRIO,,AUTO
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:33   
         4 000304   000325 605400 4                  TPNZ    s:5063

      207     5056    3             DO;

      208     5057    3               NEW_PRIO = 1;

   5057  4 000305   000001 236007                    LDQ     1,DL
         4 000306   200041 756100                    STQ     NEW_PRIO,,AUTO

      209     5058    3               QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_PRIO;

   5058  4 000307   000004 236000 2                  LDQ     CODE_SMALLEST_PRIO
         4 000310   000001 756000 xsym               STQ     QQ_CMDBLK+1

      210     5059    3               CALL QQC$BLDMSG_BLK(MSGBLK);

   5059  4 000311   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000312   200046 450500                    STP0    STATION+4,,AUTO
         4 000313   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000315   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000316   000000 011000                    NOP     0

      211     5060    3               CALL QQC$BLDMSG(MSGBLK);

   5060  4 000317   200004 630500                    EPPR0   MSGBLK,,AUTO
         4 000320   200046 450500                    STP0    STATION+4,,AUTO
         4 000321   200046 630500                    EPPR0   STATION+4,,AUTO
         4 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000323   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000324   000000 011000                    NOP     0

      212     5061    3             END;

      213     5062
      214     5063    2           VLP_CGSTAL.LIST.PRIO#(0) = NEW_PRIO;

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:34   
   5063  4 000325   200041 236100                    LDQ     NEW_PRIO,,AUTO
         4 000326   000033 736000                    QLS     27
         4 000327   000067 552040 3                  STBQ    VLP_CGSTAL+3,'40'O

      215     5064    2           CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);

   5064  4 000330   000000 630400 3                  EPPR0   FPT_CGCTL
         4 000331   500003 713400                    CLIMB   alt,+32771
         4 000332   411400 401760                    pmme    nvectors=20
         4 000333   000347 702000 4                  TSX2    MON_ERR

      216     5065
      217     5066    2           IF S$ ~= ADDR(NIL) THEN

   5066  4 000334   200003 236100                    LDQ     S$,,AUTO
         4 000335   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000336   000343 600000 4                  TZE     s:5071

      218     5067    3             DO;

      219     5068    3               TP$STATION.CURR_PRIO = NEW_PRIO;

   5068  4 000337   200003 470500                    LDP0    S$,,AUTO
         4 000340   200041 236100                    LDQ     NEW_PRIO,,AUTO
         4 000341   000033 736000                    QLS     27
         4 000342   000024 552140                    STBQ    20,'40'O,PR0

      220     5069    3             END;

      221     5070
      222     5071    2           GOTO RET;

   5071  4 000343   000345 710000 4                  TRA     RET

      223     5072
      224     5073    2   ALT:
      225     5074    2           ALTRETURN;
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:35   

   5074  4 000344   000000 702211       ALT          TSX2  ! 0,X1

      226     5075
      227     5076    2   RET:
      228     5077    2           RETURN;

   5077  4 000345   200044 221300       RET          LDX1  ! STATION+2,,AUTO
         4 000346   000001 702211                    TSX2  ! 1,X1

      229     5078
      230     5079    2   MON_ERR:
      231     5080    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   5080  4 000347   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         4 000350   000000 471500                    LDP1    0,,PR0
         4 000351   100102 236100                    LDQ     66,,PR1
         4 000352   000000 756000 xsym               STQ     QQ_GLOBAL

      232     5081    2           CALL QQC$SCREECH;

   5081  4 000353   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000354   000000 701000 xent               TSX1    QQC$SCREECH
         4 000355   000000 011000                    NOP     0

      233     5082    2   END CHANGE_PRIO;

   5082  4 000356   200044 221300                    LDX1  ! STATION+2,,AUTO
         4 000357   000001 702211                    TSX2  ! 1,X1
      234     5083    1   END QQB$PRIO;

PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:36   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$PRIO.
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:37   

 **** Variables and constants ****

  ****  Section 002 RoData QQB$PRIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b STRC        r     1 CODE_BIGGEST_PRIO          2-0-0/b STRC        r     1 CODE_DFLT_PRIO
     1-0-0/b STRC        r     1 CODE_NOTON                 0-0-0/b STRC        r     1 CODE_ONLYOU
     4-0-0/b STRC        r     1 CODE_SMALLEST_PRIO

  ****  Section 003  Data  QQB$PRIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1872)  r     1 FPT_CGCTL                 64-0-0/d STRC(324)   r     1 VLP_CGSTAL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/w UBIN        r     1 DELTA                     34-0-0/w BIT         r     1 FOUND_FLAG
    33-0-0/w BIT         r     1 GROUP_FLAG                37-0-0/w SBIN        r     1 I
     4-0-0/w STRC(738)   r     1 MSGBLK                    35-0-0/w SBIN        r     1 MULTIPLIER
    41-0-0/w SBIN        r     1 NEW_PRIO                  40-0-0/w UBIN        r     1 POS
    32-0-0/w PTR         r     1 PRIO$                      3-0-0/w PTR         r     1 S$
    42-0-0/c CHAR(8)     r     1 STATION                   31-0-0/w PTR         r     1 STATION$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:38   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$CG                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQB$PRIO requires 240 words for executable code.
   Procedure QQB$PRIO requires 42 words of local(AUTO) storage.

    No errors detected in file QQB$PRIO.:E05TSI    .
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:40   
          MINI XREF LISTING

ALT IN PROCEDURE CHANGE_PRIO
      5074**LABEL    5010--GOTO
B$ALT.CODE
      4415**DCL      4415--REDEF    4416--REDEF    4416--REDEF
B$ALT.ERR
      4416**DCL      5080>>ASSIGN
B$ALT.ERR.ERR#
      4417**DCL      4417--REDEF
B$ALT.EVID
      4416**DCL      4416--REDEF    4416--REDEF
B$TCB.ALT$
      4411**DCL      5080>>ASSIGN
B$TCB$
      4358**DCL      5080>>ASSIGN
CHANGE_PRIO
      5003**PROC     4956--CALL     4964--CALL
CODE_BIGGEST_PRIO
      4753**DCL      5050>>ASSIGN
CODE_DFLT_PRIO
      4746**DCL      5042>>ASSIGN
CODE_NOTON
      4739**DCL      5009>>ASSIGN
CODE_ONLYOU
      4732**DCL      4944>>ASSIGN
CODE_SMALLEST_PRIO
      4760**DCL      5058>>ASSIGN
DELTA
      4700**DCL      5033<<CALLBLT  5035>>ASSIGN
FOUND_FLAG
      4697**DCL      4950<>CALL     4951>>IF
FPT_CGCTL
      4844**DCL      5064<>CALL
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:41   
FPT_CGCTL.V
      4849**DCL      4844--DCLINIT
GROUP_FLAG
      4696**DCL      4934<<ASSIGN   4937<<ASSIGN   4940>>IF       4948>>IF
I
      4701**DCL      4960<<DOINDEX  4961>>ASSIGN
LOOP
      4967**LABEL    4962--CALLALT
M$CGCTL
        99**DCL-ENT  5064--CALL
MON_ERR IN PROCEDURE CHANGE_PRIO
      5080**LABEL    5064--CALLALT
MSGBLK
      4603**DCL      4972<>CALL     4973<>CALL     5043<>CALL     5044<>CALL     5051<>CALL     5052<>CALL
      5059<>CALL     5060<>CALL
MULTIPLIER
      4699**DCL      5026<<ASSIGN   5030<<ASSIGN   5035>>ASSIGN
NEW_PRIO
      4703**DCL      5015<<ASSIGN   5021<<CALLBLT  5025<<ASSIGN   5035<<ASSIGN   5035>>ASSIGN   5038>>IF
      5041<<ASSIGN   5047>>IF       5049<<ASSIGN   5055>>IF       5057<<ASSIGN   5063>>ASSIGN   5068>>ASSIGN
NO_Q
      4940**LABEL    4936--CALLALT
OUT$BLK.NSUBLKS
      4512**DCL      5005>>IF       5019>>IF
OUT$BLK.SUBLK$
      4533**DCL      4931>>ASSIGN   4933>>ASSIGN   5021>>CALLBLT  5021>>CALLBLT  5028>>IF       5033>>CALLBLT
      5033>>CALLBLT
OUT$SYM.CODE
      4552**DCL      5005>>IF       5013>>IF       5028>>IF
OUT$SYM.COUNT
      4569**DCL      4572--IMP-SIZ  4932>>ASSIGN   5021>>CALLBLT  5033>>CALLBLT
OUT$SYM.TEXT
      4572**DCL      4932>>ASSIGN   5021>>CALLBLT  5033>>CALLBLT
POS
      4702**DCL      4936<<CALLBLT
PRINT_ERR
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:42   
      4972**LABEL    4945--GOTO     4956--CALLALT  4964--CALLALT
PRIO$
      4694**DCL      4933<<ASSIGN   5005>>IF       5005>>IF       5013>>IF       5019>>IF       5021>>CALLBLT
      5021>>CALLBLT  5028>>IF       5033>>CALLBLT  5033>>CALLBLT
QQC$BLDMSG
      4330**DCL-ENT  4973--CALL     5044--CALL     5052--CALL     5060--CALL
QQC$BLDMSG_BLK
      4329**DCL-ENT  4972--CALL     5043--CALL     5051--CALL     5059--CALL
QQC$FINDSTA
      4331**DCL-ENT  4950--CALL
QQC$SCREECH
      4328**DCL-ENT  5081--CALL
QQC$WILD_COMP
      4332**DCL-ENT  4962--CALL
QQ_CMDBLK.MINOR_ERR
      3882**DCL      4944<<ASSIGN   5009<<ASSIGN   5042<<ASSIGN   5050<<ASSIGN   5058<<ASSIGN
QQ_CMDBLK.OUT$
      3882**DCL      4931>>ASSIGN   4933>>ASSIGN
QQ_CMDBLK.S$
      3882**DCL      4940>>IF       4940>>IF       5038>>IF       5038>>IF       5041>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      3893**DCL      3893--REDEF
QQ_GLOBAL.DS2$_BITS
      3893**DCL      3894--REDEF
QQ_GLOBAL.DS3$_BITS
      3894**DCL      3894--REDEF
QQ_GLOBAL.DS4$_BITS
      3894**DCL      3895--REDEF
QQ_GLOBAL.ERR
      3883**DCL      5080<<ASSIGN
QQ_GLOBAL.STATION$
      3894**DCL      4961>>ASSIGN
QQ_GLOBAL.STATION_CNT
      3888**DCL      4960>>DOINDEX
RET
      4976**LABEL    4969--GOTO
PL6.E3A0      #001=QQB$PRIO File=QQB$PRIO.:E05TSI                                WED 07/30/97 05:34 Page:43   
RET IN PROCEDURE CHANGE_PRIO
      5077**LABEL    5071--GOTO
S$
      4433**DCL      4435--IMP-PTR  4950<>CALL     4953<<ASSIGN   4961<<ASSIGN   4962>>CALL     4963>>ASSIGN
      5005>>IF       5015>>ASSIGN   5025>>ASSIGN   5066>>IF       5068>>ASSIGN
SET_PRIO IN PROCEDURE CHANGE_PRIO
      5038**LABEL    5016--GOTO     5022--GOTO
STATION
      4705**DCL      4932<<ASSIGN   4936>>CALLBLT  4940>>IF       4950<>CALL     4955>>ASSIGN   4962<>CALL
STATION$
      4693**DCL      4931<<ASSIGN   4932>>ASSIGN   4932>>ASSIGN
TP$STATION
      4435**DCL      4961--ASSIGN
TP$STATION.CURR_PRIO
      4489**DCL      5025>>ASSIGN   5068<<ASSIGN
TP$STATION.DFLT_PRIO
      4487**DCL      5015>>ASSIGN   5038>>IF       5041>>ASSIGN
TP$STATION.FLAGS.PRIV
      4463**DCL      4940>>IF       5038>>IF
TP$STATION.ID
      4436**DCL      4940>>IF       4962<>CALL     4963>>ASSIGN
VLP_CGSTAL
      4899**DCL      4845--DCLINIT
VLP_CGSTAL.LIST.NAME#
      4899**DCL      4955<<ASSIGN   4963<<ASSIGN
VLP_CGSTAL.LIST.PRIO#
      4900**DCL      5063<<ASSIGN
