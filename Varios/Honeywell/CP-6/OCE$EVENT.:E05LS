VERSION E05

PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:1    
        1        1        /*M* OCE$EVENT  asynchronous event handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        /*
       10       10           ###     ###    #####     #     #####   #   #   #####   #   #   #####
       11       11          #   #   #   #   #        ###    #       #   #   #       #   #     #
       12       12          #   #   #       #       # #     #       #   #   #       ##  #     #
       13       13          #   #   #       ####     ###    ####    #   #   ####    # # #     #
       14       14          #   #   #       #         # #   #       #   #   #       #  ##     #
       15       15          #   #   #   #   #        ###    #        # #    #       #   #     #
       16       16           ###     ###    #####     #     #####     #     #####   #   #     #
       17       17                                                                          */
       18       18                                                /**/
       19       19                                                /**/
       20       20        %SET LISTSUB='1'B;
       21       21        /*F* NAME: OCE$EVENT
       22       22             PURPOSE:  To provide proper handling of asynchronous
       23       23                       events received by KEYIN.
       24       24             DESCRIPTION:  As each event is received it is
       25       25                           remembered on a queue.  If this is
       26       26                           not the first event level, a RETURN
       27       27                           is executed.  Otherwise, process all
       28       28                           events currently on the queue.
       29       29                                                                   */
       30       30        /*D* NAME:  OCE$EVENT
       31       31             CALL: None -- ASYNChronous PROCedure.
       32       32             INTERFACE:  OCN$SKEYIN, OCO$MESSHAND, OCP$OCCG, OCP$CSCG.
       33       33             DESCRIPTION:  Upon entry to the asynchronous procedure,
       34       34                           inhibited code is entered to place the variable
       35       35                           portion of the TCB frame on a queue.  The
       36       36                           variable OC_QDEPTH (initially zero) is incremented
       37       37                           and if it is not equal to one a RETURN is
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:2    
       38       38                           executed.
       39       39                           If, however, OC_QDEPTH is equal to one, the
       40       40                           inhibited code is exited and an infinite
       41       41                           loop is entered which calls the appropriate
       42       42                           processing procedure for each entry in the
       43       43                           queue until there are no more entries,
       44       44                           whereupon a RETURN is made.
       45       45                           After each queue entry is processed, OC_QDEPTH
       46       46                           is decremented by one.
       47       47             ASSUMPTIONS:  The queue is large enough to handle the number
       48       48                           of simultaneous events which occur.
       49       49                                                                           */
       50       50                                                /**/
       51       51                                                /**/
       52       52        OCE$EVENT: PROC ASYNC;
       53       53                                                /**/
       54       54                                                /**/
       55       55        %INCLUDE OC_SUBS_C;
       56      786                                                /**/
       57      787                                                /**/
       58      788        %INCLUDE OCI_SUBS_C;
       59      886                                                /**/
       60      887                                                /**/
       61      888        %INCLUDE CP_6;
       62      969        %INCLUDE OC_DAT_R;
       63     1130                                                /**/
       64     1131                                                /**/
       65     1132                                                /**/
       66     1133                 %B$TCB;
       67     1136                                                /**/
       68     1137               %B$NWIO (STCLASS="BASED(STK$)");
       69     1222                                                /**/
       70     1223                                                /**/
       71     1224                                           /* PARMV is used as a based variable
       72     1225                                                to move the NK$NWIO parameter
       73     1226                                                image from the TCB stack to
       74     1227                                                KEYIN's internal stack */
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:3    
       75     1228             %B$NWIO        (NAME=PARMV,
       76     1229                                 PARONLY=1);
       77     1310    1   DCL STK$ PTR STATIC;
       78     1311                                                /**/
       79     1312                                                /**/
       80     1313    1   DCL B$TCB$ PTR SYMREF;
       81     1314                                                /**/
       82     1315    1   DCL DET_RENV UBIN WORD;
       83     1316                                                /**/
       84     1317                                                /****************************/
       85     1318                                                /****************************/
       86     1319        /*
       87     1320                  Begin  O C E $ E V E N T
       88     1321                                                     */
       89     1322                                           /* Upon receipt of event, move rele-
       90     1323                                                vant portions of TCB frame to
       91     1324                                                KEYIN's internal stack */
       92     1325    2        DO INHIBIT;
       93     1326    2             STK$ = B$TCB$ -> B$TCB.STK$;
       94     1327    2             OC_QUEUE.SUBC(OC_QPOSN)=B$NWIO.SUBC;
       95     1328    2             OC_QUEUE.EVID(OC_QPOSN)=B$NWIO.EVID;
       96     1329    2             OC_QUEUE.ERR(OC_QPOSN)=B$NWIO.ERR;
       97     1330                                                /* Move NK$NWIO under based
       98     1331                                                     variable PARMV */
       99     1332    2             OC_QUEUE.PARMS(OC_QPOSN)=ADDR(B$NWIO.P#)->PARMV;
      100     1333                                           /* Assumption: queue will never
      101     1334                                                overflow  */
      102     1335    2             IF OC_QPOSN = 199 /* MAX_EVNT# */
      103     1336    2             THEN
      104     1337    2                  OC_QPOSN = 0;
      105     1338    2             ELSE
      106     1339    2                  OC_QPOSN = OC_QPOSN + 1;
      107     1340    2             OC_QDEPTH = OC_QDEPTH + 1;
      108     1341    2             RETURN;
      109     1342    2           END;                            /* Inhibit */
      110     1343    1   END OCE$EVENT;
      111     1344        %EOD;
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:4    

PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:5    
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$EVENT.

   Procedure OCE$EVENT requires 31 words for executable code.
   Procedure OCE$EVENT requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:6    

 Object Unit name= OCE$EVENT                                  File name= OCE$EVENT.:E05TOU
 UTS= JUL 30 '97 03:56:32.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     1      1  OCE$EVENT
    2   Proc  even  none    31     37  OCE$EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  OCE$EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_QDEPTH                             OC_QPOSN
     OC_QUEUE                              OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B$TCB$
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:7    


        1        1        /*M* OCE$EVENT  asynchronous event handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        /*
       10       10           ###     ###    #####     #     #####   #   #   #####   #   #   #####
       11       11          #   #   #   #   #        ###    #       #   #   #       #   #     #
       12       12          #   #   #       #       # #     #       #   #   #       ##  #     #
       13       13          #   #   #       ####     ###    ####    #   #   ####    # # #     #
       14       14          #   #   #       #         # #   #       #   #   #       #  ##     #
       15       15          #   #   #   #   #        ###    #        # #    #       #   #     #
       16       16           ###     ###    #####     #     #####     #     #####   #   #     #
       17       17                                                                          */
       18       18                                                /**/
       19       19                                                /**/
       20       20        %SET LISTSUB='1'B;
       21       21        /*F* NAME: OCE$EVENT
       22       22             PURPOSE:  To provide proper handling of asynchronous
       23       23                       events received by KEYIN.
       24       24             DESCRIPTION:  As each event is received it is
       25       25                           remembered on a queue.  If this is
       26       26                           not the first event level, a RETURN
       27       27                           is executed.  Otherwise, process all
       28       28                           events currently on the queue.
       29       29                                                                   */
       30       30        /*D* NAME:  OCE$EVENT
       31       31             CALL: None -- ASYNChronous PROCedure.
       32       32             INTERFACE:  OCN$SKEYIN, OCO$MESSHAND, OCP$OCCG, OCP$CSCG.
       33       33             DESCRIPTION:  Upon entry to the asynchronous procedure,
       34       34                           inhibited code is entered to place the variable
       35       35                           portion of the TCB frame on a queue.  The
       36       36                           variable OC_QDEPTH (initially zero) is incremented
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:8    
       37       37                           and if it is not equal to one a RETURN is
       38       38                           executed.
       39       39                           If, however, OC_QDEPTH is equal to one, the
       40       40                           inhibited code is exited and an infinite
       41       41                           loop is entered which calls the appropriate
       42       42                           processing procedure for each entry in the
       43       43                           queue until there are no more entries,
       44       44                           whereupon a RETURN is made.
       45       45                           After each queue entry is processed, OC_QDEPTH
       46       46                           is decremented by one.
       47       47             ASSUMPTIONS:  The queue is large enough to handle the number
       48       48                           of simultaneous events which occur.
       49       49                                                                           */
       50       50                                                /**/
       51       51                                                /**/
       52       52        OCE$EVENT: PROC ASYNC;

     52  2 000000   000000 700200 xent  OCE$EVENT    TSX0  ! X66_AAUTO
         2 000001   000004 000000                    ZERO    4,0

       53       53                                                /**/
       54       54                                                /**/
       55       55        %INCLUDE OC_SUBS_C;
       56      786                                                /**/
       57      787                                                /**/
       58      788        %INCLUDE OCI_SUBS_C;
       59      886                                                /**/
       60      887                                                /**/
       61      888        %INCLUDE CP_6;
       62      969        %INCLUDE OC_DAT_R;
       63     1130                                                /**/
       64     1131                                                /**/
       65     1132                                                /**/
       66     1133                 %B$TCB;
       67     1136                                                /**/
       68     1137               %B$NWIO (STCLASS="BASED(STK$)");
       69     1222                                                /**/
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:9    
       70     1223                                                /**/
       71     1224                                           /* PARMV is used as a based variable
       72     1225                                                to move the NK$NWIO parameter
       73     1226                                                image from the TCB stack to
       74     1227                                                KEYIN's internal stack */
       75     1228             %B$NWIO        (NAME=PARMV,
       76     1229                                 PARONLY=1);
       77     1310    1   DCL STK$ PTR STATIC;
       78     1311                                                /**/
       79     1312                                                /**/
       80     1313    1   DCL B$TCB$ PTR SYMREF;
       81     1314                                                /**/
       82     1315    1   DCL DET_RENV UBIN WORD;
       83     1316                                                /**/
       84     1317                                                /****************************/
       85     1318                                                /****************************/
       86     1319        /*
       87     1320                  Begin  O C E $ E V E N T
       88     1321                                                     */
       89     1322                                           /* Upon receipt of event, move rele-
       90     1323                                                vant portions of TCB frame to
       91     1324                                                KEYIN's internal stack */
       92     1325    2        DO INHIBIT;

       93     1326    2             STK$ = B$TCB$ -> B$TCB.STK$;

   1326  2 000002   000000 470600 xsym               LDP0  ! B$TCB$
         2 000003   000001 236300                    LDQ   ! 1,,PR0
         2 000004   000000 756200 1                  STQ   ! STK$

       94     1327    2             OC_QUEUE.SUBC(OC_QPOSN)=B$NWIO.SUBC;

   1327  2 000005   000000 236200 xsym               LDQ   ! OC_QPOSN
         2 000006   000017 402207                    MPY   ! 15,DL
         2 000007   000000 471600 1                  LDP1  ! STK$
         2 000010   000000 620206                    EAX0  ! 0,QL
         2 000011   100100 236300                    LDQ   ! 64,,PR1
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:10   
         2 000012   777777 376207                    ANQ   ! -1,DL
         2 000013   000000 756210 xsym               STQ   ! OC_QUEUE,X0

       95     1328    2             OC_QUEUE.EVID(OC_QPOSN)=B$NWIO.EVID;

   1328  2 000014   100101 235300                    LDA   ! 65,,PR1
         2 000015   000001 755210 xsym               STA   ! OC_QUEUE+1,X0

       96     1329    2             OC_QUEUE.ERR(OC_QPOSN)=B$NWIO.ERR;

   1329  2 000016   100102 236300                    LDQ   ! 66,,PR1
         2 000017   000002 756210 xsym               STQ   ! OC_QUEUE+2,X0

       97     1330                                                /* Move NK$NWIO under based
       98     1331                                                     variable PARMV */
       99     1332    2             OC_QUEUE.PARMS(OC_QPOSN)=ADDR(B$NWIO.P#)->PARMV;

   1332  2 000020   000000 236200 xsym               LDQ   ! OC_QPOSN
         2 000021   000074 402207                    MPY   ! 60,DL
         2 000022   000006 100700                    MLR   ! fill='000'O
         2 000023   100103 000060                    ADSC9   67,,PR1                  cn=0,n=48
         2 000024   000003 000060 xsym               ADSC9   OC_QUEUE+3,Q             cn=0,n=48

      100     1333                                           /* Assumption: queue will never
      101     1334                                                overflow  */
      102     1335    2             IF OC_QPOSN = 199 /* MAX_EVNT# */

   1335  2 000025   000000 235200 xsym               LDA   ! OC_QPOSN
         2 000026   000307 115207                    CMPA  ! 199,DL
         2 000027   000032 601200 2                  TNZ   ! s:1339

      103     1336    2             THEN
      104     1337    2                  OC_QPOSN = 0;

   1337  2 000030   000000 450200 xsym               STZ   ! OC_QPOSN
         2 000031   000034 710200 2                  TRA   ! s:1340

PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:11   
      105     1338    2             ELSE
      106     1339    2                  OC_QPOSN = OC_QPOSN + 1;

   1339  2 000032   000001 035207                    ADLA  ! 1,DL
         2 000033   000000 755200 xsym               STA   ! OC_QPOSN

      107     1340    2             OC_QDEPTH = OC_QDEPTH + 1;

   1340  2 000034   000000 054200 xsym               AOS   ! OC_QDEPTH

      108     1341    2             RETURN;

   1341  2 000035   000000 702200 xent               TSX2  ! X66_AARET

      109     1342    2           END;                            /* Inhibit */

      110     1343    1   END OCE$EVENT;

   1343  2 000036   000000 702200 xent               TSX2  ! X66_AARET
      111     1344        %EOD;

PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:12   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$EVENT.
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:13   

 **** Variables and constants ****

  ****  Section 001  Data  OCE$EVENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 STK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/w SBIN        r     1 OC_QDEPTH                  0-0-0/w UBIN        r     1 OC_QPOSN
     0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2880)  r     1 B$NWIO                     0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(468)   r     1 PARMV


   Procedure OCE$EVENT requires 31 words for executable code.
   Procedure OCE$EVENT requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:14   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:15   
          MINI XREF LISTING

B$NWIO.CGPARM.MSGIDXT
      1171**DCL      1174--REDEF
B$NWIO.CODE
      1140**DCL      1140--REDEF    1141--REDEF    1141--REDEF
B$NWIO.ERR
      1141**DCL      1329>>ASSIGN
B$NWIO.ERR.ERR#
      1142**DCL      1142--REDEF
B$NWIO.EVID
      1141**DCL      1141--REDEF    1141--REDEF    1328>>ASSIGN
B$NWIO.P#
      1147**DCL      1332--ASSIGN
B$NWIO.SUBC
      1141**DCL      1327>>ASSIGN
B$TCB.STK$
      1134**DCL      1326>>ASSIGN
B$TCB$
      1313**DCL      1326>>ASSIGN
OC_CONSOLE.ATTR
      1083**DCL      1083--REDEF
OC_CONSOLE.ATTRO
      1084**DCL      1084--REDEF
OC_CONSOLE.CID
      1082**DCL      1083--REDEF
OC_CONSOLE.STATION
      1081**DCL      1081--REDEF
OC_CONSOLE$
      1080**DCL      1081--IMP-PTR
OC_DIR
      1123**DCL      1123--REDEF
OC_INTBIT
      1123**DCL      1124--REDEF
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:16   
OC_INTMSG
      1000**DCL      1013--REDEF
OC_INTMSG.FLAGS
      1007**DCL      1008--REDEF
OC_INTMSG.MESS
      1013**DCL      1013--REDEF
OC_INTMSG.MSGID
      1003**DCL      1004--REDEF
OC_INTMSG.WSN
      1010**DCL      1011--REDEF
OC_MASK
      1124**DCL      1124--REDEF
OC_MESSBUF
      1015**DCL      1030--REDEF    1044--REDEF
OC_MESSBUF.FLAGS
      1022**DCL      1023--REDEF
OC_MESSBUF.MESS
      1028**DCL      1028--REDEF
OC_MESSBUF.MSGID
      1018**DCL      1019--REDEF
OC_MESSBUF.WSN
      1025**DCL      1026--REDEF
OC_MESSBUF1.FLAGS
      1037**DCL      1038--REDEF
OC_MESSBUF1.LEN
      1043**DCL      1043--REDEF
OC_MESSBUF1.MSGID
      1033**DCL      1034--REDEF
OC_MESSBUF1.WSN
      1040**DCL      1041--REDEF
OC_MSGBUFFER
      1046**DCL      1061--REDEF
OC_MSGBUFFER.FLAGS
      1053**DCL      1054--REDEF
OC_MSGBUFFER.MESS
      1059**DCL      1059--REDEF
PL6.E3A0      #001=OCE$EVENT File=OCE$EVENT.:E05TSI                              WED 07/30/97 03:56 Page:17   
OC_MSGBUFFER.MSGID
      1049**DCL      1050--REDEF
OC_MSGBUFFER.WSN
      1056**DCL      1057--REDEF
OC_MSGBUFFER2.FLAGS
      1068**DCL      1069--REDEF
OC_MSGBUFFER2.MSGID
      1064**DCL      1065--REDEF
OC_MSGBUFFER2.WSN
      1071**DCL      1072--REDEF
OC_PARAM
      1079**DCL      1079--REDEF
OC_QDEPTH
      1074**DCL      1340<<ASSIGN   1340>>ASSIGN
OC_QPOSN
      1075**DCL      1327>>ASSIGN   1328>>ASSIGN   1329>>ASSIGN   1332>>ASSIGN   1335>>IF       1337<<ASSIGN
      1339<<ASSIGN   1339>>ASSIGN
OC_QUEUE.ERR
      1078**DCL      1329<<ASSIGN
OC_QUEUE.EVID
      1078**DCL      1328<<ASSIGN
OC_QUEUE.PARMC
      1078**DCL      1078--REDEF
OC_QUEUE.PARMS
      1078**DCL      1332<<ASSIGN
OC_QUEUE.SUBC
      1077**DCL      1327<<ASSIGN
PARMV
      1233**DCL      1332>>ASSIGN
PARMV.CGPARM.MSGIDXT
      1259**DCL      1262--REDEF
STK$
      1310**DCL      1140--IMP-PTR  1326<<ASSIGN   1327>>ASSIGN   1328>>ASSIGN   1329>>ASSIGN   1332>>ASSIGN

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:18   
      112        1        /*M* OCE$PEVENT KEYINs routine to process events off its internal
      113        2                  queue */
      114        3        /*T***********************************************************/
      115        4        /*T*                                                         */
      116        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      117        6        /*T*                                                         */
      118        7        /*T***********************************************************/
      119        8        %SET LISTSUB='1'B;
      120        9        /*
      121       10         ###    ###   #####   #   ####   #####  #   #  #####  #   #  #####
      122       11        #   #  #   #  #      ###  #   #  #      #   #  #      #   #    #
      123       12        #   #  #      #     # #   #   #  #      #   #  #      ##  #    #
      124       13        #   #  #      ####   ###  ####   ####   #   #  ####   # # #    #
      125       14        #   #  #      #       # # #      #      #   #  #      #  ##    #
      126       15        #   #  #   #  #      ###  #      #       # #   #      #   #    #
      127       16         ###    ###   #####   #   #      #####    #    #####  #   #    #
      128       17                                                                   */
      129       18                                                /**/
      130       19        OCE$PEVENT: PROC;
      131       20                                                /**/
      132       21        %INCLUDE OCI_SUBS_C;
      133      119        %INCLUDE OCP_DATA_R;
      134      136        %INCLUDE OC_SUBS_C;
      135      867        %INCLUDE F_ERRORS_C;
      136     1107        %INCLUDE OC_SCODE_C;
      137     1132                                                /**/
      138     1133        %INCLUDE CP_6;
      139     1214        %INCLUDE OC_DAT_R;
      140     1375                                                /**/
      141     1376             %FPT_READ      (FPTN=OC_READ,
      142     1377                                 DCB=M$OCCG,
      143     1378                                 WAIT=NO,
      144     1379                                 EVENT=OC_RDDN_O,
      145     1380                                 BUF=OC_KEYINBUF);
      146     1419                                                /**/
      147     1420             %FPT_READ      (FPTN=CS_READ,
      148     1421                                 DCB=M$CSCG,
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:19   
      149     1422                                 WAIT=NO,
      150     1423                                 EVENT=OC_RDDN_C,
      151     1424                                 BUF=OC_MSGBUFFER);
      152     1463                                                /**/
      153     1464             %B$NWIO        (NAME=NWIO,
      154     1465                                 PARONLY=1,
      155     1466                                 STCLASS="BASED");
      156     1547                                                /**/
      157     1548                                                /**/
      158     1549             %FPT_SCREECH   (FPTN=OCE_SCREECH,
      159     1550                                 SCODE=OCE$SCODE);
      160     1564                                                /**/
      161     1565                                                /**/
      162     1566             %VLP_SCREECH (FPTN=OCE$SCODE,
      163     1567                                 STCLASS=STATIC SYMDEF,
      164     1568                                 FCG=OC,
      165     1569                                 MID=E,
      166     1570                                 MON='0'B,
      167     1571                                 CODE=999);
      168     1641                                                /**/
      169     1642                                                /**/
      170     1643                                                /**/
      171     1644    1   DCL OCN$SKEYIN ENTRY;
      172     1645    1   DCL OCO$MESSHAND ENTRY;
      173     1646    1   DCL OCP$DOLIST ENTRY;
      174     1647    1   DCL OCR$READ ENTRY;
      175     1648    1   DCL OCO$IWRITE ENTRY(8);
      176     1649    1   DCL OCD$MARKEM ENTRY(1);
      177     1650                                                /**/
      178     1651    1   DCL STRUCT1 UBIN BYTE UNAL STATIC INIT(1);
      179     1652    1   DCL STRUCT2 UBIN BYTE UNAL STATIC INIT(4);
      180     1653    1   DCL NP# UBIN BYTE UNAL STATIC INIT(1);
      181     1654    1   DCL MSG# UBIN HALF UNAL STATIC INIT(396 /* GENL_ERR_MSG# */);
      182     1655                                                /**/
      183     1656    1   DCL EVID_REDEF UBIN WORD STATIC ALIGNED;
      184     1657    1   DCL 1 EVID REDEF EVID_REDEF,
      185     1658    1            2 CID BIT(18) UNAL,
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:20   
      186     1659    1            2 EVID UBIN HALF UNAL;
      187     1660                                                /**/
      188     1661    1   DCL M$OCCG DCB;
      189     1662    1   DCL M$CSCG DCB;
      190     1663                                                /**/
      191     1664        %EJECT;
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:21   
      192     1665                                                /**/
      193     1666        /*
      194     1667                  Begin  O C E $ P E V E N T   main
      195     1668                                                          */
      196     1669                                                /**/
      197     1670                                                /**/
      198     1671    2        DO INHIBIT;
      199     1672    2             IF OC_QDEPTH = 0              /* No events to process */
      200     1673    2             THEN
      201     1674    2                  RETURN;
      202     1675    2           END;                            /* INHIBIT */
      203     1676                                           /* Process all events on KEYIN's
      204     1677                                                internal queue            */
      205     1678    2        DO WHILE ('1'B)  /* FOREVER */;
      206     1679                                                /**/
      207     1680                                                /**/
      208     1681    2             EVID_REDEF = OC_QUEUE.EVID(OC_QHEAD);
      209     1682                                                /**/
      210     1683    3             DO CASE (EVID.EVID);
      211     1684                                                /**/
      212     1685                                                /**/
      213     1686                                                /* process a KEYIN */
      214     1687    3             CASE (2 /* OC_RDDN_O */);
      215     1688
      216     1689    4                DO CASE (OC_QUEUE.ERR.CODE(OC_QHEAD));
      217     1690
      218     1691    4                CASE (ELSE);
      219     1692
      220     1693    4                   CALL OCN$SKEYIN;
      221     1694    4                   OC_KEYINBUF = ' ';
      222     1695    4                   CALL M$READ(OC_READ);
      223     1696
      224     1697    4                CASE (%E$EOF);
      225     1698
      226     1699    4                   OC_KEYINBUF=' ';
      227     1700    4                   CALL M$READ(OC_READ);
      228     1701
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:22   
      229     1702                                                /**/
      230     1703
      231     1704    4                CASE (%E$DACTR);
      232     1705
      233     1706                                                /**/
      234     1707                  /*S*
      235     1708                            SCREECH_CODE: OCE-S$OCDEACTIVATED
      236     1709                            TYPE: SCREECH
      237     1710                                 MESSAGE: OCCG was deactivated for some reason
      238     1711                            REMARKS: If KEYIN cannot OCCG because he has been
      239     1712                                      deactivated then there is no point in
      240     1713                                      continuing operations.               */
      241     1714
      242     1715    4                   OCE$SCODE.CODE# = %S$OCDEACTIVATED;
      243     1716    4                   GOTO OCE$SCREECH;
      244     1717
      245     1718    4                CASE (%E$CGKEYV);
      246     1719
      247     1720                       /*S*
      248     1721                            SCREECH_CODE: OCE-S$OCKEYVIOLATION
      249     1722                            TYPE: SCREECH
      250     1723                            MESSAGE: KEYIN tried to read an invalid key on OCCG
      251     1724                            REMARKS:
      252     1725                                                                          */
      253     1726
      254     1727    4                   OCE$SCODE.CODE# = %S$OCKEYVIOLATION;
      255     1728    4                   GOTO OCE$SCREECH;
      256     1729
      257     1730    4                CASE (%E$CGFULL);
      258     1731
      259     1732                       /*S*
      260     1733                            SCREECH_CODE: OCE-S$OCFULL
      261     1734                            TYPE: SCREECH
      262     1735                            MESSAGE: OCCG is full.
      263     1736                            REMARKS:  This shouldn't happen unless :SYS
      264     1737                                       runs out of disc space or the system
      265     1738                                       runs out of memory.               */
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:23   
      266     1739
      267     1740    4                   OCE$SCODE.CODE# = %S$OCFULL;
      268     1741    4                   GOTO OCE$SCREECH;
      269     1742
      270     1743    4                CASE (%E$CGCRCW);
      271     1744
      272     1745                       /*S*
      273     1746                            SCREECH_CODE: OCE-S$OCREADCONTWR
      274     1747                            TYPE: SCREECH
      275     1748                            MESSAGE: OCCG read with a CONT write.
      276     1749                            REMARKS:
      277     1750                                                                          */
      278     1751    4                   OCE$SCODE.CODE# = %S$OCREADCONTWR;
      279     1752    4                   GOTO OCE$SCREECH;
      280     1753
      281     1754    4                CASE (%E$CGCWRV);
      282     1755
      283     1756                       /*S*
      284     1757                            SCREECH_CODE: OCE-S$OCWRRDCONT
      285     1758                            TYPE: SCREECH
      286     1759                            MESSAGE: OCCG write/read cont error
      287     1760                            REMARKS:
      288     1761                                                                          */
      289     1762    4                   OCE$SCODE.CODE# = %S$OCWRRDCONT;
      290     1763    4                   GOTO OCE$SCREECH;
      291     1764                                                /**/
      292     1765                                                /**/
      293     1766
      294     1767    4                END;                       /*  CASE ERR.CODE  */
      295     1768        %EJECT;
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:24   
      296     1769                                                /**/
      297     1770                                                /* process the MESSAGE from CSCG */
      298     1771    3             CASE (3 /* OC_RDDN_C */);
      299     1772    3                CALL OCO$MESSHAND;
      300     1773    3                CALL M$READ(CS_READ);
      301     1774                                                /**/
      302     1775                                           /* Process the write complete event
      303     1776                                                on CSCG */
      304     1777    3             CASE (4 /* OC_WRDN_O */);
      305     1778    3                IF OC_QUEUE.ERR.CODE(OC_QHEAD) = %E$LDSC
      306     1779    3                     AND
      307     1780    3                     EVID.CID ~= '0'B
      308     1781    3                THEN
      309     1782    3                     CALL OCO$IWRITE (EVID.CID, MSG#, NP#,
      310     1783    3                          STRUCT1, STRUCT2, 0, OCP_NON_STA, 0);
      311     1784    3                IF OC_QUEUE.ERR.CODE (OC_QHEAD) = %E$LDSC
      312     1785    3                     AND
      313     1786    3                     OC_ZIPALL
      314     1787    3                THEN
      315     1788    4                DO;
      316     1789                                           /* Account for possiblility of
      317     1790                                                a missing station during
      318     1791                                                system zap */
      319     1792    4                     OC_WSTA = ADDR(OC_QUEUE.PARMS(OC_QHEAD))
      320     1793    4                          -> NWIO.CGPARM.STATION#;
      321     1794    4                     CALL OCD$MARKEM (OC_WSTA);
      322     1795    4                   END;                    /* DO IF ZIP AND LDSC */
      323     1796                                                /**/
      324     1797                                                /**/
      325     1798                                                /**/
      326     1799    3             CASE (5 /* OC_DOLIST_C */);
      327     1800    3                CALL OCP$DOLIST;
      328     1801                                                /**/
      329     1802    3             CASE (6 /* OC_READ_EV */);
      330     1803    3                CALL OCR$READ;
      331     1804                                                /**/
      332     1805    3             END;                          /* CASE */
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:25   
      333     1806                                                /**/
      334     1807    3             DO INHIBIT;
      335     1808    3                  OC_QDEPTH = OC_QDEPTH - 1;
      336     1809    3                  IF OC_QDEPTH = 0
      337     1810    3                  THEN
      338     1811    4                  DO;
      339     1812    4                       OC_QHEAD = OC_QPOSN;
      340     1813    4                       RETURN;
      341     1814    4                     END;                  /* DO IF none left */
      342     1815    3                  IF OC_QHEAD = 199 /* MAX_EVNT# */
      343     1816    3                  THEN
      344     1817    3                       OC_QHEAD = 0;
      345     1818    3                  ELSE
      346     1819    3                       OC_QHEAD = OC_QHEAD + 1;
      347     1820    3                END;                       /* INHIBIT */
      348     1821    2           END;                            /* FOREVER DO WHILE */
      349     1822    1   OCE$SCREECH:
      350     1823    1        CALL M$SCREECH (OCE_SCREECH);
      351     1824                                                /**/
      352     1825    1   END OCE$PEVENT;
      353     1826        %EOD;

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:26   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$PEVENT.

   Procedure OCE$PEVENT requires 148 words for executable code.
   Procedure OCE$PEVENT requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:27   

 Object Unit name= OCE$PEVENT                                 File name= OCE$EVENT.:E05TOU
 UTS= JUL 30 '97 03:56:47.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    41     51  OCE$PEVENT
    2   DCB   even  none     0      0  M$OCCG
    3   DCB   even  none     0      0  M$CSCG
    4   Proc  even  none   148    224  OCE$PEVENT
    5  RoData even  none    10     12  OCE$PEVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  OCE$PEVENT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     42  OCE$SCODE
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:28   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 OCN$SKEYIN
         yes           Std       0 OCO$MESSHAND
         yes           Std       0 OCR$READ
         yes           Std       8 OCO$IWRITE
         yes           Std       0 OCP$DOLIST
         yes           Std       1 OCD$MARKEM
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
     OCP_NON_STA                           M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_QDEPTH
     OC_QHEAD                              OC_QPOSN                              OC_KEYINBUF
     OC_QUEUE                              OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_ZIPALL                             OC_WSTA                               M$OCCG
     M$CSCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:29   


      112        1        /*M* OCE$PEVENT KEYINs routine to process events off its internal
      113        2                  queue */
      114        3        /*T***********************************************************/
      115        4        /*T*                                                         */
      116        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      117        6        /*T*                                                         */
      118        7        /*T***********************************************************/
      119        8        %SET LISTSUB='1'B;
      120        9        /*
      121       10         ###    ###   #####   #   ####   #####  #   #  #####  #   #  #####
      122       11        #   #  #   #  #      ###  #   #  #      #   #  #      #   #    #
      123       12        #   #  #      #     # #   #   #  #      #   #  #      ##  #    #
      124       13        #   #  #      ####   ###  ####   ####   #   #  ####   # # #    #
      125       14        #   #  #      #       # # #      #      #   #  #      #  ##    #
      126       15        #   #  #   #  #      ###  #      #       # #   #      #   #    #
      127       16         ###    ###   #####   #   #      #####    #    #####  #   #    #
      128       17                                                                   */
      129       18                                                /**/
      130       19        OCE$PEVENT: PROC;

     19  4 000000   000000 700200 xent  OCE$PEVENT   TSX0  ! X66_AUTO_0
         4 000001   000004 000000                    ZERO    4,0

      131       20                                                /**/
      132       21        %INCLUDE OCI_SUBS_C;
      133      119        %INCLUDE OCP_DATA_R;
      134      136        %INCLUDE OC_SUBS_C;
      135      867        %INCLUDE F_ERRORS_C;
      136     1107        %INCLUDE OC_SCODE_C;
      137     1132                                                /**/
      138     1133        %INCLUDE CP_6;
      139     1214        %INCLUDE OC_DAT_R;
      140     1375                                                /**/
      141     1376             %FPT_READ      (FPTN=OC_READ,
      142     1377                                 DCB=M$OCCG,
      143     1378                                 WAIT=NO,
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:30   
      144     1379                                 EVENT=OC_RDDN_O,
      145     1380                                 BUF=OC_KEYINBUF);
      146     1419                                                /**/
      147     1420             %FPT_READ      (FPTN=CS_READ,
      148     1421                                 DCB=M$CSCG,
      149     1422                                 WAIT=NO,
      150     1423                                 EVENT=OC_RDDN_C,
      151     1424                                 BUF=OC_MSGBUFFER);
      152     1463                                                /**/
      153     1464             %B$NWIO        (NAME=NWIO,
      154     1465                                 PARONLY=1,
      155     1466                                 STCLASS="BASED");
      156     1547                                                /**/
      157     1548                                                /**/
      158     1549             %FPT_SCREECH   (FPTN=OCE_SCREECH,
      159     1550                                 SCODE=OCE$SCODE);
      160     1564                                                /**/
      161     1565                                                /**/
      162     1566             %VLP_SCREECH (FPTN=OCE$SCODE,
      163     1567                                 STCLASS=STATIC SYMDEF,
      164     1568                                 FCG=OC,
      165     1569                                 MID=E,
      166     1570                                 MON='0'B,
      167     1571                                 CODE=999);
      168     1641                                                /**/
      169     1642                                                /**/
      170     1643                                                /**/
      171     1644    1   DCL OCN$SKEYIN ENTRY;
      172     1645    1   DCL OCO$MESSHAND ENTRY;
      173     1646    1   DCL OCP$DOLIST ENTRY;
      174     1647    1   DCL OCR$READ ENTRY;
      175     1648    1   DCL OCO$IWRITE ENTRY(8);
      176     1649    1   DCL OCD$MARKEM ENTRY(1);
      177     1650                                                /**/
      178     1651    1   DCL STRUCT1 UBIN BYTE UNAL STATIC INIT(1);
      179     1652    1   DCL STRUCT2 UBIN BYTE UNAL STATIC INIT(4);
      180     1653    1   DCL NP# UBIN BYTE UNAL STATIC INIT(1);
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:31   
      181     1654    1   DCL MSG# UBIN HALF UNAL STATIC INIT(396 /* GENL_ERR_MSG# */);
      182     1655                                                /**/
      183     1656    1   DCL EVID_REDEF UBIN WORD STATIC ALIGNED;
      184     1657    1   DCL 1 EVID REDEF EVID_REDEF,
      185     1658    1            2 CID BIT(18) UNAL,
      186     1659    1            2 EVID UBIN HALF UNAL;
      187     1660                                                /**/
      188     1661    1   DCL M$OCCG DCB;
      189     1662    1   DCL M$CSCG DCB;
      190     1663                                                /**/
      191     1664        %EJECT;
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:32   
      192     1665                                                /**/
      193     1666        /*
      194     1667                  Begin  O C E $ P E V E N T   main
      195     1668                                                          */
      196     1669                                                /**/
      197     1670                                                /**/
      198     1671    2        DO INHIBIT;

      199     1672    2             IF OC_QDEPTH = 0              /* No events to process */

   1672  4 000002   000000 235200 xsym               LDA   ! OC_QDEPTH
         4 000003   000005 601200 4                  TNZ   ! s:1681

      200     1673    2             THEN
      201     1674    2                  RETURN;

   1674  4 000004   000000 702200 xent               TSX2  ! X66_ARET

      202     1675    2           END;                            /* INHIBIT */

      203     1676                                           /* Process all events on KEYIN's
      204     1677                                                internal queue            */
      205     1678    2        DO WHILE ('1'B)  /* FOREVER */;

      206     1679                                                /**/
      207     1680                                                /**/
      208     1681    2             EVID_REDEF = OC_QUEUE.EVID(OC_QHEAD);

   1681  4 000005   000000 236000 xsym               LDQ     OC_QHEAD
         4 000006   000017 402007                    MPY     15,DL
         4 000007   000001 235006 xsym               LDA     OC_QUEUE+1,QL
         4 000010   000050 755000 1                  STA     EVID_REDEF

      209     1682                                                /**/
      210     1683    3             DO CASE (EVID.EVID);

   1683  4 000011   000050 720000 1                  LXL0    EVID_REDEF
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:33   
         4 000012   000007 100003                    CMPX0   7,DU
         4 000013   000015 602010 4                  TNC     s:1683+4,X0
         4 000014   000202 710000 4                  TRA     s:1808
         4 000015   000202 710000 4                  TRA     s:1808
         4 000016   000202 710000 4                  TRA     s:1808
         4 000017   000024 710000 4                  TRA     s:1689
         4 000020   000130 710000 4                  TRA     s:1772
         4 000021   000137 710000 4                  TRA     s:1778
         4 000022   000173 710000 4                  TRA     s:1800
         4 000023   000177 710000 4                  TRA     s:1803

      211     1684                                                /**/
      212     1685                                                /**/
      213     1686                                                /* process a KEYIN */
      214     1687    3             CASE (2 /* OC_RDDN_O */);

      215     1688
      216     1689    4                DO CASE (OC_QUEUE.ERR.CODE(OC_QHEAD));

   1689  4 000024   000002 236006 xsym               LDQ     OC_QUEUE+2,QL
         4 000025   000003 772000                    QRL     3
         4 000026   037777 376007                    ANQ     16383,DL
         4 000027   000006 136007                    SBLQ    6,DL
         4 000030   000023 116007                    CMPQ    19,DL
         4 000031   000033 602006 4                  TNC     s:1689+7,QL
         4 000032   000056 710000 4                  TRA     s:1693
         4 000033   000070 710000 4                  TRA     s:1699
         4 000034   000056 710000 4                  TRA     s:1693
         4 000035   000056 710000 4                  TRA     s:1693
         4 000036   000056 710000 4                  TRA     s:1693
         4 000037   000056 710000 4                  TRA     s:1693
         4 000040   000056 710000 4                  TRA     s:1693
         4 000041   000056 710000 4                  TRA     s:1693
         4 000042   000077 710000 4                  TRA     s:1715
         4 000043   000056 710000 4                  TRA     s:1693
         4 000044   000056 710000 4                  TRA     s:1693
         4 000045   000056 710000 4                  TRA     s:1693
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:34   
         4 000046   000056 710000 4                  TRA     s:1693
         4 000047   000056 710000 4                  TRA     s:1693
         4 000050   000056 710000 4                  TRA     s:1693
         4 000051   000104 710000 4                  TRA     s:1727
         4 000052   000056 710000 4                  TRA     s:1693
         4 000053   000111 710000 4                  TRA     s:1740
         4 000054   000116 710000 4                  TRA     s:1751
         4 000055   000123 710000 4                  TRA     s:1762

      217     1690
      218     1691    4                CASE (ELSE);

      219     1692
      220     1693    4                   CALL OCN$SKEYIN;

   1693  4 000056   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000057   000000 701000 xent               TSX1    OCN$SKEYIN
         4 000060   000000 011000                    NOP     0

      221     1694    4                   OC_KEYINBUF = ' ';

   1694  4 000061   040000 100400                    MLR     fill='040'O
         4 000062   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000063   000000 000400 xsym               ADSC9   OC_KEYINBUF              cn=0,n=256

      222     1695    4                   CALL M$READ(OC_READ);

   1695  4 000064   000000 630400 1                  EPPR0   OC_READ
         4 000065   040000 713400                    CLIMB   read
         4 000066   401400 401760                    pmme    nvectors=4
         4 000067   000202 710000 4                  TRA     s:1808

      223     1696
      224     1697    4                CASE (%E$EOF);

      225     1698
      226     1699    4                   OC_KEYINBUF=' ';
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:35   

   1699  4 000070   040000 100400                    MLR     fill='040'O
         4 000071   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000072   000000 000400 xsym               ADSC9   OC_KEYINBUF              cn=0,n=256

      227     1700    4                   CALL M$READ(OC_READ);

   1700  4 000073   000000 630400 1                  EPPR0   OC_READ
         4 000074   040000 713400                    CLIMB   read
         4 000075   401400 401760                    pmme    nvectors=4
         4 000076   000202 710000 4                  TRA     s:1808

      228     1701
      229     1702                                                /**/
      230     1703
      231     1704    4                CASE (%E$DACTR);

      232     1705
      233     1706                                                /**/
      234     1707                  /*S*
      235     1708                            SCREECH_CODE: OCE-S$OCDEACTIVATED
      236     1709                            TYPE: SCREECH
      237     1710                                 MESSAGE: OCCG was deactivated for some reason
      238     1711                            REMARKS: If KEYIN cannot OCCG because he has been
      239     1712                                      deactivated then there is no point in
      240     1713                                      continuing operations.               */
      241     1714
      242     1715    4                   OCE$SCODE.CODE# = %S$OCDEACTIVATED;

   1715  4 000077   000042 236000 1                  LDQ     OCE$SCODE
         4 000100   000000 376000 5                  ANQ     0
         4 000101   004560 276007                    ORQ     2416,DL
         4 000102   000042 756000 1                  STQ     OCE$SCODE

      243     1716    4                   GOTO OCE$SCREECH;

   1716  4 000103   000220 710000 4                  TRA     OCE$SCREECH
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:36   

      244     1717
      245     1718    4                CASE (%E$CGKEYV);

      246     1719
      247     1720                       /*S*
      248     1721                            SCREECH_CODE: OCE-S$OCKEYVIOLATION
      249     1722                            TYPE: SCREECH
      250     1723                            MESSAGE: KEYIN tried to read an invalid key on OCCG
      251     1724                            REMARKS:
      252     1725                                                                          */
      253     1726
      254     1727    4                   OCE$SCODE.CODE# = %S$OCKEYVIOLATION;

   1727  4 000104   000042 236000 1                  LDQ     OCE$SCODE
         4 000105   000000 376000 5                  ANQ     0
         4 000106   004740 276007                    ORQ     2528,DL
         4 000107   000042 756000 1                  STQ     OCE$SCODE

      255     1728    4                   GOTO OCE$SCREECH;

   1728  4 000110   000220 710000 4                  TRA     OCE$SCREECH

      256     1729
      257     1730    4                CASE (%E$CGFULL);

      258     1731
      259     1732                       /*S*
      260     1733                            SCREECH_CODE: OCE-S$OCFULL
      261     1734                            TYPE: SCREECH
      262     1735                            MESSAGE: OCCG is full.
      263     1736                            REMARKS:  This shouldn't happen unless :SYS
      264     1737                                       runs out of disc space or the system
      265     1738                                       runs out of memory.               */
      266     1739
      267     1740    4                   OCE$SCODE.CODE# = %S$OCFULL;

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:37   
   1740  4 000111   000042 236000 1                  LDQ     OCE$SCODE
         4 000112   000000 376000 5                  ANQ     0
         4 000113   004750 276007                    ORQ     2536,DL
         4 000114   000042 756000 1                  STQ     OCE$SCODE

      268     1741    4                   GOTO OCE$SCREECH;

   1741  4 000115   000220 710000 4                  TRA     OCE$SCREECH

      269     1742
      270     1743    4                CASE (%E$CGCRCW);

      271     1744
      272     1745                       /*S*
      273     1746                            SCREECH_CODE: OCE-S$OCREADCONTWR
      274     1747                            TYPE: SCREECH
      275     1748                            MESSAGE: OCCG read with a CONT write.
      276     1749                            REMARKS:
      277     1750                                                                          */
      278     1751    4                   OCE$SCODE.CODE# = %S$OCREADCONTWR;

   1751  4 000116   000042 236000 1                  LDQ     OCE$SCODE
         4 000117   000000 376000 5                  ANQ     0
         4 000120   004760 276007                    ORQ     2544,DL
         4 000121   000042 756000 1                  STQ     OCE$SCODE

      279     1752    4                   GOTO OCE$SCREECH;

   1752  4 000122   000220 710000 4                  TRA     OCE$SCREECH

      280     1753
      281     1754    4                CASE (%E$CGCWRV);

      282     1755
      283     1756                       /*S*
      284     1757                            SCREECH_CODE: OCE-S$OCWRRDCONT
      285     1758                            TYPE: SCREECH
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:38   
      286     1759                            MESSAGE: OCCG write/read cont error
      287     1760                            REMARKS:
      288     1761                                                                          */
      289     1762    4                   OCE$SCODE.CODE# = %S$OCWRRDCONT;

   1762  4 000123   000042 236000 1                  LDQ     OCE$SCODE
         4 000124   000000 376000 5                  ANQ     0
         4 000125   004770 276007                    ORQ     2552,DL
         4 000126   000042 756000 1                  STQ     OCE$SCODE

      290     1763    4                   GOTO OCE$SCREECH;

   1763  4 000127   000220 710000 4                  TRA     OCE$SCREECH

      291     1764                                                /**/
      292     1765                                                /**/
      293     1766
      294     1767    4                END;                       /*  CASE ERR.CODE  */

      295     1768        %EJECT;
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:39   
      296     1769                                                /**/
      297     1770                                                /* process the MESSAGE from CSCG */
      298     1771    3             CASE (3 /* OC_RDDN_C */);

      299     1772    3                CALL OCO$MESSHAND;

   1772  4 000130   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000131   000000 701000 xent               TSX1    OCO$MESSHAND
         4 000132   000000 011000                    NOP     0

      300     1773    3                CALL M$READ(CS_READ);

   1773  4 000133   000016 630400 1                  EPPR0   CS_READ
         4 000134   040000 713400                    CLIMB   read
         4 000135   401400 401760                    pmme    nvectors=4
         4 000136   000202 710000 4                  TRA     s:1808

      301     1774                                                /**/
      302     1775                                           /* Process the write complete event
      303     1776                                                on CSCG */
      304     1777    3             CASE (4 /* OC_WRDN_O */);

      305     1778    3                IF OC_QUEUE.ERR.CODE(OC_QHEAD) = %E$LDSC

   1778  4 000137   000002 236006 xsym               LDQ     OC_QUEUE+2,QL
         4 000140   377770 376007                    ANQ     131064,DL
         4 000141   000140 116007                    CMPQ    96,DL
         4 000142   000151 601000 4                  TNZ     s:1784
         4 000143   000050 221000 1                  LDX1    EVID_REDEF
         4 000144   000151 600000 4                  TZE     s:1784

      306     1779    3                     AND
      307     1780    3                     EVID.CID ~= '0'B
      308     1781    3                THEN
      309     1782    3                     CALL OCO$IWRITE (EVID.CID, MSG#, NP#,

   1782  4 000145   000001 630400 5                  EPPR0   1
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:40   
         4 000146   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000147   000000 701000 xent               TSX1    OCO$IWRITE
         4 000150   000000 011000                    NOP     0

      310     1783    3                          STRUCT1, STRUCT2, 0, OCP_NON_STA, 0);
      311     1784    3                IF OC_QUEUE.ERR.CODE (OC_QHEAD) = %E$LDSC

   1784  4 000151   000000 236000 xsym               LDQ     OC_QHEAD
         4 000152   000017 402007                    MPY     15,DL
         4 000153   000002 236006 xsym               LDQ     OC_QUEUE+2,QL
         4 000154   377770 376007                    ANQ     131064,DL
         4 000155   000140 116007                    CMPQ    96,DL
         4 000156   000202 601000 4                  TNZ     s:1808
         4 000157   000000 234000 xsym               SZN     OC_ZIPALL
         4 000160   000202 605000 4                  TPL     s:1808

      312     1785    3                     AND
      313     1786    3                     OC_ZIPALL
      314     1787    3                THEN
      315     1788    4                DO;

      316     1789                                           /* Account for possiblility of
      317     1790                                                a missing station during
      318     1791                                                system zap */
      319     1792    4                     OC_WSTA = ADDR(OC_QUEUE.PARMS(OC_QHEAD))

   1792  4 000161   000000 236000 xsym               LDQ     OC_QHEAD
         4 000162   000074 402007                    MPY     60,DL
         4 000163   040000 100406                    MLR     fill='040'O
         4 000164   000007 000010 xsym               ADSC9   OC_QUEUE+7,Q             cn=0,n=8
         4 000165   000000 000010 xsym               ADSC9   OC_WSTA                  cn=0,n=8

      320     1793    4                          -> NWIO.CGPARM.STATION#;
      321     1794    4                     CALL OCD$MARKEM (OC_WSTA);

   1794  4 000166   000011 630400 5                  EPPR0   9
         4 000167   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:41   
         4 000170   000000 701000 xent               TSX1    OCD$MARKEM
         4 000171   000000 011000                    NOP     0

      322     1795    4                   END;                    /* DO IF ZIP AND LDSC */

   1795  4 000172   000202 710000 4                  TRA     s:1808

      323     1796                                                /**/
      324     1797                                                /**/
      325     1798                                                /**/
      326     1799    3             CASE (5 /* OC_DOLIST_C */);

      327     1800    3                CALL OCP$DOLIST;

   1800  4 000173   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000174   000000 701000 xent               TSX1    OCP$DOLIST
         4 000175   000000 011000                    NOP     0
         4 000176   000202 710000 4                  TRA     s:1808

      328     1801                                                /**/
      329     1802    3             CASE (6 /* OC_READ_EV */);

      330     1803    3                CALL OCR$READ;

   1803  4 000177   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000200   000000 701000 xent               TSX1    OCR$READ
         4 000201   000000 011000                    NOP     0

      331     1804                                                /**/
      332     1805    3             END;                          /* CASE */

      333     1806                                                /**/
      334     1807    3             DO INHIBIT;

      335     1808    3                  OC_QDEPTH = OC_QDEPTH - 1;

   1808  4 000202   000001 336207                    LCQ   ! 1,DL
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:42   
         4 000203   000000 056200 xsym               ASQ   ! OC_QDEPTH

      336     1809    3                  IF OC_QDEPTH = 0

   1809  4 000204   000210 601200 4                  TNZ   ! s:1815

      337     1810    3                  THEN
      338     1811    4                  DO;

      339     1812    4                       OC_QHEAD = OC_QPOSN;

   1812  4 000205   000000 235200 xsym               LDA   ! OC_QPOSN
         4 000206   000000 755200 xsym               STA   ! OC_QHEAD

      340     1813    4                       RETURN;

   1813  4 000207   000000 702200 xent               TSX2  ! X66_ARET

      341     1814    4                     END;                  /* DO IF none left */
      342     1815    3                  IF OC_QHEAD = 199 /* MAX_EVNT# */

   1815  4 000210   000000 235200 xsym               LDA   ! OC_QHEAD
         4 000211   000307 115207                    CMPA  ! 199,DL
         4 000212   000215 601200 4                  TNZ   ! s:1819

      343     1816    3                  THEN
      344     1817    3                       OC_QHEAD = 0;

   1817  4 000213   000000 450200 xsym               STZ   ! OC_QHEAD
         4 000214   000217 710200 4                  TRA   ! s:1821

      345     1818    3                  ELSE
      346     1819    3                       OC_QHEAD = OC_QHEAD + 1;

   1819  4 000215   000001 035207                    ADLA  ! 1,DL
         4 000216   000000 755200 xsym               STA   ! OC_QHEAD

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:43   
      347     1820    3                END;                       /* INHIBIT */

      348     1821    2           END;                            /* FOREVER DO WHILE */

   1821  4 000217   000005 710000 4                  TRA     s:1681

      349     1822    1   OCE$SCREECH:
      350     1823    1        CALL M$SCREECH (OCE_SCREECH);

   1823  4 000220   000034 630400 1     OCE$SCREECH  EPPR0   OCE_SCREECH
         4 000221   000013 713400                    CLIMB   11
         4 000222   401000 401760                    pmme    nvectors=3

      351     1824                                                /**/
      352     1825    1   END OCE$PEVENT;

   1825  4 000223   000000 702200 xent               TSX2  ! X66_ARET
      353     1826        %EOD;

PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:44   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$PEVENT.
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:45   

 **** Variables and constants ****

  ****  Section 001  Data  OCE$PEVENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/d STRC(504)   r     1 CS_READ                   50-0-0/w STRC        r     1 EVID
    50-0-0/w UBIN        r     1 EVID_REDEF                47-0-0/b UBIN(18)    r     1 MSG#
    46-0-0/b UBIN(9)     r     1 NP#                       42-0-0/d STRC(72)    r     1 OCE$SCODE
    34-0-0/d STRC(216)   r     1 OCE_SCREECH                0-0-0/d STRC(504)   r     1 OC_READ
    44-0-0/b UBIN(9)     r     1 STRUCT1                   45-0-0/b UBIN(9)     r     1 STRUCT2

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 OCP_NON_STA                0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/c CHAR(256)   r     1 OC_KEYINBUF                0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER
     0-0-0/w SBIN        r     1 OC_QDEPTH                  0-0-0/w UBIN        r     1 OC_QHEAD
     0-0-0/w UBIN        r     1 OC_QPOSN                   0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)
     0-0-0/c CHAR(8)     r     1 OC_WSTA                    0-0-0/w BIT         r     1 OC_ZIPALL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(468)   r     1 NWIO


   Procedure OCE$PEVENT requires 148 words for executable code.
   Procedure OCE$PEVENT requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:46   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:47   
          MINI XREF LISTING

CS_READ
      1441**DCL      1773<>CALL
CS_READ.STATION_
      1444**DCL      1445--REDEF
CS_READ.V
      1445**DCL      1441--DCLINIT
CS_READ.V.DVBYTE.REREAD#
      1456**DCL      1456--REDEF
CS_READ.V.INDX#
      1454**DCL      1454--REDEF
EVID.CID
      1658**DCL      1778>>IF       1782<>CALL
EVID.EVID
      1659**DCL      1683>>DOCASE
EVID_REDEF
      1656**DCL      1657--REDEF    1681<<ASSIGN
M$READ
      1143**DCL-ENT  1695--CALL     1700--CALL     1773--CALL
M$SCREECH
      1156**DCL-ENT  1823--CALL
MSG#
      1654**DCL      1782<>CALL
NP#
      1653**DCL      1782<>CALL
NWIO.CGPARM.MSGIDXT
      1496**DCL      1499--REDEF
NWIO.CGPARM.STATION#
      1490**DCL      1792>>ASSIGN
OCD$MARKEM
      1649**DCL-ENT  1794--CALL
OCE$SCODE
      1594**DCL      1561--DCLINIT
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:48   
OCE$SCODE.CODE#
      1620**DCL      1715<<ASSIGN   1727<<ASSIGN   1740<<ASSIGN   1751<<ASSIGN   1762<<ASSIGN
OCE$SCREECH
      1823**LABEL    1716--GOTO     1728--GOTO     1741--GOTO     1752--GOTO     1763--GOTO
OCE_SCREECH
      1561**DCL      1823<>CALL
OCN$SKEYIN
      1644**DCL-ENT  1693--CALL
OCO$IWRITE
      1648**DCL-ENT  1782--CALL
OCO$MESSHAND
      1645**DCL-ENT  1772--CALL
OCP$DOLIST
      1646**DCL-ENT  1800--CALL
OCP_FREE_HEAD
       128**DCL       129--REDEF
OCP_MSGBUF_FREE.B
       132**DCL       132--REDEF
OCP_NON_STA
       134**DCL      1782<>CALL
OCP_USED_HEAD
       129**DCL       130--REDEF
OCP_USED_TAIL
       130**DCL       130--REDEF
OCR$READ
      1647**DCL-ENT  1803--CALL
OC_CONSOLE.ATTR
      1328**DCL      1328--REDEF
OC_CONSOLE.ATTRO
      1329**DCL      1329--REDEF
OC_CONSOLE.CID
      1327**DCL      1328--REDEF
OC_CONSOLE.STATION
      1326**DCL      1326--REDEF
OC_CONSOLE$
      1325**DCL      1326--IMP-PTR
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:49   
OC_DIR
      1368**DCL      1368--REDEF
OC_INTBIT
      1368**DCL      1369--REDEF
OC_INTMSG
      1245**DCL      1258--REDEF
OC_INTMSG.FLAGS
      1252**DCL      1253--REDEF
OC_INTMSG.MESS
      1258**DCL      1258--REDEF
OC_INTMSG.MSGID
      1248**DCL      1249--REDEF
OC_INTMSG.WSN
      1255**DCL      1256--REDEF
OC_KEYINBUF
      1322**DCL      1399--DCLINIT  1400--DCLINIT  1694<<ASSIGN   1699<<ASSIGN
OC_MASK
      1369**DCL      1369--REDEF
OC_MESSBUF
      1260**DCL      1275--REDEF    1289--REDEF
OC_MESSBUF.FLAGS
      1267**DCL      1268--REDEF
OC_MESSBUF.MESS
      1273**DCL      1273--REDEF
OC_MESSBUF.MSGID
      1263**DCL      1264--REDEF
OC_MESSBUF.WSN
      1270**DCL      1271--REDEF
OC_MESSBUF1.FLAGS
      1282**DCL      1283--REDEF
OC_MESSBUF1.LEN
      1288**DCL      1288--REDEF
OC_MESSBUF1.MSGID
      1278**DCL      1279--REDEF
OC_MESSBUF1.WSN
      1285**DCL      1286--REDEF
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:50   
OC_MSGBUFFER
      1291**DCL      1306--REDEF    1443--DCLINIT  1444--DCLINIT
OC_MSGBUFFER.FLAGS
      1298**DCL      1299--REDEF
OC_MSGBUFFER.MESS
      1304**DCL      1304--REDEF
OC_MSGBUFFER.MSGID
      1294**DCL      1295--REDEF
OC_MSGBUFFER.WSN
      1301**DCL      1302--REDEF
OC_MSGBUFFER2.FLAGS
      1313**DCL      1314--REDEF
OC_MSGBUFFER2.MSGID
      1309**DCL      1310--REDEF
OC_MSGBUFFER2.WSN
      1316**DCL      1317--REDEF
OC_PARAM
      1324**DCL      1324--REDEF
OC_QDEPTH
      1319**DCL      1672>>IF       1808<<ASSIGN   1808>>ASSIGN   1809>>IF
OC_QHEAD
      1320**DCL      1681>>ASSIGN   1689>>DOCASE   1778>>IF       1784>>IF       1792>>ASSIGN   1812<<ASSIGN
      1815>>IF       1817<<ASSIGN   1819<<ASSIGN   1819>>ASSIGN
OC_QPOSN
      1320**DCL      1812>>ASSIGN
OC_QUEUE.ERR.CODE
      1323**DCL      1689>>DOCASE   1778>>IF       1784>>IF
OC_QUEUE.EVID
      1323**DCL      1681>>ASSIGN
OC_QUEUE.PARMC
      1323**DCL      1323--REDEF
OC_QUEUE.PARMS
      1323**DCL      1792--ASSIGN
OC_READ
      1397**DCL      1695<>CALL     1700<>CALL
OC_READ.STATION_
PL6.E3A0      #002=OCE$PEVENT File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:56 Page:51   
      1400**DCL      1401--REDEF
OC_READ.V
      1401**DCL      1397--DCLINIT
OC_READ.V.DVBYTE.REREAD#
      1412**DCL      1412--REDEF
OC_READ.V.INDX#
      1410**DCL      1410--REDEF
OC_WSTA
      1371**DCL      1792<<ASSIGN   1794<>CALL
OC_ZIPALL
      1370**DCL      1784>>IF
STRUCT1
      1651**DCL      1782<>CALL
STRUCT2
      1652**DCL      1782<>CALL

PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:52   
      354        1        /*M* OCE$MAKEDO Creates a psuedo event on KEYINs internal queue for
      355        2                            timed dolist calls */
      356        3        /*T***********************************************************/
      357        4        /*T*                                                         */
      358        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      359        6        /*T*                                                         */
      360        7        /*T***********************************************************/
      361        8        %SET LISTSUB='1'B;
      362        9        /*
      363       10         ###    ###   #####   #   #   #   ###   #   #  #####  ####    ###
      364       11        #   #  #   #  #      ###  ## ##  #   #  #  #   #      #   #  #   #
      365       12        #   #  #      #     # #   # # #  #   #  # #    #      #   #  #   #
      366       13        #   #  #      ####   ###  #   #  #####  ##     ####   #   #  #   #
      367       14        #   #  #      #       # # #   #  #   #  # #    #      #   #  #   #
      368       15        #   #  #   #  #      ###  #   #  #   #  #  #   #      #   #  #   #
      369       16         ###    ###   #####   #   #   #  #   #  #   #  #####  ####    ###
      370       17                                                                   */
      371       18                                                /**/
      372       19        OCE$MAKEDO: PROC(OCE_EVENT_ID,OCE_CONNUM);
      373       20                                                /**/
      374       21        %INCLUDE OC_SUBS_C;
      375      752        %INCLUDE OCI_SUBS_C;
      376      850        %INCLUDE CP_6;
      377      931        %INCLUDE OC_DAT_R;
      378     1092                                                /**/
      379     1093    1   DCL OCE_EVENT_ID UBIN WORD;             /* THE EVENT TO INSERT */
      380     1094    1   DCL OCE_CONNUM UBIN WORD;               /* THE CONSOLE NUMBER */
      381     1095                                                /**/
      382     1096        %EJECT;
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:53   
      383     1097        /*
      384     1098                  Begin  O C E $ M A K E D O  main
      385     1099                                                     */
      386     1100                                                /**/
      387     1101    2        DO INHIBIT;
      388     1102                                                /**/
      389     1103    2             OC_QUEUE.SUBC(OC_QPOSN) = OCE_CONNUM;
      390     1104    2             OC_QUEUE.EVID(OC_QPOSN) = OCE_EVENT_ID;
      391     1105    2             OC_QUEUE.ERR(OC_QPOSN) = '0'B;
      392     1106    2             OC_QUEUE.PARMC(OC_QPOSN) = ' ';
      393     1107                                                /**/
      394     1108    2             IF OC_QPOSN = 199 /* MAX_EVNT# */
      395     1109    2             THEN
      396     1110    2                  OC_QPOSN = 0;
      397     1111    2             ELSE
      398     1112    2                  OC_QPOSN = OC_QPOSN + 1;
      399     1113    2             OC_QDEPTH = OC_QDEPTH + 1;
      400     1114                                                /**/
      401     1115    2           END;                            /* DO INHBIT */
      402     1116    1        RETURN;
      403     1117                                                /**/
      404     1118    1   END OCE$MAKEDO;

PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:54   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$MAKEDO.

   Procedure OCE$MAKEDO requires 25 words for executable code.
   Procedure OCE$MAKEDO requires 6 words of local(AUTO) storage.

    No errors detected in file OCE$EVENT.:E05TSI    .

PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:55   

 Object Unit name= OCE$MAKEDO                                 File name= OCE$EVENT.:E05TOU
 UTS= JUL 30 '97 03:57:13.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none    25     31  OCE$MAKEDO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  OCE$MAKEDO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_QDEPTH                             OC_QPOSN
     OC_QUEUE                              OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B_VECTNIL
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:56   


      354        1        /*M* OCE$MAKEDO Creates a psuedo event on KEYINs internal queue for
      355        2                            timed dolist calls */
      356        3        /*T***********************************************************/
      357        4        /*T*                                                         */
      358        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      359        6        /*T*                                                         */
      360        7        /*T***********************************************************/
      361        8        %SET LISTSUB='1'B;
      362        9        /*
      363       10         ###    ###   #####   #   #   #   ###   #   #  #####  ####    ###
      364       11        #   #  #   #  #      ###  ## ##  #   #  #  #   #      #   #  #   #
      365       12        #   #  #      #     # #   # # #  #   #  # #    #      #   #  #   #
      366       13        #   #  #      ####   ###  #   #  #####  ##     ####   #   #  #   #
      367       14        #   #  #      #       # # #   #  #   #  # #    #      #   #  #   #
      368       15        #   #  #   #  #      ###  #   #  #   #  #  #   #      #   #  #   #
      369       16         ###    ###   #####   #   #   #  #   #  #   #  #####  ####    ###
      370       17                                                                   */
      371       18                                                /**/
      372       19        OCE$MAKEDO: PROC(OCE_EVENT_ID,OCE_CONNUM);

     19  1 000000   000000 700200 xent  OCE$MAKEDO   TSX0  ! X66_AUTO_2
         1 000001   000006 000002                    ZERO    6,2

      373       20                                                /**/
      374       21        %INCLUDE OC_SUBS_C;
      375      752        %INCLUDE OCI_SUBS_C;
      376      850        %INCLUDE CP_6;
      377      931        %INCLUDE OC_DAT_R;
      378     1092                                                /**/
      379     1093    1   DCL OCE_EVENT_ID UBIN WORD;             /* THE EVENT TO INSERT */
      380     1094    1   DCL OCE_CONNUM UBIN WORD;               /* THE CONSOLE NUMBER */
      381     1095                                                /**/
      382     1096        %EJECT;
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:57   
      383     1097        /*
      384     1098                  Begin  O C E $ M A K E D O  main
      385     1099                                                     */
      386     1100                                                /**/
      387     1101    2        DO INHIBIT;

      388     1102                                                /**/
      389     1103    2             OC_QUEUE.SUBC(OC_QPOSN) = OCE_CONNUM;

   1103  1 000002   000000 236200 xsym               LDQ   ! OC_QPOSN
         1 000003   000017 402207                    MPY   ! 15,DL
         1 000004   200004 470700                    LDP0  ! @OCE_CONNUM,,AUTO
         1 000005   000000 235300                    LDA   ! 0,,PR0
         1 000006   000000 755206 xsym               STA   ! OC_QUEUE,QL

      390     1104    2             OC_QUEUE.EVID(OC_QPOSN) = OCE_EVENT_ID;

   1104  1 000007   200003 471700                    LDP1  ! @OCE_EVENT_ID,,AUTO
         1 000010   100000 235300                    LDA   ! 0,,PR1
         1 000011   000001 755206 xsym               STA   ! OC_QUEUE+1,QL

      391     1105    2             OC_QUEUE.ERR(OC_QPOSN) = '0'B;

   1105  1 000012   000002 450206 xsym               STZ   ! OC_QUEUE+2,QL

      392     1106    2             OC_QUEUE.PARMC(OC_QPOSN) = ' ';

   1106  1 000013   000000 236200 xsym               LDQ   ! OC_QPOSN
         1 000014   000074 402207                    MPY   ! 60,DL
         1 000015   040006 100600                    MLR   ! fill='040'O
         1 000016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000017   000003 000060 xsym               ADSC9   OC_QUEUE+3,Q             cn=0,n=48

      393     1107                                                /**/
      394     1108    2             IF OC_QPOSN = 199 /* MAX_EVNT# */

   1108  1 000020   000000 235200 xsym               LDA   ! OC_QPOSN
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:58   
         1 000021   000307 115207                    CMPA  ! 199,DL
         1 000022   000025 601200 1                  TNZ   ! s:1112

      395     1109    2             THEN
      396     1110    2                  OC_QPOSN = 0;

   1110  1 000023   000000 450200 xsym               STZ   ! OC_QPOSN
         1 000024   000027 710200 1                  TRA   ! s:1113

      397     1111    2             ELSE
      398     1112    2                  OC_QPOSN = OC_QPOSN + 1;

   1112  1 000025   000001 035207                    ADLA  ! 1,DL
         1 000026   000000 755200 xsym               STA   ! OC_QPOSN

      399     1113    2             OC_QDEPTH = OC_QDEPTH + 1;

   1113  1 000027   000000 054200 xsym               AOS   ! OC_QDEPTH

      400     1114                                                /**/
      401     1115    2           END;                            /* DO INHBIT */

      402     1116    1        RETURN;

   1116  1 000030   000000 702200 xent               TSX2  ! X66_ARET
      403     1117                                                /**/
      404     1118    1   END OCE$MAKEDO;

PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:59   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCE$MAKEDO.
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:60   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @OCE_CONNUM                3-0-0/w PTR         r     1 @OCE_EVENT_ID
    *0-0-0/w UBIN        r     1 OCE_CONNUM                *0-0-0/w UBIN        r     1 OCE_EVENT_ID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w SBIN        r     1 OC_QDEPTH
     0-0-0/w UBIN        r     1 OC_QPOSN                   0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)


   Procedure OCE$MAKEDO requires 25 words for executable code.
   Procedure OCE$MAKEDO requires 6 words of local(AUTO) storage.

    No errors detected in file OCE$EVENT.:E05TSI    .
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:61   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:62   
          MINI XREF LISTING

OCE_CONNUM
      1094**DCL        19--PROC     1103>>ASSIGN
OCE_EVENT_ID
      1093**DCL        19--PROC     1104>>ASSIGN
OC_CONSOLE.ATTR
      1045**DCL      1045--REDEF
OC_CONSOLE.ATTRO
      1046**DCL      1046--REDEF
OC_CONSOLE.CID
      1044**DCL      1045--REDEF
OC_CONSOLE.STATION
      1043**DCL      1043--REDEF
OC_CONSOLE$
      1042**DCL      1043--IMP-PTR
OC_DIR
      1085**DCL      1085--REDEF
OC_INTBIT
      1085**DCL      1086--REDEF
OC_INTMSG
       962**DCL       975--REDEF
OC_INTMSG.FLAGS
       969**DCL       970--REDEF
OC_INTMSG.MESS
       975**DCL       975--REDEF
OC_INTMSG.MSGID
       965**DCL       966--REDEF
OC_INTMSG.WSN
       972**DCL       973--REDEF
OC_MASK
      1086**DCL      1086--REDEF
OC_MESSBUF
       977**DCL       992--REDEF    1006--REDEF
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:63   
OC_MESSBUF.FLAGS
       984**DCL       985--REDEF
OC_MESSBUF.MESS
       990**DCL       990--REDEF
OC_MESSBUF.MSGID
       980**DCL       981--REDEF
OC_MESSBUF.WSN
       987**DCL       988--REDEF
OC_MESSBUF1.FLAGS
       999**DCL      1000--REDEF
OC_MESSBUF1.LEN
      1005**DCL      1005--REDEF
OC_MESSBUF1.MSGID
       995**DCL       996--REDEF
OC_MESSBUF1.WSN
      1002**DCL      1003--REDEF
OC_MSGBUFFER
      1008**DCL      1023--REDEF
OC_MSGBUFFER.FLAGS
      1015**DCL      1016--REDEF
OC_MSGBUFFER.MESS
      1021**DCL      1021--REDEF
OC_MSGBUFFER.MSGID
      1011**DCL      1012--REDEF
OC_MSGBUFFER.WSN
      1018**DCL      1019--REDEF
OC_MSGBUFFER2.FLAGS
      1030**DCL      1031--REDEF
OC_MSGBUFFER2.MSGID
      1026**DCL      1027--REDEF
OC_MSGBUFFER2.WSN
      1033**DCL      1034--REDEF
OC_PARAM
      1041**DCL      1041--REDEF
OC_QDEPTH
      1036**DCL      1113<<ASSIGN   1113>>ASSIGN
PL6.E3A0      #003=OCE$MAKEDO File=OCE$EVENT.:E05TSI                             WED 07/30/97 03:57 Page:64   
OC_QPOSN
      1037**DCL      1103>>ASSIGN   1104>>ASSIGN   1105>>ASSIGN   1106>>ASSIGN   1108>>IF       1110<<ASSIGN
      1112<<ASSIGN   1112>>ASSIGN
OC_QUEUE.ERR
      1040**DCL      1105<<ASSIGN
OC_QUEUE.EVID
      1040**DCL      1104<<ASSIGN
OC_QUEUE.PARMC
      1040**DCL      1040--REDEF    1106<<ASSIGN
OC_QUEUE.SUBC
      1039**DCL      1103<<ASSIGN
