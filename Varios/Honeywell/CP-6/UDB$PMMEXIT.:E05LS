VERSION E05

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:1    
        1        1        /*M*     UDB$PMMEXIT    Return to user following PMME processing */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=5,ENU=0,ECU=0    */
        8        8        UDB$PMMEXIT: PROC;
        9        9        %PLIST;
       10       10
       11       11
       12       12        /*LOCAL AUTOMATIC */
       13       13
       14       14    1   DCL DFLG BIT(1);
       15       15
       16       16    1   DCL 1 ECP ALIGNED,
       17       17    1         2 ECCS UBIN(36) UNAL,
       18       18    1         2 EID UBIN(36) ALIGNED,           /* EVENT ID                           */
       19       19    1         2 JERR BIT(36),                   /* JIT.ERR                            */
       20       20    1         2 P# UBIN(36);                    /* # OF PARAMETERS                    */
       21       21
       22       22    1   DCL SSIC UBIN(36);                      /*IC FOR SAFE-STORE FRAME             */
       23       23    1   DCL ECC  UBIN(36);                      /*EXC. COND. CODE                     */
       24       24        /* When UDB_ALTLOG.LOG is set to '1'b, all altrets from PMMEs will
       25       25           be written to ELF via the SYSLOG mechanism.  File number 69 is
       26       26           used for this purpose.  The UDB_ALTLOG structure is organized
       27       27           to attempt to have most significant things in the most significant
       28       28           places.  Thus, for example, the resultant file could be copied
       29       29           to another file as an indexed file with the information as a 12
       30       30           byte key, thus eliminating duplicates and sorting by FCG, PMME code,
       31       31           ASN, ORG, ACS, FUN (the last 4 are only significant if they are
       32       32           significant), and finally error word (FCG, code).
       33       33
       34       34        Here's some JCL to help with that process.  (From JLJ, 5/18/89)
       35       35
       36       36        !"  -----
       37       37        !"  to begin error logging of ALTRETs into :ELF69.:SYS .....
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:2    
       38       38        !"  ----
       39       39        !"
       40       40        !"  !PRIV ALL
       41       41        !"  !PRIV JIT,EXMM
       42       42        !"  !DELTA
       43       43        !"  AN
       44       44        !"  SCH M:MON.:SYS
       45       45        !"  SCH UDB$PMMEXIT
       46       46        !"  L UDB_ALTLOG.LOG '1'B
       47       47        !"  Q
       48       48        !"
       49       49        !"  -----
       50       50        !"  then, after some time has passed....
       51       51        !"  -----
       52       52        !"  !PRIV ALL
       53       53        !"  !PRIV JIT,EXMM
       54       54        !"  !DELTA
       55       55        !"  AN
       56       56        !"  SCH M:MON.:SYS
       57       57        !"  SCH UDB$PMMEXIT
       58       58        !"  L UDB_ALTLOG.LOG '0'B
       59       59        !"  Q
       60       60        !"
       61       61        !C :ELF69.:SYS OVER *ELF (LN(.01,.01))
       62       62        !E *ELF
       63       63        SE;21A1
       64       64        END
       65       65        !C *ELF OVER *ELF (RECS=12)
       66       66        !SORT *ELF OVER *ELF2
       67       67        REC INL=12
       68       68        KEY S=3,L=10
       69       69        END
       70       70        !DEL *ELF
       71       71        !MOD *ELF2 TO *ELF
       72       72        !RUDD.X *ELF (COUNT)
       73       73        !FORTRAN ME OVER *G
       74       74              PROGRAM HACK
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:3    
       75       75              DATA MASK/12O000000371777/
       76       76              INTEGER ITEXT(3), IDAT(4), IERR (4)
       77       77         100  CONTINUE
       78       78              READ (10,1000,END=9999) COUNT, ITEXT
       79       79        1000  FORMAT (1X, I4, 3X, 3A4)
       80       80              ITEXT(1) = IAND (ITEXT(1) , MASK)
       81       81              IDAT(1) = IAND (ITEXT(2),12O777000000000)
       82       82              IDAT(1) = ISL (IDAT(1),-27)
       83       83              IDAT(2) = IAND (ITEXT(2),12O000777000000)
       84       84              IDAT(2) = ISL (IDAT(2), -18)
       85       85              IDAT(3) = IAND (ITEXT(2), 12O000000777000)
       86       86              IDAT(3) = ISL (IDAT(3), -9)
       87       87              IDAT(4) = IAND(ITEXT(2), 12O000000000777)
       88       88              IERR(4) = IAND(ISL(ITEXT(3),-3),5O37777)
       89       89              IERR(1) = IAND(ISL(ITEXT(3),-30),12O000000000077)
       90       90              IERR(2) = IAND(ISL(ITEXT(3),-24),12O000000000077)
       91       91              IERR(3) = IAND(ISL(ITEXT(3),-18),12O000000000077)
       92       92              IERR (1) = IERR(1)+64
       93       93              IERR (2) = IERR(2)+64
       94       94              IERR (3) = IERR(3)+64
       95       95              WRITE (108,1020) ITEXT(1), IDAT, IERR(1),IERR(2),IERR(3), IERR(4),
       96       96             -              COUNT
       97       97        1020  FORMAT (1X, O18, 4(1X,I3), 3X,3R1, '-',I6,2X,I6)
       98       98              GOTO 100
       99       99        9999  CONTINUE
      100      100              STOP
      101      101              END
      102      102        !LINK *G OVER *L (DCB1=10,DCB3=108)
      103      103        !*L *ELF OVER *LISTOUT
      104      104        !ELBBIRD.X *LISTOUT
      105      105        !E *LISTOUT
      106      106        SE;IF/000000000001/;1P/M$EXIT       /;TX
      107      107        SE;IF/000000000002/;1P/M$ERR        /;TX
      108      108        SE;IF/000000000003/;1P/M$XXX        /;TX
      109      109        SE;IF/000000000004/;1P/M$OLAY       /;TX
      110      110        SE;IF/000000000005/;1P/M$LINK       /;TX
      111      111        SE;IF/000000000006/;1P/M$LDTRC      /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:4    
      112      112        SE;IF/000000000007/;1P/M$ALIB       /;TX
      113      113        SE;IF/000000000010/;1P/M$DLIB       /;TX
      114      114        SE;IF/000000000011/;1P/M$YC         /;TX
      115      115        SE;IF/000000000012/;1P/M$CPEXIT     /;TX
      116      116        SE;IF/000000000013/;1P/M$SCREECH    /;TX
      117      117        SE;IF/000000000014/;1P/M$FSUSER     /;TX
      118      118        SE;IF/000000000015/;1P/M$ASUSER     /;TX
      119      119        SE;IF/000000000016/;1P/M$DSUSER     /;TX
      120      120        SE;IF/000000000017/;1P/M$SAVE       /;TX
      121      121        SE;IF/000000000020/;1P/M$SCON       /;TX
      122      122        SE;IF/000000000021/;1P/M$INTRTN     /;TX
      123      123        SE;IF/000000000022/;1P/M$XCONRTN    /;TX
      124      124        SE;IF/000000000023/;1P/M$PROCNAME   /;TX
      125      125        SE;IF/000000000024/;1P/M$FINDPROC   /;TX
      126      126        SE;IF/000000000025/;1P/M$UNSHARE    /;TX
      127      127        SE;IF/000000000026/;1P/M$ACCT       /;TX
      128      128        SE;IF/000000010000/;1P/M$STIMER     /;TX
      129      129        SE;IF/000000010001/;1P/M$EVENT      /;TX
      130      130        SE;IF/000000010002/;1P/M$INT        /;TX
      131      131        SE;IF/000000010003/;1P/M$XCON       /;TX
      132      132        SE;IF/000000010004/;1P/M$TRAP       /;TX
      133      133        SE;IF/000000010005/;1P/M$STRAP      /;TX
      134      134        SE;IF/000000010006/;1P/M$TTIMER     /;TX
      135      135        SE;IF/000000010007/;1P/M$MERC       /;TX
      136      136        SE;IF/000000010010/;1P/M$RETRY      /;TX
      137      137        SE;IF/000000010011/;1P/M$SENV       /;TX
      138      138        SE;IF/000000010012/;1P/M$TRTN       /;TX
      139      139        SE;IF/000000010013/;1P/M$CLRSTK     /;TX
      140      140        SE;IF/000000010014/;1P/M$MERCS      /;TX
      141      141        SE;IF/000000010015/;1P/M$RETRYS     /;TX
      142      142        SE;IF/000000010016/;1P/M$RENV       /;TX
      143      143        SE;IF/000000010017/;1P/M$DRTN       /;TX
      144      144        SE;IF/000000020000/;1P/M$ERRMSG     /;TX
      145      145        SE;IF/000000020001/;1P/M$FID        /;TX
      146      146        SE;IF/000000020002/;1P/M$ENQ        /;TX
      147      147        SE;IF/000000020003/;1P/M$DEQ        /;TX
      148      148        SE;IF/000000020004/;1P/M$TIME       /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:5    
      149      149        SE;IF/000000020005/;1P/M$NXTUSR     /;TX
      150      150        SE;IF/000000020006/;1P/M$WAIT       /;TX
      151      151        SE;IF/000000020007/;1P/M$DISPLAY    /;TX
      152      152        SE;IF/000000020010/;1P/M$STATE      /;TX
      153      153        SE;IF/000000020011/;1P/M$XEQTIME    /;TX
      154      154        SE;IF/000000020012/;1P/M$SPRIV      /;TX
      155      155        SE;IF/000000020013/;1P/M$RPRIV      /;TX
      156      156        SE;IF/000000020014/;1P/M$SSWITCH    /;TX
      157      157        SE;IF/000000020015/;1P/M$RSWITCH    /;TX
      158      158        SE;IF/000000020016/;1P/M$CHGUNIT    /;TX
      159      159        SE;IF/000000020017/;1P/M$USRFIELD   /;TX
      160      160        SE;IF/000000020020/;1P/M$RUE        /;TX
      161      161        SE;IF/000000020021/;1P/M$UNFID      /;TX
      162      162        SE;IF/000000020022/;1P/M$GJOB       /;TX
      163      163        SE;IF/000000020023/;1P/M$MONINFO    /;TX
      164      164        SE;IF/000000020024/;1P/M$HELP       /;TX
      165      165        SE;IF/000000020025/;1P/M$CMDVAR     /;TX
      166      166        SE;IF/000000020026/;1P/M$SYSID      /;TX
      167      167        SE;IF/000000030000/;1P/M$MAKUSER    /;TX
      168      168        SE;IF/000000030001/;1P/M$GDS        /;TX
      169      169        SE;IF/000000030002/;1P/M$FDS        /;TX
      170      170        SE;IF/000000030003/;1P/M$GDP        /;TX
      171      171        SE;IF/000000030004/;1P/M$FDP        /;TX
      172      172        SE;IF/000000030005/;1P/M$GVP        /;TX
      173      173        SE;IF/000000030006/;1P/M$FVP        /;TX
      174      174        SE;IF/000000030007/;1P/M$STLPP      /;TX
      175      175        SE;IF/000000030010/;1P/M$RSPP       /;TX
      176      176        SE;IF/000000030011/;1P/M$CVM        /;TX
      177      177        SE;IF/000000030012/;1P/M$SMPRT      /;TX
      178      178        SE;IF/000000030013/;1P/M$SSC        /;TX
      179      179        SE;IF/000000030014/;1P/M$GDDL       /;TX
      180      180        SE;IF/000000030015/;1P/M$SAD        /;TX
      181      181        SE;IF/000000030016/;1P/M$STD        /;TX
      182      182        SE;IF/000000030017/;1P/M$BADPP      /;TX
      183      183        SE;IF/000000030020/;1P/M$GOODPP     /;TX
      184      184        SE;IF/000000030021/;1P/M$GBPL       /;TX
      185      185        SE;IF/000000030022/;1P/M$MPL        /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:6    
      186      186        SE;IF/000000030023/;1P/M$UMPL       /;TX
      187      187        SE;IF/000000030024/;1P/M$PDS        /;TX
      188      188        SE;IF/000000030025/;1P/M$PAS        /;TX
      189      189        SE;IF/000000030026/;1P/M$VIRTUAL    /;TX
      190      190        SE;IF/000000040000/;1P/M$READ       /;TX
      191      191        SE;IF/000000040001/;1P/M$WRITE      /;TX
      192      192        SE;IF/000000040002/;1P/M$DELREC     /;TX
      193      193        SE;IF/000000040003/;1P/M$PRECORD    /;TX
      194      194        SE;IF/000000040004/;1P/M$PFIL       /;TX
      195      195        SE;IF/000000040005/;1P/M$EXTEND     /;TX
      196      196        SE;IF/000000040006/;1P/M$REW        /;TX
      197      197        SE;IF/000000040007/;1P/M$WEOF       /;TX
      198      198        SE;IF/000000050000/;1P/M$OPEN       /;TX
      199      199        SE;IF/000000050001/;1P/M$CLOSE      /;TX
      200      200        SE;IF/000000050002/;1P/M$CHECK      /;TX
      201      201        SE;IF/000000050003/;1P/M$TRUNC      /;TX
      202      202        SE;IF/000000050004/;1P/M$CVOL       /;TX
      203      203        SE;IF/000000050005/;1P/M$LINES      /;TX
      204      204        SE;IF/000000050006/;1P/M$DEVICE     /;TX
      205      205        SE;IF/000000060000/;1P/M$CORRES     /;TX
      206      206        SE;IF/000000060001/;1P/M$SETFMA     /;TX
      207      207        SE;IF/000000060002/;1P/M$GETDCB     /;TX
      208      208        SE;IF/000000060003/;1P/M$RELDCB     /;TX
      209      209        SE;IF/000000060004/;1P/M$LDEV       /;TX
      210      210        SE;IF/000000060005/;1P/M$MADMUCK    /;TX
      211      211        SE;IF/000000060006/;1P/M$REM        /;TX
      212      212        SE;IF/000000060007/;1P/M$XFLUSH     /;TX
      213      213        SE;IF/000000060010/;1P/M$RELSTARF   /;TX
      214      214        SE;IF/000000070000/;1P/M$RDSYSLOG   /;TX
      215      215        SE;IF/000000070001/;1P/M$WRSYSLOG   /;TX
      216      216        SE;IF/000000070002/;1P/M$TDOPEN     /;TX
      217      217        SE;IF/000000070003/;1P/M$TDCLOSE    /;TX
      218      218        SE;IF/000000070004/;1P/M$TDIO       /;TX
      219      219        SE;IF/000000070005/;1P/M$TDREQCPU   /;TX
      220      220        SE;IF/000000070006/;1P/M$IOQ        /;TX
      221      221        SE;IF/000000070007/;1P/M$SYSCON     /;TX
      222      222        SE;IF/000000100000/;1P/M$ACTIVATE   /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:7    
      223      223        SE;IF/000000100001/;1P/M$DEACTIVATE /;TX
      224      224        SE;IF/000000100002/;1P/M$UNLATCH    /;TX
      225      225        SE;IF/000000100003/;1P/M$CGCTL      /;TX
      226      226        SE;IF/000000100004/;1P/M$CGINFO     /;TX
      227      227        SE;IF/000000100005/;1P/M$FWCG       /;TX
      228      228        SE;IF/000000100006/;1P/M$ATTACH     /;TX
      229      229        SE;IF/000000100007/;1P/M$DETACH     /;TX
      230      230        SE;IF/000000110000/;1P/M$TEMPWROC   /;TX
      231      231        SE;IF/000000120000/;1P/M$KEYIN      /;TX
      232      232        SE;IF/000000120001/;1P/M$OCMSG      /;TX
      233      233        SE;IF/000000130000/;1P/M$PATHCON    /;TX
      234      234        SE;IF/000000130001/;1P/M$EXHUME     /;TX
      235      235        SE;IF/000000140003/;1P/M$SMOUSE     /;TX
      236      236        SE;IF/000000140004/;1P/M$XMOUSE     /;TX
      237      237        SE;IF/000000140005/;1P/M$GETMOUSE   /;TX
      238      238        SE;IF/000000140006/;1P/M$GETPM      /;TX
      239      239        SE;IF/000000150000/;1P/M$LIMIT      /;TX
      240      240        SE;IF/000000150001/;1P/M$MBS        /;TX
      241      241        SE;IF/000000150002/;1P/M$DISPRES    /;TX
      242      242        SE;IF/000000150003/;1P/M$RELRES     /;TX
      243      243        SE;IF/000000150004/;1P/M$REQUIRE    /;TX
      244      244        SE;IF/000000150005/;1P/M$RACST      /;TX
      245      245        SE;IF/000000160000/;1P/M$STRMCTL    /;TX
      246      246        SE;IF/000000160001/;1P/M$GTRMCTL    /;TX
      247      247        SE;IF/000000160002/;1P/M$PROMPT     /;TX
      248      248        SE;IF/000000160003/;1P/M$EOM        /;TX
      249      249        SE;IF/000000160004/;1P/M$TRMPRG     /;TX
      250      250        SE;IF/000000160005/;1P/M$GLINEATTR  /;TX
      251      251        SE;IF/000000160006/;1P/M$STRMATTR   /;TX
      252      252        SE;IF/000000160007/;1P/M$GTRMATTR   /;TX
      253      253        SE;IF/000000160010/;1P/M$PLATEN     /;TX
      254      254        SE;IF/000000160011/;1P/M$STRMTAB    /;TX
      255      255        SE;IF/000000160012/;1P/M$GTRMTAB    /;TX
      256      256        SE;IF/000000160013/;1P/M$SINPUT     /;TX
      257      257        SE;IF/000000160014/;1P/M$PROFILE    /;TX
      258      258        SE;IF/000000160015/;1P/M$FEBOOT     /;TX
      259      259        SE;IF/000000160016/;1P/M$FEDUMP     /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:8    
      260      260        SE;IF/000000160017/;1P/M$FECTL      /;TX
      261      261        SE;IF/000000160020/;1P/M$TRMISC     /;TX
      262      262        SE;IF/000000160021/;1P/M$SETFP      /;TX
      263      263        SE;IF/000000160022/;1P/M$DRIBBLE    /;TX
      264      264        SE;IF/000000160023/;1P/M$CONFIG     /;TX
      265      265        SE;IF/000000160024/;1P/M$DCLFLD     /;TX
      266      266        SE;IF/000000160025/;1P/M$ERASE      /;TX
      267      267        SE;IF/000000160026/;1P/M$MDFFLD     /;TX
      268      268        SE;IF/000000160027/;1P/M$RLSFLD     /;TX
      269      269        SE;IF/000000160030/;1P/M$SLCFLD     /;TX
      270      270        SE;IF/000000160031/;1P/M$NODEINFO   /;TX
      271      271        SE;IF/000000160032/;1P/M$GPROMPT    /;TX
      272      272        SE;IF/000000160033/;1P/M$GPLATEN    /;TX
      273      273        SE;IF/000000170000/;1P/M$SYMBIO     /;TX
      274      274        SE;IF/000000170001/;1P/M$JOBSTATS   /;TX
      275      275        END
      276      276        !C *LISTOUT OVER *ELF
      277      277        !E *ELF
      278      278        BP ON
      279      279        33A21
      280      280        C *ELF
      281      281        IP.25,.5
      282      282        PMME NAME            ASN ORG ACS FUN   JIT.ERR    OCCURRENCES
      283      283        -----------------    --- --- --- ---   -------    ------------
      284      284        END
      285      285        */
      286      286    1   DCL 1 UDB_ALTLOG STATIC SYMDEF,
      287      287    1         2 LOG BIT(1) INIT('0'B),
      288      288    1         2 * BIT(17) INIT('0'B),
      289      289    1         2 FPT,
      290      290    1           3 ALT BIT(1),
      291      291    1           3 FCG UBIN(5) UNAL,
      292      292    1           3 CODE UBIN(12) UNAL,
      293      293    1         2 FILE,
      294      294    1           3 ASN UBIN BYTE CALIGNED,
      295      295    1           3 ORG UBIN BYTE CALIGNED,
      296      296    1           3 ACS UBIN BYTE CALIGNED,
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:9    
      297      297    1           3 FUN UBIN BYTE CALIGNED,
      298      298    1         2 JITERR BIT(36);
      299      299
      300      300        /*EXTERNAL PROCEDURES */
      301      301
      302      302    1   DCL SC_UDB421 ENTRY CONV(2,0);
      303      303    1   DCL UDB$AUTO  ENTRY;                    /*TO RESCEDULE USER                   */
      304      304    1   DCL SST$SSFTCB ENTRY(6) ALTRET;         /* TO MOVE SS FRAME TO TCB            */
      305      305    1   DCL SSU$DELTAGO ENTRY(3);               /* TO ENTER DELTA                     */
      306      306    1   DCL PHP$END_PMME ENTRY;
      307      307    1   DCL JSE$ABORTM  ENTRY(8);
      308      308    1   DCL JSS$BACKSS ENTRY;
      309      309    1   DCL JSS$RELOADSS ENTRY;
      310      310    1   DCL UDN$MAGIC ENTRY;
      311      311    1   DCL UDN$JAMSS ENTRY;
      312      312    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      313      313    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
      314      314
      315      315        /* BASED DATA */
      316      316
      317      317        %INCLUDE B_MACROS_C;
      318      428        %INCLUDE F$DCB;
      319      477        %T01DESCR (NAME=B$$DESCR);
      320      485        %INCLUDE B$SS;
      321      664        %INCLUDE B$JIT_C;
      322      978        %B$JIT0;
      323     1067        %U$JIT1X;
      324     1070        %M$JIT2X;
      325     1073        %F$JIT3;
      326     1078        %S$JIT4X;
      327     1081        %J$JIT5;
      328     1169        %A$JIT6X;
      329     1172
      330     1173    1   DCL DCB# UBIN HALF BASED;
      331     1174
      332     1175        %INCLUDE UE_CP6;
      333     1866        %B$ECCB;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:10   
      334     1874        %INCLUDE B_ULSMAC_C;
      335     2983        %B_USRULS (FPTN=B$ULS,STCLASS=BASED);
      336     3182
      337     3183        /* EXTERNAL DATA       */
      338     3184
      339     3185        %INCLUDE B_MAGIC_C;
      340     3303        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
      341     3396    1   DCL B$JIT$ PTR SYMREF;
      342     3397    1   DCL B$PS0$ PTR SYMREF;
      343     3398    1   DCL PH_MOUSE_USERS SBIN WORD SYMREF;
      344     3399    1   DCL S_PNO UBIN(36) SYMREF;
      345     3400    1   DCL P_CALCOMP(0:3) SBIN SYMREF;
      346     3401
      347     3402
      348     3403        /* STRING SUBSTITUTIONS */
      349     3404
      350     3405        %INCLUDE B_STRINGS_C;
      351     3534        %INCLUDE UD_ERRORS_C;
      352     3576        %INCLUDE UD_EQU_E;
      353     3965        %SUB B$JIT = B$JIT$->B$JIT;
      354     3966        %SUB B$SS = B_MPT.SS$->B$SS;
      355     3967        %SUB B$ECCB = B_MPT.ECCB$->B$ECCB;
      356     3968        %SUB_EXC;
      357     4015
      358     4016
      359     4017        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:11   
      360     4018
      361     4019         /*F*  NAME:         UDB$PMMEXIT
      362     4020
      363     4021               PURPOSE:      To provide for normal or error return
      364     4022                             to the user following PMME processing.
      365     4023
      366     4024               DESCRIPTION:
      367     4025
      368     4026         UDB$PMMEXIT is entered with B$JIT.ERR.CODE set to
      369     4027         zero to indicate normal PMME processing completion;
      370     4028         set non-zero to indicate PMME error.
      371     4029
      372     4030         Normal completion requires only that the IC in
      373     4031         Safe-Store be bumped if ALTRET was specified on
      374     4032         the PMME call.
      375     4033
      376     4034         Processing for PMME error completion is dependent
      377     4035         on:
      378     4036         TU
      379     4037           1)  ALTRET specification
      380     4038           2)  M$TRAP control of bad PMMEs
      381     4039           3)  severity of the error
      382     4040           4)  association of DELTA
      383     4041         TF
      384     4042
      385     4043         When ALTRET has not been specified and the severity
      386     4044         of the error is zero, the error condition is ignored
      387     4045         and the user is re-entered at the instruction
      388     4046         following the PMME (no change to the Safe-Store IC
      389     4047         and no entry to DELTA and/or the PMME Trap Control
      390     4048         routine).
      391     4049
      392     4050         When ALTRET is not specified (user not executing under
      393     4051         DELTA or PMME is from a Special Shared Processor) but
      394     4052         PMME trap control has been established, the PMME Trap
      395     4053         Control routine is entered.  If neither ALTRET specified
      396     4054         on the PMME call or PMME Trap Control, the abort logic
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:12   
      397     4055         is entered.
      398     4056
      399     4057         When ALTRET is not specified, and the user is running
      400     4058         under DELTA, DELTA is entered with the ECC of the
      401     4059         Exceptional Condition Frame set to %ECC_PMME#.
      402     4060         */
      403     4061
      404     4062
      405     4063        /*  Set the M bit in VLP_ERRCODE just in case any monitor routine
      406     4064            forgot to do so.
      407     4065        */
      408     4066    1           B$JIT.ERR = B$JIT.ERR | '000000400000'O;
      409     4067
      410     4068
      411     4069
      412     4070
      413     4071
      414     4072        /*F*   NAME:   UDB$PMMEXIT1
      415     4073
      416     4074               PURPOSE:  To provide an entry to the PMME exit logic
      417     4075                         when the M bit in the ERRCODE is not to be set
      418     4076                         but the MOUSE data is to be updated.
      419     4077        */
      420     4078    1   UDB$PMMEXIT1: ENTRY;
      421     4079    1           CALL CALCOMP;
      422     4080
      423     4081
      424     4082        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:13   
      425     4083
      426     4084         /*F*  NAME:         UDB$PMMEXIT2
      427     4085
      428     4086               PURPOSE:      To provide an entry to the PMME
      429     4087                             exit logic when the MOUSE data
      430     4088                             has already been updated.
      431     4089
      432     4090         */
      433     4091
      434     4092    1   UDB$PMMEXIT2: ENTRY;
      435     4093    1           CALL UDN$JAMSS;
      436     4094    1           IF (B$JIT.JUNK & %JJ_BAKIC#) ~='0'O
      437     4095    2           THEN DO;
      438     4096    2                B$JIT.JUNK = (B$JIT.JUNK &~ %JJ_BAKIC#);
      439     4097    2                IF B$SS.ISR.WSR ~= %MONWSR
      440     4098    3                THEN DO;
      441     4099    3                     B$SS.IC = B$SS.IC-2;
      442     4100    3                     GOTO UDB_EXIT;
      443     4101    3                     END;
      444     4102    2                END;                       /* DO IF NOT %MONWSR                  */
      445     4103
      446     4104    1           IF B$JIT.ERR.CODE = 0
      447     4105    1           THEN IF B$SS.FPT.ALT ~= '0'O
      448     4106    2                THEN DO;
      449     4107    2                     B$SS.IC = B$SS.IC+1;
      450     4108    2                     END;
      451     4109    1                ELSE ;                     /* NO ALTRET AND GOOD PMME--GOTO EXIT */
      452     4110
      453     4111    2           ELSE DO;                        /*WHEN B$JIT.ERR NOT ZERO             */
      454     4112    2                IF UDB_ALTLOG.LOG AND B$SS.FPT.FCG ~= %FCG_TD#
      455     4113    3                THEN DO;
      456     4114    3                     UDB_ALTLOG.FPT = B$SS.FPT;
      457     4115    3                     UDB_ALTLOG.JITERR = B$JIT.ERR;
      458     4116    3                     IF (UDB_ALTLOG.FPT.FCG = %FCG_FM1#
      459     4117    3                       OR UDB_ALTLOG.FPT.FCG = %FCG_FM2#)
      460     4118    3                       AND B$JIT.DCB$ ~= ADDR(NIL)
      461     4119    4                     THEN DO;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:14   
      462     4120    4                          UDB_ALTLOG.FILE.ASN = B$JIT.DCB$ -> F$DCB.ASN;
      463     4121    4                          UDB_ALTLOG.FILE.ORG = B$JIT.DCB$ -> F$DCB.ORG;
      464     4122    4                          UDB_ALTLOG.FILE.ACS = B$JIT.DCB$ -> F$DCB.ACS;
      465     4123    4                          UDB_ALTLOG.FILE.FUN = B$JIT.DCB$ -> F$DCB.FUN;
      466     4124    4                          END;
      467     4125    3                     ELSE
      468     4126    3                          UDB_ALTLOG.FILE = '0'B;
      469     4127    3                     CALL ELA$SYSLOG (0,UDB_ALTLOG,SIZEW(UDB_ALTLOG),0,69,DFLG);
      470     4128    3                     END;
      471     4129                                      /* First make sure DCB# is the JIT is right     */
      472     4130    2                IF ( (B$SS.FPT.FCG=%FCG_FM1#) OR (B$SS.FPT.FCG=%FCG_FM2#) )
      473     4131    2                  AND B$JIT.ERR.CODE ~= %E$BADVECT0
      474     4132    3                THEN DO;
      475     4133    3                     CALL HFF$NILERASE(0) ALTRET(NO_PS0);
      476     4134    3                     ECP.EID = B$PS0$->DCB#;
      477     4135    3                     B$JIT.DCBNO = B$PS0$->DCB#;
      478     4136    3                     END;
      479     4137    3                ELSE DO;
      480     4138    3   NO_PS0:           ;
      481     4139    3                     ECP.EID=0;
      482     4140    3                     END;
      483     4141
      484     4142    2                CALL UDN$MAGIC;
      485     4143
      486     4144    2                DFLG='0'B;
      487     4145    2                IF B$SS.FPT.ALT = '0'B
      488     4146    3                THEN DO;                   /*B$JIT.ERR NOT 0 ALTBIT=0            */
      489     4147    3                     IF B$JIT.ERR.SEV = 0 THEN GOTO UDB_EXIT;
      490     4148    3                     IF B$SS.ISR.WSR <= 1 THEN CALL SC_UDB421;
      491     4149        /*S*   SCREECH_CODE:   UDB-S$MPMMERR
      492     4150               TYPE:   SUA
      493     4151               MESSAGE:  Monitor PMME error and no ALTRET
      494     4152        */
      495     4153    3                     B$SS.IC = B$SS.IC-2;
      496     4154    3                     IF B_MPT.ECCBDESC$->B$$DESCR.FLGS & %DSXXX
      497     4155    4                     THEN DO;              /* GET SET FOR DELTA                  */
      498     4156    4                          DFLG = '1'B;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:15   
      499     4157    4                          SSIC = B$SS.IC;
      500     4158    4                          GOTO SETECC;
      501     4159    4                          END;             /* GET SET FOR DELTA                  */
      502     4160    4                     ELSE DO;              /* GO TO PMME TRAP CONTROL OR ABORTM  */
      503     4161    4                          IF B$ECCB.FLAGS.PMMESET = '0'B THEN CALL JSE$ABORTM;
      504     4162    4                          SSIC = B$ECCB.PMME;
      505     4163    4   SETECC:                ECC = %ECC_PMME#;
      506     4164    4                          END;             /* GOTO PMME TRAP CONTROL             */
      507     4165    3                     GOTO SETSSF$;
      508     4166    3                     END;                  /*B$JIT.ERR NOT 0  ALTBIT =0          */
      509     4167    3                ELSE DO;                   /*B$JIT.ERR NOT0 ALTBIT SET           */
      510     4168    3                     IF B$SS.ISR.WSR = %MONWSR THEN GOTO UDB_EXIT;
      511     4169    3                     ECC = %ECC_ALT#;
      512     4170    3                     SSIC= B$SS.IC;
      513     4171    3                     B$SS.IC = B$SS.IC-2;
      514     4172    3                     END;
      515     4173    2   SETSSF$:     ;
      516     4174    2                ECP.ECCS = BITBIN(B$SS.FPT & '371777'O);
              4174                         /*DONT MOVE ALTRET-FPTCHK FLG */
      517     4175    2                ECP.JERR = B$JIT.ERR;
      518     4176    2                ECP.P# = 0;
      519     4177
      520     4178    2                IF DFLG THEN CALL SSU$DELTAGO(ECC,ECP);
      521     4179    2                IF B_MPT.TCBDESC$->B$$DESCR.BOUND=0 THEN GOTO FULLTCB;
      522     4180    2                CALL SST$SSFTCB(SSIC,ECC,ECP,B_MPT.SS$,B_MPT.TCB$) ALTRET(FULLTCB);
      523     4181
      524     4182    2                END;                       /*DO WHEN B$JIT.ERR NOT ZERO          */
      525     4183
      526     4184
      527     4185    1   UDB_EXIT: CALL UDB$AUTO;
      528     4186    1   FULLTCB: ;
      529     4187    1           IF ECC=%ECC_PMME# THEN CALL JSE$ABORTM;
      530     4188    1           B$SS.IC=SSIC;
      531     4189    1           CALL UDB$AUTO;
      532     4190        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:16   
      533     4191         /*F*  NAME:          UDB$CALCOMP
      534     4192
      535     4193               PURPOSE:       To provide for updating of the MOUSE
      536     4194                              data for those PMMEs that do not return
      537     4195                              to the user via UDB$PMMEXIT following
      538     4196                              PMME processing.
      539     4197         */
      540     4198
      541     4199    1   UDB$CALCOMP: ENTRY;
      542     4200    1           CALL CALCOMP;
      543     4201    1           RETURN;
      544     4202
      545     4203        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:17   
      546     4204
      547     4205         /*I*  NAME:          CALCOMP
      548     4206
      549     4207               PURPOSE:       To provide for updating of the MOUSE data.
      550     4208
      551     4209         */
      552     4210
      553     4211    1   CALCOMP: PROC;
      554     4212    2           B$SS.FPTCHK=0;
      555     4213    2           B$SS.FPT=(B$SS.FPT | '004000'O);
      556     4214
      557     4215    2           P_CALCOMP(S_PNO) = P_CALCOMP(S_PNO)+1;
      558     4216    2           IF PH_MOUSE_USERS ~=0 THEN CALL PHP$END_PMME;
      559     4217
      560     4218    2           RETURN;
      561     4219    2   END CALCOMP;
      562     4220
      563     4221
      564     4222    1   END UDB$PMMEXIT;

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:18   
--  Include file information  --

   UD_EQU_E.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure UDB$PMMEXIT.

   Procedure UDB$PMMEXIT requires 247 words for executable code.
   Procedure UDB$PMMEXIT requires 18 words of local(AUTO) storage.

    No errors detected in file UDB$PMMEXIT.:E05TSI    .

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:19   

 Object Unit name= UDB$PMMEXIT                                File name= UDB$PMMEXIT.:E05TOU
 UTS= JUL 30 '97 06:55:40.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     3      3  UDB$PMMEXIT
    1  RoData even  UTS      1      1  UDB$PMMEXIT
    2   Proc  even  none   247    367  UDB$PMMEXIT
    3  RoData even  none     8     10  UDB$PMMEXIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  UDB$PMMEXIT
     2      7                  yes      Std        0  UDB$PMMEXIT1
     2     14                  yes      Std        0  UDB$PMMEXIT2
     2    343                  yes      Std        0  UDB$CALCOMP

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  UDB_ALTLOG
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:20   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 UDN$JAMSS
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       3 SSU$DELTAGO
 yes     yes           Std       6 ELA$SYSLOG
         yes           Std       8 JSE$ABORTM
         yes           Std       0 UDB$AUTO
         yes           Std       0 UDN$MAGIC
 yes     yes           Std       6 SST$SSFTCB
         yes           Std       0 PHP$END_PMME
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_UDB421                             B_MPT                                 B$JIT$
     B$PS0$                                PH_MOUSE_USERS                        S_PNO
     P_CALCOMP                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:21   


        1        1        /*M*     UDB$PMMEXIT    Return to user following PMME processing */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=5,ENU=0,ECU=0    */
        8        8        UDB$PMMEXIT: PROC;

      8  2 000000   000000 700200 xent  UDB$PMMEXIT  TSX0  ! X66_AUTO_0
         2 000001   000022 000000                    ZERO    18,0

        9        9        %PLIST;
       10       10
       11       11
       12       12        /*LOCAL AUTOMATIC */
       13       13
       14       14    1   DCL DFLG BIT(1);
       15       15
       16       16    1   DCL 1 ECP ALIGNED,
       17       17    1         2 ECCS UBIN(36) UNAL,
       18       18    1         2 EID UBIN(36) ALIGNED,           /* EVENT ID                           */
       19       19    1         2 JERR BIT(36),                   /* JIT.ERR                            */
       20       20    1         2 P# UBIN(36);                    /* # OF PARAMETERS                    */
       21       21
       22       22    1   DCL SSIC UBIN(36);                      /*IC FOR SAFE-STORE FRAME             */
       23       23    1   DCL ECC  UBIN(36);                      /*EXC. COND. CODE                     */
       24       24        /* When UDB_ALTLOG.LOG is set to '1'b, all altrets from PMMEs will
       25       25           be written to ELF via the SYSLOG mechanism.  File number 69 is
       26       26           used for this purpose.  The UDB_ALTLOG structure is organized
       27       27           to attempt to have most significant things in the most significant
       28       28           places.  Thus, for example, the resultant file could be copied
       29       29           to another file as an indexed file with the information as a 12
       30       30           byte key, thus eliminating duplicates and sorting by FCG, PMME code,
       31       31           ASN, ORG, ACS, FUN (the last 4 are only significant if they are
       32       32           significant), and finally error word (FCG, code).
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:22   
       33       33
       34       34        Here's some JCL to help with that process.  (From JLJ, 5/18/89)
       35       35
       36       36        !"  -----
       37       37        !"  to begin error logging of ALTRETs into :ELF69.:SYS .....
       38       38        !"  ----
       39       39        !"
       40       40        !"  !PRIV ALL
       41       41        !"  !PRIV JIT,EXMM
       42       42        !"  !DELTA
       43       43        !"  AN
       44       44        !"  SCH M:MON.:SYS
       45       45        !"  SCH UDB$PMMEXIT
       46       46        !"  L UDB_ALTLOG.LOG '1'B
       47       47        !"  Q
       48       48        !"
       49       49        !"  -----
       50       50        !"  then, after some time has passed....
       51       51        !"  -----
       52       52        !"  !PRIV ALL
       53       53        !"  !PRIV JIT,EXMM
       54       54        !"  !DELTA
       55       55        !"  AN
       56       56        !"  SCH M:MON.:SYS
       57       57        !"  SCH UDB$PMMEXIT
       58       58        !"  L UDB_ALTLOG.LOG '0'B
       59       59        !"  Q
       60       60        !"
       61       61        !C :ELF69.:SYS OVER *ELF (LN(.01,.01))
       62       62        !E *ELF
       63       63        SE;21A1
       64       64        END
       65       65        !C *ELF OVER *ELF (RECS=12)
       66       66        !SORT *ELF OVER *ELF2
       67       67        REC INL=12
       68       68        KEY S=3,L=10
       69       69        END
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:23   
       70       70        !DEL *ELF
       71       71        !MOD *ELF2 TO *ELF
       72       72        !RUDD.X *ELF (COUNT)
       73       73        !FORTRAN ME OVER *G
       74       74              PROGRAM HACK
       75       75              DATA MASK/12O000000371777/
       76       76              INTEGER ITEXT(3), IDAT(4), IERR (4)
       77       77         100  CONTINUE
       78       78              READ (10,1000,END=9999) COUNT, ITEXT
       79       79        1000  FORMAT (1X, I4, 3X, 3A4)
       80       80              ITEXT(1) = IAND (ITEXT(1) , MASK)
       81       81              IDAT(1) = IAND (ITEXT(2),12O777000000000)
       82       82              IDAT(1) = ISL (IDAT(1),-27)
       83       83              IDAT(2) = IAND (ITEXT(2),12O000777000000)
       84       84              IDAT(2) = ISL (IDAT(2), -18)
       85       85              IDAT(3) = IAND (ITEXT(2), 12O000000777000)
       86       86              IDAT(3) = ISL (IDAT(3), -9)
       87       87              IDAT(4) = IAND(ITEXT(2), 12O000000000777)
       88       88              IERR(4) = IAND(ISL(ITEXT(3),-3),5O37777)
       89       89              IERR(1) = IAND(ISL(ITEXT(3),-30),12O000000000077)
       90       90              IERR(2) = IAND(ISL(ITEXT(3),-24),12O000000000077)
       91       91              IERR(3) = IAND(ISL(ITEXT(3),-18),12O000000000077)
       92       92              IERR (1) = IERR(1)+64
       93       93              IERR (2) = IERR(2)+64
       94       94              IERR (3) = IERR(3)+64
       95       95              WRITE (108,1020) ITEXT(1), IDAT, IERR(1),IERR(2),IERR(3), IERR(4),
       96       96             -              COUNT
       97       97        1020  FORMAT (1X, O18, 4(1X,I3), 3X,3R1, '-',I6,2X,I6)
       98       98              GOTO 100
       99       99        9999  CONTINUE
      100      100              STOP
      101      101              END
      102      102        !LINK *G OVER *L (DCB1=10,DCB3=108)
      103      103        !*L *ELF OVER *LISTOUT
      104      104        !ELBBIRD.X *LISTOUT
      105      105        !E *LISTOUT
      106      106        SE;IF/000000000001/;1P/M$EXIT       /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:24   
      107      107        SE;IF/000000000002/;1P/M$ERR        /;TX
      108      108        SE;IF/000000000003/;1P/M$XXX        /;TX
      109      109        SE;IF/000000000004/;1P/M$OLAY       /;TX
      110      110        SE;IF/000000000005/;1P/M$LINK       /;TX
      111      111        SE;IF/000000000006/;1P/M$LDTRC      /;TX
      112      112        SE;IF/000000000007/;1P/M$ALIB       /;TX
      113      113        SE;IF/000000000010/;1P/M$DLIB       /;TX
      114      114        SE;IF/000000000011/;1P/M$YC         /;TX
      115      115        SE;IF/000000000012/;1P/M$CPEXIT     /;TX
      116      116        SE;IF/000000000013/;1P/M$SCREECH    /;TX
      117      117        SE;IF/000000000014/;1P/M$FSUSER     /;TX
      118      118        SE;IF/000000000015/;1P/M$ASUSER     /;TX
      119      119        SE;IF/000000000016/;1P/M$DSUSER     /;TX
      120      120        SE;IF/000000000017/;1P/M$SAVE       /;TX
      121      121        SE;IF/000000000020/;1P/M$SCON       /;TX
      122      122        SE;IF/000000000021/;1P/M$INTRTN     /;TX
      123      123        SE;IF/000000000022/;1P/M$XCONRTN    /;TX
      124      124        SE;IF/000000000023/;1P/M$PROCNAME   /;TX
      125      125        SE;IF/000000000024/;1P/M$FINDPROC   /;TX
      126      126        SE;IF/000000000025/;1P/M$UNSHARE    /;TX
      127      127        SE;IF/000000000026/;1P/M$ACCT       /;TX
      128      128        SE;IF/000000010000/;1P/M$STIMER     /;TX
      129      129        SE;IF/000000010001/;1P/M$EVENT      /;TX
      130      130        SE;IF/000000010002/;1P/M$INT        /;TX
      131      131        SE;IF/000000010003/;1P/M$XCON       /;TX
      132      132        SE;IF/000000010004/;1P/M$TRAP       /;TX
      133      133        SE;IF/000000010005/;1P/M$STRAP      /;TX
      134      134        SE;IF/000000010006/;1P/M$TTIMER     /;TX
      135      135        SE;IF/000000010007/;1P/M$MERC       /;TX
      136      136        SE;IF/000000010010/;1P/M$RETRY      /;TX
      137      137        SE;IF/000000010011/;1P/M$SENV       /;TX
      138      138        SE;IF/000000010012/;1P/M$TRTN       /;TX
      139      139        SE;IF/000000010013/;1P/M$CLRSTK     /;TX
      140      140        SE;IF/000000010014/;1P/M$MERCS      /;TX
      141      141        SE;IF/000000010015/;1P/M$RETRYS     /;TX
      142      142        SE;IF/000000010016/;1P/M$RENV       /;TX
      143      143        SE;IF/000000010017/;1P/M$DRTN       /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:25   
      144      144        SE;IF/000000020000/;1P/M$ERRMSG     /;TX
      145      145        SE;IF/000000020001/;1P/M$FID        /;TX
      146      146        SE;IF/000000020002/;1P/M$ENQ        /;TX
      147      147        SE;IF/000000020003/;1P/M$DEQ        /;TX
      148      148        SE;IF/000000020004/;1P/M$TIME       /;TX
      149      149        SE;IF/000000020005/;1P/M$NXTUSR     /;TX
      150      150        SE;IF/000000020006/;1P/M$WAIT       /;TX
      151      151        SE;IF/000000020007/;1P/M$DISPLAY    /;TX
      152      152        SE;IF/000000020010/;1P/M$STATE      /;TX
      153      153        SE;IF/000000020011/;1P/M$XEQTIME    /;TX
      154      154        SE;IF/000000020012/;1P/M$SPRIV      /;TX
      155      155        SE;IF/000000020013/;1P/M$RPRIV      /;TX
      156      156        SE;IF/000000020014/;1P/M$SSWITCH    /;TX
      157      157        SE;IF/000000020015/;1P/M$RSWITCH    /;TX
      158      158        SE;IF/000000020016/;1P/M$CHGUNIT    /;TX
      159      159        SE;IF/000000020017/;1P/M$USRFIELD   /;TX
      160      160        SE;IF/000000020020/;1P/M$RUE        /;TX
      161      161        SE;IF/000000020021/;1P/M$UNFID      /;TX
      162      162        SE;IF/000000020022/;1P/M$GJOB       /;TX
      163      163        SE;IF/000000020023/;1P/M$MONINFO    /;TX
      164      164        SE;IF/000000020024/;1P/M$HELP       /;TX
      165      165        SE;IF/000000020025/;1P/M$CMDVAR     /;TX
      166      166        SE;IF/000000020026/;1P/M$SYSID      /;TX
      167      167        SE;IF/000000030000/;1P/M$MAKUSER    /;TX
      168      168        SE;IF/000000030001/;1P/M$GDS        /;TX
      169      169        SE;IF/000000030002/;1P/M$FDS        /;TX
      170      170        SE;IF/000000030003/;1P/M$GDP        /;TX
      171      171        SE;IF/000000030004/;1P/M$FDP        /;TX
      172      172        SE;IF/000000030005/;1P/M$GVP        /;TX
      173      173        SE;IF/000000030006/;1P/M$FVP        /;TX
      174      174        SE;IF/000000030007/;1P/M$STLPP      /;TX
      175      175        SE;IF/000000030010/;1P/M$RSPP       /;TX
      176      176        SE;IF/000000030011/;1P/M$CVM        /;TX
      177      177        SE;IF/000000030012/;1P/M$SMPRT      /;TX
      178      178        SE;IF/000000030013/;1P/M$SSC        /;TX
      179      179        SE;IF/000000030014/;1P/M$GDDL       /;TX
      180      180        SE;IF/000000030015/;1P/M$SAD        /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:26   
      181      181        SE;IF/000000030016/;1P/M$STD        /;TX
      182      182        SE;IF/000000030017/;1P/M$BADPP      /;TX
      183      183        SE;IF/000000030020/;1P/M$GOODPP     /;TX
      184      184        SE;IF/000000030021/;1P/M$GBPL       /;TX
      185      185        SE;IF/000000030022/;1P/M$MPL        /;TX
      186      186        SE;IF/000000030023/;1P/M$UMPL       /;TX
      187      187        SE;IF/000000030024/;1P/M$PDS        /;TX
      188      188        SE;IF/000000030025/;1P/M$PAS        /;TX
      189      189        SE;IF/000000030026/;1P/M$VIRTUAL    /;TX
      190      190        SE;IF/000000040000/;1P/M$READ       /;TX
      191      191        SE;IF/000000040001/;1P/M$WRITE      /;TX
      192      192        SE;IF/000000040002/;1P/M$DELREC     /;TX
      193      193        SE;IF/000000040003/;1P/M$PRECORD    /;TX
      194      194        SE;IF/000000040004/;1P/M$PFIL       /;TX
      195      195        SE;IF/000000040005/;1P/M$EXTEND     /;TX
      196      196        SE;IF/000000040006/;1P/M$REW        /;TX
      197      197        SE;IF/000000040007/;1P/M$WEOF       /;TX
      198      198        SE;IF/000000050000/;1P/M$OPEN       /;TX
      199      199        SE;IF/000000050001/;1P/M$CLOSE      /;TX
      200      200        SE;IF/000000050002/;1P/M$CHECK      /;TX
      201      201        SE;IF/000000050003/;1P/M$TRUNC      /;TX
      202      202        SE;IF/000000050004/;1P/M$CVOL       /;TX
      203      203        SE;IF/000000050005/;1P/M$LINES      /;TX
      204      204        SE;IF/000000050006/;1P/M$DEVICE     /;TX
      205      205        SE;IF/000000060000/;1P/M$CORRES     /;TX
      206      206        SE;IF/000000060001/;1P/M$SETFMA     /;TX
      207      207        SE;IF/000000060002/;1P/M$GETDCB     /;TX
      208      208        SE;IF/000000060003/;1P/M$RELDCB     /;TX
      209      209        SE;IF/000000060004/;1P/M$LDEV       /;TX
      210      210        SE;IF/000000060005/;1P/M$MADMUCK    /;TX
      211      211        SE;IF/000000060006/;1P/M$REM        /;TX
      212      212        SE;IF/000000060007/;1P/M$XFLUSH     /;TX
      213      213        SE;IF/000000060010/;1P/M$RELSTARF   /;TX
      214      214        SE;IF/000000070000/;1P/M$RDSYSLOG   /;TX
      215      215        SE;IF/000000070001/;1P/M$WRSYSLOG   /;TX
      216      216        SE;IF/000000070002/;1P/M$TDOPEN     /;TX
      217      217        SE;IF/000000070003/;1P/M$TDCLOSE    /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:27   
      218      218        SE;IF/000000070004/;1P/M$TDIO       /;TX
      219      219        SE;IF/000000070005/;1P/M$TDREQCPU   /;TX
      220      220        SE;IF/000000070006/;1P/M$IOQ        /;TX
      221      221        SE;IF/000000070007/;1P/M$SYSCON     /;TX
      222      222        SE;IF/000000100000/;1P/M$ACTIVATE   /;TX
      223      223        SE;IF/000000100001/;1P/M$DEACTIVATE /;TX
      224      224        SE;IF/000000100002/;1P/M$UNLATCH    /;TX
      225      225        SE;IF/000000100003/;1P/M$CGCTL      /;TX
      226      226        SE;IF/000000100004/;1P/M$CGINFO     /;TX
      227      227        SE;IF/000000100005/;1P/M$FWCG       /;TX
      228      228        SE;IF/000000100006/;1P/M$ATTACH     /;TX
      229      229        SE;IF/000000100007/;1P/M$DETACH     /;TX
      230      230        SE;IF/000000110000/;1P/M$TEMPWROC   /;TX
      231      231        SE;IF/000000120000/;1P/M$KEYIN      /;TX
      232      232        SE;IF/000000120001/;1P/M$OCMSG      /;TX
      233      233        SE;IF/000000130000/;1P/M$PATHCON    /;TX
      234      234        SE;IF/000000130001/;1P/M$EXHUME     /;TX
      235      235        SE;IF/000000140003/;1P/M$SMOUSE     /;TX
      236      236        SE;IF/000000140004/;1P/M$XMOUSE     /;TX
      237      237        SE;IF/000000140005/;1P/M$GETMOUSE   /;TX
      238      238        SE;IF/000000140006/;1P/M$GETPM      /;TX
      239      239        SE;IF/000000150000/;1P/M$LIMIT      /;TX
      240      240        SE;IF/000000150001/;1P/M$MBS        /;TX
      241      241        SE;IF/000000150002/;1P/M$DISPRES    /;TX
      242      242        SE;IF/000000150003/;1P/M$RELRES     /;TX
      243      243        SE;IF/000000150004/;1P/M$REQUIRE    /;TX
      244      244        SE;IF/000000150005/;1P/M$RACST      /;TX
      245      245        SE;IF/000000160000/;1P/M$STRMCTL    /;TX
      246      246        SE;IF/000000160001/;1P/M$GTRMCTL    /;TX
      247      247        SE;IF/000000160002/;1P/M$PROMPT     /;TX
      248      248        SE;IF/000000160003/;1P/M$EOM        /;TX
      249      249        SE;IF/000000160004/;1P/M$TRMPRG     /;TX
      250      250        SE;IF/000000160005/;1P/M$GLINEATTR  /;TX
      251      251        SE;IF/000000160006/;1P/M$STRMATTR   /;TX
      252      252        SE;IF/000000160007/;1P/M$GTRMATTR   /;TX
      253      253        SE;IF/000000160010/;1P/M$PLATEN     /;TX
      254      254        SE;IF/000000160011/;1P/M$STRMTAB    /;TX
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:28   
      255      255        SE;IF/000000160012/;1P/M$GTRMTAB    /;TX
      256      256        SE;IF/000000160013/;1P/M$SINPUT     /;TX
      257      257        SE;IF/000000160014/;1P/M$PROFILE    /;TX
      258      258        SE;IF/000000160015/;1P/M$FEBOOT     /;TX
      259      259        SE;IF/000000160016/;1P/M$FEDUMP     /;TX
      260      260        SE;IF/000000160017/;1P/M$FECTL      /;TX
      261      261        SE;IF/000000160020/;1P/M$TRMISC     /;TX
      262      262        SE;IF/000000160021/;1P/M$SETFP      /;TX
      263      263        SE;IF/000000160022/;1P/M$DRIBBLE    /;TX
      264      264        SE;IF/000000160023/;1P/M$CONFIG     /;TX
      265      265        SE;IF/000000160024/;1P/M$DCLFLD     /;TX
      266      266        SE;IF/000000160025/;1P/M$ERASE      /;TX
      267      267        SE;IF/000000160026/;1P/M$MDFFLD     /;TX
      268      268        SE;IF/000000160027/;1P/M$RLSFLD     /;TX
      269      269        SE;IF/000000160030/;1P/M$SLCFLD     /;TX
      270      270        SE;IF/000000160031/;1P/M$NODEINFO   /;TX
      271      271        SE;IF/000000160032/;1P/M$GPROMPT    /;TX
      272      272        SE;IF/000000160033/;1P/M$GPLATEN    /;TX
      273      273        SE;IF/000000170000/;1P/M$SYMBIO     /;TX
      274      274        SE;IF/000000170001/;1P/M$JOBSTATS   /;TX
      275      275        END
      276      276        !C *LISTOUT OVER *ELF
      277      277        !E *ELF
      278      278        BP ON
      279      279        33A21
      280      280        C *ELF
      281      281        IP.25,.5
      282      282        PMME NAME            ASN ORG ACS FUN   JIT.ERR    OCCURRENCES
      283      283        -----------------    --- --- --- ---   -------    ------------
      284      284        END
      285      285        */
      286      286    1   DCL 1 UDB_ALTLOG STATIC SYMDEF,
      287      287    1         2 LOG BIT(1) INIT('0'B),
      288      288    1         2 * BIT(17) INIT('0'B),
      289      289    1         2 FPT,
      290      290    1           3 ALT BIT(1),
      291      291    1           3 FCG UBIN(5) UNAL,
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:29   
      292      292    1           3 CODE UBIN(12) UNAL,
      293      293    1         2 FILE,
      294      294    1           3 ASN UBIN BYTE CALIGNED,
      295      295    1           3 ORG UBIN BYTE CALIGNED,
      296      296    1           3 ACS UBIN BYTE CALIGNED,
      297      297    1           3 FUN UBIN BYTE CALIGNED,
      298      298    1         2 JITERR BIT(36);
      299      299
      300      300        /*EXTERNAL PROCEDURES */
      301      301
      302      302    1   DCL SC_UDB421 ENTRY CONV(2,0);
      303      303    1   DCL UDB$AUTO  ENTRY;                    /*TO RESCEDULE USER                   */
      304      304    1   DCL SST$SSFTCB ENTRY(6) ALTRET;         /* TO MOVE SS FRAME TO TCB            */
      305      305    1   DCL SSU$DELTAGO ENTRY(3);               /* TO ENTER DELTA                     */
      306      306    1   DCL PHP$END_PMME ENTRY;
      307      307    1   DCL JSE$ABORTM  ENTRY(8);
      308      308    1   DCL JSS$BACKSS ENTRY;
      309      309    1   DCL JSS$RELOADSS ENTRY;
      310      310    1   DCL UDN$MAGIC ENTRY;
      311      311    1   DCL UDN$JAMSS ENTRY;
      312      312    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      313      313    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
      314      314
      315      315        /* BASED DATA */
      316      316
      317      317        %INCLUDE B_MACROS_C;
      318      428        %INCLUDE F$DCB;
      319      477        %T01DESCR (NAME=B$$DESCR);
      320      485        %INCLUDE B$SS;
      321      664        %INCLUDE B$JIT_C;
      322      978        %B$JIT0;
      323     1067        %U$JIT1X;
      324     1070        %M$JIT2X;
      325     1073        %F$JIT3;
      326     1078        %S$JIT4X;
      327     1081        %J$JIT5;
      328     1169        %A$JIT6X;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:30   
      329     1172
      330     1173    1   DCL DCB# UBIN HALF BASED;
      331     1174
      332     1175        %INCLUDE UE_CP6;
      333     1866        %B$ECCB;
      334     1874        %INCLUDE B_ULSMAC_C;
      335     2983        %B_USRULS (FPTN=B$ULS,STCLASS=BASED);
      336     3182
      337     3183        /* EXTERNAL DATA       */
      338     3184
      339     3185        %INCLUDE B_MAGIC_C;
      340     3303        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
      341     3396    1   DCL B$JIT$ PTR SYMREF;
      342     3397    1   DCL B$PS0$ PTR SYMREF;
      343     3398    1   DCL PH_MOUSE_USERS SBIN WORD SYMREF;
      344     3399    1   DCL S_PNO UBIN(36) SYMREF;
      345     3400    1   DCL P_CALCOMP(0:3) SBIN SYMREF;
      346     3401
      347     3402
      348     3403        /* STRING SUBSTITUTIONS */
      349     3404
      350     3405        %INCLUDE B_STRINGS_C;
      351     3534        %INCLUDE UD_ERRORS_C;
      352     3576        %INCLUDE UD_EQU_E;
      353     3965        %SUB B$JIT = B$JIT$->B$JIT;
      354     3966        %SUB B$SS = B_MPT.SS$->B$SS;
      355     3967        %SUB B$ECCB = B_MPT.ECCB$->B$ECCB;
      356     3968        %SUB_EXC;
      357     4015
      358     4016
      359     4017        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:31   
      360     4018
      361     4019         /*F*  NAME:         UDB$PMMEXIT
      362     4020
      363     4021               PURPOSE:      To provide for normal or error return
      364     4022                             to the user following PMME processing.
      365     4023
      366     4024               DESCRIPTION:
      367     4025
      368     4026         UDB$PMMEXIT is entered with B$JIT.ERR.CODE set to
      369     4027         zero to indicate normal PMME processing completion;
      370     4028         set non-zero to indicate PMME error.
      371     4029
      372     4030         Normal completion requires only that the IC in
      373     4031         Safe-Store be bumped if ALTRET was specified on
      374     4032         the PMME call.
      375     4033
      376     4034         Processing for PMME error completion is dependent
      377     4035         on:
      378     4036         TU
      379     4037           1)  ALTRET specification
      380     4038           2)  M$TRAP control of bad PMMEs
      381     4039           3)  severity of the error
      382     4040           4)  association of DELTA
      383     4041         TF
      384     4042
      385     4043         When ALTRET has not been specified and the severity
      386     4044         of the error is zero, the error condition is ignored
      387     4045         and the user is re-entered at the instruction
      388     4046         following the PMME (no change to the Safe-Store IC
      389     4047         and no entry to DELTA and/or the PMME Trap Control
      390     4048         routine).
      391     4049
      392     4050         When ALTRET is not specified (user not executing under
      393     4051         DELTA or PMME is from a Special Shared Processor) but
      394     4052         PMME trap control has been established, the PMME Trap
      395     4053         Control routine is entered.  If neither ALTRET specified
      396     4054         on the PMME call or PMME Trap Control, the abort logic
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:32   
      397     4055         is entered.
      398     4056
      399     4057         When ALTRET is not specified, and the user is running
      400     4058         under DELTA, DELTA is entered with the ECC of the
      401     4059         Exceptional Condition Frame set to %ECC_PMME#.
      402     4060         */
      403     4061
      404     4062
      405     4063        /*  Set the M bit in VLP_ERRCODE just in case any monitor routine
      406     4064            forgot to do so.
      407     4065        */
      408     4066    1           B$JIT.ERR = B$JIT.ERR | '000000400000'O;

   4066  2 000002   000000 470400 xsym               LDP0    B$JIT$
         2 000003   000012 236100                    LDQ     10,,PR0
         2 000004   000000 276000 1                  ORQ     0
         2 000005   000012 756100                    STQ     10,,PR0
         2 000006   000011 710000 2                  TRA     s:4079

      409     4067
      410     4068
      411     4069
      412     4070
      413     4071
      414     4072        /*F*   NAME:   UDB$PMMEXIT1
      415     4073
      416     4074               PURPOSE:  To provide an entry to the PMME exit logic
      417     4075                         when the M bit in the ERRCODE is not to be set
      418     4076                         but the MOUSE data is to be updated.
      419     4077        */
      420     4078    1   UDB$PMMEXIT1: ENTRY;

   4078  2 000007   000000 700200 xent  UDB$PMMEXIT1 TSX0  ! X66_AUTO_0
         2 000010   000022 000000                    ZERO    18,0

      421     4079    1           CALL CALCOMP;

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:33   
   4079  2 000011   000350 701000 2                  TSX1    CALCOMP
         2 000012   000000 011000                    NOP     0
         2 000013   000016 710000 2                  TRA     s:4093

      422     4080
      423     4081
      424     4082        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:34   
      425     4083
      426     4084         /*F*  NAME:         UDB$PMMEXIT2
      427     4085
      428     4086               PURPOSE:      To provide an entry to the PMME
      429     4087                             exit logic when the MOUSE data
      430     4088                             has already been updated.
      431     4089
      432     4090         */
      433     4091
      434     4092    1   UDB$PMMEXIT2: ENTRY;

   4092  2 000014   000000 700200 xent  UDB$PMMEXIT2 TSX0  ! X66_AUTO_0
         2 000015   000022 000000                    ZERO    18,0

      435     4093    1           CALL UDN$JAMSS;

   4093  2 000016   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000017   000000 701000 xent               TSX1    UDN$JAMSS
         2 000020   000000 011000                    NOP     0

      436     4094    1           IF (B$JIT.JUNK & %JJ_BAKIC#) ~='0'O

   4094  2 000021   000000 470400 xsym               LDP0    B$JIT$
         2 000022   000315 220100                    LDX0    205,,PR0
         2 000023   001000 360003                    ANX0    512,DU
         2 000024   000040 600000 2                  TZE     s:4104

      437     4095    2           THEN DO;

      438     4096    2                B$JIT.JUNK = (B$JIT.JUNK &~ %JJ_BAKIC#);

   4096  2 000025   000315 220100                    LDX0    205,,PR0
         2 000026   776777 360003                    ANX0    -513,DU
         2 000027   000315 740100                    STX0    205,,PR0

      439     4097    2                IF B$SS.ISR.WSR ~= %MONWSR

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:35   
   4097  2 000030   000000 471400 xsym               LDP1    B_MPT
         2 000031   100010 236100                    LDQ     8,,PR1
         2 000032   000160 316007                    CANQ    112,DL
         2 000033   000040 600000 2                  TZE     s:4104

      440     4098    3                THEN DO;

      441     4099    3                     B$SS.IC = B$SS.IC-2;

   4099  2 000034   100004 221100                    LDX1    4,,PR1
         2 000035   777776 622011                    EAX2    -2,X1
         2 000036   100004 742100                    STX2    4,,PR1

      442     4100    3                     GOTO UDB_EXIT;

   4100  2 000037   000323 710000 2                  TRA     UDB_EXIT

      443     4101    3                     END;
      444     4102    2                END;                       /* DO IF NOT %MONWSR                  */
      445     4103
      446     4104    1           IF B$JIT.ERR.CODE = 0

   4104  2 000040   000012 236100                    LDQ     10,,PR0
         2 000041   377770 316007                    CANQ    131064,DL
         2 000042   000052 601000 2                  TNZ     s:4112

      447     4105    1           THEN IF B$SS.FPT.ALT ~= '0'O

   4105  2 000043   000000 471400 xsym               LDP1    B_MPT
         2 000044   100001 234100                    SZN     1,,PR1
         2 000045   000323 605000 2                  TPL     UDB_EXIT

      448     4106    2                THEN DO;

      449     4107    2                     B$SS.IC = B$SS.IC+1;

   4107  2 000046   100004 220100                    LDX0    4,,PR1
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:36   
         2 000047   000001 621010                    EAX1    1,X0
         2 000050   100004 741100                    STX1    4,,PR1

      450     4108    2                     END;

   4108  2 000051   000323 710000 2                  TRA     UDB_EXIT

      451     4109    1                ELSE ;                     /* NO ALTRET AND GOOD PMME--GOTO EXIT */
      452     4110
      453     4111    2           ELSE DO;                        /*WHEN B$JIT.ERR NOT ZERO             */

      454     4112    2                IF UDB_ALTLOG.LOG AND B$SS.FPT.FCG ~= %FCG_TD#

   4112  2 000052   000000 234000 0                  SZN     UDB_ALTLOG
         2 000053   000131 605000 2                  TPL     s:4130
         2 000054   000000 471400 xsym               LDP1    B_MPT
         2 000055   100001 236100                    LDQ     1,,PR1
         2 000056   370000 376003                    ANQ     126976,DU
         2 000057   070000 116003                    CMPQ    28672,DU
         2 000060   000131 600000 2                  TZE     s:4130

      455     4113    3                THEN DO;

      456     4114    3                     UDB_ALTLOG.FPT = B$SS.FPT;

   4114  2 000061   100001 220100                    LDX0    1,,PR1
         2 000062   000000 440000 0                  SXL0    UDB_ALTLOG

      457     4115    3                     UDB_ALTLOG.JITERR = B$JIT.ERR;

   4115  2 000063   000012 236100                    LDQ     10,,PR0
         2 000064   000002 756000 0                  STQ     UDB_ALTLOG+2

      458     4116    3                     IF (UDB_ALTLOG.FPT.FCG = %FCG_FM1#

   4116  2 000065   000000 236000 0                  LDQ     UDB_ALTLOG
         2 000066   370000 376007                    ANQ     126976,DL
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:37   
         2 000067   040000 116007                    CMPQ    16384,DL
         2 000070   000073 600000 2                  TZE     s:4116+6
         2 000071   050000 116007                    CMPQ    20480,DL
         2 000072   000114 601000 2                  TNZ     s:4126
         2 000073   000232 236100                    LDQ     154,,PR0
         2 000074   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000075   000114 600000 2                  TZE     s:4126

      459     4117    3                       OR UDB_ALTLOG.FPT.FCG = %FCG_FM2#)
      460     4118    3                       AND B$JIT.DCB$ ~= ADDR(NIL)
      461     4119    4                     THEN DO;

      462     4120    4                          UDB_ALTLOG.FILE.ASN = B$JIT.DCB$ -> F$DCB.ASN;

   4120  2 000076   000232 473500                    LDP3    154,,PR0
         2 000077   300032 236100                    LDQ     26,,PR3
         2 000100   000022 736000                    QLS     18
         2 000101   000001 552040 0                  STBQ    UDB_ALTLOG+1,'40'O

      463     4121    4                          UDB_ALTLOG.FILE.ORG = B$JIT.DCB$ -> F$DCB.ORG;

   4121  2 000102   300032 236100                    LDQ     26,,PR3
         2 000103   000011 772000                    QRL     9
         2 000104   000001 552020 0                  STBQ    UDB_ALTLOG+1,'20'O

      464     4122    4                          UDB_ALTLOG.FILE.ACS = B$JIT.DCB$ -> F$DCB.ACS;

   4122  2 000105   300036 236100                    LDQ     30,,PR3
         2 000106   000011 736000                    QLS     9
         2 000107   000001 552010 0                  STBQ    UDB_ALTLOG+1,'10'O

      465     4123    4                          UDB_ALTLOG.FILE.FUN = B$JIT.DCB$ -> F$DCB.FUN;

   4123  2 000110   300032 236100                    LDQ     26,,PR3
         2 000111   000022 772000                    QRL     18
         2 000112   000001 552004 0                  STBQ    UDB_ALTLOG+1,'04'O

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:38   
      466     4124    4                          END;

   4124  2 000113   000115 710000 2                  TRA     s:4127

      467     4125    3                     ELSE
      468     4126    3                          UDB_ALTLOG.FILE = '0'B;

   4126  2 000114   000001 450000 0                  STZ     UDB_ALTLOG+1

      469     4127    3                     CALL ELA$SYSLOG (0,UDB_ALTLOG,SIZEW(UDB_ALTLOG),0,69,DFLG);

   4127  2 000115   200003 633500                    EPPR3   DFLG,,AUTO
         2 000116   200021 453500                    STP3    ECC+8,,AUTO
         2 000117   000001 236000 3                  LDQ     1
         2 000120   200020 756100                    STQ     ECC+7,,AUTO
         2 000121   000002 237000 3                  LDAQ    2
         2 000122   200016 757100                    STAQ    ECC+5,,AUTO
         2 000123   000004 237000 3                  LDAQ    4
         2 000124   200014 757100                    STAQ    ECC+3,,AUTO
         2 000125   200014 630500                    EPPR0   ECC+3,,AUTO
         2 000126   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000127   000000 701000 xent               TSX1    ELA$SYSLOG
         2 000130   000000 011000                    NOP     0

      470     4128    3                     END;

      471     4129                                      /* First make sure DCB# is the JIT is right     */
      472     4130    2                IF ( (B$SS.FPT.FCG=%FCG_FM1#) OR (B$SS.FPT.FCG=%FCG_FM2#) )

   4130  2 000131   000000 470400 xsym               LDP0    B_MPT
         2 000132   000001 236100                    LDQ     1,,PR0
         2 000133   370000 376003                    ANQ     126976,DU
         2 000134   040000 116003                    CMPQ    16384,DU
         2 000135   000140 600000 2                  TZE     s:4130+7
         2 000136   050000 116003                    CMPQ    20480,DU
         2 000137   000162 601000 2                  TNZ     NO_PS0
         2 000140   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:39   
         2 000141   100012 236100                    LDQ     10,,PR1
         2 000142   377770 376007                    ANQ     131064,DL
         2 000143   006440 116007                    CMPQ    3360,DL
         2 000144   000162 600000 2                  TZE     NO_PS0

      473     4131    2                  AND B$JIT.ERR.CODE ~= %E$BADVECT0
      474     4132    3                THEN DO;

      475     4133    3                     CALL HFF$NILERASE(0) ALTRET(NO_PS0);

   4133  2 000145   000003 630400 3                  EPPR0   3
         2 000146   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000147   000000 701000 xent               TSX1    HFF$NILERASE
         2 000150   000162 702000 2                  TSX2    NO_PS0

      476     4134    3                     ECP.EID = B$PS0$->DCB#;

   4134  2 000151   000000 470400 xsym               LDP0    B$PS0$
         2 000152   000000 236100                    LDQ     0,,PR0
         2 000153   000022 772000                    QRL     18
         2 000154   200005 756100                    STQ     ECP+1,,AUTO

      477     4135    3                     B$JIT.DCBNO = B$PS0$->DCB#;

   4135  2 000155   000000 471400 xsym               LDP1    B$JIT$
         2 000156   000000 236100                    LDQ     0,,PR0
         2 000157   000022 772000                    QRL     18
         2 000160   100022 552104                    STBQ    18,'04'O,PR1

      478     4136    3                     END;

   4136  2 000161   000163 710000 2                  TRA     s:4142

      479     4137    3                ELSE DO;

   4135  2 000162                       NO_PS0       null
      480     4138    3   NO_PS0:           ;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:40   
      481     4139    3                     ECP.EID=0;

   4139  2 000162   200005 450100                    STZ     ECP+1,,AUTO

      482     4140    3                     END;

      483     4141
      484     4142    2                CALL UDN$MAGIC;

   4142  2 000163   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000164   000000 701000 xent               TSX1    UDN$MAGIC
         2 000165   000000 011000                    NOP     0

      485     4143
      486     4144    2                DFLG='0'B;

   4144  2 000166   200003 450100                    STZ     DFLG,,AUTO

      487     4145    2                IF B$SS.FPT.ALT = '0'B

   4145  2 000167   000000 470400 xsym               LDP0    B_MPT
         2 000170   000001 234100                    SZN     1,,PR0
         2 000171   000242 604000 2                  TMI     s:4168

      488     4146    3                THEN DO;                   /*B$JIT.ERR NOT 0 ALTBIT=0            */

      489     4147    3                     IF B$JIT.ERR.SEV = 0 THEN GOTO UDB_EXIT;

   4147  2 000172   000000 471400 xsym               LDP1    B$JIT$
         2 000173   100012 236100                    LDQ     10,,PR1
         2 000174   000007 316007                    CANQ    7,DL
         2 000175   000323 600000 2                  TZE     UDB_EXIT

      490     4148    3                     IF B$SS.ISR.WSR <= 1 THEN CALL SC_UDB421;

   4148  2 000176   000010 236100                    LDQ     8,,PR0
         2 000177   000160 376007                    ANQ     112,DL
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:41   
         2 000200   000040 116007                    CMPQ    32,DL
         2 000201   000204 603000 2                  TRC     s:4153

   4148  2 000202   000000 713400 xsym               CLIMB   SC_UDB421
         2 000203   000000 600000 xsid               climb   nvectors=         0

      491     4149        /*S*   SCREECH_CODE:   UDB-S$MPMMERR
      492     4150               TYPE:   SUA
      493     4151               MESSAGE:  Monitor PMME error and no ALTRET
      494     4152        */
      495     4153    3                     B$SS.IC = B$SS.IC-2;

   4153  2 000204   000000 470400 xsym               LDP0    B_MPT
         2 000205   000004 220100                    LDX0    4,,PR0
         2 000206   777776 621010                    EAX1    -2,X0
         2 000207   000004 741100                    STX1    4,,PR0

      496     4154    3                     IF B_MPT.ECCBDESC$->B$$DESCR.FLGS & %DSXXX

   4154  2 000210   000013 471400 xsym               LDP1    B_MPT+11
         2 000211   100000 236100                    LDQ     0,,PR1
         2 000212   000024 736000                    QLS     20
         2 000213   777000 376003                    ANQ     -512,DU
         2 000214   020000 376003                    ANQ     8192,DU
         2 000215   000224 600000 2                  TZE     s:4161

      497     4155    4                     THEN DO;              /* GET SET FOR DELTA                  */

      498     4156    4                          DFLG = '1'B;

   4156  2 000216   400000 236003                    LDQ     -131072,DU
         2 000217   200003 756100                    STQ     DFLG,,AUTO

      499     4157    4                          SSIC = B$SS.IC;

   4157  2 000220   000004 236100                    LDQ     4,,PR0
         2 000221   000022 772000                    QRL     18
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:42   
         2 000222   200010 756100                    STQ     SSIC,,AUTO

      500     4158    4                          GOTO SETECC;

   4158  2 000223   000237 710000 2                  TRA     SETECC

      501     4159    4                          END;             /* GET SET FOR DELTA                  */
      502     4160    4                     ELSE DO;              /* GO TO PMME TRAP CONTROL OR ABORTM  */

      503     4161    4                          IF B$ECCB.FLAGS.PMMESET = '0'B THEN CALL JSE$ABORTM;

   4161  2 000224   000005 473400 xsym               LDP3    B_MPT+5
         2 000225   300004 236100                    LDQ     4,,PR3
         2 000226   020000 316003                    CANQ    8192,DU
         2 000227   000233 601000 2                  TNZ     s:4162

   4161  2 000230   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000231   000000 701000 xent               TSX1    JSE$ABORTM
         2 000232   000000 011000                    NOP     0

      504     4162    4                          SSIC = B$ECCB.PMME;

   4162  2 000233   000005 470400 xsym               LDP0    B_MPT+5
         2 000234   000002 236100                    LDQ     2,,PR0
         2 000235   000022 772000                    QRL     18
         2 000236   200010 756100                    STQ     SSIC,,AUTO

      505     4163    4   SETECC:                ECC = %ECC_PMME#;

   4163  2 000237   000004 235007       SETECC       LDA     4,DL
         2 000240   200011 755100                    STA     ECC,,AUTO

      506     4164    4                          END;             /* GOTO PMME TRAP CONTROL             */

      507     4165    3                     GOTO SETSSF$;

   4165  2 000241   000255 710000 2                  TRA     SETSSF$
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:43   

      508     4166    3                     END;                  /*B$JIT.ERR NOT 0  ALTBIT =0          */
      509     4167    3                ELSE DO;                   /*B$JIT.ERR NOT0 ALTBIT SET           */

      510     4168    3                     IF B$SS.ISR.WSR = %MONWSR THEN GOTO UDB_EXIT;

   4168  2 000242   000010 236100                    LDQ     8,,PR0
         2 000243   000160 316007                    CANQ    112,DL
         2 000244   000323 600000 2                  TZE     UDB_EXIT

      511     4169    3                     ECC = %ECC_ALT#;

   4169  2 000245   000143 235007                    LDA     99,DL
         2 000246   200011 755100                    STA     ECC,,AUTO

      512     4170    3                     SSIC= B$SS.IC;

   4170  2 000247   000004 236100                    LDQ     4,,PR0
         2 000250   000022 772000                    QRL     18
         2 000251   200010 756100                    STQ     SSIC,,AUTO

      513     4171    3                     B$SS.IC = B$SS.IC-2;

   4171  2 000252   000004 220100                    LDX0    4,,PR0
         2 000253   777776 621010                    EAX1    -2,X0
         2 000254   000004 741100                    STX1    4,,PR0

      514     4172    3                     END;

   4168  2 000255                       SETSSF$      null
      515     4173    2   SETSSF$:     ;
      516     4174    2                ECP.ECCS = BITBIN(B$SS.FPT & '371777'O);
              4174                         /*DONT MOVE ALTRET-FPTCHK FLG */

   4174  2 000255   000000 470400 xsym               LDP0    B_MPT
         2 000256   000001 220100                    LDX0    1,,PR0
         2 000257   371777 360003                    ANX0    127999,DU
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:44   
         2 000260   000000 636010                    EAQ     0,X0
         2 000261   000022 772000                    QRL     18
         2 000262   200004 756100                    STQ     ECP,,AUTO

      517     4175    2                ECP.JERR = B$JIT.ERR;

   4175  2 000263   000000 471400 xsym               LDP1    B$JIT$
         2 000264   100012 236100                    LDQ     10,,PR1
         2 000265   200006 756100                    STQ     ECP+2,,AUTO

      518     4176    2                ECP.P# = 0;

   4176  2 000266   200007 450100                    STZ     ECP+3,,AUTO

      519     4177
      520     4178    2                IF DFLG THEN CALL SSU$DELTAGO(ECC,ECP);

   4178  2 000267   200003 234100                    SZN     DFLG,,AUTO
         2 000270   000301 605000 2                  TPL     s:4179

   4178  2 000271   200004 633500                    EPPR3   ECP,,AUTO
         2 000272   200015 453500                    STP3    ECC+4,,AUTO
         2 000273   200011 634500                    EPPR4   ECC,,AUTO
         2 000274   200014 454500                    STP4    ECC+3,,AUTO
         2 000275   200014 630500                    EPPR0   ECC+3,,AUTO
         2 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000277   000000 701000 xent               TSX1    SSU$DELTAGO
         2 000300   000000 011000                    NOP     0

      521     4179    2                IF B_MPT.TCBDESC$->B$$DESCR.BOUND=0 THEN GOTO FULLTCB;

   4179  2 000301   000012 470400 xsym               LDP0    B_MPT+10
         2 000302   000000 236100                    LDQ     0,,PR0
         2 000303   000034 316000 xsym               CANQ    B_VECTNIL+28
         2 000304   000326 600000 2                  TZE     FULLTCB

      522     4180    2                CALL SST$SSFTCB(SSIC,ECC,ECP,B_MPT.SS$,B_MPT.TCB$) ALTRET(FULLTCB);
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:45   

   4180  2 000305   000006 236000 3                  LDQ     6
         2 000306   200020 756100                    STQ     ECC+7,,AUTO
         2 000307   000007 236000 3                  LDQ     7
         2 000310   200017 756100                    STQ     ECC+6,,AUTO
         2 000311   200004 631500                    EPPR1   ECP,,AUTO
         2 000312   200016 451500                    STP1    ECC+5,,AUTO
         2 000313   200011 633500                    EPPR3   ECC,,AUTO
         2 000314   200015 453500                    STP3    ECC+4,,AUTO
         2 000315   200010 634500                    EPPR4   SSIC,,AUTO
         2 000316   200014 454500                    STP4    ECC+3,,AUTO
         2 000317   200014 630500                    EPPR0   ECC+3,,AUTO
         2 000320   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000321   000000 701000 xent               TSX1    SST$SSFTCB
         2 000322   000326 702000 2                  TSX2    FULLTCB

      523     4181
      524     4182    2                END;                       /*DO WHEN B$JIT.ERR NOT ZERO          */

      525     4183
      526     4184
      527     4185    1   UDB_EXIT: CALL UDB$AUTO;

   4185  2 000323   000002 631400 xsym  UDB_EXIT     EPPR1   B_VECTNIL+2
         2 000324   000000 701000 xent               TSX1    UDB$AUTO
         2 000325   000000 011000                    NOP     0

   4179  2 000326                       FULLTCB      null
      528     4186    1   FULLTCB: ;
      529     4187    1           IF ECC=%ECC_PMME# THEN CALL JSE$ABORTM;

   4187  2 000326   200011 235100                    LDA     ECC,,AUTO
         2 000327   000004 115007                    CMPA    4,DL
         2 000330   000334 601000 2                  TNZ     s:4188

   4187  2 000331   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000332   000000 701000 xent               TSX1    JSE$ABORTM
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:46   
         2 000333   000000 011000                    NOP     0

      530     4188    1           B$SS.IC=SSIC;

   4188  2 000334   200010 720100                    LXL0    SSIC,,AUTO
         2 000335   000000 470400 xsym               LDP0    B_MPT
         2 000336   000004 740100                    STX0    4,,PR0

      531     4189    1           CALL UDB$AUTO;

   4189  2 000337   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000340   000000 701000 xent               TSX1    UDB$AUTO
         2 000341   000000 011000                    NOP     0
         2 000342   000345 710000 2                  TRA     s:4200

      532     4190        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:47   
      533     4191         /*F*  NAME:          UDB$CALCOMP
      534     4192
      535     4193               PURPOSE:       To provide for updating of the MOUSE
      536     4194                              data for those PMMEs that do not return
      537     4195                              to the user via UDB$PMMEXIT following
      538     4196                              PMME processing.
      539     4197         */
      540     4198
      541     4199    1   UDB$CALCOMP: ENTRY;

   4199  2 000343   000000 700200 xent  UDB$CALCOMP  TSX0  ! X66_AUTO_0
         2 000344   000022 000000                    ZERO    18,0

      542     4200    1           CALL CALCOMP;

   4200  2 000345   000350 701000 2                  TSX1    CALCOMP
         2 000346   000000 011000                    NOP     0

      543     4201    1           RETURN;

   4201  2 000347   000000 702200 xent               TSX2  ! X66_ARET

      544     4202
      545     4203        %EJECT;
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:48   
      546     4204
      547     4205         /*I*  NAME:          CALCOMP
      548     4206
      549     4207               PURPOSE:       To provide for updating of the MOUSE data.
      550     4208
      551     4209         */
      552     4210
      553     4211    1   CALCOMP: PROC;

   4211  2 000350   200012 741300       CALCOMP      STX1  ! ECC+1,,AUTO

      554     4212    2           B$SS.FPTCHK=0;

   4212  2 000351   000000 470400 xsym               LDP0    B_MPT
         2 000352   000007 450100                    STZ     7,,PR0

      555     4213    2           B$SS.FPT=(B$SS.FPT | '004000'O);

   4213  2 000353   000001 220100                    LDX0    1,,PR0
         2 000354   004000 260003                    ORX0    2048,DU
         2 000355   000001 740100                    STX0    1,,PR0

      556     4214
      557     4215    2           P_CALCOMP(S_PNO) = P_CALCOMP(S_PNO)+1;

   4215  2 000356   000000 721000 xsym               LXL1    S_PNO
         2 000357   000000 054011 xsym               AOS     P_CALCOMP,X1

      558     4216    2           IF PH_MOUSE_USERS ~=0 THEN CALL PHP$END_PMME;

   4216  2 000360   000000 235000 xsym               LDA     PH_MOUSE_USERS
         2 000361   000365 600000 2                  TZE     s:4218

   4216  2 000362   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000363   000000 701000 xent               TSX1    PHP$END_PMME
         2 000364   000000 011000                    NOP     0

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:49   
      559     4217
      560     4218    2           RETURN;

   4218  2 000365   200012 221300                    LDX1  ! ECC+1,,AUTO
         2 000366   000001 702211                    TSX2  ! 1,X1

UDB_ALTLOG
 Sect OctLoc
   0     000   000000 0*****   ****** ******   ****** ******                    ............

(unnamed)
 Sect OctLoc
   1     000   000000 400000                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 000105   000000 006000   000005 006000   000002 006000    ...E............
   3     004   000002 006000   000000 006000   000004 006000   000000 006000    ................
      561     4219    2   END CALCOMP;
      562     4220
      563     4221
      564     4222    1   END UDB$PMMEXIT;

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:50   
--  Include file information  --

   UD_EQU_E.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure UDB$PMMEXIT.
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:51   

 **** Variables and constants ****

  ****  Section 000  Data  UDB$PMMEXIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(108)   r     1 UDB_ALTLOG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 DFLG                      11-0-0/w UBIN        r     1 ECC
     4-0-0/w STRC(144)   r     1 ECP                       10-0-0/w UBIN        r     1 SSIC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/d STRC(432)   r     1 B_MPT                      0-0-0/w SBIN        r     1 PH_MOUSE_USERS
     0-0-0/w SBIN        r     1 P_CALCOMP(0:3)
     0-0-0/w UBIN        r     1 S_PNO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 B$$DESCR                   0-0-0/w STRC(180)   r     1 B$ECCB
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(2304)  r     1 B$SS
     0-0-0/w UBIN(18)    r     1 DCB#                       0-0-0/d ASTR(3528)  r     1 F$DCB

PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:52   

   Procedure UDB$PMMEXIT requires 247 words for executable code.
   Procedure UDB$PMMEXIT requires 18 words of local(AUTO) storage.

    No errors detected in file UDB$PMMEXIT.:E05TSI    .
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:54   
          MINI XREF LISTING

B$$DESCR.BOUND
       479**DCL      4179>>IF
B$$DESCR.FLGS
       480**DCL      4154>>IF
B$ECCB.FLAGS.PMMESET
      1868**DCL      4161>>IF
B$ECCB.PMME
      1867**DCL      4162>>ASSIGN
B$JIT.DCB$
      1074**DCL      4116>>IF       4120>>ASSIGN   4121>>ASSIGN   4122>>ASSIGN   4123>>ASSIGN
B$JIT.DCBNO
      1065**DCL      4135<<ASSIGN
B$JIT.ERR
       984**DCL      4066<<ASSIGN   4066>>ASSIGN   4115>>ASSIGN   4175>>ASSIGN
B$JIT.ERR.CODE
       985**DCL      4104>>IF       4130>>IF
B$JIT.ERR.MID
       985**DCL       985--REDEF
B$JIT.ERR.SEV
       985**DCL      4147>>IF
B$JIT.JUNK
      1103**DCL      4094>>IF       4096<<ASSIGN   4096>>ASSIGN
B$JIT$
      3396**DCL       979--IMP-PTR  4066>>ASSIGN   4066>>ASSIGN   4094>>IF       4096>>ASSIGN   4096>>ASSIGN
      4104>>IF       4115>>ASSIGN   4116>>IF       4120>>ASSIGN   4121>>ASSIGN   4122>>ASSIGN   4123>>ASSIGN
      4130>>IF       4135>>ASSIGN   4147>>IF       4175>>ASSIGN
B$PS0$
      3397**DCL      4134>>ASSIGN   4135>>ASSIGN
B$SS.FPT
       496**DCL      4114>>ASSIGN   4174>>ASSIGN   4213<<ASSIGN   4213>>ASSIGN
B$SS.FPT.ALT
       497**DCL      4105>>IF       4145>>IF
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:55   
B$SS.FPT.FCG
       498**DCL      4112>>IF       4130>>IF       4130>>IF
B$SS.FPTCHK
       538**DCL      4212<<ASSIGN
B$SS.IC
       504**DCL      4099<<ASSIGN   4099>>ASSIGN   4107<<ASSIGN   4107>>ASSIGN   4153<<ASSIGN   4153>>ASSIGN
      4157>>ASSIGN   4170>>ASSIGN   4171<<ASSIGN   4171>>ASSIGN   4188<<ASSIGN
B$SS.ISR.WSR
       542**DCL      4097>>IF       4148>>IF       4168>>IF
B$SS.RVA
       537**DCL       538--REDEF
B_MPT.AS
      3339**DCL      3342--REDEF
B_MPT.ASDESC
      3371**DCL      3375--REDEF
B_MPT.ECCB
      3354**DCL      3357--REDEF
B_MPT.ECCB$
      3357**DCL      4161>>IF       4162>>ASSIGN
B_MPT.ECCBDESC
      3389**DCL      3393--REDEF
B_MPT.ECCBDESC$
      3393**DCL      4154>>IF
B_MPT.LS
      3334**DCL      3337--REDEF
B_MPT.LSDESC
      3365**DCL      3369--REDEF
B_MPT.PS
      3344**DCL      3347--REDEF
B_MPT.PSDESC
      3377**DCL      3381--REDEF
B_MPT.SS
      3329**DCL      3332--REDEF
B_MPT.SS$
      3332**DCL      4097>>IF       4099>>ASSIGN   4099>>ASSIGN   4105>>IF       4107>>ASSIGN   4107>>ASSIGN
      4112>>IF       4114>>ASSIGN   4130>>IF       4130>>IF       4145>>IF       4148>>IF       4153>>ASSIGN
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:56   
      4153>>ASSIGN   4157>>ASSIGN   4168>>IF       4170>>ASSIGN   4171>>ASSIGN   4171>>ASSIGN   4174>>ASSIGN
      4180<>CALL     4188>>ASSIGN   4212>>ASSIGN   4213>>ASSIGN   4213>>ASSIGN
B_MPT.SSDESC
      3359**DCL      3363--REDEF
B_MPT.TCB
      3349**DCL      3352--REDEF
B_MPT.TCB$
      3352**DCL      4180<>CALL
B_MPT.TCBDESC
      3383**DCL      3387--REDEF
B_MPT.TCBDESC$
      3387**DCL      4179>>IF
CALCOMP
      4211**PROC     4079--CALL     4200--CALL
DCB#
      1173**DCL      4134>>ASSIGN   4135>>ASSIGN
DFLG
        14**DCL      4127<>CALL     4144<<ASSIGN   4156<<ASSIGN   4178>>IF
ECC
        23**DCL      4163<<ASSIGN   4169<<ASSIGN   4178<>CALL     4180<>CALL     4187>>IF
ECP
        16**DCL      4178<>CALL     4180<>CALL
ECP.ECCS
        17**DCL      4174<<ASSIGN
ECP.EID
        18**DCL      4134<<ASSIGN   4139<<ASSIGN
ECP.JERR
        19**DCL      4175<<ASSIGN
ECP.P#
        20**DCL      4176<<ASSIGN
ELA$SYSLOG
       313**DCL-ENT  4127--CALL
F$DCB.ACS
       446**DCL      4122>>ASSIGN
F$DCB.ACTPOS
       454**DCL       454--REDEF
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:57   
F$DCB.ARS
       429**DCL       429--REDEF
F$DCB.ASN
       444**DCL      4120>>ASSIGN
F$DCB.ATTR
       447**DCL       448--REDEF
F$DCB.BORROW
       462**DCL       462--REDEF     462--REDEF     462--REDEF
F$DCB.DCBNAME.L
       476**DCL       476--IMP-SIZ
F$DCB.EOMCHAR
       433**DCL       433--REDEF
F$DCB.FLDID
       457**DCL       457--REDEF
F$DCB.FORM$
       451**DCL       451--REDEF
F$DCB.FSECT
       467**DCL       467--REDEF
F$DCB.FSN
       444**DCL       444--REDEF     444--REDEF     445--REDEF
F$DCB.FUN
       443**DCL      4123>>ASSIGN
F$DCB.HEADER$
       450**DCL       450--REDEF
F$DCB.IXTNSIZE
       448**DCL       448--REDEF
F$DCB.LASTSTA$
       438**DCL       438--REDEF
F$DCB.LVL
       463**DCL       463--REDEF
F$DCB.NAME.C
       438**DCL       438--REDEF
F$DCB.NOEOF
       459**DCL       459--REDEF
F$DCB.NRECS
       449**DCL       449--REDEF
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:58   
F$DCB.NRECX
       468**DCL       468--REDEF
F$DCB.OHDR
       460**DCL       460--REDEF
F$DCB.ORG
       443**DCL       443--REDEF    4121>>ASSIGN
F$DCB.PRECNO
       466**DCL       466--REDEF
F$DCB.RCSZ
       471**DCL       471--REDEF
F$DCB.RES
       439**DCL       439--REDEF
F$DCB.SETX
       451**DCL       451--REDEF
F$DCB.TAB$
       450**DCL       451--REDEF
F$DCB.TDA
       465**DCL       465--REDEF
F$DCB.WSN
       440**DCL       440--REDEF
FULLTCB
      4179**LABEL    4179--GOTO     4180--CALLALT
HFF$NILERASE
       312**DCL-ENT  4133--CALL
JSE$ABORTM
       307**DCL-ENT  4161--CALL     4187--CALL
NO_PS0
      4135**LABEL    4133--CALLALT
PHP$END_PMME
       306**DCL-ENT  4216--CALL
PH_MOUSE_USERS
      3398**DCL      4216>>IF
P_CALCOMP
      3400**DCL      4215<<ASSIGN   4215>>ASSIGN
SC_UDB421
       302**DCL-ENT  4148--CALL
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:59   
SETECC
      4163**LABEL    4158--GOTO
SETSSF$
      4168**LABEL    4165--GOTO
SSIC
        22**DCL      4157<<ASSIGN   4162<<ASSIGN   4170<<ASSIGN   4180<>CALL     4188>>ASSIGN
SST$SSFTCB
       304**DCL-ENT  4180--CALL
SSU$DELTAGO
       305**DCL-ENT  4178--CALL
S_PNO
      3399**DCL      4215>>ASSIGN   4215>>ASSIGN
UDB$AUTO
       303**DCL-ENT  4185--CALL     4189--CALL
UDB_ALTLOG
       286**DCL      4127<>CALL     4127--CALL
UDB_ALTLOG.FILE
       293**DCL      4126<<ASSIGN
UDB_ALTLOG.FILE.ACS
       296**DCL      4122<<ASSIGN
UDB_ALTLOG.FILE.ASN
       294**DCL      4120<<ASSIGN
UDB_ALTLOG.FILE.FUN
       297**DCL      4123<<ASSIGN
UDB_ALTLOG.FILE.ORG
       295**DCL      4121<<ASSIGN
UDB_ALTLOG.FPT
       289**DCL      4114<<ASSIGN
UDB_ALTLOG.FPT.FCG
       291**DCL      4116>>IF       4116>>IF
UDB_ALTLOG.JITERR
       298**DCL      4115<<ASSIGN
UDB_ALTLOG.LOG
       287**DCL      4112>>IF
UDB_EXIT
      4185**LABEL    4100--GOTO     4147--GOTO     4168--GOTO
PL6.E3A0      #001=UDB$PMMEXIT File=UDB$PMMEXIT.:E05TSI                          WED 07/30/97 06:55 Page:60   
UDN$JAMSS
       311**DCL-ENT  4093--CALL
UDN$MAGIC
       310**DCL-ENT  4142--CALL
