
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:1    
        1        1        /*M*     ZIG$V_OA       I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_OA
        9        9        PURPOSE:
       10       10              To build a OA record in the schema subset and initialize
       11       11            it with the all the things I can from the control block
       12       12            of the subschema.
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V        OOO   AAA
       16       16            Z   I   G   G  $$$  V   V       O O O A   A
       17       17           Z    I   G     $ $   V   V       O O O A   A
       18       18          Z     I   G      $$$  V   V       O  OO AAAAA
       19       19         Z      I   G  GG   $ $ V   V       O   O A   A
       20       20        Z       I   G   G  $$$   V V        O   O A   A
       21       21        ZZZZZ  III   GGG    $     V          OOO  A   A
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:2    
       25       25        ZIG$V_OA:
       26       26            PROC;
       27       27        /*
       28       28              This subroutine assumes that PRVAL has be called and
       29       29            this is really a subschema file that we are working with.
       30       30            Also it assumes that PRVAL read in the control block
       31       31            into CONTROL.
       32       32        */
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE CP_6_SUBS;
       35      654        %FPT_TIME (FPTN = TIME_FPT,DEST=UTS,TSTAMP=UTSS);
       36      673        %INCLUDE ZI_ERRORS_SUBS;
       37     1193        %INCLUDE ZI_SUB_LANG;
       38     2908        %GENERAL;
       39     3032        %CONTROL_BLOCK;
       40     3140        %INCLUDE ZIG_GENERAL;
       41     3248        %INCLUDE ZIG_TYPE_SUBS;
       42     3263        %INCLUDE ZIG_SSS;
       43     3833        %SS_GENERAL(PSTCLASS=EXT);
       44     3854        %OA(PSTCLASS=EXT);
       45     3921        %OA1(PSTCLASS=EXT);
       46     3929        %DP(PSTCLASS=EXT);
       47     3943        %DP1(PSTCLASS=EXT);
       48     3951        %INCLUDE ZIG_DBA_INT;
       49     3999        %INCLUDE ZI_SUB4_CAN;
       50     4656        %UWA;
       51     4991        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:3    
       52     4992    1   DCL UTSS UBIN (36) STATIC ALIGNED;
       53     4993    1   DCL I UBIN (36);
       54     4994    1   DCL TPTR$ PTR;
       55     4995    1   DCL L_SCHEMA UBIN (36);
       56     4996    1   DCL L_SUBSCH UBIN (36);
       57     4997    1   DCL SUCC BIT (1);
       58     4998    1   DCL LAST_DP UBIN (36) STATIC;
       59     4999    1   DCL PNDBK UBIN (36) STATIC;
       60     5000    1   DCL TEMP_WORD CHAR (30) STATIC;
       61     5001    1   DCL MEMORY_USED_SSS UBIN WORD EXT;
       62     5002        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:4    
       63     5003    1   FIND_LENGTH:
       64     5004    1       PROC(STRING_TO_GET,RETURN_LENGTH);
       65     5005    2   DCL RETURN_LENGTH UBIN (36);
       66     5006    2   DCL STRING_TO_GET CHAR (30);
       67     5007    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);
       68     5008    2       RETURN;
       69     5009    2   NOT_BLANK:
       70     5010    2       RETURN_LENGTH = 30;
       71     5011    2       RETURN;
       72     5012    2   END FIND_LENGTH;
       73     5013        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:5    
       74     5014        /*
       75     5015            THIS SUBROUTINE CHANGES COBOL WORDS INTO SCHEMA WORDS '_' TO '-'.
       76     5016        */
       77     5017    1   CHANGE_TO_STR_SCH:
       78     5018    1       PROC (CHANGE_STR);
       79     5019    2   DCL CHANGE_STR CHAR (30);
       80     5020    2   DCL COUNT1 UBIN (36);
       81     5021    2   DCL ONE_CHANGE (0:4) CHAR (2) STATIC INIT ('  ',
       82     5022    2    '-_' /* COBOL */, '$_' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
       83     5023    2       IF SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC THEN RETURN;
       84     5024    2       CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);
       85     5025    3       DO WHILE (COUNT1~= 30);
       86     5026    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));
       87     5027    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);
       88     5028    3           END;
       89     5029    2       RETURN;
       90     5030    2   END CHANGE_TO_STR_SCH;
       91     5031        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:6    
       92     5032    1   ADD_DP:
       93     5033    1       PROC;
       94     5034    2       CALL ZIG$G_DYN_MEM_6(1,DP1$);
       95     5035    2       TPTR$ = PINCRW(SSS$,LAST_DP-1);
       96     5036    2       DP1$ -> DP1.XXDPN = TPTR$ -> DP1.XXDPN;
       97     5037    2       TPTR$-> DP1.XXDPN = POFFW(DP1$,SSS$) + 1;
       98     5038        /*
       99     5039              Put the DP record in the OA-DP set and connected it up.
      100     5040        */
      101     5041    2       CALL ZIG$G_DYN_MEM_6(%DP_BASE_SIZE,DP$);
      102     5042    2       DP.DEF.TYPE = '000000000010'B;
      103     5043    2       DP.DEF.CTYP = 1; /* PL6 only! */
      104     5044    2   END ADD_DP;
      105     5045    1       ALLOCATE_END = 0;
      106     5046        /*
      107     5047              Allocate dynamic storage from start of dynamic storage.
      108     5048        */
      109     5049    1       MEMORY_USED_SSS = 0;
      110     5050    1       CALL ZIG$G_DYN_MEM_6(1,OA1$);
      111     5051    1       SSS$ = OA1$;
      112     5052    1       CALL SRCHD(CONTROL.SCHEMA_NAME,%ZIG_RTYPE_OA,SUCC);
      113     5053        /*
      114     5054              Got the OA record of the schema and the DA record.
      115     5055        */
      116     5056    1       CALL FIND_LENGTH(CONTROL.SUBSCHEMA_NAME,L_SUBSCH);
      117     5057    1       CALL FIND_LENGTH(CONTROL.SCHEMA_NAME,L_SCHEMA);
      118     5058    1       TEMP_WORD = CONTROL.SCHEMA_NAME;
      119     5059    1       CALL CHANGE_TO_STR_SCH(TEMP_WORD);
      120     5060    1       IF MOD(L_SUBSCH,4) ~= 0
      121     5061    1       THEN L_SUBSCH = L_SUBSCH + 4 - MOD(L_SUBSCH,4);
      122     5062    1       IF MOD(L_SCHEMA,4) ~= 0
      123     5063    1       THEN L_SCHEMA = L_SCHEMA + 4 - MOD(L_SCHEMA,4);
      124     5064    1       CALL ZIG$G_DYN_MEM_6(%OA_BASE_SIZE+(L_SCHEMA+L_SUBSCH)/4,OA$);
      125     5065        /*
      126     5066              OA size = number of words in schema name
      127     5067                      + number of words in subschema name
      128     5068                      + constant (22)
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:7    
      129     5069        */
      130     5070        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:8    
      131     5071        /*
      132     5072              Now init every thing in the schema subset to the
      133     5073            initial values.
      134     5074        */
      135     5075    1       OA.DEF.TYPE = '100000000000'B; /* '4000'O */
      136     5076    1       OA.DEF.STI = '1'B; /* TRANSLATION OK */
      137     5077    1       OA.DEF.SSL = SUB_LANGUAGE;
      138     5078        /*W*
      139     5079              All set in the schema subset end with the value 0 and all
      140     5080            dynamic memory is initialized to zero so not initialization
      141     5081            is needed.
      142     5082        */
      143     5083    1       OA.UWSSZ = CONTROL.NEXT_UWA_LOC;
      144     5084    1       OA.SCNAM.EIS.REG = 6;
      145     5085    1       OA.SCNAM.EIS.OFFSET.WD = %OA_BASE_SIZE + 1;
      146     5086    1       CALL FIND_LENGTH(CONTROL.SCHEMA_NAME,I);
      147     5087    1       OA.SCNAM.EIS.COUNT = I;
      148     5088    1       OA.SSNAM.EIS.REG = 6;
      149     5089    1       OA.SSNAM.EIS.OFFSET.WD = %OA_BASE_SIZE + (L_SCHEMA)/4 + 1;
      150     5090    1       CALL FIND_LENGTH(CONTROL.SUBSCHEMA_NAME,I);
      151     5091    1       OA.SSNAM.EIS.COUNT = I;
      152     5092    1       OA.SSDT = CONTROL.SUBSCHEMA_UTS;
      153     5093    1       CALL M$TIME (TIME_FPT);
      154     5094    1       CONTROL.VALIDATION_UTS = UTSS;
      155     5095    1       OA.SSVDT = UTSS;
      156     5096    1       OA.CSZ = %CUR_SIZE_INIT;
      157     5097    1       OA.UWSZ = CONTROL.NEXT_UWA_LOC;
      158     5098    1       OA.SNAM = TEMP_WORD;
      159     5099    1       TPTR$ = PINCRW(SSS$,OA.SSNAM.EIS.OFFSET.WD);
      160     5100    1       CALL INSERT(TPTR$ -> SSNAME,0,OA.SSNAM.EIS.COUNT,SUBSTR(
      161     5101    1          CONTROL.SUBSCHEMA_NAME,0,OA.SSNAM.EIS.COUNT));
      162     5102    1       LAST_DP = 1; /* offset of OA record. */
      163     5103    2       DO WHILE ('1'B);
      164     5104        /*
      165     5105              DP, AG, and PL tranformation.
      166     5106            Get each PN record along the DA_PN set.
      167     5107            The DA is still current.
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:9    
      168     5108            Build the sturctures in the schema subset part of the
      169     5109            dynamic memory segment and put names and DBK in the
      170     5110            hash table for fast access to the record.
      171     5111        */
      172     5112    2           CALL FETCHNS_6('DA-PN   ') ALTRET(END_DA_PN);
      173     5113    2           PNDBK = UWA.DIRECT_REF;
      174     5114    2           CALL ADD_DP;
      175     5115    2           END;
      176     5116    1   END_DA_PN:
      177     5117    1       IF UWA.DB_STATUS ~= %END_OF_SET
      178     5118    1       THEN CALL ABORT;
      179     5119    1       RETURN;
      180     5120    1   END ZIG$V_OA;

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:10   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIG$V_OA.

   Procedure ZIG$V_OA requires 258 words for executable code.
   Procedure ZIG$V_OA requires 16 words of local(AUTO) storage.

    No errors detected in file ZIG$V_OA.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:11   

 Object Unit name= ZIG$V_OA                                   File name= ZIG$V_OA.:ZIC0TOU
 UTS= SEP 05 '97 12:21:53.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    26     32  ZIG$V_OA
    2  LblCom even  none     5      5  LANG_ALLOWED
    3  LblCom even  none     1      1  SUB_LANGUAGE
    4  LblCom even  none    16     20  HEADING_TEXT
    5  LblCom even  none    13     15  LANG_TEXT
    6  LblCom even  none     1      1  HASH_SCHEMA_NAME
    7  LblCom even  none     1      1  CURRENT_RECORD
    8  LblCom even  none    64    100  CONTROL
    9  LblCom even  none     1      1  NUM_ERROR_MSG
   10  LblCom even  none     1      1  NUM_WARN_MSG
   11  LblCom even  none     1      1  ALLOCATE_END
   12  LblCom even  none     2      2  SUBSCHEMA_KEY
   13  LblCom even  none     1      1  BUFFER$
   14  LblCom even  none     1      1  ERROR_IO
   15  LblCom even  none     1      1  BUFFER_LEN
   16  LblCom even  none     2      2  UWA_KEY
   17  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   18  LblCom even  none     2      2  RVA_KEY
   19  LblCom even  none     2      2  IA__KEY
   20  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   21  LblCom even  none    32     40  SEARCHR_NB
   22  LblCom even  none    32     40  SEM_COM
   23  LblCom even  none    32     40  DMCL_XLATE
   24  LblCom even  none    32     40  Q2_PERCENT
   25  LblCom even  none     1      1  SSS$
   26  LblCom even  none     1      1  OA$
   27  LblCom even  none     1      1  OA1$
   28  LblCom even  none     1      1  DP$
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:12   
   29  LblCom even  none     1      1  DP1$
   30  LblCom even  none   656   1220  UWA
   31  LblCom even  none     1      1  MEMORY_USED_SSS
   32  RoData even  UTS      4      4  ZIG$V_OA
   33   Proc  even  none   258    402  ZIG$V_OA
   34  RoData even  none    23     27  ZIG$V_OA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    33      0   yes            yes      Std        0  ZIG$V_OA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 ZIG$G_DYN_MEM_6
         yes           Std       3 SRCHD
 yes     yes           Std       1 FETCHNS_6
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:13   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:14   


        1        1        /*M*     ZIG$V_OA       I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_OA
        9        9        PURPOSE:
       10       10              To build a OA record in the schema subset and initialize
       11       11            it with the all the things I can from the control block
       12       12            of the subschema.
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V        OOO   AAA
       16       16            Z   I   G   G  $$$  V   V       O O O A   A
       17       17           Z    I   G     $ $   V   V       O O O A   A
       18       18          Z     I   G      $$$  V   V       O  OO AAAAA
       19       19         Z      I   G  GG   $ $ V   V       O   O A   A
       20       20        Z       I   G   G  $$$   V V        O   O A   A
       21       21        ZZZZZ  III   GGG    $     V          OOO  A   A
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:15   
       25       25        ZIG$V_OA:
       26       26            PROC;

     26 33 000000   000000 700200 xent  ZIG$V_OA     TSX0  ! X66_AUTO_0
        33 000001   000020 000000                    ZERO    16,0
        33 000002   000130 710000 33                 TRA     s:5045

       27       27        /*
       28       28              This subroutine assumes that PRVAL has be called and
       29       29            this is really a subschema file that we are working with.
       30       30            Also it assumes that PRVAL read in the control block
       31       31            into CONTROL.
       32       32        */
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE CP_6_SUBS;
       35      654        %FPT_TIME (FPTN = TIME_FPT,DEST=UTS,TSTAMP=UTSS);
       36      673        %INCLUDE ZI_ERRORS_SUBS;
       37     1193        %INCLUDE ZI_SUB_LANG;
       38     2908        %GENERAL;
       39     3032        %CONTROL_BLOCK;
       40     3140        %INCLUDE ZIG_GENERAL;
       41     3248        %INCLUDE ZIG_TYPE_SUBS;
       42     3263        %INCLUDE ZIG_SSS;
       43     3833        %SS_GENERAL(PSTCLASS=EXT);
       44     3854        %OA(PSTCLASS=EXT);
       45     3921        %OA1(PSTCLASS=EXT);
       46     3929        %DP(PSTCLASS=EXT);
       47     3943        %DP1(PSTCLASS=EXT);
       48     3951        %INCLUDE ZIG_DBA_INT;
       49     3999        %INCLUDE ZI_SUB4_CAN;
       50     4656        %UWA;
       51     4991        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:16   
       52     4992    1   DCL UTSS UBIN (36) STATIC ALIGNED;
       53     4993    1   DCL I UBIN (36);
       54     4994    1   DCL TPTR$ PTR;
       55     4995    1   DCL L_SCHEMA UBIN (36);
       56     4996    1   DCL L_SUBSCH UBIN (36);
       57     4997    1   DCL SUCC BIT (1);
       58     4998    1   DCL LAST_DP UBIN (36) STATIC;
       59     4999    1   DCL PNDBK UBIN (36) STATIC;
       60     5000    1   DCL TEMP_WORD CHAR (30) STATIC;
       61     5001    1   DCL MEMORY_USED_SSS UBIN WORD EXT;
       62     5002        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:17   
       63     5003    1   FIND_LENGTH:

   5003 33 000003   200010 741300       FIND_LENGTH  STX1  ! SUCC+1,,AUTO

       64     5004    1       PROC(STRING_TO_GET,RETURN_LENGTH);
       65     5005    2   DCL RETURN_LENGTH UBIN (36);
       66     5006    2   DCL STRING_TO_GET CHAR (30);
       67     5007    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);

   5007 33 000004   200012 470500                    LDP0    @RETURN_LENGTH,,AUTO
        33 000005   200011 471500                    LDP1    @STRING_TO_GET,,AUTO
        33 000006   000000 124500                    SCM     mask='000'O
        33 000007   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        33 000010   000000 000001 34                 ADSC9   0                        cn=0,n=1
        33 000011   000000 000100                    ARG     0,,PR0
        33 000012   000015 606400 33                 TTN     NOT_BLANK

       68     5008    2       RETURN;

   5008 33 000013   200010 221300                    LDX1  ! SUCC+1,,AUTO
        33 000014   000001 702211                    TSX2  ! 1,X1

       69     5009    2   NOT_BLANK:
       70     5010    2       RETURN_LENGTH = 30;

   5010 33 000015   000036 235007       NOT_BLANK    LDA     30,DL
        33 000016   200012 470500                    LDP0    @RETURN_LENGTH,,AUTO
        33 000017   000000 755100                    STA     0,,PR0

       71     5011    2       RETURN;

   5011 33 000020   200010 221300                    LDX1  ! SUCC+1,,AUTO
        33 000021   000001 702211                    TSX2  ! 1,X1

       72     5012    2   END FIND_LENGTH;
       73     5013        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:18   
       74     5014        /*
       75     5015            THIS SUBROUTINE CHANGES COBOL WORDS INTO SCHEMA WORDS '_' TO '-'.
       76     5016        */
       77     5017    1   CHANGE_TO_STR_SCH:

   5017 33 000022   200010 741300       CHANGE_TO_S* STX1  ! SUCC+1,,AUTO

       78     5018    1       PROC (CHANGE_STR);
       79     5019    2   DCL CHANGE_STR CHAR (30);
       80     5020    2   DCL COUNT1 UBIN (36);
       81     5021    2   DCL ONE_CHANGE (0:4) CHAR (2) STATIC INIT ('  ',
       82     5022    2    '-_' /* COBOL */, '$_' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
       83     5023    2       IF SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC THEN RETURN;

   5023 33 000023   000000 235000 3                  LDA     SUB_LANGUAGE
        33 000024   000003 115007                    CMPA    3,DL
        33 000025   000030 600000 33                 TZE     s:5023+5
        33 000026   000004 115007                    CMPA    4,DL
        33 000027   000031 601000 33                 TNZ     s:5024

   5023 33 000030   000001 702211                    TSX2  ! 1,X1

       84     5024    2       CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);

   5024 33 000031   000001 735000                    ALS     1
        33 000032   200011 470500                    LDP0    @CHANGE_STR,,AUTO
        33 000033   000005 124500                    SCM     mask='000'O
        33 000034   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        33 000035   000027 000001 1                  ADSC9   ONE_CHANGE,A             cn=0,n=1
        33 000036   200012 000100                    ARG     COUNT1,,AUTO

       85     5025    3       DO WHILE (COUNT1~= 30);

   5025 33 000037   200012 236100                    LDQ     COUNT1,,AUTO
        33 000040   000036 116007                    CMPQ    30,DL
        33 000041   000062 600000 33                 TZE     s:5029

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:19   
       86     5026    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));

   5026 33 000042   000000 235000 3                  LDA     SUB_LANGUAGE
        33 000043   000001 735000                    ALS     1
        33 000044   200011 470500                    LDP0    @CHANGE_STR,,AUTO
        33 000045   200012 236100                    LDQ     COUNT1,,AUTO
        33 000046   040106 100405                    MLR     fill='040'O
        33 000047   000027 200001 1                  ADSC9   ONE_CHANGE,A             cn=1,n=1
        33 000050   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

       87     5027    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);

   5027 33 000051   000000 235000 3                  LDA     SUB_LANGUAGE
        33 000052   000001 735000                    ALS     1
        33 000053   000005 124500                    SCM     mask='000'O
        33 000054   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        33 000055   000027 000001 1                  ADSC9   ONE_CHANGE,A             cn=0,n=1
        33 000056   200012 000100                    ARG     COUNT1,,AUTO

       88     5028    3           END;

   5028 33 000057   200012 236100                    LDQ     COUNT1,,AUTO
        33 000060   000036 116007                    CMPQ    30,DL
        33 000061   000042 601000 33                 TNZ     s:5026

       89     5029    2       RETURN;

   5029 33 000062   200010 221300                    LDX1  ! SUCC+1,,AUTO
        33 000063   000001 702211                    TSX2  ! 1,X1

       90     5030    2   END CHANGE_TO_STR_SCH;
       91     5031        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:20   
       92     5032    1   ADD_DP:

   5032 33 000064   200010 741300       ADD_DP       STX1  ! SUCC+1,,AUTO

       93     5033    1       PROC;
       94     5034    2       CALL ZIG$G_DYN_MEM_6(1,DP1$);

   5034 33 000065   000003 630400 34                 EPPR0   3
        33 000066   000001 631400 34                 EPPR1   1
        33 000067   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        33 000070   000000 011000                    NOP     0

       95     5035    2       TPTR$ = PINCRW(SSS$,LAST_DP-1);

   5035 33 000071   000015 236000 1                  LDQ     LAST_DP
        33 000072   000022 736000                    QLS     18
        33 000073   000001 136003                    SBLQ    1,DU
        33 000074   000000 036000 25                 ADLQ    SSS$
        33 000075   200004 756100                    STQ     TPTR$,,AUTO

       96     5036    2       DP1$ -> DP1.XXDPN = TPTR$ -> DP1.XXDPN;

   5036 33 000076   200004 470500                    LDP0    TPTR$,,AUTO
        33 000077   000000 220100                    LDX0    0,,PR0
        33 000100   000000 471400 29                 LDP1    DP1$
        33 000101   100000 740100                    STX0    0,,PR1

       97     5037    2       TPTR$-> DP1.XXDPN = POFFW(DP1$,SSS$) + 1;

   5037 33 000102   000000 235000 25                 LDA     SSS$
        33 000103   000022 771000                    ARL     18
        33 000104   200014 755100                    STA     COUNT1+2,,AUTO
        33 000105   000000 236000 29                 LDQ     DP1$
        33 000106   000022 772000                    QRL     18
        33 000107   200014 136100                    SBLQ    COUNT1+2,,AUTO
        33 000110   000001 620006                    EAX0    1,QL
        33 000111   000000 740100                    STX0    0,,PR0
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:21   

       98     5038        /*
       99     5039              Put the DP record in the OA-DP set and connected it up.
      100     5040        */
      101     5041    2       CALL ZIG$G_DYN_MEM_6(%DP_BASE_SIZE,DP$);

   5041 33 000112   000006 630400 34                 EPPR0   6
        33 000113   000001 631400 34                 EPPR1   1
        33 000114   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        33 000115   000000 011000                    NOP     0

      102     5042    2       DP.DEF.TYPE = '000000000010'B;

   5042 33 000116   000000 470400 28                 LDP0    DP$
        33 000117   000200 236003                    LDQ     128,DU
        33 000120   000000 752160                    STCQ    0,'60'O,PR0

      103     5043    2       DP.DEF.CTYP = 1; /* PL6 only! */

   5043 33 000121   000000 470400 28                 LDP0    DP$
        33 000122   000000 236100                    LDQ     0,,PR0
        33 000123   000010 376000 34                 ANQ     8
        33 000124   100000 276007                    ORQ     32768,DL
        33 000125   000000 756100                    STQ     0,,PR0

      104     5044    2   END ADD_DP;

   5044 33 000126   200010 221300                    LDX1  ! SUCC+1,,AUTO
        33 000127   000001 702211                    TSX2  ! 1,X1

      105     5045    1       ALLOCATE_END = 0;

   5045 33 000130   000000 450000 11                 STZ     ALLOCATE_END

      106     5046        /*
      107     5047              Allocate dynamic storage from start of dynamic storage.
      108     5048        */
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:22   
      109     5049    1       MEMORY_USED_SSS = 0;

   5049 33 000131   000000 450000 31                 STZ     MEMORY_USED_SSS

      110     5050    1       CALL ZIG$G_DYN_MEM_6(1,OA1$);

   5050 33 000132   000011 630400 34                 EPPR0   9
        33 000133   000001 631400 34                 EPPR1   1
        33 000134   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        33 000135   000000 011000                    NOP     0

      111     5051    1       SSS$ = OA1$;

   5051 33 000136   000000 236000 27                 LDQ     OA1$
        33 000137   000000 756000 25                 STQ     SSS$

      112     5052    1       CALL SRCHD(CONTROL.SCHEMA_NAME,%ZIG_RTYPE_OA,SUCC);

   5052 33 000140   200007 630500                    EPPR0   SUCC,,AUTO
        33 000141   200016 450500                    STP0    COUNT1+4,,AUTO
        33 000142   000016 237000 34                 LDAQ    14
        33 000143   200014 757100                    STAQ    COUNT1+2,,AUTO
        33 000144   200014 630500                    EPPR0   COUNT1+2,,AUTO
        33 000145   000013 631400 34                 EPPR1   11
        33 000146   000000 701000 xent               TSX1    SRCHD
        33 000147   000000 011000                    NOP     0

      113     5053        /*
      114     5054              Got the OA record of the schema and the DA record.
      115     5055        */
      116     5056    1       CALL FIND_LENGTH(CONTROL.SUBSCHEMA_NAME,L_SUBSCH);

   5056 33 000150   200006 630500                    EPPR0   L_SUBSCH,,AUTO
        33 000151   200012 450500                    STP0    @CHANGE_STR+1,,AUTO
        33 000152   000015 236000 34                 LDQ     13
        33 000153   200011 756100                    STQ     SUCC+2,,AUTO
        33 000154   000003 701000 33                 TSX1    FIND_LENGTH
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:23   
        33 000155   000000 011000                    NOP     0

      117     5057    1       CALL FIND_LENGTH(CONTROL.SCHEMA_NAME,L_SCHEMA);

   5057 33 000156   200005 630500                    EPPR0   L_SCHEMA,,AUTO
        33 000157   200012 450500                    STP0    @CHANGE_STR+1,,AUTO
        33 000160   000016 236000 34                 LDQ     14
        33 000161   200011 756100                    STQ     SUCC+2,,AUTO
        33 000162   000003 701000 33                 TSX1    FIND_LENGTH
        33 000163   000000 011000                    NOP     0

      118     5058    1       TEMP_WORD = CONTROL.SCHEMA_NAME;

   5058 33 000164   040000 100400                    MLR     fill='040'O
        33 000165   000020 000036 8                  ADSC9   CONTROL+16               cn=0,n=30
        33 000166   000017 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      119     5059    1       CALL CHANGE_TO_STR_SCH(TEMP_WORD);

   5059 33 000167   000020 236000 34                 LDQ     16
        33 000170   200011 756100                    STQ     SUCC+2,,AUTO
        33 000171   000022 701000 33                 TSX1    CHANGE_TO_STR_SCH
        33 000172   000000 011000                    NOP     0

      120     5060    1       IF MOD(L_SUBSCH,4) ~= 0

   5060 33 000173   200006 236100                    LDQ     L_SUBSCH,,AUTO
        33 000174   000003 376007                    ANQ     3,DL
        33 000175   000205 600000 33                 TZE     s:5062

      121     5061    1       THEN L_SUBSCH = L_SUBSCH + 4 - MOD(L_SUBSCH,4);

   5061 33 000176   200006 236100                    LDQ     L_SUBSCH,,AUTO
        33 000177   000003 376007                    ANQ     3,DL
        33 000200   200014 756100                    STQ     COUNT1+2,,AUTO
        33 000201   200006 236100                    LDQ     L_SUBSCH,,AUTO
        33 000202   200014 136100                    SBLQ    COUNT1+2,,AUTO
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:24   
        33 000203   000004 036007                    ADLQ    4,DL
        33 000204   200006 756100                    STQ     L_SUBSCH,,AUTO

      122     5062    1       IF MOD(L_SCHEMA,4) ~= 0

   5062 33 000205   200005 236100                    LDQ     L_SCHEMA,,AUTO
        33 000206   000003 376007                    ANQ     3,DL
        33 000207   000217 600000 33                 TZE     s:5064

      123     5063    1       THEN L_SCHEMA = L_SCHEMA + 4 - MOD(L_SCHEMA,4);

   5063 33 000210   200005 236100                    LDQ     L_SCHEMA,,AUTO
        33 000211   000003 376007                    ANQ     3,DL
        33 000212   200014 756100                    STQ     COUNT1+2,,AUTO
        33 000213   200005 236100                    LDQ     L_SCHEMA,,AUTO
        33 000214   200014 136100                    SBLQ    COUNT1+2,,AUTO
        33 000215   000004 036007                    ADLQ    4,DL
        33 000216   200005 756100                    STQ     L_SCHEMA,,AUTO

      124     5064    1       CALL ZIG$G_DYN_MEM_6(%OA_BASE_SIZE+(L_SCHEMA+L_SUBSCH)/4,OA$);

   5064 33 000217   200005 236100                    LDQ     L_SCHEMA,,AUTO
        33 000220   200006 036100                    ADLQ    L_SUBSCH,,AUTO
        33 000221   000002 772000                    QRL     2
        33 000222   000025 036007                    ADLQ    21,DL
        33 000223   200014 756100                    STQ     COUNT1+2,,AUTO
        33 000224   000021 236000 34                 LDQ     17
        33 000225   200017 756100                    STQ     COUNT1+5,,AUTO
        33 000226   200014 630500                    EPPR0   COUNT1+2,,AUTO
        33 000227   200016 450500                    STP0    COUNT1+4,,AUTO
        33 000230   200016 630500                    EPPR0   COUNT1+4,,AUTO
        33 000231   000001 631400 34                 EPPR1   1
        33 000232   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        33 000233   000000 011000                    NOP     0

      125     5065        /*
      126     5066              OA size = number of words in schema name
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:25   
      127     5067                      + number of words in subschema name
      128     5068                      + constant (22)
      129     5069        */
      130     5070        %EJECT;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:26   
      131     5071        /*
      132     5072              Now init every thing in the schema subset to the
      133     5073            initial values.
      134     5074        */
      135     5075    1       OA.DEF.TYPE = '100000000000'B; /* '4000'O */

   5075 33 000234   000000 470400 26                 LDP0    OA$
        33 000235   400000 236003                    LDQ     -131072,DU
        33 000236   000000 752160                    STCQ    0,'60'O,PR0

      136     5076    1       OA.DEF.STI = '1'B; /* TRANSLATION OK */

   5076 33 000237   000000 470400 26                 LDP0    OA$
        33 000240   000040 236003                    LDQ     32,DU
        33 000241   000000 256100                    ORSQ    0,,PR0

      137     5077    1       OA.DEF.SSL = SUB_LANGUAGE;

   5077 33 000242   000000 470400 26                 LDP0    OA$
        33 000243   000000 236000 3                  LDQ     SUB_LANGUAGE
        33 000244   000022 736000                    QLS     18
        33 000245   000000 676100                    ERQ     0,,PR0
        33 000246   000007 376003                    ANQ     7,DU
        33 000247   000000 656100                    ERSQ    0,,PR0

      138     5078        /*W*
      139     5079              All set in the schema subset end with the value 0 and all
      140     5080            dynamic memory is initialized to zero so not initialization
      141     5081            is needed.
      142     5082        */
      143     5083    1       OA.UWSSZ = CONTROL.NEXT_UWA_LOC;

   5083 33 000250   000051 720000 8                  LXL0    CONTROL+41
        33 000251   000000 470400 26                 LDP0    OA$
        33 000252   000002 440100                    SXL0    2,,PR0

      144     5084    1       OA.SCNAM.EIS.REG = 6;
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:27   

   5084 33 000253   000004 236100                    LDQ     4,,PR0
        33 000254   000022 376000 34                 ANQ     18
        33 000255   600000 276003                    ORQ     -65536,DU
        33 000256   000004 756100                    STQ     4,,PR0

      145     5085    1       OA.SCNAM.EIS.OFFSET.WD = %OA_BASE_SIZE + 1;

   5085 33 000257   000004 236100                    LDQ     4,,PR0
        33 000260   000023 376000 34                 ANQ     19
        33 000261   000026 276003                    ORQ     22,DU
        33 000262   000004 756100                    STQ     4,,PR0

      146     5086    1       CALL FIND_LENGTH(CONTROL.SCHEMA_NAME,I);

   5086 33 000263   200003 631500                    EPPR1   I,,AUTO
        33 000264   200012 451500                    STP1    @CHANGE_STR+1,,AUTO
        33 000265   000016 236000 34                 LDQ     14
        33 000266   200011 756100                    STQ     SUCC+2,,AUTO
        33 000267   000003 701000 33                 TSX1    FIND_LENGTH
        33 000270   000000 011000                    NOP     0

      147     5087    1       OA.SCNAM.EIS.COUNT = I;

   5087 33 000271   000000 470400 26                 LDP0    OA$
        33 000272   200003 236100                    LDQ     I,,AUTO
        33 000273   000004 752103                    STCQ    4,'03'O,PR0

      148     5088    1       OA.SSNAM.EIS.REG = 6;

   5088 33 000274   000005 236100                    LDQ     5,,PR0
        33 000275   000022 376000 34                 ANQ     18
        33 000276   600000 276003                    ORQ     -65536,DU
        33 000277   000005 756100                    STQ     5,,PR0

      149     5089    1       OA.SSNAM.EIS.OFFSET.WD = %OA_BASE_SIZE + (L_SCHEMA)/4 + 1;

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:28   
   5089 33 000300   200005 236100                    LDQ     L_SCHEMA,,AUTO
        33 000301   000002 772000                    QRL     2
        33 000302   000026 036007                    ADLQ    22,DL
        33 000303   000022 736000                    QLS     18
        33 000304   000005 676100                    ERQ     5,,PR0
        33 000305   077777 376003                    ANQ     32767,DU
        33 000306   000005 656100                    ERSQ    5,,PR0

      150     5090    1       CALL FIND_LENGTH(CONTROL.SUBSCHEMA_NAME,I);

   5090 33 000307   200003 631500                    EPPR1   I,,AUTO
        33 000310   200012 451500                    STP1    @CHANGE_STR+1,,AUTO
        33 000311   000015 236000 34                 LDQ     13
        33 000312   200011 756100                    STQ     SUCC+2,,AUTO
        33 000313   000003 701000 33                 TSX1    FIND_LENGTH
        33 000314   000000 011000                    NOP     0

      151     5091    1       OA.SSNAM.EIS.COUNT = I;

   5091 33 000315   000000 470400 26                 LDP0    OA$
        33 000316   200003 236100                    LDQ     I,,AUTO
        33 000317   000005 752103                    STCQ    5,'03'O,PR0

      152     5092    1       OA.SSDT = CONTROL.SUBSCHEMA_UTS;

   5092 33 000320   000053 235000 8                  LDA     CONTROL+43
        33 000321   000007 755100                    STA     7,,PR0

      153     5093    1       CALL M$TIME (TIME_FPT);

   5093 33 000322   000000 630400 1                  EPPR0   TIME_FPT
        33 000323   020004 713400                    CLIMB   8196
        33 000324   402000 401760                    pmme    nvectors=5

      154     5094    1       CONTROL.VALIDATION_UTS = UTSS;

   5094 33 000325   000014 235000 1                  LDA     UTSS
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:29   
        33 000326   000055 755000 8                  STA     CONTROL+45

      155     5095    1       OA.SSVDT = UTSS;

   5095 33 000327   000000 470400 26                 LDP0    OA$
        33 000330   000011 755100                    STA     9,,PR0

      156     5096    1       OA.CSZ = %CUR_SIZE_INIT;

   5096 33 000331   000012 220003                    LDX0    10,DU
        33 000332   000017 740100                    STX0    15,,PR0

      157     5097    1       OA.UWSZ = CONTROL.NEXT_UWA_LOC;

   5097 33 000333   000051 721000 8                  LXL1    CONTROL+41
        33 000334   000020 741100                    STX1    16,,PR0

      158     5098    1       OA.SNAM = TEMP_WORD;

   5098 33 000335   000004 722100                    LXL2    4,,PR0
        33 000336   007777 362003                    ANX2    4095,DU
        33 000337   040140 100400                    MLR     fill='040'O
        33 000340   000017 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30
        33 000341   000025 000012                    ADSC9   21,,PR0                  cn=0,n=*X2

      159     5099    1       TPTR$ = PINCRW(SSS$,OA.SSNAM.EIS.OFFSET.WD);

   5099 33 000342   000005 223100                    LDX3    5,,PR0
        33 000343   077777 363003                    ANX3    32767,DU
        33 000344   000000 636013                    EAQ     0,X3
        33 000345   000000 036000 25                 ADLQ    SSS$
        33 000346   200004 756100                    STQ     TPTR$,,AUTO

      160     5100    1       CALL INSERT(TPTR$ -> SSNAME,0,OA.SSNAM.EIS.COUNT,SUBSTR(

   5100 33 000347   000005 724100                    LXL4    5,,PR0
        33 000350   007777 364003                    ANX4    4095,DU
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:30   
        33 000351   000005 725100                    LXL5    5,,PR0
        33 000352   007777 365003                    ANX5    4095,DU
        33 000353   200004 471500                    LDP1    TPTR$,,AUTO
        33 000354   040140 100440                    MLR     fill='040'O
        33 000355   000030 000014 8                  ADSC9   CONTROL+24               cn=0,n=*X4
        33 000356   100000 000015                    ADSC9   0,,PR1                   cn=0,n=*X5

      161     5101    1          CONTROL.SUBSCHEMA_NAME,0,OA.SSNAM.EIS.COUNT));
      162     5102    1       LAST_DP = 1; /* offset of OA record. */

   5102 33 000357   000001 235007                    LDA     1,DL
        33 000360   000015 755000 1                  STA     LAST_DP

      163     5103    2       DO WHILE ('1'B);

      164     5104        /*
      165     5105              DP, AG, and PL tranformation.
      166     5106            Get each PN record along the DA_PN set.
      167     5107            The DA is still current.
      168     5108            Build the sturctures in the schema subset part of the
      169     5109            dynamic memory segment and put names and DBK in the
      170     5110            hash table for fast access to the record.
      171     5111        */
      172     5112    2           CALL FETCHNS_6('DA-PN   ') ALTRET(END_DA_PN);

   5112 33 000361   000025 630400 34                 EPPR0   21
        33 000362   000024 631400 34                 EPPR1   20
        33 000363   000000 701000 xent               TSX1    FETCHNS_6
        33 000364   000372 702000 33                 TSX2    END_DA_PN

      173     5113    2           PNDBK = UWA.DIRECT_REF;

   5113 33 000365   000036 235000 30                 LDA     UWA+30
        33 000366   000016 755000 1                  STA     PNDBK

      174     5114    2           CALL ADD_DP;

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:31   
   5114 33 000367   000064 701000 33                 TSX1    ADD_DP
        33 000370   000000 011000                    NOP     0

      175     5115    2           END;

   5115 33 000371   000361 710000 33                 TRA     s:5112

      176     5116    1   END_DA_PN:
      177     5117    1       IF UWA.DB_STATUS ~= %END_OF_SET

   5117 33 000372   040000 106400       END_DA_PN    CMPC    fill='040'O
        33 000373   000001 000007 30                 ADSC9   UWA+1                    cn=0,n=7
        33 000374   000002 000007 32                 ADSC9   2                        cn=0,n=7
        33 000375   000401 600000 33                 TZE     s:5119

      178     5118    1       THEN CALL ABORT;

   5118 33 000376   000026 631400 34                 EPPR1   22
        33 000377   000000 701000 xent               TSX1    ABORT
        33 000400   000000 011000                    NOP     0

      179     5119    1       RETURN;

   5119 33 000401   000000 702200 xent               TSX2  ! X66_ARET

TIME_FPT
 Sect OctLoc
   1     000   000001 777640   000012 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     010   000000 777640   000014 006000   000004 000000   ****** ******    ................

TEMP_WORD
 Sect OctLoc
   1     017   ****** ******   ****** ******   ****** ******   ****** ******    ................

ONE_CHANGE
 Sect OctLoc
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:32   
   1     027   040040 055137   044137 137137   137137 ******                      -_$_____..

LANG_ALLOWED
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
   5     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
   5     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
   5     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
   5     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
   6     000   0***** ******                                                    ....

CONTROL
 Sect OctLoc
   8     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
   8     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
   8     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
   8     020*  040040 040040   040040 040040   040040 040040   040040 040040
   8     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
   8     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
   8     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
   8     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   8     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
   8     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   8     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

UWA_KEY
 Sect OctLoc
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:33   
  16     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  18     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  19     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  21     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  21     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  21     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  21     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  22     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  22     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  22     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  22     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  22     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  22     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  22     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  22     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  23     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  23     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  23     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  23     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  23     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  23     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  23     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:34   
  23     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  24     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  24     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  24     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  24     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  24     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  24     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  24     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  24     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  30     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  30     004   040040 040040   040040 040040   040040 040040   040040 040040
  30     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  30     014   040040 040040   040040 040040   040040 040040   040040 040040
  30     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  30     024   040040 040040   040040 040040   040040 040040   040040 040040
  30     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  30     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  30     040   040040 040040   040040 040040   040040 040040   040040 040040
  30     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  30     050   040040 040040   040040 040040   040040 040040   040040 040040
  30     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  30     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  30     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  30     070   040040 040040   040040 040040   040040 040040   040040 040040
  30     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  30     104   040040 040040   040040 040040   040040 040040   040040 040040
  30     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  30     130   040040 040040   040040 040040   040040 040040   040040 040040
  30     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  30     140   040040 040040   040040 040040   040040 040040   040040 040040
  30     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:35   
  30     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     154   040040 040040   040040 040040   040040 040040   040040 040040
  30     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  30     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  30     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  30     174   040040 040040   040040 040040   040040 040040   040040 040040
  30     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  30     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  30     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  30     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  30     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  30     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  30     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  30     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  30     430   040040 040040   040040 040040   040040 040040   040040 040040
  30     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  30     440   040040 040040   040040 040040   040040 040040   040040 040040
  30     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  30     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  30     460   040040 040040   040040 040040   040040 040040   040040 040040
  30     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  30     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  30     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  30     504   040040 040040   040040 040040   040040 040040   040040 040040
  30     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  30     524   040040 040040   040040 040040   040040 040040   040040 040040
  30     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  30     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:36   
  30     614   040040 040040   040040 040040   040040 040040   040040 040040
  30     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  30     624   040040 040040   040040 040040   040040 040040   040040 040040
  30     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  30     664   040040 040040   040040 040040   040040 040040   040040 040040
  30     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30     700   040040 040040   040040 040040   040040 040040   040040 040040
  30     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30     714   040040 040040   040040 040040   040040 040040   040040 040040
  30     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  30     724   040040 040040   040040 040040   040040 040040   040040 040040
  30     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30     744   040040 040040   040040 040040   040040 040040   040040 040040
  30     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1000   040040 040040   040040 040040   040040 040040   040040 040040
  30    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1040   040040 040040   040040 040040   040040 040040   040040 040040
  30    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1064   040040 040040   040040 040040   040040 040040   040040 040040
  30    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1120   040040 040040   040040 040040   040040 040040   040040 040040
  30    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  30    1140   040040 040040   040040 040040   040040 040040   040040 040040
  30    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  30    1154   040040 040040   040040 040040   040040 040040   040040 040040
  30    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  30    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  30    1170   040040 040040   040040 040040   040040 040040   040040 040040
  30    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  30    1204   040040 040040   040040 040040   040040 040040   040040 040040
  30    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
  32     000   104101 055120   116040 040040   060065 060062   061060 060040    DA-PN   0502100

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:37   
(unnamed)
 Sect OctLoc
  34     000   040040 040040   000002 000000   000000 000001   000002 006000        ............
  34     004   000000 006000   000000 000003   000005 006000   000000 006000    ................
  34     010   777777 077777   000002 006000   000000 006000   000003 000000    ..?.............
  34     014   000000 000012   000030 006000   000020 006000   000014 006000    ................
  34     020   000017 006000   000000 006000   077777 777777   700000 777777    ........?.......
  34     024   000001 000000   000000 006000   000000 000000                    ............
      180     5120    1   END ZIG$V_OA;

PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:38   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIG$V_OA.

   Procedure ZIG$V_OA requires 258 words for executable code.
   Procedure ZIG$V_OA requires 16 words of local(AUTO) storage.

    No errors detected in file ZIG$V_OA.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:40   
          MINI XREF LISTING

ABORT
      3161**DCL-ENT  5118--CALL
ADD_DP
      5033**PROC     5114--CALL
ALLOCATE_END
      3164**DCL      5045<<ASSIGN
CHANGE_STR IN PROCEDURE CHANGE_TO_STR_SCH
      5019**DCL      5018--PROC     5024>>CALLBLT  5026<<CALLBLT  5027>>CALLBLT
CHANGE_TO_STR_SCH
      5018**PROC     5059--CALL
CONTROL.NEXT_UWA_LOC
      3119**DCL      5083>>ASSIGN   5097>>ASSIGN
CONTROL.SCHEMA_NAME
      3112**DCL      5052<>CALL     5057<>CALL     5058>>ASSIGN   5086<>CALL
CONTROL.SUBSCHEMA_NAME
      3113**DCL      5056<>CALL     5090<>CALL     5100>>CALLBLT
CONTROL.SUBSCHEMA_UTS
      3121**DCL      5092>>ASSIGN
CONTROL.VALIDATION_UTS
      3123**DCL      5094<<ASSIGN
COUNT1 IN PROCEDURE CHANGE_TO_STR_SCH
      5020**DCL      5024<<CALLBLT  5025>>DOWHILE  5026>>CALLBLT  5027<<CALLBLT
DP.DEF.CTYP
      3936**DCL      5043<<ASSIGN
DP.DEF.TYPE
      3934**DCL      5042<<ASSIGN
DP$
      3931**DCL      3932--IMP-PTR  5041<>CALL     5042>>ASSIGN   5043>>ASSIGN
DP1.XXDPN
      3947**DCL      5036<<ASSIGN   5036>>ASSIGN   5037<<ASSIGN
DP1$
      3945**DCL      3946--IMP-PTR  5034<>CALL     5036>>ASSIGN   5037>>ASSIGN
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:41   
END_DA_PN
      5117**LABEL    5112--CALLALT
FETCHNS_6
      3966**DCL-ENT  5112--CALL
FIND_LENGTH
      5004**PROC     5056--CALL     5057--CALL     5086--CALL     5090--CALL
I
      4993**DCL      5086<>CALL     5087>>ASSIGN   5090<>CALL     5091>>ASSIGN
LAST_DP
      4998**DCL      5035>>ASSIGN   5102<<ASSIGN
L_SCHEMA
      4995**DCL      5057<>CALL     5062>>IF       5063<<ASSIGN   5063>>ASSIGN   5063>>ASSIGN   5064>>CALL
      5089>>ASSIGN
L_SUBSCH
      4996**DCL      5056<>CALL     5060>>IF       5061<<ASSIGN   5061>>ASSIGN   5061>>ASSIGN   5064>>CALL
M$TIME
       109**DCL-ENT  5093--CALL
MEMORY_USED_SSS
      5001**DCL      5049<<ASSIGN
NOT_BLANK IN PROCEDURE FIND_LENGTH
      5010**LABEL    5007--CALLALT
OA.CSZ
      3904**DCL      5096<<ASSIGN
OA.DEF.SSL
      3863**DCL      5077<<ASSIGN
OA.DEF.STI
      3861**DCL      5076<<ASSIGN
OA.DEF.TYPE
      3860**DCL      5075<<ASSIGN
OA.SCNAM.EIS.COUNT
      3879**DCL      3916--IMP-SIZ  5087<<ASSIGN   5098>>ASSIGN
OA.SCNAM.EIS.OFFSET.WD
      3875**DCL      5085<<ASSIGN
OA.SCNAM.EIS.REG
      3873**DCL      5084<<ASSIGN
OA.SNAM
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:42   
      3916**DCL      5098<<ASSIGN
OA.SSDT
      3890**DCL      5092<<ASSIGN
OA.SSNAM.EIS.COUNT
      3888**DCL      5091<<ASSIGN   5100>>CALLBLT  5100>>CALLBLT
OA.SSNAM.EIS.OFFSET.WD
      3884**DCL      5089<<ASSIGN   5099>>ASSIGN
OA.SSNAM.EIS.REG
      3882**DCL      5088<<ASSIGN
OA.SSVDT
      3892**DCL      5095<<ASSIGN
OA.UWSSZ
      3868**DCL      5083<<ASSIGN
OA.UWSZ
      3906**DCL      5097<<ASSIGN
OA$
      3857**DCL      3858--IMP-PTR  5064<>CALL     5075>>ASSIGN   5076>>ASSIGN   5077>>ASSIGN   5083>>ASSIGN
      5084>>ASSIGN   5085>>ASSIGN   5087>>ASSIGN   5088>>ASSIGN   5089>>ASSIGN   5091>>ASSIGN   5092>>ASSIGN
      5095>>ASSIGN   5096>>ASSIGN   5097>>ASSIGN   5098>>ASSIGN   5098>>ASSIGN   5099>>ASSIGN   5100>>CALLBLT
      5100>>CALLBLT
OA1$
      3923**DCL      3924--IMP-PTR  5050<>CALL     5051>>ASSIGN
ONE_CHANGE IN PROCEDURE CHANGE_TO_STR_SCH
      5021**DCL      5024>>CALLBLT  5026>>CALLBLT  5027>>CALLBLT
PNDBK
      4999**DCL      5113<<ASSIGN
RETURN_LENGTH IN PROCEDURE FIND_LENGTH
      5005**DCL      5004--PROC     5007<<CALLBLT  5010<<ASSIGN
SRCHD
      3182**DCL-ENT  5052--CALL
SSNAME
      3917**DCL      5100<<CALLBLT
SSS$
      3852**DCL      5035>>ASSIGN   5037>>ASSIGN   5051<<ASSIGN   5099>>ASSIGN
STRING_TO_GET IN PROCEDURE FIND_LENGTH
      5006**DCL      5004--PROC     5007>>CALLBLT
PL6.E3A0      #001=ZIG$V_OA File=ZIG$V_OA.:ZIC0TSI                               FRI 09/05/97 12:21 Page:43   
SUBSCHEMA_KEY
      3188**DCL      3189--REDEF
SUB_LANGUAGE
      2916**DCL      5023>>IF       5023>>IF       5024>>CALLBLT  5026>>CALLBLT  5027>>CALLBLT  5077>>ASSIGN
SUCC
      4997**DCL      5052<>CALL
TEMP_WORD
      5000**DCL      5058<<ASSIGN   5059<>CALL     5098>>ASSIGN
TIME_FPT
       665**DCL      5093<>CALL
TIME_FPT.V
       669**DCL       665--DCLINIT
TPTR$
      4994**DCL      5035<<ASSIGN   5036>>ASSIGN   5037>>ASSIGN   5099<<ASSIGN   5100>>CALLBLT
UTSS
      4992**DCL       669--DCLINIT  5094>>ASSIGN   5095>>ASSIGN
UWA.AC.CALC_NEXT
      4767**DCL      4768--REDEF
UWA.AC.CALC_PRIOR
      4776**DCL      4777--REDEF
UWA.AC.DEFAULTS
      4728**DCL      4729--REDEF
UWA.AC.FILE_CODE
      4733**DCL      4734--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      4730**DCL      4731--REDEF
UWA.DB_STATUS
      4659**DCL      5117>>IF
UWA.DIRECT_REF
      4668**DCL      5113>>ASSIGN
ZIG$G_DYN_MEM_6
      3163**DCL-ENT  5034--CALL     5041--CALL     5050--CALL     5064--CALL
