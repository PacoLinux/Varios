VERSION E05

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:1    
        1        1        /*M* FOS$STATUS Job status co-ordinator */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOS$STATUS
       10       10
       11       11             PURPOSE:      To provide job status functions
       12       12        */
       13       13        FOS$PMME: PROC;
       14       14        /**/
       15       15        /*F* NAME:         FOS$PMME
       16       16
       17       17             PURPOSE:      To service the M$JOBSTATS PMME
       18       18        */
       19       19        /**/
       20       20
       21       21
       22       22
       23       23        /**/
       24       24        /* INCLUDES */
       25       25        /**/
       26       26        %INCLUDE CP_6_C;
       27     5505        %INCLUDE FOS_SUBS_C;
       28     5522        %INCLUDE FOS_DATA_R;
       29     5532        %INCLUDE JG_EVID_C;
       30     5757        %INCLUDE UM$CP6V_C;
       31     5944        %INCLUDE F$CP6V_C;
       32     6170        %INCLUDE B$JIT_C;
       33     6484        %INCLUDE FO_ERRORS_C;
       34     6516        %INCLUDE UD_SEV_C;
       35     6530        %INCLUDE SS_SCHED_C;
       36     6763        %INCLUDE FS$FIT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:2    
       37     6806        %INCLUDE FOO_SUBS_C;
       38     7042        %INCLUDE FOO_MAC_C;
       39     7790        /* %INCLUDE FOO_DATA_R; */
       40     7791        %INCLUDE JP_MACRO_C;
       41     7946        %INCLUDE JM_SUBS_C;
       42     8052        %INCLUDE JM$STRUCT;
       43     8797        /* +79,82 03/07/88 DAD #CLNUP */
       44     8798        %INCLUDE JMC$DATA;
       45     8809        %INCLUDE CP_6_SUBS;
       46     9349        %INCLUDE UD_ERRORS_C;
       47     9391        %INCLUDE JG_GHOSTS_C;
       48     9481
       49     9482
       50     9483
       51     9484        /**/
       52     9485        /* MACROS */
       53     9486        /**/
       54     9487        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       55     9488        DCL 1 NAME CONSTANT ALIGNED,
       56     9489              2 * BIT(18) UNAL INIT('061723'O),
       57     9490              2 * UBIN(15) UNAL INIT(CODE),
       58     9491              2 * UBIN(3) UNAL INIT(SEV);
       59     9492        %MEND;
       60     9493
       61     9494
       62     9495
       63     9496        /**/
       64     9497        /* BASED STRUCTURES */
       65     9498        /**/
       66     9499        %B$JIT0;
       67     9588        %A$JIT6X;
       68     9591        %VLR$JOBSTATS_CHECK_V (FPTN=R$CHECK,BASED="BASED(B$PS2$)");
       69     9596        %VLR$JOBSTATS_OSRCH_V (FPTN=R$OSRCH,BASED="BASED(B$PS2$)");
       70     9599        %VLR$JOBSTATS_ISRCH_V (FPTN=R$ISRCH,BASED="BASED(B$PS2$)");
       71     9602        %VLR$JOBSTATS_ISRCH_SN_V (FPTN=R$ISRCH_SN,BASED="BASED(B$PS6$)");
       72     9605        %VLR$JOBSTATS_ISRCH_RES_V (FPTN=R$ISRCH_RES,BASED="BASED(B$PS7$)");
       73     9608        %FPT$JOBSTATS_V (FPTN=FPT$JOBSTATS_V,BASED="BASED(B$PS0$)");
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:3    
       74     9612        %VLP$JOBNAME_V (FPTN=VLP$JOBNAME,BASED="BASED(B$PS4$)");
       75     9615        %VLP$ACCT_V (FPTN=VLP$ACCT,BASED="BASED(B$PS5$)");
       76     9618        %VLP$CRITERIA_V (FPTN=VLP$CRITERIA,BASED="BASED(B$PS3$)");
       77     9630        %VLA$JOBSTATS_OSRCH_V (FPTN=R$FILE);
       78     9637        %VLA$JOBSTATS_ISRCH_V (FPTN=R$JOB);
       79     9646        %JM_IF (FPTN=JM$IF,STCLASS=BASED);
       80     9804        %JM_SN (FPTN=JM$SN,STCLASS=BASED);
       81     9843        %JM_RES (FPTN=JM$QRIT,STCLASS=BASED);
       82     9880        %FO_FIL (FPTN=FO$FIL,STCLASS=BASED);
       83     9980        %FO_DEV (FPTN=FO$DEV,STCLASS=BASED);
       84    10079        %FO_JOB (FPTN=FO$JOB,STCLASS=BASED);
       85    10126        %FO_Q   (FPTN=FO$Q  ,STCLASS=BASED);
       86    10147        %JP$Q    (NAME=JP$Q  ,STCLASS=BASED);
       87    10178        %JP$JOB  (NAME=JP$JOB,STCLASS=BASED);
       88    10188    1   DCL B$$WSN CHAR(SEL_WSNL) BASED CALIGNED;
       89    10189
       90    10190
       91    10191
       92    10192        /**/
       93    10193        /* REFS */
       94    10194        /**/
       95    10195    1   DCL B$PS0$ PTR SYMREF;
       96    10196    1   DCL B$PS1$ PTR SYMREF;
       97    10197    1   DCL B$PS2$ PTR SYMREF;
       98    10198    1   DCL B$PS3$ PTR SYMREF;
       99    10199    1   DCL B$PS4$ PTR SYMREF;
      100    10200    1   DCL B$PS5$ PTR SYMREF;
      101    10201    1   DCL B$PS6$ PTR SYMREF;
      102    10202    1   DCL B$PS7$ PTR SYMREF;
      103    10203    1   DCL S_CUN UBIN WORD SYMREF;
      104    10204    1   DCL B$JIT$ PTR SYMREF;
      105    10205    1   DCL J_OUTSYM CHAR(8) SYMREF READONLY;
      106    10206    1   DCL J_MBS CHAR(8) SYMREF READONLY;
      107    10207
      108    10208    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      109    10209    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      110    10210    1   DCL KUW$WRITE     ENTRY(3) ALTRET;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:4    
      111    10211    1   DCL MMS$COMPACT   ENTRY(1) ALTRET;
      112    10212    1   DCL MMS$VGET      ENTRY(4) ALTRET;
      113    10213    1   DCL MMS$VREL      ENTRY(2) ALTRET;
      114    10214    1   DCL SSR$REG       ENTRY(3) ALTRET;
      115    10215    1   DCL SSS$BLOCK     ENTRY;
      116    10216    1   DCL UDB$PMMEXIT   ENTRY;
      117    10217
      118    10218
      119    10219
      120    10220        /**/
      121    10221        /* STATIC */
      122    10222        /**/
      123    10223        %$ERROR (NAME=E_BADFC,CODE=%E$BADFC);
      124    10229        %$ERROR (NAME=E_NAUTHFC,CODE=%E$NAUTHFC);
      125    10235        %$ERROR (NAME=E_NVMEM,CODE=%E$NVMEM);
      126    10241        %$ERROR (NAME=E_NOTFND,CODE=%E$NOTFND);
      127    10247        %$ERROR (NAME=E_NOTYJ,CODE=%E$NOTYJ);
      128    10253        %$ERROR (NAME=E_JOBAOFF,CODE=%E$JOBAOFF);
      129    10259        %$ERROR (NAME=E_JSIRAS,CODE=%E$JSIRAS);
      130    10265        %$ERROR (NAME=E_JSIRLS,CODE=%E$JSIRLS);
      131    10271        %$ERROR (NAME=E_JSISLS,CODE=%E$JSISLS);
      132    10277        %$ERROR (NAME=E_JSNORESULTS,CODE=%E$BADVECT2);
      133    10283        %$ERROR (NAME=E_JSNOCRITERIA,CODE=%E$BADVECT3);
      134    10289        %$ERROR (NAME=E_JSIRPS,CODE=%E$JSIRPS);
      135    10295        %$ERROR (NAME=E_JSICPS,CODE=%E$JSICPS);
      136    10301        %$ERROR (NAME=E_NSPILL,CODE=%E$NSPILL);
      137    10307        %$ERROR (NAME=E_FNOTFND,CODE=%E$FNOTFND);
      138    10313        %$ERROR (NAME=E_NSPILLED,CODE=%E$NSPILLED);
      139    10319        %$ERROR (NAME=E_SQRCVR,CODE=%E$SQRCVR);
      140    10325        %JM_CITE (FPTN=FOS_JM_CITE,STCLASS=SYMREF);
      141    10375        %FO_CITE (FPTN=FOS_FO_CITE,STCLASS=SYMREF);
      142    10434        %VLR_JOBSTATS_CHECK (FPTN=RCHECK_INIT,STCLASS=CONSTANT);
      143    10453
      144    10454
      145    10455
      146    10456        /**/
      147    10457        /* AUTO */
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:5    
      148    10458        /**/
      149    10459    1   DCL SEL_NORUN UBIN WORD;
      150    10460    1   DCL SEL_NSFORM UBIN WORD;
      151    10461    1   DCL SEL_PRIO UBIN WORD;
      152    10462    1   DCL SEL_TNAME SBIN WORD;
      153    10463    1   DCL SEL_ACCT SBIN WORD;
      154    10464    1   DCL SEL_WSNL UBIN WORD;
      155    10465    1   DCL SEL_FORM SBIN WORD;
      156    10466    1   DCL SEL_SYSID UBIN WORD;
      157    10467    1   DCL SEL_DEVTYP UBIN WORD;
      158    10468    1   DCL OPRIO SBIN WORD;
      159    10469    1   DCL HIPRIO SBIN WORD;
      160    10470    1   DCL LOPRIO SBIN WORD;
      161    10471    1   DCL FILX UBIN WORD;
      162    10472    1   DCL UFIL$ PTR;
      163    10473    1   DCL 1 UFIL$R REDEF UFIL$,
      164    10474    1         2 DISP UBIN HALF UNAL,
      165    10475    1         2 * UBIN HALF UNAL;
      166    10476    1   DCL SYMFIL$ PTR;
      167    10477    1   DCL MFIL$ PTR;
      168    10478    1   DCL DSIZ UBIN WORD;
      169    10479    1   DCL STATSEG UBIN WORD;
      170    10480    1   DCL JOBNAME CHAR(32);
      171    10481    1   DCL TNAME CHAR(8);
      172    10482    1   DCL SYSID UBIN WORD;
      173    10483    1   DCL BYSYSID UBIN WORD;
      174    10484    1   DCL SYMHDR$ PTR;
      175    10485    1   DCL UJOB$ PTR;
      176    10486    1   DCL 1 UJOB$R REDEF UJOB$,
      177    10487    1         2 DISP UBIN HALF UNAL,
      178    10488    1         2 * UBIN HALF UNAL;
      179    10489    1   DCL SYMJOB$ PTR;
      180    10490    1   DCL MBSJOB$ PTR;
      181    10491    1   DCL SUBMISSION_PRIO UBIN;
      182    10492    1   DCL JPRIO UBIN WORD;
      183    10493    1   DCL FPRIO UBIN WORD;
      184    10494    1   DCL MJOB$ PTR;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:6    
      185    10495    1   DCL PREHDR$ PTR;
      186    10496    1   DCL PREJOB$ PTR;
      187    10497    1   DCL MBSHDR$ PTR;
      188    10498    1   DCL NAHEAD SBIN WORD;
      189    10499    1   DCL ACCT CHAR(8);
      190    10500    1   DCL IPRIO SBIN WORD;
      191    10501    1   DCL MBSRES$ PTR;
      192    10502    1   DCL MBSSN$ REDEF MBSRES$ PTR;
      193    10503    1   DCL RFIL$ PTR;
      194    10504    1   DCL RJOB$ PTR;
      195    10505    1   DCL RSIZ UBIN WORD;
      196    10506    1   DCL RSIZ_RES UBIN WORD;
      197    10507    1   DCL RSIZ_SN UBIN WORD;
      198    10508    1   DCL CSIZ UBIN WORD;
      199    10509    1   DCL RESX UBIN WORD;
      200    10510    1   DCL SNX UBIN WORD;
      201    10511    1   DCL URES$ PTR;
      202    10512    1   DCL 1 URES$R REDEF URES$,
      203    10513    1         2 DISP UBIN HALF UNAL,
      204    10514    1         2 * UBIN HALF UNAL;
      205    10515    1   DCL USN$ PTR;
      206    10516    1   DCL 1 USN$R REDEF USN$,
      207    10517    1         2 DISP UBIN HALF UNAL,
      208    10518    1         2 * UBIN HALF UNAL;
      209    10519    1   DCL MRES$ PTR;
      210    10520    1   DCL MSN$ PTR;
      211    10521    1   DCL UPRIO UBIN WORD;
      212    10522    1   DCL ORDER UBIN WORD;
      213    10523    1   DCL UCODE UBIN WORD;
      214    10524    1   DCL SYMDEV$ PTR;
      215    10525    1   DCL DEVNM CHAR(4);
      216    10526    1   DCL DEVNM1 CHAR(4);
      217    10527    1   DCL MDEV$ PTR;
      218    10528    1   DCL UDEV$ PTR;
      219    10529    1   DCL 1 UDEV$R REDEF UDEV$,
      220    10530    1         2 DISP UBIN HALF UNAL,
      221    10531    1         2 * UBIN HALF UNAL;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:7    
      222    10532        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:8    
      223    10533
      224    10534                                /* FORCE TO MASTER CPU */
      225    10535    1         CALL SSS$BLOCK;
      226    10536    1         ORDER=FPT$JOBSTATS_V.ORDER;
      227    10537
      228    10538
      229    10539        /***
      230    10540         ***
      231    10541         ***
      232    10542         ***          VECTOR ON PMME FUNCTION CODE
      233    10543         ***
      234    10544         ***
      235    10545         ***/
      236    10546    2           DO CASE (ORDER);
      237    10547        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:9    
      238    10548        /**
      239    10549
      240    10550         RRRR   EEEEE  M   M   AAA   PPPP
      241    10551         R   R  E      MM MM  A   A  P   P
      242    10552         R   R  E      M M M  A   A  P   P
      243    10553         RRRR   EEEE   M   M  AAAAA  PPPP
      244    10554         R R    E      M   M  A   A  P
      245    10555         R  R   E      M   M  A   A  P
      246    10556         R   R  EEEEE  M   M  A   A  P
      247    10557
      248    10558
      249    10559         **/
      250    10560        /*D* NAME:         FOS$PMME-REMAP
      251    10561             PURPOSE:      To receive the REMAP function of the M$JOBSTATS
      252    10562                           service.
      253    10563             DESCRIPTION:  The REMAP function of M$JOBSTATS serves to make
      254    10564                           selected areas of data in certain system ghosts
      255    10565                           visible to the monitor.
      256    10566
      257    10567                           This is done by means of a special WSQ and page
      258    10568                           table, allocated at boot time.  The system ghosts
      259    10569                           involved in this process issue M$JOBSTATS REMAP
      260    10570                           to map their data into this page table whenever
      261    10571                           the area being framed changes.  The different
      262    10572                           areas mapped are called 'job status segments',
      263    10573                           and each segment has an entry in the table
      264    10574                           FOS_SEG$, consisting of a pointer relative to
      265    10575                           the JOBSTATS WSQ.  The service routines for the
      266    10576                           other M$JOBSTATS functions then look through
      267    10577                           these pointers at based structures framing the
      268    10578                           data, to obtain information.
      269    10579
      270    10580                           Since the information being examined usually
      271    10581                           consists of chains of frames, and since the
      272    10582                           ghosts can be blocked (e.g. quantum ended)
      273    10583                           while playing with the chains, it is possible
      274    10584                           for a user to issue the M$JOBSTATS call when
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:10   
      275    10585                           one of the ghosts has his chains in disarray.
      276    10586                           For this reason, each ghost owns a segment
      277    10587                           called his 'header', which contains a lock
      278    10588                           word for all his segments.  If M$JOBSTATS
      279    10589                           wants to look a segment belonging to a ghost
      280    10590                           whose lock is set, it simply sleeps for one
      281    10591                           second and tries again.  Note that all system
      282    10592                           ghosts run exclusively on the master cpu, and
      283    10593                           that M$JOBSTATS always blocks the user onto
      284    10594                           the master, thus avoiding inter-cpu interlock
      285    10595                           problems.
      286    10596        */
      287    10597
      288    10598    2             CASE (%REMAP#);
      289    10599
      290    10600
      291    10601                                /* ENSURE USER IS AUTHORIZED */
      292    10602    2               IF NOT (S_CUN = JG_MBS#
      293    10603    2               OR S_CUN = JG_OUTSYM#
      294    10604    2               OR S_CUN = JG_PRESCAN#) THEN
      295    10605    3                 DO;
      296    10606    3   NAUTH:        ;
      297    10607    3                 B$JIT.ERR=E_NAUTHFC;
      298    10608        /*E* ERROR:        FOS-E$NAUTHFC-E
      299    10609             MESSAGE:      You are not authorized to use this function
      300    10610             MESSAGE1:     Only the MBS, PRESCAN and OUTSYM system ghosts
      301    10611                           may execute the REMAP function of M$JOBSTATS.
      302    10612                           Only users with EFT privilege may issue the
      303    10613                           SPILL/FILL functions of M$JOBSTATS.
      304    10614             DESCRIPTION:  Although any user may issue the informational forms
      305    10615                           of M$JOBSTATS, the system co-ordination function(s)
      306    10616                           are restricted to use by system processes. */
      307    10617    3                 RETURN;
      308    10618    3                 END;
      309    10619
      310    10620                                /* USER IS AOK */
      311    10621    2               STATSEG=FPT$JOBSTATS_V.STATSEG;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:11   
      312    10622
      313    10623    2               CALL RELSEG (STATSEG);
      314    10624
      315    10625                                /* GET SIZE OF SEGMENT TO BE FRAMED */
      316    10626    2               CALL HFF$DSIZ (1,DSIZ) ALTRET(DELSEG);
      317    10627    2               IF DSIZ = 0 THEN GOTO DELSEG;
      318    10628    2               CALL MMS$VGET (FOS_WSQ,B$PS1$,DSIZ,FOS_SEG$(STATSEG)) ALTRET(NOSSPACE);
      319    10629    2               RETURN;
      320    10630
      321    10631    2   NOSSPACE:   ;
      322    10632        /* Attempt to compress the segments and get the one we want again  */
      323    10633        /* before giving up entirely...                                    */
      324    10634    2               CALL MMS$COMPACT(FOS_WSQ) ALTRET(NO_WAY);
      325    10635    2   NO_WAY:     CALL MMS$VGET(FOS_WSQ,B$PS1$,DSIZ,FOS_SEG$(STATSEG)) ALTRET(BLOW_OUT);
      326    10636    2               RETURN;
      327    10637    2   BLOW_OUT:   ;
      328    10638    2               B$JIT.ERR=E_NVMEM;
      329    10639        /*E* ERROR:        FOS-E$NVMEM-E
      330    10640             MESSAGE:      No space to map status segment in page table
      331    10641             DESCRIPTION:  The buffer passed with M$JOBSTATS REMAP is assumed
      332    10642                           to be a segment of the in-core job status
      333    10643                           information.  This buffer is to be mapped into the
      334    10644                           page table used for framing the various segments
      335    10645                           of the in-core file.  This error occurs when the
      336    10646                           page table contains insufficient room for the
      337    10647                           mapping to be performed.  */
      338    10648
      339    10649                                /* CANNOT MAP IT ALL.  THE OLD MAPPING
      340    10650                                   HAS BEEN VREL'D SO WE MUST SET THE
      341    10651                                   POINTER TO ADDR(NIL).  HENCE FALL
      342    10652                                   THRU TO DELSEG.  */
      343    10653
      344    10654
      345    10655
      346    10656                                /* THE VECTOR FRAMING THE BUFFER TO BE
      347    10657                                   MAPPED WAS NIL.  THIS MEANS THAT THE
      348    10658                                   SPECIFIED SEGMENT IS TO DISAPPEAR,
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:12   
      349    10659                                   SO WE JUST LEAVE THE POINTER ADDR(NIL).*/
      350    10660    2   DELSEG:     ;
      351    10661    2               RETURN;
      352    10662        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:13   
      353    10663        /**
      354    10664
      355    10665          CCC   H   H  EEEEE   CCC   K   K
      356    10666         C   C  H   H  E      C   C  K  K
      357    10667         C      H   H  E      C      K K
      358    10668         C      HHHHH  EEEE   C      KK
      359    10669         C      H   H  E      C      K K
      360    10670         C   C  H   H  E      C   C  K  K
      361    10671          CCC   H   H  EEEEE   CCC   K   K
      362    10672
      363    10673
      364    10674         **/
      365    10675        /*D* NAME:         FOS$PMME-CHECK
      366    10676             PURPOSE:      To receive the CHECK function of the M$JOBSTATS
      367    10677                           service
      368    10678        */
      369    10679
      370    10680    2             CASE (%CHECK#);
      371    10681
      372    10682
      373    10683    2               CALL DOCHECK;
      374    10684    2               RETURN;
      375    10685        /**
      376    10686
      377    10687          CCC   H   H  EEEEE   CCC   K   K  FFFFF
      378    10688         C   C  H   H  E      C   C  K  K   F
      379    10689         C      H   H  E      C      K K    F
      380    10690         C      HHHHH  EEEE   C      KK     FFFF
      381    10691         C      H   H  E      C      K K    F
      382    10692         C   C  H   H  E      C   C  K  K   F
      383    10693          CCC   H   H  EEEEE   CCC   K   K  F
      384    10694
      385    10695
      386    10696        **/
      387    10697        /*D* NAME:         FOS$PMME-CHECKF
      388    10698             PURPOSE:      To receive the CHECKF function of the M$JOBSTATS
      389    10699                           service.
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:14   
      390    10700        */
      391    10701
      392    10702    2             CASE (%CHECKF#);
      393    10703
      394    10704    2               CALL DOCHECK;
      395    10705    2               CALL FINDOUTPF ALTRET(CHKRET);
      396    10706    2               CALL SET_FPRIO;
      397    10707    2               R$CHECK.FCODE=UCODE;
      398    10708    2               R$CHECK.FPRIO=UPRIO;
      399    10709    2               R$CHECK.DEVNAME=DEVNM;
      400    10710    2               R$CHECK.DEVAVAIL=MFIL$->FO$FIL.FLG.LPAVAIL;
      401    10711    2               R$CHECK.AHEAD=MFIL$->FO$FIL.AHEAD;
      402    10712    2   CHKRET:     ;
      403    10713    2               RETURN;
      404    10714        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:15   
      405    10715        /**
      406    10716
      407    10717         U   U  N   N  H   H   OOO   L      DDDD
      408    10718         U   U  N   N  H   H  O O O  L      D   D
      409    10719         U   U  NN  N  H   H  O O O  L      D   D
      410    10720         U   U  N N N  HHHHH  O  OO  L      D   D
      411    10721         U   U  N  NN  H   H  O   O  L      D   D
      412    10722         U   U  N   N  H   H  O   O  L      D   D
      413    10723          UUU   N   N  H   H   OOO   LLLLL  DDDD
      414    10724
      415    10725
      416    10726         **/
      417    10727        /*D* NAME:         FOS$PMME-UNHOLD
      418    10728             PURPOSE:      To receive the UNHOLD function of the M$JOBSTATS
      419    10729                           service.
      420    10730        */
      421    10731
      422    10732    2             CASE (%UNHOLD#);
      423    10733
      424    10734
      425    10735    2               CALL FINDOUTP ALTRET(NOTFOUND);
      426    10736
      427    10737    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      428    10738    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10738                        PR_MSYS# THEN
      429    10739    3                 DO;
      430    10740    3   NOTYOURJ:     ;
      431    10741    3                 B$JIT.ERR=E_NOTYJ;
      432    10742        /*E* ERROR:        FOS-E$NOTYJ-E
      433    10743             MESSAGE:      M$JOBSTATS refuses to CANCEL/UNHOLD this job - it
      434    10744                           is not yours
      435    10745             MESSAGE1:     The requested job belongs to another account,
      436    10746                           therefore you are not allowed to CANCEL/UNHOLD it */
      437    10747    3                 RETURN;
      438    10748    3                 END;
      439    10749
      440    10750    2               FOS_FO_CITE.NUMR=-1;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:16   
      441    10751    2   UNHOLD1:    ;
      442    10752    2               FOS_FO_CITE.CODE=FOEV_UHLD#;
      443    10753    2               FOS_FO_CITE.SYSID=MJOB$->FO$JOB.SYSID;
      444    10754    2   WRITE_OUTSYM:;
      445    10755    2               CALL KUW$WRITE (FOS_FO_CITE,LENGTHC(FOS_FO_CITE),J_OUTSYM);
      446    10756    2               RETURN;
      447    10757        /**
      448    10758
      449    10759         U   U  N   N  H   H   OOO   L      DDDD   FFFFF
      450    10760         U   U  N   N  H   H  O O O  L      D   D  F
      451    10761         U   U  NN  N  H   H  O O O  L      D   D  F
      452    10762         U   U  N N N  HHHHH  O  OO  L      D   D  FFFF
      453    10763         U   U  N  NN  H   H  O   O  L      D   D  F
      454    10764         U   U  N   N  H   H  O   O  L      D   D  F
      455    10765          UUU   N   N  H   H   OOO   LLLLL  DDDD   F
      456    10766
      457    10767
      458    10768        **/
      459    10769        /*D* NAME:         FOS$PMME-UNHOLDF
      460    10770             PURPOSE:      To receive the UNHOLDF function of the M$JOBSTATS
      461    10771                           service.
      462    10772        */
      463    10773
      464    10774    2             CASE (%UNHOLDF#);
      465    10775
      466    10776    2               CALL FINDOUTPF ALTRET(FNOTFOUND);
      467    10777    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      468    10778    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10778                        PR_MSYS# THEN
      469    10779    2                GOTO NOTYOURJ;
      470    10780    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;
      471    10781    2               GOTO UNHOLD1;
      472    10782    2   FNOTFOUND:  ;
      473    10783    2               B$JIT.ERR=E_FNOTFND;
      474    10784        /*E* ERROR:        FOS-E$FNOTFND-E
      475    10785             MESSAGE:      M$JOBSTATS was unable to find the requested file. */
      476    10786    2               RETURN;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:17   
      477    10787        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:18   
      478    10788        /**
      479    10789
      480    10790          SSS   PPPP    III   L      L      DDDD    OOO   N   N  EEEEE
      481    10791         S   S  P   P    I    L      L      D   D  O O O  N   N  E
      482    10792         S      P   P    I    L      L      D   D  O O O  NN  N  E
      483    10793          SSS   PPPP     I    L      L      D   D  O  OO  N N N  EEEE
      484    10794             S  P        I    L      L      D   D  O   O  N  NN  E
      485    10795         S   S  P        I    L      L      D   D  O   O  N   N  E
      486    10796          SSS   P       III   LLLLL  LLLLL  DDDD    OOO   N   N  EEEEE
      487    10797
      488    10798
      489    10799        **/
      490    10800        /*D* NAME:         FOS$PMME-SPILLDONE
      491    10801             PURPOSE:      To receive the SPILLDONE function of the M$JOBSTATS
      492    10802                           service.
      493    10803        */
      494    10804
      495    10805    2             CASE (%SPILLDONE#);
      496    10806
      497    10807    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;
      498    10808    2               CALL FINDOUTPF ALTRET(FNOTFOUND);
      499    10809    2               IF NOT MFIL$->FO$FIL.FLG.SPILL THEN
      500    10810    3                 DO;
      501    10811    3                 B$JIT.ERR=E_NSPILL;
      502    10812        /*E* ERROR:        FOS-E$NSPILL-E
      503    10813             MESSAGE:      That file is not marked for spill
      504    10814             MESSAGE1:     The file specified on an M$JOBSTATS SPILLDONE
      505    10815                           call was found not marked for spill. */
      506    10816    3                 RETURN;
      507    10817    3                 END;
      508    10818    2               FOS_FO_CITE.SYSID=SYSID;
      509    10819    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;
      510    10820    2               FOS_FO_CITE.DISP=FPT$JOBSTATS_V.DISP;
      511    10821    2               FOS_FO_CITE.CODE=FOEV_SPLD#;
      512    10822    2               GOTO WRITE_OUTSYM;
      513    10823        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:19   
      514    10824        /**
      515    10825
      516    10826         FFFFF   III   L      L
      517    10827         F        I    L      L
      518    10828         F        I    L      L
      519    10829         FFFF     I    L      L
      520    10830         F        I    L      L
      521    10831         F        I    L      L
      522    10832         F       III   LLLLL  LLLLL
      523    10833
      524    10834
      525    10835        **/
      526    10836        /*D* NAME:         FOS$PMME-FILL
      527    10837             PURPOSE:      To receive the FILL function of the M$JOBSTATS
      528    10838                           service.
      529    10839        */
      530    10840
      531    10841    2             CASE (%FILL#);
      532    10842
      533    10843    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;
      534    10844    2               CALL FINDOUTPF ALTRET(FNOTFOUND);
      535    10845    2               IF MFIL$->FO$FIL.PRIO ~= FOPR_SPILLED# THEN
      536    10846    3                 DO;
      537    10847    3                 B$JIT.ERR=E_NSPILLED;
      538    10848        /*E* ERROR:        FOS-E$NSPILLED-E
      539    10849             MESSAGE:      That file is not spilled
      540    10850             MESSAGE1:     The file specified on an M$JOBSTATS FILL
      541    10851                           call was found not spilled. */
      542    10852    3                 RETURN;
      543    10853    3                 END;
      544    10854    2               FOS_FO_CITE.SYSID=SYSID;
      545    10855    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;
      546    10856    2               FOS_FO_CITE.DISP=FPT$JOBSTATS_V.DISP;
      547    10857    2               FOS_FO_CITE.CODE=FOEV_FILL#;
      548    10858    2               GOTO WRITE_OUTSYM;
      549    10859        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:20   
      550    10860        /**
      551    10861
      552    10862          CCC    AAA   N   N   CCC   EEEEE  L
      553    10863         C   C  A   A  N   N  C   C  E      L
      554    10864         C      A   A  NN  N  C      E      L
      555    10865         C      AAAAA  N N N  C      EEEE   L
      556    10866         C      A   A  N  NN  C      E      L
      557    10867         C   C  A   A  N   N  C   C  E      L
      558    10868          CCC   A   A  N   N   CCC   EEEEE  LLLLL
      559    10869
      560    10870
      561    10871         **/
      562    10872
      563    10873        /*D* NAME:         FOS$PMME-CANCEL
      564    10874             PURPOSE:      To receive the CANCEL function of the M$JOBSTATS
      565    10875                           service.
      566    10876             DESCRIPTION:  The given SYSID/JOBNAME.ACCT is to be cancelled
      567    10877                           if it is a running or waiting job.  Also, if the
      568    10878                           OUTPUT bit is selected in the FPT, the job's output
      569    10879                           (if any) is to be cancelled.  Note that output for
      570    10880                           a non-batch user can be cancelled in this way by
      571    10881                           simply specifiying the user's SYSID, and OUTPUT.
      572    10882
      573    10883                           This is implemented by sending an event to MBS
      574    10884                           for the job, if any, and an event to OUTSYM if
      575    10885                           OUTPUT was specified and output is present.
      576    10886                           Note that in the case of a batch job where the
      577    10887                           PMME specifies OUTPUT, an event must still be
      578    10888                           sent to OUTSYM telling him to throw away the
      579    10889                           output when it finally arrives.  */
      580    10890
      581    10891
      582    10892    2             CASE (%CANCEL#);
      583    10893
      584    10894    2               CALL FINDJOB ALTRET(CANCEL1);
      585    10895    2               IF (B$JIT.ACCN ~= MJOB$->JM$IF.ACCT
      586    10896    2               OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:21   
             10896                        PR_MSYS# THEN
      587    10897    2                GOTO NOTYOURJ;
      588    10898    2               SYSID=MJOB$->JM$IF.SYSID;
      589    10899    2               FOS_JM_CITE.SYSID=SYSID;
      590    10900    2               FOS_JM_CITE.SUBCODE=JMEC_CID#;
      591    10901    2               FOS_JM_CITE.ACCT=MJOB$->JM$IF.ACCT;
      592    10902    2               CALL KUW$WRITE (FOS_JM_CITE,LENGTHC(FOS_JM_CITE),J_MBS);
      593    10903
      594    10904                                /* IF OUTPUT IS TO BE CANCELLED, THEN SEND
      595    10905                                   MESSAGE TO OUTSYM IF 'TIS RUNNING */
      596    10906    2               IF NOT FPT$JOBSTATS_V.OUTPUT
      597    10907    2               OR JPRIO ~= JM_Q$RUN THEN RETURN;
      598    10908
      599    10909                                /* CANCEL THE OUTPUT TOO */
      600    10910    2               FOS_FO_CITE.BATCH=1;
      601    10911    2               GOTO CANCEL2;
      602    10912
      603    10913                                /* NO JOB FOUND */
      604    10914    2   CANCEL1:    ;
      605    10915    2               CALL FINDOUTP ALTRET(NOTFOUND);
      606    10916    2               IF NOT FPT$JOBSTATS_V.OUTPUT THEN
      607    10917    3                 DO;
      608    10918    3                 B$JIT.ERR=E_JOBAOFF;
      609    10919        /*E* ERROR:        FOS-E$JOBAOFF-E
      610    10920             MESSAGE:      The job to be cancelled has already run
      611    10921             MESSAGE1:     This error occurs when a CANCEL is issued but output
      612    10922                           is not to be deleted, and the job has finished
      613    10923                           running and has output waiting or printing.
      614    10924             DESCRIPTION:  As in MESSAGE1.  Note that if OUTPUT is specified,
      615    10925                           then output will be cancelled in this situation. */
      616    10926    3                 RETURN;
      617    10927    3                 END;
      618    10928    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      619    10929    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10929                        PR_MSYS# THEN
      620    10930    2                GOTO NOTYOURJ;
      621    10931    2               FOS_FO_CITE.BATCH=0;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:22   
      622    10932    2               SYSID=MJOB$->FO$JOB.SYSID;
      623    10933    2   CANCEL2:    ;
      624    10934    2               FOS_FO_CITE.NUMR=-1;
      625    10935    2   CANCEL3:    ;
      626    10936    2               FOS_FO_CITE.CODE=FOEV_CNCL#;
      627    10937    2               FOS_FO_CITE.SYSID=SYSID;
      628    10938    2               GOTO WRITE_OUTSYM;
      629    10939                                /* COME HERE WHEN NOTHING FOUND */
      630    10940    2   NOTFOUND:   ;
      631    10941    2               B$JIT.ERR=E_NOTFND;
      632    10942        /*E* ERROR:        FOS-E$NOTFND-E
      633    10943             MESSAGE:      M$JOBSTATS was unable to find the requested job(s) */
      634    10944    2               RETURN;
      635    10945        /**
      636    10946
      637    10947          CCC    AAA   N   N   CCC   EEEEE  L      FFFFF
      638    10948         C   C  A   A  N   N  C   C  E      L      F
      639    10949         C      A   A  NN  N  C      E      L      F
      640    10950         C      AAAAA  N N N  C      EEEE   L      FFFF
      641    10951         C      A   A  N  NN  C      E      L      F
      642    10952         C   C  A   A  N   N  C   C  E      L      F
      643    10953          CCC   A   A  N   N   CCC   EEEEE  LLLLL  F
      644    10954
      645    10955
      646    10956        **/
      647    10957        /*D* NAME:         FOS$PMME-CANCELF
      648    10958             PURPOSE:      To receive the CANCELF function of the M$JOBSTATS
      649    10959                           service.
      650    10960        */
      651    10961
      652    10962    2             CASE (%CANCELF#);
      653    10963
      654    10964    2               CALL FINDOUTPF ALTRET(FNOTFOUND);
      655    10965    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      656    10966    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10966                        PR_MSYS# THEN
      657    10967    2                GOTO NOTYOURJ;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:23   
      658    10968    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;
      659    10969    2               GOTO CANCEL3;
      660    10970        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:24   
      661    10971        /**
      662    10972
      663    10973          SSS   PPPP    III   L      L
      664    10974         S   S  P   P    I    L      L
      665    10975         S      P   P    I    L      L
      666    10976          SSS   PPPP     I    L      L
      667    10977             S  P        I    L      L
      668    10978         S   S  P        I    L      L
      669    10979          SSS   P       III   LLLLL  LLLLL
      670    10980
      671    10981
      672    10982        **/
      673    10983        /*D* NAME:         FOS$PMME-SPILL
      674    10984             PURPOSE:      To receive the SPILL function of the M$JOBSTATS
      675    10985                           service.
      676    10986        */
      677    10987
      678    10988    2             CASE (%SPILL#);
      679    10989
      680    10990    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;
      681    10991    2               GOTO SRCH;
      682    10992
      683    10993
      684    10994        /**
      685    10995
      686    10996          SSS   RRRR    CCC   H   H
      687    10997         S   S  R   R  C   C  H   H
      688    10998         S      R   R  C      H   H
      689    10999          SSS   RRRR   C      HHHHH
      690    11000             S  R R    C      H   H
      691    11001         S   S  R  R   C   C  H   H
      692    11002          SSS   R   R   CCC   H   H
      693    11003
      694    11004
      695    11005         **/
      696    11006        /*D* NAME:         FOS$PMME-SRCH
      697    11007             PURPOSE:      To receive the SRCH function of the M$JOBSTATS
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:25   
      698    11008                           service.
      699    11009        */
      700    11010
      701    11011    2             CASE (%SRCH#);
      702    11012
      703    11013    2   SRCH:
      704    11014                    /* Get RESULTS_ size */
      705    11015    2               CALL HFF$DSIZ (2, RSIZ) ALTRET (NO_RESULTS_VECTOR);
      706    11016
      707    11017    3                 DO WHILE ( '0'B );
      708    11018    3   NO_RESULTS_VECTOR:
      709    11019    3                 B$JIT.ERR = E_JSNORESULTS;
      710    11020        /*E* ERROR:        FOS-E$BADVECT2-E
      711    11021             MESSAGE:      The RESULTS vector is NIL/ERASE in your M$JOBSTATS
      712    11022                           CHECK, CHECKF, SPILL, or SRCH FPT.  */
      713    11023    3                 RETURN;
      714    11024    3                 END;
      715    11025
      716    11026                    /* We need at least enough for  2 FOUND UBIN...
      717    11027                                               and  2 * UBIN... */
      718    11028    2               IF RSIZ < 8 THEN
      719    11029    3                 DO;
      720    11030    3                 B$JIT.ERR = E_JSIRPS;
      721    11031        /*E* ERROR:        FOS-E$JSIRPS-E
      722    11032             MESSAGE:      Insufficient M$JOBSTATS results parameter size.
      723    11033             MESSAGE1:     While performing an M$JOBSTATS CHECK, CHECKF, SPILL,
      724    11034                           or SRCH service, you have specified too small an area
      725    11035                           to serve as a results (RESULTS_) parameter.  */
      726    11036    3                 RETURN;
      727    11037    3                 END;
      728    11038
      729    11039                    /* Discount  2 FOUND UBIN...
      730    11040                            and  2 * UBIN... */
      731    11041    2               RSIZ = RSIZ - 8;
      732    11042
      733    11043                    /* Get CRITERIA_ size */
      734    11044    2               CALL HFF$DSIZ (3, CSIZ) ALTRET (NO_CRITERIA_VECTOR);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:26   
      735    11045    3                 DO WHILE ( '0'B );
      736    11046    3   NO_CRITERIA_VECTOR:
      737    11047    3                 B$JIT.ERR = E_JSNOCRITERIA;
      738    11048        /*E* ERROR:        FOS-E$BADVECT3-E
      739    11049             MESSAGE:      The CRITERIA vector is NIL/ERASE in your M$JOBSTATS
      740    11050                           SPILL or SRCH FPT.  */
      741    11051    3                 RETURN;
      742    11052    3                 END;
      743    11053
      744    11054    2               IF CSIZ < SIZEC (VLP$CRITERIA)
      745    11055    2               THEN
      746    11056    3                 DO;
      747    11057    3                 B$JIT.ERR = E_JSICPS;
      748    11058        /*E* ERROR:        FOS-E$JSICPS-E
      749    11059             MESSAGE:      Insufficient M$JOBSTATS criteria parameter size.
      750    11060             MESSAGE1:     While performing an M$JOBSTATS SPILL or SRCH service,
      751    11061                           you have specified too small an area to serve as a
      752    11062                           criteria (CRITERIA_) parameter.  */
      753    11063    3                 RETURN;
      754    11064    3                 END;
      755    11065
      756    11066                                /* SET UP FLAGS FOR COMMON CRITERIA */
      757    11067    2               IF VLP$CRITERIA.ACCT ~= ' ' THEN
      758    11068    2                IF VLP$CRITERIA.NOTACCT THEN SEL_ACCT=-1; ELSE SEL_ACCT=1;
      759    11069    2               ELSE SEL_ACCT=0;
      760    11070    2               IF VLP$CRITERIA.SYSID ~= 0 THEN SEL_SYSID=1;
      761    11071    2               ELSE SEL_SYSID=0;
      762    11072    2               IF NOT FPT$JOBSTATS_V.OUTPUT
      763    11073    2               AND ORDER ~= %SPILL# THEN GOTO ISRCH;
      764    11074
      765    11075        /**
      766    11076         **
      767    11077         **      SEARCH OUTPUT QUEUES
      768    11078         **
      769    11079         **/
      770    11080
      771    11081                                /* CALC NUMBER OF FILE FRAMES PRESENT
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:27   
      772    11082                                   IN RESULTS AREA */
      773    11083    2               RSIZ=RSIZ/LENGTHC(R$FILE);
      774    11084
      775    11085    2               IF VLP$CRITERIA.WSN ~= ' ' THEN
      776    11086    2                CALL INDEX (SEL_WSNL,'?',VLP$CRITERIA.WSN);
      777    11087    2               ELSE SEL_WSNL=0;
      778    11088
      779    11089    2               IF VLP$CRITERIA.FORM ~= ' ' THEN
      780    11090    2                IF VLP$CRITERIA.NOTFORM THEN SEL_FORM=-1; ELSE SEL_FORM=1;
      781    11091    2               ELSE SEL_FORM=0;
      782    11092    2               IF VLP$CRITERIA.TNAME ~= ' ' THEN
      783    11093    2                IF VLP$CRITERIA.NOTTNAME THEN SEL_TNAME=-1; ELSE SEL_TNAME=1;
      784    11094    2               ELSE SEL_TNAME=0;
      785    11095
      786    11096    2               IF VLP$CRITERIA.DEVTYP ~= ' ' THEN SEL_DEVTYP=1;
      787    11097    2               ELSE SEL_DEVTYP=0;
      788    11098
      789    11099    2               CALL GET_SYMHDR ALTRET(NOTFOUND);
      790    11100
      791    11101    2               FILX=0;
      792    11102    2               R$OSRCH.FOUND=0;
      793    11103
      794    11104                                /* DECIDE WHICH PRIO CHAIN(S) TO SRCH */
      795    11105    2               IF VLP$CRITERIA.MFW THEN
      796    11106    3                 DO;
      797    11107    3                 LOPRIO=FOPR_MFW#;
      798    11108    3                 HIPRIO=LOPRIO;
      799    11109    3                 END;
      800    11110    2               ELSE IF VLP$CRITERIA.HOLD THEN
      801    11111    3                  DO;
      802    11112    3                  LOPRIO=FOPR_HOLD#;
      803    11113    3                  HIPRIO=LOPRIO;
      804    11114    3                  END;
      805    11115    2                ELSE IF VLP$CRITERIA.SPILLED AND ORDER ~= %SPILL# THEN
      806    11116    3                   DO;
      807    11117    3                   LOPRIO=FOPR_SPILLED#;
      808    11118    3                   HIPRIO=LOPRIO;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:28   
      809    11119    3                   END;
      810    11120    2                 ELSE IF VLP$CRITERIA.PRIO > 15
      811    11121    2                  OR VLP$CRITERIA.PRIO1 > 15
      812    11122    2                  OR VLP$CRITERIA.PRIO > VLP$CRITERIA.PRIO1 THEN
      813    11123    3                    DO;
      814    11124    3                    LOPRIO=0;
      815    11125    3                    HIPRIO=FOPR_MAX#;
      816    11126    3                    END;
      817    11127    2                  ELSE
      818    11128    3                    DO;
      819    11129    3                    LOPRIO=VLP$CRITERIA.PRIO+FOPR_P0#;
      820    11130    3                    HIPRIO=VLP$CRITERIA.PRIO1+FOPR_P0#;
      821    11131    3                    END;
      822    11132
      823    11133    2               IF VLP$CRITERIA.NSFORM THEN SEL_NSFORM=1;
      824    11134    2               ELSE SEL_NSFORM=0;
      825    11135
      826    11136    2               OPRIO=HIPRIO;
      827    11137    3                 DO WHILE (OPRIO >= LOPRIO);
      828    11138
      829    11139    3                 UFIL$=SYMHDR$->FO$Q.FILHD$(OPRIO);
      830    11140
      831    11141    4                   DO WHILE (UFIL$ ~= ADDR(NIL));
      832    11142
      833    11143    4                   MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);
      834    11144
      835    11145    4                   UJOB$=MFIL$->FO$FIL.OJOB$;
      836    11146    4                   MJOB$=PINCRW(SYMJOB$,UJOB$R.DISP);
      837    11147
      838    11148    4                   UDEV$=MFIL$->FO$FIL.CDEV$;
      839    11149    4                   IF UDEV$ ~= ADDR(NIL)
      840    11150    4                   THEN
      841    11151    5                     DO;
      842    11152    5                     MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);
      843    11153    5                     TNAME=MDEV$->FO$DEV.TNAME;
      844    11154    5                     END;
      845    11155    4                   ELSE
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:29   
      846    11156    5                     DO;
      847    11157    5                     MDEV$=ADDR(NIL);
      848    11158    5                     TNAME=' ';
      849    11159    5                     END;
      850    11160
      851    11161    4                   IF
      852    11162    4                   (SEL_SYSID ~= 0 AND
      853    11163    4                   (MFIL$->FO$FIL.SYSID < VLP$CRITERIA.SYSID
      854    11164    4                   OR MFIL$->FO$FIL.SYSID > VLP$CRITERIA.SYSID1))
      855    11165    4                   OR
      856    11166    4                   (SEL_ACCT > 0 AND VLP$CRITERIA.ACCT ~= MJOB$->FO$JOB.ACCT)
      857    11167    4                   OR
      858    11168    4                   (SEL_ACCT < 0 AND VLP$CRITERIA.ACCT = MJOB$->FO$JOB.ACCT)
      859    11169    4                   OR
      860    11170    4                   (SEL_FORM > 0 AND VLP$CRITERIA.FORM ~= MFIL$->FO$FIL.FORM)
      861    11171    4                   OR
      862    11172    4                   (SEL_FORM < 0 AND VLP$CRITERIA.FORM  = MFIL$->FO$FIL.FORM)
      863    11173    4                   OR
      864    11174    4                   ( (B$JIT.PRIV.ACTIVE & (%PR_DISPJOB#|%PR_FMEFT#))='0'B
      865    11175    4                   AND
      866    11176    4                   (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      867    11177    4                   OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME))
      868    11178    4                   OR
      869    11179    4                   (SEL_NSFORM ~= 0
      870    11180    4                   AND SUBSTR(MFIL$->FO$FIL.FORM,0,3) = 'STD')
      871    11181    4                   OR
      872    11182    4                   (ORDER = %SPILL# AND
      873    11183    4                   (OPRIO = FOPR_SPILLED# OR
      874    11184    4                   MFIL$->FO$FIL.CDEV$ ~= ADDR(NIL) OR
      875    11185    4                   MFIL$->FO$FIL.FLG.GLC = '0'B))
      876    11186    4                   OR
      877    11187    4                   (SEL_TNAME > 0
      878    11188    4                   AND TNAME ~= VLP$CRITERIA.TNAME)
      879    11189    4                   OR
      880    11190    4                   (SEL_TNAME < 0
      881    11191    4                   AND TNAME = VLP$CRITERIA.TNAME)
      882    11192    4                   OR
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:30   
      883    11193    4                   (SEL_WSNL ~= 0 AND
      884    11194    4                   (VLP$CRITERIA.NOTWSN = '0'B AND
      885    11195    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MFIL$->FO$FIL.DESTR.WSN)->
             11195                            B$$WSN))
      886    11196    4                   OR (VLP$CRITERIA.NOTWSN = '1'B AND
      887    11197    4                   (ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MFIL$->FO$FIL.DESTR.WSN)->
             11197                            B$$WSN))
      888    11198    4                   OR
      889    11199    4                   (SEL_DEVTYP ~= 0
      890    11200    4                   AND MFIL$->FO$FIL.DESTR.TYP ~= VLP$CRITERIA.DEVTYP)
      891    11201    4                   THEN GOTO OSKIP;
      892    11202
      893    11203    4                   IF FILX >= RSIZ THEN
      894    11204    5                     DO;
      895    11205    5                     R$OSRCH.FOUND=FILX;
      896    11206    5                     GOTO NORSPACE;
      897    11207    5                     END;
      898    11208    4                   RFIL$=ADDR(R$OSRCH.F(FILX));
      899    11209
      900    11210
      901    11211                                /* GIVE IT TO HIM */
      902    11212
      903    11213    4                   RFIL$->R$FILE.TNAME           =TNAME;
      904    11214    4                   RFIL$->R$FILE.WOD             =MFIL$->FO$FIL.DESTR.WSN;
      905    11215    4                   RFIL$->R$FILE.DEVTYP          =MFIL$->FO$FIL.DESTR.TYP;
      906    11216    4                   RFIL$->R$FILE.COPIES          =MFIL$->FO$FIL.COPIES;
      907    11217    4                   RFIL$->R$FILE.SAPCOPIES       =MFIL$->FO$FIL.SAPCOPIES;
      908    11218    4                   RFIL$->R$FILE.ATTR            =MFIL$->FO$FIL.ATTR;
      909    11219    4                   RFIL$->R$FILE.FLG.GLC         =MFIL$->FO$FIL.FLG.GLC;
      910    11220    4                   RFIL$->R$FILE.FLG.SAP         =MFIL$->FO$FIL.FLG.SAP;
      911    11221    4                   RFIL$->R$FILE.FLG.DEVAVAIL    =MFIL$->FO$FIL.FLG.LPAVAIL;
      912    11222    4                   RFIL$->R$FILE.MODE            =MJOB$->FO$JOB.MODE;
      913    11223    4                   RFIL$->R$FILE.BOOTID          =MFIL$->FO$FIL.BOOTID;
      914    11224    4                   RFIL$->R$FILE.FLG.SPILL       =MFIL$->FO$FIL.FLG.SPILL;
      915    11225    4                   RFIL$->R$FILE.SYSID           =MFIL$->FO$FIL.SYSID;
      916    11226    4                   RFIL$->R$FILE.NUM             =MFIL$->FO$FIL.NUM;
      917    11227    4                   RFIL$->R$FILE.HICNUM          =MFIL$->FO$FIL.HICNUM;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:31   
      918    11228    4                   RFIL$->R$FILE.GRANS           =MFIL$->FO$FIL.GRANS;
      919    11229    4                   RFIL$->R$FILE.FORM            =MFIL$->FO$FIL.FORM;
      920    11230    4                   RFIL$->R$FILE.ACCT            =MJOB$->FO$JOB.ACCT;
      921    11231    4                   RFIL$->R$FILE.JNAME           =MJOB$->FO$JOB.JOBNAME;
      922    11232    4                   RFIL$->R$FILE.AHEAD           =MFIL$->FO$FIL.AHEAD;
      923    11233    4                   RFIL$->R$FILE.CREATED         =MFIL$->FO$FIL.CREATED;
      924    11234    4                   IF MDEV$ ~= ADDR(NIL)
      925    11235    4                   THEN
      926    11236    4                    RFIL$->R$FILE.DEVNAME=MDEV$->FO$DEV.NAMER.NUM;
      927    11237    4                   ELSE
      928    11238    4                    RFIL$->R$FILE.DEVNAME=' ';
      929    11239    4                   CALL SET_FPRIO;
      930    11240    4                   RFIL$->R$FILE.PRIO=UPRIO;
      931    11241    4                   IF ORDER = %SPILL# THEN MFIL$->FO$FIL.FLG.SPILL='1'B;
      932    11242
      933    11243    4                   FILX=FILX+1;
      934    11244
      935    11245    4   OSKIP:          ;
      936    11246    4                   UFIL$=MFIL$->FO$FIL.LNK$;
      937    11247    4                   END;
      938    11248    3                 OPRIO=OPRIO-1;
      939    11249    3                 END;
      940    11250
      941    11251    2               R$OSRCH.FOUND=FILX;
      942    11252    2               IF FILX = 0 THEN GOTO NOTFOUND;
      943    11253    2               RETURN;
      944    11254
      945    11255
      946    11256
      947    11257        /**
      948    11258         **
      949    11259         **      SEARCH INPUT QUEUES
      950    11260         **
      951    11261         **/
      952    11262    2   ISRCH:      ;
      953    11263                                /* CALC NUMBER OF JOB FRAMES PRESENT */
      954    11264    2               RSIZ=RSIZ/LENGTHC(R$JOB);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:32   
      955    11265
      956    11266    2               IF VLP$CRITERIA.WSN ~= '  ' THEN
      957    11267    2                CALL INDEX (SEL_WSNL,'?',VLP$CRITERIA.WSN);
      958    11268    2               ELSE SEL_WSNL=0;
      959    11269
      960    11270    2               CALL GET_MBSHDR ALTRET(NOTFOUND);
      961    11271
      962    11272    2               FILX=0;
      963    11273    2               R$ISRCH.FOUND=0;
      964    11274    2               RESX=0;
      965    11275    2               SNX=0;
      966    11276    2               NAHEAD=0;
      967    11277
      968    11278                                /* SELECT WHICH PRIO CHAIN(S) TO SRCH */
      969    11279
      970    11280    2               IF VLP$CRITERIA.NORUN THEN
      971    11281    3                 DO;
      972    11282    3                 LOPRIO=JM_Q$WP;
      973    11283    3                 HIPRIO=JM_Q$WP;
      974    11284    3                 END;
      975    11285    2               ELSE
      976    11286    3                 DO;
      977    11287    3                 IF VLP$CRITERIA.RUNAFTER THEN
      978    11288    4                   DO;
      979    11289    4                   LOPRIO=JM_Q$WR;
      980    11290    4                   HIPRIO=JM_Q$WR;
      981    11291    4                   END;
      982    11292    3                 ELSE
      983    11293    4                   DO;
      984    11294    4                   IF VLP$CRITERIA.RUNNING THEN
      985    11295    5                     DO;
      986    11296    5                     LOPRIO=JM_Q$RUN;
      987    11297    5                     HIPRIO=JM_Q$RUN;
      988    11298    5                     END;
      989    11299    4                   ELSE
      990    11300    5                     DO;
      991    11301    5                     IF VLP$CRITERIA.WPS THEN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:33   
      992    11302    6                       DO;
      993    11303    6                       LOPRIO=JM_Q$DP;
      994    11304    6                       HIPRIO=JM_Q$DP;
      995    11305    6                       END;
      996    11306    5                     ELSE
      997    11307    6                       DO;
      998    11308    6                       IF VLP$CRITERIA.PRIO > 15
      999    11309    6                       OR VLP$CRITERIA.PRIO1> 15
     1000    11310    6                       OR VLP$CRITERIA.PRIO > VLP$CRITERIA.PRIO1 THEN
     1001    11311    7                         DO;
     1002    11312    7                         LOPRIO=JM_Q$WP;
     1003    11313    7                         HIPRIO=JM_Q$RUN;
     1004    11314    7                         END;
     1005    11315    6                       ELSE
     1006    11316    7                         DO;
     1007    11317    7                         LOPRIO=VLP$CRITERIA.PRIO+JM_Q$P0;
     1008    11318    7                         HIPRIO=VLP$CRITERIA.PRIO1+JM_Q$P0;
     1009    11319    7                         END;
     1010    11320    6                       END;
     1011    11321    5                     END;
     1012    11322    4                   END;
     1013    11323    3                 END;
     1014    11324                                /* IF SELECTION DOES NOT START WITH P15,
     1015    11325                                   THEN COUNT JOBS IN QUEUES ABOVE HIPRIO
     1016    11326                                   QUEUE TO MAKE 'AHEAD' CORRECT */
     1017    11327    2               IPRIO=JM_Q$P15;
     1018    11328    3                 DO WHILE (IPRIO > HIPRIO);
     1019    11329    3                 UJOB$=MBSHDR$->JMC$CHAINS.HEAD$(IPRIO);
     1020    11330    4                   DO WHILE (UJOB$ ~= ADDR(NIL));
     1021    11331    4                   MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);
     1022    11332    4                   NAHEAD=NAHEAD+1;
     1023    11333    4                   UJOB$=MJOB$->JM$IF.LNK$;
     1024    11334    4                   END;
     1025    11335    3                 IPRIO=IPRIO-1;
     1026    11336    3                 END;
     1027    11337
     1028    11338
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:34   
     1029    11339
     1030    11340                                /* FIGURE OUT IF RESLISTS & SNLISTS ARE
     1031    11341                                   REQUESTED */
     1032    11342    2               CALL HFF$DSIZ(7,RSIZ_RES);
     1033    11343    2               IF RSIZ_RES ~= 0 THEN RSIZ_RES=RSIZ_RES/LENGTHC(R$ISRCH_RES.R(0));
     1034    11344    2               CALL HFF$DSIZ(6,RSIZ_SN);
     1035    11345    2               IF RSIZ_SN ~= 0 THEN RSIZ_SN=RSIZ_SN/LENGTHC(R$ISRCH_SN.S(0));
     1036    11346
     1037    11347                                /* NOW LOOP THRU THE CORRECT CHAINS */
     1038    11348    2   RELOOP:     ;
     1039    11349    2               IPRIO=HIPRIO;
     1040    11350    3                 DO WHILE (IPRIO >= LOPRIO);
     1041    11351    3                 UJOB$=MBSHDR$->JMC$CHAINS.HEAD$(IPRIO);
     1042    11352    4                   DO WHILE (UJOB$ ~= ADDR(NIL));
     1043    11353    4                   MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);
     1044    11354
     1045    11355    4                   IF
     1046    11356    4                   (SEL_SYSID ~= 0 AND
     1047    11357    4                   (MJOB$->JM$IF.SYSID < VLP$CRITERIA.SYSID
     1048    11358    4                   OR MJOB$->JM$IF.SYSID > VLP$CRITERIA.SYSID1))
     1049    11359    4                   OR
     1050    11360    4                   (SEL_ACCT > 0 AND VLP$CRITERIA.ACCT ~= MJOB$->JM$IF.ACCT)
     1051    11361    4                   OR
     1052    11362    4                   (SEL_ACCT < 0 AND VLP$CRITERIA.ACCT  = MJOB$->JM$IF.ACCT)
     1053    11363    4                   OR
     1054    11364    4                   (NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#)
     1055    11365    4                   AND
     1056    11366    4                   (B$JIT.ACCN ~= MJOB$->JM$IF.ACCT
     1057    11367    4                   OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME))
     1058    11368    4                   OR
     1059    11369    4                   (SEL_WSNL ~= 0 AND
     1060    11370    4                   (VLP$CRITERIA.NOTWSN = '0'B AND
     1061    11371    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MJOB$->JM$IF.WSN)->B$$WSN AND
     1062    11372    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MJOB$->JM$IF.WOO)->B$$WSN)
     1063    11373    4                   OR (VLP$CRITERIA.NOTWSN = '1'B AND
     1064    11374    4                   (ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MJOB$->JM$IF.WSN)->B$$WSN OR
     1065    11375    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MJOB$->JM$IF.WOO)->B$$WSN)))
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:35   
     1066    11376    4                   THEN GOTO ISKIP;
     1067    11377
     1068    11378    4                   IF FILX >= RSIZ THEN
     1069    11379    5                     DO;
     1070    11380    5                     R$ISRCH.FOUND=FILX;
     1071    11381    5                     GOTO NORSPACE;
     1072    11382    5                     END;
     1073    11383    4                   RJOB$=ADDR(R$ISRCH.J(FILX));
     1074    11384
     1075    11385                                /* GIVE IT TO HIM */
     1076    11386    4                   RJOB$->R$JOB.AHEAD               =NAHEAD;
     1077    11387    4                   RJOB$->R$JOB.U                   =MJOB$->JM$IF.U;
     1078    11388    4                   RJOB$->R$JOB.PART                =MJOB$->JM$IF.PART;
     1079    11389    4                   RJOB$->R$JOB.PNUM                =MJOB$->JM$IF.PNUM+1;
             11389                            /* JM$IF HAS INDEX */
     1080    11390    4                   RJOB$->R$JOB.PI                  =MJOB$->JM$IF.PI;
     1081    11391    4                   RJOB$->R$JOB.IPRIO               =MJOB$->JM$IF.PRIO;
     1082    11392    4                   RJOB$->R$JOB.SUBMIT_TIME         =MJOB$->JM$IF.SUBMIT_TIME;
     1083    11393    4                   RJOB$->R$JOB.START_TIME          =MJOB$->JM$IF.START_TIME;
     1084    11394    4                   RJOB$->R$JOB.FLG                 =MJOB$->JM$IF.FLG;
     1085    11395    4                   RJOB$->R$JOB.SYSID               =MJOB$->JM$IF.SYSID;
     1086    11396    4                   RJOB$->R$JOB.ACCT                =MJOB$->JM$IF.ACCT;
     1087    11397    4                   RJOB$->R$JOB.UNAME               =MJOB$->JM$IF.UNAME;
     1088    11398    4                   RJOB$->R$JOB.WOO                 =MJOB$->JM$IF.WOO;
     1089    11399    4                   RJOB$->R$JOB.WSN                 =MJOB$->JM$IF.WSN;
     1090    11400    4                   RJOB$->R$JOB.JNAME               =MJOB$->JM$IF.JNAME;
     1091    11401    4                   RJOB$->R$JOB.RATIM               =MJOB$->JM$IF.RATIM;
     1092    11402    4                   RJOB$->R$JOB.RRT                 =MJOB$->JM$IF.RRT;
     1093    11403    4                   RJOB$->R$JOB.TIM                 =MJOB$->JM$IF.TIM;
     1094    11404    4                   RJOB$->R$JOB.JDID                =MJOB$->JM$IF.JDID;
     1095    11405    4                   RJOB$->R$JOB.JDSTEPCC            =MJOB$->JM$IF.JDSTEPCC;
     1096    11406    4                   RJOB$->R$JOB.NFOLL               =MJOB$->JM$IF.NJD;
     1097    11407    4                   JPRIO=IPRIO;
     1098    11408    4                   CALL SET_JPRIO;
     1099    11409    4                   RJOB$->R$JOB.PRIO=UPRIO;
     1100    11410    4                   RJOB$->R$JOB.NSN=0;
     1101    11411    4                   IF RSIZ_SN ~= 0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:36   
     1102    11412    4                   AND MJOB$->JM$IF.MAXPSN ~= 0 THEN
     1103    11413    5                     DO;
     1104    11414    5                     RJOB$->R$JOB.SNX=SNX;
     1105    11415    5                     USN$=MJOB$->JM$IF.XLNK$;
     1106    11416    5                     CALL GET_SNS ALTRET(NOSLS);
     1107    11417    5                     USN$=MJOB$->JM$IF.SLNK$;
     1108    11418    5                     CALL GET_SNS ALTRET(NOSLS);
     1109    11419    5                     END;
     1110    11420    4                   RJOB$->R$JOB.NRES=0;
     1111    11421    4                   IF RSIZ_RES ~= 0 THEN
     1112    11422    5                     DO;
     1113    11423    5                     RJOB$->R$JOB.RESX=RESX;
     1114    11424    5                     URES$=MJOB$->JM$IF.VRLIST$;
     1115    11425    6                       DO WHILE (URES$ ~= ADDR(NIL));
     1116    11426    6                       MRES$=PINCRW(MBSRES$,URES$R.DISP);
     1117    11427    6                       IF RESX >= RSIZ_RES THEN
     1118    11428    7                         DO;
     1119    11429    7                         B$JIT.ERR=E_JSIRLS;
     1120    11430        /*E* ERROR:        FOS-E$JSIRLS-E
     1121    11431             MESSAGE:      Insufficient M$JOBSTATS resource list space
     1122    11432             MESSAGE1:     While performing an M$JOBSTATS SRCH (batch queue)
     1123    11433                           service, you have specified too few frames in the
     1124    11434                           resource list (RESLIST_) results area. */
     1125    11435    7                         RETURN;
     1126    11436    7                         END;
     1127    11437    6                       R$ISRCH_RES.R.TYP(RESX)=MRES$->JM$QRIT.TYPE;
     1128    11438    6                       R$ISRCH_RES.R.VNUM(RESX)=MRES$->JM$QRIT.VNUM;
     1129    11439    6                       R$ISRCH_RES.R.ATTR(RESX)=MRES$->JM$QRIT.ATTRS;
     1130    11440    6                       RESX=RESX+1;
     1131    11441    6                       RJOB$->R$JOB.NRES=RJOB$->R$JOB.NRES+1;
     1132    11442    6                       URES$=MRES$->JM$QRIT.NXT$;
     1133    11443    6                       END;
     1134    11444    5                     END;
     1135    11445
     1136    11446
     1137    11447    4                   FILX=FILX+1;
     1138    11448
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:37   
     1139    11449    4   ISKIP:          ;
     1140    11450    4                   UJOB$=MJOB$->JM$IF.LNK$;
     1141    11451    4                   NAHEAD=NAHEAD+1;
     1142    11452    4                   END;
     1143    11453    3                 IF IPRIO = JM_Q$RUN THEN NAHEAD=0;
     1144    11454    3                 IPRIO=IPRIO-1;
     1145    11455    3                 END;
     1146    11456
     1147    11457    2               IF  LOPRIO = JM_Q$WP
     1148    11458    2               AND VLP$CRITERIA.NORUN THEN
     1149    11459    3                 DO;
     1150    11460    3                 LOPRIO=JM_Q$DP;
     1151    11461    3                 HIPRIO=JM_Q$DP;
     1152    11462    3                 GOTO RELOOP;
     1153    11463    3                 END;
     1154    11464    2               R$ISRCH.FOUND=FILX;
     1155    11465    2               IF FILX = 0 THEN GOTO NOTFOUND;
     1156    11466    2               RETURN;
     1157    11467
     1158    11468    2   NOSLS:      ;
     1159    11469    2               B$JIT.ERR=E_JSISLS;
     1160    11470        /*E* ERROR:        FOS-E$JSISLS-E
     1161    11471             MESSAGE:      Insufficient M$JOBSTATS serial number list space
     1162    11472             MESSAGE1:     While performing an M$JOBSTATS SRCH (batch queue)
     1163    11473                           service, you have specified too few frames in the
     1164    11474                           serial number list (SNLIST_) results area. */
     1165    11475    2               RETURN;
     1166    11476
     1167    11477    2   NORSPACE:
     1168    11478    2               B$JIT.ERR = E_JSIRAS;
     1169    11479        /*E* ERROR:        FOS-E$JSIRAS-E
     1170    11480             MESSAGE:      Insufficient number of M$JOBSTATS results frames.
     1171    11481             MESSAGE1:     While performing an M$JOBSTATS SPILL or SRCH service,
     1172    11482                           you have specified too few frames in the primary (RESULTS_)
     1173    11483                           results area.  */
     1174    11484    2               RETURN;
     1175    11485
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:38   
     1176    11486        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:39   
     1177    11487
     1178    11488
     1179    11489
     1180    11490
     1181    11491        /**
     1182    11492         **
     1183    11493         **
     1184    11494         **      UNKNOWN FUNCTION CODE
     1185    11495         **
     1186    11496         **
     1187    11497         **/
     1188    11498    2             CASE (ELSE);
     1189    11499    2               B$JIT.ERR=E_BADFC;
     1190    11500        /*E* ERROR:        FOS-E$BADFC-E
     1191    11501             MESSAGE:      Unknown M$JOBSTATS function code
     1192    11502             DESCRIPTION:  The function code (order) passed with M$JOBSTATS
     1193    11503                           was unknown.  */
     1194    11504    2               RETURN;
     1195    11505
     1196    11506
     1197    11507
     1198    11508        /***
     1199    11509         ***
     1200    11510         ***
     1201    11511         ***          END OF M$JOBSTATS FUNCTION CODE DO CASE
     1202    11512         ***
     1203    11513         ***
     1204    11514         ***/
     1205    11515    2           END;
     1206    11516        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:40   
     1207    11517        /**************************************
     1208    11518         **************************************
     1209    11519                    RELSEG
     1210    11520         **************************************
     1211    11521         **************************************/
     1212    11522        /*D* NAME:         RELSEG
     1213    11523             PURPOSE:      To wipe out a status segment
     1214    11524        */
     1215    11525    1   RELSEG: PROC (SEG#);
     1216    11526        /**/
     1217    11527    2   DCL SEG# UBIN WORD;
     1218    11528        /**/
     1219    11529    2         IF FOS_SEG$(SEG#) ~= ADDR(NIL) THEN
     1220    11530    3           DO;
     1221    11531    3           CALL MMS$VREL (FOS_WSQ,FOS_SEG$(SEG#));
     1222    11532    3           FOS_SEG$(SEG#)=ADDR(NIL);
     1223    11533    3           END;
     1224    11534    2         RETURN;
     1225    11535    2   END RELSEG;
     1226    11536        /**************************************
     1227    11537         **************************************
     1228    11538                    SET_CHECK
     1229    11539         **************************************
     1230    11540         **************************************/
     1231    11541        /*D* NAME:         SET_CHECK
     1232    11542             PURPOSE:      Inserts the status appropriate to the OUTSYM job
     1233    11543                           frame pointed to by MJOB$, into the R$CHECK results
     1234    11544                           area. Clobbers MFIL$. */
     1235    11545    1   SET_CHECK: PROC;
     1236    11546
     1237    11547    2         R$CHECK.DEVNAME=' ';
     1238    11548    2         DEVNM1=' ';
     1239    11549    2         R$CHECK.TNAME=' ';
     1240    11550    2         TNAME=' ';
     1241    11551    2         R$CHECK.AHEAD=NAHEAD;
     1242    11552    2         R$CHECK.NOF=MJOB$->FO$JOB.NFIL;
     1243    11553    2         R$CHECK.NOFDONE=MJOB$->FO$JOB.NFIL_DONE;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:41   
     1244    11554    2         R$CHECK.NOFPRINTING=MJOB$->FO$JOB.NFIL_PRINTING;
     1245    11555    2         R$CHECK.NOFSPILLED=0;
     1246    11556    2         UFIL$=MJOB$->FO$JOB.FILHD$;
     1247    11557    3           DO WHILE (UFIL$ ~= ADDR(NIL));
     1248    11558    3           MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);
     1249    11559    3           R$CHECK.DEVAVAIL=R$CHECK.DEVAVAIL|MFIL$->FO$FIL.FLG.LPAVAIL;
     1250    11560    3           IF MFIL$->FO$FIL.PRIO = FOPR_SPILLED# THEN
     1251    11561    3            R$CHECK.NOFSPILLED=R$CHECK.NOFSPILLED+1;
     1252    11562    3           IF MFIL$->FO$FIL.CDEV$ ~= ADDR(NIL) THEN
     1253    11563    4             DO;
     1254    11564    4             UDEV$=MFIL$->FO$FIL.CDEV$;
     1255    11565    4             MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);
     1256    11566    4             DEVNM1=SUBSTR(MDEV$->FO$DEV.NAME,0,4);
     1257    11567    4             TNAME=MDEV$->FO$DEV.TNAME;
     1258    11568    4             IF MDEV$->FO$DEV.NAMER.TYP = 'LP' THEN
     1259    11569    5               DO;
     1260    11570    5               R$CHECK.DEVNAME=DEVNM1;
     1261    11571    5               R$CHECK.TNAME=TNAME;
     1262    11572    5               END;
     1263    11573    4             END;
     1264    11574    3           UFIL$=MFIL$->FO$FIL.JLNK$;
     1265    11575    3           END;
     1266    11576    2         IF R$CHECK.DEVNAME = ' ' THEN
     1267    11577    3           DO;
     1268    11578    3           R$CHECK.DEVNAME=DEVNM1;
     1269    11579    3           R$CHECK.TNAME=TNAME;
     1270    11580    3           END;
     1271    11581    2         IF R$CHECK.NOFPRINTING = 0 THEN
     1272    11582    3           DO;
     1273    11583    3           IF R$CHECK.NOFSPILLED + R$CHECK.NOFDONE = R$CHECK.NOF THEN
     1274    11584    3            R$CHECK.CODE=%JS_SPILLED#;
     1275    11585    3           ELSE R$CHECK.CODE=%JS_PWAIT#;
     1276    11586    3           END;
     1277    11587    2         ELSE R$CHECK.CODE=%JS_PRT#;
     1278    11588    2         R$CHECK.SYSID=SYSID;
     1279    11589    2         RETURN;
     1280    11590    2   END SET_CHECK;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:42   
     1281    11591        /**************************************
     1282    11592         **************************************
     1283    11593                    SET_FPRIO
     1284    11594         **************************************
     1285    11595         **************************************/
     1286    11596        /*D* NAME:         SET_FPRIO
     1287    11597             PURPOSE:      To set the priority and status for a file.
     1288    11598             DESCRIPTION:  MFIL$ points to an OUTSYM file frame.  UPRIO
     1289    11599                           and UCODE are set the the appropriate prio and
     1290    11600                           status codes for that file.  Also, DEVNM is
     1291    11601                           set to the file's current device if the file
     1292    11602                           is printing. */
     1293    11603    1   SET_FPRIO: PROC;
     1294    11604
     1295    11605    2         FPRIO=MFIL$->FO$FIL.PRIO;
     1296    11606
     1297    11607    3           DO CASE (FPRIO);
     1298    11608
     1299    11609    3             CASE (FOPR_SPILLED#);
     1300    11610    3               UCODE=%FS_SPILLED#;
     1301    11611    3               UPRIO=%FP_SPILLED#;
     1302    11612
     1303    11613    3             CASE (FOPR_HOLD#);
     1304    11614    3               UCODE=%FS_HOLD#;
     1305    11615    3               UPRIO=%FP_HOLD#;
     1306    11616
     1307    11617    3             CASE (FOPR_MFW#);
     1308    11618    3               UCODE=%FS_MFW#;
     1309    11619    3               UPRIO=%FP_MFW#;
     1310    11620
     1311    11621    3             CASE (ELSE);
     1312    11622    3               UCODE=%FS_PWAIT#;
     1313    11623    3               IF  FPRIO >= FOPR_P0#
     1314    11624    3               AND FPRIO <= FOPR_P15# THEN
     1315    11625    4                 DO;
     1316    11626    4                 UPRIO=FPRIO-FOPR_P0#;
     1317    11627    4                 UDEV$=MFIL$->FO$FIL.CDEV$;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:43   
     1318    11628    4                 IF UDEV$ ~= ADDR(NIL) THEN
     1319    11629    5                   DO;
     1320    11630    5                   UCODE=%FS_PRT#;
     1321    11631    5                   MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);
     1322    11632    5                   DEVNM=SUBSTR(MDEV$->FO$DEV.NAME,0,4);
     1323    11633    5                   END;
     1324    11634    4                 END;
     1325    11635    3               ELSE UPRIO=%FP_OTHER#;
     1326    11636
     1327    11637    3           END;
     1328    11638    2         RETURN;
     1329    11639    2   END SET_FPRIO;
     1330    11640        /**************************************
     1331    11641         **************************************
     1332    11642                    DOCHECK
     1333    11643         **************************************
     1334    11644         **************************************/
     1335    11645        /*D* NAME:         DOCHECK
     1336    11646             PURPOSE:      To perform a check function
     1337    11647             DESCRIPTION:  The R$CHECK results area is filled with the
     1338    11648                           appropriate status for the specified job.
     1339    11649                           All fields are set to their default values
     1340    11650                           which would be correct if the job (or files
     1341    11651                           belonging thereto) were not found (e.g. DEVNM
     1342    11652                           is set to blanks).
     1343    11653        */
     1344    11654    1   DOCHECK: PROC;
     1345    11655
     1346    11656              /* Make sure we have a RESULTS_ */
     1347    11657    2         CALL HFF$DSIZ (2, RSIZ) ALTRET (NO_RESULTS_VECTOR);
     1348    11658
     1349    11659    3           DO WHILE ( '0'B );
     1350    11660    3   NO_RESULTS_VECTOR:
     1351    11661    3           B$JIT.ERR = E_JSNORESULTS;
     1352    11662    3           RETURN;
     1353    11663    3           END;
     1354    11664
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:44   
     1355    11665              /* We have a RESULTS_, but is it big enough? */
     1356    11666    2         IF RSIZ < SIZEC (RCHECK_INIT)
     1357    11667    2         THEN
     1358    11668    3           DO;
     1359    11669    3           B$JIT.ERR = E_JSIRPS;
     1360    11670    3           RETURN;
     1361    11671    3           END;
     1362    11672
     1363    11673    2         R$CHECK=RCHECK_INIT;
     1364    11674    2         R$CHECK.CODE=%JS_NOTF#;
     1365    11675    2         R$CHECK.FCODE=%FS_NOTF#;
     1366    11676
     1367    11677    2         CALL FINDPRE ALTRET(CHK1);
     1368    11678    2         R$CHECK.CODE=%JS_AP#;
     1369    11679    2         GOTO DONE;
     1370    11680    2   CHK1: ;
     1371    11681    2         CALL FINDOUTP ALTRET(CHK0);
     1372    11682    2         IF B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
     1373    11683    2         OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME THEN
     1374    11684    2          IF NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#) THEN
     1375    11685    2           GOTO CHK0;
     1376    11686    2         CALL SET_CHECK;
     1377    11687    2   CHK0: ;
     1378    11688    2         CALL FINDJOB ALTRET(DONE);
     1379    11689    2         IF B$JIT.ACCN ~= MJOB$->JM$IF.ACCT
     1380    11690    2         OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME THEN
     1381    11691    2          IF NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#) THEN
     1382    11692    2           GOTO DONE;
     1383    11693    2         R$CHECK.IPRIO = SUBMISSION_PRIO;
     1384    11694    2         IF JPRIO = JM_Q$RUN THEN
     1385    11695    2          R$CHECK.CODE=%JS_RUN#;
     1386    11696    2         ELSE
     1387    11697    3           DO;
     1388    11698    3           CALL SET_JPRIO;
     1389    11699    3           R$CHECK.CODE=%JS_WAIT#;
     1390    11700    3           R$CHECK.PRIO=UPRIO;
     1391    11701    3           R$CHECK.AHEAD=NAHEAD;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:45   
     1392    11702    3           END;
     1393    11703    2   DONE: ;
     1394    11704    2         R$CHECK.SYSID=SYSID;
     1395    11705    2         RETURN;
     1396    11706    2   END DOCHECK;
     1397    11707        /**************************************
     1398    11708         **************************************
     1399    11709                    SET_JPRIO
     1400    11710         **************************************
     1401    11711         **************************************/
     1402    11712        /*D* NAME:         SET_JPRIO
     1403    11713
     1404    11714             PURPOSE:      XLATES JPRIO (INDEX TO MBS QUEUES) TO
     1405    11715                           UPRIO (A LA CP_6_SUBS JP_XXXX#) */
     1406    11716    1   SET_JPRIO: PROC;
     1407    11717
     1408    11718    3           DO CASE (JPRIO);
     1409    11719
     1410    11720    3             CASE (JM_Q$WP); /* WAITING 4 PARTITION */
     1411    11721    3               UPRIO=%JP_WPART#;
     1412    11722
     1413    11723    3             CASE (JM_Q$WR); /* WAITING 4 RUNAFTER TIME */
     1414    11724    3               UPRIO=%JP_RUNAFTER#;
     1415    11725
     1416    11726    3             CASE (JM_Q$JD); /* WAITING 4 FOLLOW CONDITION */
     1417    11727    3               UPRIO=%JP_FOLL#;
     1418    11728
     1419    11729    3             CASE (JM_Q$RUN);
     1420    11730    3               UPRIO=%JP_RUN#;
     1421    11731
     1422    11732    3             CASE (JM_Q$DP);
     1423    11733    3               UPRIO=%JP_WPS#;
     1424    11734
     1425    11735    3             CASE (ELSE);
     1426    11736    3               IF  JPRIO >= JM_Q$P0
     1427    11737    3               AND JPRIO <= JM_Q$P15
     1428    11738    3               THEN UPRIO=JPRIO-JM_Q$P0;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:46   
     1429    11739    3               ELSE UPRIO=%JP_OTHER#;
     1430    11740
     1431    11741    3           END;
     1432    11742    2         RETURN;
     1433    11743    2   END SET_JPRIO;
     1434    11744        /**************************************
     1435    11745         **************************************
     1436    11746                    GET_SNS
     1437    11747         **************************************
     1438    11748         **************************************/
     1439    11749        /*D* NAME:         GET_SNS
     1440    11750             PURPOSE:      To extract SNLIST entries from an MBS chain,
     1441    11751                           and stuff them into the user's SNLIST results
     1442    11752                           area.  ALTRETs if no room in latter.  */
     1443    11753    1   GET_SNS: PROC ALTRET;
     1444    11754
     1445    11755    3           DO WHILE (USN$ ~= ADDR(NIL));
     1446    11756    3           IF SNX >= RSIZ_SN THEN ALTRETURN;
     1447    11757    3           MSN$=PINCRW(MBSSN$,USN$R.DISP);
     1448    11758    3           R$ISRCH_SN.S.NAME(SNX)=MSN$->JM$SN.TXT;
     1449    11759    3           R$ISRCH_SN.S.FLG(SNX)=MSN$->JM$SN.FLGS;
     1450    11760    3           USN$=MSN$->JM$SN.NXT$;
     1451    11761    3           RJOB$->R$JOB.NSN=RJOB$->R$JOB.NSN+1;
     1452    11762    3           SNX=SNX+1;
     1453    11763    3           END;
     1454    11764    2         RETURN;
     1455    11765    2   END GET_SNS;
     1456    11766        /**************************************
     1457    11767         **************************************
     1458    11768                    FINDJOB
     1459    11769         **************************************
     1460    11770         **************************************/
     1461    11771        /*D* NAME:         FINDJOB
     1462    11772             PURPOSE:      To find a job in the in-core status tables
     1463    11773             DESCRIPTION:  The M$JOBSTATS PMME FPT contains either a SYSID
     1464    11774                           or JOBNAME & ACCT selecting the job to be found.
     1465    11775
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:47   
     1466    11776                           The routine ALTRETs if no such job is found.
     1467    11777                           Otherwise it returns with MJOB$ pointing to
     1468    11778                           the MBS job frame.
     1469    11779
     1470    11780                           If normal return, then JPRIO is set to the
     1471    11781                           numeric MBS queue index of the job, and
     1472    11782                           NAHEAD is set to the number of jobs ahead
     1473    11783                           of it if it is not running.  Note that if
     1474    11784                           the request is by jobname, then SYSID is
     1475    11785                           set to the job's sysid. */
     1476    11786
     1477    11787
     1478    11788    1   FINDJOB: PROC ALTRET;
     1479    11789
     1480    11790                                /* SET UP PARAMS */
     1481    11791    2         CALL GET_JP;
     1482    11792
     1483    11793
     1484    11794
     1485    11795                                /* SEARCH THE MBS QUEUES */
     1486    11796
     1487    11797
     1488    11798    2         CALL GET_MBSHDR ALTRET(ALTRT);
     1489    11799
     1490    11800                           /* RUN Q 1ST */
     1491    11801    2         JPRIO=JM_Q$RUN;
     1492    11802    2         CALL SRCHQ ALTRET(S1);
     1493    11803    2         RETURN;  /* FOUND IT RUNNING */
     1494    11804
     1495    11805    2   S1:   ;
     1496    11806    2         NAHEAD=0;
     1497    11807                           /* SEARCH FROM PRIO 15 DOWN */
     1498    11808    2         JPRIO=JM_Q$P15;
     1499    11809    2   S2:   ;
     1500    11810    2         CALL SRCHQ ALTRET(S3);
     1501    11811    2         RETURN;  /* FOUND IT */
     1502    11812    2   S3:   ;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:48   
     1503    11813    2         IF JPRIO = 0 THEN ALTRETURN;
     1504    11814    2         JPRIO=JPRIO-1;
     1505    11815    2         IF JPRIO = JM_Q$FRE THEN GOTO S3;
     1506    11816    2         GOTO S2;
     1507    11817
     1508    11818
     1509    11819                                /* SUBROUTINE TO SEARCH MBS QUEUE 'JPRIO' */
     1510    11820    2   SRCHQ: PROC ALTRET;
     1511    11821
     1512    11822    3         UJOB$ = MBSHDR$->JMC$CHAINS.HEAD$(JPRIO);
     1513    11823
     1514    11824    3         IF BYSYSID=1 THEN
     1515    11825    4           DO;
     1516    11826    5             DO WHILE (UJOB$ ~= ADDR(NIL));
     1517    11827    5             MJOB$ = PINCRW(MBSJOB$,UJOB$R.DISP);
     1518    11828    5             IF MJOB$->JM$IF.SYSID = SYSID THEN
     1519    11829    6               DO;
     1520    11830    6               SUBMISSION_PRIO = MJOB$->JM$IF.PRIO;
     1521    11831    6               RETURN;
     1522    11832    6               END;
     1523    11833    5             NAHEAD=NAHEAD+1;
     1524    11834    5             UJOB$=MJOB$->JM$IF.LNK$;
     1525    11835    5             END;
     1526    11836    4           ALTRETURN;
     1527    11837    4           END;
     1528    11838
     1529    11839    4           DO WHILE (UJOB$ ~= ADDR(NIL));
     1530    11840    4           MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);
     1531    11841    4           IF MJOB$->JM$IF.ACCT = ACCT
     1532    11842    4           AND MJOB$->JM$IF.JNAME = JOBNAME THEN
     1533    11843    5             DO;
     1534    11844    5             SYSID=MJOB$->JM$IF.SYSID;
     1535    11845    5             SUBMISSION_PRIO = MJOB$->JM$IF.PRIO;
     1536    11846    5             RETURN;
     1537    11847    5             END;
     1538    11848    4           NAHEAD=NAHEAD+1;
     1539    11849    4           UJOB$=MJOB$->JM$IF.LNK$;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:49   
     1540    11850    4           END;
     1541    11851    3         ALTRETURN;
     1542    11852    3   END SRCHQ;
     1543    11853
     1544    11854
     1545    11855
     1546    11856    2   ALTRT:;
     1547    11857    2         ALTRETURN;
     1548    11858    2   END FINDJOB;
     1549    11859        /**************************************
     1550    11860         **************************************
     1551    11861                    FINDPRE
     1552    11862         **************************************
     1553    11863         **************************************/
     1554    11864        /*D* NAME:         FINDPRE
     1555    11865             PURPOSE:      To find a job, in the in-core status tables
     1556    11866             DESCRIPTION:  Like FINDJOB but looks for an PRESCAN job
     1557    11867                           frame.  */
     1558    11868
     1559    11869    1   FINDPRE: PROC ALTRET;
     1560    11870
     1561    11871    2         CALL GET_JP;
     1562    11872    2         IF BYSYSID = 0 THEN ALTRETURN;
     1563    11873    2         CALL GET_PREHDR ALTRET(ALTRT);
     1564    11874    2         UJOB$=PREHDR$->JP$Q.HEAD$;
     1565    11875    3           DO WHILE (UJOB$ ~= ADDR(NIL));
     1566    11876    3           MJOB$=PINCRW(PREJOB$,UJOB$R.DISP);
     1567    11877    3           IF SYSID = MJOB$->JP$JOB.SYSID THEN RETURN;
     1568    11878    3           UJOB$=MJOB$->JP$JOB.LNK$;
     1569    11879    3           END;
     1570    11880    2         UJOB$=PREHDR$->JP$Q.SCAN$;
     1571    11881    3           DO WHILE (UJOB$ ~= ADDR(NIL));
     1572    11882    3           MJOB$=PINCRW(PREJOB$,UJOB$R.DISP);
     1573    11883    3           IF SYSID = MJOB$->JP$JOB.SYSID THEN RETURN;
     1574    11884    3           UJOB$=MJOB$->JP$JOB.LNK$;
     1575    11885    3           END;
     1576    11886    2   ALTRT:;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:50   
     1577    11887    2         ALTRETURN;
     1578    11888    2   END FINDPRE;
     1579    11889        /**************************************
     1580    11890         **************************************
     1581    11891                    FINDOUTP
     1582    11892         **************************************
     1583    11893         **************************************/
     1584    11894        /*D* NAME:         FINDOUTP
     1585    11895             PURPOSE:      To find output for a job, in the in-core status tables
     1586    11896             DESCRIPTION:  Like FINDJOB but looks for an appropriate
     1587    11897                           output file.
     1588    11898                           If successful returns
     1589    11899                            MJOB$             OUTSYM job frame
     1590    11900                            MFIL$             OUTSYM file frame for highest-
     1591    11901                                              prio file
     1592    11902                            SYSID             sysid if jobname check
     1593    11903                            NAHEAD            number of files ahead of MFIL$
     1594    11904        */
     1595    11905    1   FINDOUTP: PROC ALTRET;
     1596    11906        /**/
     1597    11907    2   DCL SPECIFIC UBIN;
     1598    11908        /**/
     1599    11909    2         SPECIFIC=0;
     1600    11910    2         GOTO FIND;
     1601    11911        /**/
     1602    11912        /*D* NAME:         FINDOUTPF
     1603    11913             PURPOSE:      To find a particular output file
     1604    11914             DESCRIPTION:  Like FINDOUTP but looks for the specific file
     1605    11915                           FPT$JOBSTATS_V.NUM.
     1606    11916        */
     1607    11917    2   FINDOUTPF: ENTRY ALTRET;
     1608    11918        /**/
     1609    11919    2         SPECIFIC=1;
     1610    11920    2   FIND: ;
     1611    11921    2         CALL GET_JP;
     1612    11922    2         CALL GET_SYMHDR ALTRET(ALTRT);
     1613    11923    2         NAHEAD=-1;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:51   
     1614    11924    2         OPRIO=FOPR_MAX#;
     1615    11925    2   S2:   CALL SRCHQ ALTRET(S3);
     1616    11926    2         RETURN;
     1617    11927    2   S3:   IF OPRIO = 0 THEN ALTRETURN;
     1618    11928    2         OPRIO=OPRIO-1;
     1619    11929    2         GOTO S2;
     1620    11930    2   ALTRT:;
     1621    11931    2         ALTRETURN;
     1622    11932                                /* Search OUTSYM queue OPRIO */
     1623    11933    2   SRCHQ: PROC ALTRET;
     1624    11934    3         UFIL$=SYMHDR$->FO$Q.FILHD$(OPRIO);
     1625    11935    4           DO WHILE (UFIL$ ~= ADDR(NIL));
     1626    11936    4           MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);
     1627    11937    4           UJOB$=MFIL$->FO$FIL.OJOB$;
     1628    11938    4           MJOB$=PINCRW(SYMJOB$,UJOB$R.DISP);
     1629    11939    4           IF BYSYSID = 1 THEN
     1630    11940    5             DO;
     1631    11941    5             IF MFIL$->FO$FIL.SYSID = SYSID THEN
     1632    11942    6   GOTJOB:     DO;
     1633    11943    6               IF NAHEAD < 0 THEN
     1634    11944    6                NAHEAD=MFIL$->FO$FIL.AHEAD;
     1635    11945    6               SYSID=MFIL$->FO$FIL.SYSID;
     1636    11946    6               IF SPECIFIC = 0
     1637    11947    6               OR MFIL$->FO$FIL.NUM = FPT$JOBSTATS_V.NUM THEN
     1638    11948    6                RETURN;
     1639    11949    6               END;
     1640    11950    5             END;
     1641    11951    4           ELSE
     1642    11952    4            IF MJOB$->FO$JOB.ACCT = ACCT
     1643    11953    4            AND MJOB$->FO$JOB.JOBNAME = JOBNAME THEN
     1644    11954    4             GOTO GOTJOB;
     1645    11955    4           UFIL$=MFIL$->FO$FIL.LNK$;
     1646    11956    4           END;
     1647    11957    3         ALTRETURN;
     1648    11958    3   END SRCHQ;
     1649    11959    2   END FINDOUTP;
     1650    11960        /**************************************
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:52   
     1651    11961         **************************************
     1652    11962                    GET_JP
     1653    11963         **************************************
     1654    11964         **************************************/
     1655    11965        /*D* NAME:         GET_JP
     1656    11966             PURPOSE:      To extract params from the FPT
     1657    11967             DESCRIPTION:  This routine returns with the following set up:
     1658    11968
     1659    11969                           1) ACCT is the desired account (either from
     1660    11970                              the FPT or the current JIT if the FPT did not
     1661    11971                              specify ACCT.
     1662    11972
     1663    11973                           2) BYSYSID=1 and SYSID= desired SYSID
     1664    11974
     1665    11975                           or
     1666    11976
     1667    11977                           3) BYSYSID=0 and JOBNAME= desired job name */
     1668    11978
     1669    11979    1   GET_JP: PROC;
     1670    11980
     1671    11981                                /* SET CORRECT ACCT */
     1672    11982    2         ACCT=B$JIT.ACCN;
     1673    11983    2         CALL HFF$NILERASE (5) ALTRET(NOACCN);
     1674    11984    2         ACCT=VLP$ACCT.ACCT;
     1675    11985    2   NOACCN:;
     1676    11986    2         BYSYSID=1;
     1677    11987    2         SYSID=FPT$JOBSTATS_V.SYSID;
     1678    11988    2         CALL HFF$NILERASE (4) ALTRET(NONAME);
     1679    11989    2         BYSYSID=0;
     1680    11990    2         JOBNAME=VLP$JOBNAME.JOBNAME;
     1681    11991    2   NONAME:;
     1682    11992    2         RETURN;
     1683    11993    2   END GET_JP;
     1684    11994        /**************************************
     1685    11995         **************************************
     1686    11996                    GET_PREHDR
     1687    11997         **************************************
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:53   
     1688    11998         **************************************/
     1689    11999        /*D* NAME:         GET_PREHDR
     1690    12000             PURPOSE:      To get the pointer to the PRESCAN queues header.
     1691    12001             DESCRIPTION:  The routine PMMEXITs if PRESCAN is still doing
     1692    12002                           its initialization.  Otherwise, it returns when
     1693    12003                           PRESCAN's queues lock is clear, and altreturns if
     1694    12004                           the user has hit break while waiting for the lock
     1695    12005                           to clear (in which case PRESCAN may be stuck.)  */
     1696    12006    1   GET_PREHDR: PROC ALTRET;
     1697    12007
     1698    12008    2   AGAIN:;
     1699    12009    2         PREHDR$=FOS_SEG$(FOSS_PREHDR#);
     1700    12010    2         IF PREHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;
     1701    12011    2         IF PREHDR$->JP$Q.RCVR ~= 0 THEN
     1702    12012    2   STILL_RECOVERING:
     1703    12013    3           DO;
     1704    12014    3           B$JIT.ERR=E_SQRCVR;
     1705    12015        /*E* ERROR:   FOS-E$SQRCVR-E
     1706    12016             MESSAGE:      Symbiont queue recovery in progress.
     1707    12017             MESSAGE1:     Your job status service request cannot be processed
     1708    12018                           because the job status information is being recovered.
     1709    12019             DESCRIPTION:  One of the ghosts who supply the jobstats information
     1710    12020                           is still performing his post-boot recovery. */
     1711    12021    3           CALL UDB$PMMEXIT;
     1712    12022    3           END STILL_RECOVERING;
     1713    12023    2         IF PREHDR$->JP$Q.LOCK ~= 0 THEN
     1714    12024    3           DO;
     1715    12025    3           CALL SSR$REG (%SS_SL,,1)
     1716    12026    3           WHENALTRETURN
     1717    12027    4             DO;
     1718    12028    4             ALTRETURN;
     1719    12029    4             END;
     1720    12030    3           GOTO AGAIN;
     1721    12031    3           END;
     1722    12032    2         PREJOB$=FOS_SEG$(FOSS_PREJOB#);
     1723    12033    2         RETURN;
     1724    12034        /**************************************
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:54   
     1725    12035         **************************************
     1726    12036                    GET_SYMHDR
     1727    12037         **************************************
     1728    12038         **************************************/
     1729    12039        /*D* NAME:         GET_SYMHDR
     1730    12040             PURPOSE:      To get the pointer to the OUTSYM queues header.
     1731    12041             DESCRIPTION:  The routine PMMEXITs if OUTSYM is still doing
     1732    12042                           its initialization.  Otherwise, it returns when
     1733    12043                           OUTSYM's queues lock is clear, and altreturns if
     1734    12044                           the user has hit break while waiting for the lock
     1735    12045                           to clear (in which case OUTSYM may be stuck.)  */
     1736    12046    2   GET_SYMHDR: ENTRY ALTRET;
     1737    12047
     1738    12048    2   SAGAIN:;
     1739    12049    2         SYMHDR$=FOS_SEG$(FOSS_SYMHDR#);
     1740    12050    2         IF SYMHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;
     1741    12051    2         IF SYMHDR$->FO$Q.RCVR ~= 0 THEN GOTO STILL_RECOVERING;
     1742    12052    2         IF SYMHDR$->FO$Q.LOCK ~= 0 THEN
     1743    12053    3           DO;
     1744    12054    3           CALL SSR$REG (%SS_SL,,1)
     1745    12055    3           WHENALTRETURN
     1746    12056    4             DO;
     1747    12057    4             ALTRETURN;
     1748    12058    4             END;
     1749    12059    3           GOTO SAGAIN;
     1750    12060    3           END;
     1751    12061    2         SYMJOB$=FOS_SEG$(FOSS_SYMJOB#);
     1752    12062    2         SYMFIL$=FOS_SEG$(FOSS_SYMFIL#);
     1753    12063    2         SYMDEV$=FOS_SEG$(FOSS_SYMDEV#);
     1754    12064    2         RETURN;
     1755    12065        /**************************************
     1756    12066         **************************************
     1757    12067                    GET_MBSHDR
     1758    12068         **************************************
     1759    12069         **************************************/
     1760    12070        /*D* NAME:         GET_MBSHDR
     1761    12071             PURPOSE:      To get the pointer to the MBS queues header.
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:55   
     1762    12072             DESCRIPTION:  The routine PMMEXITs if MBS is still doing
     1763    12073                           its initialization.  Otherwise, it returns when
     1764    12074                           MBS's queues lock is clear, and altreturns if
     1765    12075                           the user has hit break while waiting for the lock
     1766    12076                           to clear (in which case MBS may be stuck.)  */
     1767    12077    2   GET_MBSHDR: ENTRY ALTRET;
     1768    12078
     1769    12079    2   MAGAIN:;
     1770    12080    2         MBSHDR$=FOS_SEG$(FOSS_MBSHDR#);
     1771    12081    2         IF MBSHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;
     1772    12082    2         IF MBSHDR$->JMC$CH.RCVR ~= 0 THEN GOTO STILL_RECOVERING;
     1773    12083    2         IF MBSHDR$->JMC$CH.LOCK ~= 0 THEN
     1774    12084    3           DO;
     1775    12085    3           CALL SSR$REG (%SS_SL,,1)
     1776    12086    3           WHENALTRETURN
     1777    12087    4             DO;
     1778    12088    4             ALTRETURN;
     1779    12089    4             END;
     1780    12090    3           GOTO MAGAIN;
     1781    12091    3           END;
     1782    12092    2         MBSJOB$=FOS_SEG$(FOSS_MBSJOB#);
     1783    12093    2         MBSRES$=FOS_SEG$(FOSS_MBSRES#);
     1784    12094    2         RETURN;
     1785    12095    2   END GET_PREHDR;
     1786    12096        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:56   
     1787    12097        /*F* NAME:         FOS$RUND
     1788    12098             PURPOSE:      To remove M$JOBSTATS data provided by a ghost being
     1789    12099                           run down.
     1790    12100             DESCRIPTION:  When one of the system ghosts which provides some
     1791    12101                           of the M$JOBSTATS PMME information thru the FOS
     1792    12102                           wsq gets run down, the pointers to that data must
     1793    12103                           be cleared, since the data lies in the ghost's own
     1794    12104                           pages which are about to be released.  This routine
     1795    12105                           is called whenever one of these ghosts is being run
     1796    12106                           down, and clears the appropriate pointers. */
     1797    12107
     1798    12108
     1799    12109    1   FOS$RUND: ENTRY;
     1800    12110        /**/
     1801    12111
     1802    12112    1         IF S_CUN = JG_OUTSYM# THEN
     1803    12113    2           DO;
     1804    12114    2           CALL RELSEG (FOSS_SYMHDR#);
     1805    12115    2           CALL RELSEG (FOSS_SYMFIL#);
     1806    12116    2           CALL RELSEG (FOSS_SYMDEV#);
     1807    12117    2           CALL RELSEG (FOSS_SYMJOB#);
     1808    12118    2           END;
     1809    12119    1         IF S_CUN = JG_PRESCAN# THEN
     1810    12120    2           DO;
     1811    12121    2           CALL RELSEG (FOSS_PREHDR#);
     1812    12122    2           CALL RELSEG (FOSS_PREJOB#);
     1813    12123    2           END;
     1814    12124    1         RETURN;
     1815    12125        /**/
     1816    12126        /**/
     1817    12127    1   END FOS$PMME;
     1818    12128        /**/

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:57   
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   JMC$DATA.:E05TOU  cannot be made into a system file and is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   FOS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FOS$PMME.

   Procedure FOS$PMME requires 1899 words for executable code.
   Procedure FOS$PMME requires 80 words of local(AUTO) storage.

    No errors detected in file FOS$STATUS.:E05TSI    .

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:58   

 Object Unit name= FOS$PMME                                   File name= FOS$STATUS.:E05TOU
 UTS= JUL 29 '97 17:14:25.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     33     41  FOS$PMME
    1   Proc  even  none  1899   3553  FOS$PMME
    2  RoData even  none    25     31  FOS$PMME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  FOS$PMME
     1   3512                  yes      Std        0  FOS$RUND

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 SSS$BLOCK
 yes     yes           Std       4 MMS$VGET
 yes     yes           Std       1 MMS$COMPACT
 yes     yes           Std       2 HFF$DSIZ
 yes     yes           Std       3 KUW$WRITE
 yes     yes           Std       2 MMS$VREL
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       0 UDB$PMMEXIT
 yes     yes           Std       3 SSR$REG
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:59   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FOS_WSQ                               FOS_SEG$                              B$PS0$
     B$PS1$                                B$PS2$                                B$PS3$
     B$PS4$                                B$PS5$                                B$PS6$
     B$PS7$                                S_CUN                                 B$JIT$
r    J_OUTSYM                         r    J_MBS                                 FOS_JM_CITE
     FOS_FO_CITE                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:60   


        1        1        /*M* FOS$STATUS Job status co-ordinator */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOS$STATUS
       10       10
       11       11             PURPOSE:      To provide job status functions
       12       12        */
       13       13        FOS$PMME: PROC;

     13  1 000000   000000 700200 xent  FOS$PMME     TSX0  ! X66_AUTO_0
         1 000001   000120 000000                    ZERO    80,0

       14       14        /**/
       15       15        /*F* NAME:         FOS$PMME
       16       16
       17       17             PURPOSE:      To service the M$JOBSTATS PMME
       18       18        */
       19       19        /**/
       20       20
       21       21
       22       22
       23       23        /**/
       24       24        /* INCLUDES */
       25       25        /**/
       26       26        %INCLUDE CP_6_C;
       27     5505        %INCLUDE FOS_SUBS_C;
       28     5522        %INCLUDE FOS_DATA_R;
       29     5532        %INCLUDE JG_EVID_C;
       30     5757        %INCLUDE UM$CP6V_C;
       31     5944        %INCLUDE F$CP6V_C;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:61   
       32     6170        %INCLUDE B$JIT_C;
       33     6484        %INCLUDE FO_ERRORS_C;
       34     6516        %INCLUDE UD_SEV_C;
       35     6530        %INCLUDE SS_SCHED_C;
       36     6763        %INCLUDE FS$FIT;
       37     6806        %INCLUDE FOO_SUBS_C;
       38     7042        %INCLUDE FOO_MAC_C;
       39     7790        /* %INCLUDE FOO_DATA_R; */
       40     7791        %INCLUDE JP_MACRO_C;
       41     7946        %INCLUDE JM_SUBS_C;
       42     8052        %INCLUDE JM$STRUCT;
       43     8797        /* +79,82 03/07/88 DAD #CLNUP */
       44     8798        %INCLUDE JMC$DATA;
       45     8809        %INCLUDE CP_6_SUBS;
       46     9349        %INCLUDE UD_ERRORS_C;
       47     9391        %INCLUDE JG_GHOSTS_C;
       48     9481
       49     9482
       50     9483
       51     9484        /**/
       52     9485        /* MACROS */
       53     9486        /**/
       54     9487        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       55     9488        DCL 1 NAME CONSTANT ALIGNED,
       56     9489              2 * BIT(18) UNAL INIT('061723'O),
       57     9490              2 * UBIN(15) UNAL INIT(CODE),
       58     9491              2 * UBIN(3) UNAL INIT(SEV);
       59     9492        %MEND;
       60     9493
       61     9494
       62     9495
       63     9496        /**/
       64     9497        /* BASED STRUCTURES */
       65     9498        /**/
       66     9499        %B$JIT0;
       67     9588        %A$JIT6X;
       68     9591        %VLR$JOBSTATS_CHECK_V (FPTN=R$CHECK,BASED="BASED(B$PS2$)");
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:62   
       69     9596        %VLR$JOBSTATS_OSRCH_V (FPTN=R$OSRCH,BASED="BASED(B$PS2$)");
       70     9599        %VLR$JOBSTATS_ISRCH_V (FPTN=R$ISRCH,BASED="BASED(B$PS2$)");
       71     9602        %VLR$JOBSTATS_ISRCH_SN_V (FPTN=R$ISRCH_SN,BASED="BASED(B$PS6$)");
       72     9605        %VLR$JOBSTATS_ISRCH_RES_V (FPTN=R$ISRCH_RES,BASED="BASED(B$PS7$)");
       73     9608        %FPT$JOBSTATS_V (FPTN=FPT$JOBSTATS_V,BASED="BASED(B$PS0$)");
       74     9612        %VLP$JOBNAME_V (FPTN=VLP$JOBNAME,BASED="BASED(B$PS4$)");
       75     9615        %VLP$ACCT_V (FPTN=VLP$ACCT,BASED="BASED(B$PS5$)");
       76     9618        %VLP$CRITERIA_V (FPTN=VLP$CRITERIA,BASED="BASED(B$PS3$)");
       77     9630        %VLA$JOBSTATS_OSRCH_V (FPTN=R$FILE);
       78     9637        %VLA$JOBSTATS_ISRCH_V (FPTN=R$JOB);
       79     9646        %JM_IF (FPTN=JM$IF,STCLASS=BASED);
       80     9804        %JM_SN (FPTN=JM$SN,STCLASS=BASED);
       81     9843        %JM_RES (FPTN=JM$QRIT,STCLASS=BASED);
       82     9880        %FO_FIL (FPTN=FO$FIL,STCLASS=BASED);
       83     9980        %FO_DEV (FPTN=FO$DEV,STCLASS=BASED);
       84    10079        %FO_JOB (FPTN=FO$JOB,STCLASS=BASED);
       85    10126        %FO_Q   (FPTN=FO$Q  ,STCLASS=BASED);
       86    10147        %JP$Q    (NAME=JP$Q  ,STCLASS=BASED);
       87    10178        %JP$JOB  (NAME=JP$JOB,STCLASS=BASED);
       88    10188    1   DCL B$$WSN CHAR(SEL_WSNL) BASED CALIGNED;
       89    10189
       90    10190
       91    10191
       92    10192        /**/
       93    10193        /* REFS */
       94    10194        /**/
       95    10195    1   DCL B$PS0$ PTR SYMREF;
       96    10196    1   DCL B$PS1$ PTR SYMREF;
       97    10197    1   DCL B$PS2$ PTR SYMREF;
       98    10198    1   DCL B$PS3$ PTR SYMREF;
       99    10199    1   DCL B$PS4$ PTR SYMREF;
      100    10200    1   DCL B$PS5$ PTR SYMREF;
      101    10201    1   DCL B$PS6$ PTR SYMREF;
      102    10202    1   DCL B$PS7$ PTR SYMREF;
      103    10203    1   DCL S_CUN UBIN WORD SYMREF;
      104    10204    1   DCL B$JIT$ PTR SYMREF;
      105    10205    1   DCL J_OUTSYM CHAR(8) SYMREF READONLY;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:63   
      106    10206    1   DCL J_MBS CHAR(8) SYMREF READONLY;
      107    10207
      108    10208    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      109    10209    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      110    10210    1   DCL KUW$WRITE     ENTRY(3) ALTRET;
      111    10211    1   DCL MMS$COMPACT   ENTRY(1) ALTRET;
      112    10212    1   DCL MMS$VGET      ENTRY(4) ALTRET;
      113    10213    1   DCL MMS$VREL      ENTRY(2) ALTRET;
      114    10214    1   DCL SSR$REG       ENTRY(3) ALTRET;
      115    10215    1   DCL SSS$BLOCK     ENTRY;
      116    10216    1   DCL UDB$PMMEXIT   ENTRY;
      117    10217
      118    10218
      119    10219
      120    10220        /**/
      121    10221        /* STATIC */
      122    10222        /**/
      123    10223        %$ERROR (NAME=E_BADFC,CODE=%E$BADFC);
      124    10229        %$ERROR (NAME=E_NAUTHFC,CODE=%E$NAUTHFC);
      125    10235        %$ERROR (NAME=E_NVMEM,CODE=%E$NVMEM);
      126    10241        %$ERROR (NAME=E_NOTFND,CODE=%E$NOTFND);
      127    10247        %$ERROR (NAME=E_NOTYJ,CODE=%E$NOTYJ);
      128    10253        %$ERROR (NAME=E_JOBAOFF,CODE=%E$JOBAOFF);
      129    10259        %$ERROR (NAME=E_JSIRAS,CODE=%E$JSIRAS);
      130    10265        %$ERROR (NAME=E_JSIRLS,CODE=%E$JSIRLS);
      131    10271        %$ERROR (NAME=E_JSISLS,CODE=%E$JSISLS);
      132    10277        %$ERROR (NAME=E_JSNORESULTS,CODE=%E$BADVECT2);
      133    10283        %$ERROR (NAME=E_JSNOCRITERIA,CODE=%E$BADVECT3);
      134    10289        %$ERROR (NAME=E_JSIRPS,CODE=%E$JSIRPS);
      135    10295        %$ERROR (NAME=E_JSICPS,CODE=%E$JSICPS);
      136    10301        %$ERROR (NAME=E_NSPILL,CODE=%E$NSPILL);
      137    10307        %$ERROR (NAME=E_FNOTFND,CODE=%E$FNOTFND);
      138    10313        %$ERROR (NAME=E_NSPILLED,CODE=%E$NSPILLED);
      139    10319        %$ERROR (NAME=E_SQRCVR,CODE=%E$SQRCVR);
      140    10325        %JM_CITE (FPTN=FOS_JM_CITE,STCLASS=SYMREF);
      141    10375        %FO_CITE (FPTN=FOS_FO_CITE,STCLASS=SYMREF);
      142    10434        %VLR_JOBSTATS_CHECK (FPTN=RCHECK_INIT,STCLASS=CONSTANT);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:64   
      143    10453
      144    10454
      145    10455
      146    10456        /**/
      147    10457        /* AUTO */
      148    10458        /**/
      149    10459    1   DCL SEL_NORUN UBIN WORD;
      150    10460    1   DCL SEL_NSFORM UBIN WORD;
      151    10461    1   DCL SEL_PRIO UBIN WORD;
      152    10462    1   DCL SEL_TNAME SBIN WORD;
      153    10463    1   DCL SEL_ACCT SBIN WORD;
      154    10464    1   DCL SEL_WSNL UBIN WORD;
      155    10465    1   DCL SEL_FORM SBIN WORD;
      156    10466    1   DCL SEL_SYSID UBIN WORD;
      157    10467    1   DCL SEL_DEVTYP UBIN WORD;
      158    10468    1   DCL OPRIO SBIN WORD;
      159    10469    1   DCL HIPRIO SBIN WORD;
      160    10470    1   DCL LOPRIO SBIN WORD;
      161    10471    1   DCL FILX UBIN WORD;
      162    10472    1   DCL UFIL$ PTR;
      163    10473    1   DCL 1 UFIL$R REDEF UFIL$,
      164    10474    1         2 DISP UBIN HALF UNAL,
      165    10475    1         2 * UBIN HALF UNAL;
      166    10476    1   DCL SYMFIL$ PTR;
      167    10477    1   DCL MFIL$ PTR;
      168    10478    1   DCL DSIZ UBIN WORD;
      169    10479    1   DCL STATSEG UBIN WORD;
      170    10480    1   DCL JOBNAME CHAR(32);
      171    10481    1   DCL TNAME CHAR(8);
      172    10482    1   DCL SYSID UBIN WORD;
      173    10483    1   DCL BYSYSID UBIN WORD;
      174    10484    1   DCL SYMHDR$ PTR;
      175    10485    1   DCL UJOB$ PTR;
      176    10486    1   DCL 1 UJOB$R REDEF UJOB$,
      177    10487    1         2 DISP UBIN HALF UNAL,
      178    10488    1         2 * UBIN HALF UNAL;
      179    10489    1   DCL SYMJOB$ PTR;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:65   
      180    10490    1   DCL MBSJOB$ PTR;
      181    10491    1   DCL SUBMISSION_PRIO UBIN;
      182    10492    1   DCL JPRIO UBIN WORD;
      183    10493    1   DCL FPRIO UBIN WORD;
      184    10494    1   DCL MJOB$ PTR;
      185    10495    1   DCL PREHDR$ PTR;
      186    10496    1   DCL PREJOB$ PTR;
      187    10497    1   DCL MBSHDR$ PTR;
      188    10498    1   DCL NAHEAD SBIN WORD;
      189    10499    1   DCL ACCT CHAR(8);
      190    10500    1   DCL IPRIO SBIN WORD;
      191    10501    1   DCL MBSRES$ PTR;
      192    10502    1   DCL MBSSN$ REDEF MBSRES$ PTR;
      193    10503    1   DCL RFIL$ PTR;
      194    10504    1   DCL RJOB$ PTR;
      195    10505    1   DCL RSIZ UBIN WORD;
      196    10506    1   DCL RSIZ_RES UBIN WORD;
      197    10507    1   DCL RSIZ_SN UBIN WORD;
      198    10508    1   DCL CSIZ UBIN WORD;
      199    10509    1   DCL RESX UBIN WORD;
      200    10510    1   DCL SNX UBIN WORD;
      201    10511    1   DCL URES$ PTR;
      202    10512    1   DCL 1 URES$R REDEF URES$,
      203    10513    1         2 DISP UBIN HALF UNAL,
      204    10514    1         2 * UBIN HALF UNAL;
      205    10515    1   DCL USN$ PTR;
      206    10516    1   DCL 1 USN$R REDEF USN$,
      207    10517    1         2 DISP UBIN HALF UNAL,
      208    10518    1         2 * UBIN HALF UNAL;
      209    10519    1   DCL MRES$ PTR;
      210    10520    1   DCL MSN$ PTR;
      211    10521    1   DCL UPRIO UBIN WORD;
      212    10522    1   DCL ORDER UBIN WORD;
      213    10523    1   DCL UCODE UBIN WORD;
      214    10524    1   DCL SYMDEV$ PTR;
      215    10525    1   DCL DEVNM CHAR(4);
      216    10526    1   DCL DEVNM1 CHAR(4);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:66   
      217    10527    1   DCL MDEV$ PTR;
      218    10528    1   DCL UDEV$ PTR;
      219    10529    1   DCL 1 UDEV$R REDEF UDEV$,
      220    10530    1         2 DISP UBIN HALF UNAL,
      221    10531    1         2 * UBIN HALF UNAL;
      222    10532        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:67   
      223    10533
      224    10534                                /* FORCE TO MASTER CPU */
      225    10535    1         CALL SSS$BLOCK;

  10535  1 000002   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000003   000000 701000 xent               TSX1    SSS$BLOCK
         1 000004   000000 011000                    NOP     0

      226    10536    1         ORDER=FPT$JOBSTATS_V.ORDER;

  10536  1 000005   000000 470400 xsym               LDP0    B$PS0$
         1 000006   000000 235100                    LDA     0,,PR0
         1 000007   200076 755100                    STA     ORDER,,AUTO

      227    10537
      228    10538
      229    10539        /***
      230    10540         ***
      231    10541         ***
      232    10542         ***          VECTOR ON PMME FUNCTION CODE
      233    10543         ***
      234    10544         ***
      235    10545         ***/
      236    10546    2           DO CASE (ORDER);

  10546  1 000010   000013 115007                    CMPA    11,DL
         1 000011   000013 602005 1                  TNC     s:10546+3,AL
         1 000012   002160 710000 1                  TRA     s:11499
         1 000013   000026 710000 1                  TRA     s:10602
         1 000014   000121 710000 1                  TRA     s:10683
         1 000015   000466 710000 1                  TRA     SRCH
         1 000016   000322 710000 1                  TRA     s:10894
         1 000017   000153 710000 1                  TRA     s:10735
         1 000020   000461 710000 1                  TRA     s:10990
         1 000021   000241 710000 1                  TRA     s:10807
         1 000022   000124 710000 1                  TRA     s:10704
         1 000023   000436 710000 1                  TRA     s:10964
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:68   
         1 000024   000212 710000 1                  TRA     s:10776
         1 000025   000271 710000 1                  TRA     s:10843

      237    10547        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:69   
      238    10548        /**
      239    10549
      240    10550         RRRR   EEEEE  M   M   AAA   PPPP
      241    10551         R   R  E      MM MM  A   A  P   P
      242    10552         R   R  E      M M M  A   A  P   P
      243    10553         RRRR   EEEE   M   M  AAAAA  PPPP
      244    10554         R R    E      M   M  A   A  P
      245    10555         R  R   E      M   M  A   A  P
      246    10556         R   R  EEEEE  M   M  A   A  P
      247    10557
      248    10558
      249    10559         **/
      250    10560        /*D* NAME:         FOS$PMME-REMAP
      251    10561             PURPOSE:      To receive the REMAP function of the M$JOBSTATS
      252    10562                           service.
      253    10563             DESCRIPTION:  The REMAP function of M$JOBSTATS serves to make
      254    10564                           selected areas of data in certain system ghosts
      255    10565                           visible to the monitor.
      256    10566
      257    10567                           This is done by means of a special WSQ and page
      258    10568                           table, allocated at boot time.  The system ghosts
      259    10569                           involved in this process issue M$JOBSTATS REMAP
      260    10570                           to map their data into this page table whenever
      261    10571                           the area being framed changes.  The different
      262    10572                           areas mapped are called 'job status segments',
      263    10573                           and each segment has an entry in the table
      264    10574                           FOS_SEG$, consisting of a pointer relative to
      265    10575                           the JOBSTATS WSQ.  The service routines for the
      266    10576                           other M$JOBSTATS functions then look through
      267    10577                           these pointers at based structures framing the
      268    10578                           data, to obtain information.
      269    10579
      270    10580                           Since the information being examined usually
      271    10581                           consists of chains of frames, and since the
      272    10582                           ghosts can be blocked (e.g. quantum ended)
      273    10583                           while playing with the chains, it is possible
      274    10584                           for a user to issue the M$JOBSTATS call when
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:70   
      275    10585                           one of the ghosts has his chains in disarray.
      276    10586                           For this reason, each ghost owns a segment
      277    10587                           called his 'header', which contains a lock
      278    10588                           word for all his segments.  If M$JOBSTATS
      279    10589                           wants to look a segment belonging to a ghost
      280    10590                           whose lock is set, it simply sleeps for one
      281    10591                           second and tries again.  Note that all system
      282    10592                           ghosts run exclusively on the master cpu, and
      283    10593                           that M$JOBSTATS always blocks the user onto
      284    10594                           the master, thus avoiding inter-cpu interlock
      285    10595                           problems.
      286    10596        */
      287    10597
      288    10598    2             CASE (%REMAP#);

      289    10599
      290    10600
      291    10601                                /* ENSURE USER IS AUTHORIZED */
      292    10602    2               IF NOT (S_CUN = JG_MBS#

  10602  1 000026   000000 236000 xsym               LDQ     S_CUN
         1 000027   000001 116007                    CMPQ    1,DL
         1 000030   000041 600000 1                  TZE     s:10621
         1 000031   000003 116007                    CMPQ    3,DL
         1 000032   000041 600000 1                  TZE     s:10621
         1 000033   000004 116007                    CMPQ    4,DL
         1 000034   000041 600000 1                  TZE     s:10621

      293    10603    2               OR S_CUN = JG_OUTSYM#
      294    10604    2               OR S_CUN = JG_PRESCAN#) THEN
      295    10605    3                 DO;

      296    10606    3   NAUTH:        ;

  10606  1 000035                       NAUTH        null
      297    10607    3                 B$JIT.ERR=E_NAUTHFC;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:71   
  10607  1 000035   000001 236000 0                  LDQ     E_NAUTHFC
         1 000036   000000 470400 xsym               LDP0    B$JIT$
         1 000037   000012 756100                    STQ     10,,PR0

      298    10608        /*E* ERROR:        FOS-E$NAUTHFC-E
      299    10609             MESSAGE:      You are not authorized to use this function
      300    10610             MESSAGE1:     Only the MBS, PRESCAN and OUTSYM system ghosts
      301    10611                           may execute the REMAP function of M$JOBSTATS.
      302    10612                           Only users with EFT privilege may issue the
      303    10613                           SPILL/FILL functions of M$JOBSTATS.
      304    10614             DESCRIPTION:  Although any user may issue the informational forms
      305    10615                           of M$JOBSTATS, the system co-ordination function(s)
      306    10616                           are restricted to use by system processes. */
      307    10617    3                 RETURN;

  10617  1 000040   000000 702200 xent               TSX2  ! X66_ARET

      308    10618    3                 END;
      309    10619
      310    10620                                /* USER IS AOK */
      311    10621    2               STATSEG=FPT$JOBSTATS_V.STATSEG;

  10621  1 000041   000002 235100                    LDA     2,,PR0
         1 000042   200024 755100                    STA     STATSEG,,AUTO

      312    10622
      313    10623    2               CALL RELSEG (STATSEG);

  10623  1 000043   200024 631500                    EPPR1   STATSEG,,AUTO
         1 000044   200107 451500                    STP1    UDEV$+3,,AUTO
         1 000045   002164 701000 1                  TSX1    RELSEG
         1 000046   000000 011000                    NOP     0

      314    10624
      315    10625                                /* GET SIZE OF SEGMENT TO BE FRAMED */
      316    10626    2               CALL HFF$DSIZ (1,DSIZ) ALTRET(DELSEG);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:72   
  10626  1 000047   200023 630500                    EPPR0   DSIZ,,AUTO
         1 000050   200115 450500                    STP0    SPECIFIC+4,,AUTO
         1 000051   000000 236000 2                  LDQ     0
         1 000052   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 000053   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 000054   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000055   000000 701000 xent               TSX1    HFF$DSIZ
         1 000056   000120 702000 1                  TSX2    DELSEG

      317    10627    2               IF DSIZ = 0 THEN GOTO DELSEG;

  10627  1 000057   200023 235100                    LDA     DSIZ,,AUTO
         1 000060   000120 600000 1                  TZE     DELSEG

      318    10628    2               CALL MMS$VGET (FOS_WSQ,B$PS1$,DSIZ,FOS_SEG$(STATSEG)) ALTRET(NOSSPACE);

  10628  1 000061   200024 720100                    LXL0    STATSEG,,AUTO
         1 000062   000000 630410 xsym               EPPR0   FOS_SEG$,X0
         1 000063   200117 450500                    STP0    SPECIFIC+6,,AUTO
         1 000064   200023 631500                    EPPR1   DSIZ,,AUTO
         1 000065   200116 451500                    STP1    SPECIFIC+5,,AUTO
         1 000066   000002 237000 2                  LDAQ    2
         1 000067   200114 757100                    STAQ    SPECIFIC+3,,AUTO
         1 000070   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 000071   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000072   000000 701000 xent               TSX1    MMS$VGET
         1 000073   000075 702000 1                  TSX2    NOSSPACE

      319    10629    2               RETURN;

  10629  1 000074   000000 702200 xent               TSX2  ! X66_ARET

  10627  1 000075                       NOSSPACE     null
      320    10630
      321    10631    2   NOSSPACE:   ;
      322    10632        /* Attempt to compress the segments and get the one we want again  */
      323    10633        /* before giving up entirely...                                    */
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:73   
      324    10634    2               CALL MMS$COMPACT(FOS_WSQ) ALTRET(NO_WAY);

  10634  1 000075   000002 630400 2                  EPPR0   2
         1 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000077   000000 701000 xent               TSX1    MMS$COMPACT
         1 000100   000101 702000 1                  TSX2    NO_WAY

      325    10635    2   NO_WAY:     CALL MMS$VGET(FOS_WSQ,B$PS1$,DSIZ,FOS_SEG$(STATSEG)) ALTRET(BLOW_OUT);

  10635  1 000101   200024 720100       NO_WAY       LXL0    STATSEG,,AUTO
         1 000102   000000 630410 xsym               EPPR0   FOS_SEG$,X0
         1 000103   200117 450500                    STP0    SPECIFIC+6,,AUTO
         1 000104   200023 631500                    EPPR1   DSIZ,,AUTO
         1 000105   200116 451500                    STP1    SPECIFIC+5,,AUTO
         1 000106   000002 237000 2                  LDAQ    2
         1 000107   200114 757100                    STAQ    SPECIFIC+3,,AUTO
         1 000110   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 000111   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000112   000000 701000 xent               TSX1    MMS$VGET
         1 000113   000115 702000 1                  TSX2    BLOW_OUT

      326    10636    2               RETURN;

  10636  1 000114   000000 702200 xent               TSX2  ! X66_ARET

  10635  1 000115                       BLOW_OUT     null
      327    10637    2   BLOW_OUT:   ;
      328    10638    2               B$JIT.ERR=E_NVMEM;

  10638  1 000115   000002 236000 0                  LDQ     E_NVMEM
         1 000116   000000 470400 xsym               LDP0    B$JIT$
         1 000117   000012 756100                    STQ     10,,PR0

  10638  1 000120                       DELSEG       null
      329    10639        /*E* ERROR:        FOS-E$NVMEM-E
      330    10640             MESSAGE:      No space to map status segment in page table
      331    10641             DESCRIPTION:  The buffer passed with M$JOBSTATS REMAP is assumed
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:74   
      332    10642                           to be a segment of the in-core job status
      333    10643                           information.  This buffer is to be mapped into the
      334    10644                           page table used for framing the various segments
      335    10645                           of the in-core file.  This error occurs when the
      336    10646                           page table contains insufficient room for the
      337    10647                           mapping to be performed.  */
      338    10648
      339    10649                                /* CANNOT MAP IT ALL.  THE OLD MAPPING
      340    10650                                   HAS BEEN VREL'D SO WE MUST SET THE
      341    10651                                   POINTER TO ADDR(NIL).  HENCE FALL
      342    10652                                   THRU TO DELSEG.  */
      343    10653
      344    10654
      345    10655
      346    10656                                /* THE VECTOR FRAMING THE BUFFER TO BE
      347    10657                                   MAPPED WAS NIL.  THIS MEANS THAT THE
      348    10658                                   SPECIFIED SEGMENT IS TO DISAPPEAR,
      349    10659                                   SO WE JUST LEAVE THE POINTER ADDR(NIL).*/
      350    10660    2   DELSEG:     ;
      351    10661    2               RETURN;

  10661  1 000120   000000 702200 xent               TSX2  ! X66_ARET

      352    10662        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:75   
      353    10663        /**
      354    10664
      355    10665          CCC   H   H  EEEEE   CCC   K   K
      356    10666         C   C  H   H  E      C   C  K  K
      357    10667         C      H   H  E      C      K K
      358    10668         C      HHHHH  EEEE   C      KK
      359    10669         C      H   H  E      C      K K
      360    10670         C   C  H   H  E      C   C  K  K
      361    10671          CCC   H   H  EEEEE   CCC   K   K
      362    10672
      363    10673
      364    10674         **/
      365    10675        /*D* NAME:         FOS$PMME-CHECK
      366    10676             PURPOSE:      To receive the CHECK function of the M$JOBSTATS
      367    10677                           service
      368    10678        */
      369    10679
      370    10680    2             CASE (%CHECK#);

      371    10681
      372    10682
      373    10683    2               CALL DOCHECK;

  10683  1 000121   002453 701000 1                  TSX1    DOCHECK
         1 000122   000000 011000                    NOP     0

      374    10684    2               RETURN;

  10684  1 000123   000000 702200 xent               TSX2  ! X66_ARET

      375    10685        /**
      376    10686
      377    10687          CCC   H   H  EEEEE   CCC   K   K  FFFFF
      378    10688         C   C  H   H  E      C   C  K  K   F
      379    10689         C      H   H  E      C      K K    F
      380    10690         C      HHHHH  EEEE   C      KK     FFFF
      381    10691         C      H   H  E      C      K K    F
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:76   
      382    10692         C   C  H   H  E      C   C  K  K   F
      383    10693          CCC   H   H  EEEEE   CCC   K   K  F
      384    10694
      385    10695
      386    10696        **/
      387    10697        /*D* NAME:         FOS$PMME-CHECKF
      388    10698             PURPOSE:      To receive the CHECKF function of the M$JOBSTATS
      389    10699                           service.
      390    10700        */
      391    10701
      392    10702    2             CASE (%CHECKF#);

      393    10703
      394    10704    2               CALL DOCHECK;

  10704  1 000124   002453 701000 1                  TSX1    DOCHECK
         1 000125   000000 011000                    NOP     0

      395    10705    2               CALL FINDOUTPF ALTRET(CHKRET);

  10705  1 000126   003172 701000 1                  TSX1    FINDOUTPF
         1 000127   000152 702000 1                  TSX2    CHKRET

      396    10706    2               CALL SET_FPRIO;

  10706  1 000130   002371 701000 1                  TSX1    SET_FPRIO
         1 000131   000000 011000                    NOP     0

      397    10707    2               R$CHECK.FCODE=UCODE;

  10707  1 000132   200077 720100                    LXL0    UCODE,,AUTO
         1 000133   000000 470400 xsym               LDP0    B$PS2$
         1 000134   000004 740100                    STX0    4,,PR0

      398    10708    2               R$CHECK.FPRIO=UPRIO;

  10708  1 000135   200075 721100                    LXL1    UPRIO,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:77   
         1 000136   000004 441100                    SXL1    4,,PR0

      399    10709    2               R$CHECK.DEVNAME=DEVNM;

  10709  1 000137   200101 236100                    LDQ     DEVNM,,AUTO
         1 000140   000007 756100                    STQ     7,,PR0

      400    10710    2               R$CHECK.DEVAVAIL=MFIL$->FO$FIL.FLG.LPAVAIL;

  10710  1 000141   200022 471500                    LDP1    MFIL$,,AUTO
         1 000142   100015 236100                    LDQ     13,,PR1
         1 000143   000033 736000                    QLS     27
         1 000144   000010 676100                    ERQ     8,,PR0
         1 000145   400000 376003                    ANQ     -131072,DU
         1 000146   000010 656100                    ERSQ    8,,PR0

      401    10711    2               R$CHECK.AHEAD=MFIL$->FO$FIL.AHEAD;

  10711  1 000147   100022 236100                    LDQ     18,,PR1
         1 000150   000022 772000                    QRL     18
         1 000151   000002 756100                    STQ     2,,PR0

  10711  1 000152                       CHKRET       null
      402    10712    2   CHKRET:     ;
      403    10713    2               RETURN;

  10713  1 000152   000000 702200 xent               TSX2  ! X66_ARET

      404    10714        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:78   
      405    10715        /**
      406    10716
      407    10717         U   U  N   N  H   H   OOO   L      DDDD
      408    10718         U   U  N   N  H   H  O O O  L      D   D
      409    10719         U   U  NN  N  H   H  O O O  L      D   D
      410    10720         U   U  N N N  HHHHH  O  OO  L      D   D
      411    10721         U   U  N  NN  H   H  O   O  L      D   D
      412    10722         U   U  N   N  H   H  O   O  L      D   D
      413    10723          UUU   N   N  H   H   OOO   LLLLL  DDDD
      414    10724
      415    10725
      416    10726         **/
      417    10727        /*D* NAME:         FOS$PMME-UNHOLD
      418    10728             PURPOSE:      To receive the UNHOLD function of the M$JOBSTATS
      419    10729                           service.
      420    10730        */
      421    10731
      422    10732    2             CASE (%UNHOLD#);

      423    10733
      424    10734
      425    10735    2               CALL FINDOUTP ALTRET(NOTFOUND);

  10735  1 000153   003167 701000 1                  TSX1    FINDOUTP
         1 000154   000432 702000 1                  TSX2    NOTFOUND

      426    10736
      427    10737    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT

  10737  1 000155   000000 470400 xsym               LDP0    B$JIT$
         1 000156   200050 471500                    LDP1    MJOB$,,AUTO
         1 000157   040100 106500                    CMPC    fill='040'O
         1 000160   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 000161   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 000162   000167 601000 1                  TNZ     s:10737+10
         1 000163   040100 106500                    CMPC    fill='040'O
         1 000164   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:79   
         1 000165   100006 200014                    ADSC9   6,,PR1                   cn=1,n=12
         1 000166   000176 600000 1                  TZE     s:10750
         1 000167   000013 236100                    LDQ     11,,PR0
         1 000170   000012 376000 xsym               ANQ     B_VECTNIL+10
         1 000171   000176 601000 1                  TNZ     s:10750

      428    10738    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10738                        PR_MSYS# THEN
      429    10739    3                 DO;

  10737  1 000172                       NOTYOURJ     null
      430    10740    3   NOTYOURJ:     ;
      431    10741    3                 B$JIT.ERR=E_NOTYJ;

  10741  1 000172   000004 236000 0                  LDQ     E_NOTYJ
         1 000173   000000 470400 xsym               LDP0    B$JIT$
         1 000174   000012 756100                    STQ     10,,PR0

      432    10742        /*E* ERROR:        FOS-E$NOTYJ-E
      433    10743             MESSAGE:      M$JOBSTATS refuses to CANCEL/UNHOLD this job - it
      434    10744                           is not yours
      435    10745             MESSAGE1:     The requested job belongs to another account,
      436    10746                           therefore you are not allowed to CANCEL/UNHOLD it */
      437    10747    3                 RETURN;

  10747  1 000175   000000 702200 xent               TSX2  ! X66_ARET

      438    10748    3                 END;
      439    10749
      440    10750    2               FOS_FO_CITE.NUMR=-1;

  10750  1 000176   777777 220003                    LDX0    -1,DU
         1 000177   000001 440000 xsym               SXL0    FOS_FO_CITE+1

  10750  1 000200                       UNHOLD1      null
      441    10751    2   UNHOLD1:    ;
      442    10752    2               FOS_FO_CITE.CODE=FOEV_UHLD#;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:80   

  10752  1 000200   000011 220003                    LDX0    9,DU
         1 000201   000000 740000 xsym               STX0    FOS_FO_CITE

      443    10753    2               FOS_FO_CITE.SYSID=MJOB$->FO$JOB.SYSID;

  10753  1 000202   200050 470500                    LDP0    MJOB$,,AUTO
         1 000203   000002 221100                    LDX1    2,,PR0
         1 000204   000000 441000 xsym               SXL1    FOS_FO_CITE

  10753  1 000205                       WRITE_OUTSYM null
      444    10754    2   WRITE_OUTSYM:;
      445    10755    2               CALL KUW$WRITE (FOS_FO_CITE,LENGTHC(FOS_FO_CITE),J_OUTSYM);

  10755  1 000205   000004 630400 2                  EPPR0   4
         1 000206   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000207   000000 701000 xent               TSX1    KUW$WRITE
         1 000210   000000 011000                    NOP     0

      446    10756    2               RETURN;

  10756  1 000211   000000 702200 xent               TSX2  ! X66_ARET

      447    10757        /**
      448    10758
      449    10759         U   U  N   N  H   H   OOO   L      DDDD   FFFFF
      450    10760         U   U  N   N  H   H  O O O  L      D   D  F
      451    10761         U   U  NN  N  H   H  O O O  L      D   D  F
      452    10762         U   U  N N N  HHHHH  O  OO  L      D   D  FFFF
      453    10763         U   U  N  NN  H   H  O   O  L      D   D  F
      454    10764         U   U  N   N  H   H  O   O  L      D   D  F
      455    10765          UUU   N   N  H   H   OOO   LLLLL  DDDD   F
      456    10766
      457    10767
      458    10768        **/
      459    10769        /*D* NAME:         FOS$PMME-UNHOLDF
      460    10770             PURPOSE:      To receive the UNHOLDF function of the M$JOBSTATS
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:81   
      461    10771                           service.
      462    10772        */
      463    10773
      464    10774    2             CASE (%UNHOLDF#);

      465    10775
      466    10776    2               CALL FINDOUTPF ALTRET(FNOTFOUND);

  10776  1 000212   003172 701000 1                  TSX1    FINDOUTPF
         1 000213   000235 702000 1                  TSX2    FNOTFOUND

      467    10777    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT

  10777  1 000214   000000 470400 xsym               LDP0    B$JIT$
         1 000215   200050 471500                    LDP1    MJOB$,,AUTO
         1 000216   040100 106500                    CMPC    fill='040'O
         1 000217   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 000220   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 000221   000226 601000 1                  TNZ     s:10777+10
         1 000222   040100 106500                    CMPC    fill='040'O
         1 000223   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 000224   100006 200014                    ADSC9   6,,PR1                   cn=1,n=12
         1 000225   000231 600000 1                  TZE     s:10780
         1 000226   000013 236100                    LDQ     11,,PR0
         1 000227   000012 376000 xsym               ANQ     B_VECTNIL+10
         1 000230   000172 600000 1                  TZE     NOTYOURJ

      468    10778    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10778                        PR_MSYS# THEN
      469    10779    2                GOTO NOTYOURJ;
      470    10780    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;

  10780  1 000231   000000 473400 xsym               LDP3    B$PS0$
         1 000232   300004 220100                    LDX0    4,,PR3
         1 000233   000001 440000 xsym               SXL0    FOS_FO_CITE+1

      471    10781    2               GOTO UNHOLD1;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:82   

  10781  1 000234   000200 710000 1                  TRA     UNHOLD1

  10780  1 000235                       FNOTFOUND    null
      472    10782    2   FNOTFOUND:  ;
      473    10783    2               B$JIT.ERR=E_FNOTFND;

  10783  1 000235   000016 236000 0                  LDQ     E_FNOTFND
         1 000236   000000 470400 xsym               LDP0    B$JIT$
         1 000237   000012 756100                    STQ     10,,PR0

      474    10784        /*E* ERROR:        FOS-E$FNOTFND-E
      475    10785             MESSAGE:      M$JOBSTATS was unable to find the requested file. */
      476    10786    2               RETURN;

  10786  1 000240   000000 702200 xent               TSX2  ! X66_ARET

      477    10787        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:83   
      478    10788        /**
      479    10789
      480    10790          SSS   PPPP    III   L      L      DDDD    OOO   N   N  EEEEE
      481    10791         S   S  P   P    I    L      L      D   D  O O O  N   N  E
      482    10792         S      P   P    I    L      L      D   D  O O O  NN  N  E
      483    10793          SSS   PPPP     I    L      L      D   D  O  OO  N N N  EEEE
      484    10794             S  P        I    L      L      D   D  O   O  N  NN  E
      485    10795         S   S  P        I    L      L      D   D  O   O  N   N  E
      486    10796          SSS   P       III   LLLLL  LLLLL  DDDD    OOO   N   N  EEEEE
      487    10797
      488    10798
      489    10799        **/
      490    10800        /*D* NAME:         FOS$PMME-SPILLDONE
      491    10801             PURPOSE:      To receive the SPILLDONE function of the M$JOBSTATS
      492    10802                           service.
      493    10803        */
      494    10804
      495    10805    2             CASE (%SPILLDONE#);

      496    10806
      497    10807    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;

  10807  1 000241   000000 471400 xsym               LDP1    B$JIT$
         1 000242   100013 236100                    LDQ     11,,PR1
         1 000243   000030 376000 xsym               ANQ     B_VECTNIL+24
         1 000244   000035 600000 1                  TZE     NAUTH

      498    10808    2               CALL FINDOUTPF ALTRET(FNOTFOUND);

  10808  1 000245   003172 701000 1                  TSX1    FINDOUTPF
         1 000246   000235 702000 1                  TSX2    FNOTFOUND

      499    10809    2               IF NOT MFIL$->FO$FIL.FLG.SPILL THEN

  10809  1 000247   200022 470500                    LDP0    MFIL$,,AUTO
         1 000250   000015 236100                    LDQ     13,,PR0
         1 000251   000001 316007                    CANQ    1,DL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:84   
         1 000252   000257 601000 1                  TNZ     s:10818

      500    10810    3                 DO;

      501    10811    3                 B$JIT.ERR=E_NSPILL;

  10811  1 000253   000015 236000 0                  LDQ     E_NSPILL
         1 000254   000000 471400 xsym               LDP1    B$JIT$
         1 000255   100012 756100                    STQ     10,,PR1

      502    10812        /*E* ERROR:        FOS-E$NSPILL-E
      503    10813             MESSAGE:      That file is not marked for spill
      504    10814             MESSAGE1:     The file specified on an M$JOBSTATS SPILLDONE
      505    10815                           call was found not marked for spill. */
      506    10816    3                 RETURN;

  10816  1 000256   000000 702200 xent               TSX2  ! X66_ARET

      507    10817    3                 END;
      508    10818    2               FOS_FO_CITE.SYSID=SYSID;

  10818  1 000257   200037 720100                    LXL0    SYSID,,AUTO
         1 000260   000000 440000 xsym               SXL0    FOS_FO_CITE

      509    10819    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;

  10819  1 000261   000000 471400 xsym               LDP1    B$PS0$
         1 000262   100004 221100                    LDX1    4,,PR1
         1 000263   000001 441000 xsym               SXL1    FOS_FO_CITE+1

      510    10820    2               FOS_FO_CITE.DISP=FPT$JOBSTATS_V.DISP;

  10820  1 000264   100004 722100                    LXL2    4,,PR1
         1 000265   000001 742000 xsym               STX2    FOS_FO_CITE+1

      511    10821    2               FOS_FO_CITE.CODE=FOEV_SPLD#;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:85   
  10821  1 000266   000007 223003                    LDX3    7,DU
         1 000267   000000 743000 xsym               STX3    FOS_FO_CITE

      512    10822    2               GOTO WRITE_OUTSYM;

  10822  1 000270   000205 710000 1                  TRA     WRITE_OUTSYM

      513    10823        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:86   
      514    10824        /**
      515    10825
      516    10826         FFFFF   III   L      L
      517    10827         F        I    L      L
      518    10828         F        I    L      L
      519    10829         FFFF     I    L      L
      520    10830         F        I    L      L
      521    10831         F        I    L      L
      522    10832         F       III   LLLLL  LLLLL
      523    10833
      524    10834
      525    10835        **/
      526    10836        /*D* NAME:         FOS$PMME-FILL
      527    10837             PURPOSE:      To receive the FILL function of the M$JOBSTATS
      528    10838                           service.
      529    10839        */
      530    10840
      531    10841    2             CASE (%FILL#);

      532    10842
      533    10843    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;

  10843  1 000271   000000 471400 xsym               LDP1    B$JIT$
         1 000272   100013 236100                    LDQ     11,,PR1
         1 000273   000030 376000 xsym               ANQ     B_VECTNIL+24
         1 000274   000035 600000 1                  TZE     NAUTH

      534    10844    2               CALL FINDOUTPF ALTRET(FNOTFOUND);

  10844  1 000275   003172 701000 1                  TSX1    FINDOUTPF
         1 000276   000235 702000 1                  TSX2    FNOTFOUND

      535    10845    2               IF MFIL$->FO$FIL.PRIO ~= FOPR_SPILLED# THEN

  10845  1 000277   200022 470500                    LDP0    MFIL$,,AUTO
         1 000300   000016 236100                    LDQ     14,,PR0
         1 000301   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:87   
         1 000302   000002 116007                    CMPQ    2,DL
         1 000303   000310 600000 1                  TZE     s:10854

      536    10846    3                 DO;

      537    10847    3                 B$JIT.ERR=E_NSPILLED;

  10847  1 000304   000017 236000 0                  LDQ     E_NSPILLED
         1 000305   000000 471400 xsym               LDP1    B$JIT$
         1 000306   100012 756100                    STQ     10,,PR1

      538    10848        /*E* ERROR:        FOS-E$NSPILLED-E
      539    10849             MESSAGE:      That file is not spilled
      540    10850             MESSAGE1:     The file specified on an M$JOBSTATS FILL
      541    10851                           call was found not spilled. */
      542    10852    3                 RETURN;

  10852  1 000307   000000 702200 xent               TSX2  ! X66_ARET

      543    10853    3                 END;
      544    10854    2               FOS_FO_CITE.SYSID=SYSID;

  10854  1 000310   200037 720100                    LXL0    SYSID,,AUTO
         1 000311   000000 440000 xsym               SXL0    FOS_FO_CITE

      545    10855    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;

  10855  1 000312   000000 471400 xsym               LDP1    B$PS0$
         1 000313   100004 221100                    LDX1    4,,PR1
         1 000314   000001 441000 xsym               SXL1    FOS_FO_CITE+1

      546    10856    2               FOS_FO_CITE.DISP=FPT$JOBSTATS_V.DISP;

  10856  1 000315   100004 722100                    LXL2    4,,PR1
         1 000316   000001 742000 xsym               STX2    FOS_FO_CITE+1

      547    10857    2               FOS_FO_CITE.CODE=FOEV_FILL#;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:88   

  10857  1 000317   000010 223003                    LDX3    8,DU
         1 000320   000000 743000 xsym               STX3    FOS_FO_CITE

      548    10858    2               GOTO WRITE_OUTSYM;

  10858  1 000321   000205 710000 1                  TRA     WRITE_OUTSYM

      549    10859        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:89   
      550    10860        /**
      551    10861
      552    10862          CCC    AAA   N   N   CCC   EEEEE  L
      553    10863         C   C  A   A  N   N  C   C  E      L
      554    10864         C      A   A  NN  N  C      E      L
      555    10865         C      AAAAA  N N N  C      EEEE   L
      556    10866         C      A   A  N  NN  C      E      L
      557    10867         C   C  A   A  N   N  C   C  E      L
      558    10868          CCC   A   A  N   N   CCC   EEEEE  LLLLL
      559    10869
      560    10870
      561    10871         **/
      562    10872
      563    10873        /*D* NAME:         FOS$PMME-CANCEL
      564    10874             PURPOSE:      To receive the CANCEL function of the M$JOBSTATS
      565    10875                           service.
      566    10876             DESCRIPTION:  The given SYSID/JOBNAME.ACCT is to be cancelled
      567    10877                           if it is a running or waiting job.  Also, if the
      568    10878                           OUTPUT bit is selected in the FPT, the job's output
      569    10879                           (if any) is to be cancelled.  Note that output for
      570    10880                           a non-batch user can be cancelled in this way by
      571    10881                           simply specifiying the user's SYSID, and OUTPUT.
      572    10882
      573    10883                           This is implemented by sending an event to MBS
      574    10884                           for the job, if any, and an event to OUTSYM if
      575    10885                           OUTPUT was specified and output is present.
      576    10886                           Note that in the case of a batch job where the
      577    10887                           PMME specifies OUTPUT, an event must still be
      578    10888                           sent to OUTSYM telling him to throw away the
      579    10889                           output when it finally arrives.  */
      580    10890
      581    10891
      582    10892    2             CASE (%CANCEL#);

      583    10893
      584    10894    2               CALL FINDJOB ALTRET(CANCEL1);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:90   
  10894  1 000322   002751 701000 1                  TSX1    FINDJOB
         1 000323   000370 702000 1                  TSX2    CANCEL1

      585    10895    2               IF (B$JIT.ACCN ~= MJOB$->JM$IF.ACCT

  10895  1 000324   000000 470400 xsym               LDP0    B$JIT$
         1 000325   200050 471500                    LDP1    MJOB$,,AUTO
         1 000326   040100 106500                    CMPC    fill='040'O
         1 000327   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 000330   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 000331   000336 601000 1                  TNZ     s:10895+10
         1 000332   040100 106500                    CMPC    fill='040'O
         1 000333   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 000334   100017 000014                    ADSC9   15,,PR1                  cn=0,n=12
         1 000335   000341 600000 1                  TZE     s:10898
         1 000336   000013 236100                    LDQ     11,,PR0
         1 000337   000012 376000 xsym               ANQ     B_VECTNIL+10
         1 000340   000172 600000 1                  TZE     NOTYOURJ

      586    10896    2               OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10896                        PR_MSYS# THEN
      587    10897    2                GOTO NOTYOURJ;
      588    10898    2               SYSID=MJOB$->JM$IF.SYSID;

  10898  1 000341   100014 236100                    LDQ     12,,PR1
         1 000342   777777 376007                    ANQ     -1,DL
         1 000343   200037 756100                    STQ     SYSID,,AUTO

      589    10899    2               FOS_JM_CITE.SYSID=SYSID;

  10899  1 000344   000000 620006                    EAX0    0,QL
         1 000345   000000 440000 xsym               SXL0    FOS_JM_CITE

      590    10900    2               FOS_JM_CITE.SUBCODE=JMEC_CID#;

  10900  1 000346   000001 450000 xsym               STZ     FOS_JM_CITE+1

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:91   
      591    10901    2               FOS_JM_CITE.ACCT=MJOB$->JM$IF.ACCT;

  10901  1 000347   040000 100500                    MLR     fill='040'O
         1 000350   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 000351   000003 000010 xsym               ADSC9   FOS_JM_CITE+3            cn=0,n=8

      592    10902    2               CALL KUW$WRITE (FOS_JM_CITE,LENGTHC(FOS_JM_CITE),J_MBS);

  10902  1 000352   000010 630400 2                  EPPR0   8
         1 000353   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000354   000000 701000 xent               TSX1    KUW$WRITE
         1 000355   000000 011000                    NOP     0

      593    10903
      594    10904                                /* IF OUTPUT IS TO BE CANCELLED, THEN SEND
      595    10905                                   MESSAGE TO OUTSYM IF 'TIS RUNNING */
      596    10906    2               IF NOT FPT$JOBSTATS_V.OUTPUT

  10906  1 000356   000000 470400 xsym               LDP0    B$PS0$
         1 000357   000003 234100                    SZN     3,,PR0
         1 000360   000364 605000 1                  TPL     s:10907
         1 000361   200046 235100                    LDA     JPRIO,,AUTO
         1 000362   000026 115007                    CMPA    22,DL
         1 000363   000365 600000 1                  TZE     s:10910

      597    10907    2               OR JPRIO ~= JM_Q$RUN THEN RETURN;

  10907  1 000364   000000 702200 xent               TSX2  ! X66_ARET

      598    10908
      599    10909                                /* CANCEL THE OUTPUT TOO */
      600    10910    2               FOS_FO_CITE.BATCH=1;

  10910  1 000365   000001 220003                    LDX0    1,DU
         1 000366   000001 740000 xsym               STX0    FOS_FO_CITE+1

      601    10911    2               GOTO CANCEL2;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:92   

  10911  1 000367   000423 710000 1                  TRA     CANCEL2

  10910  1 000370                       CANCEL1      null
      602    10912
      603    10913                                /* NO JOB FOUND */
      604    10914    2   CANCEL1:    ;
      605    10915    2               CALL FINDOUTP ALTRET(NOTFOUND);

  10915  1 000370   003167 701000 1                  TSX1    FINDOUTP
         1 000371   000432 702000 1                  TSX2    NOTFOUND

      606    10916    2               IF NOT FPT$JOBSTATS_V.OUTPUT THEN

  10916  1 000372   000000 470400 xsym               LDP0    B$PS0$
         1 000373   000003 234100                    SZN     3,,PR0
         1 000374   000401 604000 1                  TMI     s:10928

      607    10917    3                 DO;

      608    10918    3                 B$JIT.ERR=E_JOBAOFF;

  10918  1 000375   000005 236000 0                  LDQ     E_JOBAOFF
         1 000376   000000 471400 xsym               LDP1    B$JIT$
         1 000377   100012 756100                    STQ     10,,PR1

      609    10919        /*E* ERROR:        FOS-E$JOBAOFF-E
      610    10920             MESSAGE:      The job to be cancelled has already run
      611    10921             MESSAGE1:     This error occurs when a CANCEL is issued but output
      612    10922                           is not to be deleted, and the job has finished
      613    10923                           running and has output waiting or printing.
      614    10924             DESCRIPTION:  As in MESSAGE1.  Note that if OUTPUT is specified,
      615    10925                           then output will be cancelled in this situation. */
      616    10926    3                 RETURN;

  10926  1 000400   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:93   
      617    10927    3                 END;
      618    10928    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT

  10928  1 000401   000000 471400 xsym               LDP1    B$JIT$
         1 000402   200050 473500                    LDP3    MJOB$,,AUTO
         1 000403   040100 106500                    CMPC    fill='040'O
         1 000404   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000405   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         1 000406   000413 601000 1                  TNZ     s:10928+10
         1 000407   040100 106500                    CMPC    fill='040'O
         1 000410   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
         1 000411   300006 200014                    ADSC9   6,,PR3                   cn=1,n=12
         1 000412   000416 600000 1                  TZE     s:10931
         1 000413   100013 236100                    LDQ     11,,PR1
         1 000414   000012 376000 xsym               ANQ     B_VECTNIL+10
         1 000415   000172 600000 1                  TZE     NOTYOURJ

      619    10929    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
             10929                        PR_MSYS# THEN
      620    10930    2                GOTO NOTYOURJ;
      621    10931    2               FOS_FO_CITE.BATCH=0;

  10931  1 000416   000000 220003                    LDX0    0,DU
         1 000417   000001 740000 xsym               STX0    FOS_FO_CITE+1

      622    10932    2               SYSID=MJOB$->FO$JOB.SYSID;

  10932  1 000420   300002 236100                    LDQ     2,,PR3
         1 000421   000022 772000                    QRL     18
         1 000422   200037 756100                    STQ     SYSID,,AUTO

  10932  1 000423                       CANCEL2      null
      623    10933    2   CANCEL2:    ;
      624    10934    2               FOS_FO_CITE.NUMR=-1;

  10934  1 000423   777777 221003                    LDX1    -1,DU
         1 000424   000001 441000 xsym               SXL1    FOS_FO_CITE+1
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:94   

  10934  1 000425                       CANCEL3      null
      625    10935    2   CANCEL3:    ;
      626    10936    2               FOS_FO_CITE.CODE=FOEV_CNCL#;

  10936  1 000425   000006 220003                    LDX0    6,DU
         1 000426   000000 740000 xsym               STX0    FOS_FO_CITE

      627    10937    2               FOS_FO_CITE.SYSID=SYSID;

  10937  1 000427   200037 721100                    LXL1    SYSID,,AUTO
         1 000430   000000 441000 xsym               SXL1    FOS_FO_CITE

      628    10938    2               GOTO WRITE_OUTSYM;

  10938  1 000431   000205 710000 1                  TRA     WRITE_OUTSYM

  10937  1 000432                       NOTFOUND     null
      629    10939                                /* COME HERE WHEN NOTHING FOUND */
      630    10940    2   NOTFOUND:   ;
      631    10941    2               B$JIT.ERR=E_NOTFND;

  10941  1 000432   000003 236000 0                  LDQ     E_NOTFND
         1 000433   000000 470400 xsym               LDP0    B$JIT$
         1 000434   000012 756100                    STQ     10,,PR0

      632    10942        /*E* ERROR:        FOS-E$NOTFND-E
      633    10943             MESSAGE:      M$JOBSTATS was unable to find the requested job(s) */
      634    10944    2               RETURN;

  10944  1 000435   000000 702200 xent               TSX2  ! X66_ARET

      635    10945        /**
      636    10946
      637    10947          CCC    AAA   N   N   CCC   EEEEE  L      FFFFF
      638    10948         C   C  A   A  N   N  C   C  E      L      F
      639    10949         C      A   A  NN  N  C      E      L      F
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:95   
      640    10950         C      AAAAA  N N N  C      EEEE   L      FFFF
      641    10951         C      A   A  N  NN  C      E      L      F
      642    10952         C   C  A   A  N   N  C   C  E      L      F
      643    10953          CCC   A   A  N   N   CCC   EEEEE  LLLLL  F
      644    10954
      645    10955
      646    10956        **/
      647    10957        /*D* NAME:         FOS$PMME-CANCELF
      648    10958             PURPOSE:      To receive the CANCELF function of the M$JOBSTATS
      649    10959                           service.
      650    10960        */
      651    10961
      652    10962    2             CASE (%CANCELF#);

      653    10963
      654    10964    2               CALL FINDOUTPF ALTRET(FNOTFOUND);

  10964  1 000436   003172 701000 1                  TSX1    FINDOUTPF
         1 000437   000235 702000 1                  TSX2    FNOTFOUND

      655    10965    2               IF (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT

  10965  1 000440   000000 470400 xsym               LDP0    B$JIT$
         1 000441   200050 471500                    LDP1    MJOB$,,AUTO
         1 000442   040100 106500                    CMPC    fill='040'O
         1 000443   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 000444   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 000445   000452 601000 1                  TNZ     s:10965+10
         1 000446   040100 106500                    CMPC    fill='040'O
         1 000447   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 000450   100006 200014                    ADSC9   6,,PR1                   cn=1,n=12
         1 000451   000455 600000 1                  TZE     s:10968
         1 000452   000013 236100                    LDQ     11,,PR0
         1 000453   000012 376000 xsym               ANQ     B_VECTNIL+10
         1 000454   000172 600000 1                  TZE     NOTYOURJ

      656    10966    2               OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME) AND NOT B$JIT.PRIV.ACTIVE & %
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:96   
             10966                        PR_MSYS# THEN
      657    10967    2                GOTO NOTYOURJ;
      658    10968    2               FOS_FO_CITE.NUM=FPT$JOBSTATS_V.NUM;

  10968  1 000455   000000 473400 xsym               LDP3    B$PS0$
         1 000456   300004 220100                    LDX0    4,,PR3
         1 000457   000001 440000 xsym               SXL0    FOS_FO_CITE+1

      659    10969    2               GOTO CANCEL3;

  10969  1 000460   000425 710000 1                  TRA     CANCEL3

      660    10970        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:97   
      661    10971        /**
      662    10972
      663    10973          SSS   PPPP    III   L      L
      664    10974         S   S  P   P    I    L      L
      665    10975         S      P   P    I    L      L
      666    10976          SSS   PPPP     I    L      L
      667    10977             S  P        I    L      L
      668    10978         S   S  P        I    L      L
      669    10979          SSS   P       III   LLLLL  LLLLL
      670    10980
      671    10981
      672    10982        **/
      673    10983        /*D* NAME:         FOS$PMME-SPILL
      674    10984             PURPOSE:      To receive the SPILL function of the M$JOBSTATS
      675    10985                           service.
      676    10986        */
      677    10987
      678    10988    2             CASE (%SPILL#);

      679    10989
      680    10990    2               IF NOT (B$JIT.PRIV.ACTIVE & %PR_FMEFT#) THEN GOTO NAUTH;

  10990  1 000461   000000 471400 xsym               LDP1    B$JIT$
         1 000462   100013 236100                    LDQ     11,,PR1
         1 000463   000030 376000 xsym               ANQ     B_VECTNIL+24
         1 000464   000035 600000 1                  TZE     NAUTH

      681    10991    2               GOTO SRCH;

  10991  1 000465   000466 710000 1                  TRA     SRCH

      682    10992
      683    10993
      684    10994        /**
      685    10995
      686    10996          SSS   RRRR    CCC   H   H
      687    10997         S   S  R   R  C   C  H   H
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:98   
      688    10998         S      R   R  C      H   H
      689    10999          SSS   RRRR   C      HHHHH
      690    11000             S  R R    C      H   H
      691    11001         S   S  R  R   C   C  H   H
      692    11002          SSS   R   R   CCC   H   H
      693    11003
      694    11004
      695    11005         **/
      696    11006        /*D* NAME:         FOS$PMME-SRCH
      697    11007             PURPOSE:      To receive the SRCH function of the M$JOBSTATS
      698    11008                           service.
      699    11009        */
      700    11010
      701    11011    2             CASE (%SRCH#);

      702    11012
      703    11013    2   SRCH:
      704    11014                    /* Get RESULTS_ size */
      705    11015    2               CALL HFF$DSIZ (2, RSIZ) ALTRET (NO_RESULTS_VECTOR);

  11015  1 000466   200063 631500       SRCH         EPPR1   RSIZ,,AUTO
         1 000467   200115 451500                    STP1    SPECIFIC+4,,AUTO
         1 000470   000013 236000 2                  LDQ     11
         1 000471   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 000472   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 000473   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000474   000000 701000 xent               TSX1    HFF$DSIZ
         1 000475   000477 702000 1                  TSX2    NO_RESULTS_VECTOR

      706    11016
      707    11017    3                 DO WHILE ( '0'B );

  11017  1 000476   000503 710000 1                  TRA     s:11028

      708    11018    3   NO_RESULTS_VECTOR:
      709    11019    3                 B$JIT.ERR = E_JSNORESULTS;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:99   
  11019  1 000477   000011 236000 0     NO_RESULTS_* LDQ     E_JSNORESULTS
         1 000500   000000 470400 xsym               LDP0    B$JIT$
         1 000501   000012 756100                    STQ     10,,PR0

      710    11020        /*E* ERROR:        FOS-E$BADVECT2-E
      711    11021             MESSAGE:      The RESULTS vector is NIL/ERASE in your M$JOBSTATS
      712    11022                           CHECK, CHECKF, SPILL, or SRCH FPT.  */
      713    11023    3                 RETURN;

  11023  1 000502   000000 702200 xent               TSX2  ! X66_ARET

      714    11024    3                 END;

      715    11025
      716    11026                    /* We need at least enough for  2 FOUND UBIN...
      717    11027                                               and  2 * UBIN... */
      718    11028    2               IF RSIZ < 8 THEN

  11028  1 000503   200063 235100                    LDA     RSIZ,,AUTO
         1 000504   000010 115007                    CMPA    8,DL
         1 000505   000512 603000 1                  TRC     s:11041

      719    11029    3                 DO;

      720    11030    3                 B$JIT.ERR = E_JSIRPS;

  11030  1 000506   000013 236000 0                  LDQ     E_JSIRPS
         1 000507   000000 470400 xsym               LDP0    B$JIT$
         1 000510   000012 756100                    STQ     10,,PR0

      721    11031        /*E* ERROR:        FOS-E$JSIRPS-E
      722    11032             MESSAGE:      Insufficient M$JOBSTATS results parameter size.
      723    11033             MESSAGE1:     While performing an M$JOBSTATS CHECK, CHECKF, SPILL,
      724    11034                           or SRCH service, you have specified too small an area
      725    11035                           to serve as a results (RESULTS_) parameter.  */
      726    11036    3                 RETURN;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:100  
  11036  1 000511   000000 702200 xent               TSX2  ! X66_ARET

      727    11037    3                 END;
      728    11038
      729    11039                    /* Discount  2 FOUND UBIN...
      730    11040                            and  2 * UBIN... */
      731    11041    2               RSIZ = RSIZ - 8;

  11041  1 000512   000010 135007                    SBLA    8,DL
         1 000513   200063 755100                    STA     RSIZ,,AUTO

      732    11042
      733    11043                    /* Get CRITERIA_ size */
      734    11044    2               CALL HFF$DSIZ (3, CSIZ) ALTRET (NO_CRITERIA_VECTOR);

  11044  1 000514   200066 630500                    EPPR0   CSIZ,,AUTO
         1 000515   200115 450500                    STP0    SPECIFIC+4,,AUTO
         1 000516   000014 236000 2                  LDQ     12
         1 000517   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 000520   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 000521   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000522   000000 701000 xent               TSX1    HFF$DSIZ
         1 000523   000525 702000 1                  TSX2    NO_CRITERIA_VECTOR

      735    11045    3                 DO WHILE ( '0'B );

  11045  1 000524   000531 710000 1                  TRA     s:11054

      736    11046    3   NO_CRITERIA_VECTOR:
      737    11047    3                 B$JIT.ERR = E_JSNOCRITERIA;

  11047  1 000525   000012 236000 0     NO_CRITERIA* LDQ     E_JSNOCRITERIA
         1 000526   000000 470400 xsym               LDP0    B$JIT$
         1 000527   000012 756100                    STQ     10,,PR0

      738    11048        /*E* ERROR:        FOS-E$BADVECT3-E
      739    11049             MESSAGE:      The CRITERIA vector is NIL/ERASE in your M$JOBSTATS
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:101  
      740    11050                           SPILL or SRCH FPT.  */
      741    11051    3                 RETURN;

  11051  1 000530   000000 702200 xent               TSX2  ! X66_ARET

      742    11052    3                 END;

      743    11053
      744    11054    2               IF CSIZ < SIZEC (VLP$CRITERIA)

  11054  1 000531   200066 235100                    LDA     CSIZ,,AUTO
         1 000532   000120 115007                    CMPA    80,DL
         1 000533   000540 603000 1                  TRC     s:11067

      745    11055    2               THEN
      746    11056    3                 DO;

      747    11057    3                 B$JIT.ERR = E_JSICPS;

  11057  1 000534   000014 236000 0                  LDQ     E_JSICPS
         1 000535   000000 470400 xsym               LDP0    B$JIT$
         1 000536   000012 756100                    STQ     10,,PR0

      748    11058        /*E* ERROR:        FOS-E$JSICPS-E
      749    11059             MESSAGE:      Insufficient M$JOBSTATS criteria parameter size.
      750    11060             MESSAGE1:     While performing an M$JOBSTATS SPILL or SRCH service,
      751    11061                           you have specified too small an area to serve as a
      752    11062                           criteria (CRITERIA_) parameter.  */
      753    11063    3                 RETURN;

  11063  1 000537   000000 702200 xent               TSX2  ! X66_ARET

      754    11064    3                 END;
      755    11065
      756    11066                                /* SET UP FLAGS FOR COMMON CRITERIA */
      757    11067    2               IF VLP$CRITERIA.ACCT ~= ' ' THEN

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:102  
  11067  1 000540   000000 470400 xsym               LDP0    B$PS3$
         1 000541   000004 237100                    LDAQ    4,,PR0
         1 000542   000016 117000 2                  CMPAQ   14
         1 000543   000554 600000 1                  TZE     s:11069

      758    11068    2                IF VLP$CRITERIA.NOTACCT THEN SEL_ACCT=-1; ELSE SEL_ACCT=1;

  11068  1 000544   000010 430100                    FSZN    8,,PR0
         1 000545   000551 605000 1                  TPL     s:11068+5

  11068  1 000546   000001 335007                    LCA     1,DL
         1 000547   200007 755100                    STA     SEL_ACCT,,AUTO
         1 000550   000555 710000 1                  TRA     s:11070

  11068  1 000551   000001 235007                    LDA     1,DL
         1 000552   200007 755100                    STA     SEL_ACCT,,AUTO
         1 000553   000555 710000 1                  TRA     s:11070

      759    11069    2               ELSE SEL_ACCT=0;

  11069  1 000554   200007 450100                    STZ     SEL_ACCT,,AUTO

      760    11070    2               IF VLP$CRITERIA.SYSID ~= 0 THEN SEL_SYSID=1;

  11070  1 000555   000006 235100                    LDA     6,,PR0
         1 000556   000562 600000 1                  TZE     s:11071

  11070  1 000557   000001 235007                    LDA     1,DL
         1 000560   200012 755100                    STA     SEL_SYSID,,AUTO
         1 000561   000563 710000 1                  TRA     s:11072

      761    11071    2               ELSE SEL_SYSID=0;

  11071  1 000562   200012 450100                    STZ     SEL_SYSID,,AUTO

      762    11072    2               IF NOT FPT$JOBSTATS_V.OUTPUT

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:103  
  11072  1 000563   000000 471400 xsym               LDP1    B$PS0$
         1 000564   100003 234100                    SZN     3,,PR1
         1 000565   000571 604000 1                  TMI     s:11083
         1 000566   200076 235100                    LDA     ORDER,,AUTO
         1 000567   000005 115007                    CMPA    5,DL
         1 000570   001354 601000 1                  TNZ     ISRCH

      763    11073    2               AND ORDER ~= %SPILL# THEN GOTO ISRCH;
      764    11074
      765    11075        /**
      766    11076         **
      767    11077         **      SEARCH OUTPUT QUEUES
      768    11078         **
      769    11079         **/
      770    11080
      771    11081                                /* CALC NUMBER OF FILE FRAMES PRESENT
      772    11082                                   IN RESULTS AREA */
      773    11083    2               RSIZ=RSIZ/LENGTHC(R$FILE);

  11083  1 000571   200063 236100                    LDQ     RSIZ,,AUTO
         1 000572   000001 772000                    QRL     1
         1 000573   000070 506007                    DIV     56,DL
         1 000574   200063 756100                    STQ     RSIZ,,AUTO

      774    11084
      775    11085    2               IF VLP$CRITERIA.WSN ~= ' ' THEN

  11085  1 000575   000002 237100                    LDAQ    2,,PR0
         1 000576   000016 117000 2                  CMPAQ   14
         1 000577   000605 600000 1                  TZE     s:11087

      776    11086    2                CALL INDEX (SEL_WSNL,'?',VLP$CRITERIA.WSN);

  11086  1 000600   000000 124500                    SCM     mask='000'O
         1 000601   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         1 000602   000020 000001 2                  ADSC9   16                       cn=0,n=1
         1 000603   200010 000100                    ARG     SEL_WSNL,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:104  
         1 000604   000606 710000 1                  TRA     s:11089

      777    11087    2               ELSE SEL_WSNL=0;

  11087  1 000605   200010 450100                    STZ     SEL_WSNL,,AUTO

      778    11088
      779    11089    2               IF VLP$CRITERIA.FORM ~= ' ' THEN

  11089  1 000606   040000 106500                    CMPC    fill='040'O
         1 000607   000015 000006                    ADSC9   13,,PR0                  cn=0,n=6
         1 000610   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000611   000623 600000 1                  TZE     s:11091

      780    11090    2                IF VLP$CRITERIA.NOTFORM THEN SEL_FORM=-1; ELSE SEL_FORM=1;

  11090  1 000612   000010 236100                    LDQ     8,,PR0
         1 000613   000100 316003                    CANQ    64,DU
         1 000614   000620 600000 1                  TZE     s:11090+6

  11090  1 000615   000001 335007                    LCA     1,DL
         1 000616   200011 755100                    STA     SEL_FORM,,AUTO
         1 000617   000624 710000 1                  TRA     s:11092

  11090  1 000620   000001 235007                    LDA     1,DL
         1 000621   200011 755100                    STA     SEL_FORM,,AUTO
         1 000622   000624 710000 1                  TRA     s:11092

      781    11091    2               ELSE SEL_FORM=0;

  11091  1 000623   200011 450100                    STZ     SEL_FORM,,AUTO

      782    11092    2               IF VLP$CRITERIA.TNAME ~= ' ' THEN

  11092  1 000624   000000 237100                    LDAQ    0,,PR0
         1 000625   000016 117000 2                  CMPAQ   14
         1 000626   000640 600000 1                  TZE     s:11094
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:105  

      783    11093    2                IF VLP$CRITERIA.NOTTNAME THEN SEL_TNAME=-1; ELSE SEL_TNAME=1;

  11093  1 000627   000010 236100                    LDQ     8,,PR0
         1 000630   000200 316003                    CANQ    128,DU
         1 000631   000635 600000 1                  TZE     s:11093+6

  11093  1 000632   000001 335007                    LCA     1,DL
         1 000633   200006 755100                    STA     SEL_TNAME,,AUTO
         1 000634   000641 710000 1                  TRA     s:11096

  11093  1 000635   000001 235007                    LDA     1,DL
         1 000636   200006 755100                    STA     SEL_TNAME,,AUTO
         1 000637   000641 710000 1                  TRA     s:11096

      784    11094    2               ELSE SEL_TNAME=0;

  11094  1 000640   200006 450100                    STZ     SEL_TNAME,,AUTO

      785    11095
      786    11096    2               IF VLP$CRITERIA.DEVTYP ~= ' ' THEN SEL_DEVTYP=1;

  11096  1 000641   000013 220100                    LDX0    11,,PR0
         1 000642   040040 100003                    CMPX0   16416,DU
         1 000643   000647 600000 1                  TZE     s:11097

  11096  1 000644   000001 235007                    LDA     1,DL
         1 000645   200013 755100                    STA     SEL_DEVTYP,,AUTO
         1 000646   000650 710000 1                  TRA     s:11099

      787    11097    2               ELSE SEL_DEVTYP=0;

  11097  1 000647   200013 450100                    STZ     SEL_DEVTYP,,AUTO

      788    11098
      789    11099    2               CALL GET_SYMHDR ALTRET(NOTFOUND);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:106  
  11099  1 000650   003416 701000 1                  TSX1    GET_SYMHDR
         1 000651   000432 702000 1                  TSX2    NOTFOUND

      790    11100
      791    11101    2               FILX=0;

  11101  1 000652   200017 450100                    STZ     FILX,,AUTO

      792    11102    2               R$OSRCH.FOUND=0;

  11102  1 000653   000000 470400 xsym               LDP0    B$PS2$
         1 000654   000000 450100                    STZ     0,,PR0

      793    11103
      794    11104                                /* DECIDE WHICH PRIO CHAIN(S) TO SRCH */
      795    11105    2               IF VLP$CRITERIA.MFW THEN

  11105  1 000655   000000 470400 xsym               LDP0    B$PS3$
         1 000656   000010 236100                    LDQ     8,,PR0
         1 000657   100000 316003                    CANQ    32768,DU
         1 000660   000665 600000 1                  TZE     s:11110

      796    11106    3                 DO;

      797    11107    3                 LOPRIO=FOPR_MFW#;

  11107  1 000661   000001 235007                    LDA     1,DL
         1 000662   200016 755100                    STA     LOPRIO,,AUTO

      798    11108    3                 HIPRIO=LOPRIO;

  11108  1 000663   200015 755100                    STA     HIPRIO,,AUTO

      799    11109    3                 END;

  11109  1 000664   000726 710000 1                  TRA     s:11133

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:107  
      800    11110    2               ELSE IF VLP$CRITERIA.HOLD THEN

  11110  1 000665   040000 316003                    CANQ    16384,DU
         1 000666   000673 600000 1                  TZE     s:11115

      801    11111    3                  DO;

      802    11112    3                  LOPRIO=FOPR_HOLD#;

  11112  1 000667   200016 450100                    STZ     LOPRIO,,AUTO

      803    11113    3                  HIPRIO=LOPRIO;

  11113  1 000670   200016 235100                    LDA     LOPRIO,,AUTO
         1 000671   200015 755100                    STA     HIPRIO,,AUTO

      804    11114    3                  END;

  11114  1 000672   000726 710000 1                  TRA     s:11133

      805    11115    2                ELSE IF VLP$CRITERIA.SPILLED AND ORDER ~= %SPILL# THEN

  11115  1 000673   004000 316003                    CANQ    2048,DU
         1 000674   000704 600000 1                  TZE     s:11120
         1 000675   200076 235100                    LDA     ORDER,,AUTO
         1 000676   000005 115007                    CMPA    5,DL
         1 000677   000704 600000 1                  TZE     s:11120

      806    11116    3                   DO;

      807    11117    3                   LOPRIO=FOPR_SPILLED#;

  11117  1 000700   000002 235007                    LDA     2,DL
         1 000701   200016 755100                    STA     LOPRIO,,AUTO

      808    11118    3                   HIPRIO=LOPRIO;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:108  
  11118  1 000702   200015 755100                    STA     HIPRIO,,AUTO

      809    11119    3                   END;

  11119  1 000703   000726 710000 1                  TRA     s:11133

      810    11120    2                 ELSE IF VLP$CRITERIA.PRIO > 15

  11120  1 000704   000011 235100                    LDA     9,,PR0
         1 000705   000020 115007                    CMPA    16,DL
         1 000706   000715 603000 1                  TRC     s:11124
         1 000707   000012 235100                    LDA     10,,PR0
         1 000710   000020 115007                    CMPA    16,DL
         1 000711   000715 603000 1                  TRC     s:11124
         1 000712   000012 236100                    LDQ     10,,PR0
         1 000713   000011 116100                    CMPQ    9,,PR0
         1 000714   000721 603000 1                  TRC     s:11129

      811    11121    2                  OR VLP$CRITERIA.PRIO1 > 15
      812    11122    2                  OR VLP$CRITERIA.PRIO > VLP$CRITERIA.PRIO1 THEN
      813    11123    3                    DO;

      814    11124    3                    LOPRIO=0;

  11124  1 000715   200016 450100                    STZ     LOPRIO,,AUTO

      815    11125    3                    HIPRIO=FOPR_MAX#;

  11125  1 000716   000022 235007                    LDA     18,DL
         1 000717   200015 755100                    STA     HIPRIO,,AUTO

      816    11126    3                    END;

  11126  1 000720   000726 710000 1                  TRA     s:11133

      817    11127    2                  ELSE
      818    11128    3                    DO;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:109  

      819    11129    3                    LOPRIO=VLP$CRITERIA.PRIO+FOPR_P0#;

  11129  1 000721   000011 235100                    LDA     9,,PR0
         1 000722   000003 035007                    ADLA    3,DL
         1 000723   200016 755100                    STA     LOPRIO,,AUTO

      820    11130    3                    HIPRIO=VLP$CRITERIA.PRIO1+FOPR_P0#;

  11130  1 000724   000003 036007                    ADLQ    3,DL
         1 000725   200015 756100                    STQ     HIPRIO,,AUTO

      821    11131    3                    END;

      822    11132
      823    11133    2               IF VLP$CRITERIA.NSFORM THEN SEL_NSFORM=1;

  11133  1 000726   000010 236100                    LDQ     8,,PR0
         1 000727   020000 316003                    CANQ    8192,DU
         1 000730   000734 600000 1                  TZE     s:11134

  11133  1 000731   000001 235007                    LDA     1,DL
         1 000732   200004 755100                    STA     SEL_NSFORM,,AUTO
         1 000733   000735 710000 1                  TRA     s:11136

      824    11134    2               ELSE SEL_NSFORM=0;

  11134  1 000734   200004 450100                    STZ     SEL_NSFORM,,AUTO

      825    11135
      826    11136    2               OPRIO=HIPRIO;

  11136  1 000735   200015 235100                    LDA     HIPRIO,,AUTO
         1 000736   200014 755100                    STA     OPRIO,,AUTO

      827    11137    3                 DO WHILE (OPRIO >= LOPRIO);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:110  
  11137  1 000737   200014 236100                    LDQ     OPRIO,,AUTO
         1 000740   200016 116100                    CMPQ    LOPRIO,,AUTO
         1 000741   001347 604000 1                  TMI     s:11251

      828    11138
      829    11139    3                 UFIL$=SYMHDR$->FO$Q.FILHD$(OPRIO);

  11139  1 000742   200041 470500                    LDP0    SYMHDR$,,AUTO
         1 000743   200014 720100                    LXL0    OPRIO,,AUTO
         1 000744   000004 236110                    LDQ     4,X0,PR0
         1 000745   200020 756100                    STQ     UFIL$,,AUTO

      830    11140
      831    11141    4                   DO WHILE (UFIL$ ~= ADDR(NIL));

  11141  1 000746   001340 710000 1                  TRA     s:11247

      832    11142
      833    11143    4                   MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);

  11143  1 000747   200020 236100                    LDQ     UFIL$,,AUTO
         1 000750   777777 376003                    ANQ     -1,DU
         1 000751   200021 036100                    ADLQ    SYMFIL$,,AUTO
         1 000752   200022 756100                    STQ     MFIL$,,AUTO

      834    11144
      835    11145    4                   UJOB$=MFIL$->FO$FIL.OJOB$;

  11145  1 000753   200022 470500                    LDP0    MFIL$,,AUTO
         1 000754   000003 236100                    LDQ     3,,PR0
         1 000755   200042 756100                    STQ     UJOB$,,AUTO

      836    11146    4                   MJOB$=PINCRW(SYMJOB$,UJOB$R.DISP);

  11146  1 000756   200042 236100                    LDQ     UJOB$,,AUTO
         1 000757   777777 376003                    ANQ     -1,DU
         1 000760   200043 036100                    ADLQ    SYMJOB$,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:111  
         1 000761   200050 756100                    STQ     MJOB$,,AUTO

      837    11147
      838    11148    4                   UDEV$=MFIL$->FO$FIL.CDEV$;

  11148  1 000762   000011 236100                    LDQ     9,,PR0
         1 000763   200104 756100                    STQ     UDEV$,,AUTO

      839    11149    4                   IF UDEV$ ~= ADDR(NIL)

  11149  1 000764   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000765   000777 600000 1                  TZE     s:11157

      840    11150    4                   THEN
      841    11151    5                     DO;

      842    11152    5                     MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);

  11152  1 000766   200104 236100                    LDQ     UDEV$,,AUTO
         1 000767   777777 376003                    ANQ     -1,DU
         1 000770   200100 036100                    ADLQ    SYMDEV$,,AUTO
         1 000771   200103 756100                    STQ     MDEV$,,AUTO

      843    11153    5                     TNAME=MDEV$->FO$DEV.TNAME;

  11153  1 000772   200103 471500                    LDP1    MDEV$,,AUTO
         1 000773   040100 100500                    MLR     fill='040'O
         1 000774   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000775   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8

      844    11154    5                     END;

  11154  1 000776   001005 710000 1                  TRA     s:11161

      845    11155    4                   ELSE
      846    11156    5                     DO;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:112  
      847    11157    5                     MDEV$=ADDR(NIL);

  11157  1 000777   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001000   200103 756100                    STQ     MDEV$,,AUTO

      848    11158    5                     TNAME=' ';

  11158  1 001001   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001002   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001003   200035 755100                    STA     TNAME,,AUTO
         1 001004   200036 756100                    STQ     TNAME+1,,AUTO

      849    11159    5                     END;

      850    11160
      851    11161    4                   IF

  11161  1 001005   200012 235100                    LDA     SEL_SYSID,,AUTO
         1 001006   001017 600000 1                  TZE     s:11161+10
         1 001007   000000 471400 xsym               LDP1    B$PS3$
         1 001010   000012 236100                    LDQ     10,,PR0
         1 001011   000022 772000                    QRL     18
         1 001012   100006 116100                    CMPQ    6,,PR1
         1 001013   001335 602000 1                  TNC     OSKIP
         1 001014   100007 116100                    CMPQ    7,,PR1
         1 001015   001017 600000 1                  TZE     s:11161+10
         1 001016   001335 603000 1                  TRC     OSKIP
         1 001017   200007 236100                    LDQ     SEL_ACCT,,AUTO
         1 001020   001027 604400 1                  TMOZ    s:11161+18
         1 001021   000000 471400 xsym               LDP1    B$PS3$
         1 001022   200050 473500                    LDP3    MJOB$,,AUTO
         1 001023   040100 106500                    CMPC    fill='040'O
         1 001024   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 001025   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         1 001026   001335 601000 1                  TNZ     OSKIP
         1 001027   000000 116003                    CMPQ    0,DU
         1 001030   001037 605000 1                  TPL     s:11161+26
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:113  
         1 001031   000000 471400 xsym               LDP1    B$PS3$
         1 001032   200050 473500                    LDP3    MJOB$,,AUTO
         1 001033   040100 106500                    CMPC    fill='040'O
         1 001034   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 001035   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         1 001036   001335 600000 1                  TZE     OSKIP
         1 001037   200011 235100                    LDA     SEL_FORM,,AUTO
         1 001040   001046 604400 1                  TMOZ    s:11161+33
         1 001041   000000 471400 xsym               LDP1    B$PS3$
         1 001042   040100 106500                    CMPC    fill='040'O
         1 001043   100015 000006                    ADSC9   13,,PR1                  cn=0,n=6
         1 001044   000013 000006                    ADSC9   11,,PR0                  cn=0,n=6
         1 001045   001335 601000 1                  TNZ     OSKIP
         1 001046   000000 115003                    CMPA    0,DU
         1 001047   001055 605000 1                  TPL     s:11161+40
         1 001050   000000 471400 xsym               LDP1    B$PS3$
         1 001051   040100 106500                    CMPC    fill='040'O
         1 001052   100015 000006                    ADSC9   13,,PR1                  cn=0,n=6
         1 001053   000013 000006                    ADSC9   11,,PR0                  cn=0,n=6
         1 001054   001335 600000 1                  TZE     OSKIP
         1 001055   000026 236000 xsym               LDQ     B_VECTNIL+22
         1 001056   000030 276000 xsym               ORQ     B_VECTNIL+24
         1 001057   000000 471400 xsym               LDP1    B$JIT$
         1 001060   100013 376100                    ANQ     11,,PR1
         1 001061   001073 601000 1                  TNZ     s:11161+54
         1 001062   200050 473500                    LDP3    MJOB$,,AUTO
         1 001063   040100 106500                    CMPC    fill='040'O
         1 001064   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 001065   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         1 001066   001335 601000 1                  TNZ     OSKIP
         1 001067   040100 106500                    CMPC    fill='040'O
         1 001070   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
         1 001071   300006 200014                    ADSC9   6,,PR3                   cn=1,n=12
         1 001072   001335 601000 1                  TNZ     OSKIP
         1 001073   200004 236100                    LDQ     SEL_NSFORM,,AUTO
         1 001074   001101 600000 1                  TZE     s:11161+60
         1 001075   000013 236100                    LDQ     11,,PR0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:114  
         1 001076   000036 676000 0                  ERQ     RCHECK_INIT+12
         1 001077   000021 376000 2                  ANQ     17
         1 001100   001335 600000 1                  TZE     OSKIP
         1 001101   200076 236100                    LDQ     ORDER,,AUTO
         1 001102   000005 116007                    CMPQ    5,DL
         1 001103   001115 601000 1                  TNZ     s:11161+72
         1 001104   200014 235100                    LDA     OPRIO,,AUTO
         1 001105   000002 115007                    CMPA    2,DL
         1 001106   001335 600000 1                  TZE     OSKIP
         1 001107   000011 236100                    LDQ     9,,PR0
         1 001110   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001111   001335 601000 1                  TNZ     OSKIP
         1 001112   000015 236100                    LDQ     13,,PR0
         1 001113   000100 316007                    CANQ    64,DL
         1 001114   001335 600000 1                  TZE     OSKIP
         1 001115   200006 235100                    LDA     SEL_TNAME,,AUTO
         1 001116   001124 604400 1                  TMOZ    s:11161+79
         1 001117   000000 473400 xsym               LDP3    B$PS3$
         1 001120   040100 106500                    CMPC    fill='040'O
         1 001121   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8
         1 001122   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         1 001123   001335 601000 1                  TNZ     OSKIP
         1 001124   000000 115003                    CMPA    0,DU
         1 001125   001133 605000 1                  TPL     s:11161+86
         1 001126   000000 473400 xsym               LDP3    B$PS3$
         1 001127   040100 106500                    CMPC    fill='040'O
         1 001130   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8
         1 001131   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         1 001132   001335 600000 1                  TZE     OSKIP
         1 001133   200010 236100                    LDQ     SEL_WSNL,,AUTO
         1 001134   001146 600000 1                  TZE     s:11161+97
         1 001135   000000 473400 xsym               LDP3    B$PS3$
         1 001136   300010 236100                    LDQ     8,,PR3
         1 001137   000400 316003                    CANQ    256,DU
         1 001140   001146 601000 1                  TNZ     s:11161+97
         1 001141   200010 720100                    LXL0    SEL_WSNL,,AUTO
         1 001142   040140 106540                    CMPC    fill='040'O
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:115  
         1 001143   300002 000010                    ADSC9   2,,PR3                   cn=0,n=*X0
         1 001144   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 001145   001335 601000 1                  TNZ     OSKIP
         1 001146   000000 473400 xsym               LDP3    B$PS3$
         1 001147   300010 236100                    LDQ     8,,PR3
         1 001150   000400 316003                    CANQ    256,DU
         1 001151   001157 600000 1                  TZE     s:11161+106
         1 001152   200010 720100                    LXL0    SEL_WSNL,,AUTO
         1 001153   040140 106540                    CMPC    fill='040'O
         1 001154   300002 000010                    ADSC9   2,,PR3                   cn=0,n=*X0
         1 001155   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 001156   001335 600000 1                  TZE     OSKIP
         1 001157   200013 235100                    LDA     SEL_DEVTYP,,AUTO
         1 001160   001164 600000 1                  TZE     s:11203
         1 001161   000007 220100                    LDX0    7,,PR0
         1 001162   300013 100100                    CMPX0   11,,PR3
         1 001163   001335 601000 1                  TNZ     OSKIP

      852    11162    4                   (SEL_SYSID ~= 0 AND
      853    11163    4                   (MFIL$->FO$FIL.SYSID < VLP$CRITERIA.SYSID
      854    11164    4                   OR MFIL$->FO$FIL.SYSID > VLP$CRITERIA.SYSID1))
      855    11165    4                   OR
      856    11166    4                   (SEL_ACCT > 0 AND VLP$CRITERIA.ACCT ~= MJOB$->FO$JOB.ACCT)
      857    11167    4                   OR
      858    11168    4                   (SEL_ACCT < 0 AND VLP$CRITERIA.ACCT = MJOB$->FO$JOB.ACCT)
      859    11169    4                   OR
      860    11170    4                   (SEL_FORM > 0 AND VLP$CRITERIA.FORM ~= MFIL$->FO$FIL.FORM)
      861    11171    4                   OR
      862    11172    4                   (SEL_FORM < 0 AND VLP$CRITERIA.FORM  = MFIL$->FO$FIL.FORM)
      863    11173    4                   OR
      864    11174    4                   ( (B$JIT.PRIV.ACTIVE & (%PR_DISPJOB#|%PR_FMEFT#))='0'B
      865    11175    4                   AND
      866    11176    4                   (B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT
      867    11177    4                   OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME))
      868    11178    4                   OR
      869    11179    4                   (SEL_NSFORM ~= 0
      870    11180    4                   AND SUBSTR(MFIL$->FO$FIL.FORM,0,3) = 'STD')
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:116  
      871    11181    4                   OR
      872    11182    4                   (ORDER = %SPILL# AND
      873    11183    4                   (OPRIO = FOPR_SPILLED# OR
      874    11184    4                   MFIL$->FO$FIL.CDEV$ ~= ADDR(NIL) OR
      875    11185    4                   MFIL$->FO$FIL.FLG.GLC = '0'B))
      876    11186    4                   OR
      877    11187    4                   (SEL_TNAME > 0
      878    11188    4                   AND TNAME ~= VLP$CRITERIA.TNAME)
      879    11189    4                   OR
      880    11190    4                   (SEL_TNAME < 0
      881    11191    4                   AND TNAME = VLP$CRITERIA.TNAME)
      882    11192    4                   OR
      883    11193    4                   (SEL_WSNL ~= 0 AND
      884    11194    4                   (VLP$CRITERIA.NOTWSN = '0'B AND
      885    11195    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MFIL$->FO$FIL.DESTR.WSN)->
             11195                            B$$WSN))
      886    11196    4                   OR (VLP$CRITERIA.NOTWSN = '1'B AND
      887    11197    4                   (ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MFIL$->FO$FIL.DESTR.WSN)->
             11197                            B$$WSN))
      888    11198    4                   OR
      889    11199    4                   (SEL_DEVTYP ~= 0
      890    11200    4                   AND MFIL$->FO$FIL.DESTR.TYP ~= VLP$CRITERIA.DEVTYP)
      891    11201    4                   THEN GOTO OSKIP;
      892    11202
      893    11203    4                   IF FILX >= RSIZ THEN

  11203  1 001164   200017 236100                    LDQ     FILX,,AUTO
         1 001165   200063 116100                    CMPQ    RSIZ,,AUTO
         1 001166   001172 602000 1                  TNC     s:11208

      894    11204    5                     DO;

      895    11205    5                     R$OSRCH.FOUND=FILX;

  11205  1 001167   000000 474400 xsym               LDP4    B$PS2$
         1 001170   400000 756100                    STQ     0,,PR4

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:117  
      896    11206    5                     GOTO NORSPACE;

  11206  1 001171   002154 710000 1                  TRA     NORSPACE

      897    11207    5                     END;
      898    11208    4                   RFIL$=ADDR(R$OSRCH.F(FILX));

  11208  1 001172   000034 402003                    MPY     28,DU
         1 001173   000002 036003                    ADLQ    2,DU
         1 001174   000000 036000 xsym               ADLQ    B$PS2$
         1 001175   200061 756100                    STQ     RFIL$,,AUTO

      899    11209
      900    11210
      901    11211                                /* GIVE IT TO HIM */
      902    11212
      903    11213    4                   RFIL$->R$FILE.TNAME           =TNAME;

  11213  1 001176   200061 474500                    LDP4    RFIL$,,AUTO
         1 001177   040100 100500                    MLR     fill='040'O
         1 001200   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8
         1 001201   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      904    11214    4                   RFIL$->R$FILE.WOD             =MFIL$->FO$FIL.DESTR.WSN;

  11214  1 001202   040100 100500                    MLR     fill='040'O
         1 001203   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 001204   400025 000010                    ADSC9   21,,PR4                  cn=0,n=8

      905    11215    4                   RFIL$->R$FILE.DEVTYP          =MFIL$->FO$FIL.DESTR.TYP;

  11215  1 001205   000007 220100                    LDX0    7,,PR0
         1 001206   400002 740100                    STX0    2,,PR4

      906    11216    4                   RFIL$->R$FILE.COPIES          =MFIL$->FO$FIL.COPIES;

  11216  1 001207   000007 236100                    LDQ     7,,PR0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:118  
         1 001210   000011 736000                    QLS     9
         1 001211   400002 552110                    STBQ    2,'10'O,PR4

      907    11217    4                   RFIL$->R$FILE.SAPCOPIES       =MFIL$->FO$FIL.SAPCOPIES;

  11217  1 001212   000016 236100                    LDQ     14,,PR0
         1 001213   000022 736000                    QLS     18
         1 001214   400003 552140                    STBQ    3,'40'O,PR4

      908    11218    4                   RFIL$->R$FILE.ATTR            =MFIL$->FO$FIL.ATTR;

  11218  1 001215   000010 220100                    LDX0    8,,PR0
         1 001216   400003 440100                    SXL0    3,,PR4

      909    11219    4                   RFIL$->R$FILE.FLG.GLC         =MFIL$->FO$FIL.FLG.GLC;

  11219  1 001217   000015 236100                    LDQ     13,,PR0
         1 001220   000035 736000                    QLS     29
         1 001221   400004 676100                    ERQ     4,,PR4
         1 001222   400000 376003                    ANQ     -131072,DU
         1 001223   400004 656100                    ERSQ    4,,PR4

      910    11220    4                   RFIL$->R$FILE.FLG.SAP         =MFIL$->FO$FIL.FLG.SAP;

  11220  1 001224   000015 236100                    LDQ     13,,PR0
         1 001225   000035 736000                    QLS     29
         1 001226   400004 676100                    ERQ     4,,PR4
         1 001227   200000 376003                    ANQ     65536,DU
         1 001230   400004 656100                    ERSQ    4,,PR4

      911    11221    4                   RFIL$->R$FILE.FLG.DEVAVAIL    =MFIL$->FO$FIL.FLG.LPAVAIL;

  11221  1 001231   000015 236100                    LDQ     13,,PR0
         1 001232   000030 736000                    QLS     24
         1 001233   400004 676100                    ERQ     4,,PR4
         1 001234   040000 376003                    ANQ     16384,DU
         1 001235   400004 656100                    ERSQ    4,,PR4
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:119  

      912    11222    4                   RFIL$->R$FILE.MODE            =MJOB$->FO$JOB.MODE;

  11222  1 001236   200050 471500                    LDP1    MJOB$,,AUTO
         1 001237   100003 236100                    LDQ     3,,PR1
         1 001240   000002 772000                    QRL     2
         1 001241   400004 676100                    ERQ     4,,PR4
         1 001242   017000 376003                    ANQ     7680,DU
         1 001243   400004 656100                    ERSQ    4,,PR4

      913    11223    4                   RFIL$->R$FILE.BOOTID          =MFIL$->FO$FIL.BOOTID;

  11223  1 001244   000021 236100                    LDQ     17,,PR0
         1 001245   000011 772000                    QRL     9
         1 001246   400004 552134                    STBQ    4,'34'O,PR4

      914    11224    4                   RFIL$->R$FILE.FLG.SPILL       =MFIL$->FO$FIL.FLG.SPILL;

  11224  1 001247   000015 236100                    LDQ     13,,PR0
         1 001250   000041 736000                    QLS     33
         1 001251   400004 676100                    ERQ     4,,PR4
         1 001252   100000 376003                    ANQ     32768,DU
         1 001253   400004 656100                    ERSQ    4,,PR4

      915    11225    4                   RFIL$->R$FILE.SYSID           =MFIL$->FO$FIL.SYSID;

  11225  1 001254   000012 221100                    LDX1    10,,PR0
         1 001255   400005 741100                    STX1    5,,PR4

      916    11226    4                   RFIL$->R$FILE.NUM             =MFIL$->FO$FIL.NUM;

  11226  1 001256   000012 722100                    LXL2    10,,PR0
         1 001257   400005 442100                    SXL2    5,,PR4

      917    11227    4                   RFIL$->R$FILE.HICNUM          =MFIL$->FO$FIL.HICNUM;

  11227  1 001260   000016 223100                    LDX3    14,,PR0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:120  
         1 001261   400006 743100                    STX3    6,,PR4

      918    11228    4                   RFIL$->R$FILE.GRANS           =MFIL$->FO$FIL.GRANS;

  11228  1 001262   000015 224100                    LDX4    13,,PR0
         1 001263   400006 444100                    SXL4    6,,PR4

      919    11229    4                   RFIL$->R$FILE.FORM            =MFIL$->FO$FIL.FORM;

  11229  1 001264   040100 100500                    MLR     fill='040'O
         1 001265   000013 000006                    ADSC9   11,,PR0                  cn=0,n=6
         1 001266   400007 000006                    ADSC9   7,,PR4                   cn=0,n=6

      920    11230    4                   RFIL$->R$FILE.ACCT            =MJOB$->FO$JOB.ACCT;

  11230  1 001267   040100 100500                    MLR     fill='040'O
         1 001270   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 001271   400011 000010                    ADSC9   9,,PR4                   cn=0,n=8

      921    11231    4                   RFIL$->R$FILE.JNAME           =MJOB$->FO$JOB.JOBNAME;

  11231  1 001272   100011 236100                    LDQ     9,,PR1
         1 001273   000011 772000                    QRL     9
         1 001274   000777 376007                    ANQ     511,DL
         1 001275   000000 625006                    EAX5    0,QL
         1 001276   040100 100540                    MLR     fill='040'O
         1 001277   100011 600015                    ADSC9   9,,PR1                   cn=3,n=*X5
         1 001300   400013 000037                    ADSC9   11,,PR4                  cn=0,n=31

      922    11232    4                   RFIL$->R$FILE.AHEAD           =MFIL$->FO$FIL.AHEAD;

  11232  1 001301   000022 225100                    LDX5    18,,PR0
         1 001302   400023 745100                    STX5    19,,PR4

      923    11233    4                   RFIL$->R$FILE.CREATED         =MFIL$->FO$FIL.CREATED;

  11233  1 001303   000020 235100                    LDA     16,,PR0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:121  
         1 001304   400024 755100                    STA     20,,PR4

      924    11234    4                   IF MDEV$ ~= ADDR(NIL)

  11234  1 001305   200103 236100                    LDQ     MDEV$,,AUTO
         1 001306   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001307   001314 600000 1                  TZE     s:11238

      925    11235    4                   THEN
      926    11236    4                    RFIL$->R$FILE.DEVNAME=MDEV$->FO$DEV.NAMER.NUM;

  11236  1 001310   200103 473500                    LDP3    MDEV$,,AUTO
         1 001311   300005 726100                    LXL6    5,,PR3
         1 001312   400010 446100                    SXL6    8,,PR4
         1 001313   001316 710000 1                  TRA     s:11239

      927    11237    4                   ELSE
      928    11238    4                    RFIL$->R$FILE.DEVNAME=' ';

  11238  1 001314   040040 226003                    LDX6    16416,DU
         1 001315   400010 446100                    SXL6    8,,PR4

      929    11239    4                   CALL SET_FPRIO;

  11239  1 001316   002371 701000 1                  TSX1    SET_FPRIO
         1 001317   000000 011000                    NOP     0

      930    11240    4                   RFIL$->R$FILE.PRIO=UPRIO;

  11240  1 001320   200061 470500                    LDP0    RFIL$,,AUTO
         1 001321   200075 236100                    LDQ     UPRIO,,AUTO
         1 001322   000022 736000                    QLS     18
         1 001323   000003 552120                    STBQ    3,'20'O,PR0

      931    11241    4                   IF ORDER = %SPILL# THEN MFIL$->FO$FIL.FLG.SPILL='1'B;

  11241  1 001324   200076 235100                    LDA     ORDER,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:122  
         1 001325   000005 115007                    CMPA    5,DL
         1 001326   001332 601000 1                  TNZ     s:11243

  11241  1 001327   200022 471500                    LDP1    MFIL$,,AUTO
         1 001330   000001 236007                    LDQ     1,DL
         1 001331   100015 256100                    ORSQ    13,,PR1

      932    11242
      933    11243    4                   FILX=FILX+1;

  11243  1 001332   200017 236100                    LDQ     FILX,,AUTO
         1 001333   000001 036007                    ADLQ    1,DL
         1 001334   200017 756100                    STQ     FILX,,AUTO

  11243  1 001335                       OSKIP        null
      934    11244
      935    11245    4   OSKIP:          ;
      936    11246    4                   UFIL$=MFIL$->FO$FIL.LNK$;

  11246  1 001335   200022 470500                    LDP0    MFIL$,,AUTO
         1 001336   000000 236100                    LDQ     0,,PR0
         1 001337   200020 756100                    STQ     UFIL$,,AUTO

      937    11247    4                   END;

  11247  1 001340   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001341   000747 601000 1                  TNZ     s:11143

      938    11248    3                 OPRIO=OPRIO-1;

  11248  1 001342   000001 336007                    LCQ     1,DL
         1 001343   200014 056100                    ASQ     OPRIO,,AUTO

      939    11249    3                 END;

  11249  1 001344   200014 236100                    LDQ     OPRIO,,AUTO
         1 001345   200016 116100                    CMPQ    LOPRIO,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:123  
         1 001346   000742 605000 1                  TPL     s:11139

      940    11250
      941    11251    2               R$OSRCH.FOUND=FILX;

  11251  1 001347   000000 470400 xsym               LDP0    B$PS2$
         1 001350   200017 235100                    LDA     FILX,,AUTO
         1 001351   000000 755100                    STA     0,,PR0

      942    11252    2               IF FILX = 0 THEN GOTO NOTFOUND;

  11252  1 001352   000432 600000 1                  TZE     NOTFOUND

      943    11253    2               RETURN;

  11253  1 001353   000000 702200 xent               TSX2  ! X66_ARET

  11252  1 001354                       ISRCH        null
      944    11254
      945    11255
      946    11256
      947    11257        /**
      948    11258         **
      949    11259         **      SEARCH INPUT QUEUES
      950    11260         **
      951    11261         **/
      952    11262    2   ISRCH:      ;
      953    11263                                /* CALC NUMBER OF JOB FRAMES PRESENT */
      954    11264    2               RSIZ=RSIZ/LENGTHC(R$JOB);

  11264  1 001354   200063 236100                    LDQ     RSIZ,,AUTO
         1 001355   000010 772000                    QRL     8
         1 001356   200063 756100                    STQ     RSIZ,,AUTO

      955    11265
      956    11266    2               IF VLP$CRITERIA.WSN ~= '  ' THEN

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:124  
  11266  1 001357   040000 106500                    CMPC    fill='040'O
         1 001360   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         1 001361   000037 000002 0                  ADSC9   RCHECK_INIT+13           cn=0,n=2
         1 001362   001370 600000 1                  TZE     s:11268

      957    11267    2                CALL INDEX (SEL_WSNL,'?',VLP$CRITERIA.WSN);

  11267  1 001363   000000 124500                    SCM     mask='000'O
         1 001364   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         1 001365   000020 000001 2                  ADSC9   16                       cn=0,n=1
         1 001366   200010 000100                    ARG     SEL_WSNL,,AUTO
         1 001367   001371 710000 1                  TRA     s:11270

      958    11268    2               ELSE SEL_WSNL=0;

  11268  1 001370   200010 450100                    STZ     SEL_WSNL,,AUTO

      959    11269
      960    11270    2               CALL GET_MBSHDR ALTRET(NOTFOUND);

  11270  1 001371   003455 701000 1                  TSX1    GET_MBSHDR
         1 001372   000432 702000 1                  TSX2    NOTFOUND

      961    11271
      962    11272    2               FILX=0;

  11272  1 001373   200017 450100                    STZ     FILX,,AUTO

      963    11273    2               R$ISRCH.FOUND=0;

  11273  1 001374   000000 470400 xsym               LDP0    B$PS2$
         1 001375   000000 450100                    STZ     0,,PR0

      964    11274    2               RESX=0;

  11274  1 001376   200067 450100                    STZ     RESX,,AUTO

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:125  
      965    11275    2               SNX=0;

  11275  1 001377   200070 450100                    STZ     SNX,,AUTO

      966    11276    2               NAHEAD=0;

  11276  1 001400   200054 450100                    STZ     NAHEAD,,AUTO

      967    11277
      968    11278                                /* SELECT WHICH PRIO CHAIN(S) TO SRCH */
      969    11279
      970    11280    2               IF VLP$CRITERIA.NORUN THEN

  11280  1 001401   000000 470400 xsym               LDP0    B$PS3$
         1 001402   000010 234100                    SZN     8,,PR0
         1 001403   001410 605000 1                  TPL     s:11287

      971    11281    3                 DO;

      972    11282    3                 LOPRIO=JM_Q$WP;

  11282  1 001404   000001 235007                    LDA     1,DL
         1 001405   200016 755100                    STA     LOPRIO,,AUTO

      973    11283    3                 HIPRIO=JM_Q$WP;

  11283  1 001406   200015 755100                    STA     HIPRIO,,AUTO

      974    11284    3                 END;

  11284  1 001407   001456 710000 1                  TRA     s:11327

      975    11285    2               ELSE
      976    11286    3                 DO;

      977    11287    3                 IF VLP$CRITERIA.RUNAFTER THEN

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:126  
  11287  1 001410   000010 236100                    LDQ     8,,PR0
         1 001411   200000 316003                    CANQ    65536,DU
         1 001412   001417 600000 1                  TZE     s:11294

      978    11288    4                   DO;

      979    11289    4                   LOPRIO=JM_Q$WR;

  11289  1 001413   000002 235007                    LDA     2,DL
         1 001414   200016 755100                    STA     LOPRIO,,AUTO

      980    11290    4                   HIPRIO=JM_Q$WR;

  11290  1 001415   200015 755100                    STA     HIPRIO,,AUTO

      981    11291    4                   END;

  11291  1 001416   001456 710000 1                  TRA     s:11327

      982    11292    3                 ELSE
      983    11293    4                   DO;

      984    11294    4                   IF VLP$CRITERIA.RUNNING THEN

  11294  1 001417   010000 316003                    CANQ    4096,DU
         1 001420   001425 600000 1                  TZE     s:11301

      985    11295    5                     DO;

      986    11296    5                     LOPRIO=JM_Q$RUN;

  11296  1 001421   000026 235007                    LDA     22,DL
         1 001422   200016 755100                    STA     LOPRIO,,AUTO

      987    11297    5                     HIPRIO=JM_Q$RUN;

  11297  1 001423   200015 755100                    STA     HIPRIO,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:127  

      988    11298    5                     END;

  11298  1 001424   001456 710000 1                  TRA     s:11327

      989    11299    4                   ELSE
      990    11300    5                     DO;

      991    11301    5                     IF VLP$CRITERIA.WPS THEN

  11301  1 001425   002000 316003                    CANQ    1024,DU
         1 001426   001433 600000 1                  TZE     s:11308

      992    11302    6                       DO;

      993    11303    6                       LOPRIO=JM_Q$DP;

  11303  1 001427   000005 235007                    LDA     5,DL
         1 001430   200016 755100                    STA     LOPRIO,,AUTO

      994    11304    6                       HIPRIO=JM_Q$DP;

  11304  1 001431   200015 755100                    STA     HIPRIO,,AUTO

      995    11305    6                       END;

  11305  1 001432   001456 710000 1                  TRA     s:11327

      996    11306    5                     ELSE
      997    11307    6                       DO;

      998    11308    6                       IF VLP$CRITERIA.PRIO > 15

  11308  1 001433   000011 235100                    LDA     9,,PR0
         1 001434   000020 115007                    CMPA    16,DL
         1 001435   001444 603000 1                  TRC     s:11312
         1 001436   000012 235100                    LDA     10,,PR0
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:128  
         1 001437   000020 115007                    CMPA    16,DL
         1 001440   001444 603000 1                  TRC     s:11312
         1 001441   000012 236100                    LDQ     10,,PR0
         1 001442   000011 116100                    CMPQ    9,,PR0
         1 001443   001451 603000 1                  TRC     s:11317

      999    11309    6                       OR VLP$CRITERIA.PRIO1> 15
     1000    11310    6                       OR VLP$CRITERIA.PRIO > VLP$CRITERIA.PRIO1 THEN
     1001    11311    7                         DO;

     1002    11312    7                         LOPRIO=JM_Q$WP;

  11312  1 001444   000001 235007                    LDA     1,DL
         1 001445   200016 755100                    STA     LOPRIO,,AUTO

     1003    11313    7                         HIPRIO=JM_Q$RUN;

  11313  1 001446   000026 236007                    LDQ     22,DL
         1 001447   200015 756100                    STQ     HIPRIO,,AUTO

     1004    11314    7                         END;

  11314  1 001450   001456 710000 1                  TRA     s:11327

     1005    11315    6                       ELSE
     1006    11316    7                         DO;

     1007    11317    7                         LOPRIO=VLP$CRITERIA.PRIO+JM_Q$P0;

  11317  1 001451   000011 235100                    LDA     9,,PR0
         1 001452   000006 035007                    ADLA    6,DL
         1 001453   200016 755100                    STA     LOPRIO,,AUTO

     1008    11318    7                         HIPRIO=VLP$CRITERIA.PRIO1+JM_Q$P0;

  11318  1 001454   000006 036007                    ADLQ    6,DL
         1 001455   200015 756100                    STQ     HIPRIO,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:129  

     1009    11319    7                         END;

     1010    11320    6                       END;

     1011    11321    5                     END;

     1012    11322    4                   END;

     1013    11323    3                 END;

     1014    11324                                /* IF SELECTION DOES NOT START WITH P15,
     1015    11325                                   THEN COUNT JOBS IN QUEUES ABOVE HIPRIO
     1016    11326                                   QUEUE TO MAKE 'AHEAD' CORRECT */
     1017    11327    2               IPRIO=JM_Q$P15;

  11327  1 001456   000025 236007                    LDQ     21,DL
         1 001457   200057 756100                    STQ     IPRIO,,AUTO

     1018    11328    3                 DO WHILE (IPRIO > HIPRIO);

  11328  1 001460   200015 116100                    CMPQ    HIPRIO,,AUTO
         1 001461   001507 604400 1                  TMOZ    s:11342

     1019    11329    3                 UJOB$=MBSHDR$->JMC$CHAINS.HEAD$(IPRIO);

  11329  1 001462   200057 235100                    LDA     IPRIO,,AUTO
         1 001463   000001 735000                    ALS     1
         1 001464   200053 470500                    LDP0    MBSHDR$,,AUTO
         1 001465   000000 236105                    LDQ     0,AL,PR0
         1 001466   200042 756100                    STQ     UJOB$,,AUTO

     1020    11330    4                   DO WHILE (UJOB$ ~= ADDR(NIL));

  11330  1 001467   001500 710000 1                  TRA     s:11334

     1021    11331    4                   MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:130  

  11331  1 001470   200042 236100                    LDQ     UJOB$,,AUTO
         1 001471   777777 376003                    ANQ     -1,DU
         1 001472   200044 036100                    ADLQ    MBSJOB$,,AUTO
         1 001473   200050 756100                    STQ     MJOB$,,AUTO

     1022    11332    4                   NAHEAD=NAHEAD+1;

  11332  1 001474   200054 054100                    AOS     NAHEAD,,AUTO

     1023    11333    4                   UJOB$=MJOB$->JM$IF.LNK$;

  11333  1 001475   200050 470500                    LDP0    MJOB$,,AUTO
         1 001476   000000 236100                    LDQ     0,,PR0
         1 001477   200042 756100                    STQ     UJOB$,,AUTO

     1024    11334    4                   END;

  11334  1 001500   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001501   001470 601000 1                  TNZ     s:11331

     1025    11335    3                 IPRIO=IPRIO-1;

  11335  1 001502   000001 336007                    LCQ     1,DL
         1 001503   200057 056100                    ASQ     IPRIO,,AUTO

     1026    11336    3                 END;

  11336  1 001504   200057 236100                    LDQ     IPRIO,,AUTO
         1 001505   200015 116100                    CMPQ    HIPRIO,,AUTO
         1 001506   001462 605400 1                  TPNZ    s:11329

     1027    11337
     1028    11338
     1029    11339
     1030    11340                                /* FIGURE OUT IF RESLISTS & SNLISTS ARE
     1031    11341                                   REQUESTED */
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:131  
     1032    11342    2               CALL HFF$DSIZ(7,RSIZ_RES);

  11342  1 001507   200064 630500                    EPPR0   RSIZ_RES,,AUTO
         1 001510   200115 450500                    STP0    SPECIFIC+4,,AUTO
         1 001511   000022 236000 2                  LDQ     18
         1 001512   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 001513   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 001514   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001515   000000 701000 xent               TSX1    HFF$DSIZ
         1 001516   000000 011000                    NOP     0

     1033    11343    2               IF RSIZ_RES ~= 0 THEN RSIZ_RES=RSIZ_RES/LENGTHC(R$ISRCH_RES.R(0));

  11343  1 001517   200064 235100                    LDA     RSIZ_RES,,AUTO
         1 001520   001524 600000 1                  TZE     s:11344

  11343  1 001521   200064 236100                    LDQ     RSIZ_RES,,AUTO
         1 001522   000003 772000                    QRL     3
         1 001523   200064 756100                    STQ     RSIZ_RES,,AUTO

     1034    11344    2               CALL HFF$DSIZ(6,RSIZ_SN);

  11344  1 001524   200065 630500                    EPPR0   RSIZ_SN,,AUTO
         1 001525   200115 450500                    STP0    SPECIFIC+4,,AUTO
         1 001526   000023 236000 2                  LDQ     19
         1 001527   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 001530   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 001531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001532   000000 701000 xent               TSX1    HFF$DSIZ
         1 001533   000000 011000                    NOP     0

     1035    11345    2               IF RSIZ_SN ~= 0 THEN RSIZ_SN=RSIZ_SN/LENGTHC(R$ISRCH_SN.S(0));

  11345  1 001534   200065 235100                    LDA     RSIZ_SN,,AUTO
         1 001535   001541 600000 1                  TZE     RELOOP

  11345  1 001536   200065 236100                    LDQ     RSIZ_SN,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:132  
         1 001537   000003 772000                    QRL     3
         1 001540   200065 756100                    STQ     RSIZ_SN,,AUTO

  11345  1 001541                       RELOOP       null
     1036    11346
     1037    11347                                /* NOW LOOP THRU THE CORRECT CHAINS */
     1038    11348    2   RELOOP:     ;
     1039    11349    2               IPRIO=HIPRIO;

  11349  1 001541   200015 235100                    LDA     HIPRIO,,AUTO
         1 001542   200057 755100                    STA     IPRIO,,AUTO

     1040    11350    3                 DO WHILE (IPRIO >= LOPRIO);

  11350  1 001543   200057 236100                    LDQ     IPRIO,,AUTO
         1 001544   200016 116100                    CMPQ    LOPRIO,,AUTO
         1 001545   002131 604000 1                  TMI     s:11457

     1041    11351    3                 UJOB$=MBSHDR$->JMC$CHAINS.HEAD$(IPRIO);

  11351  1 001546   200057 235100                    LDA     IPRIO,,AUTO
         1 001547   000001 735000                    ALS     1
         1 001550   200053 470500                    LDP0    MBSHDR$,,AUTO
         1 001551   000000 236105                    LDQ     0,AL,PR0
         1 001552   200042 756100                    STQ     UJOB$,,AUTO

     1042    11352    4                   DO WHILE (UJOB$ ~= ADDR(NIL));

  11352  1 001553   002116 710000 1                  TRA     s:11452

     1043    11353    4                   MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);

  11353  1 001554   200042 236100                    LDQ     UJOB$,,AUTO
         1 001555   777777 376003                    ANQ     -1,DU
         1 001556   200044 036100                    ADLQ    MBSJOB$,,AUTO
         1 001557   200050 756100                    STQ     MJOB$,,AUTO

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:133  
     1044    11354
     1045    11355    4                   IF

  11355  1 001560   200012 235100                    LDA     SEL_SYSID,,AUTO
         1 001561   001573 600000 1                  TZE     s:11355+11
         1 001562   000000 470400 xsym               LDP0    B$PS3$
         1 001563   200050 471500                    LDP1    MJOB$,,AUTO
         1 001564   100014 236100                    LDQ     12,,PR1
         1 001565   777777 376007                    ANQ     -1,DL
         1 001566   000006 116100                    CMPQ    6,,PR0
         1 001567   002112 602000 1                  TNC     ISKIP
         1 001570   000007 116100                    CMPQ    7,,PR0
         1 001571   001573 600000 1                  TZE     s:11355+11
         1 001572   002112 603000 1                  TRC     ISKIP
         1 001573   200007 236100                    LDQ     SEL_ACCT,,AUTO
         1 001574   001603 604400 1                  TMOZ    s:11355+19
         1 001575   000000 470400 xsym               LDP0    B$PS3$
         1 001576   200050 471500                    LDP1    MJOB$,,AUTO
         1 001577   040100 106500                    CMPC    fill='040'O
         1 001600   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         1 001601   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 001602   002112 601000 1                  TNZ     ISKIP
         1 001603   000000 116003                    CMPQ    0,DU
         1 001604   001613 605000 1                  TPL     s:11355+27
         1 001605   000000 470400 xsym               LDP0    B$PS3$
         1 001606   200050 471500                    LDP1    MJOB$,,AUTO
         1 001607   040100 106500                    CMPC    fill='040'O
         1 001610   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         1 001611   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 001612   002112 600000 1                  TZE     ISKIP
         1 001613   000000 470400 xsym               LDP0    B$JIT$
         1 001614   000013 236100                    LDQ     11,,PR0
         1 001615   000026 376000 xsym               ANQ     B_VECTNIL+22
         1 001616   001630 601000 1                  TNZ     s:11355+40
         1 001617   200050 471500                    LDP1    MJOB$,,AUTO
         1 001620   040100 106500                    CMPC    fill='040'O
         1 001621   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:134  
         1 001622   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 001623   002112 601000 1                  TNZ     ISKIP
         1 001624   040100 106500                    CMPC    fill='040'O
         1 001625   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 001626   100017 000014                    ADSC9   15,,PR1                  cn=0,n=12
         1 001627   002112 601000 1                  TNZ     ISKIP
         1 001630   200010 236100                    LDQ     SEL_WSNL,,AUTO
         1 001631   001650 600000 1                  TZE     s:11355+56
         1 001632   000000 471400 xsym               LDP1    B$PS3$
         1 001633   100010 236100                    LDQ     8,,PR1
         1 001634   000400 316003                    CANQ    256,DU
         1 001635   001650 601000 1                  TNZ     s:11355+56
         1 001636   200010 720100                    LXL0    SEL_WSNL,,AUTO
         1 001637   200050 473500                    LDP3    MJOB$,,AUTO
         1 001640   040140 106540                    CMPC    fill='040'O
         1 001641   100002 000010                    ADSC9   2,,PR1                   cn=0,n=*X0
         1 001642   300024 000010                    ADSC9   20,,PR3                  cn=0,n=*X0
         1 001643   001650 600000 1                  TZE     s:11355+56
         1 001644   040140 106540                    CMPC    fill='040'O
         1 001645   100002 000010                    ADSC9   2,,PR1                   cn=0,n=*X0
         1 001646   300022 000010                    ADSC9   18,,PR3                  cn=0,n=*X0
         1 001647   002112 601000 1                  TNZ     ISKIP
         1 001650   000000 471400 xsym               LDP1    B$PS3$
         1 001651   100010 236100                    LDQ     8,,PR1
         1 001652   000400 316003                    CANQ    256,DU
         1 001653   001666 600000 1                  TZE     s:11378
         1 001654   200010 720100                    LXL0    SEL_WSNL,,AUTO
         1 001655   200050 473500                    LDP3    MJOB$,,AUTO
         1 001656   040140 106540                    CMPC    fill='040'O
         1 001657   100002 000010                    ADSC9   2,,PR1                   cn=0,n=*X0
         1 001660   300024 000010                    ADSC9   20,,PR3                  cn=0,n=*X0
         1 001661   002112 600000 1                  TZE     ISKIP
         1 001662   040140 106540                    CMPC    fill='040'O
         1 001663   100002 000010                    ADSC9   2,,PR1                   cn=0,n=*X0
         1 001664   300022 000010                    ADSC9   18,,PR3                  cn=0,n=*X0
         1 001665   002112 600000 1                  TZE     ISKIP

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:135  
     1046    11356    4                   (SEL_SYSID ~= 0 AND
     1047    11357    4                   (MJOB$->JM$IF.SYSID < VLP$CRITERIA.SYSID
     1048    11358    4                   OR MJOB$->JM$IF.SYSID > VLP$CRITERIA.SYSID1))
     1049    11359    4                   OR
     1050    11360    4                   (SEL_ACCT > 0 AND VLP$CRITERIA.ACCT ~= MJOB$->JM$IF.ACCT)
     1051    11361    4                   OR
     1052    11362    4                   (SEL_ACCT < 0 AND VLP$CRITERIA.ACCT  = MJOB$->JM$IF.ACCT)
     1053    11363    4                   OR
     1054    11364    4                   (NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#)
     1055    11365    4                   AND
     1056    11366    4                   (B$JIT.ACCN ~= MJOB$->JM$IF.ACCT
     1057    11367    4                   OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME))
     1058    11368    4                   OR
     1059    11369    4                   (SEL_WSNL ~= 0 AND
     1060    11370    4                   (VLP$CRITERIA.NOTWSN = '0'B AND
     1061    11371    4                  ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MJOB$->JM$IF.WSN)->B$$WSN AND
     1062    11372    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN ~= ADDR(MJOB$->JM$IF.WOO)->B$$WSN)
     1063    11373    4                   OR (VLP$CRITERIA.NOTWSN = '1'B AND
     1064    11374    4                   (ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MJOB$->JM$IF.WSN)->B$$WSN OR
     1065    11375    4                   ADDR(VLP$CRITERIA.WSN)->B$$WSN = ADDR(MJOB$->JM$IF.WOO)->B$$WSN)))
     1066    11376    4                   THEN GOTO ISKIP;
     1067    11377
     1068    11378    4                   IF FILX >= RSIZ THEN

  11378  1 001666   200017 236100                    LDQ     FILX,,AUTO
         1 001667   200063 116100                    CMPQ    RSIZ,,AUTO
         1 001670   001674 602000 1                  TNC     s:11383

     1069    11379    5                     DO;

     1070    11380    5                     R$ISRCH.FOUND=FILX;

  11380  1 001671   000000 473400 xsym               LDP3    B$PS2$
         1 001672   300000 756100                    STQ     0,,PR3

     1071    11381    5                     GOTO NORSPACE;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:136  
  11381  1 001673   002154 710000 1                  TRA     NORSPACE

     1072    11382    5                     END;
     1073    11383    4                   RJOB$=ADDR(R$ISRCH.J(FILX));

  11383  1 001674   000030 736000                    QLS     24
         1 001675   000002 036003                    ADLQ    2,DU
         1 001676   000000 036000 xsym               ADLQ    B$PS2$
         1 001677   200062 756100                    STQ     RJOB$,,AUTO

     1074    11384
     1075    11385                                /* GIVE IT TO HIM */
     1076    11386    4                   RJOB$->R$JOB.AHEAD               =NAHEAD;

  11386  1 001700   200054 235100                    LDA     NAHEAD,,AUTO
         1 001701   200062 473500                    LDP3    RJOB$,,AUTO
         1 001702   300007 755100                    STA     7,,PR3

     1077    11387    4                   RJOB$->R$JOB.U                   =MJOB$->JM$IF.U;

  11387  1 001703   200050 474500                    LDP4    MJOB$,,AUTO
         1 001704   400005 220100                    LDX0    5,,PR4
         1 001705   300002 740100                    STX0    2,,PR3

     1078    11388    4                   RJOB$->R$JOB.PART                =MJOB$->JM$IF.PART;

  11388  1 001706   400005 236100                    LDQ     5,,PR4
         1 001707   300002 676100                    ERQ     2,,PR3
         1 001710   177777 376007                    ANQ     65535,DL
         1 001711   300002 656100                    ERSQ    2,,PR3

     1079    11389    4                   RJOB$->R$JOB.PNUM                =MJOB$->JM$IF.PNUM+1;
             11389                            /* JM$IF HAS INDEX */

  11389  1 001712   400006 236100                    LDQ     6,,PR4
         1 001713   000011 772000                    QRL     9
         1 001714   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:137  
         1 001715   000001 036007                    ADLQ    1,DL
         1 001716   000033 736000                    QLS     27
         1 001717   300003 552140                    STBQ    3,'40'O,PR3

     1080    11390    4                   RJOB$->R$JOB.PI                  =MJOB$->JM$IF.PI;

  11390  1 001720   400006 236100                    LDQ     6,,PR4
         1 001721   000022 736000                    QLS     18
         1 001722   300003 552120                    STBQ    3,'20'O,PR3

     1081    11391    4                   RJOB$->R$JOB.IPRIO               =MJOB$->JM$IF.PRIO;

  11391  1 001723   400013 236100                    LDQ     11,,PR4
         1 001724   000011 772000                    QRL     9
         1 001725   300003 552110                    STBQ    3,'10'O,PR3

     1082    11392    4                   RJOB$->R$JOB.SUBMIT_TIME         =MJOB$->JM$IF.SUBMIT_TIME;

  11392  1 001726   400007 235100                    LDA     7,,PR4
         1 001727   300004 755100                    STA     4,,PR3

     1083    11393    4                   RJOB$->R$JOB.START_TIME          =MJOB$->JM$IF.START_TIME;

  11393  1 001730   400010 235100                    LDA     8,,PR4
         1 001731   300005 755100                    STA     5,,PR3

     1084    11394    4                   RJOB$->R$JOB.FLG                 =MJOB$->JM$IF.FLG;

  11394  1 001732   400013 236100                    LDQ     11,,PR4
         1 001733   000022 736000                    QLS     18
         1 001734   300006 552140                    STBQ    6,'40'O,PR3

     1085    11395    4                   RJOB$->R$JOB.SYSID               =MJOB$->JM$IF.SYSID;

  11395  1 001735   400014 721100                    LXL1    12,,PR4
         1 001736   300006 441100                    SXL1    6,,PR3

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:138  
     1086    11396    4                   RJOB$->R$JOB.ACCT                =MJOB$->JM$IF.ACCT;

  11396  1 001737   040100 100500                    MLR     fill='040'O
         1 001740   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         1 001741   300010 000010                    ADSC9   8,,PR3                   cn=0,n=8

     1087    11397    4                   RJOB$->R$JOB.UNAME               =MJOB$->JM$IF.UNAME;

  11397  1 001742   040100 100500                    MLR     fill='040'O
         1 001743   400017 000014                    ADSC9   15,,PR4                  cn=0,n=12
         1 001744   300012 000014                    ADSC9   10,,PR3                  cn=0,n=12

     1088    11398    4                   RJOB$->R$JOB.WOO                 =MJOB$->JM$IF.WOO;

  11398  1 001745   040100 100500                    MLR     fill='040'O
         1 001746   400022 000010                    ADSC9   18,,PR4                  cn=0,n=8
         1 001747   300015 000010                    ADSC9   13,,PR3                  cn=0,n=8

     1089    11399    4                   RJOB$->R$JOB.WSN                 =MJOB$->JM$IF.WSN;

  11399  1 001750   040100 100500                    MLR     fill='040'O
         1 001751   400024 000010                    ADSC9   20,,PR4                  cn=0,n=8
         1 001752   300017 000010                    ADSC9   15,,PR3                  cn=0,n=8

     1090    11400    4                   RJOB$->R$JOB.JNAME               =MJOB$->JM$IF.JNAME;

  11400  1 001753   400056 236100                    LDQ     46,,PR4
         1 001754   000033 772000                    QRL     27
         1 001755   000000 622006                    EAX2    0,QL
         1 001756   040100 100540                    MLR     fill='040'O
         1 001757   400056 200012                    ADSC9   46,,PR4                  cn=1,n=*X2
         1 001760   300021 000037                    ADSC9   17,,PR3                  cn=0,n=31

     1091    11401    4                   RJOB$->R$JOB.RATIM               =MJOB$->JM$IF.RATIM;

  11401  1 001761   400026 235100                    LDA     22,,PR4
         1 001762   300031 755100                    STA     25,,PR3
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:139  

     1092    11402    4                   RJOB$->R$JOB.RRT                 =MJOB$->JM$IF.RRT;

  11402  1 001763   000100 100500                    MLR     fill='000'O
         1 001764   400041 000030                    ADSC9   33,,PR4                  cn=0,n=24
         1 001765   300032 000030                    ADSC9   26,,PR3                  cn=0,n=24

     1093    11403    4                   RJOB$->R$JOB.TIM                 =MJOB$->JM$IF.TIM;

  11403  1 001766   400012 235100                    LDA     10,,PR4
         1 001767   300040 755100                    STA     32,,PR3

     1094    11404    4                   RJOB$->R$JOB.JDID                =MJOB$->JM$IF.JDID;

  11404  1 001770   000100 100500                    MLR     fill='000'O
         1 001771   400027 000040                    ADSC9   23,,PR4                  cn=0,n=32
         1 001772   300041 000040                    ADSC9   33,,PR3                  cn=0,n=32

     1095    11405    4                   RJOB$->R$JOB.JDSTEPCC            =MJOB$->JM$IF.JDSTEPCC;

  11405  1 001773   000100 100500                    MLR     fill='000'O
         1 001774   400037 000010                    ADSC9   31,,PR4                  cn=0,n=8
         1 001775   300051 000010                    ADSC9   41,,PR3                  cn=0,n=8

     1096    11406    4                   RJOB$->R$JOB.NFOLL               =MJOB$->JM$IF.NJD;

  11406  1 001776   400013 236100                    LDQ     11,,PR4
         1 001777   000011 772000                    QRL     9
         1 002000   300006 552120                    STBQ    6,'20'O,PR3

     1097    11407    4                   JPRIO=IPRIO;

  11407  1 002001   200057 236100                    LDQ     IPRIO,,AUTO
         1 002002   200046 756100                    STQ     JPRIO,,AUTO

     1098    11408    4                   CALL SET_JPRIO;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:140  
  11408  1 002003   002613 701000 1                  TSX1    SET_JPRIO
         1 002004   000000 011000                    NOP     0

     1099    11409    4                   RJOB$->R$JOB.PRIO=UPRIO;

  11409  1 002005   200062 470500                    LDP0    RJOB$,,AUTO
         1 002006   200075 236100                    LDQ     UPRIO,,AUTO
         1 002007   000003 552104                    STBQ    3,'04'O,PR0

     1100    11410    4                   RJOB$->R$JOB.NSN=0;

  11410  1 002010   000000 220003                    LDX0    0,DU
         1 002011   000000 740100                    STX0    0,,PR0

     1101    11411    4                   IF RSIZ_SN ~= 0

  11411  1 002012   200065 235100                    LDA     RSIZ_SN,,AUTO
         1 002013   002033 600000 1                  TZE     s:11420
         1 002014   200050 471500                    LDP1    MJOB$,,AUTO
         1 002015   100014 236100                    LDQ     12,,PR1
         1 002016   777000 316003                    CANQ    -512,DU
         1 002017   002033 600000 1                  TZE     s:11420

     1102    11412    4                   AND MJOB$->JM$IF.MAXPSN ~= 0 THEN
     1103    11413    5                     DO;

     1104    11414    5                     RJOB$->R$JOB.SNX=SNX;

  11414  1 002020   200070 721100                    LXL1    SNX,,AUTO
         1 002021   000000 441100                    SXL1    0,,PR0

     1105    11415    5                     USN$=MJOB$->JM$IF.XLNK$;

  11415  1 002022   100003 236100                    LDQ     3,,PR1
         1 002023   200072 756100                    STQ     USN$,,AUTO

     1106    11416    5                     CALL GET_SNS ALTRET(NOSLS);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:141  

  11416  1 002024   002700 701000 1                  TSX1    GET_SNS
         1 002025   002150 702000 1                  TSX2    NOSLS

     1107    11417    5                     USN$=MJOB$->JM$IF.SLNK$;

  11417  1 002026   200050 470500                    LDP0    MJOB$,,AUTO
         1 002027   000004 236100                    LDQ     4,,PR0
         1 002030   200072 756100                    STQ     USN$,,AUTO

     1108    11418    5                     CALL GET_SNS ALTRET(NOSLS);

  11418  1 002031   002700 701000 1                  TSX1    GET_SNS
         1 002032   002150 702000 1                  TSX2    NOSLS

     1109    11419    5                     END;

     1110    11420    4                   RJOB$->R$JOB.NRES=0;

  11420  1 002033   000000 220003                    LDX0    0,DU
         1 002034   200062 470500                    LDP0    RJOB$,,AUTO
         1 002035   000001 740100                    STX0    1,,PR0

     1111    11421    4                   IF RSIZ_RES ~= 0 THEN

  11421  1 002036   200064 235100                    LDA     RSIZ_RES,,AUTO
         1 002037   002107 600000 1                  TZE     s:11447

     1112    11422    5                     DO;

     1113    11423    5                     RJOB$->R$JOB.RESX=RESX;

  11423  1 002040   200067 721100                    LXL1    RESX,,AUTO
         1 002041   000001 441100                    SXL1    1,,PR0

     1114    11424    5                     URES$=MJOB$->JM$IF.VRLIST$;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:142  
  11424  1 002042   200050 471500                    LDP1    MJOB$,,AUTO
         1 002043   100002 236100                    LDQ     2,,PR1
         1 002044   200071 756100                    STQ     URES$,,AUTO

     1115    11425    6                       DO WHILE (URES$ ~= ADDR(NIL));

  11425  1 002045   002105 710000 1                  TRA     s:11443

     1116    11426    6                       MRES$=PINCRW(MBSRES$,URES$R.DISP);

  11426  1 002046   200071 236100                    LDQ     URES$,,AUTO
         1 002047   777777 376003                    ANQ     -1,DU
         1 002050   200060 036100                    ADLQ    MBSRES$,,AUTO
         1 002051   200073 756100                    STQ     MRES$,,AUTO

     1117    11427    6                       IF RESX >= RSIZ_RES THEN

  11427  1 002052   200067 236100                    LDQ     RESX,,AUTO
         1 002053   200064 116100                    CMPQ    RSIZ_RES,,AUTO
         1 002054   002061 602000 1                  TNC     s:11437

     1118    11428    7                         DO;

     1119    11429    7                         B$JIT.ERR=E_JSIRLS;

  11429  1 002055   000007 236000 0                  LDQ     E_JSIRLS
         1 002056   000000 470400 xsym               LDP0    B$JIT$
         1 002057   000012 756100                    STQ     10,,PR0

     1120    11430        /*E* ERROR:        FOS-E$JSIRLS-E
     1121    11431             MESSAGE:      Insufficient M$JOBSTATS resource list space
     1122    11432             MESSAGE1:     While performing an M$JOBSTATS SRCH (batch queue)
     1123    11433                           service, you have specified too few frames in the
     1124    11434                           resource list (RESLIST_) results area. */
     1125    11435    7                         RETURN;

  11435  1 002060   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:143  

     1126    11436    7                         END;
     1127    11437    6                       R$ISRCH_RES.R.TYP(RESX)=MRES$->JM$QRIT.TYPE;

  11437  1 002061   200067 235100                    LDA     RESX,,AUTO
         1 002062   000001 735000                    ALS     1
         1 002063   200073 470500                    LDP0    MRES$,,AUTO
         1 002064   000000 220100                    LDX0    0,,PR0
         1 002065   000000 471400 xsym               LDP1    B$PS7$
         1 002066   100000 740105                    STX0    0,AL,PR1

     1128    11438    6                       R$ISRCH_RES.R.VNUM(RESX)=MRES$->JM$QRIT.VNUM;

  11438  1 002067   000000 720100                    LXL0    0,,PR0
         1 002070   000000 471400 xsym               LDP1    B$PS7$
         1 002071   100000 440105                    SXL0    0,AL,PR1

     1129    11439    6                       R$ISRCH_RES.R.ATTR(RESX)=MRES$->JM$QRIT.ATTRS;

  11439  1 002072   000001 220100                    LDX0    1,,PR0
         1 002073   000000 471400 xsym               LDP1    B$PS7$
         1 002074   100001 740105                    STX0    1,AL,PR1

     1130    11440    6                       RESX=RESX+1;

  11440  1 002075   000001 036007                    ADLQ    1,DL
         1 002076   200067 756100                    STQ     RESX,,AUTO

     1131    11441    6                       RJOB$->R$JOB.NRES=RJOB$->R$JOB.NRES+1;

  11441  1 002077   200062 471500                    LDP1    RJOB$,,AUTO
         1 002100   100001 220100                    LDX0    1,,PR1
         1 002101   000001 621010                    EAX1    1,X0
         1 002102   100001 741100                    STX1    1,,PR1

     1132    11442    6                       URES$=MRES$->JM$QRIT.NXT$;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:144  
  11442  1 002103   000002 236100                    LDQ     2,,PR0
         1 002104   200071 756100                    STQ     URES$,,AUTO

     1133    11443    6                       END;

  11443  1 002105   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002106   002046 601000 1                  TNZ     s:11426

     1134    11444    5                     END;

     1135    11445
     1136    11446
     1137    11447    4                   FILX=FILX+1;

  11447  1 002107   200017 235100                    LDA     FILX,,AUTO
         1 002110   000001 035007                    ADLA    1,DL
         1 002111   200017 755100                    STA     FILX,,AUTO

  11447  1 002112                       ISKIP        null
     1138    11448
     1139    11449    4   ISKIP:          ;
     1140    11450    4                   UJOB$=MJOB$->JM$IF.LNK$;

  11450  1 002112   200050 470500                    LDP0    MJOB$,,AUTO
         1 002113   000000 236100                    LDQ     0,,PR0
         1 002114   200042 756100                    STQ     UJOB$,,AUTO

     1141    11451    4                   NAHEAD=NAHEAD+1;

  11451  1 002115   200054 054100                    AOS     NAHEAD,,AUTO

     1142    11452    4                   END;

  11452  1 002116   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002117   001554 601000 1                  TNZ     s:11353

     1143    11453    3                 IF IPRIO = JM_Q$RUN THEN NAHEAD=0;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:145  

  11453  1 002120   200057 235100                    LDA     IPRIO,,AUTO
         1 002121   000026 115007                    CMPA    22,DL
         1 002122   002124 601000 1                  TNZ     s:11454

  11453  1 002123   200054 450100                    STZ     NAHEAD,,AUTO

     1144    11454    3                 IPRIO=IPRIO-1;

  11454  1 002124   000001 336007                    LCQ     1,DL
         1 002125   200057 056100                    ASQ     IPRIO,,AUTO

     1145    11455    3                 END;

  11455  1 002126   200057 236100                    LDQ     IPRIO,,AUTO
         1 002127   200016 116100                    CMPQ    LOPRIO,,AUTO
         1 002130   001546 605000 1                  TPL     s:11351

     1146    11456
     1147    11457    2               IF  LOPRIO = JM_Q$WP

  11457  1 002131   200016 235100                    LDA     LOPRIO,,AUTO
         1 002132   000001 115007                    CMPA    1,DL
         1 002133   002143 601000 1                  TNZ     s:11464
         1 002134   000000 470400 xsym               LDP0    B$PS3$
         1 002135   000010 234100                    SZN     8,,PR0
         1 002136   002143 605000 1                  TPL     s:11464

     1148    11458    2               AND VLP$CRITERIA.NORUN THEN
     1149    11459    3                 DO;

     1150    11460    3                 LOPRIO=JM_Q$DP;

  11460  1 002137   000005 235007                    LDA     5,DL
         1 002140   200016 755100                    STA     LOPRIO,,AUTO

     1151    11461    3                 HIPRIO=JM_Q$DP;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:146  

  11461  1 002141   200015 755100                    STA     HIPRIO,,AUTO

     1152    11462    3                 GOTO RELOOP;

  11462  1 002142   001541 710000 1                  TRA     RELOOP

     1153    11463    3                 END;
     1154    11464    2               R$ISRCH.FOUND=FILX;

  11464  1 002143   000000 470400 xsym               LDP0    B$PS2$
         1 002144   200017 235100                    LDA     FILX,,AUTO
         1 002145   000000 755100                    STA     0,,PR0

     1155    11465    2               IF FILX = 0 THEN GOTO NOTFOUND;

  11465  1 002146   000432 600000 1                  TZE     NOTFOUND

     1156    11466    2               RETURN;

  11466  1 002147   000000 702200 xent               TSX2  ! X66_ARET

  11465  1 002150                       NOSLS        null
     1157    11467
     1158    11468    2   NOSLS:      ;
     1159    11469    2               B$JIT.ERR=E_JSISLS;

  11469  1 002150   000010 236000 0                  LDQ     E_JSISLS
         1 002151   000000 470400 xsym               LDP0    B$JIT$
         1 002152   000012 756100                    STQ     10,,PR0

     1160    11470        /*E* ERROR:        FOS-E$JSISLS-E
     1161    11471             MESSAGE:      Insufficient M$JOBSTATS serial number list space
     1162    11472             MESSAGE1:     While performing an M$JOBSTATS SRCH (batch queue)
     1163    11473                           service, you have specified too few frames in the
     1164    11474                           serial number list (SNLIST_) results area. */
     1165    11475    2               RETURN;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:147  

  11475  1 002153   000000 702200 xent               TSX2  ! X66_ARET

     1166    11476
     1167    11477    2   NORSPACE:
     1168    11478    2               B$JIT.ERR = E_JSIRAS;

  11478  1 002154   000006 236000 0     NORSPACE     LDQ     E_JSIRAS
         1 002155   000000 470400 xsym               LDP0    B$JIT$
         1 002156   000012 756100                    STQ     10,,PR0

     1169    11479        /*E* ERROR:        FOS-E$JSIRAS-E
     1170    11480             MESSAGE:      Insufficient number of M$JOBSTATS results frames.
     1171    11481             MESSAGE1:     While performing an M$JOBSTATS SPILL or SRCH service,
     1172    11482                           you have specified too few frames in the primary (RESULTS_)
     1173    11483                           results area.  */
     1174    11484    2               RETURN;

  11484  1 002157   000000 702200 xent               TSX2  ! X66_ARET

     1175    11485
     1176    11486        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:148  
     1177    11487
     1178    11488
     1179    11489
     1180    11490
     1181    11491        /**
     1182    11492         **
     1183    11493         **
     1184    11494         **      UNKNOWN FUNCTION CODE
     1185    11495         **
     1186    11496         **
     1187    11497         **/
     1188    11498    2             CASE (ELSE);

     1189    11499    2               B$JIT.ERR=E_BADFC;

  11499  1 002160   000000 236000 0                  LDQ     E_BADFC
         1 002161   000000 471400 xsym               LDP1    B$JIT$
         1 002162   100012 756100                    STQ     10,,PR1

     1190    11500        /*E* ERROR:        FOS-E$BADFC-E
     1191    11501             MESSAGE:      Unknown M$JOBSTATS function code
     1192    11502             DESCRIPTION:  The function code (order) passed with M$JOBSTATS
     1193    11503                           was unknown.  */
     1194    11504    2               RETURN;

  11504  1 002163   000000 702200 xent               TSX2  ! X66_ARET

     1195    11505
     1196    11506
     1197    11507
     1198    11508        /***
     1199    11509         ***
     1200    11510         ***
     1201    11511         ***          END OF M$JOBSTATS FUNCTION CODE DO CASE
     1202    11512         ***
     1203    11513         ***
     1204    11514         ***/
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:149  
     1205    11515    2           END;

     1206    11516        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:150  
     1207    11517        /**************************************
     1208    11518         **************************************
     1209    11519                    RELSEG
     1210    11520         **************************************
     1211    11521         **************************************/
     1212    11522        /*D* NAME:         RELSEG
     1213    11523             PURPOSE:      To wipe out a status segment
     1214    11524        */
     1215    11525    1   RELSEG: PROC (SEG#);

  11525  1 002164   200106 741300       RELSEG       STX1  ! UDEV$+2,,AUTO

     1216    11526        /**/
     1217    11527    2   DCL SEG# UBIN WORD;
     1218    11528        /**/
     1219    11529    2         IF FOS_SEG$(SEG#) ~= ADDR(NIL) THEN

  11529  1 002165   200107 470500                    LDP0    @SEG#,,AUTO
         1 002166   000000 720100                    LXL0    0,,PR0
         1 002167   000000 236010 xsym               LDQ     FOS_SEG$,X0
         1 002170   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002171   002206 600000 1                  TZE     s:11534

     1220    11530    3           DO;

     1221    11531    3           CALL MMS$VREL (FOS_WSQ,FOS_SEG$(SEG#));

  11531  1 002172   000000 631410 xsym               EPPR1   FOS_SEG$,X0
         1 002173   200115 451500                    STP1    SPECIFIC+4,,AUTO
         1 002174   000002 236000 2                  LDQ     2
         1 002175   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 002176   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 002177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002200   000000 701000 xent               TSX1    MMS$VREL
         1 002201   000000 011000                    NOP     0

     1222    11532    3           FOS_SEG$(SEG#)=ADDR(NIL);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:151  

  11532  1 002202   200107 470500                    LDP0    @SEG#,,AUTO
         1 002203   000000 720100                    LXL0    0,,PR0
         1 002204   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002205   000000 756010 xsym               STQ     FOS_SEG$,X0

     1223    11533    3           END;

     1224    11534    2         RETURN;

  11534  1 002206   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002207   000001 702211                    TSX2  ! 1,X1

     1225    11535    2   END RELSEG;
     1226    11536        /**************************************
     1227    11537         **************************************
     1228    11538                    SET_CHECK
     1229    11539         **************************************
     1230    11540         **************************************/
     1231    11541        /*D* NAME:         SET_CHECK
     1232    11542             PURPOSE:      Inserts the status appropriate to the OUTSYM job
     1233    11543                           frame pointed to by MJOB$, into the R$CHECK results
     1234    11544                           area. Clobbers MFIL$. */
     1235    11545    1   SET_CHECK: PROC;

  11545  1 002210   200110 741300       SET_CHECK    STX1  ! @SEG#+1,,AUTO

     1236    11546
     1237    11547    2         R$CHECK.DEVNAME=' ';

  11547  1 002211   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 002212   000000 470400 xsym               LDP0    B$PS2$
         1 002213   000007 756100                    STQ     7,,PR0

     1238    11548    2         DEVNM1=' ';

  11548  1 002214   200102 756100                    STQ     DEVNM1,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:152  

     1239    11549    2         R$CHECK.TNAME=' ';

  11549  1 002215   000035 235000 xsym               LDA     B_VECTNIL+29
         1 002216   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 002217   000011 755100                    STA     9,,PR0
         1 002220   000012 756100                    STQ     10,,PR0

     1240    11550    2         TNAME=' ';

  11550  1 002221   000035 235000 xsym               LDA     B_VECTNIL+29
         1 002222   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 002223   200035 755100                    STA     TNAME,,AUTO
         1 002224   200036 756100                    STQ     TNAME+1,,AUTO

     1241    11551    2         R$CHECK.AHEAD=NAHEAD;

  11551  1 002225   200054 235100                    LDA     NAHEAD,,AUTO
         1 002226   000002 755100                    STA     2,,PR0

     1242    11552    2         R$CHECK.NOF=MJOB$->FO$JOB.NFIL;

  11552  1 002227   200050 471500                    LDP1    MJOB$,,AUTO
         1 002230   100002 720100                    LXL0    2,,PR1
         1 002231   000005 740100                    STX0    5,,PR0

     1243    11553    2         R$CHECK.NOFDONE=MJOB$->FO$JOB.NFIL_DONE;

  11553  1 002232   100003 721100                    LXL1    3,,PR1
         1 002233   000005 441100                    SXL1    5,,PR0

     1244    11554    2         R$CHECK.NOFPRINTING=MJOB$->FO$JOB.NFIL_PRINTING;

  11554  1 002234   100003 222100                    LDX2    3,,PR1
         1 002235   003777 362003                    ANX2    2047,DU
         1 002236   000006 742100                    STX2    6,,PR0

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:153  
     1245    11555    2         R$CHECK.NOFSPILLED=0;

  11555  1 002237   000000 223003                    LDX3    0,DU
         1 002240   000006 443100                    SXL3    6,,PR0

     1246    11556    2         UFIL$=MJOB$->FO$JOB.FILHD$;

  11556  1 002241   100001 236100                    LDQ     1,,PR1
         1 002242   200020 756100                    STQ     UFIL$,,AUTO

     1247    11557    3           DO WHILE (UFIL$ ~= ADDR(NIL));

  11557  1 002243   002322 710000 1                  TRA     s:11575

     1248    11558    3           MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);

  11558  1 002244   200020 236100                    LDQ     UFIL$,,AUTO
         1 002245   777777 376003                    ANQ     -1,DU
         1 002246   200021 036100                    ADLQ    SYMFIL$,,AUTO
         1 002247   200022 756100                    STQ     MFIL$,,AUTO

     1249    11559    3           R$CHECK.DEVAVAIL=R$CHECK.DEVAVAIL|MFIL$->FO$FIL.FLG.LPAVAIL;

  11559  1 002250   200022 470500                    LDP0    MFIL$,,AUTO
         1 002251   000015 236100                    LDQ     13,,PR0
         1 002252   000033 736000                    QLS     27
         1 002253   400000 376003                    ANQ     -131072,DU
         1 002254   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 002255   000000 471400 xsym               LDP1    B$PS2$
         1 002256   100010 236100                    LDQ     8,,PR1
         1 002257   400000 376003                    ANQ     -131072,DU
         1 002260   200114 276100                    ORQ     SPECIFIC+3,,AUTO
         1 002261   100010 676100                    ERQ     8,,PR1
         1 002262   400000 376003                    ANQ     -131072,DU
         1 002263   100010 656100                    ERSQ    8,,PR1

     1250    11560    3           IF MFIL$->FO$FIL.PRIO = FOPR_SPILLED# THEN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:154  

  11560  1 002264   000016 236100                    LDQ     14,,PR0
         1 002265   000777 376007                    ANQ     511,DL
         1 002266   000002 116007                    CMPQ    2,DL
         1 002267   002273 601000 1                  TNZ     s:11562

     1251    11561    3            R$CHECK.NOFSPILLED=R$CHECK.NOFSPILLED+1;

  11561  1 002270   100006 720100                    LXL0    6,,PR1
         1 002271   000001 621010                    EAX1    1,X0
         1 002272   100006 441100                    SXL1    6,,PR1

     1252    11562    3           IF MFIL$->FO$FIL.CDEV$ ~= ADDR(NIL) THEN

  11562  1 002273   000011 236100                    LDQ     9,,PR0
         1 002274   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002275   002320 600000 1                  TZE     s:11574

     1253    11563    4             DO;

     1254    11564    4             UDEV$=MFIL$->FO$FIL.CDEV$;

  11564  1 002276   200104 756100                    STQ     UDEV$,,AUTO

     1255    11565    4             MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);

  11565  1 002277   200104 236100                    LDQ     UDEV$,,AUTO
         1 002300   777777 376003                    ANQ     -1,DU
         1 002301   200100 036100                    ADLQ    SYMDEV$,,AUTO
         1 002302   200103 756100                    STQ     MDEV$,,AUTO

     1256    11566    4             DEVNM1=SUBSTR(MDEV$->FO$DEV.NAME,0,4);

  11566  1 002303   200103 473500                    LDP3    MDEV$,,AUTO
         1 002304   300005 236100                    LDQ     5,,PR3
         1 002305   200102 756100                    STQ     DEVNM1,,AUTO

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:155  
     1257    11567    4             TNAME=MDEV$->FO$DEV.TNAME;

  11567  1 002306   040100 100500                    MLR     fill='040'O
         1 002307   300007 000010                    ADSC9   7,,PR3                   cn=0,n=8
         1 002310   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8

     1258    11568    4             IF MDEV$->FO$DEV.NAMER.TYP = 'LP' THEN

  11568  1 002311   300005 220100                    LDX0    5,,PR3
         1 002312   000040 100000 0                  CMPX0   RCHECK_INIT+14
         1 002313   002320 601000 1                  TNZ     s:11574

     1259    11569    5               DO;

     1260    11570    5               R$CHECK.DEVNAME=DEVNM1;

  11570  1 002314   100007 756100                    STQ     7,,PR1

     1261    11571    5               R$CHECK.TNAME=TNAME;

  11571  1 002315   040100 100500                    MLR     fill='040'O
         1 002316   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8
         1 002317   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8

     1262    11572    5               END;

     1263    11573    4             END;

     1264    11574    3           UFIL$=MFIL$->FO$FIL.JLNK$;

  11574  1 002320   000004 236100                    LDQ     4,,PR0
         1 002321   200020 756100                    STQ     UFIL$,,AUTO

     1265    11575    3           END;

  11575  1 002322   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002323   002244 601000 1                  TNZ     s:11558
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:156  

     1266    11576    2         IF R$CHECK.DEVNAME = ' ' THEN

  11576  1 002324   000000 470400 xsym               LDP0    B$PS2$
         1 002325   000007 236100                    LDQ     7,,PR0
         1 002326   000035 116000 xsym               CMPQ    B_VECTNIL+29
         1 002327   002335 601000 1                  TNZ     s:11581

     1267    11577    3           DO;

     1268    11578    3           R$CHECK.DEVNAME=DEVNM1;

  11578  1 002330   200102 236100                    LDQ     DEVNM1,,AUTO
         1 002331   000007 756100                    STQ     7,,PR0

     1269    11579    3           R$CHECK.TNAME=TNAME;

  11579  1 002332   040100 100500                    MLR     fill='040'O
         1 002333   200035 000010                    ADSC9   TNAME,,AUTO              cn=0,n=8
         1 002334   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8

     1270    11580    3           END;

     1271    11581    2         IF R$CHECK.NOFPRINTING = 0 THEN

  11581  1 002335   000006 220100                    LDX0    6,,PR0
         1 002336   002362 601000 1                  TNZ     s:11587

     1272    11582    3           DO;

     1273    11583    3           IF R$CHECK.NOFSPILLED + R$CHECK.NOFDONE = R$CHECK.NOF THEN

  11583  1 002337   000005 236100                    LDQ     5,,PR0
         1 002340   777777 376007                    ANQ     -1,DL
         1 002341   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 002342   000006 236100                    LDQ     6,,PR0
         1 002343   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:157  
         1 002344   200114 036100                    ADLQ    SPECIFIC+3,,AUTO
         1 002345   200115 756100                    STQ     SPECIFIC+4,,AUTO
         1 002346   000005 236100                    LDQ     5,,PR0
         1 002347   000022 772000                    QRL     18
         1 002350   200116 756100                    STQ     SPECIFIC+5,,AUTO
         1 002351   200115 236100                    LDQ     SPECIFIC+4,,AUTO
         1 002352   200116 116100                    CMPQ    SPECIFIC+5,,AUTO
         1 002353   002357 601000 1                  TNZ     s:11585

     1274    11584    3            R$CHECK.CODE=%JS_SPILLED#;

  11584  1 002354   000006 235007                    LDA     6,DL
         1 002355   000000 755100                    STA     0,,PR0
         1 002356   002364 710000 1                  TRA     s:11588

     1275    11585    3           ELSE R$CHECK.CODE=%JS_PWAIT#;

  11585  1 002357   000003 235007                    LDA     3,DL
         1 002360   000000 755100                    STA     0,,PR0

     1276    11586    3           END;

  11586  1 002361   002364 710000 1                  TRA     s:11588

     1277    11587    2         ELSE R$CHECK.CODE=%JS_PRT#;

  11587  1 002362   000004 235007                    LDA     4,DL
         1 002363   000000 755100                    STA     0,,PR0

     1278    11588    2         R$CHECK.SYSID=SYSID;

  11588  1 002364   000000 470400 xsym               LDP0    B$PS2$
         1 002365   200037 235100                    LDA     SYSID,,AUTO
         1 002366   000003 755100                    STA     3,,PR0

     1279    11589    2         RETURN;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:158  
  11589  1 002367   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 002370   000001 702211                    TSX2  ! 1,X1

     1280    11590    2   END SET_CHECK;
     1281    11591        /**************************************
     1282    11592         **************************************
     1283    11593                    SET_FPRIO
     1284    11594         **************************************
     1285    11595         **************************************/
     1286    11596        /*D* NAME:         SET_FPRIO
     1287    11597             PURPOSE:      To set the priority and status for a file.
     1288    11598             DESCRIPTION:  MFIL$ points to an OUTSYM file frame.  UPRIO
     1289    11599                           and UCODE are set the the appropriate prio and
     1290    11600                           status codes for that file.  Also, DEVNM is
     1291    11601                           set to the file's current device if the file
     1292    11602                           is printing. */
     1293    11603    1   SET_FPRIO: PROC;

  11603  1 002371   200106 741300       SET_FPRIO    STX1  ! UDEV$+2,,AUTO

     1294    11604
     1295    11605    2         FPRIO=MFIL$->FO$FIL.PRIO;

  11605  1 002372   200022 470500                    LDP0    MFIL$,,AUTO
         1 002373   000016 236100                    LDQ     14,,PR0
         1 002374   000777 376007                    ANQ     511,DL
         1 002375   200047 756100                    STQ     FPRIO,,AUTO

     1296    11606
     1297    11607    3           DO CASE (FPRIO);

  11607  1 002376   000003 116007                    CMPQ    3,DL
         1 002377   002401 602006 1                  TNC     s:11607+3,QL
         1 002400   002422 710000 1                  TRA     s:11622
         1 002401   002411 710000 1                  TRA     s:11614
         1 002402   002415 710000 1                  TRA     s:11618
         1 002403   002404 710000 1                  TRA     s:11610
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:159  

     1298    11608
     1299    11609    3             CASE (FOPR_SPILLED#);

     1300    11610    3               UCODE=%FS_SPILLED#;

  11610  1 002404   000004 235007                    LDA     4,DL
         1 002405   200077 755100                    STA     UCODE,,AUTO

     1301    11611    3               UPRIO=%FP_SPILLED#;

  11611  1 002406   000023 235007                    LDA     19,DL
         1 002407   200075 755100                    STA     UPRIO,,AUTO
         1 002410   002452 710000 1                  TRA     s:11638

     1302    11612
     1303    11613    3             CASE (FOPR_HOLD#);

     1304    11614    3               UCODE=%FS_HOLD#;

  11614  1 002411   200077 450100                    STZ     UCODE,,AUTO

     1305    11615    3               UPRIO=%FP_HOLD#;

  11615  1 002412   000021 235007                    LDA     17,DL
         1 002413   200075 755100                    STA     UPRIO,,AUTO
         1 002414   002452 710000 1                  TRA     s:11638

     1306    11616
     1307    11617    3             CASE (FOPR_MFW#);

     1308    11618    3               UCODE=%FS_MFW#;

  11618  1 002415   000001 235007                    LDA     1,DL
         1 002416   200077 755100                    STA     UCODE,,AUTO

     1309    11619    3               UPRIO=%FP_MFW#;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:160  

  11619  1 002417   000020 235007                    LDA     16,DL
         1 002420   200075 755100                    STA     UPRIO,,AUTO
         1 002421   002452 710000 1                  TRA     s:11638

     1310    11620
     1311    11621    3             CASE (ELSE);

     1312    11622    3               UCODE=%FS_PWAIT#;

  11622  1 002422   000002 235007                    LDA     2,DL
         1 002423   200077 755100                    STA     UCODE,,AUTO

     1313    11623    3               IF  FPRIO >= FOPR_P0#

  11623  1 002424   000003 116007                    CMPQ    3,DL
         1 002425   002450 602000 1                  TNC     s:11635
         1 002426   000023 116007                    CMPQ    19,DL
         1 002427   002450 603000 1                  TRC     s:11635

     1314    11624    3               AND FPRIO <= FOPR_P15# THEN
     1315    11625    4                 DO;

     1316    11626    4                 UPRIO=FPRIO-FOPR_P0#;

  11626  1 002430   000003 136007                    SBLQ    3,DL
         1 002431   200075 756100                    STQ     UPRIO,,AUTO

     1317    11627    4                 UDEV$=MFIL$->FO$FIL.CDEV$;

  11627  1 002432   000011 236100                    LDQ     9,,PR0
         1 002433   200104 756100                    STQ     UDEV$,,AUTO

     1318    11628    4                 IF UDEV$ ~= ADDR(NIL) THEN

  11628  1 002434   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002435   002452 600000 1                  TZE     s:11638
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:161  

     1319    11629    5                   DO;

     1320    11630    5                   UCODE=%FS_PRT#;

  11630  1 002436   000003 235007                    LDA     3,DL
         1 002437   200077 755100                    STA     UCODE,,AUTO

     1321    11631    5                   MDEV$=PINCRW(SYMDEV$,UDEV$R.DISP);

  11631  1 002440   200104 236100                    LDQ     UDEV$,,AUTO
         1 002441   777777 376003                    ANQ     -1,DU
         1 002442   200100 036100                    ADLQ    SYMDEV$,,AUTO
         1 002443   200103 756100                    STQ     MDEV$,,AUTO

     1322    11632    5                   DEVNM=SUBSTR(MDEV$->FO$DEV.NAME,0,4);

  11632  1 002444   200103 471500                    LDP1    MDEV$,,AUTO
         1 002445   100005 236100                    LDQ     5,,PR1
         1 002446   200101 756100                    STQ     DEVNM,,AUTO

     1323    11633    5                   END;

     1324    11634    4                 END;

  11634  1 002447   002452 710000 1                  TRA     s:11638

     1325    11635    3               ELSE UPRIO=%FP_OTHER#;

  11635  1 002450   000022 235007                    LDA     18,DL
         1 002451   200075 755100                    STA     UPRIO,,AUTO

     1326    11636
     1327    11637    3           END;

     1328    11638    2         RETURN;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:162  
  11638  1 002452   000001 702211                    TSX2  ! 1,X1

     1329    11639    2   END SET_FPRIO;
     1330    11640        /**************************************
     1331    11641         **************************************
     1332    11642                    DOCHECK
     1333    11643         **************************************
     1334    11644         **************************************/
     1335    11645        /*D* NAME:         DOCHECK
     1336    11646             PURPOSE:      To perform a check function
     1337    11647             DESCRIPTION:  The R$CHECK results area is filled with the
     1338    11648                           appropriate status for the specified job.
     1339    11649                           All fields are set to their default values
     1340    11650                           which would be correct if the job (or files
     1341    11651                           belonging thereto) were not found (e.g. DEVNM
     1342    11652                           is set to blanks).
     1343    11653        */
     1344    11654    1   DOCHECK: PROC;

  11654  1 002453   200106 741300       DOCHECK      STX1  ! UDEV$+2,,AUTO

     1345    11655
     1346    11656              /* Make sure we have a RESULTS_ */
     1347    11657    2         CALL HFF$DSIZ (2, RSIZ) ALTRET (NO_RESULTS_VECTOR);

  11657  1 002454   200063 630500                    EPPR0   RSIZ,,AUTO
         1 002455   200115 450500                    STP0    SPECIFIC+4,,AUTO
         1 002456   000013 236000 2                  LDQ     11
         1 002457   200114 756100                    STQ     SPECIFIC+3,,AUTO
         1 002460   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 002461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002462   000000 701000 xent               TSX1    HFF$DSIZ
         1 002463   002465 702000 1                  TSX2    NO_RESULTS_VECTOR

     1348    11658
     1349    11659    3           DO WHILE ( '0'B );

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:163  
  11659  1 002464   002472 710000 1                  TRA     s:11666

     1350    11660    3   NO_RESULTS_VECTOR:
     1351    11661    3           B$JIT.ERR = E_JSNORESULTS;

  11661  1 002465   000011 236000 0     NO_RESULTS_* LDQ     E_JSNORESULTS
         1 002466   000000 470400 xsym               LDP0    B$JIT$
         1 002467   000012 756100                    STQ     10,,PR0

     1352    11662    3           RETURN;

  11662  1 002470   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002471   000001 702211                    TSX2  ! 1,X1

     1353    11663    3           END;

     1354    11664
     1355    11665              /* We have a RESULTS_, but is it big enough? */
     1356    11666    2         IF RSIZ < SIZEC (RCHECK_INIT)

  11666  1 002472   200063 235100                    LDA     RSIZ,,AUTO
         1 002473   000060 115007                    CMPA    48,DL
         1 002474   002502 603000 1                  TRC     s:11673

     1357    11667    2         THEN
     1358    11668    3           DO;

     1359    11669    3           B$JIT.ERR = E_JSIRPS;

  11669  1 002475   000013 236000 0                  LDQ     E_JSIRPS
         1 002476   000000 470400 xsym               LDP0    B$JIT$
         1 002477   000012 756100                    STQ     10,,PR0

     1360    11670    3           RETURN;

  11670  1 002500   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002501   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:164  

     1361    11671    3           END;
     1362    11672
     1363    11673    2         R$CHECK=RCHECK_INIT;

  11673  1 002502   000000 470400 xsym               LDP0    B$PS2$
         1 002503   000100 100400                    MLR     fill='000'O
         1 002504   000022 000054 0                  ADSC9   RCHECK_INIT              cn=0,n=44
         1 002505   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44

     1364    11674    2         R$CHECK.CODE=%JS_NOTF#;

  11674  1 002506   000005 235007                    LDA     5,DL
         1 002507   000000 470400 xsym               LDP0    B$PS2$
         1 002510   000000 755100                    STA     0,,PR0

     1365    11675    2         R$CHECK.FCODE=%FS_NOTF#;

  11675  1 002511   000005 220003                    LDX0    5,DU
         1 002512   000000 470400 xsym               LDP0    B$PS2$
         1 002513   000004 740100                    STX0    4,,PR0

     1366    11676
     1367    11677    2         CALL FINDPRE ALTRET(CHK1);

  11677  1 002514   003106 701000 1                  TSX1    FINDPRE
         1 002515   002522 702000 1                  TSX2    CHK1

     1368    11678    2         R$CHECK.CODE=%JS_AP#;

  11678  1 002516   000007 235007                    LDA     7,DL
         1 002517   000000 470400 xsym               LDP0    B$PS2$
         1 002520   000000 755100                    STA     0,,PR0

     1369    11679    2         GOTO DONE;

  11679  1 002521   002606 710000 1                  TRA     DONE
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:165  

  11678  1 002522                       CHK1         null
     1370    11680    2   CHK1: ;
     1371    11681    2         CALL FINDOUTP ALTRET(CHK0);

  11681  1 002522   003167 701000 1                  TSX1    FINDOUTP
         1 002523   002543 702000 1                  TSX2    CHK0

     1372    11682    2         IF B$JIT.ACCN ~= MJOB$->FO$JOB.ACCT

  11682  1 002524   000000 470400 xsym               LDP0    B$JIT$
         1 002525   200050 471500                    LDP1    MJOB$,,AUTO
         1 002526   040100 106500                    CMPC    fill='040'O
         1 002527   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 002530   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 002531   002536 601000 1                  TNZ     s:11684
         1 002532   040100 106500                    CMPC    fill='040'O
         1 002533   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 002534   100006 200014                    ADSC9   6,,PR1                   cn=1,n=12
         1 002535   002541 600000 1                  TZE     s:11686

     1373    11683    2         OR B$JIT.UNAME ~= MJOB$->FO$JOB.UNAME THEN
     1374    11684    2          IF NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#) THEN

  11684  1 002536   000013 236100                    LDQ     11,,PR0
         1 002537   000026 376000 xsym               ANQ     B_VECTNIL+22
         1 002540   002543 600000 1                  TZE     CHK0

     1375    11685    2           GOTO CHK0;
     1376    11686    2         CALL SET_CHECK;

  11686  1 002541   002210 701000 1                  TSX1    SET_CHECK
         1 002542   000000 011000                    NOP     0

  11682  1 002543                       CHK0         null
     1377    11687    2   CHK0: ;
     1378    11688    2         CALL FINDJOB ALTRET(DONE);
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:166  

  11688  1 002543   002751 701000 1                  TSX1    FINDJOB
         1 002544   002606 702000 1                  TSX2    DONE

     1379    11689    2         IF B$JIT.ACCN ~= MJOB$->JM$IF.ACCT

  11689  1 002545   000000 470400 xsym               LDP0    B$JIT$
         1 002546   200050 471500                    LDP1    MJOB$,,AUTO
         1 002547   040100 106500                    CMPC    fill='040'O
         1 002550   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 002551   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         1 002552   002557 601000 1                  TNZ     s:11691
         1 002553   040100 106500                    CMPC    fill='040'O
         1 002554   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 002555   100017 000014                    ADSC9   15,,PR1                  cn=0,n=12
         1 002556   002562 600000 1                  TZE     s:11693

     1380    11690    2         OR B$JIT.UNAME ~= MJOB$->JM$IF.UNAME THEN
     1381    11691    2          IF NOT (B$JIT.PRIV.ACTIVE & %PR_DISPJOB#) THEN

  11691  1 002557   000013 236100                    LDQ     11,,PR0
         1 002560   000026 376000 xsym               ANQ     B_VECTNIL+22
         1 002561   002606 600000 1                  TZE     DONE

     1382    11692    2           GOTO DONE;
     1383    11693    2         R$CHECK.IPRIO = SUBMISSION_PRIO;

  11693  1 002562   000000 473400 xsym               LDP3    B$PS2$
         1 002563   200045 236100                    LDQ     SUBMISSION_PRIO,,AUTO
         1 002564   000011 736000                    QLS     9
         1 002565   300001 552110                    STBQ    1,'10'O,PR3

     1384    11694    2         IF JPRIO = JM_Q$RUN THEN

  11694  1 002566   200046 235100                    LDA     JPRIO,,AUTO
         1 002567   000026 115007                    CMPA    22,DL
         1 002570   002574 601000 1                  TNZ     s:11698
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:167  

     1385    11695    2          R$CHECK.CODE=%JS_RUN#;

  11695  1 002571   000002 236007                    LDQ     2,DL
         1 002572   300000 756100                    STQ     0,,PR3
         1 002573   002606 710000 1                  TRA     DONE

     1386    11696    2         ELSE
     1387    11697    3           DO;

     1388    11698    3           CALL SET_JPRIO;

  11698  1 002574   002613 701000 1                  TSX1    SET_JPRIO
         1 002575   000000 011000                    NOP     0

     1389    11699    3           R$CHECK.CODE=%JS_WAIT#;

  11699  1 002576   000001 235007                    LDA     1,DL
         1 002577   000000 470400 xsym               LDP0    B$PS2$
         1 002600   000000 755100                    STA     0,,PR0

     1390    11700    3           R$CHECK.PRIO=UPRIO;

  11700  1 002601   000000 470400 xsym               LDP0    B$PS2$
         1 002602   200075 236100                    LDQ     UPRIO,,AUTO
         1 002603   000001 552104                    STBQ    1,'04'O,PR0

     1391    11701    3           R$CHECK.AHEAD=NAHEAD;

  11701  1 002604   200054 235100                    LDA     NAHEAD,,AUTO
         1 002605   000002 755100                    STA     2,,PR0

     1392    11702    3           END;

  11694  1 002606                       DONE         null
     1393    11703    2   DONE: ;
     1394    11704    2         R$CHECK.SYSID=SYSID;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:168  

  11704  1 002606   000000 470400 xsym               LDP0    B$PS2$
         1 002607   200037 235100                    LDA     SYSID,,AUTO
         1 002610   000003 755100                    STA     3,,PR0

     1395    11705    2         RETURN;

  11705  1 002611   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002612   000001 702211                    TSX2  ! 1,X1

     1396    11706    2   END DOCHECK;
     1397    11707        /**************************************
     1398    11708         **************************************
     1399    11709                    SET_JPRIO
     1400    11710         **************************************
     1401    11711         **************************************/
     1402    11712        /*D* NAME:         SET_JPRIO
     1403    11713
     1404    11714             PURPOSE:      XLATES JPRIO (INDEX TO MBS QUEUES) TO
     1405    11715                           UPRIO (A LA CP_6_SUBS JP_XXXX#) */
     1406    11716    1   SET_JPRIO: PROC;

  11716  1 002613   200110 741300       SET_JPRIO    STX1  ! @SEG#+1,,AUTO

     1407    11717
     1408    11718    3           DO CASE (JPRIO);

  11718  1 002614   200046 235100                    LDA     JPRIO,,AUTO
         1 002615   000027 115007                    CMPA    23,DL
         1 002616   002620 602005 1                  TNC     s:11718+4,AL
         1 002617   002666 710000 1                  TRA     s:11736
         1 002620   002666 710000 1                  TRA     s:11736
         1 002621   002647 710000 1                  TRA     s:11721
         1 002622   002652 710000 1                  TRA     s:11724
         1 002623   002666 710000 1                  TRA     s:11736
         1 002624   002655 710000 1                  TRA     s:11727
         1 002625   002663 710000 1                  TRA     s:11733
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:169  
         1 002626   002666 710000 1                  TRA     s:11736
         1 002627   002666 710000 1                  TRA     s:11736
         1 002630   002666 710000 1                  TRA     s:11736
         1 002631   002666 710000 1                  TRA     s:11736
         1 002632   002666 710000 1                  TRA     s:11736
         1 002633   002666 710000 1                  TRA     s:11736
         1 002634   002666 710000 1                  TRA     s:11736
         1 002635   002666 710000 1                  TRA     s:11736
         1 002636   002666 710000 1                  TRA     s:11736
         1 002637   002666 710000 1                  TRA     s:11736
         1 002640   002666 710000 1                  TRA     s:11736
         1 002641   002666 710000 1                  TRA     s:11736
         1 002642   002666 710000 1                  TRA     s:11736
         1 002643   002666 710000 1                  TRA     s:11736
         1 002644   002666 710000 1                  TRA     s:11736
         1 002645   002666 710000 1                  TRA     s:11736
         1 002646   002660 710000 1                  TRA     s:11730

     1409    11719
     1410    11720    3             CASE (JM_Q$WP); /* WAITING 4 PARTITION */

     1411    11721    3               UPRIO=%JP_WPART#;

  11721  1 002647   000023 236007                    LDQ     19,DL
         1 002650   200075 756100                    STQ     UPRIO,,AUTO
         1 002651   002677 710000 1                  TRA     s:11742

     1412    11722
     1413    11723    3             CASE (JM_Q$WR); /* WAITING 4 RUNAFTER TIME */

     1414    11724    3               UPRIO=%JP_RUNAFTER#;

  11724  1 002652   000022 236007                    LDQ     18,DL
         1 002653   200075 756100                    STQ     UPRIO,,AUTO
         1 002654   002677 710000 1                  TRA     s:11742

     1415    11725
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:170  
     1416    11726    3             CASE (JM_Q$JD); /* WAITING 4 FOLLOW CONDITION */

     1417    11727    3               UPRIO=%JP_FOLL#;

  11727  1 002655   000021 236007                    LDQ     17,DL
         1 002656   200075 756100                    STQ     UPRIO,,AUTO
         1 002657   002677 710000 1                  TRA     s:11742

     1418    11728
     1419    11729    3             CASE (JM_Q$RUN);

     1420    11730    3               UPRIO=%JP_RUN#;

  11730  1 002660   000020 236007                    LDQ     16,DL
         1 002661   200075 756100                    STQ     UPRIO,,AUTO
         1 002662   002677 710000 1                  TRA     s:11742

     1421    11731
     1422    11732    3             CASE (JM_Q$DP);

     1423    11733    3               UPRIO=%JP_WPS#;

  11733  1 002663   000025 236007                    LDQ     21,DL
         1 002664   200075 756100                    STQ     UPRIO,,AUTO
         1 002665   002677 710000 1                  TRA     s:11742

     1424    11734
     1425    11735    3             CASE (ELSE);

     1426    11736    3               IF  JPRIO >= JM_Q$P0

  11736  1 002666   000006 115007                    CMPA    6,DL
         1 002667   002675 602000 1                  TNC     s:11739
         1 002670   000026 115007                    CMPA    22,DL
         1 002671   002675 603000 1                  TRC     s:11739

     1427    11737    3               AND JPRIO <= JM_Q$P15
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:171  
     1428    11738    3               THEN UPRIO=JPRIO-JM_Q$P0;

  11738  1 002672   000006 135007                    SBLA    6,DL
         1 002673   200075 755100                    STA     UPRIO,,AUTO
         1 002674   002677 710000 1                  TRA     s:11742

     1429    11739    3               ELSE UPRIO=%JP_OTHER#;

  11739  1 002675   000024 236007                    LDQ     20,DL
         1 002676   200075 756100                    STQ     UPRIO,,AUTO

     1430    11740
     1431    11741    3           END;

     1432    11742    2         RETURN;

  11742  1 002677   000001 702211                    TSX2  ! 1,X1

     1433    11743    2   END SET_JPRIO;
     1434    11744        /**************************************
     1435    11745         **************************************
     1436    11746                    GET_SNS
     1437    11747         **************************************
     1438    11748         **************************************/
     1439    11749        /*D* NAME:         GET_SNS
     1440    11750             PURPOSE:      To extract SNLIST entries from an MBS chain,
     1441    11751                           and stuff them into the user's SNLIST results
     1442    11752                           area.  ALTRETs if no room in latter.  */
     1443    11753    1   GET_SNS: PROC ALTRET;

  11753  1 002700   200106 741300       GET_SNS      STX1  ! UDEV$+2,,AUTO

     1444    11754
     1445    11755    3           DO WHILE (USN$ ~= ADDR(NIL));

  11755  1 002701   002744 710000 1                  TRA     s:11763

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:172  
     1446    11756    3           IF SNX >= RSIZ_SN THEN ALTRETURN;

  11756  1 002702   200070 236100                    LDQ     SNX,,AUTO
         1 002703   200065 116100                    CMPQ    RSIZ_SN,,AUTO
         1 002704   002707 602000 1                  TNC     s:11757

  11756  1 002705   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002706   000000 702211                    TSX2  ! 0,X1

     1447    11757    3           MSN$=PINCRW(MBSSN$,USN$R.DISP);

  11757  1 002707   200072 236100                    LDQ     USN$,,AUTO
         1 002710   777777 376003                    ANQ     -1,DU
         1 002711   200060 036100                    ADLQ    MBSRES$,,AUTO
         1 002712   200074 756100                    STQ     MSN$,,AUTO

     1448    11758    3           R$ISRCH_SN.S.NAME(SNX)=MSN$->JM$SN.TXT;

  11758  1 002713   200070 235100                    LDA     SNX,,AUTO
         1 002714   000001 735000                    ALS     1
         1 002715   000002 735000                    ALS     2
         1 002716   200074 470500                    LDP0    MSN$,,AUTO
         1 002717   000000 471400 xsym               LDP1    B$PS6$
         1 002720   040105 100500                    MLR     fill='040'O
         1 002721   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         1 002722   100000 000006                    ADSC9   0,A,PR1                  cn=0,n=6

     1449    11759    3           R$ISRCH_SN.S.FLG(SNX)=MSN$->JM$SN.FLGS;

  11759  1 002723   200070 235100                    LDA     SNX,,AUTO
         1 002724   000001 735000                    ALS     1
         1 002725   000100 100500                    MLR     fill='000'O
         1 002726   000001 400001                    ADSC9   1,,PR0                   cn=2,n=1
         1 002727   200114 000004                    ADSC9   SPECIFIC+3,,AUTO         cn=0,n=4
         1 002730   200114 220100                    LDX0    SPECIFIC+3,,AUTO
         1 002731   000000 471400 xsym               LDP1    B$PS6$
         1 002732   100001 440105                    SXL0    1,AL,PR1
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:173  

     1450    11760    3           USN$=MSN$->JM$SN.NXT$;

  11760  1 002733   000002 236100                    LDQ     2,,PR0
         1 002734   200072 756100                    STQ     USN$,,AUTO

     1451    11761    3           RJOB$->R$JOB.NSN=RJOB$->R$JOB.NSN+1;

  11761  1 002735   200062 471500                    LDP1    RJOB$,,AUTO
         1 002736   100000 220100                    LDX0    0,,PR1
         1 002737   000001 621010                    EAX1    1,X0
         1 002740   100000 741100                    STX1    0,,PR1

     1452    11762    3           SNX=SNX+1;

  11762  1 002741   200070 235100                    LDA     SNX,,AUTO
         1 002742   000001 035007                    ADLA    1,DL
         1 002743   200070 755100                    STA     SNX,,AUTO

     1453    11763    3           END;

  11763  1 002744   200072 236100                    LDQ     USN$,,AUTO
         1 002745   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002746   002702 601000 1                  TNZ     s:11756

     1454    11764    2         RETURN;

  11764  1 002747   200106 221300                    LDX1  ! UDEV$+2,,AUTO
         1 002750   000001 702211                    TSX2  ! 1,X1

     1455    11765    2   END GET_SNS;
     1456    11766        /**************************************
     1457    11767         **************************************
     1458    11768                    FINDJOB
     1459    11769         **************************************
     1460    11770         **************************************/
     1461    11771        /*D* NAME:         FINDJOB
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:174  
     1462    11772             PURPOSE:      To find a job in the in-core status tables
     1463    11773             DESCRIPTION:  The M$JOBSTATS PMME FPT contains either a SYSID
     1464    11774                           or JOBNAME & ACCT selecting the job to be found.
     1465    11775
     1466    11776                           The routine ALTRETs if no such job is found.
     1467    11777                           Otherwise it returns with MJOB$ pointing to
     1468    11778                           the MBS job frame.
     1469    11779
     1470    11780                           If normal return, then JPRIO is set to the
     1471    11781                           numeric MBS queue index of the job, and
     1472    11782                           NAHEAD is set to the number of jobs ahead
     1473    11783                           of it if it is not running.  Note that if
     1474    11784                           the request is by jobname, then SYSID is
     1475    11785                           set to the job's sysid. */
     1476    11786
     1477    11787
     1478    11788    1   FINDJOB: PROC ALTRET;

  11788  1 002751   200110 741300       FINDJOB      STX1  ! @SEG#+1,,AUTO

     1479    11789
     1480    11790                                /* SET UP PARAMS */
     1481    11791    2         CALL GET_JP;

  11791  1 002752   003317 701000 1                  TSX1    GET_JP
         1 002753   000000 011000                    NOP     0

     1482    11792
     1483    11793
     1484    11794
     1485    11795                                /* SEARCH THE MBS QUEUES */
     1486    11796
     1487    11797
     1488    11798    2         CALL GET_MBSHDR ALTRET(ALTRT);

  11798  1 002754   003455 701000 1                  TSX1    GET_MBSHDR
         1 002755   003104 702000 1                  TSX2    ALTRT
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:175  

     1489    11799
     1490    11800                           /* RUN Q 1ST */
     1491    11801    2         JPRIO=JM_Q$RUN;

  11801  1 002756   000026 235007                    LDA     22,DL
         1 002757   200046 755100                    STA     JPRIO,,AUTO

     1492    11802    2         CALL SRCHQ ALTRET(S1);

  11802  1 002760   003003 701000 1                  TSX1    SRCHQ
         1 002761   002764 702000 1                  TSX2    S1

     1493    11803    2         RETURN;  /* FOUND IT RUNNING */

  11803  1 002762   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 002763   000001 702211                    TSX2  ! 1,X1

  11801  1 002764                       S1           null
     1494    11804
     1495    11805    2   S1:   ;
     1496    11806    2         NAHEAD=0;

  11806  1 002764   200054 450100                    STZ     NAHEAD,,AUTO

     1497    11807                           /* SEARCH FROM PRIO 15 DOWN */
     1498    11808    2         JPRIO=JM_Q$P15;

  11808  1 002765   000025 235007                    LDA     21,DL
         1 002766   200046 755100                    STA     JPRIO,,AUTO

  11808  1 002767                       S2           null
     1499    11809    2   S2:   ;
     1500    11810    2         CALL SRCHQ ALTRET(S3);

  11810  1 002767   003003 701000 1                  TSX1    SRCHQ
         1 002770   002773 702000 1                  TSX2    S3
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:176  

     1501    11811    2         RETURN;  /* FOUND IT */

  11811  1 002771   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 002772   000001 702211                    TSX2  ! 1,X1

  11808  1 002773                       S3           null
     1502    11812    2   S3:   ;
     1503    11813    2         IF JPRIO = 0 THEN ALTRETURN;

  11813  1 002773   200046 235100                    LDA     JPRIO,,AUTO
         1 002774   002777 601000 1                  TNZ     s:11814

  11813  1 002775   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 002776   000000 702211                    TSX2  ! 0,X1

     1504    11814    2         JPRIO=JPRIO-1;

  11814  1 002777   000001 135007                    SBLA    1,DL
         1 003000   200046 755100                    STA     JPRIO,,AUTO

     1505    11815    2         IF JPRIO = JM_Q$FRE THEN GOTO S3;

  11815  1 003001   002773 600000 1                  TZE     S3

     1506    11816    2         GOTO S2;

  11816  1 003002   002767 710000 1                  TRA     S2

     1507    11817
     1508    11818
     1509    11819                                /* SUBROUTINE TO SEARCH MBS QUEUE 'JPRIO' */
     1510    11820    2   SRCHQ: PROC ALTRET;

  11820  1 003003   200112 741300       SRCHQ        STX1  ! SPECIFIC+1,,AUTO

     1511    11821
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:177  
     1512    11822    3         UJOB$ = MBSHDR$->JMC$CHAINS.HEAD$(JPRIO);

  11822  1 003004   200046 235100                    LDA     JPRIO,,AUTO
         1 003005   000001 735000                    ALS     1
         1 003006   200053 470500                    LDP0    MBSHDR$,,AUTO
         1 003007   000000 236105                    LDQ     0,AL,PR0
         1 003010   200042 756100                    STQ     UJOB$,,AUTO

     1513    11823
     1514    11824    3         IF BYSYSID=1 THEN

  11824  1 003011   200040 235100                    LDA     BYSYSID,,AUTO
         1 003012   000001 115007                    CMPA    1,DL
         1 003013   003043 601000 1                  TNZ     s:11839

     1515    11825    4           DO;

     1516    11826    5             DO WHILE (UJOB$ ~= ADDR(NIL));

  11826  1 003014   003037 710000 1                  TRA     s:11835

     1517    11827    5             MJOB$ = PINCRW(MBSJOB$,UJOB$R.DISP);

  11827  1 003015   200042 236100                    LDQ     UJOB$,,AUTO
         1 003016   777777 376003                    ANQ     -1,DU
         1 003017   200044 036100                    ADLQ    MBSJOB$,,AUTO
         1 003020   200050 756100                    STQ     MJOB$,,AUTO

     1518    11828    5             IF MJOB$->JM$IF.SYSID = SYSID THEN

  11828  1 003021   200050 470500                    LDP0    MJOB$,,AUTO
         1 003022   000014 236100                    LDQ     12,,PR0
         1 003023   777777 376007                    ANQ     -1,DL
         1 003024   200037 116100                    CMPQ    SYSID,,AUTO
         1 003025   003034 601000 1                  TNZ     s:11833

     1519    11829    6               DO;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:178  

     1520    11830    6               SUBMISSION_PRIO = MJOB$->JM$IF.PRIO;

  11830  1 003026   000013 236100                    LDQ     11,,PR0
         1 003027   000022 772000                    QRL     18
         1 003030   000777 376007                    ANQ     511,DL
         1 003031   200045 756100                    STQ     SUBMISSION_PRIO,,AUTO

     1521    11831    6               RETURN;

  11831  1 003032   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003033   000001 702211                    TSX2  ! 1,X1

     1522    11832    6               END;
     1523    11833    5             NAHEAD=NAHEAD+1;

  11833  1 003034   200054 054100                    AOS     NAHEAD,,AUTO

     1524    11834    5             UJOB$=MJOB$->JM$IF.LNK$;

  11834  1 003035   000000 236100                    LDQ     0,,PR0
         1 003036   200042 756100                    STQ     UJOB$,,AUTO

     1525    11835    5             END;

  11835  1 003037   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003040   003015 601000 1                  TNZ     s:11827

     1526    11836    4           ALTRETURN;

  11836  1 003041   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003042   000000 702211                    TSX2  ! 0,X1

     1527    11837    4           END;
     1528    11838
     1529    11839    4           DO WHILE (UJOB$ ~= ADDR(NIL));

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:179  
  11839  1 003043   003100 710000 1                  TRA     s:11850

     1530    11840    4           MJOB$=PINCRW(MBSJOB$,UJOB$R.DISP);

  11840  1 003044   200042 236100                    LDQ     UJOB$,,AUTO
         1 003045   777777 376003                    ANQ     -1,DU
         1 003046   200044 036100                    ADLQ    MBSJOB$,,AUTO
         1 003047   200050 756100                    STQ     MJOB$,,AUTO

     1531    11841    4           IF MJOB$->JM$IF.ACCT = ACCT

  11841  1 003050   200050 470500                    LDP0    MJOB$,,AUTO
         1 003051   040100 106500                    CMPC    fill='040'O
         1 003052   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         1 003053   200055 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         1 003054   003075 601000 1                  TNZ     s:11848
         1 003055   000056 236100                    LDQ     46,,PR0
         1 003056   000033 772000                    QRL     27
         1 003057   000000 620006                    EAX0    0,QL
         1 003060   040100 106540                    CMPC    fill='040'O
         1 003061   000056 200010                    ADSC9   46,,PR0                  cn=1,n=*X0
         1 003062   200025 000040                    ADSC9   JOBNAME,,AUTO            cn=0,n=32
         1 003063   003075 601000 1                  TNZ     s:11848

     1532    11842    4           AND MJOB$->JM$IF.JNAME = JOBNAME THEN
     1533    11843    5             DO;

     1534    11844    5             SYSID=MJOB$->JM$IF.SYSID;

  11844  1 003064   000014 236100                    LDQ     12,,PR0
         1 003065   777777 376007                    ANQ     -1,DL
         1 003066   200037 756100                    STQ     SYSID,,AUTO

     1535    11845    5             SUBMISSION_PRIO = MJOB$->JM$IF.PRIO;

  11845  1 003067   000013 236100                    LDQ     11,,PR0
         1 003070   000022 772000                    QRL     18
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:180  
         1 003071   000777 376007                    ANQ     511,DL
         1 003072   200045 756100                    STQ     SUBMISSION_PRIO,,AUTO

     1536    11846    5             RETURN;

  11846  1 003073   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003074   000001 702211                    TSX2  ! 1,X1

     1537    11847    5             END;
     1538    11848    4           NAHEAD=NAHEAD+1;

  11848  1 003075   200054 054100                    AOS     NAHEAD,,AUTO

     1539    11849    4           UJOB$=MJOB$->JM$IF.LNK$;

  11849  1 003076   000000 236100                    LDQ     0,,PR0
         1 003077   200042 756100                    STQ     UJOB$,,AUTO

     1540    11850    4           END;

  11850  1 003100   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003101   003044 601000 1                  TNZ     s:11840

     1541    11851    3         ALTRETURN;

  11851  1 003102   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003103   000000 702211                    TSX2  ! 0,X1

  11851  1 003104                       ALTRT        null
     1542    11852    3   END SRCHQ;
     1543    11853
     1544    11854
     1545    11855
     1546    11856    2   ALTRT:;
     1547    11857    2         ALTRETURN;

  11857  1 003104   200110 221300                    LDX1  ! @SEG#+1,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:181  
         1 003105   000000 702211                    TSX2  ! 0,X1

     1548    11858    2   END FINDJOB;
     1549    11859        /**************************************
     1550    11860         **************************************
     1551    11861                    FINDPRE
     1552    11862         **************************************
     1553    11863         **************************************/
     1554    11864        /*D* NAME:         FINDPRE
     1555    11865             PURPOSE:      To find a job, in the in-core status tables
     1556    11866             DESCRIPTION:  Like FINDJOB but looks for an PRESCAN job
     1557    11867                           frame.  */
     1558    11868
     1559    11869    1   FINDPRE: PROC ALTRET;

  11869  1 003106   200110 741300       FINDPRE      STX1  ! @SEG#+1,,AUTO

     1560    11870
     1561    11871    2         CALL GET_JP;

  11871  1 003107   003317 701000 1                  TSX1    GET_JP
         1 003110   000000 011000                    NOP     0

     1562    11872    2         IF BYSYSID = 0 THEN ALTRETURN;

  11872  1 003111   200040 235100                    LDA     BYSYSID,,AUTO
         1 003112   003115 601000 1                  TNZ     s:11873

  11872  1 003113   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003114   000000 702211                    TSX2  ! 0,X1

     1563    11873    2         CALL GET_PREHDR ALTRET(ALTRT);

  11873  1 003115   003354 701000 1                  TSX1    GET_PREHDR
         1 003116   003165 702000 1                  TSX2    ALTRT

     1564    11874    2         UJOB$=PREHDR$->JP$Q.HEAD$;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:182  

  11874  1 003117   200051 470500                    LDP0    PREHDR$,,AUTO
         1 003120   000002 236100                    LDQ     2,,PR0
         1 003121   200042 756100                    STQ     UJOB$,,AUTO

     1565    11875    3           DO WHILE (UJOB$ ~= ADDR(NIL));

  11875  1 003122   003140 710000 1                  TRA     s:11879

     1566    11876    3           MJOB$=PINCRW(PREJOB$,UJOB$R.DISP);

  11876  1 003123   200042 236100                    LDQ     UJOB$,,AUTO
         1 003124   777777 376003                    ANQ     -1,DU
         1 003125   200052 036100                    ADLQ    PREJOB$,,AUTO
         1 003126   200050 756100                    STQ     MJOB$,,AUTO

     1567    11877    3           IF SYSID = MJOB$->JP$JOB.SYSID THEN RETURN;

  11877  1 003127   200050 470500                    LDP0    MJOB$,,AUTO
         1 003130   000001 236100                    LDQ     1,,PR0
         1 003131   777777 376007                    ANQ     -1,DL
         1 003132   200037 116100                    CMPQ    SYSID,,AUTO
         1 003133   003136 601000 1                  TNZ     s:11878

  11877  1 003134   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003135   000001 702211                    TSX2  ! 1,X1

     1568    11878    3           UJOB$=MJOB$->JP$JOB.LNK$;

  11878  1 003136   000000 236100                    LDQ     0,,PR0
         1 003137   200042 756100                    STQ     UJOB$,,AUTO

     1569    11879    3           END;

  11879  1 003140   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003141   003123 601000 1                  TNZ     s:11876

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:183  
     1570    11880    2         UJOB$=PREHDR$->JP$Q.SCAN$;

  11880  1 003142   200051 470500                    LDP0    PREHDR$,,AUTO
         1 003143   000005 236100                    LDQ     5,,PR0
         1 003144   200042 756100                    STQ     UJOB$,,AUTO

     1571    11881    3           DO WHILE (UJOB$ ~= ADDR(NIL));

  11881  1 003145   003163 710000 1                  TRA     s:11885

     1572    11882    3           MJOB$=PINCRW(PREJOB$,UJOB$R.DISP);

  11882  1 003146   200042 236100                    LDQ     UJOB$,,AUTO
         1 003147   777777 376003                    ANQ     -1,DU
         1 003150   200052 036100                    ADLQ    PREJOB$,,AUTO
         1 003151   200050 756100                    STQ     MJOB$,,AUTO

     1573    11883    3           IF SYSID = MJOB$->JP$JOB.SYSID THEN RETURN;

  11883  1 003152   200050 470500                    LDP0    MJOB$,,AUTO
         1 003153   000001 236100                    LDQ     1,,PR0
         1 003154   777777 376007                    ANQ     -1,DL
         1 003155   200037 116100                    CMPQ    SYSID,,AUTO
         1 003156   003161 601000 1                  TNZ     s:11884

  11883  1 003157   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003160   000001 702211                    TSX2  ! 1,X1

     1574    11884    3           UJOB$=MJOB$->JP$JOB.LNK$;

  11884  1 003161   000000 236100                    LDQ     0,,PR0
         1 003162   200042 756100                    STQ     UJOB$,,AUTO

     1575    11885    3           END;

  11885  1 003163   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003164   003146 601000 1                  TNZ     s:11882
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:184  

  11882  1 003165                       ALTRT        null
     1576    11886    2   ALTRT:;
     1577    11887    2         ALTRETURN;

  11887  1 003165   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003166   000000 702211                    TSX2  ! 0,X1

     1578    11888    2   END FINDPRE;
     1579    11889        /**************************************
     1580    11890         **************************************
     1581    11891                    FINDOUTP
     1582    11892         **************************************
     1583    11893         **************************************/
     1584    11894        /*D* NAME:         FINDOUTP
     1585    11895             PURPOSE:      To find output for a job, in the in-core status tables
     1586    11896             DESCRIPTION:  Like FINDJOB but looks for an appropriate
     1587    11897                           output file.
     1588    11898                           If successful returns
     1589    11899                            MJOB$             OUTSYM job frame
     1590    11900                            MFIL$             OUTSYM file frame for highest-
     1591    11901                                              prio file
     1592    11902                            SYSID             sysid if jobname check
     1593    11903                            NAHEAD            number of files ahead of MFIL$
     1594    11904        */
     1595    11905    1   FINDOUTP: PROC ALTRET;

  11905  1 003167   200110 741300       FINDOUTP     STX1  ! @SEG#+1,,AUTO

     1596    11906        /**/
     1597    11907    2   DCL SPECIFIC UBIN;
     1598    11908        /**/
     1599    11909    2         SPECIFIC=0;

  11909  1 003170   200111 450100                    STZ     SPECIFIC,,AUTO

     1600    11910    2         GOTO FIND;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:185  

  11910  1 003171   003175 710000 1                  TRA     FIND

     1601    11911        /**/
     1602    11912        /*D* NAME:         FINDOUTPF
     1603    11913             PURPOSE:      To find a particular output file
     1604    11914             DESCRIPTION:  Like FINDOUTP but looks for the specific file
     1605    11915                           FPT$JOBSTATS_V.NUM.
     1606    11916        */
     1607    11917    2   FINDOUTPF: ENTRY ALTRET;

  11917  1 003172   200110 741300       FINDOUTPF    STX1  ! @SEG#+1,,AUTO

     1608    11918        /**/
     1609    11919    2         SPECIFIC=1;

  11919  1 003173   000001 235007                    LDA     1,DL
         1 003174   200111 755100                    STA     SPECIFIC,,AUTO

  11919  1 003175                       FIND         null
     1610    11920    2   FIND: ;
     1611    11921    2         CALL GET_JP;

  11921  1 003175   003317 701000 1                  TSX1    GET_JP
         1 003176   000000 011000                    NOP     0

     1612    11922    2         CALL GET_SYMHDR ALTRET(ALTRT);

  11922  1 003177   003416 701000 1                  TSX1    GET_SYMHDR
         1 003200   003220 702000 1                  TSX2    ALTRT

     1613    11923    2         NAHEAD=-1;

  11923  1 003201   000001 335007                    LCA     1,DL
         1 003202   200054 755100                    STA     NAHEAD,,AUTO

     1614    11924    2         OPRIO=FOPR_MAX#;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:186  

  11924  1 003203   000022 236007                    LDQ     18,DL
         1 003204   200014 756100                    STQ     OPRIO,,AUTO

     1615    11925    2   S2:   CALL SRCHQ ALTRET(S3);

  11925  1 003205   003222 701000 1     S2           TSX1    SRCHQ
         1 003206   003211 702000 1                  TSX2    S3

     1616    11926    2         RETURN;

  11926  1 003207   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003210   000001 702211                    TSX2  ! 1,X1

     1617    11927    2   S3:   IF OPRIO = 0 THEN ALTRETURN;

  11927  1 003211   200014 235100       S3           LDA     OPRIO,,AUTO
         1 003212   003215 601000 1                  TNZ     s:11928

  11927  1 003213   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003214   000000 702211                    TSX2  ! 0,X1

     1618    11928    2         OPRIO=OPRIO-1;

  11928  1 003215   000001 336007                    LCQ     1,DL
         1 003216   200014 056100                    ASQ     OPRIO,,AUTO

     1619    11929    2         GOTO S2;

  11929  1 003217   003205 710000 1                  TRA     S2

  11928  1 003220                       ALTRT        null
     1620    11930    2   ALTRT:;
     1621    11931    2         ALTRETURN;

  11931  1 003220   200110 221300                    LDX1  ! @SEG#+1,,AUTO
         1 003221   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:187  

     1622    11932                                /* Search OUTSYM queue OPRIO */
     1623    11933    2   SRCHQ: PROC ALTRET;

  11933  1 003222   200112 741300       SRCHQ        STX1  ! SPECIFIC+1,,AUTO

     1624    11934    3         UFIL$=SYMHDR$->FO$Q.FILHD$(OPRIO);

  11934  1 003223   200041 470500                    LDP0    SYMHDR$,,AUTO
         1 003224   200014 720100                    LXL0    OPRIO,,AUTO
         1 003225   000004 236110                    LDQ     4,X0,PR0
         1 003226   200020 756100                    STQ     UFIL$,,AUTO

     1625    11935    4           DO WHILE (UFIL$ ~= ADDR(NIL));

  11935  1 003227   003313 710000 1                  TRA     s:11956

     1626    11936    4           MFIL$=PINCRW(SYMFIL$,UFIL$R.DISP);

  11936  1 003230   200020 236100                    LDQ     UFIL$,,AUTO
         1 003231   777777 376003                    ANQ     -1,DU
         1 003232   200021 036100                    ADLQ    SYMFIL$,,AUTO
         1 003233   200022 756100                    STQ     MFIL$,,AUTO

     1627    11937    4           UJOB$=MFIL$->FO$FIL.OJOB$;

  11937  1 003234   200022 470500                    LDP0    MFIL$,,AUTO
         1 003235   000003 236100                    LDQ     3,,PR0
         1 003236   200042 756100                    STQ     UJOB$,,AUTO

     1628    11938    4           MJOB$=PINCRW(SYMJOB$,UJOB$R.DISP);

  11938  1 003237   200042 236100                    LDQ     UJOB$,,AUTO
         1 003240   777777 376003                    ANQ     -1,DU
         1 003241   200043 036100                    ADLQ    SYMJOB$,,AUTO
         1 003242   200050 756100                    STQ     MJOB$,,AUTO

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:188  
     1629    11939    4           IF BYSYSID = 1 THEN

  11939  1 003243   200040 235100                    LDA     BYSYSID,,AUTO
         1 003244   000001 115007                    CMPA    1,DL
         1 003245   003274 601000 1                  TNZ     s:11952

     1630    11940    5             DO;

     1631    11941    5             IF MFIL$->FO$FIL.SYSID = SYSID THEN

  11941  1 003246   000012 236100                    LDQ     10,,PR0
         1 003247   000022 772000                    QRL     18
         1 003250   200037 116100                    CMPQ    SYSID,,AUTO
         1 003251   003311 601000 1                  TNZ     s:11955

     1632    11942    6   GOTJOB:     DO;

  11942  1 003252                       GOTJOB       null
     1633    11943    6               IF NAHEAD < 0 THEN

  11943  1 003252   200054 235100                    LDA     NAHEAD,,AUTO
         1 003253   003260 605000 1                  TPL     s:11945

     1634    11944    6                NAHEAD=MFIL$->FO$FIL.AHEAD;

  11944  1 003254   200022 470500                    LDP0    MFIL$,,AUTO
         1 003255   000022 236100                    LDQ     18,,PR0
         1 003256   000022 772000                    QRL     18
         1 003257   200054 756100                    STQ     NAHEAD,,AUTO

     1635    11945    6               SYSID=MFIL$->FO$FIL.SYSID;

  11945  1 003260   200022 470500                    LDP0    MFIL$,,AUTO
         1 003261   000012 236100                    LDQ     10,,PR0
         1 003262   000022 772000                    QRL     18
         1 003263   200037 756100                    STQ     SYSID,,AUTO

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:189  
     1636    11946    6               IF SPECIFIC = 0

  11946  1 003264   200111 235100                    LDA     SPECIFIC,,AUTO
         1 003265   003272 600000 1                  TZE     s:11948
         1 003266   000012 720100                    LXL0    10,,PR0
         1 003267   000000 471400 xsym               LDP1    B$PS0$
         1 003270   100004 100100                    CMPX0   4,,PR1
         1 003271   003311 601000 1                  TNZ     s:11955

     1637    11947    6               OR MFIL$->FO$FIL.NUM = FPT$JOBSTATS_V.NUM THEN
     1638    11948    6                RETURN;

  11948  1 003272   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003273   000001 702211                    TSX2  ! 1,X1

     1639    11949    6               END;
     1640    11950    5             END;
     1641    11951    4           ELSE
     1642    11952    4            IF MJOB$->FO$JOB.ACCT = ACCT

  11952  1 003274   200050 471500                    LDP1    MJOB$,,AUTO
         1 003275   040100 106500                    CMPC    fill='040'O
         1 003276   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         1 003277   200055 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         1 003300   003311 601000 1                  TNZ     s:11955
         1 003301   100011 236100                    LDQ     9,,PR1
         1 003302   000011 772000                    QRL     9
         1 003303   000777 376007                    ANQ     511,DL
         1 003304   000000 620006                    EAX0    0,QL
         1 003305   040100 106540                    CMPC    fill='040'O
         1 003306   100011 600010                    ADSC9   9,,PR1                   cn=3,n=*X0
         1 003307   200025 000040                    ADSC9   JOBNAME,,AUTO            cn=0,n=32
         1 003310   003252 600000 1                  TZE     GOTJOB

     1643    11953    4            AND MJOB$->FO$JOB.JOBNAME = JOBNAME THEN
     1644    11954    4             GOTO GOTJOB;
     1645    11955    4           UFIL$=MFIL$->FO$FIL.LNK$;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:190  

  11955  1 003311   000000 236100                    LDQ     0,,PR0
         1 003312   200020 756100                    STQ     UFIL$,,AUTO

     1646    11956    4           END;

  11956  1 003313   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003314   003230 601000 1                  TNZ     s:11936

     1647    11957    3         ALTRETURN;

  11957  1 003315   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003316   000000 702211                    TSX2  ! 0,X1

     1648    11958    3   END SRCHQ;
     1649    11959    2   END FINDOUTP;
     1650    11960        /**************************************
     1651    11961         **************************************
     1652    11962                    GET_JP
     1653    11963         **************************************
     1654    11964         **************************************/
     1655    11965        /*D* NAME:         GET_JP
     1656    11966             PURPOSE:      To extract params from the FPT
     1657    11967             DESCRIPTION:  This routine returns with the following set up:
     1658    11968
     1659    11969                           1) ACCT is the desired account (either from
     1660    11970                              the FPT or the current JIT if the FPT did not
     1661    11971                              specify ACCT.
     1662    11972
     1663    11973                           2) BYSYSID=1 and SYSID= desired SYSID
     1664    11974
     1665    11975                           or
     1666    11976
     1667    11977                           3) BYSYSID=0 and JOBNAME= desired job name */
     1668    11978
     1669    11979    1   GET_JP: PROC;

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:191  
  11979  1 003317   200112 741300       GET_JP       STX1  ! SPECIFIC+1,,AUTO

     1670    11980
     1671    11981                                /* SET CORRECT ACCT */
     1672    11982    2         ACCT=B$JIT.ACCN;

  11982  1 003320   000000 470400 xsym               LDP0    B$JIT$
         1 003321   040100 100500                    MLR     fill='040'O
         1 003322   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 003323   200055 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

     1673    11983    2         CALL HFF$NILERASE (5) ALTRET(NOACCN);

  11983  1 003324   000024 630400 2                  EPPR0   20
         1 003325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003326   000000 701000 xent               TSX1    HFF$NILERASE
         1 003327   003334 702000 1                  TSX2    NOACCN

     1674    11984    2         ACCT=VLP$ACCT.ACCT;

  11984  1 003330   000000 470400 xsym               LDP0    B$PS5$
         1 003331   040100 100500                    MLR     fill='040'O
         1 003332   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 003333   200055 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

  11984  1 003334                       NOACCN       null
     1675    11985    2   NOACCN:;
     1676    11986    2         BYSYSID=1;

  11986  1 003334   000001 235007                    LDA     1,DL
         1 003335   200040 755100                    STA     BYSYSID,,AUTO

     1677    11987    2         SYSID=FPT$JOBSTATS_V.SYSID;

  11987  1 003336   000000 470400 xsym               LDP0    B$PS0$
         1 003337   000001 235100                    LDA     1,,PR0
         1 003340   200037 755100                    STA     SYSID,,AUTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:192  

     1678    11988    2         CALL HFF$NILERASE (4) ALTRET(NONAME);

  11988  1 003341   000025 630400 2                  EPPR0   21
         1 003342   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003343   000000 701000 xent               TSX1    HFF$NILERASE
         1 003344   003352 702000 1                  TSX2    NONAME

     1679    11989    2         BYSYSID=0;

  11989  1 003345   200040 450100                    STZ     BYSYSID,,AUTO

     1680    11990    2         JOBNAME=VLP$JOBNAME.JOBNAME;

  11990  1 003346   000000 470400 xsym               LDP0    B$PS4$
         1 003347   040100 100500                    MLR     fill='040'O
         1 003350   000000 200037                    ADSC9   0,,PR0                   cn=1,n=31
         1 003351   200025 000040                    ADSC9   JOBNAME,,AUTO            cn=0,n=32

  11990  1 003352                       NONAME       null
     1681    11991    2   NONAME:;
     1682    11992    2         RETURN;

  11992  1 003352   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003353   000001 702211                    TSX2  ! 1,X1

     1683    11993    2   END GET_JP;
     1684    11994        /**************************************
     1685    11995         **************************************
     1686    11996                    GET_PREHDR
     1687    11997         **************************************
     1688    11998         **************************************/
     1689    11999        /*D* NAME:         GET_PREHDR
     1690    12000             PURPOSE:      To get the pointer to the PRESCAN queues header.
     1691    12001             DESCRIPTION:  The routine PMMEXITs if PRESCAN is still doing
     1692    12002                           its initialization.  Otherwise, it returns when
     1693    12003                           PRESCAN's queues lock is clear, and altreturns if
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:193  
     1694    12004                           the user has hit break while waiting for the lock
     1695    12005                           to clear (in which case PRESCAN may be stuck.)  */
     1696    12006    1   GET_PREHDR: PROC ALTRET;

  12006  1 003354   200112 741300       GET_PREHDR   STX1  ! SPECIFIC+1,,AUTO

  12006  1 003355                       AGAIN        null
     1697    12007
     1698    12008    2   AGAIN:;
     1699    12009    2         PREHDR$=FOS_SEG$(FOSS_PREHDR#);

  12009  1 003355   000002 236000 xsym               LDQ     FOS_SEG$+2
         1 003356   200051 756100                    STQ     PREHDR$,,AUTO

     1700    12010    2         IF PREHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;

  12010  1 003357   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003360   003364 600000 1                  TZE     STILL_RECOVERING

     1701    12011    2         IF PREHDR$->JP$Q.RCVR ~= 0 THEN

  12011  1 003361   200051 470500                    LDP0    PREHDR$,,AUTO
         1 003362   000001 235100                    LDA     1,,PR0
         1 003363   003372 600000 1                  TZE     s:12023

     1702    12012    2   STILL_RECOVERING:
     1703    12013    3           DO;

  12013  1 003364                       STILL_RECOV* null
     1704    12014    3           B$JIT.ERR=E_SQRCVR;

  12014  1 003364   000020 236000 0                  LDQ     E_SQRCVR
         1 003365   000000 470400 xsym               LDP0    B$JIT$
         1 003366   000012 756100                    STQ     10,,PR0

     1705    12015        /*E* ERROR:   FOS-E$SQRCVR-E
     1706    12016             MESSAGE:      Symbiont queue recovery in progress.
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:194  
     1707    12017             MESSAGE1:     Your job status service request cannot be processed
     1708    12018                           because the job status information is being recovered.
     1709    12019             DESCRIPTION:  One of the ghosts who supply the jobstats information
     1710    12020                           is still performing his post-boot recovery. */
     1711    12021    3           CALL UDB$PMMEXIT;

  12021  1 003367   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003370   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 003371   000000 011000                    NOP     0

     1712    12022    3           END STILL_RECOVERING;

     1713    12023    2         IF PREHDR$->JP$Q.LOCK ~= 0 THEN

  12023  1 003372   200051 470500                    LDP0    PREHDR$,,AUTO
         1 003373   000000 235100                    LDA     0,,PR0
         1 003374   003412 600000 1                  TZE     s:12032

     1714    12024    3           DO;

     1715    12025    3           CALL SSR$REG (%SS_SL,,1)

  12025  1 003375   000000 236000 2                  LDQ     0
         1 003376   200116 756100                    STQ     SPECIFIC+5,,AUTO
         1 003377   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003400   000027 235000 2                  LDA     23
         1 003401   200114 757100                    STAQ    SPECIFIC+3,,AUTO
         1 003402   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 003403   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003404   000000 701000 xent               TSX1    SSR$REG
         1 003405   003407 702000 1                  TSX2    s:12028
         1 003406   003411 710000 1                  TRA     s:12030

     1716    12026    3           WHENALTRETURN
     1717    12027    4             DO;

     1718    12028    4             ALTRETURN;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:195  

  12028  1 003407   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003410   000000 702211                    TSX2  ! 0,X1

     1719    12029    4             END;
     1720    12030    3           GOTO AGAIN;

  12030  1 003411   003355 710000 1                  TRA     AGAIN

     1721    12031    3           END;
     1722    12032    2         PREJOB$=FOS_SEG$(FOSS_PREJOB#);

  12032  1 003412   000010 236000 xsym               LDQ     FOS_SEG$+8
         1 003413   200052 756100                    STQ     PREJOB$,,AUTO

     1723    12033    2         RETURN;

  12033  1 003414   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003415   000001 702211                    TSX2  ! 1,X1

     1724    12034        /**************************************
     1725    12035         **************************************
     1726    12036                    GET_SYMHDR
     1727    12037         **************************************
     1728    12038         **************************************/
     1729    12039        /*D* NAME:         GET_SYMHDR
     1730    12040             PURPOSE:      To get the pointer to the OUTSYM queues header.
     1731    12041             DESCRIPTION:  The routine PMMEXITs if OUTSYM is still doing
     1732    12042                           its initialization.  Otherwise, it returns when
     1733    12043                           OUTSYM's queues lock is clear, and altreturns if
     1734    12044                           the user has hit break while waiting for the lock
     1735    12045                           to clear (in which case OUTSYM may be stuck.)  */
     1736    12046    2   GET_SYMHDR: ENTRY ALTRET;

  12046  1 003416   200112 741300       GET_SYMHDR   STX1  ! SPECIFIC+1,,AUTO

  12032  1 003417                       SAGAIN       null
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:196  
     1737    12047
     1738    12048    2   SAGAIN:;
     1739    12049    2         SYMHDR$=FOS_SEG$(FOSS_SYMHDR#);

  12049  1 003417   000003 236000 xsym               LDQ     FOS_SEG$+3
         1 003420   200041 756100                    STQ     SYMHDR$,,AUTO

     1740    12050    2         IF SYMHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;

  12050  1 003421   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003422   003364 600000 1                  TZE     STILL_RECOVERING

     1741    12051    2         IF SYMHDR$->FO$Q.RCVR ~= 0 THEN GOTO STILL_RECOVERING;

  12051  1 003423   200041 470500                    LDP0    SYMHDR$,,AUTO
         1 003424   000001 235100                    LDA     1,,PR0
         1 003425   003364 601000 1                  TNZ     STILL_RECOVERING

     1742    12052    2         IF SYMHDR$->FO$Q.LOCK ~= 0 THEN

  12052  1 003426   000000 235100                    LDA     0,,PR0
         1 003427   003445 600000 1                  TZE     s:12061

     1743    12053    3           DO;

     1744    12054    3           CALL SSR$REG (%SS_SL,,1)

  12054  1 003430   000000 236000 2                  LDQ     0
         1 003431   200116 756100                    STQ     SPECIFIC+5,,AUTO
         1 003432   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003433   000027 235000 2                  LDA     23
         1 003434   200114 757100                    STAQ    SPECIFIC+3,,AUTO
         1 003435   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 003436   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003437   000000 701000 xent               TSX1    SSR$REG
         1 003440   003442 702000 1                  TSX2    s:12057
         1 003441   003444 710000 1                  TRA     s:12059
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:197  

     1745    12055    3           WHENALTRETURN
     1746    12056    4             DO;

     1747    12057    4             ALTRETURN;

  12057  1 003442   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003443   000000 702211                    TSX2  ! 0,X1

     1748    12058    4             END;
     1749    12059    3           GOTO SAGAIN;

  12059  1 003444   003417 710000 1                  TRA     SAGAIN

     1750    12060    3           END;
     1751    12061    2         SYMJOB$=FOS_SEG$(FOSS_SYMJOB#);

  12061  1 003445   000005 236000 xsym               LDQ     FOS_SEG$+5
         1 003446   200043 756100                    STQ     SYMJOB$,,AUTO

     1752    12062    2         SYMFIL$=FOS_SEG$(FOSS_SYMFIL#);

  12062  1 003447   000004 236000 xsym               LDQ     FOS_SEG$+4
         1 003450   200021 756100                    STQ     SYMFIL$,,AUTO

     1753    12063    2         SYMDEV$=FOS_SEG$(FOSS_SYMDEV#);

  12063  1 003451   000007 236000 xsym               LDQ     FOS_SEG$+7
         1 003452   200100 756100                    STQ     SYMDEV$,,AUTO

     1754    12064    2         RETURN;

  12064  1 003453   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003454   000001 702211                    TSX2  ! 1,X1

     1755    12065        /**************************************
     1756    12066         **************************************
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:198  
     1757    12067                    GET_MBSHDR
     1758    12068         **************************************
     1759    12069         **************************************/
     1760    12070        /*D* NAME:         GET_MBSHDR
     1761    12071             PURPOSE:      To get the pointer to the MBS queues header.
     1762    12072             DESCRIPTION:  The routine PMMEXITs if MBS is still doing
     1763    12073                           its initialization.  Otherwise, it returns when
     1764    12074                           MBS's queues lock is clear, and altreturns if
     1765    12075                           the user has hit break while waiting for the lock
     1766    12076                           to clear (in which case MBS may be stuck.)  */
     1767    12077    2   GET_MBSHDR: ENTRY ALTRET;

  12077  1 003455   200112 741300       GET_MBSHDR   STX1  ! SPECIFIC+1,,AUTO

  12063  1 003456                       MAGAIN       null
     1768    12078
     1769    12079    2   MAGAIN:;
     1770    12080    2         MBSHDR$=FOS_SEG$(FOSS_MBSHDR#);

  12080  1 003456   000006 236000 xsym               LDQ     FOS_SEG$+6
         1 003457   200053 756100                    STQ     MBSHDR$,,AUTO

     1771    12081    2         IF MBSHDR$ = ADDR(NIL) THEN GOTO STILL_RECOVERING;

  12081  1 003460   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003461   003364 600000 1                  TZE     STILL_RECOVERING

     1772    12082    2         IF MBSHDR$->JMC$CH.RCVR ~= 0 THEN GOTO STILL_RECOVERING;

  12082  1 003462   200053 470500                    LDP0    MBSHDR$,,AUTO
         1 003463   000057 235100                    LDA     47,,PR0
         1 003464   003364 601000 1                  TNZ     STILL_RECOVERING

     1773    12083    2         IF MBSHDR$->JMC$CH.LOCK ~= 0 THEN

  12083  1 003465   000056 235100                    LDA     46,,PR0
         1 003466   003504 600000 1                  TZE     s:12092
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:199  

     1774    12084    3           DO;

     1775    12085    3           CALL SSR$REG (%SS_SL,,1)

  12085  1 003467   000000 236000 2                  LDQ     0
         1 003470   200116 756100                    STQ     SPECIFIC+5,,AUTO
         1 003471   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003472   000027 235000 2                  LDA     23
         1 003473   200114 757100                    STAQ    SPECIFIC+3,,AUTO
         1 003474   200114 630500                    EPPR0   SPECIFIC+3,,AUTO
         1 003475   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003476   000000 701000 xent               TSX1    SSR$REG
         1 003477   003501 702000 1                  TSX2    s:12088
         1 003500   003503 710000 1                  TRA     s:12090

     1776    12086    3           WHENALTRETURN
     1777    12087    4             DO;

     1778    12088    4             ALTRETURN;

  12088  1 003501   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003502   000000 702211                    TSX2  ! 0,X1

     1779    12089    4             END;
     1780    12090    3           GOTO MAGAIN;

  12090  1 003503   003456 710000 1                  TRA     MAGAIN

     1781    12091    3           END;
     1782    12092    2         MBSJOB$=FOS_SEG$(FOSS_MBSJOB#);

  12092  1 003504   000000 236000 xsym               LDQ     FOS_SEG$
         1 003505   200044 756100                    STQ     MBSJOB$,,AUTO

     1783    12093    2         MBSRES$=FOS_SEG$(FOSS_MBSRES#);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:200  
  12093  1 003506   000001 236000 xsym               LDQ     FOS_SEG$+1
         1 003507   200060 756100                    STQ     MBSRES$,,AUTO

     1784    12094    2         RETURN;

  12094  1 003510   200112 221300                    LDX1  ! SPECIFIC+1,,AUTO
         1 003511   000001 702211                    TSX2  ! 1,X1

     1785    12095    2   END GET_PREHDR;
     1786    12096        %EJECT;
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:201  
     1787    12097        /*F* NAME:         FOS$RUND
     1788    12098             PURPOSE:      To remove M$JOBSTATS data provided by a ghost being
     1789    12099                           run down.
     1790    12100             DESCRIPTION:  When one of the system ghosts which provides some
     1791    12101                           of the M$JOBSTATS PMME information thru the FOS
     1792    12102                           wsq gets run down, the pointers to that data must
     1793    12103                           be cleared, since the data lies in the ghost's own
     1794    12104                           pages which are about to be released.  This routine
     1795    12105                           is called whenever one of these ghosts is being run
     1796    12106                           down, and clears the appropriate pointers. */
     1797    12107
     1798    12108
     1799    12109    1   FOS$RUND: ENTRY;

  12109  1 003512   000000 700200 xent  FOS$RUND     TSX0  ! X66_AUTO_0
         1 003513   000120 000000                    ZERO    80,0

     1800    12110        /**/
     1801    12111
     1802    12112    1         IF S_CUN = JG_OUTSYM# THEN

  12112  1 003514   000000 235000 xsym               LDA     S_CUN
         1 003515   000003 115007                    CMPA    3,DL
         1 003516   003537 601000 1                  TNZ     s:12119

     1803    12113    2           DO;

     1804    12114    2           CALL RELSEG (FOSS_SYMHDR#);

  12114  1 003517   000014 236000 2                  LDQ     12
         1 003520   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003521   002164 701000 1                  TSX1    RELSEG
         1 003522   000000 011000                    NOP     0

     1805    12115    2           CALL RELSEG (FOSS_SYMFIL#);

  12115  1 003523   000025 236000 2                  LDQ     21
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:202  
         1 003524   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003525   002164 701000 1                  TSX1    RELSEG
         1 003526   000000 011000                    NOP     0

     1806    12116    2           CALL RELSEG (FOSS_SYMDEV#);

  12116  1 003527   000022 236000 2                  LDQ     18
         1 003530   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003531   002164 701000 1                  TSX1    RELSEG
         1 003532   000000 011000                    NOP     0

     1807    12117    2           CALL RELSEG (FOSS_SYMJOB#);

  12117  1 003533   000024 236000 2                  LDQ     20
         1 003534   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003535   002164 701000 1                  TSX1    RELSEG
         1 003536   000000 011000                    NOP     0

     1808    12118    2           END;

     1809    12119    1         IF S_CUN = JG_PRESCAN# THEN

  12119  1 003537   000000 235000 xsym               LDA     S_CUN
         1 003540   000004 115007                    CMPA    4,DL
         1 003541   003552 601000 1                  TNZ     s:12124

     1810    12120    2           DO;

     1811    12121    2           CALL RELSEG (FOSS_PREHDR#);

  12121  1 003542   000013 236000 2                  LDQ     11
         1 003543   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003544   002164 701000 1                  TSX1    RELSEG
         1 003545   000000 011000                    NOP     0

     1812    12122    2           CALL RELSEG (FOSS_PREJOB#);

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:203  
  12122  1 003546   000030 236000 2                  LDQ     24
         1 003547   200107 756100                    STQ     UDEV$+3,,AUTO
         1 003550   002164 701000 1                  TSX1    RELSEG
         1 003551   000000 011000                    NOP     0

     1813    12123    2           END;

     1814    12124    1         RETURN;

  12124  1 003552   000000 702200 xent               TSX2  ! X66_ARET

E_BADFC
 Sect OctLoc
   0     000   061723 021234                                                    1...

E_NAUTHFC
 Sect OctLoc
   0     001   061723 021254                                                    1...

E_NVMEM
 Sect OctLoc
   0     002   061723 021204                                                    1...

E_NOTFND
 Sect OctLoc
   0     003   061723 021264                                                    1...

E_NOTYJ
 Sect OctLoc
   0     004   061723 021274                                                    1...

E_JOBAOFF
 Sect OctLoc
   0     005   061723 021314                                                    1...

E_JSIRAS
 Sect OctLoc
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:204  
   0     006   061723 021324                                                    1...

E_JSIRLS
 Sect OctLoc
   0     007   061723 021334                                                    1...

E_JSISLS
 Sect OctLoc
   0     010   061723 021344                                                    1...

E_JSNORESULTS
 Sect OctLoc
   0     011   061723 006464                                                    1...

E_JSNOCRITERIA
 Sect OctLoc
   0     012   061723 006474                                                    1...

E_JSIRPS
 Sect OctLoc
   0     013   061723 021424                                                    1...

E_JSICPS
 Sect OctLoc
   0     014   061723 021434                                                    1...

E_NSPILL
 Sect OctLoc
   0     015   061723 021354                                                    1...

E_FNOTFND
 Sect OctLoc
   0     016   061723 021364                                                    1...

E_NSPILLED
 Sect OctLoc
   0     017   061723 021374                                                    1...
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:205  

E_SQRCVR
 Sect OctLoc
   0     020   061723 021404                                                    1...

RCHECK_INIT
 Sect OctLoc
   0     022   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     026   000000 000000   000000 000000   000000 000000   040040 040040    ............
   0     032   000000 000000   040040 040040   040040 040040                    ....

(unnamed)
 Sect OctLoc
   0     035   ****** ******   123124 104040   040040 040040   114120 040040    ....STD     LP

(unnamed)
 Sect OctLoc
   2     000   000003 006000   000000 000000   000000 006000   000000 006000    ................
   2     004   000000 006000   000014 006000   000000 006000   000000 000024    ................
   2     010   000000 006000   000007 006000   000000 006000   000004 006000    ................
   2     014   000005 006000   000000 000000   040040 040040   040040 040040    ........
   2     020   077040 040040   777777 777000   000011 006000   000010 006000    ?   ............
   2     024   000007 006000   000006 006000   000000 000031   000026 006000    ................
   2     030   000012 006000                                                    ....
     1815    12125        /**/
     1816    12126        /**/
     1817    12127    1   END FOS$PMME;
     1818    12128        /**/

PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:206  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   JMC$DATA.:E05TOU  cannot be made into a system file and is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   FOS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FOS$PMME.
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:207  

 **** Variables and constants ****

  ****  Section 000 RoData FOS$PMME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 E_BADFC                   16-0-0/w STRC        r     1 E_FNOTFND
     5-0-0/w STRC        r     1 E_JOBAOFF                 14-0-0/w STRC        r     1 E_JSICPS
     6-0-0/w STRC        r     1 E_JSIRAS                   7-0-0/w STRC        r     1 E_JSIRLS
    13-0-0/w STRC        r     1 E_JSIRPS                  10-0-0/w STRC        r     1 E_JSISLS
    12-0-0/w STRC        r     1 E_JSNOCRITERIA            11-0-0/w STRC        r     1 E_JSNORESULTS
     1-0-0/w STRC        r     1 E_NAUTHFC                  3-0-0/w STRC        r     1 E_NOTFND
     4-0-0/w STRC        r     1 E_NOTYJ                   15-0-0/w STRC        r     1 E_NSPILL
    17-0-0/w STRC        r     1 E_NSPILLED                 2-0-0/w STRC        r     1 E_NVMEM
    20-0-0/w STRC        r     1 E_SQRCVR                  22-0-0/d STRC(396)   r     1 RCHECK_INIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   107-0-0/w PTR         r     1 @SEG#                     55-0-0/c CHAR(8)     r     1 ACCT
    40-0-0/w UBIN        r     1 BYSYSID                   66-0-0/w UBIN        r     1 CSIZ
   101-0-0/c CHAR(4)     r     1 DEVNM                    102-0-0/c CHAR(4)     r     1 DEVNM1
    23-0-0/w UBIN        r     1 DSIZ                      17-0-0/w UBIN        r     1 FILX
    47-0-0/w UBIN        r     1 FPRIO                     15-0-0/w SBIN        r     1 HIPRIO
    57-0-0/w SBIN        r     1 IPRIO                     25-0-0/c CHAR(32)    r     1 JOBNAME
    46-0-0/w UBIN        r     1 JPRIO                     16-0-0/w SBIN        r     1 LOPRIO
    53-0-0/w PTR         r     1 MBSHDR$                   44-0-0/w PTR         r     1 MBSJOB$
    60-0-0/w PTR         r     1 MBSRES$                   60-0-0/w PTR         r     1 MBSSN$
   103-0-0/w PTR         r     1 MDEV$                     22-0-0/w PTR         r     1 MFIL$
    50-0-0/w PTR         r     1 MJOB$                     73-0-0/w PTR         r     1 MRES$
    74-0-0/w PTR         r     1 MSN$                      54-0-0/w SBIN        r     1 NAHEAD
    14-0-0/w SBIN        r     1 OPRIO                     76-0-0/w UBIN        r     1 ORDER
    51-0-0/w PTR         r     1 PREHDR$                   52-0-0/w PTR         r     1 PREJOB$
    67-0-0/w UBIN        r     1 RESX                      61-0-0/w PTR         r     1 RFIL$
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:208  
    62-0-0/w PTR         r     1 RJOB$                     63-0-0/w UBIN        r     1 RSIZ
    64-0-0/w UBIN        r     1 RSIZ_RES                  65-0-0/w UBIN        r     1 RSIZ_SN
    *0-0-0/w UBIN        r     1 SEG#                       7-0-0/w SBIN        r     1 SEL_ACCT
    13-0-0/w UBIN        r     1 SEL_DEVTYP                11-0-0/w SBIN        r     1 SEL_FORM
     4-0-0/w UBIN        r     1 SEL_NSFORM                12-0-0/w UBIN        r     1 SEL_SYSID
     6-0-0/w SBIN        r     1 SEL_TNAME                 10-0-0/w UBIN        r     1 SEL_WSNL
    70-0-0/w UBIN        r     1 SNX                      111-0-0/w UBIN        r     1 SPECIFIC
    24-0-0/w UBIN        r     1 STATSEG                   45-0-0/w UBIN        r     1 SUBMISSION_PRIO
   100-0-0/w PTR         r     1 SYMDEV$                   21-0-0/w PTR         r     1 SYMFIL$
    41-0-0/w PTR         r     1 SYMHDR$                   43-0-0/w PTR         r     1 SYMJOB$
    37-0-0/w UBIN        r     1 SYSID                     35-0-0/c CHAR(8)     r     1 TNAME
    77-0-0/w UBIN        r     1 UCODE                    104-0-0/w PTR         r     1 UDEV$
   104-0-0/w STRC        r     1 UDEV$R                    20-0-0/w PTR         r     1 UFIL$
    20-0-0/w STRC        r     1 UFIL$R                    42-0-0/w PTR         r     1 UJOB$
    42-0-0/w STRC        r     1 UJOB$R                    75-0-0/w UBIN        r     1 UPRIO
    71-0-0/w PTR         r     1 URES$                     71-0-0/w STRC        r     1 URES$R
    72-0-0/w PTR         r     1 USN$                      72-0-0/w STRC        r     1 USN$R

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 B$PS4$
     0-0-0/w PTR         r     1 B$PS5$                     0-0-0/w PTR         r     1 B$PS6$
     0-0-0/w PTR         r     1 B$PS7$                     0-0-0/w STRC(90)    r     1 FOS_FO_CITE
     0-0-0/w STRC(180)   r     1 FOS_JM_CITE
     0-0-0/w PTR         r     1 FOS_SEG$(0:0)
     0-0-0/w UBIN        r     1 FOS_WSQ                    0-0-0/c CHAR(8)     r     1 J_MBS
     0-0-0/c CHAR(8)     r     1 J_OUTSYM                   0-0-0/w UBIN        r     1 S_CUN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:209  

     0-0-0/c ACHR        r     1 B$$WSN                     0-0-0/d STRC(2088)  r     1 B$JIT
     0-0-0/w STRC(657)   r     1 FO$DEV                     0-0-0/w STRC(1332)  r     1 FO$FIL
     0-0-0/w ASTR(351)   r     1 FO$JOB                     0-0-0/d STRC(1512)  r     1 FO$Q
     0-0-0/d STRC(432)   r     1 FPT$JOBSTATS_V             0-0-0/w ASTR(1665)  r     1 JM$IF
     0-0-0/w STRC(108)   r     1 JM$QRIT                    0-0-0/w STRC(108)   r     1 JM$SN
     0-0-0/w STRC(1728)  r     1 JMC$CH
     0-0-0/w STRC(72)    r     1 JMC$CHAINS(0:23)
     0-0-0/w STRC(72)    r     1 JP$JOB                     0-0-0/w STRC(216)   r     1 JP$Q
     0-0-0/d STRC(396)   r     1 R$CHECK                    0-0-0/w STRC(1008)  r     1 R$FILE
     0-0-0/d STRC(2376)  r     1 R$ISRCH                    0-0-0/d STRC(72)    r     1 R$ISRCH_RES
     0-0-0/d STRC(72)    r     1 R$ISRCH_SN                 0-0-0/w STRC(2304)  r     1 R$JOB
     0-0-0/d STRC(1080)  r     1 R$OSRCH                    0-0-0/c STRC(72)    r     1 VLP$ACCT
     0-0-0/d STRC(702)   r     1 VLP$CRITERIA               0-0-0/d STRC(288)   r     1 VLP$JOBNAME


   Procedure FOS$PMME requires 1899 words for executable code.
   Procedure FOS$PMME requires 80 words of local(AUTO) storage.

    No errors detected in file FOS$STATUS.:E05TSI    .
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:210  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:211  
          MINI XREF LISTING

ACCT
     10499**DCL     11841>>IF      11952>>IF      11982<<ASSIGN  11984<<ASSIGN
AGAIN IN PROCEDURE GET_PREHDR
     12006**LABEL   12030--GOTO
ALTRT IN PROCEDURE FINDJOB
     11851**LABEL   11798--CALLALT
ALTRT IN PROCEDURE FINDOUTP
     11928**LABEL   11922--CALLALT
ALTRT IN PROCEDURE FINDPRE
     11882**LABEL   11873--CALLALT
B$$WSN
     10188**DCL     11161>>IF      11161>>IF      11161>>IF      11161>>IF      11355>>IF      11355>>IF
     11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF
B$JIT.ACCN
      9505**DCL     10737>>IF      10777>>IF      10895>>IF      10928>>IF      10965>>IF      11161>>IF
     11355>>IF      11682>>IF      11689>>IF      11982>>ASSIGN
B$JIT.ERR
      9505**DCL     10607<<ASSIGN  10638<<ASSIGN  10741<<ASSIGN  10783<<ASSIGN  10811<<ASSIGN  10847<<ASSIGN
     10918<<ASSIGN  10941<<ASSIGN  11019<<ASSIGN  11030<<ASSIGN  11047<<ASSIGN  11057<<ASSIGN  11429<<ASSIGN
     11469<<ASSIGN  11478<<ASSIGN  11499<<ASSIGN  11661<<ASSIGN  11669<<ASSIGN  12014<<ASSIGN
B$JIT.ERR.MID
      9506**DCL      9506--REDEF
B$JIT.PRIV.ACTIVE
      9506**DCL     10737>>IF      10777>>IF      10807>>IF      10843>>IF      10895>>IF      10928>>IF
     10965>>IF      10990>>IF      11161>>IF      11355>>IF      11684>>IF      11691>>IF
B$JIT.UNAME
      9505**DCL     10737>>IF      10777>>IF      10895>>IF      10928>>IF      10965>>IF      11161>>IF
     11355>>IF      11682>>IF      11689>>IF
B$JIT$
     10204**DCL      9500--IMP-PTR 10607>>ASSIGN  10638>>ASSIGN  10737>>IF      10737>>IF      10737>>IF
     10741>>ASSIGN  10777>>IF      10777>>IF      10777>>IF      10783>>ASSIGN  10807>>IF      10811>>ASSIGN
     10843>>IF      10847>>ASSIGN  10895>>IF      10895>>IF      10895>>IF      10918>>ASSIGN  10928>>IF
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:212  
     10928>>IF      10928>>IF      10941>>ASSIGN  10965>>IF      10965>>IF      10965>>IF      10990>>IF
     11019>>ASSIGN  11030>>ASSIGN  11047>>ASSIGN  11057>>ASSIGN  11161>>IF      11161>>IF      11161>>IF
     11355>>IF      11355>>IF      11355>>IF      11429>>ASSIGN  11469>>ASSIGN  11478>>ASSIGN  11499>>ASSIGN
     11661>>ASSIGN  11669>>ASSIGN  11682>>IF      11682>>IF      11684>>IF      11689>>IF      11689>>IF
     11691>>IF      11982>>ASSIGN  12014>>ASSIGN
B$PS0$
     10195**DCL      9609--IMP-PTR 10536>>ASSIGN  10621>>ASSIGN  10780>>ASSIGN  10819>>ASSIGN  10820>>ASSIGN
     10855>>ASSIGN  10856>>ASSIGN  10906>>IF      10916>>IF      10968>>ASSIGN  11072>>IF      11946>>IF
     11987>>ASSIGN
B$PS1$
     10196**DCL     10628<>CALL    10635<>CALL
B$PS2$
     10197**DCL      9592--IMP-PTR  9597--IMP-PTR  9600--IMP-PTR 10707>>ASSIGN  10708>>ASSIGN  10709>>ASSIGN
     10710>>ASSIGN  10711>>ASSIGN  11102>>ASSIGN  11205>>ASSIGN  11208>>ASSIGN  11251>>ASSIGN  11273>>ASSIGN
     11380>>ASSIGN  11383>>ASSIGN  11464>>ASSIGN  11547>>ASSIGN  11549>>ASSIGN  11551>>ASSIGN  11552>>ASSIGN
     11553>>ASSIGN  11554>>ASSIGN  11555>>ASSIGN  11559>>ASSIGN  11559>>ASSIGN  11561>>ASSIGN  11561>>ASSIGN
     11570>>ASSIGN  11571>>ASSIGN  11576>>IF      11578>>ASSIGN  11579>>ASSIGN  11581>>IF      11583>>IF
     11583>>IF      11583>>IF      11584>>ASSIGN  11585>>ASSIGN  11587>>ASSIGN  11588>>ASSIGN  11673>>ASSIGN
     11674>>ASSIGN  11675>>ASSIGN  11678>>ASSIGN  11693>>ASSIGN  11695>>ASSIGN  11699>>ASSIGN  11700>>ASSIGN
     11701>>ASSIGN  11704>>ASSIGN
B$PS3$
     10198**DCL      9620--IMP-PTR 11067>>IF      11068>>IF      11070>>IF      11085>>IF      11086>>CALLBLT
     11089>>IF      11090>>IF      11092>>IF      11093>>IF      11096>>IF      11105>>IF      11110>>IF
     11115>>IF      11120>>IF      11120>>IF      11120>>IF      11120>>IF      11129>>ASSIGN  11130>>ASSIGN
     11133>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF
     11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF
     11266>>IF      11267>>CALLBLT 11280>>IF      11287>>IF      11294>>IF      11301>>IF      11308>>IF
     11308>>IF      11308>>IF      11308>>IF      11317>>ASSIGN  11318>>ASSIGN  11355>>IF      11355>>IF
     11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF
     11355>>IF      11457>>IF
B$PS4$
     10199**DCL      9613--IMP-PTR 11990>>ASSIGN
B$PS5$
     10200**DCL      9616--IMP-PTR 11984>>ASSIGN
B$PS6$
     10201**DCL      9603--IMP-PTR 11758>>ASSIGN  11759>>ASSIGN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:213  
B$PS7$
     10202**DCL      9606--IMP-PTR 11437>>ASSIGN  11438>>ASSIGN  11439>>ASSIGN
BLOW_OUT
     10635**LABEL   10635--CALLALT
BYSYSID
     10483**DCL     11824>>IF      11872>>IF      11939>>IF      11986<<ASSIGN  11989<<ASSIGN
CANCEL1
     10910**LABEL   10894--CALLALT
CANCEL2
     10932**LABEL   10911--GOTO
CANCEL3
     10934**LABEL   10969--GOTO
CHK0 IN PROCEDURE DOCHECK
     11682**LABEL   11681--CALLALT 11685--GOTO
CHK1 IN PROCEDURE DOCHECK
     11678**LABEL   11677--CALLALT
CHKRET
     10711**LABEL   10705--CALLALT
CSIZ
     10508**DCL     11044<>CALL    11054>>IF
DELSEG
     10638**LABEL   10626--CALLALT 10627--GOTO
DEVNM
     10525**DCL     10709>>ASSIGN  11632<<ASSIGN
DEVNM1
     10526**DCL     11548<<ASSIGN  11566<<ASSIGN  11570>>ASSIGN  11578>>ASSIGN
DOCHECK
     11654**PROC    10683--CALL    10704--CALL
DONE IN PROCEDURE DOCHECK
     11694**LABEL   11679--GOTO    11688--CALLALT 11692--GOTO
DSIZ
     10478**DCL     10626<>CALL    10627>>IF      10628<>CALL    10635<>CALL
E_BADFC
     10224**DCL     11499>>ASSIGN
E_FNOTFND
     10308**DCL     10783>>ASSIGN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:214  
E_JOBAOFF
     10254**DCL     10918>>ASSIGN
E_JSICPS
     10296**DCL     11057>>ASSIGN
E_JSIRAS
     10260**DCL     11478>>ASSIGN
E_JSIRLS
     10266**DCL     11429>>ASSIGN
E_JSIRPS
     10290**DCL     11030>>ASSIGN  11669>>ASSIGN
E_JSISLS
     10272**DCL     11469>>ASSIGN
E_JSNOCRITERIA
     10284**DCL     11047>>ASSIGN
E_JSNORESULTS
     10278**DCL     11019>>ASSIGN  11661>>ASSIGN
E_NAUTHFC
     10230**DCL     10607>>ASSIGN
E_NOTFND
     10242**DCL     10941>>ASSIGN
E_NOTYJ
     10248**DCL     10741>>ASSIGN
E_NSPILL
     10302**DCL     10811>>ASSIGN
E_NSPILLED
     10314**DCL     10847>>ASSIGN
E_NVMEM
     10236**DCL     10638>>ASSIGN
E_SQRCVR
     10320**DCL     12014>>ASSIGN
FILX
     10471**DCL     11101<<ASSIGN  11203>>IF      11205>>ASSIGN  11208>>ASSIGN  11243<<ASSIGN  11243>>ASSIGN
     11251>>ASSIGN  11252>>IF      11272<<ASSIGN  11378>>IF      11380>>ASSIGN  11383>>ASSIGN  11447<<ASSIGN
     11447>>ASSIGN  11464>>ASSIGN  11465>>IF
FIND IN PROCEDURE FINDOUTP
     11919**LABEL   11910--GOTO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:215  
FINDJOB
     11788**PROC    10894--CALL    11688--CALL
FINDOUTP
     11905**PROC    10735--CALL    10915--CALL    11681--CALL
FINDOUTPF IN PROCEDURE FINDOUTP
     11917**ENTRY   10705--CALL    10776--CALL    10808--CALL    10844--CALL    10964--CALL
FINDPRE
     11869**PROC    11677--CALL
FNOTFOUND
     10780**LABEL   10776--CALLALT 10808--CALLALT 10844--CALLALT 10964--CALLALT
FO$DEV.NAME
     10008**DCL     10009--REDEF   11566>>ASSIGN  11632>>ASSIGN
FO$DEV.NAMER.NUM
     10011**DCL     11236>>ASSIGN
FO$DEV.NAMER.TYP
     10010**DCL     11568>>IF
FO$DEV.RACCT
     10076**DCL     10077--REDEF
FO$DEV.TNAME
     10014**DCL     11153>>ASSIGN  11567>>ASSIGN
FO$FIL.AHEAD
      9954**DCL     10711>>ASSIGN  11232>>ASSIGN  11944>>ASSIGN
FO$FIL.ATTR
      9911**DCL     11218>>ASSIGN
FO$FIL.BOOTID
      9951**DCL     11223>>ASSIGN
FO$FIL.CDEV$
      9915**DCL     11148>>ASSIGN  11161>>IF      11562>>IF      11564>>ASSIGN  11627>>ASSIGN
FO$FIL.COPIES
      9910**DCL     11216>>ASSIGN
FO$FIL.CREATED
      9949**DCL     11233>>ASSIGN
FO$FIL.DEST
      9905**DCL      9906--REDEF
FO$FIL.DESTR.TYP
      9908**DCL     11161>>IF      11215>>ASSIGN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:216  
FO$FIL.DESTR.WSN
      9907**DCL     11161--IF      11161--IF      11214>>ASSIGN
FO$FIL.FLG.GLC
      9931**DCL     11161>>IF      11219>>ASSIGN
FO$FIL.FLG.LPAVAIL
      9928**DCL     10710>>ASSIGN  11221>>ASSIGN  11559>>ASSIGN
FO$FIL.FLG.SAP
      9933**DCL     11220>>ASSIGN
FO$FIL.FLG.SPILL
      9938**DCL     10809>>IF      11224>>ASSIGN  11241<<ASSIGN
FO$FIL.FORM
      9920**DCL     11161>>IF      11161>>IF      11161>>IF      11229>>ASSIGN
FO$FIL.GRANS
      9923**DCL     11228>>ASSIGN
FO$FIL.HICNUM
      9940**DCL     11227>>ASSIGN
FO$FIL.JLNK$
      9903**DCL     11574>>ASSIGN
FO$FIL.LNK$
      9895**DCL     11246>>ASSIGN  11955>>ASSIGN
FO$FIL.NUM
      9919**DCL     11226>>ASSIGN  11946>>IF
FO$FIL.OJOB$
      9901**DCL     11145>>ASSIGN  11937>>ASSIGN
FO$FIL.PRIO
      9943**DCL     10845>>IF      11560>>IF      11605>>ASSIGN
FO$FIL.SAPCOPIES
      9941**DCL     11217>>ASSIGN
FO$FIL.SYSID
      9917**DCL     11161>>IF      11161>>IF      11225>>ASSIGN  11941>>IF      11945>>ASSIGN
FO$JOB.ACCT
     10110**DCL     10737>>IF      10777>>IF      10928>>IF      10965>>IF      11161>>IF      11161>>IF
     11161>>IF      11230>>ASSIGN  11682>>IF      11952>>IF
FO$JOB.FILHD$
     10096**DCL     11556>>ASSIGN
FO$JOB.JNL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:217  
     10116**DCL     10123--IMP-SIZ 11231>>ASSIGN  11952>>IF
FO$JOB.JOBNAME
     10123**DCL     11231>>ASSIGN  11952>>IF
FO$JOB.MODE
     10107**DCL     11222>>ASSIGN
FO$JOB.NFIL
     10099**DCL     11552>>ASSIGN
FO$JOB.NFIL_DONE
     10109**DCL     11553>>ASSIGN
FO$JOB.NFIL_PRINTING
     10108**DCL     11554>>ASSIGN
FO$JOB.SYSID
     10098**DCL     10753>>ASSIGN  10932>>ASSIGN
FO$JOB.UNAME
     10113**DCL     10737>>IF      10777>>IF      10928>>IF      10965>>IF      11161>>IF      11682>>IF
FO$Q.FILHD$
     10144**DCL     11139>>ASSIGN  11934>>ASSIGN
FO$Q.LOCK
     10140**DCL     12052>>IF
FO$Q.RCVR
     10141**DCL     12051>>IF
FOS_FO_CITE
     10389**DCL     10755<>CALL    10755--CALL
FOS_FO_CITE.BATCH
     10399**DCL     10402--REDEF   10406--REDEF   10910<<ASSIGN  10931<<ASSIGN
FOS_FO_CITE.CODE
     10393**DCL     10752<<ASSIGN  10821<<ASSIGN  10857<<ASSIGN  10936<<ASSIGN
FOS_FO_CITE.DISP
     10402**DCL     10820<<ASSIGN  10856<<ASSIGN
FOS_FO_CITE.NUM
     10408**DCL     10411--REDEF   10780<<ASSIGN  10819<<ASSIGN  10855<<ASSIGN  10968<<ASSIGN
FOS_FO_CITE.NUMR
     10411**DCL     10750<<ASSIGN  10934<<ASSIGN
FOS_FO_CITE.SYSID
     10397**DCL     10753<<ASSIGN  10818<<ASSIGN  10854<<ASSIGN  10937<<ASSIGN
FOS_JM_CITE
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:218  
     10340**DCL     10902<>CALL    10902--CALL
FOS_JM_CITE.ACCT
     10357**DCL     10360--REDEF   10901<<ASSIGN
FOS_JM_CITE.SUBCODE
     10351**DCL     10900<<ASSIGN
FOS_JM_CITE.SYSID
     10349**DCL     10899<<ASSIGN
FOS_SEG$
      5530**DCL      5530--REDEF   10628<>CALL    10635<>CALL    11529>>IF      11531<>CALL    11532<<ASSIGN
     12009>>ASSIGN  12032>>ASSIGN  12049>>ASSIGN  12061>>ASSIGN  12062>>ASSIGN  12063>>ASSIGN  12080>>ASSIGN
     12092>>ASSIGN  12093>>ASSIGN
FOS_WSQ
      5530**DCL     10628<>CALL    10634<>CALL    10635<>CALL    11531<>CALL
FPRIO
     10493**DCL     11605<<ASSIGN  11607>>DOCASE  11623>>IF      11623>>IF      11626>>ASSIGN
FPT$JOBSTATS_V.DISP
      9610**DCL     10820>>ASSIGN  10856>>ASSIGN
FPT$JOBSTATS_V.NUM
      9609**DCL     10780>>ASSIGN  10819>>ASSIGN  10855>>ASSIGN  10968>>ASSIGN  11946>>IF
FPT$JOBSTATS_V.ORDER
      9609**DCL     10536>>ASSIGN
FPT$JOBSTATS_V.OUTPUT
      9609**DCL     10906>>IF      10916>>IF      11072>>IF
FPT$JOBSTATS_V.STATSEG
      9609**DCL     10621>>ASSIGN
FPT$JOBSTATS_V.SYSID
      9609**DCL     11987>>ASSIGN
GET_JP
     11979**PROC    11791--CALL    11871--CALL    11921--CALL
GET_MBSHDR IN PROCEDURE GET_PREHDR
     12077**ENTRY   11270--CALL    11798--CALL
GET_PREHDR
     12006**PROC    11873--CALL
GET_SNS
     11753**PROC    11416--CALL    11418--CALL
GET_SYMHDR IN PROCEDURE GET_PREHDR
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:219  
     12046**ENTRY   11099--CALL    11922--CALL
GOTJOB IN PROCEDURE SRCHQ
     11942**LABEL   11954--GOTO
HFF$DSIZ
     10208**DCL-ENT 10626--CALL    11015--CALL    11044--CALL    11342--CALL    11344--CALL    11657--CALL
HFF$NILERASE
     10209**DCL-ENT 11983--CALL    11988--CALL
HIPRIO
     10469**DCL     11108<<ASSIGN  11113<<ASSIGN  11118<<ASSIGN  11125<<ASSIGN  11130<<ASSIGN  11136>>ASSIGN
     11283<<ASSIGN  11290<<ASSIGN  11297<<ASSIGN  11304<<ASSIGN  11313<<ASSIGN  11318<<ASSIGN  11328>>DOWHILE
     11349>>ASSIGN  11461<<ASSIGN
IPRIO
     10500**DCL     11327<<ASSIGN  11328>>DOWHILE 11329>>ASSIGN  11335<<ASSIGN  11335>>ASSIGN  11349<<ASSIGN
     11350>>DOWHILE 11351>>ASSIGN  11407>>ASSIGN  11453>>IF      11454<<ASSIGN  11454>>ASSIGN
ISKIP
     11447**LABEL   11376--GOTO
ISRCH
     11252**LABEL   11073--GOTO
JM$IF.ACCT
      9735**DCL     10895>>IF      10901>>ASSIGN  11355>>IF      11355>>IF      11355>>IF      11396>>ASSIGN
     11689>>IF      11841>>IF
JM$IF.FLG
      9705**DCL     11394>>ASSIGN
JM$IF.JDID
      9745**DCL     11404>>ASSIGN
JM$IF.JDSTEPCC
      9768**DCL     11405>>ASSIGN
JM$IF.JNAME
      9801**DCL     11400>>ASSIGN  11841>>IF
JM$IF.JNL
      9789**DCL      9801--IMP-SIZ 11400>>ASSIGN  11841>>IF
JM$IF.LNK$
      9663**DCL     11333>>ASSIGN  11450>>ASSIGN  11834>>ASSIGN  11849>>ASSIGN
JM$IF.MAXPSN
      9727**DCL     11411>>IF
JM$IF.NJD
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:220  
      9699**DCL     11406>>ASSIGN
JM$IF.PART
      9676**DCL     11388>>ASSIGN
JM$IF.PI
      9685**DCL     11390>>ASSIGN
JM$IF.PNUM
      9683**DCL     11389>>ASSIGN
JM$IF.PRIO
      9703**DCL     11391>>ASSIGN  11830>>ASSIGN  11845>>ASSIGN
JM$IF.RATIM
      9743**DCL     11401>>ASSIGN
JM$IF.RRT
      9775**DCL     11402>>ASSIGN
JM$IF.SLNK$
      9671**DCL     11417>>ASSIGN
JM$IF.START_TIME
      9689**DCL     11393>>ASSIGN
JM$IF.SUBMIT_TIME
      9687**DCL     11392>>ASSIGN
JM$IF.SYSID
      9733**DCL     10898>>ASSIGN  11355>>IF      11355>>IF      11395>>ASSIGN  11828>>IF      11844>>ASSIGN
JM$IF.TIM
      9697**DCL     11403>>ASSIGN
JM$IF.U
      9673**DCL     11387>>ASSIGN
JM$IF.UNAME
      9737**DCL     10895>>IF      11355>>IF      11397>>ASSIGN  11689>>IF
JM$IF.VRLIST$
      9667**DCL     11424>>ASSIGN
JM$IF.WOO
      9739**DCL     11355--IF      11355--IF      11398>>ASSIGN
JM$IF.WSN
      9741**DCL     11355--IF      11355--IF      11399>>ASSIGN
JM$IF.XLNK$
      9669**DCL     11415>>ASSIGN
JM$QRIT.ATTRS
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:221  
      9869**DCL     11439>>ASSIGN
JM$QRIT.NXT$
      9874**DCL     11442>>ASSIGN
JM$QRIT.TYPE
      9863**DCL     11437>>ASSIGN
JM$QRIT.VNUM
      9865**DCL      9867--REDEF   11438>>ASSIGN
JM$SN.FLGS
      9826**DCL     11759>>ASSIGN
JM$SN.NXT$
      9835**DCL     11760>>ASSIGN
JM$SN.TXT
      9824**DCL     11758>>ASSIGN
JMC$CH
      8806**DCL      8807--REDEF
JMC$CH.LOCK
      8807**DCL     12083>>IF
JMC$CH.RCVR
      8807**DCL     12082>>IF
JMC$CHAINS.HEAD$
      8808**DCL     11329>>ASSIGN  11351>>ASSIGN  11822>>ASSIGN
JOBNAME
     10480**DCL     11841>>IF      11952>>IF      11990<<ASSIGN
JP$JOB.LNK$
     10180**DCL     11878>>ASSIGN  11884>>ASSIGN
JP$JOB.SYSID
     10185**DCL     11877>>IF      11883>>IF
JP$Q.HEAD$
     10168**DCL     11874>>ASSIGN
JP$Q.LOCK
     10161**DCL     12023>>IF
JP$Q.RCVR
     10165**DCL     12011>>IF
JP$Q.SCAN$
     10174**DCL     11880>>ASSIGN
JPRIO
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:222  
     10492**DCL     10906>>IF      11407<<ASSIGN  11694>>IF      11718>>DOCASE  11736>>IF      11736>>IF
     11738>>ASSIGN  11801<<ASSIGN  11808<<ASSIGN  11813>>IF      11814<<ASSIGN  11814>>ASSIGN  11815>>IF
     11822>>ASSIGN
J_MBS
     10206**DCL     10902<>CALL
J_OUTSYM
     10205**DCL     10755<>CALL
KUW$WRITE
     10210**DCL-ENT 10755--CALL    10902--CALL
LOPRIO
     10470**DCL     11107<<ASSIGN  11108>>ASSIGN  11112<<ASSIGN  11113>>ASSIGN  11117<<ASSIGN  11118>>ASSIGN
     11124<<ASSIGN  11129<<ASSIGN  11137>>DOWHILE 11282<<ASSIGN  11289<<ASSIGN  11296<<ASSIGN  11303<<ASSIGN
     11312<<ASSIGN  11317<<ASSIGN  11350>>DOWHILE 11457>>IF      11460<<ASSIGN
MAGAIN IN PROCEDURE GET_PREHDR
     12063**LABEL   12090--GOTO
MBSHDR$
     10497**DCL     11329>>ASSIGN  11351>>ASSIGN  11822>>ASSIGN  12080<<ASSIGN  12081>>IF      12082>>IF
     12083>>IF
MBSJOB$
     10490**DCL     11331>>ASSIGN  11353>>ASSIGN  11827>>ASSIGN  11840>>ASSIGN  12092<<ASSIGN
MBSRES$
     10501**DCL     10502--REDEF   11426>>ASSIGN  12093<<ASSIGN
MBSSN$
     10502**DCL     11757>>ASSIGN
MDEV$
     10527**DCL     11152<<ASSIGN  11153>>ASSIGN  11157<<ASSIGN  11234>>IF      11236>>ASSIGN  11565<<ASSIGN
     11566>>ASSIGN  11567>>ASSIGN  11568>>IF      11631<<ASSIGN  11632>>ASSIGN
MFIL$
     10477**DCL     10710>>ASSIGN  10711>>ASSIGN  10809>>IF      10845>>IF      11143<<ASSIGN  11145>>ASSIGN
     11148>>ASSIGN  11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF      11161>>IF
     11161>>IF      11161>>IF      11161>>IF      11161>>IF      11214>>ASSIGN  11215>>ASSIGN  11216>>ASSIGN
     11217>>ASSIGN  11218>>ASSIGN  11219>>ASSIGN  11220>>ASSIGN  11221>>ASSIGN  11223>>ASSIGN  11224>>ASSIGN
     11225>>ASSIGN  11226>>ASSIGN  11227>>ASSIGN  11228>>ASSIGN  11229>>ASSIGN  11232>>ASSIGN  11233>>ASSIGN
     11241>>ASSIGN  11246>>ASSIGN  11558<<ASSIGN  11559>>ASSIGN  11560>>IF      11562>>IF      11564>>ASSIGN
     11574>>ASSIGN  11605>>ASSIGN  11627>>ASSIGN  11936<<ASSIGN  11937>>ASSIGN  11941>>IF      11944>>ASSIGN
     11945>>ASSIGN  11946>>IF      11955>>ASSIGN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:223  
MJOB$
     10494**DCL     10737>>IF      10737>>IF      10753>>ASSIGN  10777>>IF      10777>>IF      10895>>IF
     10895>>IF      10898>>ASSIGN  10901>>ASSIGN  10928>>IF      10928>>IF      10932>>ASSIGN  10965>>IF
     10965>>IF      11146<<ASSIGN  11161>>IF      11161>>IF      11161>>IF      11161>>IF      11222>>ASSIGN
     11230>>ASSIGN  11231>>ASSIGN  11231>>ASSIGN  11331<<ASSIGN  11333>>ASSIGN  11353<<ASSIGN  11355>>IF
     11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF
     11355>>IF      11355>>IF      11387>>ASSIGN  11388>>ASSIGN  11389>>ASSIGN  11390>>ASSIGN  11391>>ASSIGN
     11392>>ASSIGN  11393>>ASSIGN  11394>>ASSIGN  11395>>ASSIGN  11396>>ASSIGN  11397>>ASSIGN  11398>>ASSIGN
     11399>>ASSIGN  11400>>ASSIGN  11400>>ASSIGN  11401>>ASSIGN  11402>>ASSIGN  11403>>ASSIGN  11404>>ASSIGN
     11405>>ASSIGN  11406>>ASSIGN  11411>>IF      11415>>ASSIGN  11417>>ASSIGN  11424>>ASSIGN  11450>>ASSIGN
     11552>>ASSIGN  11553>>ASSIGN  11554>>ASSIGN  11556>>ASSIGN  11682>>IF      11682>>IF      11689>>IF
     11689>>IF      11827<<ASSIGN  11828>>IF      11830>>ASSIGN  11834>>ASSIGN  11840<<ASSIGN  11841>>IF
     11841>>IF      11841>>IF      11844>>ASSIGN  11845>>ASSIGN  11849>>ASSIGN  11876<<ASSIGN  11877>>IF
     11878>>ASSIGN  11882<<ASSIGN  11883>>IF      11884>>ASSIGN  11938<<ASSIGN  11952>>IF      11952>>IF
     11952>>IF
MMS$COMPACT
     10211**DCL-ENT 10634--CALL
MMS$VGET
     10212**DCL-ENT 10628--CALL    10635--CALL
MMS$VREL
     10213**DCL-ENT 11531--CALL
MRES$
     10519**DCL     11426<<ASSIGN  11437>>ASSIGN  11438>>ASSIGN  11439>>ASSIGN  11442>>ASSIGN
MSN$
     10520**DCL     11757<<ASSIGN  11758>>ASSIGN  11759>>ASSIGN  11760>>ASSIGN
NAHEAD
     10498**DCL     11276<<ASSIGN  11332<<ASSIGN  11332>>ASSIGN  11386>>ASSIGN  11451<<ASSIGN  11451>>ASSIGN
     11453<<ASSIGN  11551>>ASSIGN  11701>>ASSIGN  11806<<ASSIGN  11833<<ASSIGN  11833>>ASSIGN  11848<<ASSIGN
     11848>>ASSIGN  11923<<ASSIGN  11943>>IF      11944<<ASSIGN
NAUTH
     10606**LABEL   10807--GOTO    10843--GOTO    10990--GOTO
NOACCN IN PROCEDURE GET_JP
     11984**LABEL   11983--CALLALT
NONAME IN PROCEDURE GET_JP
     11990**LABEL   11988--CALLALT
NORSPACE
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:224  
     11478**LABEL   11206--GOTO    11381--GOTO
NOSLS
     11465**LABEL   11416--CALLALT 11418--CALLALT
NOSSPACE
     10627**LABEL   10628--CALLALT
NOTFOUND
     10937**LABEL   10735--CALLALT 10915--CALLALT 11099--CALLALT 11252--GOTO    11270--CALLALT 11465--GOTO
NOTYOURJ
     10737**LABEL   10779--GOTO    10897--GOTO    10930--GOTO    10967--GOTO
NO_CRITERIA_VECTOR
     11047**LABEL   11044--CALLALT
NO_RESULTS_VECTOR
     11019**LABEL   11015--CALLALT
NO_RESULTS_VECTOR IN PROCEDURE DOCHECK
     11661**LABEL   11657--CALLALT
NO_WAY
     10635**LABEL   10634--CALLALT
OPRIO
     10468**DCL     11136<<ASSIGN  11137>>DOWHILE 11139>>ASSIGN  11161>>IF      11248<<ASSIGN  11248>>ASSIGN
     11924<<ASSIGN  11927>>IF      11928<<ASSIGN  11928>>ASSIGN  11934>>ASSIGN
ORDER
     10522**DCL     10536<<ASSIGN  10546>>DOCASE  11072>>IF      11115>>IF      11161>>IF      11241>>IF
OSKIP
     11243**LABEL   11201--GOTO
PREHDR$
     10495**DCL     11874>>ASSIGN  11880>>ASSIGN  12009<<ASSIGN  12010>>IF      12011>>IF      12023>>IF
PREJOB$
     10496**DCL     11876>>ASSIGN  11882>>ASSIGN  12032<<ASSIGN
R$CHECK
      9592**DCL     11673<<ASSIGN
R$CHECK.AHEAD
      9592**DCL     10711<<ASSIGN  11551<<ASSIGN  11701<<ASSIGN
R$CHECK.CODE
      9592**DCL     11584<<ASSIGN  11585<<ASSIGN  11587<<ASSIGN  11674<<ASSIGN  11678<<ASSIGN  11695<<ASSIGN
     11699<<ASSIGN
R$CHECK.DEVAVAIL
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:225  
      9594**DCL     10710<<ASSIGN  11559<<ASSIGN  11559>>ASSIGN
R$CHECK.DEVNAME
      9594**DCL     10709<<ASSIGN  11547<<ASSIGN  11570<<ASSIGN  11576>>IF      11578<<ASSIGN
R$CHECK.FCODE
      9593**DCL     10707<<ASSIGN  11675<<ASSIGN
R$CHECK.FPRIO
      9593**DCL     10708<<ASSIGN
R$CHECK.IPRIO
      9592**DCL     11693<<ASSIGN
R$CHECK.NOF
      9593**DCL     11552<<ASSIGN  11583>>IF
R$CHECK.NOFDONE
      9593**DCL     11553<<ASSIGN  11583>>IF
R$CHECK.NOFPRINTING
      9593**DCL     11554<<ASSIGN  11581>>IF
R$CHECK.NOFSPILLED
      9594**DCL     11555<<ASSIGN  11561<<ASSIGN  11561>>ASSIGN  11583>>IF
R$CHECK.PRIO
      9592**DCL     11700<<ASSIGN
R$CHECK.SYSID
      9593**DCL     11588<<ASSIGN  11704<<ASSIGN
R$CHECK.TNAME
      9594**DCL     11549<<ASSIGN  11571<<ASSIGN  11579<<ASSIGN
R$FILE
      9631**DCL     11083--ASSIGN
R$FILE.ACCT
      9634**DCL     11230<<ASSIGN
R$FILE.AHEAD
      9634**DCL     11232<<ASSIGN
R$FILE.ATTR
      9632**DCL     11218<<ASSIGN
R$FILE.BOOTID
      9632**DCL     11223<<ASSIGN
R$FILE.COPIES
      9631**DCL     11216<<ASSIGN
R$FILE.CREATED
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:226  
      9634**DCL     11233<<ASSIGN
R$FILE.DEVNAME
      9633**DCL     11236<<ASSIGN  11238<<ASSIGN
R$FILE.DEVTYP
      9631**DCL     11215<<ASSIGN
R$FILE.FLG.DEVAVAIL
      9632**DCL     11221<<ASSIGN
R$FILE.FLG.GLC
      9632**DCL     11219<<ASSIGN
R$FILE.FLG.SAP
      9632**DCL     11220<<ASSIGN
R$FILE.FLG.SPILL
      9632**DCL     11224<<ASSIGN
R$FILE.FORM
      9633**DCL     11229<<ASSIGN
R$FILE.GRANS
      9633**DCL     11228<<ASSIGN
R$FILE.HICNUM
      9633**DCL     11227<<ASSIGN
R$FILE.JNAME
      9634**DCL     11231<<ASSIGN
R$FILE.MODE
      9632**DCL     11222<<ASSIGN
R$FILE.NUM
      9633**DCL     11226<<ASSIGN
R$FILE.PRIO
      9631**DCL     11240<<ASSIGN
R$FILE.SAPCOPIES
      9631**DCL     11217<<ASSIGN
R$FILE.SYSID
      9633**DCL     11225<<ASSIGN
R$FILE.TNAME
      9631**DCL     11213<<ASSIGN
R$FILE.WOD
      9634**DCL     11214<<ASSIGN
R$ISRCH.FOUND
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:227  
      9600**DCL     11273<<ASSIGN  11380<<ASSIGN  11464<<ASSIGN
R$ISRCH.J
      9600**DCL     11383--ASSIGN
R$ISRCH_RES.R
      9606**DCL     11343--ASSIGN
R$ISRCH_RES.R.ATTR
      9606**DCL     11439<<ASSIGN
R$ISRCH_RES.R.TYP
      9606**DCL     11437<<ASSIGN
R$ISRCH_RES.R.VNUM
      9606**DCL     11438<<ASSIGN
R$ISRCH_SN.S
      9603**DCL     11345--ASSIGN
R$ISRCH_SN.S.FLG
      9603**DCL     11759<<ASSIGN
R$ISRCH_SN.S.NAME
      9603**DCL     11758<<ASSIGN
R$JOB
      9638**DCL     11264--ASSIGN
R$JOB.ACCT
      9641**DCL     11396<<ASSIGN
R$JOB.AHEAD
      9641**DCL     11386<<ASSIGN
R$JOB.FLG
      9640**DCL     11394<<ASSIGN
R$JOB.IPRIO
      9639**DCL     11391<<ASSIGN
R$JOB.JDID
      9642**DCL     11404<<ASSIGN
R$JOB.JDSTEPCC
      9643**DCL     11405<<ASSIGN
R$JOB.JNAME
      9642**DCL     11400<<ASSIGN
R$JOB.NFOLL
      9641**DCL     11406<<ASSIGN
R$JOB.NRES
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:228  
      9638**DCL     11420<<ASSIGN  11441<<ASSIGN  11441>>ASSIGN
R$JOB.NSN
      9638**DCL     11410<<ASSIGN  11761<<ASSIGN  11761>>ASSIGN
R$JOB.PART
      9639**DCL     11388<<ASSIGN
R$JOB.PI
      9639**DCL     11390<<ASSIGN
R$JOB.PNUM
      9639**DCL     11389<<ASSIGN
R$JOB.PRIO
      9639**DCL     11409<<ASSIGN
R$JOB.RATIM
      9642**DCL     11401<<ASSIGN
R$JOB.RESX
      9638**DCL     11423<<ASSIGN
R$JOB.RRT
      9642**DCL     11402<<ASSIGN
R$JOB.SNX
      9638**DCL     11414<<ASSIGN
R$JOB.START_TIME
      9640**DCL     11393<<ASSIGN
R$JOB.SUBMIT_TIME
      9639**DCL     11392<<ASSIGN
R$JOB.SYSID
      9641**DCL     11395<<ASSIGN
R$JOB.TIM
      9642**DCL     11403<<ASSIGN
R$JOB.U
      9638**DCL     11387<<ASSIGN
R$JOB.UNAME
      9641**DCL     11397<<ASSIGN
R$JOB.WOO
      9641**DCL     11398<<ASSIGN
R$JOB.WSN
      9642**DCL     11399<<ASSIGN
R$OSRCH.F
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:229  
      9597**DCL     11208--ASSIGN
R$OSRCH.FOUND
      9597**DCL     11102<<ASSIGN  11205<<ASSIGN  11251<<ASSIGN
RCHECK_INIT
     10445**DCL     11666--IF      11673>>ASSIGN
RELOOP
     11345**LABEL   11462--GOTO
RELSEG
     11525**PROC    10623--CALL    12114--CALL    12115--CALL    12116--CALL    12117--CALL    12121--CALL
     12122--CALL
RESX
     10509**DCL     11274<<ASSIGN  11423>>ASSIGN  11427>>IF      11437>>ASSIGN  11438>>ASSIGN  11439>>ASSIGN
     11440<<ASSIGN  11440>>ASSIGN
RFIL$
     10503**DCL     11208<<ASSIGN  11213>>ASSIGN  11214>>ASSIGN  11215>>ASSIGN  11216>>ASSIGN  11217>>ASSIGN
     11218>>ASSIGN  11219>>ASSIGN  11220>>ASSIGN  11221>>ASSIGN  11222>>ASSIGN  11223>>ASSIGN  11224>>ASSIGN
     11225>>ASSIGN  11226>>ASSIGN  11227>>ASSIGN  11228>>ASSIGN  11229>>ASSIGN  11230>>ASSIGN  11231>>ASSIGN
     11232>>ASSIGN  11233>>ASSIGN  11236>>ASSIGN  11238>>ASSIGN  11240>>ASSIGN
RJOB$
     10504**DCL     11383<<ASSIGN  11386>>ASSIGN  11387>>ASSIGN  11388>>ASSIGN  11389>>ASSIGN  11390>>ASSIGN
     11391>>ASSIGN  11392>>ASSIGN  11393>>ASSIGN  11394>>ASSIGN  11395>>ASSIGN  11396>>ASSIGN  11397>>ASSIGN
     11398>>ASSIGN  11399>>ASSIGN  11400>>ASSIGN  11401>>ASSIGN  11402>>ASSIGN  11403>>ASSIGN  11404>>ASSIGN
     11405>>ASSIGN  11406>>ASSIGN  11409>>ASSIGN  11410>>ASSIGN  11414>>ASSIGN  11420>>ASSIGN  11423>>ASSIGN
     11441>>ASSIGN  11441>>ASSIGN  11761>>ASSIGN  11761>>ASSIGN
RSIZ
     10505**DCL     11015<>CALL    11028>>IF      11041<<ASSIGN  11041>>ASSIGN  11083<<ASSIGN  11083>>ASSIGN
     11203>>IF      11264<<ASSIGN  11264>>ASSIGN  11378>>IF      11657<>CALL    11666>>IF
RSIZ_RES
     10506**DCL     11342<>CALL    11343>>IF      11343<<ASSIGN  11343>>ASSIGN  11421>>IF      11427>>IF
RSIZ_SN
     10507**DCL     11344<>CALL    11345>>IF      11345<<ASSIGN  11345>>ASSIGN  11411>>IF      11756>>IF
S1 IN PROCEDURE FINDJOB
     11801**LABEL   11802--CALLALT
S2 IN PROCEDURE FINDJOB
     11808**LABEL   11816--GOTO
S2 IN PROCEDURE FINDOUTP
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:230  
     11925**LABEL   11929--GOTO
S3 IN PROCEDURE FINDJOB
     11808**LABEL   11810--CALLALT 11815--GOTO
S3 IN PROCEDURE FINDOUTP
     11927**LABEL   11925--CALLALT
SAGAIN IN PROCEDURE GET_PREHDR
     12032**LABEL   12059--GOTO
SEG# IN PROCEDURE RELSEG
     11527**DCL     11525--PROC    11529>>IF      11531>>CALL    11532>>ASSIGN
SEL_ACCT
     10463**DCL     11068<<ASSIGN  11068<<ASSIGN  11069<<ASSIGN  11161>>IF      11161>>IF      11355>>IF
     11355>>IF
SEL_DEVTYP
     10467**DCL     11096<<ASSIGN  11097<<ASSIGN  11161>>IF
SEL_FORM
     10465**DCL     11090<<ASSIGN  11090<<ASSIGN  11091<<ASSIGN  11161>>IF      11161>>IF
SEL_NSFORM
     10460**DCL     11133<<ASSIGN  11134<<ASSIGN  11161>>IF
SEL_SYSID
     10466**DCL     11070<<ASSIGN  11071<<ASSIGN  11161>>IF      11355>>IF
SEL_TNAME
     10462**DCL     11093<<ASSIGN  11093<<ASSIGN  11094<<ASSIGN  11161>>IF      11161>>IF
SEL_WSNL
     10464**DCL     10188--IMP-SIZ 11086<<CALLBLT 11087<<ASSIGN  11161>>IF      11161>>IF      11161>>IF
     11161>>IF      11161>>IF      11267<<CALLBLT 11268<<ASSIGN  11355>>IF      11355>>IF      11355>>IF
     11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF      11355>>IF
SET_CHECK
     11545**PROC    11686--CALL
SET_FPRIO
     11603**PROC    10706--CALL    11239--CALL
SET_JPRIO
     11716**PROC    11408--CALL    11698--CALL
SNX
     10510**DCL     11275<<ASSIGN  11414>>ASSIGN  11756>>IF      11758>>ASSIGN  11759>>ASSIGN  11762<<ASSIGN
     11762>>ASSIGN
SPECIFIC IN PROCEDURE FINDOUTP
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:231  
     11907**DCL     11909<<ASSIGN  11919<<ASSIGN  11946>>IF
SRCH
     11015**LABEL   10991--GOTO
SRCHQ IN PROCEDURE FINDJOB
     11820**PROC    11802--CALL    11810--CALL
SRCHQ IN PROCEDURE FINDOUTP
     11933**PROC    11925--CALL
SSR$REG
     10214**DCL-ENT 12025--CALL    12054--CALL    12085--CALL
SSS$BLOCK
     10215**DCL-ENT 10535--CALL
STATSEG
     10479**DCL     10621<<ASSIGN  10623<>CALL    10628>>CALL    10635>>CALL
STILL_RECOVERING IN PROCEDURE GET_PREHDR
     12013**LABEL   12010--GOTO    12050--GOTO    12051--GOTO    12081--GOTO    12082--GOTO
SUBMISSION_PRIO
     10491**DCL     11693>>ASSIGN  11830<<ASSIGN  11845<<ASSIGN
SYMDEV$
     10524**DCL     11152>>ASSIGN  11565>>ASSIGN  11631>>ASSIGN  12063<<ASSIGN
SYMFIL$
     10476**DCL     11143>>ASSIGN  11558>>ASSIGN  11936>>ASSIGN  12062<<ASSIGN
SYMHDR$
     10484**DCL     11139>>ASSIGN  11934>>ASSIGN  12049<<ASSIGN  12050>>IF      12051>>IF      12052>>IF
SYMJOB$
     10489**DCL     11146>>ASSIGN  11938>>ASSIGN  12061<<ASSIGN
SYSID
     10482**DCL     10818>>ASSIGN  10854>>ASSIGN  10898<<ASSIGN  10899>>ASSIGN  10932<<ASSIGN  10937>>ASSIGN
     11588>>ASSIGN  11704>>ASSIGN  11828>>IF      11844<<ASSIGN  11877>>IF      11883>>IF      11941>>IF
     11945<<ASSIGN  11987<<ASSIGN
S_CUN
     10203**DCL     10602>>IF      10602>>IF      10602>>IF      12112>>IF      12119>>IF
TNAME
     10481**DCL     11153<<ASSIGN  11158<<ASSIGN  11161>>IF      11161>>IF      11213>>ASSIGN  11550<<ASSIGN
     11567<<ASSIGN  11571>>ASSIGN  11579>>ASSIGN
UCODE
     10523**DCL     10707>>ASSIGN  11610<<ASSIGN  11614<<ASSIGN  11618<<ASSIGN  11622<<ASSIGN  11630<<ASSIGN
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:232  
UDB$PMMEXIT
     10216**DCL-ENT 12021--CALL
UDEV$
     10528**DCL     10529--REDEF   11148<<ASSIGN  11149>>IF      11564<<ASSIGN  11627<<ASSIGN  11628>>IF
UDEV$R.DISP
     10530**DCL     11152>>ASSIGN  11565>>ASSIGN  11631>>ASSIGN
UFIL$
     10472**DCL     10473--REDEF   11139<<ASSIGN  11141>>DOWHILE 11246<<ASSIGN  11556<<ASSIGN  11557>>DOWHILE
     11574<<ASSIGN  11934<<ASSIGN  11935>>DOWHILE 11955<<ASSIGN
UFIL$R.DISP
     10474**DCL     11143>>ASSIGN  11558>>ASSIGN  11936>>ASSIGN
UJOB$
     10485**DCL     10486--REDEF   11145<<ASSIGN  11329<<ASSIGN  11330>>DOWHILE 11333<<ASSIGN  11351<<ASSIGN
     11352>>DOWHILE 11450<<ASSIGN  11822<<ASSIGN  11826>>DOWHILE 11834<<ASSIGN  11839>>DOWHILE 11849<<ASSIGN
     11874<<ASSIGN  11875>>DOWHILE 11878<<ASSIGN  11880<<ASSIGN  11881>>DOWHILE 11884<<ASSIGN  11937<<ASSIGN
UJOB$R.DISP
     10487**DCL     11146>>ASSIGN  11331>>ASSIGN  11353>>ASSIGN  11827>>ASSIGN  11840>>ASSIGN  11876>>ASSIGN
     11882>>ASSIGN  11938>>ASSIGN
UNHOLD1
     10750**LABEL   10781--GOTO
UPRIO
     10521**DCL     10708>>ASSIGN  11240>>ASSIGN  11409>>ASSIGN  11611<<ASSIGN  11615<<ASSIGN  11619<<ASSIGN
     11626<<ASSIGN  11635<<ASSIGN  11700>>ASSIGN  11721<<ASSIGN  11724<<ASSIGN  11727<<ASSIGN  11730<<ASSIGN
     11733<<ASSIGN  11738<<ASSIGN  11739<<ASSIGN
URES$
     10511**DCL     10512--REDEF   11424<<ASSIGN  11425>>DOWHILE 11442<<ASSIGN
URES$R.DISP
     10513**DCL     11426>>ASSIGN
USN$
     10515**DCL     10516--REDEF   11415<<ASSIGN  11417<<ASSIGN  11755>>DOWHILE 11760<<ASSIGN
USN$R.DISP
     10517**DCL     11757>>ASSIGN
VLP$ACCT.ACCT
      9616**DCL     11984>>ASSIGN
VLP$CRITERIA
      9620**DCL     11054--IF
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:233  
VLP$CRITERIA.ACCT
      9624**DCL     11067>>IF      11161>>IF      11161>>IF      11355>>IF      11355>>IF
VLP$CRITERIA.DEVTYP
      9627**DCL     11096>>IF      11161>>IF
VLP$CRITERIA.FORM
      9628**DCL     11089>>IF      11161>>IF      11161>>IF
VLP$CRITERIA.HOLD
      9625**DCL     11110>>IF
VLP$CRITERIA.MFW
      9625**DCL     11105>>IF
VLP$CRITERIA.NORUN
      9625**DCL     11280>>IF      11457>>IF
VLP$CRITERIA.NOTACCT
      9626**DCL     11068>>IF
VLP$CRITERIA.NOTFORM
      9626**DCL     11090>>IF
VLP$CRITERIA.NOTTNAME
      9626**DCL     11093>>IF
VLP$CRITERIA.NOTWSN
      9626**DCL     11161>>IF      11161>>IF      11355>>IF      11355>>IF
VLP$CRITERIA.NSFORM
      9625**DCL     11133>>IF
VLP$CRITERIA.PRIO
      9627**DCL     11120>>IF      11120>>IF      11129>>ASSIGN  11308>>IF      11308>>IF      11317>>ASSIGN
VLP$CRITERIA.PRIO1
      9627**DCL     11120>>IF      11120>>IF      11130>>ASSIGN  11308>>IF      11308>>IF      11318>>ASSIGN
VLP$CRITERIA.RUNAFTER
      9625**DCL     11287>>IF
VLP$CRITERIA.RUNNING
      9625**DCL     11294>>IF
VLP$CRITERIA.SPILLED
      9626**DCL     11115>>IF
VLP$CRITERIA.SYSID
      9624**DCL     11070>>IF      11161>>IF      11355>>IF
VLP$CRITERIA.SYSID1
      9624**DCL     11161>>IF      11355>>IF
PL6.E3A0      #001=FOS$PMME File=FOS$STATUS.:E05TSI                              TUE 07/29/97 17:14 Page:234  
VLP$CRITERIA.TNAME
      9624**DCL     11092>>IF      11161>>IF      11161>>IF
VLP$CRITERIA.WPS
      9626**DCL     11301>>IF
VLP$CRITERIA.WSN
      9624**DCL     11085>>IF      11086>>CALLBLT 11161--IF      11161--IF      11266>>IF      11267>>CALLBLT
     11355--IF      11355--IF      11355--IF      11355--IF
VLP$JOBNAME.JOBNAME
      9613**DCL     11990>>ASSIGN
WRITE_OUTSYM
     10753**LABEL   10822--GOTO    10858--GOTO    10938--GOTO
