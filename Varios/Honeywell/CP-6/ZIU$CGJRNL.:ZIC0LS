
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:1    
        1        1        /*M* ZIU$CGJRNL - open comgroup and write and delete messages */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        ZIU$CGJRNL: PROC (JRNL$,DCB#) ALTRET;
        9        9
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE XS_MACRO_C;
       12      135        %INCLUDE ZI$JRNL;
       13      243        %INCLUDE ZI_GLOBAL_DBUTIL;
       14      421        %INCLUDE ZI_DBU_ROLL;
       15      505        %F$DCB;
       16      562        %B$TCB;
       17      565        %B$ALT;
       18      573        %ROLL_LIST;
       19      632        %INCLUDE B_ERRORS_C;
       20     1759        %XSA_PARAM (FPTN=FSA,STCLASS=SYMREF);
       21     1789
       22     1790        %FPT_OPEN (FPTN=OPN_CG,ASN=COMGROUP,FUN=UPDATE,SETSTA=CG_STA,
       23     1791         JRNLBYPASS=YES,SHARE=NONE,AU=YES,SN=CGSN);
       24     1900        %VLP_SETSTA (FPTN=CG_STA,MYSTATION='DBUTIL',OSTATION='DBUTIL',OMSGTYP='DBUTIL');
       25     1928        %VLP_SN (FPTN=CGSN,N=1);
       26     1941
       27     1942        %FPT_OPEN (FPTN=OPN_TCG,ASN=FILE,FUN=UPDATE,SETSTA=CG_STA,
       28     1943         AU=YES,TEST=YES,SN=CGSN);
       29     2052
       30     2053        %FPT_WRITE (FPTN=WR_CG);
       31     2084
       32     2085        %VLP_STATION (FPTN=WR_STA,STCLASS=BASED);
       33     2112
       34     2113        %FPT_FWCG (FPTN=REST_CG,CRITERIA=CRIT_CGMA,SCA=SEL_CRIT,
       35     2114         QSELECT=DIRECT,SRA=SEL_REATTR);
       36     2133        %VLP_CGMA (FPTN=CRIT_CGMA,DEST='DBUTIL',MSGTYP='DBUTIL');
       37     2160        %VLP_SCGMA (FPTN=SEL_CRIT,MSGID=YES,MSGTYP=YES,DEST=YES);
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:2    
       38     2177        %VLP_SCGMA (FPTN=SEL_REATTR,MSGTYP=YES,ORIGIN=YES,DEST=YES,PRIO=YES,
       39     2178         UTS=YES,MSGID=YES,MSGIDXT=1,DVE=YES,MSGSIZE=YES,TYC=YES);
       40     2195
       41     2196        %FPT_FWCG (FPTN=DEL_CG,CRITERIA=DEL_CRIT,SCA=DEL_SEL,DELETE=YES);
       42     2215        %VLP_CGMA (FPTN=DEL_CRIT);
       43     2242        %VLP_SCGMA (FPTN=DEL_SEL,MSGID=YES,MSGIDXT=6);
       44     2259
       45     2260        %JRNL_REC (STCLASS=" ");
       46     2335        %SYS_FUNC;
       47     2427        %INCLUDE FM$FIT;
       48     2648        %CODE07(BASED="BASED(FIT$)");
       49     2651        %FM_FITCODE( NAME=FIT_HDR, CODE=1, NAW=1000, NDW=4 );
       50     2654        %FM_FITCODE( NAME=FIT_CODE7, CODE=7, NAW=2, NDW=2 );
       51     2657    1   DCL FILE_INFO(0:1023) BIT(36) SYMREF ALIGNED;
       52     2658    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       53     2659
       54     2660    1   DCL B$TCB$ PTR SYMREF;
       55     2661    1   DCL OPEN_FLAG BIT(1) STATIC ALIGNED INIT('0'B);
       56     2662    1   DCL FIT$ PTR SYMREF ALIGNED;
       57     2663
       58     2664        /* DCL JRNL$ PTR   is in JRNL_REC macro, and is journal record pointer. */
       59     2665    1   DCL DCB# UBIN HALF UNAL; /* DCB number */
       60     2666
       61     2667    1   DCL 1 MSGID BASED,
       62     2668    1         2 ID UBIN,
       63     2669    1         2 XT UBIN;
       64     2670
       65     2671        %ZI$CGMSG (FPTN=CGREC,STCLASS="BASED(JRNL$)");
       66     2708        %ZI$CGDEL (FPTN=CGDEL,STCLASS="BASED(JRNL$)");
       67     2719
       68     2720        /* Open comgroup */
       69     2721
       70     2722    1   ZIU$CGOPN: ENTRY (JRNL$,DCB#) ALTRET;
       71     2723
       72     2724    1       IF DCBADDR(DCB#)->F$DCB.FCD# THEN
       73     2725    1           RETURN;
       74     2726    1       OPN_CG.V.DCB#=DCB#;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:3    
       75     2727    1       OPN_CG.IFPARAM_ = VECTOR(NIL);
       76     2728    1       OPN_CG.FPARAM_ = VECTOR(NIL);
       77     2729    1       OPN_CG.NAME_=VECTOR(FIDLIST.NAME(FIDX));
       78     2730    1       OPN_CG.ACCT_=VECTOR(FIDLIST.ACCNT#(FIDX));
       79     2731    1       OPN_CG.PASS_=VECTOR(FIDLIST.PASS#(FIDX));
       80     2732    1       CGSN.SN#(0)=FIDLIST.PACK#(FIDX);
       81     2733    1       OPEN_FLAG = '1'B;
       82     2734    1       CALL M$OPEN (OPN_CG) ALTRET(CGERR);
       83     2735    1       OPEN_FLAG = '0'B;
       84     2736    1       RETURN;
       85     2737
       86     2738        /* Test Open comgroup   */
       87     2739
       88     2740    1   ZIU$CGTOPN: ENTRY(JRNL$,DCB#) ALTRET;
       89     2741    1       OPN_TCG.V.DCB#=DCB#;
       90     2742    1       OPN_TCG.NAME_=VECTOR(FIDLIST.NAME(FIDX));
       91     2743    1       OPN_TCG.ACCT_=VECTOR(FIDLIST.ACCNT#(FIDX));
       92     2744    1       OPN_TCG.PASS_=VECTOR(FIDLIST.PASS#(FIDX));
       93     2745    1       CGSN.SN#(0)=FIDLIST.PACK#(FIDX);
       94     2746    1       CALL M$OPEN (OPN_TCG) ALTRET(CGERR);
       95     2747    1       RETURN;
       96     2748        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:4    
       97     2749        /* Put message into comgroup with its original attributes.            */
       98     2750
       99     2751    1   ZIU$CGMSG: ENTRY (JRNL$,DCB#) ALTRET;
      100     2752
      101     2753    1       WR_CG.BUF_=VECTOR(CGREC.MESS);
      102     2754    1       WR_CG.BUF_.BOUND=FSA.ARS#-POFFC(ADDR(CGREC.MESS),JRNL$)-1;
      103     2755    1       WR_CG.V.DCB#=DCB#;
      104     2756    1       IF CGREC.CONT THEN
      105     2757    1           WR_CG.V.DVBYTE.CONT#='1'B;
      106     2758    1       ELSE
      107     2759    2       DO;
      108     2760    2           WR_CG.V.DVBYTE.CONT#='0'B;
      109     2761    2           END;
      110     2762
      111     2763    1       CALL M$WRITE (WR_CG) ALTRET(CGERR);
      112     2764
      113     2765    1       REST_CG.REATTR_=VECTOR(CGREC.MSGATTR);
      114     2766    1       IF NOT CGREC.CONT THEN
      115     2767    2       DO;
      116     2768    2           CRIT_CGMA.MSGID#=DCBADDR(DCB#)->F$DCB.LASTSTA$->WR_STA.MSGID#;
      117     2769    2           REST_CG.V.DCB#=DCB#;
      118     2770    2           CALL M$FWCG (REST_CG) ALTRET(CGERR);
      119     2771    2           END;
      120     2772    1       RETURN;
      121     2773        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:5    
      122     2774        /* Delete messages from a Comgroup                                    */
      123     2775
      124     2776    1   ZIU$CGDEL: ENTRY (JRNL$,DCB#) ALTRET;
      125     2777
      126     2778    1       DEL_CG.V.DCB#=DCB#;
      127     2779    1       DEL_CRIT.MSGID#=CGDEL.MSGID.PRIMARY;
      128     2780    1       DEL_CRIT.MSGIDBXT=CGDEL.MSGID.XT;
      129     2781    1       CALL M$FWCG (DEL_CG) ALTRET(CGERR);
      130     2782    1       RETURN;
      131     2783        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:6    
      132     2784        /* Handle ALTRET errors from monitor services by outputting the
      133     2785           message and ALTRETURNing.
      134     2786           Special case for open errors if there was a password. We try to
      135     2787           reopen using the password.
      136     2788        */
      137     2789
      138     2790    1   CGERR: ;
      139     2791    1       IF OPEN_FLAG AND FIDLIST.PASS#(FIDX)~= ' ' THEN
      140     2792    2       DO;
      141     2793    2           OPEN_FLAG = '0'B;
      142     2794    2           FILE_INFO(0) = FIT_HDR;
      143     2795    2           FILE_INFO(1) = FIT_CODE7;
      144     2796    2           FIT$ = ADDR(FILE_INFO(2));
      145     2797    2           CODE07.PASS = FIDLIST.PASS#(FIDX);
      146     2798    2           OPN_CG.IFPARAM_ = VECTOR(FILE_INFO);
      147     2799    2           CALL M$OPEN(OPN_CG) ALTRET(ALT_ERR);
      148     2800    2           RETURN;
      149     2801    2           END;
      150     2802    1   ALT_ERR:
      151     2803    1       DCBSF = DCB#;
      152     2804    1       MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      153     2805    1       INCL_ERR='1'B;
      154     2806    1       CALL SYS_FUNC_ERRMSG;
      155     2807    1       OPEN_FLAG = '0'B;
      156     2808    1       ALTRETURN;
      157     2809        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:7    
      158     2810        /* Delete a message from a comgroup                                   */
      159     2811
      160     2812    1   ZIU$CGCLNUP: ENTRY(JRNL$,DCB#) ALTRET;
      161     2813
      162     2814        /* Called with a MSGID as the first argument.                         */
      163     2815
      164     2816    1       DEL_CG.V.DCB#=DCB#;
      165     2817    1       DEL_CRIT.MSGID#=JRNL$->MSGID.ID;
      166     2818    1       DEL_CRIT.MSGIDBXT=JRNL$->MSGID.XT;
      167     2819    1       CALL M$FWCG (DEL_CG) ALTRET(DELERR);
      168     2820    2       DO WHILE ('0'B);
      169     2821    2   DELERR: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# ~= %E$FWCG_NONE THEN
      170     2822    2               GOTO CGERR;
      171     2823    2           END;
      172     2824    1       RETURN;
      173     2825    1   END;

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:8    
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   XS_MACRO_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$CGJRNL.

   Procedure ZIU$CGJRNL requires 261 words for executable code.
   Procedure ZIU$CGJRNL requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$CGJRNL.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:9    

 Object Unit name= ZIU$CGJRNL                                 File name= ZIU$CGJRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:07:44.84 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   267    413  ZIU$CGJRNL
    2  RoData even  UTS      2      2  ZIU$CGJRNL
    3   Proc  even  none   261    405  ZIU$CGJRNL
    4  RoData even  none    15     17  ZIU$CGJRNL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  ZIU$CGJRNL
     3      3          yes     yes      Std        2  ZIU$CGOPN
     3     75          yes     yes      Std        2  ZIU$CGTOPN
     3    145          yes     yes      Std        2  ZIU$CGMSG
     3    256          yes     yes      Std        2  ZIU$CGDEL
     3    354          yes     yes      Std        2  ZIU$CGCLNUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 SYS_FUNC_ERRMSG
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FID$                                  DCBLIST$
     USER$                                 FID_INDXS$                            FID_INDXS
     NXT_AVIL_FIDSLOT                      NXT_AVIL_DCBSLOT                      LAST_UNUSED_DCBSLOT
     USER                                  NO                                    FIRST
     LAST                                  MAX_DCBINDX                           MAX_FIDINDX
     FIDX                                  DCBX                                  BRK_ROLL
     FSA                                   BLKLSF                                KEYLSF
     KEYXSF                                DCBSF                                 ORGSF
     KEYSF                                 KEYVSF                                ACSSF
     NOTIMESF                              FUNSF                                 ASNSF
     TESTSF                                XTENSIZESF                            DISPSF
     WAITSF                                VFCSF                                 FULLSF
     BKUPSF                                BUFLNSF                               BUFSF
     SOURCESF                              DESTSF                                DATESF
     TIMESF                                UTSSF                                 DAYSF
     TSTAMPSF                              ENCRP_SEEDSF                          ERRCODESF
     MSGCODE                               INCL_ERR                              ERR_INSERT
     FIDSF_RD                              ACNT                                  EXISTSF
     SHARESF                               DCBNMSF                               KEYRSF
     NO_KEYSF                              REASGNSF                              CARRY_ATTRIBUTESF
     SUBMESSF                              SPKY_OPNSF                            POSSF
     ERRFLGSF                              MERGESF                               FSA_FLAG
     RELGSF                                UNUSED                                HELPCODE
     COUNTSF                               INDEXSF                               GAP
     PSNSF                                 ACNTSF                                KEY_SHADWSF
     FILE_INFO                             B$TCB$                                FIT$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:11   


        1        1        /*M* ZIU$CGJRNL - open comgroup and write and delete messages */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        ZIU$CGJRNL: PROC (JRNL$,DCB#) ALTRET;

      8  3 000000   000000 700200 xent  ZIU$CGJRNL   TSX0  ! X66_AUTO_2
         3 000001   000012 000002                    ZERO    10,2
         3 000002   000005 710000 3                  TRA     s:2724

        9        9
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE XS_MACRO_C;
       12      135        %INCLUDE ZI$JRNL;
       13      243        %INCLUDE ZI_GLOBAL_DBUTIL;
       14      421        %INCLUDE ZI_DBU_ROLL;
       15      505        %F$DCB;
       16      562        %B$TCB;
       17      565        %B$ALT;
       18      573        %ROLL_LIST;
       19      632        %INCLUDE B_ERRORS_C;
       20     1759        %XSA_PARAM (FPTN=FSA,STCLASS=SYMREF);
       21     1789
       22     1790        %FPT_OPEN (FPTN=OPN_CG,ASN=COMGROUP,FUN=UPDATE,SETSTA=CG_STA,
       23     1791         JRNLBYPASS=YES,SHARE=NONE,AU=YES,SN=CGSN);
       24     1900        %VLP_SETSTA (FPTN=CG_STA,MYSTATION='DBUTIL',OSTATION='DBUTIL',OMSGTYP='DBUTIL');
       25     1928        %VLP_SN (FPTN=CGSN,N=1);
       26     1941
       27     1942        %FPT_OPEN (FPTN=OPN_TCG,ASN=FILE,FUN=UPDATE,SETSTA=CG_STA,
       28     1943         AU=YES,TEST=YES,SN=CGSN);
       29     2052
       30     2053        %FPT_WRITE (FPTN=WR_CG);
       31     2084
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:12   
       32     2085        %VLP_STATION (FPTN=WR_STA,STCLASS=BASED);
       33     2112
       34     2113        %FPT_FWCG (FPTN=REST_CG,CRITERIA=CRIT_CGMA,SCA=SEL_CRIT,
       35     2114         QSELECT=DIRECT,SRA=SEL_REATTR);
       36     2133        %VLP_CGMA (FPTN=CRIT_CGMA,DEST='DBUTIL',MSGTYP='DBUTIL');
       37     2160        %VLP_SCGMA (FPTN=SEL_CRIT,MSGID=YES,MSGTYP=YES,DEST=YES);
       38     2177        %VLP_SCGMA (FPTN=SEL_REATTR,MSGTYP=YES,ORIGIN=YES,DEST=YES,PRIO=YES,
       39     2178         UTS=YES,MSGID=YES,MSGIDXT=1,DVE=YES,MSGSIZE=YES,TYC=YES);
       40     2195
       41     2196        %FPT_FWCG (FPTN=DEL_CG,CRITERIA=DEL_CRIT,SCA=DEL_SEL,DELETE=YES);
       42     2215        %VLP_CGMA (FPTN=DEL_CRIT);
       43     2242        %VLP_SCGMA (FPTN=DEL_SEL,MSGID=YES,MSGIDXT=6);
       44     2259
       45     2260        %JRNL_REC (STCLASS=" ");
       46     2335        %SYS_FUNC;
       47     2427        %INCLUDE FM$FIT;
       48     2648        %CODE07(BASED="BASED(FIT$)");
       49     2651        %FM_FITCODE( NAME=FIT_HDR, CODE=1, NAW=1000, NDW=4 );
       50     2654        %FM_FITCODE( NAME=FIT_CODE7, CODE=7, NAW=2, NDW=2 );
       51     2657    1   DCL FILE_INFO(0:1023) BIT(36) SYMREF ALIGNED;
       52     2658    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       53     2659
       54     2660    1   DCL B$TCB$ PTR SYMREF;
       55     2661    1   DCL OPEN_FLAG BIT(1) STATIC ALIGNED INIT('0'B);
       56     2662    1   DCL FIT$ PTR SYMREF ALIGNED;
       57     2663
       58     2664        /* DCL JRNL$ PTR   is in JRNL_REC macro, and is journal record pointer. */
       59     2665    1   DCL DCB# UBIN HALF UNAL; /* DCB number */
       60     2666
       61     2667    1   DCL 1 MSGID BASED,
       62     2668    1         2 ID UBIN,
       63     2669    1         2 XT UBIN;
       64     2670
       65     2671        %ZI$CGMSG (FPTN=CGREC,STCLASS="BASED(JRNL$)");
       66     2708        %ZI$CGDEL (FPTN=CGDEL,STCLASS="BASED(JRNL$)");
       67     2719
       68     2720        /* Open comgroup */
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:13   
       69     2721
       70     2722    1   ZIU$CGOPN: ENTRY (JRNL$,DCB#) ALTRET;

   2722  3 000003   000000 700200 xent  ZIU$CGOPN    TSX0  ! X66_AUTO_2
         3 000004   000012 000002                    ZERO    10,2

       71     2723
       72     2724    1       IF DCBADDR(DCB#)->F$DCB.FCD# THEN

   2724  3 000005   000000 470400 4                  LDP0    0
         3 000006   000000 471500                    LDP1    0,,PR0
         3 000007   200004 473500                    LDP3    @DCB#,,AUTO
         3 000010   003100 060500                    CSL     bolr='003'O
         3 000011   300000 000022                    BDSC    0,,PR3                   by=0,bit=0,n=18
         3 000012   200006 000044                    BDSC    @DCB#+2,,AUTO            by=0,bit=0,n=36
         3 000013   200006 220100                    LDX0    @DCB#+2,,AUTO
         3 000014   100000 474510                    LDP4    0,X0,PR1
         3 000015   400031 236100                    LDQ     25,,PR4
         3 000016   020000 316007                    CANQ    8192,DL
         3 000017   000021 600000 3                  TZE     s:2726

       73     2725    1           RETURN;

   2725  3 000020   000000 702200 xent               TSX2  ! X66_ARET

       74     2726    1       OPN_CG.V.DCB#=DCB#;

   2726  3 000021   003000 060500                    CSL     bolr='003'O
         3 000022   300000 000022                    BDSC    0,,PR3                   by=0,bit=0,n=18
         3 000023   000044 000022 1                  BDSC    OPN_CG+36                by=0,bit=0,n=18

       75     2727    1       OPN_CG.IFPARAM_ = VECTOR(NIL);

   2727  3 000024   000002 237000 4                  LDAQ    2
         3 000025   000026 757000 1                  STAQ    OPN_CG+22

       76     2728    1       OPN_CG.FPARAM_ = VECTOR(NIL);
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:14   

   2728  3 000026   000002 237000 4                  LDAQ    2
         3 000027   000030 757000 1                  STAQ    OPN_CG+24

       77     2729    1       OPN_CG.NAME_=VECTOR(FIDLIST.NAME(FIDX));

   2729  3 000030   000004 235000 4                  LDA     4
         3 000031   000000 236000 xsym               LDQ     FIDX
         3 000032   200006 755100                    STA     @DCB#+2,,AUTO
         3 000033   000021 402003                    MPY     17,DU
         3 000034   000000 036000 xsym               ADLQ    FID$
         3 000035   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000036   000006 757000 1                  STAQ    OPN_CG+6

       78     2730    1       OPN_CG.ACCT_=VECTOR(FIDLIST.ACCNT#(FIDX));

   2730  3 000037   000005 235000 4                  LDA     5
         3 000040   000000 236000 xsym               LDQ     FIDX
         3 000041   200006 755100                    STA     @DCB#+2,,AUTO
         3 000042   000021 402003                    MPY     17,DU
         3 000043   000010 036003                    ADLQ    8,DU
         3 000044   000000 036000 xsym               ADLQ    FID$
         3 000045   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000046   000024 757000 1                  STAQ    OPN_CG+20

       79     2731    1       OPN_CG.PASS_=VECTOR(FIDLIST.PASS#(FIDX));

   2731  3 000047   000005 235000 4                  LDA     5
         3 000050   000000 236000 xsym               LDQ     FIDX
         3 000051   200006 755100                    STA     @DCB#+2,,AUTO
         3 000052   000021 402003                    MPY     17,DU
         3 000053   000012 036003                    ADLQ    10,DU
         3 000054   000000 036000 xsym               ADLQ    FID$
         3 000055   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000056   000010 757000 1                  STAQ    OPN_CG+8

       80     2732    1       CGSN.SN#(0)=FIDLIST.PACK#(FIDX);
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:15   

   2732  3 000057   000000 236000 xsym               LDQ     FIDX
         3 000060   000104 402007                    MPY     68,DL
         3 000061   000000 474400 xsym               LDP4    FID$
         3 000062   040000 100506                    MLR     fill='040'O
         3 000063   400014 000006                    ADSC9   12,Q,PR4                 cn=0,n=6
         3 000064   000107 000006 1                  ADSC9   CGSN+1                   cn=0,n=6

       81     2733    1       OPEN_FLAG = '1'B;

   2733  3 000065   400000 236003                    LDQ     -131072,DU
         3 000066   000412 756000 1                  STQ     OPEN_FLAG

       82     2734    1       CALL M$OPEN (OPN_CG) ALTRET(CGERR);

   2734  3 000067   000000 630400 1                  EPPR0   OPN_CG
         3 000070   450000 713400                    CLIMB   alt,open
         3 000071   410400 401760                    pmme    nvectors=18
         3 000072   000300 702000 3                  TSX2    CGERR

       83     2735    1       OPEN_FLAG = '0'B;

   2735  3 000073   000412 450000 1                  STZ     OPEN_FLAG

       84     2736    1       RETURN;

   2736  3 000074   000000 702200 xent               TSX2  ! X66_ARET

       85     2737
       86     2738        /* Test Open comgroup   */
       87     2739
       88     2740    1   ZIU$CGTOPN: ENTRY(JRNL$,DCB#) ALTRET;

   2740  3 000075   000000 700200 xent  ZIU$CGTOPN   TSX0  ! X66_AUTO_2
         3 000076   000012 000002                    ZERO    10,2

       89     2741    1       OPN_TCG.V.DCB#=DCB#;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:16   

   2741  3 000077   200004 470500                    LDP0    @DCB#,,AUTO
         3 000100   003000 060500                    CSL     bolr='003'O
         3 000101   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000102   000156 000022 1                  BDSC    OPN_TCG+36               by=0,bit=0,n=18

       90     2742    1       OPN_TCG.NAME_=VECTOR(FIDLIST.NAME(FIDX));

   2742  3 000103   000004 235000 4                  LDA     4
         3 000104   000000 236000 xsym               LDQ     FIDX
         3 000105   200006 755100                    STA     @DCB#+2,,AUTO
         3 000106   000021 402003                    MPY     17,DU
         3 000107   000000 036000 xsym               ADLQ    FID$
         3 000110   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000111   000120 757000 1                  STAQ    OPN_TCG+6

       91     2743    1       OPN_TCG.ACCT_=VECTOR(FIDLIST.ACCNT#(FIDX));

   2743  3 000112   000005 235000 4                  LDA     5
         3 000113   000000 236000 xsym               LDQ     FIDX
         3 000114   200006 755100                    STA     @DCB#+2,,AUTO
         3 000115   000021 402003                    MPY     17,DU
         3 000116   000010 036003                    ADLQ    8,DU
         3 000117   000000 036000 xsym               ADLQ    FID$
         3 000120   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000121   000136 757000 1                  STAQ    OPN_TCG+20

       92     2744    1       OPN_TCG.PASS_=VECTOR(FIDLIST.PASS#(FIDX));

   2744  3 000122   000005 235000 4                  LDA     5
         3 000123   000000 236000 xsym               LDQ     FIDX
         3 000124   200006 755100                    STA     @DCB#+2,,AUTO
         3 000125   000021 402003                    MPY     17,DU
         3 000126   000012 036003                    ADLQ    10,DU
         3 000127   000000 036000 xsym               ADLQ    FID$
         3 000130   200006 235100                    LDA     @DCB#+2,,AUTO
         3 000131   000122 757000 1                  STAQ    OPN_TCG+8
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:17   

       93     2745    1       CGSN.SN#(0)=FIDLIST.PACK#(FIDX);

   2745  3 000132   000000 236000 xsym               LDQ     FIDX
         3 000133   000104 402007                    MPY     68,DL
         3 000134   000000 471400 xsym               LDP1    FID$
         3 000135   040000 100506                    MLR     fill='040'O
         3 000136   100014 000006                    ADSC9   12,Q,PR1                 cn=0,n=6
         3 000137   000107 000006 1                  ADSC9   CGSN+1                   cn=0,n=6

       94     2746    1       CALL M$OPEN (OPN_TCG) ALTRET(CGERR);

   2746  3 000140   000112 630400 1                  EPPR0   OPN_TCG
         3 000141   450000 713400                    CLIMB   alt,open
         3 000142   410400 401760                    pmme    nvectors=18
         3 000143   000300 702000 3                  TSX2    CGERR

       95     2747    1       RETURN;

   2747  3 000144   000000 702200 xent               TSX2  ! X66_ARET

       96     2748        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:18   
       97     2749        /* Put message into comgroup with its original attributes.            */
       98     2750
       99     2751    1   ZIU$CGMSG: ENTRY (JRNL$,DCB#) ALTRET;

   2751  3 000145   000000 700200 xent  ZIU$CGMSG    TSX0  ! X66_AUTO_2
         3 000146   000012 000002                    ZERO    10,2

      100     2752
      101     2753    1       WR_CG.BUF_=VECTOR(CGREC.MESS);

   2753  3 000147   200003 470500                    LDP0    @JRNL$,,AUTO
         3 000150   000000 471500                    LDP1    0,,PR0
         3 000151   000006 235000 4                  LDA     6
         3 000152   200006 451500                    STP1    @DCB#+2,,AUTO
         3 000153   200006 236100                    LDQ     @DCB#+2,,AUTO
         3 000154   000023 036003                    ADLQ    19,DU
         3 000155   000210 757000 1                  STAQ    WR_CG+4

      102     2754    1       WR_CG.BUF_.BOUND=FSA.ARS#-POFFC(ADDR(CGREC.MESS),JRNL$)-1;

   2754  3 000156   000000 471500                    LDP1    0,,PR0
         3 000157   200006 451500                    STP1    @DCB#+2,,AUTO
         3 000160   200006 236100                    LDQ     @DCB#+2,,AUTO
         3 000161   000023 036003                    ADLQ    19,DU
         3 000162   000020 772000                    QRL     16
         3 000163   200007 756100                    STQ     @DCB#+3,,AUTO
         3 000164   000000 236100                    LDQ     0,,PR0
         3 000165   000020 772000                    QRL     16
         3 000166   200010 756100                    STQ     @DCB#+4,,AUTO
         3 000167   200007 236100                    LDQ     @DCB#+3,,AUTO
         3 000170   200010 136100                    SBLQ    @DCB#+4,,AUTO
         3 000171   200011 756100                    STQ     @DCB#+5,,AUTO
         3 000172   000000 236000 xsym               LDQ     FSA
         3 000173   200011 136100                    SBLQ    @DCB#+5,,AUTO
         3 000174   000001 136007                    SBLQ    1,DL
         3 000175   000020 736000                    QLS     16
         3 000176   000210 676000 1                  ERQ     WR_CG+4
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:19   
         3 000177   000007 376000 4                  ANQ     7
         3 000200   000210 656000 1                  ERSQ    WR_CG+4

      103     2755    1       WR_CG.V.DCB#=DCB#;

   2755  3 000201   200004 471500                    LDP1    @DCB#,,AUTO
         3 000202   003000 060500                    CSL     bolr='003'O
         3 000203   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         3 000204   000214 000022 1                  BDSC    WR_CG+8                  by=0,bit=0,n=18

      104     2756    1       IF CGREC.CONT THEN

   2756  3 000205   000000 473500                    LDP3    0,,PR0
         3 000206   300002 234100                    SZN     2,,PR3
         3 000207   000213 605000 3                  TPL     s:2760

      105     2757    1           WR_CG.V.DVBYTE.CONT#='1'B;

   2757  3 000210   001000 236003                    LDQ     512,DU
         3 000211   000217 256000 1                  ORSQ    WR_CG+11
         3 000212   000215 710000 3                  TRA     s:2763

      106     2758    1       ELSE
      107     2759    2       DO;

      108     2760    2           WR_CG.V.DVBYTE.CONT#='0'B;

   2760  3 000213   000010 236000 4                  LDQ     8
         3 000214   000217 356000 1                  ANSQ    WR_CG+11

      109     2761    2           END;

      110     2762
      111     2763    1       CALL M$WRITE (WR_CG) ALTRET(CGERR);

   2763  3 000215   000204 630400 1                  EPPR0   WR_CG
         3 000216   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:20   
         3 000217   401400 401760                    pmme    nvectors=4
         3 000220   000300 702000 3                  TSX2    CGERR

      112     2764
      113     2765    1       REST_CG.REATTR_=VECTOR(CGREC.MSGATTR);

   2765  3 000221   200003 470500                    LDP0    @JRNL$,,AUTO
         3 000222   000000 471500                    LDP1    0,,PR0
         3 000223   000011 235000 4                  LDA     9
         3 000224   200006 451500                    STP1    @DCB#+2,,AUTO
         3 000225   200006 236100                    LDQ     @DCB#+2,,AUTO
         3 000226   000003 036003                    ADLQ    3,DU
         3 000227   000224 757000 1                  STAQ    REST_CG+4

      114     2766    1       IF NOT CGREC.CONT THEN

   2766  3 000230   000000 471500                    LDP1    0,,PR0
         3 000231   100002 234100                    SZN     2,,PR1
         3 000232   000255 604000 3                  TMI     s:2772

      115     2767    2       DO;

      116     2768    2           CRIT_CGMA.MSGID#=DCBADDR(DCB#)->F$DCB.LASTSTA$->WR_STA.MSGID#;

   2768  3 000233   000000 473400 4                  LDP3    0
         3 000234   300000 474500                    LDP4    0,,PR3
         3 000235   200004 475500                    LDP5    @DCB#,,AUTO
         3 000236   003100 060500                    CSL     bolr='003'O
         3 000237   500000 000022                    BDSC    0,,PR5                   by=0,bit=0,n=18
         3 000240   200006 000044                    BDSC    @DCB#+2,,AUTO            by=0,bit=0,n=36
         3 000241   200006 220100                    LDX0    @DCB#+2,,AUTO
         3 000242   400000 471510                    LDP1    0,X0,PR4
         3 000243   100007 476500                    LDP6    7,,PR1
         3 000244   600005 235100                    LDA     5,,PR6
         3 000245   000306 755000 1                  STA     CRIT_CGMA+12

      117     2769    2           REST_CG.V.DCB#=DCB#;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:21   

   2769  3 000246   003000 060500                    CSL     bolr='003'O
         3 000247   500000 000022                    BDSC    0,,PR5                   by=0,bit=0,n=18
         3 000250   000254 000022 1                  BDSC    REST_CG+28               by=0,bit=0,n=18

      118     2770    2           CALL M$FWCG (REST_CG) ALTRET(CGERR);

   2770  3 000251   000220 630400 1                  EPPR0   REST_CG
         3 000252   500005 713400                    CLIMB   alt,+32773
         3 000253   406400 401760                    pmme    nvectors=14
         3 000254   000300 702000 3                  TSX2    CGERR

      119     2771    2           END;

      120     2772    1       RETURN;

   2772  3 000255   000000 702200 xent               TSX2  ! X66_ARET

      121     2773        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:22   
      122     2774        /* Delete messages from a Comgroup                                    */
      123     2775
      124     2776    1   ZIU$CGDEL: ENTRY (JRNL$,DCB#) ALTRET;

   2776  3 000256   000000 700200 xent  ZIU$CGDEL    TSX0  ! X66_AUTO_2
         3 000257   000012 000002                    ZERO    10,2

      125     2777
      126     2778    1       DEL_CG.V.DCB#=DCB#;

   2778  3 000260   200004 470500                    LDP0    @DCB#,,AUTO
         3 000261   003000 060500                    CSL     bolr='003'O
         3 000262   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000263   000352 000022 1                  BDSC    DEL_CG+28                by=0,bit=0,n=18

      127     2779    1       DEL_CRIT.MSGID#=CGDEL.MSGID.PRIMARY;

   2779  3 000264   200003 471500                    LDP1    @JRNL$,,AUTO
         3 000265   100000 473500                    LDP3    0,,PR1
         3 000266   300002 235100                    LDA     2,,PR3
         3 000267   000404 755000 1                  STA     DEL_CRIT+12

      128     2780    1       DEL_CRIT.MSGIDBXT=CGDEL.MSGID.XT;

   2780  3 000270   100000 473500                    LDP3    0,,PR1
         3 000271   300003 235100                    LDA     3,,PR3
         3 000272   000405 755000 1                  STA     DEL_CRIT+13

      129     2781    1       CALL M$FWCG (DEL_CG) ALTRET(CGERR);

   2781  3 000273   000316 630400 1                  EPPR0   DEL_CG
         3 000274   500005 713400                    CLIMB   alt,+32773
         3 000275   406400 401760                    pmme    nvectors=14
         3 000276   000300 702000 3                  TSX2    CGERR

      130     2782    1       RETURN;

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:23   
   2782  3 000277   000000 702200 xent               TSX2  ! X66_ARET

   2780  3 000300                       CGERR        null
      131     2783        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:24   
      132     2784        /* Handle ALTRET errors from monitor services by outputting the
      133     2785           message and ALTRETURNing.
      134     2786           Special case for open errors if there was a password. We try to
      135     2787           reopen using the password.
      136     2788        */
      137     2789
      138     2790    1   CGERR: ;
      139     2791    1       IF OPEN_FLAG AND FIDLIST.PASS#(FIDX)~= ' ' THEN

   2791  3 000300   000412 234000 1                  SZN     OPEN_FLAG
         3 000301   000335 605000 3                  TPL     ALT_ERR
         3 000302   000000 236000 xsym               LDQ     FIDX
         3 000303   000104 402007                    MPY     68,DL
         3 000304   000000 470400 xsym               LDP0    FID$
         3 000305   040000 106506                    CMPC    fill='040'O
         3 000306   000012 000010                    ADSC9   10,Q,PR0                 cn=0,n=8
         3 000307   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000310   000335 600000 3                  TZE     ALT_ERR

      140     2792    2       DO;

      141     2793    2           OPEN_FLAG = '0'B;

   2793  3 000311   000412 450000 1                  STZ     OPEN_FLAG

      142     2794    2           FILE_INFO(0) = FIT_HDR;

   2794  3 000312   000000 236000 2                  LDQ     FIT_HDR
         3 000313   000000 756000 xsym               STQ     FILE_INFO

      143     2795    2           FILE_INFO(1) = FIT_CODE7;

   2795  3 000314   000001 236000 2                  LDQ     FIT_CODE7
         3 000315   000001 756000 xsym               STQ     FILE_INFO+1

      144     2796    2           FIT$ = ADDR(FILE_INFO(2));

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:25   
   2796  3 000316   000013 236000 4                  LDQ     11
         3 000317   000000 756000 xsym               STQ     FIT$

      145     2797    2           CODE07.PASS = FIDLIST.PASS#(FIDX);

   2797  3 000320   000000 236000 xsym               LDQ     FIDX
         3 000321   000104 402007                    MPY     68,DL
         3 000322   000000 471400 xsym               LDP1    FIT$
         3 000323   040100 100506                    MLR     fill='040'O
         3 000324   000012 000010                    ADSC9   10,Q,PR0                 cn=0,n=8
         3 000325   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      146     2798    2           OPN_CG.IFPARAM_ = VECTOR(FILE_INFO);

   2798  3 000326   000014 237000 4                  LDAQ    12
         3 000327   000026 757000 1                  STAQ    OPN_CG+22

      147     2799    2           CALL M$OPEN(OPN_CG) ALTRET(ALT_ERR);

   2799  3 000330   000000 630400 1                  EPPR0   OPN_CG
         3 000331   450000 713400                    CLIMB   alt,open
         3 000332   410400 401760                    pmme    nvectors=18
         3 000333   000335 702000 3                  TSX2    ALT_ERR

      148     2800    2           RETURN;

   2800  3 000334   000000 702200 xent               TSX2  ! X66_ARET

      149     2801    2           END;
      150     2802    1   ALT_ERR:
      151     2803    1       DCBSF = DCB#;

   2803  3 000335   200004 470500       ALT_ERR      LDP0    @DCB#,,AUTO
         3 000336   003000 060500                    CSL     bolr='003'O
         3 000337   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000340   000000 000022 xsym               BDSC    DCBSF                    by=0,bit=0,n=18

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:26   
      152     2804    1       MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   2804  3 000341   000000 471400 xsym               LDP1    B$TCB$
         3 000342   100000 473500                    LDP3    0,,PR1
         3 000343   300102 236100                    LDQ     66,,PR3
         3 000344   000000 756000 xsym               STQ     MSGCODE

      153     2805    1       INCL_ERR='1'B;

   2805  3 000345   400000 236003                    LDQ     -131072,DU
         3 000346   000000 756000 xsym               STQ     INCL_ERR

      154     2806    1       CALL SYS_FUNC_ERRMSG;

   2806  3 000347   000016 631400 4                  EPPR1   14
         3 000350   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         3 000351   000000 011000                    NOP     0

      155     2807    1       OPEN_FLAG = '0'B;

   2807  3 000352   000412 450000 1                  STZ     OPEN_FLAG

      156     2808    1       ALTRETURN;

   2808  3 000353   000000 702200 xent               TSX2  ! X66_AALT

      157     2809        %EJECT;
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:27   
      158     2810        /* Delete a message from a comgroup                                   */
      159     2811
      160     2812    1   ZIU$CGCLNUP: ENTRY(JRNL$,DCB#) ALTRET;

   2812  3 000354   000000 700200 xent  ZIU$CGCLNUP  TSX0  ! X66_AUTO_2
         3 000355   000012 000002                    ZERO    10,2

      161     2813
      162     2814        /* Called with a MSGID as the first argument.                         */
      163     2815
      164     2816    1       DEL_CG.V.DCB#=DCB#;

   2816  3 000356   200004 470500                    LDP0    @DCB#,,AUTO
         3 000357   003000 060500                    CSL     bolr='003'O
         3 000360   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000361   000352 000022 1                  BDSC    DEL_CG+28                by=0,bit=0,n=18

      165     2817    1       DEL_CRIT.MSGID#=JRNL$->MSGID.ID;

   2817  3 000362   200003 471500                    LDP1    @JRNL$,,AUTO
         3 000363   100000 473500                    LDP3    0,,PR1
         3 000364   300000 235100                    LDA     0,,PR3
         3 000365   000404 755000 1                  STA     DEL_CRIT+12

      166     2818    1       DEL_CRIT.MSGIDBXT=JRNL$->MSGID.XT;

   2818  3 000366   100000 473500                    LDP3    0,,PR1
         3 000367   300001 235100                    LDA     1,,PR3
         3 000370   000405 755000 1                  STA     DEL_CRIT+13

      167     2819    1       CALL M$FWCG (DEL_CG) ALTRET(DELERR);

   2819  3 000371   000316 630400 1                  EPPR0   DEL_CG
         3 000372   500005 713400                    CLIMB   alt,+32773
         3 000373   406400 401760                    pmme    nvectors=14
         3 000374   000376 702000 3                  TSX2    DELERR

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:28   
      168     2820    2       DO WHILE ('0'B);

   2820  3 000375   000404 710000 3                  TRA     s:2824

      169     2821    2   DELERR: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# ~= %E$FWCG_NONE THEN

   2821  3 000376   000000 470400 xsym  DELERR       LDP0    B$TCB$
         3 000377   000000 471500                    LDP1    0,,PR0
         3 000400   100102 236100                    LDQ     66,,PR1
         3 000401   377770 376007                    ANQ     131064,DL
         3 000402   022220 116007                    CMPQ    9360,DL
         3 000403   000300 601000 3                  TNZ     CGERR

      170     2822    2               GOTO CGERR;
      171     2823    2           END;

      172     2824    1       RETURN;

   2824  3 000404   000000 702200 xent               TSX2  ! X66_ARET

OPN_CG
 Sect OctLoc
   1     000   000025 777640   000044 006000   000003 777640   000106 006000    .....$.......F..
   1     004   000013 777640   000072 006000   000000 177640   000000 006014    .....:..........
   1     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     044*  000000 000072   000000 001004   252525 000000   000040 252540    ...:......... ..
   1     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     060   251000 622000   000000 000000   000000 000000   111310 000000    ............I...
   1     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     070   000000 000000   ****** ******                                    ........

CG_STA
 Sect OctLoc
   1     072   104102 125124   111114 040040   040040 040040   040040 040040    DBUTIL
   1     076   040040 040040   040040 040040   000000 000000   104102 125124            ....DBUT
   1     102   111114 040040   104102 125124   111114 040040   000000 000000    IL  DBUTIL  ....
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:29   

CGSN
 Sect OctLoc
   1     106   000000 000001   040040 040040   040040 ******                    ....      ..

OPN_TCG
 Sect OctLoc
   1     112   000025 777640   000156 006000   000003 777640   000106 006000    .....n.......F..
   1     116   000013 777640   000072 006000   000000 177640   000000 006014    .....:..........
   1     122   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     156*  000000 020042   000000 001001   252525 000000   000040 252520    ..."......... ..
   1     162   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     166   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     172   251000 622000   000000 000000   000000 000000   111310 000000    ............I...
   1     176   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     202   000000 000000   ****** ******                                    ........

WR_CG
 Sect OctLoc
   1     204   000003 777640   000214 006000   000000 177640   000000 006014    ................
   1     210   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     214   000000 400400   000000 000000   000000 000000   000000 000000    ................

REST_CG
 Sect OctLoc
   1     220   000015 777640   000254 006000   000017 777640   000272 006000    ................
   1     224   000000 177640   000000 006014   000001 777640   000312 006000    ................
   1     230   000001 777640   000314 006000   000000 177640   000000 006014    ................
   1     234   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     254*  000000 000000   040000 000000   000000 000000   000000 000000    .... ...........
   1     260   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     270*  000000 000000   000000 000000                                    ........

CRIT_CGMA
 Sect OctLoc
   1     272   000000 000000   000000 000000   104102 125124   111114 040040    ........DBUTIL
   1     276   077040 040040   040040 040040   000000 000000   000000 000000    ?       ........
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:30   
   1     302   000000 000000   104102 125124   111114 040040   000000 000000    ....DBUTIL  ....
   1     306   000000 000000   000000 000000   000000 000000   000000 000000    ................

SEL_CRIT
 Sect OctLoc
   1     312   510000 000000   000000 000000                                    ........

SEL_REATTR
 Sect OctLoc
   1     314   777001 000000   000000 000000                                    ........

DEL_CG
 Sect OctLoc
   1     316   000015 777640   000352 006000   000017 777640   000370 006000    ................
   1     322   000000 177640   000000 006014   000001 777640   000410 006000    ................
   1     326   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     352*  000000 000000   420000 000000   000000 000000   000000 000000    ................
   1     356   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     366*  000000 000000   000000 000000                                    ........

DEL_CRIT
 Sect OctLoc
   1     370   000000 000000   000000 000000   077040 040040   040040 040040    ........?
   1     374   077040 040040   040040 040040   000000 000000   000000 000000    ?       ........
   1     400   000000 000000   077040 040040   040040 040040   000000 000000    ....?       ....
   1     404   000000 000000   000000 000000   000000 000000   000000 000000    ................

DEL_SEL
 Sect OctLoc
   1     410   010006 000000   000000 000000                                    ........

OPEN_FLAG
 Sect OctLoc
   1     412   0***** ******                                                    ....

FIT_HDR
 Sect OctLoc
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:31   
   2     000   027640 010000                                                    ....

FIT_CODE7
 Sect OctLoc
   2     001   160010 004000                                                    p...

(unnamed)
 Sect OctLoc
   4     000   000000 006003   000000 000000   000000 177640   000000 006014    ................
   4     004   000007 777640   000001 777640   001747 777640   777777 600000    ................
   4     010   776777 777777   000017 777640   040040 040040   000002 006000    ........    ....
   4     014   001777 777640   000000 006000   000000 000000                    ............
      173     2825    1   END;

PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:32   
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   XS_MACRO_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$CGJRNL.

   Procedure ZIU$CGJRNL requires 261 words for executable code.
   Procedure ZIU$CGJRNL requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$CGJRNL.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:33   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:34   
          MINI XREF LISTING

ALT_ERR
      2803**LABEL    2799--CALLALT
B$ALT.CODE
       567**DCL       567--REDEF     568--REDEF     568--REDEF
B$ALT.ERR
       568**DCL      2804>>ASSIGN
B$ALT.ERR.ERR#
       569**DCL       569--REDEF    2821>>IF
B$ALT.EVID
       568**DCL       568--REDEF     568--REDEF
B$TCB.ALT$
       563**DCL      2804>>ASSIGN   2821>>IF
B$TCB$
      2660**DCL      2804>>ASSIGN   2821>>IF
BERC.DCB#
      2303**DCL      2304--REDEF
CGDEL.MSGID.PRIMARY
      2715**DCL      2779>>ASSIGN
CGDEL.MSGID.XT
      2716**DCL      2780>>ASSIGN
CGERR
      2780**LABEL    2734--CALLALT  2746--CALLALT  2763--CALLALT  2770--CALLALT  2781--CALLALT  2822--GOTO
CGREC.CONT
      2678**DCL      2756>>IF       2766>>IF
CGREC.MESS
      2706**DCL      2753--ASSIGN   2754--ASSIGN
CGREC.MSGATTR
      2693**DCL      2765--ASSIGN
CGREC.MSGATTR.MSGIDXT
      2700**DCL      2703--REDEF
CGSN
      1939**DCL      1856--DCLINIT  2008--DCLINIT
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:35   
CGSN.SN#
      1939**DCL      2732<<ASSIGN   2745<<ASSIGN
CG_STA
      1912**DCL      1857--DCLINIT  2009--DCLINIT
CODE07.PASS
      2649**DCL      2797<<ASSIGN
COUNTSF
      2416**DCL      2417--REDEF
CRIT_CGMA
      2145**DCL      2125--DCLINIT
CRIT_CGMA.MSGID#
      2153**DCL      2768<<ASSIGN
CRIT_CGMA.MSGIDXT
      2154**DCL      2157--REDEF
DCB#
      2665**DCL         8--PROC     2722--ENTRY    2724--IF       2726>>ASSIGN   2740--ENTRY    2741>>ASSIGN
      2751--ENTRY    2755>>ASSIGN   2768--ASSIGN   2769>>ASSIGN   2776--ENTRY    2778>>ASSIGN   2803>>ASSIGN
      2812--ENTRY    2816>>ASSIGN
DCBLIST$
       581**DCL       604--IMP-PTR
DCBSF
      2345**DCL      2803<<ASSIGN
DELERR
      2821**LABEL    2819--CALLALT
DEL_CG
      2207**DCL      2781<>CALL     2819<>CALL
DEL_CG.V
      2210**DCL      2207--DCLINIT
DEL_CG.V.DCB#
      2210**DCL      2778<<ASSIGN   2816<<ASSIGN
DEL_CRIT
      2227**DCL      2207--DCLINIT
DEL_CRIT.MSGID#
      2235**DCL      2779<<ASSIGN   2817<<ASSIGN
DEL_CRIT.MSGIDBXT
      2239**DCL      2780<<ASSIGN   2818<<ASSIGN
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:36   
DEL_CRIT.MSGIDXT
      2236**DCL      2239--REDEF
DEL_SEL
      2253**DCL      2208--DCLINIT
ENCRP_SEEDSF
      2374**DCL      2375--REDEF
ERRCODESF
      2376**DCL      2381--REDEF
F$DCB.ACTPOS
       538**DCL       538--REDEF
F$DCB.ARS#
       512**DCL       512--REDEF
F$DCB.ATTR
       531**DCL       532--REDEF
F$DCB.BORROW
       546**DCL       546--REDEF     546--REDEF     546--REDEF
F$DCB.DCBNAME.L
       560**DCL       560--IMP-SIZ
F$DCB.EOMCHAR#
       516**DCL       516--REDEF
F$DCB.FCD#
       525**DCL      2724>>IF
F$DCB.FLDID
       541**DCL       541--REDEF
F$DCB.FORM$
       535**DCL       535--REDEF
F$DCB.FSECT
       551**DCL       551--REDEF
F$DCB.FSN#
       528**DCL       528--REDEF     528--REDEF     529--REDEF
F$DCB.HEADER$
       534**DCL       534--REDEF
F$DCB.IXTNSIZE#
       532**DCL       532--REDEF
F$DCB.LASTSTA$
       521**DCL       521--REDEF    2768>>ASSIGN
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:37   
F$DCB.LVL
       547**DCL       547--REDEF
F$DCB.NAME#.C
       522**DCL       522--REDEF
F$DCB.NOEOF
       544**DCL       544--REDEF
F$DCB.NRECS#
       533**DCL       533--REDEF
F$DCB.NRECX
       552**DCL       552--REDEF
F$DCB.OHDR
       544**DCL       544--REDEF
F$DCB.ORG#
       527**DCL       527--REDEF
F$DCB.PRECNO
       550**DCL       550--REDEF
F$DCB.RCSZ
       556**DCL       556--REDEF
F$DCB.RES#
       523**DCL       523--REDEF
F$DCB.SETX
       535**DCL       535--REDEF
F$DCB.TAB$
       535**DCL       535--REDEF
F$DCB.TDA
       549**DCL       550--REDEF
F$DCB.WSN#
       523**DCL       523--REDEF
FID$
       580**DCL       584--IMP-PTR  2729>>ASSIGN   2730>>ASSIGN   2731>>ASSIGN   2732>>ASSIGN   2742>>ASSIGN
      2743>>ASSIGN   2744>>ASSIGN   2745>>ASSIGN   2791>>IF       2797>>ASSIGN
FIDLIST.ACCNT#
       588**DCL      2730--ASSIGN   2743--ASSIGN
FIDLIST.CRPT
       593**DCL       594--REDEF
FIDLIST.NAME
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:38   
       585**DCL      2729--ASSIGN   2742--ASSIGN
FIDLIST.PACK#
       590**DCL      2732>>ASSIGN   2745>>ASSIGN
FIDLIST.PASS#
       589**DCL      2731--ASSIGN   2744--ASSIGN   2791>>IF       2797>>ASSIGN
FIDSF_RD
      2392**DCL      2393--REDEF
FIDX
       628**DCL      2729>>ASSIGN   2730>>ASSIGN   2731>>ASSIGN   2732>>ASSIGN   2742>>ASSIGN   2743>>ASSIGN
      2744>>ASSIGN   2745>>ASSIGN   2791>>IF       2797>>ASSIGN
FILE_INFO
      2657**DCL      2794<<ASSIGN   2795<<ASSIGN   2796--ASSIGN   2798--ASSIGN
FIT$
      2662**DCL      2649--IMP-PTR  2796<<ASSIGN   2797>>ASSIGN
FIT_CODE7
      2655**DCL      2795>>ASSIGN
FIT_HDR
      2652**DCL      2794>>ASSIGN
FSA.ARS#
      1771**DCL      2754>>ASSIGN
FSA.EOMCHAR#
      1783**DCL      1784--REDEF
FSA.SIG1
      1777**DCL      1777--REDEF
FSA.SIG2
      1777**DCL      1778--REDEF
HELPCODE
      2410**DCL      2415--REDEF
INCL_ERR
      2388**DCL      2805<<ASSIGN
JREC.LENGTH
      2288**DCL      2291--IMP-SIZ
JRNL$
      2261**DCL         8--PROC     2262--IMP-PTR  2282--IMP-PTR  2292--IMP-PTR  2299--IMP-PTR  2305--IMP-PTR
      2673--IMP-PTR  2709--IMP-PTR  2722--ENTRY    2740--ENTRY    2751--ENTRY    2753>>ASSIGN   2754>>ASSIGN
      2754>>ASSIGN   2756>>IF       2765>>ASSIGN   2766>>IF       2776--ENTRY    2779>>ASSIGN   2780>>ASSIGN
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:39   
      2812--ENTRY    2817>>ASSIGN   2818>>ASSIGN
KEYVSF
      2348**DCL      2353--REDEF
KEYVSF.WD_ONE
      2350**DCL      2351--REDEF
M$FWCG
        40**DCL-ENT  2770--CALL     2781--CALL     2819--CALL
M$OPEN
        19**DCL-ENT  2734--CALL     2746--CALL     2799--CALL
M$WRITE
        20**DCL-ENT  2763--CALL
MONITOR_ERR
      2383**DCL      2804<<ASSIGN
MSGCODE
      2382**DCL      2383--REDEF
MSGID.ID
      2668**DCL      2817>>ASSIGN
MSGID.XT
      2669**DCL      2818>>ASSIGN
OPEN_FLAG
      2661**DCL      2733<<ASSIGN   2735<<ASSIGN   2791>>IF       2793<<ASSIGN   2807<<ASSIGN
OPN_CG
      1856**DCL      2734<>CALL     2799<>CALL
OPN_CG.ACCT_
      1860**DCL      2730<<ASSIGN
OPN_CG.ACSVEH_
      1858**DCL      1859--REDEF
OPN_CG.ALTKEYS_
      1864**DCL      1865--REDEF    1865--REDEF
OPN_CG.FPARAM_
      1861**DCL      2728<<ASSIGN
OPN_CG.HDR_
      1863**DCL      1864--REDEF
OPN_CG.IFPARAM_
      1861**DCL      2727<<ASSIGN   2798<<ASSIGN
OPN_CG.NAME_
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:40   
      1857**DCL      2729<<ASSIGN
OPN_CG.PASS_
      1858**DCL      2731<<ASSIGN
OPN_CG.TAB_
      1862**DCL      1863--REDEF
OPN_CG.UHL_
      1856**DCL      1857--REDEF    1857--REDEF
OPN_CG.V
      1865**DCL      1856--DCLINIT
OPN_CG.V.DCB#
      1865**DCL      2726<<ASSIGN
OPN_CG.V.FSN#
      1896**DCL      1896--REDEF    1896--REDEF
OPN_CG.WSN_
      1862**DCL      1862--REDEF
OPN_TCG
      2008**DCL      2746<>CALL
OPN_TCG.ACCT_
      2012**DCL      2743<<ASSIGN
OPN_TCG.ACSVEH_
      2010**DCL      2011--REDEF
OPN_TCG.ALTKEYS_
      2016**DCL      2017--REDEF    2017--REDEF
OPN_TCG.HDR_
      2015**DCL      2016--REDEF
OPN_TCG.NAME_
      2009**DCL      2742<<ASSIGN
OPN_TCG.PASS_
      2010**DCL      2744<<ASSIGN
OPN_TCG.TAB_
      2014**DCL      2015--REDEF
OPN_TCG.UHL_
      2008**DCL      2009--REDEF    2009--REDEF
OPN_TCG.V
      2017**DCL      2008--DCLINIT
OPN_TCG.V.DCB#
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:41   
      2017**DCL      2741<<ASSIGN
OPN_TCG.V.FSN#
      2048**DCL      2048--REDEF    2048--REDEF
OPN_TCG.WSN_
      2014**DCL      2014--REDEF
REST_CG
      2125**DCL      2770<>CALL
REST_CG.REATTR_
      2126**DCL      2765<<ASSIGN
REST_CG.V
      2128**DCL      2125--DCLINIT
REST_CG.V.DCB#
      2128**DCL      2769<<ASSIGN
SEL_CRIT
      2171**DCL      2126--DCLINIT
SEL_REATTR
      2189**DCL      2127--DCLINIT
SYS_FUNC_ERRMSG
      2658**DCL-ENT  2806--CALL
WR_CG
      2070**DCL      2763<>CALL
WR_CG.BUF_
      2070**DCL      2753<<ASSIGN
WR_CG.BUF_.BOUND
      2070**DCL      2754<<ASSIGN
WR_CG.STATION_
      2072**DCL      2072--REDEF
WR_CG.V
      2073**DCL      2070--DCLINIT
WR_CG.V.DCB#
      2073**DCL      2755<<ASSIGN
WR_CG.V.DVBYTE.CONT#
      2081**DCL      2757<<ASSIGN   2760<<ASSIGN
WR_CG.V.DVBYTE.VFC#
      2079**DCL      2079--REDEF
WR_STA.MSGID#
PL6.E3A0      #001=ZIU$CGJRNL File=ZIU$CGJRNL.:ZIC0TSI                           FRI 09/05/97 13:07 Page:42   
      2107**DCL      2768>>ASSIGN
WR_STA.MSGIDXT
      2107**DCL      2110--REDEF
