VERSION E05

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:1    
        1        1        /*M* ASC$PRIV: Processes PRIV and FEPRIV options.               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASC$PRIV - this module consists of procedures:
       11       11                        ASC$PRIV
       12       12                        ASC$FEPRIV
       13       13        */
       14       14        /********************************************************************/
       15       15        /*                                                                   */
       16       16        /*                   ASC$PRIV            proc                        */
       17       17        /*                                                                   */
       18       18        /*********************************************************************/
       19       19                                                              /**/
       20       20        ASC$PRIV: PROC ;
       21       21                                                              /**/
       22       22        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:2    
       23       23        /********************************************************************/
       24       24        /*   Include files   include files   include files   include files   */
       25       25        /*********************************************************************/
       26       26                                                              /**/
       27       27        %INCLUDE      AS_ENTRIES_M ;
       28     1077        %INCLUDE      AS_SUPER_C   ;
       29     1512        %INCLUDE      AS_MAC_C     ;
       30     1592        %INCLUDE      AS_SUBS_C    ;
       31     3006        %INCLUDE      AS_PERR_C    ;
       32     3608        %INCLUDE      B_MACROS_C   ;
       33     3719        %INCLUDE      CP_6         ;
       34     3800        %INCLUDE      XU_MACRO_C   ;
       35     6906        %INCLUDE      XU_FORMAT_C  ;
       36     7068        %INCLUDE      KL_SUPER_C   ;
       37     9970        %INCLUDE      AS_SUPER_R   ;
       38    12986                                                              /**/
       39    12987        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:3    
       40    12988        /********************************************************************/
       41    12989        /*   Local based     local based     local based     local based     */
       42    12990        /*********************************************************************/
       43    12991                                                              /**/
       44    12992            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       45    12993                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       46    13038        %P$LIT( NAME=P$LIT, STCLASS=BASED, LEN="P$LIT.COUNT" );
       47    13091                                                              /**/
       48    13092        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:4    
       49    13093        /********************************************************************/
       50    13094        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       51    13095        /*********************************************************************/
       52    13096                                                              /**/
       53    13097    1   DCL X$PARSE ENTRY(1) ALTRET ;
       54    13098        %ASB$READ_SI ;
       55    13101        %ASB$SET_PROMPT ;
       56    13104        %ASH$HELP ;
       57    13107        %ASH$DQUEST ;
       58    13110        %ASH$QUEST ;
       59    13113        %ASH$ERROR ;
       60    13116                                                              /**/
       61    13117        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:5    
       62    13118        /********************************************************************/
       63    13119        /*   Auto data       auto data       auto data       auto data       */
       64    13120        /*********************************************************************/
       65    13121                                                              /**/
       66    13122    1   DCL ARS UBIN ;
       67    13123    1   DCL I SBIN ;
       68    13124    1   DCL J SBIN ;
       69    13125    1   DCL K SBIN ;
       70    13126    1   DCL ANS SBIN ;
       71    13127    1   DCL MODE SBIN ;
       72    13128    1   DCL NUM SBIN ;
       73    13129    1   DCL SUBNODES SBIN ;
       74    13130    1   DCL MORE BIT(1) ;
       75    13131    1   DCL DUMMY BIT(1) ;
       76    13132    1   DCL P$ PTR ;
       77    13133    1   DCL TEMP_PRIV BIT(36) ALIGNED ;
       78    13134                                                              /**/
       79    13135        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:6    
       80    13136        /********************************************************************/
       81    13137        /*   Static data     static data     static data     static data     */
       82    13138        /*********************************************************************/
       83    13139                                                              /**/
       84    13140    1   DCL 1 ERR_FCG CONSTANT ,
       85    13141    1          2 FCG_MID UBIN(18) UNAL INIT(5315) ;     /*  'ASC' in sixbit.  */
       86    13142    1   DCL 1 ASH_FCG CONSTANT ,
       87    13143    1          2 FCG_MID UBIN(18) UNAL INIT(5320) ;     /*  'ASH' in sixbit.  */
       88    13144    1   DCL PPRIV_S_OPT UBIN WORD SYMREF ;
       89    13145        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:7    
       90    13146        /********************************************************************/
       91    13147        /*   Procedure       procedure       procedure       procedure       */
       92    13148        /*********************************************************************/
       93    13149                                                              /**/
       94    13150        /*
       95    13151            ***            Begin procedure                    ***
       96    13152        */
       97    13153    1   P_PCB.ROOT$ = ADDR(PRIV_S_OPT) ;
       98    13154    1   MORE = AS_TRUE ;
       99    13155    1   DUMMY = AS_TRUE ;
      100    13156                                                              /**/
      101    13157    2   DO WHILE (DUMMY) ;
      102    13158    2   PRIV_LOOP: ;
      103    13159    3      DO WHILE (MORE) ;
      104    13160    3         REMEMBER PRIV_LOOP IN REMEM_VAR ;
      105    13161                                                              /*  Set prompt  */
      106    13162    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;
      107    13163    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */
      108    13164    3         P_PCB.NCHARS = ARS ;
      109    13165    3         CALL X$PARSE(P_PCB) ALTRET (PRIV_ERR) ;
      110    13166    3         NODE$ = P_PCB.OUT$ ;
      111    13167    3         SUBNODES = P$NODE.SUBNODES ;
      112    13168    4         DO I = 0 TO SUBNODES - 2 ;
      113    13169                                                              /* Check for end */
      114    13170    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
      115    13171    5            DO SELECT (CODE) ;
      116    13172                                                              /**/
      117    13173    5               SELECT (END_VAL, BLANK_LINE_VAL) ;
      118    13174    5               ERR_CODE.CODE = 0 ;
      119    13175    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      120    13176    5               RETURN ;
      121    13177                                                              /**/
      122    13178    5               SELECT(HELP_VAL) ;
      123    13179    5               CALL ASH$HELP ;
      124    13180    5               GOTO PRIV_DO_I ;
      125    13181                                                              /**/
      126    13182    5               SELECT(DQUESTION_VAL) ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:8    
      127    13183    5               CALL ASH$DQUEST ;
      128    13184    5               GOTO PRIV_DO_I ;
      129    13185                                                              /**/
      130    13186    5               SELECT(QUESTION_VAL) ;
      131    13187    5               CALL ASH$QUEST ;
      132    13188    5               GOTO PRIV_DO_I ;
      133    13189                                                              /**/
      134    13190    5               END ;   /*  Do case (code)  */
      135    13191    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      136    13192    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
      137    13193                                                              /**/
      138    13194    4            TEMP_PRIV = AS_PRIVILEGE(CODE);
      139    13195    4            ERR_CODE.CODE = 0 ;
      140    13196    4            NUM = P$ -> P$NODE.SUBNODES ;
      141    13197                                                              /**/
      142    13198    5            DO J = 0 TO NUM-1 ;
      143    13199    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)
      144    13200    5                    -> P$NODE.CODE ;
      145    13201    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;
      146    13202    5               IF K = 2
      147    13203    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)
      148    13204    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      149    13205    5               ELSE ANS = 1 ;
      150    13206                                                              /**/
      151    13207    5               IF ANS = 1
      152    13208    6               THEN DO;
      153    13209    6                  IF  AS_CR_MOD_PROJ > 0
      154    13210    6                       AND
      155    13211    6                       (TEMP_PRIV & AS_DFLT.PRIV(MODE)) = '0'B
      156    13212    7                  THEN DO;
      157    13213    7                     ERR_CODE = ERR_FCG;
      158    13214    8                     DO SELECT( AS_CR_MOD_PROJ );
      159    13215    8                        SELECT( %CR_PROJ_USER );
      160    13216        /*E* ERROR:   ASC-E$CANT_GIVE_PRIVTO_USER-C
      161    13217             MESSAGE: %U1 %U2 privilege not allowed.
      162    13218             MESSAGE1: Users in your project are not allowed to have the %U2 privilege
      163    13219                       in %U1 access mode.
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:9    
      164    13220             MESSAGE2: No user in the project may have a privilege not specified in
      165    13221                       the default record for the project.
      166    13222        */
      167    13223    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_USER;
      168    13224
      169    13225    8                        SELECT( %CR_PROJECT );
      170    13226        /*E*  ERROR:  ASC-E$CANT_GIVE_PRIVTO_PROJ-C
      171    13227              MESSAGE: %U1 %U2 privilege not allowed.
      172    13228              MESSAGE1: Projects you create are not allowed to have the %U2 privilege
      173    13229                        in %U1 access mode.
      174    13230              MESSAGE2: Your project does not have that privilege, so you are not
      175    13231                        allowed to give the privilege to a project you create.
      176    13232        */
      177    13233    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_PROJ;
      178    13234
      179    13235    8                        SELECT( %CR_PROJ_DEFAULT );
      180    13236        /*E*  ERROR:  ASC-E$CANT_GIVE_PRIVTO_DFLT-C
      181    13237            MESSAGE: %U1 %U2 privilege not allowed.
      182    13238            MESSAGE1: Users in a project you create are not allowed to have the
      183    13239                     %U2 privilege in %U1 access mode.
      184    13240            MESSAGE2: Your project does not have that privilege, so you are not allowed
      185    13241                      to give the privilege to users in a project you create.
      186    13242        */
      187    13243    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_DFLT;
      188    13244    8                        END;              /* Do case */
      189    13245    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);
      190    13246    7                     AS_FIELD2.COUNT = AS_PRIV_NAMES(CODE) -> P$LIT.COUNT;
      191    13247    7                     AS_FIELD2.TEXT = AS_PRIV_NAMES(CODE) -> P$LIT.TEXT;
      192    13248    7                     CALL ASH$ERROR( ERR_CODE );
      193    13249    7                     END;
      194    13250    7                  ELSE DO;
      195    13251                          %SETV (VAR="AS_USERS.PRIV(MODE)",FLAGS=TEMP_PRIV);
      196    13254    7                     AS_MOD_USER.PRIV_A(4*CODE+MODE) = YES_VAL;
      197    13255    7                     END;
      198    13256    6                  END;
      199    13257    6               ELSE DO;
      200    13258                       %RESETV (VAR="AS_USERS.PRIV(MODE)",FLAGS=TEMP_PRIV);
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:10   
      201    13261    6                  AS_MOD_USER.PRIV_A(4*CODE+MODE) = NO_VAL;
      202    13262    6                  END;
      203    13263                                                              /*
      204    13264                                                                   Mode
      205    13265                                                                   batch   = 0
      206    13266                                                                   ghost   = 1
      207    13267                                                                   on-line = 2
      208    13268                                                                   tp = 3
      209    13269                                                                   ans
      210    13270                                                                   yes = 1
      211    13271                                                                   no = 2
      212    13272                                                              */
      213    13273    5               END ; /* Do j */
      214    13274    4   PRIV_DO_I: ;
      215    13275    4            END ; /*  Do i  */
      216    13276    3         END ; /* Do while (more) */
      217    13277    2   PRIV_ERR: ;
      218    13278    2      CALL ASH$ERROR( P_PCB.ERROR );
      219    13279    2      END ; /* Do while (dummy) */
      220    13280                                                              /**/
      221    13281        %EJECT;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:11   
      222    13282    1   ASC$PPRIV: ENTRY ;
      223    13283                                                              /**/
      224    13284    1   P_PCB.ROOT$ = ADDR(PPRIV_S_OPT) ;
      225    13285    1   MORE = AS_TRUE ;
      226    13286    1   DUMMY = AS_TRUE ;
      227    13287                                                              /**/
      228    13288    2   DO WHILE (DUMMY) ;
      229    13289    2   PPRIV_LOOP: ;
      230    13290    3      DO WHILE (MORE) ;
      231    13291    3         REMEMBER PPRIV_LOOP IN REMEM_VAR ;
      232    13292                                                              /* Set prompt */
      233    13293    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;
      234    13294    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */
      235    13295    3         P_PCB.NCHARS = ARS ;
      236    13296    3         CALL X$PARSE(P_PCB) ALTRET (PPRIV_ERR) ;
      237    13297    3         NODE$ = P_PCB.OUT$ ;
      238    13298    3         SUBNODES = P$NODE.SUBNODES ;
      239    13299    4         DO I = 0 TO SUBNODES - 2 ;
      240    13300                                                              /* Check for end */
      241    13301    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
      242    13302    5            DO SELECT (CODE) ;
      243    13303                                                              /**/
      244    13304    5               SELECT (END_VAL, BLANK_LINE_VAL) ;
      245    13305    5               ERR_CODE.CODE = 0 ;
      246    13306    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      247    13307    5               RETURN ;
      248    13308                                                              /**/
      249    13309    5               SELECT(HELP_VAL) ;
      250    13310    5               CALL ASH$HELP ;
      251    13311    5               GOTO PPRIV_DO_I ;
      252    13312                                                              /**/
      253    13313    5               SELECT(DQUESTION_VAL) ;
      254    13314    5               CALL ASH$DQUEST ;
      255    13315    5               GOTO PPRIV_DO_I ;
      256    13316                                                              /**/
      257    13317    5               SELECT(QUESTION_VAL) ;
      258    13318    5               CALL ASH$QUEST ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:12   
      259    13319    5               GOTO PPRIV_DO_I ;
      260    13320                                                              /**/
      261    13321    5               END ;   /*  Do case (code)  */
      262    13322    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      263    13323    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
      264    13324                                                              /**/
      265    13325    4            TEMP_PRIV = AS_PPRIVILEGE(CODE);
      266    13326                                                                  /**/
      267    13327    4            ERR_CODE = '0'B ;
      268    13328    4            NUM = P$ -> P$NODE.SUBNODES ;
      269    13329                                                              /**/
      270    13330    5            DO J = 0 TO NUM-1 ;
      271    13331    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)
      272    13332    5                    -> P$NODE.CODE ;
      273    13333    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;
      274    13334    5               IF K = 2
      275    13335    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)
      276    13336    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      277    13337    5               ELSE ANS = 1 ;
      278    13338                                                              /**/
      279    13339    5               IF ANS = 1
      280    13340    6               THEN DO;
      281    13341    6                  IF AS_CR_MOD_PROJ > 0
      282    13342    6                       AND
      283    13343    6                       (TEMP_PRIV & AS_DFLT.PPRIV(MODE)) = '0'B
      284    13344    7                  THEN DO;
      285    13345    7                     ERR_CODE = ERR_FCG;
      286    13346    8                     DO SELECT( AS_CR_MOD_PROJ );
      287    13347    8                        SELECT( %CR_PROJ_USER );
      288    13348        /*E* ERROR:   ASC-E$CANT_GIVE_PPRIVTO_USER-C
      289    13349             MESSAGE: %U1 %U2 pprivilege not allowed.
      290    13350             MESSAGE1: Users in your project are not allowed to have the %U2 pprivilege
      291    13351                       in %U1 access mode.
      292    13352             MESSAGE2: No user in the project may have a pprivilege not specified in
      293    13353                       the default record for the project.
      294    13354        */
      295    13355    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_USER;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:13   
      296    13356
      297    13357    8                        SELECT( %CR_PROJECT );
      298    13358        /*E*  ERROR:  ASC-E$CANT_GIVE_PPRIVTO_PROJ-C
      299    13359              MESSAGE: %U1 %U2 pprivilege not allowed.
      300    13360              MESSAGE1: Projects you create are not allowed to have the %U2 pprivilege
      301    13361                        in %U1 access mode.
      302    13362              MESSAGE2: Your project does not have that pprivilege, so you are not
      303    13363                        allowed to give the pprivilege to a project you create.
      304    13364        */
      305    13365    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_PROJ;
      306    13366
      307    13367    8                        SELECT( %CR_PROJ_DEFAULT );
      308    13368        /*E*  ERROR:  ASC-E$CANT_GIVE_PPRIVTO_DFLT-C
      309    13369              MESSAGE: %U1 %U2 pprivilege not allowed.
      310    13370            MESSAGE1: Users in a project you create are not allowed to have the
      311    13371                     %U2 pprivilege in %U1 access mode.
      312    13372            MESSAGE2: Your project does not have that pprivilege, so you are not allowed
      313    13373                      to give the pprivilege to users in a project you create.
      314    13374        */
      315    13375    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_DFLT;
      316    13376    8                        END;              /* Do case */
      317    13377    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);
      318    13378    7                     AS_FIELD2.COUNT = AS_PPRIV_NAMES(CODE) -> P$LIT.COUNT;
      319    13379    7                     AS_FIELD2.TEXT = AS_PPRIV_NAMES(CODE) -> P$LIT.TEXT;
      320    13380    7                     CALL ASH$ERROR( ERR_CODE );
      321    13381    7                     END;
      322    13382    7                  ELSE DO;
      323    13383                          %SETV (VAR="AS_USERS.PPRIV(MODE)",FLAGS=TEMP_PRIV);
      324    13386    7                     AS_MOD_USER.PPRIV_A(4*CODE+MODE) = YES_VAL;
      325    13387    7                     END;
      326    13388    6                  END;
      327    13389    6               ELSE DO;
      328    13390                       %RESETV (VAR="AS_USERS.PPRIV(MODE)",FLAGS=TEMP_PRIV);
      329    13393    6                  AS_MOD_USER.PPRIV_A(4*CODE+MODE) = NO_VAL;
      330    13394    6                  END;
      331    13395                                                              /*
      332    13396                                                                   Mode
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:14   
      333    13397                                                                   batch   = 0
      334    13398                                                                   ghost   = 1
      335    13399                                                                   on-line = 2
      336    13400                                                                   tp = 3
      337    13401                                                                   ans
      338    13402                                                                   yes = 1
      339    13403                                                                   no = 2
      340    13404                                                              */
      341    13405    5               END ; /* Do j */
      342    13406    4   PPRIV_DO_I: ;
      343    13407    4            END ; /*  Do i  */
      344    13408    3         END ; /* Do while (more) */
      345    13409    2   PPRIV_ERR: ;
      346    13410    2      CALL ASH$ERROR( P_PCB.ERROR );
      347    13411    2      END ; /* Do while( dummy ) */
      348    13412    1   END       ASC$PRIV ;
      349    13413        %EOD ;

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:15   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$PRIV.

   Procedure ASC$PRIV requires 437 words for executable code.
   Procedure ASC$PRIV requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:16   

 Object Unit name= ASC$PRIV                                   File name= ASC$PRIV.:E05TOU
 UTS= JUL 29 '97 09:38:41.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS      2      2  ASC$PRIV
    3   Proc  even  none   437    665  ASC$PRIV
    4  RoData even  none     9     11  ASC$PRIV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASC$PRIV
     3    333                  yes      Std        0  ASC$PPRIV
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:17   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
         yes           Std       2 ASH$ERROR
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CR_MOD_TREE                           PRIV_S_OPT
r    AS_TRUE                          r    AS_PRIV_NAMES                    r    AS_PPRIV_NAMES
r    AS_PRIVILEGE                     r    AS_PPRIVILEGE                    r    AS_MODE
r    AS_FE_MODE                            M$LO                                  IN_BUF
     NODE$                                 CODE                                  ERR_CODE
     AS_FIELD1                             AS_FIELD2                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          AS_CR_MOD_PROJ
     P_PCB                                 AS_USERS                              AS_DFLT
     AS_MOD_USER                           PPRIV_S_OPT                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:18   


        1        1        /*M* ASC$PRIV: Processes PRIV and FEPRIV options.               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASC$PRIV - this module consists of procedures:
       11       11                        ASC$PRIV
       12       12                        ASC$FEPRIV
       13       13        */
       14       14        /********************************************************************/
       15       15        /*                                                                   */
       16       16        /*                   ASC$PRIV            proc                        */
       17       17        /*                                                                   */
       18       18        /*********************************************************************/
       19       19                                                              /**/
       20       20        ASC$PRIV: PROC ;

     20  3 000000   000000 700200 xent  ASC$PRIV     TSX0  ! X66_AUTO_0
         3 000001   000022 000000                    ZERO    18,0

       21       21                                                              /**/
       22       22        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:19   
       23       23        /********************************************************************/
       24       24        /*   Include files   include files   include files   include files   */
       25       25        /*********************************************************************/
       26       26                                                              /**/
       27       27        %INCLUDE      AS_ENTRIES_M ;
       28     1077        %INCLUDE      AS_SUPER_C   ;
       29     1512        %INCLUDE      AS_MAC_C     ;
       30     1592        %INCLUDE      AS_SUBS_C    ;
       31     3006        %INCLUDE      AS_PERR_C    ;
       32     3608        %INCLUDE      B_MACROS_C   ;
       33     3719        %INCLUDE      CP_6         ;
       34     3800        %INCLUDE      XU_MACRO_C   ;
       35     6906        %INCLUDE      XU_FORMAT_C  ;
       36     7068        %INCLUDE      KL_SUPER_C   ;
       37     9970        %INCLUDE      AS_SUPER_R   ;
       38    12986                                                              /**/
       39    12987        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:20   
       40    12988        /********************************************************************/
       41    12989        /*   Local based     local based     local based     local based     */
       42    12990        /*********************************************************************/
       43    12991                                                              /**/
       44    12992            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       45    12993                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       46    13038        %P$LIT( NAME=P$LIT, STCLASS=BASED, LEN="P$LIT.COUNT" );
       47    13091                                                              /**/
       48    13092        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:21   
       49    13093        /********************************************************************/
       50    13094        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       51    13095        /*********************************************************************/
       52    13096                                                              /**/
       53    13097    1   DCL X$PARSE ENTRY(1) ALTRET ;
       54    13098        %ASB$READ_SI ;
       55    13101        %ASB$SET_PROMPT ;
       56    13104        %ASH$HELP ;
       57    13107        %ASH$DQUEST ;
       58    13110        %ASH$QUEST ;
       59    13113        %ASH$ERROR ;
       60    13116                                                              /**/
       61    13117        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:22   
       62    13118        /********************************************************************/
       63    13119        /*   Auto data       auto data       auto data       auto data       */
       64    13120        /*********************************************************************/
       65    13121                                                              /**/
       66    13122    1   DCL ARS UBIN ;
       67    13123    1   DCL I SBIN ;
       68    13124    1   DCL J SBIN ;
       69    13125    1   DCL K SBIN ;
       70    13126    1   DCL ANS SBIN ;
       71    13127    1   DCL MODE SBIN ;
       72    13128    1   DCL NUM SBIN ;
       73    13129    1   DCL SUBNODES SBIN ;
       74    13130    1   DCL MORE BIT(1) ;
       75    13131    1   DCL DUMMY BIT(1) ;
       76    13132    1   DCL P$ PTR ;
       77    13133    1   DCL TEMP_PRIV BIT(36) ALIGNED ;
       78    13134                                                              /**/
       79    13135        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:23   
       80    13136        /********************************************************************/
       81    13137        /*   Static data     static data     static data     static data     */
       82    13138        /*********************************************************************/
       83    13139                                                              /**/
       84    13140    1   DCL 1 ERR_FCG CONSTANT ,
       85    13141    1          2 FCG_MID UBIN(18) UNAL INIT(5315) ;     /*  'ASC' in sixbit.  */
       86    13142    1   DCL 1 ASH_FCG CONSTANT ,
       87    13143    1          2 FCG_MID UBIN(18) UNAL INIT(5320) ;     /*  'ASH' in sixbit.  */
       88    13144    1   DCL PPRIV_S_OPT UBIN WORD SYMREF ;
       89    13145        %EJECT ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:24   
       90    13146        /********************************************************************/
       91    13147        /*   Procedure       procedure       procedure       procedure       */
       92    13148        /*********************************************************************/
       93    13149                                                              /**/
       94    13150        /*
       95    13151            ***            Begin procedure                    ***
       96    13152        */
       97    13153    1   P_PCB.ROOT$ = ADDR(PRIV_S_OPT) ;

  13153  3 000002   000000 236000 4                  LDQ     0
         3 000003   000001 756000 xsym               STQ     P_PCB+1

       98    13154    1   MORE = AS_TRUE ;

  13154  3 000004   000000 236000 xsym               LDQ     AS_TRUE
         3 000005   400000 376003                    ANQ     -131072,DU
         3 000006   200013 756100                    STQ     MORE,,AUTO

       99    13155    1   DUMMY = AS_TRUE ;

  13155  3 000007   200014 756100                    STQ     DUMMY,,AUTO

      100    13156                                                              /**/
      101    13157    2   DO WHILE (DUMMY) ;

  13157  3 000010   200014 234100                    SZN     DUMMY,,AUTO
         3 000011   000332 605000 3                  TPL     s:13279+2

  13153  3 000012                       PRIV_LOOP    null
      102    13158    2   PRIV_LOOP: ;
      103    13159    3      DO WHILE (MORE) ;

  13159  3 000012   200013 234100                    SZN     MORE,,AUTO
         3 000013   000324 605000 3                  TPL     PRIV_ERR

      104    13160    3         REMEMBER PRIV_LOOP IN REMEM_VAR ;

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:25   
  13160  3 000014   000012 635000 3                  EAA     PRIV_LOOP
         3 000015   000000 452400 xsym               STP2    REMEM_VAR
         3 000016   000001 755000 xsym               STA     REMEM_VAR+1

      105    13161                                                              /*  Set prompt  */
      106    13162    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;

  13162  3 000017   000001 630400 4                  EPPR0   1
         3 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000021   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000022   000000 011000                    NOP     0

      107    13163    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */

  13163  3 000023   200003 630500                    EPPR0   ARS,,AUTO
         3 000024   200021 450500                    STP0    TEMP_PRIV+3,,AUTO
         3 000025   000002 236000 4                  LDQ     2
         3 000026   200020 756100                    STQ     TEMP_PRIV+2,,AUTO
         3 000027   200020 630500                    EPPR0   TEMP_PRIV+2,,AUTO
         3 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000031   000000 701000 xent               TSX1    ASB$READ_SI
         3 000032   000000 011000                    NOP     0

      108    13164    3         P_PCB.NCHARS = ARS ;

  13164  3 000033   200003 235100                    LDA     ARS,,AUTO
         3 000034   000011 755000 xsym               STA     P_PCB+9

      109    13165    3         CALL X$PARSE(P_PCB) ALTRET (PRIV_ERR) ;

  13165  3 000035   000003 630400 4                  EPPR0   3
         3 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000037   000000 701000 xent               TSX1    X$PARSE
         3 000040   000324 702000 3                  TSX2    PRIV_ERR

      110    13166    3         NODE$ = P_PCB.OUT$ ;

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:26   
  13166  3 000041   000003 236000 xsym               LDQ     P_PCB+3
         3 000042   000000 756000 xsym               STQ     NODE$

      111    13167    3         SUBNODES = P$NODE.SUBNODES ;

  13167  3 000043   000000 470400 xsym               LDP0    NODE$
         3 000044   000001 236100                    LDQ     1,,PR0
         3 000045   000022 772000                    QRL     18
         3 000046   200012 756100                    STQ     SUBNODES,,AUTO

      112    13168    4         DO I = 0 TO SUBNODES - 2 ;

  13168  3 000047   200004 450100                    STZ     I,,AUTO
         3 000050   000316 710000 3                  TRA     PRIV_DO_I+1

      113    13169                                                              /* Check for end */
      114    13170    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;

  13170  3 000051   000000 470400 xsym               LDP0    NODE$
         3 000052   200004 720100                    LXL0    I,,AUTO
         3 000053   000003 471510                    LDP1    3,X0,PR0
         3 000054   100000 236100                    LDQ     0,,PR1
         3 000055   777777 376007                    ANQ     -1,DL
         3 000056   000000 756000 xsym               STQ     CODE

      115    13171    5            DO SELECT (CODE) ;

  13171  3 000057   000032 116007                    CMPQ    26,DL
         3 000060   000073 602000 3                  TNC     s:13171+12
         3 000061   000076 600000 3                  TZE     s:13174
         3 000062   000455 116007                    CMPQ    301,DL
         3 000063   000070 602000 3                  TNC     s:13171+9
         3 000064   000113 600000 3                  TZE     s:13187
         3 000065   000456 116007                    CMPQ    302,DL
         3 000066   000117 601000 3                  TNZ     s:13191
         3 000067   000103 710000 3                  TRA     s:13179
         3 000070   000454 116007                    CMPQ    300,DL
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:27   
         3 000071   000117 601000 3                  TNZ     s:13191
         3 000072   000107 710000 3                  TRA     s:13183
         3 000073   000014 116007                    CMPQ    12,DL
         3 000074   000117 601000 3                  TNZ     s:13191
         3 000075   000076 710000 3                  TRA     s:13174

      116    13172                                                              /**/
      117    13173    5               SELECT (END_VAL, BLANK_LINE_VAL) ;

      118    13174    5               ERR_CODE.CODE = 0 ;

  13174  3 000076   000004 236000 4                  LDQ     4
         3 000077   000000 356000 xsym               ANSQ    ERR_CODE

      119    13175    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  13175  3 000100   000005 236000 4                  LDQ     5
         3 000101   000001 756000 xsym               STQ     P_PCB+1

      120    13176    5               RETURN ;

  13176  3 000102   000000 702200 xent               TSX2  ! X66_ARET

      121    13177                                                              /**/
      122    13178    5               SELECT(HELP_VAL) ;

      123    13179    5               CALL ASH$HELP ;

  13179  3 000103   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000104   000000 701000 xent               TSX1    ASH$HELP
         3 000105   000000 011000                    NOP     0

      124    13180    5               GOTO PRIV_DO_I ;

  13180  3 000106   000315 710000 3                  TRA     PRIV_DO_I

      125    13181                                                              /**/
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:28   
      126    13182    5               SELECT(DQUESTION_VAL) ;

      127    13183    5               CALL ASH$DQUEST ;

  13183  3 000107   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000110   000000 701000 xent               TSX1    ASH$DQUEST
         3 000111   000000 011000                    NOP     0

      128    13184    5               GOTO PRIV_DO_I ;

  13184  3 000112   000315 710000 3                  TRA     PRIV_DO_I

      129    13185                                                              /**/
      130    13186    5               SELECT(QUESTION_VAL) ;

      131    13187    5               CALL ASH$QUEST ;

  13187  3 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000114   000000 701000 xent               TSX1    ASH$QUEST
         3 000115   000000 011000                    NOP     0

      132    13188    5               GOTO PRIV_DO_I ;

  13188  3 000116   000315 710000 3                  TRA     PRIV_DO_I

      133    13189                                                              /**/
      134    13190    5               END ;   /*  Do case (code)  */

      135    13191    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  13191  3 000117   000003 471510                    LDP1    3,X0,PR0
         3 000120   100003 473500                    LDP3    3,,PR1
         3 000121   300000 236100                    LDQ     0,,PR3
         3 000122   777777 376007                    ANQ     -1,DL
         3 000123   000000 756000 xsym               STQ     CODE

      136    13192    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:29   

  13192  3 000124   000003 471510                    LDP1    3,X0,PR0
         3 000125   100004 236100                    LDQ     4,,PR1
         3 000126   200015 756100                    STQ     P$,,AUTO

      137    13193                                                              /**/
      138    13194    4            TEMP_PRIV = AS_PRIVILEGE(CODE);

  13194  3 000127   000000 721000 xsym               LXL1    CODE
         3 000130   000000 236011 xsym               LDQ     AS_PRIVILEGE,X1
         3 000131   200016 756100                    STQ     TEMP_PRIV,,AUTO

      139    13195    4            ERR_CODE.CODE = 0 ;

  13195  3 000132   000004 236000 4                  LDQ     4
         3 000133   000000 356000 xsym               ANSQ    ERR_CODE

      140    13196    4            NUM = P$ -> P$NODE.SUBNODES ;

  13196  3 000134   200015 471500                    LDP1    P$,,AUTO
         3 000135   100001 236100                    LDQ     1,,PR1
         3 000136   000022 772000                    QRL     18
         3 000137   200011 756100                    STQ     NUM,,AUTO

      141    13197                                                              /**/
      142    13198    5            DO J = 0 TO NUM-1 ;

  13198  3 000140   200005 450100                    STZ     J,,AUTO
         3 000141   000312 710000 3                  TRA     s:13273+1

      143    13199    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)

  13199  3 000142   200015 470500                    LDP0    P$,,AUTO
         3 000143   200005 720100                    LXL0    J,,AUTO
         3 000144   000003 471510                    LDP1    3,X0,PR0
         3 000145   100003 473500                    LDP3    3,,PR1
         3 000146   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:30   
         3 000147   777777 376007                    ANQ     -1,DL
         3 000150   200010 756100                    STQ     MODE,,AUTO

      144    13200    5                    -> P$NODE.CODE ;
      145    13201    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;

  13201  3 000151   100001 236100                    LDQ     1,,PR1
         3 000152   000022 772000                    QRL     18
         3 000153   200006 756100                    STQ     K,,AUTO

      146    13202    5               IF K = 2

  13202  3 000154   000002 116007                    CMPQ    2,DL
         3 000155   000163 601000 3                  TNZ     s:13205

      147    13203    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)

  13203  3 000156   100004 474500                    LDP4    4,,PR1
         3 000157   400000 236100                    LDQ     0,,PR4
         3 000160   777777 376007                    ANQ     -1,DL
         3 000161   200007 756100                    STQ     ANS,,AUTO
         3 000162   000165 710000 3                  TRA     s:13207

      148    13204    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      149    13205    5               ELSE ANS = 1 ;

  13205  3 000163   000001 235007                    LDA     1,DL
         3 000164   200007 755100                    STA     ANS,,AUTO

      150    13206                                                              /**/
      151    13207    5               IF ANS = 1

  13207  3 000165   200007 235100                    LDA     ANS,,AUTO
         3 000166   000001 115007                    CMPA    1,DL
         3 000167   000273 601000 3                  TNZ     s:13259

      152    13208    6               THEN DO;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:31   

      153    13209    6                  IF  AS_CR_MOD_PROJ > 0

  13209  3 000170   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000171   000255 604400 3                  TMOZ    s:13252
         3 000172   200010 721100                    LXL1    MODE,,AUTO
         3 000173   200016 236100                    LDQ     TEMP_PRIV,,AUTO
         3 000174   000225 376011 xsym               ANQ     AS_DFLT+149,X1
         3 000175   000255 601000 3                  TNZ     s:13252

      154    13210    6                       AND
      155    13211    6                       (TEMP_PRIV & AS_DFLT.PRIV(MODE)) = '0'B
      156    13212    7                  THEN DO;

      157    13213    7                     ERR_CODE = ERR_FCG;

  13213  3 000176   000000 236000 2                  LDQ     ERR_FCG
         3 000177   777777 376003                    ANQ     -1,DU
         3 000200   000000 756000 xsym               STQ     ERR_CODE

      158    13214    8                     DO SELECT( AS_CR_MOD_PROJ );

  13214  3 000201   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000202   000002 116007                    CMPQ    2,DL
         3 000203   000210 604000 3                  TMI     s:13214+7
         3 000204   000220 600000 3                  TZE     s:13233
         3 000205   000003 116007                    CMPQ    3,DL
         3 000206   000231 601000 3                  TNZ     s:13245
         3 000207   000225 710000 3                  TRA     s:13243
         3 000210   000001 116007                    CMPQ    1,DL
         3 000211   000231 601000 3                  TNZ     s:13245
         3 000212   000213 710000 3                  TRA     s:13223

      159    13215    8                        SELECT( %CR_PROJ_USER );

      160    13216        /*E* ERROR:   ASC-E$CANT_GIVE_PRIVTO_USER-C
      161    13217             MESSAGE: %U1 %U2 privilege not allowed.
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:32   
      162    13218             MESSAGE1: Users in your project are not allowed to have the %U2 privilege
      163    13219                       in %U1 access mode.
      164    13220             MESSAGE2: No user in the project may have a privilege not specified in
      165    13221                       the default record for the project.
      166    13222        */
      167    13223    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_USER;

  13223  3 000213   000000 236000 xsym               LDQ     ERR_CODE
         3 000214   000004 376000 4                  ANQ     4
         3 000215   000420 276007                    ORQ     272,DL
         3 000216   000000 756000 xsym               STQ     ERR_CODE
         3 000217   000231 710000 3                  TRA     s:13245

      168    13224
      169    13225    8                        SELECT( %CR_PROJECT );

      170    13226        /*E*  ERROR:  ASC-E$CANT_GIVE_PRIVTO_PROJ-C
      171    13227              MESSAGE: %U1 %U2 privilege not allowed.
      172    13228              MESSAGE1: Projects you create are not allowed to have the %U2 privilege
      173    13229                        in %U1 access mode.
      174    13230              MESSAGE2: Your project does not have that privilege, so you are not
      175    13231                        allowed to give the privilege to a project you create.
      176    13232        */
      177    13233    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_PROJ;

  13233  3 000220   000000 236000 xsym               LDQ     ERR_CODE
         3 000221   000004 376000 4                  ANQ     4
         3 000222   000430 276007                    ORQ     280,DL
         3 000223   000000 756000 xsym               STQ     ERR_CODE
         3 000224   000231 710000 3                  TRA     s:13245

      178    13234
      179    13235    8                        SELECT( %CR_PROJ_DEFAULT );

      180    13236        /*E*  ERROR:  ASC-E$CANT_GIVE_PRIVTO_DFLT-C
      181    13237            MESSAGE: %U1 %U2 privilege not allowed.
      182    13238            MESSAGE1: Users in a project you create are not allowed to have the
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:33   
      183    13239                     %U2 privilege in %U1 access mode.
      184    13240            MESSAGE2: Your project does not have that privilege, so you are not allowed
      185    13241                      to give the privilege to users in a project you create.
      186    13242        */
      187    13243    8                        ERR_CODE.CODE = E$CANT_GIVE_PRIVTO_DFLT;

  13243  3 000225   000000 236000 xsym               LDQ     ERR_CODE
         3 000226   000004 376000 4                  ANQ     4
         3 000227   000440 276007                    ORQ     288,DL
         3 000230   000000 756000 xsym               STQ     ERR_CODE

      188    13244    8                        END;              /* Do case */

      189    13245    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);

  13245  3 000231   200010 236100                    LDQ     MODE,,AUTO
         3 000232   000007 402007                    MPY     7,DL
         3 000233   000000 100406                    MLR     fill='000'O
         3 000234   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         3 000235   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      190    13246    7                     AS_FIELD2.COUNT = AS_PRIV_NAMES(CODE) -> P$LIT.COUNT;

  13246  3 000236   000000 722000 xsym               LXL2    CODE
         3 000237   000000 471412 xsym               LDP1    AS_PRIV_NAMES,X2
         3 000240   100001 236100                    LDQ     1,,PR1
         3 000241   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      191    13247    7                     AS_FIELD2.TEXT = AS_PRIV_NAMES(CODE) -> P$LIT.TEXT;

  13247  3 000242   100001 236100                    LDQ     1,,PR1
         3 000243   000033 772000                    QRL     27
         3 000244   000000 623006                    EAX3    0,QL
         3 000245   040000 100540                    MLR     fill='040'O
         3 000246   100001 200013                    ADSC9   1,,PR1                   cn=1,n=*X3
         3 000247   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:34   
      192    13248    7                     CALL ASH$ERROR( ERR_CODE );

  13248  3 000250   000006 630400 4                  EPPR0   6
         3 000251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000252   000000 701000 xent               TSX1    ASH$ERROR
         3 000253   000000 011000                    NOP     0

      193    13249    7                     END;

  13249  3 000254   000311 710000 3                  TRA     s:13273

      194    13250    7                  ELSE DO;

      195    13251                          %SETV (VAR="AS_USERS.PRIV(MODE)",FLAGS=TEMP_PRIV);

  13252  3 000255   200010 721100                    LXL1    MODE,,AUTO
         3 000256   000225 236011 xsym               LDQ     AS_USERS+149,X1
         3 000257   200016 276100                    ORQ     TEMP_PRIV,,AUTO
         3 000260   000225 756011 xsym               STQ     AS_USERS+149,X1

      196    13254    7                     AS_MOD_USER.PRIV_A(4*CODE+MODE) = YES_VAL;

  13254  3 000261   000000 236000 xsym               LDQ     CODE
         3 000262   000002 736000                    QLS     2
         3 000263   200010 036100                    ADLQ    MODE,,AUTO
         3 000264   000001 736000                    QLS     1
         3 000265   000267 605000 3                  TPL     s:13254+6
         3 000266   000044 036003                    ADLQ    36,DU
         3 000267   003006 061400                    CSR     bolr='003'O
         3 000270   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         3 000271   000001 430002 xsym               BDSC    AS_MOD_USER+1,Q          by=2,bit=3,n=2

      197    13255    7                     END;

      198    13256    6                  END;

  13256  3 000272   000311 710000 3                  TRA     s:13273
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:35   

      199    13257    6               ELSE DO;

      200    13258                       %RESETV (VAR="AS_USERS.PRIV(MODE)",FLAGS=TEMP_PRIV);

  13259  3 000273   200016 236100                    LDQ     TEMP_PRIV,,AUTO
         3 000274   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000275   200010 721100                    LXL1    MODE,,AUTO
         3 000276   000225 376011 xsym               ANQ     AS_USERS+149,X1
         3 000277   000225 756011 xsym               STQ     AS_USERS+149,X1

      201    13261    6                  AS_MOD_USER.PRIV_A(4*CODE+MODE) = NO_VAL;

  13261  3 000300   000000 236000 xsym               LDQ     CODE
         3 000301   000002 736000                    QLS     2
         3 000302   200010 036100                    ADLQ    MODE,,AUTO
         3 000303   000001 736000                    QLS     1
         3 000304   000306 605000 3                  TPL     s:13261+6
         3 000305   000044 036003                    ADLQ    36,DU
         3 000306   003006 061400                    CSR     bolr='003'O
         3 000307   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         3 000310   000001 430002 xsym               BDSC    AS_MOD_USER+1,Q          by=2,bit=3,n=2

      202    13262    6                  END;

      203    13263                                                              /*
      204    13264                                                                   Mode
      205    13265                                                                   batch   = 0
      206    13266                                                                   ghost   = 1
      207    13267                                                                   on-line = 2
      208    13268                                                                   tp = 3
      209    13269                                                                   ans
      210    13270                                                                   yes = 1
      211    13271                                                                   no = 2
      212    13272                                                              */
      213    13273    5               END ; /* Do j */

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:36   
  13273  3 000311   200005 054100                    AOS     J,,AUTO
         3 000312   200005 236100                    LDQ     J,,AUTO
         3 000313   200011 116100                    CMPQ    NUM,,AUTO
         3 000314   000142 604000 3                  TMI     s:13199

  13262  3 000315                       PRIV_DO_I    null
      214    13274    4   PRIV_DO_I: ;
      215    13275    4            END ; /*  Do i  */

  13275  3 000315   200004 054100                    AOS     I,,AUTO
         3 000316   200012 236100                    LDQ     SUBNODES,,AUTO
         3 000317   000002 136007                    SBLQ    2,DL
         3 000320   200004 116100                    CMPQ    I,,AUTO
         3 000321   000051 605000 3                  TPL     s:13170

      216    13276    3         END ; /* Do while (more) */

  13276  3 000322   200013 234100                    SZN     MORE,,AUTO
         3 000323   000014 604000 3                  TMI     s:13160

  13274  3 000324                       PRIV_ERR     null
      217    13277    2   PRIV_ERR: ;
      218    13278    2      CALL ASH$ERROR( P_PCB.ERROR );

  13278  3 000324   000007 630400 4                  EPPR0   7
         3 000325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000326   000000 701000 xent               TSX1    ASH$ERROR
         3 000327   000000 011000                    NOP     0

      219    13279    2      END ; /* Do while (dummy) */

  13279  3 000330   200014 234100                    SZN     DUMMY,,AUTO
         3 000331   000012 604000 3                  TMI     PRIV_LOOP
         3 000332   000335 710000 3                  TRA     s:13284

      220    13280                                                              /**/
      221    13281        %EJECT;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:37   
      222    13282    1   ASC$PPRIV: ENTRY ;

  13282  3 000333   000000 700200 xent  ASC$PPRIV    TSX0  ! X66_AUTO_0
         3 000334   000022 000000                    ZERO    18,0

      223    13283                                                              /**/
      224    13284    1   P_PCB.ROOT$ = ADDR(PPRIV_S_OPT) ;

  13284  3 000335   000010 236000 4                  LDQ     8
         3 000336   000001 756000 xsym               STQ     P_PCB+1

      225    13285    1   MORE = AS_TRUE ;

  13285  3 000337   000000 236000 xsym               LDQ     AS_TRUE
         3 000340   400000 376003                    ANQ     -131072,DU
         3 000341   200013 756100                    STQ     MORE,,AUTO

      226    13286    1   DUMMY = AS_TRUE ;

  13286  3 000342   200014 756100                    STQ     DUMMY,,AUTO

      227    13287                                                              /**/
      228    13288    2   DO WHILE (DUMMY) ;

  13288  3 000343   200014 234100                    SZN     DUMMY,,AUTO
         3 000344   000664 605000 3                  TPL     s:13412

  13282  3 000345                       PPRIV_LOOP   null
      229    13289    2   PPRIV_LOOP: ;
      230    13290    3      DO WHILE (MORE) ;

  13290  3 000345   200013 234100                    SZN     MORE,,AUTO
         3 000346   000656 605000 3                  TPL     PPRIV_ERR

      231    13291    3         REMEMBER PPRIV_LOOP IN REMEM_VAR ;

  13291  3 000347   000345 635000 3                  EAA     PPRIV_LOOP
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:38   
         3 000350   000000 452400 xsym               STP2    REMEM_VAR
         3 000351   000001 755000 xsym               STA     REMEM_VAR+1

      232    13292                                                              /* Set prompt */
      233    13293    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;

  13293  3 000352   000001 630400 4                  EPPR0   1
         3 000353   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000354   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000355   000000 011000                    NOP     0

      234    13294    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */

  13294  3 000356   200003 630500                    EPPR0   ARS,,AUTO
         3 000357   200021 450500                    STP0    TEMP_PRIV+3,,AUTO
         3 000360   000002 236000 4                  LDQ     2
         3 000361   200020 756100                    STQ     TEMP_PRIV+2,,AUTO
         3 000362   200020 630500                    EPPR0   TEMP_PRIV+2,,AUTO
         3 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000364   000000 701000 xent               TSX1    ASB$READ_SI
         3 000365   000000 011000                    NOP     0

      235    13295    3         P_PCB.NCHARS = ARS ;

  13295  3 000366   200003 235100                    LDA     ARS,,AUTO
         3 000367   000011 755000 xsym               STA     P_PCB+9

      236    13296    3         CALL X$PARSE(P_PCB) ALTRET (PPRIV_ERR) ;

  13296  3 000370   000003 630400 4                  EPPR0   3
         3 000371   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000372   000000 701000 xent               TSX1    X$PARSE
         3 000373   000656 702000 3                  TSX2    PPRIV_ERR

      237    13297    3         NODE$ = P_PCB.OUT$ ;

  13297  3 000374   000003 236000 xsym               LDQ     P_PCB+3
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:39   
         3 000375   000000 756000 xsym               STQ     NODE$

      238    13298    3         SUBNODES = P$NODE.SUBNODES ;

  13298  3 000376   000000 470400 xsym               LDP0    NODE$
         3 000377   000001 236100                    LDQ     1,,PR0
         3 000400   000022 772000                    QRL     18
         3 000401   200012 756100                    STQ     SUBNODES,,AUTO

      239    13299    4         DO I = 0 TO SUBNODES - 2 ;

  13299  3 000402   200004 450100                    STZ     I,,AUTO
         3 000403   000650 710000 3                  TRA     PPRIV_DO_I+1

      240    13300                                                              /* Check for end */
      241    13301    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;

  13301  3 000404   000000 470400 xsym               LDP0    NODE$
         3 000405   200004 720100                    LXL0    I,,AUTO
         3 000406   000003 471510                    LDP1    3,X0,PR0
         3 000407   100000 236100                    LDQ     0,,PR1
         3 000410   777777 376007                    ANQ     -1,DL
         3 000411   000000 756000 xsym               STQ     CODE

      242    13302    5            DO SELECT (CODE) ;

  13302  3 000412   000032 116007                    CMPQ    26,DL
         3 000413   000426 602000 3                  TNC     s:13302+12
         3 000414   000431 600000 3                  TZE     s:13305
         3 000415   000455 116007                    CMPQ    301,DL
         3 000416   000423 602000 3                  TNC     s:13302+9
         3 000417   000446 600000 3                  TZE     s:13318
         3 000420   000456 116007                    CMPQ    302,DL
         3 000421   000452 601000 3                  TNZ     s:13322
         3 000422   000436 710000 3                  TRA     s:13310
         3 000423   000454 116007                    CMPQ    300,DL
         3 000424   000452 601000 3                  TNZ     s:13322
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:40   
         3 000425   000442 710000 3                  TRA     s:13314
         3 000426   000014 116007                    CMPQ    12,DL
         3 000427   000452 601000 3                  TNZ     s:13322
         3 000430   000431 710000 3                  TRA     s:13305

      243    13303                                                              /**/
      244    13304    5               SELECT (END_VAL, BLANK_LINE_VAL) ;

      245    13305    5               ERR_CODE.CODE = 0 ;

  13305  3 000431   000004 236000 4                  LDQ     4
         3 000432   000000 356000 xsym               ANSQ    ERR_CODE

      246    13306    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  13306  3 000433   000005 236000 4                  LDQ     5
         3 000434   000001 756000 xsym               STQ     P_PCB+1

      247    13307    5               RETURN ;

  13307  3 000435   000000 702200 xent               TSX2  ! X66_ARET

      248    13308                                                              /**/
      249    13309    5               SELECT(HELP_VAL) ;

      250    13310    5               CALL ASH$HELP ;

  13310  3 000436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000437   000000 701000 xent               TSX1    ASH$HELP
         3 000440   000000 011000                    NOP     0

      251    13311    5               GOTO PPRIV_DO_I ;

  13311  3 000441   000647 710000 3                  TRA     PPRIV_DO_I

      252    13312                                                              /**/
      253    13313    5               SELECT(DQUESTION_VAL) ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:41   

      254    13314    5               CALL ASH$DQUEST ;

  13314  3 000442   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000443   000000 701000 xent               TSX1    ASH$DQUEST
         3 000444   000000 011000                    NOP     0

      255    13315    5               GOTO PPRIV_DO_I ;

  13315  3 000445   000647 710000 3                  TRA     PPRIV_DO_I

      256    13316                                                              /**/
      257    13317    5               SELECT(QUESTION_VAL) ;

      258    13318    5               CALL ASH$QUEST ;

  13318  3 000446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000447   000000 701000 xent               TSX1    ASH$QUEST
         3 000450   000000 011000                    NOP     0

      259    13319    5               GOTO PPRIV_DO_I ;

  13319  3 000451   000647 710000 3                  TRA     PPRIV_DO_I

      260    13320                                                              /**/
      261    13321    5               END ;   /*  Do case (code)  */

      262    13322    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  13322  3 000452   000003 471510                    LDP1    3,X0,PR0
         3 000453   100003 473500                    LDP3    3,,PR1
         3 000454   300000 236100                    LDQ     0,,PR3
         3 000455   777777 376007                    ANQ     -1,DL
         3 000456   000000 756000 xsym               STQ     CODE

      263    13323    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:42   
  13323  3 000457   000003 471510                    LDP1    3,X0,PR0
         3 000460   100004 236100                    LDQ     4,,PR1
         3 000461   200015 756100                    STQ     P$,,AUTO

      264    13324                                                              /**/
      265    13325    4            TEMP_PRIV = AS_PPRIVILEGE(CODE);

  13325  3 000462   000000 721000 xsym               LXL1    CODE
         3 000463   000000 236011 xsym               LDQ     AS_PPRIVILEGE,X1
         3 000464   200016 756100                    STQ     TEMP_PRIV,,AUTO

      266    13326                                                                  /**/
      267    13327    4            ERR_CODE = '0'B ;

  13327  3 000465   000000 450000 xsym               STZ     ERR_CODE

      268    13328    4            NUM = P$ -> P$NODE.SUBNODES ;

  13328  3 000466   200015 471500                    LDP1    P$,,AUTO
         3 000467   100001 236100                    LDQ     1,,PR1
         3 000470   000022 772000                    QRL     18
         3 000471   200011 756100                    STQ     NUM,,AUTO

      269    13329                                                              /**/
      270    13330    5            DO J = 0 TO NUM-1 ;

  13330  3 000472   200005 450100                    STZ     J,,AUTO
         3 000473   000644 710000 3                  TRA     s:13405+1

      271    13331    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)

  13331  3 000474   200015 470500                    LDP0    P$,,AUTO
         3 000475   200005 720100                    LXL0    J,,AUTO
         3 000476   000003 471510                    LDP1    3,X0,PR0
         3 000477   100003 473500                    LDP3    3,,PR1
         3 000500   300000 236100                    LDQ     0,,PR3
         3 000501   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:43   
         3 000502   200010 756100                    STQ     MODE,,AUTO

      272    13332    5                    -> P$NODE.CODE ;
      273    13333    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;

  13333  3 000503   100001 236100                    LDQ     1,,PR1
         3 000504   000022 772000                    QRL     18
         3 000505   200006 756100                    STQ     K,,AUTO

      274    13334    5               IF K = 2

  13334  3 000506   000002 116007                    CMPQ    2,DL
         3 000507   000515 601000 3                  TNZ     s:13337

      275    13335    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)

  13335  3 000510   100004 474500                    LDP4    4,,PR1
         3 000511   400000 236100                    LDQ     0,,PR4
         3 000512   777777 376007                    ANQ     -1,DL
         3 000513   200007 756100                    STQ     ANS,,AUTO
         3 000514   000517 710000 3                  TRA     s:13339

      276    13336    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      277    13337    5               ELSE ANS = 1 ;

  13337  3 000515   000001 235007                    LDA     1,DL
         3 000516   200007 755100                    STA     ANS,,AUTO

      278    13338                                                              /**/
      279    13339    5               IF ANS = 1

  13339  3 000517   200007 235100                    LDA     ANS,,AUTO
         3 000520   000001 115007                    CMPA    1,DL
         3 000521   000625 601000 3                  TNZ     s:13391

      280    13340    6               THEN DO;

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:44   
      281    13341    6                  IF AS_CR_MOD_PROJ > 0

  13341  3 000522   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000523   000607 604400 3                  TMOZ    s:13384
         3 000524   200010 721100                    LXL1    MODE,,AUTO
         3 000525   200016 236100                    LDQ     TEMP_PRIV,,AUTO
         3 000526   000231 376011 xsym               ANQ     AS_DFLT+153,X1
         3 000527   000607 601000 3                  TNZ     s:13384

      282    13342    6                       AND
      283    13343    6                       (TEMP_PRIV & AS_DFLT.PPRIV(MODE)) = '0'B
      284    13344    7                  THEN DO;

      285    13345    7                     ERR_CODE = ERR_FCG;

  13345  3 000530   000000 236000 2                  LDQ     ERR_FCG
         3 000531   777777 376003                    ANQ     -1,DU
         3 000532   000000 756000 xsym               STQ     ERR_CODE

      286    13346    8                     DO SELECT( AS_CR_MOD_PROJ );

  13346  3 000533   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000534   000002 116007                    CMPQ    2,DL
         3 000535   000542 604000 3                  TMI     s:13346+7
         3 000536   000552 600000 3                  TZE     s:13365
         3 000537   000003 116007                    CMPQ    3,DL
         3 000540   000563 601000 3                  TNZ     s:13377
         3 000541   000557 710000 3                  TRA     s:13375
         3 000542   000001 116007                    CMPQ    1,DL
         3 000543   000563 601000 3                  TNZ     s:13377
         3 000544   000545 710000 3                  TRA     s:13355

      287    13347    8                        SELECT( %CR_PROJ_USER );

      288    13348        /*E* ERROR:   ASC-E$CANT_GIVE_PPRIVTO_USER-C
      289    13349             MESSAGE: %U1 %U2 pprivilege not allowed.
      290    13350             MESSAGE1: Users in your project are not allowed to have the %U2 pprivilege
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:45   
      291    13351                       in %U1 access mode.
      292    13352             MESSAGE2: No user in the project may have a pprivilege not specified in
      293    13353                       the default record for the project.
      294    13354        */
      295    13355    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_USER;

  13355  3 000545   000000 236000 xsym               LDQ     ERR_CODE
         3 000546   000004 376000 4                  ANQ     4
         3 000547   000450 276007                    ORQ     296,DL
         3 000550   000000 756000 xsym               STQ     ERR_CODE
         3 000551   000563 710000 3                  TRA     s:13377

      296    13356
      297    13357    8                        SELECT( %CR_PROJECT );

      298    13358        /*E*  ERROR:  ASC-E$CANT_GIVE_PPRIVTO_PROJ-C
      299    13359              MESSAGE: %U1 %U2 pprivilege not allowed.
      300    13360              MESSAGE1: Projects you create are not allowed to have the %U2 pprivilege
      301    13361                        in %U1 access mode.
      302    13362              MESSAGE2: Your project does not have that pprivilege, so you are not
      303    13363                        allowed to give the pprivilege to a project you create.
      304    13364        */
      305    13365    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_PROJ;

  13365  3 000552   000000 236000 xsym               LDQ     ERR_CODE
         3 000553   000004 376000 4                  ANQ     4
         3 000554   000460 276007                    ORQ     304,DL
         3 000555   000000 756000 xsym               STQ     ERR_CODE
         3 000556   000563 710000 3                  TRA     s:13377

      306    13366
      307    13367    8                        SELECT( %CR_PROJ_DEFAULT );

      308    13368        /*E*  ERROR:  ASC-E$CANT_GIVE_PPRIVTO_DFLT-C
      309    13369              MESSAGE: %U1 %U2 pprivilege not allowed.
      310    13370            MESSAGE1: Users in a project you create are not allowed to have the
      311    13371                     %U2 pprivilege in %U1 access mode.
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:46   
      312    13372            MESSAGE2: Your project does not have that pprivilege, so you are not allowed
      313    13373                      to give the pprivilege to users in a project you create.
      314    13374        */
      315    13375    8                        ERR_CODE.CODE = E$CANT_GIVE_PPRIVTO_DFLT;

  13375  3 000557   000000 236000 xsym               LDQ     ERR_CODE
         3 000560   000004 376000 4                  ANQ     4
         3 000561   000470 276007                    ORQ     312,DL
         3 000562   000000 756000 xsym               STQ     ERR_CODE

      316    13376    8                        END;              /* Do case */

      317    13377    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);

  13377  3 000563   200010 236100                    LDQ     MODE,,AUTO
         3 000564   000007 402007                    MPY     7,DL
         3 000565   000000 100406                    MLR     fill='000'O
         3 000566   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         3 000567   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      318    13378    7                     AS_FIELD2.COUNT = AS_PPRIV_NAMES(CODE) -> P$LIT.COUNT;

  13378  3 000570   000000 722000 xsym               LXL2    CODE
         3 000571   000000 471412 xsym               LDP1    AS_PPRIV_NAMES,X2
         3 000572   100001 236100                    LDQ     1,,PR1
         3 000573   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      319    13379    7                     AS_FIELD2.TEXT = AS_PPRIV_NAMES(CODE) -> P$LIT.TEXT;

  13379  3 000574   100001 236100                    LDQ     1,,PR1
         3 000575   000033 772000                    QRL     27
         3 000576   000000 623006                    EAX3    0,QL
         3 000577   040000 100540                    MLR     fill='040'O
         3 000600   100001 200013                    ADSC9   1,,PR1                   cn=1,n=*X3
         3 000601   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      320    13380    7                     CALL ASH$ERROR( ERR_CODE );
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:47   

  13380  3 000602   000006 630400 4                  EPPR0   6
         3 000603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000604   000000 701000 xent               TSX1    ASH$ERROR
         3 000605   000000 011000                    NOP     0

      321    13381    7                     END;

  13381  3 000606   000643 710000 3                  TRA     s:13405

      322    13382    7                  ELSE DO;

      323    13383                          %SETV (VAR="AS_USERS.PPRIV(MODE)",FLAGS=TEMP_PRIV);

  13384  3 000607   200010 721100                    LXL1    MODE,,AUTO
         3 000610   000231 236011 xsym               LDQ     AS_USERS+153,X1
         3 000611   200016 276100                    ORQ     TEMP_PRIV,,AUTO
         3 000612   000231 756011 xsym               STQ     AS_USERS+153,X1

      324    13386    7                     AS_MOD_USER.PPRIV_A(4*CODE+MODE) = YES_VAL;

  13386  3 000613   000000 236000 xsym               LDQ     CODE
         3 000614   000002 736000                    QLS     2
         3 000615   200010 036100                    ADLQ    MODE,,AUTO
         3 000616   000001 736000                    QLS     1
         3 000617   000621 605000 3                  TPL     s:13386+6
         3 000620   000044 036003                    ADLQ    36,DU
         3 000621   003006 061400                    CSR     bolr='003'O
         3 000622   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         3 000623   000011 430002 xsym               BDSC    AS_MOD_USER+9,Q          by=2,bit=3,n=2

      325    13387    7                     END;

      326    13388    6                  END;

  13388  3 000624   000643 710000 3                  TRA     s:13405

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:48   
      327    13389    6               ELSE DO;

      328    13390                       %RESETV (VAR="AS_USERS.PPRIV(MODE)",FLAGS=TEMP_PRIV);

  13391  3 000625   200016 236100                    LDQ     TEMP_PRIV,,AUTO
         3 000626   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000627   200010 721100                    LXL1    MODE,,AUTO
         3 000630   000231 376011 xsym               ANQ     AS_USERS+153,X1
         3 000631   000231 756011 xsym               STQ     AS_USERS+153,X1

      329    13393    6                  AS_MOD_USER.PPRIV_A(4*CODE+MODE) = NO_VAL;

  13393  3 000632   000000 236000 xsym               LDQ     CODE
         3 000633   000002 736000                    QLS     2
         3 000634   200010 036100                    ADLQ    MODE,,AUTO
         3 000635   000001 736000                    QLS     1
         3 000636   000640 605000 3                  TPL     s:13393+6
         3 000637   000044 036003                    ADLQ    36,DU
         3 000640   003006 061400                    CSR     bolr='003'O
         3 000641   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         3 000642   000011 430002 xsym               BDSC    AS_MOD_USER+9,Q          by=2,bit=3,n=2

      330    13394    6                  END;

      331    13395                                                              /*
      332    13396                                                                   Mode
      333    13397                                                                   batch   = 0
      334    13398                                                                   ghost   = 1
      335    13399                                                                   on-line = 2
      336    13400                                                                   tp = 3
      337    13401                                                                   ans
      338    13402                                                                   yes = 1
      339    13403                                                                   no = 2
      340    13404                                                              */
      341    13405    5               END ; /* Do j */

  13405  3 000643   200005 054100                    AOS     J,,AUTO
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:49   
         3 000644   200005 236100                    LDQ     J,,AUTO
         3 000645   200011 116100                    CMPQ    NUM,,AUTO
         3 000646   000474 604000 3                  TMI     s:13331

  13394  3 000647                       PPRIV_DO_I   null
      342    13406    4   PPRIV_DO_I: ;
      343    13407    4            END ; /*  Do i  */

  13407  3 000647   200004 054100                    AOS     I,,AUTO
         3 000650   200012 236100                    LDQ     SUBNODES,,AUTO
         3 000651   000002 136007                    SBLQ    2,DL
         3 000652   200004 116100                    CMPQ    I,,AUTO
         3 000653   000404 605000 3                  TPL     s:13301

      344    13408    3         END ; /* Do while (more) */

  13408  3 000654   200013 234100                    SZN     MORE,,AUTO
         3 000655   000347 604000 3                  TMI     s:13291

  13406  3 000656                       PPRIV_ERR    null
      345    13409    2   PPRIV_ERR: ;
      346    13410    2      CALL ASH$ERROR( P_PCB.ERROR );

  13410  3 000656   000007 630400 4                  EPPR0   7
         3 000657   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000660   000000 701000 xent               TSX1    ASH$ERROR
         3 000661   000000 011000                    NOP     0

      347    13411    2      END ; /* Do while( dummy ) */

  13411  3 000662   200014 234100                    SZN     DUMMY,,AUTO
         3 000663   000345 604000 3                  TMI     PPRIV_LOOP

      348    13412    1   END       ASC$PRIV ;

  13412  3 000664   000000 702200 xent               TSX2  ! X66_ARET
      349    13413        %EOD ;
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:50   

PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:51   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$PRIV.
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:52   

 **** Variables and constants ****

  ****  Section 002 RoData ASC$PRIV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(18)    r     1 ERR_FCG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w SBIN        r     1 ANS                        3-0-0/w UBIN        r     1 ARS
    14-0-0/b BIT         r     1 DUMMY                      4-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                          6-0-0/w SBIN        r     1 K
    10-0-0/w SBIN        r     1 MODE                      13-0-0/b BIT         r     1 MORE
    11-0-0/w SBIN        r     1 NUM                       15-0-0/w PTR         r     1 P$
    12-0-0/w SBIN        r     1 SUBNODES                  16-0-0/w BIT         r     1 TEMP_PRIV

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/w STRC(18576) r     1 AS_DFLT
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/c STRC(315)   r     1 AS_MODE
     0-0-0/c STRC(63)    r     1 AS_MODE_ARRY(0:4)
     0-0-0/w STRC(1483)  r     1 AS_MOD_USER
     0-0-0/w BIT         r     1 AS_PPRIVILEGE(0:20)
     0-0-0/w PTR         r     1 AS_PPRIV_NAMES(0:20)
     0-0-0/w BIT         r     1 AS_PRIVILEGE(0:23)
     0-0-0/w PTR         r     1 AS_PRIV_NAMES(0:23)
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w UBIN        r     1 CR_MOD_TREE
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:53   
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/w PTR         r     1 NODE$                      0-0-0/w UBIN        r     1 PPRIV_S_OPT
     0-0-0/w UBIN        r     1 PRIV_S_OPT                 0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/d REMB        r     1 REMEM_VAR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(45)    r     1 P$LIT                      0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASC$PRIV requires 437 words for executable code.
   Procedure ASC$PRIV requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:54   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:55   
          MINI XREF LISTING

ANS
     13126**DCL     13203<<ASSIGN  13205<<ASSIGN  13207>>IF      13335<<ASSIGN  13337<<ASSIGN  13339>>IF
ARS
     13122**DCL     13163<>CALL    13164>>ASSIGN  13294<>CALL    13295>>ASSIGN
ASA_BRKS_LOC
     10134**DCL     10134--REDEF
ASB$READ_SI
     13099**DCL-ENT 13163--CALL    13294--CALL
ASB$SET_PROMPT
     13102**DCL-ENT 13162--CALL    13293--CALL
ASH$DQUEST
     13108**DCL-ENT 13183--CALL    13314--CALL
ASH$ERROR
     13114**DCL-ENT 13248--CALL    13278--CALL    13380--CALL    13410--CALL
ASH$HELP
     13105**DCL-ENT 13179--CALL    13310--CALL
ASH$QUEST
     13111**DCL-ENT 13187--CALL    13318--CALL
AS_CR_MOD_PROJ
     10142**DCL     13209>>IF      13214>>DOSELCT 13341>>IF      13346>>DOSELCT
AS_DEFAULT.BANNER_PERM
     10827**DCL     10828--REDEF
AS_DEFAULT.BUDGET.MACCT
     10732**DCL     10736--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10745**DCL     10748--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10728**DCL     10730--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10723**DCL     10725--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10843**DCL     10844--REDEF   10845--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:56   
AS_DEFAULT_DREC.PASSWORD
     12097**DCL     12101--REDEF
AS_DEFAULT_DREC.RENAME
     12120**DCL     12121--REDEF
AS_DFLT.BANNER_PERM
     10649**DCL     10650--REDEF
AS_DFLT.BUDGET.MACCT
     10554**DCL     10558--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10567**DCL     10570--REDEF
AS_DFLT.BUDGET.PACCUM
     10550**DCL     10552--REDEF
AS_DFLT.BUDGET.PMAXC
     10545**DCL     10547--REDEF
AS_DFLT.PPRIV
     10613**DCL     13341>>IF
AS_DFLT.PRIV
     10612**DCL     13209>>IF
AS_DFLT.SETUP_CHRA.TXT
     10665**DCL     10666--REDEF   10667--REDEF
AS_FE_MODE
     10000**DCL     10001--REDEF
AS_FIELD1
     10130**DCL     13245<<ASSIGN  13377<<ASSIGN
AS_FIELD2.COUNT
     10131**DCL     13246<<ASSIGN  13378<<ASSIGN
AS_FIELD2.TEXT
     10131**DCL     13247<<ASSIGN  13379<<ASSIGN
AS_MODE
      9997**DCL      9999--REDEF
AS_MODE_ARRY
      9999**DCL     13245>>ASSIGN  13377>>ASSIGN
AS_MOD_USER.ACCESS
     12862**DCL     12863--REDEF
AS_MOD_USER.BANNER
     12849**DCL     12850--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:57   
AS_MOD_USER.BANNER_PERM
     12851**DCL     12852--REDEF
AS_MOD_USER.BILL
     12857**DCL     12858--REDEF
AS_MOD_USER.CPROC
     12853**DCL     12854--REDEF
AS_MOD_USER.FEBILL
     12933**DCL     12934--REDEF
AS_MOD_USER.FECXTMEM
     12950**DCL     12951--REDEF
AS_MOD_USER.FEMINTS
     12935**DCL     12936--REDEF
AS_MOD_USER.FEMMEM
     12946**DCL     12947--REDEF
AS_MOD_USER.FEMTIME
     12944**DCL     12945--REDEF
AS_MOD_USER.FEPPRIV
     12941**DCL     12943--REDEF
AS_MOD_USER.FEPRIV
     12938**DCL     12940--REDEF
AS_MOD_USER.FORCE_BIT
     12847**DCL     12848--REDEF
AS_MOD_USER.KEY
     12929**DCL     12931--REDEF
AS_MOD_USER.LASTCPROC
     12855**DCL     12856--REDEF
AS_MOD_USER.LIMITS.DO_
     12903**DCL     12904--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12919**DCL     12920--REDEF
AS_MOD_USER.LIMITS.LO
     12899**DCL     12900--REDEF
AS_MOD_USER.LIMITS.MEM
     12895**DCL     12896--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12923**DCL     12924--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:58   
AS_MOD_USER.LIMITS.PDIS
     12911**DCL     12912--REDEF
AS_MOD_USER.LIMITS.PO
     12907**DCL     12908--REDEF
AS_MOD_USER.LIMITS.TDIS
     12915**DCL     12916--REDEF
AS_MOD_USER.LIMITS.TIME
     12891**DCL     12892--REDEF
AS_MOD_USER.MAXENQ
     12872**DCL     12873--REDEF
AS_MOD_USER.PERM_BIT
     12845**DCL     12846--REDEF
AS_MOD_USER.PPRIV
     12867**DCL     12869--REDEF
AS_MOD_USER.PPRIV_A
     12869**DCL     13386<<ASSIGN  13393<<ASSIGN
AS_MOD_USER.PRIOB
     12874**DCL     12875--REDEF
AS_MOD_USER.PRIV
     12864**DCL     12866--REDEF
AS_MOD_USER.PRIV_A
     12866**DCL     13254<<ASSIGN  13261<<ASSIGN
AS_MOD_USER.QUAN
     12870**DCL     12871--REDEF
AS_MOD_USER.SETUP
     12843**DCL     12844--REDEF
AS_PPRIVILEGE
      9997**DCL     13325>>ASSIGN
AS_PPRIV_NAMES
      9996**DCL     13378>>ASSIGN  13379>>ASSIGN  13379>>ASSIGN
AS_PRIVILEGE
      9997**DCL     13194>>ASSIGN
AS_PRIV_NAMES
      9996**DCL     13246>>ASSIGN  13247>>ASSIGN  13247>>ASSIGN
AS_PROJECT.BANNER_PERM
     11183**DCL     11184--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:59   
AS_PROJECT.BUDGET.MACCT
     11088**DCL     11092--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11101**DCL     11104--REDEF
AS_PROJECT.BUDGET.PACCUM
     11084**DCL     11086--REDEF
AS_PROJECT.BUDGET.PMAXC
     11079**DCL     11081--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11199**DCL     11200--REDEF   11201--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11361**DCL     11362--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11266**DCL     11270--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11279**DCL     11282--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11262**DCL     11264--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11257**DCL     11259--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11377**DCL     11378--REDEF   11379--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12583**DCL     12587--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12606**DCL     12607--REDEF
AS_PROJECT_DREC.PASSWORD
     12421**DCL     12425--REDEF
AS_PROJECT_DREC.RENAME
     12444**DCL     12445--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     11005**DCL     11006--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10910**DCL     10914--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10923**DCL     10926--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:60   
AS_PROJ_ADMIN.BUDGET.PACCUM
     10906**DCL     10908--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10901**DCL     10903--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11021**DCL     11022--REDEF   11023--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12259**DCL     12263--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12282**DCL     12283--REDEF
AS_TRUE
      9994**DCL     13154>>ASSIGN  13155>>ASSIGN  13285>>ASSIGN  13286>>ASSIGN
AS_USERS.BANNER_PERM
     10471**DCL     10472--REDEF
AS_USERS.BUDGET.MACCT
     10376**DCL     10380--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10389**DCL     10392--REDEF
AS_USERS.BUDGET.PACCUM
     10372**DCL     10374--REDEF
AS_USERS.BUDGET.PMAXC
     10367**DCL     10369--REDEF
AS_USERS.PPRIV
     10435**DCL     13384<<ASSIGN  13384>>ASSIGN  13391<<ASSIGN  13391>>ASSIGN
AS_USERS.PRIV
     10434**DCL     13252<<ASSIGN  13252>>ASSIGN  13259<<ASSIGN  13259>>ASSIGN
AS_USERS.SETUP_CHRA.TXT
     10487**DCL     10488--REDEF   10489--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11539**DCL     11540--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11444**DCL     11448--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11457**DCL     11460--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11440**DCL     11442--REDEF
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:61   
AS_USERS_CONSTANT.BUDGET.PMAXC
     11435**DCL     11437--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11555**DCL     11556--REDEF   11557--REDEF
CODE
     10127**DCL     13170<<ASSIGN  13171>>DOSELCT 13191<<ASSIGN  13194>>ASSIGN  13246>>ASSIGN  13247>>ASSIGN
     13247>>ASSIGN  13254>>ASSIGN  13261>>ASSIGN  13301<<ASSIGN  13302>>DOSELCT 13322<<ASSIGN  13325>>ASSIGN
     13378>>ASSIGN  13379>>ASSIGN  13379>>ASSIGN  13386>>ASSIGN  13393>>ASSIGN
CR_MOD_TREE
      9986**DCL     13175--ASSIGN  13306--ASSIGN
DUMMY
     13131**DCL     13155<<ASSIGN  13157>>DOWHILE 13286<<ASSIGN  13288>>DOWHILE
ERR_CODE
     10129**DCL     10130--REDEF   13213<<ASSIGN  13248<>CALL    13327<<ASSIGN  13345<<ASSIGN  13380<>CALL
ERR_CODE.CODE
     10129**DCL     13174<<ASSIGN  13195<<ASSIGN  13223<<ASSIGN  13233<<ASSIGN  13243<<ASSIGN  13305<<ASSIGN
     13355<<ASSIGN  13365<<ASSIGN  13375<<ASSIGN
ERR_FCG
     13140**DCL     13213>>ASSIGN  13345>>ASSIGN
I
     13123**DCL     13168<<DOINDEX 13170>>ASSIGN  13191>>ASSIGN  13192>>ASSIGN  13299<<DOINDEX 13301>>ASSIGN
     13322>>ASSIGN  13323>>ASSIGN
IN_BUF
     10125**DCL     13163<>CALL    13294<>CALL
J
     13124**DCL     13198<<DOINDEX 13199>>ASSIGN  13201>>ASSIGN  13203>>ASSIGN  13330<<DOINDEX 13331>>ASSIGN
     13333>>ASSIGN  13335>>ASSIGN
K
     13125**DCL     13201<<ASSIGN  13202>>IF      13333<<ASSIGN  13334>>IF
KL_DEFAULT.PASSWORD
     12745**DCL     12749--REDEF
KL_DEFAULT.RENAME
     12768**DCL     12769--REDEF
KL_DFLT.PASSWORD
     11935**DCL     11939--REDEF
KL_DFLT.RENAME
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:62   
     11958**DCL     11959--REDEF
KL_DREC.PASSWORD
     11773**DCL     11777--REDEF
KL_DREC.RENAME
     11796**DCL     11797--REDEF
KL_DREC_CNT.PASSWORD
     11660**DCL     11664--REDEF
KL_DREC_CNT.RENAME
     11683**DCL     11684--REDEF
MODE
     13127**DCL     13199<<ASSIGN  13209>>IF      13245>>ASSIGN  13252>>ASSIGN  13252>>ASSIGN  13254>>ASSIGN
     13259>>ASSIGN  13259>>ASSIGN  13261>>ASSIGN  13331<<ASSIGN  13341>>IF      13377>>ASSIGN  13384>>ASSIGN
     13384>>ASSIGN  13386>>ASSIGN  13391>>ASSIGN  13391>>ASSIGN  13393>>ASSIGN
MORE
     13130**DCL     13154<<ASSIGN  13159>>DOWHILE 13285<<ASSIGN  13290>>DOWHILE
NODE$
     10127**DCL     12999--IMP-PTR 13166<<ASSIGN  13167>>ASSIGN  13170>>ASSIGN  13191>>ASSIGN  13192>>ASSIGN
     13297<<ASSIGN  13298>>ASSIGN  13301>>ASSIGN  13322>>ASSIGN  13323>>ASSIGN
NUM
     13128**DCL     13196<<ASSIGN  13198>>DOINDEX 13328<<ASSIGN  13330>>DOINDEX
P$
     13132**DCL     13192<<ASSIGN  13196>>ASSIGN  13199>>ASSIGN  13201>>ASSIGN  13203>>ASSIGN  13323<<ASSIGN
     13328>>ASSIGN  13331>>ASSIGN  13333>>ASSIGN  13335>>ASSIGN
P$LIT.COUNT
     13079**DCL     13082--IMP-SIZ 13246>>ASSIGN  13247>>ASSIGN  13378>>ASSIGN  13379>>ASSIGN
P$LIT.TEXT
     13082**DCL     13247>>ASSIGN  13379>>ASSIGN
P$NODE.CODE
     13007**DCL     13170>>ASSIGN  13191>>ASSIGN  13199>>ASSIGN  13203>>ASSIGN  13301>>ASSIGN  13322>>ASSIGN
     13331>>ASSIGN  13335>>ASSIGN
P$NODE.SUBLK$
     13032**DCL     13170>>ASSIGN  13191>>ASSIGN  13191>>ASSIGN  13192>>ASSIGN  13192>>ASSIGN  13199>>ASSIGN
     13199>>ASSIGN  13201>>ASSIGN  13203>>ASSIGN  13203>>ASSIGN  13301>>ASSIGN  13322>>ASSIGN  13322>>ASSIGN
     13323>>ASSIGN  13323>>ASSIGN  13331>>ASSIGN  13331>>ASSIGN  13333>>ASSIGN  13335>>ASSIGN  13335>>ASSIGN
P$NODE.SUBNODES
     13011**DCL     13167>>ASSIGN  13196>>ASSIGN  13201>>ASSIGN  13298>>ASSIGN  13328>>ASSIGN  13333>>ASSIGN
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:63   
PPRIV_DO_I
     13394**LABEL   13311--GOTO    13315--GOTO    13319--GOTO
PPRIV_ERR
     13406**LABEL   13296--CALLALT
PPRIV_LOOP
     13282**LABEL   13291--REMEMBR
PPRIV_S_OPT
     13144**DCL     13284--ASSIGN
PRIV_DO_I
     13262**LABEL   13180--GOTO    13184--GOTO    13188--GOTO
PRIV_ERR
     13274**LABEL   13165--CALLALT
PRIV_LOOP
     13153**LABEL   13160--REMEMBR
PRIV_S_OPT
      9986**DCL     13153--ASSIGN
PROJ_KEY.TEXT
     10007**DCL     10007--REDEF
PROJ_KEY.TXT.PROJECT
     10007**DCL     10007--REDEF
P_PCB
     10162**DCL     13165<>CALL    13296<>CALL
P_PCB.ERROR
     10266**DCL     13278<>CALL    13410<>CALL
P_PCB.NCHARS
     10309**DCL     13164<<ASSIGN  13295<<ASSIGN
P_PCB.OUT$
     10175**DCL     13166>>ASSIGN  13297>>ASSIGN
P_PCB.ROOT$
     10167**DCL     13153<<ASSIGN  13175<<ASSIGN  13284<<ASSIGN  13306<<ASSIGN
REMEM_VAR
     10133**DCL     10133--REDEF   13160<<REMEMBR 13291<<REMEMBR
REM_FCMD
     10133**DCL     10134--REDEF
SUBNODES
     13129**DCL     13167<<ASSIGN  13168>>DOINDEX 13298<<ASSIGN  13299>>DOINDEX
PL6.E3A0      #001=ASC$PRIV File=ASC$PRIV.:E05TSI                                TUE 07/29/97 09:38 Page:64   
TEMP_PRIV
     13133**DCL     13194<<ASSIGN  13209>>IF      13252>>ASSIGN  13259>>ASSIGN  13325<<ASSIGN  13341>>IF
     13384>>ASSIGN  13391>>ASSIGN
USERS_KEY.TEXT
     10004**DCL     10005--REDEF   10005--REDEF   10005--REDEF   10006--REDEF
X$PARSE
     13097**DCL-ENT 13165--CALL    13296--CALL

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:65   
      350        1        /*T***********************************************************/
      351        2        /*T*                                                         */
      352        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      353        4        /*T*                                                         */
      354        5        /*T***********************************************************/
      355        6        /********************************************************************/
      356        7        /*                                                                   */
      357        8        /*                   ASC$FEPRIV            proc                        */
      358        9        /*                                                                   */
      359       10        /*********************************************************************/
      360       11                                                              /**/
      361       12        ASC$FEPRIV: PROC ;
      362       13                                                              /**/
      363       14        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:66   
      364       15        /********************************************************************/
      365       16        /*   Include files   include files   include files   include files   */
      366       17        /*********************************************************************/
      367       18                                                              /**/
      368       19        %INCLUDE      AS_ENTRIES_M ;
      369     1069        %INCLUDE      AS_SUPER_C   ;
      370     1504        %INCLUDE      AS_MAC_C     ;
      371     1584        %INCLUDE      AS_SUBS_C    ;
      372     2998        %INCLUDE      AS_PERR_C    ;
      373     3600        %INCLUDE      B_MACROS_C   ;
      374     3711        %INCLUDE      CP_6         ;
      375     3792        %INCLUDE      XU_MACRO_C   ;
      376     6898        %INCLUDE      XU_FORMAT_C  ;
      377     7060        %INCLUDE      KL_SUPER_C   ;
      378     9962        %INCLUDE      AS_SUPER_R   ;
      379    12978                                                              /**/
      380    12979        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:67   
      381    12980        /********************************************************************/
      382    12981        /*   Local based     local based     local based     local based     */
      383    12982        /*********************************************************************/
      384    12983                                                              /**/
      385    12984            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      386    12985                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      387    13030        %P$LIT( NAME=P$LIT, STCLASS=BASED, LEN="P$LIT.COUNT" );
      388    13083                                                              /**/
      389    13084        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:68   
      390    13085        /********************************************************************/
      391    13086        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      392    13087        /*********************************************************************/
      393    13088                                                              /**/
      394    13089    1   DCL X$PARSE ENTRY(1) ALTRET ;
      395    13090        %ASB$READ_SI ;
      396    13093        %ASB$SET_PROMPT ;
      397    13096        %ASH$HELP ;
      398    13099        %ASH$DQUEST ;
      399    13102        %ASH$QUEST ;
      400    13105        %ASH$ERROR ;
      401    13108                                                              /**/
      402    13109        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:69   
      403    13110        /********************************************************************/
      404    13111        /*   Auto data       auto data       auto data       auto data       */
      405    13112        /*********************************************************************/
      406    13113                                                              /**/
      407    13114    1   DCL ARS UBIN ;
      408    13115    1   DCL I SBIN ;
      409    13116    1   DCL J SBIN ;
      410    13117    1   DCL K SBIN ;
      411    13118    1   DCL ANS SBIN ;
      412    13119    1   DCL MODE SBIN ;
      413    13120    1   DCL NUM SBIN ;
      414    13121    1   DCL SUBNODES SBIN ;
      415    13122    1   DCL MORE BIT(1) ;
      416    13123    1   DCL DUMMY BIT(1) ;
      417    13124    1   DCL P$ PTR ;
      418    13125    1   DCL TEMP_FEPRIV BIT(36) ALIGNED ;
      419    13126        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:70   
      420    13127        /********************************************************************/
      421    13128        /*   Static data     static data     static data     static data     */
      422    13129        /*********************************************************************/
      423    13130                                                              /**/
      424    13131    1   DCL 1 ERR_FCG CONSTANT ,
      425    13132    1          2 FCG_MID UBIN(18) UNAL INIT(5315) ;     /*  'ASC' in sixbit.  */
      426    13133    1   DCL 1 ASH_FCG CONSTANT ,
      427    13134    1          2 FCG_MID UBIN(18) UNAL INIT(5320) ;     /*  'ASH' in sixbit.  */
      428    13135    1   DCL FEPPRIV_S_OPT UBIN WORD SYMREF ;
      429    13136        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:71   
      430    13137        /********************************************************************/
      431    13138        /*   Procedure       procedure       procedure       procedure       */
      432    13139        /*********************************************************************/
      433    13140                                                              /**/
      434    13141        /*
      435    13142            ***            Begin procedure                    ***
      436    13143        */
      437    13144    1   P_PCB.ROOT$ = ADDR(FEPRIV_S_OPT) ;
      438    13145    1   MORE = AS_TRUE ;
      439    13146    1   DUMMY = AS_TRUE ;
      440    13147                                                              /**/
      441    13148    2   DO WHILE (DUMMY) ;
      442    13149    2   FEPRIV_LOOP: ;
      443    13150    3      DO WHILE (MORE) ;
      444    13151    3         REMEMBER FEPRIV_LOOP IN REMEM_VAR ;
      445    13152                                                              /*  Set prompt  */
      446    13153    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;
      447    13154    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */
      448    13155    3         P_PCB.NCHARS = ARS ;
      449    13156    3         CALL X$PARSE(P_PCB) ALTRET (FEPRIV_ERR) ;
      450    13157    3         NODE$ = P_PCB.OUT$ ;
      451    13158    3         SUBNODES = P$NODE.SUBNODES ;
      452    13159    4         DO I = 0 TO SUBNODES - 2 ;
      453    13160                                                              /* Check for end */
      454    13161    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
      455    13162    5            DO SELECT (CODE) ;
      456    13163                                                              /**/
      457    13164    5               SELECT (END_VAL, BLANK_LINE_VAL) ;
      458    13165    5               ERR_CODE.CODE = 0 ;
      459    13166    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      460    13167    5               RETURN ;
      461    13168                                                              /**/
      462    13169    5               SELECT(HELP_VAL) ;
      463    13170    5               CALL ASH$HELP ;
      464    13171    5               GOTO FEPRIV_DO_I ;
      465    13172                                                              /**/
      466    13173    5               SELECT(DQUESTION_VAL) ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:72   
      467    13174    5               CALL ASH$DQUEST ;
      468    13175    5               GOTO FEPRIV_DO_I ;
      469    13176                                                              /**/
      470    13177    5               SELECT(QUESTION_VAL) ;
      471    13178    5               CALL ASH$QUEST ;
      472    13179    5               GOTO FEPRIV_DO_I ;
      473    13180                                                              /**/
      474    13181    5               END ;   /*  Do case (code)  */
      475    13182    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      476    13183    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
      477    13184                                                              /**/
      478    13185    4            TEMP_FEPRIV = AS_PRIVILEGE(CODE);
      479    13186    4            ERR_CODE.CODE = 0 ;
      480    13187    4            NUM = P$ -> P$NODE.SUBNODES ;
      481    13188                                                              /**/
      482    13189    5            DO J = 0 TO NUM-1 ;
      483    13190    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)
      484    13191    5                    -> P$NODE.CODE ;
      485    13192    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;
      486    13193    5               IF K = 2
      487    13194    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)
      488    13195    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      489    13196    5               ELSE ANS = 1 ;
      490    13197                                                              /**/
      491    13198    5               IF ANS = 1
      492    13199    6               THEN DO;
      493    13200    6                  IF  AS_CR_MOD_PROJ > 0
      494    13201    6                       AND
      495    13202    6                       (TEMP_FEPRIV & KL_DFLT.KL_DFLT_FEBLK.PRIV(MODE)) = '0'B
      496    13203    7                  THEN DO;
      497    13204    7                     ERR_CODE = ERR_FCG;
      498    13205    8                     DO SELECT( AS_CR_MOD_PROJ );
      499    13206    8                        SELECT( %CR_PROJ_USER );
      500    13207        /*E* ERROR:   ASC-E$CANT_GIVE_FEPRIVTO_USER-C
      501    13208             MESSAGE: %U1 %U2 feprivilege not allowed.
      502    13209             MESSAGE1: Users in your project are not allowed to have the %U2 feprivilege
      503    13210                       in %U1 access mode.
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:73   
      504    13211             MESSAGE2: No user in the project may have a feprivilege not specified in
      505    13212                       the default record for the project.
      506    13213        */
      507    13214    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_USER;
      508    13215
      509    13216    8                        SELECT( %CR_PROJECT );
      510    13217        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPRIVTO_PROJ-C
      511    13218              MESSAGE: %U1 %U2 feprivilege not allowed.
      512    13219              MESSAGE1: Projects you create are not allowed to have the %U2 feprivilege
      513    13220                        in %U1 access mode.
      514    13221              MESSAGE2: Your project does not have that feprivilege, so you are not
      515    13222                        allowed to give the feprivilege to a project you create.
      516    13223        */
      517    13224    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_PROJ;
      518    13225
      519    13226    8                        SELECT( %CR_PROJ_DEFAULT );
      520    13227        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPRIVTO_DFLT-C
      521    13228            MESSAGE: %U1 %U2 feprivilege not allowed.
      522    13229            MESSAGE1: Users in a project you create are not allowed to have the
      523    13230                     %U2 feprivilege in %U1 access mode.
      524    13231            MESSAGE2: Your project does not have that feprivilege, so you are not allowed
      525    13232                      to give the feprivilege to users in a project you create.
      526    13233        */
      527    13234    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_DFLT;
      528    13235    8                        END;              /* Do case */
      529    13236    7                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE);
      530    13237    7                     AS_FIELD2.COUNT = AS_PRIV_NAMES(CODE) -> P$LIT.COUNT;
      531    13238    7                     AS_FIELD2.TEXT = AS_PRIV_NAMES(CODE) -> P$LIT.TEXT;
      532    13239    7                     CALL ASH$ERROR( ERR_CODE );
      533    13240    7                     END;
      534    13241    7                  ELSE DO;
      535    13242                          %SETV (VAR="KL_DREC.KL_DREC_FEBLK.PRIV(MODE)",FLAGS=TEMP_FEPRIV);
      536    13245    7                     AS_MOD_USER.FEPRIV_A(4*CODE+MODE) = YES_VAL;
      537    13246    7                     END;
      538    13247    6                  END;
      539    13248    6               ELSE DO;
      540    13249                       %RESETV (VAR="KL_DREC.KL_DREC_FEBLK.PRIV(MODE)",FLAGS=TEMP_FEPRIV);
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:74   
      541    13252    6                  AS_MOD_USER.FEPRIV_A(4*CODE+MODE) = NO_VAL;
      542    13253    6                  END;
      543    13254                                                              /*
      544    13255                                                                   Mode
      545    13256                                                                   dcb   = 0
      546    13257                                                                   comgroup   = 1
      547    13258                                                                   handler = 2
      548    13259                                                                   ghost = 3
      549    13260                                                                   ans
      550    13261                                                                   yes = 1
      551    13262                                                                   no = 2
      552    13263                                                              */
      553    13264    5               END ; /* Do j */
      554    13265    4   FEPRIV_DO_I: ;
      555    13266    4            END ; /*  Do i  */
      556    13267    3         END ; /* Do while (more) */
      557    13268    2   FEPRIV_ERR: ;
      558    13269    2      CALL ASH$ERROR( P_PCB.ERROR );
      559    13270    2      END ; /* Do while (dummy) */
      560    13271                                                              /**/
      561    13272        %EJECT;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:75   
      562    13273    1   ASC$FEPPRIV: ENTRY ;
      563    13274                                                              /**/
      564    13275    1   P_PCB.ROOT$ = ADDR(FEPPRIV_S_OPT) ;
      565    13276    1   MORE = AS_TRUE ;
      566    13277    1   DUMMY = AS_TRUE ;
      567    13278                                                              /**/
      568    13279    2   DO WHILE (DUMMY) ;
      569    13280    2   FEPPRIV_LOOP: ;
      570    13281    3      DO WHILE (MORE) ;
      571    13282    3         REMEMBER FEPPRIV_LOOP IN REMEM_VAR ;
      572    13283                                                              /* Set prompt */
      573    13284    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;
      574    13285    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */
      575    13286    3         P_PCB.NCHARS = ARS ;
      576    13287    3         CALL X$PARSE(P_PCB) ALTRET (FEPPRIV_ERR) ;
      577    13288    3         NODE$ = P_PCB.OUT$ ;
      578    13289    3         SUBNODES = P$NODE.SUBNODES ;
      579    13290    4         DO I = 0 TO SUBNODES - 2 ;
      580    13291                                                              /* Check for end */
      581    13292    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
      582    13293    5            DO SELECT (CODE) ;
      583    13294                                                              /**/
      584    13295    5               SELECT (END_VAL, BLANK_LINE_VAL) ;
      585    13296    5               ERR_CODE.CODE = 0 ;
      586    13297    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      587    13298    5               RETURN ;
      588    13299                                                              /**/
      589    13300    5               SELECT(HELP_VAL) ;
      590    13301    5               CALL ASH$HELP ;
      591    13302    5               GOTO FEPPRIV_DO_I ;
      592    13303                                                              /**/
      593    13304    5               SELECT(DQUESTION_VAL) ;
      594    13305    5               CALL ASH$DQUEST ;
      595    13306    5               GOTO FEPPRIV_DO_I ;
      596    13307                                                              /**/
      597    13308    5               SELECT(QUESTION_VAL) ;
      598    13309    5               CALL ASH$QUEST ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:76   
      599    13310    5               GOTO FEPPRIV_DO_I ;
      600    13311                                                              /**/
      601    13312    5               END ;   /*  Do case (code)  */
      602    13313    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      603    13314    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
      604    13315                                                              /**/
      605    13316    4            TEMP_FEPRIV = AS_PPRIVILEGE(CODE);
      606    13317                                                                  /**/
      607    13318    4            ERR_CODE = '0'B ;
      608    13319    4            NUM = P$ -> P$NODE.SUBNODES ;
      609    13320                                                              /**/
      610    13321    5            DO J = 0 TO NUM-1 ;
      611    13322    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)
      612    13323    5                    -> P$NODE.CODE ;
      613    13324    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;
      614    13325    5               IF K = 2
      615    13326    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)
      616    13327    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      617    13328    5               ELSE ANS = 1 ;
      618    13329                                                              /**/
      619    13330    5               IF ANS = 1
      620    13331    6               THEN DO;
      621    13332    6                  IF AS_CR_MOD_PROJ > 0
      622    13333    6                       AND
      623    13334    6                       (TEMP_FEPRIV & KL_DFLT.KL_DFLT_FEBLK.PPRIV(MODE)) = '0'B
      624    13335    7                  THEN DO;
      625    13336    7                     ERR_CODE = ERR_FCG;
      626    13337    8                     DO SELECT( AS_CR_MOD_PROJ );
      627    13338    8                        SELECT( %CR_PROJ_USER );
      628    13339        /*E* ERROR:   ASC-E$CANT_GIVE_FEPPRIVTO_USER-C
      629    13340             MESSAGE: %U1 %U2 fepprivilege not allowed.
      630    13341             MESSAGE1: Users in your project are not allowed to have the %U2 fepprivilege
      631    13342                       in %U1 access mode.
      632    13343             MESSAGE2: No user in the project may have a fepprivilege not specified in
      633    13344                       the default record for the project.
      634    13345        */
      635    13346    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_USER;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:77   
      636    13347
      637    13348    8                        SELECT( %CR_PROJECT );
      638    13349        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPPRIVTO_PROJ-C
      639    13350              MESSAGE: %U1 %U2 fepprivilege not allowed.
      640    13351              MESSAGE1: Projects you create are not allowed to have the %U2 fepprivilege
      641    13352                        in %U1 access mode.
      642    13353              MESSAGE2: Your project does not have that fepprivilege, so you are not
      643    13354                        allowed to give the fepprivilege to a project you create.
      644    13355        */
      645    13356    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_PROJ;
      646    13357
      647    13358    8                        SELECT( %CR_PROJ_DEFAULT );
      648    13359        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPPRIVTO_DFLT-C
      649    13360              MESSAGE: %U1 %U2 fepprivilege not allowed.
      650    13361            MESSAGE1: Users in a project you create are not allowed to have the
      651    13362                     %U2 fepprivilege in %U1 access mode.
      652    13363            MESSAGE2: Your project does not have that fepprivilege, so you are not allowed
      653    13364                      to give the fepprivilege to users in a project you create.
      654    13365        */
      655    13366    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_DFLT;
      656    13367    8                        END;              /* Do case */
      657    13368    7                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE);
      658    13369    7                     AS_FIELD2.COUNT = AS_PPRIV_NAMES(CODE) -> P$LIT.COUNT;
      659    13370    7                     AS_FIELD2.TEXT = AS_PPRIV_NAMES(CODE) -> P$LIT.TEXT;
      660    13371    7                     CALL ASH$ERROR( ERR_CODE );
      661    13372    7                     END;
      662    13373    7                  ELSE DO;
      663    13374                          %SETV (VAR="KL_DREC.KL_DREC_FEBLK.PPRIV(MODE)",FLAGS=TEMP_FEPRIV);
      664    13377    7                     AS_MOD_USER.FEPPRIV_A(4*CODE+MODE) = YES_VAL;
      665    13378    7                     END;
      666    13379    6                  END;
      667    13380    6               ELSE DO;
      668    13381                       %RESETV (VAR="KL_DREC.KL_DREC_FEBLK.PPRIV(MODE)",FLAGS=TEMP_FEPRIV);
      669    13384    6                  AS_MOD_USER.FEPPRIV_A(4*CODE+MODE) = NO_VAL;
      670    13385    6                  END;
      671    13386                                                              /*
      672    13387                                                                   Mode
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:78   
      673    13388                                                                   dcb   = 0
      674    13389                                                                   comgroup   = 1
      675    13390                                                                   handler = 2
      676    13391                                                                   ghost = 3
      677    13392                                                                   ans
      678    13393                                                                   yes = 1
      679    13394                                                                   no = 2
      680    13395                                                              */
      681    13396    5               END ; /* Do j */
      682    13397    4   FEPPRIV_DO_I: ;
      683    13398    4            END ; /*  Do i  */
      684    13399    3         END ; /* Do while (more) */
      685    13400    2   FEPPRIV_ERR: ;
      686    13401    2      CALL ASH$ERROR( P_PCB.ERROR );
      687    13402    2      END ; /* Do while( dummy ) */
      688    13403    1   END       ASC$FEPRIV ;

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:79   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$FEPRIV.

   Procedure ASC$FEPRIV requires 437 words for executable code.
   Procedure ASC$FEPRIV requires 18 words of local(AUTO) storage.

    No errors detected in file ASC$PRIV.:E05TSI    .

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:80   

 Object Unit name= ASC$FEPRIV                                 File name= ASC$PRIV.:E05TOU
 UTS= JUL 29 '97 09:40:47.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS      2      2  ASC$FEPRIV
    3   Proc  even  none   437    665  ASC$FEPRIV
    4  RoData even  none     9     11  ASC$FEPRIV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASC$FEPRIV
     3    333                  yes      Std        0  ASC$FEPPRIV
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:81   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
         yes           Std       2 ASH$ERROR
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CR_MOD_TREE                           FEPRIV_S_OPT
r    AS_TRUE                          r    AS_PRIV_NAMES                    r    AS_PPRIV_NAMES
r    AS_PRIVILEGE                     r    AS_PPRIVILEGE                    r    AS_MODE
r    AS_FE_MODE                            M$LO                                  IN_BUF
     NODE$                                 CODE                                  ERR_CODE
     AS_FIELD1                             AS_FIELD2                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          AS_CR_MOD_PROJ
     P_PCB                                 KL_DREC                               KL_DFLT
     AS_MOD_USER                           FEPPRIV_S_OPT                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:82   


      350        1        /*T***********************************************************/
      351        2        /*T*                                                         */
      352        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      353        4        /*T*                                                         */
      354        5        /*T***********************************************************/
      355        6        /********************************************************************/
      356        7        /*                                                                   */
      357        8        /*                   ASC$FEPRIV            proc                        */
      358        9        /*                                                                   */
      359       10        /*********************************************************************/
      360       11                                                              /**/
      361       12        ASC$FEPRIV: PROC ;

     12  3 000000   000000 700200 xent  ASC$FEPRIV   TSX0  ! X66_AUTO_0
         3 000001   000022 000000                    ZERO    18,0

      362       13                                                              /**/
      363       14        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:83   
      364       15        /********************************************************************/
      365       16        /*   Include files   include files   include files   include files   */
      366       17        /*********************************************************************/
      367       18                                                              /**/
      368       19        %INCLUDE      AS_ENTRIES_M ;
      369     1069        %INCLUDE      AS_SUPER_C   ;
      370     1504        %INCLUDE      AS_MAC_C     ;
      371     1584        %INCLUDE      AS_SUBS_C    ;
      372     2998        %INCLUDE      AS_PERR_C    ;
      373     3600        %INCLUDE      B_MACROS_C   ;
      374     3711        %INCLUDE      CP_6         ;
      375     3792        %INCLUDE      XU_MACRO_C   ;
      376     6898        %INCLUDE      XU_FORMAT_C  ;
      377     7060        %INCLUDE      KL_SUPER_C   ;
      378     9962        %INCLUDE      AS_SUPER_R   ;
      379    12978                                                              /**/
      380    12979        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:84   
      381    12980        /********************************************************************/
      382    12981        /*   Local based     local based     local based     local based     */
      383    12982        /*********************************************************************/
      384    12983                                                              /**/
      385    12984            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      386    12985                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      387    13030        %P$LIT( NAME=P$LIT, STCLASS=BASED, LEN="P$LIT.COUNT" );
      388    13083                                                              /**/
      389    13084        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:85   
      390    13085        /********************************************************************/
      391    13086        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      392    13087        /*********************************************************************/
      393    13088                                                              /**/
      394    13089    1   DCL X$PARSE ENTRY(1) ALTRET ;
      395    13090        %ASB$READ_SI ;
      396    13093        %ASB$SET_PROMPT ;
      397    13096        %ASH$HELP ;
      398    13099        %ASH$DQUEST ;
      399    13102        %ASH$QUEST ;
      400    13105        %ASH$ERROR ;
      401    13108                                                              /**/
      402    13109        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:86   
      403    13110        /********************************************************************/
      404    13111        /*   Auto data       auto data       auto data       auto data       */
      405    13112        /*********************************************************************/
      406    13113                                                              /**/
      407    13114    1   DCL ARS UBIN ;
      408    13115    1   DCL I SBIN ;
      409    13116    1   DCL J SBIN ;
      410    13117    1   DCL K SBIN ;
      411    13118    1   DCL ANS SBIN ;
      412    13119    1   DCL MODE SBIN ;
      413    13120    1   DCL NUM SBIN ;
      414    13121    1   DCL SUBNODES SBIN ;
      415    13122    1   DCL MORE BIT(1) ;
      416    13123    1   DCL DUMMY BIT(1) ;
      417    13124    1   DCL P$ PTR ;
      418    13125    1   DCL TEMP_FEPRIV BIT(36) ALIGNED ;
      419    13126        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:87   
      420    13127        /********************************************************************/
      421    13128        /*   Static data     static data     static data     static data     */
      422    13129        /*********************************************************************/
      423    13130                                                              /**/
      424    13131    1   DCL 1 ERR_FCG CONSTANT ,
      425    13132    1          2 FCG_MID UBIN(18) UNAL INIT(5315) ;     /*  'ASC' in sixbit.  */
      426    13133    1   DCL 1 ASH_FCG CONSTANT ,
      427    13134    1          2 FCG_MID UBIN(18) UNAL INIT(5320) ;     /*  'ASH' in sixbit.  */
      428    13135    1   DCL FEPPRIV_S_OPT UBIN WORD SYMREF ;
      429    13136        %EJECT ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:88   
      430    13137        /********************************************************************/
      431    13138        /*   Procedure       procedure       procedure       procedure       */
      432    13139        /*********************************************************************/
      433    13140                                                              /**/
      434    13141        /*
      435    13142            ***            Begin procedure                    ***
      436    13143        */
      437    13144    1   P_PCB.ROOT$ = ADDR(FEPRIV_S_OPT) ;

  13144  3 000002   000000 236000 4                  LDQ     0
         3 000003   000001 756000 xsym               STQ     P_PCB+1

      438    13145    1   MORE = AS_TRUE ;

  13145  3 000004   000000 236000 xsym               LDQ     AS_TRUE
         3 000005   400000 376003                    ANQ     -131072,DU
         3 000006   200013 756100                    STQ     MORE,,AUTO

      439    13146    1   DUMMY = AS_TRUE ;

  13146  3 000007   200014 756100                    STQ     DUMMY,,AUTO

      440    13147                                                              /**/
      441    13148    2   DO WHILE (DUMMY) ;

  13148  3 000010   200014 234100                    SZN     DUMMY,,AUTO
         3 000011   000332 605000 3                  TPL     s:13270+2

  13144  3 000012                       FEPRIV_LOOP  null
      442    13149    2   FEPRIV_LOOP: ;
      443    13150    3      DO WHILE (MORE) ;

  13150  3 000012   200013 234100                    SZN     MORE,,AUTO
         3 000013   000324 605000 3                  TPL     FEPRIV_ERR

      444    13151    3         REMEMBER FEPRIV_LOOP IN REMEM_VAR ;

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:89   
  13151  3 000014   000012 635000 3                  EAA     FEPRIV_LOOP
         3 000015   000000 452400 xsym               STP2    REMEM_VAR
         3 000016   000001 755000 xsym               STA     REMEM_VAR+1

      445    13152                                                              /*  Set prompt  */
      446    13153    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;

  13153  3 000017   000001 630400 4                  EPPR0   1
         3 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000021   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000022   000000 011000                    NOP     0

      447    13154    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */

  13154  3 000023   200003 630500                    EPPR0   ARS,,AUTO
         3 000024   200021 450500                    STP0    TEMP_FEPRIV+3,,AUTO
         3 000025   000002 236000 4                  LDQ     2
         3 000026   200020 756100                    STQ     TEMP_FEPRIV+2,,AUTO
         3 000027   200020 630500                    EPPR0   TEMP_FEPRIV+2,,AUTO
         3 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000031   000000 701000 xent               TSX1    ASB$READ_SI
         3 000032   000000 011000                    NOP     0

      448    13155    3         P_PCB.NCHARS = ARS ;

  13155  3 000033   200003 235100                    LDA     ARS,,AUTO
         3 000034   000011 755000 xsym               STA     P_PCB+9

      449    13156    3         CALL X$PARSE(P_PCB) ALTRET (FEPRIV_ERR) ;

  13156  3 000035   000003 630400 4                  EPPR0   3
         3 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000037   000000 701000 xent               TSX1    X$PARSE
         3 000040   000324 702000 3                  TSX2    FEPRIV_ERR

      450    13157    3         NODE$ = P_PCB.OUT$ ;

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:90   
  13157  3 000041   000003 236000 xsym               LDQ     P_PCB+3
         3 000042   000000 756000 xsym               STQ     NODE$

      451    13158    3         SUBNODES = P$NODE.SUBNODES ;

  13158  3 000043   000000 470400 xsym               LDP0    NODE$
         3 000044   000001 236100                    LDQ     1,,PR0
         3 000045   000022 772000                    QRL     18
         3 000046   200012 756100                    STQ     SUBNODES,,AUTO

      452    13159    4         DO I = 0 TO SUBNODES - 2 ;

  13159  3 000047   200004 450100                    STZ     I,,AUTO
         3 000050   000316 710000 3                  TRA     FEPRIV_DO_I+1

      453    13160                                                              /* Check for end */
      454    13161    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;

  13161  3 000051   000000 470400 xsym               LDP0    NODE$
         3 000052   200004 720100                    LXL0    I,,AUTO
         3 000053   000003 471510                    LDP1    3,X0,PR0
         3 000054   100000 236100                    LDQ     0,,PR1
         3 000055   777777 376007                    ANQ     -1,DL
         3 000056   000000 756000 xsym               STQ     CODE

      455    13162    5            DO SELECT (CODE) ;

  13162  3 000057   000032 116007                    CMPQ    26,DL
         3 000060   000073 602000 3                  TNC     s:13162+12
         3 000061   000076 600000 3                  TZE     s:13165
         3 000062   000455 116007                    CMPQ    301,DL
         3 000063   000070 602000 3                  TNC     s:13162+9
         3 000064   000113 600000 3                  TZE     s:13178
         3 000065   000456 116007                    CMPQ    302,DL
         3 000066   000117 601000 3                  TNZ     s:13182
         3 000067   000103 710000 3                  TRA     s:13170
         3 000070   000454 116007                    CMPQ    300,DL
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:91   
         3 000071   000117 601000 3                  TNZ     s:13182
         3 000072   000107 710000 3                  TRA     s:13174
         3 000073   000014 116007                    CMPQ    12,DL
         3 000074   000117 601000 3                  TNZ     s:13182
         3 000075   000076 710000 3                  TRA     s:13165

      456    13163                                                              /**/
      457    13164    5               SELECT (END_VAL, BLANK_LINE_VAL) ;

      458    13165    5               ERR_CODE.CODE = 0 ;

  13165  3 000076   000004 236000 4                  LDQ     4
         3 000077   000000 356000 xsym               ANSQ    ERR_CODE

      459    13166    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  13166  3 000100   000005 236000 4                  LDQ     5
         3 000101   000001 756000 xsym               STQ     P_PCB+1

      460    13167    5               RETURN ;

  13167  3 000102   000000 702200 xent               TSX2  ! X66_ARET

      461    13168                                                              /**/
      462    13169    5               SELECT(HELP_VAL) ;

      463    13170    5               CALL ASH$HELP ;

  13170  3 000103   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000104   000000 701000 xent               TSX1    ASH$HELP
         3 000105   000000 011000                    NOP     0

      464    13171    5               GOTO FEPRIV_DO_I ;

  13171  3 000106   000315 710000 3                  TRA     FEPRIV_DO_I

      465    13172                                                              /**/
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:92   
      466    13173    5               SELECT(DQUESTION_VAL) ;

      467    13174    5               CALL ASH$DQUEST ;

  13174  3 000107   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000110   000000 701000 xent               TSX1    ASH$DQUEST
         3 000111   000000 011000                    NOP     0

      468    13175    5               GOTO FEPRIV_DO_I ;

  13175  3 000112   000315 710000 3                  TRA     FEPRIV_DO_I

      469    13176                                                              /**/
      470    13177    5               SELECT(QUESTION_VAL) ;

      471    13178    5               CALL ASH$QUEST ;

  13178  3 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000114   000000 701000 xent               TSX1    ASH$QUEST
         3 000115   000000 011000                    NOP     0

      472    13179    5               GOTO FEPRIV_DO_I ;

  13179  3 000116   000315 710000 3                  TRA     FEPRIV_DO_I

      473    13180                                                              /**/
      474    13181    5               END ;   /*  Do case (code)  */

      475    13182    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  13182  3 000117   000003 471510                    LDP1    3,X0,PR0
         3 000120   100003 473500                    LDP3    3,,PR1
         3 000121   300000 236100                    LDQ     0,,PR3
         3 000122   777777 376007                    ANQ     -1,DL
         3 000123   000000 756000 xsym               STQ     CODE

      476    13183    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:93   

  13183  3 000124   000003 471510                    LDP1    3,X0,PR0
         3 000125   100004 236100                    LDQ     4,,PR1
         3 000126   200015 756100                    STQ     P$,,AUTO

      477    13184                                                              /**/
      478    13185    4            TEMP_FEPRIV = AS_PRIVILEGE(CODE);

  13185  3 000127   000000 721000 xsym               LXL1    CODE
         3 000130   000000 236011 xsym               LDQ     AS_PRIVILEGE,X1
         3 000131   200016 756100                    STQ     TEMP_FEPRIV,,AUTO

      479    13186    4            ERR_CODE.CODE = 0 ;

  13186  3 000132   000004 236000 4                  LDQ     4
         3 000133   000000 356000 xsym               ANSQ    ERR_CODE

      480    13187    4            NUM = P$ -> P$NODE.SUBNODES ;

  13187  3 000134   200015 471500                    LDP1    P$,,AUTO
         3 000135   100001 236100                    LDQ     1,,PR1
         3 000136   000022 772000                    QRL     18
         3 000137   200011 756100                    STQ     NUM,,AUTO

      481    13188                                                              /**/
      482    13189    5            DO J = 0 TO NUM-1 ;

  13189  3 000140   200005 450100                    STZ     J,,AUTO
         3 000141   000312 710000 3                  TRA     s:13264+1

      483    13190    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)

  13190  3 000142   200015 470500                    LDP0    P$,,AUTO
         3 000143   200005 720100                    LXL0    J,,AUTO
         3 000144   000003 471510                    LDP1    3,X0,PR0
         3 000145   100003 473500                    LDP3    3,,PR1
         3 000146   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:94   
         3 000147   777777 376007                    ANQ     -1,DL
         3 000150   200010 756100                    STQ     MODE,,AUTO

      484    13191    5                    -> P$NODE.CODE ;
      485    13192    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;

  13192  3 000151   100001 236100                    LDQ     1,,PR1
         3 000152   000022 772000                    QRL     18
         3 000153   200006 756100                    STQ     K,,AUTO

      486    13193    5               IF K = 2

  13193  3 000154   000002 116007                    CMPQ    2,DL
         3 000155   000163 601000 3                  TNZ     s:13196

      487    13194    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)

  13194  3 000156   100004 474500                    LDP4    4,,PR1
         3 000157   400000 236100                    LDQ     0,,PR4
         3 000160   777777 376007                    ANQ     -1,DL
         3 000161   200007 756100                    STQ     ANS,,AUTO
         3 000162   000165 710000 3                  TRA     s:13198

      488    13195    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      489    13196    5               ELSE ANS = 1 ;

  13196  3 000163   000001 235007                    LDA     1,DL
         3 000164   200007 755100                    STA     ANS,,AUTO

      490    13197                                                              /**/
      491    13198    5               IF ANS = 1

  13198  3 000165   200007 235100                    LDA     ANS,,AUTO
         3 000166   000001 115007                    CMPA    1,DL
         3 000167   000273 601000 3                  TNZ     s:13250

      492    13199    6               THEN DO;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:95   

      493    13200    6                  IF  AS_CR_MOD_PROJ > 0

  13200  3 000170   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000171   000255 604400 3                  TMOZ    s:13243
         3 000172   200010 721100                    LXL1    MODE,,AUTO
         3 000173   200016 236100                    LDQ     TEMP_FEPRIV,,AUTO
         3 000174   000032 376011 xsym               ANQ     KL_DFLT+26,X1
         3 000175   000255 601000 3                  TNZ     s:13243

      494    13201    6                       AND
      495    13202    6                       (TEMP_FEPRIV & KL_DFLT.KL_DFLT_FEBLK.PRIV(MODE)) = '0'B
      496    13203    7                  THEN DO;

      497    13204    7                     ERR_CODE = ERR_FCG;

  13204  3 000176   000000 236000 2                  LDQ     ERR_FCG
         3 000177   777777 376003                    ANQ     -1,DU
         3 000200   000000 756000 xsym               STQ     ERR_CODE

      498    13205    8                     DO SELECT( AS_CR_MOD_PROJ );

  13205  3 000201   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000202   000002 116007                    CMPQ    2,DL
         3 000203   000210 604000 3                  TMI     s:13205+7
         3 000204   000220 600000 3                  TZE     s:13224
         3 000205   000003 116007                    CMPQ    3,DL
         3 000206   000231 601000 3                  TNZ     s:13236
         3 000207   000225 710000 3                  TRA     s:13234
         3 000210   000001 116007                    CMPQ    1,DL
         3 000211   000231 601000 3                  TNZ     s:13236
         3 000212   000213 710000 3                  TRA     s:13214

      499    13206    8                        SELECT( %CR_PROJ_USER );

      500    13207        /*E* ERROR:   ASC-E$CANT_GIVE_FEPRIVTO_USER-C
      501    13208             MESSAGE: %U1 %U2 feprivilege not allowed.
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:96   
      502    13209             MESSAGE1: Users in your project are not allowed to have the %U2 feprivilege
      503    13210                       in %U1 access mode.
      504    13211             MESSAGE2: No user in the project may have a feprivilege not specified in
      505    13212                       the default record for the project.
      506    13213        */
      507    13214    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_USER;

  13214  3 000213   000000 236000 xsym               LDQ     ERR_CODE
         3 000214   000004 376000 4                  ANQ     4
         3 000215   001230 276007                    ORQ     664,DL
         3 000216   000000 756000 xsym               STQ     ERR_CODE
         3 000217   000231 710000 3                  TRA     s:13236

      508    13215
      509    13216    8                        SELECT( %CR_PROJECT );

      510    13217        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPRIVTO_PROJ-C
      511    13218              MESSAGE: %U1 %U2 feprivilege not allowed.
      512    13219              MESSAGE1: Projects you create are not allowed to have the %U2 feprivilege
      513    13220                        in %U1 access mode.
      514    13221              MESSAGE2: Your project does not have that feprivilege, so you are not
      515    13222                        allowed to give the feprivilege to a project you create.
      516    13223        */
      517    13224    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_PROJ;

  13224  3 000220   000000 236000 xsym               LDQ     ERR_CODE
         3 000221   000004 376000 4                  ANQ     4
         3 000222   001240 276007                    ORQ     672,DL
         3 000223   000000 756000 xsym               STQ     ERR_CODE
         3 000224   000231 710000 3                  TRA     s:13236

      518    13225
      519    13226    8                        SELECT( %CR_PROJ_DEFAULT );

      520    13227        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPRIVTO_DFLT-C
      521    13228            MESSAGE: %U1 %U2 feprivilege not allowed.
      522    13229            MESSAGE1: Users in a project you create are not allowed to have the
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:97   
      523    13230                     %U2 feprivilege in %U1 access mode.
      524    13231            MESSAGE2: Your project does not have that feprivilege, so you are not allowed
      525    13232                      to give the feprivilege to users in a project you create.
      526    13233        */
      527    13234    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPRIVTO_DFLT;

  13234  3 000225   000000 236000 xsym               LDQ     ERR_CODE
         3 000226   000004 376000 4                  ANQ     4
         3 000227   001250 276007                    ORQ     680,DL
         3 000230   000000 756000 xsym               STQ     ERR_CODE

      528    13235    8                        END;              /* Do case */

      529    13236    7                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE);

  13236  3 000231   200010 236100                    LDQ     MODE,,AUTO
         3 000232   000007 402007                    MPY     7,DL
         3 000233   000000 100406                    MLR     fill='000'O
         3 000234   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         3 000235   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      530    13237    7                     AS_FIELD2.COUNT = AS_PRIV_NAMES(CODE) -> P$LIT.COUNT;

  13237  3 000236   000000 722000 xsym               LXL2    CODE
         3 000237   000000 471412 xsym               LDP1    AS_PRIV_NAMES,X2
         3 000240   100001 236100                    LDQ     1,,PR1
         3 000241   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      531    13238    7                     AS_FIELD2.TEXT = AS_PRIV_NAMES(CODE) -> P$LIT.TEXT;

  13238  3 000242   100001 236100                    LDQ     1,,PR1
         3 000243   000033 772000                    QRL     27
         3 000244   000000 623006                    EAX3    0,QL
         3 000245   040000 100540                    MLR     fill='040'O
         3 000246   100001 200013                    ADSC9   1,,PR1                   cn=1,n=*X3
         3 000247   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:98   
      532    13239    7                     CALL ASH$ERROR( ERR_CODE );

  13239  3 000250   000006 630400 4                  EPPR0   6
         3 000251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000252   000000 701000 xent               TSX1    ASH$ERROR
         3 000253   000000 011000                    NOP     0

      533    13240    7                     END;

  13240  3 000254   000311 710000 3                  TRA     s:13264

      534    13241    7                  ELSE DO;

      535    13242                          %SETV (VAR="KL_DREC.KL_DREC_FEBLK.PRIV(MODE)",FLAGS=TEMP_FEPRIV);

  13243  3 000255   200010 721100                    LXL1    MODE,,AUTO
         3 000256   000032 236011 xsym               LDQ     KL_DREC+26,X1
         3 000257   200016 276100                    ORQ     TEMP_FEPRIV,,AUTO
         3 000260   000032 756011 xsym               STQ     KL_DREC+26,X1

      536    13245    7                     AS_MOD_USER.FEPRIV_A(4*CODE+MODE) = YES_VAL;

  13245  3 000261   000000 236000 xsym               LDQ     CODE
         3 000262   000002 736000                    QLS     2
         3 000263   200010 036100                    ADLQ    MODE,,AUTO
         3 000264   000001 736000                    QLS     1
         3 000265   000267 605000 3                  TPL     s:13245+6
         3 000266   000044 036003                    ADLQ    36,DU
         3 000267   003006 061400                    CSR     bolr='003'O
         3 000270   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         3 000271   000030 430002 xsym               BDSC    AS_MOD_USER+24,Q         by=2,bit=3,n=2

      537    13246    7                     END;

      538    13247    6                  END;

  13247  3 000272   000311 710000 3                  TRA     s:13264
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:99   

      539    13248    6               ELSE DO;

      540    13249                       %RESETV (VAR="KL_DREC.KL_DREC_FEBLK.PRIV(MODE)",FLAGS=TEMP_FEPRIV);

  13250  3 000273   200016 236100                    LDQ     TEMP_FEPRIV,,AUTO
         3 000274   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000275   200010 721100                    LXL1    MODE,,AUTO
         3 000276   000032 376011 xsym               ANQ     KL_DREC+26,X1
         3 000277   000032 756011 xsym               STQ     KL_DREC+26,X1

      541    13252    6                  AS_MOD_USER.FEPRIV_A(4*CODE+MODE) = NO_VAL;

  13252  3 000300   000000 236000 xsym               LDQ     CODE
         3 000301   000002 736000                    QLS     2
         3 000302   200010 036100                    ADLQ    MODE,,AUTO
         3 000303   000001 736000                    QLS     1
         3 000304   000306 605000 3                  TPL     s:13252+6
         3 000305   000044 036003                    ADLQ    36,DU
         3 000306   003006 061400                    CSR     bolr='003'O
         3 000307   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         3 000310   000030 430002 xsym               BDSC    AS_MOD_USER+24,Q         by=2,bit=3,n=2

      542    13253    6                  END;

      543    13254                                                              /*
      544    13255                                                                   Mode
      545    13256                                                                   dcb   = 0
      546    13257                                                                   comgroup   = 1
      547    13258                                                                   handler = 2
      548    13259                                                                   ghost = 3
      549    13260                                                                   ans
      550    13261                                                                   yes = 1
      551    13262                                                                   no = 2
      552    13263                                                              */
      553    13264    5               END ; /* Do j */

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:100  
  13264  3 000311   200005 054100                    AOS     J,,AUTO
         3 000312   200005 236100                    LDQ     J,,AUTO
         3 000313   200011 116100                    CMPQ    NUM,,AUTO
         3 000314   000142 604000 3                  TMI     s:13190

  13252  3 000315                       FEPRIV_DO_I  null
      554    13265    4   FEPRIV_DO_I: ;
      555    13266    4            END ; /*  Do i  */

  13266  3 000315   200004 054100                    AOS     I,,AUTO
         3 000316   200012 236100                    LDQ     SUBNODES,,AUTO
         3 000317   000002 136007                    SBLQ    2,DL
         3 000320   200004 116100                    CMPQ    I,,AUTO
         3 000321   000051 605000 3                  TPL     s:13161

      556    13267    3         END ; /* Do while (more) */

  13267  3 000322   200013 234100                    SZN     MORE,,AUTO
         3 000323   000014 604000 3                  TMI     s:13151

  13252  3 000324                       FEPRIV_ERR   null
      557    13268    2   FEPRIV_ERR: ;
      558    13269    2      CALL ASH$ERROR( P_PCB.ERROR );

  13269  3 000324   000007 630400 4                  EPPR0   7
         3 000325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000326   000000 701000 xent               TSX1    ASH$ERROR
         3 000327   000000 011000                    NOP     0

      559    13270    2      END ; /* Do while (dummy) */

  13270  3 000330   200014 234100                    SZN     DUMMY,,AUTO
         3 000331   000012 604000 3                  TMI     FEPRIV_LOOP
         3 000332   000335 710000 3                  TRA     s:13275

      560    13271                                                              /**/
      561    13272        %EJECT;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:101  
      562    13273    1   ASC$FEPPRIV: ENTRY ;

  13273  3 000333   000000 700200 xent  ASC$FEPPRIV  TSX0  ! X66_AUTO_0
         3 000334   000022 000000                    ZERO    18,0

      563    13274                                                              /**/
      564    13275    1   P_PCB.ROOT$ = ADDR(FEPPRIV_S_OPT) ;

  13275  3 000335   000010 236000 4                  LDQ     8
         3 000336   000001 756000 xsym               STQ     P_PCB+1

      565    13276    1   MORE = AS_TRUE ;

  13276  3 000337   000000 236000 xsym               LDQ     AS_TRUE
         3 000340   400000 376003                    ANQ     -131072,DU
         3 000341   200013 756100                    STQ     MORE,,AUTO

      566    13277    1   DUMMY = AS_TRUE ;

  13277  3 000342   200014 756100                    STQ     DUMMY,,AUTO

      567    13278                                                              /**/
      568    13279    2   DO WHILE (DUMMY) ;

  13279  3 000343   200014 234100                    SZN     DUMMY,,AUTO
         3 000344   000664 605000 3                  TPL     s:13403

  13273  3 000345                       FEPPRIV_LOOP null
      569    13280    2   FEPPRIV_LOOP: ;
      570    13281    3      DO WHILE (MORE) ;

  13281  3 000345   200013 234100                    SZN     MORE,,AUTO
         3 000346   000656 605000 3                  TPL     FEPPRIV_ERR

      571    13282    3         REMEMBER FEPPRIV_LOOP IN REMEM_VAR ;

  13282  3 000347   000345 635000 3                  EAA     FEPPRIV_LOOP
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:102  
         3 000350   000000 452400 xsym               STP2    REMEM_VAR
         3 000351   000001 755000 xsym               STA     REMEM_VAR+1

      572    13283                                                              /* Set prompt */
      573    13284    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;

  13284  3 000352   000001 630400 4                  EPPR0   1
         3 000353   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000354   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000355   000000 011000                    NOP     0

      574    13285    3         CALL ASB$READ_SI(IN_BUF,ARS) ;         /* Read option line */

  13285  3 000356   200003 630500                    EPPR0   ARS,,AUTO
         3 000357   200021 450500                    STP0    TEMP_FEPRIV+3,,AUTO
         3 000360   000002 236000 4                  LDQ     2
         3 000361   200020 756100                    STQ     TEMP_FEPRIV+2,,AUTO
         3 000362   200020 630500                    EPPR0   TEMP_FEPRIV+2,,AUTO
         3 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000364   000000 701000 xent               TSX1    ASB$READ_SI
         3 000365   000000 011000                    NOP     0

      575    13286    3         P_PCB.NCHARS = ARS ;

  13286  3 000366   200003 235100                    LDA     ARS,,AUTO
         3 000367   000011 755000 xsym               STA     P_PCB+9

      576    13287    3         CALL X$PARSE(P_PCB) ALTRET (FEPPRIV_ERR) ;

  13287  3 000370   000003 630400 4                  EPPR0   3
         3 000371   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000372   000000 701000 xent               TSX1    X$PARSE
         3 000373   000656 702000 3                  TSX2    FEPPRIV_ERR

      577    13288    3         NODE$ = P_PCB.OUT$ ;

  13288  3 000374   000003 236000 xsym               LDQ     P_PCB+3
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:103  
         3 000375   000000 756000 xsym               STQ     NODE$

      578    13289    3         SUBNODES = P$NODE.SUBNODES ;

  13289  3 000376   000000 470400 xsym               LDP0    NODE$
         3 000377   000001 236100                    LDQ     1,,PR0
         3 000400   000022 772000                    QRL     18
         3 000401   200012 756100                    STQ     SUBNODES,,AUTO

      579    13290    4         DO I = 0 TO SUBNODES - 2 ;

  13290  3 000402   200004 450100                    STZ     I,,AUTO
         3 000403   000650 710000 3                  TRA     FEPPRIV_DO_I+1

      580    13291                                                              /* Check for end */
      581    13292    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;

  13292  3 000404   000000 470400 xsym               LDP0    NODE$
         3 000405   200004 720100                    LXL0    I,,AUTO
         3 000406   000003 471510                    LDP1    3,X0,PR0
         3 000407   100000 236100                    LDQ     0,,PR1
         3 000410   777777 376007                    ANQ     -1,DL
         3 000411   000000 756000 xsym               STQ     CODE

      582    13293    5            DO SELECT (CODE) ;

  13293  3 000412   000032 116007                    CMPQ    26,DL
         3 000413   000426 602000 3                  TNC     s:13293+12
         3 000414   000431 600000 3                  TZE     s:13296
         3 000415   000455 116007                    CMPQ    301,DL
         3 000416   000423 602000 3                  TNC     s:13293+9
         3 000417   000446 600000 3                  TZE     s:13309
         3 000420   000456 116007                    CMPQ    302,DL
         3 000421   000452 601000 3                  TNZ     s:13313
         3 000422   000436 710000 3                  TRA     s:13301
         3 000423   000454 116007                    CMPQ    300,DL
         3 000424   000452 601000 3                  TNZ     s:13313
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:104  
         3 000425   000442 710000 3                  TRA     s:13305
         3 000426   000014 116007                    CMPQ    12,DL
         3 000427   000452 601000 3                  TNZ     s:13313
         3 000430   000431 710000 3                  TRA     s:13296

      583    13294                                                              /**/
      584    13295    5               SELECT (END_VAL, BLANK_LINE_VAL) ;

      585    13296    5               ERR_CODE.CODE = 0 ;

  13296  3 000431   000004 236000 4                  LDQ     4
         3 000432   000000 356000 xsym               ANSQ    ERR_CODE

      586    13297    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  13297  3 000433   000005 236000 4                  LDQ     5
         3 000434   000001 756000 xsym               STQ     P_PCB+1

      587    13298    5               RETURN ;

  13298  3 000435   000000 702200 xent               TSX2  ! X66_ARET

      588    13299                                                              /**/
      589    13300    5               SELECT(HELP_VAL) ;

      590    13301    5               CALL ASH$HELP ;

  13301  3 000436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000437   000000 701000 xent               TSX1    ASH$HELP
         3 000440   000000 011000                    NOP     0

      591    13302    5               GOTO FEPPRIV_DO_I ;

  13302  3 000441   000647 710000 3                  TRA     FEPPRIV_DO_I

      592    13303                                                              /**/
      593    13304    5               SELECT(DQUESTION_VAL) ;
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:105  

      594    13305    5               CALL ASH$DQUEST ;

  13305  3 000442   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000443   000000 701000 xent               TSX1    ASH$DQUEST
         3 000444   000000 011000                    NOP     0

      595    13306    5               GOTO FEPPRIV_DO_I ;

  13306  3 000445   000647 710000 3                  TRA     FEPPRIV_DO_I

      596    13307                                                              /**/
      597    13308    5               SELECT(QUESTION_VAL) ;

      598    13309    5               CALL ASH$QUEST ;

  13309  3 000446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000447   000000 701000 xent               TSX1    ASH$QUEST
         3 000450   000000 011000                    NOP     0

      599    13310    5               GOTO FEPPRIV_DO_I ;

  13310  3 000451   000647 710000 3                  TRA     FEPPRIV_DO_I

      600    13311                                                              /**/
      601    13312    5               END ;   /*  Do case (code)  */

      602    13313    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  13313  3 000452   000003 471510                    LDP1    3,X0,PR0
         3 000453   100003 473500                    LDP3    3,,PR1
         3 000454   300000 236100                    LDQ     0,,PR3
         3 000455   777777 376007                    ANQ     -1,DL
         3 000456   000000 756000 xsym               STQ     CODE

      603    13314    4            P$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(1) ;

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:106  
  13314  3 000457   000003 471510                    LDP1    3,X0,PR0
         3 000460   100004 236100                    LDQ     4,,PR1
         3 000461   200015 756100                    STQ     P$,,AUTO

      604    13315                                                              /**/
      605    13316    4            TEMP_FEPRIV = AS_PPRIVILEGE(CODE);

  13316  3 000462   000000 721000 xsym               LXL1    CODE
         3 000463   000000 236011 xsym               LDQ     AS_PPRIVILEGE,X1
         3 000464   200016 756100                    STQ     TEMP_FEPRIV,,AUTO

      606    13317                                                                  /**/
      607    13318    4            ERR_CODE = '0'B ;

  13318  3 000465   000000 450000 xsym               STZ     ERR_CODE

      608    13319    4            NUM = P$ -> P$NODE.SUBNODES ;

  13319  3 000466   200015 471500                    LDP1    P$,,AUTO
         3 000467   100001 236100                    LDQ     1,,PR1
         3 000470   000022 772000                    QRL     18
         3 000471   200011 756100                    STQ     NUM,,AUTO

      609    13320                                                              /**/
      610    13321    5            DO J = 0 TO NUM-1 ;

  13321  3 000472   200005 450100                    STZ     J,,AUTO
         3 000473   000644 710000 3                  TRA     s:13396+1

      611    13322    5               MODE = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0)

  13322  3 000474   200015 470500                    LDP0    P$,,AUTO
         3 000475   200005 720100                    LXL0    J,,AUTO
         3 000476   000003 471510                    LDP1    3,X0,PR0
         3 000477   100003 473500                    LDP3    3,,PR1
         3 000500   300000 236100                    LDQ     0,,PR3
         3 000501   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:107  
         3 000502   200010 756100                    STQ     MODE,,AUTO

      612    13323    5                    -> P$NODE.CODE ;
      613    13324    5               K = P$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES ;

  13324  3 000503   100001 236100                    LDQ     1,,PR1
         3 000504   000022 772000                    QRL     18
         3 000505   200006 756100                    STQ     K,,AUTO

      614    13325    5               IF K = 2

  13325  3 000506   000002 116007                    CMPQ    2,DL
         3 000507   000515 601000 3                  TNZ     s:13328

      615    13326    5               THEN ANS = P$ -> P$NODE.SUBLK$(J)

  13326  3 000510   100004 474500                    LDP4    4,,PR1
         3 000511   400000 236100                    LDQ     0,,PR4
         3 000512   777777 376007                    ANQ     -1,DL
         3 000513   200007 756100                    STQ     ANS,,AUTO
         3 000514   000517 710000 3                  TRA     s:13330

      616    13327    5                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      617    13328    5               ELSE ANS = 1 ;

  13328  3 000515   000001 235007                    LDA     1,DL
         3 000516   200007 755100                    STA     ANS,,AUTO

      618    13329                                                              /**/
      619    13330    5               IF ANS = 1

  13330  3 000517   200007 235100                    LDA     ANS,,AUTO
         3 000520   000001 115007                    CMPA    1,DL
         3 000521   000625 601000 3                  TNZ     s:13382

      620    13331    6               THEN DO;

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:108  
      621    13332    6                  IF AS_CR_MOD_PROJ > 0

  13332  3 000522   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000523   000607 604400 3                  TMOZ    s:13375
         3 000524   200010 721100                    LXL1    MODE,,AUTO
         3 000525   200016 236100                    LDQ     TEMP_FEPRIV,,AUTO
         3 000526   000036 376011 xsym               ANQ     KL_DFLT+30,X1
         3 000527   000607 601000 3                  TNZ     s:13375

      622    13333    6                       AND
      623    13334    6                       (TEMP_FEPRIV & KL_DFLT.KL_DFLT_FEBLK.PPRIV(MODE)) = '0'B
      624    13335    7                  THEN DO;

      625    13336    7                     ERR_CODE = ERR_FCG;

  13336  3 000530   000000 236000 2                  LDQ     ERR_FCG
         3 000531   777777 376003                    ANQ     -1,DU
         3 000532   000000 756000 xsym               STQ     ERR_CODE

      626    13337    8                     DO SELECT( AS_CR_MOD_PROJ );

  13337  3 000533   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000534   000002 116007                    CMPQ    2,DL
         3 000535   000542 604000 3                  TMI     s:13337+7
         3 000536   000552 600000 3                  TZE     s:13356
         3 000537   000003 116007                    CMPQ    3,DL
         3 000540   000563 601000 3                  TNZ     s:13368
         3 000541   000557 710000 3                  TRA     s:13366
         3 000542   000001 116007                    CMPQ    1,DL
         3 000543   000563 601000 3                  TNZ     s:13368
         3 000544   000545 710000 3                  TRA     s:13346

      627    13338    8                        SELECT( %CR_PROJ_USER );

      628    13339        /*E* ERROR:   ASC-E$CANT_GIVE_FEPPRIVTO_USER-C
      629    13340             MESSAGE: %U1 %U2 fepprivilege not allowed.
      630    13341             MESSAGE1: Users in your project are not allowed to have the %U2 fepprivilege
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:109  
      631    13342                       in %U1 access mode.
      632    13343             MESSAGE2: No user in the project may have a fepprivilege not specified in
      633    13344                       the default record for the project.
      634    13345        */
      635    13346    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_USER;

  13346  3 000545   000000 236000 xsym               LDQ     ERR_CODE
         3 000546   000004 376000 4                  ANQ     4
         3 000547   001260 276007                    ORQ     688,DL
         3 000550   000000 756000 xsym               STQ     ERR_CODE
         3 000551   000563 710000 3                  TRA     s:13368

      636    13347
      637    13348    8                        SELECT( %CR_PROJECT );

      638    13349        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPPRIVTO_PROJ-C
      639    13350              MESSAGE: %U1 %U2 fepprivilege not allowed.
      640    13351              MESSAGE1: Projects you create are not allowed to have the %U2 fepprivilege
      641    13352                        in %U1 access mode.
      642    13353              MESSAGE2: Your project does not have that fepprivilege, so you are not
      643    13354                        allowed to give the fepprivilege to a project you create.
      644    13355        */
      645    13356    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_PROJ;

  13356  3 000552   000000 236000 xsym               LDQ     ERR_CODE
         3 000553   000004 376000 4                  ANQ     4
         3 000554   001270 276007                    ORQ     696,DL
         3 000555   000000 756000 xsym               STQ     ERR_CODE
         3 000556   000563 710000 3                  TRA     s:13368

      646    13357
      647    13358    8                        SELECT( %CR_PROJ_DEFAULT );

      648    13359        /*E*  ERROR:  ASC-E$CANT_GIVE_FEPPRIVTO_DFLT-C
      649    13360              MESSAGE: %U1 %U2 fepprivilege not allowed.
      650    13361            MESSAGE1: Users in a project you create are not allowed to have the
      651    13362                     %U2 fepprivilege in %U1 access mode.
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:110  
      652    13363            MESSAGE2: Your project does not have that fepprivilege, so you are not allowed
      653    13364                      to give the fepprivilege to users in a project you create.
      654    13365        */
      655    13366    8                        ERR_CODE.CODE = E$CANT_GIVE_FEPPRIVTO_DFLT;

  13366  3 000557   000000 236000 xsym               LDQ     ERR_CODE
         3 000560   000004 376000 4                  ANQ     4
         3 000561   001300 276007                    ORQ     704,DL
         3 000562   000000 756000 xsym               STQ     ERR_CODE

      656    13367    8                        END;              /* Do case */

      657    13368    7                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE);

  13368  3 000563   200010 236100                    LDQ     MODE,,AUTO
         3 000564   000007 402007                    MPY     7,DL
         3 000565   000000 100406                    MLR     fill='000'O
         3 000566   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         3 000567   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      658    13369    7                     AS_FIELD2.COUNT = AS_PPRIV_NAMES(CODE) -> P$LIT.COUNT;

  13369  3 000570   000000 722000 xsym               LXL2    CODE
         3 000571   000000 471412 xsym               LDP1    AS_PPRIV_NAMES,X2
         3 000572   100001 236100                    LDQ     1,,PR1
         3 000573   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      659    13370    7                     AS_FIELD2.TEXT = AS_PPRIV_NAMES(CODE) -> P$LIT.TEXT;

  13370  3 000574   100001 236100                    LDQ     1,,PR1
         3 000575   000033 772000                    QRL     27
         3 000576   000000 623006                    EAX3    0,QL
         3 000577   040000 100540                    MLR     fill='040'O
         3 000600   100001 200013                    ADSC9   1,,PR1                   cn=1,n=*X3
         3 000601   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      660    13371    7                     CALL ASH$ERROR( ERR_CODE );
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:111  

  13371  3 000602   000006 630400 4                  EPPR0   6
         3 000603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000604   000000 701000 xent               TSX1    ASH$ERROR
         3 000605   000000 011000                    NOP     0

      661    13372    7                     END;

  13372  3 000606   000643 710000 3                  TRA     s:13396

      662    13373    7                  ELSE DO;

      663    13374                         %SETV (VAR="KL_DREC.KL_DREC_FEBLK.PPRIV(MODE)",FLAGS=TEMP_FEPRIV);

  13375  3 000607   200010 721100                    LXL1    MODE,,AUTO
         3 000610   000036 236011 xsym               LDQ     KL_DREC+30,X1
         3 000611   200016 276100                    ORQ     TEMP_FEPRIV,,AUTO
         3 000612   000036 756011 xsym               STQ     KL_DREC+30,X1

      664    13377    7                     AS_MOD_USER.FEPPRIV_A(4*CODE+MODE) = YES_VAL;

  13377  3 000613   000000 236000 xsym               LDQ     CODE
         3 000614   000002 736000                    QLS     2
         3 000615   200010 036100                    ADLQ    MODE,,AUTO
         3 000616   000001 736000                    QLS     1
         3 000617   000621 605000 3                  TPL     s:13377+6
         3 000620   000044 036003                    ADLQ    36,DU
         3 000621   003006 061400                    CSR     bolr='003'O
         3 000622   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         3 000623   000040 430002 xsym               BDSC    AS_MOD_USER+32,Q         by=2,bit=3,n=2

      665    13378    7                     END;

      666    13379    6                  END;

  13379  3 000624   000643 710000 3                  TRA     s:13396

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:112  
      667    13380    6               ELSE DO;

      668    13381                       %RESETV (VAR="KL_DREC.KL_DREC_FEBLK.PPRIV(MODE)",FLAGS=TEMP_FEPRIV);

  13382  3 000625   200016 236100                    LDQ     TEMP_FEPRIV,,AUTO
         3 000626   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000627   200010 721100                    LXL1    MODE,,AUTO
         3 000630   000036 376011 xsym               ANQ     KL_DREC+30,X1
         3 000631   000036 756011 xsym               STQ     KL_DREC+30,X1

      669    13384    6                  AS_MOD_USER.FEPPRIV_A(4*CODE+MODE) = NO_VAL;

  13384  3 000632   000000 236000 xsym               LDQ     CODE
         3 000633   000002 736000                    QLS     2
         3 000634   200010 036100                    ADLQ    MODE,,AUTO
         3 000635   000001 736000                    QLS     1
         3 000636   000640 605000 3                  TPL     s:13384+6
         3 000637   000044 036003                    ADLQ    36,DU
         3 000640   003006 061400                    CSR     bolr='003'O
         3 000641   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         3 000642   000040 430002 xsym               BDSC    AS_MOD_USER+32,Q         by=2,bit=3,n=2

      670    13385    6                  END;

      671    13386                                                              /*
      672    13387                                                                   Mode
      673    13388                                                                   dcb   = 0
      674    13389                                                                   comgroup   = 1
      675    13390                                                                   handler = 2
      676    13391                                                                   ghost = 3
      677    13392                                                                   ans
      678    13393                                                                   yes = 1
      679    13394                                                                   no = 2
      680    13395                                                              */
      681    13396    5               END ; /* Do j */

  13396  3 000643   200005 054100                    AOS     J,,AUTO
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:113  
         3 000644   200005 236100                    LDQ     J,,AUTO
         3 000645   200011 116100                    CMPQ    NUM,,AUTO
         3 000646   000474 604000 3                  TMI     s:13322

  13384  3 000647                       FEPPRIV_DO_I null
      682    13397    4   FEPPRIV_DO_I: ;
      683    13398    4            END ; /*  Do i  */

  13398  3 000647   200004 054100                    AOS     I,,AUTO
         3 000650   200012 236100                    LDQ     SUBNODES,,AUTO
         3 000651   000002 136007                    SBLQ    2,DL
         3 000652   200004 116100                    CMPQ    I,,AUTO
         3 000653   000404 605000 3                  TPL     s:13292

      684    13399    3         END ; /* Do while (more) */

  13399  3 000654   200013 234100                    SZN     MORE,,AUTO
         3 000655   000347 604000 3                  TMI     s:13282

  13384  3 000656                       FEPPRIV_ERR  null
      685    13400    2   FEPPRIV_ERR: ;
      686    13401    2      CALL ASH$ERROR( P_PCB.ERROR );

  13401  3 000656   000007 630400 4                  EPPR0   7
         3 000657   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000660   000000 701000 xent               TSX1    ASH$ERROR
         3 000661   000000 011000                    NOP     0

      687    13402    2      END ; /* Do while( dummy ) */

  13402  3 000662   200014 234100                    SZN     DUMMY,,AUTO
         3 000663   000345 604000 3                  TMI     FEPPRIV_LOOP

      688    13403    1   END       ASC$FEPRIV ;

  13403  3 000664   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:114  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$FEPRIV.
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:115  

 **** Variables and constants ****

  ****  Section 002 RoData ASC$FEPRIV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(18)    r     1 ERR_FCG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w SBIN        r     1 ANS                        3-0-0/w UBIN        r     1 ARS
    14-0-0/b BIT         r     1 DUMMY                      4-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                          6-0-0/w SBIN        r     1 K
    10-0-0/w SBIN        r     1 MODE                      13-0-0/b BIT         r     1 MORE
    11-0-0/w SBIN        r     1 NUM                       15-0-0/w PTR         r     1 P$
    12-0-0/w SBIN        r     1 SUBNODES                  16-0-0/w BIT         r     1 TEMP_FEPRIV

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/c STRC(252)   r     1 AS_FE_MODE
     0-0-0/c STRC(63)    r     1 AS_FE_MODE_ARRY(0:3)
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(1483)  r     1 AS_MOD_USER
     0-0-0/w BIT         r     1 AS_PPRIVILEGE(0:20)
     0-0-0/w PTR         r     1 AS_PPRIV_NAMES(0:20)
     0-0-0/w BIT         r     1 AS_PRIVILEGE(0:23)
     0-0-0/w PTR         r     1 AS_PRIV_NAMES(0:23)
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w UBIN        r     1 CODE
     0-0-0/w UBIN        r     1 CR_MOD_TREE                0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w UBIN        r     1 FEPPRIV_S_OPT              0-0-0/w UBIN        r     1 FEPRIV_S_OPT
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:116  
     0-0-0/c CHAR(255)   r     1 IN_BUF                     0-0-0/w STRC(6084)  r     1 KL_DFLT
     0-0-0/w STRC(6084)  r     1 KL_DREC                    0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(45)    r     1 P$LIT                      0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASC$FEPRIV requires 437 words for executable code.
   Procedure ASC$FEPRIV requires 18 words of local(AUTO) storage.

    No errors detected in file ASC$PRIV.:E05TSI    .
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:117  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:118  
          MINI XREF LISTING

ANS
     13118**DCL     13194<<ASSIGN  13196<<ASSIGN  13198>>IF      13326<<ASSIGN  13328<<ASSIGN  13330>>IF
ARS
     13114**DCL     13154<>CALL    13155>>ASSIGN  13285<>CALL    13286>>ASSIGN
ASA_BRKS_LOC
     10126**DCL     10126--REDEF
ASB$READ_SI
     13091**DCL-ENT 13154--CALL    13285--CALL
ASB$SET_PROMPT
     13094**DCL-ENT 13153--CALL    13284--CALL
ASH$DQUEST
     13100**DCL-ENT 13174--CALL    13305--CALL
ASH$ERROR
     13106**DCL-ENT 13239--CALL    13269--CALL    13371--CALL    13401--CALL
ASH$HELP
     13097**DCL-ENT 13170--CALL    13301--CALL
ASH$QUEST
     13103**DCL-ENT 13178--CALL    13309--CALL
AS_CR_MOD_PROJ
     10134**DCL     13200>>IF      13205>>DOSELCT 13332>>IF      13337>>DOSELCT
AS_DEFAULT.BANNER_PERM
     10819**DCL     10820--REDEF
AS_DEFAULT.BUDGET.MACCT
     10724**DCL     10728--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10737**DCL     10740--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10720**DCL     10722--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10715**DCL     10717--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10835**DCL     10836--REDEF   10837--REDEF
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:119  
AS_DEFAULT_DREC.PASSWORD
     12089**DCL     12093--REDEF
AS_DEFAULT_DREC.RENAME
     12112**DCL     12113--REDEF
AS_DFLT.BANNER_PERM
     10641**DCL     10642--REDEF
AS_DFLT.BUDGET.MACCT
     10546**DCL     10550--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10559**DCL     10562--REDEF
AS_DFLT.BUDGET.PACCUM
     10542**DCL     10544--REDEF
AS_DFLT.BUDGET.PMAXC
     10537**DCL     10539--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10657**DCL     10658--REDEF   10659--REDEF
AS_FE_MODE
      9992**DCL      9993--REDEF
AS_FE_MODE_ARRY
      9993**DCL     13236>>ASSIGN  13368>>ASSIGN
AS_FIELD1
     10122**DCL     13236<<ASSIGN  13368<<ASSIGN
AS_FIELD2.COUNT
     10123**DCL     13237<<ASSIGN  13369<<ASSIGN
AS_FIELD2.TEXT
     10123**DCL     13238<<ASSIGN  13370<<ASSIGN
AS_MODE
      9989**DCL      9991--REDEF
AS_MOD_USER.ACCESS
     12854**DCL     12855--REDEF
AS_MOD_USER.BANNER
     12841**DCL     12842--REDEF
AS_MOD_USER.BANNER_PERM
     12843**DCL     12844--REDEF
AS_MOD_USER.BILL
     12849**DCL     12850--REDEF
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:120  
AS_MOD_USER.CPROC
     12845**DCL     12846--REDEF
AS_MOD_USER.FEBILL
     12925**DCL     12926--REDEF
AS_MOD_USER.FECXTMEM
     12942**DCL     12943--REDEF
AS_MOD_USER.FEMINTS
     12927**DCL     12928--REDEF
AS_MOD_USER.FEMMEM
     12938**DCL     12939--REDEF
AS_MOD_USER.FEMTIME
     12936**DCL     12937--REDEF
AS_MOD_USER.FEPPRIV
     12933**DCL     12935--REDEF
AS_MOD_USER.FEPPRIV_A
     12935**DCL     13377<<ASSIGN  13384<<ASSIGN
AS_MOD_USER.FEPRIV
     12930**DCL     12932--REDEF
AS_MOD_USER.FEPRIV_A
     12932**DCL     13245<<ASSIGN  13252<<ASSIGN
AS_MOD_USER.FORCE_BIT
     12839**DCL     12840--REDEF
AS_MOD_USER.KEY
     12921**DCL     12923--REDEF
AS_MOD_USER.LASTCPROC
     12847**DCL     12848--REDEF
AS_MOD_USER.LIMITS.DO_
     12895**DCL     12896--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12911**DCL     12912--REDEF
AS_MOD_USER.LIMITS.LO
     12891**DCL     12892--REDEF
AS_MOD_USER.LIMITS.MEM
     12887**DCL     12888--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12915**DCL     12916--REDEF
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:121  
AS_MOD_USER.LIMITS.PDIS
     12903**DCL     12904--REDEF
AS_MOD_USER.LIMITS.PO
     12899**DCL     12900--REDEF
AS_MOD_USER.LIMITS.TDIS
     12907**DCL     12908--REDEF
AS_MOD_USER.LIMITS.TIME
     12883**DCL     12884--REDEF
AS_MOD_USER.MAXENQ
     12864**DCL     12865--REDEF
AS_MOD_USER.PERM_BIT
     12837**DCL     12838--REDEF
AS_MOD_USER.PPRIV
     12859**DCL     12861--REDEF
AS_MOD_USER.PRIOB
     12866**DCL     12867--REDEF
AS_MOD_USER.PRIV
     12856**DCL     12858--REDEF
AS_MOD_USER.QUAN
     12862**DCL     12863--REDEF
AS_MOD_USER.SETUP
     12835**DCL     12836--REDEF
AS_PPRIVILEGE
      9989**DCL     13316>>ASSIGN
AS_PPRIV_NAMES
      9988**DCL     13369>>ASSIGN  13370>>ASSIGN  13370>>ASSIGN
AS_PRIVILEGE
      9989**DCL     13185>>ASSIGN
AS_PRIV_NAMES
      9988**DCL     13237>>ASSIGN  13238>>ASSIGN  13238>>ASSIGN
AS_PROJECT.BANNER_PERM
     11175**DCL     11176--REDEF
AS_PROJECT.BUDGET.MACCT
     11080**DCL     11084--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11093**DCL     11096--REDEF
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:122  
AS_PROJECT.BUDGET.PACCUM
     11076**DCL     11078--REDEF
AS_PROJECT.BUDGET.PMAXC
     11071**DCL     11073--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11191**DCL     11192--REDEF   11193--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11353**DCL     11354--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11258**DCL     11262--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11271**DCL     11274--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11254**DCL     11256--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11249**DCL     11251--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11369**DCL     11370--REDEF   11371--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12575**DCL     12579--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12598**DCL     12599--REDEF
AS_PROJECT_DREC.PASSWORD
     12413**DCL     12417--REDEF
AS_PROJECT_DREC.RENAME
     12436**DCL     12437--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10997**DCL     10998--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10902**DCL     10906--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10915**DCL     10918--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10898**DCL     10900--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10893**DCL     10895--REDEF
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:123  
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11013**DCL     11014--REDEF   11015--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12251**DCL     12255--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12274**DCL     12275--REDEF
AS_TRUE
      9986**DCL     13145>>ASSIGN  13146>>ASSIGN  13276>>ASSIGN  13277>>ASSIGN
AS_USERS.BANNER_PERM
     10463**DCL     10464--REDEF
AS_USERS.BUDGET.MACCT
     10368**DCL     10372--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10381**DCL     10384--REDEF
AS_USERS.BUDGET.PACCUM
     10364**DCL     10366--REDEF
AS_USERS.BUDGET.PMAXC
     10359**DCL     10361--REDEF
AS_USERS.SETUP_CHRA.TXT
     10479**DCL     10480--REDEF   10481--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11531**DCL     11532--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11436**DCL     11440--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11449**DCL     11452--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11432**DCL     11434--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11427**DCL     11429--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11547**DCL     11548--REDEF   11549--REDEF
CODE
     10119**DCL     13161<<ASSIGN  13162>>DOSELCT 13182<<ASSIGN  13185>>ASSIGN  13237>>ASSIGN  13238>>ASSIGN
     13238>>ASSIGN  13245>>ASSIGN  13252>>ASSIGN  13292<<ASSIGN  13293>>DOSELCT 13313<<ASSIGN  13316>>ASSIGN
     13369>>ASSIGN  13370>>ASSIGN  13370>>ASSIGN  13377>>ASSIGN  13384>>ASSIGN
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:124  
CR_MOD_TREE
      9978**DCL     13166--ASSIGN  13297--ASSIGN
DUMMY
     13123**DCL     13146<<ASSIGN  13148>>DOWHILE 13277<<ASSIGN  13279>>DOWHILE
ERR_CODE
     10121**DCL     10122--REDEF   13204<<ASSIGN  13239<>CALL    13318<<ASSIGN  13336<<ASSIGN  13371<>CALL
ERR_CODE.CODE
     10121**DCL     13165<<ASSIGN  13186<<ASSIGN  13214<<ASSIGN  13224<<ASSIGN  13234<<ASSIGN  13296<<ASSIGN
     13346<<ASSIGN  13356<<ASSIGN  13366<<ASSIGN
ERR_FCG
     13131**DCL     13204>>ASSIGN  13336>>ASSIGN
FEPPRIV_DO_I
     13384**LABEL   13302--GOTO    13306--GOTO    13310--GOTO
FEPPRIV_ERR
     13384**LABEL   13287--CALLALT
FEPPRIV_LOOP
     13273**LABEL   13282--REMEMBR
FEPPRIV_S_OPT
     13135**DCL     13275--ASSIGN
FEPRIV_DO_I
     13252**LABEL   13171--GOTO    13175--GOTO    13179--GOTO
FEPRIV_ERR
     13252**LABEL   13156--CALLALT
FEPRIV_LOOP
     13144**LABEL   13151--REMEMBR
FEPRIV_S_OPT
      9978**DCL     13144--ASSIGN
I
     13115**DCL     13159<<DOINDEX 13161>>ASSIGN  13182>>ASSIGN  13183>>ASSIGN  13290<<DOINDEX 13292>>ASSIGN
     13313>>ASSIGN  13314>>ASSIGN
IN_BUF
     10117**DCL     13154<>CALL    13285<>CALL
J
     13116**DCL     13189<<DOINDEX 13190>>ASSIGN  13192>>ASSIGN  13194>>ASSIGN  13321<<DOINDEX 13322>>ASSIGN
     13324>>ASSIGN  13326>>ASSIGN
K
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:125  
     13117**DCL     13192<<ASSIGN  13193>>IF      13324<<ASSIGN  13325>>IF
KL_DEFAULT.PASSWORD
     12737**DCL     12741--REDEF
KL_DEFAULT.RENAME
     12760**DCL     12761--REDEF
KL_DFLT.KL_DFLT_FEBLK.PPRIV
     11996**DCL     13332>>IF
KL_DFLT.KL_DFLT_FEBLK.PRIV
     11995**DCL     13200>>IF
KL_DFLT.PASSWORD
     11927**DCL     11931--REDEF
KL_DFLT.RENAME
     11950**DCL     11951--REDEF
KL_DREC.KL_DREC_FEBLK.PPRIV
     11834**DCL     13375<<ASSIGN  13375>>ASSIGN  13382<<ASSIGN  13382>>ASSIGN
KL_DREC.KL_DREC_FEBLK.PRIV
     11833**DCL     13243<<ASSIGN  13243>>ASSIGN  13250<<ASSIGN  13250>>ASSIGN
KL_DREC.PASSWORD
     11765**DCL     11769--REDEF
KL_DREC.RENAME
     11788**DCL     11789--REDEF
KL_DREC_CNT.PASSWORD
     11652**DCL     11656--REDEF
KL_DREC_CNT.RENAME
     11675**DCL     11676--REDEF
MODE
     13119**DCL     13190<<ASSIGN  13200>>IF      13236>>ASSIGN  13243>>ASSIGN  13243>>ASSIGN  13245>>ASSIGN
     13250>>ASSIGN  13250>>ASSIGN  13252>>ASSIGN  13322<<ASSIGN  13332>>IF      13368>>ASSIGN  13375>>ASSIGN
     13375>>ASSIGN  13377>>ASSIGN  13382>>ASSIGN  13382>>ASSIGN  13384>>ASSIGN
MORE
     13122**DCL     13145<<ASSIGN  13150>>DOWHILE 13276<<ASSIGN  13281>>DOWHILE
NODE$
     10119**DCL     12991--IMP-PTR 13157<<ASSIGN  13158>>ASSIGN  13161>>ASSIGN  13182>>ASSIGN  13183>>ASSIGN
     13288<<ASSIGN  13289>>ASSIGN  13292>>ASSIGN  13313>>ASSIGN  13314>>ASSIGN
NUM
     13120**DCL     13187<<ASSIGN  13189>>DOINDEX 13319<<ASSIGN  13321>>DOINDEX
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:126  
P$
     13124**DCL     13183<<ASSIGN  13187>>ASSIGN  13190>>ASSIGN  13192>>ASSIGN  13194>>ASSIGN  13314<<ASSIGN
     13319>>ASSIGN  13322>>ASSIGN  13324>>ASSIGN  13326>>ASSIGN
P$LIT.COUNT
     13071**DCL     13074--IMP-SIZ 13237>>ASSIGN  13238>>ASSIGN  13369>>ASSIGN  13370>>ASSIGN
P$LIT.TEXT
     13074**DCL     13238>>ASSIGN  13370>>ASSIGN
P$NODE.CODE
     12999**DCL     13161>>ASSIGN  13182>>ASSIGN  13190>>ASSIGN  13194>>ASSIGN  13292>>ASSIGN  13313>>ASSIGN
     13322>>ASSIGN  13326>>ASSIGN
P$NODE.SUBLK$
     13024**DCL     13161>>ASSIGN  13182>>ASSIGN  13182>>ASSIGN  13183>>ASSIGN  13183>>ASSIGN  13190>>ASSIGN
     13190>>ASSIGN  13192>>ASSIGN  13194>>ASSIGN  13194>>ASSIGN  13292>>ASSIGN  13313>>ASSIGN  13313>>ASSIGN
     13314>>ASSIGN  13314>>ASSIGN  13322>>ASSIGN  13322>>ASSIGN  13324>>ASSIGN  13326>>ASSIGN  13326>>ASSIGN
P$NODE.SUBNODES
     13003**DCL     13158>>ASSIGN  13187>>ASSIGN  13192>>ASSIGN  13289>>ASSIGN  13319>>ASSIGN  13324>>ASSIGN
PROJ_KEY.TEXT
      9999**DCL      9999--REDEF
PROJ_KEY.TXT.PROJECT
      9999**DCL      9999--REDEF
P_PCB
     10154**DCL     13156<>CALL    13287<>CALL
P_PCB.ERROR
     10258**DCL     13269<>CALL    13401<>CALL
P_PCB.NCHARS
     10301**DCL     13155<<ASSIGN  13286<<ASSIGN
P_PCB.OUT$
     10167**DCL     13157>>ASSIGN  13288>>ASSIGN
P_PCB.ROOT$
     10159**DCL     13144<<ASSIGN  13166<<ASSIGN  13275<<ASSIGN  13297<<ASSIGN
REMEM_VAR
     10125**DCL     10125--REDEF   13151<<REMEMBR 13282<<REMEMBR
REM_FCMD
     10125**DCL     10126--REDEF
SUBNODES
     13121**DCL     13158<<ASSIGN  13159>>DOINDEX 13289<<ASSIGN  13290>>DOINDEX
PL6.E3A0      #002=ASC$FEPRIV File=ASC$PRIV.:E05TSI                              TUE 07/29/97 09:40 Page:127  
TEMP_FEPRIV
     13125**DCL     13185<<ASSIGN  13200>>IF      13243>>ASSIGN  13250>>ASSIGN  13316<<ASSIGN  13332>>IF
     13375>>ASSIGN  13382>>ASSIGN
USERS_KEY.TEXT
      9996**DCL      9997--REDEF    9997--REDEF    9997--REDEF    9998--REDEF
X$PARSE
     13089**DCL-ENT 13156--CALL    13287--CALL
