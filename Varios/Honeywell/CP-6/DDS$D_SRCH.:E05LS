VERSION E05

PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:1    
        1        1        /*M*  DDS$D_SRCH - search special desc/ptr names  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        DDS$D_SRCH: PROC(SYM$,DESC_VAL) ALTRET;
        9        9        /* Parameters */
       10       10    1   DCL SYM$ PTR;
       11       11    1   DCL 1 DESC_VAL UNAL,
       12       12    1         2 TYPE UBIN(6) UNAL,
       13       13    1         2 ID UBIN(9) UNAL,
       14       14    1         2 DISP UBIN(9) UNAL,
       15       15    1         2 FLAGS UBIN(6) UNAL,
       16       16    1         2 FMT UBIN(6) UNAL;
       17       17        /* Locals */
       18       18    1   DCL I SBIN;
       19       19    1   DCL J SBIN;
       20       20    1   DCL T UBIN(9);
       21       21    1   DCL SIZE SBIN;
       22       22    1   DCL VALUE SBIN;
       23       23    1   DCL SP_NAME CHAR(16);              /*** Bigger than longest special name! ***/
       24       24    1   DCL ULIMIT(0:11) SBIN CONSTANT INIT(510,510,510,8,7,7,510,510,510,3,7,7);
       25       25    1   DCL LLIMIT(0:11) SBIN CONSTANT INIT(0,0,0,1,0,0,1,1,0,1,1,1);
       26       26    1   DCL 1 CHAR3 BASED,
       27       27    1         2 * UBIN(9) UNAL,
       28       28    1         2 TXT CHAR(3) UNAL;
       29       29        /* Misc */
       30       30             %LIST;
       31       31             %INCLUDE DD_DESC_R;
        1+      32        /*M* DD_DESC_R - SYMREF FOR SPECIAL DESC/PTR SYMBOLS STRUCTURE */
        2+      33        /*T***********************************************************/
        3+      34        /*T*                                                         */
        4+      35        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5+      36        /*T*                                                         */
        6+      37        /*T***********************************************************/
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:2    
        7+      38        /*X* DMC,DFC */
        8+      39        /* These EQUs are the indexes into the table build in DD_SPEC_D */
        9+      40             %EQU SSR_DESC=0;     /* INDEX TO $SSR */
       10+      41             %EQU JIT_DESC=1;     /* INDEX TO $JIT */
       11+      42             %EQU HJIT_DESC=2;    /* INDEX TO $HJIT */
       12+      43             %EQU ISR_DESC=3;     /* INDEX TO $ISR */
       13+      44             %EQU ASR_DESC=4;     /* INDEX TO $ASR */
       14+      45             %EQU LSR_DESC=5;     /* INDEX TO $LSR */
       15+      46             %EQU PSR_DESC=6;     /* INDEX TO $PSR */
       16+      47             %EQU AUTO_DESC=7;    /* INDEX TO $AUTO */
       17+      48             %EQU REAL_DESC=8;    /* INDEX TO $REAL */
       18+      49             %EQU VIRT_DESC=9;    /* INDEX TO $VIRT */
       19+      50             %EQU IOBUF_DESC=10;  /* INDEX TO $IOBUF */
       20+      51             %EQU TCB_DESC=11;   /* INDEX TO $TCB */
       21+      52             %EQU SAD_DESC=12;   /* INDEX TO $SAD */
       22+      53             %EQU RVB_DESC=13;   /* INDEX TO $RVB */
       23+      54             %EQU USD_DESC=14;   /* INDEX TO $USD */
       24+      55             %EQU ERR_DESC=15;   /* INDEX TO $ERR */
       25+      56             %EQU HEAD_DESC=16;  /* INDEX TO $HEAD */
       26+      57             %EQU ROSEG_DESC=17; /* INDEX TO $ROSEG */
       27+      58             %EQU RDBR_DESC=18;  /* INDEX TO $RDBR */
       28+      59             %EQU TSA_DESC=19;   /* INDEX TO $TSA */
       29+      60             %EQU RES_DESC=20;   /* INDEX TO $RES */
       30+      61             %EQU LS_DESC=21;    /* INDEX TO $LS */
       31+      62             %EQU AS_DESC=22;    /* INDEX TO $AS */
       32+      63             %EQU PS_DESC=23;    /* INDEX TO $PS */
       33+      64             %EQU DS_DESC=24;    /* INDEX TO $DS */
       34+      65             %EQU DR_DESC=25;    /* INDEX TO $DR */
       35+      66             %EQU PR_DESC=26;    /* INDEX TO $PR */
       36+      67             %EQU PARM_DESC=27;  /* INDEX TO $PARM */
       37+      68             %EQU DCB_DESC=28;   /* INDEX TO $DCB */
       38+      69             %EQU CG_DESC=29;    /* INDEX TO $CG */
       39+      70             %EQU VS_DESC=30;    /* INDEX TO $VSn */
       40+      71             %EQU B_DESC=31;    /* INDEX TO $Bn */
       41+      72             %EQU IS_DESC=32;    /* INDEX TO $ISn */
       42+      73
       43+      74             %EQU DESC_NONUMLO = 0;
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:3    
       44+      75             %EQU DESC_NONUMHI = 20;
       45+      76             %EQU DESC_NUMLO = 21;
       46+      77             %EQU DESC_NUMHI = 32;
       47+      78    1        DCL 1 DESC(0:1)  SYMREF,
       48+      79    1             2 NAME$ PTR,        /* PTR TO NAME IN TEXTC */
       49+      80    1             2 ITEM BIT(36);     /* VALUE FOR DITEM STRUCTURE  */
       32       81             %PLIST;
       33       82             %INCLUDE DD_ICODE_C;
       34       97             %INCLUDE B$TABLES_C;
       35      205             %B$XL_UPPER (NAME=UP);
       36      209        %INCLUDE XUH_MACRO_C;
       37      293        %INCLUDE DD_SD_M;
       38     1629        %S_D;
       39     2947    1   DCL 1 TEXTC BASED,
       40     2948    1         2 SZ UBIN(9) UNAL,
       41     2949    1         2 TXT CHAR(TEXTC.SZ) UNAL;
       42     2950    1   DCL 1 TEXTR BASED,
       43     2951    1         2 * UBIN(9) UNAL,
       44     2952    1         2 TXT CHAR(SIZE);
       45     2953                                 /* First check list of names w/o numeric suffix  */
       46     2954    1        CALL XLATE(SP_NAME, UP, SYM$->TEXTC.TXT);
       47     2955    2        DO I = %DESC_NONUMLO TO %DESC_NONUMHI;
       48     2956    2             IF SP_NAME = DESC.NAME$(I) -> TEXTC.TXT THEN
       49     2957    3             DO;
       50     2958    3                  DESC_VAL = DESC.ITEM(I);
       51     2959    3                  ALTRETURN;               /* Found a good one */
       52     2960    3                END;
       53     2961    2           END;
       54     2962                                                /* Check names with numeric suffix  */
       55     2963    2        DO I = %DESC_NUMLO TO %DESC_NUMHI;
       56     2964    2             SIZE = DESC.NAME$(I) -> TEXTC.SZ;
       57     2965    2             IF substr(SP_NAME,,SIZE) = DESC.NAME$(I)->TEXTC.TXT THEN
       58     2966    3             DO;
       59     2967    3                  IF SYM$ -> TEXTC.SZ = SIZE
       60     2968    3                  THEN RETURN;             /* Missing numeric suffix */
       61     2969    4                  DO J = SIZE TO SYM$ -> TEXTC.SZ - 1;
       62     2970    4                       T = ASCBIN(SUBSTR(SYM$ -> TEXTC.TXT,J,1));
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:4    
       63     2971    4                       IF (T < 48) OR (T > 57)
       64     2972    4                       THEN RETURN;        /* Non-numeric suffix */
       65     2973    4                     END;                  /* DO J = SIZE ... */
       66     2974    3                  CALL CHARBIN(VALUE,SUBSTR(SYM$ -> TEXTC.TXT, SIZE));
       67     2975    3                  IF (VALUE < LLIMIT(I-%DESC_NUMLO)) OR (VALUE > ULIMIT(I-%DESC_NUMLO))
       68     2976    3                  THEN RETURN;             /* Bad value for suffix */
       69     2977    3                  DESC_VAL = DESC.ITEM(I);
       70     2978    4                  DO CASE(I);
       71     2979    4                    CASE(%LS_DESC, %AS_DESC, %PS_DESC);
       72     2980    4                       DESC_VAL.DISP = VALUE * 2;
       73     2981    4                    CASE(%DS_DESC);
       74     2982    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
       75     2983    4                       THEN DESC_VAL.DISP = 8 + (VALUE - 1) * 2;
       76     2984    4                       ELSE DESC_VAL.DISP = VALUE;
       77     2985    4                    CASE(%DR_DESC);
       78     2986    4                       DESC_VAL.DISP = 24 + VALUE * 2;
       79     2987    4                    CASE(%PR_DESC);
       80     2988    4                       DESC_VAL.DISP = 24 + VALUE * 2;
       81     2989    4                       DESC_VAL.ID = 16 + VALUE;
       82     2990    4                    CASE(%PARM_DESC, %DCB_DESC, %CG_DESC, %B_DESC);
       83     2991    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND
       84     2992    4                         I = %PARM_DESC
       85     2993    4                       THEN DESC_VAL.DISP = VALUE * 2;
       86     2994    4                       ELSE DESC_VAL.DISP = VALUE;
       87     2995    4                    CASE(%VS_DESC);
       88     2996    4                       DESC_VAL.DISP = 52 + (VALUE - 1) * 2;
       89     2997    4                    CASE(%IS_DESC);
       90     2998    4                       DESC_VAL.DISP = VALUE;
       91     2999    4                    END;
       92     3000    3                  ALTRETURN;               /* Found a good one */
       93     3001    3                END;                       /* END THEN DO; */
       94     3002    2           END;
       95     3003    1        RETURN;                            /* Didn't find it */
       96     3004    1   END DDS$D_SRCH;

PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:5    
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$D_SRCH.

   Procedure DDS$D_SRCH requires 223 words for executable code.
   Procedure DDS$D_SRCH requires 16 words of local(AUTO) storage.

    No errors detected in file DDS$D_SRCH.:E05TSI    .

PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:6    

 Object Unit name= DDS$D_SRCH                                 File name= DDS$D_SRCH.:E05TOU
 UTS= JUL 29 '97 14:15:45.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     24     30  DDS$D_SRCH
    1   Proc  even  none   223    337  DDS$D_SRCH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  DDS$D_SRCH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DESC                             r    B$XL_UPPER$                      r    S_D$
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:7    


        1        1        /*M*  DDS$D_SRCH - search special desc/ptr names  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        DDS$D_SRCH: PROC(SYM$,DESC_VAL) ALTRET;

      8  1 000000   000000 700200 xent  DDS$D_SRCH   TSX0  ! X66_AUTO_2
         1 000001   000020 000002                    ZERO    16,2

        9        9        /* Parameters */
       10       10    1   DCL SYM$ PTR;
       11       11    1   DCL 1 DESC_VAL UNAL,
       12       12    1         2 TYPE UBIN(6) UNAL,
       13       13    1         2 ID UBIN(9) UNAL,
       14       14    1         2 DISP UBIN(9) UNAL,
       15       15    1         2 FLAGS UBIN(6) UNAL,
       16       16    1         2 FMT UBIN(6) UNAL;
       17       17        /* Locals */
       18       18    1   DCL I SBIN;
       19       19    1   DCL J SBIN;
       20       20    1   DCL T UBIN(9);
       21       21    1   DCL SIZE SBIN;
       22       22    1   DCL VALUE SBIN;
       23       23    1   DCL SP_NAME CHAR(16);              /*** Bigger than longest special name! ***/
       24       24    1   DCL ULIMIT(0:11) SBIN CONSTANT INIT(510,510,510,8,7,7,510,510,510,3,7,7);
       25       25    1   DCL LLIMIT(0:11) SBIN CONSTANT INIT(0,0,0,1,0,0,1,1,0,1,1,1);
       26       26    1   DCL 1 CHAR3 BASED,
       27       27    1         2 * UBIN(9) UNAL,
       28       28    1         2 TXT CHAR(3) UNAL;
       29       29        /* Misc */
       30       30             %LIST;
       31       31             %INCLUDE DD_DESC_R;
        1+      32        /*M* DD_DESC_R - SYMREF FOR SPECIAL DESC/PTR SYMBOLS STRUCTURE */
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:8    
        2+      33        /*T***********************************************************/
        3+      34        /*T*                                                         */
        4+      35        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5+      36        /*T*                                                         */
        6+      37        /*T***********************************************************/
        7+      38        /*X* DMC,DFC */
        8+      39        /* These EQUs are the indexes into the table build in DD_SPEC_D */
        9+      40             %EQU SSR_DESC=0;     /* INDEX TO $SSR */
       10+      41             %EQU JIT_DESC=1;     /* INDEX TO $JIT */
       11+      42             %EQU HJIT_DESC=2;    /* INDEX TO $HJIT */
       12+      43             %EQU ISR_DESC=3;     /* INDEX TO $ISR */
       13+      44             %EQU ASR_DESC=4;     /* INDEX TO $ASR */
       14+      45             %EQU LSR_DESC=5;     /* INDEX TO $LSR */
       15+      46             %EQU PSR_DESC=6;     /* INDEX TO $PSR */
       16+      47             %EQU AUTO_DESC=7;    /* INDEX TO $AUTO */
       17+      48             %EQU REAL_DESC=8;    /* INDEX TO $REAL */
       18+      49             %EQU VIRT_DESC=9;    /* INDEX TO $VIRT */
       19+      50             %EQU IOBUF_DESC=10;  /* INDEX TO $IOBUF */
       20+      51             %EQU TCB_DESC=11;   /* INDEX TO $TCB */
       21+      52             %EQU SAD_DESC=12;   /* INDEX TO $SAD */
       22+      53             %EQU RVB_DESC=13;   /* INDEX TO $RVB */
       23+      54             %EQU USD_DESC=14;   /* INDEX TO $USD */
       24+      55             %EQU ERR_DESC=15;   /* INDEX TO $ERR */
       25+      56             %EQU HEAD_DESC=16;  /* INDEX TO $HEAD */
       26+      57             %EQU ROSEG_DESC=17; /* INDEX TO $ROSEG */
       27+      58             %EQU RDBR_DESC=18;  /* INDEX TO $RDBR */
       28+      59             %EQU TSA_DESC=19;   /* INDEX TO $TSA */
       29+      60             %EQU RES_DESC=20;   /* INDEX TO $RES */
       30+      61             %EQU LS_DESC=21;    /* INDEX TO $LS */
       31+      62             %EQU AS_DESC=22;    /* INDEX TO $AS */
       32+      63             %EQU PS_DESC=23;    /* INDEX TO $PS */
       33+      64             %EQU DS_DESC=24;    /* INDEX TO $DS */
       34+      65             %EQU DR_DESC=25;    /* INDEX TO $DR */
       35+      66             %EQU PR_DESC=26;    /* INDEX TO $PR */
       36+      67             %EQU PARM_DESC=27;  /* INDEX TO $PARM */
       37+      68             %EQU DCB_DESC=28;   /* INDEX TO $DCB */
       38+      69             %EQU CG_DESC=29;    /* INDEX TO $CG */
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:9    
       39+      70             %EQU VS_DESC=30;    /* INDEX TO $VSn */
       40+      71             %EQU B_DESC=31;    /* INDEX TO $Bn */
       41+      72             %EQU IS_DESC=32;    /* INDEX TO $ISn */
       42+      73
       43+      74             %EQU DESC_NONUMLO = 0;
       44+      75             %EQU DESC_NONUMHI = 20;
       45+      76             %EQU DESC_NUMLO = 21;
       46+      77             %EQU DESC_NUMHI = 32;
       47+      78    1        DCL 1 DESC(0:1)  SYMREF,
       48+      79    1             2 NAME$ PTR,        /* PTR TO NAME IN TEXTC */
       49+      80    1             2 ITEM BIT(36);     /* VALUE FOR DITEM STRUCTURE  */
       32       81             %PLIST;
       33       82             %INCLUDE DD_ICODE_C;
       34       97             %INCLUDE B$TABLES_C;
       35      205             %B$XL_UPPER (NAME=UP);
       36      209        %INCLUDE XUH_MACRO_C;
       37      293        %INCLUDE DD_SD_M;
       38     1629        %S_D;
       39     2947    1   DCL 1 TEXTC BASED,
       40     2948    1         2 SZ UBIN(9) UNAL,
       41     2949    1         2 TXT CHAR(TEXTC.SZ) UNAL;
       42     2950    1   DCL 1 TEXTR BASED,
       43     2951    1         2 * UBIN(9) UNAL,
       44     2952    1         2 TXT CHAR(SIZE);
       45     2953                                 /* First check list of names w/o numeric suffix  */
       46     2954    1        CALL XLATE(SP_NAME, UP, SYM$->TEXTC.TXT);

   2954  1 000002   200003 470500                    LDP0    @SYM$,,AUTO
         1 000003   000000 471500                    LDP1    0,,PR0
         1 000004   000100 101500                    MRL     fill='000'O
         1 000005   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000006   200016 000002                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=2
         1 000007   200016 220100                    LDX0    SP_NAME+4,,AUTO
         1 000010   000000 473400 xsym               LDP3    B$XL_UPPER$
         1 000011   040100 160540                    MVT     fill='040'O
         1 000012   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         1 000013   200012 000020                    ADSC9   SP_NAME,,AUTO            cn=0,n=16
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:10   
         1 000014   300000 000100                    ARG     0,,PR3

       47     2955    2        DO I = %DESC_NONUMLO TO %DESC_NONUMHI;

   2955  1 000015   200005 450100                    STZ     I,,AUTO

       48     2956    2             IF SP_NAME = DESC.NAME$(I) -> TEXTC.TXT THEN

   2956  1 000016   200005 235100                    LDA     I,,AUTO
         1 000017   000001 735000                    ALS     1
         1 000020   000000 470405 xsym               LDP0    DESC,AL
         1 000021   000100 101500                    MRL     fill='000'O
         1 000022   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000023   200016 000002                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=2
         1 000024   200016 220100                    LDX0    SP_NAME+4,,AUTO
         1 000025   040140 106500                    CMPC    fill='040'O
         1 000026   200012 000020                    ADSC9   SP_NAME,,AUTO            cn=0,n=16
         1 000027   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         1 000030   000043 601000 1                  TNZ     s:2961

       49     2957    3             DO;

       50     2958    3                  DESC_VAL = DESC.ITEM(I);

   2958  1 000031   200005 236100                    LDQ     I,,AUTO
         1 000032   000110 402007                    MPY     72,DL
         1 000033   000000 116003                    CMPQ    0,DU
         1 000034   000036 605000 1                  TPL     s:2958+5
         1 000035   000044 036003                    ADLQ    36,DU
         1 000036   200004 470500                    LDP0    @DESC_VAL,,AUTO
         1 000037   003100 060406                    CSL     bolr='003'O
         1 000040   000001 000044 xsym               BDSC    DESC+1,Q                 by=0,bit=0,n=36
         1 000041   000000 000044                    BDSC    0,,PR0                   by=0,bit=0,n=36

       51     2959    3                  ALTRETURN;               /* Found a good one */

   2959  1 000042   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:11   

       52     2960    3                END;
       53     2961    2           END;

   2961  1 000043   200005 054100                    AOS     I,,AUTO
         1 000044   200005 235100                    LDA     I,,AUTO
         1 000045   000024 115007                    CMPA    20,DL
         1 000046   000016 604400 1                  TMOZ    s:2956

       54     2962                                                /* Check names with numeric suffix  */
       55     2963    2        DO I = %DESC_NUMLO TO %DESC_NUMHI;

   2963  1 000047   000025 236007                    LDQ     21,DL
         1 000050   200005 756100                    STQ     I,,AUTO

       56     2964    2             SIZE = DESC.NAME$(I) -> TEXTC.SZ;

   2964  1 000051   200005 235100                    LDA     I,,AUTO
         1 000052   000001 735000                    ALS     1
         1 000053   000000 470405 xsym               LDP0    DESC,AL
         1 000054   000100 101500                    MRL     fill='000'O
         1 000055   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000056   200010 000004                    ADSC9   SIZE,,AUTO               cn=0,n=4

       57     2965    2             IF substr(SP_NAME,,SIZE) = DESC.NAME$(I)->TEXTC.TXT THEN

   2965  1 000057   000100 101500                    MRL     fill='000'O
         1 000060   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000061   200016 000002                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=2
         1 000062   200016 220100                    LDX0    SP_NAME+4,,AUTO
         1 000063   200010 721100                    LXL1    SIZE,,AUTO
         1 000064   040140 106540                    CMPC    fill='040'O
         1 000065   200012 000011                    ADSC9   SP_NAME,,AUTO            cn=0,n=*X1
         1 000066   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         1 000067   000332 601000 1                  TNZ     s:3002

       58     2966    3             DO;
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:12   

       59     2967    3                  IF SYM$ -> TEXTC.SZ = SIZE

   2967  1 000070   200003 471500                    LDP1    @SYM$,,AUTO
         1 000071   100000 473500                    LDP3    0,,PR1
         1 000072   000100 101500                    MRL     fill='000'O
         1 000073   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000074   200016 000004                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=4
         1 000075   200016 236100                    LDQ     SP_NAME+4,,AUTO
         1 000076   200010 116100                    CMPQ    SIZE,,AUTO
         1 000077   000101 601000 1                  TNZ     s:2969

       60     2968    3                  THEN RETURN;             /* Missing numeric suffix */

   2968  1 000100   000000 702200 xent               TSX2  ! X66_ARET

       61     2969    4                  DO J = SIZE TO SYM$ -> TEXTC.SZ - 1;

   2969  1 000101   200010 235100                    LDA     SIZE,,AUTO
         1 000102   200006 755100                    STA     J,,AUTO
         1 000103   000131 710000 1                  TRA     s:2973+1

       62     2970    4                       T = ASCBIN(SUBSTR(SYM$ -> TEXTC.TXT,J,1));

   2970  1 000104   200003 470500                    LDP0    @SYM$,,AUTO
         1 000105   000000 471500                    LDP1    0,,PR0
         1 000106   000100 101500                    MRL     fill='000'O
         1 000107   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000110   200016 000002                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=2
         1 000111   200016 220100                    LDX0    SP_NAME+4,,AUTO
         1 000112   200006 235100                    LDA     J,,AUTO
         1 000113   000100 101505                    MRL     fill='000'O
         1 000114   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         1 000115   200017 000004                    ADSC9   SP_NAME+5,,AUTO          cn=0,n=4
         1 000116   200017 236100                    LDQ     SP_NAME+5,,AUTO
         1 000117   000033 736000                    QLS     27
         1 000120   200007 756100                    STQ     T,,AUTO
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:13   

       63     2971    4                       IF (T < 48) OR (T > 57)

   2971  1 000121   200007 236100                    LDQ     T,,AUTO
         1 000122   777000 376003                    ANQ     -512,DU
         1 000123   060000 116003                    CMPQ    24576,DU
         1 000124   000127 602000 1                  TNC     s:2972
         1 000125   072000 116003                    CMPQ    29696,DU
         1 000126   000130 602000 1                  TNC     s:2973

       64     2972    4                       THEN RETURN;        /* Non-numeric suffix */

   2972  1 000127   000000 702200 xent               TSX2  ! X66_ARET

       65     2973    4                     END;                  /* DO J = SIZE ... */

   2973  1 000130   200006 054100                    AOS     J,,AUTO
         1 000131   200003 470500                    LDP0    @SYM$,,AUTO
         1 000132   000000 471500                    LDP1    0,,PR0
         1 000133   000100 101500                    MRL     fill='000'O
         1 000134   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000135   200016 000004                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=4
         1 000136   200016 236100                    LDQ     SP_NAME+4,,AUTO
         1 000137   200006 116100                    CMPQ    J,,AUTO
         1 000140   000104 605400 1                  TPNZ    s:2970

       66     2974    3                  CALL CHARBIN(VALUE,SUBSTR(SYM$ -> TEXTC.TXT, SIZE));

   2974  1 000141   000000 471500                    LDP1    0,,PR0
         1 000142   000100 101500                    MRL     fill='000'O
         1 000143   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000144   200016 000002                    ADSC9   SP_NAME+4,,AUTO          cn=0,n=2
         1 000145   200016 220100                    LDX0    SP_NAME+4,,AUTO
         1 000146   000000 636010                    EAQ     0,X0
         1 000147   000022 772000                    QRL     18
         1 000150   200010 136100                    SBLQ    SIZE,,AUTO
         1 000151   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:14   
         1 000152   200010 235100                    LDA     SIZE,,AUTO
         1 000153   000100 305545                    DTB
         1 000154   100000 230011                    NDSC9   0,A,PR1                  cn=1,s=nosgn,sf=0,n=*X1
         1 000155   200011 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

       67     2975    3                 IF (VALUE < LLIMIT(I-%DESC_NUMLO)) OR (VALUE > ULIMIT(I-%DESC_NUMLO))

   2975  1 000156   200005 720100                    LXL0    I,,AUTO
         1 000157   200011 236100                    LDQ     VALUE,,AUTO
         1 000160   777767 116010 0                  CMPQ    LLIMIT-21,X0
         1 000161   000164 604000 1                  TMI     s:2976
         1 000162   777753 116010 0                  CMPQ    LLIMIT-33,X0
         1 000163   000165 604400 1                  TMOZ    s:2977

       68     2976    3                  THEN RETURN;             /* Bad value for suffix */

   2976  1 000164   000000 702200 xent               TSX2  ! X66_ARET

       69     2977    3                  DESC_VAL = DESC.ITEM(I);

   2977  1 000165   200005 236100                    LDQ     I,,AUTO
         1 000166   000110 402007                    MPY     72,DL
         1 000167   000000 116003                    CMPQ    0,DU
         1 000170   000172 605000 1                  TPL     s:2977+5
         1 000171   000044 036003                    ADLQ    36,DU
         1 000172   200004 471500                    LDP1    @DESC_VAL,,AUTO
         1 000173   003100 060406                    CSL     bolr='003'O
         1 000174   000001 000044 xsym               BDSC    DESC+1,Q                 by=0,bit=0,n=36
         1 000175   100000 000044                    BDSC    0,,PR1                   by=0,bit=0,n=36

       70     2978    4                  DO CASE(I);

   2978  1 000176   200005 235100                    LDA     I,,AUTO
         1 000177   000025 135007                    SBLA    21,DL
         1 000200   000014 115007                    CMPA    12,DL
         1 000201   000203 602005 1                  TNC     s:2978+5,AL
         1 000202   000331 710000 1                  TRA     s:3000
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:15   
         1 000203   000217 710000 1                  TRA     s:2980
         1 000204   000217 710000 1                  TRA     s:2980
         1 000205   000217 710000 1                  TRA     s:2980
         1 000206   000226 710000 1                  TRA     s:2982
         1 000207   000246 710000 1                  TRA     s:2986
         1 000210   000256 710000 1                  TRA     s:2988
         1 000211   000274 710000 1                  TRA     s:2991
         1 000212   000274 710000 1                  TRA     s:2991
         1 000213   000274 710000 1                  TRA     s:2991
         1 000214   000316 710000 1                  TRA     s:2996
         1 000215   000274 710000 1                  TRA     s:2991
         1 000216   000326 710000 1                  TRA     s:2998

       71     2979    4                    CASE(%LS_DESC, %AS_DESC, %PS_DESC);

       72     2980    4                       DESC_VAL.DISP = VALUE * 2;

   2980  1 000217   200011 236100                    LDQ     VALUE,,AUTO
         1 000220   000001 736000                    QLS     1
         1 000221   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000222   003100 061500                    CSR     bolr='003'O
         1 000223   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000224   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000225   000331 710000 1                  TRA     s:3000

       73     2981    4                    CASE(%DS_DESC);

       74     2982    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   2982  1 000226   000000 473400 xsym               LDP3    S_D$
         1 000227   306714 235100                    LDA     3532,,PR3
         1 000230   000001 115007                    CMPA    1,DL
         1 000231   000242 601000 1                  TNZ     s:2984

       75     2983    4                       THEN DESC_VAL.DISP = 8 + (VALUE - 1) * 2;

   2983  1 000232   200011 236100                    LDQ     VALUE,,AUTO
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:16   
         1 000233   000001 736000                    QLS     1
         1 000234   000006 036007                    ADLQ    6,DL
         1 000235   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000236   003100 061500                    CSR     bolr='003'O
         1 000237   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000240   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000241   000331 710000 1                  TRA     s:3000

       76     2984    4                       ELSE DESC_VAL.DISP = VALUE;

   2984  1 000242   003100 061500                    CSR     bolr='003'O
         1 000243   200011 000044                    BDSC    VALUE,,AUTO              by=0,bit=0,n=36
         1 000244   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000245   000331 710000 1                  TRA     s:3000

       77     2985    4                    CASE(%DR_DESC);

       78     2986    4                       DESC_VAL.DISP = 24 + VALUE * 2;

   2986  1 000246   200011 236100                    LDQ     VALUE,,AUTO
         1 000247   000001 736000                    QLS     1
         1 000250   000030 036007                    ADLQ    24,DL
         1 000251   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000252   003100 061500                    CSR     bolr='003'O
         1 000253   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000254   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000255   000331 710000 1                  TRA     s:3000

       79     2987    4                    CASE(%PR_DESC);

       80     2988    4                       DESC_VAL.DISP = 24 + VALUE * 2;

   2988  1 000256   200011 236100                    LDQ     VALUE,,AUTO
         1 000257   000001 736000                    QLS     1
         1 000260   000030 036007                    ADLQ    24,DL
         1 000261   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000262   003100 061500                    CSR     bolr='003'O
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:17   
         1 000263   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000264   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9

       81     2989    4                       DESC_VAL.ID = 16 + VALUE;

   2989  1 000265   200011 236100                    LDQ     VALUE,,AUTO
         1 000266   000020 036007                    ADLQ    16,DL
         1 000267   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000270   003100 061500                    CSR     bolr='003'O
         1 000271   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000272   100000 060011                    BDSC    0,,PR1                   by=0,bit=6,n=9
         1 000273   000331 710000 1                  TRA     s:3000

       82     2990    4                    CASE(%PARM_DESC, %DCB_DESC, %CG_DESC, %B_DESC);

       83     2991    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6 AND

   2991  1 000274   000000 473400 xsym               LDP3    S_D$
         1 000275   306714 235100                    LDA     3532,,PR3
         1 000276   000002 115007                    CMPA    2,DL
         1 000277   000312 601000 1                  TNZ     s:2994
         1 000300   200005 236100                    LDQ     I,,AUTO
         1 000301   000033 116007                    CMPQ    27,DL
         1 000302   000312 601000 1                  TNZ     s:2994

       84     2992    4                         I = %PARM_DESC
       85     2993    4                       THEN DESC_VAL.DISP = VALUE * 2;

   2993  1 000303   200011 236100                    LDQ     VALUE,,AUTO
         1 000304   000001 736000                    QLS     1
         1 000305   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000306   003100 061500                    CSR     bolr='003'O
         1 000307   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000310   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000311   000331 710000 1                  TRA     s:3000

       86     2994    4                       ELSE DESC_VAL.DISP = VALUE;
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:18   

   2994  1 000312   003100 061500                    CSR     bolr='003'O
         1 000313   200011 000044                    BDSC    VALUE,,AUTO              by=0,bit=0,n=36
         1 000314   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000315   000331 710000 1                  TRA     s:3000

       87     2995    4                    CASE(%VS_DESC);

       88     2996    4                       DESC_VAL.DISP = 52 + (VALUE - 1) * 2;

   2996  1 000316   200011 236100                    LDQ     VALUE,,AUTO
         1 000317   000001 736000                    QLS     1
         1 000320   000062 036007                    ADLQ    50,DL
         1 000321   200016 756100                    STQ     SP_NAME+4,,AUTO
         1 000322   003100 061500                    CSR     bolr='003'O
         1 000323   200016 000044                    BDSC    SP_NAME+4,,AUTO          by=0,bit=0,n=36
         1 000324   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9
         1 000325   000331 710000 1                  TRA     s:3000

       89     2997    4                    CASE(%IS_DESC);

       90     2998    4                       DESC_VAL.DISP = VALUE;

   2998  1 000326   003100 061500                    CSR     bolr='003'O
         1 000327   200011 000044                    BDSC    VALUE,,AUTO              by=0,bit=0,n=36
         1 000330   100000 260011                    BDSC    0,,PR1                   by=1,bit=6,n=9

       91     2999    4                    END;

       92     3000    3                  ALTRETURN;               /* Found a good one */

   3000  1 000331   000000 702200 xent               TSX2  ! X66_AALT

       93     3001    3                END;                       /* END THEN DO; */
       94     3002    2           END;

   3002  1 000332   200005 054100                    AOS     I,,AUTO
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:19   
         1 000333   200005 235100                    LDA     I,,AUTO
         1 000334   000040 115007                    CMPA    32,DL
         1 000335   000051 604400 1                  TMOZ    s:2964

       95     3003    1        RETURN;                            /* Didn't find it */

   3003  1 000336   000000 702200 xent               TSX2  ! X66_ARET

ULIMIT
 Sect OctLoc
   0     000   000000 000776   000000 000776   000000 000776   000000 000010    ................
   0     004   000000 000007   000000 000007   000000 000776   000000 000776    ................
   0     010   000000 000776   000000 000003   000000 000007   000000 000007    ................

LLIMIT
 Sect OctLoc
   0     014   000000 000000   000000 000000   000000 000000   000000 000001    ................
   0     020   000000 000000   000000 000000   000000 000001   000000 000001    ................
   0     024   000000 000000   000000 000001   000000 000001   000000 000001    ................
       96     3004    1   END DDS$D_SRCH;

PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:20   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDS$D_SRCH.

   Procedure DDS$D_SRCH requires 223 words for executable code.
   Procedure DDS$D_SRCH requires 16 words of local(AUTO) storage.

    No errors detected in file DDS$D_SRCH.:E05TSI    .
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:21   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:22   
          MINI XREF LISTING

B$XL_UPPER$
       206**DCL       207--IMP-PTR  2954>>CALLBLT
DESC.ITEM
        80**DCL      2958>>ASSIGN   2977>>ASSIGN
DESC.NAME$
        79**DCL      2956>>IF       2956>>IF       2964>>ASSIGN   2965>>IF       2965>>IF
DESC_VAL
        11**DCL         8--PROC     2958<<ASSIGN   2977<<ASSIGN
DESC_VAL.DISP
        14**DCL      2980<<ASSIGN   2983<<ASSIGN   2984<<ASSIGN   2986<<ASSIGN   2988<<ASSIGN   2993<<ASSIGN
      2994<<ASSIGN   2996<<ASSIGN   2998<<ASSIGN
DESC_VAL.ID
        13**DCL      2989<<ASSIGN
I
        18**DCL      2955<<DOINDEX  2956>>IF       2956>>IF       2958>>ASSIGN   2963<<DOINDEX  2964>>ASSIGN
      2965>>IF       2965>>IF       2975>>IF       2975>>IF       2977>>ASSIGN   2978>>DOCASE   2991>>IF
J
        19**DCL      2969<<DOINDEX  2970>>ASSIGN
LLIMIT
        25**DCL      2975>>IF
SIZE
        21**DCL      2952--IMP-SIZ  2964<<ASSIGN   2965>>IF       2967>>IF       2969>>DOINDEX  2974>>CALLBLT
SP_NAME
        23**DCL      2954<<CALLBLT  2956>>IF       2965>>IF
SYM$
        10**DCL         8--PROC     2954>>CALLBLT  2954>>CALLBLT  2967>>IF       2969>>DOINDEX  2970>>ASSIGN
      2970>>ASSIGN   2974>>CALLBLT  2974>>CALLBLT
S_D.CURRENT_CHANNEL
      2581**DCL      2583--REDEF
S_D.DEBUGA
      1733**DCL      1735--REDEF
S_D.EIS
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:23   
      2691**DCL      2720--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      2624**DCL      2625--REDEF    2639--REDEF
S_D.JDE
      2238**DCL      2239--REDEF
S_D.L$.VALUE
      1791**DCL      1797--REDEF    1805--REDEF    1808--REDEF    1811--REDEF    1814--REDEF
S_D.L$.VALUE.L
      1792**DCL      1793--REDEF    1794--REDEF
S_D.L6_MESSAGE_BUF
      2645**DCL      2647--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      2656**DCL      2982>>IF       2991>>IF
S_D.OUTPUT
      2611**DCL      2613--REDEF
S_D.REMOTE_MSG.FNCC
      2630**DCL      2631--REDEF
S_D.REMOTE_MSG.STXC
      2626**DCL      2627--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2634**DCL      2635--REDEF
S_D.SV
      1690**DCL      1711--REDEF
S_D$
      2942**DCL      1638--IMP-PTR  2982>>IF       2991>>IF
T
        20**DCL      2970<<ASSIGN   2971>>IF       2971>>IF
TEXTC.SZ
      2948**DCL      2949--IMP-SIZ  2954>>CALLBLT  2956>>IF       2964>>ASSIGN   2965>>IF       2967>>IF
      2969>>DOINDEX  2970>>ASSIGN   2974>>CALLBLT
TEXTC.TXT
      2949**DCL      2954>>CALLBLT  2956>>IF       2965>>IF       2970>>ASSIGN   2974>>CALLBLT
ULIMIT
        24**DCL      2975>>IF
UP
       207**DCL      2954>>CALLBLT
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:24   
VALUE
        22**DCL      2974<<CALLBLT  2975>>IF       2975>>IF       2980>>ASSIGN   2983>>ASSIGN   2984>>ASSIGN
      2986>>ASSIGN   2988>>ASSIGN   2989>>ASSIGN   2993>>ASSIGN   2994>>ASSIGN   2996>>ASSIGN   2998>>ASSIGN
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:25   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDS$D_SRCH File=DDS$D_SRCH.:E05TSI                            TUE 07/29/97 14:15 Page:26   
              MINI UREF LISTING

B_POINTER     147**DCL-ENT
CHAR3      26**DCL
DDS$D_SRCH       8**PROC
TEXTR    2950**DCL
