VERSION E05

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:1    
        1        1        /*M*     VEE$EDIT   File building and maintanence utility */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /*P*     NAME:     VEE$EDIT
        9        9                 PURPOSE:  The cp-6 editor allows manipulation of data stored
       10       10                           in keyed files. Its capabilities include the building
       11       11                           copying, merging and deleteing of files as well
       12       12                           as various manipulation of data records within files
       13       13                           and data within records.
       14       14                 STRUCTURE: Edit is split into three modules. VEE$EDIT contains
       15       15                           the main control routine as well as routines to do the
       16       16                           syntax checking for all commands. VEM$MASTER contains
       17       17                           the routines that perform the editting functions.
       18       18                           VEX$EDITEXT is made up of subroutines called from
       19       19                           various places within Edit.   */
       20       20        /**/
       21       21        /*D*     NAME:     VEE$EDIT
       22       22                 PARAMETERS: None
       23       23                 DESCRIPTION: VEE$EDIT contains the main driver routine for edit
       24       24                           and the various parsing and execution control routines
       25       25                           for all of the edit commands.
       26       26                             When VEE$EDIT is entered some initialization
       27       27                           is performed and READ_CMD is called to read user commands
       28       28                           M$PARSE is called to parse the commands and CHECK_CMD
       29       29                           does further semantic checking and setting of selection
       30       30                           parameters for the se,st,ss,ft,fs,fd commands. The
       31       31                           command table (CMD_TBL) is build by CHECK_CMD to
       32       32                           record the commands given by the user.
       33       33                             If step mode is invoked by an st or ss command then
       34       34                           user is prompted for commands to be applied
       35       35                           to the open record. In any case the command table is
       36       36                           passed to VEM$MASTER to be processed.
       37       37                             If selection criteria have been established then
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:2    
       38       38                           CHECK_SSE is called to determine whether the open
       39       39                           record meets the criteria.
       40       40                 DCBS:     The following DCBs are used.
       41       41                           M$SI - user input
       42       42                           M$ME - output to user
       43       43                           M$DO - diagnostics
       44       44                           M$FILE - file open for editing
       45       45                           M$FILE2 - copy or merge file
       46       46        */
       47       47        /*K*     EDIT_KEY  edit writes keyed files with three byte keys. The format
       48       48                           of the keys is the binary value for the sequence
       49       49                           number times one thousand.
       50       50        *
       51       51                           ************************************
       52       52                           * COUNT *         VALUE            *
       53       53                           ************************************
       54       54        *
       55       55                           COUNT = 3
       56       56                           VALUE = SEQUENCE NUMBER * 1000          */
       57       57        /**/
       58       58        VEE$EDIT: PROC MAIN;
       59       59        /*********************************************************************/
       60       60        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       61       61        /*********************************************************************/
       62       62        /**/
       63       63        %PLIST;
       64       64        %INCLUDE VE_SUBS_C;
       65      258        %INCLUDE VE_PERR_C;
       66      475        %INCLUDE F$DCB;
       67      524        %INCLUDE CP_6;
       68      605        %INCLUDE CP_6_SUBS ;
       69     1145        %INCLUDE XU_MACRO_C;
       70     4251        %INCLUDE XU_PERR_C;
       71     4442        %INCLUDE B$JIT;
       72     4732        %INCLUDE B_ERRORS_C ;
       73     5859        %INCLUDE NK_VFC_C;
       74     5933        %INCLUDE B$TABLES_C;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:3    
       75     6041        %INCLUDE XU_SUBS_C ;
       76     6133        %INCLUDE XUG_ENTRY ;                    /* XUG ENTRY DCLS */
       77     6164
       78     6165        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:4    
       79     6166        /********************************************************************/
       80     6167        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       81     6168        /********************************************************************/
       82     6169        /**/
       83     6170        %FPT_GDS (FPTN = GDS_FPT,
       84     6171                 RESULTS = DS_RESULTS, STCLASS = CONSTANT,
       85     6172                 SEGSIZE = 1024);
       86     6188        /**/
       87     6189        %FPT_OPEN (FPTN = OPEN_ME,
       88     6190                  DCB = M$ME,
       89     6191                  SCRUB = YES,
       90     6192                  REASSIGN = YES,
       91     6193                  STCLASS = CONSTANT,
       92     6194                  FUN = CREATE,
       93     6195                  EXIST = OLDFILE) ;
       94     6304        /**/
       95     6305        %FPT_OPEN (FPTN = OPEN_DO,DCB=M$DO,STCLASS=CONSTANT);
       96     6414        /**/
       97     6415        %FPT_CLOSE    (FPTN = CLOSE_TY_FPT,
       98     6416                      STCLASS = STATIC,
       99     6417                      DISP = SAVE);
      100     6459        /**/
      101     6460        %FPT_OPEN  (FPTN = OPEN_SIREAD_FPT,
      102     6461                      NAME = OPEN_FILE_NAME,
      103     6462                      ASN = FILE,
      104     6463                      DISP = NAMED,
      105     6464                      SCRUB = YES,
      106     6465                      FUN = IN);
      107     6574        /**/
      108     6575        %FPT_OPEN  (FPTN = OPEN_SIME_FPT,
      109     6576                    DCB = M$SI, STCLASS = "CONSTANT  SYMDEF",
      110     6577                    SCRUB = YES,
      111     6578                    ASN = DEVICE,
      112     6579                    FUN = IN,
      113     6580                    RES = 'ME',
      114     6581                    REASSIGN = NO) ;
      115     6690        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:5    
      116     6691        %FPT_CLOSE (FPTN = CLOSE_SIREAD_FPT,
      117     6692                      DISP = SAVE,
      118     6693                      STCLASS ="STATIC SYMDEF") ;
      119     6735        /**/
      120     6736        %FPT_CLOSE (FPTN = CLOSE_FPT,
      121     6737                    STCLASS = CONSTANT,
      122     6738                    DCB = M$FILE,
      123     6739                    RELG = YES,
      124     6740                    DISP = SAVE) ;
      125     6782        %FPT_INT (FPTN=INT_FPT,UENTRY=VEX$BREAK,STCLASS=CONSTANT);
      126     6796        /**/
      127     6797        %VLP_TAB (FPTN = TAB_VLP,
      128     6798                  STCLASS ="STATIC  SYMDEF");
      129     6812        /**/
      130     6813        %VLP_TAB (FPTN = SAVE_TAB_VLP,
      131     6814                  STCLASS ="STATIC  SYMDEF");
      132     6828        /**/
      133     6829        %FPT_LINK  (FPTN = PCLLINK_FPT, STCLASS = CONSTANT,
      134     6830                    NAME = PCLNAME,
      135     6831                    ACCT = SYSACCT,
      136     6832                    CMD = TYPE_BUF);
      137     6850        /**/
      138     6851        %VLP_NAME  (FPTN = PCLNAME, STCLASS = CONSTANT,
      139     6852                    LEN = 3,
      140     6853                    NAME = 'PCL');
      141     6880        /**/
      142     6881        %VLP_ACCT  (FPTN = SYSACCT, STCLASS = CONSTANT,
      143     6882                    ACCT = ':SYS');
      144     6895        /**/
      145     6896        %VLP_ACCT (FPTN = VE_ERRMSGACCT ,
      146     6897                  STCLASS = SYMREF) ;
      147     6910        /**/
      148     6911        %VLP_TAB (FPTN = TAB$VLP,STCLASS = BASED);
      149     6925        %VLP_NAME (FPTN = DIR_TRASH ,
      150     6926                   LEN = 31 ) ;
      151     6953        /**/
      152     6954        %VLP_ACCT (FPTN = DIR_ACCT) ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:6    
      153     6967        /**/
      154     6968        %VLP_SN   (FPTN = DIR_SN ,
      155     6969                  N = 2 ) ;
      156     6982        /**/
      157     6983        %VLR_FID  (FPTN = FID_RESULTS) ;
      158     7002        /**/
      159     7003        %FPT_FID  (FPTN = FPT_FID , STCLASS = CONSTANT,
      160     7004                  ACCT = DIR_ACCT ,
      161     7005                  ASN = ASN ,
      162     7006                  NAME = DIR_TRASH ,
      163     7007                  PASS = DIR_TRASH ,
      164     7008                  RES = TBUF ,
      165     7009                  RESULTS = FID_RESULTS ,
      166     7010                  SN = DIR_SN ,
      167     7011                  TEXTFID = DIR_BUF ,
      168     7012                  WSN = DIR_TRASH ) ;
      169     7035        %FPT_RELDCB ( FPTN = RELDCB_FPT,
      170     7036                      STCLASS = STATIC) ;
      171     7050        %FPT_GETDCB ( FPTN = GETDCB_FPT,
      172     7051                      STCLASS = CONSTANT,
      173     7052                      DCBNAME = READ_DCB_NAME,
      174     7053                      DCBNUM = IN_DCBNUM) ;
      175     7068        %VLP_NAME ( FPTN = READ_DCB_NAME,
      176     7069                    NAME = 'M$READ',
      177     7070                    LEN = 6) ;
      178     7097        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:7    
      179     7098        /***************************************************************************/
      180     7099        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
      181     7100        /***************************************************************************/
      182     7101    1   DCL REC_BUF CHAR(PC_RECSIZE#) STATIC SYMDEF;
      183     7102    1   DCL TEMP_BUF CHAR(PC_RECSIZE#) STATIC SYMDEF;
      184     7103    1   DCL TY_DCBNUM UBIN WORD INIT(DCBNUM(M$ME)) STATIC SYMDEF ;
              7103            /* DCBNUM FOR OL COMMAND. */
      185     7104    1   DCL IN_DCBNUM UBIN WORD INIT(DCBNUM(M$SI)) STATIC SYMDEF ;
              7104            /* DCBNUM FOR READ COMMAND. */
      186     7105    1   DCL ME_DCBNUM UBIN WORD INIT(DCBNUM(M$ME)) STATIC SYMDEF ;
              7105            /* M$ME DCBNUM FOR OL COMMAND. */
      187     7106    1   DCL SI_DCBNUM UBIN WORD INIT(DCBNUM(M$SI)) STATIC SYMDEF ;
              7106            /* M$SI DCBNUM FOR READ COMMAND. */
      188     7107    1   DCL CMD_BUF CHAR(256) STATIC SYMDEF ALIGNED;
      189     7108    1   DCL TEMP_CMD_BUF CHAR(256) STATIC SYMDEF ALIGNED;
      190     7109    1   DCL 1 TYPE_BUF STATIC SYMDEF,
      191     7110    1          2 VFC CHAR(1) CALIGNED INIT(%VFC_S1A),
      192     7111    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      193     7112    1   DCL 1 SUB_BUF_1 STATIC SYMDEF,
      194     7113    1          2 COUNT UBIN(9) CALIGNED,
      195     7114    1          2 TEXT CHAR(31) CALIGNED;
      196     7115    1   DCL 1 SUB_BUF_2 STATIC SYMDEF,
      197     7116    1          2 COUNT UBIN(9) CALIGNED,
      198     7117    1          2 TEXT CHAR(31) CALIGNED;
      199     7118    1   DCL 1 SUB_BUF_3 STATIC SYMDEF,
      200     7119    1          2 COUNT UBIN(9) CALIGNED,
      201     7120    1          2 TEXT CHAR(31) CALIGNED;
      202     7121    1   DCL 1 STR_BUF STATIC SYMDEF,
      203     7122    1          2 COUNT UBIN HALF HALIGNED,
      204     7123    1          2 TEXT CHAR(PC_RECSIZE#) CALIGNED;
      205     7124    1   DCL SEQ_TEXT_BUF CHAR(9)  STATIC SYMDEF;
      206     7125    1   DCL 1 CURR_FILE_NAME STATIC SYMDEF,     /* Remember the FID being edited from*/
      207     7126    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
      208     7127    1          2 TEXT CHAR(31) CALIGNED;        /* that changed it.                  */
      209     7128    1   DCL   CURR_FILE_ACCT CHAR(8) STATIC SYMDEF ;
      210     7129    1   DCL   CURR_FILE_PASS CHAR(8) STATIC SYMDEF ;
      211     7130    1   DCL 1 CURR_FILE_SN  STATIC SYMDEF,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:8    
      212     7131    1          2 COUNT SBIN WORD INIT (1),
      213     7132    1          2 SN CHAR(6) CALIGNED INIT ('      ');
      214     7133    1   DCL 1 OPEN_FILE_NAME STATIC SYMDEF,     /* EDIT FILE NAME                     */
      215     7134    1          2 COUNT UBIN(9) CALIGNED INIT (10),
      216     7135    1          2 TEXT CHAR(31) CALIGNED INIT ('..........');
      217     7136    1   DCL OPEN_FILE_ACCT CHAR(8) STATIC SYMDEF INIT (' '); /* EDIT FILE ACCT       */
      218     7137    1   DCL OPEN_FILE_PASS CHAR(8) STATIC SYMDEF INIT (' '); /* EDIT FILE PASSWORD   */
      219     7138    1   DCL 1 OPEN_FILE_SN STATIC SYMDEF,
      220     7139    1          2 COUNT SBIN WORD INIT (1),
      221     7140    1          2 SN CHAR(6) CALIGNED INIT ('      ');
      222     7141    1   DCL 1 ERR_CODE STATIC SYMDEF,
      223     7142    1          2 FCG_MID BIT(18) UNAL INIT('260505'O),
      224     7143    1          2 MON BIT(1) UNAL INIT('0'B),
      225     7144    1          2 ERR# UBIN(14) UNAL INIT(E$E_HELP),
      226     7145    1          2 SEV UBIN(3) UNAL INIT(0);
      227     7146    1   DCL TYPE_CODE CHAR(2) STATIC SYMDEF INIT('SE');
      228     7147        /**/
      229     7148    1   DCL SSE_TBL(0:255) UBIN(36) AUTO;       /* SELECTION CRITERIA              */
      230     7149        /*B*     SSE_TBL   SSE_TBL IS A TABLE OF TWO WORD SSE_PARAM ENTRIES
      231     7150                           WHICH DESCRIBES THE SELECTION CRITERIA GIVEN BY
      232     7151                           THE USER. (SEE SSE_PARAM)           */
      233     7152        /**/
      234     7153    1   DCL REC_SIZE UBIN(36) STATIC SYMDEF;    /* CHARACTER COUNT OF REC_BUF         */
      235     7154    1   DCL RP_REC_SIZE UBIN WORD STATIC SYMDEF INIT(0); /* RECORD SIZE AS READ       */
      236     7155    1   DCL CMD_SIZE UBIN(36) STATIC SYMDEF;    /* CHARACTER COUNT OF CMD_BUF         */
      237     7156    1   DCL TEMP_CMD_SIZE UBIN(36) STATIC SYMDEF; /* CHARACTER COUNT OF TEMP_CMD_BUF  */
      238     7157    1   DCL TYPE_SIZE UBIN(36) STATIC SYMDEF;   /* SIZE OF TYPE_REC WRITE             */
      239     7158    1   DCL DVBYTE BIT(36) STATIC SYMDEF INIT('0'B) ; /* DVBYTE for writes. */
      240     7159    1   DCL LO_SRCH_CLMN UBIN(36) STATIC SYMDEF; /* LOW LIMIT OF SEARCH RANGE         */
      241     7160    1   DCL HI_SRCH_CLMN UBIN(36) STATIC SYMDEF; /* HIGH LIMIT OF SEARCH RANGE        */
      242     7161    1   DCL LO_EXEC_CLMN UBIN(36) STATIC SYMDEF; /* LOW LIMIT OF CHANGEABLE RANGE     */
      243     7162    1   DCL HI_EXEC_CLMN UBIN(36) STATIC SYMDEF; /* HIGH LIMIT OF CHANGEABLE RANGE    */
      244     7163    1   DCL RR_POS_CLMN SBIN WORD STATIC SYMDEF INIT (0);
              7163            /* Column num to position to on an RR */
      245     7164    1   DCL LO_SEQNUM UBIN(36) STATIC SYMDEF INIT(BITBIN('003000000000'O));
      246     7165                                                /* LOW LIMIT OF RECORD RANGE          */
      247     7166    1   DCL HI_SEQNUM UBIN(36) STATIC SYMDEF INIT(BITBIN('003575360377'O));
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:9    
      248     7167                                                /* HIHG LIMIT OF COLUMN RANGE         */
      249     7168    1   DCL EXEC_SEQNUM UBIN(36) STATIC SYMDEF; /* CURRENT RECORD BEING USED          */
      250     7169    1   DCL LIMIT_SEQNUM UBIN(36) STATIC SYMDEF; /* TEMP FOR SEARCHING RANGES         */
      251     7170    1   DCL CP_SEQNUM UBIN WORD STATIC SYMDEF INIT(BITBIN('003777777777'O));
      252     7171    1   DCL CP_LIMIT_SEQNUM UBIN WORD STATIC SYMDEF INIT(BITBIN('003000000000'O));
      253     7172    1   DCL CP_DFLT_INCR UBIN WORD STATIC SYMDEF INIT(1000);
      254     7173    1   DCL CP_RECSMVED UBIN WORD STATIC SYMDEF INIT(0);
      255     7174    1   DCL INCR UBIN(36) STATIC SYMDEF;        /* INCREMENT                          */
      256     7175    1   DCL DFLT_INCR UBIN(36) STATIC SYMDEF INIT(1000);
      257     7176    1   DCL LAST_KEY UBIN(36) STATIC SYMDEF INIT(BITBIN('003000000000'O));
              7176            /* KEY OF LAST RECORD READ */
      258     7177    1   DCL READ_KEY UBIN(36) STATIC SYMDEF;    /* KEY TO BE USED TO READ RECORD      */
      259     7178    1   DCL SAVE_KEY UBIN(36) STATIC SYMDEF;    /* SAVE LAST KEY IN MD                */
      260     7179    1   DCL MATCH_CLMN UBIN(36) STATIC SYMDEF;  /* COLUMN OF START OF STRING          */
      261     7180    1   DCL TEMP_CLMN UBIN(36) STATIC SYMDEF;   /* TEMP CELL FOR COLUMN NUM.          */
      262     7181    1   DCL TEMP_COUNT UBIN(36) STATIC SYMDEF;
      263     7182    1   DCL TEMP_STRCHG_COUNT UBIN(36) STATIC SYMDEF;
      264     7183    1   DCL STR1_CLMN UBIN(36) STATIC SYMDEF;   /* START OF FIRST INTRA STRING        */
      265     7184    1   DCL STR2_CLMN UBIN(36) STATIC SYMDEF;   /* START OF SECOND INTRA STRING       */
      266     7185    1   DCL CMD_INDEX UBIN(36) STATIC SYMDEF INIT(0); /* START OF NEXT CMD IN CMD_BUF */
      267     7186    1   DCL CMD_CODE UBIN(36) STATIC SYMDEF;    /* CODE FOR CURRENT COMMAND           */
      268     7187    1   DCL LAST_CMD UBIN(36) STATIC SYMDEF INIT(0); /* LAST CMD FOR ?? COMMAND       */
      269     7188    1   DCL SAVED_CMD UBIN(36) STATIC SYMDEF INIT(0);
      270     7189    1   DCL LAST_TYPE_CMD UBIN(36) STATIC SYMDEF INIT(TYCMD);
              7189            /* FORMAT USED BY LF-UPARROW */
      271     7190    1   DCL FT_COUNT UBIN WORD STATIC SYMDEF INIT(0); /* COUNT OF RECORDS DELETED     */
      272     7191    1   DCL REC_COUNT UBIN(36) STATIC SYMDEF;   /* COUNT OF RECORDS OPERATED ON       */
      273     7192    1   DCL DELREC_COUNT UBIN(36) STATIC SYMDEF INIT(0); /* COUNT OF RECORDS DELETED  */
      274     7193    1   DCL STRCHG_COUNT UBIN(36) STATIC SYMDEF INIT(0); /* COUNT OF STRINGS CHANGED  */
      275     7194    1   DCL TRNC_COUNT UBIN WORD STATIC SYMDEF INIT(0); /* RECORD TRUNCATED COUNT     */
      276     7195    1   DCL IF_LEVEL UBIN WORD STATIC SYMDEF;   /* IF PROCESSING                      */
      277     7196    1   DCL TEMP_IF_LEVEL UBIN WORD STATIC SYMDEF; /* TEMP IF PROCESSING              */
      278     7197    1   DCL I UBIN(36) STATIC SYMDEF;           /* INDEX                              */
      279     7198    1   DCL M$FILE_NUM UBIN(36) STATIC SYMDEF INIT(DCBNUM(M$FILE));
      280     7199    1   DCL M$FILE2_NUM UBIN(36) STATIC SYMDEF INIT(DCBNUM(M$FILE2));
      281     7200    1   DCL SEED UBIN(36) STATIC SYMDEF INIT(0); /* ENCRYPTION                        */
      282     7201    1   DCL NUM_TABS UBIN(36) STATIC SYMDEF INIT(0); /* NUMBER OF TAB STOPS           */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:10   
      283     7202    1   DCL MK_COUNT UBIN WORD STATIC SYMDEF;   /* MK BLOCK MOVE REC COUNT            */
      284     7203    1   DCL FRST2DEL UBIN WORD STATIC SYMDEF;   /* FIRST TO DELETE IN MK BLOCK        */
      285     7204    1   DCL VERIFY_TYPE UBIN WORD STATIC SYMDEF; /* HOW TO VERIFY                     */
      286     7205        /**/
      287     7206    1   DCL P$ PTR STATIC SYMDEF;               /* TEMP PTR                           */
      288     7207    1   DCL INDX UBIN WORD STATIC SYMDEF ;      /* TEMP INDEX.                        */
      289     7208    1   DCL M$SI$ PTR STATIC SYMDEF;
      290     7209    1   DCL M$UC$ PTR STATIC SYMDEF;
      291     7210    1   DCL M$FILE$ PTR STATIC SYMDEF;          /* POINTER TO M$FILE                  */
      292     7211    1   DCL M$FILE2$ PTR STATIC SYMDEF;
      293     7212    1   DCL M$DCB$ PTR STATIC ;
      294     7213    1   DCL CMD$ PTR STATIC SYMDEF;
      295     7214    1   DCL CMD_BASE$ PTR STATIC SYMDEF;
      296     7215    1   DCL CMD_END$ PTR STATIC SYMDEF;
      297     7216    1   DCL CMDBUF$ PTR STATIC SYMDEF;
      298     7217    1   DCL CMDBUF_BASE$ PTR STATIC SYMDEF;
      299     7218    1   DCL CMDBUF_END$ PTR STATIC SYMDEF;
      300     7219    1   DCL SSE$ PTR STATIC SYMDEF ;            /* POINTER TO SSE_TBL        */
      301     7220    1   DCL SSE_INIT$ PTR STATIC SYMDEF ;       /* POINTER TO SSE_TBL */
      302     7221    1   DCL MK_BASE$ PTR STATIC SYMDEF;         /* MK MOVE PTRS                       */
      303     7222    1   DCL MK_WORK$ PTR STATIC SYMDEF;
      304     7223    1   DCL MK_BOUND$ PTR STATIC SYMDEF;
      305     7224    1   DCL COPYDS_PTR$ PTR STATIC SYMDEF;      /* COPY/MERGE DATA SEG. PTR           */
      306     7225    1   DCL STR_TEXT$ PTR STATIC SYMDEF;        /* POINTS TO NEXT TEXT STRING AREA    */
      307     7226    1   DCL STR_TEXT_HEAD$ PTR STATIC SYMDEF;   /* START OF TEXT SEGMENT              */
      308     7227    1   DCL STR_TEXT_END$ PTR STATIC SYMDEF;
      309     7228    1   DCL STR_TEXT_SE$ PTR STATIC SYMDEF;     /* END OF 'SE' STRINGS IN SEGMENT     */
      310     7229    1   DCL STR_TEXT_QM$ PTR STATIC SYMDEF;     /* START OF ? STRING TEXT             */
      311     7230    1   DCL BLK$ PTR STATIC;                    /* POINTS TO PARSE BLOCKS */
      312     7231        /**/
      313     7232    1   DCL REMEM_CMD_READ REMEMBER STATIC SYMDEF; /* REMEMBER VAR.                   */
      314     7233    1   DCL REMEM_STEP_CMD REMEMBER STATIC SYMDEF;
      315     7234        /**/
      316     7235    1   DCL 1 FLAGS STATIC SYMDEF,              /* FLAGS                              */
      317     7236    1          2 EDIT_MODE BIT(1) UNAL INIT('0'B), /* FILE CURRENTLY OPEN              */
      318     7237    1          2 INTRA_CMD BIT(1) UNAL INIT('0'B), /* INTRA RECORD COMMANDS RECIEVED   */
      319     7238    1          2 STEP_MODE BIT(1) UNAL INIT('0'B), /* SS OR ST COMMAND RECIEVED        */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:11   
      320     7239    1          2 NEWLINE_FLAG BIT(1) UNAL INIT('0'B), /* NEWLINE COMMAND RECIEVED      */
      321     7240    1          2 EXISTS BIT (1) UNAL INIT('0'B), /* REQUESTED RECORD EXISTS            */
      322     7241    1          2 EOF BIT(1) UNAL INIT('0'B),    /* END OF FILE ON SEQUEN READ         */
      323     7242    1          2 ST_CMD BIT(1) UNAL INIT('0'B), /* STCMD IF TRUE ELSE SS              */
      324     7243    1          2 CONSEC_MODE BIT(1) UNAL INIT('0'B), /* CONSECUTIVE FILE OPEN          */
      325     7244    1          2 BPFLAG BIT(1) UNAL INIT('1'B), /* DEFAULT IS ON                      */
      326     7245    1          2 CRFLAG BIT(1) UNAL INIT('0'B),
      327     7246    1          2 RPFLAG BIT(1) UNAL INIT('0'B),
      328     7247    1          2 TABXFLAG BIT(1) UNAL INIT('0'B),
      329     7248    1          2 TXFLAG BIT(1) UNAL INIT('0'B),
      330     7249    1          2 RFFLAG BIT(1) UNAL INIT('0'B),
      331     7250    1          2 NOCOMPCMD BIT(1) UNAL INIT('0'B), /* LAST COMMAND CANT BE COMPOUNDED  */
      332     7251    1          2 FIRSTCMD BIT(1) UNAL INIT('0'B), /* CURRENT COMMAND IS THE FIRST      */
      333     7252    1          2 IBEX_BUILD BIT(1) UNAL INIT('0'B), /* BUILD CALL FROM CP              */
      334     7253    1          2 TABCFLAG BIT(1) UNAL INIT('0'B),
      335     7254    1          2 REL_MODE BIT(1) UNAL INIT(FALSE),
      336     7255    1          2 OVERFLOWMSG BIT(1) UNAL INIT('0'B), /* OVERFLOW MESSAGE GIVEN         */
      337     7256    1          2 UNDRFLOWMSG BIT(1) UNAL INIT('0'B), /* UNDERFLOW MESSAGE GIVEN        */
      338     7257    1          2 TABMSG BIT(1) UNAL INIT('0'B), /* TAB MESSAGE GIVEN                  */
      339     7258    1          2 STRCHGCMD BIT(1) UNAL INIT('0'B), /* COMMAND TRIES TO ALTER STRINGS   */
      340     7259    1          2 VERIFY BIT(1) UNAL INIT('0'B),
      341     7260    1          2 RLFLAG BIT(1) UNAL INIT('0'B),
      342     7261    1          2 NOFLAG BIT(1) UNAL INIT('0'B),
      343     7262    1          2 DELRECCMD BIT(1) UNAL INIT('0'B),
      344     7263    1          2 OLINPROG BIT(1) UNAL INIT('0'B),
      345     7264    1          2 BREAK BIT(1) UNAL INIT('0'B),
      346     7265    1          2 INPUT BIT(1) UNAL INIT('0'B),
      347     7266    1          2 HTEXT BIT(1) UNAL INIT('1'B),  /* HELP TEXT RECORD SPECIFIED.        */
      348     7267    1          2 HDICT BIT(1) UNAL INIT('0'B),  /* HELP DICTIONARY RECORD SPECIFIED.  */
      349     7268    1          2 HSYN BIT(1) UNAL INIT('0'B),   /* HELP SYNONYM RECORD SPECIFIED.     */
      350     7269    1          2 RECVDCR BIT(1) UNAL INIT('0'B), /* RECEIVED ONE CARRIAGE RETURN.     */
      351     7270    1          2 HELP_MODE BIT(1) UNAL INIT('1'B),/* HELP message, not ERROR message.  */
      352     7271    1          2 PARS_ERR BIT(1) UNAL INIT('0'B) ,/* Last CMD_READ caused parse error. */
      353     7272    1          2 CUTOFF BIT(1) UNAL INIT('0'B) , /* Cutoff occured in a MERGE op.     */
      354     7273    1          2 BADKEY BIT(1) UNAL ,
      355     7274    1          2 CCBUFLG BIT(1) UNAL INIT('0'B),
      356     7275    1          2 BPFLAG_SAV BIT(1) UNAL INIT('1'B), /* Save the BP over the RF CMD */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:12   
      357     7276    1          2 ROUNDFLAG BIT(1) UNAL INIT ('0'B), /* Should keys be rounded to INCR */
      358     7277    1          2 * BIT(31) UNAL ;
      359     7278        /**/
      360     7279    1   DCL 1 SSE_PARAM STATIC SYMDEF,          /* STRING SEL. PARAMETER              */
      361     7280    1          2 FLAGS,
      362     7281    1             3 CLMNFLAG BIT(1) UNAL,
      363     7282    1             3 NOTFLAG BIT(1) UNAL,
      364     7283    1             3 ANDFLAG BIT(1) UNAL,
      365     7284    1             3 ORFLAG BIT(1) UNAL,
      366     7285    1             3 EORFLAG BIT(1) UNAL,
      367     7286    1             3 * BIT(13) UNAL,
      368     7287    1          2 J SBIN HALF UNAL,
      369     7288    1          2 PTR$ PTR UNAL;
      370     7289        /**/
      371     7290        /*B*     SSE_PARAM AN SSE_PARAM IS A TWO WORD ENTRY WHICH IS USED IN
      372     7291                           SSE_TBL TO DESCRIBE A SELECTION CRITERIA STRING AND
      373     7292                           IN CMD_TBL TO DESCRIBE A COLUMN NUMBER OR A STRING
      374     7293                           WHICH MIGHT BE PRECEDED BY AN OCCURANCE NUMBER
      375     7294        *
      376     7295                           SSE_PARAM  ***************************************
      377     7296                                      *CNAOE             *         J        *
      378     7297                                      ***************************************
      379     7298                                      *         PTR$  OR   CLMN             *
      380     7299                                      ***************************************
      381     7300        *
      382     7301                           C - CLMNFLAG - IF SET SECOND WORD OF SSE_PARAM IS A
      383     7302                                COLUMN NUMBER ELSE IT IS A POINTER TO A TEXTC
      384     7303                                STRING
      385     7304                           N - NOTFLAG - THE LOGICAL OPERATOR GIVEN IN THE
      386     7305                                STRING SELECTION EXPRESSION WAS 'NOT'
      387     7306                           A - ANDFLAG - 'AND' WAS THE LOGICAL OPERATOR SPECIFIED
      388     7307                           O - ORFLAG - 'OR' WAS THE LOGICAL OPERATOR SPECIFIEDD
      389     7308                           E - EORFLAG - 'EOR' WAS THE LOGICAL OPERATOR SPECIFIED
      390     7309                           NOTE: C IS ONLY MEANINGFUL IN CMD_TBL AND N,A,O,E
      391     7310                                ARE ONLY MEANINGFUL IN SSE_TBL
      392     7311                           J - OCCURANCE NUMBER IF STRING WAS GIVEN. J IS ONE(1)
      393     7312                                BY DEFAULT AND IS NOT MEANINGFUL IF CLMNFLAG IS SET.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:13   
      394     7313                           PTR$ OR CLMN - POINTER TO TEXTC STRING OR COLUMN NUMBER
      395     7314        */
      396     7315        /**/
      397     7316        %LIST;
      398     7317        %P_PCB    (T = CMD_BUF,
      399     7318                  R = P_ALLCMDS,
      400     7319                 NAME=P_GET,
      401     7320                 U$ = VEX$XPARSE_ENT,
      402     7321                 WSZ = 500);
              7322        /*F*  NAME:     P_PCB
              7323              FUNCTION: Parse Control Block.  This structure is used to pass data
              7324                  to the X$PARSE utility, and to receive X$PARSE's responses.
              7325        */
              7326         %LSET LISTDIR='0'B;
              7339    1   DCL 1 P_GET STATIC SYMDEF ALIGNED,
              7340    1         2 TEXT$ PTR INIT(ADDR(CMD_BUF))/**/,
              7344    1         2 ROOT$ PTR INIT(ADDR(P_ALLCMDS))/**/,
              7348    1         2 WORK$ PTR INIT(ADDR(NIL))/**/,
              7352    1         2 OUT$ PTR INIT(ADDR(NIL))/**/,
              7357    1         2 U$$ EPTR INIT(ENTADDR(VEX$XPARSE_ENT))/**/,
              7369    1         2 WKSZ UBIN(18) UNAL INIT(500)/**/,
              7374    1         2 CMPRS BIT(1) UNAL INIT('1'B)/**/,
              7380    1         2 CONTINUE BIT(1) UNAL INIT('1'B)/**/,
              7384    1         2 NOLEADBLANKS BIT(1) UNAL INIT('0'B)/**/,
              7389    1         2 NXT BIT(1) UNAL INIT('0'B)/**/,
              7406    1         2 DYNMEM BIT(1) UNAL INIT('0'B)/**/,
              7411    1         2 KEYWORDS BIT (1) INIT ('0'B) /**/,
              7426    1         2 BLANKONLY BIT (1),
              7434    1         2 NXT_SZONLY BIT(1) UNAL INIT('0'B)/**/,
              7442    1         2 * BIT (10) INIT ('0'B) /**/,
              7443    1         2 ERROR ALIGNED,
              7448    1           3 FCG BIT(12) UNAL INIT('0'B)/**/,
              7449    1           3 MID BIT(6) UNAL INIT('0'B)/**/,
              7450    1           3 MON BIT(1) UNAL INIT('0'B)/**/,
              7451    1           3 CODE UBIN(14) UNAL INIT(0)/**/,
              7452    1           3 SEV UBIN(3) UNAL INIT(0)/**/,
              7453    1         2 COMMENT ALIGNED,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:14   
              7457    1           3 LEAD CHAR(2) UNAL INIT(' "')/**/,
              7465    1           3 TRAIL CHAR(2) UNAL INIT(' "')/**/,
              7472    1         2 WK_USED UBIN(18) UNAL INIT(0)/**/,
              7476    1         2 VERSION_CODE UBIN(4) UNAL INIT(1)/**/,
              7481    1         2 OUTDCB# UBIN(14) UNAL INIT(DCBNUM(NIL))/**/,
              7486    1         2 NCHARS UBIN WORD INIT(0)/**/,
              7490    1         2 HI_CHAR UBIN WORD INIT(0)/**/,
              7497    1         2 HINODE$ PTR INIT(ADDR(NIL))/**/,
              7506    1         2 USER$ PTR INIT(ADDR(NIL))/**/,
              7512    1         2 OUTENT$ EPTR INIT(ENTADDR(NIL))/**/;
      403     7520        %P_PCB    (T = CMD_BUF,
      404     7521                  R = P_ALLCMDS,
      405     7522                 U$ = VEX$XPARSE_ENT,
      406     7523                 WSZ = 100);
              7524        /*F*  NAME:     P_PCB
              7525              FUNCTION: Parse Control Block.  This structure is used to pass data
              7526                  to the X$PARSE utility, and to receive X$PARSE's responses.
              7527        */
              7528         %LSET LISTDIR='0'B;
              7541    1   DCL 1 P_PCB STATIC SYMDEF ALIGNED,
              7542    1         2 TEXT$ PTR INIT(ADDR(CMD_BUF))/**/,
              7546    1         2 ROOT$ PTR INIT(ADDR(P_ALLCMDS))/**/,
              7550    1         2 WORK$ PTR INIT(ADDR(NIL))/**/,
              7554    1         2 OUT$ PTR INIT(ADDR(NIL))/**/,
              7559    1         2 U$$ EPTR INIT(ENTADDR(VEX$XPARSE_ENT))/**/,
              7571    1         2 WKSZ UBIN(18) UNAL INIT(100)/**/,
              7576    1         2 CMPRS BIT(1) UNAL INIT('1'B)/**/,
              7582    1         2 CONTINUE BIT(1) UNAL INIT('1'B)/**/,
              7586    1         2 NOLEADBLANKS BIT(1) UNAL INIT('0'B)/**/,
              7591    1         2 NXT BIT(1) UNAL INIT('0'B)/**/,
              7608    1         2 DYNMEM BIT(1) UNAL INIT('0'B)/**/,
              7613    1         2 KEYWORDS BIT (1) INIT ('0'B) /**/,
              7628    1         2 BLANKONLY BIT (1),
              7636    1         2 NXT_SZONLY BIT(1) UNAL INIT('0'B)/**/,
              7644    1         2 * BIT (10) INIT ('0'B) /**/,
              7645    1         2 ERROR ALIGNED,
              7650    1           3 FCG BIT(12) UNAL INIT('0'B)/**/,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:15   
              7651    1           3 MID BIT(6) UNAL INIT('0'B)/**/,
              7652    1           3 MON BIT(1) UNAL INIT('0'B)/**/,
              7653    1           3 CODE UBIN(14) UNAL INIT(0)/**/,
              7654    1           3 SEV UBIN(3) UNAL INIT(0)/**/,
              7655    1         2 COMMENT ALIGNED,
              7659    1           3 LEAD CHAR(2) UNAL INIT(' "')/**/,
              7667    1           3 TRAIL CHAR(2) UNAL INIT(' "')/**/,
              7674    1         2 WK_USED UBIN(18) UNAL INIT(0)/**/,
              7678    1         2 VERSION_CODE UBIN(4) UNAL INIT(1)/**/,
              7683    1         2 OUTDCB# UBIN(14) UNAL INIT(DCBNUM(NIL))/**/,
              7688    1         2 NCHARS UBIN WORD INIT(0)/**/,
              7692    1         2 HI_CHAR UBIN WORD INIT(0)/**/,
              7699    1         2 HINODE$ PTR INIT(ADDR(NIL))/**/,
              7708    1         2 USER$ PTR INIT(ADDR(NIL))/**/,
              7714    1         2 OUTENT$ EPTR INIT(ENTADDR(NIL))/**/;
      407     7722        %PLIST;
      408     7723        /**/
      409     7724             %XUG_GETCMD
      410     7725                ( NAME           = XUG$GETCMD_,
      411     7726                STCLASS        = "STATIC SYMDEF",
      412     7727                DCB_PARAM     = M$DO,
      413     7728                NODES          = P_ALLCMDS,
      414     7729                SFROUTINE      = VEX$XPARSE_ENT,
      415     7730                OUTDCB         = M$DO);
      416     8068
      417     8069             %XUG_INIT
      418     8070                ( NAME           = XUG$INIT_,
      419     8071                STCLASS        = STATIC,
      420     8072                ALWAYS_SET_PROMPT = NO,
      421     8073                COMMANDS       = YES,
      422     8074                GOODCMD        = NO,
      423     8075                PCB      = P_GET,
      424     8076                INHIBIT_DIRECTORY  = YES,
      425     8077                INHIBIT_END        = YES,
      426     8078                INHIBIT_OUTPUT     = YES,
      427     8079                INHIBIT_NULL       = YES,
      428     8080                SPHANDLE = CMD_CONTINUE,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:16   
      429     8081                SYNTAX         = YES ) ;
      430     8494
      431     8495        /**/
      432     8496    1   DCL 1 DS_RESULTS DALIGNED STATIC SYMDEF,
      433     8497    1          2 BOUND UBIN(20) UNAL,
      434     8498    1          2 FLAGSV UBIN(11) UNAL,
      435     8499    1          2 * UBIN(5) UNAL,
      436     8500    1          2 PTR$ PTR UNAL;
      437     8501    1   DCL BREAK_ARS UBIN WORD STATIC SYMDEF INIT(0) ;
      438     8502    1   DCL ASN UBIN (9) STATIC ;               /* FID assignment type                */
      439     8503    1   DCL TBUF CHAR(4) STATIC ;               /* temp buffer.                       */
      440     8504    1   DCL GET_CMD_TBL (0:255) BIT(9) STATIC SYMDEF INIT ('0'B*0) ;
      441     8505    1   DCL DIR_BUF CHAR(33) STATIC ;           /* Text buffer.                       */
      442     8506        /**/
      443     8507        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:17   
      444     8508        /*****************************************************************************/
      445     8509        /*   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   */
      446     8510        /*****************************************************************************/
      447     8511    1   DCL MAX_SEQNUM UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003575360377'O));
      448     8512                                                /* 99999999+'003000000000'O           */
      449     8513    1   DCL MAX_CLMN UBIN(36) CONSTANT SYMDEF INIT(PC_RECSIZE#);
      450     8514    1   DCL Y003 UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003000000000'O));
      451     8515    1   DCL CRET CHAR(1) CONSTANT SYMDEF INIT(BINASC(13)); /* O'015' IS CR            */
      452     8516    1   DCL NEWLINE CHAR(1) CONSTANT SYMDEF INIT(BINASC(10)); /* O'012' IS LF         */
      453     8517    1   DCL EOT CHAR(1) CONSTANT INIT(BINASC(4)); /* '004'O IS EOT */
      454     8518    1   DCL BSPACECHAR CHAR(1) CONSTANT SYMDEF INIT (BINASC(8)); /* O'010' IS BS      */
      455     8519    1   DCL TABCHAR CHAR(1) CONSTANT SYMDEF INIT(BINASC(9)); /* O'011' IS HT          */
      456     8520    1   DCL SINGLE_AST CHAR(1) CONSTANT SYMDEF INIT('*'); /* Prompt for CMD line   */
      457     8521    1   DCL GTAST CHAR(2) CONSTANT SYMDEF INIT('>*'); /* Prompt for Cont line   */
      458     8522    1   DCL BLANKS CHAR(4) CONSTANT SYMDEF INIT('    ');
      459     8523    1   DCL SEQNUM_ONE UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003000001750'O));
      460     8524    1   DCL 1 NEWLINE_CNTRLWD CONSTANT,
      461     8525    1          2 FLAGS,
      462     8526    1             3 ENDCT BIT(1) UNAL INIT('0'B),
      463     8527    1             3 * BIT(17) UNAL,
      464     8528    1          2 OFFSET UBIN(9) UNAL INIT (SIZEW(CMD_CNTRLWD)),
      465     8529    1          2 CMD_CODE UBIN(9) UNAL INIT(NEWLINECMD);
      466     8530    1   DCL CMD_SPACE_EXHAUSTED REMEMBER ;
      467     8531        /**/
      468     8532        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:18   
      469     8533        /**********************************************************************/
      470     8534        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      471     8535        /**********************************************************************/
      472     8536    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
      473     8537    1          2 FLAGS,
      474     8538    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
      475     8539    1             3 * BIT(17) UNAL,
      476     8540    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
      477     8541    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
      478     8542    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
      479     8543    1          2 FLAGS,
      480     8544    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
      481     8545                                                                   ELSE PTR$ */
      482     8546    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
      483     8547    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
      484     8548    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
      485     8549    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
      486     8550    1             3 * BIT(13) UNAL,
      487     8551    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
      488     8552    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
      489     8553    1   DCL 1 STR$BUF BASED ALIGNED,
      490     8554    1          2 COUNT UBIN(9) UNAL,
      491     8555    1          2 TEXT CHAR(255) UNAL;
      492     8556    1   DCL CMD$BUF CHAR(256)  BASED;
      493     8557        /**/
      494     8558        %XUG_RLT   (STCLASS = BASED);
      495     8565        %PARSE$OUT (STCLASS = BASED);
      496     8610        %PARSE$SYM (NAME = OUT$SYM, STCLASS = BASED);
      497     8648        %B$TCB ;
      498     8651        %B$ALT ;
      499     8659        /**/
      500     8660    1   DCL 1 ED_CMD_TBL BASED ALIGNED,         /* EDIT AND DELETE                    */
      501     8661    1          2 * BIT(36) UNAL,
      502     8662    1          2 FID$ PTR;
      503     8663    1   DCL 1 B_CMD_TBL BASED ALIGNED,          /* BUILD COMMAND                      */
      504     8664    1          2 * BIT(36) UNAL,
      505     8665    1          2 FID$ PTR UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:19   
      506     8666    1          2 SEQNUM UBIN(36) UNAL,
      507     8667    1          2 INCR UBIN(36) UNAL,
      508     8668    1          2 TYPE CHAR(2) UNAL;
      509     8669    1   DCL 1 B_HELP_CMD_TBL BASED ALIGNED,     /* BUILD COMMAND                      */
      510     8670    1          2 * BIT(36) UNAL,
      511     8671    1          2 FID$ PTR UNAL,
      512     8672    1          2 HELPKEY CHAR(64) UNAL,
      513     8673    1          2 INCR UBIN WORD UNAL,
      514     8674    1          2 TYPE CHAR(2) UNAL;
      515     8675    1   DCL 1 C_CMD_TBL BASED ALIGNED,          /* COPY COMMAND                       */
      516     8676    1          2 * BIT(36) UNAL,
      517     8677    1          2 FID$ PTR UNAL,
      518     8678    1          2 FID2$ PTR UNAL,
      519     8679    1          2 ONOVER CHAR(4) UNAL,
      520     8680    1          2 SEQNUM UBIN(36) UNAL,
      521     8681    1          2 INCR UBIN(36) UNAL,
      522     8682    1          2 TYPE CHAR(2) UNAL;
      523     8683    1   DCL 1 M_CMD_TBL BASED ALIGNED,          /* MERGE COMMAND                      */
      524     8684    1          2 * BIT(36) UNAL,
      525     8685    1          2 FID$ PTR UNAL,
      526     8686    1          2 LO_SEQNUM,
      527     8687    1             3 KEY UBIN WORD UNAL ,
      528     8688    1          2 HI_SEQNUM ,
      529     8689    1             3 KEY UBIN WORD UNAL ,
      530     8690    1          2 ONOVER UBIN WORD UNAL,
      531     8691    1          2 FID2$ PTR UNAL,
      532     8692    1          2 LO_SEQNUM2 ,
      533     8693    1             3 KEY UBIN WORD UNAL ,
      534     8694    1          2 HI_SEQNUM2,
      535     8695    1             3 KEY UBIN WORD UNAL ,
      536     8696    1          2 INCR UBIN(36) UNAL;
      537     8697    1   DCL 1 HELP_CMD_TBL BASED ALIGNED,
      538     8698    1          2 * BIT(36) UNAL,
      539     8699    1          2 CMD_CODE UBIN(36) UNAL;
      540     8700    1   DCL 1 IN_CMD_TBL BASED ALIGNED,         /*IN,IP,IS,RN,DE,AD,RR CMDS           */
      541     8701    1          2 * BIT(36) UNAL,
      542     8702    1          2 LO_SEQNUM UBIN(36) UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:20   
      543     8703    1          2 HI_SEQNUM UBIN(36) UNAL,
      544     8704    1          2 START_SPEC UBIN(36) UNAL,      /* DID USER SPECIFY A START */
      545     8705    1          2 COLUMN SBIN WORD UNAL;
      546     8706    1   DCL 1 IN_HELP_CMD_TBL BASED ALIGNED, /*IN,IP,IS,RN,DE,AD,RR CMDS FOR HELP KEYS  */
      547     8707    1          2 * BIT(36) UNAL,
      548     8708    1          2 LO_KEY CHAR(64) UNAL,
      549     8709    1          2 HI_KEY CHAR(64) UNAL ,
      550     8710    1          2 INCR UBIN WORD UNAL ;
      551     8711    1   DCL 1 STR_CMD_TBL BASED ALIGNED,        /* AEOFPS COMMANDS                    */
      552     8712    1          2 * BIT(36) UNAL,
      553     8713    1          2 SSE_PARAM,
      554     8714    1             3 FLAGS,
      555     8715    1                4 CLMNFLAG BIT(1) UNAL,
      556     8716    1                4 NOTFLAG BIT(1) UNAL,
      557     8717    1                4 ANDFLAG BIT(1) UNAL,
      558     8718    1                4 ORFLAG BIT(1) UNAL,
      559     8719    1                4 EORFLAG BIT(1) UNAL,
      560     8720    1                4 * BIT(13) UNAL,
      561     8721    1             3 J SBIN HALF UNAL,
      562     8722    1             3 PTR$ PTR UNAL,
      563     8723    1          2 SSE_PARAM2,
      564     8724    1             3 FLAGS,
      565     8725    1                4 CLMNFLAG BIT(1) UNAL,
      566     8726    1                4 NOTFLAG BIT(1) UNAL,
      567     8727    1                4 ANDFLAG BIT(1) UNAL,
      568     8728    1                4 ORFLAG BIT(1) UNAL,
      569     8729    1                4 EORFLAG BIT(1) UNAL,
      570     8730    1                4 * BIT(13) UNAL,
      571     8731    1             3 J SBIN HALF UNAL,
      572     8732    1             3 PTR$ PTR UNAL;
      573     8733    1   DCL 1 D_CMD_TBL BASED ALIGNED,          /* D COMMAND                          */
      574     8734    1          2 * BIT(36) UNAL,
      575     8735    1          2 SSE_PARAM,
      576     8736    1             3 FLAGS,
      577     8737    1                4 CLMNFLAG BIT(1) UNAL,
      578     8738    1                4 NOTFLAG BIT(1) UNAL,
      579     8739    1                4 ANDFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:21   
      580     8740    1                4 ORFLAG BIT(1) UNAL,
      581     8741    1                4 EORFLAG BIT(1) UNAL,
      582     8742    1                4 * BIT(13) UNAL,
      583     8743    1             3 J SBIN HALF UNAL,
      584     8744    1             3 PTR$ PTR UNAL;
      585     8745    1   DCL 1 RL_CMD_TBL BASED ALIGNED,         /* R,L COMMANDS                       */
      586     8746    1          2 * BIT(36) UNAL,
      587     8747    1          2 SSE_PARAM,
      588     8748    1             3 FLAGS,
      589     8749    1                4 CLMNFLAG BIT(1) UNAL,
      590     8750    1                4 NOTFLAG BIT(1) UNAL,
      591     8751    1                4 ANDFLAG BIT(1) UNAL,
      592     8752    1                4 ORFLAG BIT(1) UNAL,
      593     8753    1                4 EORFLAG BIT(1) UNAL,
      594     8754    1                4 * BIT(13) UNAL,
      595     8755    1             3 J SBIN HALF UNAL,
      596     8756    1             3 PTR$ PTR UNAL,
      597     8757    1          2 SHIFT# UBIN(36) UNAL;
      598     8758    1   DCL 1 CM_CMD_TBL BASED ALIGNED,         /* CM,CT COMMANDS                     */
      599     8759    1          2 * BIT(36) UNAL,
      600     8760    1          2 SEQNUM UBIN(36) UNAL,
      601     8761    1          2 LO_CLMN UBIN(36) UNAL,
      602     8762    1          2 HI_CLMN UBIN(36) UNAL;
      603     8763    1   DCL 1 MK_CMD_TBL BASED ALIGNED,         /* MK,MD COMMANDS                     */
      604     8764    1          2 * BIT(36) UNAL,
      605     8765    1          2 LO_SEQNUM UBIN(36) UNAL,
      606     8766    1          2 HI_SEQNUM UBIN(36) UNAL,
      607     8767    1          2 LO_SEQNUM2 UBIN(36) UNAL,
      608     8768    1          2 HI_SEQNUM2 UBIN(36) UNAL,
      609     8769    1          2 INCR UBIN(36) UNAL;
      610     8770    1   DCL 1 TA_CMD_TBL BASED ALIGNED,         /* TABS AND STATUS                    */
      611     8771    1          2 * BIT(36) UNAL,
      612     8772    1          2 TABS(0:30) UBIN(9) UNAL,
      613     8773    1          2 NUM_TABS UBIN(9) UNAL;
      614     8774    1   DCL 1 BP_CMD_TBL BASED ALIGNED,
      615     8775    1          2 * BIT(36) UNAL,
      616     8776    1          2 TEXT CHAR(4) UNAL;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:22   
      617     8777    1   DCL 1 JU_CMD_TBL BASED ALIGNED,         /* JU COMMAND                         */
      618     8778    1          2 * BIT(36) UNAL,
      619     8779    1          2 HELPKEY CHAR(64) UNAL ,
      620     8780    1          2 EDITKEY REDEF HELPKEY ,
      621     8781    1             3 SEQNUM UBIN(36) UNAL ,
      622     8782    1             3 * CHAR (60) UNAL ;
      623     8783    1   DCL 1 CP_CMD_TBL BASED ALIGNED,         /* CP and CI commands.                */
      624     8784    1          2 * BIT(36) UNAL ,
      625     8785    1          2 SEQNUM UBIN WORD UNAL ,
      626     8786    1          2 LIMIT_SEQNUM UBIN WORD UNAL ,
      627     8787    1          2 INCR UBIN WORD UNAL ;
      628     8788    1   DCL 1 TYPE_CMD_TBL BASED ALIGNED,
      629     8789    1          2 * BIT(36) UNAL,
      630     8790    1          2 CODE CHAR(2);
      631     8791    1   DCL 1 FILE_CMD_TBL BASED ALIGNED,
      632     8792    1          2 * BIT(36) UNAL,
      633     8793    1          2 CODE UBIN WORD ;
      634     8794    1   DCL 1 TN_CMD_TBL BASED ALIGNED,
      635     8795    1          2 * BIT(36) UNAL,
      636     8796    1          2 COUNT UBIN WORD UNAL;
      637     8797    1   DCL 1 VE_CMD_TBL BASED ALIGNED,
      638     8798    1          2 * BIT(36) UNAL,
      639     8799    1          2 TYPE UBIN WORD UNAL;
      640     8800    1   DCL 1 IF_CMD_TBL BASED ALIGNED,
      641     8801    1          2 * BIT(36) UNAL,
      642     8802    1          2 LO_CLMN UBIN WORD UNAL,
      643     8803    1          2 HI_CLMN UBIN WORD UNAL,
      644     8804    1          2 SSE(0:0),
      645     8805    1             3 FLAGS,
      646     8806    1                4 CLMNFLAG BIT(1) UNAL,
      647     8807    1                4 NOTFLAG BIT(1) UNAL,
      648     8808    1                4 ANDFLAG BIT(1) UNAL,
      649     8809    1                4 ORFLAG BIT(1) UNAL,
      650     8810    1                4 EORFLAG BIT(1) UNAL,
      651     8811    1                4 * BIT(13) UNAL,
      652     8812    1             3 J SBIN HALF UNAL,
      653     8813    1             3 PTR$ PTR UNAL;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:23   
      654     8814    1   DCL 1 DIR_CMD_TBL BASED ALIGNED ,       /* DIRECTORY                          */
      655     8815    1          2 * BIT(36) UNAL ,
      656     8816    1          2 CODE UBIN WORD UNAL ,
      657     8817    1          2 ACCT CHAR(8) UNAL ,
      658     8818    1          2 PSN CHAR(6) UNAL ;
      659     8819    1   DCL 1 VARY$STRC BASED ALIGNED ,
      660     8820    1          2 CNT UBIN BYTE UNAL ,
      661     8821    1          2 TXT CHAR(VARY$STRC.CNT) UNAL ;
      662     8822        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:24   
      663     8823        /***********************************************************************/
      664     8824        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      665     8825        /**********************************************************************/
      666     8826    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;       /* GET NEXT RECORD                    */
      667     8827    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      668     8828    1   DCL VEX$FIND_MATCH ENTRY(4) ALTRET;
      669     8829    1   DCL VEX$FID_2_FPT ENTRY(3) ALTRET;
      670     8830    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      671     8831    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      672     8832    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      673     8833    1   DCL VEX$ERROR_NO_PRINT ENTRY(2) ALTRET;
      674     8834    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      675     8835    1   DCL VEX$ERRMAX ENTRY ALTRET;
      676     8836    1   DCL VEX$READ_TERM_REC ENTRY(3) ALTRET;
      677     8837    1   DCL VEX$TYPE_REC ENTRY(1);
      678     8838    1   DCL VEX$CLMN_DFLT ENTRY;
      679     8839    1   DCL VEX$FIELD_LEFT ENTRY(2);
      680     8840    1   DCL VEX$MOVE_LEFT ENTRY(2);
      681     8841    1   DCL VEX$COMP_RIGHT ENTRY(2);
      682     8842    1   DCL VEX$MOVE_RIGHT ENTRY(2);
      683     8843    1   DCL VEX$FIND_CLMN ENTRY(2) ALTRET;
      684     8844    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      685     8845    1   DCL VEX$SET_PROMPT ENTRY(1);
      686     8846    1   DCL VEX$BUILD_SEQNUM ENTRY(2) ALTRET;
      687     8847    1   DCL VEX$PARSE_SEQRANGE ENTRY(3) ALTRET;
      688     8848    1   DCL VEX$PARSE_CLMNRANGE ENTRY(3) ALTRET;
      689     8849    1   DCL VEX$PARSE_STRING ENTRY(2) ALTRET;
      690     8850    1   DCL VEX$PARSE_JSTRING ENTRY(3) ALTRET;
      691     8851    1   DCL VEX$PARSE_CLMNSTRING ENTRY(3) ALTRET;
      692     8852    1   DCL VEX$CHECK_FIRST ENTRY ALTRET;
      693     8853    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      694     8854    1   DCL VEX$BREAK ENTRY ASYNC;
      695     8855    1   DCL VEX$XPARSE_ENT ENTRY(1);
      696     8856    1   DCL VEM$MASTER ENTRY;
      697     8857    1   DCL VEX$XPAND ENTRY ALTRET;
      698     8858    1   DCL VEX$GET_NEXT_KEY ENTRY ALTRET;      /* GET NEXT RECORD KEY                */
      699     8859        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:25   
      700     8860    1   DCL X$PARSE ENTRY(1) ALTRET;
      701     8861    1   DCL CMD_CONTINUE ENTRY(2) ;             /* THIS MODULE RESIDES IN VEE$EDIT */
      702     8862        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:26   
      703     8863        /**/
      704     8864        /*****************************************************************/
      705     8865        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      706     8866        /*****************************************************************/
      707     8867    1   DCL 1 P_ALLCMDS SYMREF ALIGNED,         /* NODE MACRO                         */
      708     8868    1          2 TYPE UBIN(9) UNAL,
      709     8869    1          2 NSUBNDS UBIN(9) UNAL,
      710     8870    1          2 CODE UBIN(18) UNAL,
      711     8871    1          2 * EPTR UNAL,
      712     8872    1          2 * EPTR UNAL,
      713     8873    1          2 * EPTR UNAL,
      714     8874    1          2 *(0:0) PTR UNAL;
      715     8875        /**/
      716     8876        /**/
      717     8877        %FPT_ERRMSG  (FPTN = ERRMSG_FPT,
      718     8878                      OUTDCB1 = M$DO ,
      719     8879                      OUTDCB2 = M$ME ,
      720     8880                      STCLASS="SYMREF") ;
      721     8907        /**/
      722     8908    1   DCL B$JIT$ PTR SYMREF;
      723     8909    1   DCL B$TCB$ PTR SYMREF;
      724     8910    1   DCL 1 B_VERSION SYMREF ,
      725     8911    1          2 CNT UBIN BYTE UNAL,
      726     8912    1          2 TEXT CHAR(6) UNAL ;
      727     8913        /**/
      728     8914        %B$SR_NON_BLANK;
      729     8918
      730     8919        /********************************************************************/
      731     8920        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      732     8921        /********************************************************************/
      733     8922        /**/
      734     8923    1   DCL M$SI DCB;
      735     8924    1   DCL M$LM DCB;                           /* FOR ERROR MGS FILE */
      736     8925    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      737     8926    1   DCL M$FILE2 DCB;                        /* FOR MERGE AND COPY                 */
      738     8927    1   DCL M$DO DCB;                           /* ERROR MESSAGES                     */
      739     8928        %M$DCB (DCBN = M$ME,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:27   
      740     8929                CTG = YES,
      741     8930                RES = 'ME',
      742     8931                DISP = NAMED,
      743     8932                FUN = CREATE);
      744     9006        /**/
      745     9007        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:28   
      746     9008        /*****************************************************************************/
      747     9009        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      748     9010        /*****************************************************************************/
      749     9011        /**/
      750     9012    1        M$SI$ = DCBADDR(DCBNUM(M$SI));
      751     9013    1        M$FILE$ = DCBADDR(DCBNUM(M$FILE));
      752     9014    1        M$FILE2$ = DCBADDR(DCBNUM(M$FILE2));
      753     9015    1        M$UC$ = DCBADDR(DCBNUM(M$UC));
      754     9016        /**/
      755     9017    1        CALL M$INT (INT_FPT);
      756     9018        /**/
      757     9019    1        REMEMBER STEP_DONE IN REMEM_CMD_READ; /* BREAK RETURN                 */
      758     9020    1        REMEMBER STEP_CMD_READ IN REMEM_STEP_CMD;
      759     9021        /**/
      760     9022    1        VE_ERRMSGACCT.ACCT# = DCBADDR(DCBNUM(M$LM)) -> F$DCB.ACCT;
      761     9023        /**/
      762     9024    1        SSE$ = ADDR (SSE_TBL);
      763     9025    1        SSE_INIT$ = SSE$;
      764     9026    1        CALL VEX$CLMN_DFLT;                /* SET COLUMN LIMITS                  */
      765     9027        /**/
      766     9028    1        CALL M$OPEN (OPEN_ME);             /***/
      767     9029    1        CALL M$OPEN (OPEN_DO);             /***/
      768     9030    1        CALL XUG$INIT (XUG$GETCMD_,XUG$INIT_); /****/
      769     9031        /**/
      770     9032    1        TAB_VLP = M$UC$ -> F$DCB.TAB$ -> TAB$VLP;
      771     9033    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));
      772     9034    2           NUM_TABS = NUM_TABS + 1;
      773     9035    2           END;
      774     9036    1        SAVE_TAB_VLP = TAB_VLP;
      775     9037    1        CALL CONCAT(TYPE_BUF.TEXT,'EDIT ',
      776     9038    1           SUBSTR(B_VERSION.TEXT,0,B_VERSION.CNT),' here') ;
      777     9039    1        CALL VEX$TYPE_REC(TYPECR);
      778     9040        /**/
      779     9041    1        DS_RESULTS = FALSE;
      780     9042    1        CALL M$GDS(GDS_FPT) ALTRET (NO_MEMORY);
      781     9043        /**/
      782     9044        /*One Data Segment is divided up into four pieces and used as follows:
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:29   
      783     9045              STR_TEXT        - 412
      784     9046              Parse work area - 100
      785     9047              CMDBUF          - 412
      786     9048              CMD             - 100
      787     9049        for a total of 1024 words - 1 page.
      788     9050        Any time one of the areas is exhausted, VEX$XPAND is called to add
      789     9051        a page to the segment. The above sizes are added to each area.
      790     9052        */
      791     9053    1        STR_TEXT$ = DS_RESULTS.PTR$ ;
      792     9054    1        STR_TEXT_HEAD$ = STR_TEXT$;
      793     9055    1        STR_TEXT_SE$ = STR_TEXT$;
      794     9056    1        STR_TEXT_END$ = PINCRW(STR_TEXT$,412 );
      795     9057        /**/
      796     9058    1        SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL); /* NO SELECTION CRITERIA          */
      797     9059    1        P_PCB.WORK$ = STR_TEXT_END$ ;
      798     9060        /**/
      799     9061    1        CMDBUF$ = PINCRW(P_PCB.WORK$, 100) ;
      800     9062    1        CMDBUF_BASE$ = CMDBUF$;
      801     9063    1        CMDBUF_END$ = PINCRW(CMDBUF$,412 );
      802     9064        /**/
      803     9065    1        CMD$ = CMDBUF_END$;
      804     9066    1        CMD_BASE$ = CMD$;
      805     9067    1        CMD_END$ = PINCRW(CMD$,100 );
      806     9068        /**/
      807     9069    1        FLAGS.BADKEY = FALSE ;
      808     9070    1        REMEMBER RAN_OUT_OF_CMD_SPACE IN CMD_SPACE_EXHAUSTED ;
      809     9071    1        CMD_SIZE = B$JIT$ -> B$JIT.CCARS;
      810     9072    1        CALL INSERT(CMDBUF$ -> CMD$BUF,0,CMD_SIZE,B$JIT$ -> B$JIT.CCBUF);
      811     9073    2        DO WHILE('0'B);
      812     9074    2   PARSE1_ERR: ;
      813     9075    2           IF FLAGS.CCBUFLG
      814     9076    2           THEN
      815     9077    2              GOTO PARSE_ERR;
      816     9078    2           CALL INDEX (I, ' ', SUBSTR(CMDBUF$->CMD$BUF,0,CMD_SIZE))
      817     9079    2           WHENRETURN
      818     9080    3           DO;
      819     9081    3              CALL INSERT (SUBSTR(CMDBUF$->CMD$BUF,0,I),,,'E');
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:30   
      820     9082    3              END;
      821     9083    2           WHENALTRETURN
      822     9084    3           DO;
      823     9085    3              CALL INSERT (SUBSTR(CMDBUF$->CMD$BUF,0,4),,,'EDIT');
      824     9086    3              CMD_SIZE=4;
      825     9087    3              END;
      826     9088    2           FLAGS.CCBUFLG='1'B;
      827     9089    2           CMD_INDEX = 0;
      828     9090    2           END;
      829     9091    1        CALL GET_CMD;
      830     9092    1        CALL X$PARSE(P_PCB) ALTRET(PARSE1_ERR);
      831     9093    1        FLAGS.PARS_ERR = '0'B ;
      832     9094    1        CALL CHECK_CMD ALTRET (CMD_READ);
      833     9095    1        IF (CMD_CODE = BUILDCMD) THEN FLAGS.IBEX_BUILD = TRUE;
      834     9096    1        IF (CMD_CODE ~= ENDCMD) THEN GOTO CMD_OK; /* 'E' MEANS EDIT           */
      835     9097        /**/
      836     9098        /**/
      837     9099    1   CMD_READ:
      838     9100    2        IF (FLAGS.IBEX_BUILD) THEN DO ;
      839     9101    2           CALL M$CLOSE(CLOSE_FPT) ALTRET (IBEX_BUILD_CLOSE_ERR) ;
      840     9102
      841     9103    2   IBEX_BUILD_CLOSE_ERR:
      842     9104    2           CALL M$EXIT ;
      843     9105    2           END ;                           /* THEN DO */
      844     9106    1        DELREC_COUNT = 0;
      845     9107    1        STRCHG_COUNT = 0;
      846     9108        /**/
      847     9109    1        CALL VEX$SET_PROMPT(PR_1AST);
      848     9110    1        CALL READ_CMD;                     /* GET NEXT COMMAND LINE              */
      849     9111        /**/
      850     9112    2        IF (FLAGS.NEWLINE_FLAG) THEN DO;
      851     9113    2           CMD$ = CMD_BASE$;
      852     9114    2           CMD$ -> CMD_CNTRLWD = NEWLINE_CNTRLWD;
      853     9115    2           CMD$ = PINCRW(CMD$,SIZEW(CMD_CNTRLWD));
      854     9116    2           CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;
      855     9117    2           CALL VEM$MASTER;
      856     9118    3           IF DELREC_COUNT > 0 THEN DO;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:31   
      857     9119    3              CALL VEX$SET_SUB_BUF(SUB_BUF_1,DELREC_COUNT);
      858     9120    3              CALL VEX$ERROR(E$E_RECSDEL,1);
      859     9121    3              END;
      860     9122    2           GOTO CMD_READ;
      861     9123    2           END;
      862     9124        /**/
      863     9125    1        FLAGS.STEP_MODE = FALSE;           /* RESET                              */
      864     9126    1        FLAGS.BADKEY = FALSE ;
      865     9127    1        IF (CMD_SIZE = 0) THEN GOTO CMD_READ; /* NULL CMD                     */
      866     9128        /**/
      867     9129    2        DO WHILE (CMD_INDEX < CMD_SIZE);   /* LOOP THRU ALL CMDS                */
      868     9130    2           CALL GET_CMD ALTRET(CMD_READ);
      869     9131    3           DO WHILE ('0'B) ;
      870     9132
      871     9133    3   RAN_OUT_OF_CMD_SPACE:
      872     9134    3              CALL VEX$XPAND ALTRET (NO_MEMORY) ;
      873     9135    3              CMD_INDEX = 0 ;
      874     9136    3              CMD$ = CMD_BASE$ ;
      875     9137    3              STR_TEXT$ = STR_TEXT_HEAD$ ;
      876     9138    3              END ;                        /* Do While */
      877     9139    2   CMD_RETRY:
      878     9140    2           CALL X$PARSE(P_PCB) ALTRET(PARSE_ERR);
      879     9141    2           FLAGS.PARS_ERR = '0'B ;
      880     9142    2           CALL CHECK_CMD ALTRET (CMD_READ);
      881     9143    2           END;
      882     9144        /**/
      883     9145    1        IF (FLAGS.INTRA_CMD)AND(FLAGS.VERIFY)AND
      884     9146    2           (POFFW(CMD$,CMD_BASE$) > 1) THEN DO;
      885     9147    2           CMD$ -> CMD_CNTRLWD.FLAGS = FALSE;
      886     9148    2           CMD$ -> CMD_CNTRLWD.CMD_CODE = VERIFY_TYPE;
      887     9149    2           CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);
      888     9150    2           CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
      889     9151    2           CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;
      890     9152    2           END;
      891     9153        /**/
      892     9154    1   CMD_OK:
      893     9155    1        CMD$ = CMD_BASE$;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:32   
      894     9156    1        STR_TEXT_QM$ = STR_TEXT$;
      895     9157        /**/
      896     9158    2        IF ((FLAGS.INTRA_CMD) OR (FLAGS.STEP_MODE)) THEN DO;
              9158                 /* CHECK RECORD FOR SEL. CRITERA */
      897     9159    2           CALL READ_FIRST_REC ALTRET (CMD_READ);
      898     9160    2           IF ((CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT)AND(~FLAGS.STEP_MODE))
      899     9161    2           THEN GOTO CMD_READ;             /* ONLY SE COMMAND GIVEN              */
      900     9162        /**/
      901     9163    2   NEXT_REC:
      902     9164    2           CALL CHECK_SSE ALTRET (READ_NEXT);
      903     9165    2           END;
      904     9166        /**/
      905     9167    2        IF (FLAGS.STEP_MODE) THEN DO;      /* READ COMMANDS FOR THIS REC.        */
      906     9168    2           CALL VEX$SEQNUM_TEXT(LAST_KEY);
      907     9169    2           CALL VEX$SET_PROMPT(PR_2AST);
      908     9170    3           IF (FLAGS.ST_CMD) THEN DO;
      909     9171    3              CALL CONCAT(TYPE_BUF.TEXT,SEQ_TEXT_BUF,
      910     9172    3                 ' ',SUBSTR(REC_BUF,0,REC_SIZE)) ;
      911     9173    3              CALL VEX$TYPE_REC(TYPECR);
      912     9174    3              END;
      913     9175    3           ELSE DO;
      914     9176    3              CALL INDEX(I,':',SEQ_TEXT_BUF) ALTRET(NO_COLON) ;
      915     9177    3              CALL INSERT(SEQ_TEXT_BUF,I,1,' ') ;
      916     9178    3   NO_COLON:  TYPE_BUF.TEXT = SEQ_TEXT_BUF ;
      917     9179    3              M$DCB$ = DCBADDR(IN_DCBNUM) ;
      918     9180                                           /* Test to stop print of rec. no. for SS */
      919     9181    3              IF (NOT(M$DCB$ -> F$DCB.DDEV.XEQ) AND
      920     9182    3                 NOT(M$DCB$ -> F$DCB.ASN = %FILE#))
      921     9183    3              THEN
      922     9184    3                 CALL VEX$TYPE_REC(TYPENOCR);
      923     9185    3              END;
      924     9186        /**/
      925     9187    2   STEP_CMD_READ: CALL READ_CMD;
      926     9188        /**/
      927     9189    2           IF (FLAGS.NEWLINE_FLAG) THEN GOTO READ_NEXT;
      928     9190    2           IF (CMD_SIZE = 0) THEN GOTO STEP_DONE;
      929     9191    3           DO WHILE (CMD_INDEX < CMD_SIZE);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:33   
      930     9192        /**/
      931     9193    3              CALL GET_CMD ALTRET(STEP_CMD_READ);
      932     9194    3   STEP_CMD_RETRY:
      933     9195    3              CALL X$PARSE(P_PCB) ALTRET(PARSE_ERR);
      934     9196    3              FLAGS.PARS_ERR = '0'B ;
      935     9197        /**/
      936     9198    4              DO CASE (P_PCB.OUT$ -> OUT$BLK.CODE); /* LEGAL STEP MODE COMMAND? */
      937     9199    4              CASE (EDITCMD,BUILDCMD,COPYCMD,DELETECMD,MERGECMD,
      938     9200    4                 SECMD,
      939     9201    4                 SSCMD,STCMD,FTCMD,FSCMD,FDCMD,MKCMD,MDCMD,MKPCMD,
      940     9202    4                 MDPCMD,CMCMD,CTCMD,INCMD,IPCMD,ISCMD,IACMD,IBCMD,
      941     9203    4                 APCMD,RNCMD,UPARROWCMD,EXAMINECMD,TPCMD,TNCMD,OLCMD);
      942     9204    4                 CALL VEX$ERROR(E$E_NOTSTEPMODE,2);
      943     9205    4                 GOTO STEP_CMD_READ;
      944     9206    4              END;
      945     9207        /**/
      946     9208        /*E*    ERROR:   VEE-E$E_NOTSTEPMODE-0
      947     9209                MESSAGE: Command not legal in step mode.
      948     9210                DESCRIPTION: ILLEGAL COMMAND              */
      949     9211        /**/
      950     9212    3              CALL CHECK_CMD ALTRET (STEP_CMD_READ);
      951     9213    3              END;
      952     9214    2           IF (FLAGS.INTRA_CMD)AND(FLAGS.VERIFY)AND
      953     9215    3              (POFFW(CMD$,CMD_BASE$) > 1) THEN DO;
      954     9216    3              CMD$ -> CMD_CNTRLWD.FLAGS = FALSE;
      955     9217    3              CMD$ -> CMD_CNTRLWD.CMD_CODE = VERIFY_TYPE;
      956     9218    3              CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);
      957     9219    3              CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
      958     9220    3              CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;
      959     9221    3              END;
      960     9222    2           CMD$ = CMD_BASE$;
      961     9223    2           STR_TEXT_QM$ = STR_TEXT$;
      962     9224    2           IF (CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT) THEN GOTO READ_NEXT;
      963     9225    2           END;
      964     9226        /**/
      965     9227    1        STR_TEXT$ = STR_TEXT_QM$;
      966     9228        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:34   
      967     9229    1        CALL VEM$MASTER;                   /* PROCESS COMMANDS                   */
      968     9230        /**/
      969     9231    2        IF ((FLAGS.INTRA_CMD) OR (FLAGS.STEP_MODE)) THEN DO; /* LOOP IF RANGE */
      970     9232    2           IF (FLAGS.TXFLAG)AND(~FLAGS.NOFLAG) THEN
      971     9233    2              CALL VEX$WRITE_REC(M$FILE_NUM,LAST_KEY)
      972     9234    2                 ALTRET(WRITE_ALT) ;       /* WRITE 'EDIT' RECORD IF CHANGED */
      973     9235        /**/
      974     9236    2   READ_NEXT:
      975     9237    2           FLAGS.TXFLAG = FALSE;           /* RESET                              */
      976     9238    2           FLAGS.NOFLAG = FALSE;
      977     9239    3           IF (FLAGS.RFFLAG) THEN DO;      /* SET RPFLAG AGAIN                   */
      978     9240    3              FLAGS.RFFLAG = FALSE;
      979     9241    3              FLAGS.BPFLAG = FLAGS.BPFLAG_SAV;
      980     9242    3              END;
      981     9243        /**/
      982     9244    3           IF (CP_LIMIT_SEQNUM = 0) THEN DO; /* CP ERROR                      */
      983     9245    3              CP_LIMIT_SEQNUM = Y003;
      984     9246    3              GOTO STEP_DONE;
      985     9247    3              END;
      986     9248        /**/
      987     9249    2           IF (CMD_CODE = DECMD AND FLAGS.BADKEY)
      988     9250    2           THEN GOTO STEP_DONE ;
      989     9251        /**/
      990     9252    2           IF (LAST_KEY = HI_SEQNUM)
      991     9253    2           THEN GOTO STEP_DONE ;
      992     9254        /**/
      993     9255    3           DO CASE(CMD_CODE);              /* CERTAIN COMMANDS DONT COUNT        */
      994     9256    3           CASE (HELPCMD,BPCMD,CRCMD,RPCMD,TACMD,TABXCMD,STATUSCMD,CRPTCMD,
      995     9257    3              QMCMD,QM2CMD,VECMD,TYPECMD,ROUNDCMD);
      996     9258    3              GOTO STEP_CMD_READ;
      997     9259    3           END;
      998     9260        /**/
      999     9261    2           SAVE_KEY = LAST_KEY ;
     1000     9262                                                /* Save for EOF. */
     1001     9263    2           CALL VEX$READ_SEQUEN ALTRET (STEP_DONE);
     1002     9264    3           IF (FLAGS.EOF) THEN DO;
     1003     9265    3              IF CMD_CODE ~= JUCMD
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:35   
     1004     9266    3              THEN
     1005     9267                                                    /*
     1006     9268                                                      Restore LAST_KEY.
     1007     9269                                                    */
     1008     9270    3                 LAST_KEY = SAVE_KEY;
     1009     9271    3              CALL VEX$ERROR (E$E_EDITEOF,1);
     1010     9272    3              GOTO STEP_DONE;
     1011     9273    3              END;
     1012     9274        /**/
     1013     9275        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1014     9276                 MESSAGE:  EOF hit after %U1
     1015     9277                 DESCRIPTION: While doing a consecutive read of the edit file
     1016     9278                           the end of file was encountered.
     1017     9279        */
     1018     9280        /**/
     1019     9281    2           IF  LAST_KEY <= HI_SEQNUM
     1020     9282    2           THEN GOTO NEXT_REC ;            /* Continue SE,SS,ST mode. */
     1021     9283    2           END;
     1022     9284        /**/
     1023     9285    1   STEP_DONE:
     1024     9286    2        IF (DELREC_COUNT > 0) OR (FLAGS.DELRECCMD) THEN DO;
     1025     9287    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,DELREC_COUNT);
     1026     9288    2           CALL VEX$ERROR(E$E_RECSDEL,1);
     1027     9289    2           END;
     1028     9290        /**/
     1029     9291        /*E*     ERROR:    VEE-E$E_RECSDEL-0
     1030     9292                 DESCRIPTION:   Output number of record deleted by intrarecord
     1031     9293                           delete operation.
     1032     9294        */
     1033     9295        /**/
     1034     9296    2        IF (STRCHG_COUNT > 0) OR (FLAGS.STRCHGCMD) THEN DO;
     1035     9297    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,STRCHG_COUNT);
     1036     9298    2           CALL VEX$ERROR(E$E_STRCHANGED,1);
     1037     9299    2           END;
     1038     9300        /**/
     1039     9301        /*E*     ERROR:    VEE-E$E_STRCHANGED-0
     1040     9302                 MESSAGE:  %U1 strings changed
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:36   
     1041     9303                 DESCRIPTION:   Output the number of character strings altered by
     1042     9304                           the last intrarecord command line.
     1043     9305        */
     1044     9306        /**/
     1045     9307    2        IF (CP_RECSMVED > 0) THEN DO;
     1046     9308    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,CP_RECSMVED);
     1047     9309    2           CALL VEX$ERROR(E$E_RECSMVED,1);
     1048     9310    2           CP_RECSMVED = 0;
     1049     9311    2           END;
     1050     9312        /**/
     1051     9313        /*E*    ERROR:   VEE-E$E_RECSMVED-0
     1052     9314                DESCRIPTION: OUTPUT RECORDS MOVED BY CP,CI */
     1053     9315        /**/
     1054     9316    2        IF (TRNC_COUNT ~= 0) THEN DO;
     1055     9317    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,TRNC_COUNT);
     1056     9318    2           CALL VEX$ERROR(E$E_RECSTRNC,1);
     1057     9319    2           TRNC_COUNT = 0;
     1058     9320    2           END;
     1059     9321        /**/
     1060     9322        /*E*    ERROR:   VEE-E$E_RECSTRNC-0
     1061     9323                MESSAGE: %U1 Records truncated
     1062     9324                DESCRIPTION: SOME RECORDS TRUNCATED BECAUSE OF RP MODE */
     1063     9325        /**/
     1064     9326    2        IF (FLAGS.OLINPROG) THEN DO;
     1065     9327    2           FLAGS.OLINPROG = FALSE;
     1066     9328    2           CLOSE_TY_FPT.V.DCB# = TY_DCBNUM ;
     1067     9329    2           CALL M$CLOSE (CLOSE_TY_FPT);
     1068     9330    2           RELDCB_FPT.V.DCB# = TY_DCBNUM ;
     1069     9331    2           CALL M$RELDCB(RELDCB_FPT) ALTRET(RELDCB_ERR) ;
     1070     9332    2   RELDCB_ERR:
     1071     9333    2           TY_DCBNUM = ME_DCBNUM ;
     1072     9334    2           END;
     1073     9335    1        IF CMD_CODE = FTCMD AND FT_COUNT = 0
     1074     9336    1        THEN
     1075     9337    1           CALL VEX$ERROR(E$E_NONE,1) ;
     1076     9338    1        ELSE
     1077     9339    1           FT_COUNT = 0 ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:37   
     1078     9340        /**/
     1079     9341        /*E*     ERROR:    VEE-E$E_NONE-0
     1080     9342                 DESCRIPTION: There are no records in the selected range.
     1081     9343        */
     1082     9344        /**/
     1083     9345        /**/
     1084     9346    1        GOTO CMD_READ;                     /* GET MORE COMMANDS                  */
     1085     9347        /**/
     1086     9348    1   NO_MEMORY:
     1087     9349    1        CALL VEX$ERROR(E$E_NOMEM,4);
     1088     9350    1        CALL M$EXIT;
     1089     9351        /**/
     1090     9352        /*E*     ERROR:    VEE-E$E_NOMEM-0
     1091     9353                 MESSAGE: No memory available - command aborted.
     1092     9354                 DESCRIPTION: EDIT was unable to get a data segment to use as
     1093     9355                           a work area for X$PARSE and there can't read commands.
     1094     9356        */
     1095     9357        /**/
     1096     9358    1   WRITE_ALT:
     1097     9359    2        IF (FLAGS.INTRA_CMD) THEN DO;
     1098     9360    2           FLAGS.INTRA_CMD = FALSE;
     1099     9361    2           FLAGS.TXFLAG = FALSE;
     1100     9362    2           GOTO STEP_DONE ;
     1101     9363    2           END;
     1102     9364    1        ELSE GOTO READ_NEXT;
     1103     9365        /**/
     1104     9366    1   PARSE_ERR:
     1105     9367    2        IF (P_PCB.ERROR.CODE = %E$WKOVERFLOW) THEN DO;
     1106     9368    2           CALL VEX$XPAND ALTRET (NO_MEMORY);
     1107     9369    2           IF (FLAGS.STEP_MODE) THEN GOTO STEP_CMD_RETRY;
     1108     9370    2           GOTO CMD_RETRY;
     1109     9371    2           END;
     1110     9372        /**/
     1111     9373    2        IF (P_PCB.ERROR.CODE = %E$SYNERR) THEN DO;
     1112     9374    2           FLAGS.PARS_ERR = '1'B ;
     1113     9375        %SET LISTCON = '1'B ;
     1114     9376        %IF '0'B ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:38   
     1115     9377 C              DO WHILE ('0'B) ;
     1116     9378 C      DUMMY_LABEL:
     1117     9379 C                 IF (SUBSTR(CMD_BUF,P_PCB.HI_CHAR,1) = '?') THEN DO ;
     1118     9380 C                    P_PCB.NXT = '1'B ;
     1119     9381 C                    TYPE_BUF.TEXT = 'Acceptable input at ^ is:' ;
     1120     9382 C                    CALL VEX$TYPE_REC(TYPECR) ;
     1121     9383 C                    CALL X$PARSE(P_PCB) ALTRET(QUESTION_ERR) ;
     1122     9384 C      QUESTION_ERR:
     1123     9385 C                    P_PCB.NXT = '0'B ;
     1124     9386 C                    GOTO CMD_READ ;
     1125     9387 C                    END ;                     /* THEN DO */
     1126     9388 C                 END ;                        /* DUMMY DO WHILE */
     1127     9389        %ENDIF ;
     1128     9390        /**/
     1129     9391    3           IF (LAST_CMD = 0) THEN DO;
     1130     9392    3              CALL VEX$ERROR(E$E_BADCMD,2);
     1131     9393    3              END;
     1132     9394        /*E*     ERROR:    VEE-E$E_BADCMD-0
     1133     9395                 MESSAGE:  Unknown command.
     1134     9396                 MESSAGE1: The last command was not recognized by EDIT.
     1135     9397                 DESCRIPTION: No command literal was found by X$PARSE. */
     1136     9398        /**/
     1137     9399    3           ELSE DO;
     1138     9400    3              CALL VEX$SET_SUB_BUF(SUB_BUF_1,P_PCB.HI_CHAR+(CMD_INDEX-P_PCB.NCHARS));
     1139     9401    3              CALL VEX$ERROR(E$E_SYNTAX,2);
     1140     9402    3              END;
     1141     9403        /*E*     ERROR:    VEE-E$E_SYNTAX-0
     1142     9404                 MESSAGE: Eh?
     1143     9405                 DESCRIPTION: THE USER BLEW HIS INPUT COMMAND
     1144     9406        */
     1145     9407        /**/
     1146     9408    2           IF (FLAGS.STEP_MODE) THEN GOTO STEP_CMD_READ;
     1147     9409    2           GOTO CMD_READ;
     1148     9410    2           END;
     1149     9411        /**/
     1150     9412    2        ELSE DO;
     1151     9413    2           FLAGS.PARS_ERR = '1'B ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:39   
     1152     9414    2           ERR_CODE = P_PCB.ERROR;
     1153     9415    2           CALL VEX$ERRMAX;
     1154     9416    2           GOTO CMD_READ;
     1155     9417    2           END;
     1156     9418        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:40   
     1157     9419        /**/
     1158     9420    1   READ_CMD: PROC;
     1159     9421        /**/
     1160     9422    2        IF (M$SI$ -> F$DCB.ASN = %DEVICE#) AND (M$SI$ -> F$DCB.RESNT.TYP = 'NO')
     1161     9423    2        THEN GOTO READ_SI_ERR ;       /* Unable to read from M$SI, set to 'NO' */
     1162     9424    3        IF (FLAGS.PARS_ERR) THEN DO ;
     1163     9425    3           TEMP_CMD_BUF = CMD_BUF ;        /* Save CMD_BUF for '?'            */
     1164     9426    3           TEMP_CMD_SIZE = CMD_SIZE ;
     1165     9427    3           END ;                           /* THEN DO */
     1166     9428    2   READ_CMD_AGAIN:
     1167     9429    2        CMD_INDEX = 0;
     1168     9430    2        CMD_SIZE = 0;
     1169     9431    2        SAVED_CMD = LAST_CMD;              /* FOR ?,??                           */
     1170     9432    2        LAST_CMD = 0;
     1171     9433    2        FLAGS.NEWLINE_FLAG = FALSE;
     1172     9434    2        FLAGS.NOCOMPCMD = FALSE;           /*RESET NO COMPOUND FLAG              */
     1173     9435    2        FLAGS.OVERFLOWMSG = FALSE;
     1174     9436    2        FLAGS.UNDRFLOWMSG = FALSE;
     1175     9437    2        FLAGS.TABMSG = FALSE;
     1176     9438    2        FLAGS.STRCHGCMD = FALSE;
     1177     9439    2        FLAGS.DELRECCMD = FALSE;
     1178     9440    2        CMD$ = CMD_BASE$;
     1179     9441    2        CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE; /* EMPTY COMMAND LIST         */
     1180     9442    2        CMDBUF$ = CMDBUF_BASE$;
     1181     9443    2        STR_TEXT$ = STR_TEXT_SE$;          /* SET TEXT AREA                      */
     1182     9444        /**/
     1183     9445    2   READ_CMD_1:
     1184     9446    2        FLAGS.INPUT = '1'B;
     1185     9447    2        XUG$GETCMD_.INDCB#  = IN_DCBNUM;
     1186     9448    2        M$DCB$ = DCBADDR(IN_DCBNUM);
     1187     9449    2        XUG$GETCMD_.PROMPT_ = VECTOR(SINGLE_AST);
     1188     9450    3        IF (BREAK_ARS~=0) THEN DO;
     1189     9451    3           XUG$GETCMD_.TEXT_ = VECTOR (CMD_BUF);
     1190     9452    3           BREAK_ARS = 0;
     1191     9453    3           END;
     1192     9454    2        ELSE
     1193     9455    2           XUG$GETCMD_.TEXT_ = VECTOR (NIL);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:41   
     1194     9456    2        CALL XUG$GETCMD(XUG$GETCMD_)
     1195     9457    3        WHENALTRETURN DO;
     1196     9458    4           DO SELECT( XUG$GETCMD_.ERR#.CODE#) ;
     1197     9459
     1198     9460    4              SELECT(%E$SYNERR);
     1199     9461                            /* IGNORE SYNTAX ERRORS BECAUSE EDIT WILL CATCH IT LATER */
     1200     9462
     1201     9463
     1202     9464    4              SELECT (%E$IOERR , %E$DI) ;
     1203     9465    4              IF B$JIT.MODE = %M_BATCH# OR M$DCB$ -> F$DCB.DDEV.XEQ
     1204     9466    4              THEN
     1205     9467    5              DO ;
     1206     9468    5                 CALL VEX$ERROR(0,3) ;
     1207     9469    5                 GOTO READ_CMD_ERR;
     1208     9470    5                 END ;                     /* THEN DO */
     1209     9471    4              CALL VEX$ERROR(E$E_INPUTERR,3) ;
     1210     9472    4              GOTO READ_CMD_AGAIN;
     1211     9473
     1212     9474    4              SELECT(%E$EOF,%E$NOFILE,%E$FILEBUSY) ;
     1213     9475    4              IF     XUG$GETCMD_.ERR#.CODE# ~= %E$EOF
     1214     9476    4              THEN
     1215     9477    4                 CALL VEX$ERROR(0,3) ;
     1216     9478    4              IF M$DCB$ -> F$DCB.ASN = %FILE#
     1217     9479    4              THEN
     1218     9480    5              DO ;
     1219     9481    5                 CLOSE_SIREAD_FPT.V.DCB# = IN_DCBNUM ;
     1220     9482    5                 CALL M$CLOSE(CLOSE_SIREAD_FPT) ALTRET (CLOSE_SIREAD_ERR) ;
     1221     9483    5   CLOSE_SIREAD_ERR:
     1222     9484    5                 IF IN_DCBNUM = SI_DCBNUM
     1223     9485    6                 THEN DO;
     1224     9486    6                    CALL M$OPEN(OPEN_SIME_FPT) ALTRET(READ_CMD_ERR);
     1225     9487    6                    CALL VEX$ERROR(E$E_REOPENMSI,3) ;
     1226     9488    6                    END;
     1227     9489        /*E*     ERROR:    VEE-E$E_REOPENMSI-0
     1228     9490                 MESSAGE: M$SI has been reinitialized to the ME device.
     1229     9491                 DESCRIPTION: M$SI WAS SET TO A BOGUS FILE,AND HAS BEEN RESET
     1230     9492        */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:42   
     1231     9493        /**/
     1232     9494    6                 ELSE DO ;
     1233     9495    6                    RELDCB_FPT.V.DCB# = IN_DCBNUM ;
     1234     9496    6                    CALL M$RELDCB(RELDCB_FPT) ALTRET(RELDCB_ERR) ;
     1235     9497    6   RELDCB_ERR:
     1236     9498    6                    IN_DCBNUM = SI_DCBNUM ;
     1237     9499    6                    END ;                  /* ELSE DO */
     1238     9500
     1239     9501                                 /* If last line was continue it must be reparsed */
     1240     9502    5                 IF XUG$GETCMD_.ERR#.CODE# = %E$NOFILE OR XUG$GETCMD_.ERR#.CODE# = %
              9502                          E$FILEBUSY
     1241     9503    5                 THEN
     1242     9504    5                    GOTO READ_CMD_AGAIN;
     1243     9505                                 /* If last line was continue it must be reparsed */
     1244     9506    5                 IF (SUBSTR(XUG$GETCMD_.BUF$->CMD$BUF,P_GET.NCHARS-1,1) = ';')
     1245     9507    6                 THEN DO;
     1246     9508    6                    BREAK_ARS = P_GET.NCHARS;
     1247     9509    6                    CMD_BUF = SUBSTR(XUG$GETCMD_.BUF$->CMD$BUF,
     1248     9510    6                       0,
     1249     9511    6                       P_GET.NCHARS) ;
     1250     9512    6                    END;
     1251     9513    5                 GOTO READ_CMD_AGAIN;
     1252     9514    5                 END ;                     /* THEN DO */
     1253     9515    4              ELSE                    /* This is End of file on the XEQ stream */
     1254     9516    4                 GOTO READ_CMD_ERR;
     1255     9517
     1256     9518    4              SELECT(ELSE) ;               /* Bad ERROR. */
     1257     9519    4           CALL VEX$ERROR(0,3) ;
     1258     9520    4           GOTO READ_CMD_ERR;
     1259     9521    4              END ;                        /* DO SELECT */
     1260     9522    3           END;
     1261     9523    2        FLAGS.INPUT = '0'B;
     1262     9524        /**/
     1263     9525    3        DO I = 1 TO XUG$GETCMD_.NLINES;
     1264     9526    3           TEMP_COUNT = XUG$GETCMD_.RLT$-> XUG_RLT(I);
     1265     9527    3           CMD_BUF = SUBSTR(XUG$GETCMD_.BUF$ -> CMD$BUF,CMD_SIZE, TEMP_COUNT) ;
     1266     9528    3           CALL INSERT(CMDBUF$ -> CMD$BUF,CMD_SIZE,TEMP_COUNT,CMD_BUF);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:43   
     1267     9529    3           CMD_SIZE = CMD_SIZE + TEMP_COUNT;
     1268     9530    4           IF (POFFC(CMDBUF_END$,PINCRC(CMDBUF$,CMD_SIZE)) < SIZEC(CMD_BUF)) THEN DO;
     1269     9531    4              CALL VEX$XPAND ALTRET(NO_MEMORY);
     1270     9532    4              END;
     1271     9533    3           END;
     1272     9534        /**/
     1273     9535    3        DO WHILE ((SUBSTR(CMDBUF$->CMD$BUF,CMD_SIZE-1,1) = ';') OR
     1274     9536    3           (SUBSTR(CMDBUF$->CMD$BUF,CMD_SIZE-1,1) = ' ') ) ;
     1275     9537    3           CMD_SIZE = CMD_SIZE -1 ;
     1276     9538    3           END;
     1277     9539        /**/
     1278     9540        /**/
     1279     9541    2        FLAGS.PARS_ERR = '0'B ;
     1280     9542    2        IF (CMD_BUF ~= '?') THEN ERR_CODE = '0'B ;
     1281     9543        /**/
     1282     9544        /**/
     1283     9545    2        IF ((CMD_SIZE = 0) AND (M$SI$ -> F$DCB.EOMCHAR = NEWLINE))
     1284     9546    2        THEN FLAGS.NEWLINE_FLAG = TRUE;
     1285     9547        /**/
     1286     9548    3        IF ((CMD_SIZE = 0)AND(M$SI$ -> F$DCB.EOMCHAR = EOT)) THEN DO;
     1287     9549    3           CMD_SIZE = 1;                   /* EOT MEANS UPARROW                  */
     1288     9550    3           CALL INSERT(CMDBUF$ -> CMD$BUF,0,1,'^');
     1289     9551    3           END;
     1290     9552    2        RETURN;
     1291     9553        /**/
     1292     9554    2   READ_CMD_ERR:
     1293     9555    2        FLAGS.INPUT = '0'B ;
     1294     9556    2        IF (B$JIT$ -> B$JIT.MODE = %M_BATCH#) OR
     1295     9557    2           (M$SI$ -> F$DCB.DDEV.XEQ)
     1296     9558    2        THEN
     1297     9559    3        DO ;
     1298     9560    3   READ_SI_ERR:
     1299     9561    3           CALL VEX$ERROR(E$E_CMDERR,3) ;
     1300     9562    3           CALL M$EXIT ;
     1301     9563    3           END ;                           /* THEN DO */
     1302     9564    2        CALL VEX$ERROR(E$E_INPUTERR,3) ;
     1303     9565    2        GOTO READ_CMD_AGAIN ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:44   
     1304     9566        /**/
     1305     9567        /*E*     ERROR:    VEE-E$E_CMDERR-0
     1306     9568                 MESSAGE:  Error reading command input - EDIT exiting
     1307     9569                 DESCRIPTION: ERROR READING M$SI - PROBABLY SET SOMEWHERE  */
     1308     9570        /**/
     1309     9571        /*E*     ERROR:    VEE-E$E_INPUTERR-0
     1310     9572                 MESSAGE:  Error reading command input - please try again.
     1311     9573                 DESCRIPTION: ERROR READING M$SI - PROBABLY PARITY OR SOMETHING */
     1312     9574        /**/
     1313     9575    2   NO_MEMORY:
     1314     9576    2        CALL VEX$ERROR(E$E_NOMEM,3);
     1315     9577    2        CMD_SIZE = 0;
     1316     9578    2        RETURN;
     1317     9579        /*E*    ERROR:   VEE-E$E_NOMEM-0
     1318     9580                DESCRIPTION: NO MEMORY FOR COMMAND TEXT   */
     1319     9581        /**/
     1320     9582    2   END;                                    /* END READ_CMD                       */
     1321     9583        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:45   
     1322     9584        /**/
     1323     9585    1   GET_CMD: PROC ALTRET;
     1324     9586        /**/
     1325     9587    2   DCL IN_DQUOTE BIT(1);
     1326     9588    2   DCL IN_SQUOTE BIT(1);
     1327     9589    2   DCL TBLVAL UBIN WORD ;
     1328     9590    2   DCL STR_LEN UBIN WORD ;
     1329     9591        /**/
     1330     9592        %EQU DQUOTE_TBLPOS = 34 ;
     1331     9593        %EQU SQUOTE_TBLPOS = 39 ;
     1332     9594        %EQU SLASH_TBLPOS = 47 ;
     1333     9595        %EQU SEMICOLON_TBLPOS = 59 ;
     1334     9596    2   DCL IN_SLASH BIT(1);
     1335     9597        /**/
     1336     9598    2        IF (CMD_INDEX >= CMD_SIZE) THEN ALTRETURN; /* NO MORE COMMANDS        */
     1337     9599        /**/
     1338     9600    2        IF (CMD_INDEX = 0) THEN FLAGS.FIRSTCMD = TRUE; /* FIRST COMMAND       */
     1339     9601    2        ELSE FLAGS.FIRSTCMD = FALSE;
     1340     9602        /**/
     1341     9603    2        IN_SLASH = FALSE;
     1342     9604    2        IN_SQUOTE = FALSE;
     1343     9605    2        IN_DQUOTE = FALSE;
     1344     9606    2        TEMP_CLMN = 0 ;
     1345     9607    2        CMDBUF$ = PINCRC(CMDBUF_BASE$, CMD_INDEX) ;
     1346     9608    2        GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;
     1347     9609    2        GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;
     1348     9610    2        GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;
     1349     9611    2        GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;
     1350     9612    2        STR_LEN = CMD_SIZE - CMD_INDEX ;
     1351     9613        /**/
     1352     9614    3        DO WHILE (TEMP_CLMN < CMD_SIZE - CMD_INDEX);
     1353     9615    3           CALL SEARCH (TEMP_CLMN, TBLVAL, GET_CMD_TBL, SUBSTR(CMDBUF$ ->
     1354     9616    3              CMD$BUF,0,STR_LEN), TEMP_CLMN) ALTRET (GOT_CMD) ;
     1355     9617        /**/
     1356     9618    4           DO SELECT (TBLVAL) ;
     1357     9619
     1358     9620    4              SELECT (%DQUOTE_TBLPOS) ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:46   
     1359     9621    4              IF IN_DQUOTE
     1360     9622    4              THEN
     1361     9623    5              DO ;
     1362     9624    5                 IN_DQUOTE = FALSE ;
     1363     9625    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;
     1364     9626    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;
     1365     9627    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;
     1366     9628    5                 END ;                     /* Then Do */
     1367     9629    4              ELSE
     1368     9630    5              DO ;
     1369     9631    5                 IN_DQUOTE = TRUE ;
     1370     9632    5                 GET_CMD_TBL = FALSE ;
     1371     9633    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;
     1372     9634    5                 END ;                     /* Else Do */
     1373     9635
     1374     9636    4              SELECT (%SQUOTE_TBLPOS) ;
     1375     9637    4              IF IN_SQUOTE
     1376     9638    4              THEN
     1377     9639    5              DO ;
     1378     9640    5                 IN_SQUOTE = FALSE ;
     1379     9641    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;
     1380     9642    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;
     1381     9643    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;
     1382     9644    5                 END ;                     /* Then Do */
     1383     9645    4              ELSE
     1384     9646    5              DO ;
     1385     9647    5                 IN_SQUOTE = TRUE ;
     1386     9648    5                 GET_CMD_TBL = FALSE ;
     1387     9649    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;
     1388     9650    5                 END ;                     /* Else Do */
     1389     9651
     1390     9652    4              SELECT (%SLASH_TBLPOS) ;
     1391     9653    4              IF IN_SLASH
     1392     9654    4              THEN
     1393     9655    5              DO ;
     1394     9656    5                 IN_SLASH = FALSE ;
     1395     9657    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:47   
     1396     9658    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;
     1397     9659    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;
     1398     9660    5                 END ;                     /* Then Do */
     1399     9661    4              ELSE
     1400     9662    5              DO ;
     1401     9663    5                 IN_SLASH = TRUE ;
     1402     9664    5                 GET_CMD_TBL = FALSE ;
     1403     9665    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;
     1404     9666    5                 END ;                     /* Else Do */
     1405     9667
     1406     9668    4              SELECT (%SEMICOLON_TBLPOS) ;
     1407     9669    4   GOT_CMD:
     1408     9670    4              CMD_BUF = SUBSTR(CMDBUF$->CMD$BUF, 0, TEMP_CLMN) ;
     1409     9671    4              P_PCB.NCHARS = TEMP_CLMN ;
     1410     9672    4              CMD_INDEX = CMD_INDEX + TEMP_CLMN + 1 ;
     1411     9673    4              RETURN ;
     1412     9674
     1413     9675    4              END ;                        /* Do Select */
     1414     9676    3           TEMP_CLMN = TEMP_CLMN + 1 ;
     1415     9677    3           END ;                           /* Do While */
     1416     9678    2        GOTO GOT_CMD ;
     1417     9679        /**/
     1418     9680    2   END;                                    /* END GET_CMD                        */
     1419     9681        /**/
     1420     9682        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:48   
     1421     9683        /**/
     1422     9684    1   READ_FIRST_REC: PROC ALTRET;
     1423     9685        /**/
     1424     9686        /*F*     NAME:     READ_FIRST_REC
     1425     9687                 FUNCTION: READS THE FIRST RECORD OF THE SELECTED RANGE OF THE
     1426     9688                      FILE INTO REC_BUF. ALTRET IF NO RECORDS IN RANGE */
     1427     9689        /**/
     1428     9690    2        CALL VEX$READ_RANDOM (LO_SEQNUM) ALTRET (READ_FIRST_ERR);
     1429     9691    3        IF (~FLAGS.EXISTS) THEN DO;        /* NO RECORD WITH THAT KEY            */
     1430     9692    3           CALL VEX$READ_SEQUEN ALTRET (READ_FIRST_ERR);
     1431     9693    4           IF (FLAGS.EOF) THEN DO;
     1432     9694    4              CALL VEX$ERROR (E$E_EDITEOF,1);
     1433     9695    4              ALTRETURN;
     1434     9696    4              END;
     1435     9697        /**/
     1436     9698        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1437     9699                 DESCRIPTION: EOF hit before selected range or record.
     1438     9700        */
     1439     9701        /**/
     1440     9702    3           IF LAST_KEY > HI_SEQNUM
     1441     9703    4           THEN DO;
     1442     9704    4              CALL VEX$ERROR (E$E_NONE,1);
     1443     9705    4              ALTRETURN;
     1444     9706    4              END;
     1445     9707        /**/
     1446     9708        /*E*     ERROR:    VEE-E$E_NONE-0
     1447     9709                 MESSAGE:  None
     1448     9710                 MESSAGE1: No records in range
     1449     9711                 DESCRIPTION: There are no records in the selected range.
     1450     9712        */
     1451     9713    3           END;
     1452     9714    2        RETURN;
     1453     9715        /**/
     1454     9716    2   READ_FIRST_ERR:
     1455     9717    2        ALTRETURN;
     1456     9718    2   END;                                    /* END READ_FIRST_REC                 */
     1457     9719        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:49   
     1458     9720    1   CHECK_SSE: PROC ALTRET;
     1459     9721        /**/
     1460     9722    2   DCL SSE$ PTR;                           /* TEMP PTR TO RUN SSE_TBL            */
     1461     9723    2   DCL 1 STR_FLGS,
     1462     9724    2          2 CLMNFLAG BIT(1) UNAL,
     1463     9725    2          2 NOTFLAG BIT(1) UNAL,
     1464     9726    2          2 ANDFLAG BIT(1) UNAL,
     1465     9727    2          2 ORFLAG BIT(1) UNAL,
     1466     9728    2          2 EORFLAG BIT(1) UNAL,
     1467     9729    2          2 * BIT(13) UNAL;
     1468     9730    2   DCL SSE_EVAL BIT(1);
     1469     9731        /**/
     1470     9732    2        SSE$ = ADDR(SSE_TBL);
     1471     9733    2        IF (SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL)) THEN RETURN;
              9733                 /* NO SELECTION CRITERIA */
     1472     9734    2        SSE_EVAL = FALSE;
     1473     9735        /**/
     1474     9736    2   CHECK_SSE_1:
     1475     9737    2        STR_FLGS = SSE$ -> SSE$PARAM.FLAGS;
     1476     9738    2        IF ((SSE_EVAL) AND (STR_FLGS.ORFLAG)) THEN GOTO CHECK_SSE_NEXT;
     1477     9739    2        IF ((~SSE_EVAL) AND (STR_FLGS.ANDFLAG)) THEN GOTO CHECK_SSE_NEXT;
     1478     9740        /**/
     1479     9741    2        CALL VEX$FIND_MATCH(SSE$,LO_SRCH_CLMN,HI_SRCH_CLMN,MATCH_CLMN) ALTRET (
              9741                 CHECK_SSE_2);
     1480     9742                                                /* MATCHING STRING IS PRESENT         */
     1481     9743    2        IF ((~SSE_EVAL) AND
     1482     9744    2           (((STR_FLGS.ORFLAG) OR (STR_FLGS.EORFLAG)) AND (~STR_FLGS.NOTFLAG)))
     1483     9745    2        THEN SSE_EVAL = TRUE;
     1484     9746        /**/
     1485     9747    2        ELSE IF ((SSE_EVAL) AND
     1486     9748    2              ((STR_FLGS.ANDFLAG) AND (STR_FLGS.NOTFLAG)) OR
     1487     9749    2              ((STR_FLGS.EORFLAG) AND (~STR_FLGS.NOTFLAG)))
     1488     9750    2           THEN SSE_EVAL = FALSE;
     1489     9751        /**/
     1490     9752    2        GOTO CHECK_SSE_NEXT;
     1491     9753        /**/                                    /* MATCHING STRING NOT FOUND          */
     1492     9754    2   CHECK_SSE_2:
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:50   
     1493     9755    2        IF ((~SSE_EVAL) AND
     1494     9756    2           ((STR_FLGS.NOTFLAG)  AND ((STR_FLGS.ORFLAG) OR (STR_FLGS.EORFLAG))))
     1495     9757    2        THEN SSE_EVAL = TRUE;
     1496     9758        /**/
     1497     9759    2        ELSE IF ((SSE_EVAL) AND
     1498     9760    2              (((STR_FLGS.ANDFLAG) AND (~STR_FLGS.NOTFLAG)) OR
     1499     9761    2              ((STR_FLGS.EORFLAG) AND (STR_FLGS.NOTFLAG))))
     1500     9762    2           THEN SSE_EVAL = FALSE;
     1501     9763        /**/
     1502     9764    2   CHECK_SSE_NEXT:
     1503     9765    2        SSE$ = PINCRW(SSE$,2);             /* TWO WORD BLOCKS                    */
     1504     9766    3        IF (SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL)) THEN DO;
     1505     9767    4           IF (SSE_EVAL) THEN DO ;
     1506     9768    4              FT_COUNT = FT_COUNT + 1 ;
     1507     9769    4              RETURN ;
     1508     9770    4              END ;                        /* THEN DO */
     1509     9771    3           ELSE ALTRETURN;
     1510     9772    3           END;
     1511     9773        /**/
     1512     9774    2        GOTO CHECK_SSE_1;
     1513     9775        /**/
     1514     9776    2   END;                                    /* END CHECK SSE                      */
     1515     9777        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:51   
     1516     9778        /**/
     1517     9779    1   CHECK_CMD: PROC ALTRET;
     1518     9780        /**/
     1519     9781    2        BLK$ = P_PCB.OUT$;
     1520     9782    3        IF (FLAGS.NOCOMPCMD = TRUE) THEN DO; /* NO MORE COMMANDS ALLOWED      */
     1521     9783    4           IF (CMD_CODE = BLANKLINE) THEN DO ;
     1522     9784    4              CALL VEX$SET_SUB_BUF(SUB_BUF_1,CMD_INDEX-P_PCB.NCHARS-1) ;
     1523     9785    4              CALL VEX$ERROR(E$E_SYNTAX,2) ;
     1524     9786    4              ALTRETURN ;
     1525     9787    4              END ;                        /* THEN DO */
     1526     9788    3           CALL VEX$ERROR (E$E_NOTCOMP,3);
     1527     9789    3           ALTRETURN;
     1528     9790    3           END;
     1529     9791        /**/
     1530     9792        /*E*     ERROR:    VEE-E$E_NOTCOMP-0
     1531     9793                 MESSAGE:  Command not compoundable
     1532     9794                 MESSAGE1: One of the commands in the last command line must
     1533     9795                           be the last command on a line and is not last or
     1534     9796                           the first command on a line and is not first.
     1535     9797                 DESCRIPTION: There are commands following a command which
     1536     9798                           must appear last on a line.
     1537     9799        */
     1538     9800        /**/
     1539     9801    2        CMD_CODE = BLK$ -> OUT$BLK.CODE;
     1540     9802    2        IF (CMD_CODE ~= QMCMD)AND(CMD_CODE ~= QM2CMD) THEN LAST_CMD = CMD_CODE;
     1541     9803    2        CMD$ -> CMD_CNTRLWD.FLAGS = FALSE; /* CLEAR FLAGS                     */
     1542     9804    2        CMD$ -> CMD_CNTRLWD.CMD_CODE = CMD_CODE;
     1543     9805    2        FLAGS.INTRA_CMD = FALSE;           /* RESET FLAGS                        */
     1544     9806        /**/
     1545     9807    3        DO CASE (CMD_CODE);                /* CHECK FOR LEGAL INPUT MODE CMDS    */
     1546     9808        /**/
     1547     9809    3        CASE (FDCMD,MKCMD,MDCMD,MKPCMD,MDPCMD,CMCMD,CTCMD,INCMD,IPCMD,
     1548     9810    3           IACMD,IBCMD,ISCMD,APCMD,DECMD,ADCMD,RNCMD,RRCMD,ACMD,
     1549     9811    3           ECMD,OCMD,FCMD,PCMD,SCMD,DCMD,RCMD,LCMD);
     1550     9812    3           IF (FLAGS.EDIT_MODE)AND
     1551     9813    3              ((NOT(M$FILE$ -> F$DCB.FFLG.DELR))AND
     1552     9814    3              (NOT(M$FILE$ -> F$DCB.FFLG.WNEW))AND
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:52   
     1553     9815    4              (NOT(M$FILE$ -> F$DCB.FFLG.UPD))) THEN DO;
     1554     9816    4              CALL VEX$ERROR (E$E_INONLY,3);
     1555     9817    4              ALTRETURN;
     1556     9818    4              END;
     1557     9819    3        END;
     1558     9820        /**/
     1559     9821        /**/
     1560     9822    3        DO CASE (CMD_CODE);
     1561     9823        /**/
     1562     9824    3        CASE (BPCMD,CRCMD,RPCMD,TABXCMD,TABCCMD,ROUNDCMD);
     1563     9825    3           CALL CHECK_BP ALTRET(CHECK_CMD_ALT);
     1564     9826    3        CASE (BUILDCMD);
     1565     9827    3           CALL CHECK_BUILD ALTRET(CHECK_CMD_ALT);
     1566     9828    3        CASE (COPYCMD);
     1567     9829    3           CALL CHECK_COPY ALTRET(CHECK_CMD_ALT);
     1568     9830    3        CASE (CRPTCMD);
     1569     9831    3           CALL CHECK_CRPT ALTRET (CHECK_CMD_ALT);
     1570     9832    3        CASE (EDITCMD,DELETECMD,EXAMINECMD);
     1571     9833    3           CALL CHECK_EDIT ALTRET(CHECK_CMD_ALT);
     1572     9834    3        CASE (ENDCMD,XCMD,QMCMD,QM2CMD,UPARROWCMD);
     1573     9835    3           CALL CHECK_END ALTRET (CHECK_CMD_ALT);
     1574     9836    3        CASE (LISTCMD);
     1575     9837    3           CALL CHECK_LIST ALTRET (CHECK_CMD_ALT);
     1576     9838    3        CASE (MERGECMD) ;
     1577     9839    3           CALL CHECK_MERGE ALTRET(CHECK_CMD_ALT);
     1578     9840    3        CASE (READCMD);
     1579     9841    3           CALL CHECK_READ ALTRET (CHECK_CMD_ALT);
     1580     9842    3           CMD$ -> CMD_CNTRLWD.OFFSET = 1 ;
     1581     9843    3        CASE (STATUSCMD);
     1582     9844    3           CALL CHECK_STATUS ALTRET (CHECK_CMD_ALT);
     1583     9845    3        CASE (TACMD);
     1584     9846    3           CALL CHECK_TA ALTRET(CHECK_CMD_ALT);
     1585     9847    3        CASE (TYPECMD);
     1586     9848    3           CALL CHECK_TYPE ALTRET (CHECK_CMD_ALT);
     1587     9849    3        CASE (VECMD);
     1588     9850    3           CALL CHECK_VE ALTRET(CHECK_CMD_ALT);
     1589     9851    3        CASE (DIRCMD);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:53   
     1590     9852    3           CALL CHECK_DIR ALTRET(CHECK_CMD_ALT);
     1591     9853        /**/
     1592     9854        /**/
     1593     9855    3        CASE (HELPCMD);
     1594     9856    3           CMD$ -> CMD_CNTRLWD.OFFSET = 1 ;
     1595     9857    3           FLAGS.NOCOMPCMD = TRUE;
     1596     9858    3        CASE (BLANKLINE) ;
     1597     9859    3           FLAGS.NOCOMPCMD = TRUE ;
     1598     9860        /**/
     1599     9861        /**/
     1600     9862    3        CASE (CMCMD,CTCMD);
     1601     9863    3           CALL CHECK_CM ALTRET(CHECK_CMD_ALT);
     1602     9864    3        CASE (DECMD,RRCMD,ADCMD,OLCMD);
     1603     9865    3           CALL CHECK_DE ALTRET(CHECK_CMD_ALT);
     1604     9866    3        CASE (INCMD,IPCMD,ISCMD,IACMD,IBCMD,APCMD);
     1605     9867    3           CALL CHECK_IN ALTRET(CHECK_CMD_ALT);
     1606     9868    3        CASE (MKCMD,MDCMD,MKPCMD,MDPCMD);
     1607     9869    3           CALL CHECK_MK ALTRET(CHECK_CMD_ALT);
     1608     9870    3        CASE (RNCMD);
     1609     9871    3           CALL CHECK_RN ALTRET(CHECK_CMD_ALT);
     1610     9872    3        CASE (SECMD,SSCMD,STCMD,TYCMD,FTCMD,FSCMD,FDCMD);
     1611     9873    3           CALL CHECK_SE ALTRET(CHECK_CMD_ALT);
     1612     9874    3        CASE (TNCMD,TPCMD);
     1613     9875    3           CALL CHECK_TN ALTRET(CHECK_CMD_ALT);
     1614     9876    3        CASE (TSCMD,TCCMD,TXCMD,RFCMD,NOCMD,EICMD,QRCMD,RLCMD);
     1615     9877    3           CALL CHECK_TS ALTRET(CHECK_CMD_ALT);
     1616     9878        /**/
     1617     9879        /**/
     1618     9880    3        CASE (ACMD);
     1619     9881    3           CALL CHECK_A ALTRET(CHECK_CMD_ALT);
     1620     9882    3        CASE (CLCMD);
     1621     9883    3           CALL CHECK_CL ALTRET(CHECK_CMD_ALT);
     1622     9884    3        CASE (CPCMD,CICMD);
     1623     9885    3           CALL CHECK_CP ALTRET(CHECK_CMD_ALT);
     1624     9886    3        CASE (DCMD);
     1625     9887    3           CALL CHECK_D ALTRET(CHECK_CMD_ALT);
     1626     9888    3        CASE (ECMD,OCMD,FCMD,PCMD);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:54   
     1627     9889    3           CALL CHECK_E ALTRET(CHECK_CMD_ALT);
     1628     9890    3        CASE (IFCMD,ELCMD);
     1629     9891    3           CALL CHECK_IF ALTRET(CHECK_CMD_ALT);
     1630     9892    3        CASE (JUCMD);
     1631     9893    3           CALL CHECK_JU ALTRET(CHECK_CMD_ALT);
     1632     9894    3        CASE (RCMD,LCMD);
     1633     9895    3           CALL CHECK_R ALTRET(CHECK_CMD_ALT);
     1634     9896    3        CASE (SCMD);
     1635     9897    3           CALL CHECK_S ALTRET(CHECK_CMD_ALT);
     1636     9898    3        END;
     1637     9899        /**/
     1638     9900    2        CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
     1639     9901    2        CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;
     1640     9902    3        IF (POFFW(CMD_END$,CMD$) < 10) THEN DO;
     1641     9903    3           CALL VEX$XPAND ALTRET(NO_MEMORY);
     1642     9904    3           END;
     1643     9905    2        RETURN;
     1644     9906        /**/
     1645     9907    2   NO_MEMORY:
     1646     9908    2        CALL VEX$ERROR(E$E_NOSTRMEM,3);
     1647     9909    2   CHECK_CMD_ALT:
     1648     9910    2        ALTRETURN;
     1649     9911    2   END;                                    /* END CHECK_CMD                      */
     1650     9912        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:55   
     1651     9913        /**/
     1652     9914    1   CHECK_BP: PROC ALTRET;
     1653     9915        /**/
     1654     9916    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_BP_ALT);
     1655     9917        /**/
     1656     9918    3        IF (CMD_CODE = RPCMD)AND(FLAGS.CONSEC_MODE) THEN DO;
     1657     9919    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     1658     9920    3           ALTRETURN;
     1659     9921    3           END;
     1660     9922        /**/
     1661     9923        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     1662     9924                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     1663     9925        /**/
     1664     9926    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> BP_CMD_TBL);
     1665     9927        /**/
     1666     9928    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_ON) THEN
     1667     9929    2           CMD$ -> BP_CMD_TBL.TEXT = 'ON';
     1668     9930    2        ELSE CMD$ -> BP_CMD_TBL.TEXT = 'OFF';
     1669     9931    2        RETURN;
     1670     9932        /**/
     1671     9933    2   CHECK_BP_ALT:
     1672     9934    2        ALTRETURN;
     1673     9935    2   END;                                    /* END CHECK_BP                       */
     1674     9936        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:56   
     1675     9937        /**/
     1676     9938    1   CHECK_BUILD: PROC ALTRET;
     1677     9939        /**/
     1678     9940    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_BUILD_ALT);
     1679     9941        /**/
     1680     9942    2        I = BLK$ -> OUT$BLK.NSUBLKS ;
     1681     9943    2        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;
     1682     9944    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(B_CMD_TBL);
     1683     9945    2        CMD$ -> B_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);
     1684     9946    2        CMD$ -> B_CMD_TBL.SEQNUM = SEQNUM_ONE; /* DEFAULT                     */
     1685     9947    2        DFLT_INCR = SEQNUM_ONE - Y003;
     1686     9948    2        CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;
     1687     9949    2        CMD$ -> B_CMD_TBL.TYPE = TYPE_CODE;
     1688     9950        /**/
     1689     9951    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */
     1690     9952        /**/
     1691     9953    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN;
     1692     9954        /**/
     1693     9955    2        P$ = BLK$;
     1694     9956    2        I = 2;
     1695     9957        /**/
     1696     9958    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);
     1697     9959    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILETYPE;
     1698     9960        /**/
     1699     9961    3        IF (BLK$ -> OUT$BLK.CODE = PC_INCR) THEN DO; /* FID,,i CASE           */
     1700     9962    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);
     1701     9963    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_BUILD_ALT);
     1702     9964    3           DFLT_INCR = DFLT_INCR - Y003;
     1703     9965    3           CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;
     1704     9966    3           END;
     1705     9967        /**/
     1706     9968    3        ELSE DO;
     1707     9969    3           CALL VEX$BUILD_SEQNUM(CMD$ -> B_CMD_TBL.SEQNUM,BLK$)
     1708     9970    3              ALTRET (CHECK_BUILD_ALT);
     1709     9971    3           END;
     1710     9972        /**/
     1711     9973    2        I = 3;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:57   
     1712     9974    2        IF (P$ -> OUT$BLK.NSUBLKS = 3) THEN RETURN;
     1713     9975        /**/
     1714     9976    2        BLK$ = P$ -> OUT$BLK.SUBLK$(3);
     1715     9977    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILETYPE;
     1716     9978        /**/
     1717     9979    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);
     1718     9980    2        CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_BUILD_ALT);
     1719     9981    2        DFLT_INCR = DFLT_INCR - Y003;
     1720     9982    2        CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;
     1721     9983        /**/
     1722     9984    2        I = 4;
     1723     9985    2        IF (P$ -> OUT$BLK.NSUBLKS = 4) THEN RETURN;
     1724     9986        /**/
     1725     9987    2   FILETYPE:
     1726     9988    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);
     1727     9989    3        IF (BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT > 2 ) THEN DO;
     1728     9990    3           CMD$ -> B_CMD_TBL.TYPE = 'SE';
     1729     9991    3           CALL VEX$ERROR (E$E_SETYPEUSED,2);
     1730     9992    3           RETURN;
     1731     9993    3           END;
     1732     9994        /**/
     1733     9995        /*E*     ERROR:    VEE-E$E_SETYPEUSED-0
     1734     9996                 MESSAGE:  A file type code of 'SE' has been used by default
     1735     9997                 DESCRIPTION: No file type code was input so 'SE' is to
     1736     9998                           be used by default.
     1737     9999        */
     1738    10000        /**/
     1739    10001    2        CMD$ -> B_CMD_TBL.TYPE = SUBSTR(BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,
     1740    10002    2           0,BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     1741    10003    2        RETURN;
     1742    10004        /**/
     1743    10005    2   CHECK_BUILD_ALT:
     1744    10006    2        ALTRETURN;
     1745    10007    2   END;                                    /* END CHECK_BUILD                    */
     1746    10008        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:58   
     1747    10009        /**/
     1748    10010    1   CHECK_COPY: PROC ALTRET;
     1749    10011        /**/
     1750    10012    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_COPY_ALT);
     1751    10013        /**/
     1752    10014    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */
     1753    10015        /**/
     1754    10016    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> C_CMD_TBL);
     1755    10017        /**/
     1756    10018    2        CMD$ -> C_CMD_TBL.SEQNUM = SEQNUM_ONE;
     1757    10019    2        CMD$ -> C_CMD_TBL.INCR = SEQNUM_ONE - Y003;
     1758    10020    2        CMD$ -> C_CMD_TBL.TYPE = '  ';
     1759    10021        /**/
     1760    10022    2        CMD$ -> C_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);
     1761    10023        /**/
     1762    10024    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN DO; /* 'COPY FID' CASE          */
     1763    10025    3           CMD$ -> C_CMD_TBL.FID2$ = CMD$ -> C_CMD_TBL.FID$;
     1764    10026    3           CMD$ -> C_CMD_TBL.ONOVER = 'OVER';
     1765    10027    3           RETURN;
     1766    10028    3           END;
     1767    10029        /**/
     1768    10030    2        P$ = BLK$;
     1769    10031    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);
     1770    10032        /**/
     1771    10033    2        IF (BLK$ -> OUT$BLK.CODE = PC_ON)OR
     1772    10034    3           (BLK$ -> OUT$BLK.CODE = PC_OVER) THEN DO; /* COPY FID ON/OVER CASE  */
     1773    10035    3           IF (BLK$ -> OUT$BLK.CODE = PC_ON) THEN
     1774    10036    3              CMD$ -> C_CMD_TBL.ONOVER = 'ON';
     1775    10037    3           ELSE CMD$ -> C_CMD_TBL.ONOVER = 'OVER';
     1776    10038        /**/
     1777    10039    3           BLK$ = P$ -> OUT$BLK.SUBLK$(3);
     1778    10040    3           CMD$ -> C_CMD_TBL.FID2$ = BLK$ -> OUT$BLK.SUBLK$(0);
     1779    10041    4           IF (P$ -> OUT$BLK.NSUBLKS = 4) THEN DO; /* SAME SEQ NUMBERS        */
     1780    10042    4              CMD$ -> C_CMD_TBL.SEQNUM = MAX_SEQNUM + 1;
     1781    10043    4              RETURN;
     1782    10044    4              END;
     1783    10045    3           I = 4;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:59   
     1784    10046    3           END;
     1785    10047    3        ELSE DO;
     1786    10048    3           CMD$ -> C_CMD_TBL.FID2$ = CMD$ -> C_CMD_TBL.FID$; /* 'COPY,N,I' CASE */
     1787    10049    3           CMD$ -> C_CMD_TBL.ONOVER = 'OVER';
     1788    10050    3           I = 2;
     1789    10051    3           END;
     1790    10052        /**/
     1791    10053    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);
     1792    10054    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILE_TYPE;
     1793    10055        /**/
     1794    10056    3        IF (BLK$ -> OUT$BLK.CODE = PC_INCR) THEN DO; /* ,,i CASE              */
     1795    10057    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);
     1796    10058    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_COPY_ALT);
     1797    10059    3           DFLT_INCR = DFLT_INCR - Y003;
     1798    10060    3           CMD$ -> C_CMD_TBL.INCR = DFLT_INCR;
     1799    10061    3           I = I+1;
     1800    10062    3           END;
     1801    10063        /**/
     1802    10064    3        ELSE DO;
     1803    10065    3           CALL VEX$BUILD_SEQNUM (CMD$ -> C_CMD_TBL.SEQNUM,BLK$)
     1804    10066    3              ALTRET (CHECK_COPY_ALT);
     1805    10067    3           I = I+1;
     1806    10068    3           END;
     1807    10069        /**/
     1808    10070    2        IF (P$ -> OUT$BLK.NSUBLKS = I) THEN RETURN;
     1809    10071        /**/
     1810    10072    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);
     1811    10073    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILE_TYPE;
     1812    10074        /**/
     1813    10075    2        I = I+1;
     1814    10076    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);  /* ,n,i CASE                        */
     1815    10077    2        CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_COPY_ALT);
     1816    10078    2        DFLT_INCR = DFLT_INCR - Y003;
     1817    10079    2        CMD$ -> C_CMD_TBL.INCR = DFLT_INCR;
     1818    10080        /**/
     1819    10081    2        IF (P$ -> OUT$BLK.NSUBLKS = I) THEN RETURN;
     1820    10082        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:60   
     1821    10083    2   FILE_TYPE:
     1822    10084    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);
     1823    10085    3        IF (BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT > 2 ) THEN DO;
     1824    10086    3           CMD$ -> C_CMD_TBL.TYPE = 'SE';
     1825    10087    3           CALL VEX$ERROR (E$E_SETYPEUSED,2);
     1826    10088    3           RETURN;
     1827    10089    3           END;
     1828    10090        /**/
     1829    10091        /*E*     ERROR:    VEE-E$E_SETYPEUSED-0
     1830    10092                 DESCRIPTION: Illegal type code was input so 'SE' is to
     1831    10093                           be used by default.
     1832    10094        */
     1833    10095        /**/
     1834    10096    2        CMD$ -> C_CMD_TBL.TYPE = SUBSTR(BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,
     1835    10097    2           0,BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     1836    10098    2        RETURN;
     1837    10099    2   CHECK_COPY_ALT:
     1838    10100    2        ALTRETURN;
     1839    10101    2   END;                                    /* END CHECK_COPY                     */
     1840    10102        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:61   
     1841    10103        /**/
     1842    10104    1   CHECK_CRPT: PROC ALTRET;
     1843    10105        /**/
     1844    10106    3        IF (BLK$ -> OUT$BLK.NSUBLKS <= 1) THEN DO;
     1845    10107    3           SEED = 0;
     1846    10108    3           RETURN;
     1847    10109    3           END;
     1848    10110        /**/
     1849    10111    2        SEED = 0;
     1850    10112    2        TEMP_COUNT = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.NSUBLKS - 1;
             10112                 /* NUMBER OF DIGITS */
     1851    10113    2        TEMP_CLMN = 1;                     /* MULTIPLIER                         */
     1852    10114        /**/
     1853    10115    3        DO I = 0 TO TEMP_COUNT;
     1854    10116    3           SEED = SEED + (TEMP_CLMN * (( BLK$ -> OUT$BLK.SUBLK$(1) ->
     1855    10117    3              OUT$BLK.SUBLK$(TEMP_COUNT-I) -> OUT$BLK.CODE) - PC_OCTOFFSET));
     1856    10118    3           TEMP_CLMN = TEMP_CLMN*8;
     1857    10119    3           END;
     1858    10120    2        RETURN;
     1859    10121    2   END;
     1860    10122        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:62   
     1861    10123        /**/
     1862    10124    1   CHECK_EDIT: PROC ALTRET;
     1863    10125        /**/
     1864    10126    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_EDIT_ALT);
     1865    10127        /**/
     1866    10128    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */
     1867    10129        /**/
     1868    10130    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN ALTRETURN ; /* No file named. */
     1869    10131        /**/
     1870    10132    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> ED_CMD_TBL);
     1871    10133    2        CMD$ -> ED_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);
     1872    10134    2        RETURN;
     1873    10135        /**/
     1874    10136    2   CHECK_EDIT_ALT:
     1875    10137    2        ALTRETURN;
     1876    10138    2   END;                                    /* END CHECK_EDIT                     */
     1877    10139        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:63   
     1878    10140        /**/
     1879    10141    1   CHECK_END: PROC ALTRET;                 /* END,X                              */
     1880    10142        /**/
     1881    10143    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_END_ALT);
     1882    10144        /**/
     1883    10145    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CMD_CNTRLWD);
     1884    10146    2        RETURN;
     1885    10147        /**/
     1886    10148    2   CHECK_END_ALT:
     1887    10149    2        ALTRETURN;
     1888    10150    2   END;
     1889    10151        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:64   
     1890    10152        /**/
     1891    10153    1   CHECK_LIST: PROC ALTRET;                /* LIST                               */
     1892    10154        /**/
     1893    10155    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_LIST_ALT);
     1894    10156        /**/
     1895    10157    3        IF (CMD_INDEX < CMD_SIZE) THEN DO;
     1896    10158    3           CALL VEX$ERROR (E$E_NOTCOMP,3); /* CANT COMPOUND                   */
     1897    10159    3           ALTRETURN;
     1898    10160    3           END;
     1899    10161        /**/
     1900    10162    2        TYPE_BUF.TEXT = P_PCB.TEXT$ -> CMD$BUF; /* TEXTC TO PCL               */
     1901    10163    2        TYPE_BUF.VFC = BINASC(P_PCB.NCHARS);
     1902    10164        /**/
     1903    10165    2        CALL M$LINK(PCLLINK_FPT) ALTRET (LINK_ERR);
     1904    10166        /**/
     1905    10167    2        TYPE_BUF.VFC = %VFC_S1A;
     1906    10168    2        ALTRETURN;                         /* ALWAYS ALTRETURN - LIST ANYTIME    */
     1907    10169        /**/
     1908    10170    2   LINK_ERR:
     1909    10171    2        IF B$JIT$->B$JIT.CPFLAGS1 & %CP_EXIT#
     1910    10172    2        THEN                               /* LINK target EXITed NORMALLY.  */
     1911    10173    2           CALL VEX$ERROR_NO_PRINT(0,3) ;  /* Just set-up error for '?'.    */
     1912    10174    2        ELSE                               /* LINK target ALTRETed to EDIT. */
     1913    10175    2           CALL VEX$ERROR (0,3);           /* Put out error message.        */
     1914    10176    2        TYPE_BUF.VFC = %VFC_S1A;
     1915    10177        /**/
     1916    10178    2   CHECK_LIST_ALT:
     1917    10179    2        ALTRETURN;
     1918    10180    2   END;
     1919    10181        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:65   
     1920    10182        /**/
     1921    10183    1   CHECK_MERGE: PROC ALTRET;
     1922    10184        /**/
     1923    10185    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_MERGE_ALT);
     1924    10186        /**/
     1925    10187        /**/
     1926    10188    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */
     1927    10189        /**/
     1928    10190    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> M_CMD_TBL);
     1929    10191    2        CMD$ -> M_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);
     1930    10192        /**/
     1931    10193    2        I = 2;
     1932    10194    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);
     1933    10195    3        IF (BLK$ -> OUT$BLK.CODE = PC_SEQRANGE) THEN DO; /* 'MERGE FID,X-Y ...' CASE */
     1934    10196    3           CALL VEX$PARSE_SEQRANGE(CMD$ -> M_CMD_TBL.LO_SEQNUM,
     1935    10197    3              CMD$ -> M_CMD_TBL.HI_SEQNUM,BLK$)
     1936    10198    3              ALTRET (CHECK_MERGE_ALT);
     1937    10199    3           I = 3;
     1938    10200    3           END;
     1939    10201    3        ELSE DO;
     1940    10202    3           CMD$ -> M_CMD_TBL.LO_SEQNUM.KEY = Y003;
     1941    10203    3           CMD$ -> M_CMD_TBL.HI_SEQNUM.KEY = MAX_SEQNUM;
     1942    10204    3           END;
     1943    10205        /**/
     1944    10206    2        BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(I); /* INTO/ON/OVER */
     1945    10207        /**/
     1946    10208    2        IF (BLK$ -> OUT$BLK.CODE = PC_ON) THEN
     1947    10209    2           CMD$ -> M_CMD_TBL.ONOVER = %ERROR#;
     1948    10210    2        ELSE IF (BLK$ -> OUT$BLK.CODE = PC_INTO) THEN
     1949    10211    2              CMD$ -> M_CMD_TBL.ONOVER = %OLDFILE#;
     1950    10212    2           ELSE CMD$ -> M_CMD_TBL.ONOVER = %NEWFILE#;
     1951    10213        /**/
     1952    10214    2        I = I + 1;                         /* Increment to FID2 */
     1953    10215    2        BLK$ = P_PCB.OUT$;
     1954    10216    2        CMD$ -> M_CMD_TBL.FID2$ = BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0);
     1955    10217    2        CALL VEX$PARSE_SEQRANGE(CMD$ -> M_CMD_TBL.LO_SEQNUM2,
     1956    10218    2           CMD$ -> M_CMD_TBL.HI_SEQNUM2,BLK$ -> OUT$BLK.SUBLK$(I+1))
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:66   
     1957    10219    2           ALTRET (CHECK_MERGE_ALT);
     1958    10220    3        IF (BLK$ -> OUT$BLK.NSUBLKS = I+2) THEN DO; /* NO INCR GIVEN          */
     1959    10221    3           CMD$ -> M_CMD_TBL.INCR = DFLT_INCR ;
     1960    10222    3           RETURN;
     1961    10223    3           END;
     1962    10224        /**/
     1963    10225    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+2); /* POINT TO INCR BLOCK            */
     1964    10226    2        CALL VEX$BUILD_SEQNUM(EXEC_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(0))
     1965    10227    2           ALTRET(CHECK_MERGE_ALT);
     1966    10228    2        DFLT_INCR = EXEC_SEQNUM - Y003;
     1967    10229    2        CMD$ -> M_CMD_TBL.INCR = DFLT_INCR ;
     1968    10230    2        RETURN;
     1969    10231        /**/
     1970    10232        /**/
     1971    10233    2   CHECK_MERGE_ALT:
     1972    10234    2        ALTRETURN;
     1973    10235    2   END;                                    /* END CHECK_MERGE                    */
     1974    10236        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:67   
     1975    10237        /**/
     1976    10238    1   CHECK_READ: PROC ALTRET;
     1977    10239        /**/
     1978    10240    2        CALL VEX$CHECK_FIRST ALTRET(CHECK_READ_ALT);
     1979    10241        /**/
     1980    10242    2        CALL VEX$FID_2_FPT(BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0),
     1981    10243    2           OPEN_SIREAD_FPT,1) ALTRET(CHECK_READ_ALT);
     1982    10244        /**/
     1983    10245    2        CALL M$GETDCB(GETDCB_FPT) ALTRET(CHECK_READ_RELDCB_ERR) ;
     1984    10246    2        OPEN_SIREAD_FPT.V.DCB# = IN_DCBNUM ;
     1985    10247
     1986    10248    2   CHECK_READ_RETRY_OPEN:
     1987    10249    2        CALL M$OPEN(OPEN_SIREAD_FPT) ALTRET(CHECK_READ_ERR);
     1988    10250    2        RETURN;
     1989    10251        /**/
     1990    10252    2   CHECK_READ_ERR:
     1991    10253    2        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# = %E$DCBOPEN
     1992    10254    2        THEN
     1993    10255    3        DO ;
     1994    10256    3           CLOSE_SIREAD_FPT.V.DCB# = IN_DCBNUM ;
     1995    10257    3           CALL M$CLOSE(CLOSE_SIREAD_FPT) ALTRET (CHECK_READ_CLOSE_ERR) ;
     1996    10258
     1997    10259    3   CHECK_READ_CLOSE_ERR:
     1998    10260    3           GOTO CHECK_READ_RETRY_OPEN ;
     1999    10261    3           END ;                           /* THEN DO */
     2000    10262    2        CALL VEX$ERROR(0,3);
     2001    10263    2        RELDCB_FPT.V.DCB# = IN_DCBNUM ;
     2002    10264    2        CALL M$RELDCB(RELDCB_FPT) ALTRET(CHECK_READ_RELDCB_ERR) ;
     2003    10265
     2004    10266    2   CHECK_READ_RELDCB_ERR:
     2005    10267    2        IN_DCBNUM = SI_DCBNUM ;
     2006    10268    2   CHECK_READ_ALT:
     2007    10269    2        ALTRETURN;
     2008    10270    2   END;
     2009    10271        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:68   
     2010    10272        /**/
     2011    10273    1   CHECK_STATUS: PROC ALTRET;
     2012    10274        /**/
     2013    10275    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> TA_CMD_TBL);
     2014    10276        /**/
     2015    10277    3        DO I = 0 TO BLK$ -> OUT$BLK.NSUBLKS-1;
     2016    10278    3           CMD$ -> TA_CMD_TBL.TABS(I) = BLK$ -> OUT$BLK.SUBLK$(I) ->
     2017    10279    3              OUT$BLK.CODE - FIRSTSTATUS;
     2018    10280    3           END;
     2019    10281    2        CMD$ -> TA_CMD_TBL.NUM_TABS = I;
     2020    10282    2        RETURN;
     2021    10283    2   END;
     2022    10284        /**/
     2023    10285        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:69   
     2024    10286        /**/
     2025    10287    1   CHECK_TA: PROC ALTRET;
     2026    10288        /**/
     2027    10289    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TA_ALT);
     2028    10290        /**/
     2029    10291    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> TA_CMD_TBL);
     2030    10292    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);  /* POINT TO OPTION                  */
     2031    10293        /**/
     2032    10294    3        DO CASE(BLK$ -> OUT$BLK.CODE);
     2033    10295    3        CASE (PC_FTAB);
     2034    10296    3           CMD$ -> TA_CMD_TBL.TABS(0) = 7;
     2035    10297    3           CMD$ -> TA_CMD_TBL.TABS(1) = 16;
     2036    10298    3           CMD$ -> TA_CMD_TBL.TABS(2) = 34;
     2037    10299    3           NUM_TABS = 3;
     2038    10300        /**/
     2039    10301    3        CASE (PC_ATAB);
     2040    10302    3           CMD$ -> TA_CMD_TBL.TABS(0) = 8;
     2041    10303    3           CMD$ -> TA_CMD_TBL.TABS(1) = 16;
     2042    10304    3           CMD$ -> TA_CMD_TBL.TABS(2) = 32;
     2043    10305    3           NUM_TABS = 3;
     2044    10306        /**/
     2045    10307    3        CASE (PC_CTAB);
     2046    10308    3           CMD$ -> TA_CMD_TBL.TABS(0) = 8;
     2047    10309    3           CMD$ -> TA_CMD_TBL.TABS(1) = 12;
     2048    10310    3           CMD$ -> TA_CMD_TBL.TABS(2) = 36;
     2049    10311    3           NUM_TABS = 3;
     2050    10312        /**/
     2051    10313    3        CASE (PC_TABLIST);
     2052    10314    4           IF (BLK$ -> OUT$BLK.NSUBLKS > 31) THEN DO;
     2053    10315    4              CALL VEX$ERROR(E$E_BADTAB,2);
     2054    10316    4              ALTRETURN;
     2055    10317    4              END;
     2056    10318        /**/
     2057    10319        /*E*     ERROR:    VEE-E$E_BADTAB-0
     2058    10320                 MESSAGE:  Illegal tab specification
     2059    10321                 MESSAGE1: Either too many or out of order tab stops were requested
     2060    10322                 DESCRIPTION:   ILLEGAL TABS STOPS INPUT           */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:70   
     2061    10323        /**/
     2062    10324    4           DO I = 0 TO BLK$ -> OUT$BLK.NSUBLKS-1;
     2063    10325    4              CALL CHARBIN(TEMP_COUNT,SUBSTR(BLK$ -> OUT$BLK.SUBLK$(I)
     2064    10326    4                 -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2065    10327    4                 BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0)
     2066    10328    4                 -> STR$BUF.COUNT));
     2067    10329        /**/
     2068    10330    4              CMD$ -> TA_CMD_TBL.TABS(I) = TEMP_COUNT;
     2069    10331        /**/
     2070    10332    5              IF (I ~= 0) THEN DO;
     2071    10333    6                 IF (TEMP_COUNT <= CMD$ -> TA_CMD_TBL.TABS(I-1)) THEN DO;
     2072    10334    6                    CALL VEX$ERROR(E$E_BADTAB,2);
     2073    10335    6                    ALTRETURN;
     2074    10336    6                    END;
     2075    10337    5                 ELSE;
     2076    10338    5                 END;
     2077    10339    5              ELSE IF (TEMP_COUNT = 0) THEN DO;
     2078    10340    6                    IF (BLK$ -> OUT$BLK.NSUBLKS ~= 1) THEN DO;
     2079    10341    6                       CALL VEX$ERROR(E$E_BADTAB,2);
     2080    10342    6                       ALTRETURN;
     2081    10343    6                       END;
     2082    10344    6                    ELSE DO;               /* TA 0 - RESET TABS                  */
     2083    10345    6                       NUM_TABS = 0;
     2084    10346    6                       RETURN;
     2085    10347    6                       END;
     2086    10348    5                    END;
     2087    10349    4              END;
     2088    10350    3           NUM_TABS = BLK$ -> OUT$BLK.NSUBLKS;
     2089    10351    3        END;
     2090    10352        /**/
     2091    10353    2        RETURN;
     2092    10354        /**/
     2093    10355    2   CHECK_TA_ALT:
     2094    10356    2        ALTRETURN;
     2095    10357    2   END;
     2096    10358        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:71   
     2097    10359        /**/
     2098    10360    1   CHECK_TYPE: PROC ALTRET;
     2099    10361        /**/
     2100    10362    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(TYPE_CMD_TBL);
     2101    10363        /**/
     2102    10364    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT)
     2103    10365    3           > 2 THEN DO;
     2104    10366    3           CALL VEX$ERROR (E$E_BADTYPE,2);
     2105    10367    3           ALTRETURN;
     2106    10368    3           END;
     2107    10369        /**/
     2108    10370        /*E*     ERROR:    VEE-E$E_BADTYPE-0
     2109    10371                 MESSAGE:  File type code is limited to two(2) characters
     2110    10372                 DESCRIPTION: A file type code of more than two characters
     2111    10373                           was input.
     2112    10374        */
     2113    10375        /**/
     2114    10376    2        CMD$ -> TYPE_CMD_TBL.CODE = SUBSTR (BLK$ -> OUT$BLK.SUBLK$(1) ->
     2115    10377    2           OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,BLK$ -> OUT$BLK.SUBLK$(1)
     2116    10378    2           -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     2117    10379    2        RETURN;
     2118    10380    2   END;
     2119    10381        /**/
     2120    10382        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:72   
     2121    10383        /**/
     2122    10384    1   CHECK_VE: PROC ALTRET;
     2123    10385        /**/
     2124    10386    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_VE_ALT);
     2125    10387        /**/
     2126    10388    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(VE_CMD_TBL);
     2127    10389        /**/
     2128    10390    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_OFF) THEN
     2129    10391    2           CMD$ -> VE_CMD_TBL.TYPE = 0;
     2130    10392    2        ELSE CMD$ -> VE_CMD_TBL.TYPE = BLK$ -> OUT$BLK.SUBLK$(1) ->
     2131    10393    2              OUT$BLK.CODE;
     2132    10394    2        RETURN;
     2133    10395        /**/
     2134    10396    2   CHECK_VE_ALT:
     2135    10397    2        ALTRETURN;
     2136    10398    2   END;
     2137    10399        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:73   
     2138    10400        /**/
     2139    10401    1   CHECK_HELP: PROC ALTRET;
     2140    10402        /**/
     2141    10403    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_HELP_ALT);
     2142    10404        /**/
     2143    10405    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> HELP_CMD_TBL);
     2144    10406    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN
     2145    10407    2           CMD$ -> HELP_CMD_TBL.CMD_CODE = 0; /* FIRST LEVEL HELP             */
     2146    10408    2        ELSE CMD$ -> HELP_CMD_TBL.CMD_CODE = BLK$ -> OUT$BLK.SUBLK$(1)
     2147    10409    2              -> OUT$BLK.CODE;
     2148    10410    2        RETURN;
     2149    10411        /**/
     2150    10412    2   CHECK_HELP_ALT:
     2151    10413    2        ALTRETURN;
     2152    10414    2   END;                                    /* END CHECK_HELP                     */
     2153    10415        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:74   
     2154    10416        /**/
     2155    10417    1   CHECK_CM: PROC ALTRET;                  /* CM,CT                              */
     2156    10418        /**/
     2157    10419    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2158    10420    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2159    10421        /**/
     2160    10422        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2161    10423                 DESCRIPTION: A record oriented command has been received
     2162    10424                           without a file open to edit.
     2163    10425        */
     2164    10426    3           ALTRETURN;
     2165    10427    3           END;
     2166    10428        /**/
     2167    10429    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_CM_ALT);
     2168    10430        /**/
     2169    10431    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CM_CMD_TBL);
     2170    10432        /**/
     2171    10433    2        CALL VEX$BUILD_SEQNUM(CMD$ -> CM_CMD_TBL.SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2172    10434    2           ALTRET (CHECK_CM_ALT);
     2173    10435        /**/
     2174    10436    2        CALL VEX$PARSE_CLMNRANGE (CMD$ -> CM_CMD_TBL.LO_CLMN,
     2175    10437    2           CMD$ -> CM_CMD_TBL.HI_CLMN,BLK$ -> OUT$BLK.SUBLK$(2))
     2176    10438    2           ALTRET (CHECK_CM_ALT);
     2177    10439    2        RETURN;
     2178    10440        /**/
     2179    10441    2   CHECK_CM_ALT:
     2180    10442    2        ALTRETURN;
     2181    10443    2   END;
     2182    10444        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:75   
     2183    10445        /**/
     2184    10446    1   CHECK_DE: PROC ALTRET;                  /* DE,RR,AD                           */
     2185    10447        /**/
     2186    10448    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2187    10449    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2188    10450        /**/
     2189    10451        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2190    10452                 DESCRIPTION: A record oriented command has been received
     2191    10453                           without a file open to edit.
     2192    10454        */
     2193    10455    3           ALTRETURN;
     2194    10456    3           END;
     2195    10457        /**/
     2196    10458    3        IF (CMD_CODE = DECMD)AND(FLAGS.CONSEC_MODE) THEN DO;
     2197    10459    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2198    10460    3           ALTRETURN;
     2199    10461    3           END;
     2200    10462        /**/
     2201    10463        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2202    10464                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2203    10465        /**/
     2204    10466    3        IF (CMD_CODE = RRCMD) THEN DO;
     2205    10467    4           IF (B$JIT$ -> B$JIT.MODE = %M_BATCH#) THEN DO;
     2206    10468    4              CALL VEX$ERROR(E$E_NOBATCHRR,3);
     2207    10469    4              ALTRETURN;
     2208    10470    4              END;
     2209    10471    3           LAST_TYPE_CMD = RRCMD;
     2210    10472    3           END;
     2211    10473        /**/
     2212    10474        /*E*    ERROR:   VEE-E$E_NOBATCHRR-0
     2213    10475                MESSAGE: The RR command is not allowed in batch.
     2214    10476                DESCRIPTION: CAN'T USE FRONT END EDITTING IN BATCH  */
     2215    10477    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);
     2216    10478        /**/
     2217    10479    2        I = 1;
     2218    10480    2        IF ((BLK$ -> OUT$BLK.NSUBLKS > 1) AND
     2219    10481    2           ( BLK$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = PC_SEQRANGE)) THEN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:76   
     2220    10482    3           IF ((FLAGS.STEP_MODE)) THEN DO;
     2221    10483    3              CALL VEX$ERROR(E$E_NOSEQRNGE,2);
     2222    10484    3              ALTRETURN;
     2223    10485    3              END;
     2224    10486        /**/
     2225    10487        /*E*     ERROR:    VEE-E$E_NOSEQRNGE-0
     2226    10488                 DESCRIPTION:   A DE,RR,AD command with a sequence number range was
     2227    10489                           input while in step mode.
     2228    10490        */
     2229    10491        /**/
     2230    10492    3           ELSE DO;                        /* Validate SEQRANGE */
     2231    10493    3              CALL VEX$CHECK_FIRST ALTRET (CHECK_DE_ALT);
     2232    10494        /**/
     2233    10495    3              CALL VEX$PARSE_SEQRANGE(CMD$ -> IN_CMD_TBL.LO_SEQNUM,
     2234    10496    3                 CMD$ -> IN_CMD_TBL.HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2235    10497    3                 ALTRET (CHECK_DE_ALT);
     2236    10498    3              I = 2  ;
     2237    10499    3              END;
     2238    10500    2        ELSE
     2239    10501    2           FLAGS.INTRA_CMD = TRUE;
     2240    10502        /**/
     2241    10503        /*  SEE IF WE HAVE A COLUMN SPECIFIED */
     2242    10504    3        IF (BLK$ -> OUT$BLK.NSUBLKS = I + 1) THEN DO;/* HAVE A COLUMN */
     2243    10505    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(I) ;
     2244    10506    3           I = BLK$ -> OUT$BLK.NSUBLKS - 1;
     2245    10507    3           CALL CHARBIN(CMD$ -> IN_CMD_TBL.COLUMN,SUBSTR(
     2246    10508    3              BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2247    10509    3              BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT));
     2248    10510    3           IF (I = 1) THEN                 /* NEGATE IT */
     2249    10511    3              CMD$ -> IN_CMD_TBL.COLUMN = -CMD$ -> IN_CMD_TBL.COLUMN ;
     2250    10512    3           END;                            /* HAVE COLUMN */
     2251    10513    2        ELSE
     2252    10514    2           CMD$ -> IN_CMD_TBL.COLUMN = 0;
     2253    10515    2        RETURN;
     2254    10516        /**/
     2255    10517    2   CHECK_DE_ALT:
     2256    10518    2        ALTRETURN;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:77   
     2257    10519    2   END;
     2258    10520        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:78   
     2259    10521        /**/
     2260    10522    1   CHECK_IN: PROC ALTRET;                  /* IN,IP,IS                           */
     2261    10523        /**/
     2262    10524    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2263    10525    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2264    10526        /**/
     2265    10527        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2266    10528                 DESCRIPTION: A record oriented command has been received
     2267    10529                           without a file open to edit.
     2268    10530        */
     2269    10531    3           ALTRETURN;
     2270    10532    3           END;
     2271    10533        /**/
     2272    10534    2        IF (CMD_CODE ~= APCMD)AND(CMD_CODE ~= INCMD)AND
     2273    10535    3           (CMD_CODE ~= ISCMD)AND(FLAGS.CONSEC_MODE) THEN DO;
     2274    10536    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2275    10537    3           ALTRETURN;
     2276    10538    3           END;
     2277    10539        /**/
     2278    10540        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2279    10541                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2280    10542        /**/
     2281    10543    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_IN_ALT);
     2282    10544        /**/
     2283    10545    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);
     2284    10546    2        CMD$ -> IN_CMD_TBL.START_SPEC = 0; /* ASSUME NOT HERE */
     2285    10547        /**/
     2286    10548    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO;
     2287    10549    3           IF (CMD_CODE = IBCMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = LO_SEQNUM;
     2288    10550    3           ELSE IF (CMD_CODE = IACMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;
     2289    10551    4              ELSE DO;
     2290    10552    4                 CALL VEX$READ_RANDOM(HI_SEQNUM) ALTRET (CHECK_IN_ALT);
     2291    10553    4                 IF (FLAGS.EXISTS)
     2292    10554    4                 THEN
     2293    10555    5                 DO ;
     2294    10556    5                    CALL VEX$GET_NEXT_KEY ALTRET(CHECK_IN_ALT) ;
     2295    10557    5                    IF CMD_CODE ~= APCMD AND
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:79   
     2296    10558    5                       LAST_KEY <= HI_SEQNUM + DFLT_INCR AND
     2297    10559    5                       NOT FLAGS.EOF
     2298    10560    5                    THEN
     2299    10561    6                    DO ;
     2300    10562    6                       CALL VEX$ERROR(E$E_NOROOM,3) ;
     2301    10563    6                       ALTRETURN ;
     2302    10564    6                       END ;               /* Then Do */
     2303    10565    5                    CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM +
     2304    10566    5                       DFLT_INCR ;
     2305    10567    5                    END ;                  /* Then Do */
     2306    10568    4                 ELSE CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;
     2307    10569    4                 END;
     2308    10570    3           CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;
     2309    10571    3           RETURN;
     2310    10572    4           DO WHILE('0'B) ;
     2311    10573    4   CHECK_IN_NOROOM:
     2312    10574    4              CALL VEX$ERROR(E$E_NOROOM,3) ;
     2313    10575    4              ALTRETURN ;
     2314    10576    4              END ;                        /* DO WHILE */
     2315    10577        /**/
     2316    10578        /*E*     ERROR:    VEE-E$E_NOROOM-0
     2317    10579                 DESCRIPTION: THE HOLE TO PUT RECORDS IN HASN'T EVEN ENOUGH
     2318    10580                           ROOM FOR A SINGLE ONE         */
     2319    10581        /**/
     2320    10582    3           END;
     2321    10583        /**/
     2322    10584    3        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_INCR) THEN DO;
     2323    10585    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(1); /* POINT TO INCR BLOCK       */
     2324    10586    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))
     2325    10587    3              ALTRET (CHECK_IN_ALT);
     2326    10588    3           DFLT_INCR = DFLT_INCR - Y003;
     2327    10589    4           IF (FLAGS.CONSEC_MODE)AND(DFLT_INCR ~= 1000) THEN DO;
     2328    10590    4              CALL VEX$ERROR(E$CANONLYINCR1,1);
     2329    10591    4              DFLT_INCR = 1000;
     2330    10592    4              END;
     2331    10593        /**/
     2332    10594        /*E*     ERROR:     VEE-E$CANONLYINCR1-0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:80   
     2333    10595                 MESSAGE: Non Keyed files can only increment keys by 1, 1 Assumed.
     2334    10596                 DESCRIPTION:  User specified an INCRement other than 1 for a
     2335    10597                               Consecutive file, so I politely change it.
     2336    10598        */
     2337    10599        /**/
     2338    10600    3           IF (CMD_CODE = APCMD) OR (FLAGS.CONSEC_MODE)
     2339    10601    3           THEN
     2340    10602    4           DO ;
     2341    10603    4              CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR ;
     2342    10604                                           /* File Positioning done in VER$EXEC_IN */
     2343    10605    4              RETURN ;
     2344    10606    4              END ;                        /* Then Do */
     2345    10607    3           IF (CMD_CODE = IBCMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = LO_SEQNUM;
     2346    10608    4           ELSE DO;
     2347    10609    4              CALL VEX$READ_RANDOM(HI_SEQNUM) ALTRET (CHECK_IN_ALT);
     2348    10610    4              IF (FLAGS.EXISTS) AND (CMD_CODE ~= IACMD)
     2349    10611    4              THEN
     2350    10612    5              DO ;                         /* Is there any room? */
     2351    10613    5                 CALL VEX$READ_SEQUEN ALTRET(CHECK_IN_ALT) ;
     2352    10614    5                 IF (FLAGS.EOF)
     2353    10615    5                 THEN LAST_KEY = MAX_SEQNUM ;
     2354    10616    5                 IF LAST_KEY <= HI_SEQNUM + DFLT_INCR
     2355    10617    5                 THEN GOTO CHECK_IN_NOROOM ;
     2356    10618    5                 CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM +
     2357    10619    5                    DFLT_INCR ;
     2358    10620    5                 END ;                     /* THEN DO */
     2359    10621    4              ELSE CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;
     2360    10622    4              END;
     2361    10623    3           CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;
     2362    10624    3           RETURN;
     2363    10625    3           END;
     2364    10626        /**/
     2365    10627        /**/
     2366    10628    2        CMD$ -> IN_CMD_TBL.START_SPEC = 1; /* USER SPECIFIED A START */
     2367    10629        /**/
     2368    10630    2        CALL VEX$BUILD_SEQNUM(CMD$ -> IN_CMD_TBL.LO_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2369    10631    2           ALTRET (CHECK_IN_ALT);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:81   
     2370    10632        /**/
     2371    10633    2        IF (FLAGS.CONSEC_MODE)AND(M$FILE$->F$DCB.NRECS >=
     2372    10634    3           ((CMD$->IN_CMD_TBL.LO_SEQNUM-Y003)/1000)) THEN DO;
     2373    10635    3           CALL VEX$ERROR(E$INNOTALLOWED,1);
     2374    10636    3           ALTRETURN;
     2375    10637    3           END;
     2376    10638        /**/
     2377    10639        /*E*     ERROR:     VEE-E$INNOTALLOWED-0
     2378    10640                 MESSAGE: IN/IS on non keyed file must start past end of file
     2379    10641                 DESCRIPTION:  You can only INsert at the end of the file
     2380    10642        */
     2381    10643        /**/
     2382    10644    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 3) THEN DO;
     2383    10645    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(2); /* POINT TO INCR BLOCK       */
     2384    10646    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))
     2385    10647    3              ALTRET (CHECK_IN_ALT);
     2386    10648    3           DFLT_INCR = DFLT_INCR - Y003;
     2387    10649    3           END;
     2388    10650    3        IF (FLAGS.CONSEC_MODE)AND(DFLT_INCR ~= 1000) THEN DO;
     2389    10651    3           CALL VEX$ERROR(E$CANONLYINCR1,1);
     2390    10652    3           DFLT_INCR=1000;
     2391    10653    3           END;
     2392    10654        /**/
     2393    10655    2        CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;
     2394    10656    2        RETURN;
     2395    10657        /**/
     2396    10658    2   CHECK_IN_ALT:
     2397    10659    2        ALTRETURN;
     2398    10660    2   END;
     2399    10661        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:82   
     2400    10662        /**/
     2401    10663    1   CHECK_MK: PROC ALTRET;                  /* MK,MD                              */
     2402    10664        /**/
     2403    10665    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2404    10666    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2405    10667        /**/
     2406    10668        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2407    10669                 DESCRIPTION: A record oriented command has been received
     2408    10670                           without a file open to edit.
     2409    10671        */
     2410    10672    3           ALTRETURN;
     2411    10673    3           END;
     2412    10674        /**/
     2413    10675    3        IF (FLAGS.CONSEC_MODE) THEN DO;
     2414    10676    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2415    10677    3           ALTRETURN;
     2416    10678    3           END;
     2417    10679        /**/
     2418    10680        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2419    10681                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2420    10682        /**/
     2421    10683    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_MK_ALT);
     2422    10684        /**/
     2423    10685    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> MK_CMD_TBL);
     2424    10686        /**/
     2425    10687    2        CALL VEX$PARSE_SEQRANGE (CMD$ -> MK_CMD_TBL.LO_SEQNUM,
     2426    10688    2           CMD$ -> MK_CMD_TBL.HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2427    10689    2           ALTRET (CHECK_MK_ALT);
     2428    10690        /**/
     2429    10691    2        CALL VEX$PARSE_SEQRANGE (CMD$ -> MK_CMD_TBL.LO_SEQNUM2,
     2430    10692    2           CMD$ -> MK_CMD_TBL.HI_SEQNUM2,BLK$ -> OUT$BLK.SUBLK$(2))
     2431    10693    2           ALTRET (CHECK_MK_ALT);
     2432    10694        /**/
     2433    10695    2        IF (((CMD$ -> MK_CMD_TBL.LO_SEQNUM2 >= CMD$ -> MK_CMD_TBL.LO_SEQNUM)
     2434    10696    2           AND(CMD$ -> MK_CMD_TBL.LO_SEQNUM2 <= CMD$ -> MK_CMD_TBL.HI_SEQNUM))
     2435    10697    2           OR((CMD$ -> MK_CMD_TBL.HI_SEQNUM2 >= CMD$ -> MK_CMD_TBL.LO_SEQNUM)
     2436    10698    2           AND(CMD$ -> MK_CMD_TBL.HI_SEQNUM2 <= CMD$ -> MK_CMD_TBL.HI_SEQNUM)))
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:83   
     2437    10699    3        THEN DO;
     2438    10700    3           CALL VEX$ERROR(E$E_OVERLAP,3);
     2439    10701    3           ALTRETURN;
     2440    10702    3           END;
     2441    10703        /**/
     2442    10704        /*E*     ERROR:    VEE-E$E_OVERLAP-0
     2443    10705                 MESSAGE:  Range overlap
     2444    10706                 MESSAGE1: 'TO' and 'FROM' ranges may not overlap
     2445    10707                 DESCRIPTION:   The TO and FROM ranges for a MK/MD command
     2446    10708                           may not overlap.
     2447    10709        */
     2448    10710        /**/
     2449    10711    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 4) THEN DO; /* INCR GIVEN               */
     2450    10712    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(3); /* POINT TO INCR BLOCK           */
     2451    10713    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))
     2452    10714    3              ALTRET (CHECK_MK_ALT);
     2453    10715    3           DFLT_INCR = DFLT_INCR - Y003;
     2454    10716    3           END;
     2455    10717        /**/
     2456    10718    2        CMD$ -> MK_CMD_TBL.INCR = DFLT_INCR;
     2457    10719    2        RETURN;
     2458    10720        /**/
     2459    10721    2   CHECK_MK_ALT:
     2460    10722    2        ALTRETURN;
     2461    10723    2   END;
     2462    10724        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:84   
     2463    10725        /**/
     2464    10726    1   CHECK_RN: PROC ALTRET;                  /* RN                                 */
     2465    10727        /**/
     2466    10728    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2467    10729    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2468    10730        /**/
     2469    10731        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2470    10732                 DESCRIPTION: A record oriented command has been received
     2471    10733                           without a file open to edit.
     2472    10734        */
     2473    10735    3           ALTRETURN;
     2474    10736    3           END;
     2475    10737        /**/
     2476    10738    3        IF (FLAGS.CONSEC_MODE) THEN DO;
     2477    10739    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2478    10740    3           ALTRETURN;
     2479    10741    3           END;
     2480    10742        /**/
     2481    10743        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2482    10744                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2483    10745        /**/
     2484    10746    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_RN_ALT);
     2485    10747        /**/
     2486    10748    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);
     2487    10749        /**/
     2488    10750    2        CALL VEX$BUILD_SEQNUM (CMD$ -> IN_CMD_TBL.LO_SEQNUM,
     2489    10751    2           BLK$ -> OUT$BLK.SUBLK$(1)) ALTRET (CHECK_RN_ALT);
     2490    10752        /**/
     2491    10753    2        CALL VEX$BUILD_SEQNUM (CMD$ -> IN_CMD_TBL.HI_SEQNUM,
     2492    10754    2           BLK$ -> OUT$BLK.SUBLK$(2)) ALTRET (CHECK_RN_ALT);
     2493    10755    2        RETURN;
     2494    10756        /**/
     2495    10757    2   CHECK_RN_ALT:
     2496    10758    2        ALTRETURN;
     2497    10759    2   END;
     2498    10760        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:85   
     2499    10761        /**/
     2500    10762    1   CHECK_SE: PROC ALTRET;                  /* SE,SS,ST,FT,FS,FD,TY               */
     2501    10763        /**/
     2502    10764    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2503    10765    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2504    10766    3           ALTRETURN;
     2505    10767    3           END;
     2506    10768        /**/
     2507    10769        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2508    10770                 MESSAGE:  No file named
     2509    10771                 MESSAGE1: An intra-record or inter-record command has been
     2510    10772                           issued without a file open for editting
     2511    10773                 DESCRIPTION: A record oriented command was received
     2512    10774                           without a file open.
     2513    10775        */
     2514    10776        /**/
     2515    10777    3        IF (CMD_CODE = FDCMD)AND(FLAGS.CONSEC_MODE) THEN DO;
     2516    10778    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2517    10779    3           ALTRETURN;
     2518    10780    3           END;
     2519    10781        /**/
     2520    10782        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2521    10783                MESSAGE: Command not legal on non keyed files.
     2522    10784                MESSAGE1: Insert,delete and RP mode changes are not legal for
     2523    10785                          non keyed files.
     2524    10786                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2525    10787        /**/
     2526    10788    2        IF (CMD_CODE = TYCMD)OR(CMD_CODE = FTCMD) THEN
     2527    10789    2           LAST_TYPE_CMD = TYCMD;
     2528    10790    2        ELSE IF (CMD_CODE = FSCMD) THEN LAST_TYPE_CMD = TSCMD;
     2529    10791    3        IF ((CMD_CODE ~= TYCMD)OR(BLK$ -> OUT$BLK.NSUBLKS ~= 1)) THEN DO;
     2530    10792    3           CALL VEX$CHECK_FIRST ALTRET(CHECK_SE_ALT);
     2531    10793    3           SSE$ = ADDR(SSE_TBL);
     2532    10794    3           SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);
     2533    10795    3           STR_TEXT$ = STR_TEXT_HEAD$;     /* RESET TEXT SEG. PTRS               */
     2534    10796    3           STR_TEXT_SE$ = STR_TEXT_HEAD$;
     2535    10797    3           CALL VEX$CLMN_DFLT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:86   
     2536    10798    3           END;
     2537    10799    3        ELSE DO;                           /* INTRA RECORD TY                    */
     2538    10800    3           CMD_CODE = INTTYCMD;
     2539    10801    3           CMD$ -> CMD_CNTRLWD.CMD_CODE = INTTYCMD;
     2540    10802    3           END;
     2541    10803        /**/
     2542    10804    2        IF (CMD_CODE = SECMD) THEN FLAGS.NOCOMPCMD = FALSE; /* SE MAY BE COMPOUNDED */
     2543    10805        /**/
     2544    10806    2        IF ((CMD_CODE = TYCMD)OR(CMD_CODE = FTCMD)OR(CMD_CODE = FSCMD)OR
     2545    10807    2           (CMD_CODE = FDCMD)OR(CMD_CODE = INTTYCMD)) THEN
     2546    10808    2           CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);
     2547    10809    2        ELSE CMD$ -> CMD_CNTRLWD.OFFSET = 0; /* NO ENTRY IN CMD_TBL FOR       */
     2548    10810                                                /* SE,SS OR ST COMMAND                */
     2549    10811        /**/
     2550    10812    3        IF (CMD_CODE = SSCMD)OR(CMD_CODE = STCMD) THEN DO;
     2551    10813    3           FLAGS.STEP_MODE = TRUE;
     2552    10814    3           IF (CMD_CODE = STCMD) THEN FLAGS.ST_CMD = TRUE;
     2553    10815    3           ELSE FLAGS.ST_CMD = FALSE;
     2554    10816    3           END;
     2555    10817    2        ELSE FLAGS.INTRA_CMD = TRUE;
     2556    10818        /**/
     2557    10819    2        IF ((CMD_CODE = SECMD)OR(CMD_CODE = SSCMD)OR(CMD_CODE = STCMD))AND
     2558    10820    3           (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO; /* DEFAULT                   */
     2559    10821    3           LO_SEQNUM = Y003 ;
     2560    10822    3           HI_SEQNUM = MAX_SEQNUM ;
     2561    10823    3           RETURN;
     2562    10824    3           END;
     2563    10825        /**/
     2564    10826    2        IF (CMD_CODE = FDCMD) THEN FLAGS.DELRECCMD = TRUE;
     2565    10827        /**/
     2566    10828    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN RETURN;
     2567    10829        /**/
     2568    10830    2        CALL VEX$PARSE_SEQRANGE(LO_SEQNUM,HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2569    10831    2           ALTRET (CHECK_SE_ALT);
     2570    10832    2        IF ((LO_SEQNUM = HI_SEQNUM) AND ((CMD_CODE = SSCMD) OR
     2571    10833    2           (CMD_CODE = STCMD)))
     2572    10834    2        THEN HI_SEQNUM = MAX_SEQNUM ;      /* SS or ST to EOF. */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:87   
     2573    10835        /**/
     2574    10836        /**/                                    /* SS,ST TO EOF                       */
     2575    10837    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN;
     2576    10838    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);
     2577    10839    3        IF (BLK$ -> OUT$BLK.CODE = PC_SSE) THEN DO;
     2578    10840    3           I = 0;
     2579    10841    3           SSE$ -> SSE$PARAM.FLAGS = FALSE;
     2580    10842    3           SSE$ -> SSE$PARAM.FLAGS.ORFLAG = TRUE; /* FIRST OP. IS OR          */
     2581    10843    4           IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_NOT) THEN DO;
     2582    10844    4              SSE$ -> SSE$PARAM.FLAGS.NOTFLAG = TRUE;
     2583    10845    4              I = I+1;
     2584    10846    4              END;
     2585    10847    3           CALL VEX$PARSE_JSTRING (BLK$ -> OUT$BLK.SUBLK$(I),SSE$,J0NOTOK)
     2586    10848    3              ALTRET (CHECK_SE_ALT);
     2587    10849        /**/
     2588    10850    4           DO WHILE (BLK$ -> OUT$BLK.NSUBLKS > I+1); /* PROCESS ALL STRINGS   */
     2589    10851    4              SSE$  = PINCRW(SSE$,2);      /* NEXT BLOCK                         */
     2590    10852    4              SSE$ -> SSE$PARAM.FLAGS = FALSE;
     2591    10853    4              BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+1);
     2592    10854    4              I = 1;
     2593    10855    4              IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_AND)
     2594    10856    4              THEN SSE$ -> SSE$PARAM.FLAGS.ANDFLAG = TRUE;
     2595    10857    4              ELSE IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_OR)
     2596    10858    4                 THEN SSE$ -> SSE$PARAM.FLAGS.ORFLAG = TRUE;
     2597    10859    4                 ELSE SSE$ -> SSE$PARAM.FLAGS.EORFLAG = TRUE;
     2598    10860        /**/
     2599    10861    5              IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_NOT) THEN DO;
     2600    10862    5                 SSE$ -> SSE$PARAM.FLAGS.NOTFLAG = TRUE;
     2601    10863    5                 I = I+1;
     2602    10864    5                 END;
     2603    10865        /**/
     2604    10866    4              CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),SSE$,J0NOTOK)
     2605    10867    4                 ALTRET (CHECK_SE_ALT);
     2606    10868    4              END;
     2607    10869        /**/
     2608    10870    3           STR_TEXT_SE$ = STR_TEXT$;       /* SET STR_TEXT$ AFTER 'SE' TEXT      */
     2609    10871    3           SSE$ = PINCRW(SSE$,2);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:88   
     2610    10872    3           SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);
     2611    10873    3           IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 3) THEN RETURN;
             10873                    /* NO COLUMN RANGE GIVEN */
     2612    10874    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(3);
     2613    10875    3           END;
     2614    10876        /**/
     2615    10877    2        CALL VEX$PARSE_CLMNRANGE (LO_SRCH_CLMN,HI_SRCH_CLMN,BLK$)
     2616    10878    2           ALTRET (CHECK_SE_ALT);
     2617    10879    2        LO_EXEC_CLMN = LO_SRCH_CLMN;
     2618    10880    2        HI_EXEC_CLMN = HI_SRCH_CLMN;
     2619    10881        /**/
     2620    10882    2        RETURN;
     2621    10883        /**/
     2622    10884    2   CHECK_SE_ALT:
     2623    10885    2        ALTRETURN;
     2624    10886    2   END;
     2625    10887        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:89   
     2626    10888        /**/
     2627    10889    1   CHECK_TN: PROC ALTRET;
     2628    10890        /**/
     2629    10891    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2630    10892    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2631    10893        /**/
     2632    10894        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2633    10895                 DESCRIPTION: A record oriented command has been received
     2634    10896                           without a file open to edit.
     2635    10897        */
     2636    10898    3           ALTRETURN;
     2637    10899    3           END;
     2638    10900        /**/
     2639    10901    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(TN_CMD_TBL);
     2640    10902        /**/
     2641    10903    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TN_ALT);
     2642    10904        /**/
     2643    10905    2        CALL CHARBIN(CMD$ -> TN_CMD_TBL.COUNT,SUBSTR(
     2644    10906    2           BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2645    10907    2           BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT));
     2646    10908    2        RETURN;
     2647    10909        /**/
     2648    10910    2   CHECK_TN_ALT:
     2649    10911    2        ALTRETURN;
     2650    10912    2   END;
     2651    10913        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:90   
     2652    10914        /**/
     2653    10915    1   CHECK_TS: PROC ALTRET;                  /* TS,TC,TX,RF,NO,EI,RL,QR            */
     2654    10916        /**/
     2655    10917    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2656    10918    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2657    10919        /**/
     2658    10920        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2659    10921                 DESCRIPTION: A record oriented command has been received
     2660    10922                           without a file open to edit.
     2661    10923        */
     2662    10924    3           ALTRETURN;
     2663    10925    3           END;
     2664    10926        /**/
     2665    10927    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CMD_CNTRLWD);
     2666    10928    2        FLAGS.INTRA_CMD = TRUE;
     2667    10929        /**/
     2668    10930    2        IF (CMD_CODE = TYCMD) THEN LAST_TYPE_CMD = TYCMD;
     2669    10931    2        IF (CMD_CODE = TCCMD) THEN LAST_TYPE_CMD = TCCMD;
     2670    10932    2        IF (CMD_CODE = TSCMD) THEN LAST_TYPE_CMD = TSCMD;
     2671    10933        /**/
     2672    10934    2        IF (BLK$ -> OUT$BLK.NSUBLKS <= 1) THEN RETURN;
     2673    10935        /**/
     2674    10936    3        IF ((FLAGS.STEP_MODE)AND(BLK$ -> OUT$BLK.NSUBLKS > 1)) THEN DO;
     2675    10937    3           CALL VEX$ERROR(E$E_NOSEQRNGE,2);
     2676    10938    3           ALTRETURN;
     2677    10939    3           END;
     2678    10940        /**/
     2679    10941        /*E*     ERROR:    VEE-E$E_NOSEQRNGE-0
     2680    10942                 MESSAGE:  No sequence number range allowed here
     2681    10943                 DESCRIPTION:   A TY command with a range of sequence numbers was
     2682    10944                           input while in strp mode.
     2683    10945        */
     2684    10946        /**/
     2685    10947    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TS_ALT);
     2686    10948    2        CALL VEX$CLMN_DFLT;
     2687    10949    2        SSE$ = ADDR(SSE_TBL);
     2688    10950    2        SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:91   
     2689    10951        /**/
     2690    10952    2        FLAGS.NOCOMPCMD = TRUE;       /* INTER REC. TY,TS,TC NOT COMPOUNDABLE    */
     2691    10953        /**/
     2692    10954    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);
     2693    10955    3        IF (BLK$ -> OUT$BLK.CODE = PC_SEQRANGE) THEN DO;
     2694    10956    3           CALL VEX$PARSE_SEQRANGE(LO_SEQNUM,HI_SEQNUM,BLK$)
     2695    10957    3              ALTRET (CHECK_TS_ALT);
     2696    10958    3           IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN; /* NO CLMNRANGE GIVEN */
     2697    10959    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(2);
     2698    10960    3           END;
     2699    10961        /**/
     2700    10962        /**/
     2701    10963    2        CALL VEX$PARSE_CLMNRANGE(LO_SRCH_CLMN,HI_SRCH_CLMN,BLK$)
     2702    10964    2           ALTRET (CHECK_TS_ALT);
     2703    10965    2        LO_EXEC_CLMN = LO_SRCH_CLMN;
     2704    10966    2        HI_EXEC_CLMN = HI_SRCH_CLMN;
     2705    10967    2        RETURN;
     2706    10968        /**/
     2707    10969    2   CHECK_TS_ALT:
     2708    10970    2        ALTRETURN;
     2709    10971    2   END;
     2710    10972        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:92   
     2711    10973        /**/
     2712    10974    1   CHECK_A: PROC ALTRET;                   /* A                                  */
     2713    10975        /**/
     2714    10976    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2715    10977    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2716    10978        /**/
     2717    10979        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2718    10980                 DESCRIPTION: A record oriented command has been received
     2719    10981                           without a file open to edit.
     2720    10982        */
     2721    10983    3           ALTRETURN;
     2722    10984    3           END;
     2723    10985        /**/
     2724    10986    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);
     2725    10987    2        FLAGS.INTRA_CMD = TRUE;
     2726    10988    2        FLAGS.STRCHGCMD = TRUE;
     2727    10989        /**/
     2728    10990    2        P$ = PINCRW(CMD$,1);
     2729    10991    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0NOTOK)
     2730    10992    2           ALTRET (CHECK_A_ALT);
     2731    10993        /**/
     2732    10994    2        P$ = PINCRW(P$,2);                 /* POINT TO NEXT SSE$PARAM            */
     2733    10995    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(2),P$,J0NOTOK)
     2734    10996    2           ALTRET (CHECK_A_ALT);
     2735    10997    2        RETURN;
     2736    10998        /**/
     2737    10999    2   CHECK_A_ALT:
     2738    11000    2        ALTRETURN;
     2739    11001    2   END;
     2740    11002        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:93   
     2741    11003        /**/
     2742    11004    1   CHECK_CL: PROC ALTRET;
     2743    11005        /**/
     2744    11006    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2745    11007    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2746    11008        /**/
     2747    11009        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2748    11010                 DESCRIPTION: A record oriented command has been received
     2749    11011                           without a file open to edit.
     2750    11012        */
     2751    11013    3           ALTRETURN;
     2752    11014    3           END;
     2753    11015        /**/
     2754    11016    2        CMD$->CMD_CNTRLWD.OFFSET = SIZEW(CMD$->IN_CMD_TBL) ;
     2755    11017    2        CALL VEX$PARSE_CLMNRANGE(CMD$->IN_CMD_TBL.LO_SEQNUM ,
     2756    11018    2           CMD$->IN_CMD_TBL.HI_SEQNUM ,
     2757    11019    2           BLK$->OUT$BLK.SUBLK$(1))
     2758    11020    2           ALTRET(CHECK_CL_ALT) ;
     2759    11021    2        FLAGS.INTRA_CMD = TRUE ;
     2760    11022    2        LO_EXEC_CLMN = CMD$ -> IN_CMD_TBL.LO_SEQNUM ;
     2761    11023    2        HI_EXEC_CLMN = CMD$ -> IN_CMD_TBL.HI_SEQNUM ;
     2762    11024    2        RETURN;
     2763    11025        /**/
     2764    11026    2   CHECK_CL_ALT:
     2765    11027    2        ALTRETURN;
     2766    11028    2   END;
     2767    11029        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:94   
     2768    11030        /**/
     2769    11031    1   CHECK_CP: PROC ALTRET;
     2770    11032        /**/
     2771    11033    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2772    11034    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2773    11035    3           ALTRETURN;
     2774    11036    3           END;
     2775    11037        /**/
     2776    11038        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2777    11039                 DESCRIPTION: A record oriented command was received
     2778    11040                           without a file open.
     2779    11041        */
     2780    11042        /**/
     2781    11043    3        IF (FLAGS.CONSEC_MODE) THEN DO;
     2782    11044    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);
     2783    11045    3           ALTRETURN;
     2784    11046    3           END;
     2785    11047        /**/
     2786    11048        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2787    11049                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2788    11050        /**/
     2789    11051    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CP_CMD_TBL) ;
     2790    11052    2        FLAGS.INTRA_CMD = TRUE;
     2791    11053    2        CP_RECSMVED = 0;
     2792    11054        /**/
     2793    11055    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO;
     2794    11056    4           IF (CP_SEQNUM = BITBIN('003777777777'O)) THEN DO;
     2795    11057    4              CALL VEX$ERROR(E$E_NOCPSEQ,3);
     2796    11058    4              ALTRETURN;
     2797    11059    4              END;
     2798    11060        /**/
     2799    11061        /*E*    ERROR: VEE-E$E_NOCPSEQ-0
     2800    11062                MESSAGE: No sequence number specified for copy destination
     2801    11063                MESSAGE1: The first CP or CI command must specify a sequence number.
     2802    11064                DESCRIPTION: GAVE DEFAULT CP OR CI COMMAND FIRST TIME - ERROR  */
     2803    11065        /**/
     2804    11066    3           CP_SEQNUM = CP_SEQNUM + CP_DFLT_INCR;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:95   
     2805    11067    3           GOTO CP_LIMIT;
     2806    11068    3           END;
     2807    11069        /**/
     2808    11070    3        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_INCR) THEN DO;
     2809    11071    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(1); /* POINT TO INCR BLOCK           */
     2810    11072    3           CALL VEX$BUILD_SEQNUM(CP_DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))
     2811    11073    3              ALTRET (CHECK_CP_ALT);
     2812    11074    3           CP_DFLT_INCR = CP_DFLT_INCR - Y003;
     2813    11075    3           GOTO CP_LIMIT;
     2814    11076    3           END;
     2815    11077        /**/
     2816    11078    2        CALL VEX$BUILD_SEQNUM(CP_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2817    11079    2           ALTRET (CHECK_CP_ALT);
     2818    11080        /**/
     2819    11081    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 3) THEN DO;
     2820    11082    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(2); /* POINT TO INCR BLOCK           */
     2821    11083    3           CALL VEX$BUILD_SEQNUM(CP_DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))
     2822    11084    3              ALTRET (CHECK_CP_ALT);
     2823    11085    3           CP_DFLT_INCR = CP_DFLT_INCR - Y003;
     2824    11086    3           END;
     2825    11087        /**/
     2826    11088    2   CP_LIMIT:
     2827    11089    3        IF (CMD_CODE = CPCMD) THEN DO;
     2828    11090    3           CALL VEX$READ_RANDOM(CP_SEQNUM) ALTRET(CHECK_CP_ALT);
     2829    11091    4           IF (~FLAGS.EXISTS) THEN DO;
     2830    11092    4              CALL VEX$READ_SEQUEN ALTRET(CHECK_CP_ALT);
     2831    11093    4              IF (FLAGS.EOF) THEN LAST_KEY = MAX_SEQNUM + 1;
     2832    11094    4              END;
     2833    11095    3           CP_LIMIT_SEQNUM = LAST_KEY;
     2834    11096    3           CALL VEX$READ_RANDOM(LO_SEQNUM) ALTRET(CHECK_CP_ALT);
     2835    11097    3           END;
     2836    11098    2        ELSE CP_LIMIT_SEQNUM = MAX_SEQNUM + 1;
     2837    11099        /**/
     2838    11100    2        CP_SEQNUM = CP_SEQNUM - CP_DFLT_INCR; /* SET FOR FIRST WRITE          */
     2839    11101    2        IF ((BLK$->OUT$BLK.CODE = CPCMD) OR (BLK$->OUT$BLK.CODE = CICMD)) AND (BLK$->
             11101                 OUT$BLK.NSUBLKS = 1)
     2840    11102    2        THEN CMD$->CP_CMD_TBL.SEQNUM = 0 ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:96   
     2841    11103    2        ELSE CMD$->CP_CMD_TBL.SEQNUM = CP_SEQNUM ;
     2842    11104    2        CMD$->CP_CMD_TBL.INCR = CP_DFLT_INCR ;
     2843    11105    2        CMD$->CP_CMD_TBL.LIMIT_SEQNUM = CP_LIMIT_SEQNUM ;
     2844    11106    2        RETURN;
     2845    11107        /**/
     2846    11108    2   CHECK_CP_ALT:
     2847    11109    2        ALTRETURN;
     2848    11110    2   END;
     2849    11111        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:97   
     2850    11112        /**/
     2851    11113    1   CHECK_D: PROC ALTRET;                   /* D                                  */
     2852    11114        /**/
     2853    11115    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2854    11116    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2855    11117        /**/
     2856    11118        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2857    11119                 DESCRIPTION: A record oriented command has been received
     2858    11120                           without a file open to edit.
     2859    11121        */
     2860    11122    3           ALTRETURN;
     2861    11123    3           END;
     2862    11124        /**/
     2863    11125    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> D_CMD_TBL);
     2864    11126    2        FLAGS.INTRA_CMD = TRUE;
     2865    11127    2        FLAGS.STRCHGCMD = TRUE;
     2866    11128        /**/
     2867    11129    2        P$ = PINCRW(CMD$,1);
     2868    11130    2        CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK) ALTRET (CHECK_D_ALT);
     2869    11131    2        RETURN;
     2870    11132        /**/
     2871    11133    2   CHECK_D_ALT:
     2872    11134    2        ALTRETURN;
     2873    11135    2   END;
     2874    11136        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:98   
     2875    11137        /**/
     2876    11138    1   CHECK_E: PROC ALTRET;                   /* E,O,F,P                            */
     2877    11139        /**/
     2878    11140    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2879    11141    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2880    11142        /**/
     2881    11143        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2882    11144                 DESCRIPTION: A record oriented command has been received
     2883    11145                           without a file open to edit.
     2884    11146        */
     2885    11147    3           ALTRETURN;
     2886    11148    3           END;
     2887    11149        /**/
     2888    11150    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);
     2889    11151    2        FLAGS.INTRA_CMD = TRUE;
     2890    11152    2        FLAGS.STRCHGCMD = TRUE;
     2891    11153        /**/
     2892    11154    2        P$ = PINCRW(CMD$,1);
     2893    11155    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK)
     2894    11156    2           ALTRET (CHECK_E_ALT);
     2895    11157        /**/
     2896    11158    2        P$ = PINCRW(P$,2);
     2897    11159    2        CALL VEX$PARSE_STRING (BLK$ -> OUT$BLK.SUBLK$(2),P$)
     2898    11160    2           ALTRET (CHECK_E_ALT);           /*SBLK->STRINGBLK->SLSTRINGBLK        */
     2899    11161    2        RETURN;
     2900    11162        /**/
     2901    11163    2   CHECK_E_ALT:
     2902    11164    2        ALTRETURN;
     2903    11165    2   END;
     2904    11166        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:99   
     2905    11167        /**/
     2906    11168    1   CHECK_IF: PROC ALTRET;                  /* IF,EL                              */
     2907    11169        /**/
     2908    11170    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2909    11171    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2910    11172    3           ALTRETURN;
     2911    11173    3           END;
     2912    11174        /**/
     2913    11175        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2914    11176                 DESCRIPTION: A record oriented command was received
     2915    11177                           without a file open.
     2916    11178        */
     2917    11179        /**/
     2918    11180    2        IF_LEVEL = 0;
     2919    11181    2        CMD$ -> IF_CMD_TBL.LO_CLMN = 0;
     2920    11182    2        CMD$ -> IF_CMD_TBL.HI_CLMN = MAX_CLMN-1;
     2921    11183    2        IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(0)) >= CMD_END$
     2922    11184    2        THEN GOTO NO_MORE_SPACE ;
     2923    11185    2        CMD$ -> IF_CMD_TBL.SSE.PTR$(0) = ADDR(NIL);
     2924    11186        /**/
     2925    11187    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN GOTO CHECK_IF_RET;
     2926    11188        /**/
     2927    11189    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);
     2928    11190    3        IF (BLK$ -> OUT$BLK.CODE = PC_SSE) THEN DO;
     2929    11191    3           I = 0;
     2930    11192    3           CMD$ -> IF_CMD_TBL.SSE.FLAGS(IF_LEVEL) = FALSE;
     2931    11193    3           CMD$ -> IF_CMD_TBL.SSE.FLAGS.ORFLAG(IF_LEVEL) = TRUE; /* FIRST OP. IS OR */
     2932    11194    4           IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_NOT) THEN DO;
     2933    11195    4              CMD$ -> IF_CMD_TBL.SSE.FLAGS.NOTFLAG(IF_LEVEL) = TRUE;
     2934    11196    4              I = I+1;
     2935    11197    4              END;
     2936    11198    3           CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),ADDR(CMD$ ->
     2937    11199    3              IF_CMD_TBL.SSE(IF_LEVEL)),J0NOTOK) ALTRET (CHECK_IF_ALT);
     2938    11200        /**/
     2939    11201    4           DO WHILE (BLK$ -> OUT$BLK.NSUBLKS > I+1); /* PROCESS ALL STRINGS   */
     2940    11202    4              IF_LEVEL = IF_LEVEL + 1;
     2941    11203    4              CMD$ -> IF_CMD_TBL.SSE.FLAGS(IF_LEVEL) = FALSE;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:100  
     2942    11204    4              BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+1);
     2943    11205    4              I = 1;
     2944    11206    4              IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_AND)
     2945    11207    4              THEN CMD$ -> IF_CMD_TBL.SSE.FLAGS.ANDFLAG(IF_LEVEL) = TRUE;
     2946    11208    4              ELSE IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_OR)
     2947    11209    4                 THEN CMD$ -> IF_CMD_TBL.SSE.FLAGS.ORFLAG(IF_LEVEL) = TRUE;
     2948    11210    4                 ELSE CMD$ -> IF_CMD_TBL.SSE.FLAGS.EORFLAG(IF_LEVEL) = TRUE;
     2949    11211        /**/
     2950    11212    5              IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_NOT) THEN DO;
     2951    11213    5                 CMD$ -> IF_CMD_TBL.SSE.FLAGS.NOTFLAG(IF_LEVEL) = TRUE;
     2952    11214    5                 I = I+1;
     2953    11215    5                 END;
     2954    11216        /**/
     2955    11217    4              IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL)) >= CMD_END$
     2956    11218    4              THEN GOTO NO_MORE_SPACE ;
     2957    11219    4              CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),ADDR(CMD$ ->
     2958    11220    4                 IF_CMD_TBL.SSE(IF_LEVEL)),J0NOTOK) ALTRET(CHECK_IF_ALT);
     2959    11221    4              END;
     2960    11222        /**/
     2961    11223    3           IF_LEVEL = IF_LEVEL + 1;
     2962    11224    3           IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL)) >= CMD_END$
     2963    11225    3           THEN GOTO NO_MORE_SPACE ;
     2964    11226    3           CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL) = ADDR(NIL);
     2965    11227    3           IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 2) THEN GOTO CHECK_IF_RET;
             11227                    /* NO COLUMN RANGE GIVEN */
     2966    11228    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(2);
     2967    11229    3           END;
     2968    11230        /**/
     2969    11231    2        CALL VEX$PARSE_CLMNRANGE (CMD$ -> IF_CMD_TBL.LO_CLMN,
     2970    11232    2           CMD$ -> IF_CMD_TBL.HI_CLMN,BLK$) ALTRET (CHECK_IF_ALT);
     2971    11233        /**/
     2972    11234    2   CHECK_IF_RET:
     2973    11235    2        FLAGS.INTRA_CMD = TRUE;
     2974    11236    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(IF_CMD_TBL) +
     2975    11237    2           (IF_LEVEL * SIZEW(IF_CMD_TBL.SSE));
     2976    11238    2        RETURN;
     2977    11239        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:101  
     2978    11240    2   CHECK_IF_ALT:
     2979    11241    2        ALTRETURN;
     2980    11242
     2981    11243    2   NO_MORE_SPACE:
     2982    11244    2        UNWIND TO CMD_SPACE_EXHAUSTED ;
     2983    11245    2   END;
     2984    11246        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:102  
     2985    11247        /**/
     2986    11248    1   CHECK_JU: PROC ALTRET;                  /* JU                                 */
     2987    11249        /**/
     2988    11250    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     2989    11251    3           CALL VEX$ERROR (E$E_NOFILE,3);
     2990    11252        /**/
     2991    11253        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2992    11254                 DESCRIPTION: A record oriented command has been received
     2993    11255                           without a file open to edit.
     2994    11256        */
     2995    11257    3           ALTRETURN;
     2996    11258    3           END;
     2997    11259    3        IF (~FLAGS.STEP_MODE) THEN DO; /* Not in SET and STEP mode.           */
     2998    11260    3           CALL VEX$ERROR (E$E_BADJUCMD,3);
     2999    11261        /**/
     3000    11262        /*E*     ERROR:    VEE-E$E_BADJUCMD-0
     3001    11263                 MESSAGE:  JU illegal.
     3002    11264                 MESSAGE2: JU legal only in SET and STEP mode.
     3003    11265                 DESCRIPTION: JU legal only in set and step mode.
     3004    11266        */
     3005    11267    3           ALTRETURN;
     3006    11268    3           END;
     3007    11269        /**/
     3008    11270    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> JU_CMD_TBL);
     3009    11271    2        FLAGS.INTRA_CMD = TRUE;
     3010    11272    2        FLAGS.NOCOMPCMD = TRUE;            /* JU MUST BE LAST                    */
     3011    11273        /**/
     3012    11274    2        CALL VEX$BUILD_SEQNUM(CMD$ -> JU_CMD_TBL.EDITKEY.SEQNUM,BLK$ ->
     3013    11275    2           OUT$BLK.SUBLK$(1)) ALTRET (CHECK_JU_ALT) ;
     3014    11276    2        RETURN;
     3015    11277        /**/
     3016    11278    2   CHECK_JU_ALT:
     3017    11279    2        ALTRETURN;
     3018    11280    2   END;
     3019    11281        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:103  
     3020    11282        /**/
     3021    11283    1   CHECK_R: PROC ALTRET;                   /* R,L                                */
     3022    11284        /**/
     3023    11285    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     3024    11286    3           CALL VEX$ERROR (E$E_NOFILE,3);
     3025    11287        /**/
     3026    11288        /*E*     ERROR:    VEE-E$E_NOFILE-0
     3027    11289                 DESCRIPTION: A record oriented command has been received
     3028    11290                           without a file open to edit.
     3029    11291        */
     3030    11292    3           ALTRETURN;
     3031    11293    3           END;
     3032    11294        /**/
     3033    11295    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> RL_CMD_TBL);
     3034    11296    2        FLAGS.INTRA_CMD = TRUE;
     3035    11297    2        FLAGS.STRCHGCMD = TRUE;
     3036    11298        /**/
     3037    11299    2        P$ = PINCRW(CMD$,1);
     3038    11300    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0NOTOK)
     3039    11301    2           ALTRET (CHECK_R_ALT);
     3040    11302        /**/
     3041    11303    2        STR_BUF.COUNT = BLK$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT
             11303                 ;
     3042    11304    2        STR_BUF.TEXT = BLK$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT;
     3043    11305    2        CALL CHARBIN (CMD$ -> RL_CMD_TBL.SHIFT#,SUBSTR(STR_BUF.TEXT,0,
     3044    11306    2           STR_BUF.COUNT));
     3045    11307    2        IF (CMD$ -> RL_CMD_TBL.SHIFT# > MAX_CLMN) THEN ALTRETURN;
     3046    11308    2        RETURN;
     3047    11309        /**/
     3048    11310    2   CHECK_R_ALT:
     3049    11311    2        ALTRETURN;
     3050    11312    2   END;
     3051    11313        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:104  
     3052    11314        /**/
     3053    11315    1   CHECK_S: PROC ALTRET;                   /* S                                  */
     3054    11316        /**/
     3055    11317    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */
     3056    11318    3           CALL VEX$ERROR (E$E_NOFILE,3);
     3057    11319        /**/
     3058    11320        /*E*     ERROR:    VEE-E$E_NOFILE-0
     3059    11321                 DESCRIPTION: A record oriented command has been received
     3060    11322                           without a file open to edit.
     3061    11323        */
     3062    11324    3           ALTRETURN;
     3063    11325    3           END;
     3064    11326        /**/
     3065    11327    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);
     3066    11328    2        FLAGS.INTRA_CMD = TRUE;
     3067    11329    2        FLAGS.STRCHGCMD = TRUE;
     3068    11330        /**/
     3069    11331    2        P$ = PINCRW(CMD$,1);
     3070    11332    2        CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK)
     3071    11333    2           ALTRET (CHECK_S_ALT);
     3072    11334        /**/
     3073    11335    2        P$ = PINCRW(P$,2);
     3074    11336    2        CALL VEX$PARSE_STRING(BLK$ -> OUT$BLK.SUBLK$(2),P$)
     3075    11337    2           ALTRET (CHECK_S_ALT);
     3076    11338    2        RETURN;
     3077    11339        /**/
     3078    11340    2   CHECK_S_ALT:
     3079    11341    2        ALTRETURN;
     3080    11342    2   END;
     3081    11343        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:105  
     3082    11344        /**/
     3083    11345    1   CHECK_DIR: PROC ALTRET ;                /* DIRECTORY                          */
     3084    11346    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> DIR_CMD_TBL) ;
     3085    11347        /**/
     3086    11348    2        IF BLK$ -> OUT$BLK.NSUBLKS = 1     /* Just 'DIR'                         */
     3087    11349    2        THEN
     3088    11350    2           CMD$ -> DIR_CMD_TBL.CODE = DIRCMD ;
     3089    11351    2        ELSE                               /* Set or reset                       */
     3090    11352    2           CMD$ -> DIR_CMD_TBL.CODE = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.CODE ;
     3091    11353        /**/
     3092    11354    2        IF CMD$ -> DIR_CMD_TBL.CODE = PC_FID THEN /* Set DIR                  */
     3093    11355    3        DO ;
     3094    11356    3           DIR_BUF = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT ;
     3095    11357    3           CALL M$FID(FPT_FID) ALTRET( FID_ERR ) ;
     3096    11358    3           IF FID_RESULTS.NAME OR FID_RESULTS.PASS OR FID_RESULTS.WSN
     3097    11359    3              OR ~FID_RESULTS.ACCT OR DIR_ACCT.ACCT# = ' '
     3098    11360    3              OR DIR_SN.NUM# > 1 OR ASN ~= %FILE# THEN
     3099    11361    4           DO ;
     3100    11362    4              CALL VEX$ERROR(E$E_BADDIR,1) ;
     3101    11363    4              ALTRETURN ;
     3102    11364    4              END ;                        /* THEN DO                            */
     3103    11365        /**/
     3104    11366        /*E*     ERROR:    VEE-E$E_BADDIR-0
     3105    11367                 MESSAGE:  Bad DIRECTORY specification.
     3106    11368                 MESSAGE1: DIRECTORY fid can only specify [DP#SN].ACCOUNT
     3107    11369                 DESCRIPTION: The user has input more than just [DP#SN].ACCOUNT
     3108    11370                              for the fid of the DIRECTORY command.
     3109    11371        */
     3110    11372    3           CMD$ -> DIR_CMD_TBL.ACCT = DIR_ACCT.ACCT# ;
     3111    11373    3           IF FID_RESULTS.SN THEN          /* Change PSN.                        */
     3112    11374    3              CMD$ -> DIR_CMD_TBL.PSN = DIR_SN.SN#(0) ;
     3113    11375    3           ELSE
     3114    11376    3              CMD$ -> DIR_CMD_TBL.PSN = ' ' ;
     3115    11377    3           END ;                           /* THEN DO                            */
     3116    11378        /**/
     3117    11379    2        RETURN ;
     3118    11380        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:106  
     3119    11381    2   FID_ERR:
     3120    11382    2        CALL VEX$ERROR(E$E_BADFID,1) ;
     3121    11383    2        ALTRETURN ;
     3122    11384        /**/
     3123    11385    2   END     CHECK_DIR ;
     3124    11386    1   END;                                    /* END VEE$EDIT                       */

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:107  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEE$EDIT.

   Procedure VEE$EDIT requires 4201 words for executable code.
   Procedure VEE$EDIT requires 272 words of local(AUTO) storage.

    No errors detected in file VEE$EDIT.:E05TSI    .

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:108  

 Object Unit name= VEE$EDIT                                   File name= VEE$EDIT.:E05TOU
 UTS= JUL 30 '97 07:04:42.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    290    442  VEE$EDIT
    2   Data  even  none  1666   3202  VEE$EDIT
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$LM
    5   DCB   even  none     0      0  M$FILE
    6   DCB   even  none     0      0  M$FILE2
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none    98    142  M$ME
    9   Proc  even  none  4201  10151  VEE$EDIT
   10  RoData even  none   168    250  VEE$EDIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Main       0  VEE$EDIT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:109  

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    172  OPEN_SIME_FPT                      2    130  CLOSE_SIREAD_FPT
    2    166  TAB_VLP                            2    176  SAVE_TAB_VLP
    2    244  REC_BUF                            2    644  TEMP_BUF
    2   1244  TY_DCBNUM                          2   1245  IN_DCBNUM
    2   1246  ME_DCBNUM                          2   1247  SI_DCBNUM
    2   1250  CMD_BUF                            2   1350  TEMP_CMD_BUF
    2   1450  TYPE_BUF                           2   2072  SUB_BUF_1
    2   2102  SUB_BUF_2                          2   2112  SUB_BUF_3
    2   2122  STR_BUF                            2   2523  SEQ_TEXT_BUF
    2   2526  CURR_FILE_NAME                     2   2536  CURR_FILE_ACCT
    2   2540  CURR_FILE_PASS                     2   2542  CURR_FILE_SN
    2   2545  OPEN_FILE_NAME                     2   2555  OPEN_FILE_ACCT
    2   2557  OPEN_FILE_PASS                     2   2561  OPEN_FILE_SN
    2   2564  ERR_CODE                           2   2565  TYPE_CODE
    2   2566  REC_SIZE                           2   2567  RP_REC_SIZE
    2   2570  CMD_SIZE                           2   2571  TEMP_CMD_SIZE
    2   2572  TYPE_SIZE                          2   2573  DVBYTE
    2   2574  LO_SRCH_CLMN                       2   2575  HI_SRCH_CLMN
    2   2576  LO_EXEC_CLMN                       2   2577  HI_EXEC_CLMN
    2   2600  RR_POS_CLMN                        2   2601  LO_SEQNUM
    2   2602  HI_SEQNUM                          2   2603  EXEC_SEQNUM
    2   2604  LIMIT_SEQNUM                       2   2605  CP_SEQNUM
    2   2606  CP_LIMIT_SEQNUM                    2   2607  CP_DFLT_INCR
    2   2610  CP_RECSMVED                        2   2611  INCR
    2   2612  DFLT_INCR                          2   2613  LAST_KEY
    2   2614  READ_KEY                           2   2615  SAVE_KEY
    2   2616  MATCH_CLMN                         2   2617  TEMP_CLMN
    2   2620  TEMP_COUNT                         2   2621  TEMP_STRCHG_COUNT
    2   2622  STR1_CLMN                          2   2623  STR2_CLMN
    2   2624  CMD_INDEX                          2   2625  CMD_CODE
    2   2626  LAST_CMD                           2   2627  SAVED_CMD
    2   2630  LAST_TYPE_CMD                      2   2631  FT_COUNT
    2   2632  REC_COUNT                          2   2633  DELREC_COUNT
    2   2634  STRCHG_COUNT                       2   2635  TRNC_COUNT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:110  
    2   2636  IF_LEVEL                           2   2637  TEMP_IF_LEVEL
    2   2640  I                                  2   2641  M$FILE_NUM
    2   2642  M$FILE2_NUM                        2   2643  SEED
    2   2644  NUM_TABS                           2   2645  MK_COUNT
    2   2646  FRST2DEL                           2   2647  VERIFY_TYPE
    2   2650  P$                                 2   2651  INDX
    2   2652  M$SI$                              2   2653  M$UC$
    2   2654  M$FILE$                            2   2655  M$FILE2$
    2   2657  CMD$                               2   2660  CMD_BASE$
    2   2661  CMD_END$                           2   2662  CMDBUF$
    2   2663  CMDBUF_BASE$                       2   2664  CMDBUF_END$
    2   2665  SSE$                               2   2666  SSE_INIT$
    2   2667  MK_BASE$                           2   2670  MK_WORK$
    2   2671  MK_BOUND$                          2   2672  COPYDS_PTR$
    2   2673  STR_TEXT$                          2   2674  STR_TEXT_HEAD$
    2   2675  STR_TEXT_END$                      2   2676  STR_TEXT_SE$
    2   2677  STR_TEXT_QM$                       2   2702  REMEM_CMD_READ
    2   2704  REMEM_STEP_CMD                     2   2706  FLAGS
    2   2710  SSE_PARAM                          2   2712  P_GET
    2   2730  P_PCB                              2   2746  XUG$GETCMD_
    2   3064  DS_RESULTS                         2   3066  BREAK_ARS
    2   3071  GET_CMD_TBL                        1    412  MAX_SEQNUM
    1    413  MAX_CLMN                           1    414  Y003
    1    415  CRET                               1    416  NEWLINE
    1    420  BSPACECHAR                         1    421  TABCHAR
    1    422  SINGLE_AST                         1    423  GTAST
    1    424  BLANKS                             1    425  SEQNUM_ONE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:111  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       2 VEX$ERROR
         yes           Std       2 VEX$SEQNUM_TEXT
         yes           Std       2 VEX$SET_SUB_BUF
         yes          Async      0 VEX$BREAK
         yes           Std       1 VEX$XPARSE_ENT
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       0 VEX$READ_SEQUEN
         yes           Std       0 VEX$CLMN_DFLT
         yes           Std       0 VEM$MASTER
 yes     yes           Std       2 VEX$WRITE_REC
         yes           Std       1 VEX$TYPE_REC
 yes     yes           Std       0 VEX$XPAND
         yes           Std       2 CMD_CONTINUE
         yes           Std       1 VEX$SET_PROMPT
 yes     yes           Std       0 VEX$ERRMAX
 yes     yes           Std       2 XUG$INIT
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       1 XUG$GETCMD
 yes     yes           Std       1 VEX$READ_RANDOM
 yes     yes           Std       4 VEX$FIND_MATCH
 yes     yes           Std       0 VEX$CHECK_FIRST
 yes     yes           Std       2 VEX$BUILD_SEQNUM
 yes     yes           Std       2 VEX$ERROR_NO_PRINT
 yes     yes           Std       3 VEX$PARSE_SEQRANGE
 yes     yes           Std       3 VEX$FID_2_FPT
 yes     yes           Std       3 VEX$PARSE_CLMNRANGE
 yes     yes           Std       0 VEX$GET_NEXT_KEY
 yes     yes           Std       3 VEX$PARSE_JSTRING
 yes     yes           Std       3 VEX$PARSE_CLMNSTRING
 yes     yes           Std       2 VEX$PARSE_STRING
                       nStd      0 X66_MAUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:112  
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VE_ERRMSGACCT                         P_ALLCMDS
     B$JIT$                                B$TCB$                                B_VERSION
r    B$SR_NON_BLANK$                       M$SI                                  M$LM
     M$FILE                                M$FILE2                               M$DO
     M$ME                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:113  


        1        1        /*M*     VEE$EDIT   File building and maintanence utility */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /*P*     NAME:     VEE$EDIT
        9        9                 PURPOSE:  The cp-6 editor allows manipulation of data stored
       10       10                           in keyed files. Its capabilities include the building
       11       11                           copying, merging and deleteing of files as well
       12       12                           as various manipulation of data records within files
       13       13                           and data within records.
       14       14                 STRUCTURE: Edit is split into three modules. VEE$EDIT contains
       15       15                           the main control routine as well as routines to do the
       16       16                           syntax checking for all commands. VEM$MASTER contains
       17       17                           the routines that perform the editting functions.
       18       18                           VEX$EDITEXT is made up of subroutines called from
       19       19                           various places within Edit.   */
       20       20        /**/
       21       21        /*D*     NAME:     VEE$EDIT
       22       22                 PARAMETERS: None
       23       23                 DESCRIPTION: VEE$EDIT contains the main driver routine for edit
       24       24                           and the various parsing and execution control routines
       25       25                           for all of the edit commands.
       26       26                             When VEE$EDIT is entered some initialization
       27       27                           is performed and READ_CMD is called to read user commands
       28       28                           M$PARSE is called to parse the commands and CHECK_CMD
       29       29                           does further semantic checking and setting of selection
       30       30                           parameters for the se,st,ss,ft,fs,fd commands. The
       31       31                           command table (CMD_TBL) is build by CHECK_CMD to
       32       32                           record the commands given by the user.
       33       33                             If step mode is invoked by an st or ss command then
       34       34                           user is prompted for commands to be applied
       35       35                           to the open record. In any case the command table is
       36       36                           passed to VEM$MASTER to be processed.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:114  
       37       37                             If selection criteria have been established then
       38       38                           CHECK_SSE is called to determine whether the open
       39       39                           record meets the criteria.
       40       40                 DCBS:     The following DCBs are used.
       41       41                           M$SI - user input
       42       42                           M$ME - output to user
       43       43                           M$DO - diagnostics
       44       44                           M$FILE - file open for editing
       45       45                           M$FILE2 - copy or merge file
       46       46        */
       47       47        /*K*     EDIT_KEY  edit writes keyed files with three byte keys. The format
       48       48                           of the keys is the binary value for the sequence
       49       49                           number times one thousand.
       50       50        *
       51       51                           ************************************
       52       52                           * COUNT *         VALUE            *
       53       53                           ************************************
       54       54        *
       55       55                           COUNT = 3
       56       56                           VALUE = SEQUENCE NUMBER * 1000          */
       57       57        /**/
       58       58        VEE$EDIT: PROC MAIN;

     58  9 000000   000000 700200 xent  VEE$EDIT     TSX0  ! X66_MAUTO
         9 000001   000420 000000                    ZERO    272,0

       59       59        /*********************************************************************/
       60       60        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       61       61        /*********************************************************************/
       62       62        /**/
       63       63        %PLIST;
       64       64        %INCLUDE VE_SUBS_C;
       65      258        %INCLUDE VE_PERR_C;
       66      475        %INCLUDE F$DCB;
       67      524        %INCLUDE CP_6;
       68      605        %INCLUDE CP_6_SUBS ;
       69     1145        %INCLUDE XU_MACRO_C;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:115  
       70     4251        %INCLUDE XU_PERR_C;
       71     4442        %INCLUDE B$JIT;
       72     4732        %INCLUDE B_ERRORS_C ;
       73     5859        %INCLUDE NK_VFC_C;
       74     5933        %INCLUDE B$TABLES_C;
       75     6041        %INCLUDE XU_SUBS_C ;
       76     6133        %INCLUDE XUG_ENTRY ;                    /* XUG ENTRY DCLS */
       77     6164
       78     6165        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:116  
       79     6166        /********************************************************************/
       80     6167        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       81     6168        /********************************************************************/
       82     6169        /**/
       83     6170        %FPT_GDS (FPTN = GDS_FPT,
       84     6171                 RESULTS = DS_RESULTS, STCLASS = CONSTANT,
       85     6172                 SEGSIZE = 1024);
       86     6188        /**/
       87     6189        %FPT_OPEN (FPTN = OPEN_ME,
       88     6190                  DCB = M$ME,
       89     6191                  SCRUB = YES,
       90     6192                  REASSIGN = YES,
       91     6193                  STCLASS = CONSTANT,
       92     6194                  FUN = CREATE,
       93     6195                  EXIST = OLDFILE) ;
       94     6304        /**/
       95     6305        %FPT_OPEN (FPTN = OPEN_DO,DCB=M$DO,STCLASS=CONSTANT);
       96     6414        /**/
       97     6415        %FPT_CLOSE    (FPTN = CLOSE_TY_FPT,
       98     6416                      STCLASS = STATIC,
       99     6417                      DISP = SAVE);
      100     6459        /**/
      101     6460        %FPT_OPEN  (FPTN = OPEN_SIREAD_FPT,
      102     6461                      NAME = OPEN_FILE_NAME,
      103     6462                      ASN = FILE,
      104     6463                      DISP = NAMED,
      105     6464                      SCRUB = YES,
      106     6465                      FUN = IN);
      107     6574        /**/
      108     6575        %FPT_OPEN  (FPTN = OPEN_SIME_FPT,
      109     6576                    DCB = M$SI, STCLASS = "CONSTANT  SYMDEF",
      110     6577                    SCRUB = YES,
      111     6578                    ASN = DEVICE,
      112     6579                    FUN = IN,
      113     6580                    RES = 'ME',
      114     6581                    REASSIGN = NO) ;
      115     6690        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:117  
      116     6691        %FPT_CLOSE (FPTN = CLOSE_SIREAD_FPT,
      117     6692                      DISP = SAVE,
      118     6693                      STCLASS ="STATIC SYMDEF") ;
      119     6735        /**/
      120     6736        %FPT_CLOSE (FPTN = CLOSE_FPT,
      121     6737                    STCLASS = CONSTANT,
      122     6738                    DCB = M$FILE,
      123     6739                    RELG = YES,
      124     6740                    DISP = SAVE) ;
      125     6782        %FPT_INT (FPTN=INT_FPT,UENTRY=VEX$BREAK,STCLASS=CONSTANT);
      126     6796        /**/
      127     6797        %VLP_TAB (FPTN = TAB_VLP,
      128     6798                  STCLASS ="STATIC  SYMDEF");
      129     6812        /**/
      130     6813        %VLP_TAB (FPTN = SAVE_TAB_VLP,
      131     6814                  STCLASS ="STATIC  SYMDEF");
      132     6828        /**/
      133     6829        %FPT_LINK  (FPTN = PCLLINK_FPT, STCLASS = CONSTANT,
      134     6830                    NAME = PCLNAME,
      135     6831                    ACCT = SYSACCT,
      136     6832                    CMD = TYPE_BUF);
      137     6850        /**/
      138     6851        %VLP_NAME  (FPTN = PCLNAME, STCLASS = CONSTANT,
      139     6852                    LEN = 3,
      140     6853                    NAME = 'PCL');
      141     6880        /**/
      142     6881        %VLP_ACCT  (FPTN = SYSACCT, STCLASS = CONSTANT,
      143     6882                    ACCT = ':SYS');
      144     6895        /**/
      145     6896        %VLP_ACCT (FPTN = VE_ERRMSGACCT ,
      146     6897                  STCLASS = SYMREF) ;
      147     6910        /**/
      148     6911        %VLP_TAB (FPTN = TAB$VLP,STCLASS = BASED);
      149     6925        %VLP_NAME (FPTN = DIR_TRASH ,
      150     6926                   LEN = 31 ) ;
      151     6953        /**/
      152     6954        %VLP_ACCT (FPTN = DIR_ACCT) ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:118  
      153     6967        /**/
      154     6968        %VLP_SN   (FPTN = DIR_SN ,
      155     6969                  N = 2 ) ;
      156     6982        /**/
      157     6983        %VLR_FID  (FPTN = FID_RESULTS) ;
      158     7002        /**/
      159     7003        %FPT_FID  (FPTN = FPT_FID , STCLASS = CONSTANT,
      160     7004                  ACCT = DIR_ACCT ,
      161     7005                  ASN = ASN ,
      162     7006                  NAME = DIR_TRASH ,
      163     7007                  PASS = DIR_TRASH ,
      164     7008                  RES = TBUF ,
      165     7009                  RESULTS = FID_RESULTS ,
      166     7010                  SN = DIR_SN ,
      167     7011                  TEXTFID = DIR_BUF ,
      168     7012                  WSN = DIR_TRASH ) ;
      169     7035        %FPT_RELDCB ( FPTN = RELDCB_FPT,
      170     7036                      STCLASS = STATIC) ;
      171     7050        %FPT_GETDCB ( FPTN = GETDCB_FPT,
      172     7051                      STCLASS = CONSTANT,
      173     7052                      DCBNAME = READ_DCB_NAME,
      174     7053                      DCBNUM = IN_DCBNUM) ;
      175     7068        %VLP_NAME ( FPTN = READ_DCB_NAME,
      176     7069                    NAME = 'M$READ',
      177     7070                    LEN = 6) ;
      178     7097        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:119  
      179     7098        /***************************************************************************/
      180     7099        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
      181     7100        /***************************************************************************/
      182     7101    1   DCL REC_BUF CHAR(PC_RECSIZE#) STATIC SYMDEF;
      183     7102    1   DCL TEMP_BUF CHAR(PC_RECSIZE#) STATIC SYMDEF;
      184     7103    1   DCL TY_DCBNUM UBIN WORD INIT(DCBNUM(M$ME)) STATIC SYMDEF ;
              7103            /* DCBNUM FOR OL COMMAND. */
      185     7104    1   DCL IN_DCBNUM UBIN WORD INIT(DCBNUM(M$SI)) STATIC SYMDEF ;
              7104            /* DCBNUM FOR READ COMMAND. */
      186     7105    1   DCL ME_DCBNUM UBIN WORD INIT(DCBNUM(M$ME)) STATIC SYMDEF ;
              7105            /* M$ME DCBNUM FOR OL COMMAND. */
      187     7106    1   DCL SI_DCBNUM UBIN WORD INIT(DCBNUM(M$SI)) STATIC SYMDEF ;
              7106            /* M$SI DCBNUM FOR READ COMMAND. */
      188     7107    1   DCL CMD_BUF CHAR(256) STATIC SYMDEF ALIGNED;
      189     7108    1   DCL TEMP_CMD_BUF CHAR(256) STATIC SYMDEF ALIGNED;
      190     7109    1   DCL 1 TYPE_BUF STATIC SYMDEF,
      191     7110    1          2 VFC CHAR(1) CALIGNED INIT(%VFC_S1A),
      192     7111    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      193     7112    1   DCL 1 SUB_BUF_1 STATIC SYMDEF,
      194     7113    1          2 COUNT UBIN(9) CALIGNED,
      195     7114    1          2 TEXT CHAR(31) CALIGNED;
      196     7115    1   DCL 1 SUB_BUF_2 STATIC SYMDEF,
      197     7116    1          2 COUNT UBIN(9) CALIGNED,
      198     7117    1          2 TEXT CHAR(31) CALIGNED;
      199     7118    1   DCL 1 SUB_BUF_3 STATIC SYMDEF,
      200     7119    1          2 COUNT UBIN(9) CALIGNED,
      201     7120    1          2 TEXT CHAR(31) CALIGNED;
      202     7121    1   DCL 1 STR_BUF STATIC SYMDEF,
      203     7122    1          2 COUNT UBIN HALF HALIGNED,
      204     7123    1          2 TEXT CHAR(PC_RECSIZE#) CALIGNED;
      205     7124    1   DCL SEQ_TEXT_BUF CHAR(9)  STATIC SYMDEF;
      206     7125    1   DCL 1 CURR_FILE_NAME STATIC SYMDEF,     /* Remember the FID being edited from*/
      207     7126    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
      208     7127    1          2 TEXT CHAR(31) CALIGNED;        /* that changed it.                  */
      209     7128    1   DCL   CURR_FILE_ACCT CHAR(8) STATIC SYMDEF ;
      210     7129    1   DCL   CURR_FILE_PASS CHAR(8) STATIC SYMDEF ;
      211     7130    1   DCL 1 CURR_FILE_SN  STATIC SYMDEF,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:120  
      212     7131    1          2 COUNT SBIN WORD INIT (1),
      213     7132    1          2 SN CHAR(6) CALIGNED INIT ('      ');
      214     7133    1   DCL 1 OPEN_FILE_NAME STATIC SYMDEF,     /* EDIT FILE NAME                     */
      215     7134    1          2 COUNT UBIN(9) CALIGNED INIT (10),
      216     7135    1          2 TEXT CHAR(31) CALIGNED INIT ('..........');
      217     7136    1   DCL OPEN_FILE_ACCT CHAR(8) STATIC SYMDEF INIT (' '); /* EDIT FILE ACCT       */
      218     7137    1   DCL OPEN_FILE_PASS CHAR(8) STATIC SYMDEF INIT (' '); /* EDIT FILE PASSWORD   */
      219     7138    1   DCL 1 OPEN_FILE_SN STATIC SYMDEF,
      220     7139    1          2 COUNT SBIN WORD INIT (1),
      221     7140    1          2 SN CHAR(6) CALIGNED INIT ('      ');
      222     7141    1   DCL 1 ERR_CODE STATIC SYMDEF,
      223     7142    1          2 FCG_MID BIT(18) UNAL INIT('260505'O),
      224     7143    1          2 MON BIT(1) UNAL INIT('0'B),
      225     7144    1          2 ERR# UBIN(14) UNAL INIT(E$E_HELP),
      226     7145    1          2 SEV UBIN(3) UNAL INIT(0);
      227     7146    1   DCL TYPE_CODE CHAR(2) STATIC SYMDEF INIT('SE');
      228     7147        /**/
      229     7148    1   DCL SSE_TBL(0:255) UBIN(36) AUTO;       /* SELECTION CRITERIA              */
      230     7149        /*B*     SSE_TBL   SSE_TBL IS A TABLE OF TWO WORD SSE_PARAM ENTRIES
      231     7150                           WHICH DESCRIBES THE SELECTION CRITERIA GIVEN BY
      232     7151                           THE USER. (SEE SSE_PARAM)           */
      233     7152        /**/
      234     7153    1   DCL REC_SIZE UBIN(36) STATIC SYMDEF;    /* CHARACTER COUNT OF REC_BUF         */
      235     7154    1   DCL RP_REC_SIZE UBIN WORD STATIC SYMDEF INIT(0); /* RECORD SIZE AS READ       */
      236     7155    1   DCL CMD_SIZE UBIN(36) STATIC SYMDEF;    /* CHARACTER COUNT OF CMD_BUF         */
      237     7156    1   DCL TEMP_CMD_SIZE UBIN(36) STATIC SYMDEF; /* CHARACTER COUNT OF TEMP_CMD_BUF  */
      238     7157    1   DCL TYPE_SIZE UBIN(36) STATIC SYMDEF;   /* SIZE OF TYPE_REC WRITE             */
      239     7158    1   DCL DVBYTE BIT(36) STATIC SYMDEF INIT('0'B) ; /* DVBYTE for writes. */
      240     7159    1   DCL LO_SRCH_CLMN UBIN(36) STATIC SYMDEF; /* LOW LIMIT OF SEARCH RANGE         */
      241     7160    1   DCL HI_SRCH_CLMN UBIN(36) STATIC SYMDEF; /* HIGH LIMIT OF SEARCH RANGE        */
      242     7161    1   DCL LO_EXEC_CLMN UBIN(36) STATIC SYMDEF; /* LOW LIMIT OF CHANGEABLE RANGE     */
      243     7162    1   DCL HI_EXEC_CLMN UBIN(36) STATIC SYMDEF; /* HIGH LIMIT OF CHANGEABLE RANGE    */
      244     7163    1   DCL RR_POS_CLMN SBIN WORD STATIC SYMDEF INIT (0);
              7163            /* Column num to position to on an RR */
      245     7164    1   DCL LO_SEQNUM UBIN(36) STATIC SYMDEF INIT(BITBIN('003000000000'O));
      246     7165                                                /* LOW LIMIT OF RECORD RANGE          */
      247     7166    1   DCL HI_SEQNUM UBIN(36) STATIC SYMDEF INIT(BITBIN('003575360377'O));
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:121  
      248     7167                                                /* HIHG LIMIT OF COLUMN RANGE         */
      249     7168    1   DCL EXEC_SEQNUM UBIN(36) STATIC SYMDEF; /* CURRENT RECORD BEING USED          */
      250     7169    1   DCL LIMIT_SEQNUM UBIN(36) STATIC SYMDEF; /* TEMP FOR SEARCHING RANGES         */
      251     7170    1   DCL CP_SEQNUM UBIN WORD STATIC SYMDEF INIT(BITBIN('003777777777'O));
      252     7171    1   DCL CP_LIMIT_SEQNUM UBIN WORD STATIC SYMDEF INIT(BITBIN('003000000000'O));
      253     7172    1   DCL CP_DFLT_INCR UBIN WORD STATIC SYMDEF INIT(1000);
      254     7173    1   DCL CP_RECSMVED UBIN WORD STATIC SYMDEF INIT(0);
      255     7174    1   DCL INCR UBIN(36) STATIC SYMDEF;        /* INCREMENT                          */
      256     7175    1   DCL DFLT_INCR UBIN(36) STATIC SYMDEF INIT(1000);
      257     7176    1   DCL LAST_KEY UBIN(36) STATIC SYMDEF INIT(BITBIN('003000000000'O));
              7176            /* KEY OF LAST RECORD READ */
      258     7177    1   DCL READ_KEY UBIN(36) STATIC SYMDEF;    /* KEY TO BE USED TO READ RECORD      */
      259     7178    1   DCL SAVE_KEY UBIN(36) STATIC SYMDEF;    /* SAVE LAST KEY IN MD                */
      260     7179    1   DCL MATCH_CLMN UBIN(36) STATIC SYMDEF;  /* COLUMN OF START OF STRING          */
      261     7180    1   DCL TEMP_CLMN UBIN(36) STATIC SYMDEF;   /* TEMP CELL FOR COLUMN NUM.          */
      262     7181    1   DCL TEMP_COUNT UBIN(36) STATIC SYMDEF;
      263     7182    1   DCL TEMP_STRCHG_COUNT UBIN(36) STATIC SYMDEF;
      264     7183    1   DCL STR1_CLMN UBIN(36) STATIC SYMDEF;   /* START OF FIRST INTRA STRING        */
      265     7184    1   DCL STR2_CLMN UBIN(36) STATIC SYMDEF;   /* START OF SECOND INTRA STRING       */
      266     7185    1   DCL CMD_INDEX UBIN(36) STATIC SYMDEF INIT(0); /* START OF NEXT CMD IN CMD_BUF */
      267     7186    1   DCL CMD_CODE UBIN(36) STATIC SYMDEF;    /* CODE FOR CURRENT COMMAND           */
      268     7187    1   DCL LAST_CMD UBIN(36) STATIC SYMDEF INIT(0); /* LAST CMD FOR ?? COMMAND       */
      269     7188    1   DCL SAVED_CMD UBIN(36) STATIC SYMDEF INIT(0);
      270     7189    1   DCL LAST_TYPE_CMD UBIN(36) STATIC SYMDEF INIT(TYCMD);
              7189            /* FORMAT USED BY LF-UPARROW */
      271     7190    1   DCL FT_COUNT UBIN WORD STATIC SYMDEF INIT(0); /* COUNT OF RECORDS DELETED     */
      272     7191    1   DCL REC_COUNT UBIN(36) STATIC SYMDEF;   /* COUNT OF RECORDS OPERATED ON       */
      273     7192    1   DCL DELREC_COUNT UBIN(36) STATIC SYMDEF INIT(0); /* COUNT OF RECORDS DELETED  */
      274     7193    1   DCL STRCHG_COUNT UBIN(36) STATIC SYMDEF INIT(0); /* COUNT OF STRINGS CHANGED  */
      275     7194    1   DCL TRNC_COUNT UBIN WORD STATIC SYMDEF INIT(0); /* RECORD TRUNCATED COUNT     */
      276     7195    1   DCL IF_LEVEL UBIN WORD STATIC SYMDEF;   /* IF PROCESSING                      */
      277     7196    1   DCL TEMP_IF_LEVEL UBIN WORD STATIC SYMDEF; /* TEMP IF PROCESSING              */
      278     7197    1   DCL I UBIN(36) STATIC SYMDEF;           /* INDEX                              */
      279     7198    1   DCL M$FILE_NUM UBIN(36) STATIC SYMDEF INIT(DCBNUM(M$FILE));
      280     7199    1   DCL M$FILE2_NUM UBIN(36) STATIC SYMDEF INIT(DCBNUM(M$FILE2));
      281     7200    1   DCL SEED UBIN(36) STATIC SYMDEF INIT(0); /* ENCRYPTION                        */
      282     7201    1   DCL NUM_TABS UBIN(36) STATIC SYMDEF INIT(0); /* NUMBER OF TAB STOPS           */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:122  
      283     7202    1   DCL MK_COUNT UBIN WORD STATIC SYMDEF;   /* MK BLOCK MOVE REC COUNT            */
      284     7203    1   DCL FRST2DEL UBIN WORD STATIC SYMDEF;   /* FIRST TO DELETE IN MK BLOCK        */
      285     7204    1   DCL VERIFY_TYPE UBIN WORD STATIC SYMDEF; /* HOW TO VERIFY                     */
      286     7205        /**/
      287     7206    1   DCL P$ PTR STATIC SYMDEF;               /* TEMP PTR                           */
      288     7207    1   DCL INDX UBIN WORD STATIC SYMDEF ;      /* TEMP INDEX.                        */
      289     7208    1   DCL M$SI$ PTR STATIC SYMDEF;
      290     7209    1   DCL M$UC$ PTR STATIC SYMDEF;
      291     7210    1   DCL M$FILE$ PTR STATIC SYMDEF;          /* POINTER TO M$FILE                  */
      292     7211    1   DCL M$FILE2$ PTR STATIC SYMDEF;
      293     7212    1   DCL M$DCB$ PTR STATIC ;
      294     7213    1   DCL CMD$ PTR STATIC SYMDEF;
      295     7214    1   DCL CMD_BASE$ PTR STATIC SYMDEF;
      296     7215    1   DCL CMD_END$ PTR STATIC SYMDEF;
      297     7216    1   DCL CMDBUF$ PTR STATIC SYMDEF;
      298     7217    1   DCL CMDBUF_BASE$ PTR STATIC SYMDEF;
      299     7218    1   DCL CMDBUF_END$ PTR STATIC SYMDEF;
      300     7219    1   DCL SSE$ PTR STATIC SYMDEF ;            /* POINTER TO SSE_TBL        */
      301     7220    1   DCL SSE_INIT$ PTR STATIC SYMDEF ;       /* POINTER TO SSE_TBL */
      302     7221    1   DCL MK_BASE$ PTR STATIC SYMDEF;         /* MK MOVE PTRS                       */
      303     7222    1   DCL MK_WORK$ PTR STATIC SYMDEF;
      304     7223    1   DCL MK_BOUND$ PTR STATIC SYMDEF;
      305     7224    1   DCL COPYDS_PTR$ PTR STATIC SYMDEF;      /* COPY/MERGE DATA SEG. PTR           */
      306     7225    1   DCL STR_TEXT$ PTR STATIC SYMDEF;        /* POINTS TO NEXT TEXT STRING AREA    */
      307     7226    1   DCL STR_TEXT_HEAD$ PTR STATIC SYMDEF;   /* START OF TEXT SEGMENT              */
      308     7227    1   DCL STR_TEXT_END$ PTR STATIC SYMDEF;
      309     7228    1   DCL STR_TEXT_SE$ PTR STATIC SYMDEF;     /* END OF 'SE' STRINGS IN SEGMENT     */
      310     7229    1   DCL STR_TEXT_QM$ PTR STATIC SYMDEF;     /* START OF ? STRING TEXT             */
      311     7230    1   DCL BLK$ PTR STATIC;                    /* POINTS TO PARSE BLOCKS */
      312     7231        /**/
      313     7232    1   DCL REMEM_CMD_READ REMEMBER STATIC SYMDEF; /* REMEMBER VAR.                   */
      314     7233    1   DCL REMEM_STEP_CMD REMEMBER STATIC SYMDEF;
      315     7234        /**/
      316     7235    1   DCL 1 FLAGS STATIC SYMDEF,              /* FLAGS                              */
      317     7236    1          2 EDIT_MODE BIT(1) UNAL INIT('0'B), /* FILE CURRENTLY OPEN              */
      318     7237    1          2 INTRA_CMD BIT(1) UNAL INIT('0'B), /* INTRA RECORD COMMANDS RECIEVED   */
      319     7238    1          2 STEP_MODE BIT(1) UNAL INIT('0'B), /* SS OR ST COMMAND RECIEVED        */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:123  
      320     7239    1          2 NEWLINE_FLAG BIT(1) UNAL INIT('0'B), /* NEWLINE COMMAND RECIEVED      */
      321     7240    1          2 EXISTS BIT (1) UNAL INIT('0'B), /* REQUESTED RECORD EXISTS            */
      322     7241    1          2 EOF BIT(1) UNAL INIT('0'B),    /* END OF FILE ON SEQUEN READ         */
      323     7242    1          2 ST_CMD BIT(1) UNAL INIT('0'B), /* STCMD IF TRUE ELSE SS              */
      324     7243    1          2 CONSEC_MODE BIT(1) UNAL INIT('0'B), /* CONSECUTIVE FILE OPEN          */
      325     7244    1          2 BPFLAG BIT(1) UNAL INIT('1'B), /* DEFAULT IS ON                      */
      326     7245    1          2 CRFLAG BIT(1) UNAL INIT('0'B),
      327     7246    1          2 RPFLAG BIT(1) UNAL INIT('0'B),
      328     7247    1          2 TABXFLAG BIT(1) UNAL INIT('0'B),
      329     7248    1          2 TXFLAG BIT(1) UNAL INIT('0'B),
      330     7249    1          2 RFFLAG BIT(1) UNAL INIT('0'B),
      331     7250    1          2 NOCOMPCMD BIT(1) UNAL INIT('0'B), /* LAST COMMAND CANT BE COMPOUNDED  */
      332     7251    1          2 FIRSTCMD BIT(1) UNAL INIT('0'B), /* CURRENT COMMAND IS THE FIRST      */
      333     7252    1          2 IBEX_BUILD BIT(1) UNAL INIT('0'B), /* BUILD CALL FROM CP              */
      334     7253    1          2 TABCFLAG BIT(1) UNAL INIT('0'B),
      335     7254    1          2 REL_MODE BIT(1) UNAL INIT(FALSE),
      336     7255    1          2 OVERFLOWMSG BIT(1) UNAL INIT('0'B), /* OVERFLOW MESSAGE GIVEN         */
      337     7256    1          2 UNDRFLOWMSG BIT(1) UNAL INIT('0'B), /* UNDERFLOW MESSAGE GIVEN        */
      338     7257    1          2 TABMSG BIT(1) UNAL INIT('0'B), /* TAB MESSAGE GIVEN                  */
      339     7258    1          2 STRCHGCMD BIT(1) UNAL INIT('0'B), /* COMMAND TRIES TO ALTER STRINGS   */
      340     7259    1          2 VERIFY BIT(1) UNAL INIT('0'B),
      341     7260    1          2 RLFLAG BIT(1) UNAL INIT('0'B),
      342     7261    1          2 NOFLAG BIT(1) UNAL INIT('0'B),
      343     7262    1          2 DELRECCMD BIT(1) UNAL INIT('0'B),
      344     7263    1          2 OLINPROG BIT(1) UNAL INIT('0'B),
      345     7264    1          2 BREAK BIT(1) UNAL INIT('0'B),
      346     7265    1          2 INPUT BIT(1) UNAL INIT('0'B),
      347     7266    1          2 HTEXT BIT(1) UNAL INIT('1'B),  /* HELP TEXT RECORD SPECIFIED.        */
      348     7267    1          2 HDICT BIT(1) UNAL INIT('0'B),  /* HELP DICTIONARY RECORD SPECIFIED.  */
      349     7268    1          2 HSYN BIT(1) UNAL INIT('0'B),   /* HELP SYNONYM RECORD SPECIFIED.     */
      350     7269    1          2 RECVDCR BIT(1) UNAL INIT('0'B), /* RECEIVED ONE CARRIAGE RETURN.     */
      351     7270    1          2 HELP_MODE BIT(1) UNAL INIT('1'B),/* HELP message, not ERROR message.  */
      352     7271    1          2 PARS_ERR BIT(1) UNAL INIT('0'B) ,/* Last CMD_READ caused parse error. */
      353     7272    1          2 CUTOFF BIT(1) UNAL INIT('0'B) , /* Cutoff occured in a MERGE op.     */
      354     7273    1          2 BADKEY BIT(1) UNAL ,
      355     7274    1          2 CCBUFLG BIT(1) UNAL INIT('0'B),
      356     7275    1          2 BPFLAG_SAV BIT(1) UNAL INIT('1'B), /* Save the BP over the RF CMD */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:124  
      357     7276    1          2 ROUNDFLAG BIT(1) UNAL INIT ('0'B), /* Should keys be rounded to INCR */
      358     7277    1          2 * BIT(31) UNAL ;
      359     7278        /**/
      360     7279    1   DCL 1 SSE_PARAM STATIC SYMDEF,          /* STRING SEL. PARAMETER              */
      361     7280    1          2 FLAGS,
      362     7281    1             3 CLMNFLAG BIT(1) UNAL,
      363     7282    1             3 NOTFLAG BIT(1) UNAL,
      364     7283    1             3 ANDFLAG BIT(1) UNAL,
      365     7284    1             3 ORFLAG BIT(1) UNAL,
      366     7285    1             3 EORFLAG BIT(1) UNAL,
      367     7286    1             3 * BIT(13) UNAL,
      368     7287    1          2 J SBIN HALF UNAL,
      369     7288    1          2 PTR$ PTR UNAL;
      370     7289        /**/
      371     7290        /*B*     SSE_PARAM AN SSE_PARAM IS A TWO WORD ENTRY WHICH IS USED IN
      372     7291                           SSE_TBL TO DESCRIBE A SELECTION CRITERIA STRING AND
      373     7292                           IN CMD_TBL TO DESCRIBE A COLUMN NUMBER OR A STRING
      374     7293                           WHICH MIGHT BE PRECEDED BY AN OCCURANCE NUMBER
      375     7294        *
      376     7295                           SSE_PARAM  ***************************************
      377     7296                                      *CNAOE             *         J        *
      378     7297                                      ***************************************
      379     7298                                      *         PTR$  OR   CLMN             *
      380     7299                                      ***************************************
      381     7300        *
      382     7301                           C - CLMNFLAG - IF SET SECOND WORD OF SSE_PARAM IS A
      383     7302                                COLUMN NUMBER ELSE IT IS A POINTER TO A TEXTC
      384     7303                                STRING
      385     7304                           N - NOTFLAG - THE LOGICAL OPERATOR GIVEN IN THE
      386     7305                                STRING SELECTION EXPRESSION WAS 'NOT'
      387     7306                           A - ANDFLAG - 'AND' WAS THE LOGICAL OPERATOR SPECIFIED
      388     7307                           O - ORFLAG - 'OR' WAS THE LOGICAL OPERATOR SPECIFIEDD
      389     7308                           E - EORFLAG - 'EOR' WAS THE LOGICAL OPERATOR SPECIFIED
      390     7309                           NOTE: C IS ONLY MEANINGFUL IN CMD_TBL AND N,A,O,E
      391     7310                                ARE ONLY MEANINGFUL IN SSE_TBL
      392     7311                           J - OCCURANCE NUMBER IF STRING WAS GIVEN. J IS ONE(1)
      393     7312                                BY DEFAULT AND IS NOT MEANINGFUL IF CLMNFLAG IS SET.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:125  
      394     7313                           PTR$ OR CLMN - POINTER TO TEXTC STRING OR COLUMN NUMBER
      395     7314        */
      396     7315        /**/
      397     7316        %LIST;
      398     7317        %P_PCB    (T = CMD_BUF,
      399     7318                  R = P_ALLCMDS,
      400     7319                 NAME=P_GET,
      401     7320                 U$ = VEX$XPARSE_ENT,
      402     7321                 WSZ = 500);
              7322        /*F*  NAME:     P_PCB
              7323              FUNCTION: Parse Control Block.  This structure is used to pass data
              7324                  to the X$PARSE utility, and to receive X$PARSE's responses.
              7325        */
              7326         %LSET LISTDIR='0'B;
              7339    1   DCL 1 P_GET STATIC SYMDEF ALIGNED,
              7340    1         2 TEXT$ PTR INIT(ADDR(CMD_BUF))/**/,
              7344    1         2 ROOT$ PTR INIT(ADDR(P_ALLCMDS))/**/,
              7348    1         2 WORK$ PTR INIT(ADDR(NIL))/**/,
              7352    1         2 OUT$ PTR INIT(ADDR(NIL))/**/,
              7357    1         2 U$$ EPTR INIT(ENTADDR(VEX$XPARSE_ENT))/**/,
              7369    1         2 WKSZ UBIN(18) UNAL INIT(500)/**/,
              7374    1         2 CMPRS BIT(1) UNAL INIT('1'B)/**/,
              7380    1         2 CONTINUE BIT(1) UNAL INIT('1'B)/**/,
              7384    1         2 NOLEADBLANKS BIT(1) UNAL INIT('0'B)/**/,
              7389    1         2 NXT BIT(1) UNAL INIT('0'B)/**/,
              7406    1         2 DYNMEM BIT(1) UNAL INIT('0'B)/**/,
              7411    1         2 KEYWORDS BIT (1) INIT ('0'B) /**/,
              7426    1         2 BLANKONLY BIT (1),
              7434    1         2 NXT_SZONLY BIT(1) UNAL INIT('0'B)/**/,
              7442    1         2 * BIT (10) INIT ('0'B) /**/,
              7443    1         2 ERROR ALIGNED,
              7448    1           3 FCG BIT(12) UNAL INIT('0'B)/**/,
              7449    1           3 MID BIT(6) UNAL INIT('0'B)/**/,
              7450    1           3 MON BIT(1) UNAL INIT('0'B)/**/,
              7451    1           3 CODE UBIN(14) UNAL INIT(0)/**/,
              7452    1           3 SEV UBIN(3) UNAL INIT(0)/**/,
              7453    1         2 COMMENT ALIGNED,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:126  
              7457    1           3 LEAD CHAR(2) UNAL INIT(' "')/**/,
              7465    1           3 TRAIL CHAR(2) UNAL INIT(' "')/**/,
              7472    1         2 WK_USED UBIN(18) UNAL INIT(0)/**/,
              7476    1         2 VERSION_CODE UBIN(4) UNAL INIT(1)/**/,
              7481    1         2 OUTDCB# UBIN(14) UNAL INIT(DCBNUM(NIL))/**/,
              7486    1         2 NCHARS UBIN WORD INIT(0)/**/,
              7490    1         2 HI_CHAR UBIN WORD INIT(0)/**/,
              7497    1         2 HINODE$ PTR INIT(ADDR(NIL))/**/,
              7506    1         2 USER$ PTR INIT(ADDR(NIL))/**/,
              7512    1         2 OUTENT$ EPTR INIT(ENTADDR(NIL))/**/;
      403     7520        %P_PCB    (T = CMD_BUF,
      404     7521                  R = P_ALLCMDS,
      405     7522                 U$ = VEX$XPARSE_ENT,
      406     7523                 WSZ = 100);
              7524        /*F*  NAME:     P_PCB
              7525              FUNCTION: Parse Control Block.  This structure is used to pass data
              7526                  to the X$PARSE utility, and to receive X$PARSE's responses.
              7527        */
              7528         %LSET LISTDIR='0'B;
              7541    1   DCL 1 P_PCB STATIC SYMDEF ALIGNED,
              7542    1         2 TEXT$ PTR INIT(ADDR(CMD_BUF))/**/,
              7546    1         2 ROOT$ PTR INIT(ADDR(P_ALLCMDS))/**/,
              7550    1         2 WORK$ PTR INIT(ADDR(NIL))/**/,
              7554    1         2 OUT$ PTR INIT(ADDR(NIL))/**/,
              7559    1         2 U$$ EPTR INIT(ENTADDR(VEX$XPARSE_ENT))/**/,
              7571    1         2 WKSZ UBIN(18) UNAL INIT(100)/**/,
              7576    1         2 CMPRS BIT(1) UNAL INIT('1'B)/**/,
              7582    1         2 CONTINUE BIT(1) UNAL INIT('1'B)/**/,
              7586    1         2 NOLEADBLANKS BIT(1) UNAL INIT('0'B)/**/,
              7591    1         2 NXT BIT(1) UNAL INIT('0'B)/**/,
              7608    1         2 DYNMEM BIT(1) UNAL INIT('0'B)/**/,
              7613    1         2 KEYWORDS BIT (1) INIT ('0'B) /**/,
              7628    1         2 BLANKONLY BIT (1),
              7636    1         2 NXT_SZONLY BIT(1) UNAL INIT('0'B)/**/,
              7644    1         2 * BIT (10) INIT ('0'B) /**/,
              7645    1         2 ERROR ALIGNED,
              7650    1           3 FCG BIT(12) UNAL INIT('0'B)/**/,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:127  
              7651    1           3 MID BIT(6) UNAL INIT('0'B)/**/,
              7652    1           3 MON BIT(1) UNAL INIT('0'B)/**/,
              7653    1           3 CODE UBIN(14) UNAL INIT(0)/**/,
              7654    1           3 SEV UBIN(3) UNAL INIT(0)/**/,
              7655    1         2 COMMENT ALIGNED,
              7659    1           3 LEAD CHAR(2) UNAL INIT(' "')/**/,
              7667    1           3 TRAIL CHAR(2) UNAL INIT(' "')/**/,
              7674    1         2 WK_USED UBIN(18) UNAL INIT(0)/**/,
              7678    1         2 VERSION_CODE UBIN(4) UNAL INIT(1)/**/,
              7683    1         2 OUTDCB# UBIN(14) UNAL INIT(DCBNUM(NIL))/**/,
              7688    1         2 NCHARS UBIN WORD INIT(0)/**/,
              7692    1         2 HI_CHAR UBIN WORD INIT(0)/**/,
              7699    1         2 HINODE$ PTR INIT(ADDR(NIL))/**/,
              7708    1         2 USER$ PTR INIT(ADDR(NIL))/**/,
              7714    1         2 OUTENT$ EPTR INIT(ENTADDR(NIL))/**/;
      407     7722        %PLIST;
      408     7723        /**/
      409     7724             %XUG_GETCMD
      410     7725                ( NAME           = XUG$GETCMD_,
      411     7726                STCLASS        = "STATIC SYMDEF",
      412     7727                DCB_PARAM     = M$DO,
      413     7728                NODES          = P_ALLCMDS,
      414     7729                SFROUTINE      = VEX$XPARSE_ENT,
      415     7730                OUTDCB         = M$DO);
      416     8068
      417     8069             %XUG_INIT
      418     8070                ( NAME           = XUG$INIT_,
      419     8071                STCLASS        = STATIC,
      420     8072                ALWAYS_SET_PROMPT = NO,
      421     8073                COMMANDS       = YES,
      422     8074                GOODCMD        = NO,
      423     8075                PCB      = P_GET,
      424     8076                INHIBIT_DIRECTORY  = YES,
      425     8077                INHIBIT_END        = YES,
      426     8078                INHIBIT_OUTPUT     = YES,
      427     8079                INHIBIT_NULL       = YES,
      428     8080                SPHANDLE = CMD_CONTINUE,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:128  
      429     8081                SYNTAX         = YES ) ;
      430     8494
      431     8495        /**/
      432     8496    1   DCL 1 DS_RESULTS DALIGNED STATIC SYMDEF,
      433     8497    1          2 BOUND UBIN(20) UNAL,
      434     8498    1          2 FLAGSV UBIN(11) UNAL,
      435     8499    1          2 * UBIN(5) UNAL,
      436     8500    1          2 PTR$ PTR UNAL;
      437     8501    1   DCL BREAK_ARS UBIN WORD STATIC SYMDEF INIT(0) ;
      438     8502    1   DCL ASN UBIN (9) STATIC ;               /* FID assignment type                */
      439     8503    1   DCL TBUF CHAR(4) STATIC ;               /* temp buffer.                       */
      440     8504    1   DCL GET_CMD_TBL (0:255) BIT(9) STATIC SYMDEF INIT ('0'B*0) ;
      441     8505    1   DCL DIR_BUF CHAR(33) STATIC ;           /* Text buffer.                       */
      442     8506        /**/
      443     8507        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:129  
      444     8508        /*****************************************************************************/
      445     8509        /*   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   CONSTANTS   */
      446     8510        /*****************************************************************************/
      447     8511    1   DCL MAX_SEQNUM UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003575360377'O));
      448     8512                                                /* 99999999+'003000000000'O           */
      449     8513    1   DCL MAX_CLMN UBIN(36) CONSTANT SYMDEF INIT(PC_RECSIZE#);
      450     8514    1   DCL Y003 UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003000000000'O));
      451     8515    1   DCL CRET CHAR(1) CONSTANT SYMDEF INIT(BINASC(13)); /* O'015' IS CR            */
      452     8516    1   DCL NEWLINE CHAR(1) CONSTANT SYMDEF INIT(BINASC(10)); /* O'012' IS LF         */
      453     8517    1   DCL EOT CHAR(1) CONSTANT INIT(BINASC(4)); /* '004'O IS EOT */
      454     8518    1   DCL BSPACECHAR CHAR(1) CONSTANT SYMDEF INIT (BINASC(8)); /* O'010' IS BS      */
      455     8519    1   DCL TABCHAR CHAR(1) CONSTANT SYMDEF INIT(BINASC(9)); /* O'011' IS HT          */
      456     8520    1   DCL SINGLE_AST CHAR(1) CONSTANT SYMDEF INIT('*'); /* Prompt for CMD line   */
      457     8521    1   DCL GTAST CHAR(2) CONSTANT SYMDEF INIT('>*'); /* Prompt for Cont line   */
      458     8522    1   DCL BLANKS CHAR(4) CONSTANT SYMDEF INIT('    ');
      459     8523    1   DCL SEQNUM_ONE UBIN(36) CONSTANT SYMDEF INIT(BITBIN('003000001750'O));
      460     8524    1   DCL 1 NEWLINE_CNTRLWD CONSTANT,
      461     8525    1          2 FLAGS,
      462     8526    1             3 ENDCT BIT(1) UNAL INIT('0'B),
      463     8527    1             3 * BIT(17) UNAL,
      464     8528    1          2 OFFSET UBIN(9) UNAL INIT (SIZEW(CMD_CNTRLWD)),
      465     8529    1          2 CMD_CODE UBIN(9) UNAL INIT(NEWLINECMD);
      466     8530    1   DCL CMD_SPACE_EXHAUSTED REMEMBER ;
      467     8531        /**/
      468     8532        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:130  
      469     8533        /**********************************************************************/
      470     8534        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      471     8535        /**********************************************************************/
      472     8536    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
      473     8537    1          2 FLAGS,
      474     8538    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
      475     8539    1             3 * BIT(17) UNAL,
      476     8540    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
      477     8541    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
      478     8542    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
      479     8543    1          2 FLAGS,
      480     8544    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
      481     8545                                                                   ELSE PTR$ */
      482     8546    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
      483     8547    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
      484     8548    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
      485     8549    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
      486     8550    1             3 * BIT(13) UNAL,
      487     8551    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
      488     8552    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
      489     8553    1   DCL 1 STR$BUF BASED ALIGNED,
      490     8554    1          2 COUNT UBIN(9) UNAL,
      491     8555    1          2 TEXT CHAR(255) UNAL;
      492     8556    1   DCL CMD$BUF CHAR(256)  BASED;
      493     8557        /**/
      494     8558        %XUG_RLT   (STCLASS = BASED);
      495     8565        %PARSE$OUT (STCLASS = BASED);
      496     8610        %PARSE$SYM (NAME = OUT$SYM, STCLASS = BASED);
      497     8648        %B$TCB ;
      498     8651        %B$ALT ;
      499     8659        /**/
      500     8660    1   DCL 1 ED_CMD_TBL BASED ALIGNED,         /* EDIT AND DELETE                    */
      501     8661    1          2 * BIT(36) UNAL,
      502     8662    1          2 FID$ PTR;
      503     8663    1   DCL 1 B_CMD_TBL BASED ALIGNED,          /* BUILD COMMAND                      */
      504     8664    1          2 * BIT(36) UNAL,
      505     8665    1          2 FID$ PTR UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:131  
      506     8666    1          2 SEQNUM UBIN(36) UNAL,
      507     8667    1          2 INCR UBIN(36) UNAL,
      508     8668    1          2 TYPE CHAR(2) UNAL;
      509     8669    1   DCL 1 B_HELP_CMD_TBL BASED ALIGNED,     /* BUILD COMMAND                      */
      510     8670    1          2 * BIT(36) UNAL,
      511     8671    1          2 FID$ PTR UNAL,
      512     8672    1          2 HELPKEY CHAR(64) UNAL,
      513     8673    1          2 INCR UBIN WORD UNAL,
      514     8674    1          2 TYPE CHAR(2) UNAL;
      515     8675    1   DCL 1 C_CMD_TBL BASED ALIGNED,          /* COPY COMMAND                       */
      516     8676    1          2 * BIT(36) UNAL,
      517     8677    1          2 FID$ PTR UNAL,
      518     8678    1          2 FID2$ PTR UNAL,
      519     8679    1          2 ONOVER CHAR(4) UNAL,
      520     8680    1          2 SEQNUM UBIN(36) UNAL,
      521     8681    1          2 INCR UBIN(36) UNAL,
      522     8682    1          2 TYPE CHAR(2) UNAL;
      523     8683    1   DCL 1 M_CMD_TBL BASED ALIGNED,          /* MERGE COMMAND                      */
      524     8684    1          2 * BIT(36) UNAL,
      525     8685    1          2 FID$ PTR UNAL,
      526     8686    1          2 LO_SEQNUM,
      527     8687    1             3 KEY UBIN WORD UNAL ,
      528     8688    1          2 HI_SEQNUM ,
      529     8689    1             3 KEY UBIN WORD UNAL ,
      530     8690    1          2 ONOVER UBIN WORD UNAL,
      531     8691    1          2 FID2$ PTR UNAL,
      532     8692    1          2 LO_SEQNUM2 ,
      533     8693    1             3 KEY UBIN WORD UNAL ,
      534     8694    1          2 HI_SEQNUM2,
      535     8695    1             3 KEY UBIN WORD UNAL ,
      536     8696    1          2 INCR UBIN(36) UNAL;
      537     8697    1   DCL 1 HELP_CMD_TBL BASED ALIGNED,
      538     8698    1          2 * BIT(36) UNAL,
      539     8699    1          2 CMD_CODE UBIN(36) UNAL;
      540     8700    1   DCL 1 IN_CMD_TBL BASED ALIGNED,         /*IN,IP,IS,RN,DE,AD,RR CMDS           */
      541     8701    1          2 * BIT(36) UNAL,
      542     8702    1          2 LO_SEQNUM UBIN(36) UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:132  
      543     8703    1          2 HI_SEQNUM UBIN(36) UNAL,
      544     8704    1          2 START_SPEC UBIN(36) UNAL,      /* DID USER SPECIFY A START */
      545     8705    1          2 COLUMN SBIN WORD UNAL;
      546     8706    1   DCL 1 IN_HELP_CMD_TBL BASED ALIGNED, /*IN,IP,IS,RN,DE,AD,RR CMDS FOR HELP KEYS  */
      547     8707    1          2 * BIT(36) UNAL,
      548     8708    1          2 LO_KEY CHAR(64) UNAL,
      549     8709    1          2 HI_KEY CHAR(64) UNAL ,
      550     8710    1          2 INCR UBIN WORD UNAL ;
      551     8711    1   DCL 1 STR_CMD_TBL BASED ALIGNED,        /* AEOFPS COMMANDS                    */
      552     8712    1          2 * BIT(36) UNAL,
      553     8713    1          2 SSE_PARAM,
      554     8714    1             3 FLAGS,
      555     8715    1                4 CLMNFLAG BIT(1) UNAL,
      556     8716    1                4 NOTFLAG BIT(1) UNAL,
      557     8717    1                4 ANDFLAG BIT(1) UNAL,
      558     8718    1                4 ORFLAG BIT(1) UNAL,
      559     8719    1                4 EORFLAG BIT(1) UNAL,
      560     8720    1                4 * BIT(13) UNAL,
      561     8721    1             3 J SBIN HALF UNAL,
      562     8722    1             3 PTR$ PTR UNAL,
      563     8723    1          2 SSE_PARAM2,
      564     8724    1             3 FLAGS,
      565     8725    1                4 CLMNFLAG BIT(1) UNAL,
      566     8726    1                4 NOTFLAG BIT(1) UNAL,
      567     8727    1                4 ANDFLAG BIT(1) UNAL,
      568     8728    1                4 ORFLAG BIT(1) UNAL,
      569     8729    1                4 EORFLAG BIT(1) UNAL,
      570     8730    1                4 * BIT(13) UNAL,
      571     8731    1             3 J SBIN HALF UNAL,
      572     8732    1             3 PTR$ PTR UNAL;
      573     8733    1   DCL 1 D_CMD_TBL BASED ALIGNED,          /* D COMMAND                          */
      574     8734    1          2 * BIT(36) UNAL,
      575     8735    1          2 SSE_PARAM,
      576     8736    1             3 FLAGS,
      577     8737    1                4 CLMNFLAG BIT(1) UNAL,
      578     8738    1                4 NOTFLAG BIT(1) UNAL,
      579     8739    1                4 ANDFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:133  
      580     8740    1                4 ORFLAG BIT(1) UNAL,
      581     8741    1                4 EORFLAG BIT(1) UNAL,
      582     8742    1                4 * BIT(13) UNAL,
      583     8743    1             3 J SBIN HALF UNAL,
      584     8744    1             3 PTR$ PTR UNAL;
      585     8745    1   DCL 1 RL_CMD_TBL BASED ALIGNED,         /* R,L COMMANDS                       */
      586     8746    1          2 * BIT(36) UNAL,
      587     8747    1          2 SSE_PARAM,
      588     8748    1             3 FLAGS,
      589     8749    1                4 CLMNFLAG BIT(1) UNAL,
      590     8750    1                4 NOTFLAG BIT(1) UNAL,
      591     8751    1                4 ANDFLAG BIT(1) UNAL,
      592     8752    1                4 ORFLAG BIT(1) UNAL,
      593     8753    1                4 EORFLAG BIT(1) UNAL,
      594     8754    1                4 * BIT(13) UNAL,
      595     8755    1             3 J SBIN HALF UNAL,
      596     8756    1             3 PTR$ PTR UNAL,
      597     8757    1          2 SHIFT# UBIN(36) UNAL;
      598     8758    1   DCL 1 CM_CMD_TBL BASED ALIGNED,         /* CM,CT COMMANDS                     */
      599     8759    1          2 * BIT(36) UNAL,
      600     8760    1          2 SEQNUM UBIN(36) UNAL,
      601     8761    1          2 LO_CLMN UBIN(36) UNAL,
      602     8762    1          2 HI_CLMN UBIN(36) UNAL;
      603     8763    1   DCL 1 MK_CMD_TBL BASED ALIGNED,         /* MK,MD COMMANDS                     */
      604     8764    1          2 * BIT(36) UNAL,
      605     8765    1          2 LO_SEQNUM UBIN(36) UNAL,
      606     8766    1          2 HI_SEQNUM UBIN(36) UNAL,
      607     8767    1          2 LO_SEQNUM2 UBIN(36) UNAL,
      608     8768    1          2 HI_SEQNUM2 UBIN(36) UNAL,
      609     8769    1          2 INCR UBIN(36) UNAL;
      610     8770    1   DCL 1 TA_CMD_TBL BASED ALIGNED,         /* TABS AND STATUS                    */
      611     8771    1          2 * BIT(36) UNAL,
      612     8772    1          2 TABS(0:30) UBIN(9) UNAL,
      613     8773    1          2 NUM_TABS UBIN(9) UNAL;
      614     8774    1   DCL 1 BP_CMD_TBL BASED ALIGNED,
      615     8775    1          2 * BIT(36) UNAL,
      616     8776    1          2 TEXT CHAR(4) UNAL;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:134  
      617     8777    1   DCL 1 JU_CMD_TBL BASED ALIGNED,         /* JU COMMAND                         */
      618     8778    1          2 * BIT(36) UNAL,
      619     8779    1          2 HELPKEY CHAR(64) UNAL ,
      620     8780    1          2 EDITKEY REDEF HELPKEY ,
      621     8781    1             3 SEQNUM UBIN(36) UNAL ,
      622     8782    1             3 * CHAR (60) UNAL ;
      623     8783    1   DCL 1 CP_CMD_TBL BASED ALIGNED,         /* CP and CI commands.                */
      624     8784    1          2 * BIT(36) UNAL ,
      625     8785    1          2 SEQNUM UBIN WORD UNAL ,
      626     8786    1          2 LIMIT_SEQNUM UBIN WORD UNAL ,
      627     8787    1          2 INCR UBIN WORD UNAL ;
      628     8788    1   DCL 1 TYPE_CMD_TBL BASED ALIGNED,
      629     8789    1          2 * BIT(36) UNAL,
      630     8790    1          2 CODE CHAR(2);
      631     8791    1   DCL 1 FILE_CMD_TBL BASED ALIGNED,
      632     8792    1          2 * BIT(36) UNAL,
      633     8793    1          2 CODE UBIN WORD ;
      634     8794    1   DCL 1 TN_CMD_TBL BASED ALIGNED,
      635     8795    1          2 * BIT(36) UNAL,
      636     8796    1          2 COUNT UBIN WORD UNAL;
      637     8797    1   DCL 1 VE_CMD_TBL BASED ALIGNED,
      638     8798    1          2 * BIT(36) UNAL,
      639     8799    1          2 TYPE UBIN WORD UNAL;
      640     8800    1   DCL 1 IF_CMD_TBL BASED ALIGNED,
      641     8801    1          2 * BIT(36) UNAL,
      642     8802    1          2 LO_CLMN UBIN WORD UNAL,
      643     8803    1          2 HI_CLMN UBIN WORD UNAL,
      644     8804    1          2 SSE(0:0),
      645     8805    1             3 FLAGS,
      646     8806    1                4 CLMNFLAG BIT(1) UNAL,
      647     8807    1                4 NOTFLAG BIT(1) UNAL,
      648     8808    1                4 ANDFLAG BIT(1) UNAL,
      649     8809    1                4 ORFLAG BIT(1) UNAL,
      650     8810    1                4 EORFLAG BIT(1) UNAL,
      651     8811    1                4 * BIT(13) UNAL,
      652     8812    1             3 J SBIN HALF UNAL,
      653     8813    1             3 PTR$ PTR UNAL;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:135  
      654     8814    1   DCL 1 DIR_CMD_TBL BASED ALIGNED ,       /* DIRECTORY                          */
      655     8815    1          2 * BIT(36) UNAL ,
      656     8816    1          2 CODE UBIN WORD UNAL ,
      657     8817    1          2 ACCT CHAR(8) UNAL ,
      658     8818    1          2 PSN CHAR(6) UNAL ;
      659     8819    1   DCL 1 VARY$STRC BASED ALIGNED ,
      660     8820    1          2 CNT UBIN BYTE UNAL ,
      661     8821    1          2 TXT CHAR(VARY$STRC.CNT) UNAL ;
      662     8822        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:136  
      663     8823        /***********************************************************************/
      664     8824        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      665     8825        /**********************************************************************/
      666     8826    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;       /* GET NEXT RECORD                    */
      667     8827    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      668     8828    1   DCL VEX$FIND_MATCH ENTRY(4) ALTRET;
      669     8829    1   DCL VEX$FID_2_FPT ENTRY(3) ALTRET;
      670     8830    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      671     8831    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      672     8832    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      673     8833    1   DCL VEX$ERROR_NO_PRINT ENTRY(2) ALTRET;
      674     8834    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      675     8835    1   DCL VEX$ERRMAX ENTRY ALTRET;
      676     8836    1   DCL VEX$READ_TERM_REC ENTRY(3) ALTRET;
      677     8837    1   DCL VEX$TYPE_REC ENTRY(1);
      678     8838    1   DCL VEX$CLMN_DFLT ENTRY;
      679     8839    1   DCL VEX$FIELD_LEFT ENTRY(2);
      680     8840    1   DCL VEX$MOVE_LEFT ENTRY(2);
      681     8841    1   DCL VEX$COMP_RIGHT ENTRY(2);
      682     8842    1   DCL VEX$MOVE_RIGHT ENTRY(2);
      683     8843    1   DCL VEX$FIND_CLMN ENTRY(2) ALTRET;
      684     8844    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      685     8845    1   DCL VEX$SET_PROMPT ENTRY(1);
      686     8846    1   DCL VEX$BUILD_SEQNUM ENTRY(2) ALTRET;
      687     8847    1   DCL VEX$PARSE_SEQRANGE ENTRY(3) ALTRET;
      688     8848    1   DCL VEX$PARSE_CLMNRANGE ENTRY(3) ALTRET;
      689     8849    1   DCL VEX$PARSE_STRING ENTRY(2) ALTRET;
      690     8850    1   DCL VEX$PARSE_JSTRING ENTRY(3) ALTRET;
      691     8851    1   DCL VEX$PARSE_CLMNSTRING ENTRY(3) ALTRET;
      692     8852    1   DCL VEX$CHECK_FIRST ENTRY ALTRET;
      693     8853    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      694     8854    1   DCL VEX$BREAK ENTRY ASYNC;
      695     8855    1   DCL VEX$XPARSE_ENT ENTRY(1);
      696     8856    1   DCL VEM$MASTER ENTRY;
      697     8857    1   DCL VEX$XPAND ENTRY ALTRET;
      698     8858    1   DCL VEX$GET_NEXT_KEY ENTRY ALTRET;      /* GET NEXT RECORD KEY                */
      699     8859        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:137  
      700     8860    1   DCL X$PARSE ENTRY(1) ALTRET;
      701     8861    1   DCL CMD_CONTINUE ENTRY(2) ;             /* THIS MODULE RESIDES IN VEE$EDIT */
      702     8862        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:138  
      703     8863        /**/
      704     8864        /*****************************************************************/
      705     8865        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      706     8866        /*****************************************************************/
      707     8867    1   DCL 1 P_ALLCMDS SYMREF ALIGNED,         /* NODE MACRO                         */
      708     8868    1          2 TYPE UBIN(9) UNAL,
      709     8869    1          2 NSUBNDS UBIN(9) UNAL,
      710     8870    1          2 CODE UBIN(18) UNAL,
      711     8871    1          2 * EPTR UNAL,
      712     8872    1          2 * EPTR UNAL,
      713     8873    1          2 * EPTR UNAL,
      714     8874    1          2 *(0:0) PTR UNAL;
      715     8875        /**/
      716     8876        /**/
      717     8877        %FPT_ERRMSG  (FPTN = ERRMSG_FPT,
      718     8878                      OUTDCB1 = M$DO ,
      719     8879                      OUTDCB2 = M$ME ,
      720     8880                      STCLASS="SYMREF") ;
      721     8907        /**/
      722     8908    1   DCL B$JIT$ PTR SYMREF;
      723     8909    1   DCL B$TCB$ PTR SYMREF;
      724     8910    1   DCL 1 B_VERSION SYMREF ,
      725     8911    1          2 CNT UBIN BYTE UNAL,
      726     8912    1          2 TEXT CHAR(6) UNAL ;
      727     8913        /**/
      728     8914        %B$SR_NON_BLANK;
      729     8918
      730     8919        /********************************************************************/
      731     8920        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      732     8921        /********************************************************************/
      733     8922        /**/
      734     8923    1   DCL M$SI DCB;
      735     8924    1   DCL M$LM DCB;                           /* FOR ERROR MGS FILE */
      736     8925    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      737     8926    1   DCL M$FILE2 DCB;                        /* FOR MERGE AND COPY                 */
      738     8927    1   DCL M$DO DCB;                           /* ERROR MESSAGES                     */
      739     8928        %M$DCB (DCBN = M$ME,
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:139  
      740     8929                CTG = YES,
      741     8930                RES = 'ME',
      742     8931                DISP = NAMED,
      743     8932                FUN = CREATE);
      744     9006        /**/
      745     9007        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:140  
      746     9008        /*****************************************************************************/
      747     9009        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      748     9010        /*****************************************************************************/
      749     9011        /**/
      750     9012    1        M$SI$ = DCBADDR(DCBNUM(M$SI));

   9012  9 000002   000000 236007 xsym               LDQ     M$SI,DL
         9 000003   000000 470400 10                 LDP0    0
         9 000004   000000 471500                    LDP1    0,,PR0
         9 000005   100000 236106                    LDQ     0,QL,PR1
         9 000006   002652 756000 2                  STQ     M$SI$

      751     9013    1        M$FILE$ = DCBADDR(DCBNUM(M$FILE));

   9013  9 000007   000000 236007 xsym               LDQ     M$FILE,DL
         9 000010   100000 236106                    LDQ     0,QL,PR1
         9 000011   002654 756000 2                  STQ     M$FILE$

      752     9014    1        M$FILE2$ = DCBADDR(DCBNUM(M$FILE2));

   9014  9 000012   000000 236007 xsym               LDQ     M$FILE2,DL
         9 000013   100000 236106                    LDQ     0,QL,PR1
         9 000014   002655 756000 2                  STQ     M$FILE2$

      753     9015    1        M$UC$ = DCBADDR(DCBNUM(M$UC));

   9015  9 000015   000000 236007 xsym               LDQ     M$UC,DL
         9 000016   100000 236106                    LDQ     0,QL,PR1
         9 000017   002653 756000 2                  STQ     M$UC$

      754     9016        /**/
      755     9017    1        CALL M$INT (INT_FPT);

   9017  9 000020   000322 630400 1                  EPPR0   INT_FPT
         9 000021   010002 713400                    CLIMB   4098
         9 000022   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:141  
      756     9018        /**/
      757     9019    1        REMEMBER STEP_DONE IN REMEM_CMD_READ; /* BREAK RETURN                 */

   9019  9 000023   001057 635000 9                  EAA     STEP_DONE
         9 000024   002702 452400 2                  STP2    REMEM_CMD_READ
         9 000025   002703 755000 2                  STA     REMEM_CMD_READ+1

      758     9020    1        REMEMBER STEP_CMD_READ IN REMEM_STEP_CMD;

   9020  9 000026   000547 635000 9                  EAA     STEP_CMD_READ
         9 000027   002704 452400 2                  STP2    REMEM_STEP_CMD
         9 000030   002705 755000 2                  STA     REMEM_STEP_CMD+1

      759     9021        /**/
      760     9022    1        VE_ERRMSGACCT.ACCT# = DCBADDR(DCBNUM(M$LM)) -> F$DCB.ACCT;

   9022  9 000031   000000 236007 xsym               LDQ     M$LM,DL
         9 000032   000000 470400 10                 LDP0    0
         9 000033   000000 471500                    LDP1    0,,PR0
         9 000034   100000 473506                    LDP3    0,QL,PR1
         9 000035   300020 237100                    LDAQ    16,,PR3
         9 000036   000000 755000 xsym               STA     VE_ERRMSGACCT
         9 000037   000001 756000 xsym               STQ     VE_ERRMSGACCT+1

      761     9023        /**/
      762     9024    1        SSE$ = ADDR (SSE_TBL);

   9024  9 000040   200003 633500                    EPPR3   SSE_TBL,,AUTO
         9 000041   002665 453400 2                  STP3    SSE$

      763     9025    1        SSE_INIT$ = SSE$;

   9025  9 000042   002665 236000 2                  LDQ     SSE$
         9 000043   002666 756000 2                  STQ     SSE_INIT$

      764     9026    1        CALL VEX$CLMN_DFLT;                /* SET COLUMN LIMITS                  */

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:142  
   9026  9 000044   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000045   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         9 000046   000000 011000                    NOP     0

      765     9027        /**/
      766     9028    1        CALL M$OPEN (OPEN_ME);             /***/

   9028  9 000047   000006 630400 1                  EPPR0   OPEN_ME
         9 000050   050000 713400                    CLIMB   open
         9 000051   410400 401760                    pmme    nvectors=18

      767     9029    1        CALL M$OPEN (OPEN_DO);             /***/

   9029  9 000052   000100 630400 1                  EPPR0   OPEN_DO
         9 000053   050000 713400                    CLIMB   open
         9 000054   410400 401760                    pmme    nvectors=18

      768     9030    1        CALL XUG$INIT (XUG$GETCMD_,XUG$INIT_); /****/

   9030  9 000055   000001 630400 10                 EPPR0   1
         9 000056   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000057   000000 701000 xent               TSX1    XUG$INIT
         9 000060   000000 011000                    NOP     0

      769     9031        /**/
      770     9032    1        TAB_VLP = M$UC$ -> F$DCB.TAB$ -> TAB$VLP;

   9032  9 000061   002653 470400 2                  LDP0    M$UC$
         9 000062   000047 471500                    LDP1    39,,PR0
         9 000063   000000 100500                    MLR     fill='000'O
         9 000064   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
         9 000065   000166 000040 2                  ADSC9   TAB_VLP                  cn=0,n=32

      771     9033    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));

   9033  9 000066   000072 710000 9                  TRA     s:9035

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:143  
      772     9034    2           NUM_TABS = NUM_TABS + 1;

   9034  9 000067   002644 235000 2                  LDA     NUM_TABS
         9 000070   000001 035007                    ADLA    1,DL
         9 000071   002644 755000 2                  STA     NUM_TABS

      773     9035    2           END;

   9035  9 000072   002644 235000 2                  LDA     NUM_TABS
         9 000073   000100 101405                    MRL     fill='000'O
         9 000074   000166 200001 2                  ADSC9   TAB_VLP,A                cn=1,n=1
         9 000075   200414 000004                    ADSC9   IN_SLASH+1,,AUTO         cn=0,n=4
         9 000076   200414 236100                    LDQ     IN_SLASH+1,,AUTO
         9 000077   000000 116003                    CMPQ    0,DU
         9 000100   000103 600000 9                  TZE     s:9036
         9 000101   000037 115007                    CMPA    31,DL
         9 000102   000067 602000 9                  TNC     s:9034

      774     9036    1        SAVE_TAB_VLP = TAB_VLP;

   9036  9 000103   000000 100400                    MLR     fill='000'O
         9 000104   000166 000040 2                  ADSC9   TAB_VLP                  cn=0,n=32
         9 000105   000176 000040 2                  ADSC9   SAVE_TAB_VLP             cn=0,n=32

      775     9037    1        CALL CONCAT(TYPE_BUF.TEXT,'EDIT ',

   9037  9 000106   000000 236000 xsym               LDQ     B_VERSION
         9 000107   000033 772000                    QRL     27
         9 000110   040000 100400                    MLR     fill='040'O
         9 000111   000427 000005 1                  ADSC9   NEWLINE_CNTRLWD+1        cn=0,n=5
         9 000112   001450 200005 2                  ADSC9   TYPE_BUF                 cn=1,n=5
         9 000113   000000 620006                    EAX0    0,QL
         9 000114   040000 100440                    MLR     fill='040'O
         9 000115   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         9 000116   001451 402077 2                  ADSC9   TYPE_BUF+1               cn=2,n=1087
         9 000117   002077 116007                    CMPQ    1087,DL
         9 000120   000126 603000 9                  TRC     s:9039
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:144  
         9 000121   775700 620006                    EAX0    -1088,QL
         9 000122   777777 660003                    ERX0    -1,DU
         9 000123   040046 100400                    MLR     fill='040'O
         9 000124   000431 000005 1                  ADSC9   NEWLINE_CNTRLWD+3        cn=0,n=5
         9 000125   001451 400010 2                  ADSC9   TYPE_BUF+1,Q             cn=2,n=*X0

      776     9038    1           SUBSTR(B_VERSION.TEXT,0,B_VERSION.CNT),' here') ;
      777     9039    1        CALL VEX$TYPE_REC(TYPECR);

   9039  9 000126   000003 630400 10                 EPPR0   3
         9 000127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000130   000000 701000 xent               TSX1    VEX$TYPE_REC
         9 000131   000000 011000                    NOP     0

      778     9040        /**/
      779     9041    1        DS_RESULTS = FALSE;

   9041  9 000132   000000 235003                    LDA     0,DU
         9 000133   000000 236003                    LDQ     0,DU
         9 000134   003064 757000 2                  STAQ    DS_RESULTS

      780     9042    1        CALL M$GDS(GDS_FPT) ALTRET (NO_MEMORY);

   9042  9 000135   000000 630400 1                  EPPR0   GDS_FPT
         9 000136   430001 713400                    CLIMB   alt,gds
         9 000137   400400 401760                    pmme    nvectors=2
         9 000140   001175 702000 9                  TSX2    NO_MEMORY

      781     9043        /**/
      782     9044        /*One Data Segment is divided up into four pieces and used as follows:
      783     9045              STR_TEXT        - 412
      784     9046              Parse work area - 100
      785     9047              CMDBUF          - 412
      786     9048              CMD             - 100
      787     9049        for a total of 1024 words - 1 page.
      788     9050        Any time one of the areas is exhausted, VEX$XPAND is called to add
      789     9051        a page to the segment. The above sizes are added to each area.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:145  
      790     9052        */
      791     9053    1        STR_TEXT$ = DS_RESULTS.PTR$ ;

   9053  9 000141   003065 236000 2                  LDQ     DS_RESULTS+1
         9 000142   002673 756000 2                  STQ     STR_TEXT$

      792     9054    1        STR_TEXT_HEAD$ = STR_TEXT$;

   9054  9 000143   002674 756000 2                  STQ     STR_TEXT_HEAD$

      793     9055    1        STR_TEXT_SE$ = STR_TEXT$;

   9055  9 000144   002676 756000 2                  STQ     STR_TEXT_SE$

      794     9056    1        STR_TEXT_END$ = PINCRW(STR_TEXT$,412 );

   9056  9 000145   000634 036003                    ADLQ    412,DU
         9 000146   002675 756000 2                  STQ     STR_TEXT_END$

      795     9057        /**/
      796     9058    1        SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL); /* NO SELECTION CRITERIA          */

   9058  9 000147   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000150   002665 470400 2                  LDP0    SSE$
         9 000151   000001 756100                    STQ     1,,PR0

      797     9059    1        P_PCB.WORK$ = STR_TEXT_END$ ;

   9059  9 000152   002675 236000 2                  LDQ     STR_TEXT_END$
         9 000153   002732 756000 2                  STQ     P_PCB+2

      798     9060        /**/
      799     9061    1        CMDBUF$ = PINCRW(P_PCB.WORK$, 100) ;

   9061  9 000154   000144 036003                    ADLQ    100,DU
         9 000155   002662 756000 2                  STQ     CMDBUF$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:146  
      800     9062    1        CMDBUF_BASE$ = CMDBUF$;

   9062  9 000156   002663 756000 2                  STQ     CMDBUF_BASE$

      801     9063    1        CMDBUF_END$ = PINCRW(CMDBUF$,412 );

   9063  9 000157   000634 036003                    ADLQ    412,DU
         9 000160   002664 756000 2                  STQ     CMDBUF_END$

      802     9064        /**/
      803     9065    1        CMD$ = CMDBUF_END$;

   9065  9 000161   002657 756000 2                  STQ     CMD$

      804     9066    1        CMD_BASE$ = CMD$;

   9066  9 000162   002660 756000 2                  STQ     CMD_BASE$

      805     9067    1        CMD_END$ = PINCRW(CMD$,100 );

   9067  9 000163   000144 036003                    ADLQ    100,DU
         9 000164   002661 756000 2                  STQ     CMD_END$

      806     9068        /**/
      807     9069    1        FLAGS.BADKEY = FALSE ;

   9069  9 000165   000004 236000 10                 LDQ     4
         9 000166   002707 356000 2                  ANSQ    FLAGS+1

      808     9070    1        REMEMBER RAN_OUT_OF_CMD_SPACE IN CMD_SPACE_EXHAUSTED ;

   9070  9 000167   000346 635000 9                  EAA     RAN_OUT_OF_CMD_SPACE
         9 000170   200404 452500                    STP2    CMD_SPACE_EXHAUSTED,,AUTO
         9 000171   200405 755100                    STA     CMD_SPACE_EXHAUSTED+1,,AUTO

      809     9071    1        CMD_SIZE = B$JIT$ -> B$JIT.CCARS;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:147  
   9071  9 000172   000000 470400 xsym               LDP0    B$JIT$
         9 000173   000032 236100                    LDQ     26,,PR0
         9 000174   000022 732000                    QRS     18
         9 000175   002570 756000 2                  STQ     CMD_SIZE

      810     9072    1        CALL INSERT(CMDBUF$ -> CMD$BUF,0,CMD_SIZE,B$JIT$ -> B$JIT.CCBUF);

   9072  9 000176   002662 471400 2                  LDP1    CMDBUF$
         9 000177   000000 620006                    EAX0    0,QL
         9 000200   040140 100500                    MLR     fill='040'O
         9 000201   000033 000400                    ADSC9   27,,PR0                  cn=0,n=256
         9 000202   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      811     9073    2        DO WHILE('0'B);

   9073  9 000203   000234 710000 9                  TRA     s:9091

   9072  9 000204                       PARSE1_ERR   null
      812     9074    2   PARSE1_ERR: ;
      813     9075    2           IF FLAGS.CCBUFLG

   9075  9 000204   002707 236000 2                  LDQ     FLAGS+1
         9 000205   100000 316003                    CANQ    32768,DU
         9 000206   001213 601000 9                  TNZ     PARSE_ERR

      814     9076    2           THEN
      815     9077    2              GOTO PARSE_ERR;
      816     9078    2           CALL INDEX (I, ' ', SUBSTR(CMDBUF$->CMD$BUF,0,CMD_SIZE))

   9078  9 000207   002662 470400 2                  LDP0    CMDBUF$
         9 000210   002570 720000 2                  LXL0    CMD_SIZE
         9 000211   000000 124540                    SCM     mask='000'O
         9 000212   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         9 000213   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000214   002640 000000 2                  ARG     I
         9 000215   000223 606400 9                  TTN     s:9085

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:148  
      817     9079    2           WHENRETURN
      818     9080    3           DO;

      819     9081    3              CALL INSERT (SUBSTR(CMDBUF$->CMD$BUF,0,I),,,'E');

   9081  9 000216   002640 721000 2                  LXL1    I
         9 000217   040140 100400                    MLR     fill='040'O
         9 000220   000005 000001 10                 ADSC9   5                        cn=0,n=1
         9 000221   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      820     9082    3              END;

   9082  9 000222   000231 710000 9                  TRA     s:9088

      821     9083    2           WHENALTRETURN
      822     9084    3           DO;

      823     9085    3              CALL INSERT (SUBSTR(CMDBUF$->CMD$BUF,0,4),,,'EDIT');

   9085  9 000223   002662 470400 2                  LDP0    CMDBUF$
         9 000224   040100 100400                    MLR     fill='040'O
         9 000225   000427 000004 1                  ADSC9   NEWLINE_CNTRLWD+1        cn=0,n=4
         9 000226   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      824     9086    3              CMD_SIZE=4;

   9086  9 000227   000004 235007                    LDA     4,DL
         9 000230   002570 755000 2                  STA     CMD_SIZE

      825     9087    3              END;

      826     9088    2           FLAGS.CCBUFLG='1'B;

   9088  9 000231   100000 236003                    LDQ     32768,DU
         9 000232   002707 256000 2                  ORSQ    FLAGS+1

      827     9089    2           CMD_INDEX = 0;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:149  

   9089  9 000233   002624 450000 2                  STZ     CMD_INDEX

      828     9090    2           END;

      829     9091    1        CALL GET_CMD;

   9091  9 000234   001744 701000 9                  TSX1    GET_CMD
         9 000235   000000 011000                    NOP     0

      830     9092    1        CALL X$PARSE(P_PCB) ALTRET(PARSE1_ERR);

   9092  9 000236   000006 630400 10                 EPPR0   6
         9 000237   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000240   000000 701000 xent               TSX1    X$PARSE
         9 000241   000204 702000 9                  TSX2    PARSE1_ERR

      831     9093    1        FLAGS.PARS_ERR = '0'B ;

   9093  9 000242   000007 236000 10                 LDQ     7
         9 000243   002706 356000 2                  ANSQ    FLAGS

      832     9094    1        CALL CHECK_CMD ALTRET (CMD_READ);

   9094  9 000244   002403 701000 9                  TSX1    CHECK_CMD
         9 000245   000255 702000 9                  TSX2    CMD_READ

      833     9095    1        IF (CMD_CODE = BUILDCMD) THEN FLAGS.IBEX_BUILD = TRUE;

   9095  9 000246   002625 235000 2                  LDA     CMD_CODE
         9 000247   000027 115007                    CMPA    23,DL
         9 000250   000253 601000 9                  TNZ     s:9096

   9095  9 000251   000002 236003                    LDQ     2,DU
         9 000252   002706 256000 2                  ORSQ    FLAGS

      834     9096    1        IF (CMD_CODE ~= ENDCMD) THEN GOTO CMD_OK; /* 'E' MEANS EDIT           */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:150  

   9096  9 000253   000002 115007                    CMPA    2,DL
         9 000254   000431 601000 9                  TNZ     CMD_OK

      835     9097        /**/
      836     9098        /**/
      837     9099    1   CMD_READ:
      838     9100    2        IF (FLAGS.IBEX_BUILD) THEN DO ;

   9100  9 000255   002706 236000 2     CMD_READ     LDQ     FLAGS
         9 000256   000002 316003                    CANQ    2,DU
         9 000257   000266 600000 9                  TZE     s:9106

      839     9101    2           CALL M$CLOSE(CLOSE_FPT) ALTRET (IBEX_BUILD_CLOSE_ERR) ;

   9101  9 000260   000264 630400 1                  EPPR0   CLOSE_FPT
         9 000261   450001 713400                    CLIMB   alt,close
         9 000262   406000 401760                    pmme    nvectors=13
         9 000263   000264 702000 9                  TSX2    IBEX_BUILD_CLOSE_ERR

      840     9102
      841     9103    2   IBEX_BUILD_CLOSE_ERR:
      842     9104    2           CALL M$EXIT ;

   9104  9 000264   000001 713400       IBEX_BUILD_* CLIMB   exit
         9 000265   000000 401760                    pmme    nvectors=0

      843     9105    2           END ;                           /* THEN DO */

      844     9106    1        DELREC_COUNT = 0;

   9106  9 000266   002633 450000 2                  STZ     DELREC_COUNT

      845     9107    1        STRCHG_COUNT = 0;

   9107  9 000267   002634 450000 2                  STZ     STRCHG_COUNT

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:151  
      846     9108        /**/
      847     9109    1        CALL VEX$SET_PROMPT(PR_1AST);

   9109  9 000270   000003 630400 10                 EPPR0   3
         9 000271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000272   000000 701000 xent               TSX1    VEX$SET_PROMPT
         9 000273   000000 011000                    NOP     0

      848     9110    1        CALL READ_CMD;                     /* GET NEXT COMMAND LINE              */

   9110  9 000274   001275 701000 9                  TSX1    READ_CMD
         9 000275   000000 011000                    NOP     0

      849     9111        /**/
      850     9112    2        IF (FLAGS.NEWLINE_FLAG) THEN DO;

   9112  9 000276   002706 236000 2                  LDQ     FLAGS
         9 000277   040000 316003                    CANQ    16384,DU
         9 000300   000332 600000 9                  TZE     s:9125

      851     9113    2           CMD$ = CMD_BASE$;

   9113  9 000301   002660 236000 2                  LDQ     CMD_BASE$
         9 000302   002657 756000 2                  STQ     CMD$

      852     9114    2           CMD$ -> CMD_CNTRLWD = NEWLINE_CNTRLWD;

   9114  9 000303   000426 236000 1                  LDQ     NEWLINE_CNTRLWD
         9 000304   002657 470400 2                  LDP0    CMD$
         9 000305   000000 756100                    STQ     0,,PR0

      853     9115    2           CMD$ = PINCRW(CMD$,SIZEW(CMD_CNTRLWD));

   9115  9 000306   002657 236000 2                  LDQ     CMD$
         9 000307   000001 036003                    ADLQ    1,DU
         9 000310   002657 756000 2                  STQ     CMD$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:152  
      854     9116    2           CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;

   9116  9 000311   002657 470400 2                  LDP0    CMD$
         9 000312   400000 236003                    LDQ     -131072,DU
         9 000313   000000 256100                    ORSQ    0,,PR0

      855     9117    2           CALL VEM$MASTER;

   9117  9 000314   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000315   000000 701000 xent               TSX1    VEM$MASTER
         9 000316   000000 011000                    NOP     0

      856     9118    3           IF DELREC_COUNT > 0 THEN DO;

   9118  9 000317   002633 235000 2                  LDA     DELREC_COUNT
         9 000320   000331 600000 9                  TZE     s:9122

      857     9119    3              CALL VEX$SET_SUB_BUF(SUB_BUF_1,DELREC_COUNT);

   9119  9 000321   000010 630400 10                 EPPR0   8
         9 000322   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000323   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 000324   000000 011000                    NOP     0

      858     9120    3              CALL VEX$ERROR(E$E_RECSDEL,1);

   9120  9 000325   000013 630400 10                 EPPR0   11
         9 000326   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000327   000000 701000 xent               TSX1    VEX$ERROR
         9 000330   000000 011000                    NOP     0

      859     9121    3              END;

      860     9122    2           GOTO CMD_READ;

   9122  9 000331   000255 710000 9                  TRA     CMD_READ

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:153  
      861     9123    2           END;
      862     9124        /**/
      863     9125    1        FLAGS.STEP_MODE = FALSE;           /* RESET                              */

   9125  9 000332   000015 236000 10                 LDQ     13
         9 000333   002706 356000 2                  ANSQ    FLAGS

      864     9126    1        FLAGS.BADKEY = FALSE ;

   9126  9 000334   000004 236000 10                 LDQ     4
         9 000335   002707 356000 2                  ANSQ    FLAGS+1

      865     9127    1        IF (CMD_SIZE = 0) THEN GOTO CMD_READ; /* NULL CMD                     */

   9127  9 000336   002570 235000 2                  LDA     CMD_SIZE
         9 000337   000255 600000 9                  TZE     CMD_READ

      866     9128        /**/
      867     9129    2        DO WHILE (CMD_INDEX < CMD_SIZE);   /* LOOP THRU ALL CMDS                */

   9129  9 000340   002624 236000 2                  LDQ     CMD_INDEX
         9 000341   002570 116000 2                  CMPQ    CMD_SIZE
         9 000342   000371 603000 9                  TRC     s:9145

      868     9130    2           CALL GET_CMD ALTRET(CMD_READ);

   9130  9 000343   001744 701000 9                  TSX1    GET_CMD
         9 000344   000255 702000 9                  TSX2    CMD_READ

      869     9131    3           DO WHILE ('0'B) ;

   9131  9 000345   000356 710000 9                  TRA     CMD_RETRY

      870     9132
      871     9133    3   RAN_OUT_OF_CMD_SPACE:
      872     9134    3              CALL VEX$XPAND ALTRET (NO_MEMORY) ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:154  
   9134  9 000346   000002 631400 xsym  RAN_OUT_OF_* EPPR1   B_VECTNIL+2
         9 000347   000000 701000 xent               TSX1    VEX$XPAND
         9 000350   001175 702000 9                  TSX2    NO_MEMORY

      873     9135    3              CMD_INDEX = 0 ;

   9135  9 000351   002624 450000 2                  STZ     CMD_INDEX

      874     9136    3              CMD$ = CMD_BASE$ ;

   9136  9 000352   002660 236000 2                  LDQ     CMD_BASE$
         9 000353   002657 756000 2                  STQ     CMD$

      875     9137    3              STR_TEXT$ = STR_TEXT_HEAD$ ;

   9137  9 000354   002674 236000 2                  LDQ     STR_TEXT_HEAD$
         9 000355   002673 756000 2                  STQ     STR_TEXT$

      876     9138    3              END ;                        /* Do While */

      877     9139    2   CMD_RETRY:
      878     9140    2           CALL X$PARSE(P_PCB) ALTRET(PARSE_ERR);

   9140  9 000356   000006 630400 10    CMD_RETRY    EPPR0   6
         9 000357   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000360   000000 701000 xent               TSX1    X$PARSE
         9 000361   001213 702000 9                  TSX2    PARSE_ERR

      879     9141    2           FLAGS.PARS_ERR = '0'B ;

   9141  9 000362   000007 236000 10                 LDQ     7
         9 000363   002706 356000 2                  ANSQ    FLAGS

      880     9142    2           CALL CHECK_CMD ALTRET (CMD_READ);

   9142  9 000364   002403 701000 9                  TSX1    CHECK_CMD
         9 000365   000255 702000 9                  TSX2    CMD_READ
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:155  

      881     9143    2           END;

   9143  9 000366   002624 236000 2                  LDQ     CMD_INDEX
         9 000367   002570 116000 2                  CMPQ    CMD_SIZE
         9 000370   000343 602000 9                  TNC     s:9130

      882     9144        /**/
      883     9145    1        IF (FLAGS.INTRA_CMD)AND(FLAGS.VERIFY)AND

   9145  9 000371   002706 236000 2                  LDQ     FLAGS
         9 000372   200000 316003                    CANQ    65536,DU
         9 000373   000431 600000 9                  TZE     CMD_OK
         9 000374   010000 316007                    CANQ    4096,DL
         9 000375   000431 600000 9                  TZE     CMD_OK
         9 000376   002660 235000 2                  LDA     CMD_BASE$
         9 000377   000022 771000                    ARL     18
         9 000400   200414 755100                    STA     IN_SLASH+1,,AUTO
         9 000401   002657 236000 2                  LDQ     CMD$
         9 000402   000022 772000                    QRL     18
         9 000403   200414 136100                    SBLQ    IN_SLASH+1,,AUTO
         9 000404   000001 116007                    CMPQ    1,DL
         9 000405   000431 604400 9                  TMOZ    CMD_OK

      884     9146    2           (POFFW(CMD$,CMD_BASE$) > 1) THEN DO;

      885     9147    2           CMD$ -> CMD_CNTRLWD.FLAGS = FALSE;

   9147  9 000406   000000 220003                    LDX0    0,DU
         9 000407   002657 470400 2                  LDP0    CMD$
         9 000410   000000 740100                    STX0    0,,PR0

      886     9148    2           CMD$ -> CMD_CNTRLWD.CMD_CODE = VERIFY_TYPE;

   9148  9 000411   002657 470400 2                  LDP0    CMD$
         9 000412   002647 236000 2                  LDQ     VERIFY_TYPE
         9 000413   000000 552104                    STBQ    0,'04'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:156  

      887     9149    2           CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);

   9149  9 000414   002657 470400 2                  LDP0    CMD$
         9 000415   001000 236007                    LDQ     512,DL
         9 000416   000000 552110                    STBQ    0,'10'O,PR0

      888     9150    2           CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   9150  9 000417   002657 470400 2                  LDP0    CMD$
         9 000420   000000 236100                    LDQ     0,,PR0
         9 000421   000011 772000                    QRL     9
         9 000422   000777 376007                    ANQ     511,DL
         9 000423   000022 736000                    QLS     18
         9 000424   002657 036000 2                  ADLQ    CMD$
         9 000425   002657 756000 2                  STQ     CMD$

      889     9151    2           CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;

   9151  9 000426   002657 470400 2                  LDP0    CMD$
         9 000427   400000 236003                    LDQ     -131072,DU
         9 000430   000000 256100                    ORSQ    0,,PR0

      890     9152    2           END;

      891     9153        /**/
      892     9154    1   CMD_OK:
      893     9155    1        CMD$ = CMD_BASE$;

   9155  9 000431   002660 236000 2     CMD_OK       LDQ     CMD_BASE$
         9 000432   002657 756000 2                  STQ     CMD$

      894     9156    1        STR_TEXT_QM$ = STR_TEXT$;

   9156  9 000433   002673 236000 2                  LDQ     STR_TEXT$
         9 000434   002677 756000 2                  STQ     STR_TEXT_QM$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:157  
      895     9157        /**/
      896     9158    2        IF ((FLAGS.INTRA_CMD) OR (FLAGS.STEP_MODE)) THEN DO;
              9158                 /* CHECK RECORD FOR SEL. CRITERA */

   9158  9 000435   002706 236000 2                  LDQ     FLAGS
         9 000436   200000 316003                    CANQ    65536,DU
         9 000437   000442 601000 9                  TNZ     s:9159
         9 000440   100000 316003                    CANQ    32768,DU
         9 000441   000456 600000 9                  TZE     s:9167

      897     9159    2           CALL READ_FIRST_REC ALTRET (CMD_READ);

   9159  9 000442   002156 701000 9                  TSX1    READ_FIRST_REC
         9 000443   000255 702000 9                  TSX2    CMD_READ

      898     9160    2           IF ((CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT)AND(~FLAGS.STEP_MODE))

   9160  9 000444   002657 470400 2                  LDP0    CMD$
         9 000445   000000 234100                    SZN     0,,PR0
         9 000446   000454 605000 9                  TPL     NEXT_REC
         9 000447   002706 236000 2                  LDQ     FLAGS
         9 000450   000002 736000                    QLS     2
         9 000451   400000 376003                    ANQ     -131072,DU
         9 000452   400000 676003                    ERQ     -131072,DU
         9 000453   000255 601000 9                  TNZ     CMD_READ

      899     9161    2           THEN GOTO CMD_READ;             /* ONLY SE COMMAND GIVEN              */
      900     9162        /**/
      901     9163    2   NEXT_REC:
      902     9164    2           CALL CHECK_SSE ALTRET (READ_NEXT);

   9164  9 000454   002221 701000 9     NEXT_REC     TSX1    CHECK_SSE
         9 000455   000744 702000 9                  TSX2    READ_NEXT

      903     9165    2           END;

      904     9166        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:158  
      905     9167    2        IF (FLAGS.STEP_MODE) THEN DO;      /* READ COMMANDS FOR THIS REC.        */

   9167  9 000456   002706 236000 2                  LDQ     FLAGS
         9 000457   100000 316003                    CANQ    32768,DU
         9 000460   000717 600000 9                  TZE     s:9227

      906     9168    2           CALL VEX$SEQNUM_TEXT(LAST_KEY);

   9168  9 000461   000016 630400 10                 EPPR0   14
         9 000462   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000463   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         9 000464   000000 011000                    NOP     0

      907     9169    2           CALL VEX$SET_PROMPT(PR_2AST);

   9169  9 000465   000017 630400 10                 EPPR0   15
         9 000466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000467   000000 701000 xent               TSX1    VEX$SET_PROMPT
         9 000470   000000 011000                    NOP     0

      908     9170    3           IF (FLAGS.ST_CMD) THEN DO;

   9170  9 000471   002706 236000 2                  LDQ     FLAGS
         9 000472   004000 316003                    CANQ    2048,DU
         9 000473   000512 600000 9                  TZE     s:9176

      909     9171    3              CALL CONCAT(TYPE_BUF.TEXT,SEQ_TEXT_BUF,

   9171  9 000474   040000 100400                    MLR     fill='040'O
         9 000475   002523 000011 2                  ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         9 000476   001450 200011 2                  ADSC9   TYPE_BUF                 cn=1,n=9
         9 000477   040000 236007                    LDQ     16384,DL
         9 000500   001452 552010 2                  STBQ    TYPE_BUF+2,'10'O
         9 000501   002566 720000 2                  LXL0    REC_SIZE
         9 000502   040000 100440                    MLR     fill='040'O
         9 000503   000244 000010 2                  ADSC9   REC_BUF                  cn=0,n=*X0
         9 000504   001452 602072 2                  ADSC9   TYPE_BUF+2               cn=3,n=1082
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:159  

      910     9172    3                 ' ',SUBSTR(REC_BUF,0,REC_SIZE)) ;
      911     9173    3              CALL VEX$TYPE_REC(TYPECR);

   9173  9 000505   000003 630400 10                 EPPR0   3
         9 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000507   000000 701000 xent               TSX1    VEX$TYPE_REC
         9 000510   000000 011000                    NOP     0

      912     9174    3              END;

   9174  9 000511   000547 710000 9                  TRA     STEP_CMD_READ

      913     9175    3           ELSE DO;

      914     9176    3              CALL INDEX(I,':',SEQ_TEXT_BUF) ALTRET(NO_COLON) ;

   9176  9 000512   000000 124400                    SCM     mask='000'O
         9 000513   002523 000011 2                  ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         9 000514   000020 000001 10                 ADSC9   16                       cn=0,n=1
         9 000515   002640 000000 2                  ARG     I
         9 000516   000523 606400 9                  TTN     NO_COLON

      915     9177    3              CALL INSERT(SEQ_TEXT_BUF,I,1,' ') ;

   9177  9 000517   002640 235000 2                  LDA     I
         9 000520   040005 100400                    MLR     fill='040'O
         9 000521   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000522   002523 000001 2                  ADSC9   SEQ_TEXT_BUF,A           cn=0,n=1

      916     9178    3   NO_COLON:  TYPE_BUF.TEXT = SEQ_TEXT_BUF ;

   9178  9 000523   040000 100400       NO_COLON     MLR     fill='040'O
         9 000524   002523 000011 2                  ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         9 000525   001450 202104 2                  ADSC9   TYPE_BUF                 cn=1,n=1092

      917     9179    3              M$DCB$ = DCBADDR(IN_DCBNUM) ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:160  

   9179  9 000526   000000 470400 10                 LDP0    0
         9 000527   000000 471500                    LDP1    0,,PR0
         9 000530   001245 720000 2                  LXL0    IN_DCBNUM
         9 000531   100000 236110                    LDQ     0,X0,PR1
         9 000532   002656 756000 2                  STQ     M$DCB$

      918     9180                                           /* Test to stop print of rec. no. for SS */
      919     9181    3              IF (NOT(M$DCB$ -> F$DCB.DDEV.XEQ) AND

   9181  9 000533   002656 473400 2                  LDP3    M$DCB$
         9 000534   300004 236100                    LDQ     4,,PR3
         9 000535   040000 316007                    CANQ    16384,DL
         9 000536   000547 601000 9                  TNZ     STEP_CMD_READ
         9 000537   300032 236100                    LDQ     26,,PR3
         9 000540   777000 376007                    ANQ     -512,DL
         9 000541   001000 116007                    CMPQ    512,DL
         9 000542   000547 600000 9                  TZE     STEP_CMD_READ

      920     9182    3                 NOT(M$DCB$ -> F$DCB.ASN = %FILE#))
      921     9183    3              THEN
      922     9184    3                 CALL VEX$TYPE_REC(TYPENOCR);

   9184  9 000543   000017 630400 10                 EPPR0   15
         9 000544   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000545   000000 701000 xent               TSX1    VEX$TYPE_REC
         9 000546   000000 011000                    NOP     0

      923     9185    3              END;

      924     9186        /**/
      925     9187    2   STEP_CMD_READ: CALL READ_CMD;

   9187  9 000547   001275 701000 9     STEP_CMD_RE* TSX1    READ_CMD
         9 000550   000000 011000                    NOP     0

      926     9188        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:161  
      927     9189    2           IF (FLAGS.NEWLINE_FLAG) THEN GOTO READ_NEXT;

   9189  9 000551   002706 236000 2                  LDQ     FLAGS
         9 000552   040000 316003                    CANQ    16384,DU
         9 000553   000744 601000 9                  TNZ     READ_NEXT

      928     9190    2           IF (CMD_SIZE = 0) THEN GOTO STEP_DONE;

   9190  9 000554   002570 235000 2                  LDA     CMD_SIZE
         9 000555   001057 600000 9                  TZE     STEP_DONE

      929     9191    3           DO WHILE (CMD_INDEX < CMD_SIZE);

   9191  9 000556   002624 236000 2                  LDQ     CMD_INDEX
         9 000557   002570 116000 2                  CMPQ    CMD_SIZE
         9 000560   000650 603000 9                  TRC     s:9214

      930     9192        /**/
      931     9193    3              CALL GET_CMD ALTRET(STEP_CMD_READ);

   9193  9 000561   001744 701000 9                  TSX1    GET_CMD
         9 000562   000547 702000 9                  TSX2    STEP_CMD_READ

      932     9194    3   STEP_CMD_RETRY:
      933     9195    3              CALL X$PARSE(P_PCB) ALTRET(PARSE_ERR);

   9195  9 000563   000006 630400 10    STEP_CMD_RE* EPPR0   6
         9 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000565   000000 701000 xent               TSX1    X$PARSE
         9 000566   001213 702000 9                  TSX2    PARSE_ERR

      934     9196    3              FLAGS.PARS_ERR = '0'B ;

   9196  9 000567   000007 236000 10                 LDQ     7
         9 000570   002706 356000 2                  ANSQ    FLAGS

      935     9197        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:162  
      936     9198    4              DO CASE (P_PCB.OUT$ -> OUT$BLK.CODE); /* LEGAL STEP MODE COMMAND? */

   9198  9 000571   002733 470400 2                  LDP0    P_PCB+3
         9 000572   000000 236100                    LDQ     0,,PR0
         9 000573   777777 376007                    ANQ     -1,DL
         9 000574   000024 136007                    SBLQ    20,DL
         9 000575   000036 116007                    CMPQ    30,DL
         9 000576   000600 602006 9                  TNC     s:9198+7,QL
         9 000577   000643 710000 9                  TRA     s:9212
         9 000600   000636 710000 9                  TRA     s:9204
         9 000601   000643 710000 9                  TRA     s:9212
         9 000602   000636 710000 9                  TRA     s:9204
         9 000603   000636 710000 9                  TRA     s:9204
         9 000604   000636 710000 9                  TRA     s:9204
         9 000605   000636 710000 9                  TRA     s:9204
         9 000606   000636 710000 9                  TRA     s:9204
         9 000607   000636 710000 9                  TRA     s:9204
         9 000610   000636 710000 9                  TRA     s:9204
         9 000611   000636 710000 9                  TRA     s:9204
         9 000612   000636 710000 9                  TRA     s:9204
         9 000613   000636 710000 9                  TRA     s:9204
         9 000614   000636 710000 9                  TRA     s:9204
         9 000615   000636 710000 9                  TRA     s:9204
         9 000616   000636 710000 9                  TRA     s:9204
         9 000617   000636 710000 9                  TRA     s:9204
         9 000620   000636 710000 9                  TRA     s:9204
         9 000621   000636 710000 9                  TRA     s:9204
         9 000622   000636 710000 9                  TRA     s:9204
         9 000623   000636 710000 9                  TRA     s:9204
         9 000624   000636 710000 9                  TRA     s:9204
         9 000625   000636 710000 9                  TRA     s:9204
         9 000626   000636 710000 9                  TRA     s:9204
         9 000627   000636 710000 9                  TRA     s:9204
         9 000630   000636 710000 9                  TRA     s:9204
         9 000631   000636 710000 9                  TRA     s:9204
         9 000632   000636 710000 9                  TRA     s:9204
         9 000633   000636 710000 9                  TRA     s:9204
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:163  
         9 000634   000636 710000 9                  TRA     s:9204
         9 000635   000636 710000 9                  TRA     s:9204

      937     9199    4              CASE (EDITCMD,BUILDCMD,COPYCMD,DELETECMD,MERGECMD,

      938     9200    4                 SECMD,
      939     9201    4                 SSCMD,STCMD,FTCMD,FSCMD,FDCMD,MKCMD,MDCMD,MKPCMD,
      940     9202    4                 MDPCMD,CMCMD,CTCMD,INCMD,IPCMD,ISCMD,IACMD,IBCMD,
      941     9203    4                 APCMD,RNCMD,UPARROWCMD,EXAMINECMD,TPCMD,TNCMD,OLCMD);
      942     9204    4                 CALL VEX$ERROR(E$E_NOTSTEPMODE,2);

   9204  9 000636   000022 630400 10                 EPPR0   18
         9 000637   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000640   000000 701000 xent               TSX1    VEX$ERROR
         9 000641   000000 011000                    NOP     0

      943     9205    4                 GOTO STEP_CMD_READ;

   9205  9 000642   000547 710000 9                  TRA     STEP_CMD_READ

      944     9206    4              END;

      945     9207        /**/
      946     9208        /*E*    ERROR:   VEE-E$E_NOTSTEPMODE-0
      947     9209                MESSAGE: Command not legal in step mode.
      948     9210                DESCRIPTION: ILLEGAL COMMAND              */
      949     9211        /**/
      950     9212    3              CALL CHECK_CMD ALTRET (STEP_CMD_READ);

   9212  9 000643   002403 701000 9                  TSX1    CHECK_CMD
         9 000644   000547 702000 9                  TSX2    STEP_CMD_READ

      951     9213    3              END;

   9213  9 000645   002624 236000 2                  LDQ     CMD_INDEX
         9 000646   002570 116000 2                  CMPQ    CMD_SIZE
         9 000647   000561 602000 9                  TNC     s:9193
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:164  

      952     9214    2           IF (FLAGS.INTRA_CMD)AND(FLAGS.VERIFY)AND

   9214  9 000650   002706 236000 2                  LDQ     FLAGS
         9 000651   200000 316003                    CANQ    65536,DU
         9 000652   000710 600000 9                  TZE     s:9222
         9 000653   010000 316007                    CANQ    4096,DL
         9 000654   000710 600000 9                  TZE     s:9222
         9 000655   002660 235000 2                  LDA     CMD_BASE$
         9 000656   000022 771000                    ARL     18
         9 000657   200414 755100                    STA     IN_SLASH+1,,AUTO
         9 000660   002657 236000 2                  LDQ     CMD$
         9 000661   000022 772000                    QRL     18
         9 000662   200414 136100                    SBLQ    IN_SLASH+1,,AUTO
         9 000663   000001 116007                    CMPQ    1,DL
         9 000664   000710 604400 9                  TMOZ    s:9222

      953     9215    3              (POFFW(CMD$,CMD_BASE$) > 1) THEN DO;

      954     9216    3              CMD$ -> CMD_CNTRLWD.FLAGS = FALSE;

   9216  9 000665   000000 220003                    LDX0    0,DU
         9 000666   002657 470400 2                  LDP0    CMD$
         9 000667   000000 740100                    STX0    0,,PR0

      955     9217    3              CMD$ -> CMD_CNTRLWD.CMD_CODE = VERIFY_TYPE;

   9217  9 000670   002657 470400 2                  LDP0    CMD$
         9 000671   002647 236000 2                  LDQ     VERIFY_TYPE
         9 000672   000000 552104                    STBQ    0,'04'O,PR0

      956     9218    3              CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);

   9218  9 000673   002657 470400 2                  LDP0    CMD$
         9 000674   001000 236007                    LDQ     512,DL
         9 000675   000000 552110                    STBQ    0,'10'O,PR0

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:165  
      957     9219    3              CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   9219  9 000676   002657 470400 2                  LDP0    CMD$
         9 000677   000000 236100                    LDQ     0,,PR0
         9 000700   000011 772000                    QRL     9
         9 000701   000777 376007                    ANQ     511,DL
         9 000702   000022 736000                    QLS     18
         9 000703   002657 036000 2                  ADLQ    CMD$
         9 000704   002657 756000 2                  STQ     CMD$

      958     9220    3              CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;

   9220  9 000705   002657 470400 2                  LDP0    CMD$
         9 000706   400000 236003                    LDQ     -131072,DU
         9 000707   000000 256100                    ORSQ    0,,PR0

      959     9221    3              END;

      960     9222    2           CMD$ = CMD_BASE$;

   9222  9 000710   002660 236000 2                  LDQ     CMD_BASE$
         9 000711   002657 756000 2                  STQ     CMD$

      961     9223    2           STR_TEXT_QM$ = STR_TEXT$;

   9223  9 000712   002673 236000 2                  LDQ     STR_TEXT$
         9 000713   002677 756000 2                  STQ     STR_TEXT_QM$

      962     9224    2           IF (CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT) THEN GOTO READ_NEXT;

   9224  9 000714   002657 470400 2                  LDP0    CMD$
         9 000715   000000 234100                    SZN     0,,PR0
         9 000716   000744 604000 9                  TMI     READ_NEXT

      963     9225    2           END;

      964     9226        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:166  
      965     9227    1        STR_TEXT$ = STR_TEXT_QM$;

   9227  9 000717   002677 236000 2                  LDQ     STR_TEXT_QM$
         9 000720   002673 756000 2                  STQ     STR_TEXT$

      966     9228        /**/
      967     9229    1        CALL VEM$MASTER;                   /* PROCESS COMMANDS                   */

   9229  9 000721   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000722   000000 701000 xent               TSX1    VEM$MASTER
         9 000723   000000 011000                    NOP     0

      968     9230        /**/
      969     9231    2        IF ((FLAGS.INTRA_CMD) OR (FLAGS.STEP_MODE)) THEN DO; /* LOOP IF RANGE */

   9231  9 000724   002706 236000 2                  LDQ     FLAGS
         9 000725   200000 316003                    CANQ    65536,DU
         9 000726   000731 601000 9                  TNZ     s:9232
         9 000727   100000 316003                    CANQ    32768,DU
         9 000730   001057 600000 9                  TZE     STEP_DONE

      970     9232    2           IF (FLAGS.TXFLAG)AND(~FLAGS.NOFLAG) THEN

   9232  9 000731   000040 316003                    CANQ    32,DU
         9 000732   000744 600000 9                  TZE     READ_NEXT
         9 000733   002706 236000 2                  LDQ     FLAGS
         9 000734   000031 736000                    QLS     25
         9 000735   400000 376003                    ANQ     -131072,DU
         9 000736   400000 676003                    ERQ     -131072,DU
         9 000737   000744 600000 9                  TZE     READ_NEXT

      971     9233    2              CALL VEX$WRITE_REC(M$FILE_NUM,LAST_KEY)

   9233  9 000740   000024 630400 10                 EPPR0   20
         9 000741   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000742   000000 701000 xent               TSX1    VEX$WRITE_REC
         9 000743   001203 702000 9                  TSX2    WRITE_ALT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:167  

      972     9234    2                 ALTRET(WRITE_ALT) ;       /* WRITE 'EDIT' RECORD IF CHANGED */
      973     9235        /**/
      974     9236    2   READ_NEXT:
      975     9237    2           FLAGS.TXFLAG = FALSE;           /* RESET                              */

   9237  9 000744   000026 236000 10    READ_NEXT    LDQ     22
         9 000745   002706 356000 2                  ANSQ    FLAGS

      976     9238    2           FLAGS.NOFLAG = FALSE;

   9238  9 000746   000027 236000 10                 LDQ     23
         9 000747   002706 356000 2                  ANSQ    FLAGS

      977     9239    3           IF (FLAGS.RFFLAG) THEN DO;      /* SET RPFLAG AGAIN                   */

   9239  9 000750   002706 236000 2                  LDQ     FLAGS
         9 000751   000020 316003                    CANQ    16,DU
         9 000752   000762 600000 9                  TZE     s:9244

      978     9240    3              FLAGS.RFFLAG = FALSE;

   9240  9 000753   000030 236000 10                 LDQ     24
         9 000754   002706 356000 2                  ANSQ    FLAGS

      979     9241    3              FLAGS.BPFLAG = FLAGS.BPFLAG_SAV;

   9241  9 000755   002707 236000 2                  LDQ     FLAGS+1
         9 000756   000005 772000                    QRL     5
         9 000757   002706 676000 2                  ERQ     FLAGS
         9 000760   001000 376003                    ANQ     512,DU
         9 000761   002706 656000 2                  ERSQ    FLAGS

      980     9242    3              END;

      981     9243        /**/
      982     9244    3           IF (CP_LIMIT_SEQNUM = 0) THEN DO; /* CP ERROR                      */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:168  

   9244  9 000762   002606 235000 2                  LDA     CP_LIMIT_SEQNUM
         9 000763   000767 601000 9                  TNZ     s:9249

      983     9245    3              CP_LIMIT_SEQNUM = Y003;

   9245  9 000764   000414 236000 1                  LDQ     Y003
         9 000765   002606 756000 2                  STQ     CP_LIMIT_SEQNUM

      984     9246    3              GOTO STEP_DONE;

   9246  9 000766   001057 710000 9                  TRA     STEP_DONE

      985     9247    3              END;
      986     9248        /**/
      987     9249    2           IF (CMD_CODE = DECMD AND FLAGS.BADKEY)

   9249  9 000767   002625 236000 2                  LDQ     CMD_CODE
         9 000770   000066 116007                    CMPQ    54,DL
         9 000771   000775 601000 9                  TNZ     s:9252
         9 000772   002707 236000 2                  LDQ     FLAGS+1
         9 000773   200000 316003                    CANQ    65536,DU
         9 000774   001057 601000 9                  TNZ     STEP_DONE

      988     9250    2           THEN GOTO STEP_DONE ;
      989     9251        /**/
      990     9252    2           IF (LAST_KEY = HI_SEQNUM)

   9252  9 000775   002613 236000 2                  LDQ     LAST_KEY
         9 000776   002602 116000 2                  CMPQ    HI_SEQNUM
         9 000777   001057 600000 9                  TZE     STEP_DONE

      991     9253    2           THEN GOTO STEP_DONE ;
      992     9254        /**/
      993     9255    3           DO CASE(CMD_CODE);              /* CERTAIN COMMANDS DONT COUNT        */

   9255  9 001000   002625 235000 2                  LDA     CMD_CODE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:169  
         9 001001   000026 115007                    CMPA    22,DL
         9 001002   001004 602005 9                  TNC     s:9255+4,AL
         9 001003   001033 710000 9                  TRA     s:9261
         9 001004   001033 710000 9                  TRA     s:9261
         9 001005   001032 710000 9                  TRA     s:9258
         9 001006   001033 710000 9                  TRA     s:9261
         9 001007   001033 710000 9                  TRA     s:9261
         9 001010   001032 710000 9                  TRA     s:9258
         9 001011   001032 710000 9                  TRA     s:9258
         9 001012   001032 710000 9                  TRA     s:9258
         9 001013   001032 710000 9                  TRA     s:9258
         9 001014   001032 710000 9                  TRA     s:9258
         9 001015   001032 710000 9                  TRA     s:9258
         9 001016   001032 710000 9                  TRA     s:9258
         9 001017   001032 710000 9                  TRA     s:9258
         9 001020   001032 710000 9                  TRA     s:9258
         9 001021   001032 710000 9                  TRA     s:9258
         9 001022   001033 710000 9                  TRA     s:9261
         9 001023   001033 710000 9                  TRA     s:9261
         9 001024   001032 710000 9                  TRA     s:9258
         9 001025   001033 710000 9                  TRA     s:9261
         9 001026   001033 710000 9                  TRA     s:9261
         9 001027   001033 710000 9                  TRA     s:9261
         9 001030   001033 710000 9                  TRA     s:9261
         9 001031   001032 710000 9                  TRA     s:9258

      994     9256    3           CASE (HELPCMD,BPCMD,CRCMD,RPCMD,TACMD,TABXCMD,STATUSCMD,CRPTCMD,

      995     9257    3              QMCMD,QM2CMD,VECMD,TYPECMD,ROUNDCMD);
      996     9258    3              GOTO STEP_CMD_READ;

   9258  9 001032   000547 710000 9                  TRA     STEP_CMD_READ

      997     9259    3           END;

      998     9260        /**/
      999     9261    2           SAVE_KEY = LAST_KEY ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:170  

   9261  9 001033   002615 756000 2                  STQ     SAVE_KEY

     1000     9262                                                /* Save for EOF. */
     1001     9263    2           CALL VEX$READ_SEQUEN ALTRET (STEP_DONE);

   9263  9 001034   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001035   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         9 001036   001057 702000 9                  TSX2    STEP_DONE

     1002     9264    3           IF (FLAGS.EOF) THEN DO;

   9264  9 001037   002706 236000 2                  LDQ     FLAGS
         9 001040   010000 316003                    CANQ    4096,DU
         9 001041   001054 600000 9                  TZE     s:9281

     1003     9265    3              IF CMD_CODE ~= JUCMD

   9265  9 001042   002625 235000 2                  LDA     CMD_CODE
         9 001043   000071 115007                    CMPA    57,DL
         9 001044   001047 600000 9                  TZE     s:9271

     1004     9266    3              THEN
     1005     9267                                                    /*
     1006     9268                                                      Restore LAST_KEY.
     1007     9269                                                    */
     1008     9270    3                 LAST_KEY = SAVE_KEY;

   9270  9 001045   002615 235000 2                  LDA     SAVE_KEY
         9 001046   002613 755000 2                  STA     LAST_KEY

     1009     9271    3              CALL VEX$ERROR (E$E_EDITEOF,1);

   9271  9 001047   000032 630400 10                 EPPR0   26
         9 001050   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001051   000000 701000 xent               TSX1    VEX$ERROR
         9 001052   000000 011000                    NOP     0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:171  

     1010     9272    3              GOTO STEP_DONE;

   9272  9 001053   001057 710000 9                  TRA     STEP_DONE

     1011     9273    3              END;
     1012     9274        /**/
     1013     9275        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1014     9276                 MESSAGE:  EOF hit after %U1
     1015     9277                 DESCRIPTION: While doing a consecutive read of the edit file
     1016     9278                           the end of file was encountered.
     1017     9279        */
     1018     9280        /**/
     1019     9281    2           IF  LAST_KEY <= HI_SEQNUM

   9281  9 001054   002602 236000 2                  LDQ     HI_SEQNUM
         9 001055   002613 116000 2                  CMPQ    LAST_KEY
         9 001056   000454 603000 9                  TRC     NEXT_REC

     1020     9282    2           THEN GOTO NEXT_REC ;            /* Continue SE,SS,ST mode. */
     1021     9283    2           END;

     1022     9284        /**/
     1023     9285    1   STEP_DONE:
     1024     9286    2        IF (DELREC_COUNT > 0) OR (FLAGS.DELRECCMD) THEN DO;

   9286  9 001057   002633 235000 2     STEP_DONE    LDA     DELREC_COUNT
         9 001060   001064 601000 9                  TNZ     s:9287
         9 001061   002706 236000 2                  LDQ     FLAGS
         9 001062   001000 316007                    CANQ    512,DL
         9 001063   001074 600000 9                  TZE     s:9296

     1025     9287    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,DELREC_COUNT);

   9287  9 001064   000010 630400 10                 EPPR0   8
         9 001065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001066   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:172  
         9 001067   000000 011000                    NOP     0

     1026     9288    2           CALL VEX$ERROR(E$E_RECSDEL,1);

   9288  9 001070   000013 630400 10                 EPPR0   11
         9 001071   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001072   000000 701000 xent               TSX1    VEX$ERROR
         9 001073   000000 011000                    NOP     0

     1027     9289    2           END;

     1028     9290        /**/
     1029     9291        /*E*     ERROR:    VEE-E$E_RECSDEL-0
     1030     9292                 DESCRIPTION:   Output number of record deleted by intrarecord
     1031     9293                           delete operation.
     1032     9294        */
     1033     9295        /**/
     1034     9296    2        IF (STRCHG_COUNT > 0) OR (FLAGS.STRCHGCMD) THEN DO;

   9296  9 001074   002634 235000 2                  LDA     STRCHG_COUNT
         9 001075   001101 601000 9                  TNZ     s:9297
         9 001076   002706 236000 2                  LDQ     FLAGS
         9 001077   020000 316007                    CANQ    8192,DL
         9 001100   001111 600000 9                  TZE     s:9307

     1035     9297    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,STRCHG_COUNT);

   9297  9 001101   000034 630400 10                 EPPR0   28
         9 001102   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001103   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 001104   000000 011000                    NOP     0

     1036     9298    2           CALL VEX$ERROR(E$E_STRCHANGED,1);

   9298  9 001105   000037 630400 10                 EPPR0   31
         9 001106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001107   000000 701000 xent               TSX1    VEX$ERROR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:173  
         9 001110   000000 011000                    NOP     0

     1037     9299    2           END;

     1038     9300        /**/
     1039     9301        /*E*     ERROR:    VEE-E$E_STRCHANGED-0
     1040     9302                 MESSAGE:  %U1 strings changed
     1041     9303                 DESCRIPTION:   Output the number of character strings altered by
     1042     9304                           the last intrarecord command line.
     1043     9305        */
     1044     9306        /**/
     1045     9307    2        IF (CP_RECSMVED > 0) THEN DO;

   9307  9 001111   002610 235000 2                  LDA     CP_RECSMVED
         9 001112   001124 600000 9                  TZE     s:9316

     1046     9308    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,CP_RECSMVED);

   9308  9 001113   000041 630400 10                 EPPR0   33
         9 001114   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001115   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 001116   000000 011000                    NOP     0

     1047     9309    2           CALL VEX$ERROR(E$E_RECSMVED,1);

   9309  9 001117   000044 630400 10                 EPPR0   36
         9 001120   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001121   000000 701000 xent               TSX1    VEX$ERROR
         9 001122   000000 011000                    NOP     0

     1048     9310    2           CP_RECSMVED = 0;

   9310  9 001123   002610 450000 2                  STZ     CP_RECSMVED

     1049     9311    2           END;

     1050     9312        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:174  
     1051     9313        /*E*    ERROR:   VEE-E$E_RECSMVED-0
     1052     9314                DESCRIPTION: OUTPUT RECORDS MOVED BY CP,CI */
     1053     9315        /**/
     1054     9316    2        IF (TRNC_COUNT ~= 0) THEN DO;

   9316  9 001124   002635 235000 2                  LDA     TRNC_COUNT
         9 001125   001137 600000 9                  TZE     s:9326

     1055     9317    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,TRNC_COUNT);

   9317  9 001126   000046 630400 10                 EPPR0   38
         9 001127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001130   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 001131   000000 011000                    NOP     0

     1056     9318    2           CALL VEX$ERROR(E$E_RECSTRNC,1);

   9318  9 001132   000051 630400 10                 EPPR0   41
         9 001133   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001134   000000 701000 xent               TSX1    VEX$ERROR
         9 001135   000000 011000                    NOP     0

     1057     9319    2           TRNC_COUNT = 0;

   9319  9 001136   002635 450000 2                  STZ     TRNC_COUNT

     1058     9320    2           END;

     1059     9321        /**/
     1060     9322        /*E*    ERROR:   VEE-E$E_RECSTRNC-0
     1061     9323                MESSAGE: %U1 Records truncated
     1062     9324                DESCRIPTION: SOME RECORDS TRUNCATED BECAUSE OF RP MODE */
     1063     9325        /**/
     1064     9326    2        IF (FLAGS.OLINPROG) THEN DO;

   9326  9 001137   002706 236000 2                  LDQ     FLAGS
         9 001140   000400 316007                    CANQ    256,DL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:175  
         9 001141   001161 600000 9                  TZE     s:9335

     1065     9327    2           FLAGS.OLINPROG = FALSE;

   9327  9 001142   000053 236000 10                 LDQ     43
         9 001143   002706 356000 2                  ANSQ    FLAGS

     1066     9328    2           CLOSE_TY_FPT.V.DCB# = TY_DCBNUM ;

   9328  9 001144   001244 720000 2                  LXL0    TY_DCBNUM
         9 001145   000032 740000 2                  STX0    CLOSE_TY_FPT+26

     1067     9329    2           CALL M$CLOSE (CLOSE_TY_FPT);

   9329  9 001146   000000 630400 2                  EPPR0   CLOSE_TY_FPT
         9 001147   050001 713400                    CLIMB   close
         9 001150   406000 401760                    pmme    nvectors=13

     1068     9330    2           RELDCB_FPT.V.DCB# = TY_DCBNUM ;

   9330  9 001151   001244 720000 2                  LXL0    TY_DCBNUM
         9 001152   000240 740000 2                  STX0    RELDCB_FPT+2

     1069     9331    2           CALL M$RELDCB(RELDCB_FPT) ALTRET(RELDCB_ERR) ;

   9331  9 001153   000236 630400 2                  EPPR0   RELDCB_FPT
         9 001154   460003 713400                    CLIMB   alt,+24579
         9 001155   400000 401760                    pmme    nvectors=1
         9 001156   001157 702000 9                  TSX2    RELDCB_ERR

     1070     9332    2   RELDCB_ERR:
     1071     9333    2           TY_DCBNUM = ME_DCBNUM ;

   9333  9 001157   001246 235000 2     RELDCB_ERR   LDA     ME_DCBNUM
         9 001160   001244 755000 2                  STA     TY_DCBNUM

     1072     9334    2           END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:176  

     1073     9335    1        IF CMD_CODE = FTCMD AND FT_COUNT = 0

   9335  9 001161   002625 235000 2                  LDA     CMD_CODE
         9 001162   000035 115007                    CMPA    29,DL
         9 001163   001173 601000 9                  TNZ     s:9339
         9 001164   002631 236000 2                  LDQ     FT_COUNT
         9 001165   001173 601000 9                  TNZ     s:9339

     1074     9336    1        THEN
     1075     9337    1           CALL VEX$ERROR(E$E_NONE,1) ;

   9337  9 001166   000055 630400 10                 EPPR0   45
         9 001167   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001170   000000 701000 xent               TSX1    VEX$ERROR
         9 001171   000000 011000                    NOP     0
         9 001172   001174 710000 9                  TRA     s:9346

     1076     9338    1        ELSE
     1077     9339    1           FT_COUNT = 0 ;

   9339  9 001173   002631 450000 2                  STZ     FT_COUNT

     1078     9340        /**/
     1079     9341        /*E*     ERROR:    VEE-E$E_NONE-0
     1080     9342                 DESCRIPTION: There are no records in the selected range.
     1081     9343        */
     1082     9344        /**/
     1083     9345        /**/
     1084     9346    1        GOTO CMD_READ;                     /* GET MORE COMMANDS                  */

   9346  9 001174   000255 710000 9                  TRA     CMD_READ

     1085     9347        /**/
     1086     9348    1   NO_MEMORY:
     1087     9349    1        CALL VEX$ERROR(E$E_NOMEM,4);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:177  
   9349  9 001175   000060 630400 10    NO_MEMORY    EPPR0   48
         9 001176   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001177   000000 701000 xent               TSX1    VEX$ERROR
         9 001200   000000 011000                    NOP     0

     1088     9350    1        CALL M$EXIT;

   9350  9 001201   000001 713400                    CLIMB   exit
         9 001202   000000 401760                    pmme    nvectors=0

     1089     9351        /**/
     1090     9352        /*E*     ERROR:    VEE-E$E_NOMEM-0
     1091     9353                 MESSAGE: No memory available - command aborted.
     1092     9354                 DESCRIPTION: EDIT was unable to get a data segment to use as
     1093     9355                           a work area for X$PARSE and there can't read commands.
     1094     9356        */
     1095     9357        /**/
     1096     9358    1   WRITE_ALT:
     1097     9359    2        IF (FLAGS.INTRA_CMD) THEN DO;

   9359  9 001203   002706 236000 2     WRITE_ALT    LDQ     FLAGS
         9 001204   200000 316003                    CANQ    65536,DU
         9 001205   000744 600000 9                  TZE     READ_NEXT

     1098     9360    2           FLAGS.INTRA_CMD = FALSE;

   9360  9 001206   000004 236000 10                 LDQ     4
         9 001207   002706 356000 2                  ANSQ    FLAGS

     1099     9361    2           FLAGS.TXFLAG = FALSE;

   9361  9 001210   000026 236000 10                 LDQ     22
         9 001211   002706 356000 2                  ANSQ    FLAGS

     1100     9362    2           GOTO STEP_DONE ;

   9362  9 001212   001057 710000 9                  TRA     STEP_DONE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:178  

     1101     9363    2           END;
     1102     9364    1        ELSE GOTO READ_NEXT;
     1103     9365        /**/
     1104     9366    1   PARSE_ERR:
     1105     9367    2        IF (P_PCB.ERROR.CODE = %E$WKOVERFLOW) THEN DO;

   9367  9 001213   002736 236000 2     PARSE_ERR    LDQ     P_PCB+6
         9 001214   377770 376007                    ANQ     131064,DL
         9 001215   000040 116007                    CMPQ    32,DL
         9 001216   001226 601000 9                  TNZ     s:9373

     1106     9368    2           CALL VEX$XPAND ALTRET (NO_MEMORY);

   9368  9 001217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001220   000000 701000 xent               TSX1    VEX$XPAND
         9 001221   001175 702000 9                  TSX2    NO_MEMORY

     1107     9369    2           IF (FLAGS.STEP_MODE) THEN GOTO STEP_CMD_RETRY;

   9369  9 001222   002706 236000 2                  LDQ     FLAGS
         9 001223   100000 316003                    CANQ    32768,DU
         9 001224   000563 601000 9                  TNZ     STEP_CMD_RETRY

     1108     9370    2           GOTO CMD_RETRY;

   9370  9 001225   000356 710000 9                  TRA     CMD_RETRY

     1109     9371    2           END;
     1110     9372        /**/
     1111     9373    2        IF (P_PCB.ERROR.CODE = %E$SYNERR) THEN DO;

   9373  9 001226   000010 116007                    CMPQ    8,DL
         9 001227   001265 601000 9                  TNZ     s:9413

     1112     9374    2           FLAGS.PARS_ERR = '1'B ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:179  
   9374  9 001230   000001 236007                    LDQ     1,DL
         9 001231   002706 256000 2                  ORSQ    FLAGS

     1113     9375        %SET LISTCON = '1'B ;
     1114     9376        %IF '0'B ;
     1115     9377 C              DO WHILE ('0'B) ;
     1116     9378 C      DUMMY_LABEL:
     1117     9379 C                 IF (SUBSTR(CMD_BUF,P_PCB.HI_CHAR,1) = '?') THEN DO ;
     1118     9380 C                    P_PCB.NXT = '1'B ;
     1119     9381 C                    TYPE_BUF.TEXT = 'Acceptable input at ^ is:' ;
     1120     9382 C                    CALL VEX$TYPE_REC(TYPECR) ;
     1121     9383 C                    CALL X$PARSE(P_PCB) ALTRET(QUESTION_ERR) ;
     1122     9384 C      QUESTION_ERR:
     1123     9385 C                    P_PCB.NXT = '0'B ;
     1124     9386 C                    GOTO CMD_READ ;
     1125     9387 C                    END ;                     /* THEN DO */
     1126     9388 C                 END ;                        /* DUMMY DO WHILE */
     1127     9389        %ENDIF ;
     1128     9390        /**/
     1129     9391    3           IF (LAST_CMD = 0) THEN DO;

   9391  9 001232   002626 235000 2                  LDA     LAST_CMD
         9 001233   001241 601000 9                  TNZ     s:9400

     1130     9392    3              CALL VEX$ERROR(E$E_BADCMD,2);

   9392  9 001234   000063 630400 10                 EPPR0   51
         9 001235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001236   000000 701000 xent               TSX1    VEX$ERROR
         9 001237   000000 011000                    NOP     0

     1131     9393    3              END;

   9393  9 001240   001261 710000 9                  TRA     s:9408

     1132     9394        /*E*     ERROR:    VEE-E$E_BADCMD-0
     1133     9395                 MESSAGE:  Unknown command.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:180  
     1134     9396                 MESSAGE1: The last command was not recognized by EDIT.
     1135     9397                 DESCRIPTION: No command literal was found by X$PARSE. */
     1136     9398        /**/
     1137     9399    3           ELSE DO;

     1138     9400    3              CALL VEX$SET_SUB_BUF(SUB_BUF_1,P_PCB.HI_CHAR+(CMD_INDEX-P_PCB.NCHARS));

   9400  9 001241   002624 236000 2                  LDQ     CMD_INDEX
         9 001242   002741 136000 2                  SBLQ    P_PCB+9
         9 001243   002742 036000 2                  ADLQ    P_PCB+10
         9 001244   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 001245   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 001246   200417 450500                    STP0    IN_SLASH+4,,AUTO
         9 001247   000010 236000 10                 LDQ     8
         9 001250   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 001251   200416 630500                    EPPR0   IN_SLASH+3,,AUTO
         9 001252   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001253   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 001254   000000 011000                    NOP     0

     1139     9401    3              CALL VEX$ERROR(E$E_SYNTAX,2);

   9401  9 001255   000066 630400 10                 EPPR0   54
         9 001256   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001257   000000 701000 xent               TSX1    VEX$ERROR
         9 001260   000000 011000                    NOP     0

     1140     9402    3              END;

     1141     9403        /*E*     ERROR:    VEE-E$E_SYNTAX-0
     1142     9404                 MESSAGE: Eh?
     1143     9405                 DESCRIPTION: THE USER BLEW HIS INPUT COMMAND
     1144     9406        */
     1145     9407        /**/
     1146     9408    2           IF (FLAGS.STEP_MODE) THEN GOTO STEP_CMD_READ;

   9408  9 001261   002706 236000 2                  LDQ     FLAGS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:181  
         9 001262   100000 316003                    CANQ    32768,DU
         9 001263   000547 601000 9                  TNZ     STEP_CMD_READ

     1147     9409    2           GOTO CMD_READ;

   9409  9 001264   000255 710000 9                  TRA     CMD_READ

     1148     9410    2           END;
     1149     9411        /**/
     1150     9412    2        ELSE DO;

     1151     9413    2           FLAGS.PARS_ERR = '1'B ;

   9413  9 001265   000001 236007                    LDQ     1,DL
         9 001266   002706 256000 2                  ORSQ    FLAGS

     1152     9414    2           ERR_CODE = P_PCB.ERROR;

   9414  9 001267   002736 236000 2                  LDQ     P_PCB+6
         9 001270   002564 756000 2                  STQ     ERR_CODE

     1153     9415    2           CALL VEX$ERRMAX;

   9415  9 001271   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001272   000000 701000 xent               TSX1    VEX$ERRMAX
         9 001273   000000 011000                    NOP     0

     1154     9416    2           GOTO CMD_READ;

   9416  9 001274   000255 710000 9                  TRA     CMD_READ

     1155     9417    2           END;
     1156     9418        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:182  
     1157     9419        /**/
     1158     9420    1   READ_CMD: PROC;

   9420  9 001275   200406 741300       READ_CMD     STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     1159     9421        /**/
     1160     9422    2        IF (M$SI$ -> F$DCB.ASN = %DEVICE#) AND (M$SI$ -> F$DCB.RESNT.TYP = 'NO')

   9422  9 001276   002652 470400 2                  LDP0    M$SI$
         9 001277   000032 236100                    LDQ     26,,PR0
         9 001300   777000 376007                    ANQ     -512,DL
         9 001301   003000 116007                    CMPQ    1536,DL
         9 001302   001306 601000 9                  TNZ     s:9424
         9 001303   000026 220100                    LDX0    22,,PR0
         9 001304   000433 100000 1                  CMPX0   NEWLINE_CNTRLWD+5
         9 001305   001722 600000 9                  TZE     READ_SI_ERR

     1161     9423    2        THEN GOTO READ_SI_ERR ;       /* Unable to read from M$SI, set to 'NO' */
     1162     9424    3        IF (FLAGS.PARS_ERR) THEN DO ;

   9424  9 001306   002706 236000 2                  LDQ     FLAGS
         9 001307   000001 316007                    CANQ    1,DL
         9 001310   001316 600000 9                  TZE     READ_CMD_AGAIN

     1163     9425    3           TEMP_CMD_BUF = CMD_BUF ;        /* Save CMD_BUF for '?'            */

   9425  9 001311   040000 100400                    MLR     fill='040'O
         9 001312   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256
         9 001313   001350 000400 2                  ADSC9   TEMP_CMD_BUF             cn=0,n=256

     1164     9426    3           TEMP_CMD_SIZE = CMD_SIZE ;

   9426  9 001314   002570 235000 2                  LDA     CMD_SIZE
         9 001315   002571 755000 2                  STA     TEMP_CMD_SIZE

     1165     9427    3           END ;                           /* THEN DO */

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:183  
     1166     9428    2   READ_CMD_AGAIN:
     1167     9429    2        CMD_INDEX = 0;

   9429  9 001316   002624 450000 2     READ_CMD_AG* STZ     CMD_INDEX

     1168     9430    2        CMD_SIZE = 0;

   9430  9 001317   002570 450000 2                  STZ     CMD_SIZE

     1169     9431    2        SAVED_CMD = LAST_CMD;              /* FOR ?,??                           */

   9431  9 001320   002626 235000 2                  LDA     LAST_CMD
         9 001321   002627 755000 2                  STA     SAVED_CMD

     1170     9432    2        LAST_CMD = 0;

   9432  9 001322   002626 450000 2                  STZ     LAST_CMD

     1171     9433    2        FLAGS.NEWLINE_FLAG = FALSE;

   9433  9 001323   000070 236000 10                 LDQ     56
         9 001324   002706 356000 2                  ANSQ    FLAGS

     1172     9434    2        FLAGS.NOCOMPCMD = FALSE;           /*RESET NO COMPOUND FLAG              */

   9434  9 001325   000071 236000 10                 LDQ     57
         9 001326   002706 356000 2                  ANSQ    FLAGS

     1173     9435    2        FLAGS.OVERFLOWMSG = FALSE;

   9435  9 001327   000072 236000 10                 LDQ     58
         9 001330   002706 356000 2                  ANSQ    FLAGS

     1174     9436    2        FLAGS.UNDRFLOWMSG = FALSE;

   9436  9 001331   000073 236000 10                 LDQ     59
         9 001332   002706 356000 2                  ANSQ    FLAGS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:184  

     1175     9437    2        FLAGS.TABMSG = FALSE;

   9437  9 001333   000074 236000 10                 LDQ     60
         9 001334   002706 356000 2                  ANSQ    FLAGS

     1176     9438    2        FLAGS.STRCHGCMD = FALSE;

   9438  9 001335   000075 236000 10                 LDQ     61
         9 001336   002706 356000 2                  ANSQ    FLAGS

     1177     9439    2        FLAGS.DELRECCMD = FALSE;

   9439  9 001337   000076 236000 10                 LDQ     62
         9 001340   002706 356000 2                  ANSQ    FLAGS

     1178     9440    2        CMD$ = CMD_BASE$;

   9440  9 001341   002660 236000 2                  LDQ     CMD_BASE$
         9 001342   002657 756000 2                  STQ     CMD$

     1179     9441    2        CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE; /* EMPTY COMMAND LIST         */

   9441  9 001343   002657 470400 2                  LDP0    CMD$
         9 001344   400000 236003                    LDQ     -131072,DU
         9 001345   000000 256100                    ORSQ    0,,PR0

     1180     9442    2        CMDBUF$ = CMDBUF_BASE$;

   9442  9 001346   002663 236000 2                  LDQ     CMDBUF_BASE$
         9 001347   002662 756000 2                  STQ     CMDBUF$

     1181     9443    2        STR_TEXT$ = STR_TEXT_SE$;          /* SET TEXT AREA                      */

   9443  9 001350   002676 236000 2                  LDQ     STR_TEXT_SE$
         9 001351   002673 756000 2                  STQ     STR_TEXT$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:185  
     1182     9444        /**/
     1183     9445    2   READ_CMD_1:
     1184     9446    2        FLAGS.INPUT = '1'B;

   9446  9 001352   000100 236007       READ_CMD_1   LDQ     64,DL
         9 001353   002706 256000 2                  ORSQ    FLAGS

     1185     9447    2        XUG$GETCMD_.INDCB#  = IN_DCBNUM;

   9447  9 001354   001245 235000 2                  LDA     IN_DCBNUM
         9 001355   002760 755000 2                  STA     XUG$GETCMD_+10

     1186     9448    2        M$DCB$ = DCBADDR(IN_DCBNUM);

   9448  9 001356   000000 470400 10                 LDP0    0
         9 001357   000000 471500                    LDP1    0,,PR0
         9 001360   100000 236105                    LDQ     0,AL,PR1
         9 001361   002656 756000 2                  STQ     M$DCB$

     1187     9449    2        XUG$GETCMD_.PROMPT_ = VECTOR(SINGLE_AST);

   9449  9 001362   000100 237000 10                 LDAQ    64
         9 001363   002773 755000 2                  STA     XUG$GETCMD_+21
         9 001364   002774 756000 2                  STQ     XUG$GETCMD_+22

     1188     9450    3        IF (BREAK_ARS~=0) THEN DO;

   9450  9 001365   003066 235000 2                  LDA     BREAK_ARS
         9 001366   001373 600000 9                  TZE     s:9455

     1189     9451    3           XUG$GETCMD_.TEXT_ = VECTOR (CMD_BUF);

   9451  9 001367   000102 237000 10                 LDAQ    66
         9 001370   003002 757000 2                  STAQ    XUG$GETCMD_+28

     1190     9452    3           BREAK_ARS = 0;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:186  
   9452  9 001371   003066 450000 2                  STZ     BREAK_ARS

     1191     9453    3           END;

   9453  9 001372   001375 710000 9                  TRA     s:9456

     1192     9454    2        ELSE
     1193     9455    2           XUG$GETCMD_.TEXT_ = VECTOR (NIL);

   9455  9 001373   000104 237000 10                 LDAQ    68
         9 001374   003002 757000 2                  STAQ    XUG$GETCMD_+28

     1194     9456    2        CALL XUG$GETCMD(XUG$GETCMD_)

   9456  9 001375   000001 630400 10                 EPPR0   1
         9 001376   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001377   000000 701000 xent               TSX1    XUG$GETCMD
         9 001400   001402 702000 9                  TSX2    s:9458
         9 001401   001560 710000 9                  TRA     s:9523

     1195     9457    3        WHENALTRETURN DO;

     1196     9458    4           DO SELECT( XUG$GETCMD_.ERR#.CODE#) ;

   9458  9 001402   002747 236000 2                  LDQ     XUG$GETCMD_+1
         9 001403   000003 772000                    QRL     3
         9 001404   037777 376007                    ANQ     16383,DL
         9 001405   000010 116007                    CMPQ    8,DL
         9 001406   001424 602000 9                  TNC     s:9458+18
         9 001407   001437 600000 9                  TZE     s:9465
         9 001410   000155 116007                    CMPQ    109,DL
         9 001411   001417 602000 9                  TNC     s:9458+13
         9 001412   001462 600000 9                  TZE     s:9475
         9 001413   000003 736000                    QLS     3
         9 001414   001610 116007                    CMPQ    904,DL
         9 001415   001553 601000 9                  TNZ     s:9519
         9 001416   001462 710000 9                  TRA     s:9475
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:187  
         9 001417   002747 236000 2                  LDQ     XUG$GETCMD_+1
         9 001420   377770 376007                    ANQ     131064,DL
         9 001421   000110 116007                    CMPQ    72,DL
         9 001422   001553 601000 9                  TNZ     s:9519
         9 001423   001437 710000 9                  TRA     s:9465
         9 001424   002747 236000 2                  LDQ     XUG$GETCMD_+1
         9 001425   000003 772000                    QRL     3
         9 001426   037777 376007                    ANQ     16383,DL
         9 001427   000001 116007                    CMPQ    1,DL
         9 001430   001553 602000 9                  TNC     s:9519
         9 001431   001436 600000 9                  TZE     s:9460
         9 001432   000003 736000                    QLS     3
         9 001433   000060 116007                    CMPQ    48,DL
         9 001434   001553 601000 9                  TNZ     s:9519
         9 001435   001462 710000 9                  TRA     s:9475

     1197     9459
     1198     9460    4              SELECT(%E$SYNERR);

   9460  9 001436   001560 710000 9                  TRA     s:9523

     1199     9461                            /* IGNORE SYNTAX ERRORS BECAUSE EDIT WILL CATCH IT LATER */
     1200     9462
     1201     9463
     1202     9464    4              SELECT (%E$IOERR , %E$DI) ;

     1203     9465    4              IF B$JIT.MODE = %M_BATCH# OR M$DCB$ -> F$DCB.DDEV.XEQ

   9465  9 001437   000000 470400 xsym               LDP0    B$JIT$
         9 001440   000000 236100                    LDQ     0,,PR0
         9 001441   740000 376003                    ANQ     -16384,DU
         9 001442   040000 116003                    CMPQ    16384,DU
         9 001443   001450 600000 9                  TZE     s:9468
         9 001444   002656 471400 2                  LDP1    M$DCB$
         9 001445   100004 236100                    LDQ     4,,PR1
         9 001446   040000 316007                    CANQ    16384,DL
         9 001447   001455 600000 9                  TZE     s:9471
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:188  

     1204     9466    4              THEN
     1205     9467    5              DO ;

     1206     9468    5                 CALL VEX$ERROR(0,3) ;

   9468  9 001450   000106 630400 10                 EPPR0   70
         9 001451   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001452   000000 701000 xent               TSX1    VEX$ERROR
         9 001453   000000 011000                    NOP     0

     1207     9469    5                 GOTO READ_CMD_ERR;

   9469  9 001454   001707 710000 9                  TRA     READ_CMD_ERR

     1208     9470    5                 END ;                     /* THEN DO */
     1209     9471    4              CALL VEX$ERROR(E$E_INPUTERR,3) ;

   9471  9 001455   000110 630400 10                 EPPR0   72
         9 001456   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001457   000000 701000 xent               TSX1    VEX$ERROR
         9 001460   000000 011000                    NOP     0

     1210     9472    4              GOTO READ_CMD_AGAIN;

   9472  9 001461   001316 710000 9                  TRA     READ_CMD_AGAIN

     1211     9473
     1212     9474    4              SELECT(%E$EOF,%E$NOFILE,%E$FILEBUSY) ;

     1213     9475    4              IF     XUG$GETCMD_.ERR#.CODE# ~= %E$EOF

   9475  9 001462   002747 236000 2                  LDQ     XUG$GETCMD_+1
         9 001463   377770 376007                    ANQ     131064,DL
         9 001464   000060 116007                    CMPQ    48,DL
         9 001465   001472 600000 9                  TZE     s:9478

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:189  
     1214     9476    4              THEN
     1215     9477    4                 CALL VEX$ERROR(0,3) ;

   9477  9 001466   000106 630400 10                 EPPR0   70
         9 001467   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001470   000000 701000 xent               TSX1    VEX$ERROR
         9 001471   000000 011000                    NOP     0

     1216     9478    4              IF M$DCB$ -> F$DCB.ASN = %FILE#

   9478  9 001472   002656 470400 2                  LDP0    M$DCB$
         9 001473   000032 236100                    LDQ     26,,PR0
         9 001474   777000 376007                    ANQ     -512,DL
         9 001475   001000 116007                    CMPQ    512,DL
         9 001476   001707 601000 9                  TNZ     READ_CMD_ERR

     1217     9479    4              THEN
     1218     9480    5              DO ;

     1219     9481    5                 CLOSE_SIREAD_FPT.V.DCB# = IN_DCBNUM ;

   9481  9 001477   001245 720000 2                  LXL0    IN_DCBNUM
         9 001500   000162 740000 2                  STX0    CLOSE_SIREAD_FPT+26

     1220     9482    5                 CALL M$CLOSE(CLOSE_SIREAD_FPT) ALTRET (CLOSE_SIREAD_ERR) ;

   9482  9 001501   000130 630400 2                  EPPR0   CLOSE_SIREAD_FPT
         9 001502   450001 713400                    CLIMB   alt,close
         9 001503   406000 401760                    pmme    nvectors=13
         9 001504   001505 702000 9                  TSX2    CLOSE_SIREAD_ERR

     1221     9483    5   CLOSE_SIREAD_ERR:
     1222     9484    5                 IF IN_DCBNUM = SI_DCBNUM

   9484  9 001505   001245 236000 2     CLOSE_SIREA* LDQ     IN_DCBNUM
         9 001506   001247 116000 2                  CMPQ    SI_DCBNUM
         9 001507   001521 601000 9                  TNZ     s:9495
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:190  

     1223     9485    6                 THEN DO;

     1224     9486    6                    CALL M$OPEN(OPEN_SIME_FPT) ALTRET(READ_CMD_ERR);

   9486  9 001510   000172 630400 1                  EPPR0   OPEN_SIME_FPT
         9 001511   450000 713400                    CLIMB   alt,open
         9 001512   410400 401760                    pmme    nvectors=18
         9 001513   001707 702000 9                  TSX2    READ_CMD_ERR

     1225     9487    6                    CALL VEX$ERROR(E$E_REOPENMSI,3) ;

   9487  9 001514   000113 630400 10                 EPPR0   75
         9 001515   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001516   000000 701000 xent               TSX1    VEX$ERROR
         9 001517   000000 011000                    NOP     0

     1226     9488    6                    END;

   9488  9 001520   001531 710000 9                  TRA     s:9502

     1227     9489        /*E*     ERROR:    VEE-E$E_REOPENMSI-0
     1228     9490                 MESSAGE: M$SI has been reinitialized to the ME device.
     1229     9491                 DESCRIPTION: M$SI WAS SET TO A BOGUS FILE,AND HAS BEEN RESET
     1230     9492        */
     1231     9493        /**/
     1232     9494    6                 ELSE DO ;

     1233     9495    6                    RELDCB_FPT.V.DCB# = IN_DCBNUM ;

   9495  9 001521   000000 620006                    EAX0    0,QL
         9 001522   000240 740000 2                  STX0    RELDCB_FPT+2

     1234     9496    6                    CALL M$RELDCB(RELDCB_FPT) ALTRET(RELDCB_ERR) ;

   9496  9 001523   000236 630400 2                  EPPR0   RELDCB_FPT
         9 001524   460003 713400                    CLIMB   alt,+24579
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:191  
         9 001525   400000 401760                    pmme    nvectors=1
         9 001526   001527 702000 9                  TSX2    RELDCB_ERR

     1235     9497    6   RELDCB_ERR:
     1236     9498    6                    IN_DCBNUM = SI_DCBNUM ;

   9498  9 001527   001247 235000 2     RELDCB_ERR   LDA     SI_DCBNUM
         9 001530   001245 755000 2                  STA     IN_DCBNUM

     1237     9499    6                    END ;                  /* ELSE DO */

     1238     9500
     1239     9501                                 /* If last line was continue it must be reparsed */
     1240     9502    5                 IF XUG$GETCMD_.ERR#.CODE# = %E$NOFILE OR XUG$GETCMD_.ERR#.CODE# = %
              9502                          E$FILEBUSY

   9502  9 001531   002747 236000 2                  LDQ     XUG$GETCMD_+1
         9 001532   377770 376007                    ANQ     131064,DL
         9 001533   001610 116007                    CMPQ    904,DL
         9 001534   001316 600000 9                  TZE     READ_CMD_AGAIN
         9 001535   001550 116007                    CMPQ    872,DL
         9 001536   001316 600000 9                  TZE     READ_CMD_AGAIN

     1241     9503    5                 THEN
     1242     9504    5                    GOTO READ_CMD_AGAIN;
     1243     9505                                 /* If last line was continue it must be reparsed */
     1244     9506    5                 IF (SUBSTR(XUG$GETCMD_.BUF$->CMD$BUF,P_GET.NCHARS-1,1) = ';')

   9506  9 001537   003006 470400 2                  LDP0    XUG$GETCMD_+32
         9 001540   002723 235000 2                  LDA     P_GET+9
         9 001541   040000 106505                    CMPC    fill='040'O
         9 001542   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         9 001543   000115 000001 10                 ADSC9   77                       cn=0,n=1
         9 001544   001552 601000 9                  TNZ     s:9513

     1245     9507    6                 THEN DO;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:192  
     1246     9508    6                    BREAK_ARS = P_GET.NCHARS;

   9508  9 001545   003066 755000 2                  STA     BREAK_ARS

     1247     9509    6                    CMD_BUF = SUBSTR(XUG$GETCMD_.BUF$->CMD$BUF,

   9509  9 001546   000000 620005                    EAX0    0,AL
         9 001547   040000 100540                    MLR     fill='040'O
         9 001550   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         9 001551   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256

     1248     9510    6                       0,
     1249     9511    6                       P_GET.NCHARS) ;
     1250     9512    6                    END;

     1251     9513    5                 GOTO READ_CMD_AGAIN;

   9513  9 001552   001316 710000 9                  TRA     READ_CMD_AGAIN

     1252     9514    5                 END ;                     /* THEN DO */
     1253     9515    4              ELSE                    /* This is End of file on the XEQ stream */
     1254     9516    4                 GOTO READ_CMD_ERR;
     1255     9517
     1256     9518    4              SELECT(ELSE) ;               /* Bad ERROR. */

     1257     9519    4           CALL VEX$ERROR(0,3) ;

   9519  9 001553   000106 630400 10                 EPPR0   70
         9 001554   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001555   000000 701000 xent               TSX1    VEX$ERROR
         9 001556   000000 011000                    NOP     0

     1258     9520    4           GOTO READ_CMD_ERR;

   9520  9 001557   001707 710000 9                  TRA     READ_CMD_ERR

     1259     9521    4              END ;                        /* DO SELECT */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:193  

     1260     9522    3           END;
     1261     9523    2        FLAGS.INPUT = '0'B;

   9523  9 001560   000116 236000 10                 LDQ     78
         9 001561   002706 356000 2                  ANSQ    FLAGS

     1262     9524        /**/
     1263     9525    3        DO I = 1 TO XUG$GETCMD_.NLINES;

   9525  9 001562   000001 235007                    LDA     1,DL
         9 001563   002640 755000 2                  STA     I
         9 001564   001626 710000 9                  TRA     s:9533+3

     1264     9526    3           TEMP_COUNT = XUG$GETCMD_.RLT$-> XUG_RLT(I);

   9526  9 001565   003007 470400 2                  LDP0    XUG$GETCMD_+33
         9 001566   002640 235000 2                  LDA     I
         9 001567   000000 101505                    MRL     fill='000'O
         9 001570   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         9 001571   002620 000004 2                  ADSC9   TEMP_COUNT               cn=0,n=4

     1265     9527    3           CMD_BUF = SUBSTR(XUG$GETCMD_.BUF$ -> CMD$BUF,CMD_SIZE, TEMP_COUNT) ;

   9527  9 001572   003006 471400 2                  LDP1    XUG$GETCMD_+32
         9 001573   002620 720000 2                  LXL0    TEMP_COUNT
         9 001574   002570 236000 2                  LDQ     CMD_SIZE
         9 001575   040000 100546                    MLR     fill='040'O
         9 001576   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
         9 001577   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256

     1266     9528    3           CALL INSERT(CMDBUF$ -> CMD$BUF,CMD_SIZE,TEMP_COUNT,CMD_BUF);

   9528  9 001600   002662 473400 2                  LDP3    CMDBUF$
         9 001601   040146 100400                    MLR     fill='040'O
         9 001602   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256
         9 001603   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:194  

     1267     9529    3           CMD_SIZE = CMD_SIZE + TEMP_COUNT;

   9529  9 001604   002570 236000 2                  LDQ     CMD_SIZE
         9 001605   002620 036000 2                  ADLQ    TEMP_COUNT
         9 001606   002570 756000 2                  STQ     CMD_SIZE

     1268     9530    4           IF (POFFC(CMDBUF_END$,PINCRC(CMDBUF$,CMD_SIZE)) < SIZEC(CMD_BUF)) THEN DO;

   9530  9 001607   000020 736000                    QLS     16
         9 001610   002662 036000 2                  ADLQ    CMDBUF$
         9 001611   000020 772000                    QRL     16
         9 001612   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 001613   002664 236000 2                  LDQ     CMDBUF_END$
         9 001614   000020 772000                    QRL     16
         9 001615   200414 136100                    SBLQ    IN_SLASH+1,,AUTO
         9 001616   000400 116007                    CMPQ    256,DL
         9 001617   001623 605000 9                  TPL     s:9533

     1269     9531    4              CALL VEX$XPAND ALTRET(NO_MEMORY);

   9531  9 001620   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001621   000000 701000 xent               TSX1    VEX$XPAND
         9 001622   001735 702000 9                  TSX2    NO_MEMORY

     1270     9532    4              END;

     1271     9533    3           END;

   9533  9 001623   002640 235000 2                  LDA     I
         9 001624   000001 035007                    ADLA    1,DL
         9 001625   002640 755000 2                  STA     I
         9 001626   003014 236000 2                  LDQ     XUG$GETCMD_+38
         9 001627   000022 732000                    QRS     18
         9 001630   001633 604000 9                  TMI     s:9535
         9 001631   002640 116000 2                  CMPQ    I
         9 001632   001565 603000 9                  TRC     s:9526
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:195  

     1272     9534        /**/
     1273     9535    3        DO WHILE ((SUBSTR(CMDBUF$->CMD$BUF,CMD_SIZE-1,1) = ';') OR

   9535  9 001633   001637 710000 9                  TRA     s:9538

     1274     9536    3           (SUBSTR(CMDBUF$->CMD$BUF,CMD_SIZE-1,1) = ' ') ) ;
     1275     9537    3           CMD_SIZE = CMD_SIZE -1 ;

   9537  9 001634   002570 235000 2                  LDA     CMD_SIZE
         9 001635   000001 135007                    SBLA    1,DL
         9 001636   002570 755000 2                  STA     CMD_SIZE

     1276     9538    3           END;

   9538  9 001637   002662 470400 2                  LDP0    CMDBUF$
         9 001640   002570 235000 2                  LDA     CMD_SIZE
         9 001641   040000 106505                    CMPC    fill='040'O
         9 001642   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         9 001643   000115 000001 10                 ADSC9   77                       cn=0,n=1
         9 001644   001634 600000 9                  TZE     s:9537
         9 001645   040000 106505                    CMPC    fill='040'O
         9 001646   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         9 001647   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001650   001634 600000 9                  TZE     s:9537

     1277     9539        /**/
     1278     9540        /**/
     1279     9541    2        FLAGS.PARS_ERR = '0'B ;

   9541  9 001651   000007 236000 10                 LDQ     7
         9 001652   002706 356000 2                  ANSQ    FLAGS

     1280     9542    2        IF (CMD_BUF ~= '?') THEN ERR_CODE = '0'B ;

   9542  9 001653   040000 106400                    CMPC    fill='040'O
         9 001654   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:196  
         9 001655   000117 000001 10                 ADSC9   79                       cn=0,n=1
         9 001656   001660 600000 9                  TZE     s:9545

   9542  9 001657   002564 450000 2                  STZ     ERR_CODE

     1281     9543        /**/
     1282     9544        /**/
     1283     9545    2        IF ((CMD_SIZE = 0) AND (M$SI$ -> F$DCB.EOMCHAR = NEWLINE))

   9545  9 001660   000000 115003                    CMPA    0,DU
         9 001661   001671 601000 9                  TNZ     s:9548
         9 001662   002652 471400 2                  LDP1    M$SI$
         9 001663   040000 106500                    CMPC    fill='040'O
         9 001664   100003 600001                    ADSC9   3,,PR1                   cn=3,n=1
         9 001665   000416 000001 1                  ADSC9   NEWLINE                  cn=0,n=1
         9 001666   001671 601000 9                  TNZ     s:9548

     1284     9546    2        THEN FLAGS.NEWLINE_FLAG = TRUE;

   9546  9 001667   040000 236003                    LDQ     16384,DU
         9 001670   002706 256000 2                  ORSQ    FLAGS

     1285     9547        /**/
     1286     9548    3        IF ((CMD_SIZE = 0)AND(M$SI$ -> F$DCB.EOMCHAR = EOT)) THEN DO;

   9548  9 001671   000000 115003                    CMPA    0,DU
         9 001672   001705 601000 9                  TNZ     s:9552
         9 001673   002652 471400 2                  LDP1    M$SI$
         9 001674   040000 106500                    CMPC    fill='040'O
         9 001675   100003 600001                    ADSC9   3,,PR1                   cn=3,n=1
         9 001676   000417 000001 1                  ADSC9   EOT                      cn=0,n=1
         9 001677   001705 601000 9                  TNZ     s:9552

     1287     9549    3           CMD_SIZE = 1;                   /* EOT MEANS UPARROW                  */

   9549  9 001700   000001 236007                    LDQ     1,DL
         9 001701   002570 756000 2                  STQ     CMD_SIZE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:197  

     1288     9550    3           CALL INSERT(CMDBUF$ -> CMD$BUF,0,1,'^');

   9550  9 001702   040100 100400                    MLR     fill='040'O
         9 001703   000120 000001 10                 ADSC9   80                       cn=0,n=1
         9 001704   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1289     9551    3           END;

     1290     9552    2        RETURN;

   9552  9 001705   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 001706   000001 702211                    TSX2  ! 1,X1

     1291     9553        /**/
     1292     9554    2   READ_CMD_ERR:
     1293     9555    2        FLAGS.INPUT = '0'B ;

   9555  9 001707   000116 236000 10    READ_CMD_ERR LDQ     78
         9 001710   002706 356000 2                  ANSQ    FLAGS

     1294     9556    2        IF (B$JIT$ -> B$JIT.MODE = %M_BATCH#) OR

   9556  9 001711   000000 470400 xsym               LDP0    B$JIT$
         9 001712   000000 236100                    LDQ     0,,PR0
         9 001713   740000 376003                    ANQ     -16384,DU
         9 001714   040000 116003                    CMPQ    16384,DU
         9 001715   001722 600000 9                  TZE     READ_SI_ERR
         9 001716   002652 471400 2                  LDP1    M$SI$
         9 001717   100004 236100                    LDQ     4,,PR1
         9 001720   040000 316007                    CANQ    16384,DL
         9 001721   001730 600000 9                  TZE     s:9564

     1295     9557    2           (M$SI$ -> F$DCB.DDEV.XEQ)
     1296     9558    2        THEN
     1297     9559    3        DO ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:198  
     1298     9560    3   READ_SI_ERR:
     1299     9561    3           CALL VEX$ERROR(E$E_CMDERR,3) ;

   9561  9 001722   000122 630400 10    READ_SI_ERR  EPPR0   82
         9 001723   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001724   000000 701000 xent               TSX1    VEX$ERROR
         9 001725   000000 011000                    NOP     0

     1300     9562    3           CALL M$EXIT ;

   9562  9 001726   000001 713400                    CLIMB   exit
         9 001727   000000 401760                    pmme    nvectors=0

     1301     9563    3           END ;                           /* THEN DO */

     1302     9564    2        CALL VEX$ERROR(E$E_INPUTERR,3) ;

   9564  9 001730   000110 630400 10                 EPPR0   72
         9 001731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001732   000000 701000 xent               TSX1    VEX$ERROR
         9 001733   000000 011000                    NOP     0

     1303     9565    2        GOTO READ_CMD_AGAIN ;

   9565  9 001734   001316 710000 9                  TRA     READ_CMD_AGAIN

     1304     9566        /**/
     1305     9567        /*E*     ERROR:    VEE-E$E_CMDERR-0
     1306     9568                 MESSAGE:  Error reading command input - EDIT exiting
     1307     9569                 DESCRIPTION: ERROR READING M$SI - PROBABLY SET SOMEWHERE  */
     1308     9570        /**/
     1309     9571        /*E*     ERROR:    VEE-E$E_INPUTERR-0
     1310     9572                 MESSAGE:  Error reading command input - please try again.
     1311     9573                 DESCRIPTION: ERROR READING M$SI - PROBABLY PARITY OR SOMETHING */
     1312     9574        /**/
     1313     9575    2   NO_MEMORY:
     1314     9576    2        CALL VEX$ERROR(E$E_NOMEM,3);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:199  

   9576  9 001735   000124 630400 10    NO_MEMORY    EPPR0   84
         9 001736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001737   000000 701000 xent               TSX1    VEX$ERROR
         9 001740   000000 011000                    NOP     0

     1315     9577    2        CMD_SIZE = 0;

   9577  9 001741   002570 450000 2                  STZ     CMD_SIZE

     1316     9578    2        RETURN;

   9578  9 001742   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 001743   000001 702211                    TSX2  ! 1,X1

     1317     9579        /*E*    ERROR:   VEE-E$E_NOMEM-0
     1318     9580                DESCRIPTION: NO MEMORY FOR COMMAND TEXT   */
     1319     9581        /**/
     1320     9582    2   END;                                    /* END READ_CMD                       */
     1321     9583        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:200  
     1322     9584        /**/
     1323     9585    1   GET_CMD: PROC ALTRET;

   9585  9 001744   200406 741300       GET_CMD      STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     1324     9586        /**/
     1325     9587    2   DCL IN_DQUOTE BIT(1);
     1326     9588    2   DCL IN_SQUOTE BIT(1);
     1327     9589    2   DCL TBLVAL UBIN WORD ;
     1328     9590    2   DCL STR_LEN UBIN WORD ;
     1329     9591        /**/
     1330     9592        %EQU DQUOTE_TBLPOS = 34 ;
     1331     9593        %EQU SQUOTE_TBLPOS = 39 ;
     1332     9594        %EQU SLASH_TBLPOS = 47 ;
     1333     9595        %EQU SEMICOLON_TBLPOS = 59 ;
     1334     9596    2   DCL IN_SLASH BIT(1);
     1335     9597        /**/
     1336     9598    2        IF (CMD_INDEX >= CMD_SIZE) THEN ALTRETURN; /* NO MORE COMMANDS        */

   9598  9 001745   002624 236000 2                  LDQ     CMD_INDEX
         9 001746   002570 116000 2                  CMPQ    CMD_SIZE
         9 001747   001751 602000 9                  TNC     s:9600

   9598  9 001750   000000 702211                    TSX2  ! 0,X1

     1337     9599        /**/
     1338     9600    2        IF (CMD_INDEX = 0) THEN FLAGS.FIRSTCMD = TRUE; /* FIRST COMMAND       */

   9600  9 001751   000000 116003                    CMPQ    0,DU
         9 001752   001756 601000 9                  TNZ     s:9601

   9600  9 001753   000004 236003                    LDQ     4,DU
         9 001754   002706 256000 2                  ORSQ    FLAGS
         9 001755   001760 710000 9                  TRA     s:9603

     1339     9601    2        ELSE FLAGS.FIRSTCMD = FALSE;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:201  
   9601  9 001756   000126 236000 10                 LDQ     86
         9 001757   002706 356000 2                  ANSQ    FLAGS

     1340     9602        /**/
     1341     9603    2        IN_SLASH = FALSE;

   9603  9 001760   200413 450100                    STZ     IN_SLASH,,AUTO

     1342     9604    2        IN_SQUOTE = FALSE;

   9604  9 001761   200410 450100                    STZ     IN_SQUOTE,,AUTO

     1343     9605    2        IN_DQUOTE = FALSE;

   9605  9 001762   200407 450100                    STZ     IN_DQUOTE,,AUTO

     1344     9606    2        TEMP_CLMN = 0 ;

   9606  9 001763   002617 450000 2                  STZ     TEMP_CLMN

     1345     9607    2        CMDBUF$ = PINCRC(CMDBUF_BASE$, CMD_INDEX) ;

   9607  9 001764   002624 236000 2                  LDQ     CMD_INDEX
         9 001765   000020 736000                    QLS     16
         9 001766   002663 036000 2                  ADLQ    CMDBUF_BASE$
         9 001767   002662 756000 2                  STQ     CMDBUF$

     1346     9608    2        GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;

   9608  9 001770   042000 236007                    LDQ     17408,DL
         9 001771   003101 552010 2                  STBQ    GET_CMD_TBL+8,'10'O

     1347     9609    2        GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;

   9609  9 001772   000047 236007                    LDQ     39,DL
         9 001773   003102 552004 2                  STBQ    GET_CMD_TBL+9,'04'O

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:202  
     1348     9610    2        GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;

   9610  9 001774   000057 236007                    LDQ     47,DL
         9 001775   003104 552004 2                  STBQ    GET_CMD_TBL+11,'04'O

     1349     9611    2        GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;

   9611  9 001776   000073 236007                    LDQ     59,DL
         9 001777   003107 552004 2                  STBQ    GET_CMD_TBL+14,'04'O

     1350     9612    2        STR_LEN = CMD_SIZE - CMD_INDEX ;

   9612  9 002000   002570 236000 2                  LDQ     CMD_SIZE
         9 002001   002624 136000 2                  SBLQ    CMD_INDEX
         9 002002   200412 756100                    STQ     STR_LEN,,AUTO

     1351     9613        /**/
     1352     9614    3        DO WHILE (TEMP_CLMN < CMD_SIZE - CMD_INDEX);

   9614  9 002003   002147 710000 9                  TRA     s:9677

     1353     9615    3           CALL SEARCH (TEMP_CLMN, TBLVAL, GET_CMD_TBL, SUBSTR(CMDBUF$ ->

   9615  9 002004   200412 236100                    LDQ     STR_LEN,,AUTO
         9 002005   002617 136000 2                  SBLQ    TEMP_CLMN
         9 002006   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 002007   002617 236000 2                  LDQ     TEMP_CLMN
         9 002010   002662 470400 2                  LDP0    CMDBUF$
         9 002011   200414 720100                    LXL0    IN_SLASH+1,,AUTO
         9 002012   000000 164546                    TCT
         9 002013   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
         9 002014   003071 000000 2                  ARG     GET_CMD_TBL
         9 002015   002617 000000 2                  ARG     TEMP_CLMN
         9 002016   002617 235000 2                  LDA     TEMP_CLMN
         9 002017   000033 771000                    ARL     27
         9 002020   200411 755100                    STA     TBLVAL,,AUTO
         9 002021   002617 551040 2                  STBA    TEMP_CLMN,'40'O
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:203  
         9 002022   002617 056000 2                  ASQ     TEMP_CLMN
         9 002023   002127 606400 9                  TTN     GOT_CMD

     1354     9616    3              CMD$BUF,0,STR_LEN), TEMP_CLMN) ALTRET (GOT_CMD) ;
     1355     9617        /**/
     1356     9618    4           DO SELECT (TBLVAL) ;

   9618  9 002024   200411 236100                    LDQ     TBLVAL,,AUTO
         9 002025   000047 116007                    CMPQ    39,DL
         9 002026   002036 602000 9                  TNC     s:9618+10
         9 002027   002063 600000 9                  TZE     s:9637
         9 002030   000057 116007                    CMPQ    47,DL
         9 002031   002144 602000 9                  TNC     s:9676
         9 002032   002105 600000 9                  TZE     s:9653
         9 002033   000073 116007                    CMPQ    59,DL
         9 002034   002144 601000 9                  TNZ     s:9676
         9 002035   002127 710000 9                  TRA     GOT_CMD
         9 002036   000042 116007                    CMPQ    34,DL
         9 002037   002144 601000 9                  TNZ     s:9676
         9 002040   002041 710000 9                  TRA     s:9621

     1357     9619
     1358     9620    4              SELECT (%DQUOTE_TBLPOS) ;

     1359     9621    4              IF IN_DQUOTE

   9621  9 002041   200407 234100                    SZN     IN_DQUOTE,,AUTO
         9 002042   002053 605000 9                  TPL     s:9631

     1360     9622    4              THEN
     1361     9623    5              DO ;

     1362     9624    5                 IN_DQUOTE = FALSE ;

   9624  9 002043   200407 450100                    STZ     IN_DQUOTE,,AUTO

     1363     9625    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:204  

   9625  9 002044   000047 236007                    LDQ     39,DL
         9 002045   003102 552004 2                  STBQ    GET_CMD_TBL+9,'04'O

     1364     9626    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;

   9626  9 002046   000057 236007                    LDQ     47,DL
         9 002047   003104 552004 2                  STBQ    GET_CMD_TBL+11,'04'O

     1365     9627    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;

   9627  9 002050   000073 236007                    LDQ     59,DL
         9 002051   003107 552004 2                  STBQ    GET_CMD_TBL+14,'04'O

     1366     9628    5                 END ;                     /* Then Do */

   9628  9 002052   002144 710000 9                  TRA     s:9676

     1367     9629    4              ELSE
     1368     9630    5              DO ;

     1369     9631    5                 IN_DQUOTE = TRUE ;

   9631  9 002053   400000 236003                    LDQ     -131072,DU
         9 002054   200407 756100                    STQ     IN_DQUOTE,,AUTO

     1370     9632    5                 GET_CMD_TBL = FALSE ;

   9632  9 002055   000000 100400                    MLR     fill='000'O
         9 002056   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 002057   003071 000400 2                  ADSC9   GET_CMD_TBL              cn=0,n=256

     1371     9633    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;

   9633  9 002060   042000 236007                    LDQ     17408,DL
         9 002061   003101 552010 2                  STBQ    GET_CMD_TBL+8,'10'O

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:205  
     1372     9634    5                 END ;                     /* Else Do */

   9634  9 002062   002144 710000 9                  TRA     s:9676

     1373     9635
     1374     9636    4              SELECT (%SQUOTE_TBLPOS) ;

     1375     9637    4              IF IN_SQUOTE

   9637  9 002063   200410 234100                    SZN     IN_SQUOTE,,AUTO
         9 002064   002075 605000 9                  TPL     s:9647

     1376     9638    4              THEN
     1377     9639    5              DO ;

     1378     9640    5                 IN_SQUOTE = FALSE ;

   9640  9 002065   200410 450100                    STZ     IN_SQUOTE,,AUTO

     1379     9641    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;

   9641  9 002066   042000 236007                    LDQ     17408,DL
         9 002067   003101 552010 2                  STBQ    GET_CMD_TBL+8,'10'O

     1380     9642    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;

   9642  9 002070   000057 236007                    LDQ     47,DL
         9 002071   003104 552004 2                  STBQ    GET_CMD_TBL+11,'04'O

     1381     9643    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;

   9643  9 002072   000073 236007                    LDQ     59,DL
         9 002073   003107 552004 2                  STBQ    GET_CMD_TBL+14,'04'O

     1382     9644    5                 END ;                     /* Then Do */

   9644  9 002074   002144 710000 9                  TRA     s:9676
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:206  

     1383     9645    4              ELSE
     1384     9646    5              DO ;

     1385     9647    5                 IN_SQUOTE = TRUE ;

   9647  9 002075   400000 236003                    LDQ     -131072,DU
         9 002076   200410 756100                    STQ     IN_SQUOTE,,AUTO

     1386     9648    5                 GET_CMD_TBL = FALSE ;

   9648  9 002077   000000 100400                    MLR     fill='000'O
         9 002100   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 002101   003071 000400 2                  ADSC9   GET_CMD_TBL              cn=0,n=256

     1387     9649    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;

   9649  9 002102   000047 236007                    LDQ     39,DL
         9 002103   003102 552004 2                  STBQ    GET_CMD_TBL+9,'04'O

     1388     9650    5                 END ;                     /* Else Do */

   9650  9 002104   002144 710000 9                  TRA     s:9676

     1389     9651
     1390     9652    4              SELECT (%SLASH_TBLPOS) ;

     1391     9653    4              IF IN_SLASH

   9653  9 002105   200413 234100                    SZN     IN_SLASH,,AUTO
         9 002106   002117 605000 9                  TPL     s:9663

     1392     9654    4              THEN
     1393     9655    5              DO ;

     1394     9656    5                 IN_SLASH = FALSE ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:207  
   9656  9 002107   200413 450100                    STZ     IN_SLASH,,AUTO

     1395     9657    5                 GET_CMD_TBL(%DQUOTE_TBLPOS) = ASCBIT('"') ;

   9657  9 002110   042000 236007                    LDQ     17408,DL
         9 002111   003101 552010 2                  STBQ    GET_CMD_TBL+8,'10'O

     1396     9658    5                 GET_CMD_TBL(%SQUOTE_TBLPOS) = ASCBIT('''') ;

   9658  9 002112   000047 236007                    LDQ     39,DL
         9 002113   003102 552004 2                  STBQ    GET_CMD_TBL+9,'04'O

     1397     9659    5                 GET_CMD_TBL(%SEMICOLON_TBLPOS) = ASCBIT(';') ;

   9659  9 002114   000073 236007                    LDQ     59,DL
         9 002115   003107 552004 2                  STBQ    GET_CMD_TBL+14,'04'O

     1398     9660    5                 END ;                     /* Then Do */

   9660  9 002116   002144 710000 9                  TRA     s:9676

     1399     9661    4              ELSE
     1400     9662    5              DO ;

     1401     9663    5                 IN_SLASH = TRUE ;

   9663  9 002117   400000 236003                    LDQ     -131072,DU
         9 002120   200413 756100                    STQ     IN_SLASH,,AUTO

     1402     9664    5                 GET_CMD_TBL = FALSE ;

   9664  9 002121   000000 100400                    MLR     fill='000'O
         9 002122   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 002123   003071 000400 2                  ADSC9   GET_CMD_TBL              cn=0,n=256

     1403     9665    5                 GET_CMD_TBL(%SLASH_TBLPOS) = ASCBIT('/') ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:208  
   9665  9 002124   000057 236007                    LDQ     47,DL
         9 002125   003104 552004 2                  STBQ    GET_CMD_TBL+11,'04'O

     1404     9666    5                 END ;                     /* Else Do */

   9666  9 002126   002144 710000 9                  TRA     s:9676

     1405     9667
     1406     9668    4              SELECT (%SEMICOLON_TBLPOS) ;

     1407     9669    4   GOT_CMD:
     1408     9670    4              CMD_BUF = SUBSTR(CMDBUF$->CMD$BUF, 0, TEMP_CLMN) ;

   9670  9 002127   002662 470400 2     GOT_CMD      LDP0    CMDBUF$
         9 002130   002617 720000 2                  LXL0    TEMP_CLMN
         9 002131   040000 100540                    MLR     fill='040'O
         9 002132   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         9 002133   001250 000400 2                  ADSC9   CMD_BUF                  cn=0,n=256

     1409     9671    4              P_PCB.NCHARS = TEMP_CLMN ;

   9671  9 002134   002617 235000 2                  LDA     TEMP_CLMN
         9 002135   002741 755000 2                  STA     P_PCB+9

     1410     9672    4              CMD_INDEX = CMD_INDEX + TEMP_CLMN + 1 ;

   9672  9 002136   002624 236000 2                  LDQ     CMD_INDEX
         9 002137   002617 036000 2                  ADLQ    TEMP_CLMN
         9 002140   000001 036007                    ADLQ    1,DL
         9 002141   002624 756000 2                  STQ     CMD_INDEX

     1411     9673    4              RETURN ;

   9673  9 002142   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002143   000001 702211                    TSX2  ! 1,X1

     1412     9674
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:209  
     1413     9675    4              END ;                        /* Do Select */

     1414     9676    3           TEMP_CLMN = TEMP_CLMN + 1 ;

   9676  9 002144   002617 236000 2                  LDQ     TEMP_CLMN
         9 002145   000001 036007                    ADLQ    1,DL
         9 002146   002617 756000 2                  STQ     TEMP_CLMN

     1415     9677    3           END ;                           /* Do While */

   9677  9 002147   002570 236000 2                  LDQ     CMD_SIZE
         9 002150   002624 136000 2                  SBLQ    CMD_INDEX
         9 002151   002155 604000 9                  TMI     s:9678
         9 002152   002617 116000 2                  CMPQ    TEMP_CLMN
         9 002153   002155 600000 9                  TZE     s:9678
         9 002154   002004 603000 9                  TRC     s:9615

     1416     9678    2        GOTO GOT_CMD ;

   9678  9 002155   002127 710000 9                  TRA     GOT_CMD

     1417     9679        /**/
     1418     9680    2   END;                                    /* END GET_CMD                        */
     1419     9681        /**/
     1420     9682        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:210  
     1421     9683        /**/
     1422     9684    1   READ_FIRST_REC: PROC ALTRET;

   9684  9 002156   200406 741300       READ_FIRST_* STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     1423     9685        /**/
     1424     9686        /*F*     NAME:     READ_FIRST_REC
     1425     9687                 FUNCTION: READS THE FIRST RECORD OF THE SELECTED RANGE OF THE
     1426     9688                      FILE INTO REC_BUF. ALTRET IF NO RECORDS IN RANGE */
     1427     9689        /**/
     1428     9690    2        CALL VEX$READ_RANDOM (LO_SEQNUM) ALTRET (READ_FIRST_ERR);

   9690  9 002157   000127 630400 10                 EPPR0   87
         9 002160   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002161   000000 701000 xent               TSX1    VEX$READ_RANDOM
         9 002162   002217 702000 9                  TSX2    READ_FIRST_ERR

     1429     9691    3        IF (~FLAGS.EXISTS) THEN DO;        /* NO RECORD WITH THAT KEY            */

   9691  9 002163   002706 236000 2                  LDQ     FLAGS
         9 002164   000004 736000                    QLS     4
         9 002165   400000 376003                    ANQ     -131072,DU
         9 002166   400000 676003                    ERQ     -131072,DU
         9 002167   002215 600000 9                  TZE     s:9714

     1430     9692    3           CALL VEX$READ_SEQUEN ALTRET (READ_FIRST_ERR);

   9692  9 002170   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002171   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         9 002172   002217 702000 9                  TSX2    READ_FIRST_ERR

     1431     9693    4           IF (FLAGS.EOF) THEN DO;

   9693  9 002173   002706 236000 2                  LDQ     FLAGS
         9 002174   010000 316003                    CANQ    4096,DU
         9 002175   002204 600000 9                  TZE     s:9702

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:211  
     1432     9694    4              CALL VEX$ERROR (E$E_EDITEOF,1);

   9694  9 002176   000032 630400 10                 EPPR0   26
         9 002177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002200   000000 701000 xent               TSX1    VEX$ERROR
         9 002201   000000 011000                    NOP     0

     1433     9695    4              ALTRETURN;

   9695  9 002202   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002203   000000 702211                    TSX2  ! 0,X1

     1434     9696    4              END;
     1435     9697        /**/
     1436     9698        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1437     9699                 DESCRIPTION: EOF hit before selected range or record.
     1438     9700        */
     1439     9701        /**/
     1440     9702    3           IF LAST_KEY > HI_SEQNUM

   9702  9 002204   002602 236000 2                  LDQ     HI_SEQNUM
         9 002205   002613 116000 2                  CMPQ    LAST_KEY
         9 002206   002215 603000 9                  TRC     s:9714

     1441     9703    4           THEN DO;

     1442     9704    4              CALL VEX$ERROR (E$E_NONE,1);

   9704  9 002207   000055 630400 10                 EPPR0   45
         9 002210   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002211   000000 701000 xent               TSX1    VEX$ERROR
         9 002212   000000 011000                    NOP     0

     1443     9705    4              ALTRETURN;

   9705  9 002213   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002214   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:212  

     1444     9706    4              END;
     1445     9707        /**/
     1446     9708        /*E*     ERROR:    VEE-E$E_NONE-0
     1447     9709                 MESSAGE:  None
     1448     9710                 MESSAGE1: No records in range
     1449     9711                 DESCRIPTION: There are no records in the selected range.
     1450     9712        */
     1451     9713    3           END;
     1452     9714    2        RETURN;

   9714  9 002215   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002216   000001 702211                    TSX2  ! 1,X1

     1453     9715        /**/
     1454     9716    2   READ_FIRST_ERR:
     1455     9717    2        ALTRETURN;

   9717  9 002217   200406 221300       READ_FIRST_* LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002220   000000 702211                    TSX2  ! 0,X1

     1456     9718    2   END;                                    /* END READ_FIRST_REC                 */
     1457     9719        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:213  
     1458     9720    1   CHECK_SSE: PROC ALTRET;

   9720  9 002221   200406 741300       CHECK_SSE    STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     1459     9721        /**/
     1460     9722    2   DCL SSE$ PTR;                           /* TEMP PTR TO RUN SSE_TBL            */
     1461     9723    2   DCL 1 STR_FLGS,
     1462     9724    2          2 CLMNFLAG BIT(1) UNAL,
     1463     9725    2          2 NOTFLAG BIT(1) UNAL,
     1464     9726    2          2 ANDFLAG BIT(1) UNAL,
     1465     9727    2          2 ORFLAG BIT(1) UNAL,
     1466     9728    2          2 EORFLAG BIT(1) UNAL,
     1467     9729    2          2 * BIT(13) UNAL;
     1468     9730    2   DCL SSE_EVAL BIT(1);
     1469     9731        /**/
     1470     9732    2        SSE$ = ADDR(SSE_TBL);

   9732  9 002222   200003 630500                    EPPR0   SSE_TBL,,AUTO
         9 002223   200407 450500                    STP0    SSE$,,AUTO

     1471     9733    2        IF (SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL)) THEN RETURN;
              9733                 /* NO SELECTION CRITERIA */

   9733  9 002224   000001 236100                    LDQ     1,,PR0
         9 002225   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002226   002230 601000 9                  TNZ     s:9734

   9733  9 002227   000001 702211                    TSX2  ! 1,X1

     1472     9734    2        SSE_EVAL = FALSE;

   9734  9 002230   200411 450100                    STZ     SSE_EVAL,,AUTO

     1473     9735        /**/
     1474     9736    2   CHECK_SSE_1:
     1475     9737    2        STR_FLGS = SSE$ -> SSE$PARAM.FLAGS;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:214  
   9737  9 002231   200407 470500       CHECK_SSE_1  LDP0    SSE$,,AUTO
         9 002232   000000 220100                    LDX0    0,,PR0
         9 002233   200410 740100                    STX0    STR_FLGS,,AUTO

     1476     9738    2        IF ((SSE_EVAL) AND (STR_FLGS.ORFLAG)) THEN GOTO CHECK_SSE_NEXT;

   9738  9 002234   200411 234100                    SZN     SSE_EVAL,,AUTO
         9 002235   002241 605000 9                  TPL     s:9739
         9 002236   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002237   040000 316003                    CANQ    16384,DU
         9 002240   002362 601000 9                  TNZ     CHECK_SSE_NEXT

     1477     9739    2        IF ((~SSE_EVAL) AND (STR_FLGS.ANDFLAG)) THEN GOTO CHECK_SSE_NEXT;

   9739  9 002241   200411 236100                    LDQ     SSE_EVAL,,AUTO
         9 002242   400000 376003                    ANQ     -131072,DU
         9 002243   400000 676003                    ERQ     -131072,DU
         9 002244   002250 600000 9                  TZE     s:9741
         9 002245   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002246   100000 316003                    CANQ    32768,DU
         9 002247   002362 601000 9                  TNZ     CHECK_SSE_NEXT

     1478     9740        /**/
     1479     9741    2        CALL VEX$FIND_MATCH(SSE$,LO_SRCH_CLMN,HI_SRCH_CLMN,MATCH_CLMN) ALTRET (
              9741                 CHECK_SSE_2);

   9741  9 002250   000130 237000 10                 LDAQ    88
         9 002251   200416 757100                    STAQ    IN_SLASH+3,,AUTO
         9 002252   000132 236000 10                 LDQ     90
         9 002253   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 002254   200407 631500                    EPPR1   SSE$,,AUTO
         9 002255   200414 451500                    STP1    IN_SLASH+1,,AUTO
         9 002256   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 002257   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 002260   000000 701000 xent               TSX1    VEX$FIND_MATCH
         9 002261   002324 702000 9                  TSX2    CHECK_SSE_2

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:215  
     1480     9742                                                /* MATCHING STRING IS PRESENT         */
     1481     9743    2        IF ((~SSE_EVAL) AND

   9743  9 002262   200411 236100                    LDQ     SSE_EVAL,,AUTO
         9 002263   400000 376003                    ANQ     -131072,DU
         9 002264   400000 676003                    ERQ     -131072,DU
         9 002265   002303 600000 9                  TZE     s:9747
         9 002266   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002267   040000 316003                    CANQ    16384,DU
         9 002270   002273 601000 9                  TNZ     s:9743+9
         9 002271   020000 316003                    CANQ    8192,DU
         9 002272   002303 600000 9                  TZE     s:9747
         9 002273   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002274   000001 736000                    QLS     1
         9 002275   400000 376003                    ANQ     -131072,DU
         9 002276   400000 676003                    ERQ     -131072,DU
         9 002277   002303 600000 9                  TZE     s:9747

     1482     9744    2           (((STR_FLGS.ORFLAG) OR (STR_FLGS.EORFLAG)) AND (~STR_FLGS.NOTFLAG)))
     1483     9745    2        THEN SSE_EVAL = TRUE;

   9745  9 002300   400000 236003                    LDQ     -131072,DU
         9 002301   200411 756100                    STQ     SSE_EVAL,,AUTO
         9 002302   002323 710000 9                  TRA     s:9752

     1484     9746        /**/
     1485     9747    2        ELSE IF ((SSE_EVAL) AND

   9747  9 002303   200411 234100                    SZN     SSE_EVAL,,AUTO
         9 002304   002312 605000 9                  TPL     s:9747+7
         9 002305   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002306   100000 316003                    CANQ    32768,DU
         9 002307   002312 600000 9                  TZE     s:9747+7
         9 002310   200000 316003                    CANQ    65536,DU
         9 002311   002322 601000 9                  TNZ     s:9750
         9 002312   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002313   020000 316003                    CANQ    8192,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:216  
         9 002314   002323 600000 9                  TZE     s:9752
         9 002315   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002316   000001 736000                    QLS     1
         9 002317   400000 376003                    ANQ     -131072,DU
         9 002320   400000 676003                    ERQ     -131072,DU
         9 002321   002323 600000 9                  TZE     s:9752

     1486     9748    2              ((STR_FLGS.ANDFLAG) AND (STR_FLGS.NOTFLAG)) OR
     1487     9749    2              ((STR_FLGS.EORFLAG) AND (~STR_FLGS.NOTFLAG)))
     1488     9750    2           THEN SSE_EVAL = FALSE;

   9750  9 002322   200411 450100                    STZ     SSE_EVAL,,AUTO

     1489     9751        /**/
     1490     9752    2        GOTO CHECK_SSE_NEXT;

   9752  9 002323   002362 710000 9                  TRA     CHECK_SSE_NEXT

     1491     9753        /**/                                    /* MATCHING STRING NOT FOUND          */
     1492     9754    2   CHECK_SSE_2:
     1493     9755    2        IF ((~SSE_EVAL) AND

   9755  9 002324   200411 236100       CHECK_SSE_2  LDQ     SSE_EVAL,,AUTO
         9 002325   400000 376003                    ANQ     -131072,DU
         9 002326   400000 676003                    ERQ     -131072,DU
         9 002327   002342 600000 9                  TZE     s:9759
         9 002330   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002331   200000 316003                    CANQ    65536,DU
         9 002332   002342 600000 9                  TZE     s:9759
         9 002333   040000 316003                    CANQ    16384,DU
         9 002334   002337 601000 9                  TNZ     s:9757
         9 002335   020000 316003                    CANQ    8192,DU
         9 002336   002342 600000 9                  TZE     s:9759

     1494     9756    2           ((STR_FLGS.NOTFLAG)  AND ((STR_FLGS.ORFLAG) OR (STR_FLGS.EORFLAG))))
     1495     9757    2        THEN SSE_EVAL = TRUE;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:217  
   9757  9 002337   400000 236003                    LDQ     -131072,DU
         9 002340   200411 756100                    STQ     SSE_EVAL,,AUTO
         9 002341   002362 710000 9                  TRA     CHECK_SSE_NEXT

     1496     9758        /**/
     1497     9759    2        ELSE IF ((SSE_EVAL) AND

   9759  9 002342   200411 234100                    SZN     SSE_EVAL,,AUTO
         9 002343   002362 605000 9                  TPL     CHECK_SSE_NEXT
         9 002344   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002345   100000 316003                    CANQ    32768,DU
         9 002346   002354 600000 9                  TZE     s:9759+10
         9 002347   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002350   000001 736000                    QLS     1
         9 002351   400000 376003                    ANQ     -131072,DU
         9 002352   400000 676003                    ERQ     -131072,DU
         9 002353   002361 601000 9                  TNZ     s:9762
         9 002354   200410 236100                    LDQ     STR_FLGS,,AUTO
         9 002355   020000 316003                    CANQ    8192,DU
         9 002356   002362 600000 9                  TZE     CHECK_SSE_NEXT
         9 002357   200000 316003                    CANQ    65536,DU
         9 002360   002362 600000 9                  TZE     CHECK_SSE_NEXT

     1498     9760    2              (((STR_FLGS.ANDFLAG) AND (~STR_FLGS.NOTFLAG)) OR
     1499     9761    2              ((STR_FLGS.EORFLAG) AND (STR_FLGS.NOTFLAG))))
     1500     9762    2           THEN SSE_EVAL = FALSE;

   9762  9 002361   200411 450100                    STZ     SSE_EVAL,,AUTO

     1501     9763        /**/
     1502     9764    2   CHECK_SSE_NEXT:
     1503     9765    2        SSE$ = PINCRW(SSE$,2);             /* TWO WORD BLOCKS                    */

   9765  9 002362   200407 236100       CHECK_SSE_N* LDQ     SSE$,,AUTO
         9 002363   000002 036003                    ADLQ    2,DU
         9 002364   200407 756100                    STQ     SSE$,,AUTO

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:218  
     1504     9766    3        IF (SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL)) THEN DO;

   9766  9 002365   200407 470500                    LDP0    SSE$,,AUTO
         9 002366   000001 236100                    LDQ     1,,PR0
         9 002367   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002370   002402 601000 9                  TNZ     s:9774

     1505     9767    4           IF (SSE_EVAL) THEN DO ;

   9767  9 002371   200411 234100                    SZN     SSE_EVAL,,AUTO
         9 002372   002400 605000 9                  TPL     s:9771

     1506     9768    4              FT_COUNT = FT_COUNT + 1 ;

   9768  9 002373   002631 235000 2                  LDA     FT_COUNT
         9 002374   000001 035007                    ADLA    1,DL
         9 002375   002631 755000 2                  STA     FT_COUNT

     1507     9769    4              RETURN ;

   9769  9 002376   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002377   000001 702211                    TSX2  ! 1,X1

     1508     9770    4              END ;                        /* THEN DO */
     1509     9771    3           ELSE ALTRETURN;

   9771  9 002400   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002401   000000 702211                    TSX2  ! 0,X1

     1510     9772    3           END;
     1511     9773        /**/
     1512     9774    2        GOTO CHECK_SSE_1;

   9774  9 002402   002231 710000 9                  TRA     CHECK_SSE_1

     1513     9775        /**/
     1514     9776    2   END;                                    /* END CHECK SSE                      */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:219  
     1515     9777        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:220  
     1516     9778        /**/
     1517     9779    1   CHECK_CMD: PROC ALTRET;

   9779  9 002403   200406 741300       CHECK_CMD    STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     1518     9780        /**/
     1519     9781    2        BLK$ = P_PCB.OUT$;

   9781  9 002404   002733 236000 2                  LDQ     P_PCB+3
         9 002405   002700 756000 2                  STQ     BLK$

     1520     9782    3        IF (FLAGS.NOCOMPCMD = TRUE) THEN DO; /* NO MORE COMMANDS ALLOWED      */

   9782  9 002406   002706 236000 2                  LDQ     FLAGS
         9 002407   000010 316003                    CANQ    8,DU
         9 002410   002444 600000 9                  TZE     s:9801

     1521     9783    4           IF (CMD_CODE = BLANKLINE) THEN DO ;

   9783  9 002411   002625 235000 2                  LDA     CMD_CODE
         9 002412   000120 115007                    CMPA    80,DL
         9 002413   002436 601000 9                  TNZ     s:9788

     1522     9784    4              CALL VEX$SET_SUB_BUF(SUB_BUF_1,CMD_INDEX-P_PCB.NCHARS-1) ;

   9784  9 002414   002624 236000 2                  LDQ     CMD_INDEX
         9 002415   002741 136000 2                  SBLQ    P_PCB+9
         9 002416   000001 136007                    SBLQ    1,DL
         9 002417   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 002420   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 002421   200417 450500                    STP0    IN_SLASH+4,,AUTO
         9 002422   000010 236000 10                 LDQ     8
         9 002423   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 002424   200416 630500                    EPPR0   IN_SLASH+3,,AUTO
         9 002425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002426   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         9 002427   000000 011000                    NOP     0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:221  

     1523     9785    4              CALL VEX$ERROR(E$E_SYNTAX,2) ;

   9785  9 002430   000066 630400 10                 EPPR0   54
         9 002431   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002432   000000 701000 xent               TSX1    VEX$ERROR
         9 002433   000000 011000                    NOP     0

     1524     9786    4              ALTRETURN ;

   9786  9 002434   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002435   000000 702211                    TSX2  ! 0,X1

     1525     9787    4              END ;                        /* THEN DO */
     1526     9788    3           CALL VEX$ERROR (E$E_NOTCOMP,3);

   9788  9 002436   000134 630400 10                 EPPR0   92
         9 002437   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002440   000000 701000 xent               TSX1    VEX$ERROR
         9 002441   000000 011000                    NOP     0

     1527     9789    3           ALTRETURN;

   9789  9 002442   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002443   000000 702211                    TSX2  ! 0,X1

     1528     9790    3           END;
     1529     9791        /**/
     1530     9792        /*E*     ERROR:    VEE-E$E_NOTCOMP-0
     1531     9793                 MESSAGE:  Command not compoundable
     1532     9794                 MESSAGE1: One of the commands in the last command line must
     1533     9795                           be the last command on a line and is not last or
     1534     9796                           the first command on a line and is not first.
     1535     9797                 DESCRIPTION: There are commands following a command which
     1536     9798                           must appear last on a line.
     1537     9799        */
     1538     9800        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:222  
     1539     9801    2        CMD_CODE = BLK$ -> OUT$BLK.CODE;

   9801  9 002444   002700 470400 2                  LDP0    BLK$
         9 002445   000000 236100                    LDQ     0,,PR0
         9 002446   777777 376007                    ANQ     -1,DL
         9 002447   002625 756000 2                  STQ     CMD_CODE

     1540     9802    2        IF (CMD_CODE ~= QMCMD)AND(CMD_CODE ~= QM2CMD) THEN LAST_CMD = CMD_CODE;

   9802  9 002450   000004 116007                    CMPQ    4,DL
         9 002451   002455 600000 9                  TZE     s:9803
         9 002452   000005 116007                    CMPQ    5,DL
         9 002453   002455 600000 9                  TZE     s:9803

   9802  9 002454   002626 756000 2                  STQ     LAST_CMD

     1541     9803    2        CMD$ -> CMD_CNTRLWD.FLAGS = FALSE; /* CLEAR FLAGS                     */

   9803  9 002455   000000 220003                    LDX0    0,DU
         9 002456   002657 471400 2                  LDP1    CMD$
         9 002457   100000 740100                    STX0    0,,PR1

     1542     9804    2        CMD$ -> CMD_CNTRLWD.CMD_CODE = CMD_CODE;

   9804  9 002460   002657 470400 2                  LDP0    CMD$
         9 002461   002625 236000 2                  LDQ     CMD_CODE
         9 002462   000000 552104                    STBQ    0,'04'O,PR0

     1543     9805    2        FLAGS.INTRA_CMD = FALSE;           /* RESET FLAGS                        */

   9805  9 002463   000004 236000 10                 LDQ     4
         9 002464   002706 356000 2                  ANSQ    FLAGS

     1544     9806        /**/
     1545     9807    3        DO CASE (CMD_CODE);                /* CHECK FOR LEGAL INPUT MODE CMDS    */

   9807  9 002465   002625 235000 2                  LDA     CMD_CODE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:223  
         9 002466   000037 135007                    SBLA    31,DL
         9 002467   000046 115007                    CMPA    38,DL
         9 002470   002472 602005 9                  TNC     s:9807+5,AL
         9 002471   002560 710000 9                  TRA     s:9822
         9 002472   002540 710000 9                  TRA     s:9812
         9 002473   002540 710000 9                  TRA     s:9812
         9 002474   002540 710000 9                  TRA     s:9812
         9 002475   002540 710000 9                  TRA     s:9812
         9 002476   002540 710000 9                  TRA     s:9812
         9 002477   002540 710000 9                  TRA     s:9812
         9 002500   002540 710000 9                  TRA     s:9812
         9 002501   002540 710000 9                  TRA     s:9812
         9 002502   002540 710000 9                  TRA     s:9812
         9 002503   002540 710000 9                  TRA     s:9812
         9 002504   002540 710000 9                  TRA     s:9812
         9 002505   002540 710000 9                  TRA     s:9812
         9 002506   002540 710000 9                  TRA     s:9812
         9 002507   002540 710000 9                  TRA     s:9812
         9 002510   002560 710000 9                  TRA     s:9822
         9 002511   002560 710000 9                  TRA     s:9822
         9 002512   002560 710000 9                  TRA     s:9822
         9 002513   002560 710000 9                  TRA     s:9822
         9 002514   002560 710000 9                  TRA     s:9822
         9 002515   002560 710000 9                  TRA     s:9822
         9 002516   002560 710000 9                  TRA     s:9822
         9 002517   002560 710000 9                  TRA     s:9822
         9 002520   002560 710000 9                  TRA     s:9822
         9 002521   002540 710000 9                  TRA     s:9812
         9 002522   002540 710000 9                  TRA     s:9812
         9 002523   002540 710000 9                  TRA     s:9812
         9 002524   002560 710000 9                  TRA     s:9822
         9 002525   002560 710000 9                  TRA     s:9822
         9 002526   002560 710000 9                  TRA     s:9822
         9 002527   002540 710000 9                  TRA     s:9812
         9 002530   002540 710000 9                  TRA     s:9812
         9 002531   002540 710000 9                  TRA     s:9812
         9 002532   002540 710000 9                  TRA     s:9812
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:224  
         9 002533   002540 710000 9                  TRA     s:9812
         9 002534   002540 710000 9                  TRA     s:9812
         9 002535   002540 710000 9                  TRA     s:9812
         9 002536   002540 710000 9                  TRA     s:9812
         9 002537   002540 710000 9                  TRA     s:9812

     1546     9808        /**/
     1547     9809    3        CASE (FDCMD,MKCMD,MDCMD,MKPCMD,MDPCMD,CMCMD,CTCMD,INCMD,IPCMD,

     1548     9810    3           IACMD,IBCMD,ISCMD,APCMD,DECMD,ADCMD,RNCMD,RRCMD,ACMD,
     1549     9811    3           ECMD,OCMD,FCMD,PCMD,SCMD,DCMD,RCMD,LCMD);
     1550     9812    3           IF (FLAGS.EDIT_MODE)AND

   9812  9 002540   002706 234000 2                  SZN     FLAGS
         9 002541   002560 605000 9                  TPL     s:9822
         9 002542   002654 470400 2                  LDP0    M$FILE$
         9 002543   000004 236100                    LDQ     4,,PR0
         9 002544   200000 316003                    CANQ    65536,DU
         9 002545   002560 601000 9                  TNZ     s:9822
         9 002546   100000 316003                    CANQ    32768,DU
         9 002547   002560 601000 9                  TNZ     s:9822
         9 002550   040000 316003                    CANQ    16384,DU
         9 002551   002560 601000 9                  TNZ     s:9822

     1551     9813    3              ((NOT(M$FILE$ -> F$DCB.FFLG.DELR))AND
     1552     9814    3              (NOT(M$FILE$ -> F$DCB.FFLG.WNEW))AND
     1553     9815    4              (NOT(M$FILE$ -> F$DCB.FFLG.UPD))) THEN DO;

     1554     9816    4              CALL VEX$ERROR (E$E_INONLY,3);

   9816  9 002552   000137 630400 10                 EPPR0   95
         9 002553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002554   000000 701000 xent               TSX1    VEX$ERROR
         9 002555   000000 011000                    NOP     0

     1555     9817    4              ALTRETURN;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:225  
   9817  9 002556   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 002557   000000 702211                    TSX2  ! 0,X1

     1556     9818    4              END;
     1557     9819    3        END;

     1558     9820        /**/
     1559     9821        /**/
     1560     9822    3        DO CASE (CMD_CODE);

   9822  9 002560   002625 236000 2                  LDQ     CMD_CODE
         9 002561   000121 116007                    CMPQ    81,DL
         9 002562   002564 602006 9                  TNC     s:9822+4,QL
         9 002563   003055 710000 9                  TRA     s:9900
         9 002564   003055 710000 9                  TRA     s:9900
         9 002565   002762 710000 9                  TRA     s:9856
         9 002566   002724 710000 9                  TRA     s:9835
         9 002567   002724 710000 9                  TRA     s:9835
         9 002570   002724 710000 9                  TRA     s:9835
         9 002571   002724 710000 9                  TRA     s:9835
         9 002572   002751 710000 9                  TRA     s:9848
         9 002573   002716 710000 9                  TRA     s:9831
         9 002574   002743 710000 9                  TRA     s:9844
         9 002575   002705 710000 9                  TRA     s:9825
         9 002576   002705 710000 9                  TRA     s:9825
         9 002577   002705 710000 9                  TRA     s:9825
         9 002600   002705 710000 9                  TRA     s:9825
         9 002601   002746 710000 9                  TRA     s:9846
         9 002602   003026 710000 9                  TRA     s:9883
         9 002603   002705 710000 9                  TRA     s:9825
         9 002604   002754 710000 9                  TRA     s:9850
         9 002605   002757 710000 9                  TRA     s:9852
         9 002606   003055 710000 9                  TRA     s:9900
         9 002607   003055 710000 9                  TRA     s:9900
         9 002610   003012 710000 9                  TRA     s:9873
         9 002611   002705 710000 9                  TRA     s:9825
         9 002612   002721 710000 9                  TRA     s:9833
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:226  
         9 002613   002710 710000 9                  TRA     s:9827
         9 002614   002713 710000 9                  TRA     s:9829
         9 002615   002721 710000 9                  TRA     s:9833
         9 002616   002732 710000 9                  TRA     s:9839
         9 002617   003012 710000 9                  TRA     s:9873
         9 002620   003012 710000 9                  TRA     s:9873
         9 002621   003012 710000 9                  TRA     s:9873
         9 002622   003012 710000 9                  TRA     s:9873
         9 002623   003012 710000 9                  TRA     s:9873
         9 002624   003004 710000 9                  TRA     s:9869
         9 002625   003004 710000 9                  TRA     s:9869
         9 002626   003004 710000 9                  TRA     s:9869
         9 002627   003004 710000 9                  TRA     s:9869
         9 002630   002773 710000 9                  TRA     s:9863
         9 002631   002773 710000 9                  TRA     s:9863
         9 002632   003001 710000 9                  TRA     s:9867
         9 002633   003001 710000 9                  TRA     s:9867
         9 002634   003001 710000 9                  TRA     s:9867
         9 002635   003001 710000 9                  TRA     s:9867
         9 002636   003001 710000 9                  TRA     s:9867
         9 002637   003001 710000 9                  TRA     s:9867
         9 002640   003007 710000 9                  TRA     s:9871
         9 002641   003015 710000 9                  TRA     s:9875
         9 002642   003015 710000 9                  TRA     s:9875
         9 002643   002776 710000 9                  TRA     s:9865
         9 002644   002724 710000 9                  TRA     s:9835
         9 002645   002721 710000 9                  TRA     s:9833
         9 002646   003012 710000 9                  TRA     s:9873
         9 002647   003020 710000 9                  TRA     s:9877
         9 002650   003020 710000 9                  TRA     s:9877
         9 002651   003020 710000 9                  TRA     s:9877
         9 002652   002776 710000 9                  TRA     s:9865
         9 002653   002776 710000 9                  TRA     s:9865
         9 002654   002776 710000 9                  TRA     s:9865
         9 002655   003045 710000 9                  TRA     s:9893
         9 002656   003020 710000 9                  TRA     s:9877
         9 002657   003020 710000 9                  TRA     s:9877
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:227  
         9 002660   003023 710000 9                  TRA     s:9881
         9 002661   003037 710000 9                  TRA     s:9889
         9 002662   003037 710000 9                  TRA     s:9889
         9 002663   003037 710000 9                  TRA     s:9889
         9 002664   003037 710000 9                  TRA     s:9889
         9 002665   003053 710000 9                  TRA     s:9897
         9 002666   003034 710000 9                  TRA     s:9887
         9 002667   003050 710000 9                  TRA     s:9895
         9 002670   003050 710000 9                  TRA     s:9895
         9 002671   003055 710000 9                  TRA     s:9900
         9 002672   002727 710000 9                  TRA     s:9837
         9 002673   003042 710000 9                  TRA     s:9891
         9 002674   003020 710000 9                  TRA     s:9877
         9 002675   003042 710000 9                  TRA     s:9891
         9 002676   003020 710000 9                  TRA     s:9877
         9 002677   003020 710000 9                  TRA     s:9877
         9 002700   003031 710000 9                  TRA     s:9885
         9 002701   003031 710000 9                  TRA     s:9885
         9 002702   003055 710000 9                  TRA     s:9900
         9 002703   002735 710000 9                  TRA     s:9841
         9 002704   002770 710000 9                  TRA     s:9859

     1561     9823        /**/
     1562     9824    3        CASE (BPCMD,CRCMD,RPCMD,TABXCMD,TABCCMD,ROUNDCMD);

     1563     9825    3           CALL CHECK_BP ALTRET(CHECK_CMD_ALT);

   9825  9 002705   003112 701000 9                  TSX1    CHECK_BP
         9 002706   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002707   003055 710000 9                  TRA     s:9900

     1564     9826    3        CASE (BUILDCMD);

     1565     9827    3           CALL CHECK_BUILD ALTRET(CHECK_CMD_ALT);

   9827  9 002710   003161 701000 9                  TSX1    CHECK_BUILD
         9 002711   003110 702000 9                  TSX2    CHECK_CMD_ALT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:228  
         9 002712   003055 710000 9                  TRA     s:9900

     1566     9828    3        CASE (COPYCMD);

     1567     9829    3           CALL CHECK_COPY ALTRET(CHECK_CMD_ALT);

   9829  9 002713   003365 701000 9                  TSX1    CHECK_COPY
         9 002714   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002715   003055 710000 9                  TRA     s:9900

     1568     9830    3        CASE (CRPTCMD);

     1569     9831    3           CALL CHECK_CRPT ALTRET (CHECK_CMD_ALT);

   9831  9 002716   003656 701000 9                  TSX1    CHECK_CRPT
         9 002717   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002720   003055 710000 9                  TRA     s:9900

     1570     9832    3        CASE (EDITCMD,DELETECMD,EXAMINECMD);

     1571     9833    3           CALL CHECK_EDIT ALTRET(CHECK_CMD_ALT);

   9833  9 002721   003725 701000 9                  TSX1    CHECK_EDIT
         9 002722   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002723   003055 710000 9                  TRA     s:9900

     1572     9834    3        CASE (ENDCMD,XCMD,QMCMD,QM2CMD,UPARROWCMD);

     1573     9835    3           CALL CHECK_END ALTRET (CHECK_CMD_ALT);

   9835  9 002724   003755 701000 9                  TSX1    CHECK_END
         9 002725   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002726   003055 710000 9                  TRA     s:9900

     1574     9836    3        CASE (LISTCMD);

     1575     9837    3           CALL CHECK_LIST ALTRET (CHECK_CMD_ALT);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:229  

   9837  9 002727   003770 701000 9                  TSX1    CHECK_LIST
         9 002730   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002731   003055 710000 9                  TRA     s:9900

     1576     9838    3        CASE (MERGECMD) ;

     1577     9839    3           CALL CHECK_MERGE ALTRET(CHECK_CMD_ALT);

   9839  9 002732   004046 701000 9                  TSX1    CHECK_MERGE
         9 002733   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002734   003055 710000 9                  TRA     s:9900

     1578     9840    3        CASE (READCMD);

     1579     9841    3           CALL CHECK_READ ALTRET (CHECK_CMD_ALT);

   9841  9 002735   004240 701000 9                  TSX1    CHECK_READ
         9 002736   003110 702000 9                  TSX2    CHECK_CMD_ALT

     1580     9842    3           CMD$ -> CMD_CNTRLWD.OFFSET = 1 ;

   9842  9 002737   002657 470400 2                  LDP0    CMD$
         9 002740   001000 236007                    LDQ     512,DL
         9 002741   000000 552110                    STBQ    0,'10'O,PR0
         9 002742   003055 710000 9                  TRA     s:9900

     1581     9843    3        CASE (STATUSCMD);

     1582     9844    3           CALL CHECK_STATUS ALTRET (CHECK_CMD_ALT);

   9844  9 002743   004327 701000 9                  TSX1    CHECK_STATUS
         9 002744   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002745   003055 710000 9                  TRA     s:9900

     1583     9845    3        CASE (TACMD);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:230  
     1584     9846    3           CALL CHECK_TA ALTRET(CHECK_CMD_ALT);

   9846  9 002746   004367 701000 9                  TSX1    CHECK_TA
         9 002747   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002750   003055 710000 9                  TRA     s:9900

     1585     9847    3        CASE (TYPECMD);

     1586     9848    3           CALL CHECK_TYPE ALTRET (CHECK_CMD_ALT);

   9848  9 002751   004566 701000 9                  TSX1    CHECK_TYPE
         9 002752   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002753   003055 710000 9                  TRA     s:9900

     1587     9849    3        CASE (VECMD);

     1588     9850    3           CALL CHECK_VE ALTRET(CHECK_CMD_ALT);

   9850  9 002754   004620 701000 9                  TSX1    CHECK_VE
         9 002755   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002756   003055 710000 9                  TRA     s:9900

     1589     9851    3        CASE (DIRCMD);

     1590     9852    3           CALL CHECK_DIR ALTRET(CHECK_CMD_ALT);

   9852  9 002757   010024 701000 9                  TSX1    CHECK_DIR
         9 002760   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002761   003055 710000 9                  TRA     s:9900

     1591     9853        /**/
     1592     9854        /**/
     1593     9855    3        CASE (HELPCMD);

     1594     9856    3           CMD$ -> CMD_CNTRLWD.OFFSET = 1 ;

   9856  9 002762   002657 470400 2                  LDP0    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:231  
         9 002763   001000 236007                    LDQ     512,DL
         9 002764   000000 552110                    STBQ    0,'10'O,PR0

     1595     9857    3           FLAGS.NOCOMPCMD = TRUE;

   9857  9 002765   000010 236003                    LDQ     8,DU
         9 002766   002706 256000 2                  ORSQ    FLAGS
         9 002767   003055 710000 9                  TRA     s:9900

     1596     9858    3        CASE (BLANKLINE) ;

     1597     9859    3           FLAGS.NOCOMPCMD = TRUE ;

   9859  9 002770   000010 236003                    LDQ     8,DU
         9 002771   002706 256000 2                  ORSQ    FLAGS
         9 002772   003055 710000 9                  TRA     s:9900

     1598     9860        /**/
     1599     9861        /**/
     1600     9862    3        CASE (CMCMD,CTCMD);

     1601     9863    3           CALL CHECK_CM ALTRET(CHECK_CMD_ALT);

   9863  9 002773   004676 701000 9                  TSX1    CHECK_CM
         9 002774   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 002775   003055 710000 9                  TRA     s:9900

     1602     9864    3        CASE (DECMD,RRCMD,ADCMD,OLCMD);

     1603     9865    3           CALL CHECK_DE ALTRET(CHECK_CMD_ALT);

   9865  9 002776   004752 701000 9                  TSX1    CHECK_DE
         9 002777   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003000   003055 710000 9                  TRA     s:9900

     1604     9866    3        CASE (INCMD,IPCMD,ISCMD,IACMD,IBCMD,APCMD);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:232  
     1605     9867    3           CALL CHECK_IN ALTRET(CHECK_CMD_ALT);

   9867  9 003001   005144 701000 9                  TSX1    CHECK_IN
         9 003002   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003003   003055 710000 9                  TRA     s:9900

     1606     9868    3        CASE (MKCMD,MDCMD,MKPCMD,MDPCMD);

     1607     9869    3           CALL CHECK_MK ALTRET(CHECK_CMD_ALT);

   9869  9 003004   005525 701000 9                  TSX1    CHECK_MK
         9 003005   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003006   003055 710000 9                  TRA     s:9900

     1608     9870    3        CASE (RNCMD);

     1609     9871    3           CALL CHECK_RN ALTRET(CHECK_CMD_ALT);

   9871  9 003007   005663 701000 9                  TSX1    CHECK_RN
         9 003010   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003011   003055 710000 9                  TRA     s:9900

     1610     9872    3        CASE (SECMD,SSCMD,STCMD,TYCMD,FTCMD,FSCMD,FDCMD);

     1611     9873    3           CALL CHECK_SE ALTRET(CHECK_CMD_ALT);

   9873  9 003012   005745 701000 9                  TSX1    CHECK_SE
         9 003013   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003014   003055 710000 9                  TRA     s:9900

     1612     9874    3        CASE (TNCMD,TPCMD);

     1613     9875    3           CALL CHECK_TN ALTRET(CHECK_CMD_ALT);

   9875  9 003015   006372 701000 9                  TSX1    CHECK_TN
         9 003016   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003017   003055 710000 9                  TRA     s:9900
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:233  

     1614     9876    3        CASE (TSCMD,TCCMD,TXCMD,RFCMD,NOCMD,EICMD,QRCMD,RLCMD);

     1615     9877    3           CALL CHECK_TS ALTRET(CHECK_CMD_ALT);

   9877  9 003020   006433 701000 9                  TSX1    CHECK_TS
         9 003021   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003022   003055 710000 9                  TRA     s:9900

     1616     9878        /**/
     1617     9879        /**/
     1618     9880    3        CASE (ACMD);

     1619     9881    3           CALL CHECK_A ALTRET(CHECK_CMD_ALT);

   9881  9 003023   006566 701000 9                  TSX1    CHECK_A
         9 003024   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003025   003055 710000 9                  TRA     s:9900

     1620     9882    3        CASE (CLCMD);

     1621     9883    3           CALL CHECK_CL ALTRET(CHECK_CMD_ALT);

   9883  9 003026   006650 701000 9                  TSX1    CHECK_CL
         9 003027   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003030   003055 710000 9                  TRA     s:9900

     1622     9884    3        CASE (CPCMD,CICMD);

     1623     9885    3           CALL CHECK_CP ALTRET(CHECK_CMD_ALT);

   9885  9 003031   006716 701000 9                  TSX1    CHECK_CP
         9 003032   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003033   003055 710000 9                  TRA     s:9900

     1624     9886    3        CASE (DCMD);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:234  
     1625     9887    3           CALL CHECK_D ALTRET(CHECK_CMD_ALT);

   9887  9 003034   007133 701000 9                  TSX1    CHECK_D
         9 003035   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003036   003055 710000 9                  TRA     s:9900

     1626     9888    3        CASE (ECMD,OCMD,FCMD,PCMD);

     1627     9889    3           CALL CHECK_E ALTRET(CHECK_CMD_ALT);

   9889  9 003037   007177 701000 9                  TSX1    CHECK_E
         9 003040   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003041   003055 710000 9                  TRA     s:9900

     1628     9890    3        CASE (IFCMD,ELCMD);

     1629     9891    3           CALL CHECK_IF ALTRET(CHECK_CMD_ALT);

   9891  9 003042   007257 701000 9                  TSX1    CHECK_IF
         9 003043   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003044   003055 710000 9                  TRA     s:9900

     1630     9892    3        CASE (JUCMD);

     1631     9893    3           CALL CHECK_JU ALTRET(CHECK_CMD_ALT);

   9893  9 003045   007575 701000 9                  TSX1    CHECK_JU
         9 003046   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003047   003055 710000 9                  TRA     s:9900

     1632     9894    3        CASE (RCMD,LCMD);

     1633     9895    3           CALL CHECK_R ALTRET(CHECK_CMD_ALT);

   9895  9 003050   007650 701000 9                  TSX1    CHECK_R
         9 003051   003110 702000 9                  TSX2    CHECK_CMD_ALT
         9 003052   003055 710000 9                  TRA     s:9900
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:235  

     1634     9896    3        CASE (SCMD);

     1635     9897    3           CALL CHECK_S ALTRET(CHECK_CMD_ALT);

   9897  9 003053   007744 701000 9                  TSX1    CHECK_S
         9 003054   003110 702000 9                  TSX2    CHECK_CMD_ALT

     1636     9898    3        END;

     1637     9899        /**/
     1638     9900    2        CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   9900  9 003055   002657 470400 2                  LDP0    CMD$
         9 003056   000000 236100                    LDQ     0,,PR0
         9 003057   000011 772000                    QRL     9
         9 003060   000777 376007                    ANQ     511,DL
         9 003061   000022 736000                    QLS     18
         9 003062   002657 036000 2                  ADLQ    CMD$
         9 003063   002657 756000 2                  STQ     CMD$

     1639     9901    2        CMD$ -> CMD_CNTRLWD.FLAGS.ENDCT = TRUE;

   9901  9 003064   002657 470400 2                  LDP0    CMD$
         9 003065   400000 236003                    LDQ     -131072,DU
         9 003066   000000 256100                    ORSQ    0,,PR0

     1640     9902    3        IF (POFFW(CMD_END$,CMD$) < 10) THEN DO;

   9902  9 003067   002657 235000 2                  LDA     CMD$
         9 003070   000022 771000                    ARL     18
         9 003071   200414 755100                    STA     IN_SLASH+1,,AUTO
         9 003072   002661 236000 2                  LDQ     CMD_END$
         9 003073   000022 772000                    QRL     18
         9 003074   200414 136100                    SBLQ    IN_SLASH+1,,AUTO
         9 003075   000012 116007                    CMPQ    10,DL
         9 003076   003102 605000 9                  TPL     s:9905
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:236  

     1641     9903    3           CALL VEX$XPAND ALTRET(NO_MEMORY);

   9903  9 003077   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003100   000000 701000 xent               TSX1    VEX$XPAND
         9 003101   003104 702000 9                  TSX2    NO_MEMORY

     1642     9904    3           END;

     1643     9905    2        RETURN;

   9905  9 003102   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 003103   000001 702211                    TSX2  ! 1,X1

     1644     9906        /**/
     1645     9907    2   NO_MEMORY:
     1646     9908    2        CALL VEX$ERROR(E$E_NOSTRMEM,3);

   9908  9 003104   000142 630400 10    NO_MEMORY    EPPR0   98
         9 003105   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003106   000000 701000 xent               TSX1    VEX$ERROR
         9 003107   000000 011000                    NOP     0

     1647     9909    2   CHECK_CMD_ALT:
     1648     9910    2        ALTRETURN;

   9910  9 003110   200406 221300       CHECK_CMD_A* LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 003111   000000 702211                    TSX2  ! 0,X1

     1649     9911    2   END;                                    /* END CHECK_CMD                      */
     1650     9912        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:237  
     1651     9913        /**/
     1652     9914    1   CHECK_BP: PROC ALTRET;

   9914  9 003112   200410 741300       CHECK_BP     STX1  ! STR_FLGS,,AUTO

     1653     9915        /**/
     1654     9916    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_BP_ALT);

   9916  9 003113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003114   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003115   003157 702000 9                  TSX2    CHECK_BP_ALT

     1655     9917        /**/
     1656     9918    3        IF (CMD_CODE = RPCMD)AND(FLAGS.CONSEC_MODE) THEN DO;

   9918  9 003116   002625 235000 2                  LDA     CMD_CODE
         9 003117   000013 115007                    CMPA    11,DL
         9 003120   003132 601000 9                  TNZ     s:9926
         9 003121   002706 236000 2                  LDQ     FLAGS
         9 003122   002000 316003                    CANQ    1024,DU
         9 003123   003132 600000 9                  TZE     s:9926

     1657     9919    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

   9919  9 003124   000145 630400 10                 EPPR0   101
         9 003125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003126   000000 701000 xent               TSX1    VEX$ERROR
         9 003127   000000 011000                    NOP     0

     1658     9920    3           ALTRETURN;

   9920  9 003130   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003131   000000 702211                    TSX2  ! 0,X1

     1659     9921    3           END;
     1660     9922        /**/
     1661     9923        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:238  
     1662     9924                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     1663     9925        /**/
     1664     9926    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> BP_CMD_TBL);

   9926  9 003132   002657 470400 2                  LDP0    CMD$
         9 003133   002000 236007                    LDQ     1024,DL
         9 003134   000000 552110                    STBQ    0,'10'O,PR0

     1665     9927        /**/
     1666     9928    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_ON) THEN

   9928  9 003135   002700 470400 2                  LDP0    BLK$
         9 003136   000004 471500                    LDP1    4,,PR0
         9 003137   100000 720100                    LXL0    0,,PR1
         9 003140   000151 100003                    CMPX0   105,DU
         9 003141   003150 601000 9                  TNZ     s:9930

     1667     9929    2           CMD$ -> BP_CMD_TBL.TEXT = 'ON';

   9929  9 003142   000434 236000 1                  LDQ     NEWLINE_CNTRLWD+6
         9 003143   777777 376003                    ANQ     -1,DU
         9 003144   040040 276007                    ORQ     16416,DL
         9 003145   002657 473400 2                  LDP3    CMD$
         9 003146   300001 756100                    STQ     1,,PR3
         9 003147   003155 710000 9                  TRA     s:9931

     1668     9930    2        ELSE CMD$ -> BP_CMD_TBL.TEXT = 'OFF';

   9930  9 003150   000435 236000 1                  LDQ     NEWLINE_CNTRLWD+7
         9 003151   000147 376000 10                 ANQ     103
         9 003152   000040 276007                    ORQ     32,DL
         9 003153   002657 473400 2                  LDP3    CMD$
         9 003154   300001 756100                    STQ     1,,PR3

     1669     9931    2        RETURN;

   9931  9 003155   200410 221300                    LDX1  ! STR_FLGS,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:239  
         9 003156   000001 702211                    TSX2  ! 1,X1

     1670     9932        /**/
     1671     9933    2   CHECK_BP_ALT:
     1672     9934    2        ALTRETURN;

   9934  9 003157   200410 221300       CHECK_BP_ALT LDX1  ! STR_FLGS,,AUTO
         9 003160   000000 702211                    TSX2  ! 0,X1

     1673     9935    2   END;                                    /* END CHECK_BP                       */
     1674     9936        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:240  
     1675     9937        /**/
     1676     9938    1   CHECK_BUILD: PROC ALTRET;

   9938  9 003161   200410 741300       CHECK_BUILD  STX1  ! STR_FLGS,,AUTO

     1677     9939        /**/
     1678     9940    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_BUILD_ALT);

   9940  9 003162   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003163   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003164   003363 702000 9                  TSX2    CHECK_BUILD_ALT

     1679     9941        /**/
     1680     9942    2        I = BLK$ -> OUT$BLK.NSUBLKS ;

   9942  9 003165   002700 470400 2                  LDP0    BLK$
         9 003166   000001 236100                    LDQ     1,,PR0
         9 003167   000022 772000                    QRL     18
         9 003170   002640 756000 2                  STQ     I

     1681     9943    2        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;

   9943  9 003171   000150 236000 10                 LDQ     104
         9 003172   002731 756000 2                  STQ     P_PCB+1

     1682     9944    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(B_CMD_TBL);

   9944  9 003173   002657 471400 2                  LDP1    CMD$
         9 003174   005000 236007                    LDQ     2560,DL
         9 003175   100000 552110                    STBQ    0,'10'O,PR1

     1683     9945    2        CMD$ -> B_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);

   9945  9 003176   002700 470400 2                  LDP0    BLK$
         9 003177   000004 471500                    LDP1    4,,PR0
         9 003200   100003 236100                    LDQ     3,,PR1
         9 003201   002657 473400 2                  LDP3    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:241  
         9 003202   300001 756100                    STQ     1,,PR3

     1684     9946    2        CMD$ -> B_CMD_TBL.SEQNUM = SEQNUM_ONE; /* DEFAULT                     */

   9946  9 003203   002657 470400 2                  LDP0    CMD$
         9 003204   000425 235000 1                  LDA     SEQNUM_ONE
         9 003205   000002 755100                    STA     2,,PR0

     1685     9947    2        DFLT_INCR = SEQNUM_ONE - Y003;

   9947  9 003206   000425 236000 1                  LDQ     SEQNUM_ONE
         9 003207   000414 136000 1                  SBLQ    Y003
         9 003210   002612 756000 2                  STQ     DFLT_INCR

     1686     9948    2        CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;

   9948  9 003211   002657 470400 2                  LDP0    CMD$
         9 003212   000003 756100                    STQ     3,,PR0

     1687     9949    2        CMD$ -> B_CMD_TBL.TYPE = TYPE_CODE;

   9949  9 003213   002565 220000 2                  LDX0    TYPE_CODE
         9 003214   002657 470400 2                  LDP0    CMD$
         9 003215   000004 740100                    STX0    4,,PR0

     1688     9950        /**/
     1689     9951    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */

   9951  9 003216   000436 236000 1                  LDQ     NEWLINE_CNTRLWD+8
         9 003217   002606 756000 2                  STQ     CP_LIMIT_SEQNUM

     1690     9952        /**/
     1691     9953    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN;

   9953  9 003220   002700 470400 2                  LDP0    BLK$
         9 003221   000001 220100                    LDX0    1,,PR0
         9 003222   000002 100003                    CMPX0   2,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:242  
         9 003223   003226 601000 9                  TNZ     s:9955

   9953  9 003224   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003225   000001 702211                    TSX2  ! 1,X1

     1692     9954        /**/
     1693     9955    2        P$ = BLK$;

   9955  9 003226   002700 236000 2                  LDQ     BLK$
         9 003227   002650 756000 2                  STQ     P$

     1694     9956    2        I = 2;

   9956  9 003230   000002 235007                    LDA     2,DL
         9 003231   002640 755000 2                  STA     I

     1695     9957        /**/
     1696     9958    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);

   9958  9 003232   000005 236100                    LDQ     5,,PR0
         9 003233   002700 756000 2                  STQ     BLK$

     1697     9959    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILETYPE;

   9959  9 003234   002700 470400 2                  LDP0    BLK$
         9 003235   000000 720100                    LXL0    0,,PR0
         9 003236   000200 100003                    CMPX0   128,DU
         9 003237   003330 600000 9                  TZE     FILETYPE

     1698     9960        /**/
     1699     9961    3        IF (BLK$ -> OUT$BLK.CODE = PC_INCR) THEN DO; /* FID,,i CASE           */

   9961  9 003240   000150 100003                    CMPX0   104,DU
         9 003241   003256 601000 9                  TNZ     s:9969

     1700     9962    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:243  
   9962  9 003242   000003 236100                    LDQ     3,,PR0
         9 003243   002700 756000 2                  STQ     BLK$

     1701     9963    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_BUILD_ALT);

   9963  9 003244   000151 630400 10                 EPPR0   105
         9 003245   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003246   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003247   003363 702000 9                  TSX2    CHECK_BUILD_ALT

     1702     9964    3           DFLT_INCR = DFLT_INCR - Y003;

   9964  9 003250   002612 236000 2                  LDQ     DFLT_INCR
         9 003251   000414 136000 1                  SBLQ    Y003
         9 003252   002612 756000 2                  STQ     DFLT_INCR

     1703     9965    3           CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;

   9965  9 003253   002657 470400 2                  LDP0    CMD$
         9 003254   000003 756100                    STQ     3,,PR0

     1704     9966    3           END;

   9966  9 003255   003267 710000 9                  TRA     s:9973

     1705     9967        /**/
     1706     9968    3        ELSE DO;

     1707     9969    3           CALL VEX$BUILD_SEQNUM(CMD$ -> B_CMD_TBL.SEQNUM,BLK$)

   9969  9 003256   000152 236000 10                 LDQ     106
         9 003257   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 003260   002657 236000 2                  LDQ     CMD$
         9 003261   000002 036003                    ADLQ    2,DU
         9 003262   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 003263   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 003264   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:244  
         9 003265   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003266   003363 702000 9                  TSX2    CHECK_BUILD_ALT

     1708     9970    3              ALTRET (CHECK_BUILD_ALT);
     1709     9971    3           END;

     1710     9972        /**/
     1711     9973    2        I = 3;

   9973  9 003267   000003 235007                    LDA     3,DL
         9 003270   002640 755000 2                  STA     I

     1712     9974    2        IF (P$ -> OUT$BLK.NSUBLKS = 3) THEN RETURN;

   9974  9 003271   002650 470400 2                  LDP0    P$
         9 003272   000001 220100                    LDX0    1,,PR0
         9 003273   000003 100003                    CMPX0   3,DU
         9 003274   003277 601000 9                  TNZ     s:9976

   9974  9 003275   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003276   000001 702211                    TSX2  ! 1,X1

     1713     9975        /**/
     1714     9976    2        BLK$ = P$ -> OUT$BLK.SUBLK$(3);

   9976  9 003277   000006 236100                    LDQ     6,,PR0
         9 003300   002700 756000 2                  STQ     BLK$

     1715     9977    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILETYPE;

   9977  9 003301   002700 471400 2                  LDP1    BLK$
         9 003302   100000 720100                    LXL0    0,,PR1
         9 003303   000200 100003                    CMPX0   128,DU
         9 003304   003330 600000 9                  TZE     FILETYPE

     1716     9978        /**/
     1717     9979    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:245  

   9979  9 003305   100003 236100                    LDQ     3,,PR1
         9 003306   002700 756000 2                  STQ     BLK$

     1718     9980    2        CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_BUILD_ALT);

   9980  9 003307   000151 630400 10                 EPPR0   105
         9 003310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003311   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003312   003363 702000 9                  TSX2    CHECK_BUILD_ALT

     1719     9981    2        DFLT_INCR = DFLT_INCR - Y003;

   9981  9 003313   002612 236000 2                  LDQ     DFLT_INCR
         9 003314   000414 136000 1                  SBLQ    Y003
         9 003315   002612 756000 2                  STQ     DFLT_INCR

     1720     9982    2        CMD$ -> B_CMD_TBL.INCR = DFLT_INCR;

   9982  9 003316   002657 470400 2                  LDP0    CMD$
         9 003317   000003 756100                    STQ     3,,PR0

     1721     9983        /**/
     1722     9984    2        I = 4;

   9984  9 003320   000004 235007                    LDA     4,DL
         9 003321   002640 755000 2                  STA     I

     1723     9985    2        IF (P$ -> OUT$BLK.NSUBLKS = 4) THEN RETURN;

   9985  9 003322   002650 470400 2                  LDP0    P$
         9 003323   000001 220100                    LDX0    1,,PR0
         9 003324   000004 100003                    CMPX0   4,DU
         9 003325   003330 601000 9                  TNZ     FILETYPE

   9985  9 003326   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003327   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:246  

     1724     9986        /**/
     1725     9987    2   FILETYPE:
     1726     9988    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);

   9988  9 003330   002650 470400 2     FILETYPE     LDP0    P$
         9 003331   000003 236105                    LDQ     3,AL,PR0
         9 003332   002700 756000 2                  STQ     BLK$

     1727     9989    3        IF (BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT > 2 ) THEN DO;

   9989  9 003333   002700 471400 2                  LDP1    BLK$
         9 003334   100003 473500                    LDP3    3,,PR1
         9 003335   300000 236100                    LDQ     0,,PR3
         9 003336   777000 376003                    ANQ     -512,DU
         9 003337   003000 116003                    CMPQ    1536,DU
         9 003340   003352 602000 9                  TNC     s:10001

     1728     9990    3           CMD$ -> B_CMD_TBL.TYPE = 'SE';

   9990  9 003341   000437 220000 1                  LDX0    NEWLINE_CNTRLWD+9
         9 003342   002657 474400 2                  LDP4    CMD$
         9 003343   400004 740100                    STX0    4,,PR4

     1729     9991    3           CALL VEX$ERROR (E$E_SETYPEUSED,2);

   9991  9 003344   000154 630400 10                 EPPR0   108
         9 003345   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003346   000000 701000 xent               TSX1    VEX$ERROR
         9 003347   000000 011000                    NOP     0

     1730     9992    3           RETURN;

   9992  9 003350   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003351   000001 702211                    TSX2  ! 1,X1

     1731     9993    3           END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:247  
     1732     9994        /**/
     1733     9995        /*E*     ERROR:    VEE-E$E_SETYPEUSED-0
     1734     9996                 MESSAGE:  A file type code of 'SE' has been used by default
     1735     9997                 DESCRIPTION: No file type code was input so 'SE' is to
     1736     9998                           be used by default.
     1737     9999        */
     1738    10000        /**/
     1739    10001    2        CMD$ -> B_CMD_TBL.TYPE = SUBSTR(BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,

  10001  9 003352   300000 236100                    LDQ     0,,PR3
         9 003353   000033 772000                    QRL     27
         9 003354   000000 620006                    EAX0    0,QL
         9 003355   002657 474400 2                  LDP4    CMD$
         9 003356   040100 100540                    MLR     fill='040'O
         9 003357   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         9 003360   400004 000002                    ADSC9   4,,PR4                   cn=0,n=2

     1740    10002    2           0,BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     1741    10003    2        RETURN;

  10003  9 003361   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003362   000001 702211                    TSX2  ! 1,X1

     1742    10004        /**/
     1743    10005    2   CHECK_BUILD_ALT:
     1744    10006    2        ALTRETURN;

  10006  9 003363   200410 221300       CHECK_BUILD* LDX1  ! STR_FLGS,,AUTO
         9 003364   000000 702211                    TSX2  ! 0,X1

     1745    10007    2   END;                                    /* END CHECK_BUILD                    */
     1746    10008        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:248  
     1747    10009        /**/
     1748    10010    1   CHECK_COPY: PROC ALTRET;

  10010  9 003365   200410 741300       CHECK_COPY   STX1  ! STR_FLGS,,AUTO

     1749    10011        /**/
     1750    10012    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_COPY_ALT);

  10012  9 003366   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003367   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003370   003654 702000 9                  TSX2    CHECK_COPY_ALT

     1751    10013        /**/
     1752    10014    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */

  10014  9 003371   000436 235000 1                  LDA     NEWLINE_CNTRLWD+8
         9 003372   002606 755000 2                  STA     CP_LIMIT_SEQNUM

     1753    10015        /**/
     1754    10016    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> C_CMD_TBL);

  10016  9 003373   002657 470400 2                  LDP0    CMD$
         9 003374   007000 236007                    LDQ     3584,DL
         9 003375   000000 552110                    STBQ    0,'10'O,PR0

     1755    10017        /**/
     1756    10018    2        CMD$ -> C_CMD_TBL.SEQNUM = SEQNUM_ONE;

  10018  9 003376   002657 470400 2                  LDP0    CMD$
         9 003377   000425 235000 1                  LDA     SEQNUM_ONE
         9 003400   000004 755100                    STA     4,,PR0

     1757    10019    2        CMD$ -> C_CMD_TBL.INCR = SEQNUM_ONE - Y003;

  10019  9 003401   000425 236000 1                  LDQ     SEQNUM_ONE
         9 003402   000414 136000 1                  SBLQ    Y003
         9 003403   002657 470400 2                  LDP0    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:249  
         9 003404   000005 756100                    STQ     5,,PR0

     1758    10020    2        CMD$ -> C_CMD_TBL.TYPE = '  ';

  10020  9 003405   000430 220000 1                  LDX0    NEWLINE_CNTRLWD+2
         9 003406   002657 470400 2                  LDP0    CMD$
         9 003407   000006 740100                    STX0    6,,PR0

     1759    10021        /**/
     1760    10022    2        CMD$ -> C_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);

  10022  9 003410   002700 470400 2                  LDP0    BLK$
         9 003411   000004 471500                    LDP1    4,,PR0
         9 003412   100003 236100                    LDQ     3,,PR1
         9 003413   002657 473400 2                  LDP3    CMD$
         9 003414   300001 756100                    STQ     1,,PR3

     1761    10023        /**/
     1762    10024    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN DO; /* 'COPY FID' CASE          */

  10024  9 003415   002700 470400 2                  LDP0    BLK$
         9 003416   000001 221100                    LDX1    1,,PR0
         9 003417   000002 101003                    CMPX1   2,DU
         9 003420   003431 601000 9                  TNZ     s:10030

     1763    10025    3           CMD$ -> C_CMD_TBL.FID2$ = CMD$ -> C_CMD_TBL.FID$;

  10025  9 003421   002657 471400 2                  LDP1    CMD$
         9 003422   100001 236100                    LDQ     1,,PR1
         9 003423   100002 756100                    STQ     2,,PR1

     1764    10026    3           CMD$ -> C_CMD_TBL.ONOVER = 'OVER';

  10026  9 003424   000440 236000 1                  LDQ     NEWLINE_CNTRLWD+10
         9 003425   002657 470400 2                  LDP0    CMD$
         9 003426   000003 756100                    STQ     3,,PR0

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:250  
     1765    10027    3           RETURN;

  10027  9 003427   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003430   000001 702211                    TSX2  ! 1,X1

     1766    10028    3           END;
     1767    10029        /**/
     1768    10030    2        P$ = BLK$;

  10030  9 003431   002700 236000 2                  LDQ     BLK$
         9 003432   002650 756000 2                  STQ     P$

     1769    10031    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);

  10031  9 003433   000005 236100                    LDQ     5,,PR0
         9 003434   002700 756000 2                  STQ     BLK$

     1770    10032        /**/
     1771    10033    2        IF (BLK$ -> OUT$BLK.CODE = PC_ON)OR

  10033  9 003435   002700 470400 2                  LDP0    BLK$
         9 003436   000000 721100                    LXL1    0,,PR0
         9 003437   000151 101003                    CMPX1   105,DU
         9 003440   003443 600000 9                  TZE     s:10035
         9 003441   000152 101003                    CMPX1   106,DU
         9 003442   003502 601000 9                  TNZ     s:10048

     1772    10034    3           (BLK$ -> OUT$BLK.CODE = PC_OVER) THEN DO; /* COPY FID ON/OVER CASE  */

     1773    10035    3           IF (BLK$ -> OUT$BLK.CODE = PC_ON) THEN

  10035  9 003443   000151 101003                    CMPX1   105,DU
         9 003444   003453 601000 9                  TNZ     s:10037

     1774    10036    3              CMD$ -> C_CMD_TBL.ONOVER = 'ON';

  10036  9 003445   000434 236000 1                  LDQ     NEWLINE_CNTRLWD+6
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:251  
         9 003446   777777 376003                    ANQ     -1,DU
         9 003447   040040 276007                    ORQ     16416,DL
         9 003450   002657 471400 2                  LDP1    CMD$
         9 003451   100003 756100                    STQ     3,,PR1
         9 003452   003456 710000 9                  TRA     s:10039

     1775    10037    3           ELSE CMD$ -> C_CMD_TBL.ONOVER = 'OVER';

  10037  9 003453   000440 236000 1                  LDQ     NEWLINE_CNTRLWD+10
         9 003454   002657 471400 2                  LDP1    CMD$
         9 003455   100003 756100                    STQ     3,,PR1

     1776    10038        /**/
     1777    10039    3           BLK$ = P$ -> OUT$BLK.SUBLK$(3);

  10039  9 003456   002650 470400 2                  LDP0    P$
         9 003457   000006 236100                    LDQ     6,,PR0
         9 003460   002700 756000 2                  STQ     BLK$

     1778    10040    3           CMD$ -> C_CMD_TBL.FID2$ = BLK$ -> OUT$BLK.SUBLK$(0);

  10040  9 003461   002700 471400 2                  LDP1    BLK$
         9 003462   100003 236100                    LDQ     3,,PR1
         9 003463   002657 473400 2                  LDP3    CMD$
         9 003464   300002 756100                    STQ     2,,PR3

     1779    10041    4           IF (P$ -> OUT$BLK.NSUBLKS = 4) THEN DO; /* SAME SEQ NUMBERS        */

  10041  9 003465   002650 470400 2                  LDP0    P$
         9 003466   000001 221100                    LDX1    1,,PR0
         9 003467   000004 101003                    CMPX1   4,DU
         9 003470   003477 601000 9                  TNZ     s:10045

     1780    10042    4              CMD$ -> C_CMD_TBL.SEQNUM = MAX_SEQNUM + 1;

  10042  9 003471   002657 471400 2                  LDP1    CMD$
         9 003472   000412 236000 1                  LDQ     MAX_SEQNUM
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:252  
         9 003473   000001 036007                    ADLQ    1,DL
         9 003474   100004 756100                    STQ     4,,PR1

     1781    10043    4              RETURN;

  10043  9 003475   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003476   000001 702211                    TSX2  ! 1,X1

     1782    10044    4              END;
     1783    10045    3           I = 4;

  10045  9 003477   000004 236007                    LDQ     4,DL
         9 003500   002640 756000 2                  STQ     I

     1784    10046    3           END;

  10046  9 003501   003512 710000 9                  TRA     s:10053

     1785    10047    3        ELSE DO;

     1786    10048    3           CMD$ -> C_CMD_TBL.FID2$ = CMD$ -> C_CMD_TBL.FID$; /* 'COPY,N,I' CASE */

  10048  9 003502   002657 471400 2                  LDP1    CMD$
         9 003503   100001 236100                    LDQ     1,,PR1
         9 003504   100002 756100                    STQ     2,,PR1

     1787    10049    3           CMD$ -> C_CMD_TBL.ONOVER = 'OVER';

  10049  9 003505   000440 236000 1                  LDQ     NEWLINE_CNTRLWD+10
         9 003506   002657 470400 2                  LDP0    CMD$
         9 003507   000003 756100                    STQ     3,,PR0

     1788    10050    3           I = 2;

  10050  9 003510   000002 235007                    LDA     2,DL
         9 003511   002640 755000 2                  STA     I

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:253  
     1789    10051    3           END;

     1790    10052        /**/
     1791    10053    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);

  10053  9 003512   002650 470400 2                  LDP0    P$
         9 003513   002640 721000 2                  LXL1    I
         9 003514   000003 236111                    LDQ     3,X1,PR0
         9 003515   002700 756000 2                  STQ     BLK$

     1792    10054    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILE_TYPE;

  10054  9 003516   002700 471400 2                  LDP1    BLK$
         9 003517   100000 722100                    LXL2    0,,PR1
         9 003520   000200 102003                    CMPX2   128,DU
         9 003521   003621 600000 9                  TZE     FILE_TYPE

     1793    10055        /**/
     1794    10056    3        IF (BLK$ -> OUT$BLK.CODE = PC_INCR) THEN DO; /* ,,i CASE              */

  10056  9 003522   000150 102003                    CMPX2   104,DU
         9 003523   003543 601000 9                  TNZ     s:10065

     1795    10057    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);

  10057  9 003524   100003 236100                    LDQ     3,,PR1
         9 003525   002700 756000 2                  STQ     BLK$

     1796    10058    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_COPY_ALT);

  10058  9 003526   000151 630400 10                 EPPR0   105
         9 003527   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003530   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003531   003654 702000 9                  TSX2    CHECK_COPY_ALT

     1797    10059    3           DFLT_INCR = DFLT_INCR - Y003;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:254  
  10059  9 003532   002612 236000 2                  LDQ     DFLT_INCR
         9 003533   000414 136000 1                  SBLQ    Y003
         9 003534   002612 756000 2                  STQ     DFLT_INCR

     1798    10060    3           CMD$ -> C_CMD_TBL.INCR = DFLT_INCR;

  10060  9 003535   002657 470400 2                  LDP0    CMD$
         9 003536   000005 756100                    STQ     5,,PR0

     1799    10061    3           I = I+1;

  10061  9 003537   002640 235000 2                  LDA     I
         9 003540   000001 035007                    ADLA    1,DL
         9 003541   002640 755000 2                  STA     I

     1800    10062    3           END;

  10062  9 003542   003557 710000 9                  TRA     s:10070

     1801    10063        /**/
     1802    10064    3        ELSE DO;

     1803    10065    3           CALL VEX$BUILD_SEQNUM (CMD$ -> C_CMD_TBL.SEQNUM,BLK$)

  10065  9 003543   000152 236000 10                 LDQ     106
         9 003544   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 003545   002657 236000 2                  LDQ     CMD$
         9 003546   000004 036003                    ADLQ    4,DU
         9 003547   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 003550   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 003551   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003552   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003553   003654 702000 9                  TSX2    CHECK_COPY_ALT

     1804    10066    3              ALTRET (CHECK_COPY_ALT);
     1805    10067    3           I = I+1;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:255  
  10067  9 003554   002640 235000 2                  LDA     I
         9 003555   000001 035007                    ADLA    1,DL
         9 003556   002640 755000 2                  STA     I

     1806    10068    3           END;

     1807    10069        /**/
     1808    10070    2        IF (P$ -> OUT$BLK.NSUBLKS = I) THEN RETURN;

  10070  9 003557   002650 470400 2                  LDP0    P$
         9 003560   000001 236100                    LDQ     1,,PR0
         9 003561   000022 772000                    QRL     18
         9 003562   002640 116000 2                  CMPQ    I
         9 003563   003566 601000 9                  TNZ     s:10072

  10070  9 003564   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003565   000001 702211                    TSX2  ! 1,X1

     1809    10071        /**/
     1810    10072    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);

  10072  9 003566   000003 236105                    LDQ     3,AL,PR0
         9 003567   002700 756000 2                  STQ     BLK$

     1811    10073    2        IF (BLK$ -> OUT$BLK.CODE = PC_TYPECODE) THEN GOTO FILE_TYPE;

  10073  9 003570   002700 471400 2                  LDP1    BLK$
         9 003571   100000 720100                    LXL0    0,,PR1
         9 003572   000200 100003                    CMPX0   128,DU
         9 003573   003621 600000 9                  TZE     FILE_TYPE

     1812    10074        /**/
     1813    10075    2        I = I+1;

  10075  9 003574   002640 235000 2                  LDA     I
         9 003575   000001 035007                    ADLA    1,DL
         9 003576   002640 755000 2                  STA     I
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:256  

     1814    10076    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(0);  /* ,n,i CASE                        */

  10076  9 003577   100003 236100                    LDQ     3,,PR1
         9 003600   002700 756000 2                  STQ     BLK$

     1815    10077    2        CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$) ALTRET (CHECK_COPY_ALT);

  10077  9 003601   000151 630400 10                 EPPR0   105
         9 003602   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003603   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 003604   003654 702000 9                  TSX2    CHECK_COPY_ALT

     1816    10078    2        DFLT_INCR = DFLT_INCR - Y003;

  10078  9 003605   002612 236000 2                  LDQ     DFLT_INCR
         9 003606   000414 136000 1                  SBLQ    Y003
         9 003607   002612 756000 2                  STQ     DFLT_INCR

     1817    10079    2        CMD$ -> C_CMD_TBL.INCR = DFLT_INCR;

  10079  9 003610   002657 470400 2                  LDP0    CMD$
         9 003611   000005 756100                    STQ     5,,PR0

     1818    10080        /**/
     1819    10081    2        IF (P$ -> OUT$BLK.NSUBLKS = I) THEN RETURN;

  10081  9 003612   002650 470400 2                  LDP0    P$
         9 003613   000001 236100                    LDQ     1,,PR0
         9 003614   000022 772000                    QRL     18
         9 003615   002640 116000 2                  CMPQ    I
         9 003616   003621 601000 9                  TNZ     FILE_TYPE

  10081  9 003617   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003620   000001 702211                    TSX2  ! 1,X1

     1820    10082        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:257  
     1821    10083    2   FILE_TYPE:
     1822    10084    2        BLK$ = P$ -> OUT$BLK.SUBLK$(I);

  10084  9 003621   002640 720000 2     FILE_TYPE    LXL0    I
         9 003622   000003 236110                    LDQ     3,X0,PR0
         9 003623   002700 756000 2                  STQ     BLK$

     1823    10085    3        IF (BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT > 2 ) THEN DO;

  10085  9 003624   002700 471400 2                  LDP1    BLK$
         9 003625   100003 473500                    LDP3    3,,PR1
         9 003626   300000 236100                    LDQ     0,,PR3
         9 003627   777000 376003                    ANQ     -512,DU
         9 003630   003000 116003                    CMPQ    1536,DU
         9 003631   003643 602000 9                  TNC     s:10096

     1824    10086    3           CMD$ -> C_CMD_TBL.TYPE = 'SE';

  10086  9 003632   000437 221000 1                  LDX1    NEWLINE_CNTRLWD+9
         9 003633   002657 474400 2                  LDP4    CMD$
         9 003634   400006 741100                    STX1    6,,PR4

     1825    10087    3           CALL VEX$ERROR (E$E_SETYPEUSED,2);

  10087  9 003635   000154 630400 10                 EPPR0   108
         9 003636   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003637   000000 701000 xent               TSX1    VEX$ERROR
         9 003640   000000 011000                    NOP     0

     1826    10088    3           RETURN;

  10088  9 003641   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003642   000001 702211                    TSX2  ! 1,X1

     1827    10089    3           END;
     1828    10090        /**/
     1829    10091        /*E*     ERROR:    VEE-E$E_SETYPEUSED-0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:258  
     1830    10092                 DESCRIPTION: Illegal type code was input so 'SE' is to
     1831    10093                           be used by default.
     1832    10094        */
     1833    10095        /**/
     1834    10096    2        CMD$ -> C_CMD_TBL.TYPE = SUBSTR(BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,

  10096  9 003643   300000 236100                    LDQ     0,,PR3
         9 003644   000033 772000                    QRL     27
         9 003645   000000 621006                    EAX1    0,QL
         9 003646   002657 474400 2                  LDP4    CMD$
         9 003647   040100 100540                    MLR     fill='040'O
         9 003650   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         9 003651   400006 000002                    ADSC9   6,,PR4                   cn=0,n=2

     1835    10097    2           0,BLK$ -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     1836    10098    2        RETURN;

  10098  9 003652   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003653   000001 702211                    TSX2  ! 1,X1

     1837    10099    2   CHECK_COPY_ALT:
     1838    10100    2        ALTRETURN;

  10100  9 003654   200410 221300       CHECK_COPY_* LDX1  ! STR_FLGS,,AUTO
         9 003655   000000 702211                    TSX2  ! 0,X1

     1839    10101    2   END;                                    /* END CHECK_COPY                     */
     1840    10102        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:259  
     1841    10103        /**/
     1842    10104    1   CHECK_CRPT: PROC ALTRET;

  10104  9 003656   200410 741300       CHECK_CRPT   STX1  ! STR_FLGS,,AUTO

     1843    10105        /**/
     1844    10106    3        IF (BLK$ -> OUT$BLK.NSUBLKS <= 1) THEN DO;

  10106  9 003657   002700 470400 2                  LDP0    BLK$
         9 003660   000001 220100                    LDX0    1,,PR0
         9 003661   000002 100003                    CMPX0   2,DU
         9 003662   003665 603000 9                  TRC     s:10111

     1845    10107    3           SEED = 0;

  10107  9 003663   002643 450000 2                  STZ     SEED

     1846    10108    3           RETURN;

  10108  9 003664   000001 702211                    TSX2  ! 1,X1

     1847    10109    3           END;
     1848    10110        /**/
     1849    10111    2        SEED = 0;

  10111  9 003665   002643 450000 2                  STZ     SEED

     1850    10112    2        TEMP_COUNT = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.NSUBLKS - 1;
             10112                 /* NUMBER OF DIGITS */

  10112  9 003666   000004 471500                    LDP1    4,,PR0
         9 003667   100001 236100                    LDQ     1,,PR1
         9 003670   000022 772000                    QRL     18
         9 003671   000001 136007                    SBLQ    1,DL
         9 003672   002620 756000 2                  STQ     TEMP_COUNT

     1851    10113    2        TEMP_CLMN = 1;                     /* MULTIPLIER                         */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:260  

  10113  9 003673   000001 235007                    LDA     1,DL
         9 003674   002617 755000 2                  STA     TEMP_CLMN

     1852    10114        /**/
     1853    10115    3        DO I = 0 TO TEMP_COUNT;

  10115  9 003675   002640 450000 2                  STZ     I
         9 003676   003720 710000 9                  TRA     s:10119+3

     1854    10116    3           SEED = SEED + (TEMP_CLMN * (( BLK$ -> OUT$BLK.SUBLK$(1) ->

  10116  9 003677   002620 236000 2                  LDQ     TEMP_COUNT
         9 003700   002640 136000 2                  SBLQ    I
         9 003701   002700 470400 2                  LDP0    BLK$
         9 003702   000004 471500                    LDP1    4,,PR0
         9 003703   100003 473506                    LDP3    3,QL,PR1
         9 003704   300000 236100                    LDQ     0,,PR3
         9 003705   777777 376007                    ANQ     -1,DL
         9 003706   000012 136007                    SBLQ    10,DL
         9 003707   002617 402000 2                  MPY     TEMP_CLMN
         9 003710   002643 036000 2                  ADLQ    SEED
         9 003711   002643 756000 2                  STQ     SEED

     1855    10117    3              OUT$BLK.SUBLK$(TEMP_COUNT-I) -> OUT$BLK.CODE) - PC_OCTOFFSET));
     1856    10118    3           TEMP_CLMN = TEMP_CLMN*8;

  10118  9 003712   002617 235000 2                  LDA     TEMP_CLMN
         9 003713   000003 735000                    ALS     3
         9 003714   002617 755000 2                  STA     TEMP_CLMN

     1857    10119    3           END;

  10119  9 003715   002640 235000 2                  LDA     I
         9 003716   000001 035007                    ADLA    1,DL
         9 003717   002640 755000 2                  STA     I
         9 003720   002620 236000 2                  LDQ     TEMP_COUNT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:261  
         9 003721   002640 116000 2                  CMPQ    I
         9 003722   003677 603000 9                  TRC     s:10116

     1858    10120    2        RETURN;

  10120  9 003723   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003724   000001 702211                    TSX2  ! 1,X1

     1859    10121    2   END;
     1860    10122        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:262  
     1861    10123        /**/
     1862    10124    1   CHECK_EDIT: PROC ALTRET;

  10124  9 003725   200410 741300       CHECK_EDIT   STX1  ! STR_FLGS,,AUTO

     1863    10125        /**/
     1864    10126    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_EDIT_ALT);

  10126  9 003726   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003727   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003730   003753 702000 9                  TSX2    CHECK_EDIT_ALT

     1865    10127        /**/
     1866    10128    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */

  10128  9 003731   000436 235000 1                  LDA     NEWLINE_CNTRLWD+8
         9 003732   002606 755000 2                  STA     CP_LIMIT_SEQNUM

     1867    10129        /**/
     1868    10130    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN ALTRETURN ; /* No file named. */

  10130  9 003733   002700 470400 2                  LDP0    BLK$
         9 003734   000001 220100                    LDX0    1,,PR0
         9 003735   000001 100003                    CMPX0   1,DU
         9 003736   003741 601000 9                  TNZ     s:10132

  10130  9 003737   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003740   000000 702211                    TSX2  ! 0,X1

     1869    10131        /**/
     1870    10132    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> ED_CMD_TBL);

  10132  9 003741   002657 471400 2                  LDP1    CMD$
         9 003742   002000 236007                    LDQ     1024,DL
         9 003743   100000 552110                    STBQ    0,'10'O,PR1

     1871    10133    2        CMD$ -> ED_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:263  

  10133  9 003744   002700 470400 2                  LDP0    BLK$
         9 003745   000004 471500                    LDP1    4,,PR0
         9 003746   100003 236100                    LDQ     3,,PR1
         9 003747   002657 473400 2                  LDP3    CMD$
         9 003750   300001 756100                    STQ     1,,PR3

     1872    10134    2        RETURN;

  10134  9 003751   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003752   000001 702211                    TSX2  ! 1,X1

     1873    10135        /**/
     1874    10136    2   CHECK_EDIT_ALT:
     1875    10137    2        ALTRETURN;

  10137  9 003753   200410 221300       CHECK_EDIT_* LDX1  ! STR_FLGS,,AUTO
         9 003754   000000 702211                    TSX2  ! 0,X1

     1876    10138    2   END;                                    /* END CHECK_EDIT                     */
     1877    10139        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:264  
     1878    10140        /**/
     1879    10141    1   CHECK_END: PROC ALTRET;                 /* END,X                              */

  10141  9 003755   200410 741300       CHECK_END    STX1  ! STR_FLGS,,AUTO

     1880    10142        /**/
     1881    10143    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_END_ALT);

  10143  9 003756   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003757   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003760   003766 702000 9                  TSX2    CHECK_END_ALT

     1882    10144        /**/
     1883    10145    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CMD_CNTRLWD);

  10145  9 003761   002657 470400 2                  LDP0    CMD$
         9 003762   001000 236007                    LDQ     512,DL
         9 003763   000000 552110                    STBQ    0,'10'O,PR0

     1884    10146    2        RETURN;

  10146  9 003764   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 003765   000001 702211                    TSX2  ! 1,X1

     1885    10147        /**/
     1886    10148    2   CHECK_END_ALT:
     1887    10149    2        ALTRETURN;

  10149  9 003766   200410 221300       CHECK_END_A* LDX1  ! STR_FLGS,,AUTO
         9 003767   000000 702211                    TSX2  ! 0,X1

     1888    10150    2   END;
     1889    10151        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:265  
     1890    10152        /**/
     1891    10153    1   CHECK_LIST: PROC ALTRET;                /* LIST                               */

  10153  9 003770   200410 741300       CHECK_LIST   STX1  ! STR_FLGS,,AUTO

     1892    10154        /**/
     1893    10155    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_LIST_ALT);

  10155  9 003771   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003772   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 003773   004044 702000 9                  TSX2    CHECK_LIST_ALT

     1894    10156        /**/
     1895    10157    3        IF (CMD_INDEX < CMD_SIZE) THEN DO;

  10157  9 003774   002624 236000 2                  LDQ     CMD_INDEX
         9 003775   002570 116000 2                  CMPQ    CMD_SIZE
         9 003776   004005 603000 9                  TRC     s:10162

     1896    10158    3           CALL VEX$ERROR (E$E_NOTCOMP,3); /* CANT COMPOUND                   */

  10158  9 003777   000134 630400 10                 EPPR0   92
         9 004000   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004001   000000 701000 xent               TSX1    VEX$ERROR
         9 004002   000000 011000                    NOP     0

     1897    10159    3           ALTRETURN;

  10159  9 004003   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004004   000000 702211                    TSX2  ! 0,X1

     1898    10160    3           END;
     1899    10161        /**/
     1900    10162    2        TYPE_BUF.TEXT = P_PCB.TEXT$ -> CMD$BUF; /* TEXTC TO PCL               */

  10162  9 004005   002730 470400 2                  LDP0    P_PCB
         9 004006   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:266  
         9 004007   000000 000400                    ADSC9   0,,PR0                   cn=0,n=256
         9 004010   001450 202104 2                  ADSC9   TYPE_BUF                 cn=1,n=1092

     1901    10163    2        TYPE_BUF.VFC = BINASC(P_PCB.NCHARS);

  10163  9 004011   002741 236000 2                  LDQ     P_PCB+9
         9 004012   000033 736000                    QLS     27
         9 004013   000156 276000 10                 ORQ     110
         9 004014   001450 552040 2                  STBQ    TYPE_BUF,'40'O

     1902    10164        /**/
     1903    10165    2        CALL M$LINK(PCLLINK_FPT) ALTRET (LINK_ERR);

  10165  9 004015   000326 630400 1                  EPPR0   PCLLINK_FPT
         9 004016   400005 713400                    CLIMB   alt,+5
         9 004017   403000 401760                    pmme    nvectors=7
         9 004020   004025 702000 9                  TSX2    LINK_ERR

     1904    10166        /**/
     1905    10167    2        TYPE_BUF.VFC = %VFC_S1A;

  10167  9 004021   101000 236003                    LDQ     33280,DU
         9 004022   001450 552040 2                  STBQ    TYPE_BUF,'40'O

     1906    10168    2        ALTRETURN;                         /* ALWAYS ALTRETURN - LIST ANYTIME    */

  10168  9 004023   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004024   000000 702211                    TSX2  ! 0,X1

     1907    10169        /**/
     1908    10170    2   LINK_ERR:
     1909    10171    2        IF B$JIT$->B$JIT.CPFLAGS1 & %CP_EXIT#

  10171  9 004025   000000 470400 xsym  LINK_ERR     LDP0    B$JIT$
         9 004026   000143 236100                    LDQ     99,,PR0
         9 004027   000441 376000 1                  ANQ     NEWLINE_CNTRLWD+11
         9 004030   004036 600000 9                  TZE     s:10175
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:267  

     1910    10172    2        THEN                               /* LINK target EXITed NORMALLY.  */
     1911    10173    2           CALL VEX$ERROR_NO_PRINT(0,3) ;  /* Just set-up error for '?'.    */

  10173  9 004031   000106 630400 10                 EPPR0   70
         9 004032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004033   000000 701000 xent               TSX1    VEX$ERROR_NO_PRINT
         9 004034   000000 011000                    NOP     0
         9 004035   004042 710000 9                  TRA     s:10176

     1912    10174    2        ELSE                               /* LINK target ALTRETed to EDIT. */
     1913    10175    2           CALL VEX$ERROR (0,3);           /* Put out error message.        */

  10175  9 004036   000106 630400 10                 EPPR0   70
         9 004037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004040   000000 701000 xent               TSX1    VEX$ERROR
         9 004041   000000 011000                    NOP     0

     1914    10176    2        TYPE_BUF.VFC = %VFC_S1A;

  10176  9 004042   101000 236003                    LDQ     33280,DU
         9 004043   001450 552040 2                  STBQ    TYPE_BUF,'40'O

     1915    10177        /**/
     1916    10178    2   CHECK_LIST_ALT:
     1917    10179    2        ALTRETURN;

  10179  9 004044   200410 221300       CHECK_LIST_* LDX1  ! STR_FLGS,,AUTO
         9 004045   000000 702211                    TSX2  ! 0,X1

     1918    10180    2   END;
     1919    10181        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:268  
     1920    10182        /**/
     1921    10183    1   CHECK_MERGE: PROC ALTRET;

  10183  9 004046   200410 741300       CHECK_MERGE  STX1  ! STR_FLGS,,AUTO

     1922    10184        /**/
     1923    10185    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_MERGE_ALT);

  10185  9 004047   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004050   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004051   004236 702000 9                  TSX2    CHECK_MERGE_ALT

     1924    10186        /**/
     1925    10187        /**/
     1926    10188    2        CP_LIMIT_SEQNUM = BITBIN('003777777777'O); /* MUST GIVE FIRST COPY SEQNUM */

  10188  9 004052   000436 235000 1                  LDA     NEWLINE_CNTRLWD+8
         9 004053   002606 755000 2                  STA     CP_LIMIT_SEQNUM

     1927    10189        /**/
     1928    10190    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> M_CMD_TBL);

  10190  9 004054   002657 470400 2                  LDP0    CMD$
         9 004055   011000 236007                    LDQ     4608,DL
         9 004056   000000 552110                    STBQ    0,'10'O,PR0

     1929    10191    2        CMD$ -> M_CMD_TBL.FID$ = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0);

  10191  9 004057   002700 470400 2                  LDP0    BLK$
         9 004060   000004 471500                    LDP1    4,,PR0
         9 004061   100003 236100                    LDQ     3,,PR1
         9 004062   002657 473400 2                  LDP3    CMD$
         9 004063   300001 756100                    STQ     1,,PR3

     1930    10192        /**/
     1931    10193    2        I = 2;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:269  
  10193  9 004064   000002 236007                    LDQ     2,DL
         9 004065   002640 756000 2                  STQ     I

     1932    10194    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);

  10194  9 004066   002700 470400 2                  LDP0    BLK$
         9 004067   000005 236100                    LDQ     5,,PR0
         9 004070   002700 756000 2                  STQ     BLK$

     1933    10195    3       IF (BLK$ -> OUT$BLK.CODE = PC_SEQRANGE) THEN DO; /* 'MERGE FID,X-Y ...' CASE */

  10195  9 004071   002700 470400 2                  LDP0    BLK$
         9 004072   000000 720100                    LXL0    0,,PR0
         9 004073   000174 100003                    CMPX0   124,DU
         9 004074   004114 601000 9                  TNZ     s:10202

     1934    10196    3           CALL VEX$PARSE_SEQRANGE(CMD$ -> M_CMD_TBL.LO_SEQNUM,

  10196  9 004075   000152 236000 10                 LDQ     106
         9 004076   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 004077   002657 236000 2                  LDQ     CMD$
         9 004100   000003 036003                    ADLQ    3,DU
         9 004101   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 004102   002657 236000 2                  LDQ     CMD$
         9 004103   000002 036003                    ADLQ    2,DU
         9 004104   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 004105   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004106   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004107   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 004110   004236 702000 9                  TSX2    CHECK_MERGE_ALT

     1935    10197    3              CMD$ -> M_CMD_TBL.HI_SEQNUM,BLK$)
     1936    10198    3              ALTRET (CHECK_MERGE_ALT);
     1937    10199    3           I = 3;

  10199  9 004111   000003 235007                    LDA     3,DL
         9 004112   002640 755000 2                  STA     I
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:270  

     1938    10200    3           END;

  10200  9 004113   004122 710000 9                  TRA     s:10206

     1939    10201    3        ELSE DO;

     1940    10202    3           CMD$ -> M_CMD_TBL.LO_SEQNUM.KEY = Y003;

  10202  9 004114   002657 471400 2                  LDP1    CMD$
         9 004115   000414 235000 1                  LDA     Y003
         9 004116   100002 755100                    STA     2,,PR1

     1941    10203    3           CMD$ -> M_CMD_TBL.HI_SEQNUM.KEY = MAX_SEQNUM;

  10203  9 004117   002657 470400 2                  LDP0    CMD$
         9 004120   000412 236000 1                  LDQ     MAX_SEQNUM
         9 004121   000003 756100                    STQ     3,,PR0

     1942    10204    3           END;

     1943    10205        /**/
     1944    10206    2        BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(I); /* INTO/ON/OVER */

  10206  9 004122   002733 470400 2                  LDP0    P_PCB+3
         9 004123   002640 720000 2                  LXL0    I
         9 004124   000003 236110                    LDQ     3,X0,PR0
         9 004125   002700 756000 2                  STQ     BLK$

     1945    10207        /**/
     1946    10208    2        IF (BLK$ -> OUT$BLK.CODE = PC_ON) THEN

  10208  9 004126   002700 471400 2                  LDP1    BLK$
         9 004127   100000 721100                    LXL1    0,,PR1
         9 004130   000151 101003                    CMPX1   105,DU
         9 004131   004136 601000 9                  TNZ     s:10210

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:271  
     1947    10209    2           CMD$ -> M_CMD_TBL.ONOVER = %ERROR#;

  10209  9 004132   000001 235007                    LDA     1,DL
         9 004133   002657 473400 2                  LDP3    CMD$
         9 004134   300004 755100                    STA     4,,PR3
         9 004135   004147 710000 9                  TRA     s:10214

     1948    10210    2        ELSE IF (BLK$ -> OUT$BLK.CODE = PC_INTO) THEN

  10210  9 004136   000214 101003                    CMPX1   140,DU
         9 004137   004144 601000 9                  TNZ     s:10212

     1949    10211    2              CMD$ -> M_CMD_TBL.ONOVER = %OLDFILE#;

  10211  9 004140   000002 235007                    LDA     2,DL
         9 004141   002657 473400 2                  LDP3    CMD$
         9 004142   300004 755100                    STA     4,,PR3
         9 004143   004147 710000 9                  TRA     s:10214

     1950    10212    2           ELSE CMD$ -> M_CMD_TBL.ONOVER = %NEWFILE#;

  10212  9 004144   000003 235007                    LDA     3,DL
         9 004145   002657 473400 2                  LDP3    CMD$
         9 004146   300004 755100                    STA     4,,PR3

     1951    10213        /**/
     1952    10214    2        I = I + 1;                         /* Increment to FID2 */

  10214  9 004147   002640 235000 2                  LDA     I
         9 004150   000001 035007                    ADLA    1,DL
         9 004151   002640 755000 2                  STA     I

     1953    10215    2        BLK$ = P_PCB.OUT$;

  10215  9 004152   002733 236000 2                  LDQ     P_PCB+3
         9 004153   002700 756000 2                  STQ     BLK$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:272  
     1954    10216    2        CMD$ -> M_CMD_TBL.FID2$ = BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0);

  10216  9 004154   002700 470400 2                  LDP0    BLK$
         9 004155   000003 471505                    LDP1    3,AL,PR0
         9 004156   100003 236100                    LDQ     3,,PR1
         9 004157   002657 471400 2                  LDP1    CMD$
         9 004160   100005 756100                    STQ     5,,PR1

     1955    10217    2        CALL VEX$PARSE_SEQRANGE(CMD$ -> M_CMD_TBL.LO_SEQNUM2,

  10217  9 004161   002640 236000 2                  LDQ     I
         9 004162   000022 736000                    QLS     18
         9 004163   000004 036003                    ADLQ    4,DU
         9 004164   002700 036000 2                  ADLQ    BLK$
         9 004165   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 004166   002657 236000 2                  LDQ     CMD$
         9 004167   000007 036003                    ADLQ    7,DU
         9 004170   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 004171   002657 236000 2                  LDQ     CMD$
         9 004172   000006 036003                    ADLQ    6,DU
         9 004173   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 004174   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004175   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004176   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 004177   004236 702000 9                  TSX2    CHECK_MERGE_ALT

     1956    10218    2           CMD$ -> M_CMD_TBL.HI_SEQNUM2,BLK$ -> OUT$BLK.SUBLK$(I+1))
     1957    10219    2           ALTRET (CHECK_MERGE_ALT);
     1958    10220    3        IF (BLK$ -> OUT$BLK.NSUBLKS = I+2) THEN DO; /* NO INCR GIVEN          */

  10220  9 004200   002640 235000 2                  LDA     I
         9 004201   000002 035007                    ADLA    2,DL
         9 004202   200414 755100                    STA     IN_SLASH+1,,AUTO
         9 004203   002700 470400 2                  LDP0    BLK$
         9 004204   000001 236100                    LDQ     1,,PR0
         9 004205   000022 772000                    QRL     18
         9 004206   200414 116100                    CMPQ    IN_SLASH+1,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:273  
         9 004207   004215 601000 9                  TNZ     s:10225

     1959    10221    3           CMD$ -> M_CMD_TBL.INCR = DFLT_INCR ;

  10221  9 004210   002657 471400 2                  LDP1    CMD$
         9 004211   002612 235000 2                  LDA     DFLT_INCR
         9 004212   100010 755100                    STA     8,,PR1

     1960    10222    3           RETURN;

  10222  9 004213   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004214   000001 702211                    TSX2  ! 1,X1

     1961    10223    3           END;
     1962    10224        /**/
     1963    10225    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+2); /* POINT TO INCR BLOCK            */

  10225  9 004215   002640 720000 2                  LXL0    I
         9 004216   000005 236110                    LDQ     5,X0,PR0
         9 004217   002700 756000 2                  STQ     BLK$

     1964    10226    2        CALL VEX$BUILD_SEQNUM(EXEC_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(0))

  10226  9 004220   000003 036003                    ADLQ    3,DU
         9 004221   000157 235000 10                 LDA     111
         9 004222   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 004223   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004225   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 004226   004236 702000 9                  TSX2    CHECK_MERGE_ALT

     1965    10227    2           ALTRET(CHECK_MERGE_ALT);
     1966    10228    2        DFLT_INCR = EXEC_SEQNUM - Y003;

  10228  9 004227   002603 236000 2                  LDQ     EXEC_SEQNUM
         9 004230   000414 136000 1                  SBLQ    Y003
         9 004231   002612 756000 2                  STQ     DFLT_INCR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:274  

     1967    10229    2        CMD$ -> M_CMD_TBL.INCR = DFLT_INCR ;

  10229  9 004232   002657 470400 2                  LDP0    CMD$
         9 004233   000010 756100                    STQ     8,,PR0

     1968    10230    2        RETURN;

  10230  9 004234   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004235   000001 702211                    TSX2  ! 1,X1

     1969    10231        /**/
     1970    10232        /**/
     1971    10233    2   CHECK_MERGE_ALT:
     1972    10234    2        ALTRETURN;

  10234  9 004236   200410 221300       CHECK_MERGE* LDX1  ! STR_FLGS,,AUTO
         9 004237   000000 702211                    TSX2  ! 0,X1

     1973    10235    2   END;                                    /* END CHECK_MERGE                    */
     1974    10236        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:275  
     1975    10237        /**/
     1976    10238    1   CHECK_READ: PROC ALTRET;

  10238  9 004240   200410 741300       CHECK_READ   STX1  ! STR_FLGS,,AUTO

     1977    10239        /**/
     1978    10240    2        CALL VEX$CHECK_FIRST ALTRET(CHECK_READ_ALT);

  10240  9 004241   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004242   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004243   004325 702000 9                  TSX2    CHECK_READ_ALT

     1979    10241        /**/
     1980    10242    2        CALL VEX$FID_2_FPT(BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0),

  10242  9 004244   002700 470400 2                  LDP0    BLK$
         9 004245   000004 471500                    LDP1    4,,PR0
         9 004246   000003 236000 10                 LDQ     3
         9 004247   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 004250   000160 236000 10                 LDQ     112
         9 004251   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 004252   100003 633500                    EPPR3   3,,PR1
         9 004253   200414 453500                    STP3    IN_SLASH+1,,AUTO
         9 004254   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004255   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004256   000000 701000 xent               TSX1    VEX$FID_2_FPT
         9 004257   004325 702000 9                  TSX2    CHECK_READ_ALT

     1981    10243    2           OPEN_SIREAD_FPT,1) ALTRET(CHECK_READ_ALT);
     1982    10244        /**/
     1983    10245    2        CALL M$GETDCB(GETDCB_FPT) ALTRET(CHECK_READ_RELDCB_ERR) ;

  10245  9 004260   000402 630400 1                  EPPR0   GETDCB_FPT
         9 004261   460002 713400                    CLIMB   alt,+24578
         9 004262   401000 401760                    pmme    nvectors=3
         9 004263   004323 702000 9                  TSX2    CHECK_READ_RELDCB_ERR

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:276  
     1984    10246    2        OPEN_SIREAD_FPT.V.DCB# = IN_DCBNUM ;

  10246  9 004264   001245 720000 2                  LXL0    IN_DCBNUM
         9 004265   000102 740000 2                  STX0    OPEN_SIREAD_FPT+36

     1985    10247
     1986    10248    2   CHECK_READ_RETRY_OPEN:
     1987    10249    2        CALL M$OPEN(OPEN_SIREAD_FPT) ALTRET(CHECK_READ_ERR);

  10249  9 004266   000036 630400 2     CHECK_READ_* EPPR0   OPEN_SIREAD_FPT
         9 004267   450000 713400                    CLIMB   alt,open
         9 004270   410400 401760                    pmme    nvectors=18
         9 004271   004274 702000 9                  TSX2    CHECK_READ_ERR

     1988    10250    2        RETURN;

  10250  9 004272   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004273   000001 702211                    TSX2  ! 1,X1

     1989    10251        /**/
     1990    10252    2   CHECK_READ_ERR:
     1991    10253    2        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# = %E$DCBOPEN

  10253  9 004274   000000 470400 xsym  CHECK_READ_* LDP0    B$TCB$
         9 004275   000000 471500                    LDP1    0,,PR0
         9 004276   100102 236100                    LDQ     66,,PR1
         9 004277   377770 376007                    ANQ     131064,DL
         9 004300   001440 116007                    CMPQ    800,DL
         9 004301   004311 601000 9                  TNZ     s:10262

     1992    10254    2        THEN
     1993    10255    3        DO ;

     1994    10256    3           CLOSE_SIREAD_FPT.V.DCB# = IN_DCBNUM ;

  10256  9 004302   001245 720000 2                  LXL0    IN_DCBNUM
         9 004303   000162 740000 2                  STX0    CLOSE_SIREAD_FPT+26
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:277  

     1995    10257    3           CALL M$CLOSE(CLOSE_SIREAD_FPT) ALTRET (CHECK_READ_CLOSE_ERR) ;

  10257  9 004304   000130 630400 2                  EPPR0   CLOSE_SIREAD_FPT
         9 004305   450001 713400                    CLIMB   alt,close
         9 004306   406000 401760                    pmme    nvectors=13
         9 004307   004310 702000 9                  TSX2    CHECK_READ_CLOSE_ERR

     1996    10258
     1997    10259    3   CHECK_READ_CLOSE_ERR:
     1998    10260    3           GOTO CHECK_READ_RETRY_OPEN ;

  10260  9 004310   004266 710000 9     CHECK_READ_* TRA     CHECK_READ_RETRY_OPEN

     1999    10261    3           END ;                           /* THEN DO */
     2000    10262    2        CALL VEX$ERROR(0,3);

  10262  9 004311   000106 630400 10                 EPPR0   70
         9 004312   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004313   000000 701000 xent               TSX1    VEX$ERROR
         9 004314   000000 011000                    NOP     0

     2001    10263    2        RELDCB_FPT.V.DCB# = IN_DCBNUM ;

  10263  9 004315   001245 720000 2                  LXL0    IN_DCBNUM
         9 004316   000240 740000 2                  STX0    RELDCB_FPT+2

     2002    10264    2        CALL M$RELDCB(RELDCB_FPT) ALTRET(CHECK_READ_RELDCB_ERR) ;

  10264  9 004317   000236 630400 2                  EPPR0   RELDCB_FPT
         9 004320   460003 713400                    CLIMB   alt,+24579
         9 004321   400000 401760                    pmme    nvectors=1
         9 004322   004323 702000 9                  TSX2    CHECK_READ_RELDCB_ERR

     2003    10265
     2004    10266    2   CHECK_READ_RELDCB_ERR:
     2005    10267    2        IN_DCBNUM = SI_DCBNUM ;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:278  

  10267  9 004323   001247 235000 2     CHECK_READ_* LDA     SI_DCBNUM
         9 004324   001245 755000 2                  STA     IN_DCBNUM

     2006    10268    2   CHECK_READ_ALT:
     2007    10269    2        ALTRETURN;

  10269  9 004325   200410 221300       CHECK_READ_* LDX1  ! STR_FLGS,,AUTO
         9 004326   000000 702211                    TSX2  ! 0,X1

     2008    10270    2   END;
     2009    10271        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:279  
     2010    10272        /**/
     2011    10273    1   CHECK_STATUS: PROC ALTRET;

  10273  9 004327   200410 741300       CHECK_STATUS STX1  ! STR_FLGS,,AUTO

     2012    10274        /**/
     2013    10275    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> TA_CMD_TBL);

  10275  9 004330   002657 470400 2                  LDP0    CMD$
         9 004331   011000 236007                    LDQ     4608,DL
         9 004332   000000 552110                    STBQ    0,'10'O,PR0

     2014    10276        /**/
     2015    10277    3        DO I = 0 TO BLK$ -> OUT$BLK.NSUBLKS-1;

  10277  9 004333   002640 450000 2                  STZ     I
         9 004334   004354 710000 9                  TRA     s:10280+3

     2016    10278    3           CMD$ -> TA_CMD_TBL.TABS(I) = BLK$ -> OUT$BLK.SUBLK$(I) ->

  10278  9 004335   002700 470400 2                  LDP0    BLK$
         9 004336   002640 720000 2                  LXL0    I
         9 004337   000003 471510                    LDP1    3,X0,PR0
         9 004340   100000 236100                    LDQ     0,,PR1
         9 004341   777777 376007                    ANQ     -1,DL
         9 004342   000011 136007                    SBLQ    9,DL
         9 004343   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 004344   002657 471400 2                  LDP1    CMD$
         9 004345   002640 235000 2                  LDA     I
         9 004346   000105 101500                    MRL     fill='000'O
         9 004347   200414 000004                    ADSC9   IN_SLASH+1,,AUTO         cn=0,n=4
         9 004350   100001 000001                    ADSC9   1,A,PR1                  cn=0,n=1

     2017    10279    3              OUT$BLK.CODE - FIRSTSTATUS;
     2018    10280    3           END;

  10280  9 004351   002640 235000 2                  LDA     I
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:280  
         9 004352   000001 035007                    ADLA    1,DL
         9 004353   002640 755000 2                  STA     I
         9 004354   002700 470400 2                  LDP0    BLK$
         9 004355   000001 236100                    LDQ     1,,PR0
         9 004356   000022 772000                    QRL     18
         9 004357   002640 116000 2                  CMPQ    I
         9 004360   004362 600000 9                  TZE     s:10281
         9 004361   004335 603000 9                  TRC     s:10278

     2019    10281    2        CMD$ -> TA_CMD_TBL.NUM_TABS = I;

  10281  9 004362   002657 471400 2                  LDP1    CMD$
         9 004363   002640 236000 2                  LDQ     I
         9 004364   100010 552104                    STBQ    8,'04'O,PR1

     2020    10282    2        RETURN;

  10282  9 004365   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004366   000001 702211                    TSX2  ! 1,X1

     2021    10283    2   END;
     2022    10284        /**/
     2023    10285        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:281  
     2024    10286        /**/
     2025    10287    1   CHECK_TA: PROC ALTRET;

  10287  9 004367   200410 741300       CHECK_TA     STX1  ! STR_FLGS,,AUTO

     2026    10288        /**/
     2027    10289    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TA_ALT);

  10289  9 004370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004371   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004372   004564 702000 9                  TSX2    CHECK_TA_ALT

     2028    10290        /**/
     2029    10291    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> TA_CMD_TBL);

  10291  9 004373   002657 470400 2                  LDP0    CMD$
         9 004374   011000 236007                    LDQ     4608,DL
         9 004375   000000 552110                    STBQ    0,'10'O,PR0

     2030    10292    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);  /* POINT TO OPTION                  */

  10292  9 004376   002700 470400 2                  LDP0    BLK$
         9 004377   000004 236100                    LDQ     4,,PR0
         9 004400   002700 756000 2                  STQ     BLK$

     2031    10293        /**/
     2032    10294    3        DO CASE(BLK$ -> OUT$BLK.CODE);

  10294  9 004401   002700 470400 2                  LDP0    BLK$
         9 004402   000000 720100                    LXL0    0,,PR0
         9 004403   000005 100003                    CMPX0   5,DU
         9 004404   004406 602010 9                  TNC     s:10294+5,X0
         9 004405   004562 710000 9                  TRA     s:10353
         9 004406   004562 710000 9                  TRA     s:10353
         9 004407   004413 710000 9                  TRA     s:10296
         9 004410   004427 710000 9                  TRA     s:10302
         9 004411   004443 710000 9                  TRA     s:10308
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:282  
         9 004412   004457 710000 9                  TRA     s:10314

     2033    10295    3        CASE (PC_FTAB);

     2034    10296    3           CMD$ -> TA_CMD_TBL.TABS(0) = 7;

  10296  9 004413   002657 471400 2                  LDP1    CMD$
         9 004414   007000 236003                    LDQ     3584,DU
         9 004415   100001 552140                    STBQ    1,'40'O,PR1

     2035    10297    3           CMD$ -> TA_CMD_TBL.TABS(1) = 16;

  10297  9 004416   002657 470400 2                  LDP0    CMD$
         9 004417   000020 236003                    LDQ     16,DU
         9 004420   000001 552120                    STBQ    1,'20'O,PR0

     2036    10298    3           CMD$ -> TA_CMD_TBL.TABS(2) = 34;

  10298  9 004421   002657 470400 2                  LDP0    CMD$
         9 004422   042000 236007                    LDQ     17408,DL
         9 004423   000001 552110                    STBQ    1,'10'O,PR0

     2037    10299    3           NUM_TABS = 3;

  10299  9 004424   000003 235007                    LDA     3,DL
         9 004425   002644 755000 2                  STA     NUM_TABS
         9 004426   004562 710000 9                  TRA     s:10353

     2038    10300        /**/
     2039    10301    3        CASE (PC_ATAB);

     2040    10302    3           CMD$ -> TA_CMD_TBL.TABS(0) = 8;

  10302  9 004427   002657 471400 2                  LDP1    CMD$
         9 004430   010000 236003                    LDQ     4096,DU
         9 004431   100001 552140                    STBQ    1,'40'O,PR1

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:283  
     2041    10303    3           CMD$ -> TA_CMD_TBL.TABS(1) = 16;

  10303  9 004432   002657 470400 2                  LDP0    CMD$
         9 004433   000020 236003                    LDQ     16,DU
         9 004434   000001 552120                    STBQ    1,'20'O,PR0

     2042    10304    3           CMD$ -> TA_CMD_TBL.TABS(2) = 32;

  10304  9 004435   002657 470400 2                  LDP0    CMD$
         9 004436   040000 236007                    LDQ     16384,DL
         9 004437   000001 552110                    STBQ    1,'10'O,PR0

     2043    10305    3           NUM_TABS = 3;

  10305  9 004440   000003 235007                    LDA     3,DL
         9 004441   002644 755000 2                  STA     NUM_TABS
         9 004442   004562 710000 9                  TRA     s:10353

     2044    10306        /**/
     2045    10307    3        CASE (PC_CTAB);

     2046    10308    3           CMD$ -> TA_CMD_TBL.TABS(0) = 8;

  10308  9 004443   002657 471400 2                  LDP1    CMD$
         9 004444   010000 236003                    LDQ     4096,DU
         9 004445   100001 552140                    STBQ    1,'40'O,PR1

     2047    10309    3           CMD$ -> TA_CMD_TBL.TABS(1) = 12;

  10309  9 004446   002657 470400 2                  LDP0    CMD$
         9 004447   000014 236003                    LDQ     12,DU
         9 004450   000001 552120                    STBQ    1,'20'O,PR0

     2048    10310    3           CMD$ -> TA_CMD_TBL.TABS(2) = 36;

  10310  9 004451   002657 470400 2                  LDP0    CMD$
         9 004452   044000 236007                    LDQ     18432,DL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:284  
         9 004453   000001 552110                    STBQ    1,'10'O,PR0

     2049    10311    3           NUM_TABS = 3;

  10311  9 004454   000003 235007                    LDA     3,DL
         9 004455   002644 755000 2                  STA     NUM_TABS
         9 004456   004562 710000 9                  TRA     s:10353

     2050    10312        /**/
     2051    10313    3        CASE (PC_TABLIST);

     2052    10314    4           IF (BLK$ -> OUT$BLK.NSUBLKS > 31) THEN DO;

  10314  9 004457   000001 221100                    LDX1    1,,PR0
         9 004460   000040 101003                    CMPX1   32,DU
         9 004461   004470 602000 9                  TNC     s:10324

     2053    10315    4              CALL VEX$ERROR(E$E_BADTAB,2);

  10315  9 004462   000162 630400 10                 EPPR0   114
         9 004463   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004464   000000 701000 xent               TSX1    VEX$ERROR
         9 004465   000000 011000                    NOP     0

     2054    10316    4              ALTRETURN;

  10316  9 004466   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004467   000000 702211                    TSX2  ! 0,X1

     2055    10317    4              END;
     2056    10318        /**/
     2057    10319        /*E*     ERROR:    VEE-E$E_BADTAB-0
     2058    10320                 MESSAGE:  Illegal tab specification
     2059    10321                 MESSAGE1: Either too many or out of order tab stops were requested
     2060    10322                 DESCRIPTION:   ILLEGAL TABS STOPS INPUT           */
     2061    10323        /**/
     2062    10324    4           DO I = 0 TO BLK$ -> OUT$BLK.NSUBLKS-1;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:285  

  10324  9 004470   002640 450000 2                  STZ     I
         9 004471   004553 710000 9                  TRA     s:10349+2

     2063    10325    4              CALL CHARBIN(TEMP_COUNT,SUBSTR(BLK$ -> OUT$BLK.SUBLK$(I)

  10325  9 004472   002700 470400 2                  LDP0    BLK$
         9 004473   002640 720000 2                  LXL0    I
         9 004474   000003 471510                    LDP1    3,X0,PR0
         9 004475   100003 473500                    LDP3    3,,PR1
         9 004476   300000 236100                    LDQ     0,,PR3
         9 004477   000033 772000                    QRL     27
         9 004500   000000 621006                    EAX1    0,QL
         9 004501   000100 305540                    DTB
         9 004502   300000 230011                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         9 004503   200414 000010                    NDSC9   IN_SLASH+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 004504   200415 235100                    LDA     IN_SLASH+2,,AUTO
         9 004505   002620 755000 2                  STA     TEMP_COUNT

     2064    10326    4                 -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2065    10327    4                 BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0)
     2066    10328    4                 -> STR$BUF.COUNT));
     2067    10329        /**/
     2068    10330    4              CMD$ -> TA_CMD_TBL.TABS(I) = TEMP_COUNT;

  10330  9 004506   002657 471400 2                  LDP1    CMD$
         9 004507   002640 236000 2                  LDQ     I
         9 004510   000106 101400                    MRL     fill='000'O
         9 004511   002620 000004 2                  ADSC9   TEMP_COUNT               cn=0,n=4
         9 004512   100001 000001                    ADSC9   1,Q,PR1                  cn=0,n=1

     2069    10331        /**/
     2070    10332    5              IF (I ~= 0) THEN DO;

  10332  9 004513   002640 235000 2                  LDA     I
         9 004514   004532 600000 9                  TZE     s:10339

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:286  
     2071    10333    6                 IF (TEMP_COUNT <= CMD$ -> TA_CMD_TBL.TABS(I-1)) THEN DO;

  10333  9 004515   002657 470400 2                  LDP0    CMD$
         9 004516   000100 101505                    MRL     fill='000'O
         9 004517   000000 600001                    ADSC9   0,A,PR0                  cn=3,n=1
         9 004520   200414 000004                    ADSC9   IN_SLASH+1,,AUTO         cn=0,n=4
         9 004521   200414 236100                    LDQ     IN_SLASH+1,,AUTO
         9 004522   002620 116000 2                  CMPQ    TEMP_COUNT
         9 004523   004551 602000 9                  TNC     s:10349

     2072    10334    6                    CALL VEX$ERROR(E$E_BADTAB,2);

  10334  9 004524   000162 630400 10                 EPPR0   114
         9 004525   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004526   000000 701000 xent               TSX1    VEX$ERROR
         9 004527   000000 011000                    NOP     0

     2073    10335    6                    ALTRETURN;

  10335  9 004530   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004531   000000 702211                    TSX2  ! 0,X1

     2074    10336    6                    END;
     2075    10337    5                 ELSE;
     2076    10338    5                 END;
     2077    10339    5              ELSE IF (TEMP_COUNT = 0) THEN DO;

  10339  9 004532   002620 236000 2                  LDQ     TEMP_COUNT
         9 004533   004551 601000 9                  TNZ     s:10349

     2078    10340    6                    IF (BLK$ -> OUT$BLK.NSUBLKS ~= 1) THEN DO;

  10340  9 004534   002700 470400 2                  LDP0    BLK$
         9 004535   000001 220100                    LDX0    1,,PR0
         9 004536   000001 100003                    CMPX0   1,DU
         9 004537   004546 600000 9                  TZE     s:10345

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:287  
     2079    10341    6                       CALL VEX$ERROR(E$E_BADTAB,2);

  10341  9 004540   000162 630400 10                 EPPR0   114
         9 004541   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004542   000000 701000 xent               TSX1    VEX$ERROR
         9 004543   000000 011000                    NOP     0

     2080    10342    6                       ALTRETURN;

  10342  9 004544   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004545   000000 702211                    TSX2  ! 0,X1

     2081    10343    6                       END;
     2082    10344    6                    ELSE DO;               /* TA 0 - RESET TABS                  */

     2083    10345    6                       NUM_TABS = 0;

  10345  9 004546   002644 450000 2                  STZ     NUM_TABS

     2084    10346    6                       RETURN;

  10346  9 004547   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004550   000001 702211                    TSX2  ! 1,X1

     2085    10347    6                       END;
     2086    10348    5                    END;
     2087    10349    4              END;

  10349  9 004551   000001 035007                    ADLA    1,DL
         9 004552   002640 755000 2                  STA     I
         9 004553   002700 470400 2                  LDP0    BLK$
         9 004554   000001 236100                    LDQ     1,,PR0
         9 004555   000022 772000                    QRL     18
         9 004556   002640 116000 2                  CMPQ    I
         9 004557   004561 600000 9                  TZE     s:10350
         9 004560   004472 603000 9                  TRC     s:10325

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:288  
     2088    10350    3           NUM_TABS = BLK$ -> OUT$BLK.NSUBLKS;

  10350  9 004561   002644 756000 2                  STQ     NUM_TABS

     2089    10351    3        END;

     2090    10352        /**/
     2091    10353    2        RETURN;

  10353  9 004562   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004563   000001 702211                    TSX2  ! 1,X1

     2092    10354        /**/
     2093    10355    2   CHECK_TA_ALT:
     2094    10356    2        ALTRETURN;

  10356  9 004564   200410 221300       CHECK_TA_ALT LDX1  ! STR_FLGS,,AUTO
         9 004565   000000 702211                    TSX2  ! 0,X1

     2095    10357    2   END;
     2096    10358        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:289  
     2097    10359        /**/
     2098    10360    1   CHECK_TYPE: PROC ALTRET;

  10360  9 004566   200410 741300       CHECK_TYPE   STX1  ! STR_FLGS,,AUTO

     2099    10361        /**/
     2100    10362    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(TYPE_CMD_TBL);

  10362  9 004567   002657 470400 2                  LDP0    CMD$
         9 004570   002000 236007                    LDQ     1024,DL
         9 004571   000000 552110                    STBQ    0,'10'O,PR0

     2101    10363        /**/
     2102    10364    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT)

  10364  9 004572   002700 470400 2                  LDP0    BLK$
         9 004573   000004 471500                    LDP1    4,,PR0
         9 004574   100003 473500                    LDP3    3,,PR1
         9 004575   300000 236100                    LDQ     0,,PR3
         9 004576   777000 376003                    ANQ     -512,DU
         9 004577   003000 116003                    CMPQ    1536,DU
         9 004600   004607 602000 9                  TNC     s:10376

     2103    10365    3           > 2 THEN DO;

     2104    10366    3           CALL VEX$ERROR (E$E_BADTYPE,2);

  10366  9 004601   000165 630400 10                 EPPR0   117
         9 004602   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004603   000000 701000 xent               TSX1    VEX$ERROR
         9 004604   000000 011000                    NOP     0

     2105    10367    3           ALTRETURN;

  10367  9 004605   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004606   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:290  
     2106    10368    3           END;
     2107    10369        /**/
     2108    10370        /*E*     ERROR:    VEE-E$E_BADTYPE-0
     2109    10371                 MESSAGE:  File type code is limited to two(2) characters
     2110    10372                 DESCRIPTION: A file type code of more than two characters
     2111    10373                           was input.
     2112    10374        */
     2113    10375        /**/
     2114    10376    2        CMD$ -> TYPE_CMD_TBL.CODE = SUBSTR (BLK$ -> OUT$BLK.SUBLK$(1) ->

  10376  9 004607   300000 236100                    LDQ     0,,PR3
         9 004610   000033 772000                    QRL     27
         9 004611   000000 620006                    EAX0    0,QL
         9 004612   002657 474400 2                  LDP4    CMD$
         9 004613   040100 100540                    MLR     fill='040'O
         9 004614   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         9 004615   400001 000002                    ADSC9   1,,PR4                   cn=0,n=2

     2115    10377    2           OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,BLK$ -> OUT$BLK.SUBLK$(1)
     2116    10378    2           -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT);
     2117    10379    2        RETURN;

  10379  9 004616   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004617   000001 702211                    TSX2  ! 1,X1

     2118    10380    2   END;
     2119    10381        /**/
     2120    10382        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:291  
     2121    10383        /**/
     2122    10384    1   CHECK_VE: PROC ALTRET;

  10384  9 004620   200410 741300       CHECK_VE     STX1  ! STR_FLGS,,AUTO

     2123    10385        /**/
     2124    10386    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_VE_ALT);

  10386  9 004621   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004622   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004623   004645 702000 9                  TSX2    CHECK_VE_ALT

     2125    10387        /**/
     2126    10388    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(VE_CMD_TBL);

  10388  9 004624   002657 470400 2                  LDP0    CMD$
         9 004625   002000 236007                    LDQ     1024,DL
         9 004626   000000 552110                    STBQ    0,'10'O,PR0

     2127    10389        /**/
     2128    10390    2        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_OFF) THEN

  10390  9 004627   002700 470400 2                  LDP0    BLK$
         9 004630   000004 471500                    LDP1    4,,PR0
         9 004631   100000 720100                    LXL0    0,,PR1
         9 004632   000153 100003                    CMPX0   107,DU
         9 004633   004637 601000 9                  TNZ     s:10392

     2129    10391    2           CMD$ -> VE_CMD_TBL.TYPE = 0;

  10391  9 004634   002657 473400 2                  LDP3    CMD$
         9 004635   300001 450100                    STZ     1,,PR3
         9 004636   004643 710000 9                  TRA     s:10394

     2130    10392    2        ELSE CMD$ -> VE_CMD_TBL.TYPE = BLK$ -> OUT$BLK.SUBLK$(1) ->

  10392  9 004637   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:292  
         9 004640   777777 376007                    ANQ     -1,DL
         9 004641   002657 473400 2                  LDP3    CMD$
         9 004642   300001 756100                    STQ     1,,PR3

     2131    10393    2              OUT$BLK.CODE;
     2132    10394    2        RETURN;

  10394  9 004643   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004644   000001 702211                    TSX2  ! 1,X1

     2133    10395        /**/
     2134    10396    2   CHECK_VE_ALT:
     2135    10397    2        ALTRETURN;

  10397  9 004645   200410 221300       CHECK_VE_ALT LDX1  ! STR_FLGS,,AUTO
         9 004646   000000 702211                    TSX2  ! 0,X1

     2136    10398    2   END;
     2137    10399        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:293  
     2138    10400        /**/
     2139    10401    1   CHECK_HELP: PROC ALTRET;

  10401  9 004647   200406 741300       CHECK_HELP   STX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO

     2140    10402        /**/
     2141    10403    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_HELP_ALT);

  10403  9 004650   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004651   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004652   004674 702000 9                  TSX2    CHECK_HELP_ALT

     2142    10404        /**/
     2143    10405    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> HELP_CMD_TBL);

  10405  9 004653   002657 470400 2                  LDP0    CMD$
         9 004654   002000 236007                    LDQ     1024,DL
         9 004655   000000 552110                    STBQ    0,'10'O,PR0

     2144    10406    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN

  10406  9 004656   002700 470400 2                  LDP0    BLK$
         9 004657   000001 220100                    LDX0    1,,PR0
         9 004660   000001 100003                    CMPX0   1,DU
         9 004661   004665 601000 9                  TNZ     s:10408

     2145    10407    2           CMD$ -> HELP_CMD_TBL.CMD_CODE = 0; /* FIRST LEVEL HELP             */

  10407  9 004662   002657 471400 2                  LDP1    CMD$
         9 004663   100001 450100                    STZ     1,,PR1
         9 004664   004672 710000 9                  TRA     s:10410

     2146    10408    2        ELSE CMD$ -> HELP_CMD_TBL.CMD_CODE = BLK$ -> OUT$BLK.SUBLK$(1)

  10408  9 004665   000004 471500                    LDP1    4,,PR0
         9 004666   100000 236100                    LDQ     0,,PR1
         9 004667   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:294  
         9 004670   002657 473400 2                  LDP3    CMD$
         9 004671   300001 756100                    STQ     1,,PR3

     2147    10409    2              -> OUT$BLK.CODE;
     2148    10410    2        RETURN;

  10410  9 004672   200406 221300                    LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 004673   000001 702211                    TSX2  ! 1,X1

     2149    10411        /**/
     2150    10412    2   CHECK_HELP_ALT:
     2151    10413    2        ALTRETURN;

  10413  9 004674   200406 221300       CHECK_HELP_* LDX1  ! CMD_SPACE_EXHAUSTED+2,,AUTO
         9 004675   000000 702211                    TSX2  ! 0,X1

     2152    10414    2   END;                                    /* END CHECK_HELP                     */
     2153    10415        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:295  
     2154    10416        /**/
     2155    10417    1   CHECK_CM: PROC ALTRET;                  /* CM,CT                              */

  10417  9 004676   200410 741300       CHECK_CM     STX1  ! STR_FLGS,,AUTO

     2156    10418        /**/
     2157    10419    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10419  9 004677   002706 236000 2                  LDQ     FLAGS
         9 004700   400000 376003                    ANQ     -131072,DU
         9 004701   400000 676003                    ERQ     -131072,DU
         9 004702   004711 600000 9                  TZE     s:10429

     2158    10420    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10420  9 004703   000170 630400 10                 EPPR0   120
         9 004704   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004705   000000 701000 xent               TSX1    VEX$ERROR
         9 004706   000000 011000                    NOP     0

     2159    10421        /**/
     2160    10422        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2161    10423                 DESCRIPTION: A record oriented command has been received
     2162    10424                           without a file open to edit.
     2163    10425        */
     2164    10426    3           ALTRETURN;

  10426  9 004707   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004710   000000 702211                    TSX2  ! 0,X1

     2165    10427    3           END;
     2166    10428        /**/
     2167    10429    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_CM_ALT);

  10429  9 004711   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004712   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 004713   004750 702000 9                  TSX2    CHECK_CM_ALT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:296  

     2168    10430        /**/
     2169    10431    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CM_CMD_TBL);

  10431  9 004714   002657 470400 2                  LDP0    CMD$
         9 004715   004000 236007                    LDQ     2048,DL
         9 004716   000000 552110                    STBQ    0,'10'O,PR0

     2170    10432        /**/
     2171    10433    2        CALL VEX$BUILD_SEQNUM(CMD$ -> CM_CMD_TBL.SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))

  10433  9 004717   002700 236000 2                  LDQ     BLK$
         9 004720   000004 036003                    ADLQ    4,DU
         9 004721   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 004722   002657 236000 2                  LDQ     CMD$
         9 004723   000001 036003                    ADLQ    1,DU
         9 004724   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 004725   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004726   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004727   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 004730   004750 702000 9                  TSX2    CHECK_CM_ALT

     2172    10434    2           ALTRET (CHECK_CM_ALT);
     2173    10435        /**/
     2174    10436    2        CALL VEX$PARSE_CLMNRANGE (CMD$ -> CM_CMD_TBL.LO_CLMN,

  10436  9 004731   002700 236000 2                  LDQ     BLK$
         9 004732   000005 036003                    ADLQ    5,DU
         9 004733   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 004734   002657 236000 2                  LDQ     CMD$
         9 004735   000003 036003                    ADLQ    3,DU
         9 004736   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 004737   002657 236000 2                  LDQ     CMD$
         9 004740   000002 036003                    ADLQ    2,DU
         9 004741   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 004742   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 004743   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:297  
         9 004744   000000 701000 xent               TSX1    VEX$PARSE_CLMNRANGE
         9 004745   004750 702000 9                  TSX2    CHECK_CM_ALT

     2175    10437    2           CMD$ -> CM_CMD_TBL.HI_CLMN,BLK$ -> OUT$BLK.SUBLK$(2))
     2176    10438    2           ALTRET (CHECK_CM_ALT);
     2177    10439    2        RETURN;

  10439  9 004746   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004747   000001 702211                    TSX2  ! 1,X1

     2178    10440        /**/
     2179    10441    2   CHECK_CM_ALT:
     2180    10442    2        ALTRETURN;

  10442  9 004750   200410 221300       CHECK_CM_ALT LDX1  ! STR_FLGS,,AUTO
         9 004751   000000 702211                    TSX2  ! 0,X1

     2181    10443    2   END;
     2182    10444        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:298  
     2183    10445        /**/
     2184    10446    1   CHECK_DE: PROC ALTRET;                  /* DE,RR,AD                           */

  10446  9 004752   200410 741300       CHECK_DE     STX1  ! STR_FLGS,,AUTO

     2185    10447        /**/
     2186    10448    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10448  9 004753   002706 236000 2                  LDQ     FLAGS
         9 004754   400000 376003                    ANQ     -131072,DU
         9 004755   400000 676003                    ERQ     -131072,DU
         9 004756   004765 600000 9                  TZE     s:10458

     2187    10449    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10449  9 004757   000170 630400 10                 EPPR0   120
         9 004760   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004761   000000 701000 xent               TSX1    VEX$ERROR
         9 004762   000000 011000                    NOP     0

     2188    10450        /**/
     2189    10451        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2190    10452                 DESCRIPTION: A record oriented command has been received
     2191    10453                           without a file open to edit.
     2192    10454        */
     2193    10455    3           ALTRETURN;

  10455  9 004763   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 004764   000000 702211                    TSX2  ! 0,X1

     2194    10456    3           END;
     2195    10457        /**/
     2196    10458    3        IF (CMD_CODE = DECMD)AND(FLAGS.CONSEC_MODE) THEN DO;

  10458  9 004765   002625 235000 2                  LDA     CMD_CODE
         9 004766   000066 115007                    CMPA    54,DL
         9 004767   005001 601000 9                  TNZ     s:10466
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:299  
         9 004770   002706 236000 2                  LDQ     FLAGS
         9 004771   002000 316003                    CANQ    1024,DU
         9 004772   005001 600000 9                  TZE     s:10466

     2197    10459    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  10459  9 004773   000145 630400 10                 EPPR0   101
         9 004774   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004775   000000 701000 xent               TSX1    VEX$ERROR
         9 004776   000000 011000                    NOP     0

     2198    10460    3           ALTRETURN;

  10460  9 004777   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005000   000000 702211                    TSX2  ! 0,X1

     2199    10461    3           END;
     2200    10462        /**/
     2201    10463        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2202    10464                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2203    10465        /**/
     2204    10466    3        IF (CMD_CODE = RRCMD) THEN DO;

  10466  9 005001   000070 115007                    CMPA    56,DL
         9 005002   005020 601000 9                  TNZ     s:10477

     2205    10467    4           IF (B$JIT$ -> B$JIT.MODE = %M_BATCH#) THEN DO;

  10467  9 005003   000000 470400 xsym               LDP0    B$JIT$
         9 005004   000000 236100                    LDQ     0,,PR0
         9 005005   740000 376003                    ANQ     -16384,DU
         9 005006   040000 116003                    CMPQ    16384,DU
         9 005007   005016 601000 9                  TNZ     s:10471

     2206    10468    4              CALL VEX$ERROR(E$E_NOBATCHRR,3);

  10468  9 005010   000173 630400 10                 EPPR0   123
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:300  
         9 005011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005012   000000 701000 xent               TSX1    VEX$ERROR
         9 005013   000000 011000                    NOP     0

     2207    10469    4              ALTRETURN;

  10469  9 005014   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005015   000000 702211                    TSX2  ! 0,X1

     2208    10470    4              END;
     2209    10471    3           LAST_TYPE_CMD = RRCMD;

  10471  9 005016   000070 235007                    LDA     56,DL
         9 005017   002630 755000 2                  STA     LAST_TYPE_CMD

     2210    10472    3           END;

     2211    10473        /**/
     2212    10474        /*E*    ERROR:   VEE-E$E_NOBATCHRR-0
     2213    10475                MESSAGE: The RR command is not allowed in batch.
     2214    10476                DESCRIPTION: CAN'T USE FRONT END EDITTING IN BATCH  */
     2215    10477    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);

  10477  9 005020   002657 470400 2                  LDP0    CMD$
         9 005021   005000 236007                    LDQ     2560,DL
         9 005022   000000 552110                    STBQ    0,'10'O,PR0

     2216    10478        /**/
     2217    10479    2        I = 1;

  10479  9 005023   000001 235007                    LDA     1,DL
         9 005024   002640 755000 2                  STA     I

     2218    10480    2        IF ((BLK$ -> OUT$BLK.NSUBLKS > 1) AND

  10480  9 005025   002700 470400 2                  LDP0    BLK$
         9 005026   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:301  
         9 005027   000002 100003                    CMPX0   2,DU
         9 005030   005071 602000 9                  TNC     s:10501
         9 005031   000004 471500                    LDP1    4,,PR0
         9 005032   100000 721100                    LXL1    0,,PR1
         9 005033   000174 101003                    CMPX1   124,DU
         9 005034   005071 601000 9                  TNZ     s:10501

     2219    10481    2           ( BLK$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = PC_SEQRANGE)) THEN
     2220    10482    3           IF ((FLAGS.STEP_MODE)) THEN DO;

  10482  9 005035   002706 236000 2                  LDQ     FLAGS
         9 005036   100000 316003                    CANQ    32768,DU
         9 005037   005046 600000 9                  TZE     s:10493

     2221    10483    3              CALL VEX$ERROR(E$E_NOSEQRNGE,2);

  10483  9 005040   000176 630400 10                 EPPR0   126
         9 005041   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005042   000000 701000 xent               TSX1    VEX$ERROR
         9 005043   000000 011000                    NOP     0

     2222    10484    3              ALTRETURN;

  10484  9 005044   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005045   000000 702211                    TSX2  ! 0,X1

     2223    10485    3              END;
     2224    10486        /**/
     2225    10487        /*E*     ERROR:    VEE-E$E_NOSEQRNGE-0
     2226    10488                 DESCRIPTION:   A DE,RR,AD command with a sequence number range was
     2227    10489                           input while in step mode.
     2228    10490        */
     2229    10491        /**/
     2230    10492    3           ELSE DO;                        /* Validate SEQRANGE */

     2231    10493    3              CALL VEX$CHECK_FIRST ALTRET (CHECK_DE_ALT);

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:302  
  10493  9 005046   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005047   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 005050   005142 702000 9                  TSX2    CHECK_DE_ALT

     2232    10494        /**/
     2233    10495    3              CALL VEX$PARSE_SEQRANGE(CMD$ -> IN_CMD_TBL.LO_SEQNUM,

  10495  9 005051   002700 236000 2                  LDQ     BLK$
         9 005052   000004 036003                    ADLQ    4,DU
         9 005053   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 005054   002657 236000 2                  LDQ     CMD$
         9 005055   000002 036003                    ADLQ    2,DU
         9 005056   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 005057   002657 236000 2                  LDQ     CMD$
         9 005060   000001 036003                    ADLQ    1,DU
         9 005061   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005062   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005063   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005064   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 005065   005142 702000 9                  TSX2    CHECK_DE_ALT

     2234    10496    3                 CMD$ -> IN_CMD_TBL.HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2235    10497    3                 ALTRET (CHECK_DE_ALT);
     2236    10498    3              I = 2  ;

  10498  9 005066   000002 235007                    LDA     2,DL
         9 005067   002640 755000 2                  STA     I

     2237    10499    3              END;

  10499  9 005070   005073 710000 9                  TRA     s:10504

     2238    10500    2        ELSE
     2239    10501    2           FLAGS.INTRA_CMD = TRUE;

  10501  9 005071   200000 236003                    LDQ     65536,DU
         9 005072   002706 256000 2                  ORSQ    FLAGS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:303  

     2240    10502        /**/
     2241    10503        /*  SEE IF WE HAVE A COLUMN SPECIFIED */
     2242    10504    3        IF (BLK$ -> OUT$BLK.NSUBLKS = I + 1) THEN DO;/* HAVE A COLUMN */

  10504  9 005073   000001 035007                    ADLA    1,DL
         9 005074   200414 755100                    STA     IN_SLASH+1,,AUTO
         9 005075   002700 470400 2                  LDP0    BLK$
         9 005076   000001 236100                    LDQ     1,,PR0
         9 005077   000022 772000                    QRL     18
         9 005100   200414 116100                    CMPQ    IN_SLASH+1,,AUTO
         9 005101   005136 601000 9                  TNZ     s:10514

     2243    10505    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(I) ;

  10505  9 005102   002640 720000 2                  LXL0    I
         9 005103   000003 236110                    LDQ     3,X0,PR0
         9 005104   002700 756000 2                  STQ     BLK$

     2244    10506    3           I = BLK$ -> OUT$BLK.NSUBLKS - 1;

  10506  9 005105   002700 470400 2                  LDP0    BLK$
         9 005106   000001 236100                    LDQ     1,,PR0
         9 005107   000022 772000                    QRL     18
         9 005110   000001 136007                    SBLQ    1,DL
         9 005111   002640 756000 2                  STQ     I

     2245    10507    3           CALL CHARBIN(CMD$ -> IN_CMD_TBL.COLUMN,SUBSTR(

  10507  9 005112   000003 471506                    LDP1    3,QL,PR0
         9 005113   100003 473500                    LDP3    3,,PR1
         9 005114   002640 720000 2                  LXL0    I
         9 005115   000003 471510                    LDP1    3,X0,PR0
         9 005116   100003 474500                    LDP4    3,,PR1
         9 005117   400000 236100                    LDQ     0,,PR4
         9 005120   000033 772000                    QRL     27
         9 005121   002657 475400 2                  LDP5    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:304  
         9 005122   000000 621006                    EAX1    0,QL
         9 005123   000100 305540                    DTB
         9 005124   300000 230011                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         9 005125   500004 000004                    NDSC9   4,,PR5                   cn=0,s=lsgnf,sf=0,n=4

     2246    10508    3              BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2247    10509    3              BLK$ -> OUT$BLK.SUBLK$(I) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT));
     2248    10510    3           IF (I = 1) THEN                 /* NEGATE IT */

  10510  9 005126   002640 235000 2                  LDA     I
         9 005127   000001 115007                    CMPA    1,DL
         9 005130   005140 601000 9                  TNZ     s:10515

     2249    10511    3              CMD$ -> IN_CMD_TBL.COLUMN = -CMD$ -> IN_CMD_TBL.COLUMN ;

  10511  9 005131   002657 470400 2                  LDP0    CMD$
         9 005132   000004 235100                    LDA     4,,PR0
         9 005133   000000 531000                    NEG     0
         9 005134   000004 755100                    STA     4,,PR0

     2250    10512    3           END;                            /* HAVE COLUMN */

  10512  9 005135   005140 710000 9                  TRA     s:10515

     2251    10513    2        ELSE
     2252    10514    2           CMD$ -> IN_CMD_TBL.COLUMN = 0;

  10514  9 005136   002657 471400 2                  LDP1    CMD$
         9 005137   100004 450100                    STZ     4,,PR1

     2253    10515    2        RETURN;

  10515  9 005140   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005141   000001 702211                    TSX2  ! 1,X1

     2254    10516        /**/
     2255    10517    2   CHECK_DE_ALT:
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:305  
     2256    10518    2        ALTRETURN;

  10518  9 005142   200410 221300       CHECK_DE_ALT LDX1  ! STR_FLGS,,AUTO
         9 005143   000000 702211                    TSX2  ! 0,X1

     2257    10519    2   END;
     2258    10520        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:306  
     2259    10521        /**/
     2260    10522    1   CHECK_IN: PROC ALTRET;                  /* IN,IP,IS                           */

  10522  9 005144   200410 741300       CHECK_IN     STX1  ! STR_FLGS,,AUTO

     2261    10523        /**/
     2262    10524    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10524  9 005145   002706 236000 2                  LDQ     FLAGS
         9 005146   400000 376003                    ANQ     -131072,DU
         9 005147   400000 676003                    ERQ     -131072,DU
         9 005150   005157 600000 9                  TZE     s:10534

     2263    10525    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10525  9 005151   000170 630400 10                 EPPR0   120
         9 005152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005153   000000 701000 xent               TSX1    VEX$ERROR
         9 005154   000000 011000                    NOP     0

     2264    10526        /**/
     2265    10527        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2266    10528                 DESCRIPTION: A record oriented command has been received
     2267    10529                           without a file open to edit.
     2268    10530        */
     2269    10531    3           ALTRETURN;

  10531  9 005155   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005156   000000 702211                    TSX2  ! 0,X1

     2270    10532    3           END;
     2271    10533        /**/
     2272    10534    2        IF (CMD_CODE ~= APCMD)AND(CMD_CODE ~= INCMD)AND

  10534  9 005157   002625 235000 2                  LDA     CMD_CODE
         9 005160   000053 115007                    CMPA    43,DL
         9 005161   005177 600000 9                  TZE     s:10543
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:307  
         9 005162   000046 115007                    CMPA    38,DL
         9 005163   005177 600000 9                  TZE     s:10543
         9 005164   000050 115007                    CMPA    40,DL
         9 005165   005177 600000 9                  TZE     s:10543
         9 005166   002706 236000 2                  LDQ     FLAGS
         9 005167   002000 316003                    CANQ    1024,DU
         9 005170   005177 600000 9                  TZE     s:10543

     2273    10535    3           (CMD_CODE ~= ISCMD)AND(FLAGS.CONSEC_MODE) THEN DO;

     2274    10536    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  10536  9 005171   000145 630400 10                 EPPR0   101
         9 005172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005173   000000 701000 xent               TSX1    VEX$ERROR
         9 005174   000000 011000                    NOP     0

     2275    10537    3           ALTRETURN;

  10537  9 005175   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005176   000000 702211                    TSX2  ! 0,X1

     2276    10538    3           END;
     2277    10539        /**/
     2278    10540        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2279    10541                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2280    10542        /**/
     2281    10543    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_IN_ALT);

  10543  9 005177   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005200   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 005201   005523 702000 9                  TSX2    CHECK_IN_ALT

     2282    10544        /**/
     2283    10545    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);

  10545  9 005202   002657 470400 2                  LDP0    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:308  
         9 005203   005000 236007                    LDQ     2560,DL
         9 005204   000000 552110                    STBQ    0,'10'O,PR0

     2284    10546    2        CMD$ -> IN_CMD_TBL.START_SPEC = 0; /* ASSUME NOT HERE */

  10546  9 005205   002657 470400 2                  LDP0    CMD$
         9 005206   000003 450100                    STZ     3,,PR0

     2285    10547        /**/
     2286    10548    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO;

  10548  9 005207   002700 470400 2                  LDP0    BLK$
         9 005210   000001 220100                    LDX0    1,,PR0
         9 005211   000001 100003                    CMPX0   1,DU
         9 005212   005305 601000 9                  TNZ     s:10584

     2287    10549    3           IF (CMD_CODE = IBCMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = LO_SEQNUM;

  10549  9 005213   002625 235000 2                  LDA     CMD_CODE
         9 005214   000052 115007                    CMPA    42,DL
         9 005215   005222 601000 9                  TNZ     s:10550

  10549  9 005216   002657 471400 2                  LDP1    CMD$
         9 005217   002601 235000 2                  LDA     LO_SEQNUM
         9 005220   100001 755100                    STA     1,,PR1
         9 005221   005272 710000 9                  TRA     s:10570

     2288    10550    3           ELSE IF (CMD_CODE = IACMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;

  10550  9 005222   000051 115007                    CMPA    41,DL
         9 005223   005230 601000 9                  TNZ     s:10552

  10550  9 005224   002657 471400 2                  LDP1    CMD$
         9 005225   002602 235000 2                  LDA     HI_SEQNUM
         9 005226   100001 755100                    STA     1,,PR1
         9 005227   005272 710000 9                  TRA     s:10570

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:309  
     2289    10551    4              ELSE DO;

     2290    10552    4                 CALL VEX$READ_RANDOM(HI_SEQNUM) ALTRET (CHECK_IN_ALT);

  10552  9 005230   000200 630400 10                 EPPR0   128
         9 005231   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 005232   000000 701000 xent               TSX1    VEX$READ_RANDOM
         9 005233   005523 702000 9                  TSX2    CHECK_IN_ALT

     2291    10553    4                 IF (FLAGS.EXISTS)

  10553  9 005234   002706 236000 2                  LDQ     FLAGS
         9 005235   020000 316003                    CANQ    8192,DU
         9 005236   005267 600000 9                  TZE     s:10568

     2292    10554    4                 THEN
     2293    10555    5                 DO ;

     2294    10556    5                    CALL VEX$GET_NEXT_KEY ALTRET(CHECK_IN_ALT) ;

  10556  9 005237   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005240   000000 701000 xent               TSX1    VEX$GET_NEXT_KEY
         9 005241   005523 702000 9                  TSX2    CHECK_IN_ALT

     2295    10557    5                    IF CMD_CODE ~= APCMD AND

  10557  9 005242   002625 235000 2                  LDA     CMD_CODE
         9 005243   000053 115007                    CMPA    43,DL
         9 005244   005262 600000 9                  TZE     s:10565
         9 005245   002602 236000 2                  LDQ     HI_SEQNUM
         9 005246   002612 036000 2                  ADLQ    DFLT_INCR
         9 005247   002613 116000 2                  CMPQ    LAST_KEY
         9 005250   005262 602000 9                  TNC     s:10565
         9 005251   002706 236000 2                  LDQ     FLAGS
         9 005252   010000 316003                    CANQ    4096,DU
         9 005253   005262 601000 9                  TNZ     s:10565

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:310  
     2296    10558    5                       LAST_KEY <= HI_SEQNUM + DFLT_INCR AND
     2297    10559    5                       NOT FLAGS.EOF
     2298    10560    5                    THEN
     2299    10561    6                    DO ;

     2300    10562    6                       CALL VEX$ERROR(E$E_NOROOM,3) ;

  10562  9 005254   000202 630400 10                 EPPR0   130
         9 005255   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005256   000000 701000 xent               TSX1    VEX$ERROR
         9 005257   000000 011000                    NOP     0

     2301    10563    6                       ALTRETURN ;

  10563  9 005260   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005261   000000 702211                    TSX2  ! 0,X1

     2302    10564    6                       END ;               /* Then Do */
     2303    10565    5                    CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM +

  10565  9 005262   002602 236000 2                  LDQ     HI_SEQNUM
         9 005263   002612 036000 2                  ADLQ    DFLT_INCR
         9 005264   002657 470400 2                  LDP0    CMD$
         9 005265   000001 756100                    STQ     1,,PR0

     2304    10566    5                       DFLT_INCR ;
     2305    10567    5                    END ;                  /* Then Do */

  10567  9 005266   005272 710000 9                  TRA     s:10570

     2306    10568    4                 ELSE CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;

  10568  9 005267   002657 470400 2                  LDP0    CMD$
         9 005270   002602 235000 2                  LDA     HI_SEQNUM
         9 005271   000001 755100                    STA     1,,PR0

     2307    10569    4                 END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:311  

     2308    10570    3           CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;

  10570  9 005272   002657 470400 2                  LDP0    CMD$
         9 005273   002612 235000 2                  LDA     DFLT_INCR
         9 005274   000002 755100                    STA     2,,PR0

     2309    10571    3           RETURN;

  10571  9 005275   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005276   000001 702211                    TSX2  ! 1,X1

     2310    10572    4           DO WHILE('0'B) ;

     2311    10573    4   CHECK_IN_NOROOM:
     2312    10574    4              CALL VEX$ERROR(E$E_NOROOM,3) ;

  10574  9 005277   000202 630400 10    CHECK_IN_NO* EPPR0   130
         9 005300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005301   000000 701000 xent               TSX1    VEX$ERROR
         9 005302   000000 011000                    NOP     0

     2313    10575    4              ALTRETURN ;

  10575  9 005303   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005304   000000 702211                    TSX2  ! 0,X1

     2314    10576    4              END ;                        /* DO WHILE */

     2315    10577        /**/
     2316    10578        /*E*     ERROR:    VEE-E$E_NOROOM-0
     2317    10579                 DESCRIPTION: THE HOLE TO PUT RECORDS IN HASN'T EVEN ENOUGH
     2318    10580                           ROOM FOR A SINGLE ONE         */
     2319    10581        /**/
     2320    10582    3           END;
     2321    10583        /**/
     2322    10584    3        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_INCR) THEN DO;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:312  

  10584  9 005305   000004 471500                    LDP1    4,,PR0
         9 005306   100000 721100                    LXL1    0,,PR1
         9 005307   000150 101003                    CMPX1   104,DU
         9 005310   005425 601000 9                  TNZ     s:10628

     2323    10585    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(1); /* POINT TO INCR BLOCK       */

  10585  9 005311   000004 236100                    LDQ     4,,PR0
         9 005312   002700 756000 2                  STQ     BLK$

     2324    10586    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))

  10586  9 005313   000003 036003                    ADLQ    3,DU
         9 005314   000151 235000 10                 LDA     105
         9 005315   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 005316   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005317   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005320   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005321   005523 702000 9                  TSX2    CHECK_IN_ALT

     2325    10587    3              ALTRET (CHECK_IN_ALT);
     2326    10588    3           DFLT_INCR = DFLT_INCR - Y003;

  10588  9 005322   002612 236000 2                  LDQ     DFLT_INCR
         9 005323   000414 136000 1                  SBLQ    Y003
         9 005324   002612 756000 2                  STQ     DFLT_INCR

     2327    10589    4           IF (FLAGS.CONSEC_MODE)AND(DFLT_INCR ~= 1000) THEN DO;

  10589  9 005325   002706 236000 2                  LDQ     FLAGS
         9 005326   002000 316003                    CANQ    1024,DU
         9 005327   005341 600000 9                  TZE     s:10600
         9 005330   002612 235000 2                  LDA     DFLT_INCR
         9 005331   001750 115007                    CMPA    1000,DL
         9 005332   005341 600000 9                  TZE     s:10600

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:313  
     2328    10590    4              CALL VEX$ERROR(E$CANONLYINCR1,1);

  10590  9 005333   000205 630400 10                 EPPR0   133
         9 005334   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005335   000000 701000 xent               TSX1    VEX$ERROR
         9 005336   000000 011000                    NOP     0

     2329    10591    4              DFLT_INCR = 1000;

  10591  9 005337   001750 235007                    LDA     1000,DL
         9 005340   002612 755000 2                  STA     DFLT_INCR

     2330    10592    4              END;

     2331    10593        /**/
     2332    10594        /*E*     ERROR:     VEE-E$CANONLYINCR1-0
     2333    10595                 MESSAGE: Non Keyed files can only increment keys by 1, 1 Assumed.
     2334    10596                 DESCRIPTION:  User specified an INCRement other than 1 for a
     2335    10597                               Consecutive file, so I politely change it.
     2336    10598        */
     2337    10599        /**/
     2338    10600    3           IF (CMD_CODE = APCMD) OR (FLAGS.CONSEC_MODE)

  10600  9 005341   002625 235000 2                  LDA     CMD_CODE
         9 005342   000053 115007                    CMPA    43,DL
         9 005343   005347 600000 9                  TZE     s:10603
         9 005344   002706 236000 2                  LDQ     FLAGS
         9 005345   002000 316003                    CANQ    1024,DU
         9 005346   005354 600000 9                  TZE     s:10607

     2339    10601    3           THEN
     2340    10602    4           DO ;

     2341    10603    4              CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR ;

  10603  9 005347   002657 470400 2                  LDP0    CMD$
         9 005350   002612 236000 2                  LDQ     DFLT_INCR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:314  
         9 005351   000002 756100                    STQ     2,,PR0

     2342    10604                                           /* File Positioning done in VER$EXEC_IN */
     2343    10605    4              RETURN ;

  10605  9 005352   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005353   000001 702211                    TSX2  ! 1,X1

     2344    10606    4              END ;                        /* Then Do */
     2345    10607    3           IF (CMD_CODE = IBCMD) THEN CMD$ -> IN_CMD_TBL.LO_SEQNUM = LO_SEQNUM;

  10607  9 005354   000052 115007                    CMPA    42,DL
         9 005355   005362 601000 9                  TNZ     s:10609

  10607  9 005356   002657 470400 2                  LDP0    CMD$
         9 005357   002601 235000 2                  LDA     LO_SEQNUM
         9 005360   000001 755100                    STA     1,,PR0
         9 005361   005420 710000 9                  TRA     s:10623

     2346    10608    4           ELSE DO;

     2347    10609    4              CALL VEX$READ_RANDOM(HI_SEQNUM) ALTRET (CHECK_IN_ALT);

  10609  9 005362   000200 630400 10                 EPPR0   128
         9 005363   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 005364   000000 701000 xent               TSX1    VEX$READ_RANDOM
         9 005365   005523 702000 9                  TSX2    CHECK_IN_ALT

     2348    10610    4              IF (FLAGS.EXISTS) AND (CMD_CODE ~= IACMD)

  10610  9 005366   002706 236000 2                  LDQ     FLAGS
         9 005367   020000 316003                    CANQ    8192,DU
         9 005370   005415 600000 9                  TZE     s:10621
         9 005371   002625 235000 2                  LDA     CMD_CODE
         9 005372   000051 115007                    CMPA    41,DL
         9 005373   005415 600000 9                  TZE     s:10621

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:315  
     2349    10611    4              THEN
     2350    10612    5              DO ;                         /* Is there any room? */

     2351    10613    5                 CALL VEX$READ_SEQUEN ALTRET(CHECK_IN_ALT) ;

  10613  9 005374   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005375   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         9 005376   005523 702000 9                  TSX2    CHECK_IN_ALT

     2352    10614    5                 IF (FLAGS.EOF)

  10614  9 005377   002706 236000 2                  LDQ     FLAGS
         9 005400   010000 316003                    CANQ    4096,DU
         9 005401   005404 600000 9                  TZE     s:10616

     2353    10615    5                 THEN LAST_KEY = MAX_SEQNUM ;

  10615  9 005402   000412 235000 1                  LDA     MAX_SEQNUM
         9 005403   002613 755000 2                  STA     LAST_KEY

     2354    10616    5                 IF LAST_KEY <= HI_SEQNUM + DFLT_INCR

  10616  9 005404   002602 236000 2                  LDQ     HI_SEQNUM
         9 005405   002612 036000 2                  ADLQ    DFLT_INCR
         9 005406   002613 116000 2                  CMPQ    LAST_KEY
         9 005407   005277 603000 9                  TRC     CHECK_IN_NOROOM

     2355    10617    5                 THEN GOTO CHECK_IN_NOROOM ;
     2356    10618    5                 CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM +

  10618  9 005410   002602 236000 2                  LDQ     HI_SEQNUM
         9 005411   002612 036000 2                  ADLQ    DFLT_INCR
         9 005412   002657 470400 2                  LDP0    CMD$
         9 005413   000001 756100                    STQ     1,,PR0

     2357    10619    5                    DFLT_INCR ;
     2358    10620    5                 END ;                     /* THEN DO */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:316  

  10620  9 005414   005420 710000 9                  TRA     s:10623

     2359    10621    4              ELSE CMD$ -> IN_CMD_TBL.LO_SEQNUM = HI_SEQNUM;

  10621  9 005415   002657 470400 2                  LDP0    CMD$
         9 005416   002602 235000 2                  LDA     HI_SEQNUM
         9 005417   000001 755100                    STA     1,,PR0

     2360    10622    4              END;

     2361    10623    3           CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;

  10623  9 005420   002657 470400 2                  LDP0    CMD$
         9 005421   002612 235000 2                  LDA     DFLT_INCR
         9 005422   000002 755100                    STA     2,,PR0

     2362    10624    3           RETURN;

  10624  9 005423   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005424   000001 702211                    TSX2  ! 1,X1

     2363    10625    3           END;
     2364    10626        /**/
     2365    10627        /**/
     2366    10628    2        CMD$ -> IN_CMD_TBL.START_SPEC = 1; /* USER SPECIFIED A START */

  10628  9 005425   000001 235007                    LDA     1,DL
         9 005426   002657 473400 2                  LDP3    CMD$
         9 005427   300003 755100                    STA     3,,PR3

     2367    10629        /**/
     2368    10630    2        CALL VEX$BUILD_SEQNUM(CMD$ -> IN_CMD_TBL.LO_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))

  10630  9 005430   002700 236000 2                  LDQ     BLK$
         9 005431   000004 036003                    ADLQ    4,DU
         9 005432   200415 756100                    STQ     IN_SLASH+2,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:317  
         9 005433   002657 236000 2                  LDQ     CMD$
         9 005434   000001 036003                    ADLQ    1,DU
         9 005435   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005436   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005437   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005440   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005441   005523 702000 9                  TSX2    CHECK_IN_ALT

     2369    10631    2           ALTRET (CHECK_IN_ALT);
     2370    10632        /**/
     2371    10633    2        IF (FLAGS.CONSEC_MODE)AND(M$FILE$->F$DCB.NRECS >=

  10633  9 005442   002706 236000 2                  LDQ     FLAGS
         9 005443   002000 316003                    CANQ    1024,DU
         9 005444   005462 600000 9                  TZE     s:10644
         9 005445   002657 470400 2                  LDP0    CMD$
         9 005446   000001 236100                    LDQ     1,,PR0
         9 005447   000414 136000 1                  SBLQ    Y003
         9 005450   001750 506007                    DIV     1000,DL
         9 005451   002654 471400 2                  LDP1    M$FILE$
         9 005452   100042 116100                    CMPQ    34,,PR1
         9 005453   005462 605400 9                  TPNZ    s:10644

     2372    10634    3           ((CMD$->IN_CMD_TBL.LO_SEQNUM-Y003)/1000)) THEN DO;

     2373    10635    3           CALL VEX$ERROR(E$INNOTALLOWED,1);

  10635  9 005454   000210 630400 10                 EPPR0   136
         9 005455   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005456   000000 701000 xent               TSX1    VEX$ERROR
         9 005457   000000 011000                    NOP     0

     2374    10636    3           ALTRETURN;

  10636  9 005460   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005461   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:318  
     2375    10637    3           END;
     2376    10638        /**/
     2377    10639        /*E*     ERROR:     VEE-E$INNOTALLOWED-0
     2378    10640                 MESSAGE: IN/IS on non keyed file must start past end of file
     2379    10641                 DESCRIPTION:  You can only INsert at the end of the file
     2380    10642        */
     2381    10643        /**/
     2382    10644    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 3) THEN DO;

  10644  9 005462   002700 470400 2                  LDP0    BLK$
         9 005463   000001 220100                    LDX0    1,,PR0
         9 005464   000003 100003                    CMPX0   3,DU
         9 005465   005502 601000 9                  TNZ     s:10650

     2383    10645    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(2); /* POINT TO INCR BLOCK       */

  10645  9 005466   000005 236100                    LDQ     5,,PR0
         9 005467   002700 756000 2                  STQ     BLK$

     2384    10646    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))

  10646  9 005470   000003 036003                    ADLQ    3,DU
         9 005471   000151 235000 10                 LDA     105
         9 005472   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 005473   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005474   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005475   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005476   005523 702000 9                  TSX2    CHECK_IN_ALT

     2385    10647    3              ALTRET (CHECK_IN_ALT);
     2386    10648    3           DFLT_INCR = DFLT_INCR - Y003;

  10648  9 005477   002612 236000 2                  LDQ     DFLT_INCR
         9 005500   000414 136000 1                  SBLQ    Y003
         9 005501   002612 756000 2                  STQ     DFLT_INCR

     2387    10649    3           END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:319  

     2388    10650    3        IF (FLAGS.CONSEC_MODE)AND(DFLT_INCR ~= 1000) THEN DO;

  10650  9 005502   002706 236000 2                  LDQ     FLAGS
         9 005503   002000 316003                    CANQ    1024,DU
         9 005504   005516 600000 9                  TZE     s:10655
         9 005505   002612 235000 2                  LDA     DFLT_INCR
         9 005506   001750 115007                    CMPA    1000,DL
         9 005507   005516 600000 9                  TZE     s:10655

     2389    10651    3           CALL VEX$ERROR(E$CANONLYINCR1,1);

  10651  9 005510   000205 630400 10                 EPPR0   133
         9 005511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005512   000000 701000 xent               TSX1    VEX$ERROR
         9 005513   000000 011000                    NOP     0

     2390    10652    3           DFLT_INCR=1000;

  10652  9 005514   001750 235007                    LDA     1000,DL
         9 005515   002612 755000 2                  STA     DFLT_INCR

     2391    10653    3           END;

     2392    10654        /**/
     2393    10655    2        CMD$ -> IN_CMD_TBL.HI_SEQNUM = DFLT_INCR;

  10655  9 005516   002657 470400 2                  LDP0    CMD$
         9 005517   002612 235000 2                  LDA     DFLT_INCR
         9 005520   000002 755100                    STA     2,,PR0

     2394    10656    2        RETURN;

  10656  9 005521   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005522   000001 702211                    TSX2  ! 1,X1

     2395    10657        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:320  
     2396    10658    2   CHECK_IN_ALT:
     2397    10659    2        ALTRETURN;

  10659  9 005523   200410 221300       CHECK_IN_ALT LDX1  ! STR_FLGS,,AUTO
         9 005524   000000 702211                    TSX2  ! 0,X1

     2398    10660    2   END;
     2399    10661        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:321  
     2400    10662        /**/
     2401    10663    1   CHECK_MK: PROC ALTRET;                  /* MK,MD                              */

  10663  9 005525   200410 741300       CHECK_MK     STX1  ! STR_FLGS,,AUTO

     2402    10664        /**/
     2403    10665    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10665  9 005526   002706 236000 2                  LDQ     FLAGS
         9 005527   400000 376003                    ANQ     -131072,DU
         9 005530   400000 676003                    ERQ     -131072,DU
         9 005531   005540 600000 9                  TZE     s:10675

     2404    10666    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10666  9 005532   000170 630400 10                 EPPR0   120
         9 005533   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005534   000000 701000 xent               TSX1    VEX$ERROR
         9 005535   000000 011000                    NOP     0

     2405    10667        /**/
     2406    10668        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2407    10669                 DESCRIPTION: A record oriented command has been received
     2408    10670                           without a file open to edit.
     2409    10671        */
     2410    10672    3           ALTRETURN;

  10672  9 005536   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005537   000000 702211                    TSX2  ! 0,X1

     2411    10673    3           END;
     2412    10674        /**/
     2413    10675    3        IF (FLAGS.CONSEC_MODE) THEN DO;

  10675  9 005540   002706 236000 2                  LDQ     FLAGS
         9 005541   002000 316003                    CANQ    1024,DU
         9 005542   005551 600000 9                  TZE     s:10683
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:322  

     2414    10676    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  10676  9 005543   000145 630400 10                 EPPR0   101
         9 005544   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005545   000000 701000 xent               TSX1    VEX$ERROR
         9 005546   000000 011000                    NOP     0

     2415    10677    3           ALTRETURN;

  10677  9 005547   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005550   000000 702211                    TSX2  ! 0,X1

     2416    10678    3           END;
     2417    10679        /**/
     2418    10680        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2419    10681                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2420    10682        /**/
     2421    10683    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_MK_ALT);

  10683  9 005551   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005552   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 005553   005661 702000 9                  TSX2    CHECK_MK_ALT

     2422    10684        /**/
     2423    10685    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> MK_CMD_TBL);

  10685  9 005554   002657 470400 2                  LDP0    CMD$
         9 005555   006000 236007                    LDQ     3072,DL
         9 005556   000000 552110                    STBQ    0,'10'O,PR0

     2424    10686        /**/
     2425    10687    2        CALL VEX$PARSE_SEQRANGE (CMD$ -> MK_CMD_TBL.LO_SEQNUM,

  10687  9 005557   002700 236000 2                  LDQ     BLK$
         9 005560   000004 036003                    ADLQ    4,DU
         9 005561   200416 756100                    STQ     IN_SLASH+3,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:323  
         9 005562   002657 236000 2                  LDQ     CMD$
         9 005563   000002 036003                    ADLQ    2,DU
         9 005564   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 005565   002657 236000 2                  LDQ     CMD$
         9 005566   000001 036003                    ADLQ    1,DU
         9 005567   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005570   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005571   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005572   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 005573   005661 702000 9                  TSX2    CHECK_MK_ALT

     2426    10688    2           CMD$ -> MK_CMD_TBL.HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))
     2427    10689    2           ALTRET (CHECK_MK_ALT);
     2428    10690        /**/
     2429    10691    2        CALL VEX$PARSE_SEQRANGE (CMD$ -> MK_CMD_TBL.LO_SEQNUM2,

  10691  9 005574   002700 236000 2                  LDQ     BLK$
         9 005575   000005 036003                    ADLQ    5,DU
         9 005576   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 005577   002657 236000 2                  LDQ     CMD$
         9 005600   000004 036003                    ADLQ    4,DU
         9 005601   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 005602   002657 236000 2                  LDQ     CMD$
         9 005603   000003 036003                    ADLQ    3,DU
         9 005604   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005605   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005606   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005607   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 005610   005661 702000 9                  TSX2    CHECK_MK_ALT

     2430    10692    2           CMD$ -> MK_CMD_TBL.HI_SEQNUM2,BLK$ -> OUT$BLK.SUBLK$(2))
     2431    10693    2           ALTRET (CHECK_MK_ALT);
     2432    10694        /**/
     2433    10695    2        IF (((CMD$ -> MK_CMD_TBL.LO_SEQNUM2 >= CMD$ -> MK_CMD_TBL.LO_SEQNUM)

  10695  9 005611   002657 470400 2                  LDP0    CMD$
         9 005612   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:324  
         9 005613   000001 116100                    CMPQ    1,,PR0
         9 005614   005620 602000 9                  TNC     s:10695+7
         9 005615   000002 116100                    CMPQ    2,,PR0
         9 005616   005626 602000 9                  TNC     s:10700
         9 005617   005626 600000 9                  TZE     s:10700
         9 005620   000004 236100                    LDQ     4,,PR0
         9 005621   000001 116100                    CMPQ    1,,PR0
         9 005622   005634 602000 9                  TNC     s:10711
         9 005623   000002 116100                    CMPQ    2,,PR0
         9 005624   005626 600000 9                  TZE     s:10700
         9 005625   005634 603000 9                  TRC     s:10711

     2434    10696    2           AND(CMD$ -> MK_CMD_TBL.LO_SEQNUM2 <= CMD$ -> MK_CMD_TBL.HI_SEQNUM))
     2435    10697    2           OR((CMD$ -> MK_CMD_TBL.HI_SEQNUM2 >= CMD$ -> MK_CMD_TBL.LO_SEQNUM)
     2436    10698    2           AND(CMD$ -> MK_CMD_TBL.HI_SEQNUM2 <= CMD$ -> MK_CMD_TBL.HI_SEQNUM)))
     2437    10699    3        THEN DO;

     2438    10700    3           CALL VEX$ERROR(E$E_OVERLAP,3);

  10700  9 005626   000213 630400 10                 EPPR0   139
         9 005627   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005630   000000 701000 xent               TSX1    VEX$ERROR
         9 005631   000000 011000                    NOP     0

     2439    10701    3           ALTRETURN;

  10701  9 005632   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005633   000000 702211                    TSX2  ! 0,X1

     2440    10702    3           END;
     2441    10703        /**/
     2442    10704        /*E*     ERROR:    VEE-E$E_OVERLAP-0
     2443    10705                 MESSAGE:  Range overlap
     2444    10706                 MESSAGE1: 'TO' and 'FROM' ranges may not overlap
     2445    10707                 DESCRIPTION:   The TO and FROM ranges for a MK/MD command
     2446    10708                           may not overlap.
     2447    10709        */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:325  
     2448    10710        /**/
     2449    10711    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 4) THEN DO; /* INCR GIVEN               */

  10711  9 005634   002700 471400 2                  LDP1    BLK$
         9 005635   100001 220100                    LDX0    1,,PR1
         9 005636   000004 100003                    CMPX0   4,DU
         9 005637   005654 601000 9                  TNZ     s:10718

     2450    10712    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(3); /* POINT TO INCR BLOCK           */

  10712  9 005640   100006 236100                    LDQ     6,,PR1
         9 005641   002700 756000 2                  STQ     BLK$

     2451    10713    3           CALL VEX$BUILD_SEQNUM(DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))

  10713  9 005642   000003 036003                    ADLQ    3,DU
         9 005643   000151 235000 10                 LDA     105
         9 005644   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 005645   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005646   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005647   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005650   005661 702000 9                  TSX2    CHECK_MK_ALT

     2452    10714    3              ALTRET (CHECK_MK_ALT);
     2453    10715    3           DFLT_INCR = DFLT_INCR - Y003;

  10715  9 005651   002612 236000 2                  LDQ     DFLT_INCR
         9 005652   000414 136000 1                  SBLQ    Y003
         9 005653   002612 756000 2                  STQ     DFLT_INCR

     2454    10716    3           END;

     2455    10717        /**/
     2456    10718    2        CMD$ -> MK_CMD_TBL.INCR = DFLT_INCR;

  10718  9 005654   002657 470400 2                  LDP0    CMD$
         9 005655   002612 235000 2                  LDA     DFLT_INCR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:326  
         9 005656   000005 755100                    STA     5,,PR0

     2457    10719    2        RETURN;

  10719  9 005657   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005660   000001 702211                    TSX2  ! 1,X1

     2458    10720        /**/
     2459    10721    2   CHECK_MK_ALT:
     2460    10722    2        ALTRETURN;

  10722  9 005661   200410 221300       CHECK_MK_ALT LDX1  ! STR_FLGS,,AUTO
         9 005662   000000 702211                    TSX2  ! 0,X1

     2461    10723    2   END;
     2462    10724        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:327  
     2463    10725        /**/
     2464    10726    1   CHECK_RN: PROC ALTRET;                  /* RN                                 */

  10726  9 005663   200410 741300       CHECK_RN     STX1  ! STR_FLGS,,AUTO

     2465    10727        /**/
     2466    10728    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10728  9 005664   002706 236000 2                  LDQ     FLAGS
         9 005665   400000 376003                    ANQ     -131072,DU
         9 005666   400000 676003                    ERQ     -131072,DU
         9 005667   005676 600000 9                  TZE     s:10738

     2467    10729    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10729  9 005670   000170 630400 10                 EPPR0   120
         9 005671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005672   000000 701000 xent               TSX1    VEX$ERROR
         9 005673   000000 011000                    NOP     0

     2468    10730        /**/
     2469    10731        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2470    10732                 DESCRIPTION: A record oriented command has been received
     2471    10733                           without a file open to edit.
     2472    10734        */
     2473    10735    3           ALTRETURN;

  10735  9 005674   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005675   000000 702211                    TSX2  ! 0,X1

     2474    10736    3           END;
     2475    10737        /**/
     2476    10738    3        IF (FLAGS.CONSEC_MODE) THEN DO;

  10738  9 005676   002706 236000 2                  LDQ     FLAGS
         9 005677   002000 316003                    CANQ    1024,DU
         9 005700   005707 600000 9                  TZE     s:10746
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:328  

     2477    10739    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  10739  9 005701   000145 630400 10                 EPPR0   101
         9 005702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005703   000000 701000 xent               TSX1    VEX$ERROR
         9 005704   000000 011000                    NOP     0

     2478    10740    3           ALTRETURN;

  10740  9 005705   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005706   000000 702211                    TSX2  ! 0,X1

     2479    10741    3           END;
     2480    10742        /**/
     2481    10743        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2482    10744                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2483    10745        /**/
     2484    10746    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_RN_ALT);

  10746  9 005707   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005710   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 005711   005743 702000 9                  TSX2    CHECK_RN_ALT

     2485    10747        /**/
     2486    10748    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> IN_CMD_TBL);

  10748  9 005712   002657 470400 2                  LDP0    CMD$
         9 005713   005000 236007                    LDQ     2560,DL
         9 005714   000000 552110                    STBQ    0,'10'O,PR0

     2487    10749        /**/
     2488    10750    2        CALL VEX$BUILD_SEQNUM (CMD$ -> IN_CMD_TBL.LO_SEQNUM,

  10750  9 005715   002700 236000 2                  LDQ     BLK$
         9 005716   000004 036003                    ADLQ    4,DU
         9 005717   200415 756100                    STQ     IN_SLASH+2,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:329  
         9 005720   002657 236000 2                  LDQ     CMD$
         9 005721   000001 036003                    ADLQ    1,DU
         9 005722   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005723   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005724   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005725   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005726   005743 702000 9                  TSX2    CHECK_RN_ALT

     2489    10751    2           BLK$ -> OUT$BLK.SUBLK$(1)) ALTRET (CHECK_RN_ALT);
     2490    10752        /**/
     2491    10753    2        CALL VEX$BUILD_SEQNUM (CMD$ -> IN_CMD_TBL.HI_SEQNUM,

  10753  9 005727   002700 236000 2                  LDQ     BLK$
         9 005730   000005 036003                    ADLQ    5,DU
         9 005731   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 005732   002657 236000 2                  LDQ     CMD$
         9 005733   000002 036003                    ADLQ    2,DU
         9 005734   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 005735   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 005736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005737   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 005740   005743 702000 9                  TSX2    CHECK_RN_ALT

     2492    10754    2           BLK$ -> OUT$BLK.SUBLK$(2)) ALTRET (CHECK_RN_ALT);
     2493    10755    2        RETURN;

  10755  9 005741   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005742   000001 702211                    TSX2  ! 1,X1

     2494    10756        /**/
     2495    10757    2   CHECK_RN_ALT:
     2496    10758    2        ALTRETURN;

  10758  9 005743   200410 221300       CHECK_RN_ALT LDX1  ! STR_FLGS,,AUTO
         9 005744   000000 702211                    TSX2  ! 0,X1

     2497    10759    2   END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:330  
     2498    10760        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:331  
     2499    10761        /**/
     2500    10762    1   CHECK_SE: PROC ALTRET;                  /* SE,SS,ST,FT,FS,FD,TY               */

  10762  9 005745   200410 741300       CHECK_SE     STX1  ! STR_FLGS,,AUTO

     2501    10763        /**/
     2502    10764    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10764  9 005746   002706 236000 2                  LDQ     FLAGS
         9 005747   400000 376003                    ANQ     -131072,DU
         9 005750   400000 676003                    ERQ     -131072,DU
         9 005751   005760 600000 9                  TZE     s:10777

     2503    10765    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10765  9 005752   000170 630400 10                 EPPR0   120
         9 005753   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005754   000000 701000 xent               TSX1    VEX$ERROR
         9 005755   000000 011000                    NOP     0

     2504    10766    3           ALTRETURN;

  10766  9 005756   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005757   000000 702211                    TSX2  ! 0,X1

     2505    10767    3           END;
     2506    10768        /**/
     2507    10769        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2508    10770                 MESSAGE:  No file named
     2509    10771                 MESSAGE1: An intra-record or inter-record command has been
     2510    10772                           issued without a file open for editting
     2511    10773                 DESCRIPTION: A record oriented command was received
     2512    10774                           without a file open.
     2513    10775        */
     2514    10776        /**/
     2515    10777    3        IF (CMD_CODE = FDCMD)AND(FLAGS.CONSEC_MODE) THEN DO;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:332  
  10777  9 005760   002625 235000 2                  LDA     CMD_CODE
         9 005761   000037 115007                    CMPA    31,DL
         9 005762   005774 601000 9                  TNZ     s:10788
         9 005763   002706 236000 2                  LDQ     FLAGS
         9 005764   002000 316003                    CANQ    1024,DU
         9 005765   005774 600000 9                  TZE     s:10788

     2516    10778    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  10778  9 005766   000145 630400 10                 EPPR0   101
         9 005767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005770   000000 701000 xent               TSX1    VEX$ERROR
         9 005771   000000 011000                    NOP     0

     2517    10779    3           ALTRETURN;

  10779  9 005772   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 005773   000000 702211                    TSX2  ! 0,X1

     2518    10780    3           END;
     2519    10781        /**/
     2520    10782        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2521    10783                MESSAGE: Command not legal on non keyed files.
     2522    10784                MESSAGE1: Insert,delete and RP mode changes are not legal for
     2523    10785                          non keyed files.
     2524    10786                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2525    10787        /**/
     2526    10788    2        IF (CMD_CODE = TYCMD)OR(CMD_CODE = FTCMD) THEN

  10788  9 005774   000062 115007                    CMPA    50,DL
         9 005775   006000 600000 9                  TZE     s:10789
         9 005776   000035 115007                    CMPA    29,DL
         9 005777   006003 601000 9                  TNZ     s:10790

     2527    10789    2           LAST_TYPE_CMD = TYCMD;

  10789  9 006000   000062 236007                    LDQ     50,DL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:333  
         9 006001   002630 756000 2                  STQ     LAST_TYPE_CMD
         9 006002   006007 710000 9                  TRA     s:10791

     2528    10790    2        ELSE IF (CMD_CODE = FSCMD) THEN LAST_TYPE_CMD = TSCMD;

  10790  9 006003   000036 115007                    CMPA    30,DL
         9 006004   006007 601000 9                  TNZ     s:10791

  10790  9 006005   000063 236007                    LDQ     51,DL
         9 006006   002630 756000 2                  STQ     LAST_TYPE_CMD

     2529    10791    3        IF ((CMD_CODE ~= TYCMD)OR(BLK$ -> OUT$BLK.NSUBLKS ~= 1)) THEN DO;

  10791  9 006007   000062 115007                    CMPA    50,DL
         9 006010   006015 601000 9                  TNZ     s:10792
         9 006011   002700 470400 2                  LDP0    BLK$
         9 006012   000001 220100                    LDX0    1,,PR0
         9 006013   000001 100003                    CMPX0   1,DU
         9 006014   006033 600000 9                  TZE     s:10800

     2530    10792    3           CALL VEX$CHECK_FIRST ALTRET(CHECK_SE_ALT);

  10792  9 006015   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006016   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 006017   006370 702000 9                  TSX2    CHECK_SE_ALT

     2531    10793    3           SSE$ = ADDR(SSE_TBL);

  10793  9 006020   200003 630500                    EPPR0   SSE_TBL,,AUTO
         9 006021   002665 450400 2                  STP0    SSE$

     2532    10794    3           SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);

  10794  9 006022   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006023   000001 756100                    STQ     1,,PR0

     2533    10795    3           STR_TEXT$ = STR_TEXT_HEAD$;     /* RESET TEXT SEG. PTRS               */
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:334  

  10795  9 006024   002674 236000 2                  LDQ     STR_TEXT_HEAD$
         9 006025   002673 756000 2                  STQ     STR_TEXT$

     2534    10796    3           STR_TEXT_SE$ = STR_TEXT_HEAD$;

  10796  9 006026   002676 756000 2                  STQ     STR_TEXT_SE$

     2535    10797    3           CALL VEX$CLMN_DFLT;

  10797  9 006027   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006030   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         9 006031   000000 011000                    NOP     0

     2536    10798    3           END;

  10798  9 006032   006040 710000 9                  TRA     s:10804

     2537    10799    3        ELSE DO;                           /* INTRA RECORD TY                    */

     2538    10800    3           CMD_CODE = INTTYCMD;

  10800  9 006033   000116 236007                    LDQ     78,DL
         9 006034   002625 756000 2                  STQ     CMD_CODE

     2539    10801    3           CMD$ -> CMD_CNTRLWD.CMD_CODE = INTTYCMD;

  10801  9 006035   002657 471400 2                  LDP1    CMD$
         9 006036   000116 236007                    LDQ     78,DL
         9 006037   100000 552104                    STBQ    0,'04'O,PR1

     2540    10802    3           END;

     2541    10803        /**/
     2542    10804    2        IF (CMD_CODE = SECMD) THEN FLAGS.NOCOMPCMD = FALSE; /* SE MAY BE COMPOUNDED */

  10804  9 006040   002625 235000 2                  LDA     CMD_CODE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:335  
         9 006041   000024 115007                    CMPA    20,DL
         9 006042   006045 601000 9                  TNZ     s:10806

  10804  9 006043   000071 236000 10                 LDQ     57
         9 006044   002706 356000 2                  ANSQ    FLAGS

     2543    10805        /**/
     2544    10806    2        IF ((CMD_CODE = TYCMD)OR(CMD_CODE = FTCMD)OR(CMD_CODE = FSCMD)OR

  10806  9 006045   000062 115007                    CMPA    50,DL
         9 006046   006057 600000 9                  TZE     s:10808
         9 006047   000035 115007                    CMPA    29,DL
         9 006050   006057 600000 9                  TZE     s:10808
         9 006051   000036 115007                    CMPA    30,DL
         9 006052   006057 600000 9                  TZE     s:10808
         9 006053   000037 115007                    CMPA    31,DL
         9 006054   006057 600000 9                  TZE     s:10808
         9 006055   000116 115007                    CMPA    78,DL
         9 006056   006063 601000 9                  TNZ     s:10809

     2545    10807    2           (CMD_CODE = FDCMD)OR(CMD_CODE = INTTYCMD)) THEN
     2546    10808    2           CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD_CNTRLWD);

  10808  9 006057   002657 470400 2                  LDP0    CMD$
         9 006060   001000 236007                    LDQ     512,DL
         9 006061   000000 552110                    STBQ    0,'10'O,PR0
         9 006062   006066 710000 9                  TRA     s:10812

     2547    10809    2        ELSE CMD$ -> CMD_CNTRLWD.OFFSET = 0; /* NO ENTRY IN CMD_TBL FOR       */

  10809  9 006063   002657 470400 2                  LDP0    CMD$
         9 006064   000000 236003                    LDQ     0,DU
         9 006065   000000 552110                    STBQ    0,'10'O,PR0

     2548    10810                                                /* SE,SS OR ST COMMAND                */
     2549    10811        /**/
     2550    10812    3        IF (CMD_CODE = SSCMD)OR(CMD_CODE = STCMD) THEN DO;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:336  

  10812  9 006066   002625 235000 2                  LDA     CMD_CODE
         9 006067   000033 115007                    CMPA    27,DL
         9 006070   006073 600000 9                  TZE     s:10813
         9 006071   000034 115007                    CMPA    28,DL
         9 006072   006105 601000 9                  TNZ     s:10817

     2551    10813    3           FLAGS.STEP_MODE = TRUE;

  10813  9 006073   100000 236003                    LDQ     32768,DU
         9 006074   002706 256000 2                  ORSQ    FLAGS

     2552    10814    3           IF (CMD_CODE = STCMD) THEN FLAGS.ST_CMD = TRUE;

  10814  9 006075   000034 115007                    CMPA    28,DL
         9 006076   006102 601000 9                  TNZ     s:10815

  10814  9 006077   004000 236003                    LDQ     2048,DU
         9 006100   002706 256000 2                  ORSQ    FLAGS
         9 006101   006107 710000 9                  TRA     s:10819

     2553    10815    3           ELSE FLAGS.ST_CMD = FALSE;

  10815  9 006102   000215 236000 10                 LDQ     141
         9 006103   002706 356000 2                  ANSQ    FLAGS

     2554    10816    3           END;

  10816  9 006104   006107 710000 9                  TRA     s:10819

     2555    10817    2        ELSE FLAGS.INTRA_CMD = TRUE;

  10817  9 006105   200000 236003                    LDQ     65536,DU
         9 006106   002706 256000 2                  ORSQ    FLAGS

     2556    10818        /**/
     2557    10819    2        IF ((CMD_CODE = SECMD)OR(CMD_CODE = SSCMD)OR(CMD_CODE = STCMD))AND
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:337  

  10819  9 006107   000024 115007                    CMPA    20,DL
         9 006110   006115 600000 9                  TZE     s:10819+6
         9 006111   000033 115007                    CMPA    27,DL
         9 006112   006115 600000 9                  TZE     s:10819+6
         9 006113   000034 115007                    CMPA    28,DL
         9 006114   006127 601000 9                  TNZ     s:10826
         9 006115   002700 470400 2                  LDP0    BLK$
         9 006116   000001 220100                    LDX0    1,,PR0
         9 006117   000001 100003                    CMPX0   1,DU
         9 006120   006127 601000 9                  TNZ     s:10826

     2558    10820    3           (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO; /* DEFAULT                   */

     2559    10821    3           LO_SEQNUM = Y003 ;

  10821  9 006121   000414 236000 1                  LDQ     Y003
         9 006122   002601 756000 2                  STQ     LO_SEQNUM

     2560    10822    3           HI_SEQNUM = MAX_SEQNUM ;

  10822  9 006123   000412 235000 1                  LDA     MAX_SEQNUM
         9 006124   002602 755000 2                  STA     HI_SEQNUM

     2561    10823    3           RETURN;

  10823  9 006125   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006126   000001 702211                    TSX2  ! 1,X1

     2562    10824    3           END;
     2563    10825        /**/
     2564    10826    2        IF (CMD_CODE = FDCMD) THEN FLAGS.DELRECCMD = TRUE;

  10826  9 006127   000037 115007                    CMPA    31,DL
         9 006130   006133 601000 9                  TNZ     s:10828

  10826  9 006131   001000 236007                    LDQ     512,DL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:338  
         9 006132   002706 256000 2                  ORSQ    FLAGS

     2565    10827        /**/
     2566    10828    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN RETURN;

  10828  9 006133   002700 470400 2                  LDP0    BLK$
         9 006134   000001 220100                    LDX0    1,,PR0
         9 006135   000001 100003                    CMPX0   1,DU
         9 006136   006141 601000 9                  TNZ     s:10830

  10828  9 006137   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006140   000001 702211                    TSX2  ! 1,X1

     2567    10829        /**/
     2568    10830    2        CALL VEX$PARSE_SEQRANGE(LO_SEQNUM,HI_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))

  10830  9 006141   002700 236000 2                  LDQ     BLK$
         9 006142   000004 036003                    ADLQ    4,DU
         9 006143   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006144   000216 237000 10                 LDAQ    142
         9 006145   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 006146   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006147   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006150   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 006151   006370 702000 9                  TSX2    CHECK_SE_ALT

     2569    10831    2           ALTRET (CHECK_SE_ALT);
     2570    10832    2        IF ((LO_SEQNUM = HI_SEQNUM) AND ((CMD_CODE = SSCMD) OR

  10832  9 006152   002601 236000 2                  LDQ     LO_SEQNUM
         9 006153   002602 116000 2                  CMPQ    HI_SEQNUM
         9 006154   006164 601000 9                  TNZ     s:10837
         9 006155   002625 235000 2                  LDA     CMD_CODE
         9 006156   000033 115007                    CMPA    27,DL
         9 006157   006162 600000 9                  TZE     s:10834
         9 006160   000034 115007                    CMPA    28,DL
         9 006161   006164 601000 9                  TNZ     s:10837
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:339  

     2571    10833    2           (CMD_CODE = STCMD)))
     2572    10834    2        THEN HI_SEQNUM = MAX_SEQNUM ;      /* SS or ST to EOF. */

  10834  9 006162   000412 235000 1                  LDA     MAX_SEQNUM
         9 006163   002602 755000 2                  STA     HI_SEQNUM

     2573    10835        /**/
     2574    10836        /**/                                    /* SS,ST TO EOF                       */
     2575    10837    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN;

  10837  9 006164   002700 470400 2                  LDP0    BLK$
         9 006165   000001 220100                    LDX0    1,,PR0
         9 006166   000002 100003                    CMPX0   2,DU
         9 006167   006172 601000 9                  TNZ     s:10838

  10837  9 006170   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006171   000001 702211                    TSX2  ! 1,X1

     2576    10838    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(2);

  10838  9 006172   000005 236100                    LDQ     5,,PR0
         9 006173   002700 756000 2                  STQ     BLK$

     2577    10839    3        IF (BLK$ -> OUT$BLK.CODE = PC_SSE) THEN DO;

  10839  9 006174   002700 470400 2                  LDP0    BLK$
         9 006175   000000 720100                    LXL0    0,,PR0
         9 006176   000154 100003                    CMPX0   108,DU
         9 006177   006356 601000 9                  TNZ     s:10877

     2578    10840    3           I = 0;

  10840  9 006200   002640 450000 2                  STZ     I

     2579    10841    3           SSE$ -> SSE$PARAM.FLAGS = FALSE;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:340  
  10841  9 006201   000000 220003                    LDX0    0,DU
         9 006202   002665 471400 2                  LDP1    SSE$
         9 006203   100000 740100                    STX0    0,,PR1

     2580    10842    3           SSE$ -> SSE$PARAM.FLAGS.ORFLAG = TRUE; /* FIRST OP. IS OR          */

  10842  9 006204   002665 470400 2                  LDP0    SSE$
         9 006205   040000 236003                    LDQ     16384,DU
         9 006206   000000 256100                    ORSQ    0,,PR0

     2581    10843    4           IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_NOT) THEN DO;

  10843  9 006207   002700 470400 2                  LDP0    BLK$
         9 006210   000003 471500                    LDP1    3,,PR0
         9 006211   100000 721100                    LXL1    0,,PR1
         9 006212   000155 101003                    CMPX1   109,DU
         9 006213   006222 601000 9                  TNZ     s:10847

     2582    10844    4              SSE$ -> SSE$PARAM.FLAGS.NOTFLAG = TRUE;

  10844  9 006214   002665 473400 2                  LDP3    SSE$
         9 006215   200000 236003                    LDQ     65536,DU
         9 006216   300000 256100                    ORSQ    0,,PR3

     2583    10845    4              I = I+1;

  10845  9 006217   002640 235000 2                  LDA     I
         9 006220   000001 035007                    ADLA    1,DL
         9 006221   002640 755000 2                  STA     I

     2584    10846    4              END;

     2585    10847    3           CALL VEX$PARSE_JSTRING (BLK$ -> OUT$BLK.SUBLK$(I),SSE$,J0NOTOK)

  10847  9 006222   000017 236000 10                 LDQ     15
         9 006223   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006224   000220 236000 10                 LDQ     144
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:341  
         9 006225   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 006226   002640 236000 2                  LDQ     I
         9 006227   000022 736000                    QLS     18
         9 006230   000003 036003                    ADLQ    3,DU
         9 006231   002700 036000 2                  ADLQ    BLK$
         9 006232   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006233   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006234   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006235   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 006236   006370 702000 9                  TSX2    CHECK_SE_ALT

     2586    10848    3              ALTRET (CHECK_SE_ALT);
     2587    10849        /**/
     2588    10850    4           DO WHILE (BLK$ -> OUT$BLK.NSUBLKS > I+1); /* PROCESS ALL STRINGS   */

  10850  9 006237   006326 710000 9                  TRA     s:10868

     2589    10851    4              SSE$  = PINCRW(SSE$,2);      /* NEXT BLOCK                         */

  10851  9 006240   002665 236000 2                  LDQ     SSE$
         9 006241   000002 036003                    ADLQ    2,DU
         9 006242   002665 756000 2                  STQ     SSE$

     2590    10852    4              SSE$ -> SSE$PARAM.FLAGS = FALSE;

  10852  9 006243   000000 220003                    LDX0    0,DU
         9 006244   002665 470400 2                  LDP0    SSE$
         9 006245   000000 740100                    STX0    0,,PR0

     2591    10853    4              BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+1);

  10853  9 006246   002700 470400 2                  LDP0    BLK$
         9 006247   002640 721000 2                  LXL1    I
         9 006250   000004 236111                    LDQ     4,X1,PR0
         9 006251   002700 756000 2                  STQ     BLK$

     2592    10854    4              I = 1;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:342  

  10854  9 006252   000001 235007                    LDA     1,DL
         9 006253   002640 755000 2                  STA     I

     2593    10855    4              IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_AND)

  10855  9 006254   002700 470400 2                  LDP0    BLK$
         9 006255   000003 471500                    LDP1    3,,PR0
         9 006256   100000 721100                    LXL1    0,,PR1
         9 006257   000161 101003                    CMPX1   113,DU
         9 006260   006265 601000 9                  TNZ     s:10857

     2594    10856    4              THEN SSE$ -> SSE$PARAM.FLAGS.ANDFLAG = TRUE;

  10856  9 006261   002665 473400 2                  LDP3    SSE$
         9 006262   100000 236003                    LDQ     32768,DU
         9 006263   300000 256100                    ORSQ    0,,PR3
         9 006264   006276 710000 9                  TRA     s:10861

     2595    10857    4              ELSE IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_OR)

  10857  9 006265   000162 101003                    CMPX1   114,DU
         9 006266   006273 601000 9                  TNZ     s:10859

     2596    10858    4                 THEN SSE$ -> SSE$PARAM.FLAGS.ORFLAG = TRUE;

  10858  9 006267   002665 473400 2                  LDP3    SSE$
         9 006270   040000 236003                    LDQ     16384,DU
         9 006271   300000 256100                    ORSQ    0,,PR3
         9 006272   006276 710000 9                  TRA     s:10861

     2597    10859    4                 ELSE SSE$ -> SSE$PARAM.FLAGS.EORFLAG = TRUE;

  10859  9 006273   002665 473400 2                  LDP3    SSE$
         9 006274   020000 236003                    LDQ     8192,DU
         9 006275   300000 256100                    ORSQ    0,,PR3

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:343  
     2598    10860        /**/
     2599    10861    5              IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_NOT) THEN DO;

  10861  9 006276   002700 470400 2                  LDP0    BLK$
         9 006277   000004 471500                    LDP1    4,,PR0
         9 006300   100000 721100                    LXL1    0,,PR1
         9 006301   000155 101003                    CMPX1   109,DU
         9 006302   006311 601000 9                  TNZ     s:10866

     2600    10862    5                 SSE$ -> SSE$PARAM.FLAGS.NOTFLAG = TRUE;

  10862  9 006303   002665 473400 2                  LDP3    SSE$
         9 006304   200000 236003                    LDQ     65536,DU
         9 006305   300000 256100                    ORSQ    0,,PR3

     2601    10863    5                 I = I+1;

  10863  9 006306   002640 235000 2                  LDA     I
         9 006307   000001 035007                    ADLA    1,DL
         9 006310   002640 755000 2                  STA     I

     2602    10864    5                 END;

     2603    10865        /**/
     2604    10866    4              CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),SSE$,J0NOTOK)

  10866  9 006311   000017 236000 10                 LDQ     15
         9 006312   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006313   000220 236000 10                 LDQ     144
         9 006314   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 006315   002640 236000 2                  LDQ     I
         9 006316   000022 736000                    QLS     18
         9 006317   000003 036003                    ADLQ    3,DU
         9 006320   002700 036000 2                  ADLQ    BLK$
         9 006321   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006322   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006323   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:344  
         9 006324   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 006325   006370 702000 9                  TSX2    CHECK_SE_ALT

     2605    10867    4                 ALTRET (CHECK_SE_ALT);
     2606    10868    4              END;

  10868  9 006326   002700 470400 2                  LDP0    BLK$
         9 006327   000001 236100                    LDQ     1,,PR0
         9 006330   000022 772000                    QRL     18
         9 006331   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006332   002640 236000 2                  LDQ     I
         9 006333   000001 036007                    ADLQ    1,DL
         9 006334   200414 116100                    CMPQ    IN_SLASH+1,,AUTO
         9 006335   006240 602000 9                  TNC     s:10851

     2607    10869        /**/
     2608    10870    3           STR_TEXT_SE$ = STR_TEXT$;       /* SET STR_TEXT$ AFTER 'SE' TEXT      */

  10870  9 006336   002673 236000 2                  LDQ     STR_TEXT$
         9 006337   002676 756000 2                  STQ     STR_TEXT_SE$

     2609    10871    3           SSE$ = PINCRW(SSE$,2);

  10871  9 006340   002665 236000 2                  LDQ     SSE$
         9 006341   000002 036003                    ADLQ    2,DU
         9 006342   002665 756000 2                  STQ     SSE$

     2610    10872    3           SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);

  10872  9 006343   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006344   002665 471400 2                  LDP1    SSE$
         9 006345   100001 756100                    STQ     1,,PR1

     2611    10873    3           IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 3) THEN RETURN;
             10873                    /* NO COLUMN RANGE GIVEN */

  10873  9 006346   002733 470400 2                  LDP0    P_PCB+3
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:345  
         9 006347   000001 220100                    LDX0    1,,PR0
         9 006350   000003 100003                    CMPX0   3,DU
         9 006351   006354 601000 9                  TNZ     s:10874

  10873  9 006352   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006353   000001 702211                    TSX2  ! 1,X1

     2612    10874    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(3);

  10874  9 006354   000006 236100                    LDQ     6,,PR0
         9 006355   002700 756000 2                  STQ     BLK$

     2613    10875    3           END;

     2614    10876        /**/
     2615    10877    2        CALL VEX$PARSE_CLMNRANGE (LO_SRCH_CLMN,HI_SRCH_CLMN,BLK$)

  10877  9 006356   000221 630400 10                 EPPR0   145
         9 006357   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006360   000000 701000 xent               TSX1    VEX$PARSE_CLMNRANGE
         9 006361   006370 702000 9                  TSX2    CHECK_SE_ALT

     2616    10878    2           ALTRET (CHECK_SE_ALT);
     2617    10879    2        LO_EXEC_CLMN = LO_SRCH_CLMN;

  10879  9 006362   002574 235000 2                  LDA     LO_SRCH_CLMN
         9 006363   002576 755000 2                  STA     LO_EXEC_CLMN

     2618    10880    2        HI_EXEC_CLMN = HI_SRCH_CLMN;

  10880  9 006364   002575 236000 2                  LDQ     HI_SRCH_CLMN
         9 006365   002577 756000 2                  STQ     HI_EXEC_CLMN

     2619    10881        /**/
     2620    10882    2        RETURN;

  10882  9 006366   200410 221300                    LDX1  ! STR_FLGS,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:346  
         9 006367   000001 702211                    TSX2  ! 1,X1

     2621    10883        /**/
     2622    10884    2   CHECK_SE_ALT:
     2623    10885    2        ALTRETURN;

  10885  9 006370   200410 221300       CHECK_SE_ALT LDX1  ! STR_FLGS,,AUTO
         9 006371   000000 702211                    TSX2  ! 0,X1

     2624    10886    2   END;
     2625    10887        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:347  
     2626    10888        /**/
     2627    10889    1   CHECK_TN: PROC ALTRET;

  10889  9 006372   200410 741300       CHECK_TN     STX1  ! STR_FLGS,,AUTO

     2628    10890        /**/
     2629    10891    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10891  9 006373   002706 236000 2                  LDQ     FLAGS
         9 006374   400000 376003                    ANQ     -131072,DU
         9 006375   400000 676003                    ERQ     -131072,DU
         9 006376   006405 600000 9                  TZE     s:10901

     2630    10892    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10892  9 006377   000170 630400 10                 EPPR0   120
         9 006400   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006401   000000 701000 xent               TSX1    VEX$ERROR
         9 006402   000000 011000                    NOP     0

     2631    10893        /**/
     2632    10894        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2633    10895                 DESCRIPTION: A record oriented command has been received
     2634    10896                           without a file open to edit.
     2635    10897        */
     2636    10898    3           ALTRETURN;

  10898  9 006403   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006404   000000 702211                    TSX2  ! 0,X1

     2637    10899    3           END;
     2638    10900        /**/
     2639    10901    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(TN_CMD_TBL);

  10901  9 006405   002657 470400 2                  LDP0    CMD$
         9 006406   002000 236007                    LDQ     1024,DL
         9 006407   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:348  

     2640    10902        /**/
     2641    10903    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TN_ALT);

  10903  9 006410   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006411   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 006412   006431 702000 9                  TSX2    CHECK_TN_ALT

     2642    10904        /**/
     2643    10905    2        CALL CHARBIN(CMD$ -> TN_CMD_TBL.COUNT,SUBSTR(

  10905  9 006413   002700 470400 2                  LDP0    BLK$
         9 006414   000004 471500                    LDP1    4,,PR0
         9 006415   100003 473500                    LDP3    3,,PR1
         9 006416   300000 236100                    LDQ     0,,PR3
         9 006417   000033 772000                    QRL     27
         9 006420   000000 620006                    EAX0    0,QL
         9 006421   000100 305540                    DTB
         9 006422   300000 230010                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         9 006423   200414 000010                    NDSC9   IN_SLASH+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 006424   002657 471400 2                  LDP1    CMD$
         9 006425   200415 235100                    LDA     IN_SLASH+2,,AUTO
         9 006426   100001 755100                    STA     1,,PR1

     2644    10906    2           BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT,0,
     2645    10907    2           BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT));
     2646    10908    2        RETURN;

  10908  9 006427   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006430   000001 702211                    TSX2  ! 1,X1

     2647    10909        /**/
     2648    10910    2   CHECK_TN_ALT:
     2649    10911    2        ALTRETURN;

  10911  9 006431   200410 221300       CHECK_TN_ALT LDX1  ! STR_FLGS,,AUTO
         9 006432   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:349  

     2650    10912    2   END;
     2651    10913        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:350  
     2652    10914        /**/
     2653    10915    1   CHECK_TS: PROC ALTRET;                  /* TS,TC,TX,RF,NO,EI,RL,QR            */

  10915  9 006433   200410 741300       CHECK_TS     STX1  ! STR_FLGS,,AUTO

     2654    10916        /**/
     2655    10917    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10917  9 006434   002706 236000 2                  LDQ     FLAGS
         9 006435   400000 376003                    ANQ     -131072,DU
         9 006436   400000 676003                    ERQ     -131072,DU
         9 006437   006446 600000 9                  TZE     s:10927

     2656    10918    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10918  9 006440   000170 630400 10                 EPPR0   120
         9 006441   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006442   000000 701000 xent               TSX1    VEX$ERROR
         9 006443   000000 011000                    NOP     0

     2657    10919        /**/
     2658    10920        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2659    10921                 DESCRIPTION: A record oriented command has been received
     2660    10922                           without a file open to edit.
     2661    10923        */
     2662    10924    3           ALTRETURN;

  10924  9 006444   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006445   000000 702211                    TSX2  ! 0,X1

     2663    10925    3           END;
     2664    10926        /**/
     2665    10927    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CMD_CNTRLWD);

  10927  9 006446   002657 470400 2                  LDP0    CMD$
         9 006447   001000 236007                    LDQ     512,DL
         9 006450   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:351  

     2666    10928    2        FLAGS.INTRA_CMD = TRUE;

  10928  9 006451   200000 236003                    LDQ     65536,DU
         9 006452   002706 256000 2                  ORSQ    FLAGS

     2667    10929        /**/
     2668    10930    2        IF (CMD_CODE = TYCMD) THEN LAST_TYPE_CMD = TYCMD;

  10930  9 006453   002625 235000 2                  LDA     CMD_CODE
         9 006454   000062 115007                    CMPA    50,DL
         9 006455   006460 601000 9                  TNZ     s:10931

  10930  9 006456   000062 235007                    LDA     50,DL
         9 006457   002630 755000 2                  STA     LAST_TYPE_CMD

     2669    10931    2        IF (CMD_CODE = TCCMD) THEN LAST_TYPE_CMD = TCCMD;

  10931  9 006460   002625 235000 2                  LDA     CMD_CODE
         9 006461   000064 115007                    CMPA    52,DL
         9 006462   006465 601000 9                  TNZ     s:10932

  10931  9 006463   000064 235007                    LDA     52,DL
         9 006464   002630 755000 2                  STA     LAST_TYPE_CMD

     2670    10932    2        IF (CMD_CODE = TSCMD) THEN LAST_TYPE_CMD = TSCMD;

  10932  9 006465   002625 235000 2                  LDA     CMD_CODE
         9 006466   000063 115007                    CMPA    51,DL
         9 006467   006472 601000 9                  TNZ     s:10934

  10932  9 006470   000063 235007                    LDA     51,DL
         9 006471   002630 755000 2                  STA     LAST_TYPE_CMD

     2671    10933        /**/
     2672    10934    2        IF (BLK$ -> OUT$BLK.NSUBLKS <= 1) THEN RETURN;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:352  
  10934  9 006472   002700 470400 2                  LDP0    BLK$
         9 006473   000001 220100                    LDX0    1,,PR0
         9 006474   000002 100003                    CMPX0   2,DU
         9 006475   006500 603000 9                  TRC     s:10936

  10934  9 006476   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006477   000001 702211                    TSX2  ! 1,X1

     2673    10935        /**/
     2674    10936    3        IF ((FLAGS.STEP_MODE)AND(BLK$ -> OUT$BLK.NSUBLKS > 1)) THEN DO;

  10936  9 006500   002706 236000 2                  LDQ     FLAGS
         9 006501   100000 316003                    CANQ    32768,DU
         9 006502   006513 600000 9                  TZE     s:10947
         9 006503   000002 100003                    CMPX0   2,DU
         9 006504   006513 602000 9                  TNC     s:10947

     2675    10937    3           CALL VEX$ERROR(E$E_NOSEQRNGE,2);

  10937  9 006505   000176 630400 10                 EPPR0   126
         9 006506   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006507   000000 701000 xent               TSX1    VEX$ERROR
         9 006510   000000 011000                    NOP     0

     2676    10938    3           ALTRETURN;

  10938  9 006511   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006512   000000 702211                    TSX2  ! 0,X1

     2677    10939    3           END;
     2678    10940        /**/
     2679    10941        /*E*     ERROR:    VEE-E$E_NOSEQRNGE-0
     2680    10942                 MESSAGE:  No sequence number range allowed here
     2681    10943                 DESCRIPTION:   A TY command with a range of sequence numbers was
     2682    10944                           input while in strp mode.
     2683    10945        */
     2684    10946        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:353  
     2685    10947    2        CALL VEX$CHECK_FIRST ALTRET (CHECK_TS_ALT);

  10947  9 006513   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006514   000000 701000 xent               TSX1    VEX$CHECK_FIRST
         9 006515   006564 702000 9                  TSX2    CHECK_TS_ALT

     2686    10948    2        CALL VEX$CLMN_DFLT;

  10948  9 006516   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006517   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         9 006520   000000 011000                    NOP     0

     2687    10949    2        SSE$ = ADDR(SSE_TBL);

  10949  9 006521   200003 630500                    EPPR0   SSE_TBL,,AUTO
         9 006522   002665 450400 2                  STP0    SSE$

     2688    10950    2        SSE$ -> SSE$PARAM.PTR$ = ADDR(NIL);

  10950  9 006523   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006524   000001 756100                    STQ     1,,PR0

     2689    10951        /**/
     2690    10952    2        FLAGS.NOCOMPCMD = TRUE;       /* INTER REC. TY,TS,TC NOT COMPOUNDABLE    */

  10952  9 006525   000010 236003                    LDQ     8,DU
         9 006526   002706 256000 2                  ORSQ    FLAGS

     2691    10953        /**/
     2692    10954    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);

  10954  9 006527   002700 470400 2                  LDP0    BLK$
         9 006530   000004 236100                    LDQ     4,,PR0
         9 006531   002700 756000 2                  STQ     BLK$

     2693    10955    3        IF (BLK$ -> OUT$BLK.CODE = PC_SEQRANGE) THEN DO;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:354  
  10955  9 006532   002700 470400 2                  LDP0    BLK$
         9 006533   000000 720100                    LXL0    0,,PR0
         9 006534   000174 100003                    CMPX0   124,DU
         9 006535   006552 601000 9                  TNZ     s:10963

     2694    10956    3           CALL VEX$PARSE_SEQRANGE(LO_SEQNUM,HI_SEQNUM,BLK$)

  10956  9 006536   000224 630400 10                 EPPR0   148
         9 006537   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006540   000000 701000 xent               TSX1    VEX$PARSE_SEQRANGE
         9 006541   006564 702000 9                  TSX2    CHECK_TS_ALT

     2695    10957    3              ALTRET (CHECK_TS_ALT);
     2696    10958    3          IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 2) THEN RETURN; /* NO CLMNRANGE GIVEN */

  10958  9 006542   002733 470400 2                  LDP0    P_PCB+3
         9 006543   000001 220100                    LDX0    1,,PR0
         9 006544   000002 100003                    CMPX0   2,DU
         9 006545   006550 601000 9                  TNZ     s:10959

  10958  9 006546   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006547   000001 702211                    TSX2  ! 1,X1

     2697    10959    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(2);

  10959  9 006550   000005 236100                    LDQ     5,,PR0
         9 006551   002700 756000 2                  STQ     BLK$

     2698    10960    3           END;

     2699    10961        /**/
     2700    10962        /**/
     2701    10963    2        CALL VEX$PARSE_CLMNRANGE(LO_SRCH_CLMN,HI_SRCH_CLMN,BLK$)

  10963  9 006552   000221 630400 10                 EPPR0   145
         9 006553   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006554   000000 701000 xent               TSX1    VEX$PARSE_CLMNRANGE
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:355  
         9 006555   006564 702000 9                  TSX2    CHECK_TS_ALT

     2702    10964    2           ALTRET (CHECK_TS_ALT);
     2703    10965    2        LO_EXEC_CLMN = LO_SRCH_CLMN;

  10965  9 006556   002574 235000 2                  LDA     LO_SRCH_CLMN
         9 006557   002576 755000 2                  STA     LO_EXEC_CLMN

     2704    10966    2        HI_EXEC_CLMN = HI_SRCH_CLMN;

  10966  9 006560   002575 236000 2                  LDQ     HI_SRCH_CLMN
         9 006561   002577 756000 2                  STQ     HI_EXEC_CLMN

     2705    10967    2        RETURN;

  10967  9 006562   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006563   000001 702211                    TSX2  ! 1,X1

     2706    10968        /**/
     2707    10969    2   CHECK_TS_ALT:
     2708    10970    2        ALTRETURN;

  10970  9 006564   200410 221300       CHECK_TS_ALT LDX1  ! STR_FLGS,,AUTO
         9 006565   000000 702211                    TSX2  ! 0,X1

     2709    10971    2   END;
     2710    10972        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:356  
     2711    10973        /**/
     2712    10974    1   CHECK_A: PROC ALTRET;                   /* A                                  */

  10974  9 006566   200410 741300       CHECK_A      STX1  ! STR_FLGS,,AUTO

     2713    10975        /**/
     2714    10976    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  10976  9 006567   002706 236000 2                  LDQ     FLAGS
         9 006570   400000 376003                    ANQ     -131072,DU
         9 006571   400000 676003                    ERQ     -131072,DU
         9 006572   006601 600000 9                  TZE     s:10986

     2715    10977    3           CALL VEX$ERROR (E$E_NOFILE,3);

  10977  9 006573   000170 630400 10                 EPPR0   120
         9 006574   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006575   000000 701000 xent               TSX1    VEX$ERROR
         9 006576   000000 011000                    NOP     0

     2716    10978        /**/
     2717    10979        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2718    10980                 DESCRIPTION: A record oriented command has been received
     2719    10981                           without a file open to edit.
     2720    10982        */
     2721    10983    3           ALTRETURN;

  10983  9 006577   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006600   000000 702211                    TSX2  ! 0,X1

     2722    10984    3           END;
     2723    10985        /**/
     2724    10986    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);

  10986  9 006601   002657 470400 2                  LDP0    CMD$
         9 006602   005000 236007                    LDQ     2560,DL
         9 006603   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:357  

     2725    10987    2        FLAGS.INTRA_CMD = TRUE;

  10987  9 006604   200000 236003                    LDQ     65536,DU
         9 006605   002706 256000 2                  ORSQ    FLAGS

     2726    10988    2        FLAGS.STRCHGCMD = TRUE;

  10988  9 006606   020000 236007                    LDQ     8192,DL
         9 006607   002706 256000 2                  ORSQ    FLAGS

     2727    10989        /**/
     2728    10990    2        P$ = PINCRW(CMD$,1);

  10990  9 006610   002657 236000 2                  LDQ     CMD$
         9 006611   000001 036003                    ADLQ    1,DU
         9 006612   002650 756000 2                  STQ     P$

     2729    10991    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0NOTOK)

  10991  9 006613   000017 236000 10                 LDQ     15
         9 006614   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006615   000227 236000 10                 LDQ     151
         9 006616   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 006617   002700 236000 2                  LDQ     BLK$
         9 006620   000003 036003                    ADLQ    3,DU
         9 006621   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006622   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006623   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006624   000000 701000 xent               TSX1    VEX$PARSE_CLMNSTRING
         9 006625   006646 702000 9                  TSX2    CHECK_A_ALT

     2730    10992    2           ALTRET (CHECK_A_ALT);
     2731    10993        /**/
     2732    10994    2        P$ = PINCRW(P$,2);                 /* POINT TO NEXT SSE$PARAM            */

  10994  9 006626   002650 236000 2                  LDQ     P$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:358  
         9 006627   000002 036003                    ADLQ    2,DU
         9 006630   002650 756000 2                  STQ     P$

     2733    10995    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(2),P$,J0NOTOK)

  10995  9 006631   000017 236000 10                 LDQ     15
         9 006632   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006633   000227 236000 10                 LDQ     151
         9 006634   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 006635   002700 236000 2                  LDQ     BLK$
         9 006636   000005 036003                    ADLQ    5,DU
         9 006637   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006640   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006641   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006642   000000 701000 xent               TSX1    VEX$PARSE_CLMNSTRING
         9 006643   006646 702000 9                  TSX2    CHECK_A_ALT

     2734    10996    2           ALTRET (CHECK_A_ALT);
     2735    10997    2        RETURN;

  10997  9 006644   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006645   000001 702211                    TSX2  ! 1,X1

     2736    10998        /**/
     2737    10999    2   CHECK_A_ALT:
     2738    11000    2        ALTRETURN;

  11000  9 006646   200410 221300       CHECK_A_ALT  LDX1  ! STR_FLGS,,AUTO
         9 006647   000000 702211                    TSX2  ! 0,X1

     2739    11001    2   END;
     2740    11002        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:359  
     2741    11003        /**/
     2742    11004    1   CHECK_CL: PROC ALTRET;

  11004  9 006650   200410 741300       CHECK_CL     STX1  ! STR_FLGS,,AUTO

     2743    11005        /**/
     2744    11006    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11006  9 006651   002706 236000 2                  LDQ     FLAGS
         9 006652   400000 376003                    ANQ     -131072,DU
         9 006653   400000 676003                    ERQ     -131072,DU
         9 006654   006663 600000 9                  TZE     s:11016

     2745    11007    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11007  9 006655   000170 630400 10                 EPPR0   120
         9 006656   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006657   000000 701000 xent               TSX1    VEX$ERROR
         9 006660   000000 011000                    NOP     0

     2746    11008        /**/
     2747    11009        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2748    11010                 DESCRIPTION: A record oriented command has been received
     2749    11011                           without a file open to edit.
     2750    11012        */
     2751    11013    3           ALTRETURN;

  11013  9 006661   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006662   000000 702211                    TSX2  ! 0,X1

     2752    11014    3           END;
     2753    11015        /**/
     2754    11016    2        CMD$->CMD_CNTRLWD.OFFSET = SIZEW(CMD$->IN_CMD_TBL) ;

  11016  9 006663   002657 470400 2                  LDP0    CMD$
         9 006664   005000 236007                    LDQ     2560,DL
         9 006665   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:360  

     2755    11017    2        CALL VEX$PARSE_CLMNRANGE(CMD$->IN_CMD_TBL.LO_SEQNUM ,

  11017  9 006666   002700 236000 2                  LDQ     BLK$
         9 006667   000004 036003                    ADLQ    4,DU
         9 006670   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 006671   002657 236000 2                  LDQ     CMD$
         9 006672   000002 036003                    ADLQ    2,DU
         9 006673   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 006674   002657 236000 2                  LDQ     CMD$
         9 006675   000001 036003                    ADLQ    1,DU
         9 006676   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 006677   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 006700   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006701   000000 701000 xent               TSX1    VEX$PARSE_CLMNRANGE
         9 006702   006714 702000 9                  TSX2    CHECK_CL_ALT

     2756    11018    2           CMD$->IN_CMD_TBL.HI_SEQNUM ,
     2757    11019    2           BLK$->OUT$BLK.SUBLK$(1))
     2758    11020    2           ALTRET(CHECK_CL_ALT) ;
     2759    11021    2        FLAGS.INTRA_CMD = TRUE ;

  11021  9 006703   200000 236003                    LDQ     65536,DU
         9 006704   002706 256000 2                  ORSQ    FLAGS

     2760    11022    2        LO_EXEC_CLMN = CMD$ -> IN_CMD_TBL.LO_SEQNUM ;

  11022  9 006705   002657 470400 2                  LDP0    CMD$
         9 006706   000001 235100                    LDA     1,,PR0
         9 006707   002576 755000 2                  STA     LO_EXEC_CLMN

     2761    11023    2        HI_EXEC_CLMN = CMD$ -> IN_CMD_TBL.HI_SEQNUM ;

  11023  9 006710   000002 235100                    LDA     2,,PR0
         9 006711   002577 755000 2                  STA     HI_EXEC_CLMN

     2762    11024    2        RETURN;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:361  

  11024  9 006712   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006713   000001 702211                    TSX2  ! 1,X1

     2763    11025        /**/
     2764    11026    2   CHECK_CL_ALT:
     2765    11027    2        ALTRETURN;

  11027  9 006714   200410 221300       CHECK_CL_ALT LDX1  ! STR_FLGS,,AUTO
         9 006715   000000 702211                    TSX2  ! 0,X1

     2766    11028    2   END;
     2767    11029        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:362  
     2768    11030        /**/
     2769    11031    1   CHECK_CP: PROC ALTRET;

  11031  9 006716   200410 741300       CHECK_CP     STX1  ! STR_FLGS,,AUTO

     2770    11032        /**/
     2771    11033    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11033  9 006717   002706 236000 2                  LDQ     FLAGS
         9 006720   400000 376003                    ANQ     -131072,DU
         9 006721   400000 676003                    ERQ     -131072,DU
         9 006722   006731 600000 9                  TZE     s:11043

     2772    11034    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11034  9 006723   000170 630400 10                 EPPR0   120
         9 006724   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006725   000000 701000 xent               TSX1    VEX$ERROR
         9 006726   000000 011000                    NOP     0

     2773    11035    3           ALTRETURN;

  11035  9 006727   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006730   000000 702211                    TSX2  ! 0,X1

     2774    11036    3           END;
     2775    11037        /**/
     2776    11038        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2777    11039                 DESCRIPTION: A record oriented command was received
     2778    11040                           without a file open.
     2779    11041        */
     2780    11042        /**/
     2781    11043    3        IF (FLAGS.CONSEC_MODE) THEN DO;

  11043  9 006731   002706 236000 2                  LDQ     FLAGS
         9 006732   002000 316003                    CANQ    1024,DU
         9 006733   006742 600000 9                  TZE     s:11051
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:363  

     2782    11044    3           CALL VEX$ERROR(E$E_NOTCONSECCMD,1);

  11044  9 006734   000145 630400 10                 EPPR0   101
         9 006735   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006736   000000 701000 xent               TSX1    VEX$ERROR
         9 006737   000000 011000                    NOP     0

     2783    11045    3           ALTRETURN;

  11045  9 006740   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006741   000000 702211                    TSX2  ! 0,X1

     2784    11046    3           END;
     2785    11047        /**/
     2786    11048        /*E*    ERROR:   VEE-E$E_NOTCONSECCMD-0
     2787    11049                DESCRIPTION: USER TRIED TO DO ILLEGAL OPERATION */
     2788    11050        /**/
     2789    11051    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> CP_CMD_TBL) ;

  11051  9 006742   002657 470400 2                  LDP0    CMD$
         9 006743   004000 236007                    LDQ     2048,DL
         9 006744   000000 552110                    STBQ    0,'10'O,PR0

     2790    11052    2        FLAGS.INTRA_CMD = TRUE;

  11052  9 006745   200000 236003                    LDQ     65536,DU
         9 006746   002706 256000 2                  ORSQ    FLAGS

     2791    11053    2        CP_RECSMVED = 0;

  11053  9 006747   002610 450000 2                  STZ     CP_RECSMVED

     2792    11054        /**/
     2793    11055    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN DO;

  11055  9 006750   002700 470400 2                  LDP0    BLK$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:364  
         9 006751   000001 220100                    LDX0    1,,PR0
         9 006752   000001 100003                    CMPX0   1,DU
         9 006753   006770 601000 9                  TNZ     s:11070

     2794    11056    4           IF (CP_SEQNUM = BITBIN('003777777777'O)) THEN DO;

  11056  9 006754   002605 236000 2                  LDQ     CP_SEQNUM
         9 006755   000436 116000 1                  CMPQ    NEWLINE_CNTRLWD+8
         9 006756   006765 601000 9                  TNZ     s:11066

     2795    11057    4              CALL VEX$ERROR(E$E_NOCPSEQ,3);

  11057  9 006757   000231 630400 10                 EPPR0   153
         9 006760   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006761   000000 701000 xent               TSX1    VEX$ERROR
         9 006762   000000 011000                    NOP     0

     2796    11058    4              ALTRETURN;

  11058  9 006763   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 006764   000000 702211                    TSX2  ! 0,X1

     2797    11059    4              END;
     2798    11060        /**/
     2799    11061        /*E*    ERROR: VEE-E$E_NOCPSEQ-0
     2800    11062                MESSAGE: No sequence number specified for copy destination
     2801    11063                MESSAGE1: The first CP or CI command must specify a sequence number.
     2802    11064                DESCRIPTION: GAVE DEFAULT CP OR CI COMMAND FIRST TIME - ERROR  */
     2803    11065        /**/
     2804    11066    3           CP_SEQNUM = CP_SEQNUM + CP_DFLT_INCR;

  11066  9 006765   002607 036000 2                  ADLQ    CP_DFLT_INCR
         9 006766   002605 756000 2                  STQ     CP_SEQNUM

     2805    11067    3           GOTO CP_LIMIT;

  11067  9 006767   007041 710000 9                  TRA     CP_LIMIT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:365  

     2806    11068    3           END;
     2807    11069        /**/
     2808    11070    3        IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_INCR) THEN DO;

  11070  9 006770   000004 471500                    LDP1    4,,PR0
         9 006771   100000 721100                    LXL1    0,,PR1
         9 006772   000150 101003                    CMPX1   104,DU
         9 006773   007011 601000 9                  TNZ     s:11078

     2809    11071    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(1); /* POINT TO INCR BLOCK           */

  11071  9 006774   000004 236100                    LDQ     4,,PR0
         9 006775   002700 756000 2                  STQ     BLK$

     2810    11072    3           CALL VEX$BUILD_SEQNUM(CP_DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))

  11072  9 006776   000003 036003                    ADLQ    3,DU
         9 006777   000233 235000 10                 LDA     155
         9 007000   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 007001   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007002   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007003   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 007004   007131 702000 9                  TSX2    CHECK_CP_ALT

     2811    11073    3              ALTRET (CHECK_CP_ALT);
     2812    11074    3           CP_DFLT_INCR = CP_DFLT_INCR - Y003;

  11074  9 007005   002607 236000 2                  LDQ     CP_DFLT_INCR
         9 007006   000414 136000 1                  SBLQ    Y003
         9 007007   002607 756000 2                  STQ     CP_DFLT_INCR

     2813    11075    3           GOTO CP_LIMIT;

  11075  9 007010   007041 710000 9                  TRA     CP_LIMIT

     2814    11076    3           END;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:366  
     2815    11077        /**/
     2816    11078    2        CALL VEX$BUILD_SEQNUM(CP_SEQNUM,BLK$ -> OUT$BLK.SUBLK$(1))

  11078  9 007011   002700 236000 2                  LDQ     BLK$
         9 007012   000004 036003                    ADLQ    4,DU
         9 007013   000234 235000 10                 LDA     156
         9 007014   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 007015   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007017   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 007020   007131 702000 9                  TSX2    CHECK_CP_ALT

     2817    11079    2           ALTRET (CHECK_CP_ALT);
     2818    11080        /**/
     2819    11081    3        IF (BLK$ -> OUT$BLK.NSUBLKS = 3) THEN DO;

  11081  9 007021   002700 470400 2                  LDP0    BLK$
         9 007022   000001 220100                    LDX0    1,,PR0
         9 007023   000003 100003                    CMPX0   3,DU
         9 007024   007041 601000 9                  TNZ     CP_LIMIT

     2820    11082    3           BLK$ = BLK$ -> OUT$BLK.SUBLK$(2); /* POINT TO INCR BLOCK           */

  11082  9 007025   000005 236100                    LDQ     5,,PR0
         9 007026   002700 756000 2                  STQ     BLK$

     2821    11083    3           CALL VEX$BUILD_SEQNUM(CP_DFLT_INCR,BLK$ -> OUT$BLK.SUBLK$(0))

  11083  9 007027   000003 036003                    ADLQ    3,DU
         9 007030   000233 235000 10                 LDA     155
         9 007031   200414 757100                    STAQ    IN_SLASH+1,,AUTO
         9 007032   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007034   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 007035   007131 702000 9                  TSX2    CHECK_CP_ALT

     2822    11084    3              ALTRET (CHECK_CP_ALT);
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:367  
     2823    11085    3           CP_DFLT_INCR = CP_DFLT_INCR - Y003;

  11085  9 007036   002607 236000 2                  LDQ     CP_DFLT_INCR
         9 007037   000414 136000 1                  SBLQ    Y003
         9 007040   002607 756000 2                  STQ     CP_DFLT_INCR

     2824    11086    3           END;

     2825    11087        /**/
     2826    11088    2   CP_LIMIT:
     2827    11089    3        IF (CMD_CODE = CPCMD) THEN DO;

  11089  9 007041   002625 235000 2     CP_LIMIT     LDA     CMD_CODE
         9 007042   000114 115007                    CMPA    76,DL
         9 007043   007075 601000 9                  TNZ     s:11098

     2828    11090    3           CALL VEX$READ_RANDOM(CP_SEQNUM) ALTRET(CHECK_CP_ALT);

  11090  9 007044   000234 630400 10                 EPPR0   156
         9 007045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 007046   000000 701000 xent               TSX1    VEX$READ_RANDOM
         9 007047   007131 702000 9                  TSX2    CHECK_CP_ALT

     2829    11091    4           IF (~FLAGS.EXISTS) THEN DO;

  11091  9 007050   002706 236000 2                  LDQ     FLAGS
         9 007051   000004 736000                    QLS     4
         9 007052   400000 376003                    ANQ     -131072,DU
         9 007053   400000 676003                    ERQ     -131072,DU
         9 007054   007066 600000 9                  TZE     s:11095

     2830    11092    4              CALL VEX$READ_SEQUEN ALTRET(CHECK_CP_ALT);

  11092  9 007055   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007056   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         9 007057   007131 702000 9                  TSX2    CHECK_CP_ALT

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:368  
     2831    11093    4              IF (FLAGS.EOF) THEN LAST_KEY = MAX_SEQNUM + 1;

  11093  9 007060   002706 236000 2                  LDQ     FLAGS
         9 007061   010000 316003                    CANQ    4096,DU
         9 007062   007066 600000 9                  TZE     s:11095

  11093  9 007063   000412 235000 1                  LDA     MAX_SEQNUM
         9 007064   000001 035007                    ADLA    1,DL
         9 007065   002613 755000 2                  STA     LAST_KEY

     2832    11094    4              END;

     2833    11095    3           CP_LIMIT_SEQNUM = LAST_KEY;

  11095  9 007066   002613 235000 2                  LDA     LAST_KEY
         9 007067   002606 755000 2                  STA     CP_LIMIT_SEQNUM

     2834    11096    3           CALL VEX$READ_RANDOM(LO_SEQNUM) ALTRET(CHECK_CP_ALT);

  11096  9 007070   000127 630400 10                 EPPR0   87
         9 007071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 007072   000000 701000 xent               TSX1    VEX$READ_RANDOM
         9 007073   007131 702000 9                  TSX2    CHECK_CP_ALT

     2835    11097    3           END;

  11097  9 007074   007100 710000 9                  TRA     s:11100

     2836    11098    2        ELSE CP_LIMIT_SEQNUM = MAX_SEQNUM + 1;

  11098  9 007075   000412 236000 1                  LDQ     MAX_SEQNUM
         9 007076   000001 036007                    ADLQ    1,DL
         9 007077   002606 756000 2                  STQ     CP_LIMIT_SEQNUM

     2837    11099        /**/
     2838    11100    2        CP_SEQNUM = CP_SEQNUM - CP_DFLT_INCR; /* SET FOR FIRST WRITE          */

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:369  
  11100  9 007100   002605 236000 2                  LDQ     CP_SEQNUM
         9 007101   002607 136000 2                  SBLQ    CP_DFLT_INCR
         9 007102   002605 756000 2                  STQ     CP_SEQNUM

     2839    11101    2        IF ((BLK$->OUT$BLK.CODE = CPCMD) OR (BLK$->OUT$BLK.CODE = CICMD)) AND (BLK$->
             11101                 OUT$BLK.NSUBLKS = 1)

  11101  9 007103   002700 470400 2                  LDP0    BLK$
         9 007104   000000 720100                    LXL0    0,,PR0
         9 007105   000114 100003                    CMPX0   76,DU
         9 007106   007111 600000 9                  TZE     s:11101+6
         9 007107   000115 100003                    CMPX0   77,DU
         9 007110   007117 601000 9                  TNZ     s:11103
         9 007111   000001 221100                    LDX1    1,,PR0
         9 007112   000001 101003                    CMPX1   1,DU
         9 007113   007117 601000 9                  TNZ     s:11103

     2840    11102    2        THEN CMD$->CP_CMD_TBL.SEQNUM = 0 ;

  11102  9 007114   002657 471400 2                  LDP1    CMD$
         9 007115   100001 450100                    STZ     1,,PR1
         9 007116   007121 710000 9                  TRA     s:11104

     2841    11103    2        ELSE CMD$->CP_CMD_TBL.SEQNUM = CP_SEQNUM ;

  11103  9 007117   002657 471400 2                  LDP1    CMD$
         9 007120   100001 756100                    STQ     1,,PR1

     2842    11104    2        CMD$->CP_CMD_TBL.INCR = CP_DFLT_INCR ;

  11104  9 007121   002657 470400 2                  LDP0    CMD$
         9 007122   002607 235000 2                  LDA     CP_DFLT_INCR
         9 007123   000003 755100                    STA     3,,PR0

     2843    11105    2        CMD$->CP_CMD_TBL.LIMIT_SEQNUM = CP_LIMIT_SEQNUM ;

  11105  9 007124   002657 470400 2                  LDP0    CMD$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:370  
         9 007125   002606 235000 2                  LDA     CP_LIMIT_SEQNUM
         9 007126   000002 755100                    STA     2,,PR0

     2844    11106    2        RETURN;

  11106  9 007127   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007130   000001 702211                    TSX2  ! 1,X1

     2845    11107        /**/
     2846    11108    2   CHECK_CP_ALT:
     2847    11109    2        ALTRETURN;

  11109  9 007131   200410 221300       CHECK_CP_ALT LDX1  ! STR_FLGS,,AUTO
         9 007132   000000 702211                    TSX2  ! 0,X1

     2848    11110    2   END;
     2849    11111        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:371  
     2850    11112        /**/
     2851    11113    1   CHECK_D: PROC ALTRET;                   /* D                                  */

  11113  9 007133   200410 741300       CHECK_D      STX1  ! STR_FLGS,,AUTO

     2852    11114        /**/
     2853    11115    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11115  9 007134   002706 236000 2                  LDQ     FLAGS
         9 007135   400000 376003                    ANQ     -131072,DU
         9 007136   400000 676003                    ERQ     -131072,DU
         9 007137   007146 600000 9                  TZE     s:11125

     2854    11116    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11116  9 007140   000170 630400 10                 EPPR0   120
         9 007141   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007142   000000 701000 xent               TSX1    VEX$ERROR
         9 007143   000000 011000                    NOP     0

     2855    11117        /**/
     2856    11118        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2857    11119                 DESCRIPTION: A record oriented command has been received
     2858    11120                           without a file open to edit.
     2859    11121        */
     2860    11122    3           ALTRETURN;

  11122  9 007144   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007145   000000 702211                    TSX2  ! 0,X1

     2861    11123    3           END;
     2862    11124        /**/
     2863    11125    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> D_CMD_TBL);

  11125  9 007146   002657 470400 2                  LDP0    CMD$
         9 007147   003000 236007                    LDQ     1536,DL
         9 007150   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:372  

     2864    11126    2        FLAGS.INTRA_CMD = TRUE;

  11126  9 007151   200000 236003                    LDQ     65536,DU
         9 007152   002706 256000 2                  ORSQ    FLAGS

     2865    11127    2        FLAGS.STRCHGCMD = TRUE;

  11127  9 007153   020000 236007                    LDQ     8192,DL
         9 007154   002706 256000 2                  ORSQ    FLAGS

     2866    11128        /**/
     2867    11129    2        P$ = PINCRW(CMD$,1);

  11129  9 007155   002657 236000 2                  LDQ     CMD$
         9 007156   000001 036003                    ADLQ    1,DU
         9 007157   002650 756000 2                  STQ     P$

     2868    11130    2       CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK) ALTRET (CHECK_D_ALT);

  11130  9 007160   000003 236000 10                 LDQ     3
         9 007161   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 007162   000227 236000 10                 LDQ     151
         9 007163   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007164   002700 236000 2                  LDQ     BLK$
         9 007165   000003 036003                    ADLQ    3,DU
         9 007166   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007167   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007170   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007171   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 007172   007175 702000 9                  TSX2    CHECK_D_ALT

     2869    11131    2        RETURN;

  11131  9 007173   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007174   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:373  
     2870    11132        /**/
     2871    11133    2   CHECK_D_ALT:
     2872    11134    2        ALTRETURN;

  11134  9 007175   200410 221300       CHECK_D_ALT  LDX1  ! STR_FLGS,,AUTO
         9 007176   000000 702211                    TSX2  ! 0,X1

     2873    11135    2   END;
     2874    11136        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:374  
     2875    11137        /**/
     2876    11138    1   CHECK_E: PROC ALTRET;                   /* E,O,F,P                            */

  11138  9 007177   200410 741300       CHECK_E      STX1  ! STR_FLGS,,AUTO

     2877    11139        /**/
     2878    11140    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11140  9 007200   002706 236000 2                  LDQ     FLAGS
         9 007201   400000 376003                    ANQ     -131072,DU
         9 007202   400000 676003                    ERQ     -131072,DU
         9 007203   007212 600000 9                  TZE     s:11150

     2879    11141    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11141  9 007204   000170 630400 10                 EPPR0   120
         9 007205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007206   000000 701000 xent               TSX1    VEX$ERROR
         9 007207   000000 011000                    NOP     0

     2880    11142        /**/
     2881    11143        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2882    11144                 DESCRIPTION: A record oriented command has been received
     2883    11145                           without a file open to edit.
     2884    11146        */
     2885    11147    3           ALTRETURN;

  11147  9 007210   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007211   000000 702211                    TSX2  ! 0,X1

     2886    11148    3           END;
     2887    11149        /**/
     2888    11150    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);

  11150  9 007212   002657 470400 2                  LDP0    CMD$
         9 007213   005000 236007                    LDQ     2560,DL
         9 007214   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:375  

     2889    11151    2        FLAGS.INTRA_CMD = TRUE;

  11151  9 007215   200000 236003                    LDQ     65536,DU
         9 007216   002706 256000 2                  ORSQ    FLAGS

     2890    11152    2        FLAGS.STRCHGCMD = TRUE;

  11152  9 007217   020000 236007                    LDQ     8192,DL
         9 007220   002706 256000 2                  ORSQ    FLAGS

     2891    11153        /**/
     2892    11154    2        P$ = PINCRW(CMD$,1);

  11154  9 007221   002657 236000 2                  LDQ     CMD$
         9 007222   000001 036003                    ADLQ    1,DU
         9 007223   002650 756000 2                  STQ     P$

     2893    11155    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK)

  11155  9 007224   000003 236000 10                 LDQ     3
         9 007225   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 007226   000227 236000 10                 LDQ     151
         9 007227   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007230   002700 236000 2                  LDQ     BLK$
         9 007231   000003 036003                    ADLQ    3,DU
         9 007232   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007233   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007234   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007235   000000 701000 xent               TSX1    VEX$PARSE_CLMNSTRING
         9 007236   007255 702000 9                  TSX2    CHECK_E_ALT

     2894    11156    2           ALTRET (CHECK_E_ALT);
     2895    11157        /**/
     2896    11158    2        P$ = PINCRW(P$,2);

  11158  9 007237   002650 236000 2                  LDQ     P$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:376  
         9 007240   000002 036003                    ADLQ    2,DU
         9 007241   002650 756000 2                  STQ     P$

     2897    11159    2        CALL VEX$PARSE_STRING (BLK$ -> OUT$BLK.SUBLK$(2),P$)

  11159  9 007242   000227 236000 10                 LDQ     151
         9 007243   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007244   002700 236000 2                  LDQ     BLK$
         9 007245   000005 036003                    ADLQ    5,DU
         9 007246   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007247   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007250   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007251   000000 701000 xent               TSX1    VEX$PARSE_STRING
         9 007252   007255 702000 9                  TSX2    CHECK_E_ALT

     2898    11160    2           ALTRET (CHECK_E_ALT);           /*SBLK->STRINGBLK->SLSTRINGBLK        */
     2899    11161    2        RETURN;

  11161  9 007253   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007254   000001 702211                    TSX2  ! 1,X1

     2900    11162        /**/
     2901    11163    2   CHECK_E_ALT:
     2902    11164    2        ALTRETURN;

  11164  9 007255   200410 221300       CHECK_E_ALT  LDX1  ! STR_FLGS,,AUTO
         9 007256   000000 702211                    TSX2  ! 0,X1

     2903    11165    2   END;
     2904    11166        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:377  
     2905    11167        /**/
     2906    11168    1   CHECK_IF: PROC ALTRET;                  /* IF,EL                              */

  11168  9 007257   200410 741300       CHECK_IF     STX1  ! STR_FLGS,,AUTO

     2907    11169        /**/
     2908    11170    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11170  9 007260   002706 236000 2                  LDQ     FLAGS
         9 007261   400000 376003                    ANQ     -131072,DU
         9 007262   400000 676003                    ERQ     -131072,DU
         9 007263   007272 600000 9                  TZE     s:11180

     2909    11171    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11171  9 007264   000170 630400 10                 EPPR0   120
         9 007265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007266   000000 701000 xent               TSX1    VEX$ERROR
         9 007267   000000 011000                    NOP     0

     2910    11172    3           ALTRETURN;

  11172  9 007270   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007271   000000 702211                    TSX2  ! 0,X1

     2911    11173    3           END;
     2912    11174        /**/
     2913    11175        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2914    11176                 DESCRIPTION: A record oriented command was received
     2915    11177                           without a file open.
     2916    11178        */
     2917    11179        /**/
     2918    11180    2        IF_LEVEL = 0;

  11180  9 007272   002636 450000 2                  STZ     IF_LEVEL

     2919    11181    2        CMD$ -> IF_CMD_TBL.LO_CLMN = 0;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:378  

  11181  9 007273   002657 470400 2                  LDP0    CMD$
         9 007274   000001 450100                    STZ     1,,PR0

     2920    11182    2        CMD$ -> IF_CMD_TBL.HI_CLMN = MAX_CLMN-1;

  11182  9 007275   002657 470400 2                  LDP0    CMD$
         9 007276   000413 235000 1                  LDA     MAX_CLMN
         9 007277   000001 135007                    SBLA    1,DL
         9 007300   000002 755100                    STA     2,,PR0

     2921    11183    2        IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(0)) >= CMD_END$

  11183  9 007301   002657 236000 2                  LDQ     CMD$
         9 007302   000004 036003                    ADLQ    4,DU
         9 007303   002661 116000 2                  CMPQ    CMD_END$
         9 007304   007572 603000 9                  TRC     NO_MORE_SPACE

     2922    11184    2        THEN GOTO NO_MORE_SPACE ;
     2923    11185    2        CMD$ -> IF_CMD_TBL.SSE.PTR$(0) = ADDR(NIL);

  11185  9 007305   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007306   002657 470400 2                  LDP0    CMD$
         9 007307   000004 756100                    STQ     4,,PR0

     2924    11186        /**/
     2925    11187    2        IF (BLK$ -> OUT$BLK.NSUBLKS = 1) THEN GOTO CHECK_IF_RET;

  11187  9 007310   002700 470400 2                  LDP0    BLK$
         9 007311   000001 220100                    LDX0    1,,PR0
         9 007312   000001 100003                    CMPX0   1,DU
         9 007313   007556 600000 9                  TZE     CHECK_IF_RET

     2926    11188        /**/
     2927    11189    2        BLK$ = BLK$ -> OUT$BLK.SUBLK$(1);

  11189  9 007314   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:379  
         9 007315   002700 756000 2                  STQ     BLK$

     2928    11190    3        IF (BLK$ -> OUT$BLK.CODE = PC_SSE) THEN DO;

  11190  9 007316   002700 470400 2                  LDP0    BLK$
         9 007317   000000 720100                    LXL0    0,,PR0
         9 007320   000154 100003                    CMPX0   108,DU
         9 007321   007542 601000 9                  TNZ     s:11231

     2929    11191    3           I = 0;

  11191  9 007322   002640 450000 2                  STZ     I

     2930    11192    3           CMD$ -> IF_CMD_TBL.SSE.FLAGS(IF_LEVEL) = FALSE;

  11192  9 007323   002636 235000 2                  LDA     IF_LEVEL
         9 007324   000001 735000                    ALS     1
         9 007325   000000 220003                    LDX0    0,DU
         9 007326   002657 471400 2                  LDP1    CMD$
         9 007327   100003 740105                    STX0    3,AL,PR1

     2931    11193    3           CMD$ -> IF_CMD_TBL.SSE.FLAGS.ORFLAG(IF_LEVEL) = TRUE; /* FIRST OP. IS OR */

  11193  9 007330   002636 235000 2                  LDA     IF_LEVEL
         9 007331   000001 735000                    ALS     1
         9 007332   002657 470400 2                  LDP0    CMD$
         9 007333   040000 236003                    LDQ     16384,DU
         9 007334   000003 256105                    ORSQ    3,AL,PR0

     2932    11194    4           IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_NOT) THEN DO;

  11194  9 007335   002700 470400 2                  LDP0    BLK$
         9 007336   000003 471500                    LDP1    3,,PR0
         9 007337   100000 721100                    LXL1    0,,PR1
         9 007340   000155 101003                    CMPX1   109,DU
         9 007341   007352 601000 9                  TNZ     s:11198

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:380  
     2933    11195    4              CMD$ -> IF_CMD_TBL.SSE.FLAGS.NOTFLAG(IF_LEVEL) = TRUE;

  11195  9 007342   002636 235000 2                  LDA     IF_LEVEL
         9 007343   000001 735000                    ALS     1
         9 007344   002657 473400 2                  LDP3    CMD$
         9 007345   200000 236003                    LDQ     65536,DU
         9 007346   300003 256105                    ORSQ    3,AL,PR3

     2934    11196    4              I = I+1;

  11196  9 007347   002640 235000 2                  LDA     I
         9 007350   000001 035007                    ADLA    1,DL
         9 007351   002640 755000 2                  STA     I

     2935    11197    4              END;

     2936    11198    3           CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),ADDR(CMD$ ->

  11198  9 007352   002636 236000 2                  LDQ     IF_LEVEL
         9 007353   000023 736000                    QLS     19
         9 007354   000003 036003                    ADLQ    3,DU
         9 007355   002657 036000 2                  ADLQ    CMD$
         9 007356   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007357   000017 236000 10                 LDQ     15
         9 007360   200417 756100                    STQ     IN_SLASH+4,,AUTO
         9 007361   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007362   200416 450500                    STP0    IN_SLASH+3,,AUTO
         9 007363   002640 236000 2                  LDQ     I
         9 007364   000022 736000                    QLS     18
         9 007365   000003 036003                    ADLQ    3,DU
         9 007366   002700 036000 2                  ADLQ    BLK$
         9 007367   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007370   200415 630500                    EPPR0   IN_SLASH+2,,AUTO
         9 007371   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007372   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 007373   007570 702000 9                  TSX2    CHECK_IF_ALT

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:381  
     2937    11199    3              IF_CMD_TBL.SSE(IF_LEVEL)),J0NOTOK) ALTRET (CHECK_IF_ALT);
     2938    11200        /**/
     2939    11201    4           DO WHILE (BLK$ -> OUT$BLK.NSUBLKS > I+1); /* PROCESS ALL STRINGS   */

  11201  9 007374   007507 710000 9                  TRA     s:11221

     2940    11202    4              IF_LEVEL = IF_LEVEL + 1;

  11202  9 007375   002636 235000 2                  LDA     IF_LEVEL
         9 007376   000001 035007                    ADLA    1,DL
         9 007377   002636 755000 2                  STA     IF_LEVEL

     2941    11203    4              CMD$ -> IF_CMD_TBL.SSE.FLAGS(IF_LEVEL) = FALSE;

  11203  9 007400   000001 735000                    ALS     1
         9 007401   000000 220003                    LDX0    0,DU
         9 007402   002657 470400 2                  LDP0    CMD$
         9 007403   000003 740105                    STX0    3,AL,PR0

     2942    11204    4              BLK$ = BLK$ -> OUT$BLK.SUBLK$(I+1);

  11204  9 007404   002700 470400 2                  LDP0    BLK$
         9 007405   002640 721000 2                  LXL1    I
         9 007406   000004 236111                    LDQ     4,X1,PR0
         9 007407   002700 756000 2                  STQ     BLK$

     2943    11205    4              I = 1;

  11205  9 007410   000001 235007                    LDA     1,DL
         9 007411   002640 755000 2                  STA     I

     2944    11206    4              IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_AND)

  11206  9 007412   002700 470400 2                  LDP0    BLK$
         9 007413   000003 471500                    LDP1    3,,PR0
         9 007414   100000 721100                    LXL1    0,,PR1
         9 007415   000161 101003                    CMPX1   113,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:382  
         9 007416   007425 601000 9                  TNZ     s:11208

     2945    11207    4              THEN CMD$ -> IF_CMD_TBL.SSE.FLAGS.ANDFLAG(IF_LEVEL) = TRUE;

  11207  9 007417   002636 235000 2                  LDA     IF_LEVEL
         9 007420   000001 735000                    ALS     1
         9 007421   002657 473400 2                  LDP3    CMD$
         9 007422   100000 236003                    LDQ     32768,DU
         9 007423   300003 256105                    ORSQ    3,AL,PR3
         9 007424   007442 710000 9                  TRA     s:11212

     2946    11208    4              ELSE IF (BLK$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = PC_OR)

  11208  9 007425   000162 101003                    CMPX1   114,DU
         9 007426   007435 601000 9                  TNZ     s:11210

     2947    11209    4                 THEN CMD$ -> IF_CMD_TBL.SSE.FLAGS.ORFLAG(IF_LEVEL) = TRUE;

  11209  9 007427   002636 235000 2                  LDA     IF_LEVEL
         9 007430   000001 735000                    ALS     1
         9 007431   002657 473400 2                  LDP3    CMD$
         9 007432   040000 236003                    LDQ     16384,DU
         9 007433   300003 256105                    ORSQ    3,AL,PR3
         9 007434   007442 710000 9                  TRA     s:11212

     2948    11210    4                 ELSE CMD$ -> IF_CMD_TBL.SSE.FLAGS.EORFLAG(IF_LEVEL) = TRUE;

  11210  9 007435   002636 235000 2                  LDA     IF_LEVEL
         9 007436   000001 735000                    ALS     1
         9 007437   002657 473400 2                  LDP3    CMD$
         9 007440   020000 236003                    LDQ     8192,DU
         9 007441   300003 256105                    ORSQ    3,AL,PR3

     2949    11211        /**/
     2950    11212    5              IF (BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$BLK.CODE = PC_NOT) THEN DO;

  11212  9 007442   002700 470400 2                  LDP0    BLK$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:383  
         9 007443   000004 471500                    LDP1    4,,PR0
         9 007444   100000 721100                    LXL1    0,,PR1
         9 007445   000155 101003                    CMPX1   109,DU
         9 007446   007457 601000 9                  TNZ     s:11217

     2951    11213    5                 CMD$ -> IF_CMD_TBL.SSE.FLAGS.NOTFLAG(IF_LEVEL) = TRUE;

  11213  9 007447   002636 235000 2                  LDA     IF_LEVEL
         9 007450   000001 735000                    ALS     1
         9 007451   002657 473400 2                  LDP3    CMD$
         9 007452   200000 236003                    LDQ     65536,DU
         9 007453   300003 256105                    ORSQ    3,AL,PR3

     2952    11214    5                 I = I+1;

  11214  9 007454   002640 235000 2                  LDA     I
         9 007455   000001 035007                    ADLA    1,DL
         9 007456   002640 755000 2                  STA     I

     2953    11215    5                 END;

     2954    11216        /**/
     2955    11217    4              IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL)) >= CMD_END$

  11217  9 007457   002636 236000 2                  LDQ     IF_LEVEL
         9 007460   000023 736000                    QLS     19
         9 007461   000004 036003                    ADLQ    4,DU
         9 007462   002657 036000 2                  ADLQ    CMD$
         9 007463   002661 116000 2                  CMPQ    CMD_END$
         9 007464   007572 603000 9                  TRC     NO_MORE_SPACE

     2956    11218    4              THEN GOTO NO_MORE_SPACE ;
     2957    11219    4              CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(I),ADDR(CMD$ ->

  11219  9 007465   002636 236000 2                  LDQ     IF_LEVEL
         9 007466   000023 736000                    QLS     19
         9 007467   000003 036003                    ADLQ    3,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:384  
         9 007470   002657 036000 2                  ADLQ    CMD$
         9 007471   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007472   000017 236000 10                 LDQ     15
         9 007473   200417 756100                    STQ     IN_SLASH+4,,AUTO
         9 007474   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007475   200416 450500                    STP0    IN_SLASH+3,,AUTO
         9 007476   002640 236000 2                  LDQ     I
         9 007477   000022 736000                    QLS     18
         9 007500   000003 036003                    ADLQ    3,DU
         9 007501   002700 036000 2                  ADLQ    BLK$
         9 007502   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007503   200415 630500                    EPPR0   IN_SLASH+2,,AUTO
         9 007504   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007505   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 007506   007570 702000 9                  TSX2    CHECK_IF_ALT

     2958    11220    4                 IF_CMD_TBL.SSE(IF_LEVEL)),J0NOTOK) ALTRET(CHECK_IF_ALT);
     2959    11221    4              END;

  11221  9 007507   002700 470400 2                  LDP0    BLK$
         9 007510   000001 236100                    LDQ     1,,PR0
         9 007511   000022 772000                    QRL     18
         9 007512   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007513   002640 236000 2                  LDQ     I
         9 007514   000001 036007                    ADLQ    1,DL
         9 007515   200414 116100                    CMPQ    IN_SLASH+1,,AUTO
         9 007516   007375 602000 9                  TNC     s:11202

     2960    11222        /**/
     2961    11223    3           IF_LEVEL = IF_LEVEL + 1;

  11223  9 007517   002636 235000 2                  LDA     IF_LEVEL
         9 007520   000001 035007                    ADLA    1,DL
         9 007521   002636 755000 2                  STA     IF_LEVEL

     2962    11224    3           IF ADDR(CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL)) >= CMD_END$

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:385  
  11224  9 007522   002636 236000 2                  LDQ     IF_LEVEL
         9 007523   000023 736000                    QLS     19
         9 007524   000004 036003                    ADLQ    4,DU
         9 007525   002657 036000 2                  ADLQ    CMD$
         9 007526   002661 116000 2                  CMPQ    CMD_END$
         9 007527   007572 603000 9                  TRC     NO_MORE_SPACE

     2963    11225    3           THEN GOTO NO_MORE_SPACE ;
     2964    11226    3           CMD$ -> IF_CMD_TBL.SSE.PTR$(IF_LEVEL) = ADDR(NIL);

  11226  9 007530   000001 735000                    ALS     1
         9 007531   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007532   002657 471400 2                  LDP1    CMD$
         9 007533   100004 756105                    STQ     4,AL,PR1

     2965    11227    3           IF (P_PCB.OUT$ -> OUT$BLK.NSUBLKS = 2) THEN GOTO CHECK_IF_RET;
             11227                    /* NO COLUMN RANGE GIVEN */

  11227  9 007534   002733 470400 2                  LDP0    P_PCB+3
         9 007535   000001 220100                    LDX0    1,,PR0
         9 007536   000002 100003                    CMPX0   2,DU
         9 007537   007556 600000 9                  TZE     CHECK_IF_RET

     2966    11228    3           BLK$ = P_PCB.OUT$ -> OUT$BLK.SUBLK$(2);

  11228  9 007540   000005 236100                    LDQ     5,,PR0
         9 007541   002700 756000 2                  STQ     BLK$

     2967    11229    3           END;

     2968    11230        /**/
     2969    11231    2        CALL VEX$PARSE_CLMNRANGE (CMD$ -> IF_CMD_TBL.LO_CLMN,

  11231  9 007542   000152 236000 10                 LDQ     106
         9 007543   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 007544   002657 236000 2                  LDQ     CMD$
         9 007545   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:386  
         9 007546   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007547   002657 236000 2                  LDQ     CMD$
         9 007550   000001 036003                    ADLQ    1,DU
         9 007551   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007552   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007553   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007554   000000 701000 xent               TSX1    VEX$PARSE_CLMNRANGE
         9 007555   007570 702000 9                  TSX2    CHECK_IF_ALT

     2970    11232    2           CMD$ -> IF_CMD_TBL.HI_CLMN,BLK$) ALTRET (CHECK_IF_ALT);
     2971    11233        /**/
     2972    11234    2   CHECK_IF_RET:
     2973    11235    2        FLAGS.INTRA_CMD = TRUE;

  11235  9 007556   200000 236003       CHECK_IF_RET LDQ     65536,DU
         9 007557   002706 256000 2                  ORSQ    FLAGS

     2974    11236    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(IF_CMD_TBL) +

  11236  9 007560   002657 470400 2                  LDP0    CMD$
         9 007561   002636 236000 2                  LDQ     IF_LEVEL
         9 007562   000001 736000                    QLS     1
         9 007563   000005 036007                    ADLQ    5,DL
         9 007564   000011 736000                    QLS     9
         9 007565   000000 552110                    STBQ    0,'10'O,PR0

     2975    11237    2           (IF_LEVEL * SIZEW(IF_CMD_TBL.SSE));
     2976    11238    2        RETURN;

  11238  9 007566   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007567   000001 702211                    TSX2  ! 1,X1

     2977    11239        /**/
     2978    11240    2   CHECK_IF_ALT:
     2979    11241    2        ALTRETURN;

  11241  9 007570   200410 221300       CHECK_IF_ALT LDX1  ! STR_FLGS,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:387  
         9 007571   000000 702211                    TSX2  ! 0,X1

     2980    11242
     2981    11243    2   NO_MORE_SPACE:
     2982    11244    2        UNWIND TO CMD_SPACE_EXHAUSTED ;

  11244  9 007572   200404 237300       NO_MORE_SPA* LDAQ  ! CMD_SPACE_EXHAUSTED,,AUTO
         9 007573   000000 700200 xent               TSX0  ! X66_MAUNWIND
         9 007574   000000 000200                    ZERO    0,128

     2983    11245    2   END;
     2984    11246        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:388  
     2985    11247        /**/
     2986    11248    1   CHECK_JU: PROC ALTRET;                  /* JU                                 */

  11248  9 007575   200410 741300       CHECK_JU     STX1  ! STR_FLGS,,AUTO

     2987    11249        /**/
     2988    11250    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11250  9 007576   002706 236000 2                  LDQ     FLAGS
         9 007577   400000 376003                    ANQ     -131072,DU
         9 007600   400000 676003                    ERQ     -131072,DU
         9 007601   007610 600000 9                  TZE     s:11259

     2989    11251    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11251  9 007602   000170 630400 10                 EPPR0   120
         9 007603   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007604   000000 701000 xent               TSX1    VEX$ERROR
         9 007605   000000 011000                    NOP     0

     2990    11252        /**/
     2991    11253        /*E*     ERROR:    VEE-E$E_NOFILE-0
     2992    11254                 DESCRIPTION: A record oriented command has been received
     2993    11255                           without a file open to edit.
     2994    11256        */
     2995    11257    3           ALTRETURN;

  11257  9 007606   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007607   000000 702211                    TSX2  ! 0,X1

     2996    11258    3           END;
     2997    11259    3        IF (~FLAGS.STEP_MODE) THEN DO; /* Not in SET and STEP mode.           */

  11259  9 007610   002706 236000 2                  LDQ     FLAGS
         9 007611   000002 736000                    QLS     2
         9 007612   400000 376003                    ANQ     -131072,DU
         9 007613   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:389  
         9 007614   007623 600000 9                  TZE     s:11270

     2998    11260    3           CALL VEX$ERROR (E$E_BADJUCMD,3);

  11260  9 007615   000236 630400 10                 EPPR0   158
         9 007616   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007617   000000 701000 xent               TSX1    VEX$ERROR
         9 007620   000000 011000                    NOP     0

     2999    11261        /**/
     3000    11262        /*E*     ERROR:    VEE-E$E_BADJUCMD-0
     3001    11263                 MESSAGE:  JU illegal.
     3002    11264                 MESSAGE2: JU legal only in SET and STEP mode.
     3003    11265                 DESCRIPTION: JU legal only in set and step mode.
     3004    11266        */
     3005    11267    3           ALTRETURN;

  11267  9 007621   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007622   000000 702211                    TSX2  ! 0,X1

     3006    11268    3           END;
     3007    11269        /**/
     3008    11270    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> JU_CMD_TBL);

  11270  9 007623   002657 470400 2                  LDP0    CMD$
         9 007624   021000 236007                    LDQ     8704,DL
         9 007625   000000 552110                    STBQ    0,'10'O,PR0

     3009    11271    2        FLAGS.INTRA_CMD = TRUE;

  11271  9 007626   200000 236003                    LDQ     65536,DU
         9 007627   002706 256000 2                  ORSQ    FLAGS

     3010    11272    2        FLAGS.NOCOMPCMD = TRUE;            /* JU MUST BE LAST                    */

  11272  9 007630   000010 236003                    LDQ     8,DU
         9 007631   002706 256000 2                  ORSQ    FLAGS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:390  

     3011    11273        /**/
     3012    11274    2        CALL VEX$BUILD_SEQNUM(CMD$ -> JU_CMD_TBL.EDITKEY.SEQNUM,BLK$ ->

  11274  9 007632   002700 236000 2                  LDQ     BLK$
         9 007633   000004 036003                    ADLQ    4,DU
         9 007634   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007635   002657 236000 2                  LDQ     CMD$
         9 007636   000001 036003                    ADLQ    1,DU
         9 007637   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007640   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007641   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007642   000000 701000 xent               TSX1    VEX$BUILD_SEQNUM
         9 007643   007646 702000 9                  TSX2    CHECK_JU_ALT

     3013    11275    2           OUT$BLK.SUBLK$(1)) ALTRET (CHECK_JU_ALT) ;
     3014    11276    2        RETURN;

  11276  9 007644   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007645   000001 702211                    TSX2  ! 1,X1

     3015    11277        /**/
     3016    11278    2   CHECK_JU_ALT:
     3017    11279    2        ALTRETURN;

  11279  9 007646   200410 221300       CHECK_JU_ALT LDX1  ! STR_FLGS,,AUTO
         9 007647   000000 702211                    TSX2  ! 0,X1

     3018    11280    2   END;
     3019    11281        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:391  
     3020    11282        /**/
     3021    11283    1   CHECK_R: PROC ALTRET;                   /* R,L                                */

  11283  9 007650   200410 741300       CHECK_R      STX1  ! STR_FLGS,,AUTO

     3022    11284        /**/
     3023    11285    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11285  9 007651   002706 236000 2                  LDQ     FLAGS
         9 007652   400000 376003                    ANQ     -131072,DU
         9 007653   400000 676003                    ERQ     -131072,DU
         9 007654   007663 600000 9                  TZE     s:11295

     3024    11286    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11286  9 007655   000170 630400 10                 EPPR0   120
         9 007656   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007657   000000 701000 xent               TSX1    VEX$ERROR
         9 007660   000000 011000                    NOP     0

     3025    11287        /**/
     3026    11288        /*E*     ERROR:    VEE-E$E_NOFILE-0
     3027    11289                 DESCRIPTION: A record oriented command has been received
     3028    11290                           without a file open to edit.
     3029    11291        */
     3030    11292    3           ALTRETURN;

  11292  9 007661   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007662   000000 702211                    TSX2  ! 0,X1

     3031    11293    3           END;
     3032    11294        /**/
     3033    11295    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> RL_CMD_TBL);

  11295  9 007663   002657 470400 2                  LDP0    CMD$
         9 007664   004000 236007                    LDQ     2048,DL
         9 007665   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:392  

     3034    11296    2        FLAGS.INTRA_CMD = TRUE;

  11296  9 007666   200000 236003                    LDQ     65536,DU
         9 007667   002706 256000 2                  ORSQ    FLAGS

     3035    11297    2        FLAGS.STRCHGCMD = TRUE;

  11297  9 007670   020000 236007                    LDQ     8192,DL
         9 007671   002706 256000 2                  ORSQ    FLAGS

     3036    11298        /**/
     3037    11299    2        P$ = PINCRW(CMD$,1);

  11299  9 007672   002657 236000 2                  LDQ     CMD$
         9 007673   000001 036003                    ADLQ    1,DU
         9 007674   002650 756000 2                  STQ     P$

     3038    11300    2        CALL VEX$PARSE_CLMNSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0NOTOK)

  11300  9 007675   000017 236000 10                 LDQ     15
         9 007676   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 007677   000227 236000 10                 LDQ     151
         9 007700   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007701   002700 236000 2                  LDQ     BLK$
         9 007702   000003 036003                    ADLQ    3,DU
         9 007703   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 007704   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 007705   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007706   000000 701000 xent               TSX1    VEX$PARSE_CLMNSTRING
         9 007707   007742 702000 9                  TSX2    CHECK_R_ALT

     3039    11301    2           ALTRET (CHECK_R_ALT);
     3040    11302        /**/
     3041    11303    2       STR_BUF.COUNT = BLK$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) -> STR$BUF.COUNT
             11303                 ;

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:393  
  11303  9 007710   002700 470400 2                  LDP0    BLK$
         9 007711   000005 471500                    LDP1    5,,PR0
         9 007712   100003 473500                    LDP3    3,,PR1
         9 007713   300000 236100                    LDQ     0,,PR3
         9 007714   000033 772000                    QRL     27
         9 007715   000000 620006                    EAX0    0,QL
         9 007716   002122 740000 2                  STX0    STR_BUF

     3042    11304    2        STR_BUF.TEXT = BLK$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) -> STR$BUF.TEXT;

  11304  9 007717   000005 471500                    LDP1    5,,PR0
         9 007720   100003 473500                    LDP3    3,,PR1
         9 007721   040000 100500                    MLR     fill='040'O
         9 007722   300000 200377                    ADSC9   0,,PR3                   cn=1,n=255
         9 007723   002122 402000 2                  ADSC9   STR_BUF                  cn=2,n=1024

     3043    11305    2        CALL CHARBIN (CMD$ -> RL_CMD_TBL.SHIFT#,SUBSTR(STR_BUF.TEXT,0,

  11305  9 007724   000100 305440                    DTB
         9 007725   002122 430010 2                  NDSC9   STR_BUF                  cn=2,s=nosgn,sf=0,n=*X0
         9 007726   200414 000010                    NDSC9   IN_SLASH+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 007727   002657 471400 2                  LDP1    CMD$
         9 007730   200415 235100                    LDA     IN_SLASH+2,,AUTO
         9 007731   100003 755100                    STA     3,,PR1

     3044    11306    2           STR_BUF.COUNT));
     3045    11307    2        IF (CMD$ -> RL_CMD_TBL.SHIFT# > MAX_CLMN) THEN ALTRETURN;

  11307  9 007732   002657 470400 2                  LDP0    CMD$
         9 007733   000413 236000 1                  LDQ     MAX_CLMN
         9 007734   000003 116100                    CMPQ    3,,PR0
         9 007735   007740 603000 9                  TRC     s:11308

  11307  9 007736   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007737   000000 702211                    TSX2  ! 0,X1

     3046    11308    2        RETURN;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:394  

  11308  9 007740   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007741   000001 702211                    TSX2  ! 1,X1

     3047    11309        /**/
     3048    11310    2   CHECK_R_ALT:
     3049    11311    2        ALTRETURN;

  11311  9 007742   200410 221300       CHECK_R_ALT  LDX1  ! STR_FLGS,,AUTO
         9 007743   000000 702211                    TSX2  ! 0,X1

     3050    11312    2   END;
     3051    11313        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:395  
     3052    11314        /**/
     3053    11315    1   CHECK_S: PROC ALTRET;                   /* S                                  */

  11315  9 007744   200410 741300       CHECK_S      STX1  ! STR_FLGS,,AUTO

     3054    11316        /**/
     3055    11317    3        IF (~FLAGS.EDIT_MODE) THEN DO;     /* NO FILE OPEN                       */

  11317  9 007745   002706 236000 2                  LDQ     FLAGS
         9 007746   400000 376003                    ANQ     -131072,DU
         9 007747   400000 676003                    ERQ     -131072,DU
         9 007750   007757 600000 9                  TZE     s:11327

     3056    11318    3           CALL VEX$ERROR (E$E_NOFILE,3);

  11318  9 007751   000170 630400 10                 EPPR0   120
         9 007752   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007753   000000 701000 xent               TSX1    VEX$ERROR
         9 007754   000000 011000                    NOP     0

     3057    11319        /**/
     3058    11320        /*E*     ERROR:    VEE-E$E_NOFILE-0
     3059    11321                 DESCRIPTION: A record oriented command has been received
     3060    11322                           without a file open to edit.
     3061    11323        */
     3062    11324    3           ALTRETURN;

  11324  9 007755   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 007756   000000 702211                    TSX2  ! 0,X1

     3063    11325    3           END;
     3064    11326        /**/
     3065    11327    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> STR_CMD_TBL);

  11327  9 007757   002657 470400 2                  LDP0    CMD$
         9 007760   005000 236007                    LDQ     2560,DL
         9 007761   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:396  

     3066    11328    2        FLAGS.INTRA_CMD = TRUE;

  11328  9 007762   200000 236003                    LDQ     65536,DU
         9 007763   002706 256000 2                  ORSQ    FLAGS

     3067    11329    2        FLAGS.STRCHGCMD = TRUE;

  11329  9 007764   020000 236007                    LDQ     8192,DL
         9 007765   002706 256000 2                  ORSQ    FLAGS

     3068    11330        /**/
     3069    11331    2        P$ = PINCRW(CMD$,1);

  11331  9 007766   002657 236000 2                  LDQ     CMD$
         9 007767   000001 036003                    ADLQ    1,DU
         9 007770   002650 756000 2                  STQ     P$

     3070    11332    2        CALL VEX$PARSE_JSTRING(BLK$ -> OUT$BLK.SUBLK$(0),P$,J0OK)

  11332  9 007771   000003 236000 10                 LDQ     3
         9 007772   200416 756100                    STQ     IN_SLASH+3,,AUTO
         9 007773   000227 236000 10                 LDQ     151
         9 007774   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 007775   002700 236000 2                  LDQ     BLK$
         9 007776   000003 036003                    ADLQ    3,DU
         9 007777   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 010000   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 010001   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010002   000000 701000 xent               TSX1    VEX$PARSE_JSTRING
         9 010003   010022 702000 9                  TSX2    CHECK_S_ALT

     3071    11333    2           ALTRET (CHECK_S_ALT);
     3072    11334        /**/
     3073    11335    2        P$ = PINCRW(P$,2);

  11335  9 010004   002650 236000 2                  LDQ     P$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:397  
         9 010005   000002 036003                    ADLQ    2,DU
         9 010006   002650 756000 2                  STQ     P$

     3074    11336    2        CALL VEX$PARSE_STRING(BLK$ -> OUT$BLK.SUBLK$(2),P$)

  11336  9 010007   000227 236000 10                 LDQ     151
         9 010010   200415 756100                    STQ     IN_SLASH+2,,AUTO
         9 010011   002700 236000 2                  LDQ     BLK$
         9 010012   000005 036003                    ADLQ    5,DU
         9 010013   200414 756100                    STQ     IN_SLASH+1,,AUTO
         9 010014   200414 630500                    EPPR0   IN_SLASH+1,,AUTO
         9 010015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 010016   000000 701000 xent               TSX1    VEX$PARSE_STRING
         9 010017   010022 702000 9                  TSX2    CHECK_S_ALT

     3075    11337    2           ALTRET (CHECK_S_ALT);
     3076    11338    2        RETURN;

  11338  9 010020   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 010021   000001 702211                    TSX2  ! 1,X1

     3077    11339        /**/
     3078    11340    2   CHECK_S_ALT:
     3079    11341    2        ALTRETURN;

  11341  9 010022   200410 221300       CHECK_S_ALT  LDX1  ! STR_FLGS,,AUTO
         9 010023   000000 702211                    TSX2  ! 0,X1

     3080    11342    2   END;
     3081    11343        %EJECT;
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:398  
     3082    11344        /**/
     3083    11345    1   CHECK_DIR: PROC ALTRET ;                /* DIRECTORY                          */

  11345  9 010024   200410 741300       CHECK_DIR    STX1  ! STR_FLGS,,AUTO

     3084    11346    2        CMD$ -> CMD_CNTRLWD.OFFSET = SIZEW(CMD$ -> DIR_CMD_TBL) ;

  11346  9 010025   002657 470400 2                  LDP0    CMD$
         9 010026   006000 236007                    LDQ     3072,DL
         9 010027   000000 552110                    STBQ    0,'10'O,PR0

     3085    11347        /**/
     3086    11348    2        IF BLK$ -> OUT$BLK.NSUBLKS = 1     /* Just 'DIR'                         */

  11348  9 010030   002700 470400 2                  LDP0    BLK$
         9 010031   000001 220100                    LDX0    1,,PR0
         9 010032   000001 100003                    CMPX0   1,DU
         9 010033   010040 601000 9                  TNZ     s:11352

     3087    11349    2        THEN
     3088    11350    2           CMD$ -> DIR_CMD_TBL.CODE = DIRCMD ;

  11350  9 010034   000021 235007                    LDA     17,DL
         9 010035   002657 471400 2                  LDP1    CMD$
         9 010036   100001 755100                    STA     1,,PR1
         9 010037   010045 710000 9                  TRA     s:11354

     3089    11351    2        ELSE                               /* Set or reset                       */
     3090    11352    2           CMD$ -> DIR_CMD_TBL.CODE = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.CODE ;

  11352  9 010040   000004 471500                    LDP1    4,,PR0
         9 010041   100000 236100                    LDQ     0,,PR1
         9 010042   777777 376007                    ANQ     -1,DL
         9 010043   002657 473400 2                  LDP3    CMD$
         9 010044   300001 756100                    STQ     1,,PR3

     3091    11353        /**/
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:399  
     3092    11354    2        IF CMD$ -> DIR_CMD_TBL.CODE = PC_FID THEN /* Set DIR                  */

  11354  9 010045   002657 470400 2                  LDP0    CMD$
         9 010046   000001 235100                    LDA     1,,PR0
         9 010047   000022 115007                    CMPA    18,DL
         9 010050   010141 601000 9                  TNZ     s:11379

     3093    11355    3        DO ;

     3094    11356    3           DIR_BUF = BLK$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT ;

  11356  9 010051   002700 471400 2                  LDP1    BLK$
         9 010052   100004 473500                    LDP3    4,,PR1
         9 010053   300004 236100                    LDQ     4,,PR3
         9 010054   000033 772000                    QRL     27
         9 010055   000000 620006                    EAX0    0,QL
         9 010056   040000 100540                    MLR     fill='040'O
         9 010057   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         9 010060   003171 000041 2                  ADSC9   DIR_BUF                  cn=0,n=33

     3095    11357    3           CALL M$FID(FPT_FID) ALTRET( FID_ERR ) ;

  11357  9 010061   000352 630400 1                  EPPR0   FPT_FID
         9 010062   420001 713400                    CLIMB   alt,+8193
         9 010063   404400 401760                    pmme    nvectors=10
         9 010064   010143 702000 9                  TSX2    FID_ERR

     3096    11358    3           IF FID_RESULTS.NAME OR FID_RESULTS.PASS OR FID_RESULTS.WSN

  11358  9 010065   000224 234000 2                  SZN     FID_RESULTS
         9 010066   010113 604000 9                  TMI     s:11362
         9 010067   000224 236000 2                  LDQ     FID_RESULTS
         9 010070   100000 316003                    CANQ    32768,DU
         9 010071   010113 601000 9                  TNZ     s:11362
         9 010072   020000 316003                    CANQ    8192,DU
         9 010073   010113 601000 9                  TNZ     s:11362
         9 010074   000224 236000 2                  LDQ     FID_RESULTS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:400  
         9 010075   000001 736000                    QLS     1
         9 010076   400000 376003                    ANQ     -131072,DU
         9 010077   400000 676003                    ERQ     -131072,DU
         9 010100   010113 601000 9                  TNZ     s:11362
         9 010101   000216 237000 2                  LDAQ    DIR_ACCT
         9 010102   000240 117000 10                 CMPAQ   160
         9 010103   010113 600000 9                  TZE     s:11362
         9 010104   000220 235000 2                  LDA     DIR_SN
         9 010105   000001 115007                    CMPA    1,DL
         9 010106   010113 605400 9                  TPNZ    s:11362
         9 010107   003067 236000 2                  LDQ     ASN
         9 010110   777000 376003                    ANQ     -512,DU
         9 010111   001000 116003                    CMPQ    512,DU
         9 010112   010121 600000 9                  TZE     s:11372

     3097    11359    3              OR ~FID_RESULTS.ACCT OR DIR_ACCT.ACCT# = ' '
     3098    11360    3              OR DIR_SN.NUM# > 1 OR ASN ~= %FILE# THEN
     3099    11361    4           DO ;

     3100    11362    4              CALL VEX$ERROR(E$E_BADDIR,1) ;

  11362  9 010113   000243 630400 10                 EPPR0   163
         9 010114   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 010115   000000 701000 xent               TSX1    VEX$ERROR
         9 010116   000000 011000                    NOP     0

     3101    11363    4              ALTRETURN ;

  11363  9 010117   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 010120   000000 702211                    TSX2  ! 0,X1

     3102    11364    4              END ;                        /* THEN DO                            */
     3103    11365        /**/
     3104    11366        /*E*     ERROR:    VEE-E$E_BADDIR-0
     3105    11367                 MESSAGE:  Bad DIRECTORY specification.
     3106    11368                 MESSAGE1: DIRECTORY fid can only specify [DP#SN].ACCOUNT
     3107    11369                 DESCRIPTION: The user has input more than just [DP#SN].ACCOUNT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:401  
     3108    11370                              for the fid of the DIRECTORY command.
     3109    11371        */
     3110    11372    3           CMD$ -> DIR_CMD_TBL.ACCT = DIR_ACCT.ACCT# ;

  11372  9 010121   002657 470400 2                  LDP0    CMD$
         9 010122   000216 237000 2                  LDAQ    DIR_ACCT
         9 010123   000002 755100                    STA     2,,PR0
         9 010124   000003 756100                    STQ     3,,PR0

     3111    11373    3           IF FID_RESULTS.SN THEN          /* Change PSN.                        */

  11373  9 010125   000224 236000 2                  LDQ     FID_RESULTS
         9 010126   040000 316003                    CANQ    16384,DU
         9 010127   010135 600000 9                  TZE     s:11376

     3112    11374    3              CMD$ -> DIR_CMD_TBL.PSN = DIR_SN.SN#(0) ;

  11374  9 010130   002657 470400 2                  LDP0    CMD$
         9 010131   040100 100400                    MLR     fill='040'O
         9 010132   000221 000006 2                  ADSC9   DIR_SN+1                 cn=0,n=6
         9 010133   000004 000006                    ADSC9   4,,PR0                   cn=0,n=6
         9 010134   010141 710000 9                  TRA     s:11379

     3113    11375    3           ELSE
     3114    11376    3              CMD$ -> DIR_CMD_TBL.PSN = ' ' ;

  11376  9 010135   002657 470400 2                  LDP0    CMD$
         9 010136   040100 100400                    MLR     fill='040'O
         9 010137   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 010140   000004 000006                    ADSC9   4,,PR0                   cn=0,n=6

     3115    11377    3           END ;                           /* THEN DO                            */

     3116    11378        /**/
     3117    11379    2        RETURN ;

  11379  9 010141   200410 221300                    LDX1  ! STR_FLGS,,AUTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:402  
         9 010142   000001 702211                    TSX2  ! 1,X1

     3118    11380        /**/
     3119    11381    2   FID_ERR:
     3120    11382    2        CALL VEX$ERROR(E$E_BADFID,1) ;

  11382  9 010143   000246 630400 10    FID_ERR      EPPR0   166
         9 010144   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 010145   000000 701000 xent               TSX1    VEX$ERROR
         9 010146   000000 011000                    NOP     0

     3121    11383    2        ALTRETURN ;

  11383  9 010147   200410 221300                    LDX1  ! STR_FLGS,,AUTO
         9 010150   000000 702211                    TSX2  ! 0,X1
     3122    11384        /**/
     3123    11385    2   END     CHECK_DIR ;
     3124    11386    1   END;                                    /* END VEE$EDIT                       */

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:403  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEE$EDIT.
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:404  

 **** Variables and constants ****

  ****  Section 001 RoData VEE$EDIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   264-0-0/d STRC(1080)  r     1 CLOSE_FPT                417-0-0/c CHAR        r     1 EOT
   352-0-0/d STRC(864)   r     1 FPT_FID                    0-0-0/d STRC(216)   r     1 GDS_FPT
   402-0-0/d STRC(288)   r     1 GETDCB_FPT               322-0-0/d STRC(144)   r     1 INT_FPT
   413-0-0/w UBIN        r     1 MAX_CLMN                 412-0-0/w UBIN        r     1 MAX_SEQNUM
   416-0-0/c CHAR        r     1 NEWLINE                  426-0-0/b STRC        r     1 NEWLINE_CNTRLWD
   100-0-0/d STRC(2088)  r     1 OPEN_DO                    6-0-0/d STRC(2088)  r     1 OPEN_ME
   172-0-0/d STRC(2088)  r     1 OPEN_SIME_FPT            326-0-0/d STRC(576)   r     1 PCLLINK_FPT
   346-0-0/c STRC        r     1 PCLNAME                  425-0-0/w UBIN        r     1 SEQNUM_ONE
   422-0-0/c CHAR        r     1 SINGLE_AST               347-0-0/c STRC(72)    r     1 SYSACCT
   414-0-0/w UBIN        r     1 Y003

  ****  Section 002  Data  VEE$EDIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  3067-0-0/w UBIN(9)     r     1 ASN                     2700-0-0/w PTR         r     1 BLK$
  3066-0-0/w UBIN        r     1 BREAK_ARS                130-0-0/d STRC(1080)  r     1 CLOSE_SIREAD_FPT
     0-0-0/d STRC(1080)  r     1 CLOSE_TY_FPT            2657-0-0/w PTR         r     1 CMD$
  2662-0-0/w PTR         r     1 CMDBUF$                 2663-0-0/w PTR         r     1 CMDBUF_BASE$
  2664-0-0/w PTR         r     1 CMDBUF_END$             2660-0-0/w PTR         r     1 CMD_BASE$
  1250-0-0/w CHAR(256)   r     1 CMD_BUF                 2625-0-0/w UBIN        r     1 CMD_CODE
  2661-0-0/w PTR         r     1 CMD_END$                2624-0-0/w UBIN        r     1 CMD_INDEX
  2570-0-0/w UBIN        r     1 CMD_SIZE                2607-0-0/w UBIN        r     1 CP_DFLT_INCR
  2606-0-0/w UBIN        r     1 CP_LIMIT_SEQNUM         2610-0-0/w UBIN        r     1 CP_RECSMVED
  2605-0-0/w UBIN        r     1 CP_SEQNUM               2633-0-0/w UBIN        r     1 DELREC_COUNT
  2612-0-0/w UBIN        r     1 DFLT_INCR                216-0-0/c STRC(72)    r     1 DIR_ACCT
  3171-0-0/c CHAR(33)    r     1 DIR_BUF                  220-0-0/d STRC(144)   r     1 DIR_SN
   206-0-0/c STRC(288)   r     1 DIR_TRASH               3064-0-0/d STRC(72)    r     1 DS_RESULTS
  2564-0-0/b STRC        r     1 ERR_CODE                2603-0-0/w UBIN        r     1 EXEC_SEQNUM
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:405  
   224-0-0/d STRC(324)   r     1 FID_RESULTS             2706-0-0/b STRC(72)    r     1 FLAGS
  2631-0-0/w UBIN        r     1 FT_COUNT
  3071-0-0/b BIT (9)     r     1 GET_CMD_TBL(0:255)
  2577-0-0/w UBIN        r     1 HI_EXEC_CLMN            2602-0-0/w UBIN        r     1 HI_SEQNUM
  2575-0-0/w UBIN        r     1 HI_SRCH_CLMN            2640-0-0/w UBIN        r     1 I
  2636-0-0/w UBIN        r     1 IF_LEVEL                1245-0-0/w UBIN        r     1 IN_DCBNUM
  2626-0-0/w UBIN        r     1 LAST_CMD                2613-0-0/w UBIN        r     1 LAST_KEY
  2630-0-0/w UBIN        r     1 LAST_TYPE_CMD           2576-0-0/w UBIN        r     1 LO_EXEC_CLMN
  2601-0-0/w UBIN        r     1 LO_SEQNUM               2574-0-0/w UBIN        r     1 LO_SRCH_CLMN
  2656-0-0/w PTR         r     1 M$DCB$                  2654-0-0/w PTR         r     1 M$FILE$
  2655-0-0/w PTR         r     1 M$FILE2$                2641-0-0/w UBIN        r     1 M$FILE_NUM
  2652-0-0/w PTR         r     1 M$SI$                   2653-0-0/w PTR         r     1 M$UC$
  2616-0-0/w UBIN        r     1 MATCH_CLMN              1246-0-0/w UBIN        r     1 ME_DCBNUM
  2644-0-0/w UBIN        r     1 NUM_TABS                2545-0-0/c STRC(288)   r     1 OPEN_FILE_NAME
    36-0-0/d STRC(2088)  r     1 OPEN_SIREAD_FPT         2650-0-0/w PTR         r     1 P$
  2712-0-0/w STRC(504)   r     1 P_GET                   2730-0-0/w STRC(504)   r     1 P_PCB
   242-0-0/c STRC(63)    r     1 READ_DCB_NAME            244-0-0/c CHAR(1024)  r     1 REC_BUF
  2566-0-0/w UBIN        r     1 REC_SIZE                 236-0-0/d STRC(144)   r     1 RELDCB_FPT
  2702-0-0/d REMB        r     1 REMEM_CMD_READ          2704-0-0/d REMB        r     1 REMEM_STEP_CMD
  2627-0-0/w UBIN        r     1 SAVED_CMD               2615-0-0/w UBIN        r     1 SAVE_KEY
   176-0-0/w STRC(288)   r     1 SAVE_TAB_VLP            2643-0-0/w UBIN        r     1 SEED
  2523-0-0/c CHAR(9)     r     1 SEQ_TEXT_BUF            1247-0-0/w UBIN        r     1 SI_DCBNUM
  2665-0-0/w PTR         r     1 SSE$                    2666-0-0/w PTR         r     1 SSE_INIT$
  2634-0-0/w UBIN        r     1 STRCHG_COUNT            2122-0-0/h STRC(9234)  r     1 STR_BUF
  2673-0-0/w PTR         r     1 STR_TEXT$               2675-0-0/w PTR         r     1 STR_TEXT_END$
  2674-0-0/w PTR         r     1 STR_TEXT_HEAD$          2677-0-0/w PTR         r     1 STR_TEXT_QM$
  2676-0-0/w PTR         r     1 STR_TEXT_SE$            2072-0-0/c STRC(288)   r     1 SUB_BUF_1
   166-0-0/w STRC(288)   r     1 TAB_VLP                 3070-0-0/c CHAR(4)     r     1 TBUF
  2617-0-0/w UBIN        r     1 TEMP_CLMN               1350-0-0/w CHAR(256)   r     1 TEMP_CMD_BUF
  2571-0-0/w UBIN        r     1 TEMP_CMD_SIZE           2620-0-0/w UBIN        r     1 TEMP_COUNT
  2635-0-0/w UBIN        r     1 TRNC_COUNT              1450-0-0/c STRC(9837)  r     1 TYPE_BUF
  2565-0-0/c CHAR(2)     r     1 TYPE_CODE               1244-0-0/w UBIN        r     1 TY_DCBNUM
  2647-0-0/w UBIN        r     1 VERIFY_TYPE             2746-0-0/d STRC(1512)  r     1 XUG$GETCMD_
  3020-0-0/d STRC(1296)  r     1 XUG$INIT_

  ****  Auto variables  ****

PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:406  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   404-0-0/d REMB        r     1 CMD_SPACE_EXHAUSTED      407-0-0/b BIT         r     1 IN_DQUOTE
   413-0-0/b BIT         r     1 IN_SLASH                 410-0-0/b BIT         r     1 IN_SQUOTE
   407-0-0/w PTR         r     1 SSE$                     411-0-0/b BIT         r     1 SSE_EVAL
     3-0-0/w UBIN        r     1 SSE_TBL(0:255)           410-0-0/b STRC(18)    r     1 STR_FLGS
   412-0-0/w UBIN        r     1 STR_LEN                  411-0-0/w UBIN        r     1 TBLVAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c STRC(63)    r     1 B_VERSION
     0-0-0/w STRC(180)   r     1 P_ALLCMDS                  0-0-0/c STRC(72)    r     1 VE_ERRMSGACCT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(72)    r     1 BP_CMD_TBL
     0-0-0/w STRC(162)   r     1 B_CMD_TBL                  0-0-0/c CHAR(256)   r     1 CMD$BUF
     0-0-0/w STRC        r     1 CMD_CNTRLWD                0-0-0/w STRC(144)   r     1 CM_CMD_TBL
     0-0-0/w STRC(144)   r     1 CP_CMD_TBL                 0-0-0/w STRC(234)   r     1 C_CMD_TBL
     0-0-0/w STRC(198)   r     1 DIR_CMD_TBL                0-0-0/w STRC(108)   r     1 D_CMD_TBL
     0-0-0/w STRC(72)    r     1 ED_CMD_TBL                 0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(72)    r     1 HELP_CMD_TBL               0-0-0/w STRC(180)   r     1 IF_CMD_TBL
     0-0-0/w STRC(180)   r     1 IN_CMD_TBL                 0-0-0/w STRC(612)   r     1 JU_CMD_TBL
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$FILE
     0-0-0N  NULL        r     1 M$FILE2                    0-0-0N  NULL        r     1 M$LM
     0-0-0/d ASTR(3528)  r     1 M$ME                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(216)   r     1 MK_CMD_TBL
     0-0-0/w STRC(324)   r     1 M_CMD_TBL                  0-0-0/w STRC(144)   r     1 OUT$BLK
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:407  
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(144)   r     1 RL_CMD_TBL
     0-0-0/w STRC(72)    r     1 SSE$PARAM                  0-0-0/w STRC(2304)  r     1 STR$BUF
     0-0-0/w STRC(180)   r     1 STR_CMD_TBL                0-0-0/w STRC(288)   r     1 TAB$VLP
     0-0-0/w STRC(324)   r     1 TA_CMD_TBL                 0-0-0/w STRC(72)    r     1 TN_CMD_TBL
     0-0-0/w STRC(54)    r     1 TYPE_CMD_TBL               0-0-0/w ASTR(9)     r     1 VARY$STRC
     0-0-0/w STRC(72)    r     1 VE_CMD_TBL
     0-0-0/c UBIN(9)     r     1 XUG_RLT(0:0)


   Procedure VEE$EDIT requires 4201 words for executable code.
   Procedure VEE$EDIT requires 272 words of local(AUTO) storage.

    No errors detected in file VEE$EDIT.:E05TSI    .
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:408  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:409  
          MINI XREF LISTING

ASN
      8502**DCL      7026--DCLINIT 11358>>IF
B$ALT.CODE
      8653**DCL      8653--REDEF    8654--REDEF    8654--REDEF
B$ALT.ERR.ERR#
      8655**DCL      8655--REDEF   10253>>IF
B$ALT.EVID
      8654**DCL      8654--REDEF    8654--REDEF
B$JIT.CCARS
      4544**DCL      9071>>ASSIGN
B$JIT.CCBUF
      4544**DCL      9072>>CALLBLT
B$JIT.CPFLAGS1
      4545**DCL     10171>>IF
B$JIT.CPFLAGS1.SLEAZE
      4550**DCL      4550--REDEF
B$JIT.ERR.MID
      4457**DCL      4457--REDEF
B$JIT.JRESPEAK
      4618**DCL      4619--REDEF
B$JIT.MODE
      4451**DCL      9465>>IF       9556>>IF      10467>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4727**DCL      4727--REDEF    4728--REDEF
B$JIT.PNR
      4631**DCL      4631--REDEF
B$JIT.TSLINE
      4725**DCL      4726--REDEF
B$JIT$
      8908**DCL      4451--IMP-PTR  9071>>ASSIGN   9072>>CALLBLT  9465>>IF       9556>>IF      10171>>IF
     10467>>IF
B$SR_NON_BLANK$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:410  
      8915**DCL      8916--IMP-PTR
B$TCB.ALT$
      8649**DCL     10253>>IF
B$TCB$
      8909**DCL     10253>>IF
BLK$
      7230**DCL      9781<<ASSIGN   9801>>ASSIGN   9928>>IF       9942>>ASSIGN   9945>>ASSIGN   9953>>IF
      9955>>ASSIGN   9958<<ASSIGN   9958>>ASSIGN   9959>>IF       9961>>IF       9962<<ASSIGN   9962>>ASSIGN
      9963<>CALL     9969<>CALL     9976<<ASSIGN   9977>>IF       9979<<ASSIGN   9979>>ASSIGN   9980<>CALL
      9988<<ASSIGN   9989>>IF      10001>>ASSIGN  10001>>ASSIGN  10022>>ASSIGN  10024>>IF      10030>>ASSIGN
     10031<<ASSIGN  10031>>ASSIGN  10033>>IF      10033>>IF      10035>>IF      10039<<ASSIGN  10040>>ASSIGN
     10053<<ASSIGN  10054>>IF      10056>>IF      10057<<ASSIGN  10057>>ASSIGN  10058<>CALL    10065<>CALL
     10072<<ASSIGN  10073>>IF      10076<<ASSIGN  10076>>ASSIGN  10077<>CALL    10084<<ASSIGN  10085>>IF
     10096>>ASSIGN  10096>>ASSIGN  10106>>IF      10112>>ASSIGN  10116>>ASSIGN  10130>>IF      10133>>ASSIGN
     10191>>ASSIGN  10194<<ASSIGN  10194>>ASSIGN  10195>>IF      10196<>CALL    10206<<ASSIGN  10208>>IF
     10210>>IF      10215<<ASSIGN  10216>>ASSIGN  10217>>CALL    10220>>IF      10225<<ASSIGN  10225>>ASSIGN
     10226>>CALL    10242>>CALL    10277>>DOINDEX 10278>>ASSIGN  10292<<ASSIGN  10292>>ASSIGN  10294>>DOCASE
     10314>>IF      10324>>DOINDEX 10325>>CALLBLT 10325>>CALLBLT 10340>>IF      10350>>ASSIGN  10364>>IF
     10376>>ASSIGN  10376>>ASSIGN  10390>>IF      10392>>ASSIGN  10406>>IF      10408>>ASSIGN  10433>>CALL
     10436>>CALL    10480>>IF      10480>>IF      10495>>CALL    10504>>IF      10505<<ASSIGN  10505>>ASSIGN
     10506>>ASSIGN  10507>>CALLBLT 10507>>CALLBLT 10548>>IF      10584>>IF      10585<<ASSIGN  10585>>ASSIGN
     10586>>CALL    10630>>CALL    10644>>IF      10645<<ASSIGN  10645>>ASSIGN  10646>>CALL    10687>>CALL
     10691>>CALL    10711>>IF      10712<<ASSIGN  10712>>ASSIGN  10713>>CALL    10750>>CALL    10753>>CALL
     10791>>IF      10819>>IF      10828>>IF      10830>>CALL    10837>>IF      10838<<ASSIGN  10838>>ASSIGN
     10839>>IF      10843>>IF      10847>>CALL    10850>>DOWHILE 10853<<ASSIGN  10853>>ASSIGN  10855>>IF
     10857>>IF      10861>>IF      10866>>CALL    10874<<ASSIGN  10877<>CALL    10905>>CALLBLT 10905>>CALLBLT
     10934>>IF      10936>>IF      10954<<ASSIGN  10954>>ASSIGN  10955>>IF      10956<>CALL    10959<<ASSIGN
     10963<>CALL    10991>>CALL    10995>>CALL    11017>>CALL    11055>>IF      11070>>IF      11071<<ASSIGN
     11071>>ASSIGN  11072>>CALL    11078>>CALL    11081>>IF      11082<<ASSIGN  11082>>ASSIGN  11083>>CALL
     11101>>IF      11101>>IF      11101>>IF      11130>>CALL    11155>>CALL    11159>>CALL    11187>>IF
     11189<<ASSIGN  11189>>ASSIGN  11190>>IF      11194>>IF      11198>>CALL    11201>>DOWHILE 11204<<ASSIGN
     11204>>ASSIGN  11206>>IF      11208>>IF      11212>>IF      11219>>CALL    11228<<ASSIGN  11231<>CALL
     11274>>CALL    11300>>CALL    11303>>ASSIGN  11304>>ASSIGN  11332>>CALL    11336>>CALL    11348>>IF
     11352>>ASSIGN  11356>>ASSIGN  11356>>ASSIGN
BP_CMD_TBL
      8774**DCL      9926--ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:411  
BP_CMD_TBL.TEXT
      8776**DCL      9929<<ASSIGN   9930<<ASSIGN
BREAK_ARS
      8501**DCL      9450>>IF       9452<<ASSIGN   9508<<ASSIGN
B_CMD_TBL
      8663**DCL      9944--ASSIGN
B_CMD_TBL.FID$
      8665**DCL      9945<<ASSIGN
B_CMD_TBL.INCR
      8667**DCL      9948<<ASSIGN   9965<<ASSIGN   9982<<ASSIGN
B_CMD_TBL.SEQNUM
      8666**DCL      9946<<ASSIGN   9969<>CALL
B_CMD_TBL.TYPE
      8668**DCL      9949<<ASSIGN   9990<<ASSIGN  10001<<ASSIGN
B_VERSION.CNT
      8911**DCL      9037>>CALLBLT
B_VERSION.TEXT
      8912**DCL      9037>>CALLBLT
CHECK_A
     10974**PROC     9881--CALL
CHECK_A_ALT IN PROCEDURE CHECK_A
     11000**LABEL   10991--CALLALT 10995--CALLALT
CHECK_BP
      9914**PROC     9825--CALL
CHECK_BP_ALT IN PROCEDURE CHECK_BP
      9934**LABEL    9916--CALLALT
CHECK_BUILD
      9938**PROC     9827--CALL
CHECK_BUILD_ALT IN PROCEDURE CHECK_BUILD
     10006**LABEL    9940--CALLALT  9963--CALLALT  9969--CALLALT  9980--CALLALT
CHECK_CL
     11004**PROC     9883--CALL
CHECK_CL_ALT IN PROCEDURE CHECK_CL
     11027**LABEL   11017--CALLALT
CHECK_CM
     10417**PROC     9863--CALL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:412  
CHECK_CMD
      9779**PROC     9094--CALL     9142--CALL     9212--CALL
CHECK_CMD_ALT IN PROCEDURE CHECK_CMD
      9910**LABEL    9825--CALLALT  9827--CALLALT  9829--CALLALT  9831--CALLALT  9833--CALLALT  9835--CALLALT
      9837--CALLALT  9839--CALLALT  9841--CALLALT  9844--CALLALT  9846--CALLALT  9848--CALLALT  9850--CALLALT
      9852--CALLALT  9863--CALLALT  9865--CALLALT  9867--CALLALT  9869--CALLALT  9871--CALLALT  9873--CALLALT
      9875--CALLALT  9877--CALLALT  9881--CALLALT  9883--CALLALT  9885--CALLALT  9887--CALLALT  9889--CALLALT
      9891--CALLALT  9893--CALLALT  9895--CALLALT  9897--CALLALT
CHECK_CM_ALT IN PROCEDURE CHECK_CM
     10442**LABEL   10429--CALLALT 10433--CALLALT 10436--CALLALT
CHECK_COPY
     10010**PROC     9829--CALL
CHECK_COPY_ALT IN PROCEDURE CHECK_COPY
     10100**LABEL   10012--CALLALT 10058--CALLALT 10065--CALLALT 10077--CALLALT
CHECK_CP
     11031**PROC     9885--CALL
CHECK_CP_ALT IN PROCEDURE CHECK_CP
     11109**LABEL   11072--CALLALT 11078--CALLALT 11083--CALLALT 11090--CALLALT 11092--CALLALT 11096--CALLALT
CHECK_CRPT
     10104**PROC     9831--CALL
CHECK_D
     11113**PROC     9887--CALL
CHECK_DE
     10446**PROC     9865--CALL
CHECK_DE_ALT IN PROCEDURE CHECK_DE
     10518**LABEL   10493--CALLALT 10495--CALLALT
CHECK_DIR
     11345**PROC     9852--CALL
CHECK_D_ALT IN PROCEDURE CHECK_D
     11134**LABEL   11130--CALLALT
CHECK_E
     11138**PROC     9889--CALL
CHECK_EDIT
     10124**PROC     9833--CALL
CHECK_EDIT_ALT IN PROCEDURE CHECK_EDIT
     10137**LABEL   10126--CALLALT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:413  
CHECK_END
     10141**PROC     9835--CALL
CHECK_END_ALT IN PROCEDURE CHECK_END
     10149**LABEL   10143--CALLALT
CHECK_E_ALT IN PROCEDURE CHECK_E
     11164**LABEL   11155--CALLALT 11159--CALLALT
CHECK_HELP_ALT IN PROCEDURE CHECK_HELP
     10413**LABEL   10403--CALLALT
CHECK_IF
     11168**PROC     9891--CALL
CHECK_IF_ALT IN PROCEDURE CHECK_IF
     11241**LABEL   11198--CALLALT 11219--CALLALT 11231--CALLALT
CHECK_IF_RET IN PROCEDURE CHECK_IF
     11235**LABEL   11187--GOTO    11227--GOTO
CHECK_IN
     10522**PROC     9867--CALL
CHECK_IN_ALT IN PROCEDURE CHECK_IN
     10659**LABEL   10543--CALLALT 10552--CALLALT 10556--CALLALT 10586--CALLALT 10609--CALLALT 10613--CALLALT
     10630--CALLALT 10646--CALLALT
CHECK_IN_NOROOM IN PROCEDURE CHECK_IN
     10574**LABEL   10617--GOTO
CHECK_JU
     11248**PROC     9893--CALL
CHECK_JU_ALT IN PROCEDURE CHECK_JU
     11279**LABEL   11274--CALLALT
CHECK_LIST
     10153**PROC     9837--CALL
CHECK_LIST_ALT IN PROCEDURE CHECK_LIST
     10179**LABEL   10155--CALLALT
CHECK_MERGE
     10183**PROC     9839--CALL
CHECK_MERGE_ALT IN PROCEDURE CHECK_MERGE
     10234**LABEL   10185--CALLALT 10196--CALLALT 10217--CALLALT 10226--CALLALT
CHECK_MK
     10663**PROC     9869--CALL
CHECK_MK_ALT IN PROCEDURE CHECK_MK
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:414  
     10722**LABEL   10683--CALLALT 10687--CALLALT 10691--CALLALT 10713--CALLALT
CHECK_R
     11283**PROC     9895--CALL
CHECK_READ
     10238**PROC     9841--CALL
CHECK_READ_ALT IN PROCEDURE CHECK_READ
     10269**LABEL   10240--CALLALT 10242--CALLALT
CHECK_READ_CLOSE_ERR IN PROCEDURE CHECK_READ
     10260**LABEL   10257--CALLALT
CHECK_READ_ERR IN PROCEDURE CHECK_READ
     10253**LABEL   10249--CALLALT
CHECK_READ_RELDCB_ERR IN PROCEDURE CHECK_READ
     10267**LABEL   10245--CALLALT 10264--CALLALT
CHECK_READ_RETRY_OPEN IN PROCEDURE CHECK_READ
     10249**LABEL   10260--GOTO
CHECK_RN
     10726**PROC     9871--CALL
CHECK_RN_ALT IN PROCEDURE CHECK_RN
     10758**LABEL   10746--CALLALT 10750--CALLALT 10753--CALLALT
CHECK_R_ALT IN PROCEDURE CHECK_R
     11311**LABEL   11300--CALLALT
CHECK_S
     11315**PROC     9897--CALL
CHECK_SE
     10762**PROC     9873--CALL
CHECK_SE_ALT IN PROCEDURE CHECK_SE
     10885**LABEL   10792--CALLALT 10830--CALLALT 10847--CALLALT 10866--CALLALT 10877--CALLALT
CHECK_SSE
      9720**PROC     9164--CALL
CHECK_SSE_1 IN PROCEDURE CHECK_SSE
      9737**LABEL    9774--GOTO
CHECK_SSE_2 IN PROCEDURE CHECK_SSE
      9755**LABEL    9741--CALLALT
CHECK_SSE_NEXT IN PROCEDURE CHECK_SSE
      9765**LABEL    9738--GOTO     9739--GOTO     9752--GOTO
CHECK_STATUS
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:415  
     10273**PROC     9844--CALL
CHECK_S_ALT IN PROCEDURE CHECK_S
     11341**LABEL   11332--CALLALT 11336--CALLALT
CHECK_TA
     10287**PROC     9846--CALL
CHECK_TA_ALT IN PROCEDURE CHECK_TA
     10356**LABEL   10289--CALLALT
CHECK_TN
     10889**PROC     9875--CALL
CHECK_TN_ALT IN PROCEDURE CHECK_TN
     10911**LABEL   10903--CALLALT
CHECK_TS
     10915**PROC     9877--CALL
CHECK_TS_ALT IN PROCEDURE CHECK_TS
     10970**LABEL   10947--CALLALT 10956--CALLALT 10963--CALLALT
CHECK_TYPE
     10360**PROC     9848--CALL
CHECK_VE
     10384**PROC     9850--CALL
CHECK_VE_ALT IN PROCEDURE CHECK_VE
     10397**LABEL   10386--CALLALT
CLOSE_FPT
      6763**DCL      9101<>CALL
CLOSE_FPT.SN_
      6763**DCL      6763--REDEF
CLOSE_FPT.UTL_
      6764**DCL      6764--REDEF
CLOSE_FPT.V
      6768**DCL      6763--DCLINIT
CLOSE_FPT.V.EXPIRE#
      6778**DCL      6778--REDEF
CLOSE_FPT.V.TYPE#
      6776**DCL      6776--REDEF
CLOSE_FPT.V.XTNSIZE#
      6773**DCL      6773--REDEF    6775--REDEF
CLOSE_SIREAD_ERR IN PROCEDURE READ_CMD
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:416  
      9484**LABEL    9482--CALLALT
CLOSE_SIREAD_FPT
      6716**DCL      9482<>CALL    10257<>CALL
CLOSE_SIREAD_FPT.SN_
      6716**DCL      6716--REDEF
CLOSE_SIREAD_FPT.UTL_
      6717**DCL      6717--REDEF
CLOSE_SIREAD_FPT.V
      6721**DCL      6716--DCLINIT
CLOSE_SIREAD_FPT.V.DCB#
      6722**DCL      9481<<ASSIGN  10256<<ASSIGN
CLOSE_SIREAD_FPT.V.EXPIRE#
      6731**DCL      6731--REDEF
CLOSE_SIREAD_FPT.V.TYPE#
      6729**DCL      6729--REDEF
CLOSE_SIREAD_FPT.V.XTNSIZE#
      6726**DCL      6726--REDEF    6728--REDEF
CLOSE_TY_FPT
      6440**DCL      9329<>CALL
CLOSE_TY_FPT.SN_
      6440**DCL      6440--REDEF
CLOSE_TY_FPT.UTL_
      6441**DCL      6441--REDEF
CLOSE_TY_FPT.V
      6445**DCL      6440--DCLINIT
CLOSE_TY_FPT.V.DCB#
      6446**DCL      9328<<ASSIGN
CLOSE_TY_FPT.V.EXPIRE#
      6455**DCL      6455--REDEF
CLOSE_TY_FPT.V.TYPE#
      6453**DCL      6453--REDEF
CLOSE_TY_FPT.V.XTNSIZE#
      6450**DCL      6450--REDEF    6452--REDEF
CMD$
      7213**DCL      9065<<ASSIGN   9066>>ASSIGN   9067>>ASSIGN   9113<<ASSIGN   9114>>ASSIGN   9115<<ASSIGN
      9115>>ASSIGN   9116>>ASSIGN   9136<<ASSIGN   9145>>IF       9147>>ASSIGN   9148>>ASSIGN   9149>>ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:417  
      9150<<ASSIGN   9150>>ASSIGN   9150>>ASSIGN   9151>>ASSIGN   9155<<ASSIGN   9160>>IF       9214>>IF
      9216>>ASSIGN   9217>>ASSIGN   9218>>ASSIGN   9219<<ASSIGN   9219>>ASSIGN   9219>>ASSIGN   9220>>ASSIGN
      9222<<ASSIGN   9224>>IF       9440<<ASSIGN   9441>>ASSIGN   9803>>ASSIGN   9804>>ASSIGN   9842>>ASSIGN
      9856>>ASSIGN   9900<<ASSIGN   9900>>ASSIGN   9900>>ASSIGN   9901>>ASSIGN   9902>>IF       9926>>ASSIGN
      9926>>ASSIGN   9929>>ASSIGN   9930>>ASSIGN   9944>>ASSIGN   9945>>ASSIGN   9946>>ASSIGN   9948>>ASSIGN
      9949>>ASSIGN   9965>>ASSIGN   9969>>CALL     9982>>ASSIGN   9990>>ASSIGN  10001>>ASSIGN  10016>>ASSIGN
     10016>>ASSIGN  10018>>ASSIGN  10019>>ASSIGN  10020>>ASSIGN  10022>>ASSIGN  10025>>ASSIGN  10025>>ASSIGN
     10026>>ASSIGN  10036>>ASSIGN  10037>>ASSIGN  10040>>ASSIGN  10042>>ASSIGN  10048>>ASSIGN  10048>>ASSIGN
     10049>>ASSIGN  10060>>ASSIGN  10065>>CALL    10079>>ASSIGN  10086>>ASSIGN  10096>>ASSIGN  10132>>ASSIGN
     10132>>ASSIGN  10133>>ASSIGN  10145>>ASSIGN  10145>>ASSIGN  10190>>ASSIGN  10190>>ASSIGN  10191>>ASSIGN
     10196>>CALL    10196>>CALL    10202>>ASSIGN  10203>>ASSIGN  10209>>ASSIGN  10211>>ASSIGN  10212>>ASSIGN
     10216>>ASSIGN  10217>>CALL    10217>>CALL    10221>>ASSIGN  10229>>ASSIGN  10275>>ASSIGN  10275>>ASSIGN
     10278>>ASSIGN  10281>>ASSIGN  10291>>ASSIGN  10291>>ASSIGN  10296>>ASSIGN  10297>>ASSIGN  10298>>ASSIGN
     10302>>ASSIGN  10303>>ASSIGN  10304>>ASSIGN  10308>>ASSIGN  10309>>ASSIGN  10310>>ASSIGN  10330>>ASSIGN
     10333>>IF      10362>>ASSIGN  10376>>ASSIGN  10388>>ASSIGN  10391>>ASSIGN  10392>>ASSIGN  10405>>ASSIGN
     10405>>ASSIGN  10407>>ASSIGN  10408>>ASSIGN  10431>>ASSIGN  10431>>ASSIGN  10433>>CALL    10436>>CALL
     10436>>CALL    10477>>ASSIGN  10477>>ASSIGN  10495>>CALL    10495>>CALL    10507>>CALLBLT 10511>>ASSIGN
     10511>>ASSIGN  10514>>ASSIGN  10545>>ASSIGN  10545>>ASSIGN  10546>>ASSIGN  10549>>ASSIGN  10550>>ASSIGN
     10565>>ASSIGN  10568>>ASSIGN  10570>>ASSIGN  10603>>ASSIGN  10607>>ASSIGN  10618>>ASSIGN  10621>>ASSIGN
     10623>>ASSIGN  10628>>ASSIGN  10630>>CALL    10633>>IF      10655>>ASSIGN  10685>>ASSIGN  10685>>ASSIGN
     10687>>CALL    10687>>CALL    10691>>CALL    10691>>CALL    10695>>IF      10695>>IF      10695>>IF
     10695>>IF      10695>>IF      10695>>IF      10695>>IF      10695>>IF      10718>>ASSIGN  10748>>ASSIGN
     10748>>ASSIGN  10750>>CALL    10753>>CALL    10801>>ASSIGN  10808>>ASSIGN  10809>>ASSIGN  10901>>ASSIGN
     10905>>CALLBLT 10927>>ASSIGN  10927>>ASSIGN  10986>>ASSIGN  10986>>ASSIGN  10990>>ASSIGN  11016>>ASSIGN
     11016>>ASSIGN  11017>>CALL    11017>>CALL    11022>>ASSIGN  11023>>ASSIGN  11051>>ASSIGN  11051>>ASSIGN
     11102>>ASSIGN  11103>>ASSIGN  11104>>ASSIGN  11105>>ASSIGN  11125>>ASSIGN  11125>>ASSIGN  11129>>ASSIGN
     11150>>ASSIGN  11150>>ASSIGN  11154>>ASSIGN  11181>>ASSIGN  11182>>ASSIGN  11183>>IF      11185>>ASSIGN
     11192>>ASSIGN  11193>>ASSIGN  11195>>ASSIGN  11198>>CALL    11203>>ASSIGN  11207>>ASSIGN  11209>>ASSIGN
     11210>>ASSIGN  11213>>ASSIGN  11217>>IF      11219>>CALL    11224>>IF      11226>>ASSIGN  11231>>CALL
     11231>>CALL    11236>>ASSIGN  11270>>ASSIGN  11270>>ASSIGN  11274>>CALL    11295>>ASSIGN  11295>>ASSIGN
     11299>>ASSIGN  11305>>CALLBLT 11307>>IF      11327>>ASSIGN  11327>>ASSIGN  11331>>ASSIGN  11346>>ASSIGN
     11346>>ASSIGN  11350>>ASSIGN  11352>>ASSIGN  11354>>IF      11372>>ASSIGN  11374>>ASSIGN  11376>>ASSIGN
CMD$BUF
      8556**DCL      9072<<CALLBLT  9078>>CALLBLT  9081<<CALLBLT  9085<<CALLBLT  9506>>IF       9509>>ASSIGN
      9527>>ASSIGN   9528<<CALLBLT  9535>>DOWHILE  9535>>DOWHILE  9550<<CALLBLT  9615>>CALLBLT  9670>>ASSIGN
     10162>>ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:418  
CMDBUF$
      7216**DCL      9061<<ASSIGN   9062>>ASSIGN   9063>>ASSIGN   9072>>CALLBLT  9078>>CALLBLT  9081>>CALLBLT
      9085>>CALLBLT  9442<<ASSIGN   9528>>CALLBLT  9530>>IF       9535>>DOWHILE  9535>>DOWHILE  9550>>CALLBLT
      9607<<ASSIGN   9615>>CALLBLT  9670>>ASSIGN
CMDBUF_BASE$
      7217**DCL      9062<<ASSIGN   9442>>ASSIGN   9607>>ASSIGN
CMDBUF_END$
      7218**DCL      9063<<ASSIGN   9065>>ASSIGN   9530>>IF
CMD_BASE$
      7214**DCL      9066<<ASSIGN   9113>>ASSIGN   9136>>ASSIGN   9145>>IF       9155>>ASSIGN   9214>>IF
      9222>>ASSIGN   9440>>ASSIGN
CMD_BUF
      7107**DCL      7340--DCLINIT  7542--DCLINIT  9425>>ASSIGN   9451--ASSIGN   9509<<ASSIGN   9527<<ASSIGN
      9528>>CALLBLT  9530--IF       9542>>IF       9670<<ASSIGN
CMD_CNTRLWD
      8536**DCL      8528--DCLINIT  9114<<ASSIGN   9115--ASSIGN   9149--ASSIGN   9218--ASSIGN  10145--ASSIGN
     10808--ASSIGN  10927--ASSIGN
CMD_CNTRLWD.CMD_CODE
      8541**DCL      9148<<ASSIGN   9217<<ASSIGN   9804<<ASSIGN  10801<<ASSIGN
CMD_CNTRLWD.FLAGS
      8537**DCL      9147<<ASSIGN   9216<<ASSIGN   9803<<ASSIGN
CMD_CNTRLWD.FLAGS.ENDCT
      8538**DCL      9116<<ASSIGN   9151<<ASSIGN   9160>>IF       9220<<ASSIGN   9224>>IF       9441<<ASSIGN
      9901<<ASSIGN
CMD_CNTRLWD.OFFSET
      8540**DCL      9149<<ASSIGN   9150>>ASSIGN   9218<<ASSIGN   9219>>ASSIGN   9842<<ASSIGN   9856<<ASSIGN
      9900>>ASSIGN   9926<<ASSIGN   9944<<ASSIGN  10016<<ASSIGN  10132<<ASSIGN  10145<<ASSIGN  10190<<ASSIGN
     10275<<ASSIGN  10291<<ASSIGN  10362<<ASSIGN  10388<<ASSIGN  10405<<ASSIGN  10431<<ASSIGN  10477<<ASSIGN
     10545<<ASSIGN  10685<<ASSIGN  10748<<ASSIGN  10808<<ASSIGN  10809<<ASSIGN  10901<<ASSIGN  10927<<ASSIGN
     10986<<ASSIGN  11016<<ASSIGN  11051<<ASSIGN  11125<<ASSIGN  11150<<ASSIGN  11236<<ASSIGN  11270<<ASSIGN
     11295<<ASSIGN  11327<<ASSIGN  11346<<ASSIGN
CMD_CODE
      7186**DCL      9095>>IF       9096>>IF       9249>>IF       9255>>DOCASE   9265>>IF       9335>>IF
      9783>>IF       9801<<ASSIGN   9802>>IF       9802>>IF       9802>>ASSIGN   9804>>ASSIGN   9807>>DOCASE
      9822>>DOCASE   9918>>IF      10458>>IF      10466>>IF      10534>>IF      10534>>IF      10534>>IF
     10549>>IF      10550>>IF      10557>>IF      10600>>IF      10607>>IF      10610>>IF      10777>>IF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:419  
     10788>>IF      10788>>IF      10790>>IF      10791>>IF      10800<<ASSIGN  10804>>IF      10806>>IF
     10806>>IF      10806>>IF      10806>>IF      10806>>IF      10812>>IF      10812>>IF      10814>>IF
     10819>>IF      10819>>IF      10819>>IF      10826>>IF      10832>>IF      10832>>IF      10930>>IF
     10931>>IF      10932>>IF      11089>>IF
CMD_CONTINUE
      8861**DCL-ENT  8126--DCLINIT
CMD_END$
      7215**DCL      9067<<ASSIGN   9902>>IF      11183>>IF      11217>>IF      11224>>IF
CMD_INDEX
      7185**DCL      9089<<ASSIGN   9129>>DOWHILE  9135<<ASSIGN   9191>>DOWHILE  9400>>CALL     9429<<ASSIGN
      9598>>IF       9600>>IF       9607>>ASSIGN   9612>>ASSIGN   9614>>DOWHILE  9672<<ASSIGN   9672>>ASSIGN
      9784>>CALL    10157>>IF
CMD_OK
      9155**LABEL    9096--GOTO
CMD_READ
      9100**LABEL    9094--CALLALT  9122--GOTO     9127--GOTO     9130--CALLALT  9142--CALLALT  9159--CALLALT
      9161--GOTO     9346--GOTO     9409--GOTO     9416--GOTO
CMD_RETRY
      9140**LABEL    9370--GOTO
CMD_SIZE
      7155**DCL      9071<<ASSIGN   9072>>CALLBLT  9078>>CALLBLT  9086<<ASSIGN   9127>>IF       9129>>DOWHILE
      9190>>IF       9191>>DOWHILE  9426>>ASSIGN   9430<<ASSIGN   9527>>ASSIGN   9528>>CALLBLT  9529<<ASSIGN
      9529>>ASSIGN   9530>>IF       9535>>DOWHILE  9535>>DOWHILE  9537<<ASSIGN   9537>>ASSIGN   9545>>IF
      9548>>IF       9549<<ASSIGN   9577<<ASSIGN   9598>>IF       9612>>ASSIGN   9614>>DOWHILE 10157>>IF
CMD_SPACE_EXHAUSTED
      8530**DCL      9070<<REMEMBR 11244>>UNWIND
CM_CMD_TBL
      8758**DCL     10431--ASSIGN
CM_CMD_TBL.HI_CLMN
      8762**DCL     10436<>CALL
CM_CMD_TBL.LO_CLMN
      8761**DCL     10436<>CALL
CM_CMD_TBL.SEQNUM
      8760**DCL     10433<>CALL
CP_CMD_TBL
      8783**DCL     11051--ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:420  
CP_CMD_TBL.INCR
      8787**DCL     11104<<ASSIGN
CP_CMD_TBL.LIMIT_SEQNUM
      8786**DCL     11105<<ASSIGN
CP_CMD_TBL.SEQNUM
      8785**DCL     11102<<ASSIGN  11103<<ASSIGN
CP_DFLT_INCR
      7172**DCL     11066>>ASSIGN  11072<>CALL    11074<<ASSIGN  11074>>ASSIGN  11083<>CALL    11085<<ASSIGN
     11085>>ASSIGN  11100>>ASSIGN  11104>>ASSIGN
CP_LIMIT IN PROCEDURE CHECK_CP
     11089**LABEL   11067--GOTO    11075--GOTO
CP_LIMIT_SEQNUM
      7171**DCL      9244>>IF       9245<<ASSIGN   9951<<ASSIGN  10014<<ASSIGN  10128<<ASSIGN  10188<<ASSIGN
     11095<<ASSIGN  11098<<ASSIGN  11105>>ASSIGN
CP_RECSMVED
      7173**DCL      9307>>IF       9308<>CALL     9310<<ASSIGN  11053<<ASSIGN
CP_SEQNUM
      7170**DCL     11056>>IF      11066<<ASSIGN  11066>>ASSIGN  11078<>CALL    11090<>CALL    11100<<ASSIGN
     11100>>ASSIGN  11103>>ASSIGN
C_CMD_TBL
      8675**DCL     10016--ASSIGN
C_CMD_TBL.FID$
      8677**DCL     10022<<ASSIGN  10025>>ASSIGN  10048>>ASSIGN
C_CMD_TBL.FID2$
      8678**DCL     10025<<ASSIGN  10040<<ASSIGN  10048<<ASSIGN
C_CMD_TBL.INCR
      8681**DCL     10019<<ASSIGN  10060<<ASSIGN  10079<<ASSIGN
C_CMD_TBL.ONOVER
      8679**DCL     10026<<ASSIGN  10036<<ASSIGN  10037<<ASSIGN  10049<<ASSIGN
C_CMD_TBL.SEQNUM
      8680**DCL     10018<<ASSIGN  10042<<ASSIGN  10065<>CALL
C_CMD_TBL.TYPE
      8682**DCL     10020<<ASSIGN  10086<<ASSIGN  10096<<ASSIGN
DELREC_COUNT
      7192**DCL      9106<<ASSIGN   9118>>IF       9119<>CALL     9286>>IF       9287<>CALL
DFLT_INCR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:421  
      7175**DCL      9947<<ASSIGN   9948>>ASSIGN   9963<>CALL     9964<<ASSIGN   9964>>ASSIGN   9965>>ASSIGN
      9980<>CALL     9981<<ASSIGN   9981>>ASSIGN   9982>>ASSIGN  10058<>CALL    10059<<ASSIGN  10059>>ASSIGN
     10060>>ASSIGN  10077<>CALL    10078<<ASSIGN  10078>>ASSIGN  10079>>ASSIGN  10221>>ASSIGN  10228<<ASSIGN
     10229>>ASSIGN  10557>>IF      10565>>ASSIGN  10570>>ASSIGN  10586<>CALL    10588<<ASSIGN  10588>>ASSIGN
     10589>>IF      10591<<ASSIGN  10603>>ASSIGN  10616>>IF      10618>>ASSIGN  10623>>ASSIGN  10646<>CALL
     10648<<ASSIGN  10648>>ASSIGN  10650>>IF      10652<<ASSIGN  10655>>ASSIGN  10713<>CALL    10715<<ASSIGN
     10715>>ASSIGN  10718>>ASSIGN
DIR_ACCT
      6965**DCL      7024--DCLINIT
DIR_ACCT.ACCT#
      6965**DCL     11358>>IF      11372>>ASSIGN
DIR_BUF
      8505**DCL      7023--DCLINIT 11356<<ASSIGN
DIR_CMD_TBL
      8814**DCL     11346--ASSIGN
DIR_CMD_TBL.ACCT
      8817**DCL     11372<<ASSIGN
DIR_CMD_TBL.CODE
      8816**DCL     11350<<ASSIGN  11352<<ASSIGN  11354>>IF
DIR_CMD_TBL.PSN
      8818**DCL     11374<<ASSIGN  11376<<ASSIGN
DIR_SN
      6980**DCL      7025--DCLINIT
DIR_SN.NUM#
      6980**DCL     11358>>IF
DIR_SN.SN#
      6980**DCL     11374>>ASSIGN
DIR_TRASH
      6951**DCL      7024--DCLINIT  7025--DCLINIT  7025--DCLINIT
DS_RESULTS
      8496**DCL      6183--DCLINIT  9041<<ASSIGN
DS_RESULTS.PTR$
      8500**DCL      9053>>ASSIGN
D_CMD_TBL
      8733**DCL     11125--ASSIGN
ED_CMD_TBL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:422  
      8660**DCL     10132--ASSIGN
ED_CMD_TBL.FID$
      8662**DCL     10133<<ASSIGN
EOT
      8517**DCL      9548>>IF
ERR_CODE
      7141**DCL      9414<<ASSIGN   9542<<ASSIGN
EXEC_SEQNUM
      7168**DCL     10226<>CALL    10228>>ASSIGN
F$DCB.ACCT
       486**DCL      9022>>ASSIGN
F$DCB.ACTPOS
       501**DCL       501--REDEF
F$DCB.ARS
       476**DCL       476--REDEF
F$DCB.ASN
       491**DCL      9181>>IF       9422>>IF       9478>>IF
F$DCB.ATTR
       494**DCL       495--REDEF
F$DCB.BORROW
       509**DCL       509--REDEF     509--REDEF     509--REDEF
F$DCB.DCBNAME.L
       523**DCL       523--IMP-SIZ
F$DCB.DDEV.XEQ
       482**DCL      9181>>IF       9465>>IF       9556>>IF
F$DCB.EOMCHAR
       480**DCL       480--REDEF    9545>>IF       9548>>IF
F$DCB.FFLG.DELR
       481**DCL      9812>>IF
F$DCB.FFLG.UPD
       481**DCL      9812>>IF
F$DCB.FFLG.WNEW
       481**DCL      9812>>IF
F$DCB.FLDID
       504**DCL       504--REDEF
F$DCB.FORM$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:423  
       498**DCL       498--REDEF
F$DCB.FSECT
       514**DCL       514--REDEF
F$DCB.FSN
       491**DCL       491--REDEF     491--REDEF     492--REDEF
F$DCB.HEADER$
       497**DCL       497--REDEF
F$DCB.IXTNSIZE
       495**DCL       495--REDEF
F$DCB.LASTSTA$
       485**DCL       485--REDEF
F$DCB.LVL
       510**DCL       510--REDEF
F$DCB.NAME.C
       485**DCL       485--REDEF
F$DCB.NOEOF
       506**DCL       506--REDEF
F$DCB.NRECS
       496**DCL       496--REDEF   10633>>IF
F$DCB.NRECX
       515**DCL       515--REDEF
F$DCB.OHDR
       507**DCL       507--REDEF
F$DCB.ORG
       490**DCL       490--REDEF
F$DCB.PRECNO
       513**DCL       513--REDEF
F$DCB.RCSZ
       518**DCL       518--REDEF
F$DCB.RES
       486**DCL       486--REDEF
F$DCB.RESNT.TYP
       486**DCL      9422>>IF
F$DCB.SETX
       498**DCL       498--REDEF
F$DCB.TAB$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:424  
       497**DCL       498--REDEF    9032>>ASSIGN
F$DCB.TDA
       512**DCL       512--REDEF
F$DCB.WSN
       487**DCL       487--REDEF
FID_ERR IN PROCEDURE CHECK_DIR
     11382**LABEL   11357--CALLALT
FID_RESULTS
      6994**DCL      7027--DCLINIT
FID_RESULTS.ACCT
      6994**DCL     11358>>IF
FID_RESULTS.NAME
      6994**DCL     11358>>IF
FID_RESULTS.PASS
      6994**DCL     11358>>IF
FID_RESULTS.SN
      6994**DCL     11373>>IF
FID_RESULTS.WSN
      6994**DCL     11358>>IF
FILETYPE IN PROCEDURE CHECK_BUILD
      9988**LABEL    9959--GOTO     9977--GOTO
FILE_TYPE IN PROCEDURE CHECK_COPY
     10084**LABEL   10054--GOTO    10073--GOTO
FLAGS.BADKEY
      7273**DCL      9069<<ASSIGN   9126<<ASSIGN   9249>>IF
FLAGS.BPFLAG
      7244**DCL      9241<<ASSIGN
FLAGS.BPFLAG_SAV
      7275**DCL      9241>>ASSIGN
FLAGS.CCBUFLG
      7274**DCL      9075>>IF       9088<<ASSIGN
FLAGS.CONSEC_MODE
      7243**DCL      9918>>IF      10458>>IF      10534>>IF      10589>>IF      10600>>IF      10633>>IF
     10650>>IF      10675>>IF      10738>>IF      10777>>IF      11043>>IF
FLAGS.DELRECCMD
      7262**DCL      9286>>IF       9439<<ASSIGN  10826<<ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:425  
FLAGS.EDIT_MODE
      7236**DCL      9812>>IF      10419>>IF      10448>>IF      10524>>IF      10665>>IF      10728>>IF
     10764>>IF      10891>>IF      10917>>IF      10976>>IF      11006>>IF      11033>>IF      11115>>IF
     11140>>IF      11170>>IF      11250>>IF      11285>>IF      11317>>IF
FLAGS.EOF
      7241**DCL      9264>>IF       9693>>IF      10557>>IF      10614>>IF      11093>>IF
FLAGS.EXISTS
      7240**DCL      9691>>IF      10553>>IF      10610>>IF      11091>>IF
FLAGS.FIRSTCMD
      7251**DCL      9600<<ASSIGN   9601<<ASSIGN
FLAGS.IBEX_BUILD
      7252**DCL      9095<<ASSIGN   9100>>IF
FLAGS.INPUT
      7265**DCL      9446<<ASSIGN   9523<<ASSIGN   9555<<ASSIGN
FLAGS.INTRA_CMD
      7237**DCL      9145>>IF       9158>>IF       9214>>IF       9231>>IF       9359>>IF       9360<<ASSIGN
      9805<<ASSIGN  10501<<ASSIGN  10817<<ASSIGN  10928<<ASSIGN  10987<<ASSIGN  11021<<ASSIGN  11052<<ASSIGN
     11126<<ASSIGN  11151<<ASSIGN  11235<<ASSIGN  11271<<ASSIGN  11296<<ASSIGN  11328<<ASSIGN
FLAGS.NEWLINE_FLAG
      7239**DCL      9112>>IF       9189>>IF       9433<<ASSIGN   9546<<ASSIGN
FLAGS.NOCOMPCMD
      7250**DCL      9434<<ASSIGN   9782>>IF       9857<<ASSIGN   9859<<ASSIGN  10804<<ASSIGN  10952<<ASSIGN
     11272<<ASSIGN
FLAGS.NOFLAG
      7261**DCL      9232>>IF       9238<<ASSIGN
FLAGS.OLINPROG
      7263**DCL      9326>>IF       9327<<ASSIGN
FLAGS.OVERFLOWMSG
      7255**DCL      9435<<ASSIGN
FLAGS.PARS_ERR
      7271**DCL      9093<<ASSIGN   9141<<ASSIGN   9196<<ASSIGN   9374<<ASSIGN   9413<<ASSIGN   9424>>IF
      9541<<ASSIGN
FLAGS.RFFLAG
      7249**DCL      9239>>IF       9240<<ASSIGN
FLAGS.STEP_MODE
      7238**DCL      9125<<ASSIGN   9158>>IF       9160>>IF       9167>>IF       9231>>IF       9369>>IF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:426  
      9408>>IF      10482>>IF      10813<<ASSIGN  10936>>IF      11259>>IF
FLAGS.STRCHGCMD
      7258**DCL      9296>>IF       9438<<ASSIGN  10988<<ASSIGN  11127<<ASSIGN  11152<<ASSIGN  11297<<ASSIGN
     11329<<ASSIGN
FLAGS.ST_CMD
      7242**DCL      9170>>IF      10814<<ASSIGN  10815<<ASSIGN
FLAGS.TABMSG
      7257**DCL      9437<<ASSIGN
FLAGS.TXFLAG
      7248**DCL      9232>>IF       9237<<ASSIGN   9361<<ASSIGN
FLAGS.UNDRFLOWMSG
      7256**DCL      9436<<ASSIGN
FLAGS.VERIFY
      7259**DCL      9145>>IF       9214>>IF
FPT_FID
      7023**DCL     11357<>CALL
FPT_FID.V
      7027**DCL      7023--DCLINIT
FT_COUNT
      7190**DCL      9335>>IF       9339<<ASSIGN   9768<<ASSIGN   9768>>ASSIGN
GDS_FPT
      6183**DCL      9042<>CALL
GDS_FPT.V
      6183**DCL      6183--DCLINIT
GETDCB_FPT
      7064**DCL     10245<>CALL
GETDCB_FPT.V
      7065**DCL      7064--DCLINIT
GET_CMD
      9585**PROC     9091--CALL     9130--CALL     9193--CALL
GET_CMD_TBL
      8504**DCL      9608<<ASSIGN   9609<<ASSIGN   9610<<ASSIGN   9611<<ASSIGN   9615>>CALLBLT  9625<<ASSIGN
      9626<<ASSIGN   9627<<ASSIGN   9632<<ASSIGN   9633<<ASSIGN   9641<<ASSIGN   9642<<ASSIGN   9643<<ASSIGN
      9648<<ASSIGN   9649<<ASSIGN   9657<<ASSIGN   9658<<ASSIGN   9659<<ASSIGN   9664<<ASSIGN   9665<<ASSIGN
GOT_CMD IN PROCEDURE GET_CMD
      9670**LABEL    9615--CALLALT  9678--GOTO
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:427  
HELP_CMD_TBL
      8697**DCL     10405--ASSIGN
HELP_CMD_TBL.CMD_CODE
      8699**DCL     10407<<ASSIGN  10408<<ASSIGN
HI_EXEC_CLMN
      7162**DCL     10880<<ASSIGN  10966<<ASSIGN  11023<<ASSIGN
HI_SEQNUM
      7166**DCL      9252>>IF       9281>>IF       9702>>IF      10550>>ASSIGN  10552<>CALL    10557>>IF
     10565>>ASSIGN  10568>>ASSIGN  10609<>CALL    10616>>IF      10618>>ASSIGN  10621>>ASSIGN  10822<<ASSIGN
     10830<>CALL    10832>>IF      10834<<ASSIGN  10956<>CALL
HI_SRCH_CLMN
      7160**DCL      9741<>CALL    10877<>CALL    10880>>ASSIGN  10963<>CALL    10966>>ASSIGN
I
      7197**DCL      9078<<CALLBLT  9081>>CALLBLT  9176<<CALLBLT  9177>>CALLBLT  9525<<DOINDEX  9526>>ASSIGN
      9942<<ASSIGN   9956<<ASSIGN   9973<<ASSIGN   9984<<ASSIGN   9988>>ASSIGN  10045<<ASSIGN  10050<<ASSIGN
     10053>>ASSIGN  10061<<ASSIGN  10061>>ASSIGN  10067<<ASSIGN  10067>>ASSIGN  10070>>IF      10072>>ASSIGN
     10075<<ASSIGN  10075>>ASSIGN  10081>>IF      10084>>ASSIGN  10115<<DOINDEX 10116>>ASSIGN  10193<<ASSIGN
     10199<<ASSIGN  10206>>ASSIGN  10214<<ASSIGN  10214>>ASSIGN  10216>>ASSIGN  10217>>CALL    10220>>IF
     10225>>ASSIGN  10277<<DOINDEX 10278>>ASSIGN  10278>>ASSIGN  10281>>ASSIGN  10324<<DOINDEX 10325>>CALLBLT
     10325>>CALLBLT 10330>>ASSIGN  10332>>IF      10333>>IF      10479<<ASSIGN  10498<<ASSIGN  10504>>IF
     10505>>ASSIGN  10506<<ASSIGN  10507>>CALLBLT 10507>>CALLBLT 10510>>IF      10840<<ASSIGN  10845<<ASSIGN
     10845>>ASSIGN  10847>>CALL    10850>>DOWHILE 10853>>ASSIGN  10854<<ASSIGN  10863<<ASSIGN  10863>>ASSIGN
     10866>>CALL    11191<<ASSIGN  11196<<ASSIGN  11196>>ASSIGN  11198>>CALL    11201>>DOWHILE 11204>>ASSIGN
     11205<<ASSIGN  11214<<ASSIGN  11214>>ASSIGN  11219>>CALL
IBEX_BUILD_CLOSE_ERR
      9104**LABEL    9101--CALLALT
IF_CMD_TBL
      8800**DCL     11236--ASSIGN
IF_CMD_TBL.HI_CLMN
      8803**DCL     11182<<ASSIGN  11231<>CALL
IF_CMD_TBL.LO_CLMN
      8802**DCL     11181<<ASSIGN  11231<>CALL
IF_CMD_TBL.SSE
      8804**DCL     11198--CALL    11219--CALL    11236--ASSIGN
IF_CMD_TBL.SSE.FLAGS
      8805**DCL     11192<<ASSIGN  11203<<ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:428  
IF_CMD_TBL.SSE.FLAGS.ANDFLAG
      8808**DCL     11207<<ASSIGN
IF_CMD_TBL.SSE.FLAGS.EORFLAG
      8810**DCL     11210<<ASSIGN
IF_CMD_TBL.SSE.FLAGS.NOTFLAG
      8807**DCL     11195<<ASSIGN  11213<<ASSIGN
IF_CMD_TBL.SSE.FLAGS.ORFLAG
      8809**DCL     11193<<ASSIGN  11209<<ASSIGN
IF_CMD_TBL.SSE.PTR$
      8813**DCL     11183--IF      11185<<ASSIGN  11217--IF      11224--IF      11226<<ASSIGN
IF_LEVEL
      7195**DCL     11180<<ASSIGN  11192>>ASSIGN  11193>>ASSIGN  11195>>ASSIGN  11198>>CALL    11202<<ASSIGN
     11202>>ASSIGN  11203>>ASSIGN  11207>>ASSIGN  11209>>ASSIGN  11210>>ASSIGN  11213>>ASSIGN  11217>>IF
     11219>>CALL    11223<<ASSIGN  11223>>ASSIGN  11224>>IF      11226>>ASSIGN  11236>>ASSIGN
INT_FPT
      6793**DCL      9017<>CALL
INT_FPT.V
      6793**DCL      6793--DCLINIT
IN_CMD_TBL
      8700**DCL     10477--ASSIGN  10545--ASSIGN  10748--ASSIGN  11016--ASSIGN
IN_CMD_TBL.COLUMN
      8705**DCL     10507<<CALLBLT 10511<<ASSIGN  10511>>ASSIGN  10514<<ASSIGN
IN_CMD_TBL.HI_SEQNUM
      8703**DCL     10495<>CALL    10570<<ASSIGN  10603<<ASSIGN  10623<<ASSIGN  10655<<ASSIGN  10753<>CALL
     11017<>CALL    11023>>ASSIGN
IN_CMD_TBL.LO_SEQNUM
      8702**DCL     10495<>CALL    10549<<ASSIGN  10550<<ASSIGN  10565<<ASSIGN  10568<<ASSIGN  10607<<ASSIGN
     10618<<ASSIGN  10621<<ASSIGN  10630<>CALL    10633>>IF      10750<>CALL    11017<>CALL    11022>>ASSIGN
IN_CMD_TBL.START_SPEC
      8704**DCL     10546<<ASSIGN  10628<<ASSIGN
IN_DCBNUM
      7104**DCL      7065--DCLINIT  9179--ASSIGN   9447>>ASSIGN   9448--ASSIGN   9481>>ASSIGN   9484>>IF
      9495>>ASSIGN   9498<<ASSIGN  10246>>ASSIGN  10256>>ASSIGN  10263>>ASSIGN  10267<<ASSIGN
IN_DQUOTE IN PROCEDURE GET_CMD
      9587**DCL      9605<<ASSIGN   9621>>IF       9624<<ASSIGN   9631<<ASSIGN
IN_SLASH IN PROCEDURE GET_CMD
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:429  
      9596**DCL      9603<<ASSIGN   9653>>IF       9656<<ASSIGN   9663<<ASSIGN
IN_SQUOTE IN PROCEDURE GET_CMD
      9588**DCL      9604<<ASSIGN   9637>>IF       9640<<ASSIGN   9647<<ASSIGN
JU_CMD_TBL
      8777**DCL     11270--ASSIGN
JU_CMD_TBL.EDITKEY.SEQNUM
      8781**DCL     11274<>CALL
JU_CMD_TBL.HELPKEY
      8779**DCL      8780--REDEF
LAST_CMD
      7187**DCL      9391>>IF       9431>>ASSIGN   9432<<ASSIGN   9802<<ASSIGN
LAST_KEY
      7176**DCL      9168<>CALL     9233<>CALL     9252>>IF       9261>>ASSIGN   9270<<ASSIGN   9281>>IF
      9702>>IF      10557>>IF      10615<<ASSIGN  10616>>IF      11093<<ASSIGN  11095>>ASSIGN
LAST_TYPE_CMD
      7189**DCL     10471<<ASSIGN  10789<<ASSIGN  10790<<ASSIGN  10930<<ASSIGN  10931<<ASSIGN  10932<<ASSIGN
LINK_ERR IN PROCEDURE CHECK_LIST
     10171**LABEL   10165--CALLALT
LO_EXEC_CLMN
      7161**DCL     10879<<ASSIGN  10965<<ASSIGN  11022<<ASSIGN
LO_SEQNUM
      7164**DCL      9690<>CALL    10549>>ASSIGN  10607>>ASSIGN  10821<<ASSIGN  10830<>CALL    10832>>IF
     10956<>CALL    11096<>CALL
LO_SRCH_CLMN
      7159**DCL      9741<>CALL    10877<>CALL    10879>>ASSIGN  10963<>CALL    10965>>ASSIGN
M$CLOSE
       533**DCL-ENT  9101--CALL     9329--CALL     9482--CALL    10257--CALL
M$DCB$
      7212**DCL      9179<<ASSIGN   9181>>IF       9181>>IF       9448<<ASSIGN   9465>>IF       9478>>IF
M$EXIT
       545**DCL-ENT  9104--CALL     9350--CALL     9562--CALL
M$FID
       596**DCL-ENT 11357--CALL
M$FILE
      8925**DCL      9013--ASSIGN
M$FILE$
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:430  
      7210**DCL      9013<<ASSIGN   9812>>IF       9812>>IF       9812>>IF      10633>>IF
M$FILE2
      8926**DCL      9014--ASSIGN
M$FILE2$
      7211**DCL      9014<<ASSIGN
M$FILE_NUM
      7198**DCL      9233<>CALL
M$GDS
       568**DCL-ENT  9042--CALL
M$GETDCB
       539**DCL-ENT 10245--CALL
M$INT
       588**DCL-ENT  9017--CALL
M$LINK
       545**DCL-ENT 10165--CALL
M$LM
      8924**DCL      9022--ASSIGN
M$ME.ACTPOS
      8974**DCL      8974--REDEF
M$ME.ARS#
      8933**DCL      8933--REDEF
M$ME.ATTR#
      8963**DCL      8963--REDEF    8965--REDEF
M$ME.BORROW
      8985**DCL      8985--REDEF    8985--REDEF    8985--REDEF
M$ME.DCBNAME.L
      9004**DCL      9004--IMP-SIZ
M$ME.EOMCHAR#
      8940**DCL      8941--REDEF
M$ME.FLDID
      8977**DCL      8978--REDEF
M$ME.FORM$
      8969**DCL      8969--REDEF
M$ME.FSECT
      8992**DCL      8992--REDEF
M$ME.FSN#
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:431  
      8959**DCL      8959--REDEF    8959--REDEF    8960--REDEF
M$ME.HEADER$
      8968**DCL      8969--REDEF
M$ME.IXTNSIZE#
      8965**DCL      8966--REDEF
M$ME.LASTSTA$
      8949**DCL      8949--REDEF
M$ME.LVL
      8986**DCL      8986--REDEF
M$ME.NAME#.C
      8949**DCL      8950--REDEF
M$ME.NOEOF
      8981**DCL      8981--REDEF
M$ME.NRECS#
      8966**DCL      8966--REDEF
M$ME.NRECX
      8993**DCL      8993--REDEF
M$ME.OHDR
      8982**DCL      8982--REDEF
M$ME.ORG#
      8957**DCL      8958--REDEF
M$ME.PRECNO
      8990**DCL      8990--REDEF
M$ME.RCSZ
      8998**DCL      8998--REDEF
M$ME.RES#
      8951**DCL      8951--REDEF
M$ME.SETX
      8970**DCL      8970--REDEF
M$ME.TAB$
      8969**DCL      8969--REDEF
M$ME.TDA
      8989**DCL      8990--REDEF
M$ME.WSN#
      8951**DCL      8952--REDEF
M$OPEN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:432  
       533**DCL-ENT  9028--CALL     9029--CALL     9486--CALL    10249--CALL
M$RELDCB
       539**DCL-ENT  9331--CALL     9496--CALL    10264--CALL
M$SI
      8923**DCL      9012--ASSIGN
M$SI$
      7208**DCL      9012<<ASSIGN   9422>>IF       9422>>IF       9545>>IF       9548>>IF       9556>>IF
M$UC
       557**DCL      9015--ASSIGN
M$UC$
      7209**DCL      9015<<ASSIGN   9032>>ASSIGN
MATCH_CLMN
      7179**DCL      9741<>CALL
MAX_CLMN
      8513**DCL     11182>>ASSIGN  11307>>IF
MAX_SEQNUM
      8511**DCL     10042>>ASSIGN  10203>>ASSIGN  10615>>ASSIGN  10822>>ASSIGN  10834>>ASSIGN  11093>>ASSIGN
     11098>>ASSIGN
ME_DCBNUM
      7105**DCL      9333>>ASSIGN
MK_CMD_TBL
      8763**DCL     10685--ASSIGN
MK_CMD_TBL.HI_SEQNUM
      8766**DCL     10687<>CALL    10695>>IF      10695>>IF
MK_CMD_TBL.HI_SEQNUM2
      8768**DCL     10691<>CALL    10695>>IF      10695>>IF
MK_CMD_TBL.INCR
      8769**DCL     10718<<ASSIGN
MK_CMD_TBL.LO_SEQNUM
      8765**DCL     10687<>CALL    10695>>IF      10695>>IF
MK_CMD_TBL.LO_SEQNUM2
      8767**DCL     10691<>CALL    10695>>IF      10695>>IF
M_CMD_TBL
      8683**DCL     10190--ASSIGN
M_CMD_TBL.FID$
      8685**DCL     10191<<ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:433  
M_CMD_TBL.FID2$
      8691**DCL     10216<<ASSIGN
M_CMD_TBL.HI_SEQNUM
      8688**DCL     10196<>CALL
M_CMD_TBL.HI_SEQNUM.KEY
      8689**DCL     10203<<ASSIGN
M_CMD_TBL.HI_SEQNUM2
      8694**DCL     10217<>CALL
M_CMD_TBL.INCR
      8696**DCL     10221<<ASSIGN  10229<<ASSIGN
M_CMD_TBL.LO_SEQNUM
      8686**DCL     10196<>CALL
M_CMD_TBL.LO_SEQNUM.KEY
      8687**DCL     10202<<ASSIGN
M_CMD_TBL.LO_SEQNUM2
      8692**DCL     10217<>CALL
M_CMD_TBL.ONOVER
      8690**DCL     10209<<ASSIGN  10211<<ASSIGN  10212<<ASSIGN
NEWLINE
      8516**DCL      9545>>IF
NEWLINE_CNTRLWD
      8524**DCL      9114>>ASSIGN
NEXT_REC
      9164**LABEL    9282--GOTO
NO_COLON
      9178**LABEL    9176--CALLALT
NO_MEMORY
      9349**LABEL    9042--CALLALT  9134--CALLALT  9368--CALLALT
NO_MEMORY IN PROCEDURE CHECK_CMD
      9908**LABEL    9903--CALLALT
NO_MEMORY IN PROCEDURE READ_CMD
      9576**LABEL    9531--CALLALT
NO_MORE_SPACE IN PROCEDURE CHECK_IF
     11244**LABEL   11184--GOTO    11218--GOTO    11225--GOTO
NUM_TABS
      7201**DCL      9033>>DOWHILE  9033>>DOWHILE  9034<<ASSIGN   9034>>ASSIGN  10299<<ASSIGN  10305<<ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:434  
     10311<<ASSIGN  10345<<ASSIGN  10350<<ASSIGN
OPEN_DO
      6370**DCL      9029<>CALL
OPEN_DO.ACSVEH_
      6372**DCL      6373--REDEF
OPEN_DO.ALTKEYS_
      6378**DCL      6379--REDEF    6379--REDEF
OPEN_DO.HDR_
      6377**DCL      6378--REDEF
OPEN_DO.TAB_
      6376**DCL      6377--REDEF
OPEN_DO.UHL_
      6370**DCL      6371--REDEF    6371--REDEF
OPEN_DO.V
      6379**DCL      6370--DCLINIT
OPEN_DO.V.FSN#
      6410**DCL      6410--REDEF    6410--REDEF
OPEN_DO.WSN_
      6376**DCL      6376--REDEF
OPEN_FILE_NAME
      7133**DCL      6531--DCLINIT
OPEN_ME
      6260**DCL      9028<>CALL
OPEN_ME.ACSVEH_
      6262**DCL      6263--REDEF
OPEN_ME.ALTKEYS_
      6268**DCL      6269--REDEF    6269--REDEF
OPEN_ME.HDR_
      6267**DCL      6268--REDEF
OPEN_ME.TAB_
      6266**DCL      6267--REDEF
OPEN_ME.UHL_
      6260**DCL      6261--REDEF    6261--REDEF
OPEN_ME.V
      6269**DCL      6260--DCLINIT
OPEN_ME.V.FSN#
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:435  
      6300**DCL      6300--REDEF    6300--REDEF
OPEN_ME.WSN_
      6266**DCL      6266--REDEF
OPEN_SIME_FPT
      6646**DCL      9486<>CALL
OPEN_SIME_FPT.ACSVEH_
      6648**DCL      6649--REDEF
OPEN_SIME_FPT.ALTKEYS_
      6654**DCL      6655--REDEF    6655--REDEF
OPEN_SIME_FPT.HDR_
      6653**DCL      6654--REDEF
OPEN_SIME_FPT.TAB_
      6652**DCL      6653--REDEF
OPEN_SIME_FPT.UHL_
      6646**DCL      6647--REDEF    6647--REDEF
OPEN_SIME_FPT.V
      6655**DCL      6646--DCLINIT
OPEN_SIME_FPT.V.FSN#
      6686**DCL      6686--REDEF    6686--REDEF
OPEN_SIME_FPT.WSN_
      6652**DCL      6652--REDEF
OPEN_SIREAD_FPT
      6530**DCL     10242<>CALL    10249<>CALL
OPEN_SIREAD_FPT.ACSVEH_
      6532**DCL      6533--REDEF
OPEN_SIREAD_FPT.ALTKEYS_
      6538**DCL      6539--REDEF    6539--REDEF
OPEN_SIREAD_FPT.HDR_
      6537**DCL      6538--REDEF
OPEN_SIREAD_FPT.TAB_
      6536**DCL      6537--REDEF
OPEN_SIREAD_FPT.UHL_
      6530**DCL      6531--REDEF    6531--REDEF
OPEN_SIREAD_FPT.V
      6539**DCL      6530--DCLINIT
OPEN_SIREAD_FPT.V.DCB#
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:436  
      6539**DCL     10246<<ASSIGN
OPEN_SIREAD_FPT.V.FSN#
      6570**DCL      6570--REDEF    6570--REDEF
OPEN_SIREAD_FPT.WSN_
      6536**DCL      6536--REDEF
OUT$BLK.CODE
      8579**DCL      9198>>DOCASE   9801>>ASSIGN   9928>>IF       9959>>IF       9961>>IF       9977>>IF
     10033>>IF      10033>>IF      10035>>IF      10054>>IF      10056>>IF      10073>>IF      10116>>ASSIGN
     10195>>IF      10208>>IF      10210>>IF      10278>>ASSIGN  10294>>DOCASE  10390>>IF      10392>>ASSIGN
     10408>>ASSIGN  10480>>IF      10584>>IF      10839>>IF      10843>>IF      10855>>IF      10857>>IF
     10861>>IF      10955>>IF      11070>>IF      11101>>IF      11101>>IF      11190>>IF      11194>>IF
     11206>>IF      11208>>IF      11212>>IF
OUT$BLK.NSUBLKS
      8583**DCL      9942>>ASSIGN   9953>>IF       9974>>IF       9985>>IF      10024>>IF      10041>>IF
     10070>>IF      10081>>IF      10106>>IF      10112>>ASSIGN  10130>>IF      10220>>IF      10277>>DOINDEX
     10314>>IF      10324>>DOINDEX 10340>>IF      10350>>ASSIGN  10406>>IF      10480>>IF      10504>>IF
     10506>>ASSIGN  10548>>IF      10644>>IF      10711>>IF      10791>>IF      10819>>IF      10828>>IF
     10837>>IF      10850>>DOWHILE 10873>>IF      10934>>IF      10936>>IF      10958>>IF      11055>>IF
     11081>>IF      11101>>IF      11187>>IF      11201>>DOWHILE 11227>>IF      11348>>IF
OUT$BLK.SUBLK$
      8604**DCL      9928>>IF       9945>>ASSIGN   9945>>ASSIGN   9958>>ASSIGN   9962>>ASSIGN   9976>>ASSIGN
      9979>>ASSIGN   9988>>ASSIGN   9989>>IF      10001>>ASSIGN  10001>>ASSIGN  10022>>ASSIGN  10022>>ASSIGN
     10031>>ASSIGN  10039>>ASSIGN  10040>>ASSIGN  10053>>ASSIGN  10057>>ASSIGN  10072>>ASSIGN  10076>>ASSIGN
     10084>>ASSIGN  10085>>IF      10096>>ASSIGN  10096>>ASSIGN  10112>>ASSIGN  10116>>ASSIGN  10116>>ASSIGN
     10133>>ASSIGN  10133>>ASSIGN  10191>>ASSIGN  10191>>ASSIGN  10194>>ASSIGN  10206>>ASSIGN  10216>>ASSIGN
     10216>>ASSIGN  10217<>CALL    10225>>ASSIGN  10226<>CALL    10242>>CALL    10242<>CALL    10278>>ASSIGN
     10292>>ASSIGN  10325>>CALLBLT 10325>>CALLBLT 10325>>CALLBLT 10325>>CALLBLT 10364>>IF      10364>>IF
     10376>>ASSIGN  10376>>ASSIGN  10376>>ASSIGN  10376>>ASSIGN  10390>>IF      10392>>ASSIGN  10408>>ASSIGN
     10433<>CALL    10436<>CALL    10480>>IF      10495<>CALL    10505>>ASSIGN  10507>>CALLBLT 10507>>CALLBLT
     10507>>CALLBLT 10507>>CALLBLT 10584>>IF      10585>>ASSIGN  10586<>CALL    10630<>CALL    10645>>ASSIGN
     10646<>CALL    10687<>CALL    10691<>CALL    10712>>ASSIGN  10713<>CALL    10750<>CALL    10753<>CALL
     10830<>CALL    10838>>ASSIGN  10843>>IF      10847<>CALL    10853>>ASSIGN  10855>>IF      10857>>IF
     10861>>IF      10866<>CALL    10874>>ASSIGN  10905>>CALLBLT 10905>>CALLBLT 10905>>CALLBLT 10905>>CALLBLT
     10954>>ASSIGN  10959>>ASSIGN  10991<>CALL    10995<>CALL    11017<>CALL    11070>>IF      11071>>ASSIGN
     11072<>CALL    11078<>CALL    11082>>ASSIGN  11083<>CALL    11130<>CALL    11155<>CALL    11159<>CALL
     11189>>ASSIGN  11194>>IF      11198<>CALL    11204>>ASSIGN  11206>>IF      11208>>IF      11212>>IF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:437  
     11219<>CALL    11228>>ASSIGN  11274<>CALL    11300<>CALL    11303>>ASSIGN  11303>>ASSIGN  11304>>ASSIGN
     11304>>ASSIGN  11332<>CALL    11336<>CALL    11352>>ASSIGN  11356>>ASSIGN  11356>>ASSIGN
OUT$SYM.CODE
      8623**DCL     11352>>ASSIGN
OUT$SYM.COUNT
      8640**DCL      8643--IMP-SIZ 11356>>ASSIGN
OUT$SYM.TEXT
      8643**DCL     11356>>ASSIGN
P$
      7206**DCL      9955<<ASSIGN   9974>>IF       9976>>ASSIGN   9985>>IF       9988>>ASSIGN  10030<<ASSIGN
     10039>>ASSIGN  10041>>IF      10053>>ASSIGN  10070>>IF      10072>>ASSIGN  10081>>IF      10084>>ASSIGN
     10990<<ASSIGN  10991<>CALL    10994<<ASSIGN  10994>>ASSIGN  10995<>CALL    11129<<ASSIGN  11130<>CALL
     11154<<ASSIGN  11155<>CALL    11158<<ASSIGN  11158>>ASSIGN  11159<>CALL    11299<<ASSIGN  11300<>CALL
     11331<<ASSIGN  11332<>CALL    11335<<ASSIGN  11335>>ASSIGN  11336<>CALL
PARSE1_ERR
      9072**LABEL    9092--CALLALT
PARSE_ERR
      9367**LABEL    9077--GOTO     9140--CALLALT  9195--CALLALT
PCLLINK_FPT
      6845**DCL     10165<>CALL
PCLLINK_FPT.V
      6847**DCL      6847--DCLINIT
PCLNAME
      6878**DCL      6845--DCLINIT
P_ALLCMDS
      8867**DCL      7344--DCLINIT  7546--DCLINIT  7744--DCLINIT  9943--ASSIGN
P_GET
      7339**DCL      8236--DCLINIT
P_GET.NCHARS
      7486**DCL      9506>>IF       9508>>ASSIGN   9509>>ASSIGN
P_PCB
      7541**DCL      9092<>CALL     9140<>CALL     9195<>CALL
P_PCB.ERROR
      7645**DCL      9414>>ASSIGN
P_PCB.ERROR.CODE
      7653**DCL      9367>>IF       9373>>IF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:438  
P_PCB.HI_CHAR
      7692**DCL      9400>>CALL
P_PCB.NCHARS
      7688**DCL      9400>>CALL     9671<<ASSIGN   9784>>CALL    10163>>ASSIGN
P_PCB.OUT$
      7554**DCL      9198>>DOCASE   9781>>ASSIGN  10206>>ASSIGN  10215>>ASSIGN  10873>>IF      10874>>ASSIGN
     10958>>IF      10959>>ASSIGN  11227>>IF      11228>>ASSIGN
P_PCB.ROOT$
      7546**DCL      9943<<ASSIGN
P_PCB.TEXT$
      7542**DCL     10162>>ASSIGN
P_PCB.WORK$
      7550**DCL      9059<<ASSIGN   9061>>ASSIGN
RAN_OUT_OF_CMD_SPACE
      9134**LABEL    9070--REMEMBR
READ_CMD
      9420**PROC     9110--CALL     9187--CALL
READ_CMD_AGAIN IN PROCEDURE READ_CMD
      9429**LABEL    9472--GOTO     9504--GOTO     9513--GOTO     9565--GOTO
READ_CMD_ERR IN PROCEDURE READ_CMD
      9555**LABEL    9469--GOTO     9486--CALLALT  9516--GOTO     9520--GOTO
READ_DCB_NAME
      7095**DCL      7064--DCLINIT
READ_FIRST_ERR IN PROCEDURE READ_FIRST_REC
      9717**LABEL    9690--CALLALT  9692--CALLALT
READ_FIRST_REC
      9684**PROC     9159--CALL
READ_NEXT
      9237**LABEL    9164--CALLALT  9189--GOTO     9224--GOTO     9364--GOTO
READ_SI_ERR IN PROCEDURE READ_CMD
      9561**LABEL    9423--GOTO
REC_BUF
      7101**DCL      9171>>CALLBLT
REC_SIZE
      7153**DCL      9171>>CALLBLT
RELDCB_ERR
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:439  
      9333**LABEL    9331--CALLALT
RELDCB_ERR IN PROCEDURE READ_CMD
      9498**LABEL    9496--CALLALT
RELDCB_FPT
      7047**DCL      9331<>CALL     9496<>CALL    10264<>CALL
RELDCB_FPT.V
      7047**DCL      7047--DCLINIT
RELDCB_FPT.V.DCB#
      7047**DCL      9330<<ASSIGN   9495<<ASSIGN  10263<<ASSIGN
REMEM_CMD_READ
      7232**DCL      9019<<REMEMBR
REMEM_STEP_CMD
      7233**DCL      9020<<REMEMBR
RL_CMD_TBL
      8745**DCL     11295--ASSIGN
RL_CMD_TBL.SHIFT#
      8757**DCL     11305<<CALLBLT 11307>>IF
SAVED_CMD
      7188**DCL      9431<<ASSIGN
SAVE_KEY
      7178**DCL      9261<<ASSIGN   9270>>ASSIGN
SAVE_TAB_VLP
      6825**DCL      9036<<ASSIGN
SEED
      7200**DCL     10107<<ASSIGN  10111<<ASSIGN  10116<<ASSIGN  10116>>ASSIGN
SEQNUM_ONE
      8523**DCL      9946>>ASSIGN   9947>>ASSIGN  10018>>ASSIGN  10019>>ASSIGN
SEQ_TEXT_BUF
      7124**DCL      9171>>CALLBLT  9176>>CALLBLT  9177<<CALLBLT  9178>>ASSIGN
SINGLE_AST
      8520**DCL      9449--ASSIGN
SI_DCBNUM
      7106**DCL      9484>>IF       9498>>ASSIGN  10267>>ASSIGN
SSE$
      7219**DCL      9024<<ASSIGN   9025>>ASSIGN   9058>>ASSIGN  10793<<ASSIGN  10794>>ASSIGN  10841>>ASSIGN
     10842>>ASSIGN  10844>>ASSIGN  10847<>CALL    10851<<ASSIGN  10851>>ASSIGN  10852>>ASSIGN  10856>>ASSIGN
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:440  
     10858>>ASSIGN  10859>>ASSIGN  10862>>ASSIGN  10866<>CALL    10871<<ASSIGN  10871>>ASSIGN  10872>>ASSIGN
     10949<<ASSIGN  10950>>ASSIGN
SSE$ IN PROCEDURE CHECK_SSE
      9722**DCL      9732<<ASSIGN   9733>>IF       9737>>ASSIGN   9741<>CALL     9765<<ASSIGN   9765>>ASSIGN
      9766>>IF
SSE$PARAM.FLAGS
      8543**DCL      9737>>ASSIGN  10841<<ASSIGN  10852<<ASSIGN
SSE$PARAM.FLAGS.ANDFLAG
      8547**DCL     10856<<ASSIGN
SSE$PARAM.FLAGS.EORFLAG
      8549**DCL     10859<<ASSIGN
SSE$PARAM.FLAGS.NOTFLAG
      8546**DCL     10844<<ASSIGN  10862<<ASSIGN
SSE$PARAM.FLAGS.ORFLAG
      8548**DCL     10842<<ASSIGN  10858<<ASSIGN
SSE$PARAM.PTR$
      8552**DCL      9058<<ASSIGN   9733>>IF       9766>>IF      10794<<ASSIGN  10872<<ASSIGN  10950<<ASSIGN
SSE_EVAL IN PROCEDURE CHECK_SSE
      9730**DCL      9734<<ASSIGN   9738>>IF       9739>>IF       9743>>IF       9745<<ASSIGN   9747>>IF
      9750<<ASSIGN   9755>>IF       9757<<ASSIGN   9759>>IF       9762<<ASSIGN   9767>>IF
SSE_INIT$
      7220**DCL      9025<<ASSIGN
SSE_TBL
      7148**DCL      9024--ASSIGN   9732--ASSIGN  10793--ASSIGN  10949--ASSIGN
STEP_CMD_READ
      9187**LABEL    9020--REMEMBR  9193--CALLALT  9205--GOTO     9212--CALLALT  9258--GOTO     9408--GOTO
STEP_CMD_RETRY
      9195**LABEL    9369--GOTO
STEP_DONE
      9286**LABEL    9019--REMEMBR  9190--GOTO     9246--GOTO     9250--GOTO     9253--GOTO     9263--CALLALT
      9272--GOTO     9362--GOTO
STR$BUF.COUNT
      8554**DCL      9989>>IF      10001>>ASSIGN  10085>>IF      10096>>ASSIGN  10325>>CALLBLT 10364>>IF
     10376>>ASSIGN  10507>>CALLBLT 10905>>CALLBLT 11303>>ASSIGN
STR$BUF.TEXT
      8555**DCL     10001>>ASSIGN  10096>>ASSIGN  10325>>CALLBLT 10376>>ASSIGN  10507>>CALLBLT 10905>>CALLBLT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:441  
     11304>>ASSIGN
STRCHG_COUNT
      7193**DCL      9107<<ASSIGN   9296>>IF       9297<>CALL
STR_BUF.COUNT
      7122**DCL     11303<<ASSIGN  11305>>CALLBLT
STR_BUF.TEXT
      7123**DCL     11304<<ASSIGN  11305>>CALLBLT
STR_CMD_TBL
      8711**DCL     10986--ASSIGN  11150--ASSIGN  11327--ASSIGN
STR_FLGS IN PROCEDURE CHECK_SSE
      9723**DCL      9737<<ASSIGN
STR_FLGS.ANDFLAG IN PROCEDURE CHECK_SSE
      9726**DCL      9739>>IF       9747>>IF       9759>>IF
STR_FLGS.EORFLAG IN PROCEDURE CHECK_SSE
      9728**DCL      9743>>IF       9747>>IF       9755>>IF       9759>>IF
STR_FLGS.NOTFLAG IN PROCEDURE CHECK_SSE
      9725**DCL      9743>>IF       9747>>IF       9747>>IF       9755>>IF       9759>>IF       9759>>IF
STR_FLGS.ORFLAG IN PROCEDURE CHECK_SSE
      9727**DCL      9738>>IF       9743>>IF       9755>>IF
STR_LEN IN PROCEDURE GET_CMD
      9590**DCL      9612<<ASSIGN   9615>>CALLBLT
STR_TEXT$
      7225**DCL      9053<<ASSIGN   9054>>ASSIGN   9055>>ASSIGN   9056>>ASSIGN   9137<<ASSIGN   9156>>ASSIGN
      9223>>ASSIGN   9227<<ASSIGN   9443<<ASSIGN  10795<<ASSIGN  10870>>ASSIGN
STR_TEXT_END$
      7227**DCL      9056<<ASSIGN   9059>>ASSIGN
STR_TEXT_HEAD$
      7226**DCL      9054<<ASSIGN   9137>>ASSIGN  10795>>ASSIGN  10796>>ASSIGN
STR_TEXT_QM$
      7229**DCL      9156<<ASSIGN   9223<<ASSIGN   9227>>ASSIGN
STR_TEXT_SE$
      7228**DCL      9055<<ASSIGN   9443>>ASSIGN  10796<<ASSIGN  10870<<ASSIGN
SUB_BUF_1
      7112**DCL      9119<>CALL     9287<>CALL     9297<>CALL     9308<>CALL     9317<>CALL     9400<>CALL
      9784<>CALL
SYSACCT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:442  
      6893**DCL      6845--DCLINIT
TAB$VLP
      6922**DCL      9032>>ASSIGN
TAB_VLP
      6809**DCL      9032<<ASSIGN   9036>>ASSIGN
TAB_VLP.TABS#
      6809**DCL      9033>>DOWHILE
TA_CMD_TBL
      8770**DCL     10275--ASSIGN  10291--ASSIGN
TA_CMD_TBL.NUM_TABS
      8773**DCL     10281<<ASSIGN
TA_CMD_TBL.TABS
      8772**DCL     10278<<ASSIGN  10296<<ASSIGN  10297<<ASSIGN  10298<<ASSIGN  10302<<ASSIGN  10303<<ASSIGN
     10304<<ASSIGN  10308<<ASSIGN  10309<<ASSIGN  10310<<ASSIGN  10330<<ASSIGN  10333>>IF
TBLVAL IN PROCEDURE GET_CMD
      9589**DCL      9615<<CALLBLT  9618>>DOSELCT
TBUF
      8503**DCL      7026--DCLINIT
TEMP_CLMN
      7180**DCL      9606<<ASSIGN   9614>>DOWHILE  9615<<CALLBLT  9615>>CALLBLT  9670>>ASSIGN   9671>>ASSIGN
      9672>>ASSIGN   9676<<ASSIGN   9676>>ASSIGN  10113<<ASSIGN  10116>>ASSIGN  10118<<ASSIGN  10118>>ASSIGN
TEMP_CMD_BUF
      7108**DCL      9425<<ASSIGN
TEMP_CMD_SIZE
      7156**DCL      9426<<ASSIGN
TEMP_COUNT
      7181**DCL      9526<<ASSIGN   9527>>ASSIGN   9528>>CALLBLT  9529>>ASSIGN  10112<<ASSIGN  10115>>DOINDEX
     10116>>ASSIGN  10325<<CALLBLT 10330>>ASSIGN  10333>>IF      10339>>IF
TN_CMD_TBL
      8794**DCL     10901--ASSIGN
TN_CMD_TBL.COUNT
      8796**DCL     10905<<CALLBLT
TRNC_COUNT
      7194**DCL      9316>>IF       9317<>CALL     9319<<ASSIGN
TYPE_BUF
      7109**DCL      6846--DCLINIT
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:443  
TYPE_BUF.TEXT
      7111**DCL      9037<<CALLBLT  9171<<CALLBLT  9178<<ASSIGN  10162<<ASSIGN
TYPE_BUF.VFC
      7110**DCL     10163<<ASSIGN  10167<<ASSIGN  10176<<ASSIGN
TYPE_CMD_TBL
      8788**DCL     10362--ASSIGN
TYPE_CMD_TBL.CODE
      8790**DCL     10376<<ASSIGN
TYPE_CODE
      7146**DCL      9949>>ASSIGN
TY_DCBNUM
      7103**DCL      9328>>ASSIGN   9330>>ASSIGN   9333<<ASSIGN
VARY$STRC.CNT
      8820**DCL      8821--IMP-SIZ
VEM$MASTER
      8856**DCL-ENT  9117--CALL     9229--CALL
VERIFY_TYPE
      7204**DCL      9148>>ASSIGN   9217>>ASSIGN
VEX$BREAK
      8854**DCL-ENT  6793--DCLINIT
VEX$BUILD_SEQNUM
      8846**DCL-ENT  9963--CALL     9969--CALL     9980--CALL    10058--CALL    10065--CALL    10077--CALL
     10226--CALL    10433--CALL    10586--CALL    10630--CALL    10646--CALL    10713--CALL    10750--CALL
     10753--CALL    11072--CALL    11078--CALL    11083--CALL    11274--CALL
VEX$CHECK_FIRST
      8852**DCL-ENT  9916--CALL     9940--CALL    10012--CALL    10126--CALL    10143--CALL    10155--CALL
     10185--CALL    10240--CALL    10289--CALL    10386--CALL    10403--CALL    10429--CALL    10493--CALL
     10543--CALL    10683--CALL    10746--CALL    10792--CALL    10903--CALL    10947--CALL
VEX$CLMN_DFLT
      8838**DCL-ENT  9026--CALL    10797--CALL    10948--CALL
VEX$ERRMAX
      8835**DCL-ENT  9415--CALL
VEX$ERROR
      8832**DCL-ENT  9120--CALL     9204--CALL     9271--CALL     9288--CALL     9298--CALL     9309--CALL
      9318--CALL     9337--CALL     9349--CALL     9392--CALL     9401--CALL     9468--CALL     9471--CALL
      9477--CALL     9487--CALL     9519--CALL     9561--CALL     9564--CALL     9576--CALL     9694--CALL
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:444  
      9704--CALL     9785--CALL     9788--CALL     9816--CALL     9908--CALL     9919--CALL     9991--CALL
     10087--CALL    10158--CALL    10175--CALL    10262--CALL    10315--CALL    10334--CALL    10341--CALL
     10366--CALL    10420--CALL    10449--CALL    10459--CALL    10468--CALL    10483--CALL    10525--CALL
     10536--CALL    10562--CALL    10574--CALL    10590--CALL    10635--CALL    10651--CALL    10666--CALL
     10676--CALL    10700--CALL    10729--CALL    10739--CALL    10765--CALL    10778--CALL    10892--CALL
     10918--CALL    10937--CALL    10977--CALL    11007--CALL    11034--CALL    11044--CALL    11057--CALL
     11116--CALL    11141--CALL    11171--CALL    11251--CALL    11260--CALL    11286--CALL    11318--CALL
     11362--CALL    11382--CALL
VEX$ERROR_NO_PRINT
      8833**DCL-ENT 10173--CALL
VEX$FID_2_FPT
      8829**DCL-ENT 10242--CALL
VEX$FIND_MATCH
      8828**DCL-ENT  9741--CALL
VEX$GET_NEXT_KEY
      8858**DCL-ENT 10556--CALL
VEX$PARSE_CLMNRANGE
      8848**DCL-ENT 10436--CALL    10877--CALL    10963--CALL    11017--CALL    11231--CALL
VEX$PARSE_CLMNSTRING
      8851**DCL-ENT 10991--CALL    10995--CALL    11155--CALL    11300--CALL
VEX$PARSE_JSTRING
      8850**DCL-ENT 10847--CALL    10866--CALL    11130--CALL    11198--CALL    11219--CALL    11332--CALL
VEX$PARSE_SEQRANGE
      8847**DCL-ENT 10196--CALL    10217--CALL    10495--CALL    10687--CALL    10691--CALL    10830--CALL
     10956--CALL
VEX$PARSE_STRING
      8849**DCL-ENT 11159--CALL    11336--CALL
VEX$READ_RANDOM
      8827**DCL-ENT  9690--CALL    10552--CALL    10609--CALL    11090--CALL    11096--CALL
VEX$READ_SEQUEN
      8826**DCL-ENT  9263--CALL     9692--CALL    10613--CALL    11092--CALL
VEX$SEQNUM_TEXT
      8844**DCL-ENT  9168--CALL
VEX$SET_PROMPT
      8845**DCL-ENT  9109--CALL     9169--CALL
VEX$SET_SUB_BUF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:445  
      8853**DCL-ENT  9119--CALL     9287--CALL     9297--CALL     9308--CALL     9317--CALL     9400--CALL
      9784--CALL
VEX$TYPE_REC
      8837**DCL-ENT  9039--CALL     9173--CALL     9184--CALL
VEX$WRITE_REC
      8830**DCL-ENT  9233--CALL
VEX$XPAND
      8857**DCL-ENT  9134--CALL     9368--CALL     9531--CALL     9903--CALL
VEX$XPARSE_ENT
      8855**DCL-ENT  7357--DCLINIT  7559--DCLINIT  7993--DCLINIT
VE_CMD_TBL
      8797**DCL     10388--ASSIGN
VE_CMD_TBL.TYPE
      8799**DCL     10391<<ASSIGN  10392<<ASSIGN
VE_ERRMSGACCT.ACCT#
      6908**DCL      9022<<ASSIGN
WRITE_ALT
      9359**LABEL    9233--CALLALT
X$PARSE
      8860**DCL-ENT  9092--CALL     9140--CALL     9195--CALL
XTX$ADAPT
      8098**DCL-ENT  8414--DCLINIT
XUG$GETCMD
      6140**DCL-ENT  9456--CALL
XUG$GETCMD_
      7743**DCL      9030<>CALL     9456<>CALL
XUG$GETCMD_.BUF$
      8020**DCL      9506>>IF       9509>>ASSIGN   9527>>ASSIGN
XUG$GETCMD_.ERR#.CODE#
      7757**DCL      9458>>DOSELCT  9475>>IF       9502>>IF       9502>>IF
XUG$GETCMD_.INDCB#
      7914**DCL      9447<<ASSIGN
XUG$GETCMD_.NLINES
      8059**DCL      9525>>DOINDEX
XUG$GETCMD_.OUT$
      7748**DCL      7754--REDEF
PL6.E3A0      #001=VEE$EDIT File=VEE$EDIT.:E05TSI                                WED 07/30/97 07:04 Page:446  
XUG$GETCMD_.PROMPT_
      7952**DCL      9449<<ASSIGN
XUG$GETCMD_.RLT$
      8025**DCL      9526>>ASSIGN
XUG$GETCMD_.TEXT_
      8006**DCL      9451<<ASSIGN   9455<<ASSIGN
XUG$INIT
      6144**DCL-ENT  9030--CALL
XUG$INIT_
      8103**DCL      9030<>CALL
XUG_RLT
      8561**DCL      9526>>ASSIGN
Y003
      8514**DCL      9245>>ASSIGN   9947>>ASSIGN   9964>>ASSIGN   9981>>ASSIGN  10019>>ASSIGN  10059>>ASSIGN
     10078>>ASSIGN  10202>>ASSIGN  10228>>ASSIGN  10588>>ASSIGN  10633>>IF      10648>>ASSIGN  10715>>ASSIGN
     10821>>ASSIGN  11074>>ASSIGN  11085>>ASSIGN
