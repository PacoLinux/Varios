VERSION E05

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:1    
        1        1        /*M* KJF$FEI - FEI handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        KJF$FEI: PROC MAIN;
       10       10
       11       11        %INCLUDE G_JIT_M;
       12      276        %INCLUDE KJ_DATA_R;
       13    10517        %INCLUDE KH$CLK;
       14    10887        %INCLUDE KH_MACRO_C;
       15    11630        %INCLUDE KL_CONTROL_C;
       16    12010        %INCLUDE G$BOBCAT_M;
       17    12030        %INCLUDE K_ID_E;
       18    12080          %K#ENTID_E;
       19    12099
       20    12100        %INCLUDE KV$VDH;
       21    12531        /* LCP6 fpt's */
       22    12532        %FPT_SPRIV (AUTH=YES,PRC=YES,PRIV=PRIVS);
       23    12555        %FPT_INTCON (PRIVILEGED=YES);
       24    12576
       25    12577        %FPT_WAIT (FPTN=FPT_WAIT,UNITS=KJ_TIME,UETIME=KJ_TIME_LEFT,UTYPE=TICS);
       26    12601        %FPT_WRTMLT (DCB=M$CQ);
       27    12621        %FPT_GDS(FPTN=FPT_GETMEM,FREE=YES,NEXT=BIG,PAGES=2,RESULTS=MEMORY_RESULTS);
       28    12645                %VLP_SEGMENT(FPTN=MEMORY_RESULTS);
       29    12666
       30    12667        /* Write FPT to send msg to BABOON through NODEADMN to change the
       31    12668           FEP screech interrupt level for the host */
       32    12669        %FPT_WRITE ( FPTN = WRITE_NODEADMN ,
       33    12670                     BUF  = KL_CHSCRLVL ) ;
       34    12694        %KL_CHSCRLVL ( STCLASS = CONSTANT ) ;
       35    12733        %FPT_GETDCB ( DCBNAME = M$NA_NAME ,
       36    12734                      DCBNUM = M$NA_DCBNUM ) ;
       37    12754    1   DCL M$NA_DCBNUM UBIN WORD STATIC ;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:2    
       38    12755        %VLP_NAME ( FPTN = M$NA_NAME ,
       39    12756                    NAME = 'M$NA' ,
       40    12757                    STCLASS = CONSTANT ) ;
       41    12772
       42    12773        /* FPT for opening the Handler Monitor Interface */
       43    12774        %FPT_OPEN (FPTN=OPEN_HMI,
       44    12775             DCB=M$CQ,
       45    12776                       HMI=VLP_HMI,
       46    12777                       ORG=CQ,
       47    12778                       STCLASS=CONSTANT);
       48    12806        %VLP_HMI (FPTN=VLP_HMI,
       49    12807                       IO=YES,
       50    12808                       CTXSIZE="SIZEW(KJ$CTX)",
       51    12809                       STCLASS=STATIC);
       52    12825
       53    12826        /* Entry references */
       54    12827        %KH_ENTDEFS;
       55    12834    1   DCL KHC$DISPATCH ENTRY(1) ALTRET;
       56    12835    1   DCL KHC$WAIT ENTRY ALTRET;
       57    12836    1   DCL KVB$INT ENTRY(1) ALTRET;
       58    12837    1   DCL KJF$ADM ENTRY(1) ALTRET;
       59    12838    1   DCL KJF$IO ENTRY(1) ALTRET;
       60    12839    1   DCL GHH$LEV ENTRY(1) ALTRET;
       61    12840    1   DCL KJF$DATA ENTRY;
       62    12841    1   DCL KJF$INTHAND ENTRY ASYNC;
       63    12842
       64    12843        /* Local variables */
       65    12844        %GH_IO (STCLASS="");
       66    12860    1   DCL DCW$ PTR;
       67    12861
       68    12862        /* Symrefs */
       69    12863    1   DCL KH_CHNHI UBIN SYMREF;
       70    12864    1   DCL G$DS4$ PTR SYMREF;
       71    12865
       72    12866        /* Based structures */
       73    12867        %G$BOBCAT(STCLASS="BASED(G$DS4$)");
       74    12880        %KNH$MESS (STCLASS=BASED);
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:3    
       75    12929        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
       76    12942
       77    12943        /* Macro invocations */
       78    12944        %G$JIT_E;
       79    13006        %GH_LEV (FPTN=DISABLE,TYPE=INHIBIT,STCLASS=STATIC);
       80    13028        %GH_LEV (FPTN=ENABLE,TYPE=ENABLE,STCLASS=STATIC);
       81    13050        %KH$EXP (STCLASS=CONSTANT);
       82    13113        %KH$CTLTBL (STCLASS=STATIC,
       83    13114                       HIPARM=%KL_FEI_HI);
       84    13326    1   DCL KH_CTLTBL$ PTR SYMREF;
       85    13327        %KV$VDH_VDHINT (STCLASS=STATIC);
       86    13346
       87    13347        /* Constant data */
       88    13348    1   DCL PRIVS BIT(32) CONSTANT INIT(
       89    13349    1   %(G_PR_MSYS#|G_PR_INTCON#|G_PR_CQ#|G_PR_SCREECH#|G_PR_SNAP#|G_PR_EXMM#|G_PR_SPCLMM#)
             13349            );
       90    13350
       91    13351        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:4    
       92    13352
       93    13353    1        CALL M$SPRIV (FPT_SPRIV);
       94    13354    1        CALL M$SYS;
       95    13355    1        CALL KHA$INIT;
       96    13356    1        KH_CTLTBL$ = ADDR(KH$CTLTBL);
       97    13357    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_MEM) = ADDR(FPT_GETMEM.V.PAGES);
       98    13358    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_INTLVL) = ADDR(KJ_CONTROL.INTLVL);
       99    13359    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_RES) = ADDR(KJ_CONTROL.RES);
      100    13360    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_ATTR) = ADDR(KJ_CONTROL.ATTR);
      101    13361    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_RCVCQBYTSIZ) = ADDR(KJ_CONTROL.ICQPGS);
      102    13362    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_SNDCQBYTSIZ) = ADDR(KJ_CONTROL.OCQPGS);
      103    13363    1        KH$CTLTBL.PARM.PTR$(%KL_FEI_MAXICQTIME) = ADDR(KJ_CONTROL.INTHTIME);
      104    13364    1        KH$CTLTBL.PARM.PTR$(%KL_FEI_OCQDBLKSIZ) = ADDR(KJ_CONTROL.OCQDBLKSIZ);
      105    13365    1        CALL KHA$INIT_CONTROL(KH$CTLTBL);
      106    13366    1        CALL M$GDS (FPT_GETMEM);
      107    13367    1        KV$VDH_VDHINT.BFRBGN$ = MEMORY_RESULTS.BASE$;
      108    13368    1        KV$VDH_VDHINT.BFREND$=PINCRW(MEMORY_RESULTS.BASE$,MEMORY_RESULTS.PAGES*256);
      109    13369    1        CALL KVB$INT(KV$VDH_VDHINT);
      110    13370    1        CALL KHA$INIT_CHANTBL(KJ_CONTROL.RES,KJ_CONTROL.ATTR,ENTADDR(KJF$ADM));
      111    13371    1        CALL KHA$INIT_DONE;
      112    13372    1        KJ_DPS8000_FLG = G$BOBCAT.DPS8000FLG;
      113    13373
      114    13374    1        KJ_STATS.REQSTATS.DSPENT(%KH#ENTID_FEI) = '1'B;
      115    13375    1        KJ_STATS.REQSTATS.SLCENT(%KH#ENTID_FEI) = '1'B;
      116    13376    2        DO WHILE (KJ_CONTROL.CHAN = 0);
      117    13377    2             KJ_TIME = 1;
      118    13378    2             CALL M$WAIT(FPT_WAIT);
      119    13379    2           END;
      120    13380
      121    13381    1        VLP_HMI.SCQSIZE = KJ_CONTROL.OCQPGS;
      122    13382    1        VLP_HMI.RCQSIZE = KJ_CONTROL.ICQPGS;
      123    13383    1        VLP_HMI.CTXSIZE = SIZEW(KNH$MESS) + SIZEW(KJ$CTX);
      124    13384    1        CALL M$OPEN (OPEN_HMI);            /* Open the HMI interface */
      125    13385    1        FPT_INTCON.V.LEVEL=KJ_CONTROL.INTLVL+1;
      126    13386    1        DISABLE.LEVEL = KJ_CONTROL.INTLVL;
      127    13387    1        KJ_CONFIG_INIT.L6SPECINTLVL = KJ_CONTROL.INTLVL + 1;
      128    13388    1        KJ_CONFIG_INIT_ADP.L6SPECINTLVL = KJ_CONTROL.INTLVL + 1;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:5    
      129    13389    1        KJ_INTCONT_INIT.L6TERMINTLVL = KJ_CONTROL.INTLVL + 1;
      130    13390    1        FPT_INTCON.V.RUNLEVEL=KJ_CONTROL.INTLVL;
      131    13391    1        FPT_INTCON.V.IENTRY$ = ENTADDR(KJF$INTHAND);
      132    13392    1        CALL M$INTCON (FPT_INTCON);
      133    13393    1        KJ_CTX$ = PINCRW(G$HAND_Q$,KNH$QHDR.CTX.OFFSET);
      134    13394        /* Calculate the Handler Queue size for the BARR in bytes */
      135    13395
      136    13396    1        KJ_SIZE = (KNH$QHDR.RCQ.SZ + KNH$QHDR.SCQ.SZ) * 4 +
      137    13397    1             SIZEC(KJ$CTX) + SIZEC(KNH$MESS) + SIZEC(KNH$QHDR) ;
      138    13398    1        KJ$CTX = '0'B;                     /* Clear out context */
      139    13399
      140    13400        /* Hardwire first channel for now */
      141    13401    1        KJ$CTX.CHAN0 = KJ_CONTROL.CHAN / 64;
      142    13402    1        KJ$CTX.CHAN1 = (KJ_CONTROL.CHAN +64) / 64;
      143    13403    1        KJ$CTX.CHAN2 = (KJ_CONTROL.CHAN +128) / 64;
      144    13404    1        KJ$CTX.OCQ.BUF$ = PINCRW(G$HAND_Q$,KNH$QHDR.SCQ.OFFSET);
      145    13405    1        KJ$CTX.OCQ.BUF_SIZE = KJ_CONTROL.OCQPGS*256 / 2;
      146    13406    1        KJ$CTX.ICQ.BUF$ = PINCRW(G$HAND_Q$,KNH$QHDR.RCQ.OFFSET);
      147    13407    1        KJ$CTX.ICQ.BUF_SIZE = KJ_CONTROL.ICQPGS * 256 / 2;
      148    13408    1        KJ$CTX.IBUF.BUF$ = PINCRW(KJ_CTX$,SIZEW(KJ$CTX));
      149    13409    1        KJ$CTX.IBUF.SIZE = KJ_CONTROL.INTPGS * 256;
      150    13410
      151    13411    1        KJ_OFF_ICQ_RPTR = POFFW(ADDR(KJ$CTX.ICQ.RPTR),G$HAND_Q$);
      152    13412    1        KJ_OFF_ICQ_IPTR = POFFW(ADDR(KJ$CTX.ICQ.IPTR),G$HAND_Q$);
      153    13413    1        KJ_OFF_OCQ_RPTR = POFFW(ADDR(KJ$CTX.OCQ.RPTR),G$HAND_Q$);
      154    13414    1        KJ_OFF_OCQ_IPTR = POFFW(ADDR(KJ$CTX.OCQ.IPTR),G$HAND_Q$);
      155    13415    1        KJ_OFF_ICQ_DATA = POFFW(KJ$CTX.ICQ.BUF$,G$HAND_Q$);
      156    13416    1        KJ_OFF_OCQ_DATA = POFFW(KJ$CTX.OCQ.BUF$,G$HAND_Q$);
      157    13417    1        KJ_OFF_OCQ_FLAGS = POFFW(ADDR(KJ$CTX.OCQ.FLAGS),G$HAND_Q$);
      158    13418    1        KJ_OFF_IOIP = POFFW(ADDR(KJ$CTX.IOIP),G$HAND_Q$);
      159    13419    1        KJ_OFF_ICQ_LSTIPTR = POFFW(ADDR(KJ$CTX.ICQ.LSTIPTR),G$HAND_Q$);
      160    13420    1        KJ_SCQ_OFFSET = KNH$QHDR.SCQ.OFFSET;
      161    13421    1        KJ_RCQ_OFFSET = KNH$QHDR.RCQ.OFFSET;
      162    13422    1        KJ_SCQ$ = PINCRW(G$HAND_Q$,KJ_SCQ_OFFSET);
      163    13423    1        KJ_RCQ$ = PINCRW(G$HAND_Q$,KJ_RCQ_OFFSET);
      164    13424    1        KJ_DCW_JUMP.L6A = POFFW(ADDR(KJ$CTX.PTR_DCW),ADDR(KJ$CTX.DCWS));
      165    13425
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:6    
      166    13426        /* Initialize the static copy of the GH_IOLD structures */
      167    13427    1        KJ_IOLD_BARR.CHN = KJ$CTX.CHAN0;
      168    13428    1        KJ_IOLD_BARR.BUF$ = G$HAND_Q$;
      169    13429    1        KJ_IOLD_BARR.BUFSIZE = KJ_SIZE;
      170    13430    1        KJ_IOLD_DCWLIST.CHN = KJ$CTX.CHAN1;
      171    13431    1        KJ_IOLD_DCWLIST.BUF$ = ADDR(KJ$CTX.DCWS);
      172    13432    1        KJ_IOLD_DCWLIST.BUFSIZE = SIZEC(KJ$CTX.DCWS) + SIZEC(KJ$CTX.PTR_DCW);
      173    13433    1        KJ_GH_IO_INTL66.CAS.CHN = KJ$CTX.CHAN2;
      174    13434
      175    13435        /* MAKE DCWS TO READ AND WRITE QUEUE PTRS */
      176    13436    1        DCW$ = ADDR(KJ$CTX.PTR_DCW);
      177    13437             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      178    13438             L66A= %KJ_OFFSET_IPTR,
      179    13439             L6A=KJ_OFF_OCQ_IPTR,
      180    13440             MODE=%KJ_MODE_BIN,
      181    13441             TALLY=1);
      182    13464
      183    13465             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      184    13466             L66A= %KJ_OFFSET_RPTR,
      185    13467             L6A=KJ_OFF_OCQ_RPTR,
      186    13468             MODE=%KJ_MODE_BIN,
      187    13469             TALLY=1);
      188    13492
      189    13493             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      190    13494             L66A= %KJ_OFFSET_FLAGS,
      191    13495             L6A=KJ_OFF_OCQ_FLAGS,
      192    13496             MODE=%KJ_MODE_BIN,
      193    13497             TALLY=1);
      194    13520
      195    13521             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      196    13522             L66A= "%KJ_OFFSET_RPTR + KJ$CTX.ICQ.OFFSET",
      197    13523             L6A=KJ_OFF_ICQ_RPTR,
      198    13524             MODE=%KJ_MODE_BIN,
      199    13525             TALLY=1);
      200    13548
      201    13549             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      202    13550             L66A= "%KJ_OFFSET_IPTR + KJ$CTX.ICQ.OFFSET",
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:7    
      203    13551             L6A= KJ_OFF_ICQ_IPTR,
      204    13552             MODE=%KJ_MODE_BIN,
      205    13553             TALLY=1);
      206    13576
      207    13577             %KJ$BLDDCW (OPERATION=NOP,
      208    13578             MODE=%KJ_INTLVL_DATA);
      209    13601
      210    13602             %KJ$BLDDCW (OPERATION=READCLR_OR,
      211    13603             L66A=%KJ_OFFSET_IOIP,
      212    13604             L6A=KJ_OFF_IOIP,
      213    13605             MODE=%KJ_MODE_BIN,
      214    13606             TALLY=1);
      215    13629
      216    13630             %KJ$BLDDCW(OPERATION=DATAL6_L66,
      217    13631             L66A="%KJ_OFFSET_LSTIPTR + KJ$CTX.ICQ.OFFSET",
      218    13632             L6A=KJ_OFF_ICQ_LSTIPTR,
      219    13633             MODE=%KJ_MODE_BIN,
      220    13634             TALLY=1);
      221    13657             %KJ$BLDDCW (OPERATION=DISCONNECTINT);
      222    13680
      223    13681        /* Initialize the channel */
      224    13682    2        CALL INIT_COUPLER WHENALTRETURN DO;
      225    13683    2             CALL M$SCREECH ( CPLR_IO ) ;
      226    13684        /*S* SCREECH_CODE: KJF-S$CPLR_IO
      227    13685             MESSAGE: An IO error occurred during HOST<->FEP data transfer.
      228    13686        */
      229    13687    2           END;
      230    13688
      231    13689    2        CALL M$GETDCB ( FPT_GETDCB ) WHENALTRETURN DO ;
      232    13690    2             CALL M$SCREECH ( CPLR_IO ) ;
      233    13691    2           END ;
      234    13692    1        WRITE_NODEADMN.V.DCB# = M$NA_DCBNUM ;
      235    13693    2        CALL M$WRITE ( WRITE_NODEADMN ) WHENALTRETURN DO ;
      236    13694    2             CALL M$SCREECH ( CPLR_IO ) ;
      237    13695    2           END ;
      238    13696
      239    13697        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:8    
      240    13698        /* Main loop */
      241    13699    2        DO WHILE ('1'B);
      242    13700             /* If there is something in the buffer try to forward it */
      243    13701    2             IF KNH$QHDR.SCQ.IPTR ~= KNH$QHDR.SCQ.RPTR
      244    13702    2             THEN
      245    13703    3                  CALL M$WRTMLT (FPT_WRTMLT) WHENRETURN DO;
      246    13704    3                       IF KJ$CTX.FLAGS.BUF_FULL
      247    13705    3                       THEN
      248    13706    3                            IF KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR
      249    13707    3                            THEN
      250    13708    3                                 KJ$CTX.FLAGS.BUF_FULL = '0'B;
      251    13709    3                     END;
      252    13710
      253    13711
      254    13712    2             CALL GHH$LEV (DISABLE);
      255    13713    2             IF KJ$CTX.ICQ.RPTR ~= KJ$CTX.ICQ.IPTR
      256    13714    2                  OR KJ$CTX.OCQ.FLAGS.QFULL
             13714                           /* interrupt so host will check  qfull ldct list */
      257    13715    2             THEN
      258    13716    3             DO;
      259    13717    3                  KJ$CTX.PTR_DCW.OPERATION(5)= %KJ_DCW_INTL66;
      260    13718    3                  KJ_STATS.USRSTT.INPINTCNT = KJ_STATS.USRSTT.INPINTCNT + 1;
      261    13719    3                END;
      262    13720    2             ELSE
      263    13721    2                  KJ$CTX.PTR_DCW.OPERATION(5)= %KJ_DCW_NOP;
      264    13722    2             CALL KJF$DATA;
      265    13723    2             CALL GHH$LEV(ENABLE);
      266    13724
      267    13725    2             CALL KHC$WAIT
      268    13726    3             WHENRETURN DO;
      269    13727    3                  CALL KHC$DISPATCH(KH$EXP);
      270    13728    3                END;
      271    13729    2           END;
      272    13730
      273    13731        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:9    
      274    13732    1   INIT_COUPLER: PROC ALTRET;
      275    13733
      276    13734        /* Local variables */
      277    13735    2   DCL DCW$ PTR;
      278    13736
      279    13737    2        GH_IO = KJ_GH_IO_INIT;
      280    13738    2        GH_IO.CAS.CHN = KJ$CTX.CHAN1;
      281    13739    2        GH_IO.CAS.FNC = %KJ_IO_OUTCONT;
      282    13740    2        GH_IO.STATUS = KJ_INITCPLR;
      283    13741    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;
      284    13742    3             CALL M$SCREECH ( CPLR_IO ) ;
      285    13743    3           END;
      286    13744    2        GH_IO.CAS.FNC = %KJ_IO_WRTASK;
      287    13745    2        GH_IO.STATUS = KJ_TASK_INIT;
      288    13746    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;
      289    13747    3             CALL M$SCREECH ( CPLR_IO ) ;
      290    13748    3           END;
      291    13749    2        GH_IO.CAS.FNC = %KJ_IO_WRCONFA;
      292    13750    2        IF KJ_DPS8000_FLG ~= 0 THEN
      293    13751    2             GH_IO.STATUS = KJ_CONFIG_INIT_ADP;
      294    13752    2        ELSE
      295    13753    2             GH_IO.STATUS = KJ_CONFIG_INIT;
      296    13754    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;
      297    13755    3             CALL M$SCREECH ( CPLR_IO ) ;
      298    13756    3           END;
      299    13757    2        GH_IO.CAS.FNC = %KJ_IO_WRINTCONT;
      300    13758    2        GH_IO.STATUS = KJ_INTCONT_INIT;
      301    13759    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;
      302    13760    3             CALL M$SCREECH ( CPLR_IO ) ;
      303    13761    3           END;
      304    13762    2        GH_IO.CAS.FNC = %KJ_IO_INTL66;
      305    13763    2        GH_IO.CAS.CHN = KJ$CTX.CHAN2;
      306    13764    2        GH_IO.RANGE = %KJ_INTLVL_INIT;
      307    13765    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;
      308    13766    3             CALL M$SCREECH ( CPLR_IO ) ;
      309    13767    3           END;
      310    13768
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:10   
      311    13769    2        RETURN;
      312    13770    2   END INIT_COUPLER;
      313    13771    1   END KJF$FEI;
      314    13772
      315    13773        %EOD;

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:11   
--  Include file information  --

   KV$VDH.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KJF$FEI.

   Procedure KJF$FEI requires 1152 words for executable code.
   Procedure KJF$FEI requires 20 words of local(AUTO) storage.

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:12   

 Object Unit name= KJF$FEI                                    File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:45:50.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Data  even  none   162     A2  KJF$FEI
    2  RoData even  UTS     59     3B  KJF$FEI
    3   Proc  even  none  1152    480  KJF$FEI
    4  RoData even  none    11      B  KJF$FEI

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Main       0  KJF$FEI
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 KHA$INIT_CHANTBL
 yes     yes           Std       3 KHA$INIT_DONE
         yes          Async      0 KJF$INTHAND
         yes           Std       0 KJF$DATA
 yes     yes           Std       1 GHH$LEV
 yes     yes           Std       0 KHC$WAIT
 yes     yes           Std       1 KJF$ADM
 yes     yes           Std       3 KHA$INIT
 yes     yes           Std       1 KVB$INT
 yes     yes           Std       1 KHC$DISPATCH
 yes     yes           Std       3 KHA$INIT_CONTROL
 yes     yes           Std       1 KJF$IO
                       nStd      0 X6A_MAUTO
                       nStd      0 X6C_ALRZ
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                             r    KJ_DCW_DTL66L6                   r    KJ_DCW_DTL6L66
     KJ_DCW_JUMP                      r    KJ_TASK_INIT                          KJ_CONFIG_INIT
     KJ_CONFIG_INIT_ADP               r    KJ_INITCPLR                           KJ_INTCONT_INIT
     G$HAND_Q$                             KJ_CTX$                               KJ_SIZE
     KJ_OFF_ICQ_RPTR                       KJ_OFF_ICQ_IPTR                       KJ_OFF_ICQ_DATA
     KJ_OFF_ICQ_LSTIPTR                    KJ_OFF_OCQ_RPTR                       KJ_OFF_OCQ_IPTR
     KJ_OFF_OCQ_DATA                       KJ_OFF_IOIP                           KJ_OFF_OCQ_FLAGS
     KJ_SCQ_OFFSET                         KJ_RCQ_OFFSET                         KJ_SCQ$
     KJ_RCQ$                               KJ_TIME                               KJ_TIME_LEFT
     KJ_DPS8000_FLG                        KJ_CONTROL                            KJ_STATS
     KJ_IOLD_BARR                          KJ_IOLD_DCWLIST                  r    KJ_GH_IO_INIT
     KJ_GH_IO_INTL66                  r    CPLR_IO                               G$DS4$
     KH_CTLTBL$                       r    G$ROS$
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:15   


        1        1        /*M* KJF$FEI - FEI handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        KJF$FEI: PROC MAIN;

      9   3 000000  D380 0000 0000  xent KJF$FEI         LNJ,B5   X6A_MAUTO
          3 000003       0014 0000                       DC       20,0

       10       10
       11       11        %INCLUDE G_JIT_M;
       12      276        %INCLUDE KJ_DATA_R;
       13    10517        %INCLUDE KH$CLK;
       14    10887        %INCLUDE KH_MACRO_C;
       15    11630        %INCLUDE KL_CONTROL_C;
       16    12010        %INCLUDE G$BOBCAT_M;
       17    12030        %INCLUDE K_ID_E;
       18    12080          %K#ENTID_E;
       19    12099
       20    12100        %INCLUDE KV$VDH;
       21    12531        /* LCP6 fpt's */
       22    12532        %FPT_SPRIV (AUTH=YES,PRC=YES,PRIV=PRIVS);
       23    12555        %FPT_INTCON (PRIVILEGED=YES);
       24    12576
       25    12577        %FPT_WAIT (FPTN=FPT_WAIT,UNITS=KJ_TIME,UETIME=KJ_TIME_LEFT,UTYPE=TICS);
       26    12601        %FPT_WRTMLT (DCB=M$CQ);
       27    12621        %FPT_GDS(FPTN=FPT_GETMEM,FREE=YES,NEXT=BIG,PAGES=2,RESULTS=MEMORY_RESULTS);
       28    12645                %VLP_SEGMENT(FPTN=MEMORY_RESULTS);
       29    12666
       30    12667        /* Write FPT to send msg to BABOON through NODEADMN to change the
       31    12668           FEP screech interrupt level for the host */
       32    12669        %FPT_WRITE ( FPTN = WRITE_NODEADMN ,
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:16   
       33    12670                     BUF  = KL_CHSCRLVL ) ;
       34    12694        %KL_CHSCRLVL ( STCLASS = CONSTANT ) ;
       35    12733        %FPT_GETDCB ( DCBNAME = M$NA_NAME ,
       36    12734                      DCBNUM = M$NA_DCBNUM ) ;
       37    12754    1   DCL M$NA_DCBNUM UBIN WORD STATIC ;
       38    12755        %VLP_NAME ( FPTN = M$NA_NAME ,
       39    12756                    NAME = 'M$NA' ,
       40    12757                    STCLASS = CONSTANT ) ;
       41    12772
       42    12773        /* FPT for opening the Handler Monitor Interface */
       43    12774        %FPT_OPEN (FPTN=OPEN_HMI,
       44    12775             DCB=M$CQ,
       45    12776                       HMI=VLP_HMI,
       46    12777                       ORG=CQ,
       47    12778                       STCLASS=CONSTANT);
       48    12806        %VLP_HMI (FPTN=VLP_HMI,
       49    12807                       IO=YES,
       50    12808                       CTXSIZE="SIZEW(KJ$CTX)",
       51    12809                       STCLASS=STATIC);
       52    12825
       53    12826        /* Entry references */
       54    12827        %KH_ENTDEFS;
       55    12834    1   DCL KHC$DISPATCH ENTRY(1) ALTRET;
       56    12835    1   DCL KHC$WAIT ENTRY ALTRET;
       57    12836    1   DCL KVB$INT ENTRY(1) ALTRET;
       58    12837    1   DCL KJF$ADM ENTRY(1) ALTRET;
       59    12838    1   DCL KJF$IO ENTRY(1) ALTRET;
       60    12839    1   DCL GHH$LEV ENTRY(1) ALTRET;
       61    12840    1   DCL KJF$DATA ENTRY;
       62    12841    1   DCL KJF$INTHAND ENTRY ASYNC;
       63    12842
       64    12843        /* Local variables */
       65    12844        %GH_IO (STCLASS="");
       66    12860    1   DCL DCW$ PTR;
       67    12861
       68    12862        /* Symrefs */
       69    12863    1   DCL KH_CHNHI UBIN SYMREF;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:17   
       70    12864    1   DCL G$DS4$ PTR SYMREF;
       71    12865
       72    12866        /* Based structures */
       73    12867        %G$BOBCAT(STCLASS="BASED(G$DS4$)");
       74    12880        %KNH$MESS (STCLASS=BASED);
       75    12929        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
       76    12942
       77    12943        /* Macro invocations */
       78    12944        %G$JIT_E;
       79    13006        %GH_LEV (FPTN=DISABLE,TYPE=INHIBIT,STCLASS=STATIC);
       80    13028        %GH_LEV (FPTN=ENABLE,TYPE=ENABLE,STCLASS=STATIC);
       81    13050        %KH$EXP (STCLASS=CONSTANT);
       82    13113        %KH$CTLTBL (STCLASS=STATIC,
       83    13114                       HIPARM=%KL_FEI_HI);
       84    13326    1   DCL KH_CTLTBL$ PTR SYMREF;
       85    13327        %KV$VDH_VDHINT (STCLASS=STATIC);
       86    13346
       87    13347        /* Constant data */
       88    13348    1   DCL PRIVS BIT(32) CONSTANT INIT(
       89    13349    1  %(G_PR_MSYS#|G_PR_INTCON#|G_PR_CQ#|G_PR_SCREECH#|G_PR_SNAP#|G_PR_EXMM#|G_PR_SPCLMM#)
             13349            );
       90    13350
       91    13351        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:18   
       92    13352
       93    13353    1        CALL M$SPRIV (FPT_SPRIV);

  13353   3 000005  BB80 0000 0000  01                   LAB,B3   FPT_SPRIV
          3 000008  B870 0CD0                            LDR,R3   3280,IMO
          3 00000A  0001                                 MCL
          3 00000B       0000                            DC       s:13353+6,PREL

       94    13354    1        CALL M$SYS;

  13354   3 00000C  3C43                                 LDV,R3   67
          3 00000D  0001                                 MCL
          3 00000E       0000                            DC       s:13354+2,PREL

       95    13355    1        CALL KHA$INIT;

  13355   3 00000F  CBF0 0000                            LAB,B4   0,IMO
          3 000011  E380 0000 0000  xent                 LNJ,B6   KHA$INIT
          3 000014       0001                            DC       s:13356,PREL

       96    13356    1        KH_CTLTBL$ = ADDR(KH$CTLTBL);

  13356   3 000015  EB80 0000 005A  01                   LAB,B6   KH$CTLTBL
          3 000018  EF80 0000 0000  xsym                 STB,B6   KH_CTLTBL$

       97    13357    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_MEM) = ADDR(FPT_GETMEM.V.PAGES);

  13357   3 00001B  DB80 0000 0030  01                   LAB,B5   FPT_GETMEM+6
          3 00001E  DF80 0000 005F  01                   STB,B5   KH$CTLTBL+5

       98    13358    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_INTLVL) = ADDR(KJ_CONTROL.INTLVL);

  13358   3 000021  CB80 0000 0003  xsym                 LAB,B4   KJ_CONTROL+3
          3 000024  CF80 0000 005C  01                   STB,B4   KH$CTLTBL+2

       99    13359    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_RES) = ADDR(KJ_CONTROL.RES);

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:19   
  13359   3 000027  BB80 0000 0007  xsym                 LAB,B3   KJ_CONTROL+7
          3 00002A  BF80 0000 0065  01                   STB,B3   KH$CTLTBL+11

      100    13360    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_ATTR) = ADDR(KJ_CONTROL.ATTR);

  13360   3 00002D  AB80 0000 0008  xsym                 LAB,B2   KJ_CONTROL+8
          3 000030  AF80 0000 0068  01                   STB,B2   KH$CTLTBL+14

      101    13361    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_RCVCQBYTSIZ) = ADDR(KJ_CONTROL.ICQPGS);

  13361   3 000033  9B80 0000 0000  xsym                 LAB,B1   KJ_CONTROL
          3 000036  9F80 0000 0080  01                   STB,B1   KH$CTLTBL+38

      102    13362    1        KH$CTLTBL.PARM.PTR$(%KL_HNDLRPARM_SNDCQBYTSIZ) = ADDR(KJ_CONTROL.OCQPGS);

  13362   3 000039  EB80 0000 0001  xsym                 LAB,B6   KJ_CONTROL+1
          3 00003C  EF80 0000 0083  01                   STB,B6   KH$CTLTBL+41

      103    13363    1        KH$CTLTBL.PARM.PTR$(%KL_FEI_MAXICQTIME) = ADDR(KJ_CONTROL.INTHTIME);

  13363   3 00003F  EB80 0000 0006  xsym                 LAB,B6   KJ_CONTROL+6
          3 000042  EF80 0000 0092  01                   STB,B6   KH$CTLTBL+56

      104    13364    1        KH$CTLTBL.PARM.PTR$(%KL_FEI_OCQDBLKSIZ) = ADDR(KJ_CONTROL.OCQDBLKSIZ);

  13364   3 000045  EB80 0000 0009  xsym                 LAB,B6   KJ_CONTROL+9
          3 000048  EF80 0000 0095  01                   STB,B6   KH$CTLTBL+59

      105    13365    1        CALL KHA$INIT_CONTROL(KH$CTLTBL);

  13365   3 00004B  BB80 0000 0000  04                   LAB,B3   0
          3 00004E  CBF0 0100                            LAB,B4   256,IMO
          3 000050  E380 0000 0000  xent                 LNJ,B6   KHA$INIT_CONTROL
          3 000053       0001                            DC       s:13366,PREL

      106    13366    1        CALL M$GDS (FPT_GETMEM);

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:20   
  13366   3 000054  BB80 0000 002A  01                   LAB,B3   FPT_GETMEM
          3 000057  B870 0902                            LDR,R3   2306,IMO
          3 000059  0001                                 MCL
          3 00005A       0000                            DC       s:13366+6,PREL

      107    13367    1        KV$VDH_VDHINT.BFRBGN$ = MEMORY_RESULTS.BASE$;

  13367   3 00005B  EC80 0000 0032  01                   LDB,B6   MEMORY_RESULTS
          3 00005E  EF80 0000 009A  01                   STB,B6   KV$VDH_VDHINT

      108    13368    1        KV$VDH_VDHINT.BFREND$=PINCRW(MEMORY_RESULTS.BASE$,MEMORY_RESULTS.PAGES*256);

  13368   3 000061  F800 0000 0034  01                   LDR,R7   MEMORY_RESULTS+2
          3 000064  6C00                                 LDV,R6   0
          3 000065  7088                                 DOL,R7   8
          3 000066  8400 0000 0032  01                   AID      MEMORY_RESULTS
          3 000069  8D00 0000 009C  01                   SDI      KV$VDH_VDHINT+2

      109    13369    1        CALL KVB$INT(KV$VDH_VDHINT);

  13369   3 00006C  BB80 0000 0002  04                   LAB,B3   +2
          3 00006F  CBF0 0100                            LAB,B4   256,IMO
          3 000071  E380 0000 0000  xent                 LNJ,B6   KVB$INT
          3 000074       0001                            DC       s:13370,PREL

      110    13370    1        CALL KHA$INIT_CHANTBL(KJ_CONTROL.RES,KJ_CONTROL.ATTR,ENTADDR(KJF$ADM));

  13370   3 000075  EB80 0000 0000  xent                 LAB,B6   KJF$ADM
          3 000078  EFC7 000C                            STB,B6   DCW$+6,AUTO
          3 00007A  DBC7 000C                            LAB,B5   DCW$+6,AUTO
          3 00007C  DFC7 0012                            STB,B5   DCW$+12,AUTO
          3 00007E  CB80 0000 0008  xsym                 LAB,B4   KJ_CONTROL+8
          3 000081  CFC7 0010                            STB,B4   DCW$+10,AUTO
          3 000083  BB80 0000 0007  xsym                 LAB,B3   KJ_CONTROL+7
          3 000086  BFC7 000E                            STB,B3   DCW$+8,AUTO
          3 000088  BBC7 000E                            LAB,B3   DCW$+8,AUTO
          3 00008A  CBF0 0300                            LAB,B4   768,IMO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:21   
          3 00008C  E380 0000 0000  xent                 LNJ,B6   KHA$INIT_CHANTBL
          3 00008F       0001                            DC       s:13371,PREL

      111    13371    1        CALL KHA$INIT_DONE;

  13371   3 000090  CBF0 0000                            LAB,B4   0,IMO
          3 000092  E380 0000 0000  xent                 LNJ,B6   KHA$INIT_DONE
          3 000095       0001                            DC       s:13372,PREL

      112    13372    1        KJ_DPS8000_FLG = G$BOBCAT.DPS8000FLG;

  13372   3 000096  EC80 0000 0000  xsym                 LDB,B6   G$DS4$
          3 000099  E846 0067                            LDR,R6   103,B6
          3 00009B  EF00 0000 0000  xsym                 STR,R6   KJ_DPS8000_FLG

      113    13373
      114    13374    1        KJ_STATS.REQSTATS.DSPENT(%KH#ENTID_FEI) = '1'B;

  13374   3 00009E  8900 0000 0010  xsym                 LBT,'1000'X       KJ_STATS+16
  13374   3 0000A1       1000

      115    13375    1        KJ_STATS.REQSTATS.SLCENT(%KH#ENTID_FEI) = '1'B;

  13375   3 0000A2  8900 0000 0012  xsym                 LBT,'1000'X       KJ_STATS+18
  13375   3 0000A5       1000

      116    13376    2        DO WHILE (KJ_CONTROL.CHAN = 0);

  13376   3 0000A6  D800 0000 0004  xsym                 LDR,R5   KJ_CONTROL+4
          3 0000A9  5981 0012                            BNEZ,R5  s:13381,PREL

      117    13377    2             KJ_TIME = 1;

  13377   3 0000AB  8CF0 0000 0001                       LDI      1,IMO
          3 0000AE  8D00 0000 0000  xsym                 SDI      KJ_TIME

      118    13378    2             CALL M$WAIT(FPT_WAIT);
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:22   

  13378   3 0000B1  BB80 0000 0013  01                   LAB,B3   FPT_WAIT
          3 0000B4  B870 0CC5                            LDR,R3   3269,IMO
          3 0000B6  0001                                 MCL
          3 0000B7       0000                            DC       s:13378+6,PREL

      119    13379    2           END;

  13379   3 0000B8  E800 0000 0004  xsym                 LDR,R6   KJ_CONTROL+4
          3 0000BB  6970                                 BEZ,R6   s:13377,SPREL

      120    13380
      121    13381    1        VLP_HMI.SCQSIZE = KJ_CONTROL.OCQPGS;

  13381   3 0000BC  E800 0000 0001  xsym                 LDR,R6   KJ_CONTROL+1
          3 0000BF  EF00 0000 0054  01                   STR,R6   VLP_HMI

      122    13382    1        VLP_HMI.RCQSIZE = KJ_CONTROL.ICQPGS;

  13382   3 0000C2  D800 0000 0000  xsym                 LDR,R5   KJ_CONTROL
          3 0000C5  DF00 0000 0055  01                   STR,R5   VLP_HMI+1

      123    13383    1        VLP_HMI.CTXSIZE = SIZEW(KNH$MESS) + SIZEW(KJ$CTX);

  13383   3 0000C8  C870 00EE                            LDR,R4   238,IMO
          3 0000CA  CF00 0000 0056  01                   STR,R4   VLP_HMI+2

      124    13384    1        CALL M$OPEN (OPEN_HMI);            /* Open the HMI interface */

  13384   3 0000CD  BB80 0000 0004  02                   LAB,B3   OPEN_HMI
          3 0000D0  B870 3540                            LDR,R3   13632,IMO
          3 0000D2  0001                                 MCL
          3 0000D3       0000                            DC       s:13384+6,PREL

      125    13385    1        FPT_INTCON.V.LEVEL=KJ_CONTROL.INTLVL+1;

  13385   3 0000D4  E800 0000 0003  xsym                 LDR,R6   KJ_CONTROL+3
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:23   
          3 0000D7  6E01                                 ADV,R6   1
          3 0000D8  EF00 0000 000F  01                   STR,R6   FPT_INTCON+5

      126    13386    1        DISABLE.LEVEL = KJ_CONTROL.INTLVL;

  13386   3 0000DB  D800 0000 0003  xsym                 LDR,R5   KJ_CONTROL+3
          3 0000DE  DA80 0000 0058  01                   SRM,R5,'003F'X    DISABLE
          3 0000E1       003F

      127    13387    1        KJ_CONFIG_INIT.L6SPECINTLVL = KJ_CONTROL.INTLVL + 1;

  13387   3 0000E2  EA80 0000 0000  xsym                 SRM,R6,'003F'X    KJ_CONFIG_INIT
  13387   3 0000E5       003F

      128    13388    1        KJ_CONFIG_INIT_ADP.L6SPECINTLVL = KJ_CONTROL.INTLVL + 1;

  13388   3 0000E6  EA80 0000 0000  xsym                 SRM,R6,'003F'X    KJ_CONFIG_INIT_ADP
  13388   3 0000E9       003F

      129    13389    1        KJ_INTCONT_INIT.L6TERMINTLVL = KJ_CONTROL.INTLVL + 1;

  13389   3 0000EA  EA80 0000 0000  xsym                 SRM,R6,'003F'X    KJ_INTCONT_INIT
  13389   3 0000ED       003F

      130    13390    1        FPT_INTCON.V.RUNLEVEL=KJ_CONTROL.INTLVL;

  13390   3 0000EE  DF00 0000 0010  01                   STR,R5   FPT_INTCON+6

      131    13391    1        FPT_INTCON.V.IENTRY$ = ENTADDR(KJF$INTHAND);

  13391   3 0000F1  EB80 0000 0000  xent                 LAB,B6   KJF$INTHAND
          3 0000F4  EF80 0000 000D  01                   STB,B6   FPT_INTCON+3

      132    13392    1        CALL M$INTCON (FPT_INTCON);

  13392   3 0000F7  BB80 0000 000A  01                   LAB,B3   FPT_INTCON
          3 0000FA  B870 0441                            LDR,R3   1089,IMO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:24   
          3 0000FC  0001                                 MCL
          3 0000FD       0000                            DC       s:13392+6,PREL

      133    13393    1        KJ_CTX$ = PINCRW(G$HAND_Q$,KNH$QHDR.CTX.OFFSET);

  13393   3 0000FE  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 000101  B846 0008                            LDR,R3   8,B6
          3 000103  F853                                 LDR,R7   R3
          3 000104  6C00                                 LDV,R6   0
          3 000105  8400 0000 0000  xsym                 AID      G$HAND_Q$
          3 000108  8D00 0000 0000  xsym                 SDI      KJ_CTX$

      134    13394        /* Calculate the Handler Queue size for the BARR in bytes */
      135    13395
      136    13396    1        KJ_SIZE = (KNH$QHDR.RCQ.SZ + KNH$QHDR.SCQ.SZ) * 4 +

  13396   3 00010B  D846 0002                            LDR,R5   2,B6
          3 00010D  DA46 0006                            ADD,R5   6,B6
          3 00010F  F855                                 LDR,R7   R5
          3 000110  6C00                                 LDV,R6   0
          3 000111  7082                                 DOL,R7   2
          3 000112  8470 0000 020C                       AID      524,IMO
          3 000115  8D00 0000 0000  xsym                 SDI      KJ_SIZE

      137    13397    1             SIZEC(KJ$CTX) + SIZEC(KNH$MESS) + SIZEC(KNH$QHDR) ;
      138    13398    1        KJ$CTX = '0'B;                     /* Clear out context */

  13398   3 000118  AB80 0000 0000  04                   LAB,B2   0
          3 00011B  2C08                                 LDV,R2   8
          3 00011C  6C01                                 LDV,R6   1
          3 00011D  BC80 0000 0000  xsym                 LDB,B3   KJ_CTX$
          3 000120  3C00                                 LDV,R3   0
          3 000121  F870 01CC                            LDR,R7   460,IMO
          3 000123  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

      139    13399
      140    13400        /* Hardwire first channel for now */
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:25   
      141    13401    1        KJ$CTX.CHAN0 = KJ_CONTROL.CHAN / 64;

  13401   3 000126  E800 0000 0004  xsym                 LDR,R6   KJ_CONTROL+4
          3 000129  6046                                 SOR,R6   6
          3 00012A  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 00012D  EF46 0002                            STR,R6   2,B6

      142    13402    1        KJ$CTX.CHAN1 = (KJ_CONTROL.CHAN +64) / 64;

  13402   3 00012F  D800 0000 0004  xsym                 LDR,R5   KJ_CONTROL+4
          3 000132  5E40                                 ADV,R5   64
          3 000133  5046                                 SOR,R5   6
          3 000134  DF46 0003                            STR,R5   3,B6

      143    13403    1        KJ$CTX.CHAN2 = (KJ_CONTROL.CHAN +128) / 64;

  13403   3 000136  C800 0000 0004  xsym                 LDR,R4   KJ_CONTROL+4
          3 000139  CA70 0080                            ADD,R4   128,IMO
          3 00013B  4046                                 SOR,R4   6
          3 00013C  CF46 0004                            STR,R4   4,B6

      144    13404    1        KJ$CTX.OCQ.BUF$ = PINCRW(G$HAND_Q$,KNH$QHDR.SCQ.OFFSET);

  13404   3 00013E  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          3 000141  B845 0007                            LDR,R3   7,B5
          3 000143  F853                                 LDR,R7   R3
          3 000144  6C00                                 LDV,R6   0
          3 000145  8400 0000 0000  xsym                 AID      G$HAND_Q$
          3 000148  8D46 002D                            SDI      45,B6

      145    13405    1        KJ$CTX.OCQ.BUF_SIZE = KJ_CONTROL.OCQPGS*256 / 2;

  13405   3 00014A  F800 0000 0001  xsym                 LDR,R7   KJ_CONTROL+1
          3 00014D  6C00                                 LDV,R6   0
          3 00014E  7087                                 DOL,R7   7
          3 00014F  8D46 002F                            SDI      47,B6

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:26   
      146    13406    1        KJ$CTX.ICQ.BUF$ = PINCRW(G$HAND_Q$,KNH$QHDR.RCQ.OFFSET);

  13406   3 000151  A845 0003                            LDR,R2   3,B5
          3 000153  F852                                 LDR,R7   R2
          3 000154  6C00                                 LDV,R6   0
          3 000155  8400 0000 0000  xsym                 AID      G$HAND_Q$
          3 000158  8D46 0019                            SDI      25,B6

      147    13407    1        KJ$CTX.ICQ.BUF_SIZE = KJ_CONTROL.ICQPGS * 256 / 2;

  13407   3 00015A  F800 0000 0000  xsym                 LDR,R7   KJ_CONTROL
          3 00015D  6C00                                 LDV,R6   0
          3 00015E  7087                                 DOL,R7   7
          3 00015F  8D46 001B                            SDI      27,B6

      148    13408    1        KJ$CTX.IBUF.BUF$ = PINCRW(KJ_CTX$,SIZEW(KJ$CTX));

  13408   3 000161  CBC6 00E6                            LAB,B4   230,B6
          3 000163  CFC6 0031                            STB,B4   49,B6

      149    13409    1        KJ$CTX.IBUF.SIZE = KJ_CONTROL.INTPGS * 256;

  13409   3 000165  9800 0000 0002  xsym                 LDR,R1   KJ_CONTROL+2
          3 000168  1008                                 SOL,R1   8
          3 000169  9F46 0033                            STR,R1   51,B6

      150    13410
      151    13411    1        KJ_OFF_ICQ_RPTR = POFFW(ADDR(KJ$CTX.ICQ.RPTR),G$HAND_Q$);

  13411   3 00016B  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 00016E  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 000171  8470 0000 000D                       AID      13,IMO
          3 000174  8D00 0000 0000  xsym                 SDI      KJ_OFF_ICQ_RPTR

      152    13412    1        KJ_OFF_ICQ_IPTR = POFFW(ADDR(KJ$CTX.ICQ.IPTR),G$HAND_Q$);

  13412   3 000177  8C80 0000 0000  xsym                 LDI      KJ_CTX$
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:27   
          3 00017A  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 00017D  8470 0000 000A                       AID      10,IMO
          3 000180  8D00 0000 0000  xsym                 SDI      KJ_OFF_ICQ_IPTR

      153    13413    1        KJ_OFF_OCQ_RPTR = POFFW(ADDR(KJ$CTX.OCQ.RPTR),G$HAND_Q$);

  13413   3 000183  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 000186  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 000189  8470 0000 0022                       AID      34,IMO
          3 00018C  8D00 0000 0000  xsym                 SDI      KJ_OFF_OCQ_RPTR

      154    13414    1        KJ_OFF_OCQ_IPTR = POFFW(ADDR(KJ$CTX.OCQ.IPTR),G$HAND_Q$);

  13414   3 00018F  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 000192  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 000195  8470 0000 001F                       AID      31,IMO
          3 000198  8D00 0000 0000  xsym                 SDI      KJ_OFF_OCQ_IPTR

      155    13415    1        KJ_OFF_ICQ_DATA = POFFW(KJ$CTX.ICQ.BUF$,G$HAND_Q$);

  13415   3 00019B  8CC6 0019                            LDI      25,B6
          3 00019D  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0001A0  8D00 0000 0000  xsym                 SDI      KJ_OFF_ICQ_DATA

      156    13416    1        KJ_OFF_OCQ_DATA = POFFW(KJ$CTX.OCQ.BUF$,G$HAND_Q$);

  13416   3 0001A3  8CC6 002D                            LDI      45,B6
          3 0001A5  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0001A8  8D00 0000 0000  xsym                 SDI      KJ_OFF_OCQ_DATA

      157    13417    1        KJ_OFF_OCQ_FLAGS = POFFW(ADDR(KJ$CTX.OCQ.FLAGS),G$HAND_Q$);

  13417   3 0001AB  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0001AE  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0001B1  8470 0000 0028                       AID      40,IMO
          3 0001B4  8D00 0000 0000  xsym                 SDI      KJ_OFF_OCQ_FLAGS

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:28   
      158    13418    1        KJ_OFF_IOIP = POFFW(ADDR(KJ$CTX.IOIP),G$HAND_Q$);

  13418   3 0001B7  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0001BA  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0001BD  8470 0000 0035                       AID      53,IMO
          3 0001C0  8D00 0000 0000  xsym                 SDI      KJ_OFF_IOIP

      159    13419    1        KJ_OFF_ICQ_LSTIPTR = POFFW(ADDR(KJ$CTX.ICQ.LSTIPTR),G$HAND_Q$);

  13419   3 0001C3  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0001C6  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0001C9  8470 0000 0013                       AID      19,IMO
          3 0001CC  8D00 0000 0000  xsym                 SDI      KJ_OFF_ICQ_LSTIPTR

      160    13420    1        KJ_SCQ_OFFSET = KNH$QHDR.SCQ.OFFSET;

  13420   3 0001CF  F845 0007                            LDR,R7   7,B5
          3 0001D1  6C00                                 LDV,R6   0
          3 0001D2  8D00 0000 0000  xsym                 SDI      KJ_SCQ_OFFSET

      161    13421    1        KJ_RCQ_OFFSET = KNH$QHDR.RCQ.OFFSET;

  13421   3 0001D5  F845 0003                            LDR,R7   3,B5
          3 0001D7  6C00                                 LDV,R6   0
          3 0001D8  8D00 0000 0000  xsym                 SDI      KJ_RCQ_OFFSET

      162    13422    1        KJ_SCQ$ = PINCRW(G$HAND_Q$,KJ_SCQ_OFFSET);

  13422   3 0001DB  8C80 0000 0000  xsym                 LDI      G$HAND_Q$
          3 0001DE  8400 0000 0000  xsym                 AID      KJ_SCQ_OFFSET
          3 0001E1  8D00 0000 0000  xsym                 SDI      KJ_SCQ$

      163    13423    1        KJ_RCQ$ = PINCRW(G$HAND_Q$,KJ_RCQ_OFFSET);

  13423   3 0001E4  8C80 0000 0000  xsym                 LDI      G$HAND_Q$
          3 0001E7  8400 0000 0000  xsym                 AID      KJ_RCQ_OFFSET
          3 0001EA  8D00 0000 0000  xsym                 SDI      KJ_RCQ$
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:29   

      164    13424    1        KJ_DCW_JUMP.L6A = POFFW(ADDR(KJ$CTX.PTR_DCW),ADDR(KJ$CTX.DCWS));

  13424   3 0001ED  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0001F0  8480 0000 0000  xsym                 SID      KJ_CTX$
          3 0001F3  8470 0000 0078                       AID      120,IMO
          3 0001F6  8D00 0000 0004  xsym                 SDI      KJ_DCW_JUMP+4

      165    13425
      166    13426        /* Initialize the static copy of the GH_IOLD structures */
      167    13427    1        KJ_IOLD_BARR.CHN = KJ$CTX.CHAN0;

  13427   3 0001F9  D846 0002                            LDR,R5   2,B6
          3 0001FB  5006                                 SOL,R5   6
          3 0001FC  DA80 0000 0000  xsym                 SRM,R5,'FFC0'X    KJ_IOLD_BARR
          3 0001FF       FFC0

      168    13428    1        KJ_IOLD_BARR.BUF$ = G$HAND_Q$;

  13428   3 000200  DF80 0000 0001  xsym                 STB,B5   KJ_IOLD_BARR+1

      169    13429    1        KJ_IOLD_BARR.BUFSIZE = KJ_SIZE;

  13429   3 000203  D800 0000 0001  xsym                 LDR,R5   KJ_SIZE+1
          3 000206  DF00 0000 0004  xsym                 STR,R5   KJ_IOLD_BARR+4

      170    13430    1        KJ_IOLD_DCWLIST.CHN = KJ$CTX.CHAN1;

  13430   3 000209  C846 0003                            LDR,R4   3,B6
          3 00020B  4006                                 SOL,R4   6
          3 00020C  CA80 0000 0000  xsym                 SRM,R4,'FFC0'X    KJ_IOLD_DCWLIST
          3 00020F       FFC0

      171    13431    1        KJ_IOLD_DCWLIST.BUF$ = ADDR(KJ$CTX.DCWS);

  13431   3 000210  BBC6 0038                            LAB,B3   56,B6
          3 000212  BF80 0000 0001  xsym                 STB,B3   KJ_IOLD_DCWLIST+1
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:30   

      172    13432    1        KJ_IOLD_DCWLIST.BUFSIZE = SIZEC(KJ$CTX.DCWS) + SIZEC(KJ$CTX.PTR_DCW);

  13432   3 000215  C870 015C                            LDR,R4   348,IMO
          3 000217  CF00 0000 0004  xsym                 STR,R4   KJ_IOLD_DCWLIST+4

      173    13433    1        KJ_GH_IO_INTL66.CAS.CHN = KJ$CTX.CHAN2;

  13433   3 00021A  E846 0004                            LDR,R6   4,B6
          3 00021C  6006                                 SOL,R6   6
          3 00021D  EA80 0000 0000  xsym                 SRM,R6,'FFC0'X    KJ_GH_IO_INTL66
          3 000220       FFC0

      174    13434
      175    13435        /* MAKE DCWS TO READ AND WRITE QUEUE PTRS */
      176    13436    1        DCW$ = ADDR(KJ$CTX.PTR_DCW);

  13436   3 000221  ABC6 00B0                            LAB,B2   176,B6
          3 000223  AFC7 0006                            STB,B2   DCW$,AUTO

      177    13437             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      178    13438             L66A= %KJ_OFFSET_IPTR,
      179    13439             L6A=KJ_OFF_OCQ_IPTR,
      180    13440             MODE=%KJ_MODE_BIN,
      181    13441             TALLY=1);

  13445   3 000225  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          3 000228  2C00                                 LDV,R2   0
          3 000229  6C0C                                 LDV,R6   12
          3 00022A  BCC7 0006                            LDB,B3   DCW$,AUTO
          3 00022C  3C00                                 LDV,R3   0
          3 00022D  0008                                 MMM

  13451   3 00022E  6C03                                 LDV,R6   3
          3 00022F  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 000231  EA86                                 SRM,R6,'00FF'X    ,B6
          3 000232       00FF
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:31   

  13454   3 000233  5C01                                 LDV,R5   1
          3 000234  DF46 0001                            STR,R5   1,B6

  13457   3 000236  8CF0 0000 000A                       LDI      10,IMO
          3 000239  8D46 0002                            SDI      2,B6

  13460   3 00023B  8C80 0000 0000  xsym                 LDI      KJ_OFF_OCQ_IPTR
          3 00023E  8D46 0004                            SDI      4,B6

  13462   3 000240  DBC6 0006                            LAB,B5   6,B6
          3 000242  DFC7 0006                            STB,B5   DCW$,AUTO

      182    13464
      183    13465             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      184    13466             L66A= %KJ_OFFSET_RPTR,
      185    13467             L6A=KJ_OFF_OCQ_RPTR,
      186    13468             MODE=%KJ_MODE_BIN,
      187    13469             TALLY=1);

  13471   3 000244  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 000247  2C00                                 LDV,R2   0
          3 000248  6C0C                                 LDV,R6   12
          3 000249  BB85                                 LAB,B3   ,B5
          3 00024A  3C00                                 LDV,R3   0
          3 00024B  0008                                 MMM

  13479   3 00024C  6C03                                 LDV,R6   3
          3 00024D  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 00024F  EA86                                 SRM,R6,'00FF'X    ,B6
          3 000250       00FF

  13482   3 000251  DF46 0001                            STR,R5   1,B6

  13485   3 000253  8CF0 0000 0009                       LDI      9,IMO
          3 000256  8D46 0002                            SDI      2,B6

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:32   
  13488   3 000258  8C80 0000 0000  xsym                 LDI      KJ_OFF_OCQ_RPTR
          3 00025B  8D46 0004                            SDI      4,B6

  13490   3 00025D  CBC6 0006                            LAB,B4   6,B6
          3 00025F  CFC7 0006                            STB,B4   DCW$,AUTO

      188    13492
      189    13493             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      190    13494             L66A= %KJ_OFFSET_FLAGS,
      191    13495             L6A=KJ_OFF_OCQ_FLAGS,
      192    13496             MODE=%KJ_MODE_BIN,
      193    13497             TALLY=1);

  13501   3 000261  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          3 000264  2C00                                 LDV,R2   0
          3 000265  6C0C                                 LDV,R6   12
          3 000266  BB84                                 LAB,B3   ,B4
          3 000267  3C00                                 LDV,R3   0
          3 000268  0008                                 MMM

  13507   3 000269  6C03                                 LDV,R6   3
          3 00026A  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 00026C  EA86                                 SRM,R6,'00FF'X    ,B6
          3 00026D       00FF

  13510   3 00026E  DF46 0001                            STR,R5   1,B6

  13513   3 000270  8CF0 0000 000B                       LDI      11,IMO
          3 000273  8D46 0002                            SDI      2,B6

  13516   3 000275  8C80 0000 0000  xsym                 LDI      KJ_OFF_OCQ_FLAGS
          3 000278  8D46 0004                            SDI      4,B6

  13518   3 00027A  ABC6 0006                            LAB,B2   6,B6
          3 00027C  AFC7 0006                            STB,B2   DCW$,AUTO

      194    13520
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:33   
      195    13521             %KJ$BLDDCW (OPERATION=DATAL66_L6,
      196    13522             L66A= "%KJ_OFFSET_RPTR + KJ$CTX.ICQ.OFFSET",
      197    13523             L6A=KJ_OFF_ICQ_RPTR,
      198    13524             MODE=%KJ_MODE_BIN,
      199    13525             TALLY=1);

  13529   3 00027E  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          3 000281  2C00                                 LDV,R2   0
          3 000282  6C0C                                 LDV,R6   12
          3 000283  BCC7 0006                            LDB,B3   DCW$,AUTO
          3 000285  3C00                                 LDV,R3   0
          3 000286  0008                                 MMM

  13535   3 000287  6C03                                 LDV,R6   3
          3 000288  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 00028A  EA86                                 SRM,R6,'00FF'X    ,B6
          3 00028B       00FF

  13538   3 00028C  DF46 0001                            STR,R5   1,B6

  13541   3 00028E  BC80 0000 0000  xsym                 LDB,B3   KJ_CTX$
          3 000291  8CC3 0017                            LDI      23,B3
          3 000293  8470 0000 0009                       AID      9,IMO
          3 000296  8D46 0002                            SDI      2,B6

  13544   3 000298  8C80 0000 0000  xsym                 LDI      KJ_OFF_ICQ_RPTR
          3 00029B  8D46 0004                            SDI      4,B6

  13546   3 00029D  ABC6 0006                            LAB,B2   6,B6
          3 00029F  AFC7 0006                            STB,B2   DCW$,AUTO

      200    13548
      201    13549             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      202    13550             L66A= "%KJ_OFFSET_IPTR + KJ$CTX.ICQ.OFFSET",
      203    13551             L6A= KJ_OFF_ICQ_IPTR,
      204    13552             MODE=%KJ_MODE_BIN,
      205    13553             TALLY=1);
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:34   

  13555   3 0002A1  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 0002A4  2C00                                 LDV,R2   0
          3 0002A5  6C0C                                 LDV,R6   12
          3 0002A6  BCC7 0006                            LDB,B3   DCW$,AUTO
          3 0002A8  3C00                                 LDV,R3   0
          3 0002A9  0008                                 MMM

  13563   3 0002AA  6C03                                 LDV,R6   3
          3 0002AB  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 0002AD  EA86                                 SRM,R6,'00FF'X    ,B6
          3 0002AE       00FF

  13566   3 0002AF  DF46 0001                            STR,R5   1,B6

  13569   3 0002B1  BC80 0000 0000  xsym                 LDB,B3   KJ_CTX$
          3 0002B4  8CC3 0017                            LDI      23,B3
          3 0002B6  8470 0000 000A                       AID      10,IMO
          3 0002B9  8D46 0002                            SDI      2,B6

  13572   3 0002BB  8C80 0000 0000  xsym                 LDI      KJ_OFF_ICQ_IPTR
          3 0002BE  8D46 0004                            SDI      4,B6

  13574   3 0002C0  ABC6 0006                            LAB,B2   6,B6
          3 0002C2  AFC7 0006                            STB,B2   DCW$,AUTO

      206    13576
      207    13577             %KJ$BLDDCW (OPERATION=NOP,
      208    13578             MODE=%KJ_INTLVL_DATA);

  13584   3 0002C4  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 0002C7  2C00                                 LDV,R2   0
          3 0002C8  6C0C                                 LDV,R6   12
          3 0002C9  BCC7 0006                            LDB,B3   DCW$,AUTO
          3 0002CB  3C00                                 LDV,R3   0
          3 0002CC  0008                                 MMM

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:35   
  13585   3 0002CD  6C33                                 LDV,R6   51
          3 0002CE  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 0002D0  E786                                 STH,R6   ,B6

  13588   3 0002D1  3C07                                 LDV,R3   7
          3 0002D2  BA86                                 SRM,R3,'00FF'X    ,B6
          3 0002D3       00FF

  13599   3 0002D4  BBC6 0006                            LAB,B3   6,B6
          3 0002D6  BFC7 0006                            STB,B3   DCW$,AUTO

      209    13601
      210    13602             %KJ$BLDDCW (OPERATION=READCLR_OR,
      211    13603             L66A=%KJ_OFFSET_IOIP,
      212    13604             L6A=KJ_OFF_IOIP,
      213    13605             MODE=%KJ_MODE_BIN,
      214    13606             TALLY=1);

  13612   3 0002D8  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 0002DB  2C00                                 LDV,R2   0
          3 0002DC  6C0C                                 LDV,R6   12
          3 0002DD  3C00                                 LDV,R3   0
          3 0002DE  0008                                 MMM

  13613   3 0002DF  6C35                                 LDV,R6   53
          3 0002E0  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 0002E2  E786                                 STH,R6   ,B6

  13616   3 0002E3  3C03                                 LDV,R3   3
          3 0002E4  BA86                                 SRM,R3,'00FF'X    ,B6
          3 0002E5       00FF

  13619   3 0002E6  DF46 0001                            STR,R5   1,B6

  13622   3 0002E8  8CF0 0000 0002                       LDI      2,IMO
          3 0002EB  8D46 0002                            SDI      2,B6

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:36   
  13625   3 0002ED  8C80 0000 0000  xsym                 LDI      KJ_OFF_IOIP
          3 0002F0  8D46 0004                            SDI      4,B6

  13627   3 0002F2  BBC6 0006                            LAB,B3   6,B6
          3 0002F4  BFC7 0006                            STB,B3   DCW$,AUTO

      215    13629
      216    13630             %KJ$BLDDCW(OPERATION=DATAL6_L66,
      217    13631             L66A="%KJ_OFFSET_LSTIPTR + KJ$CTX.ICQ.OFFSET",
      218    13632             L6A=KJ_OFF_ICQ_LSTIPTR,
      219    13633             MODE=%KJ_MODE_BIN,
      220    13634             TALLY=1);

  13636   3 0002F6  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 0002F9  2C00                                 LDV,R2   0
          3 0002FA  6C0C                                 LDV,R6   12
          3 0002FB  3C00                                 LDV,R3   0
          3 0002FC  0008                                 MMM

  13644   3 0002FD  6C03                                 LDV,R6   3
          3 0002FE  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 000300  EA86                                 SRM,R6,'00FF'X    ,B6
          3 000301       00FF

  13647   3 000302  DF46 0001                            STR,R5   1,B6

  13650   3 000304  BC80 0000 0000  xsym                 LDB,B3   KJ_CTX$
          3 000307  8CC3 0017                            LDI      23,B3
          3 000309  8470 0000 000D                       AID      13,IMO
          3 00030C  8D46 0002                            SDI      2,B6

  13653   3 00030E  8C80 0000 0000  xsym                 LDI      KJ_OFF_ICQ_LSTIPTR
          3 000311  8D46 0004                            SDI      4,B6

  13655   3 000313  ABC6 0006                            LAB,B2   6,B6
          3 000315  AFC7 0006                            STB,B2   DCW$,AUTO

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:37   
      221    13657             %KJ$BLDDCW (OPERATION=DISCONNECTINT);

  13663   3 000317  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 00031A  2C00                                 LDV,R2   0
          3 00031B  6C0C                                 LDV,R6   12
          3 00031C  BCC7 0006                            LDB,B3   DCW$,AUTO
          3 00031E  3C00                                 LDV,R3   0
          3 00031F  0008                                 MMM

  13664   3 000320  6C38                                 LDV,R6   56
          3 000321  ECC7 0006                            LDB,B6   DCW$,AUTO
          3 000323  E786                                 STH,R6   ,B6

  13678   3 000324  BBC6 0006                            LAB,B3   6,B6
          3 000326  BFC7 0006                            STB,B3   DCW$,AUTO

      222    13680
      223    13681        /* Initialize the channel */
      224    13682    2        CALL INIT_COUPLER WHENALTRETURN DO;

  13682   3 000328  E3C0 009B                            LNJ,B6   s:0,PREL
          3 00032A       0003                            DC       s:13683,PREL
          3 00032B  0F81 0008                            B        s:13689,PREL

      225    13683    2             CALL M$SCREECH ( CPLR_IO ) ;

  13683   3 00032D  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000330  B870 0485                            LDR,R3   1157,IMO
          3 000332  0001                                 MCL
          3 000333       0000                            DC       s:13683+6,PREL

      226    13684        /*S* SCREECH_CODE: KJF-S$CPLR_IO
      227    13685             MESSAGE: An IO error occurred during HOST<->FEP data transfer.
      228    13686        */
      229    13687    2           END;

      230    13688
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:38   
      231    13689    2        CALL M$GETDCB ( FPT_GETDCB ) WHENALTRETURN DO ;

  13689   3 000334  BB80 0000 0047  01                   LAB,B3   FPT_GETDCB
          3 000337  B870 0D45                            LDR,R3   3397,IMO
          3 000339  0001                                 MCL
          3 00033A       0003                            DC       s:13690,PREL
          3 00033B  0F81 0008                            B        s:13692,PREL

      232    13690    2             CALL M$SCREECH ( CPLR_IO ) ;

  13690   3 00033D  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000340  B870 0485                            LDR,R3   1157,IMO
          3 000342  0001                                 MCL
          3 000343       0000                            DC       s:13690+6,PREL

      233    13691    2           END ;

      234    13692    1        WRITE_NODEADMN.V.DCB# = M$NA_DCBNUM ;

  13692   3 000344  E800 0000 0053  01                   LDR,R6   M$NA_DCBNUM
          3 000347  E780 0000 0044  01                   STH,R6   WRITE_NODEADMN+15

      235    13693    2        CALL M$WRITE ( WRITE_NODEADMN ) WHENALTRETURN DO ;

  13693   3 00034A  BB80 0000 0035  01                   LAB,B3   WRITE_NODEADMN
          3 00034D  B870 1543                            LDR,R3   5443,IMO
          3 00034F  0001                                 MCL
          3 000350       0003                            DC       s:13694,PREL
          3 000351  0F81 0008                            B        s:13701,PREL

      236    13694    2             CALL M$SCREECH ( CPLR_IO ) ;

  13694   3 000353  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000356  B870 0485                            LDR,R3   1157,IMO
          3 000358  0001                                 MCL
          3 000359       0000                            DC       s:13694+6,PREL

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:39   
      237    13695    2           END ;

      238    13696
      239    13697        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:40   
      240    13698        /* Main loop */
      241    13699    2        DO WHILE ('1'B);

      242    13700             /* If there is something in the buffer try to forward it */
      243    13701    2             IF KNH$QHDR.SCQ.IPTR ~= KNH$QHDR.SCQ.RPTR

  13701   3 00035A  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 00035D  E846 0004                            LDR,R6   4,B6
          3 00035F  E946 0005                            CMR,R6   5,B6
          3 000361  0901 001B                            BE       s:13712,PREL

      244    13702    2             THEN
      245    13703    3                  CALL M$WRTMLT (FPT_WRTMLT) WHENRETURN DO;

  13703   3 000363  BB80 0000 001D  01                   LAB,B3   FPT_WRTMLT
          3 000366  B870 1144                            LDR,R3   4420,IMO
          3 000368  0001                                 MCL
          3 000369       0014                            DC       s:13712,PREL

      246    13704    3                       IF KJ$CTX.FLAGS.BUF_FULL

  13704   3 00036A  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 00036D  89C6 0009                            CMZ      9,B6
          3 00036F  0881 000D                            BAGE     s:13712,PREL

      247    13705    3                       THEN
      248    13706    3                            IF KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR

  13706   3 000371  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          3 000374  E845 0004                            LDR,R6   4,B5
          3 000376  E945 0005                            CMR,R6   5,B5
          3 000378  0981 0004                            BNE      s:13712,PREL

      249    13707    3                            THEN
      250    13708    3                                 KJ$CTX.FLAGS.BUF_FULL = '0'B;

  13708   3 00037A  8846 0009                            LBF,'8000'X       9,B6
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:41   
  13708   3 00037C       8000

      251    13709    3                     END;

      252    13710
      253    13711
      254    13712    2             CALL GHH$LEV (DISABLE);

  13712   3 00037D  BB80 0000 0005  04                   LAB,B3   +5
          3 000380  CBF0 0100                            LAB,B4   256,IMO
          3 000382  E380 0000 0000  xent                 LNJ,B6   GHH$LEV
          3 000385       0001                            DC       s:13713,PREL

      255    13713    2             IF KJ$CTX.ICQ.RPTR ~= KJ$CTX.ICQ.IPTR

  13713   3 000386  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 000389  8CC6 000D                            LDI      13,B6
          3 00038B  84C6 000A                            SID      10,B6
          3 00038D  6981 0008                            BNEZ,R6  s:13717,PREL
          3 00038F  7981 0006                            BNEZ,R7  s:13717,PREL
          3 000391  82C6 0028                            LB,'0080'X        40,B6
          3 000393       0080
          3 000394  0581 000C                            BBF      s:13721,PREL

      256    13714    2                  OR KJ$CTX.OCQ.FLAGS.QFULL
             13714                           /* interrupt so host will check  qfull ldct list */
      257    13715    2             THEN
      258    13716    3             DO;

      259    13717    3                  KJ$CTX.PTR_DCW.OPERATION(5)= %KJ_DCW_INTL66;

  13717   3 000396  6C3B                                 LDV,R6   59
          3 000397  E7C6 00CE                            STH,R6   206,B6

      260    13718    3                  KJ_STATS.USRSTT.INPINTCNT = KJ_STATS.USRSTT.INPINTCNT + 1;

  13718   3 000399  8A80 0000 0015  xsym                 INC      KJ_STATS+21
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:42   
          3 00039C  8E80 0000 0014  xsym                 CAD      KJ_STATS+20

      261    13719    3                END;

  13719   3 00039F  0F81 0004                            B        s:13722,PREL

      262    13720    2             ELSE
      263    13721    2                  KJ$CTX.PTR_DCW.OPERATION(5)= %KJ_DCW_NOP;

  13721   3 0003A1  6C33                                 LDV,R6   51
          3 0003A2  E7C6 00CE                            STH,R6   206,B6

      264    13722    2             CALL KJF$DATA;

  13722   3 0003A4  CBF0 0000                            LAB,B4   0,IMO
          3 0003A6  E380 0000 0000  xent                 LNJ,B6   KJF$DATA
          3 0003A9       0001                            DC       s:13723,PREL

      265    13723    2             CALL GHH$LEV(ENABLE);

  13723   3 0003AA  BB80 0000 0007  04                   LAB,B3   +7
          3 0003AD  CBF0 0100                            LAB,B4   256,IMO
          3 0003AF  E380 0000 0000  xent                 LNJ,B6   GHH$LEV
          3 0003B2       0001                            DC       s:13725,PREL

      266    13724
      267    13725    2             CALL KHC$WAIT

  13725   3 0003B3  CBF0 0000                            LAB,B4   0,IMO
          3 0003B5  E380 0000 0000  xent                 LNJ,B6   KHC$WAIT
          3 0003B8       000A                            DC       s:13729,PREL

      268    13726    3             WHENRETURN DO;

      269    13727    3                  CALL KHC$DISPATCH(KH$EXP);

  13727   3 0003B9  BB80 0000 0009  04                   LAB,B3   +9
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:43   
          3 0003BC  CBF0 0100                            LAB,B4   256,IMO
          3 0003BE  E380 0000 0000  xent                 LNJ,B6   KHC$DISPATCH
          3 0003C1       0001                            DC       s:13729,PREL

      270    13728    3                END;

      271    13729    2           END;

  13729   3 0003C2  0F81 FF97                            B        s:13701,PREL

      272    13730
      273    13731        %EJECT;
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:44   
      274    13732    1   INIT_COUPLER: PROC ALTRET;

  13732   3 0003C4  EFC7 0008            INIT_COUPLER    STB,B6   DCW$+2,AUTO

      275    13733
      276    13734        /* Local variables */
      277    13735    2   DCL DCW$ PTR;
      278    13736
      279    13737    2        GH_IO = KJ_GH_IO_INIT;

  13737   3 0003C6  8C80 0000 0000  xsym                 LDI      KJ_GH_IO_INIT
          3 0003C9  8D47 0004                            SDI      GH_IO,AUTO

      280    13738    2        GH_IO.CAS.CHN = KJ$CTX.CHAN1;

  13738   3 0003CB  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          3 0003CE  D845 0003                            LDR,R5   3,B5
          3 0003D0  5006                                 SOL,R5   6
          3 0003D1  DAC7 0004                            SRM,R5,'FFC0'X    GH_IO,AUTO
          3 0003D3       FFC0

      281    13739    2        GH_IO.CAS.FNC = %KJ_IO_OUTCONT;

  13739   3 0003D4  5C01                                 LDV,R5   1
          3 0003D5  DAC7 0004                            SRM,R5,'003F'X    GH_IO,AUTO
          3 0003D7       003F

      282    13740    2        GH_IO.STATUS = KJ_INITCPLR;

  13740   3 0003D8  C800 0000 0000  xsym                 LDR,R4   KJ_INITCPLR
          3 0003DB  CF47 0005                            STR,R4   GH_IO+1,AUTO

      283    13741    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;

  13741   3 0003DD  CBC7 0004                            LAB,B4   GH_IO,AUTO
          3 0003DF  CFC7 000C                            STB,B4   DCW$+6,AUTO
          3 0003E1  BBC7 000C                            LAB,B3   DCW$+6,AUTO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:45   
          3 0003E3  CBF0 0100                            LAB,B4   256,IMO
          3 0003E5  E380 0000 0000  xent                 LNJ,B6   KJF$IO
          3 0003E8       0003                            DC       s:13742,PREL
          3 0003E9  0F81 0008                            B        s:13744,PREL

      284    13742    3             CALL M$SCREECH ( CPLR_IO ) ;

  13742   3 0003EB  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 0003EE  B870 0485                            LDR,R3   1157,IMO
          3 0003F0  0001                                 MCL
          3 0003F1       0000                            DC       s:13742+6,PREL

      285    13743    3           END;

      286    13744    2        GH_IO.CAS.FNC = %KJ_IO_WRTASK;

  13744   3 0003F2  6C07                                 LDV,R6   7
          3 0003F3  EAC7 0004                            SRM,R6,'003F'X    GH_IO,AUTO
          3 0003F5       003F

      287    13745    2        GH_IO.STATUS = KJ_TASK_INIT;

  13745   3 0003F6  D800 0000 0000  xsym                 LDR,R5   KJ_TASK_INIT
          3 0003F9  DF47 0005                            STR,R5   GH_IO+1,AUTO

      288    13746    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;

  13746   3 0003FB  EBC7 0004                            LAB,B6   GH_IO,AUTO
          3 0003FD  EFC7 000C                            STB,B6   DCW$+6,AUTO
          3 0003FF  BBC7 000C                            LAB,B3   DCW$+6,AUTO
          3 000401  CBF0 0100                            LAB,B4   256,IMO
          3 000403  E380 0000 0000  xent                 LNJ,B6   KJF$IO
          3 000406       0003                            DC       s:13747,PREL
          3 000407  0F81 0008                            B        s:13749,PREL

      289    13747    3             CALL M$SCREECH ( CPLR_IO ) ;

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:46   
  13747   3 000409  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 00040C  B870 0485                            LDR,R3   1157,IMO
          3 00040E  0001                                 MCL
          3 00040F       0000                            DC       s:13747+6,PREL

      290    13748    3           END;

      291    13749    2        GH_IO.CAS.FNC = %KJ_IO_WRCONFA;

  13749   3 000410  6C11                                 LDV,R6   17
          3 000411  EAC7 0004                            SRM,R6,'003F'X    GH_IO,AUTO
          3 000413       003F

      292    13750    2        IF KJ_DPS8000_FLG ~= 0 THEN

  13750   3 000414  D800 0000 0000  xsym                 LDR,R5   KJ_DPS8000_FLG
          3 000417  5901 0008                            BEZ,R5   s:13753,PREL

      293    13751    2             GH_IO.STATUS = KJ_CONFIG_INIT_ADP;

  13751   3 000419  C800 0000 0000  xsym                 LDR,R4   KJ_CONFIG_INIT_ADP
          3 00041C  CF47 0005                            STR,R4   GH_IO+1,AUTO
          3 00041E  0F81 0006                            B        s:13754,PREL

      294    13752    2        ELSE
      295    13753    2             GH_IO.STATUS = KJ_CONFIG_INIT;

  13753   3 000420  C800 0000 0000  xsym                 LDR,R4   KJ_CONFIG_INIT
          3 000423  CF47 0005                            STR,R4   GH_IO+1,AUTO

      296    13754    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;

  13754   3 000425  EBC7 0004                            LAB,B6   GH_IO,AUTO
          3 000427  EFC7 000C                            STB,B6   DCW$+6,AUTO
          3 000429  BBC7 000C                            LAB,B3   DCW$+6,AUTO
          3 00042B  CBF0 0100                            LAB,B4   256,IMO
          3 00042D  E380 0000 0000  xent                 LNJ,B6   KJF$IO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:47   
          3 000430       0003                            DC       s:13755,PREL
          3 000431  0F81 0008                            B        s:13757,PREL

      297    13755    3             CALL M$SCREECH ( CPLR_IO ) ;

  13755   3 000433  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000436  B870 0485                            LDR,R3   1157,IMO
          3 000438  0001                                 MCL
          3 000439       0000                            DC       s:13755+6,PREL

      298    13756    3           END;

      299    13757    2        GH_IO.CAS.FNC = %KJ_IO_WRINTCONT;

  13757   3 00043A  6C03                                 LDV,R6   3
          3 00043B  EAC7 0004                            SRM,R6,'003F'X    GH_IO,AUTO
          3 00043D       003F

      300    13758    2        GH_IO.STATUS = KJ_INTCONT_INIT;

  13758   3 00043E  D800 0000 0000  xsym                 LDR,R5   KJ_INTCONT_INIT
          3 000441  DF47 0005                            STR,R5   GH_IO+1,AUTO

      301    13759    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;

  13759   3 000443  EBC7 0004                            LAB,B6   GH_IO,AUTO
          3 000445  EFC7 000C                            STB,B6   DCW$+6,AUTO
          3 000447  BBC7 000C                            LAB,B3   DCW$+6,AUTO
          3 000449  CBF0 0100                            LAB,B4   256,IMO
          3 00044B  E380 0000 0000  xent                 LNJ,B6   KJF$IO
          3 00044E       0003                            DC       s:13760,PREL
          3 00044F  0F81 0008                            B        s:13762,PREL

      302    13760    3             CALL M$SCREECH ( CPLR_IO ) ;

  13760   3 000451  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000454  B870 0485                            LDR,R3   1157,IMO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:48   
          3 000456  0001                                 MCL
          3 000457       0000                            DC       s:13760+6,PREL

      303    13761    3           END;

      304    13762    2        GH_IO.CAS.FNC = %KJ_IO_INTL66;

  13762   3 000458  6C03                                 LDV,R6   3
          3 000459  EAC7 0004                            SRM,R6,'003F'X    GH_IO,AUTO
          3 00045B       003F

      305    13763    2        GH_IO.CAS.CHN = KJ$CTX.CHAN2;

  13763   3 00045C  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 00045F  D846 0004                            LDR,R5   4,B6
          3 000461  5006                                 SOL,R5   6
          3 000462  DAC7 0004                            SRM,R5,'FFC0'X    GH_IO,AUTO
          3 000464       FFC0

      306    13764    2        GH_IO.RANGE = %KJ_INTLVL_INIT;

  13764   3 000465  EF47 0005                            STR,R6   GH_IO+1,AUTO

      307    13765    3        CALL KJF$IO (GH_IO) WHENALTRETURN DO;

  13765   3 000467  DBC7 0004                            LAB,B5   GH_IO,AUTO
          3 000469  DFC7 000C                            STB,B5   DCW$+6,AUTO
          3 00046B  BBC7 000C                            LAB,B3   DCW$+6,AUTO
          3 00046D  CBF0 0100                            LAB,B4   256,IMO
          3 00046F  E380 0000 0000  xent                 LNJ,B6   KJF$IO
          3 000472       0003                            DC       s:13766,PREL
          3 000473  0F81 0008                            B        s:13769,PREL

      308    13766    3             CALL M$SCREECH ( CPLR_IO ) ;

  13766   3 000475  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000478  B870 0485                            LDR,R3   1157,IMO
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:49   
          3 00047A  0001                                 MCL
          3 00047B       0000                            DC       s:13766+6,PREL

      309    13767    3           END;

      310    13768
      311    13769    2        RETURN;

  13769   3 00047C  ECC7 0008                            LDB,B6   DCW$+2,AUTO
          3 00047E  C3C6 0001                            LNJ,B4   1,B6
      312    13770    2   END INIT_COUPLER;
      313    13771    1   END KJF$FEI;
      314    13772
      315    13773        %EOD;

PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:50   
--  Include file information  --

   KV$VDH.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KJF$FEI.
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:51   

 **** Variables and constants ****

  ****  Section 001  Data  KJF$FEI

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    58-0-0/w STRC(16)    r     1 DISABLE                   59-0-0/w STRC(16)    r     1 ENABLE
    47-0-0/w STRC(192)   r     1 FPT_GETDCB                2A-0-0/w STRC(128)   r     1 FPT_GETMEM
     A-0-0/w STRC(144)   r     1 FPT_INTCON                 0-0-0/w STRC(160)   r     1 FPT_SPRIV
    13-0-0/w STRC(160)   r     1 FPT_WAIT                  1D-0-0/w STRC(207)   r     1 FPT_WRTMLT
    5A-0-0/w STRC(1024)  r     1 KH$CTLTBL                 9A-0-0/w STRC(128)   r     1 KV$VDH_VDHINT
    53-0-0/w UBIN(16)    r     1 M$NA_DCBNUM               32-0-0/w STRC(48)    r     1 MEMORY_RESULTS
    54-0-0/w STRC(64)    r     1 VLP_HMI                   35-0-0/w STRC(288)   r     1 WRITE_NODEADMN

  ****  Section 002 RoData KJF$FEI

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    33-0-0/w STRC(96)    r     1 KH$EXP                     0-0-0/w STRC(16)    r     1 KL_CHSCRLVL
     1-0-0/c STRC(40)    r     1 M$NA_NAME                  4-0-0/w STRC(752)   r     1 OPEN_HMI
    39-0-0/b BIT (32)    r     1 PRIVS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 DCW$                       4-0-0/w STRC(32)    r     1 GH_IO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 CPLR_IO                    0-0-0/w PTR         r     1 G$DS4$
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:52   
     0-0-0/w PTR         r     1 G$HAND_Q$                  0-0-0/w PTR         r     1 KH_CTLTBL$
     0-0-0/w STRC(16)    r     1 KJ_CONFIG_INIT             0-0-0/w STRC(16)    r     1 KJ_CONFIG_INIT_ADP
     0-0-0/w STRC(160)   r     1 KJ_CONTROL                 0-0-0/w PTR         r     1 KJ_CTX$
     0-0-0/w STRC(96)    r     1 KJ_DCW_DTL66L6             0-0-0/w STRC(96)    r     1 KJ_DCW_DTL6L66
     0-0-0/w STRC(96)    r     1 KJ_DCW_JUMP                0-0-0/w UBIN(16)    r     1 KJ_DPS8000_FLG
     0-0-0/w STRC(32)    r     1 KJ_GH_IO_INIT              0-0-0/w STRC(32)    r     1 KJ_GH_IO_INTL66
     0-0-0/w STRC(16)    r     1 KJ_INITCPLR                0-0-0/w STRC(16)    r     1 KJ_INTCONT_INIT
     0-0-0/w STRC(80)    r     1 KJ_IOLD_BARR               0-0-0/w STRC(80)    r     1 KJ_IOLD_DCWLIST
     0-0-0/w UBIN(32)    r     1 KJ_OFF_ICQ_DATA            0-0-0/w UBIN(32)    r     1 KJ_OFF_ICQ_IPTR
     0-0-0/w UBIN(32)    r     1 KJ_OFF_ICQ_LSTIPTR         0-0-0/w UBIN(32)    r     1 KJ_OFF_ICQ_RPTR
     0-0-0/w UBIN(32)    r     1 KJ_OFF_IOIP                0-0-0/w UBIN(32)    r     1 KJ_OFF_OCQ_DATA
     0-0-0/w UBIN(32)    r     1 KJ_OFF_OCQ_FLAGS           0-0-0/w UBIN(32)    r     1 KJ_OFF_OCQ_IPTR
     0-0-0/w UBIN(32)    r     1 KJ_OFF_OCQ_RPTR            0-0-0/w PTR         r     1 KJ_RCQ$
     0-0-0/w UBIN(32)    r     1 KJ_RCQ_OFFSET              0-0-0/w PTR         r     1 KJ_SCQ$
     0-0-0/w UBIN(32)    r     1 KJ_SCQ_OFFSET              0-0-0/w UBIN(32)    r     1 KJ_SIZE
     0-0-0/w STRC(864)   r     1 KJ_STATS                   0-0-0/w STRC(16)    r     1 KJ_TASK_INIT
     0-0-0/w UBIN(32)    r     1 KJ_TIME                    0-0-0/w UBIN(16)    r     1 KJ_TIME_LEFT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1696)  r     1 G$BOBCAT                   0-0-0/w STRC(3680)  r     1 KJ$CTX
     0-0-0/w STRC(96)    r     1 KJ$DCW                     0-0-0/c STRC(128)   r     1 KNH$MESS
     0-0-0/w STRC(384)   r     1 KNH$QHDR                   0-0-0N  NULL        r     1 M$CQ


   Procedure KJF$FEI requires 1152 words for executable code.
   Procedure KJF$FEI requires 20 words of local(AUTO) storage.
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:54   
          MINI XREF LISTING

CPLR_IO
     10056**DCL     13683<>CALL    13690<>CALL    13694<>CALL    13742<>CALL    13747<>CALL    13755<>CALL
     13760<>CALL    13766<>CALL
DCW$
     12860**DCL     13436<<ASSIGN  13445>>ASSIGN  13451>>ASSIGN  13454>>ASSIGN  13457>>ASSIGN  13460>>ASSIGN
     13462<<ASSIGN  13462>>ASSIGN  13471>>ASSIGN  13479>>ASSIGN  13482>>ASSIGN  13485>>ASSIGN  13488>>ASSIGN
     13490<<ASSIGN  13490>>ASSIGN  13501>>ASSIGN  13507>>ASSIGN  13510>>ASSIGN  13513>>ASSIGN  13516>>ASSIGN
     13518<<ASSIGN  13518>>ASSIGN  13529>>ASSIGN  13535>>ASSIGN  13538>>ASSIGN  13541>>ASSIGN  13544>>ASSIGN
     13546<<ASSIGN  13546>>ASSIGN  13555>>ASSIGN  13563>>ASSIGN  13566>>ASSIGN  13569>>ASSIGN  13572>>ASSIGN
     13574<<ASSIGN  13574>>ASSIGN  13584>>ASSIGN  13585>>ASSIGN  13588>>ASSIGN  13599<<ASSIGN  13599>>ASSIGN
     13612>>ASSIGN  13613>>ASSIGN  13616>>ASSIGN  13619>>ASSIGN  13622>>ASSIGN  13625>>ASSIGN  13627<<ASSIGN
     13627>>ASSIGN  13636>>ASSIGN  13644>>ASSIGN  13647>>ASSIGN  13650>>ASSIGN  13653>>ASSIGN  13655<<ASSIGN
     13655>>ASSIGN  13663>>ASSIGN  13664>>ASSIGN  13678<<ASSIGN  13678>>ASSIGN
DISABLE
     13025**DCL     13712<>CALL
DISABLE.LEVEL
     13025**DCL     13386<<ASSIGN
ENABLE
     13047**DCL     13723<>CALL
FPT_GETDCB
     12747**DCL     13689<>CALL
FPT_GETDCB.V
     12751**DCL     12749--DCLINIT
FPT_GETMEM
     12634**DCL     13366<>CALL
FPT_GETMEM.V
     12637**DCL     12637--DCLINIT
FPT_GETMEM.V.PAGES
     12641**DCL     13357--ASSIGN
FPT_INTCON
     12568**DCL     13392<>CALL
FPT_INTCON.V
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:55   
     12572**DCL     12570--DCLINIT
FPT_INTCON.V.IENTRY$
     12572**DCL     13391<<ASSIGN
FPT_INTCON.V.LEVEL
     12572**DCL     13385<<ASSIGN
FPT_INTCON.V.RUNLEVEL
     12572**DCL     13390<<ASSIGN
FPT_SPRIV
     12545**DCL     13353<>CALL
FPT_SPRIV.V
     12547**DCL     12547--DCLINIT
FPT_WAIT
     12590**DCL     13378<>CALL
FPT_WAIT.V
     12594**DCL     12593--DCLINIT
FPT_WRTMLT
     12614**DCL     13703<>CALL
FPT_WRTMLT.V
     12619**DCL     12616--DCLINIT
G$BOBCAT.DPS8000FLG
     12878**DCL     13372>>ASSIGN
G$DS4$
     12864**DCL     12868--IMP-PTR 13372>>ASSIGN
G$HAND_Q$
      9294**DCL     12930--IMP-PTR 13393>>ASSIGN  13393>>ASSIGN  13396>>ASSIGN  13396>>ASSIGN  13404>>ASSIGN
     13404>>ASSIGN  13406>>ASSIGN  13406>>ASSIGN  13411>>ASSIGN  13412>>ASSIGN  13413>>ASSIGN  13414>>ASSIGN
     13415>>ASSIGN  13416>>ASSIGN  13417>>ASSIGN  13418>>ASSIGN  13419>>ASSIGN  13420>>ASSIGN  13421>>ASSIGN
     13422>>ASSIGN  13423>>ASSIGN  13428>>ASSIGN  13701>>IF      13701>>IF      13706>>IF      13706>>IF
GHH$LEV
     12839**DCL-ENT 13712--CALL    13723--CALL
GH_IO
     12855**DCL     13737<<ASSIGN  13741<>CALL    13746<>CALL    13754<>CALL    13759<>CALL    13765<>CALL
GH_IO.CAS.CHN
     12855**DCL     12855--REDEF   13738<<ASSIGN  13763<<ASSIGN
GH_IO.CAS.FNC
     12856**DCL     13739<<ASSIGN  13744<<ASSIGN  13749<<ASSIGN  13757<<ASSIGN  13762<<ASSIGN
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:56   
GH_IO.DAS
     12856**DCL     12857--REDEF   12858--REDEF
GH_IO.RANGE
     12857**DCL     13764<<ASSIGN
GH_IO.STATUS
     12858**DCL     13740<<ASSIGN  13745<<ASSIGN  13751<<ASSIGN  13753<<ASSIGN  13758<<ASSIGN
INIT_COUPLER
     13732**PROC    13682--CALL
KH$CTLTBL
     13131**DCL     13356--ASSIGN  13365<>CALL
KH$CTLTBL.PARM.PTR$
     13257**DCL     13357<<ASSIGN  13358<<ASSIGN  13359<<ASSIGN  13360<<ASSIGN  13361<<ASSIGN  13362<<ASSIGN
     13363<<ASSIGN  13364<<ASSIGN
KH$EXP
     13064**DCL     13727<>CALL
KH$EXP.UID
     13070**DCL     13071--REDEF
KHA$INIT
     12829**DCL-ENT 13355--CALL
KHA$INIT_CHANTBL
     12831**DCL-ENT 13370--CALL
KHA$INIT_CONTROL
     12830**DCL-ENT 13365--CALL
KHA$INIT_DONE
     12832**DCL-ENT 13371--CALL
KHC$DISPATCH
     12834**DCL-ENT 13727--CALL
KHC$WAIT
     12835**DCL-ENT 13725--CALL
KH_CTLTBL$
     13326**DCL     13356<<ASSIGN
KJ$CTX
      9294**DCL     12823--DCLINIT 13383--ASSIGN  13396--ASSIGN  13398<<ASSIGN  13408--ASSIGN
KJ$CTX.CHAN0
      9305**DCL     13401<<ASSIGN  13427>>ASSIGN
KJ$CTX.CHAN1
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:57   
      9305**DCL     13402<<ASSIGN  13430>>ASSIGN  13738>>ASSIGN
KJ$CTX.CHAN2
      9305**DCL     13403<<ASSIGN  13433>>ASSIGN  13763>>ASSIGN
KJ$CTX.DCWS
      9330**DCL     13424--ASSIGN  13431--ASSIGN  13432--ASSIGN
KJ$CTX.FLAGS.BUF_FULL
      9306**DCL     13704>>IF      13708<<ASSIGN
KJ$CTX.IBUF.BUF$
      9309**DCL     13408<<ASSIGN
KJ$CTX.IBUF.SIZE
      9309**DCL     13409<<ASSIGN
KJ$CTX.ICQ.BUF$
      9307**DCL     13406<<ASSIGN  13415>>ASSIGN
KJ$CTX.ICQ.BUF_SIZE
      9307**DCL     13407<<ASSIGN
KJ$CTX.ICQ.IPTR
      9306**DCL     13412--ASSIGN  13713>>IF
KJ$CTX.ICQ.LSTIPTR
      9307**DCL     13419--ASSIGN
KJ$CTX.ICQ.OFFSET
      9307**DCL     13541>>ASSIGN  13569>>ASSIGN  13650>>ASSIGN
KJ$CTX.ICQ.RPTR
      9306**DCL     13411--ASSIGN  13713>>IF
KJ$CTX.IOIP
      9309**DCL     13418--ASSIGN
KJ$CTX.OCQ.BUF$
      9309**DCL     13404<<ASSIGN  13416>>ASSIGN
KJ$CTX.OCQ.BUF_SIZE
      9309**DCL     13405<<ASSIGN
KJ$CTX.OCQ.FLAGS
      9308**DCL     13417--ASSIGN
KJ$CTX.OCQ.FLAGS.QFULL
      9308**DCL     13713>>IF
KJ$CTX.OCQ.IPTR
      9308**DCL     13414--ASSIGN
KJ$CTX.OCQ.RPTR
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:58   
      9308**DCL     13413--ASSIGN
KJ$CTX.PTR_DCW
      9370**DCL     13424--ASSIGN  13432--ASSIGN  13436--ASSIGN
KJ$CTX.PTR_DCW.OPERATION
      9376**DCL     13717<<ASSIGN  13721<<ASSIGN
KJ$DCW
      9169**DCL     13445<<ASSIGN  13462--ASSIGN  13471<<ASSIGN  13490--ASSIGN  13501<<ASSIGN  13518--ASSIGN
     13529<<ASSIGN  13546--ASSIGN  13555<<ASSIGN  13574--ASSIGN  13584<<ASSIGN  13599--ASSIGN  13612<<ASSIGN
     13627--ASSIGN  13636<<ASSIGN  13655--ASSIGN  13663<<ASSIGN  13678--ASSIGN
KJ$DCW.L66A
      9192**DCL     13457<<ASSIGN  13485<<ASSIGN  13513<<ASSIGN  13541<<ASSIGN  13569<<ASSIGN  13622<<ASSIGN
     13650<<ASSIGN
KJ$DCW.L6A
      9193**DCL     13460<<ASSIGN  13488<<ASSIGN  13516<<ASSIGN  13544<<ASSIGN  13572<<ASSIGN  13625<<ASSIGN
     13653<<ASSIGN
KJ$DCW.MODE
      9185**DCL     13451<<ASSIGN  13479<<ASSIGN  13507<<ASSIGN  13535<<ASSIGN  13563<<ASSIGN  13588<<ASSIGN
     13616<<ASSIGN  13644<<ASSIGN
KJ$DCW.OPERATION
      9180**DCL     13585<<ASSIGN  13613<<ASSIGN  13664<<ASSIGN
KJ$DCW.TALLY
      9190**DCL     13454<<ASSIGN  13482<<ASSIGN  13510<<ASSIGN  13538<<ASSIGN  13566<<ASSIGN  13619<<ASSIGN
     13647<<ASSIGN
KJF$ADM
     12837**DCL-ENT 13370--CALL
KJF$DATA
     12840**DCL-ENT 13722--CALL
KJF$INTHAND
     12841**DCL-ENT 13391--ASSIGN
KJF$IO
     12838**DCL-ENT 13741--CALL    13746--CALL    13754--CALL    13759--CALL    13765--CALL
KJ_CONFIG_INIT
      9228**DCL     13753>>ASSIGN
KJ_CONFIG_INIT.L6SPECINTLVL
      9235**DCL     13387<<ASSIGN
KJ_CONFIG_INIT_ADP
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:59   
      9250**DCL     13751>>ASSIGN
KJ_CONFIG_INIT_ADP.L6SPECINTLVL
      9257**DCL     13388<<ASSIGN
KJ_CONTROL.ATTR
      9396**DCL     13360--ASSIGN  13370<>CALL
KJ_CONTROL.CHAN
      9395**DCL     13376>>DOWHILE 13401>>ASSIGN  13402>>ASSIGN  13403>>ASSIGN
KJ_CONTROL.ICQPGS
      9395**DCL     13361--ASSIGN  13382>>ASSIGN  13407>>ASSIGN
KJ_CONTROL.INTHTIME
      9396**DCL     13363--ASSIGN
KJ_CONTROL.INTLVL
      9395**DCL     13358--ASSIGN  13385>>ASSIGN  13386>>ASSIGN  13387>>ASSIGN  13388>>ASSIGN  13389>>ASSIGN
     13390>>ASSIGN
KJ_CONTROL.INTPGS
      9395**DCL     13409>>ASSIGN
KJ_CONTROL.OCQDBLKSIZ
      9396**DCL     13364--ASSIGN
KJ_CONTROL.OCQPGS
      9395**DCL     13362--ASSIGN  13381>>ASSIGN  13405>>ASSIGN
KJ_CONTROL.RES
      9396**DCL     13359--ASSIGN  13370<>CALL
KJ_CTX$
      9294**DCL      9294--IMP-PTR 13393<<ASSIGN  13398>>ASSIGN  13401>>ASSIGN  13402>>ASSIGN  13403>>ASSIGN
     13404>>ASSIGN  13405>>ASSIGN  13406>>ASSIGN  13407>>ASSIGN  13408>>ASSIGN  13408>>ASSIGN  13409>>ASSIGN
     13411>>ASSIGN  13412>>ASSIGN  13413>>ASSIGN  13414>>ASSIGN  13415>>ASSIGN  13416>>ASSIGN  13417>>ASSIGN
     13418>>ASSIGN  13419>>ASSIGN  13424>>ASSIGN  13424>>ASSIGN  13427>>ASSIGN  13430>>ASSIGN  13431>>ASSIGN
     13433>>ASSIGN  13436>>ASSIGN  13541>>ASSIGN  13569>>ASSIGN  13650>>ASSIGN  13704>>IF      13708>>ASSIGN
     13713>>IF      13713>>IF      13713>>IF      13717>>ASSIGN  13721>>ASSIGN  13738>>ASSIGN  13763>>ASSIGN
KJ_DCW_DTL66L6
      9049**DCL     13445>>ASSIGN  13501>>ASSIGN  13529>>ASSIGN
KJ_DCW_DTL6L66
      9089**DCL     13471>>ASSIGN  13555>>ASSIGN  13584>>ASSIGN  13612>>ASSIGN  13636>>ASSIGN  13663>>ASSIGN
KJ_DCW_JUMP.L6A
      9153**DCL     13424<<ASSIGN
KJ_DPS8000_FLG
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:60   
      9395**DCL     13372<<ASSIGN  13750>>IF
KJ_GH_IO_INIT
     10008**DCL     13737>>ASSIGN
KJ_GH_IO_INIT.CAS.CHN
     10008**DCL     10008--REDEF
KJ_GH_IO_INIT.DAS
     10009**DCL     10010--REDEF   10011--REDEF
KJ_GH_IO_INTL66.CAS.CHN
     10024**DCL     10024--REDEF   13433<<ASSIGN
KJ_GH_IO_INTL66.DAS
     10025**DCL     10026--REDEF   10027--REDEF
KJ_INITCPLR
      9272**DCL     13740>>ASSIGN
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9851**DCL      9852--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9852**DCL      9852--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9840**DCL      9849--REDEF
KJ_INIT_MSG.FUNCTION
      9765**DCL      9765--REDEF
KJ_INIT_MSG.UID
      9795**DCL      9795--REDEF    9795--REDEF
KJ_INTCONT_INIT
      9290**DCL     13758>>ASSIGN
KJ_INTCONT_INIT.L6TERMINTLVL
      9292**DCL     13389<<ASSIGN
KJ_IOLD_BARR.BUF$
      9979**DCL     13428<<ASSIGN
KJ_IOLD_BARR.BUFSIZE
      9980**DCL     13429<<ASSIGN
KJ_IOLD_BARR.CHN
      9978**DCL      9978--REDEF   13427<<ASSIGN
KJ_IOLD_DCWLIST.BUF$
      9994**DCL     13431<<ASSIGN
KJ_IOLD_DCWLIST.BUFSIZE
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:61   
      9995**DCL     13432<<ASSIGN
KJ_IOLD_DCWLIST.CHN
      9993**DCL      9993--REDEF   13430<<ASSIGN
KJ_OFF_ICQ_DATA
      9391**DCL     13415<<ASSIGN
KJ_OFF_ICQ_IPTR
      9391**DCL     13412<<ASSIGN  13572>>ASSIGN
KJ_OFF_ICQ_LSTIPTR
      9391**DCL     13419<<ASSIGN  13653>>ASSIGN
KJ_OFF_ICQ_RPTR
      9391**DCL     13411<<ASSIGN  13544>>ASSIGN
KJ_OFF_IOIP
      9392**DCL     13418<<ASSIGN  13625>>ASSIGN
KJ_OFF_OCQ_DATA
      9392**DCL     13416<<ASSIGN
KJ_OFF_OCQ_FLAGS
      9393**DCL     13417<<ASSIGN  13516>>ASSIGN
KJ_OFF_OCQ_IPTR
      9392**DCL     13414<<ASSIGN  13460>>ASSIGN
KJ_OFF_OCQ_RPTR
      9392**DCL     13413<<ASSIGN  13488>>ASSIGN
KJ_RCQ$
      9394**DCL     13423<<ASSIGN
KJ_RCQ_OFFSET
      9393**DCL     13421<<ASSIGN  13423>>ASSIGN
KJ_SCQ$
      9393**DCL     13422<<ASSIGN
KJ_SCQ_OFFSET
      9393**DCL     13420<<ASSIGN  13422>>ASSIGN
KJ_SIZE
      9294**DCL     13396<<ASSIGN  13429>>ASSIGN
KJ_STATS.REQSTATS.DSPENT
      9663**DCL     13374<<ASSIGN
KJ_STATS.REQSTATS.DSPMSK
      9657**DCL      9663--REDEF
KJ_STATS.REQSTATS.SLCENT
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:62   
      9705**DCL     13375<<ASSIGN
KJ_STATS.REQSTATS.SLCMSK
      9698**DCL      9705--REDEF
KJ_STATS.USRSTT.INPINTCNT
      9727**DCL     13718<<ASSIGN  13718>>ASSIGN
KJ_TASK_INIT
      9208**DCL     13745>>ASSIGN
KJ_TERM_MSG.FUNCTION
      9883**DCL      9883--REDEF
KJ_TERM_MSG.UID
      9913**DCL      9913--REDEF    9913--REDEF
KJ_TIME
      9394**DCL     12593--DCLINIT 13377<<ASSIGN
KJ_TIME_LEFT
      9394**DCL     12594--DCLINIT
KL_CHSCRLVL
     12725**DCL     12685--DCLINIT
KNH$MESS
     12893**DCL     13383--ASSIGN  13396--ASSIGN
KNH$MESS.FUNCTION
     12893**DCL     12893--REDEF
KNH$MESS.UID
     12923**DCL     12923--REDEF   12923--REDEF
KNH$QHDR
     12930**DCL     13396--ASSIGN
KNH$QHDR.CTX.OFFSET
     12934**DCL     13393>>ASSIGN
KNH$QHDR.RCQ
     12930**DCL     12930--REDEF
KNH$QHDR.RCQ.OFFSET
     12930**DCL     13406>>ASSIGN  13421>>ASSIGN
KNH$QHDR.RCQ.SZ
     12930**DCL     13396>>ASSIGN
KNH$QHDR.SCQ.IPTR
     12931**DCL     13701>>IF      13706>>IF
KNH$QHDR.SCQ.OFFSET
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:63   
     12931**DCL     13404>>ASSIGN  13420>>ASSIGN
KNH$QHDR.SCQ.RPTR
     12931**DCL     13701>>IF      13706>>IF
KNH$QHDR.SCQ.SZ
     12931**DCL     13396>>ASSIGN
KV$VDH_VDHINT
     13340**DCL     13369<>CALL
KV$VDH_VDHINT.BFRBGN$
     13340**DCL     13367<<ASSIGN
KV$VDH_VDHINT.BFREND$
     13340**DCL     13368<<ASSIGN
KVB$INT
     12836**DCL-ENT 13369--CALL
M$GDS
      4566**DCL-ENT 13366--CALL
M$GETDCB
      4572**DCL-ENT 13689--CALL
M$INTCON
      4545**DCL-ENT 13392--CALL
M$NA_DCBNUM
     12754**DCL     12749--DCLINIT 13692>>ASSIGN
M$NA_NAME
     12770**DCL     12749--DCLINIT
M$OPEN
      4571**DCL-ENT 13384--CALL
M$SCREECH
      4551**DCL-ENT 13683--CALL    13690--CALL    13694--CALL    13742--CALL    13747--CALL    13755--CALL
     13760--CALL    13766--CALL
M$SPRIV
      4560**DCL-ENT 13353--CALL
M$SYS
      4546**DCL-ENT 13354--CALL
M$WAIT
      4555**DCL-ENT 13378--CALL
M$WRITE
      4572**DCL-ENT 13693--CALL
PL6.E3A0      #001=KJF$FEI File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:45 Page:64   
M$WRTMLT
      4572**DCL-ENT 13703--CALL
MEMORY_RESULTS
     12659**DCL     12637--DCLINIT
MEMORY_RESULTS.BASE
     12663**DCL     12663--REDEF
MEMORY_RESULTS.BASE$
     12663**DCL     13367>>ASSIGN  13368>>ASSIGN
MEMORY_RESULTS.PAGES
     12663**DCL     13368>>ASSIGN
OPEN_HMI
     12791**DCL     13384<>CALL
OPEN_HMI.V
     12799**DCL     12793--DCLINIT
PRIVS
     13348**DCL     12547--DCLINIT
VLP_HMI
     12822**DCL     12793--DCLINIT
VLP_HMI.CTXSIZE
     12822**DCL     13383<<ASSIGN
VLP_HMI.RCQSIZE
     12822**DCL     13382<<ASSIGN
VLP_HMI.SCQSIZE
     12822**DCL     13381<<ASSIGN
WRITE_NODEADMN
     12683**DCL     13693<>CALL
WRITE_NODEADMN.V
     12688**DCL     12685--DCLINIT
WRITE_NODEADMN.V.DCB#
     12688**DCL     13692<<ASSIGN

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:65   
      316        1        /*T***********************************************************/
      317        2        /*T*                                                         */
      318        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      319        4        /*T*                                                         */
      320        5        /*T***********************************************************/
      321        6        KJF$INTHAND: PROC ASYNC;
      322        7
      323        8
      324        9        /* Entry point referneces */
      325       10    1   DCL KJF$IO ENTRY(1) ALTRET;
      326       11    1   DCL KJF$DCWLIST ENTRY;
      327       12    1   DCL KJF$DATA ENTRY;
      328       13    1   DCL KJF$GETSTATUS ENTRY ALTRET;
      329       14    1   DCL KJF$FIX ENTRY(2) ALTRET;
      330       15        %INCLUDE KJ_DATA_R;
      331    10256    1   DCL X6A_INTRET ENTRY(1);
      332    10257    1   DCL KHC$XEQ2 ENTRY(1) ALTRET;
      333    10258
      334    10259        /* Local variables */
      335    10260    1   DCL DCW$ PTR;
      336    10261    1   DCL SIZE UBIN(32);
      337    10262    1   DCL SIZE2 UBIN(32);
      338    10263    1   DCL IP$ PTR;
      339    10264    1   DCL SCANSZ UBIN(32);
      340    10265    1   DCL MSGSZ UBIN;
      341    10266    1   DCL SVDXEQTIM UBIN(32);
      342    10267    1   DCL CURXEQTIM UBIN(32);
      343    10268
      344    10269        /* Based structures */
      345    10270        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      346    10283        %KNH$MESS (STCLASS="BASED(IP$)");
      347    10332
      348    10333        /* FPTs */
      349    10334        %FPT_INTRET;
      350    10354        %FPT_WRTMLT (DCB=M$CQ);
      351    10374    1   DCL 1 KJF_SAVE (0:9) STATIC SYMDEF,
      352    10375    1            2 STATUS1 BIT(16),
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:66   
      353    10376    1            2 STATUS2 BIT(16),
      354    10377    1            2 OIPTR UBIN(32),
      355    10378    1            2 ORPTR UBIN(32),
      356    10379    1            2 IIPTR UBIN(32),
      357    10380    1            2 IRPTR UBIN(32);
      358    10381
      359    10382    1   DCL KJF_COUNT SBIN STATIC SYMDEF INIT(-1);
      360    10383
      361    10384    1        CALL KHC$XEQ2(SVDXEQTIM);
      362    10385    1        KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;
      363    10386
      364    10387        /* Do the appropiate thing on the condition encountered */
      365    10388    2        CALL KJF$GETSTATUS WHENALTRETURN DO;
      366    10389    2             CALL M$SCREECH ( CPLR_IO ) ;
      367    10390    2           END;
      368    10391    1        KJF_COUNT = KJF_COUNT + 1;
      369    10392    1        IF KJF_COUNT = 10
      370    10393    1        THEN
      371    10394    1             KJF_COUNT = 0;
      372    10395    1        KJF_SAVE.STATUS1(KJF_COUNT) = KJ$CTX.STATUS1;
      373    10396    1        KJF_SAVE.STATUS2(KJF_COUNT) = KJ$CTX.STATUS2;
      374    10397    1        KJF_SAVE.OIPTR(KJF_COUNT)=KJ$CTX.OCQ.IPTR;
      375    10398    1        KJF_SAVE.ORPTR(KJF_COUNT)=KJ$CTX.OCQ.RPTR;
      376    10399    1        KJF_SAVE.IRPTR(KJF_COUNT)=KJ$CTX.ICQ.RPTR;
      377    10400    1        KJF_SAVE.IIPTR(KJF_COUNT)=KJ$CTX.ICQ.IPTR;
      378    10401
      379    10402
      380    10403        /* Check the status of the coupler */
      381    10404    1        IF KJ$CTX.STATUS1 = %KJ_STATUS_DR
      382    10405    1        THEN
      383    10406    2        DO CASE (KJ$CTX.CURRENT_FUNCTION); /* Finish last function */
      384    10407
      385    10408        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:67   
      386    10409    2        CASE (%KJ_CF_NONE);                /* No function in progress */
      387    10410
      388    10411        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:68   
      389    10412    2        CASE (%KJ_CF_INIT);                /* Init coupler */
      390    10413        /* Read in OCQ size */
      391    10414        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:69   
      392    10415    2        CASE (%KJ_CF_ROCQSIZE);            /* No function in progress */
      393    10416    2           KJ$CTX.ICQ.OFFSET = ((KJ$CTX.OCQ.SIZE + 1023) /1024) * 1024;
      394    10417    2           KJ$CTX.PTR_DCW.L66A(3) = %KJ_OFFSET_RPTR + KJ$CTX.ICQ.OFFSET;
      395    10418    2           KJ$CTX.PTR_DCW.L66A(4) = %KJ_OFFSET_IPTR + KJ$CTX.ICQ.OFFSET;
      396    10419    2           KJ$CTX.PTR_DCW.L66A(7) = %KJ_OFFSET_LSTIPTR + KJ$CTX.ICQ.OFFSET;
      397    10420
      398    10421        /* Read in ICQ size */
      399    10422    2           DCW$ = ADDR(KJ$CTX.DCWS);
      400    10423
      401    10424                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      402    10425                L66A="%KJ_OFFSET_SIZE + KJ$CTX.ICQ.OFFSET",
      403    10426                L6A="POFFW(ADDR(KJ$CTX.ICQ.SIZE),G$HAND_Q$)",
      404    10427                MODE=%KJ_MODE_BIN,
      405    10428                TALLY=1);
      406    10451
      407    10452                %KJ$BLDDCW (OPERATION=DISCONNECTINT);
      408    10475
      409    10476    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_RICQSIZE;
      410    10477        /* Do the IO and the interupt will trigger us to go further */
      411    10478    2           CALL KJF$DCWLIST;
      412    10479
      413    10480        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:70   
      414    10481    2        CASE (%KJ_CF_RICQSIZE);
      415    10482    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;
      416    10483    2           CALL KJF$DATA;
      417    10484
      418    10485        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:71   
      419    10486    2        CASE (%KJ_CF_DATA);                /* Data transfered */
      420    10487
      421    10488    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;
      422    10489
      423    10490    2           KNH$QHDR.RCQ.RPTR = KJ$CTX.ICQ.NEW_RPTR;
      424    10491
      425    10492    2           IP$ = PINCRW(KJ$CTX.OCQ.BUF$,KNH$QHDR.SCQ.IPTR*2);
      426    10493    2           SCANSZ = KJ$CTX.OCQ.RDSIZE;
      427    10494
      428    10495    2           IF SCANSZ > KNH$QHDR.SCQ.SZ
      429    10496    2           THEN
      430    10497    2                CALL M$SCREECH ( CPLR_SCANSZ ) ;
      431    10498        /*S* SCREECH_CODE: KJF-S$CPLR_SCANSZ
      432    10499             MESSAGE: The message scanning logic in COUPLER failed.
      433    10500        */
      434    10501
      435    10502    3           DO WHILE (SCANSZ >= SIZEW(KNH$MESS)/2);
      436    10503
      437    10504    3                MSGSZ = (SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ+1)/2 + (KNH$MESS.MSGSZ+1)/2
             10504                         +1)/2;
      438    10505    3                IF MSGSZ > SCANSZ          /* Not a complete message */
      439    10506    3                THEN
      440    10507    3                     EXIT;
      441    10508
      442    10509    3                KJ_STATS.OCQ_MSGS = KJ_STATS.OCQ_MSGS + 1;
      443    10510    3                KJ_STATS.OCQ_MBC = KJ_STATS.OCQ_MBC + KNH$MESS.MSGSZ;
      444    10511    3                KNH$MESS.RECTYPE = 0;
      445    10512    3                KNH$MESS.LAST_PTR = KNH$QHDR.LAST_SCQPTR;
      446    10513    3                KNH$QHDR.LAST_SCQPTR = KNH$QHDR.SCQ.IPTR;
      447    10514    4                DO CASE(KNH$MESS.FUNCTION);
      448    10515
      449    10516
      450    10517    4                CASE (%KJ_FCN_RUOK);
      451    10518    4                   KJ_STATS.DATAFNC.RUOK = KJ_STATS.DATAFNC.RUOK + 1;
      452    10519    4                   KJ_INIT_MSG.FPT.RLCID.NODE = KJ$CTX.HOST_NODE;
      453    10520    4                   KJ_INIT_MSG.FPT.RLCID.FEP_NODE = KJ$CTX.FEP_NODE;
      454    10521    4                   KJ_INIT_MSG.FPT.RLCID.FLAGS.HOST_NODE = '1'B;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:72   
      455    10522    4                   KJ_INIT_MSG.FPT.SERVICE = KJ$CTX.QOS;
      456    10523    4                   KJ_INIT_MSG.LDCTX = 0;  /* zap the ldct */
      457    10524    4                   CALL M$WRITE (KJ_WRT_INIT);
      458    10525    4                   KNH$MESS.FUNCTION = %KN_FCN_NOP;
      459    10526
      460    10527    4                CASE (%KJ_FCN_ODATA);
      461    10528    4                   KJ_STATS.DATAFNC.ODATA = KJ_STATS.DATAFNC.ODATA + 1;
      462    10529    4                   KNH$MESS.FUNCTION = %KN_FCN_DATA;
      463    10530
      464    10531    4                CASE (%KJ_FCN_NOP);
      465    10532    4                   KJ_STATS.DATAFNC.NOP = KJ_STATS.DATAFNC.NOP + 1;
      466    10533    4                   KNH$MESS.FUNCTION = %KN_FCN_NOP;
      467    10534
      468    10535    4                CASE (%KJ_FCN_TIM);
      469    10536    4                   KNH$MESS.FUNCTION = %KN_FCN_DATA;
      470    10537    4                   KJ_STATS.DATAFNC.TIM = KJ_STATS.DATAFNC.TIM + 1;
      471    10538    4                   KNH$MESS.RECTYPE = %KJ_FCN_TIM;
      472    10539
      473    10540    4                CASE (ELSE);
      474    10541    4                   CALL M$SCREECH ( CPLR_BADMSG ) ;
      475    10542        /*S* SCREECH_CODE: KJF-S$CPLR_BADMSG
      476    10543             MESSAGE: An illegal message was sent to the FEP.
      477    10544        */
      478    10545
      479    10546
      480    10547
      481    10548    4                END;                       /* End cases */
      482    10549
      483    10550    3                KNH$MESS.FPTSZ = 0;
      484    10551    3                KNH$MESS.LDCTX = KJ_LDCTX;
      485    10552    3                KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.IPTR + MSGSZ;
      486    10553
      487    10554    3                SCANSZ = SCANSZ - MSGSZ;
      488    10555    3                IP$ = PINCRW(IP$,MSGSZ*2);
      489    10556
      490    10557             /* Increment host removal pointer */
      491    10558    3                KJ$CTX.OCQ.RPTR = KJ$CTX.OCQ.RPTR + MSGSZ;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:73   
      492    10559    3                IF KJ$CTX.OCQ.RPTR >= KJ$CTX.OCQ.SIZE
      493    10560    3                THEN
      494    10561    3                     KJ$CTX.OCQ.RPTR = 0;  /* CQ has wrapped */
      495    10562
      496    10563    3              END;                         /* End of DO WHILE */
      497    10564
      498    10565    2           IF SCANSZ > 0         /* Part of a message that cannot fit in buffer */
      499    10566    2           THEN
      500    10567    2                IF KNH$QHDR.SCQ.IPTR < KNH$QHDR.SCQ.RPTR OR KNH$QHDR.SCQ.RPTR = 0
      501    10568    2                THEN
      502    10569    2                     KJ$CTX.FLAGS.BUF_FULL = '1'B;
      503    10570    3                ELSE DO;                   /* Wrap Q */
      504    10571    3                     KNH$MESS.FUNCTION = %KN_FCN_NOP;
      505    10572    3                     KNH$MESS.MSGSZ = (KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR)* 4 - SIZEC(
             10572                              KNH$MESS);
      506    10573    3                     KNH$MESS.FPTSZ=0;
      507    10574    3                     KNH$QHDR.SCQ.IPTR = 0;
      508    10575    3                   END;
      509    10576
      510    10577    2           IF KNH$QHDR.SCQ.IPTR ~= KNH$QHDR.SCQ.RPTR
      511    10578    2                AND KJ$CTX.STATE = %KJ_STATE_RUNNING
      512    10579    2           THEN
      513    10580    3                CALL M$WRTMLT(FPT_WRTMLT) WHENALTRETURN DO;
      514    10581    3                   END;
      515    10582    2           ELSE
      516    10583    2                KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR;
      517    10584
      518    10585    2           IF KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR
      519    10586    2                AND KJ$CTX.OCQ.RPTR ~= KJ$CTX.OCQ.IPTR
      520    10587    2           THEN
      521    10588    2                CALL KJF$DATA;
      522    10589
      523    10590
      524    10591
      525    10592    2        END;                               /* End cases */
      526    10593
      527    10594        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:74   
      528    10595    2        ELSE DO;                           /* error condition */
      529    10596    3             CALL KJF$FIX(KJ$CTX.STATUS1,KJ$CTX.STATUS2) WHENALTRETURN DO;
      530    10597    3                  CALL KJF$DCWLIST;
      531    10598    3                END;
      532    10599    2           END;
      533    10600    1        CALL KHC$XEQ2(CURXEQTIM);
      534    10601    1        KJ_STATS.USRSTT.INPINTISATIM = CURXEQTIM - SVDXEQTIM + KJ_STATS.USRSTT.
             10601                 INPINTISATIM;
      535    10602    1        IF (KNH$QHDR.SCQ.RPTR = KNH$QHDR.RCQ.IPTR)
      536    10603    1        THEN
      537    10604    1             CALL X6A_INTRET;
      538    10605    1        ELSE
      539    10606    1             CALL X6A_INTRET (FPT_INTRET);
      540    10607    1   END KJF$INTHAND;
      541    10608        %EOD;

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:75   
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$INTHAND.

   Procedure KJF$INTHAND requires 696 words for executable code.
   Procedure KJF$INTHAND requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:76   

 Object Unit name= KJF$INTHAND                                File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:47:05.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Data  even  none   121     79  KJF$INTHAND
    2   Proc  even  none   696    2B8  KJF$INTHAND
    3  RoData even  none     2      2  KJF$INTHAND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  KJF$INTHAND

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    1     14  KJF_SAVE                           1     78  KJF_COUNT
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:77   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KHC$XEQ2
         yes           Std       0 KJF$DCWLIST
         yes           Std       0 KJF$DATA
 yes     yes           Std       2 KJF$FIX
 yes     yes           Std       0 KJF$GETSTATUS
         yes           Std       1 X6A_INTRET
                       nStd      0 X6A_AAUTO
                       nStd      0 X6A_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                             r    KJ_DCW_DTL66L6                   r    KJ_DCW_DTL6L66
     G$HAND_Q$                             KJ_CTX$                               KJ_LDCTX
     KJ_STATS                              KJ_INIT_MSG                      r    KJ_WRT_INIT
r    CPLR_IO                          r    CPLR_SCANSZ                      r    CPLR_BADMSG
r    G$ROS$
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:78   


      316        1        /*T***********************************************************/
      317        2        /*T*                                                         */
      318        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      319        4        /*T*                                                         */
      320        5        /*T***********************************************************/
      321        6        KJF$INTHAND: PROC ASYNC;

      6   2 000000  D380 0000 0000  xent KJF$INTHAND     LNJ,B5   X6A_AAUTO
          2 000003       0018 0000                       DC       24,0

      322        7
      323        8
      324        9        /* Entry point referneces */
      325       10    1   DCL KJF$IO ENTRY(1) ALTRET;
      326       11    1   DCL KJF$DCWLIST ENTRY;
      327       12    1   DCL KJF$DATA ENTRY;
      328       13    1   DCL KJF$GETSTATUS ENTRY ALTRET;
      329       14    1   DCL KJF$FIX ENTRY(2) ALTRET;
      330       15        %INCLUDE KJ_DATA_R;
      331    10256    1   DCL X6A_INTRET ENTRY(1);
      332    10257    1   DCL KHC$XEQ2 ENTRY(1) ALTRET;
      333    10258
      334    10259        /* Local variables */
      335    10260    1   DCL DCW$ PTR;
      336    10261    1   DCL SIZE UBIN(32);
      337    10262    1   DCL SIZE2 UBIN(32);
      338    10263    1   DCL IP$ PTR;
      339    10264    1   DCL SCANSZ UBIN(32);
      340    10265    1   DCL MSGSZ UBIN;
      341    10266    1   DCL SVDXEQTIM UBIN(32);
      342    10267    1   DCL CURXEQTIM UBIN(32);
      343    10268
      344    10269        /* Based structures */
      345    10270        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      346    10283        %KNH$MESS (STCLASS="BASED(IP$)");
      347    10332
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:79   
      348    10333        /* FPTs */
      349    10334        %FPT_INTRET;
      350    10354        %FPT_WRTMLT (DCB=M$CQ);
      351    10374    1   DCL 1 KJF_SAVE (0:9) STATIC SYMDEF,
      352    10375    1            2 STATUS1 BIT(16),
      353    10376    1            2 STATUS2 BIT(16),
      354    10377    1            2 OIPTR UBIN(32),
      355    10378    1            2 ORPTR UBIN(32),
      356    10379    1            2 IIPTR UBIN(32),
      357    10380    1            2 IRPTR UBIN(32);
      358    10381
      359    10382    1   DCL KJF_COUNT SBIN STATIC SYMDEF INIT(-1);
      360    10383
      361    10384    1        CALL KHC$XEQ2(SVDXEQTIM);

  10384   2 000005  EBC7 000F                            LAB,B6   SVDXEQTIM,AUTO
          2 000007  EFC7 0014                            STB,B6   CURXEQTIM+3,AUTO
          2 000009  BBC7 0014                            LAB,B3   CURXEQTIM+3,AUTO
          2 00000B  CBF0 0100                            LAB,B4   256,IMO
          2 00000D  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          2 000010       0001                            DC       s:10385,PREL

      362    10385    1        KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;

  10385   2 000011  8A80 0000 0017  xsym                 INC      KJ_STATS+23
          2 000014  8E80 0000 0016  xsym                 CAD      KJ_STATS+22

      363    10386
      364    10387        /* Do the appropiate thing on the condition encountered */
      365    10388    2        CALL KJF$GETSTATUS WHENALTRETURN DO;

  10388   2 000017  CBF0 0000                            LAB,B4   0,IMO
          2 000019  E380 0000 0000  xent                 LNJ,B6   KJF$GETSTATUS
          2 00001C       0003                            DC       s:10389,PREL
          2 00001D  0F81 0008                            B        s:10391,PREL

      366    10389    2             CALL M$SCREECH ( CPLR_IO ) ;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:80   

  10389   2 00001F  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          2 000022  B870 0485                            LDR,R3   1157,IMO
          2 000024  0001                                 MCL
          2 000025       0000                            DC       s:10389+6,PREL

      367    10390    2           END;

      368    10391    1        KJF_COUNT = KJF_COUNT + 1;

  10391   2 000026  8A80 0000 0078  01                   INC      KJF_COUNT

      369    10392    1        IF KJF_COUNT = 10

  10392   2 000029  E800 0000 0078  01                   LDR,R6   KJF_COUNT
          2 00002C  6D0A                                 CMV,R6   10
          2 00002D  0981 0004                            BNE      s:10395,PREL

      370    10393    1        THEN
      371    10394    1             KJF_COUNT = 0;

  10394   2 00002F  8700 0000 0078  01                   CL       KJF_COUNT

      372    10395    1        KJF_SAVE.STATUS1(KJF_COUNT) = KJ$CTX.STATUS1;

  10395   2 000032  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 000035  3F0A                                 MLV,R3   10
          2 000036  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          2 000039  E846 0005                            LDR,R6   5,B6
          2 00003B  EF30 0000 0014  01                   STR,R6   KJF_SAVE,R3

      373    10396    1        KJF_SAVE.STATUS2(KJF_COUNT) = KJ$CTX.STATUS2;

  10396   2 00003E  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 000041  3F0A                                 MLV,R3   10
          2 000042  E846 0006                            LDR,R6   6,B6
          2 000044  EF30 0000 0015  01                   STR,R6   KJF_SAVE+1,R3
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:81   

      374    10397    1        KJF_SAVE.OIPTR(KJF_COUNT)=KJ$CTX.OCQ.IPTR;

  10397   2 000047  8CC6 001F                            LDI      31,B6
          2 000049  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 00004C  3F05                                 MLV,R3   5
          2 00004D  8D30 0000 0016  01                   SDI      KJF_SAVE+2,R3

      375    10398    1        KJF_SAVE.ORPTR(KJF_COUNT)=KJ$CTX.OCQ.RPTR;

  10398   2 000050  8CC6 0022                            LDI      34,B6
          2 000052  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 000055  3F05                                 MLV,R3   5
          2 000056  8D30 0000 0018  01                   SDI      KJF_SAVE+4,R3

      376    10399    1        KJF_SAVE.IRPTR(KJF_COUNT)=KJ$CTX.ICQ.RPTR;

  10399   2 000059  8CC6 000D                            LDI      13,B6
          2 00005B  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 00005E  3F05                                 MLV,R3   5
          2 00005F  8D30 0000 001C  01                   SDI      KJF_SAVE+8,R3

      377    10400    1        KJF_SAVE.IIPTR(KJF_COUNT)=KJ$CTX.ICQ.IPTR;

  10400   2 000062  8CC6 000A                            LDI      10,B6
          2 000064  B800 0000 0078  01                   LDR,R3   KJF_COUNT
          2 000067  3F05                                 MLV,R3   5
          2 000068  8D30 0000 001A  01                   SDI      KJF_SAVE+6,R3

      378    10401
      379    10402
      380    10403        /* Check the status of the coupler */
      381    10404    1        IF KJ$CTX.STATUS1 = %KJ_STATUS_DR

  10404   2 00006B  E846 0005                            LDR,R6   5,B6
          2 00006D  E970 8000                            CMR,R6   -32768,IMO
          2 00006F  0981 01FE                            BNE      s:10596,PREL
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:82   

      382    10405    1        THEN
      383    10406    2        DO CASE (KJ$CTX.CURRENT_FUNCTION); /* Finish last function */

  10406   2 000071  B846 0001                            LDR,R3   1,B6
          2 000073  3D06                                 CMV,R3   6
          2 000074  0281 0211                            BGE      s:10600,PREL
          2 000076  A830 0000 007C  02                   LDR,R2   s:10406+11,R3
          2 000079  83A0 0000 0082  02                   JMP      s:10416,R2
          2 00007C       01EA                            DC       s:10592,PREL
          2 00007D       01EA                            DC       s:10592,PREL
          2 00007E       0000                            DC       s:10416,PREL
          2 00007F       0068                            DC       s:10482,PREL
          2 000080       01EA                            DC       s:10592,PREL
          2 000081       0072                            DC       s:10488,PREL

      384    10407
      385    10408        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:83   
      386    10409    2        CASE (%KJ_CF_NONE);                /* No function in progress */

      387    10410
      388    10411        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:84   
      389    10412    2        CASE (%KJ_CF_INIT);                /* Init coupler */

      390    10413        /* Read in OCQ size */
      391    10414        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:85   
      392    10415    2        CASE (%KJ_CF_ROCQSIZE);            /* No function in progress */

      393    10416    2           KJ$CTX.ICQ.OFFSET = ((KJ$CTX.OCQ.SIZE + 1023) /1024) * 1024;

  10416   2 000082  8CC6 0025                            LDI      37,B6
          2 000084  8470 0000 03FF                       AID      1023,IMO
          2 000087  70CA                                 DOR,R7   10
          2 000088  708A                                 DOL,R7   10
          2 000089  8D46 0017                            SDI      23,B6

      394    10417    2           KJ$CTX.PTR_DCW.L66A(3) = %KJ_OFFSET_RPTR + KJ$CTX.ICQ.OFFSET;

  10417   2 00008B  8470 0000 0009                       AID      9,IMO
          2 00008E  8D46 00C4                            SDI      196,B6

      395    10418    2           KJ$CTX.PTR_DCW.L66A(4) = %KJ_OFFSET_IPTR + KJ$CTX.ICQ.OFFSET;

  10418   2 000090  8CC6 0017                            LDI      23,B6
          2 000092  8470 0000 000A                       AID      10,IMO
          2 000095  8D46 00CA                            SDI      202,B6

      396    10419    2           KJ$CTX.PTR_DCW.L66A(7) = %KJ_OFFSET_LSTIPTR + KJ$CTX.ICQ.OFFSET;

  10419   2 000097  8CC6 0017                            LDI      23,B6
          2 000099  8470 0000 000D                       AID      13,IMO
          2 00009C  8D46 00DC                            SDI      220,B6

      397    10420
      398    10421        /* Read in ICQ size */
      399    10422    2           DCW$ = ADDR(KJ$CTX.DCWS);

  10422   2 00009E  DBC6 0038                            LAB,B5   56,B6
          2 0000A0  DFC7 0004                            STB,B5   DCW$,AUTO

      400    10423
      401    10424                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      402    10425                L66A="%KJ_OFFSET_SIZE + KJ$CTX.ICQ.OFFSET",
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:86   
      403    10426                L6A="POFFW(ADDR(KJ$CTX.ICQ.SIZE),G$HAND_Q$)",
      404    10427                MODE=%KJ_MODE_BIN,
      405    10428                TALLY=1);

  10432   2 0000A2  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          2 0000A5  2C00                                 LDV,R2   0
          2 0000A6  6C0C                                 LDV,R6   12
          2 0000A7  BB85                                 LAB,B3   ,B5
          2 0000A8  3C00                                 LDV,R3   0
          2 0000A9  0008                                 MMM

  10438   2 0000AA  6C03                                 LDV,R6   3
          2 0000AB  ECC7 0004                            LDB,B6   DCW$,AUTO
          2 0000AD  EA86                                 SRM,R6,'00FF'X    ,B6
          2 0000AE       00FF

  10441   2 0000AF  5C01                                 LDV,R5   1
          2 0000B0  DF46 0001                            STR,R5   1,B6

  10444   2 0000B2  CC80 0000 0000  xsym                 LDB,B4   KJ_CTX$
          2 0000B5  8CC4 0017                            LDI      23,B4
          2 0000B7  8470 0000 0005                       AID      5,IMO
          2 0000BA  8D46 0002                            SDI      2,B6

  10447   2 0000BC  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          2 0000BF  8480 0000 0000  xsym                 SID      G$HAND_Q$
          2 0000C2  8470 0000 0010                       AID      16,IMO
          2 0000C5  8D46 0004                            SDI      4,B6

  10449   2 0000C7  ABC6 0006                            LAB,B2   6,B6
          2 0000C9  AFC7 0004                            STB,B2   DCW$,AUTO

      406    10451
      407    10452                %KJ$BLDDCW (OPERATION=DISCONNECTINT);

  10458   2 0000CB  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          2 0000CE  2C00                                 LDV,R2   0
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:87   
          2 0000CF  6C0C                                 LDV,R6   12
          2 0000D0  BCC7 0004                            LDB,B3   DCW$,AUTO
          2 0000D2  3C00                                 LDV,R3   0
          2 0000D3  0008                                 MMM

  10459   2 0000D4  6C38                                 LDV,R6   56
          2 0000D5  ECC7 0004                            LDB,B6   DCW$,AUTO
          2 0000D7  E786                                 STH,R6   ,B6

  10473   2 0000D8  CBC6 0006                            LAB,B4   6,B6
          2 0000DA  CFC7 0004                            STB,B4   DCW$,AUTO

      408    10475
      409    10476    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_RICQSIZE;

  10476   2 0000DC  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          2 0000DF  4C03                                 LDV,R4   3
          2 0000E0  CF46 0001                            STR,R4   1,B6

      410    10477        /* Do the IO and the interupt will trigger us to go further */
      411    10478    2           CALL KJF$DCWLIST;

  10478   2 0000E2  CBF0 0000                            LAB,B4   0,IMO
          2 0000E4  E380 0000 0000  xent                 LNJ,B6   KJF$DCWLIST
          2 0000E7       0001                            DC       s:10478+6,PREL
          2 0000E8  0F81 019D                            B        s:10600,PREL

      412    10479
      413    10480        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:88   
      414    10481    2        CASE (%KJ_CF_RICQSIZE);

      415    10482    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;

  10482   2 0000EA  8746 0001                            CL       1,B6

      416    10483    2           CALL KJF$DATA;

  10483   2 0000EC  CBF0 0000                            LAB,B4   0,IMO
          2 0000EE  E380 0000 0000  xent                 LNJ,B6   KJF$DATA
          2 0000F1       0001                            DC       s:10483+6,PREL
          2 0000F2  0F81 0193                            B        s:10600,PREL

      417    10484
      418    10485        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:89   
      419    10486    2        CASE (%KJ_CF_DATA);                /* Data transfered */

      420    10487
      421    10488    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;

  10488   2 0000F4  8746 0001                            CL       1,B6

      422    10489
      423    10490    2           KNH$QHDR.RCQ.RPTR = KJ$CTX.ICQ.NEW_RPTR;

  10490   2 0000F6  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 0000F9  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          2 0000FC  E845 001E                            LDR,R6   30,B5
          2 0000FE  EF46 0001                            STR,R6   1,B6

      424    10491
      425    10492    2           IP$ = PINCRW(KJ$CTX.OCQ.BUF$,KNH$QHDR.SCQ.IPTR*2);

  10492   2 000100  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 000103  B846 0004                            LDR,R3   4,B6
          2 000105  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          2 000108  CCC5 002D                            LDB,B4   45,B5
          2 00010A  CFC7 0014                            STB,B4   CURXEQTIM+3,AUTO
          2 00010C  F853                                 LDR,R7   R3
          2 00010D  6C00                                 LDV,R6   0
          2 00010E  7081                                 DOL,R7   1
          2 00010F  8447 0014                            AID      CURXEQTIM+3,AUTO
          2 000111  8D47 000A                            SDI      IP$,AUTO

      426    10493    2           SCANSZ = KJ$CTX.OCQ.RDSIZE;

  10493   2 000113  8CC5 002B                            LDI      43,B5
          2 000115  8D47 000C                            SDI      SCANSZ,AUTO

      427    10494
      428    10495    2           IF SCANSZ > KNH$QHDR.SCQ.SZ

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:90   
  10495   2 000117  F846 0006                            LDR,R7   6,B6
          2 000119  6C00                                 LDV,R6   0
          2 00011A  84C7 000C                            SID      SCANSZ,AUTO
          2 00011C  0601 0008                            BCT      s:10502,PREL

      429    10496    2           THEN
      430    10497    2                CALL M$SCREECH ( CPLR_SCANSZ ) ;

  10497   2 00011E  BB80 0000 0000  xsym                 LAB,B3   CPLR_SCANSZ
          2 000121  B870 0485                            LDR,R3   1157,IMO
          2 000123  0001                                 MCL
          2 000124       0000                            DC       s:10497+6,PREL

      431    10498        /*S* SCREECH_CODE: KJF-S$CPLR_SCANSZ
      432    10499             MESSAGE: The message scanning logic in COUPLER failed.
      433    10500        */
      434    10501
      435    10502    3           DO WHILE (SCANSZ >= SIZEW(KNH$MESS)/2);

  10502   2 000125  0F81 00D3                            B        s:10563,PREL

      436    10503
      437    10504    3                MSGSZ = (SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ+1)/2 + (KNH$MESS.MSGSZ+1)/2
             10504                         +1)/2;

  10504   2 000127  ECC7 000A                            LDB,B6   IP$,AUTO
          2 000129  E846 0006                            LDR,R6   6,B6
          2 00012B  6E01                                 ADV,R6   1
          2 00012C  6041                                 SOR,R6   1
          2 00012D  D846 0007                            LDR,R5   7,B6
          2 00012F  5E01                                 ADV,R5   1
          2 000130  5041                                 SOR,R5   1
          2 000131  EA55                                 ADD,R6   R5
          2 000132  6E09                                 ADV,R6   9
          2 000133  6041                                 SOR,R6   1
          2 000134  EF47 000E                            STR,R6   MSGSZ,AUTO

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:91   
      438    10505    3                IF MSGSZ > SCANSZ          /* Not a complete message */

  10505   2 000136  F856                                 LDR,R7   R6
          2 000137  6C00                                 LDV,R6   0
          2 000138  84C7 000C                            SID      SCANSZ,AUTO
          2 00013A  6981 0003                            BNEZ,R6  s:10505+8,PREL
          2 00013C  7901 0003                            BEZ,R7   s:10509,PREL
          2 00013E  0601 00C1                            BCT      s:10565,PREL

      439    10506    3                THEN
      440    10507    3                     EXIT;
      441    10508
      442    10509    3                KJ_STATS.OCQ_MSGS = KJ_STATS.OCQ_MSGS + 1;

  10509   2 000140  8A80 0000 0025  xsym                 INC      KJ_STATS+37
          2 000143  8E80 0000 0024  xsym                 CAD      KJ_STATS+36

      443    10510    3                KJ_STATS.OCQ_MBC = KJ_STATS.OCQ_MBC + KNH$MESS.MSGSZ;

  10510   2 000146  F846 0007                            LDR,R7   7,B6
          2 000148  6C00                                 LDV,R6   0
          2 000149  8400 0000 0028  xsym                 AID      KJ_STATS+40
          2 00014C  8D00 0000 0028  xsym                 SDI      KJ_STATS+40

      444    10511    3                KNH$MESS.RECTYPE = 0;

  10511   2 00014F  8746 0004                            CL       4,B6

      445    10512    3                KNH$MESS.LAST_PTR = KNH$QHDR.LAST_SCQPTR;

  10512   2 000151  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          2 000154  E845 0017                            LDR,R6   23,B5
          2 000156  EF46 0005                            STR,R6   5,B6

      446    10513    3                KNH$QHDR.LAST_SCQPTR = KNH$QHDR.SCQ.IPTR;

  10513   2 000158  D845 0004                            LDR,R5   4,B5
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:92   
          2 00015A  DF45 0017                            STR,R5   23,B5

      447    10514    4                DO CASE(KNH$MESS.FUNCTION);

  10514   2 00015C  B806                                 LDR,R3   ,B6
          2 00015D  3EE0                                 ADV,R3   -32
          2 00015E  3D04                                 CMV,R3   4
          2 00015F  0281 005A                            BGE      s:10541,PREL
          2 000161  A830 0000 0167  02                   LDR,R2   s:10514+11,R3
          2 000164  83A0 0000 016B  02                   JMP      s:10518,R2
          2 000167       0038                            DC       s:10532,PREL
          2 000168       0042                            DC       s:10536,PREL
          2 000169       0000                            DC       s:10518,PREL
          2 00016A       002E                            DC       s:10528,PREL

      448    10515
      449    10516
      450    10517    4                CASE (%KJ_FCN_RUOK);

      451    10518    4                   KJ_STATS.DATAFNC.RUOK = KJ_STATS.DATAFNC.RUOK + 1;

  10518   2 00016B  8A80 0000 002F  xsym                 INC      KJ_STATS+47
          2 00016E  8E80 0000 002E  xsym                 CAD      KJ_STATS+46

      452    10519    4                   KJ_INIT_MSG.FPT.RLCID.NODE = KJ$CTX.HOST_NODE;

  10519   2 000171  CC80 0000 0000  xsym                 LDB,B4   KJ_CTX$
          2 000174  E2C4 0007                            LLH,R6   7,B4
          2 000176  E780 0000 0015  xsym                 STH,R6   KJ_INIT_MSG+21

      453    10520    4                   KJ_INIT_MSG.FPT.RLCID.FEP_NODE = KJ$CTX.FEP_NODE;

  10520   2 000179  E844 0007                            LDR,R6   7,B4
          2 00017B  EA80 0000 0015  xsym                 SRM,R6,'00FF'X    KJ_INIT_MSG+21
          2 00017E       00FF

      454    10521    4                   KJ_INIT_MSG.FPT.RLCID.FLAGS.HOST_NODE = '1'B;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:93   

  10521   2 00017F  8900 0000 0016  xsym                 LBT,'8000'X       KJ_INIT_MSG+22
  10521   2 000182       8000

      455    10522    4                   KJ_INIT_MSG.FPT.SERVICE = KJ$CTX.QOS;

  10522   2 000183  E2C4 0008                            LLH,R6   8,B4
          2 000185  EA80 0000 0018  xsym                 SRM,R6,'00FF'X    KJ_INIT_MSG+24
          2 000188       00FF

      456    10523    4                   KJ_INIT_MSG.LDCTX = 0;  /* zap the ldct */

  10523   2 000189  8700 0000 0001  xsym                 CL       KJ_INIT_MSG+1

      457    10524    4                   CALL M$WRITE (KJ_WRT_INIT);

  10524   2 00018C  BB80 0000 0000  xsym                 LAB,B3   KJ_WRT_INIT
          2 00018F  B870 1543                            LDR,R3   5443,IMO
          2 000191  0001                                 MCL
          2 000192       0000                            DC       s:10524+6,PREL

      458    10525    4                   KNH$MESS.FUNCTION = %KN_FCN_NOP;

  10525   2 000193  ECC7 000A                            LDB,B6   IP$,AUTO
          2 000195  6C06                                 LDV,R6   6
          2 000196  EF06                                 STR,R6   ,B6
          2 000197  0F81 0029                            B        s:10550,PREL

      459    10526
      460    10527    4                CASE (%KJ_FCN_ODATA);

      461    10528    4                   KJ_STATS.DATAFNC.ODATA = KJ_STATS.DATAFNC.ODATA + 1;

  10528   2 000199  8A80 0000 0031  xsym                 INC      KJ_STATS+49
          2 00019C  8E80 0000 0030  xsym                 CAD      KJ_STATS+48

      462    10529    4                   KNH$MESS.FUNCTION = %KN_FCN_DATA;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:94   

  10529   2 00019F  6C05                                 LDV,R6   5
          2 0001A0  EF06                                 STR,R6   ,B6
          2 0001A1  0F81 001F                            B        s:10550,PREL

      463    10530
      464    10531    4                CASE (%KJ_FCN_NOP);

      465    10532    4                   KJ_STATS.DATAFNC.NOP = KJ_STATS.DATAFNC.NOP + 1;

  10532   2 0001A3  8A80 0000 0033  xsym                 INC      KJ_STATS+51
          2 0001A6  8E80 0000 0032  xsym                 CAD      KJ_STATS+50

      466    10533    4                   KNH$MESS.FUNCTION = %KN_FCN_NOP;

  10533   2 0001A9  6C06                                 LDV,R6   6
          2 0001AA  EF06                                 STR,R6   ,B6
          2 0001AB  0F81 0015                            B        s:10550,PREL

      467    10534
      468    10535    4                CASE (%KJ_FCN_TIM);

      469    10536    4                   KNH$MESS.FUNCTION = %KN_FCN_DATA;

  10536   2 0001AD  6C05                                 LDV,R6   5
          2 0001AE  EF06                                 STR,R6   ,B6

      470    10537    4                   KJ_STATS.DATAFNC.TIM = KJ_STATS.DATAFNC.TIM + 1;

  10537   2 0001AF  8A80 0000 0035  xsym                 INC      KJ_STATS+53
          2 0001B2  8E80 0000 0034  xsym                 CAD      KJ_STATS+52

      471    10538    4                   KNH$MESS.RECTYPE = %KJ_FCN_TIM;

  10538   2 0001B5  5C21                                 LDV,R5   33
          2 0001B6  DF46 0004                            STR,R5   4,B6
          2 0001B8  0F81 0008                            B        s:10550,PREL
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:95   

      472    10539
      473    10540    4                CASE (ELSE);

      474    10541    4                   CALL M$SCREECH ( CPLR_BADMSG ) ;

  10541   2 0001BA  BB80 0000 0000  xsym                 LAB,B3   CPLR_BADMSG
          2 0001BD  B870 0485                            LDR,R3   1157,IMO
          2 0001BF  0001                                 MCL
          2 0001C0       0000                            DC       s:10541+6,PREL

      475    10542        /*S* SCREECH_CODE: KJF-S$CPLR_BADMSG
      476    10543             MESSAGE: An illegal message was sent to the FEP.
      477    10544        */
      478    10545
      479    10546
      480    10547
      481    10548    4                END;                       /* End cases */

      482    10549
      483    10550    3                KNH$MESS.FPTSZ = 0;

  10550   2 0001C1  ECC7 000A                            LDB,B6   IP$,AUTO
          2 0001C3  8746 0006                            CL       6,B6

      484    10551    3                KNH$MESS.LDCTX = KJ_LDCTX;

  10551   2 0001C5  E800 0000 0000  xsym                 LDR,R6   KJ_LDCTX
          2 0001C8  EF46 0001                            STR,R6   1,B6

      485    10552    3                KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.IPTR + MSGSZ;

  10552   2 0001CA  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          2 0001CD  D845 0004                            LDR,R5   4,B5
          2 0001CF  DA47 000E                            ADD,R5   MSGSZ,AUTO
          2 0001D1  DF45 0004                            STR,R5   4,B5

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:96   
      486    10553
      487    10554    3                SCANSZ = SCANSZ - MSGSZ;

  10554   2 0001D3  F847 000E                            LDR,R7   MSGSZ,AUTO
          2 0001D5  6C00                                 LDV,R6   0
          2 0001D6  84C7 000C                            SID      SCANSZ,AUTO
          2 0001D8  8656                                 CPL      R6
          2 0001D9  8657                                 CPL      R7
          2 0001DA  8470 0000 0001                       AID      1,IMO
          2 0001DD  8D47 000C                            SDI      SCANSZ,AUTO

      488    10555    3                IP$ = PINCRW(IP$,MSGSZ*2);

  10555   2 0001DF  F847 000E                            LDR,R7   MSGSZ,AUTO
          2 0001E1  6C00                                 LDV,R6   0
          2 0001E2  7081                                 DOL,R7   1
          2 0001E3  8447 000A                            AID      IP$,AUTO
          2 0001E5  8D47 000A                            SDI      IP$,AUTO

      489    10556
      490    10557             /* Increment host removal pointer */
      491    10558    3                KJ$CTX.OCQ.RPTR = KJ$CTX.OCQ.RPTR + MSGSZ;

  10558   2 0001E7  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          2 0001EA  F847 000E                            LDR,R7   MSGSZ,AUTO
          2 0001EC  6C00                                 LDV,R6   0
          2 0001ED  8446 0022                            AID      34,B6
          2 0001EF  8D46 0022                            SDI      34,B6

      492    10559    3                IF KJ$CTX.OCQ.RPTR >= KJ$CTX.OCQ.SIZE

  10559   2 0001F1  84C6 0025                            SID      37,B6
          2 0001F3  0681 0005                            BCF      s:10563,PREL

      493    10560    3                THEN
      494    10561    3                     KJ$CTX.OCQ.RPTR = 0;  /* CQ has wrapped */

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:97   
  10561   2 0001F5  8746 0022                            CL       34,B6
          2 0001F7  8746 0023                            CL       35,B6

      495    10562
      496    10563    3              END;                         /* End of DO WHILE */

  10563   2 0001F9  8CC7 000C                            LDI      SCANSZ,AUTO
          2 0001FB  84F0 0000 0004                       SID      4,IMO
          2 0001FE  0601 FF28                            BCT      s:10504,PREL

      497    10564
      498    10565    2           IF SCANSZ > 0         /* Part of a message that cannot fit in buffer */

  10565   2 000200  8CC7 000C                            LDI      SCANSZ,AUTO
          2 000202  84F0 0000 0000                       SID      0,IMO
          2 000205  0681 002D                            BCF      s:10577,PREL
          2 000207  6981 0003                            BNEZ,R6  s:10567,PREL
          2 000209  7901 0029                            BEZ,R7   s:10577,PREL

      499    10566    2           THEN
      500    10567    2                IF KNH$QHDR.SCQ.IPTR < KNH$QHDR.SCQ.RPTR OR KNH$QHDR.SCQ.RPTR = 0

  10567   2 00020B  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 00020E  E846 0004                            LDR,R6   4,B6
          2 000210  E946 0005                            CMR,R6   5,B6
          2 000212  0201 0005                            BL       s:10569,PREL
          2 000214  D846 0005                            LDR,R5   5,B6
          2 000216  5981 0009                            BNEZ,R5  s:10571,PREL

      501    10568    2                THEN
      502    10569    2                     KJ$CTX.FLAGS.BUF_FULL = '1'B;

  10569   2 000218  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          2 00021B  8945 0009                            LBT,'8000'X       9,B5
          2 00021D       8000
          2 00021E  0F81 0014                            B        s:10577,PREL

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:98   
      503    10570    3                ELSE DO;                   /* Wrap Q */

      504    10571    3                     KNH$MESS.FUNCTION = %KN_FCN_NOP;

  10571   2 000220  DCC7 000A                            LDB,B5   IP$,AUTO
          2 000222  4C06                                 LDV,R4   6
          2 000223  CF05                                 STR,R4   ,B5

      505    10572    3                    KNH$MESS.MSGSZ = (KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR)* 4 - SIZEC(
             10572                              KNH$MESS);

  10572   2 000224  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 000227  E846 0006                            LDR,R6   6,B6
          2 000229  E246 0004                            SUB,R6   4,B6
          2 00022B  6002                                 SOL,R6   2
          2 00022C  6EF0                                 ADV,R6   -16
          2 00022D  EF45 0007                            STR,R6   7,B5

      506    10573    3                     KNH$MESS.FPTSZ=0;

  10573   2 00022F  8745 0006                            CL       6,B5

      507    10574    3                     KNH$QHDR.SCQ.IPTR = 0;

  10574   2 000231  8746 0004                            CL       4,B6

      508    10575    3                   END;

      509    10576
      510    10577    2           IF KNH$QHDR.SCQ.IPTR ~= KNH$QHDR.SCQ.RPTR

  10577   2 000233  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 000236  E846 0004                            LDR,R6   4,B6
          2 000238  E946 0005                            CMR,R6   5,B6
          2 00023A  0901 0013                            BE       s:10583,PREL
          2 00023C  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          2 00023F  D805                                 LDR,R5   ,B5
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:99   
          2 000240  5D03                                 CMV,R5   3
          2 000241  0981 000C                            BNE      s:10583,PREL

      511    10578    2                AND KJ$CTX.STATE = %KJ_STATE_RUNNING
      512    10579    2           THEN
      513    10580    3                CALL M$WRTMLT(FPT_WRTMLT) WHENALTRETURN DO;

  10580   2 000243  BB80 0000 0007  01                   LAB,B3   FPT_WRTMLT
          2 000246  B870 1144                            LDR,R3   4420,IMO
          2 000248  0001                                 MCL
          2 000249       0003                            DC       s:10581,PREL
          2 00024A  0F81 0001                            B        s:10581,PREL

      514    10581    3                   END;

  10581   2 00024C  0F81 0005                            B        s:10585,PREL

      515    10582    2           ELSE
      516    10583    2                KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR;

  10583   2 00024E  E846 0005                            LDR,R6   5,B6
          2 000250  EF46 0004                            STR,R6   4,B6

      517    10584
      518    10585    2           IF KNH$QHDR.SCQ.IPTR = KNH$QHDR.SCQ.RPTR

  10585   2 000252  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 000255  E846 0004                            LDR,R6   4,B6
          2 000257  E946 0005                            CMR,R6   5,B6
          2 000259  0981 002C                            BNE      s:10600,PREL
          2 00025B  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          2 00025E  8CC5 0022                            LDI      34,B5
          2 000260  84C5 001F                            SID      31,B5
          2 000262  6981 0003                            BNEZ,R6  s:10588,PREL
          2 000264  7901 0021                            BEZ,R7   s:10600,PREL

      519    10586    2                AND KJ$CTX.OCQ.RPTR ~= KJ$CTX.OCQ.IPTR
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:100  
      520    10587    2           THEN
      521    10588    2                CALL KJF$DATA;

  10588   2 000266  CBF0 0000                            LAB,B4   0,IMO
          2 000268  E380 0000 0000  xent                 LNJ,B6   KJF$DATA
          2 00026B       0001                            DC       s:10592,PREL

      522    10589
      523    10590
      524    10591
      525    10592    2        END;                               /* End cases */

  10592   2 00026C  0F81 0019                            B        s:10600,PREL

      526    10593
      527    10594        %EJECT;
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:101  
      528    10595    2        ELSE DO;                           /* error condition */

      529    10596    3             CALL KJF$FIX(KJ$CTX.STATUS1,KJ$CTX.STATUS2) WHENALTRETURN DO;

  10596   2 00026E  DBC6 0006                            LAB,B5   6,B6
          2 000270  DFC7 0016                            STB,B5   CURXEQTIM+5,AUTO
          2 000272  CBC6 0005                            LAB,B4   5,B6
          2 000274  CFC7 0014                            STB,B4   CURXEQTIM+3,AUTO
          2 000276  BBC7 0014                            LAB,B3   CURXEQTIM+3,AUTO
          2 000278  CBF0 0200                            LAB,B4   512,IMO
          2 00027A  E380 0000 0000  xent                 LNJ,B6   KJF$FIX
          2 00027D       0003                            DC       s:10597,PREL
          2 00027E  0F81 0007                            B        s:10600,PREL

      530    10597    3                  CALL KJF$DCWLIST;

  10597   2 000280  CBF0 0000                            LAB,B4   0,IMO
          2 000282  E380 0000 0000  xent                 LNJ,B6   KJF$DCWLIST
          2 000285       0001                            DC       s:10600,PREL

      531    10598    3                END;

      532    10599    2           END;

      533    10600    1        CALL KHC$XEQ2(CURXEQTIM);

  10600   2 000286  EBC7 0011                            LAB,B6   CURXEQTIM,AUTO
          2 000288  EFC7 0014                            STB,B6   CURXEQTIM+3,AUTO
          2 00028A  BBC7 0014                            LAB,B3   CURXEQTIM+3,AUTO
          2 00028C  CBF0 0100                            LAB,B4   256,IMO
          2 00028E  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          2 000291       0001                            DC       s:10601,PREL

      534    10601    1        KJ_STATS.USRSTT.INPINTISATIM = CURXEQTIM - SVDXEQTIM + KJ_STATS.USRSTT.
             10601                 INPINTISATIM;

  10601   2 000292  8CC7 0011                            LDI      CURXEQTIM,AUTO
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:102  
          2 000294  84C7 000F                            SID      SVDXEQTIM,AUTO
          2 000296  8400 0000 0018  xsym                 AID      KJ_STATS+24
          2 000299  8D00 0000 0018  xsym                 SDI      KJ_STATS+24

      535    10602    1        IF (KNH$QHDR.SCQ.RPTR = KNH$QHDR.RCQ.IPTR)

  10602   2 00029C  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          2 00029F  D846 0005                            LDR,R5   5,B6
          2 0002A1  D906                                 CMR,R5   ,B6
          2 0002A2  0981 0009                            BNE      s:10606,PREL

      536    10603    1        THEN
      537    10604    1             CALL X6A_INTRET;

  10604   2 0002A4  CBF0 0000                            LAB,B4   0,IMO
          2 0002A6  E380 0000 0000  xent                 LNJ,B6   X6A_INTRET
          2 0002A9       0001                            DC       s:10604+6,PREL
          2 0002AA  0F81 000A                            B        s:10607,PREL

      538    10605    1        ELSE
      539    10606    1             CALL X6A_INTRET (FPT_INTRET);

  10606   2 0002AC  BB80 0000 0000  03                   LAB,B3   0
          2 0002AF  CBF0 0100                            LAB,B4   256,IMO
          2 0002B1  E380 0000 0000  xent                 LNJ,B6   X6A_INTRET
          2 0002B4       0001                            DC       s:10607,PREL

      540    10607    1   END KJF$INTHAND;

  10607   2 0002B5  C380 0000 0000  xent                 LNJ,B4   X6A_AARET
      541    10608        %EOD;

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:103  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$INTHAND.
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:104  

 **** Variables and constants ****

  ****  Section 001  Data  KJF$INTHAND

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(112)   r     1 FPT_INTRET                 7-0-0/w STRC(207)   r     1 FPT_WRTMLT
    78-0-0/w SBIN(16)    r     1 KJF_COUNT
    14-0-0/w STRC(160)   r     1 KJF_SAVE(0:9)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w UBIN(32)    r     1 CURXEQTIM                  4-0-0/w PTR         r     1 DCW$
     A-0-0/w PTR         r     1 IP$                        E-0-0/w UBIN(16)    r     1 MSGSZ
     C-0-0/w UBIN(32)    r     1 SCANSZ                     F-0-0/w UBIN(32)    r     1 SVDXEQTIM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 CPLR_BADMSG                0-0-0/w STRC(48)    r     1 CPLR_IO
     0-0-0/w STRC(48)    r     1 CPLR_SCANSZ                0-0-0/w PTR         r     1 G$HAND_Q$
     0-0-0/w PTR         r     1 KJ_CTX$                    0-0-0/w STRC(96)    r     1 KJ_DCW_DTL66L6
     0-0-0/w STRC(96)    r     1 KJ_DCW_DTL6L66             0-0-0/w STRC(432)   r     1 KJ_INIT_MSG
     0-0-0/w UBIN(16)    r     1 KJ_LDCTX                   0-0-0/w STRC(864)   r     1 KJ_STATS
     0-0-0/w STRC(288)   r     1 KJ_WRT_INIT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:105  
     0-0-0/w STRC(3680)  r     1 KJ$CTX                     0-0-0/w STRC(96)    r     1 KJ$DCW
     0-0-0/c STRC(128)   r     1 KNH$MESS                   0-0-0/w STRC(384)   r     1 KNH$QHDR
     0-0-0N  NULL        r     1 M$CQ


   Procedure KJF$INTHAND requires 696 words for executable code.
   Procedure KJF$INTHAND requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:106  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:107  
          MINI XREF LISTING

CPLR_BADMSG
      9917**DCL     10541<>CALL
CPLR_IO
      9795**DCL     10389<>CALL
CPLR_SCANSZ
      9856**DCL     10497<>CALL
CURXEQTIM
     10267**DCL     10600<>CALL    10601>>ASSIGN
DCW$
     10260**DCL     10422<<ASSIGN  10432>>ASSIGN  10438>>ASSIGN  10441>>ASSIGN  10444>>ASSIGN  10447>>ASSIGN
     10449<<ASSIGN  10449>>ASSIGN  10458>>ASSIGN  10459>>ASSIGN  10473<<ASSIGN  10473>>ASSIGN
FPT_INTRET
     10347**DCL     10606<>CALL
FPT_INTRET.V
     10351**DCL     10349--DCLINIT
FPT_WRTMLT
     10367**DCL     10580<>CALL
FPT_WRTMLT.V
     10372**DCL     10369--DCLINIT
G$HAND_Q$
      9033**DCL     10271--IMP-PTR 10447>>ASSIGN  10490>>ASSIGN  10492>>ASSIGN  10495>>IF      10512>>ASSIGN
     10513>>ASSIGN  10513>>ASSIGN  10552>>ASSIGN  10552>>ASSIGN  10567>>IF      10567>>IF      10567>>IF
     10572>>ASSIGN  10572>>ASSIGN  10574>>ASSIGN  10577>>IF      10577>>IF      10583>>ASSIGN  10583>>ASSIGN
     10585>>IF      10585>>IF      10602>>IF      10602>>IF
IP$
     10263**DCL     10296--IMP-PTR 10492<<ASSIGN  10504>>ASSIGN  10504>>ASSIGN  10510>>ASSIGN  10511>>ASSIGN
     10512>>ASSIGN  10514>>DOCASE  10525>>ASSIGN  10529>>ASSIGN  10533>>ASSIGN  10536>>ASSIGN  10538>>ASSIGN
     10550>>ASSIGN  10551>>ASSIGN  10555<<ASSIGN  10555>>ASSIGN  10571>>ASSIGN  10572>>ASSIGN  10573>>ASSIGN
KHC$XEQ2
     10257**DCL-ENT 10384--CALL    10600--CALL
KJ$CTX.CURRENT_FUNCTION
      9038**DCL     10406>>DOCASE  10476<<ASSIGN  10482<<ASSIGN  10488<<ASSIGN
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:108  
KJ$CTX.DCWS
      9069**DCL     10422--ASSIGN
KJ$CTX.FEP_NODE
      9044**DCL     10520>>ASSIGN
KJ$CTX.FLAGS.BUF_FULL
      9045**DCL     10569<<ASSIGN
KJ$CTX.HOST_NODE
      9044**DCL     10519>>ASSIGN
KJ$CTX.ICQ.IPTR
      9045**DCL     10400>>ASSIGN
KJ$CTX.ICQ.NEW_RPTR
      9046**DCL     10490>>ASSIGN
KJ$CTX.ICQ.OFFSET
      9046**DCL     10416<<ASSIGN  10417>>ASSIGN  10418>>ASSIGN  10419>>ASSIGN  10444>>ASSIGN
KJ$CTX.ICQ.RPTR
      9045**DCL     10399>>ASSIGN
KJ$CTX.ICQ.SIZE
      9046**DCL     10447--ASSIGN
KJ$CTX.OCQ.BUF$
      9048**DCL     10492>>ASSIGN
KJ$CTX.OCQ.IPTR
      9047**DCL     10397>>ASSIGN  10585>>IF
KJ$CTX.OCQ.RDSIZE
      9048**DCL     10493>>ASSIGN
KJ$CTX.OCQ.RPTR
      9047**DCL     10398>>ASSIGN  10558<<ASSIGN  10558>>ASSIGN  10559>>IF      10561<<ASSIGN  10585>>IF
KJ$CTX.OCQ.SIZE
      9047**DCL     10416>>ASSIGN  10559>>IF
KJ$CTX.PTR_DCW.L66A
      9127**DCL     10417<<ASSIGN  10418<<ASSIGN  10419<<ASSIGN
KJ$CTX.QOS
      9044**DCL     10522>>ASSIGN
KJ$CTX.STATE
      9033**DCL     10577>>IF
KJ$CTX.STATUS1
      9044**DCL     10395>>ASSIGN  10404>>IF      10596<>CALL
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:109  
KJ$CTX.STATUS2
      9044**DCL     10396>>ASSIGN  10596<>CALL
KJ$DCW
      8908**DCL     10432<<ASSIGN  10449--ASSIGN  10458<<ASSIGN  10473--ASSIGN
KJ$DCW.L66A
      8931**DCL     10444<<ASSIGN
KJ$DCW.L6A
      8932**DCL     10447<<ASSIGN
KJ$DCW.MODE
      8924**DCL     10438<<ASSIGN
KJ$DCW.OPERATION
      8919**DCL     10459<<ASSIGN
KJ$DCW.TALLY
      8929**DCL     10441<<ASSIGN
KJF$DATA
        12**DCL-ENT 10483--CALL    10588--CALL
KJF$DCWLIST
        11**DCL-ENT 10478--CALL    10597--CALL
KJF$FIX
        14**DCL-ENT 10596--CALL
KJF$GETSTATUS
        13**DCL-ENT 10388--CALL
KJF_COUNT
     10382**DCL     10391<<ASSIGN  10391>>ASSIGN  10392>>IF      10394<<ASSIGN  10395>>ASSIGN  10396>>ASSIGN
     10397>>ASSIGN  10398>>ASSIGN  10399>>ASSIGN  10400>>ASSIGN
KJF_SAVE.IIPTR
     10379**DCL     10400<<ASSIGN
KJF_SAVE.IRPTR
     10380**DCL     10399<<ASSIGN
KJF_SAVE.OIPTR
     10377**DCL     10397<<ASSIGN
KJF_SAVE.ORPTR
     10378**DCL     10398<<ASSIGN
KJF_SAVE.STATUS1
     10375**DCL     10395<<ASSIGN
KJF_SAVE.STATUS2
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:110  
     10376**DCL     10396<<ASSIGN
KJ_CTX$
      9033**DCL      9033--IMP-PTR 10395>>ASSIGN  10396>>ASSIGN  10397>>ASSIGN  10398>>ASSIGN  10399>>ASSIGN
     10400>>ASSIGN  10404>>IF      10406>>DOCASE  10416>>ASSIGN  10416>>ASSIGN  10417>>ASSIGN  10417>>ASSIGN
     10418>>ASSIGN  10418>>ASSIGN  10419>>ASSIGN  10419>>ASSIGN  10422>>ASSIGN  10444>>ASSIGN  10447>>ASSIGN
     10476>>ASSIGN  10482>>ASSIGN  10488>>ASSIGN  10490>>ASSIGN  10492>>ASSIGN  10493>>ASSIGN  10519>>ASSIGN
     10520>>ASSIGN  10522>>ASSIGN  10558>>ASSIGN  10558>>ASSIGN  10559>>IF      10559>>IF      10561>>ASSIGN
     10569>>ASSIGN  10577>>IF      10585>>IF      10585>>IF      10596>>CALL    10596>>CALL
KJ_DCW_DTL66L6
      8788**DCL     10432>>ASSIGN
KJ_DCW_DTL6L66
      8828**DCL     10458>>ASSIGN
KJ_GH_IO_INIT.CAS.CHN
      9747**DCL      9747--REDEF
KJ_GH_IO_INIT.DAS
      9748**DCL      9749--REDEF    9750--REDEF
KJ_GH_IO_INTL66.CAS.CHN
      9763**DCL      9763--REDEF
KJ_GH_IO_INTL66.DAS
      9764**DCL      9765--REDEF    9766--REDEF
KJ_INIT_MSG.FPT.RLCID.FEP_NODE
      9591**DCL     10520<<ASSIGN
KJ_INIT_MSG.FPT.RLCID.FLAGS.HOST_NODE
      9592**DCL     10521<<ASSIGN
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9590**DCL      9591--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9591**DCL      9591--REDEF
KJ_INIT_MSG.FPT.RLCID.NODE
      9590**DCL     10519<<ASSIGN
KJ_INIT_MSG.FPT.SERVICE
      9593**DCL     10522<<ASSIGN
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9579**DCL      9588--REDEF
KJ_INIT_MSG.FUNCTION
      9504**DCL      9504--REDEF
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:111  
KJ_INIT_MSG.LDCTX
      9509**DCL     10523<<ASSIGN
KJ_INIT_MSG.UID
      9534**DCL      9534--REDEF    9534--REDEF
KJ_IOLD_BARR.CHN
      9717**DCL      9717--REDEF
KJ_IOLD_DCWLIST.CHN
      9732**DCL      9732--REDEF
KJ_LDCTX
      9133**DCL     10551>>ASSIGN
KJ_STATS.DATAFNC.NOP
      9480**DCL     10532<<ASSIGN  10532>>ASSIGN
KJ_STATS.DATAFNC.ODATA
      9479**DCL     10528<<ASSIGN  10528>>ASSIGN
KJ_STATS.DATAFNC.RUOK
      9478**DCL     10518<<ASSIGN  10518>>ASSIGN
KJ_STATS.DATAFNC.TIM
      9481**DCL     10537<<ASSIGN  10537>>ASSIGN
KJ_STATS.OCQ_MBC
      9474**DCL     10510<<ASSIGN  10510>>ASSIGN
KJ_STATS.OCQ_MSGS
      9472**DCL     10509<<ASSIGN  10509>>ASSIGN
KJ_STATS.REQSTATS.DSPMSK
      9396**DCL      9402--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9437**DCL      9444--REDEF
KJ_STATS.USRSTT.INPINTISATIM
      9467**DCL     10601<<ASSIGN  10601>>ASSIGN
KJ_STATS.USRSTT.OTPINTCNT
      9466**DCL     10385<<ASSIGN  10385>>ASSIGN
KJ_TERM_MSG.FUNCTION
      9622**DCL      9622--REDEF
KJ_TERM_MSG.UID
      9652**DCL      9652--REDEF    9652--REDEF
KJ_WRT_INIT
      9671**DCL     10524<>CALL
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:112  
KNH$MESS
     10296**DCL     10502--DOWHILE 10504--ASSIGN  10572--ASSIGN
KNH$MESS.FPTSZ
     10329**DCL     10504>>ASSIGN  10550<<ASSIGN  10573<<ASSIGN
KNH$MESS.FUNCTION
     10296**DCL     10296--REDEF   10514>>DOCASE  10525<<ASSIGN  10529<<ASSIGN  10533<<ASSIGN  10536<<ASSIGN
     10571<<ASSIGN
KNH$MESS.LAST_PTR
     10329**DCL     10512<<ASSIGN
KNH$MESS.LDCTX
     10301**DCL     10551<<ASSIGN
KNH$MESS.MSGSZ
     10330**DCL     10504>>ASSIGN  10510>>ASSIGN  10572<<ASSIGN
KNH$MESS.RECTYPE
     10329**DCL     10511<<ASSIGN  10538<<ASSIGN
KNH$MESS.UID
     10326**DCL     10326--REDEF   10326--REDEF
KNH$QHDR.LAST_SCQPTR
     10280**DCL     10512>>ASSIGN  10513<<ASSIGN
KNH$QHDR.RCQ
     10271**DCL     10271--REDEF
KNH$QHDR.RCQ.IPTR
     10271**DCL     10602>>IF
KNH$QHDR.RCQ.RPTR
     10271**DCL     10490<<ASSIGN
KNH$QHDR.SCQ.IPTR
     10272**DCL     10492>>ASSIGN  10513>>ASSIGN  10552<<ASSIGN  10552>>ASSIGN  10567>>IF      10572>>ASSIGN
     10574<<ASSIGN  10577>>IF      10583<<ASSIGN  10585>>IF
KNH$QHDR.SCQ.RPTR
     10272**DCL     10567>>IF      10567>>IF      10577>>IF      10583>>ASSIGN  10585>>IF      10602>>IF
KNH$QHDR.SCQ.SZ
     10272**DCL     10495>>IF      10572>>ASSIGN
M$SCREECH
      4290**DCL-ENT 10389--CALL    10497--CALL    10541--CALL
M$WRITE
      4311**DCL-ENT 10524--CALL
PL6.E3A0      #002=KJF$INTHAND File=KJF$FEI.:E05TSI                              WED 07/30/97 00:47 Page:113  
M$WRTMLT
      4311**DCL-ENT 10580--CALL
MSGSZ
     10265**DCL     10504<<ASSIGN  10505>>IF      10552>>ASSIGN  10554>>ASSIGN  10555>>ASSIGN  10558>>ASSIGN
SCANSZ
     10264**DCL     10493<<ASSIGN  10495>>IF      10502>>DOWHILE 10505>>IF      10554<<ASSIGN  10554>>ASSIGN
     10565>>IF
SVDXEQTIM
     10266**DCL     10384<>CALL    10601>>ASSIGN
X6A_INTRET
     10256**DCL-ENT 10604--CALL    10606--CALL

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:114  
      542        1        /*T***********************************************************/
      543        2        /*T*                                                         */
      544        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      545        4        /*T*                                                         */
      546        5        /*T***********************************************************/
      547        6        KJF$DATA: PROC;
      548        7
      549        8        %INCLUDE KJ_DATA_R;
      550    10249
      551    10250        /* Parameters */
      552    10251    1   DCL INTERUPT BIT(1) ALIGNED;            /* Interupt on only pointer transfer */
      553    10252
      554    10253        /* Local variables */
      555    10254    1   DCL DCW$ PTR;
      556    10255    1   DCL SIZE SBIN(32);
      557    10256    1   DCL SIZE2 SBIN(32);
      558    10257    1   DCL IP$ PTR;
      559    10258    1   DCL OP$ PTR;
      560    10259    1   DCL SCANSZ SBIN(32);
      561    10260    1   DCL BFSIZE SBIN(32);
      562    10261    1   DCL ICQ$ PTR;
      563    10262    1   DCL OCQ$ PTR;
      564    10263    1   DCL MSGSZ UBIN;
      565    10264    1   DCL INPUT BIT(1);
      566    10265
      567    10266        /* Based structures */
      568    10267        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      569    10280        %KNH$MESS (STCLASS="BASED(IP$)");
      570    10329
      571    10330        /* Entry point references */
      572    10331    1   DCL KJF$DCWLIST ENTRY;
      573    10332    1   DCL KJF$IO ENTRY(1) ALTRET;
      574    10333
      575    10334        %EJECT;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:115  
      576    10335
      577    10336        /* If there is a current function return */
      578    10337    1        IF KJ$CTX.CURRENT_FUNCTION ~= %KJ_CF_NONE
      579    10338    1        THEN
      580    10339    1             RETURN;
      581    10340
      582    10341    1        DCW$ = ADDR(KJ$CTX.DCWS);
      583    10342
      584    10343        /* Build a DCW to tell the host that a list is in process so he does
      585    10344             not try to interupt us */
      586    10345    1        KJ$CTX.IOIP.FLAG = '1'B;
      587    10346             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      588    10347             L66A=%KJ_OFFSET_IOIP,
      589    10348             L6A=KJ_OFF_IOIP,
      590    10349             MODE=%KJ_MODE_BIN,
      591    10350             TALLY=1);
      592    10373
      593    10374    1        ICQ$ = KJ$CTX.ICQ.BUF$;
      594    10375    1        OCQ$ = KJ$CTX.OCQ.BUF$;
      595    10376
      596    10377    1        KJ$CTX.IBUF.CSIZE = 0;
      597    10378
      598    10379        /* Here there is a little playing with the CQ */
      599    10380    1        IF KNH$QHDR.SCQ.RPTR = KNH$QHDR.SCQ.IPTR
      600    10381    2        THEN DO;
      601    10382    2             KNH$QHDR.SCQ.IPTR = 0;
      602    10383    2             KNH$QHDR.SCQ.RPTR = 0;
      603    10384    2           END;
      604    10385
      605    10386    1        IF KNH$QHDR.SCQ.IPTR >= KNH$QHDR.SCQ.RPTR
      606    10387    2        THEN DO;
      607    10388    2             BFSIZE = KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR - SIZEW(KNH$MESS)/2;
      608    10389
      609    10390    2             IF BFSIZE < SIZEW(KNH$MESS)/2
      610    10391    2             THEN
      611    10392    2                  IF KNH$QHDR.SCQ.RPTR ~= 0
      612    10393    3                  THEN DO;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:116  
      613    10394    3                       IP$ = PINCRW(KJ$CTX.OCQ.BUF$,KNH$QHDR.SCQ.IPTR*2);
      614    10395    3                       KNH$MESS.FUNCTION = %KN_FCN_NOP;
      615    10396    3                       KNH$MESS.FPTSZ=0;
      616    10397    3                       KNH$MESS.MSGSZ = (KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR) * 4 -
             10397                                SIZEC(KNH$MESS);
      617    10398    3                       KNH$QHDR.SCQ.IPTR = 0;
      618    10399    3                       BFSIZE = KNH$QHDR.SCQ.RPTR - 1;
      619    10400    3                     END;
      620    10401    2                  ELSE
      621    10402    2                       BFSIZE = 0;
      622    10403    2           END;
      623    10404    1        ELSE
      624    10405    1             BFSIZE = KNH$QHDR.SCQ.RPTR - KNH$QHDR.SCQ.IPTR - 1;
      625    10406
      626    10407    1        IF BFSIZE < (SIZEW(KNH$MESS)+1)/2
      627    10408    2        THEN DO;
      628    10409    2             KJ$CTX.FLAGS.BUF_FULL = '1'B;
      629    10410    2             BFSIZE = 0;
      630    10411    2           END;
      631    10412
      632    10413    1        KJ$CTX.OCQ.RDSIZE = 0;
      633    10414    1        SIZE = KJ$CTX.OCQ.IPTR - KJ$CTX.OCQ.RPTR;
      634    10415
      635    10416
      636    10417        /* If the biggest block we are to read is smaller than bfsize use ther former */
      637    10418    1        IF KJ_CONTROL.OCQDBLKSIZ ~= 0 AND BFSIZE > KJ_CONTROL.OCQDBLKSIZ
      638    10419    1        THEN
      639    10420    1             BFSIZE = KJ_CONTROL.OCQDBLKSIZ;
      640    10421
      641    10422        /* Check to see if there is data in the OCQ */
      642    10423    1        IF SIZE ~= 0 AND BFSIZE ~= 0
      643    10424    2        THEN DO;
      644    10425
      645    10426        /* There must be something in the queue so the pointers must be checked
      646    10427             to see if the queue has warpped */
      647    10428    2             IF SIZE < 0                   /* Has wrapped  */
      648    10429    3             THEN DO;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:117  
      649    10430    3                  SIZE = KJ$CTX.OCQ.SIZE - KJ$CTX.OCQ.RPTR;
      650    10431    3                  SIZE2 = KJ$CTX.OCQ.IPTR;
      651    10432    3                END;
      652    10433    2             ELSE
      653    10434    2                  SIZE2 = 0;
      654    10435    2             IF SIZE > BFSIZE              /* Data is larger than the buffer */
      655    10436    3             THEN DO;
      656    10437    3                  SIZE = BFSIZE;
      657    10438    3                  SIZE2 = 0;
      658    10439    3                END;
      659    10440    2             ELSE
      660    10441    2                  IF SIZE+SIZE2 > BFSIZE
      661    10442    2                  THEN
      662    10443    2                       SIZE2 = BFSIZE - SIZE;
      663    10444
      664    10445    2             KJ$CTX.OCQ.RDSIZE = SIZE + SIZE2;
      665    10446        /* Build DCW to transfer the data */
      666    10447
      667    10448                  %KJ$BLDDCW (OPERATION=DATAL66_L6,
      668    10449                  L66A = "KJ$CTX.OCQ.RPTR + %KJ_OFFSET_DATA",
      669    10450                  L6A = "KJ_SCQ_OFFSET + KNH$QHDR.SCQ.IPTR*2",
      670    10451                  TALLY = "SIZE*4");
      671    10474
      672    10475    2             IF SIZE2 > 0
      673    10476    3             THEN DO;
      674    10477                       %KJ$BLDDCW (OPERATION=DATAL66_L6,
      675    10478                       L66A = %KJ_OFFSET_DATA,
      676    10479                       L6A = "KJ_SCQ_OFFSET+SIZE*2+KNH$QHDR.SCQ.IPTR*2",
      677    10480                       TALLY = "SIZE2*4");
      678    10503    3                END;
      679    10504    2           END;
      680    10505
      681    10506        /* Scan circular queue from the monitor for messages */
      682    10507    1        SCANSZ = KNH$QHDR.RCQ.IPTR - KJ$CTX.ICQ.NEW_RPTR;
      683    10508
      684    10509        /* If SCANSZ is less than 0 the CQ has wrapped */
      685    10510    1        IF SCANSZ < 0
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:118  
      686    10511    1        THEN
      687    10512    1             SCANSZ = SCANSZ + KNH$QHDR.RCQ.SZ;
      688    10513    1        IP$ = PINCRW (KJ$CTX.ICQ.BUF$,KJ$CTX.ICQ.NEW_RPTR*2);
      689    10514
      690    10515    1        INPUT = '0'B;                      /* Will be set if we input a DCW */
      691    10516    2        DO WHILE (SCANSZ > 0 AND (POFFW(DCW$,ADDR(KJ$CTX.DCWS))< SIZEW(KJ$CTX.DCWS)-
             10516                 SIZEW(KJ$DCW)));
      692    10517
      693    10518    2             MSGSZ = (SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ + 1)/2 + (KNH$MESS.MSGSZ+1)/2 +
             10518                      1)/2;
      694    10519
      695    10520    3             DO CASE (KNH$MESS.FUNCTION);
      696    10521
      697    10522    3             CASE (%KN_FCN_INIT);
      698    10523
      699    10524
      700    10525    3             CASE (%KN_FCN_INIT_ACK);
      701    10526
      702    10527    3                KJ$CTX.STATE = %KJ_STATE_RUNNING;
      703    10528    3                KJ_LDCTX = KNH$MESS.LDCTX;
      704    10529    3                KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;
      705    10530    4                CALL KJF$IO (KJ_GH_IO_INTL66) WHENALTRETURN DO;
      706    10531    4                     CALL M$SCREECH ( CPLR_IO ) ;
      707    10532    4                   END;
      708    10533
      709    10534
      710    10535    3             CASE (%KN_FCN_TERM);
      711    10536
      712    10537
      713    10538    3             CASE (%KN_FCN_TERM_ACK);
      714    10539    3                KJ$CTX.STATE = %KJ_STATE_MASKED;
      715    10540
      716    10541
      717    10542    3             CASE (%KN_FCN_DATA);
      718    10543
      719    10544    3                IF KJ$CTX.STATE = %KJ_STATE_RUNNING
      720    10545    4                THEN DO;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:119  
      721    10546    4                     IF KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.RPTR
             10546                              /* Space is from KJ$CTX.ICQ.IPTR to end of CQ */
      722    10547    4                     THEN
      723    10548    4                          SIZE = KJ$CTX.ICQ.SIZE - KJ$CTX.ICQ.IPTR - SIZEW(KNH$MESS)/2;
      724    10549    4                     ELSE
      725    10550    4                          SIZE = KJ$CTX.ICQ.RPTR - KJ$CTX.ICQ.IPTR - 1;
      726    10551
      727    10552    4                     IF MSGSZ > SIZE AND KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.RPTR AND KJ$CTX.
             10552                              ICQ.RPTR ~= 0 /* Put nop at end */
      728    10553    5                     THEN DO;
      729    10554    5                          OP$ = KJ$CTX.IBUF.BUF$;
      730    10555    5                          OP$->KNH$MESS.FUNCTION = %KJ_FCN_NOPI;
      731    10556    5                          OP$->KNH$MESS.FPTSZ = 0;
      732    10557    5                          OP$->KNH$MESS.MSGSZ = SIZE * 4;
      733    10558    5                          SIZE = KJ$CTX.ICQ.RPTR - 1;
      734    10559                               %KJ$BLDDCW (OPERATION=DATAL6_L66,
      735    10560                               L6A="POFFW(OP$,G$HAND_Q$)",
      736    10561                               L66A="KJ$CTX.ICQ.IPTR + %KJ_OFFSET_DATA + KJ$CTX.ICQ.OFFSET",
      737    10562                               TALLY="SIZEC(KNH$MESS)");
      738    10585    5                          OP$->KNH$MESS.UID = KJ$CTX.ICQ.LSTIPTR;
      739    10586    5                          KJ$CTX.ICQ.LSTIPTR = KJ$CTX.ICQ.IPTR;
      740    10587    5                          KJ$CTX.ICQ.IPTR = 0;
      741    10588    5                        END;
      742    10589
      743    10590    4                     IF MSGSZ > SIZE       /* No space for message */
      744    10591    5                     THEN DO;
      745    10592    5                          SCANSZ=0;
      746    10593    5                          MSGSZ=0;
      747    10594    5                        END;
      748    10595
      749    10596    5                     ELSE DO;
      750    10597    5                          KJ_MSGSLINT = KJ_MSGSLINT + 1;
      751    10598    5                          KJ_STATS.ICQ_MSGS = KJ_STATS.ICQ_MSGS + 1;
      752    10599    5                          KJ_STATS.ICQ_MBC = KJ_STATS.ICQ_MBC + KNH$MESS.MSGSZ;
      753    10600
      754    10601                               %KJ$BLDDCW (OPERATION=DATAL6_L66,
      755    10602                               L66A ="KJ$CTX.ICQ.IPTR + %KJ_OFFSET_DATA + KJ$CTX.ICQ.OFFSET"
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:120  
             10602                                   ,
      756    10603                               L6A = "KJ_OFF_ICQ_DATA + KJ$CTX.ICQ.NEW_RPTR*2",
      757    10604                               MODE=%KJ_MODE_ASCII,
      758    10605                               TALLY="MSGSZ*4");
      759    10628
      760    10629        /* Set function code so the host understands */
      761    10630        /* If the RECTYPE is non zero it contains the function we want to put in CQ */
      762    10631    5                          IF KNH$MESS.RECTYPE ~= 0
      763    10632    5                          THEN
      764    10633    5                               KNH$MESS.FUNCTION = KNH$MESS.RECTYPE;
      765    10634    5                          ELSE
      766    10635    5                               KNH$MESS.FUNCTION = %KJ_FCN_IDATA;
      767    10636    5                          INPUT = '1'B;
             10636                                   /* This will causes the Host to be interupted */
      768    10637    5                          KNH$MESS.UID = KJ$CTX.ICQ.LSTIPTR;
      769    10638    5                          KJ$CTX.ICQ.LSTIPTR = KJ$CTX.ICQ.IPTR;
      770    10639    5                          KJ$CTX.ICQ.IPTR = KJ$CTX.ICQ.IPTR + MSGSZ;
      771    10640    5                          IF KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.SIZE
      772    10641    5                          THEN
      773    10642    5                               KJ$CTX.ICQ.IPTR = 0;
      774    10643    5                        END;
      775    10644    4                   END;
      776    10645
      777    10646
      778    10647
      779    10648    3             CASE (%KN_FCN_NOP);
      780    10649
      781    10650
      782    10651    3             END;                          /* End cases */
      783    10652
      784    10653    2             IP$ = PINCRW(IP$,MSGSZ*2);
      785    10654    2             KJ$CTX.ICQ.NEW_RPTR = KJ$CTX.ICQ.NEW_RPTR + MSGSZ;
      786    10655    2             IF KJ$CTX.ICQ.NEW_RPTR >= KNH$QHDR.RCQ.SZ
      787    10656    3             THEN DO;
      788    10657    3                  KJ$CTX.ICQ.NEW_RPTR = 0;
      789    10658    3                  IP$ = KJ$CTX.ICQ.BUF$;
      790    10659    3                END;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:121  
      791    10660
      792    10661    2             SCANSZ = SCANSZ - MSGSZ;
      793    10662    2           END;
      794    10663
      795    10664        /* Build interupt L66 DCW */
      796    10665    1        IF INPUT AND KJ_MSGSLINT >= KJ_CONTROL.MSG#
      797    10666    1             OR KJ$CTX.OCQ.FLAGS.QFULL
      798    10667    1        THEN                               /* Input was done */
      799    10668    2        DO;
      800    10669    2             KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;
      801    10670    2             KJ$CTX.PTR_DCW.OPERATION(5) = %KJ_DCW_INTL66;
      802    10671    2           END;
      803    10672
      804    10673
      805    10674    1        IF DCW$ ~= ADDR(KJ$CTX.PTR_DCW)
      806    10675    1        THEN
      807    10676    1             DCW$->KJ$DCW = KJ_DCW_JUMP;
      808    10677
      809    10678    1        IF KJ$CTX.STATE = %KJ_STATE_RUNNING
      810    10679    1             OR KJ$CTX.STATE = %KJ_STATE_INIT
      811    10680    2        THEN DO;
      812    10681    2             KJ$CTX.CURRENT_FUNCTION = %KJ_CF_DATA;
      813    10682    2             CALL KJF$DCWLIST;
      814    10683    2           END;
      815    10684
      816    10685    1        RETURN;
      817    10686
      818    10687    1   END KJF$DATA;
      819    10688        %EOD;

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:122  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$DATA.

   Procedure KJF$DATA requires 902 words for executable code.
   Procedure KJF$DATA requires 28 words of local(AUTO) storage.

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:123  

 Object Unit name= KJF$DATA                                   File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:47:56.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Proc  even  none   902    386  KJF$DATA
    2  RoData even  none     2      2  KJF$DATA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  KJF$DATA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KJF$IO
         yes           Std       0 KJF$DCWLIST
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:124  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                             r    KJ_DCW_DTL66L6                   r    KJ_DCW_DTL6L66
     KJ_DCW_JUMP                           G$HAND_Q$                             KJ_CTX$
     KJ_OFF_ICQ_DATA                       KJ_OFF_IOIP                           KJ_SCQ_OFFSET
     KJ_MSGSLINT                           KJ_LDCTX                              KJ_CONTROL
     KJ_STATS                              KJ_GH_IO_INTL66                  r    CPLR_IO
r    G$ROS$
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:125  


      542        1        /*T***********************************************************/
      543        2        /*T*                                                         */
      544        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      545        4        /*T*                                                         */
      546        5        /*T***********************************************************/
      547        6        KJF$DATA: PROC;

      6   1 000000  D380 0000 0000  xent KJF$DATA        LNJ,B5   X6A_AUTO_0
          1 000003       001C 0000                       DC       28,0

      548        7
      549        8        %INCLUDE KJ_DATA_R;
      550    10249
      551    10250        /* Parameters */
      552    10251    1   DCL INTERUPT BIT(1) ALIGNED;            /* Interupt on only pointer transfer */
      553    10252
      554    10253        /* Local variables */
      555    10254    1   DCL DCW$ PTR;
      556    10255    1   DCL SIZE SBIN(32);
      557    10256    1   DCL SIZE2 SBIN(32);
      558    10257    1   DCL IP$ PTR;
      559    10258    1   DCL OP$ PTR;
      560    10259    1   DCL SCANSZ SBIN(32);
      561    10260    1   DCL BFSIZE SBIN(32);
      562    10261    1   DCL ICQ$ PTR;
      563    10262    1   DCL OCQ$ PTR;
      564    10263    1   DCL MSGSZ UBIN;
      565    10264    1   DCL INPUT BIT(1);
      566    10265
      567    10266        /* Based structures */
      568    10267        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      569    10280        %KNH$MESS (STCLASS="BASED(IP$)");
      570    10329
      571    10330        /* Entry point references */
      572    10331    1   DCL KJF$DCWLIST ENTRY;
      573    10332    1   DCL KJF$IO ENTRY(1) ALTRET;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:126  
      574    10333
      575    10334        %EJECT;
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:127  
      576    10335
      577    10336        /* If there is a current function return */
      578    10337    1        IF KJ$CTX.CURRENT_FUNCTION ~= %KJ_CF_NONE

  10337   1 000005  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000008  E846 0001                            LDR,R6   1,B6
          1 00000A  6901 0004                            BEZ,R6   s:10341,PREL

      579    10338    1        THEN
      580    10339    1             RETURN;

  10339   1 00000C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      581    10340
      582    10341    1        DCW$ = ADDR(KJ$CTX.DCWS);

  10341   1 00000F  DBC6 0038                            LAB,B5   56,B6
          1 000011  DFC7 0005                            STB,B5   DCW$,AUTO

      583    10342
      584    10343        /* Build a DCW to tell the host that a list is in process so he does
      585    10344             not try to interupt us */
      586    10345    1        KJ$CTX.IOIP.FLAG = '1'B;

  10345   1 000013  8946 0035                            LBT,'8000'X       53,B6
  10345   1 000015       8000

      587    10346             %KJ$BLDDCW (OPERATION=DATAL6_L66,
      588    10347             L66A=%KJ_OFFSET_IOIP,
      589    10348             L6A=KJ_OFF_IOIP,
      590    10349             MODE=%KJ_MODE_BIN,
      591    10350             TALLY=1);

  10352   1 000016  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          1 000019  2C00                                 LDV,R2   0
          1 00001A  6C0C                                 LDV,R6   12
          1 00001B  BB85                                 LAB,B3   ,B5
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:128  
          1 00001C  3C00                                 LDV,R3   0
          1 00001D  0008                                 MMM

  10360   1 00001E  6C03                                 LDV,R6   3
          1 00001F  ECC7 0005                            LDB,B6   DCW$,AUTO
          1 000021  EA86                                 SRM,R6,'00FF'X    ,B6
          1 000022       00FF

  10363   1 000023  5C01                                 LDV,R5   1
          1 000024  DF46 0001                            STR,R5   1,B6

  10366   1 000026  8CF0 0000 0002                       LDI      2,IMO
          1 000029  8D46 0002                            SDI      2,B6

  10369   1 00002B  8C80 0000 0000  xsym                 LDI      KJ_OFF_IOIP
          1 00002E  8D46 0004                            SDI      4,B6

  10371   1 000030  CBC6 0006                            LAB,B4   6,B6
          1 000032  CFC7 0005                            STB,B4   DCW$,AUTO

      592    10373
      593    10374    1        ICQ$ = KJ$CTX.ICQ.BUF$;

  10374   1 000034  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000037  ACC6 0019                            LDB,B2   25,B6
          1 000039  AFC7 0013                            STB,B2   ICQ$,AUTO

      594    10375    1        OCQ$ = KJ$CTX.OCQ.BUF$;

  10375   1 00003B  9CC6 002D                            LDB,B1   45,B6
          1 00003D  9FC7 0015                            STB,B1   OCQ$,AUTO

      595    10376
      596    10377    1        KJ$CTX.IBUF.CSIZE = 0;

  10377   1 00003F  8746 0034                            CL       52,B6

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:129  
      597    10378
      598    10379        /* Here there is a little playing with the CQ */
      599    10380    1        IF KNH$QHDR.SCQ.RPTR = KNH$QHDR.SCQ.IPTR

  10380   1 000041  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          1 000044  C846 0005                            LDR,R4   5,B6
          1 000046  C946 0004                            CMR,R4   4,B6
          1 000048  0981 0005                            BNE      s:10386,PREL

      600    10381    2        THEN DO;

      601    10382    2             KNH$QHDR.SCQ.IPTR = 0;

  10382   1 00004A  8746 0004                            CL       4,B6

      602    10383    2             KNH$QHDR.SCQ.RPTR = 0;

  10383   1 00004C  8746 0005                            CL       5,B6

      603    10384    2           END;

      604    10385
      605    10386    1        IF KNH$QHDR.SCQ.IPTR >= KNH$QHDR.SCQ.RPTR

  10386   1 00004E  C846 0004                            LDR,R4   4,B6
          1 000050  C946 0005                            CMR,R4   5,B6
          1 000052  0201 0048                            BL       s:10405,PREL

      606    10387    2        THEN DO;

      607    10388    2             BFSIZE = KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR - SIZEW(KNH$MESS)/2;

  10388   1 000054  C246 0006                            SUB,R4   6,B6
          1 000056  E854                                 LDR,R6   R4
          1 000057  70F0                                 DAR,R7   16
          1 000058  8656                                 CPL      R6
          1 000059  8657                                 CPL      R7
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:130  
          1 00005A  8470 FFFF FFFD                       AID      -3,IMO
          1 00005D  8D47 0011                            SDI      BFSIZE,AUTO

      608    10389
      609    10390    2             IF BFSIZE < SIZEW(KNH$MESS)/2

  10390   1 00005F  84F0 0000 0004                       SID      4,IMO
          1 000062  6881 0040                            BGEZ,R6  s:10407,PREL

      610    10391    2             THEN
      611    10392    2                  IF KNH$QHDR.SCQ.RPTR ~= 0

  10392   1 000064  E846 0005                            LDR,R6   5,B6
          1 000066  6901 002E                            BEZ,R6   s:10402,PREL

      612    10393    3                  THEN DO;

      613    10394    3                       IP$ = PINCRW(KJ$CTX.OCQ.BUF$,KNH$QHDR.SCQ.IPTR*2);

  10394   1 000068  B846 0004                            LDR,R3   4,B6
          1 00006A  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 00006D  DCC6 002D                            LDB,B5   45,B6
          1 00006F  DFC7 001A                            STB,B5   INPUT+2,AUTO
          1 000071  F853                                 LDR,R7   R3
          1 000072  6C00                                 LDV,R6   0
          1 000073  7081                                 DOL,R7   1
          1 000074  8447 001A                            AID      INPUT+2,AUTO
          1 000076  8D47 000B                            SDI      IP$,AUTO

      614    10395    3                       KNH$MESS.FUNCTION = %KN_FCN_NOP;

  10395   1 000078  BCC7 000B                            LDB,B3   IP$,AUTO
          1 00007A  4C06                                 LDV,R4   6
          1 00007B  CF03                                 STR,R4   ,B3

      615    10396    3                       KNH$MESS.FPTSZ=0;

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:131  
  10396   1 00007C  8743 0006                            CL       6,B3

      616    10397    3                       KNH$MESS.MSGSZ = (KNH$QHDR.SCQ.SZ - KNH$QHDR.SCQ.IPTR) * 4 -
             10397                                SIZEC(KNH$MESS);

  10397   1 00007E  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          1 000081  B846 0006                            LDR,R3   6,B6
          1 000083  B246 0004                            SUB,R3   4,B6
          1 000085  3002                                 SOL,R3   2
          1 000086  3EF0                                 ADV,R3   -16
          1 000087  BF43 0007                            STR,R3   7,B3

      617    10398    3                       KNH$QHDR.SCQ.IPTR = 0;

  10398   1 000089  8746 0004                            CL       4,B6

      618    10399    3                       BFSIZE = KNH$QHDR.SCQ.RPTR - 1;

  10399   1 00008B  F846 0005                            LDR,R7   5,B6
          1 00008D  6C00                                 LDV,R6   0
          1 00008E  8470 FFFF FFFF                       AID      -1,IMO
          1 000091  8D47 0011                            SDI      BFSIZE,AUTO

      619    10400    3                     END;

  10400   1 000093  0F81 000F                            B        s:10407,PREL

      620    10401    2                  ELSE
      621    10402    2                       BFSIZE = 0;

  10402   1 000095  8747 0011                            CL       BFSIZE,AUTO
          1 000097  8747 0012                            CL       BFSIZE+1,AUTO

      622    10403    2           END;

  10403   1 000099  0F81 0009                            B        s:10407,PREL

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:132  
      623    10404    1        ELSE
      624    10405    1             BFSIZE = KNH$QHDR.SCQ.RPTR - KNH$QHDR.SCQ.IPTR - 1;

  10405   1 00009B  C246 0005                            SUB,R4   5,B6
          1 00009D  E854                                 LDR,R6   R4
          1 00009E  70F0                                 DAR,R7   16
          1 00009F  8656                                 CPL      R6
          1 0000A0  8657                                 CPL      R7
          1 0000A1  8D47 0011                            SDI      BFSIZE,AUTO

      625    10406
      626    10407    1        IF BFSIZE < (SIZEW(KNH$MESS)+1)/2

  10407   1 0000A3  8CC7 0011                            LDI      BFSIZE,AUTO
          1 0000A5  84F0 0000 0004                       SID      4,IMO
          1 0000A8  6881 000B                            BGEZ,R6  s:10413,PREL

      627    10408    2        THEN DO;

      628    10409    2             KJ$CTX.FLAGS.BUF_FULL = '1'B;

  10409   1 0000AA  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0000AD  8945 0009                            LBT,'8000'X       9,B5
          1 0000AF       8000

      629    10410    2             BFSIZE = 0;

  10410   1 0000B0  8747 0011                            CL       BFSIZE,AUTO
          1 0000B2  8747 0012                            CL       BFSIZE+1,AUTO

      630    10411    2           END;

      631    10412
      632    10413    1        KJ$CTX.OCQ.RDSIZE = 0;

  10413   1 0000B4  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0000B7  8745 002B                            CL       43,B5
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:133  
          1 0000B9  8745 002C                            CL       44,B5

      633    10414    1        SIZE = KJ$CTX.OCQ.IPTR - KJ$CTX.OCQ.RPTR;

  10414   1 0000BB  8CC5 001F                            LDI      31,B5
          1 0000BD  84C5 0022                            SID      34,B5
          1 0000BF  8D47 0007                            SDI      SIZE,AUTO

      634    10415
      635    10416
      636    10417        /* If the biggest block we are to read is smaller than bfsize use ther former */
      637    10418    1        IF KJ_CONTROL.OCQDBLKSIZ ~= 0 AND BFSIZE > KJ_CONTROL.OCQDBLKSIZ

  10418   1 0000C1  C800 0000 0009  xsym                 LDR,R4   KJ_CONTROL+9
          1 0000C4  4901 000B                            BEZ,R4   s:10423,PREL
          1 0000C6  F854                                 LDR,R7   R4
          1 0000C7  6C00                                 LDV,R6   0
          1 0000C8  84C7 0011                            SID      BFSIZE,AUTO
          1 0000CA  6881 0005                            BGEZ,R6  s:10423,PREL

      638    10419    1        THEN
      639    10420    1             BFSIZE = KJ_CONTROL.OCQDBLKSIZ;

  10420   1 0000CC  F854                                 LDR,R7   R4
          1 0000CD  6C00                                 LDV,R6   0
          1 0000CE  8D47 0011                            SDI      BFSIZE,AUTO

      640    10421
      641    10422        /* Check to see if there is data in the OCQ */
      642    10423    1        IF SIZE ~= 0 AND BFSIZE ~= 0

  10423   1 0000D0  8CC7 0007                            LDI      SIZE,AUTO
          1 0000D2  84F0 0000 0000                       SID      0,IMO
          1 0000D5  6981 0003                            BNEZ,R6  s:10423+9,PREL
          1 0000D7  7901 00AE                            BEZ,R7   s:10507,PREL
          1 0000D9  8CC7 0011                            LDI      BFSIZE,AUTO
          1 0000DB  84F0 0000 0000                       SID      0,IMO
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:134  
          1 0000DE  6981 0003                            BNEZ,R6  s:10428,PREL
          1 0000E0  7901 00A5                            BEZ,R7   s:10507,PREL

      643    10424    2        THEN DO;

      644    10425
      645    10426        /* There must be something in the queue so the pointers must be checked
      646    10427             to see if the queue has warpped */
      647    10428    2             IF SIZE < 0                   /* Has wrapped  */

  10428   1 0000E2  8CC7 0007                            LDI      SIZE,AUTO
          1 0000E4  84F0 0000 0000                       SID      0,IMO
          1 0000E7  6881 000D                            BGEZ,R6  s:10434,PREL

      648    10429    3             THEN DO;

      649    10430    3                  SIZE = KJ$CTX.OCQ.SIZE - KJ$CTX.OCQ.RPTR;

  10430   1 0000E9  8CC5 0025                            LDI      37,B5
          1 0000EB  84C5 0022                            SID      34,B5
          1 0000ED  8D47 0007                            SDI      SIZE,AUTO

      650    10431    3                  SIZE2 = KJ$CTX.OCQ.IPTR;

  10431   1 0000EF  8CC5 001F                            LDI      31,B5
          1 0000F1  8D47 0009                            SDI      SIZE2,AUTO

      651    10432    3                END;

  10432   1 0000F3  0F81 0005                            B        s:10435,PREL

      652    10433    2             ELSE
      653    10434    2                  SIZE2 = 0;

  10434   1 0000F5  8747 0009                            CL       SIZE2,AUTO
          1 0000F7  8747 000A                            CL       SIZE2+1,AUTO

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:135  
      654    10435    2             IF SIZE > BFSIZE              /* Data is larger than the buffer */

  10435   1 0000F9  8CC7 0007                            LDI      SIZE,AUTO
          1 0000FB  84C7 0011                            SID      BFSIZE,AUTO
          1 0000FD  6801 000F                            BLZ,R6   s:10441,PREL
          1 0000FF  6A01 0003                            BGZ,R6   s:10437,PREL
          1 000101  7901 000B                            BEZ,R7   s:10441,PREL

      655    10436    3             THEN DO;

      656    10437    3                  SIZE = BFSIZE;

  10437   1 000103  8CC7 0011                            LDI      BFSIZE,AUTO
          1 000105  8D47 0007                            SDI      SIZE,AUTO

      657    10438    3                  SIZE2 = 0;

  10438   1 000107  8747 0009                            CL       SIZE2,AUTO
          1 000109  8747 000A                            CL       SIZE2+1,AUTO

      658    10439    3                END;

  10439   1 00010B  0F81 0013                            B        s:10445,PREL

      659    10440    2             ELSE
      660    10441    2                  IF SIZE+SIZE2 > BFSIZE

  10441   1 00010D  8CC7 0007                            LDI      SIZE,AUTO
          1 00010F  8447 0009                            AID      SIZE2,AUTO
          1 000111  84C7 0011                            SID      BFSIZE,AUTO
          1 000113  6801 000B                            BLZ,R6   s:10445,PREL
          1 000115  6A01 0003                            BGZ,R6   s:10443,PREL
          1 000117  7901 0007                            BEZ,R7   s:10445,PREL

      661    10442    2                  THEN
      662    10443    2                       SIZE2 = BFSIZE - SIZE;

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:136  
  10443   1 000119  8CC7 0011                            LDI      BFSIZE,AUTO
          1 00011B  84C7 0007                            SID      SIZE,AUTO
          1 00011D  8D47 0009                            SDI      SIZE2,AUTO

      663    10444
      664    10445    2             KJ$CTX.OCQ.RDSIZE = SIZE + SIZE2;

  10445   1 00011F  8CC7 0007                            LDI      SIZE,AUTO
          1 000121  8447 0009                            AID      SIZE2,AUTO
          1 000123  8D45 002B                            SDI      43,B5

      665    10446        /* Build DCW to transfer the data */
      666    10447
      667    10448                  %KJ$BLDDCW (OPERATION=DATAL66_L6,
      668    10449                  L66A = "KJ$CTX.OCQ.RPTR + %KJ_OFFSET_DATA",
      669    10450                  L6A = "KJ_SCQ_OFFSET + KNH$QHDR.SCQ.IPTR*2",
      670    10451                  TALLY = "SIZE*4");

  10455   1 000125  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          1 000128  2C00                                 LDV,R2   0
          1 000129  6C0C                                 LDV,R6   12
          1 00012A  BB84                                 LAB,B3   ,B4
          1 00012B  3C00                                 LDV,R3   0
          1 00012C  0008                                 MMM

  10464   1 00012D  ECC7 0005                            LDB,B6   DCW$,AUTO
          1 00012F  8CC7 0007                            LDI      SIZE,AUTO
          1 000131  7082                                 DOL,R7   2
          1 000132  E857                                 LDR,R6   R7
          1 000133  EF46 0001                            STR,R6   1,B6

  10467   1 000135  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 000138  8CC5 0022                            LDI      34,B5
          1 00013A  8470 0000 0010                       AID      16,IMO
          1 00013D  8D46 0002                            SDI      2,B6

  10470   1 00013F  AC80 0000 0000  xsym                 LDB,B2   G$HAND_Q$
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:137  
          1 000142  F842 0004                            LDR,R7   4,B2
          1 000144  6C00                                 LDV,R6   0
          1 000145  7081                                 DOL,R7   1
          1 000146  8400 0000 0000  xsym                 AID      KJ_SCQ_OFFSET
          1 000149  8D46 0004                            SDI      4,B6

  10472   1 00014B  9BC6 0006                            LAB,B1   6,B6
          1 00014D  9FC7 0005                            STB,B1   DCW$,AUTO

      671    10474
      672    10475    2             IF SIZE2 > 0

  10475   1 00014F  8CC7 0009                            LDI      SIZE2,AUTO
          1 000151  84F0 0000 0000                       SID      0,IMO
          1 000154  6801 0031                            BLZ,R6   s:10507,PREL
          1 000156  6A01 0003                            BGZ,R6   s:10484,PREL
          1 000158  7901 002D                            BEZ,R7   s:10507,PREL

      673    10476    3             THEN DO;

      674    10477                       %KJ$BLDDCW (OPERATION=DATAL66_L6,
      675    10478                       L66A = %KJ_OFFSET_DATA,
      676    10479                       L6A = "KJ_SCQ_OFFSET+SIZE*2+KNH$QHDR.SCQ.IPTR*2",
      677    10480                       TALLY = "SIZE2*4");

  10484   1 00015A  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          1 00015D  2C00                                 LDV,R2   0
          1 00015E  6C0C                                 LDV,R6   12
          1 00015F  BB81                                 LAB,B3   ,B1
          1 000160  3C00                                 LDV,R3   0
          1 000161  0008                                 MMM

  10493   1 000162  ECC7 0005                            LDB,B6   DCW$,AUTO
          1 000164  8CC7 0009                            LDI      SIZE2,AUTO
          1 000166  7082                                 DOL,R7   2
          1 000167  E857                                 LDR,R6   R7
          1 000168  EF46 0001                            STR,R6   1,B6
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:138  

  10496   1 00016A  8CF0 0000 0010                       LDI      16,IMO
          1 00016D  8D46 0002                            SDI      2,B6

  10499   1 00016F  8CC7 0007                            LDI      SIZE,AUTO
          1 000171  7081                                 DOL,R7   1
          1 000172  8400 0000 0000  xsym                 AID      KJ_SCQ_OFFSET
          1 000175  8D47 001A                            SDI      INPUT+2,AUTO
          1 000177  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          1 00017A  F845 0004                            LDR,R7   4,B5
          1 00017C  6C00                                 LDV,R6   0
          1 00017D  7081                                 DOL,R7   1
          1 00017E  8447 001A                            AID      INPUT+2,AUTO
          1 000180  8D46 0004                            SDI      4,B6

  10501   1 000182  ABC6 0006                            LAB,B2   6,B6
          1 000184  AFC7 0005                            STB,B2   DCW$,AUTO

      678    10503    3                END;

      679    10504    2           END;

      680    10505
      681    10506        /* Scan circular queue from the monitor for messages */
      682    10507    1        SCANSZ = KNH$QHDR.RCQ.IPTR - KJ$CTX.ICQ.NEW_RPTR;

  10507   1 000186  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000189  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          1 00018C  F805                                 LDR,R7   ,B5
          1 00018D  6C00                                 LDV,R6   0
          1 00018E  84C6 001D                            SID      29,B6
          1 000190  8D47 000F                            SDI      SCANSZ,AUTO

      683    10508
      684    10509        /* If SCANSZ is less than 0 the CQ has wrapped */
      685    10510    1        IF SCANSZ < 0

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:139  
  10510   1 000192  84F0 0000 0000                       SID      0,IMO
          1 000195  6881 0008                            BGEZ,R6  s:10513,PREL

      686    10511    1        THEN
      687    10512    1             SCANSZ = SCANSZ + KNH$QHDR.RCQ.SZ;

  10512   1 000197  F845 0002                            LDR,R7   2,B5
          1 000199  6C00                                 LDV,R6   0
          1 00019A  8447 000F                            AID      SCANSZ,AUTO
          1 00019C  8D47 000F                            SDI      SCANSZ,AUTO

      688    10513    1        IP$ = PINCRW (KJ$CTX.ICQ.BUF$,KJ$CTX.ICQ.NEW_RPTR*2);

  10513   1 00019E  8CC6 001D                            LDI      29,B6
          1 0001A0  CCC6 0019                            LDB,B4   25,B6
          1 0001A2  CFC7 001A                            STB,B4   INPUT+2,AUTO
          1 0001A4  7081                                 DOL,R7   1
          1 0001A5  8447 001A                            AID      INPUT+2,AUTO
          1 0001A7  8D47 000B                            SDI      IP$,AUTO

      689    10514
      690    10515    1        INPUT = '0'B;                      /* Will be set if we input a DCW */

  10515   1 0001A9  8747 0018                            CL       INPUT,AUTO

      691    10516    2        DO WHILE (SCANSZ > 0 AND (POFFW(DCW$,ADDR(KJ$CTX.DCWS))< SIZEW(KJ$CTX.DCWS)-
             10516                 SIZEW(KJ$DCW)));

  10516   1 0001AB  0F81 0180                            B        s:10662,PREL

      692    10517
      693    10518    2            MSGSZ = (SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ + 1)/2 + (KNH$MESS.MSGSZ+1)/2 +
             10518                      1)/2;

  10518   1 0001AD  ECC7 000B                            LDB,B6   IP$,AUTO
          1 0001AF  E846 0006                            LDR,R6   6,B6
          1 0001B1  6E01                                 ADV,R6   1
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:140  
          1 0001B2  6041                                 SOR,R6   1
          1 0001B3  D846 0007                            LDR,R5   7,B6
          1 0001B5  5E01                                 ADV,R5   1
          1 0001B6  5041                                 SOR,R5   1
          1 0001B7  EA55                                 ADD,R6   R5
          1 0001B8  6E09                                 ADV,R6   9
          1 0001B9  6041                                 SOR,R6   1
          1 0001BA  EF47 0017                            STR,R6   MSGSZ,AUTO

      694    10519
      695    10520    3             DO CASE (KNH$MESS.FUNCTION);

  10520   1 0001BC  B806                                 LDR,R3   ,B6
          1 0001BD  3D06                                 CMV,R3   6
          1 0001BE  0281 0139                            BGE      s:10653,PREL
          1 0001C0  A830 0000 01C6  01                   LDR,R2   s:10520+10,R3
          1 0001C3  83A0 0000 01CC  01                   JMP      s:10527,R2
          1 0001C6       012C                            DC       s:10653,PREL
          1 0001C7       012C                            DC       s:10653,PREL
          1 0001C8       0000                            DC       s:10527,PREL
          1 0001C9       012C                            DC       s:10653,PREL
          1 0001CA       0024                            DC       s:10539,PREL
          1 0001CB       002B                            DC       s:10544,PREL

      696    10521
      697    10522    3             CASE (%KN_FCN_INIT);

      698    10523
      699    10524
      700    10525    3             CASE (%KN_FCN_INIT_ACK);

      701    10526
      702    10527    3                KJ$CTX.STATE = %KJ_STATE_RUNNING;

  10527   1 0001CC  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0001CF  5C03                                 LDV,R5   3
          1 0001D0  DF05                                 STR,R5   ,B5
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:141  

      703    10528    3                KJ_LDCTX = KNH$MESS.LDCTX;

  10528   1 0001D1  C846 0001                            LDR,R4   1,B6
          1 0001D3  CF00 0000 0000  xsym                 STR,R4   KJ_LDCTX

      704    10529    3                KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;

  10529   1 0001D6  8A80 0000 0017  xsym                 INC      KJ_STATS+23
          1 0001D9  8E80 0000 0016  xsym                 CAD      KJ_STATS+22

      705    10530    4                CALL KJF$IO (KJ_GH_IO_INTL66) WHENALTRETURN DO;

  10530   1 0001DC  BB80 0000 0000  02                   LAB,B3   0
          1 0001DF  CBF0 0100                            LAB,B4   256,IMO
          1 0001E1  E380 0000 0000  xent                 LNJ,B6   KJF$IO
          1 0001E4       0003                            DC       s:10531,PREL
          1 0001E5  0F81 0008                            B        s:10532,PREL

      706    10531    4                     CALL M$SCREECH ( CPLR_IO ) ;

  10531   1 0001E7  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          1 0001EA  B870 0485                            LDR,R3   1157,IMO
          1 0001EC  0001                                 MCL
          1 0001ED       0000                            DC       s:10531+6,PREL

      707    10532    4                   END;

  10532   1 0001EE  0F81 0109                            B        s:10653,PREL

      708    10533
      709    10534
      710    10535    3             CASE (%KN_FCN_TERM);

      711    10536
      712    10537
      713    10538    3             CASE (%KN_FCN_TERM_ACK);
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:142  

      714    10539    3                KJ$CTX.STATE = %KJ_STATE_MASKED;

  10539   1 0001F0  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0001F3  5C01                                 LDV,R5   1
          1 0001F4  DF05                                 STR,R5   ,B5
          1 0001F5  0F81 0102                            B        s:10653,PREL

      715    10540
      716    10541
      717    10542    3             CASE (%KN_FCN_DATA);

      718    10543
      719    10544    3                IF KJ$CTX.STATE = %KJ_STATE_RUNNING

  10544   1 0001F7  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0001FA  D805                                 LDR,R5   ,B5
          1 0001FB  5D03                                 CMV,R5   3
          1 0001FC  0981 00FB                            BNE      s:10653,PREL

      720    10545    4                THEN DO;

      721    10546    4                     IF KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.RPTR
             10546                              /* Space is from KJ$CTX.ICQ.IPTR to end of CQ */

  10546   1 0001FE  8CC5 000A                            LDI      10,B5
          1 000200  84C5 000D                            SID      13,B5
          1 000202  0681 000C                            BCF      s:10550,PREL

      722    10547    4                     THEN
      723    10548    4                         SIZE = KJ$CTX.ICQ.SIZE - KJ$CTX.ICQ.IPTR - SIZEW(KNH$MESS)/2;

  10548   1 000204  8CC5 0010                            LDI      16,B5
          1 000206  84C5 000A                            SID      10,B5
          1 000208  8470 FFFF FFFC                       AID      -4,IMO
          1 00020B  8D47 0007                            SDI      SIZE,AUTO
          1 00020D  0F81 000A                            B        s:10552,PREL
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:143  

      724    10549    4                     ELSE
      725    10550    4                          SIZE = KJ$CTX.ICQ.RPTR - KJ$CTX.ICQ.IPTR - 1;

  10550   1 00020F  8CC5 000D                            LDI      13,B5
          1 000211  84C5 000A                            SID      10,B5
          1 000213  8470 FFFF FFFF                       AID      -1,IMO
          1 000216  8D47 0007                            SDI      SIZE,AUTO

      726    10551
      727    10552    4                    IF MSGSZ > SIZE AND KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.RPTR AND KJ$CTX.
             10552                              ICQ.RPTR ~= 0 /* Put nop at end */

  10552   1 000218  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 00021A  6C00                                 LDV,R6   0
          1 00021B  84C7 0007                            SID      SIZE,AUTO
          1 00021D  6801 005E                            BLZ,R6   s:10590,PREL
          1 00021F  6A01 0003                            BGZ,R6   s:10552+11,PREL
          1 000221  7901 005A                            BEZ,R7   s:10590,PREL
          1 000223  8CC5 000A                            LDI      10,B5
          1 000225  84C5 000D                            SID      13,B5
          1 000227  0681 0054                            BCF      s:10590,PREL
          1 000229  8CC5 000D                            LDI      13,B5
          1 00022B  84F0 0000 0000                       SID      0,IMO
          1 00022E  6981 0003                            BNEZ,R6  s:10554,PREL
          1 000230  7901 004B                            BEZ,R7   s:10590,PREL

      728    10553    5                     THEN DO;

      729    10554    5                          OP$ = KJ$CTX.IBUF.BUF$;

  10554   1 000232  CCC5 0031                            LDB,B4   49,B5
          1 000234  CFC7 000D                            STB,B4   OP$,AUTO

      730    10555    5                          OP$->KNH$MESS.FUNCTION = %KJ_FCN_NOPI;

  10555   1 000236  8704                                 CL       ,B4
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:144  

      731    10556    5                          OP$->KNH$MESS.FPTSZ = 0;

  10556   1 000237  8744 0006                            CL       6,B4

      732    10557    5                          OP$->KNH$MESS.MSGSZ = SIZE * 4;

  10557   1 000239  8CC7 0007                            LDI      SIZE,AUTO
          1 00023B  7082                                 DOL,R7   2
          1 00023C  E857                                 LDR,R6   R7
          1 00023D  EF44 0007                            STR,R6   7,B4

      733    10558    5                          SIZE = KJ$CTX.ICQ.RPTR - 1;

  10558   1 00023F  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 000242  8CC5 000D                            LDI      13,B5
          1 000244  8470 FFFF FFFF                       AID      -1,IMO
          1 000247  8D47 0007                            SDI      SIZE,AUTO

      734    10559                               %KJ$BLDDCW (OPERATION=DATAL6_L66,
      735    10560                               L6A="POFFW(OP$,G$HAND_Q$)",
      736    10561                              L66A="KJ$CTX.ICQ.IPTR + %KJ_OFFSET_DATA + KJ$CTX.ICQ.OFFSET",
      737    10562                               TALLY="SIZEC(KNH$MESS)");

  10564   1 000249  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          1 00024C  2C00                                 LDV,R2   0
          1 00024D  6C0C                                 LDV,R6   12
          1 00024E  BCC7 0005                            LDB,B3   DCW$,AUTO
          1 000250  3C00                                 LDV,R3   0
          1 000251  0008                                 MMM

  10575   1 000252  ECC7 0005                            LDB,B6   DCW$,AUTO
          1 000254  6C10                                 LDV,R6   16
          1 000255  EF46 0001                            STR,R6   1,B6

  10578   1 000257  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 00025A  8CC5 000A                            LDI      10,B5
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:145  
          1 00025C  8445 0017                            AID      23,B5
          1 00025E  8470 0000 0010                       AID      16,IMO
          1 000261  8D46 0002                            SDI      2,B6

  10581   1 000263  8CC7 000D                            LDI      OP$,AUTO
          1 000265  8480 0000 0000  xsym                 SID      G$HAND_Q$
          1 000268  8D46 0004                            SDI      4,B6

  10583   1 00026A  CBC6 0006                            LAB,B4   6,B6
          1 00026C  CFC7 0005                            STB,B4   DCW$,AUTO

      738    10585    5                          OP$->KNH$MESS.UID = KJ$CTX.ICQ.LSTIPTR;

  10585   1 00026E  8CC5 0013                            LDI      19,B5
          1 000270  ECC7 000D                            LDB,B6   OP$,AUTO
          1 000272  8D46 0002                            SDI      2,B6

      739    10586    5                          KJ$CTX.ICQ.LSTIPTR = KJ$CTX.ICQ.IPTR;

  10586   1 000274  8CC5 000A                            LDI      10,B5
          1 000276  8D45 0013                            SDI      19,B5

      740    10587    5                          KJ$CTX.ICQ.IPTR = 0;

  10587   1 000278  8745 000A                            CL       10,B5
          1 00027A  8745 000B                            CL       11,B5

      741    10588    5                        END;

      742    10589
      743    10590    4                     IF MSGSZ > SIZE       /* No space for message */

  10590   1 00027C  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 00027E  6C00                                 LDV,R6   0
          1 00027F  84C7 0007                            SID      SIZE,AUTO
          1 000281  6801 000D                            BLZ,R6   s:10597,PREL
          1 000283  6A01 0003                            BGZ,R6   s:10592,PREL
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:146  
          1 000285  7901 0009                            BEZ,R7   s:10597,PREL

      744    10591    5                     THEN DO;

      745    10592    5                          SCANSZ=0;

  10592   1 000287  8747 000F                            CL       SCANSZ,AUTO
          1 000289  8747 0010                            CL       SCANSZ+1,AUTO

      746    10593    5                          MSGSZ=0;

  10593   1 00028B  8747 0017                            CL       MSGSZ,AUTO

      747    10594    5                        END;

  10594   1 00028D  0F81 006A                            B        s:10653,PREL

      748    10595
      749    10596    5                     ELSE DO;

      750    10597    5                          KJ_MSGSLINT = KJ_MSGSLINT + 1;

  10597   1 00028F  8A80 0000 0000  xsym                 INC      KJ_MSGSLINT

      751    10598    5                          KJ_STATS.ICQ_MSGS = KJ_STATS.ICQ_MSGS + 1;

  10598   1 000292  8A80 0000 0023  xsym                 INC      KJ_STATS+35
          1 000295  8E80 0000 0022  xsym                 CAD      KJ_STATS+34

      752    10599    5                          KJ_STATS.ICQ_MBC = KJ_STATS.ICQ_MBC + KNH$MESS.MSGSZ;

  10599   1 000298  ECC7 000B                            LDB,B6   IP$,AUTO
          1 00029A  F846 0007                            LDR,R7   7,B6
          1 00029C  6C00                                 LDV,R6   0
          1 00029D  8400 0000 0026  xsym                 AID      KJ_STATS+38
          1 0002A0  8D00 0000 0026  xsym                 SDI      KJ_STATS+38

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:147  
      753    10600
      754    10601                               %KJ$BLDDCW (OPERATION=DATAL6_L66,
      755    10602                              L66A ="KJ$CTX.ICQ.IPTR + %KJ_OFFSET_DATA + KJ$CTX.ICQ.OFFSET"
             10602                                   ,
      756    10603                               L6A = "KJ_OFF_ICQ_DATA + KJ$CTX.ICQ.NEW_RPTR*2",
      757    10604                               MODE=%KJ_MODE_ASCII,
      758    10605                               TALLY="MSGSZ*4");

  10607   1 0002A3  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          1 0002A6  2C00                                 LDV,R2   0
          1 0002A7  6C0C                                 LDV,R6   12
          1 0002A8  BCC7 0005                            LDB,B3   DCW$,AUTO
          1 0002AA  3C00                                 LDV,R3   0
          1 0002AB  0008                                 MMM

  10615   1 0002AC  6C01                                 LDV,R6   1
          1 0002AD  ECC7 0005                            LDB,B6   DCW$,AUTO
          1 0002AF  EA86                                 SRM,R6,'00FF'X    ,B6
          1 0002B0       00FF

  10618   1 0002B1  D847 0017                            LDR,R5   MSGSZ,AUTO
          1 0002B3  5002                                 SOL,R5   2
          1 0002B4  DF46 0001                            STR,R5   1,B6

  10621   1 0002B6  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0002B9  8CC5 000A                            LDI      10,B5
          1 0002BB  8445 0017                            AID      23,B5
          1 0002BD  8470 0000 0010                       AID      16,IMO
          1 0002C0  8D46 0002                            SDI      2,B6

  10624   1 0002C2  8CC5 001D                            LDI      29,B5
          1 0002C4  7081                                 DOL,R7   1
          1 0002C5  8400 0000 0000  xsym                 AID      KJ_OFF_ICQ_DATA
          1 0002C8  8D46 0004                            SDI      4,B6

  10626   1 0002CA  CBC6 0006                            LAB,B4   6,B6
          1 0002CC  CFC7 0005                            STB,B4   DCW$,AUTO
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:148  

      759    10628
      760    10629        /* Set function code so the host understands */
      761    10630        /* If the RECTYPE is non zero it contains the function we want to put in CQ */
      762    10631    5                          IF KNH$MESS.RECTYPE ~= 0

  10631   1 0002CE  ECC7 000B                            LDB,B6   IP$,AUTO
          1 0002D0  E846 0004                            LDR,R6   4,B6
          1 0002D2  6901 0004                            BEZ,R6   s:10635,PREL

      763    10632    5                          THEN
      764    10633    5                               KNH$MESS.FUNCTION = KNH$MESS.RECTYPE;

  10633   1 0002D4  EF06                                 STR,R6   ,B6
          1 0002D5  0F81 0003                            B        s:10636,PREL

      765    10634    5                          ELSE
      766    10635    5                               KNH$MESS.FUNCTION = %KJ_FCN_IDATA;

  10635   1 0002D7  4C05                                 LDV,R4   5
          1 0002D8  CF06                                 STR,R4   ,B6

      767    10636    5                          INPUT = '1'B;
             10636                                   /* This will causes the Host to be interupted */

  10636   1 0002D9  8947 0018                            LBT,'8000'X       INPUT,AUTO
  10636   1 0002DB       8000

      768    10637    5                          KNH$MESS.UID = KJ$CTX.ICQ.LSTIPTR;

  10637   1 0002DC  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          1 0002DF  8CC5 0013                            LDI      19,B5
          1 0002E1  8D46 0002                            SDI      2,B6

      769    10638    5                          KJ$CTX.ICQ.LSTIPTR = KJ$CTX.ICQ.IPTR;

  10638   1 0002E3  8CC5 000A                            LDI      10,B5
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:149  
          1 0002E5  8D45 0013                            SDI      19,B5

      770    10639    5                          KJ$CTX.ICQ.IPTR = KJ$CTX.ICQ.IPTR + MSGSZ;

  10639   1 0002E7  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 0002E9  6C00                                 LDV,R6   0
          1 0002EA  8445 000A                            AID      10,B5
          1 0002EC  8D45 000A                            SDI      10,B5

      771    10640    5                          IF KJ$CTX.ICQ.IPTR >= KJ$CTX.ICQ.SIZE

  10640   1 0002EE  84C5 0010                            SID      16,B5
          1 0002F0  0681 0007                            BCF      s:10653,PREL

      772    10641    5                          THEN
      773    10642    5                               KJ$CTX.ICQ.IPTR = 0;

  10642   1 0002F2  8745 000A                            CL       10,B5
          1 0002F4  8745 000B                            CL       11,B5

      774    10643    5                        END;

      775    10644    4                   END;

  10644   1 0002F6  0F81 0001                            B        s:10653,PREL

      776    10645
      777    10646
      778    10647
      779    10648    3             CASE (%KN_FCN_NOP);

      780    10649
      781    10650
      782    10651    3             END;                          /* End cases */

      783    10652
      784    10653    2             IP$ = PINCRW(IP$,MSGSZ*2);
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:150  

  10653   1 0002F8  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 0002FA  6C00                                 LDV,R6   0
          1 0002FB  7081                                 DOL,R7   1
          1 0002FC  8447 000B                            AID      IP$,AUTO
          1 0002FE  8D47 000B                            SDI      IP$,AUTO

      785    10654    2             KJ$CTX.ICQ.NEW_RPTR = KJ$CTX.ICQ.NEW_RPTR + MSGSZ;

  10654   1 000300  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000303  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 000305  6C00                                 LDV,R6   0
          1 000306  8446 001D                            AID      29,B6
          1 000308  8D46 001D                            SDI      29,B6

      786    10655    2             IF KJ$CTX.ICQ.NEW_RPTR >= KNH$QHDR.RCQ.SZ

  10655   1 00030A  DC80 0000 0000  xsym                 LDB,B5   G$HAND_Q$
          1 00030D  F845 0002                            LDR,R7   2,B5
          1 00030F  6C00                                 LDV,R6   0
          1 000310  84C6 001D                            SID      29,B6
          1 000312  6981 0003                            BNEZ,R6  s:10655+12,PREL
          1 000314  7901 0003                            BEZ,R7   s:10657,PREL
          1 000316  0601 0009                            BCT      s:10661,PREL

      787    10656    3             THEN DO;

      788    10657    3                  KJ$CTX.ICQ.NEW_RPTR = 0;

  10657   1 000318  8746 001D                            CL       29,B6
          1 00031A  8746 001E                            CL       30,B6

      789    10658    3                  IP$ = KJ$CTX.ICQ.BUF$;

  10658   1 00031C  CCC6 0019                            LDB,B4   25,B6
          1 00031E  CFC7 000B                            STB,B4   IP$,AUTO

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:151  
      790    10659    3                END;

      791    10660
      792    10661    2             SCANSZ = SCANSZ - MSGSZ;

  10661   1 000320  F847 0017                            LDR,R7   MSGSZ,AUTO
          1 000322  6C00                                 LDV,R6   0
          1 000323  84C7 000F                            SID      SCANSZ,AUTO
          1 000325  8656                                 CPL      R6
          1 000326  8657                                 CPL      R7
          1 000327  8470 0000 0001                       AID      1,IMO
          1 00032A  8D47 000F                            SDI      SCANSZ,AUTO

      793    10662    2           END;

  10662   1 00032C  8CC7 000F                            LDI      SCANSZ,AUTO
          1 00032E  84F0 0000 0000                       SID      0,IMO
          1 000331  6801 0012                            BLZ,R6   s:10665,PREL
          1 000333  6A01 0003                            BGZ,R6   s:10662+11,PREL
          1 000335  7901 000E                            BEZ,R7   s:10665,PREL
          1 000337  8CC7 0005                            LDI      DCW$,AUTO
          1 000339  8480 0000 0000  xsym                 SID      KJ_CTX$
          1 00033C  8470 FFFF FFC8                       AID      -56,IMO
          1 00033F  84F0 0000 0072                       SID      114,IMO
          1 000342  6801 FE6A                            BLZ,R6   s:10518,PREL

      794    10663
      795    10664        /* Build interupt L66 DCW */
      796    10665    1        IF INPUT AND KJ_MSGSLINT >= KJ_CONTROL.MSG#

  10665   1 000344  89C7 0018                            CMZ      INPUT,AUTO
          1 000346  0881 0009                            BAGE     s:10665+12,PREL
          1 000348  E800 0000 0000  xsym                 LDR,R6   KJ_MSGSLINT
          1 00034B  E900 0000 0005  xsym                 CMR,R6   KJ_CONTROL+5
          1 00034E  0281 0006                            BGE      s:10669,PREL
          1 000350  82C6 0028                            LB,'0080'X        40,B6
          1 000352       0080
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:152  
          1 000353  0581 000A                            BBF      s:10674,PREL

      797    10666    1             OR KJ$CTX.OCQ.FLAGS.QFULL
      798    10667    1        THEN                               /* Input was done */
      799    10668    2        DO;

      800    10669    2             KJ_STATS.USRSTT.OTPINTCNT = KJ_STATS.USRSTT.OTPINTCNT + 1;

  10669   1 000355  8A80 0000 0017  xsym                 INC      KJ_STATS+23
          1 000358  8E80 0000 0016  xsym                 CAD      KJ_STATS+22

      801    10670    2             KJ$CTX.PTR_DCW.OPERATION(5) = %KJ_DCW_INTL66;

  10670   1 00035B  6C3B                                 LDV,R6   59
          1 00035C  E7C6 00CE                            STH,R6   206,B6

      802    10671    2           END;

      803    10672
      804    10673
      805    10674    1        IF DCW$ ~= ADDR(KJ$CTX.PTR_DCW)

  10674   1 00035E  CCC7 0005                            LDB,B4   DCW$,AUTO
          1 000360  BBC6 00B0                            LAB,B3   176,B6
          1 000362  BFC7 001A                            STB,B3   INPUT+2,AUTO
          1 000364  CDC7 001A                            CMB,B4   INPUT+2,AUTO
          1 000366  0901 0009                            BE       s:10678,PREL

      806    10675    1        THEN
      807    10676    1             DCW$->KJ$DCW = KJ_DCW_JUMP;

  10676   1 000368  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_JUMP
          1 00036B  2C00                                 LDV,R2   0
          1 00036C  6C0C                                 LDV,R6   12
          1 00036D  BB84                                 LAB,B3   ,B4
          1 00036E  3C00                                 LDV,R3   0
          1 00036F  0008                                 MMM
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:153  

      808    10677
      809    10678    1        IF KJ$CTX.STATE = %KJ_STATE_RUNNING

  10678   1 000370  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000373  E806                                 LDR,R6   ,B6
          1 000374  6D03                                 CMV,R6   3
          1 000375  0901 0004                            BE       s:10681,PREL
          1 000377  6D02                                 CMV,R6   2
          1 000378  0981 000A                            BNE      s:10685,PREL

      810    10679    1             OR KJ$CTX.STATE = %KJ_STATE_INIT
      811    10680    2        THEN DO;

      812    10681    2             KJ$CTX.CURRENT_FUNCTION = %KJ_CF_DATA;

  10681   1 00037A  5C05                                 LDV,R5   5
          1 00037B  DF46 0001                            STR,R5   1,B6

      813    10682    2             CALL KJF$DCWLIST;

  10682   1 00037D  CBF0 0000                            LAB,B4   0,IMO
          1 00037F  E380 0000 0000  xent                 LNJ,B6   KJF$DCWLIST
          1 000382       0001                            DC       s:10685,PREL

      814    10683    2           END;

      815    10684
      816    10685    1        RETURN;

  10685   1 000383  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      817    10686
      818    10687    1   END KJF$DATA;
      819    10688        %EOD;

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:154  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$DATA.
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:155  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w SBIN(32)    r     1 BFSIZE                     5-0-0/w PTR         r     1 DCW$
    13-0-0/w PTR         r     1 ICQ$                      18-0-0/b BIT         r     1 INPUT
     B-0-0/w PTR         r     1 IP$                       17-0-0/w UBIN(16)    r     1 MSGSZ
    15-0-0/w PTR         r     1 OCQ$                       D-0-0/w PTR         r     1 OP$
     F-0-0/w SBIN(32)    r     1 SCANSZ                     7-0-0/w SBIN(32)    r     1 SIZE
     9-0-0/w SBIN(32)    r     1 SIZE2

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 CPLR_IO                    0-0-0/w PTR         r     1 G$HAND_Q$
     0-0-0/w STRC(160)   r     1 KJ_CONTROL                 0-0-0/w PTR         r     1 KJ_CTX$
     0-0-0/w STRC(96)    r     1 KJ_DCW_DTL66L6             0-0-0/w STRC(96)    r     1 KJ_DCW_DTL6L66
     0-0-0/w STRC(96)    r     1 KJ_DCW_JUMP                0-0-0/w STRC(32)    r     1 KJ_GH_IO_INTL66
     0-0-0/w UBIN(16)    r     1 KJ_LDCTX                   0-0-0/w UBIN(16)    r     1 KJ_MSGSLINT
     0-0-0/w UBIN(32)    r     1 KJ_OFF_ICQ_DATA            0-0-0/w UBIN(32)    r     1 KJ_OFF_IOIP
     0-0-0/w UBIN(32)    r     1 KJ_SCQ_OFFSET              0-0-0/w STRC(864)   r     1 KJ_STATS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3680)  r     1 KJ$CTX                     0-0-0/w STRC(96)    r     1 KJ$DCW
     0-0-0/c STRC(128)   r     1 KNH$MESS                   0-0-0/w STRC(384)   r     1 KNH$QHDR

PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:156  

   Procedure KJF$DATA requires 902 words for executable code.
   Procedure KJF$DATA requires 28 words of local(AUTO) storage.
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:157  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:158  
          MINI XREF LISTING

BFSIZE
     10260**DCL     10388<<ASSIGN  10390>>IF      10399<<ASSIGN  10402<<ASSIGN  10405<<ASSIGN  10407>>IF
     10410<<ASSIGN  10418>>IF      10420<<ASSIGN  10423>>IF      10435>>IF      10437>>ASSIGN  10441>>IF
     10443>>ASSIGN
CPLR_IO
      9788**DCL     10531<>CALL
DCW$
     10254**DCL     10341<<ASSIGN  10352>>ASSIGN  10360>>ASSIGN  10363>>ASSIGN  10366>>ASSIGN  10369>>ASSIGN
     10371<<ASSIGN  10371>>ASSIGN  10455>>ASSIGN  10464>>ASSIGN  10467>>ASSIGN  10470>>ASSIGN  10472<<ASSIGN
     10472>>ASSIGN  10484>>ASSIGN  10493>>ASSIGN  10496>>ASSIGN  10499>>ASSIGN  10501<<ASSIGN  10501>>ASSIGN
     10516>>DOWHILE 10564>>ASSIGN  10575>>ASSIGN  10578>>ASSIGN  10581>>ASSIGN  10583<<ASSIGN  10583>>ASSIGN
     10607>>ASSIGN  10615>>ASSIGN  10618>>ASSIGN  10621>>ASSIGN  10624>>ASSIGN  10626<<ASSIGN  10626>>ASSIGN
     10674>>IF      10676>>ASSIGN
G$HAND_Q$
      9026**DCL     10268--IMP-PTR 10380>>IF      10380>>IF      10382>>ASSIGN  10383>>ASSIGN  10386>>IF
     10386>>IF      10388>>ASSIGN  10388>>ASSIGN  10392>>IF      10394>>ASSIGN  10397>>ASSIGN  10397>>ASSIGN
     10398>>ASSIGN  10399>>ASSIGN  10405>>ASSIGN  10405>>ASSIGN  10470>>ASSIGN  10499>>ASSIGN  10507>>ASSIGN
     10512>>ASSIGN  10581>>ASSIGN  10655>>IF
ICQ$
     10261**DCL     10374<<ASSIGN
INPUT
     10264**DCL     10515<<ASSIGN  10636<<ASSIGN  10665>>IF
IP$
     10257**DCL     10293--IMP-PTR 10394<<ASSIGN  10395>>ASSIGN  10396>>ASSIGN  10397>>ASSIGN  10513<<ASSIGN
     10518>>ASSIGN  10518>>ASSIGN  10520>>DOCASE  10528>>ASSIGN  10599>>ASSIGN  10631>>IF      10633>>ASSIGN
     10633>>ASSIGN  10635>>ASSIGN  10637>>ASSIGN  10653<<ASSIGN  10653>>ASSIGN  10658<<ASSIGN
KJ$CTX.CURRENT_FUNCTION
      9031**DCL     10337>>IF      10681<<ASSIGN
KJ$CTX.DCWS
      9062**DCL     10341--ASSIGN  10516--DOWHILE 10516--DOWHILE
KJ$CTX.FLAGS.BUF_FULL
      9038**DCL     10409<<ASSIGN
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:159  
KJ$CTX.IBUF.BUF$
      9041**DCL     10554>>ASSIGN
KJ$CTX.IBUF.CSIZE
      9041**DCL     10377<<ASSIGN
KJ$CTX.ICQ.BUF$
      9039**DCL     10374>>ASSIGN  10513>>ASSIGN  10658>>ASSIGN
KJ$CTX.ICQ.IPTR
      9038**DCL     10546>>IF      10548>>ASSIGN  10550>>ASSIGN  10552>>IF      10578>>ASSIGN  10586>>ASSIGN
     10587<<ASSIGN  10621>>ASSIGN  10638>>ASSIGN  10639<<ASSIGN  10639>>ASSIGN  10640>>IF      10642<<ASSIGN
KJ$CTX.ICQ.LSTIPTR
      9039**DCL     10585>>ASSIGN  10586<<ASSIGN  10637>>ASSIGN  10638<<ASSIGN
KJ$CTX.ICQ.NEW_RPTR
      9039**DCL     10507>>ASSIGN  10513>>ASSIGN  10624>>ASSIGN  10654<<ASSIGN  10654>>ASSIGN  10655>>IF
     10657<<ASSIGN
KJ$CTX.ICQ.OFFSET
      9039**DCL     10578>>ASSIGN  10621>>ASSIGN
KJ$CTX.ICQ.RPTR
      9038**DCL     10546>>IF      10550>>ASSIGN  10552>>IF      10552>>IF      10558>>ASSIGN
KJ$CTX.ICQ.SIZE
      9039**DCL     10548>>ASSIGN  10640>>IF
KJ$CTX.IOIP.FLAG
      9042**DCL     10345<<ASSIGN
KJ$CTX.OCQ.BUF$
      9041**DCL     10375>>ASSIGN  10394>>ASSIGN
KJ$CTX.OCQ.FLAGS.QFULL
      9040**DCL     10665>>IF
KJ$CTX.OCQ.IPTR
      9040**DCL     10414>>ASSIGN  10431>>ASSIGN
KJ$CTX.OCQ.RDSIZE
      9041**DCL     10413<<ASSIGN  10445<<ASSIGN
KJ$CTX.OCQ.RPTR
      9040**DCL     10414>>ASSIGN  10430>>ASSIGN  10467>>ASSIGN
KJ$CTX.OCQ.SIZE
      9040**DCL     10430>>ASSIGN
KJ$CTX.PTR_DCW
      9102**DCL     10674--IF
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:160  
KJ$CTX.PTR_DCW.OPERATION
      9108**DCL     10670<<ASSIGN
KJ$CTX.STATE
      9026**DCL     10527<<ASSIGN  10539<<ASSIGN  10544>>IF      10678>>IF      10678>>IF
KJ$DCW
      8901**DCL     10352<<ASSIGN  10371--ASSIGN  10455<<ASSIGN  10472--ASSIGN  10484<<ASSIGN  10501--ASSIGN
     10516--DOWHILE 10564<<ASSIGN  10583--ASSIGN  10607<<ASSIGN  10626--ASSIGN  10676<<ASSIGN
KJ$DCW.L66A
      8924**DCL     10366<<ASSIGN  10467<<ASSIGN  10496<<ASSIGN  10578<<ASSIGN  10621<<ASSIGN
KJ$DCW.L6A
      8925**DCL     10369<<ASSIGN  10470<<ASSIGN  10499<<ASSIGN  10581<<ASSIGN  10624<<ASSIGN
KJ$DCW.MODE
      8917**DCL     10360<<ASSIGN  10615<<ASSIGN
KJ$DCW.TALLY
      8922**DCL     10363<<ASSIGN  10464<<ASSIGN  10493<<ASSIGN  10575<<ASSIGN  10618<<ASSIGN
KJF$DCWLIST
     10331**DCL-ENT 10682--CALL
KJF$IO
     10332**DCL-ENT 10530--CALL
KJ_CONTROL.MSG#
      9127**DCL     10665>>IF
KJ_CONTROL.OCQDBLKSIZ
      9128**DCL     10418>>IF      10418>>IF      10420>>ASSIGN
KJ_CTX$
      9026**DCL      9026--IMP-PTR 10337>>IF      10341>>ASSIGN  10345>>ASSIGN  10374>>ASSIGN  10375>>ASSIGN
     10377>>ASSIGN  10394>>ASSIGN  10409>>ASSIGN  10413>>ASSIGN  10414>>ASSIGN  10414>>ASSIGN  10430>>ASSIGN
     10430>>ASSIGN  10431>>ASSIGN  10445>>ASSIGN  10467>>ASSIGN  10507>>ASSIGN  10513>>ASSIGN  10513>>ASSIGN
     10516>>DOWHILE 10527>>ASSIGN  10539>>ASSIGN  10544>>IF      10546>>IF      10546>>IF      10548>>ASSIGN
     10548>>ASSIGN  10550>>ASSIGN  10550>>ASSIGN  10552>>IF      10552>>IF      10552>>IF      10554>>ASSIGN
     10558>>ASSIGN  10578>>ASSIGN  10578>>ASSIGN  10585>>ASSIGN  10586>>ASSIGN  10586>>ASSIGN  10587>>ASSIGN
     10621>>ASSIGN  10621>>ASSIGN  10624>>ASSIGN  10637>>ASSIGN  10638>>ASSIGN  10638>>ASSIGN  10639>>ASSIGN
     10639>>ASSIGN  10640>>IF      10640>>IF      10642>>ASSIGN  10654>>ASSIGN  10654>>ASSIGN  10655>>IF
     10657>>ASSIGN  10658>>ASSIGN  10665>>IF      10670>>ASSIGN  10674>>IF      10678>>IF      10678>>IF
     10681>>ASSIGN
KJ_DCW_DTL66L6
      8781**DCL     10455>>ASSIGN  10484>>ASSIGN
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:161  
KJ_DCW_DTL6L66
      8821**DCL     10352>>ASSIGN  10564>>ASSIGN  10607>>ASSIGN
KJ_DCW_JUMP
      8861**DCL     10676>>ASSIGN
KJ_GH_IO_INIT.CAS.CHN
      9740**DCL      9740--REDEF
KJ_GH_IO_INIT.DAS
      9741**DCL      9742--REDEF    9743--REDEF
KJ_GH_IO_INTL66
      9756**DCL     10530<>CALL
KJ_GH_IO_INTL66.CAS.CHN
      9756**DCL      9756--REDEF
KJ_GH_IO_INTL66.DAS
      9757**DCL      9758--REDEF    9759--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9583**DCL      9584--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9584**DCL      9584--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9572**DCL      9581--REDEF
KJ_INIT_MSG.FUNCTION
      9497**DCL      9497--REDEF
KJ_INIT_MSG.UID
      9527**DCL      9527--REDEF    9527--REDEF
KJ_IOLD_BARR.CHN
      9710**DCL      9710--REDEF
KJ_IOLD_DCWLIST.CHN
      9725**DCL      9725--REDEF
KJ_LDCTX
      9126**DCL     10528<<ASSIGN
KJ_MSGSLINT
      9126**DCL     10597<<ASSIGN  10597>>ASSIGN  10665>>IF
KJ_OFF_ICQ_DATA
      9123**DCL     10624>>ASSIGN
KJ_OFF_IOIP
      9124**DCL     10369>>ASSIGN
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:162  
KJ_SCQ_OFFSET
      9125**DCL     10470>>ASSIGN  10499>>ASSIGN
KJ_STATS.ICQ_MBC
      9466**DCL     10599<<ASSIGN  10599>>ASSIGN
KJ_STATS.ICQ_MSGS
      9464**DCL     10598<<ASSIGN  10598>>ASSIGN
KJ_STATS.REQSTATS.DSPMSK
      9389**DCL      9395--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9430**DCL      9437--REDEF
KJ_STATS.USRSTT.OTPINTCNT
      9459**DCL     10529<<ASSIGN  10529>>ASSIGN  10669<<ASSIGN  10669>>ASSIGN
KJ_TERM_MSG.FUNCTION
      9615**DCL      9615--REDEF
KJ_TERM_MSG.UID
      9645**DCL      9645--REDEF    9645--REDEF
KNH$MESS
     10293**DCL     10388--ASSIGN  10390--IF      10397--ASSIGN  10407--IF      10518--ASSIGN  10548--ASSIGN
     10575--ASSIGN
KNH$MESS.FPTSZ
     10326**DCL     10396<<ASSIGN  10518>>ASSIGN  10556<<ASSIGN
KNH$MESS.FUNCTION
     10293**DCL     10293--REDEF   10395<<ASSIGN  10520>>DOCASE  10555<<ASSIGN  10633<<ASSIGN  10635<<ASSIGN
KNH$MESS.LDCTX
     10298**DCL     10528>>ASSIGN
KNH$MESS.MSGSZ
     10327**DCL     10397<<ASSIGN  10518>>ASSIGN  10557<<ASSIGN  10599>>ASSIGN
KNH$MESS.RECTYPE
     10326**DCL     10631>>IF      10633>>ASSIGN
KNH$MESS.UID
     10323**DCL     10323--REDEF   10323--REDEF   10585<<ASSIGN  10637<<ASSIGN
KNH$QHDR.RCQ
     10268**DCL     10268--REDEF
KNH$QHDR.RCQ.IPTR
     10268**DCL     10507>>ASSIGN
KNH$QHDR.RCQ.SZ
PL6.E3A0      #003=KJF$DATA File=KJF$FEI.:E05TSI                                 WED 07/30/97 00:47 Page:163  
     10268**DCL     10512>>ASSIGN  10655>>IF
KNH$QHDR.SCQ.IPTR
     10269**DCL     10380>>IF      10382<<ASSIGN  10386>>IF      10388>>ASSIGN  10394>>ASSIGN  10397>>ASSIGN
     10398<<ASSIGN  10405>>ASSIGN  10470>>ASSIGN  10499>>ASSIGN
KNH$QHDR.SCQ.RPTR
     10269**DCL     10380>>IF      10383<<ASSIGN  10386>>IF      10392>>IF      10399>>ASSIGN  10405>>ASSIGN
KNH$QHDR.SCQ.SZ
     10269**DCL     10388>>ASSIGN  10397>>ASSIGN
M$SCREECH
      4283**DCL-ENT 10531--CALL
MSGSZ
     10263**DCL     10518<<ASSIGN  10552>>IF      10590>>IF      10593<<ASSIGN  10618>>ASSIGN  10639>>ASSIGN
     10653>>ASSIGN  10654>>ASSIGN  10661>>ASSIGN
OCQ$
     10262**DCL     10375<<ASSIGN
OP$
     10258**DCL     10554<<ASSIGN  10555>>ASSIGN  10556>>ASSIGN  10557>>ASSIGN  10581>>ASSIGN  10585>>ASSIGN
SCANSZ
     10259**DCL     10507<<ASSIGN  10510>>IF      10512<<ASSIGN  10512>>ASSIGN  10516>>DOWHILE 10592<<ASSIGN
     10661<<ASSIGN  10661>>ASSIGN
SIZE
     10255**DCL     10414<<ASSIGN  10423>>IF      10428>>IF      10430<<ASSIGN  10435>>IF      10437<<ASSIGN
     10441>>IF      10443>>ASSIGN  10445>>ASSIGN  10464>>ASSIGN  10499>>ASSIGN  10548<<ASSIGN  10550<<ASSIGN
     10552>>IF      10557>>ASSIGN  10558<<ASSIGN  10590>>IF
SIZE2
     10256**DCL     10431<<ASSIGN  10434<<ASSIGN  10438<<ASSIGN  10441>>IF      10443<<ASSIGN  10445>>ASSIGN
     10475>>IF      10493>>ASSIGN

PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:164  
      820        1        /*T***********************************************************/
      821        2        /*T*                                                         */
      822        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      823        4        /*T*                                                         */
      824        5        /*T***********************************************************/
      825        6        KJF$GETSTATUS: PROC ALTRET;
      826        7
      827        8        %INCLUDE KJ_DATA_R;
      828    10249
      829    10250        /* Entry refereneces */
      830    10251    1   DCL KJF$IO_IN ENTRY(1) ALTRET;
      831    10252
      832    10253        /* Local variables */
      833    10254        %GH_IO(STCLASS="");
      834    10270
      835    10271    1        GH_IO = KJ_GH_IO_INIT;
      836    10272    1        GH_IO.CAS.CHN = KJ$CTX.CHAN0;
      837    10273    1        GH_IO.CAS.FNC = %KJ_IO_RDSTATUS1;
      838    10274    2        CALL KJF$IO_IN (GH_IO) WHENALTRETURN DO;
      839    10275    2             ALTRETURN;
      840    10276    2           END;
      841    10277    1        KJ$CTX.STATUS1 = GH_IO.STATUS;
      842    10278    1        GH_IO.CAS.FNC = %KJ_IO_RDSTATUS2;
      843    10279
      844    10280    2        CALL KJF$IO_IN (GH_IO) WHENALTRETURN DO;
      845    10281    2             ALTRETURN;
      846    10282    2           END;
      847    10283    1        KJ$CTX.STATUS2 = GH_IO.STATUS;
      848    10284
      849    10285    1        RETURN;
      850    10286
      851    10287    1   END KJF$GETSTATUS;
      852    10288        %EOD;

PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:165  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$GETSTATUS.

   Procedure KJF$GETSTATUS requires 78 words for executable code.
   Procedure KJF$GETSTATUS requires 8 words of local(AUTO) storage.

PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:166  

 Object Unit name= KJF$GETSTATUS                              File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:48:53.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Proc  even  none    78     4E  KJF$GETSTATUS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  KJF$GETSTATUS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KJF$IO_IN
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_AALT
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                                  KJ_CTX$                          r    KJ_GH_IO_INIT
r    G$ROS$
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:167  


      820        1        /*T***********************************************************/
      821        2        /*T*                                                         */
      822        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      823        4        /*T*                                                         */
      824        5        /*T***********************************************************/
      825        6        KJF$GETSTATUS: PROC ALTRET;

      6   1 000000  D380 0000 0000  xent KJF$GETSTATUS   LNJ,B5   X6A_AUTO_0
          1 000003       0008 0000                       DC       8,0

      826        7
      827        8        %INCLUDE KJ_DATA_R;
      828    10249
      829    10250        /* Entry refereneces */
      830    10251    1   DCL KJF$IO_IN ENTRY(1) ALTRET;
      831    10252
      832    10253        /* Local variables */
      833    10254        %GH_IO(STCLASS="");
      834    10270
      835    10271    1        GH_IO = KJ_GH_IO_INIT;

  10271   1 000005  8C80 0000 0000  xsym                 LDI      KJ_GH_IO_INIT
          1 000008  8D47 0004                            SDI      GH_IO,AUTO

      836    10272    1        GH_IO.CAS.CHN = KJ$CTX.CHAN0;

  10272   1 00000A  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 00000D  D846 0002                            LDR,R5   2,B6
          1 00000F  5006                                 SOL,R5   6
          1 000010  DAC7 0004                            SRM,R5,'FFC0'X    GH_IO,AUTO
          1 000012       FFC0

      837    10273    1        GH_IO.CAS.FNC = %KJ_IO_RDSTATUS1;

  10273   1 000013  5C18                                 LDV,R5   24
          1 000014  DAC7 0004                            SRM,R5,'003F'X    GH_IO,AUTO
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:168  
          1 000016       003F

      838    10274    2        CALL KJF$IO_IN (GH_IO) WHENALTRETURN DO;

  10274   1 000017  DBC7 0004                            LAB,B5   GH_IO,AUTO
          1 000019  DFC7 0006                            STB,B5   GH_IO+2,AUTO
          1 00001B  BBC7 0006                            LAB,B3   GH_IO+2,AUTO
          1 00001D  CBF0 0100                            LAB,B4   256,IMO
          1 00001F  E380 0000 0000  xent                 LNJ,B6   KJF$IO_IN
          1 000022       0003                            DC       s:10275,PREL
          1 000023  0F81 0004                            B        s:10277,PREL

      839    10275    2             ALTRETURN;

  10275   1 000025  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      840    10276    2           END;
      841    10277    1        KJ$CTX.STATUS1 = GH_IO.STATUS;

  10277   1 000028  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 00002B  E847 0005                            LDR,R6   GH_IO+1,AUTO
          1 00002D  EF46 0005                            STR,R6   5,B6

      842    10278    1        GH_IO.CAS.FNC = %KJ_IO_RDSTATUS2;

  10278   1 00002F  5C1A                                 LDV,R5   26
          1 000030  DAC7 0004                            SRM,R5,'003F'X    GH_IO,AUTO
          1 000032       003F

      843    10279
      844    10280    2        CALL KJF$IO_IN (GH_IO) WHENALTRETURN DO;

  10280   1 000033  DBC7 0004                            LAB,B5   GH_IO,AUTO
          1 000035  DFC7 0006                            STB,B5   GH_IO+2,AUTO
          1 000037  BBC7 0006                            LAB,B3   GH_IO+2,AUTO
          1 000039  CBF0 0100                            LAB,B4   256,IMO
          1 00003B  E380 0000 0000  xent                 LNJ,B6   KJF$IO_IN
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:169  
          1 00003E       0003                            DC       s:10281,PREL
          1 00003F  0F81 0004                            B        s:10283,PREL

      845    10281    2             ALTRETURN;

  10281   1 000041  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      846    10282    2           END;
      847    10283    1        KJ$CTX.STATUS2 = GH_IO.STATUS;

  10283   1 000044  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000047  E847 0005                            LDR,R6   GH_IO+1,AUTO
          1 000049  EF46 0006                            STR,R6   6,B6

      848    10284
      849    10285    1        RETURN;

  10285   1 00004B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      850    10286
      851    10287    1   END KJF$GETSTATUS;
      852    10288        %EOD;

PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:170  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$GETSTATUS.
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:171  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w STRC(32)    r     1 GH_IO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KJ_CTX$                    0-0-0/w STRC(32)    r     1 KJ_GH_IO_INIT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3680)  r     1 KJ$CTX


   Procedure KJF$GETSTATUS requires 78 words for executable code.
   Procedure KJF$GETSTATUS requires 8 words of local(AUTO) storage.
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:172  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:173  
          MINI XREF LISTING

GH_IO
     10265**DCL     10271<<ASSIGN  10274<>CALL    10280<>CALL
GH_IO.CAS.CHN
     10265**DCL     10265--REDEF   10272<<ASSIGN
GH_IO.CAS.FNC
     10266**DCL     10273<<ASSIGN  10278<<ASSIGN
GH_IO.DAS
     10266**DCL     10267--REDEF   10268--REDEF
GH_IO.STATUS
     10268**DCL     10277>>ASSIGN  10283>>ASSIGN
KJ$CTX.CHAN0
      9037**DCL     10272>>ASSIGN
KJ$CTX.STATUS1
      9037**DCL     10277<<ASSIGN
KJ$CTX.STATUS2
      9037**DCL     10283<<ASSIGN
KJF$IO_IN
     10251**DCL-ENT 10274--CALL    10280--CALL
KJ_CTX$
      9026**DCL      9026--IMP-PTR 10272>>ASSIGN  10277>>ASSIGN  10283>>ASSIGN
KJ_GH_IO_INIT
      9740**DCL     10271>>ASSIGN
KJ_GH_IO_INIT.CAS.CHN
      9740**DCL      9740--REDEF
KJ_GH_IO_INIT.DAS
      9741**DCL      9742--REDEF    9743--REDEF
KJ_GH_IO_INTL66.CAS.CHN
      9756**DCL      9756--REDEF
KJ_GH_IO_INTL66.DAS
      9757**DCL      9758--REDEF    9759--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9583**DCL      9584--REDEF
PL6.E3A0      #004=KJF$GETSTATUS File=KJF$FEI.:E05TSI                            WED 07/30/97 00:48 Page:174  
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9584**DCL      9584--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9572**DCL      9581--REDEF
KJ_INIT_MSG.FUNCTION
      9497**DCL      9497--REDEF
KJ_INIT_MSG.UID
      9527**DCL      9527--REDEF    9527--REDEF
KJ_IOLD_BARR.CHN
      9710**DCL      9710--REDEF
KJ_IOLD_DCWLIST.CHN
      9725**DCL      9725--REDEF
KJ_STATS.REQSTATS.DSPMSK
      9389**DCL      9395--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9430**DCL      9437--REDEF
KJ_TERM_MSG.FUNCTION
      9615**DCL      9615--REDEF
KJ_TERM_MSG.UID
      9645**DCL      9645--REDEF    9645--REDEF

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:175  
      853        1        /*T***********************************************************/
      854        2        /*T*                                                         */
      855        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      856        4        /*T*                                                         */
      857        5        /*T***********************************************************/
      858        6        KJF$FIX: PROC (STATUS1,STATUS2) ALTRET;
      859        7
      860        8        /* Include files */
      861        9        %INCLUDE KJ_DATA_R;
      862    10250
      863    10251        /* Parameters */
      864    10252        %KJ$STATUS1 (NAME=STATUS1,STCLASS="");
      865    10271        %KJ$STATUS2 (NAME=STATUS2,STCLASS="");
      866    10285
      867    10286    1   DCL HARDWARE_STATUS1 BIT(16) CONSTANT INIT(%(%KJ_STATUS_CSP |
      868    10287                                                     %KJ_STATUS_CSR |
      869    10288                                                     %KJ_STATUS_CSW |
      870    10289                                                     %KJ_STATUS_L6B |
      871    10290                                                     %KJ_STATUS_NER |
      872    10291    1                                                %KJ_STATUS_MR));
      873    10292    1   DCL HARDWARE_STATUS2 BIT(16) CONSTANT INIT('0'B);
      874    10293    1   DCL SOFTWARE_STATUS1 BIT(16) CONSTANT INIT('0'B);
      875    10294    1   DCL SOFTWARE_STATUS2 BIT(16) CONSTANT INIT(%(%KJ_STATUS2_BV |
      876    10295                                                     %KJ_STATUS2_CWE |
      877    10296                                                     %KJ_STATUS2_IFC |
      878    10297                                                     %KJ_STATUS2_IDCW |
      879    10298    1                                                %KJ_STATUS2_IPCW));
      880    10299
      881    10300        /* Entry point references */
      882    10301    1   DCL KJF$DCWLIST ENTRY;
      883    10302    1   DCL KJF$DATA ENTRY;
      884    10303    1   DCL KJF$GETSTATUS ENTRY ALTRET;
      885    10304    1   DCL KJF$IO_IN ENTRY(1) ALTRET;
      886    10305
      887    10306        /* Auto */
      888    10307    1   DCL DCW$ PTR;
      889    10308        %GH_IO;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:176  
      890    10324
      891    10325        /* Based structures */
      892    10326        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      893    10339
      894    10340        /* VLPs */
      895    10341        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:177  
      896    10342        /* Check to see if there was some hardware fault */
      897    10343
      898    10344    1        IF STATUS1 & HARDWARE_STATUS1 OR
      899    10345    1             STATUS2 & HARDWARE_STATUS2
      900    10346    2        THEN DO;
      901    10347                  /*N* Record the error */
      902    10348    2             IF STATUS1.ATT                /* list was in process */
      903    10349    2             THEN
      904    10350    3                  CALL RETRY WHENALTRETURN DO; /* Retry the list */
      905    10351    3                       ALTRETURN;
      906    10352    3                     END;
      907    10353    2             RETURN;
      908    10354    2           END;
      909    10355    1        IF STATUS1 & SOFTWARE_STATUS1 OR
      910    10356    1             STATUS2 & SOFTWARE_STATUS2
      911    10357    2        THEN DO;
      912    10358                  /*N* Probably should record the error, dump the handler,
      913    10359                       and LDTRC to itself again */
      914    10360    2             CALL M$SCREECH ( CPLR_IO ) ;
      915    10361    2           END;
      916    10362    1        IF STATUS1.TT AND KJ$CTX.STATE ~= %KJ_STATE_RUNNING /* The coupler is masked */
      917    10363    1        THEN
      918    10364    1             RETURN;
      919    10365    1        IF STATUS1.CNOP                    /* Central not operational */
      920    10366    1        THEN
      921    10367    1             CALL RECOVERY;
      922    10368
      923    10369
      924    10370    1        IF STATUS1.MY                      /* Memory yellow */
      925    10371    2        THEN DO;
      926    10372                  /*N* Log the error */
      927    10373    2           END;
      928    10374
      929    10375    2        DO CASE (STATUS2.IL6PARM);
      930    10376
      931    10377    2        CASE ( %KJ_IPARM_CNOP ) ;
      932    10378    2           CALL RECOVERY ;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:178  
      933    10379
      934    10380    2        CASE(%KJ_IPARM_SCR);
      935    10381    2           CALL M$SCREECH(HOSTABRT);
      936    10382                 /*S* SCREECH_CODE: KJF-S$HOST_REQUEST
      937    10383                      TYPE: SCREECH
      938    10384                      MESSAGE: Host requested Screech
      939    10385                      REMARKS: The host reqested a screech
      940    10386         */
      941    10387
      942    10388    2        CASE(%KJ_IPARM_TO);
      943    10389    2           CALL M$SCREECH(HOSTTO);
      944    10390                 /*S* SCREECH_CODE: KJF-S$HOST_TO
      945    10391                      TYPE: SCREECH
      946    10392                      MESSAGE: Host timed out the fep.
      947    10393                      REMARKS: The host did not get a time response or
      948    10394                               the OCQ stayed full to long.
      949    10395         */
      950    10396
      951    10397    2        CASE(%KJ_IPARM_BADMSG);
      952    10398    2           CALL M$SCREECH(HOSTBADMSG);
      953    10399                 /*S* SCREECH_CODE: KJF-S$HOST_BADMSG
      954    10400                      TYPE: SCREECH
      955    10401                      MESSAGE: Host found bad message in ICQ.
      956    10402                      REMARKS: The host found a message with invalid structure
      957    10403                               in the ICQ>
      958    10404         */
      959    10405
      960    10406    2        CASE(%KJ_IPARM_FLT);
      961    10407    2           CALL M$SCREECH(HOSTFLT);
      962    10408                 /*S* SCREECH_CODE: KJF-S$HOST_FEPFLT
      963    10409                      TYPE: SCREECH
      964    10410                      MESSAGE: IOM detect a fault on the direct channel
      965    10411                      REMARKS: The IOM detect a fault on the direct channel
      966    10412                               for this fep.
      967    10413         */
      968    10414
      969    10415    2        CASE(%KJ_IPARM_OREQ);
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:179  
      970    10416    2           CALL M$SCREECH(HOSTOREQ);
      971    10417                 /*S* SCREECH_CODE: KJF-S$HOST_OREQ
      972    10418                      TYPE: SCREECH
      973    10419                      MESSAGE: The operator or user request this fep to crash
      974    10420                      REMARKS: Some user on the host request this fep to crash
      975    10421                               and create a dump.
      976    10422         */
      977    10423
      978    10424    2        CASE (%KJ_IPARM_OCQ);
      979    10425    2           IF KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE
      980    10426    2           THEN
      981    10427    2                CALL KJF$DATA;
      982    10428
      983    10429    2        CASE (%KJ_IPARM_INIT);
      984    10430
      985    10431    2           CALL RECOVERY;
      986    10432    2           DCW$ = ADDR(KJ$CTX.DCWS);
      987    10433
      988    10434                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      989    10435                L66A=%KJ_OFFSET_SIZE,
      990    10436                L6A="POFFW(ADDR(KJ$CTX.OCQ.SIZE),G$HAND_Q$)",
      991    10437                MODE=%KJ_MODE_BIN,
      992    10438                TALLY=1);
      993    10461                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      994    10462                L66A=%KJ_OFFSET_NODE,
      995    10463                L6A="POFFW(ADDR(KJ$CTX.HOST_NODE),G$HAND_Q$)",
      996    10464                TALLY=4);
      997    10487
      998    10488                %KJ$BLDDCW (OPERATION=DISCONNECTINT);
      999    10511
     1000    10512    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_ROCQSIZE;
     1001    10513        /* Do the IO and the interupt will trigger us to go further */
     1002    10514    2           CALL KJF$DCWLIST;
     1003    10515
     1004    10516    2           KJ$CTX.STATE = %KJ_STATE_INIT;
     1005    10517    2        END;                               /* End cases */
     1006    10518
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:180  
     1007    10519    1        IF STATUS1.ATT                     /* The list was aborted */
     1008    10520    1        THEN
     1009    10521    2             CALL RETRY WHENALTRETURN DO;  /* Retry the list */
     1010    10522    2                  ALTRETURN;
     1011    10523    2                END;
     1012    10524
     1013    10525    1        RETURN;
     1014    10526        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:181  
     1015    10527    1   RETRY: PROC ALTRET;
     1016    10528    2        IF KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE
     1017    10529    2        THEN
     1018    10530    2             RETURN;
     1019    10531
     1020    10532    2        KJ_STATS.DCW_ABRT  = KJ_STATS.DCW_ABRT + 1;
     1021    10533
     1022    10534        /* Get DCW offset */
     1023    10535    2        GH_IO = KJ_GH_IO_INIT;
     1024    10536    2        GH_IO.CAS.CHN = KJ$CTX.CHAN0;
     1025    10537    2        GH_IO.CAS.FNC = %KJ_IO_RDDCWOFF;
     1026    10538    2        CALL KJF$IO_IN(GH_IO);
     1027    10539
     1028    10540        /* If we are past the data transfer portion of the list build a
     1029    10541             jump to the pointer portion */
     1030    10542    2        IF GH_IO.RANGE >= POFFW(ADDR(KJ$CTX.PTR_DCW),ADDR(KJ$CTX.DCWS))
     1031    10543    2        THEN
     1032    10544    2             KJ$CTX.DCWS(0) = KJ_DCW_JUMP;
     1033    10545
     1034    10546    2        ALTRETURN;
     1035    10547
     1036    10548    2   END RETRY;
     1037    10549
     1038    10550        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:182  
     1039    10551    1   RECOVERY: PROC ;
     1040    10552
     1041    10553    2        IF KJ$CTX.STATE ~= %KJ_STATE_RUNNING
     1042    10554    2        THEN
     1043    10555    2             RETURN;
     1044    10556
     1045    10557    2        KJ_TERM_MSG.LDCTX = KJ_LDCTX;
     1046    10558    2        CALL M$WRITE (KJ_WRT_TERM);
     1047    10559    2        KNH$QHDR.SCQ.IPTR=0;
     1048    10560    2        KNH$QHDR.SCQ.RPTR=0;
     1049    10561    2        KJ$CTX.ICQ.IPTR=0;
     1050    10562    2        KJ$CTX.ICQ.RPTR=0;
     1051    10563    2        KJ$CTX.OCQ.IPTR=0;
     1052    10564    2        KJ$CTX.OCQ.RPTR=0;
     1053    10565    2        KJ$CTX.STATE = %KJ_STATE_RECOVERY;
     1054    10566    2        KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;
     1055    10567    2        RETURN;
     1056    10568
     1057    10569    2   END RECOVERY;
     1058    10570
     1059    10571    1   END KJF$FIX;
     1060    10572        %EOD;

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:183  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$FIX.

   Procedure KJF$FIX requires 452 words for executable code.
   Procedure KJF$FIX requires 16 words of local(AUTO) storage.

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:184  

 Object Unit name= KJF$FIX                                    File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:49:32.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1  RoData even  UTS      4      4  KJF$FIX
    2   Data  even  none     2      2  KJF$FIX
    3   Proc  even  none   452    1C4  KJF$FIX
    4  RoData even  none     2      2  KJF$FIX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  KJF$FIX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 KJF$DATA
         yes           Std       0 KJF$DCWLIST
 yes     yes           Std       1 KJF$IO_IN
                       nStd      0 X6A_AUTO_2
                       nStd      0 X6A_AALT
                       nStd      0 X6A_ARET
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:185  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                             r    KJ_DCW_DTL66L6                   r    KJ_DCW_DTL6L66
     KJ_DCW_JUMP                           G$HAND_Q$                             KJ_CTX$
     KJ_LDCTX                              KJ_STATS                              KJ_TERM_MSG
r    KJ_WRT_TERM                      r    KJ_GH_IO_INIT                    r    CPLR_IO
r    HOSTABRT                         r    HOSTTO                           r    HOSTFLT
r    HOSTOREQ                         r    HOSTBADMSG                       r    G$ROS$
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:186  


      853        1        /*T***********************************************************/
      854        2        /*T*                                                         */
      855        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      856        4        /*T*                                                         */
      857        5        /*T***********************************************************/
      858        6        KJF$FIX: PROC (STATUS1,STATUS2) ALTRET;

      6   3 000000  D380 0000 0000  xent KJF$FIX         LNJ,B5   X6A_AUTO_2
          3 000003       0010 0002                       DC       16,2

      859        7
      860        8        /* Include files */
      861        9        %INCLUDE KJ_DATA_R;
      862    10250
      863    10251        /* Parameters */
      864    10252        %KJ$STATUS1 (NAME=STATUS1,STCLASS="");
      865    10271        %KJ$STATUS2 (NAME=STATUS2,STCLASS="");
      866    10285
      867    10286    1   DCL HARDWARE_STATUS1 BIT(16) CONSTANT INIT(%(%KJ_STATUS_CSP |
      868    10287                                                     %KJ_STATUS_CSR |
      869    10288                                                     %KJ_STATUS_CSW |
      870    10289                                                     %KJ_STATUS_L6B |
      871    10290                                                     %KJ_STATUS_NER |
      872    10291    1                                                %KJ_STATUS_MR));
      873    10292    1   DCL HARDWARE_STATUS2 BIT(16) CONSTANT INIT('0'B);
      874    10293    1   DCL SOFTWARE_STATUS1 BIT(16) CONSTANT INIT('0'B);
      875    10294    1   DCL SOFTWARE_STATUS2 BIT(16) CONSTANT INIT(%(%KJ_STATUS2_BV |
      876    10295                                                     %KJ_STATUS2_CWE |
      877    10296                                                     %KJ_STATUS2_IFC |
      878    10297                                                     %KJ_STATUS2_IDCW |
      879    10298    1                                                %KJ_STATUS2_IPCW));
      880    10299
      881    10300        /* Entry point references */
      882    10301    1   DCL KJF$DCWLIST ENTRY;
      883    10302    1   DCL KJF$DATA ENTRY;
      884    10303    1   DCL KJF$GETSTATUS ENTRY ALTRET;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:187  
      885    10304    1   DCL KJF$IO_IN ENTRY(1) ALTRET;
      886    10305
      887    10306        /* Auto */
      888    10307    1   DCL DCW$ PTR;
      889    10308        %GH_IO;
      890    10324
      891    10325        /* Based structures */
      892    10326        %KNH$QHDR (STCLASS="BASED(G$HAND_Q$)");
      893    10339
      894    10340        /* VLPs */
      895    10341        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:188  
      896    10342        /* Check to see if there was some hardware fault */
      897    10343
      898    10344    1        IF STATUS1 & HARDWARE_STATUS1 OR

  10344   3 000005  ECC7 0004                            LDB,B6   @STATUS1,AUTO
          3 000007  E806                                 LDR,R6   ,B6
          3 000008  E500 0000 0000  01                   AND,R6   HARDWARE_STATUS1
          3 00000B  6981 0009                            BNEZ,R6  s:10348,PREL
          3 00000D  DCC7 0006                            LDB,B5   @STATUS2,AUTO
          3 00000F  E805                                 LDR,R6   ,B5
          3 000010  E500 0000 0001  01                   AND,R6   HARDWARE_STATUS2
          3 000013  6901 0010                            BEZ,R6   s:10355,PREL

      899    10345    1             STATUS2 & HARDWARE_STATUS2
      900    10346    2        THEN DO;

      901    10347                  /*N* Record the error */
      902    10348    2             IF STATUS1.ATT                /* list was in process */

  10348   3 000015  8286                                 LB,'4000'X        ,B6
  10348   3 000016       4000
          3 000017  0581 0009                            BBF      s:10353,PREL

      903    10349    2             THEN
      904    10350    3                  CALL RETRY WHENALTRETURN DO; /* Retry the list */

  10350   3 000019  E3C0 0114                            LNJ,B6   s:0,PREL
          3 00001B       0003                            DC       s:10351,PREL
          3 00001C  0F81 0004                            B        s:10353,PREL

      905    10351    3                       ALTRETURN;

  10351   3 00001E  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      906    10352    3                     END;
      907    10353    2             RETURN;

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:189  
  10353   3 000021  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      908    10354    2           END;
      909    10355    1        IF STATUS1 & SOFTWARE_STATUS1 OR

  10355   3 000024  E806                                 LDR,R6   ,B6
          3 000025  E500 0000 0002  01                   AND,R6   SOFTWARE_STATUS1
          3 000028  6981 0007                            BNEZ,R6  s:10360,PREL
          3 00002A  E805                                 LDR,R6   ,B5
          3 00002B  E500 0000 0003  01                   AND,R6   SOFTWARE_STATUS2
          3 00002E  6901 0008                            BEZ,R6   s:10362,PREL

      910    10356    1             STATUS2 & SOFTWARE_STATUS2
      911    10357    2        THEN DO;

      912    10358                  /*N* Probably should record the error, dump the handler,
      913    10359                       and LDTRC to itself again */
      914    10360    2             CALL M$SCREECH ( CPLR_IO ) ;

  10360   3 000030  BB80 0000 0000  xsym                 LAB,B3   CPLR_IO
          3 000033  B870 0485                            LDR,R3   1157,IMO
          3 000035  0001                                 MCL
          3 000036       0000                            DC       s:10360+6,PREL

      915    10361    2           END;

      916    10362    1       IF STATUS1.TT AND KJ$CTX.STATE ~= %KJ_STATE_RUNNING /* The coupler is masked */

  10362   3 000037  ECC7 0004                            LDB,B6   @STATUS1,AUTO
          3 000039  8286                                 LB,'0020'X        ,B6
          3 00003A       0020
          3 00003B  0581 000B                            BBF      s:10365,PREL
          3 00003D  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          3 000040  E805                                 LDR,R6   ,B5
          3 000041  6D03                                 CMV,R6   3
          3 000042  0901 0004                            BE       s:10365,PREL

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:190  
      917    10363    1        THEN
      918    10364    1             RETURN;

  10364   3 000044  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      919    10365    1        IF STATUS1.CNOP                    /* Central not operational */

  10365   3 000047  8286                                 LB,'0400'X        ,B6
  10365   3 000048       0400
          3 000049  0581 0004                            BBF      s:10370,PREL

      920    10366    1        THEN
      921    10367    1             CALL RECOVERY;

  10367   3 00004B  E3C0 0139                            LNJ,B6   s:0,PREL
          3 00004D       0001                            DC       s:10370,PREL

      922    10368
      923    10369
      924    10370    1        IF STATUS1.MY                      /* Memory yellow */

  10370   3 00004E  ECC7 0004                            LDB,B6   @STATUS1,AUTO
          3 000050  8286                                 LB,'0008'X        ,B6
          3 000051       0008
          3 000052  0581 0001                            BBF      s:10375,PREL

      925    10371    2        THEN DO;

      926    10372                  /*N* Log the error */
      927    10373    2           END;

      928    10374
      929    10375    2        DO CASE (STATUS2.IL6PARM);

  10375   3 000054  DCC7 0006                            LDB,B5   @STATUS2,AUTO
          3 000056  B805                                 LDR,R3   ,B5
          3 000057  B570 003F                            AND,R3   63,IMO
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:191  
          3 000059  3D09                                 CMV,R3   9
          3 00005A  0281 00C2                            BGE      s:10519,PREL
          3 00005C  A830 0000 0062  03                   LDR,R2   s:10375+14,R3
          3 00005F  83A0 0000 006B  03                   JMP      s:10378,R2
          3 000062       00B2                            DC       s:10519,PREL
          3 000063       0032                            DC       s:10425,PREL
          3 000064       0041                            DC       s:10431,PREL
          3 000065       0005                            DC       s:10381,PREL
          3 000066       000E                            DC       s:10389,PREL
          3 000067       0017                            DC       s:10398,PREL
          3 000068       0020                            DC       s:10407,PREL
          3 000069       0029                            DC       s:10416,PREL
          3 00006A       0000                            DC       s:10378,PREL

      930    10376
      931    10377    2        CASE ( %KJ_IPARM_CNOP ) ;

      932    10378    2           CALL RECOVERY ;

  10378   3 00006B  E3C0 0119                            LNJ,B6   s:0,PREL
          3 00006D       0001                            DC       s:10378+3,PREL
          3 00006E  0F81 00AE                            B        s:10519,PREL

      933    10379
      934    10380    2        CASE(%KJ_IPARM_SCR);

      935    10381    2           CALL M$SCREECH(HOSTABRT);

  10381   3 000070  BB80 0000 0000  xsym                 LAB,B3   HOSTABRT
          3 000073  B870 0485                            LDR,R3   1157,IMO
          3 000075  0001                                 MCL
          3 000076       0000                            DC       s:10381+6,PREL
          3 000077  0F81 00A5                            B        s:10519,PREL

      936    10382                 /*S* SCREECH_CODE: KJF-S$HOST_REQUEST
      937    10383                      TYPE: SCREECH
      938    10384                      MESSAGE: Host requested Screech
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:192  
      939    10385                      REMARKS: The host reqested a screech
      940    10386         */
      941    10387
      942    10388    2        CASE(%KJ_IPARM_TO);

      943    10389    2           CALL M$SCREECH(HOSTTO);

  10389   3 000079  BB80 0000 0000  xsym                 LAB,B3   HOSTTO
          3 00007C  B870 0485                            LDR,R3   1157,IMO
          3 00007E  0001                                 MCL
          3 00007F       0000                            DC       s:10389+6,PREL
          3 000080  0F81 009C                            B        s:10519,PREL

      944    10390                 /*S* SCREECH_CODE: KJF-S$HOST_TO
      945    10391                      TYPE: SCREECH
      946    10392                      MESSAGE: Host timed out the fep.
      947    10393                      REMARKS: The host did not get a time response or
      948    10394                               the OCQ stayed full to long.
      949    10395         */
      950    10396
      951    10397    2        CASE(%KJ_IPARM_BADMSG);

      952    10398    2           CALL M$SCREECH(HOSTBADMSG);

  10398   3 000082  BB80 0000 0000  xsym                 LAB,B3   HOSTBADMSG
          3 000085  B870 0485                            LDR,R3   1157,IMO
          3 000087  0001                                 MCL
          3 000088       0000                            DC       s:10398+6,PREL
          3 000089  0F81 0093                            B        s:10519,PREL

      953    10399                 /*S* SCREECH_CODE: KJF-S$HOST_BADMSG
      954    10400                      TYPE: SCREECH
      955    10401                      MESSAGE: Host found bad message in ICQ.
      956    10402                      REMARKS: The host found a message with invalid structure
      957    10403                               in the ICQ>
      958    10404         */
      959    10405
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:193  
      960    10406    2        CASE(%KJ_IPARM_FLT);

      961    10407    2           CALL M$SCREECH(HOSTFLT);

  10407   3 00008B  BB80 0000 0000  xsym                 LAB,B3   HOSTFLT
          3 00008E  B870 0485                            LDR,R3   1157,IMO
          3 000090  0001                                 MCL
          3 000091       0000                            DC       s:10407+6,PREL
          3 000092  0F81 008A                            B        s:10519,PREL

      962    10408                 /*S* SCREECH_CODE: KJF-S$HOST_FEPFLT
      963    10409                      TYPE: SCREECH
      964    10410                      MESSAGE: IOM detect a fault on the direct channel
      965    10411                      REMARKS: The IOM detect a fault on the direct channel
      966    10412                               for this fep.
      967    10413         */
      968    10414
      969    10415    2        CASE(%KJ_IPARM_OREQ);

      970    10416    2           CALL M$SCREECH(HOSTOREQ);

  10416   3 000094  BB80 0000 0000  xsym                 LAB,B3   HOSTOREQ
          3 000097  B870 0485                            LDR,R3   1157,IMO
          3 000099  0001                                 MCL
          3 00009A       0000                            DC       s:10416+6,PREL
          3 00009B  0F81 0081                            B        s:10519,PREL

      971    10417                 /*S* SCREECH_CODE: KJF-S$HOST_OREQ
      972    10418                      TYPE: SCREECH
      973    10419                      MESSAGE: The operator or user request this fep to crash
      974    10420                      REMARKS: Some user on the host request this fep to crash
      975    10421                               and create a dump.
      976    10422         */
      977    10423
      978    10424    2        CASE (%KJ_IPARM_OCQ);

      979    10425    2           IF KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:194  

  10425   3 00009D  CC80 0000 0000  xsym                 LDB,B4   KJ_CTX$
          3 0000A0  E844 0001                            LDR,R6   1,B4
          3 0000A2  6981 007A                            BNEZ,R6  s:10519,PREL

      980    10426    2           THEN
      981    10427    2                CALL KJF$DATA;

  10427   3 0000A4  CBF0 0000                            LAB,B4   0,IMO
          3 0000A6  E380 0000 0000  xent                 LNJ,B6   KJF$DATA
          3 0000A9       0001                            DC       s:10427+6,PREL
          3 0000AA  0F81 0072                            B        s:10519,PREL

      982    10428
      983    10429    2        CASE (%KJ_IPARM_INIT);

      984    10430
      985    10431    2           CALL RECOVERY;

  10431   3 0000AC  E3C0 00D8                            LNJ,B6   s:0,PREL
          3 0000AE       0001                            DC       s:10432,PREL

      986    10432    2           DCW$ = ADDR(KJ$CTX.DCWS);

  10432   3 0000AF  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 0000B2  DBC6 0038                            LAB,B5   56,B6
          3 0000B4  DFC7 0008                            STB,B5   DCW$,AUTO

      987    10433
      988    10434                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      989    10435                L66A=%KJ_OFFSET_SIZE,
      990    10436                L6A="POFFW(ADDR(KJ$CTX.OCQ.SIZE),G$HAND_Q$)",
      991    10437                MODE=%KJ_MODE_BIN,
      992    10438                TALLY=1);

  10442   3 0000B6  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          3 0000B9  2C00                                 LDV,R2   0
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:195  
          3 0000BA  6C0C                                 LDV,R6   12
          3 0000BB  BB85                                 LAB,B3   ,B5
          3 0000BC  3C00                                 LDV,R3   0
          3 0000BD  0008                                 MMM

  10448   3 0000BE  6C03                                 LDV,R6   3
          3 0000BF  ECC7 0008                            LDB,B6   DCW$,AUTO
          3 0000C1  EA86                                 SRM,R6,'00FF'X    ,B6
          3 0000C2       00FF

  10451   3 0000C3  5C01                                 LDV,R5   1
          3 0000C4  DF46 0001                            STR,R5   1,B6

  10454   3 0000C6  8CF0 0000 0005                       LDI      5,IMO
          3 0000C9  8D46 0002                            SDI      2,B6

  10457   3 0000CB  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0000CE  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0000D1  8470 0000 0025                       AID      37,IMO
          3 0000D4  8D46 0004                            SDI      4,B6

  10459   3 0000D6  CBC6 0006                            LAB,B4   6,B6
          3 0000D8  CFC7 0008                            STB,B4   DCW$,AUTO

      993    10461                %KJ$BLDDCW (OPERATION=DATAL66_L6,
      994    10462                L66A=%KJ_OFFSET_NODE,
      995    10463                L6A="POFFW(ADDR(KJ$CTX.HOST_NODE),G$HAND_Q$)",
      996    10464                TALLY=4);

  10468   3 0000DA  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL66L6
          3 0000DD  2C00                                 LDV,R2   0
          3 0000DE  6C0C                                 LDV,R6   12
          3 0000DF  BB84                                 LAB,B3   ,B4
          3 0000E0  3C00                                 LDV,R3   0
          3 0000E1  0008                                 MMM

  10477   3 0000E2  ECC7 0008                            LDB,B6   DCW$,AUTO
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:196  
          3 0000E4  6C04                                 LDV,R6   4
          3 0000E5  EF46 0001                            STR,R6   1,B6

  10480   3 0000E7  8CF0 0000 0003                       LDI      3,IMO
          3 0000EA  8D46 0002                            SDI      2,B6

  10483   3 0000EC  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 0000EF  8480 0000 0000  xsym                 SID      G$HAND_Q$
          3 0000F2  8470 0000 0007                       AID      7,IMO
          3 0000F5  8D46 0004                            SDI      4,B6

  10485   3 0000F7  ABC6 0006                            LAB,B2   6,B6
          3 0000F9  AFC7 0008                            STB,B2   DCW$,AUTO

      997    10487
      998    10488                %KJ$BLDDCW (OPERATION=DISCONNECTINT);

  10494   3 0000FB  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_DTL6L66
          3 0000FE  2C00                                 LDV,R2   0
          3 0000FF  6C0C                                 LDV,R6   12
          3 000100  BCC7 0008                            LDB,B3   DCW$,AUTO
          3 000102  3C00                                 LDV,R3   0
          3 000103  0008                                 MMM

  10495   3 000104  6C38                                 LDV,R6   56
          3 000105  ECC7 0008                            LDB,B6   DCW$,AUTO
          3 000107  E786                                 STH,R6   ,B6

  10509   3 000108  BBC6 0006                            LAB,B3   6,B6
          3 00010A  BFC7 0008                            STB,B3   DCW$,AUTO

      999    10511
     1000    10512    2           KJ$CTX.CURRENT_FUNCTION = %KJ_CF_ROCQSIZE;

  10512   3 00010C  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 00010F  4C02                                 LDV,R4   2
          3 000110  CF46 0001                            STR,R4   1,B6
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:197  

     1001    10513        /* Do the IO and the interupt will trigger us to go further */
     1002    10514    2           CALL KJF$DCWLIST;

  10514   3 000112  CBF0 0000                            LAB,B4   0,IMO
          3 000114  E380 0000 0000  xent                 LNJ,B6   KJF$DCWLIST
          3 000117       0001                            DC       s:10516,PREL

     1003    10515
     1004    10516    2           KJ$CTX.STATE = %KJ_STATE_INIT;

  10516   3 000118  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 00011B  6C02                                 LDV,R6   2
          3 00011C  EF06                                 STR,R6   ,B6

     1005    10517    2        END;                               /* End cases */

     1006    10518
     1007    10519    1        IF STATUS1.ATT                     /* The list was aborted */

  10519   3 00011D  ECC7 0004                            LDB,B6   @STATUS1,AUTO
          3 00011F  8286                                 LB,'4000'X        ,B6
          3 000120       4000
          3 000121  0581 0009                            BBF      s:10525,PREL

     1008    10520    1        THEN
     1009    10521    2             CALL RETRY WHENALTRETURN DO;  /* Retry the list */

  10521   3 000123  E3C0 000A                            LNJ,B6   s:0,PREL
          3 000125       0003                            DC       s:10522,PREL
          3 000126  0F81 0004                            B        s:10525,PREL

     1010    10522    2                  ALTRETURN;

  10522   3 000128  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     1011    10523    2                END;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:198  
     1012    10524
     1013    10525    1        RETURN;

  10525   3 00012B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1014    10526        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:199  
     1015    10527    1   RETRY: PROC ALTRET;

  10527   3 00012E  EFC7 000A            RETRY           STB,B6   DCW$+2,AUTO

     1016    10528    2        IF KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE

  10528   3 000130  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          3 000133  E845 0001                            LDR,R6   1,B5
          3 000135  6981 0005                            BNEZ,R6  s:10532,PREL

     1017    10529    2        THEN
     1018    10530    2             RETURN;

  10530   3 000137  ECC7 000A                            LDB,B6   DCW$+2,AUTO
          3 000139  C3C6 0001                            LNJ,B4   1,B6

     1019    10531
     1020    10532    2        KJ_STATS.DCW_ABRT  = KJ_STATS.DCW_ABRT + 1;

  10532   3 00013B  8A80 0000 002B  xsym                 INC      KJ_STATS+43
          3 00013E  8E80 0000 002A  xsym                 CAD      KJ_STATS+42

     1021    10533
     1022    10534        /* Get DCW offset */
     1023    10535    2        GH_IO = KJ_GH_IO_INIT;

  10535   3 000141  8C80 0000 0000  xsym                 LDI      KJ_GH_IO_INIT
          3 000144  8D00 0000 0000  02                   SDI      GH_IO

     1024    10536    2        GH_IO.CAS.CHN = KJ$CTX.CHAN0;

  10536   3 000147  D845 0002                            LDR,R5   2,B5
          3 000149  5006                                 SOL,R5   6
          3 00014A  DA80 0000 0000  02                   SRM,R5,'FFC0'X    GH_IO
          3 00014D       FFC0

     1025    10537    2        GH_IO.CAS.FNC = %KJ_IO_RDDCWOFF;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:200  

  10537   3 00014E  5C0C                                 LDV,R5   12
          3 00014F  DA80 0000 0000  02                   SRM,R5,'003F'X    GH_IO
          3 000152       003F

     1026    10538    2        CALL KJF$IO_IN(GH_IO);

  10538   3 000153  BB80 0000 0000  04                   LAB,B3   0
          3 000156  CBF0 0100                            LAB,B4   256,IMO
          3 000158  E380 0000 0000  xent                 LNJ,B6   KJF$IO_IN
          3 00015B       0001                            DC       s:10542,PREL

     1027    10539
     1028    10540        /* If we are past the data transfer portion of the list build a
     1029    10541             jump to the pointer portion */
     1030    10542    2        IF GH_IO.RANGE >= POFFW(ADDR(KJ$CTX.PTR_DCW),ADDR(KJ$CTX.DCWS))

  10542   3 00015C  8C80 0000 0000  xsym                 LDI      KJ_CTX$
          3 00015F  8480 0000 0000  xsym                 SID      KJ_CTX$
          3 000162  8D47 000C                            SDI      DCW$+4,AUTO
          3 000164  F800 0000 0001  02                   LDR,R7   GH_IO+1
          3 000167  6C00                                 LDV,R6   0
          3 000168  8D47 000E                            SDI      DCW$+6,AUTO
          3 00016A  8CC7 000C                            LDI      DCW$+4,AUTO
          3 00016C  8470 0000 0078                       AID      120,IMO
          3 00016F  84C7 000E                            SID      DCW$+6,AUTO
          3 000171  6A01 000F                            BGZ,R6   s:10546,PREL
          3 000173  6801 0003                            BLZ,R6   s:10544,PREL
          3 000175  7981 000B                            BNEZ,R7  s:10546,PREL

     1031    10543    2        THEN
     1032    10544    2             KJ$CTX.DCWS(0) = KJ_DCW_JUMP;

  10544   3 000177  AB80 0000 0000  xsym                 LAB,B2   KJ_DCW_JUMP
          3 00017A  2C00                                 LDV,R2   0
          3 00017B  6C0C                                 LDV,R6   12
          3 00017C  BC80 0000 0000  xsym                 LDB,B3   KJ_CTX$
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:201  
          3 00017F  3C70                                 LDV,R3   112
          3 000180  0008                                 MMM

     1033    10545
     1034    10546    2        ALTRETURN;

  10546   3 000181  ECC7 000A                            LDB,B6   DCW$+2,AUTO
          3 000183  B806                                 LDR,R3   ,B6
          3 000184  C3B6                                 LNJ,B4   ,B6,R3

     1035    10547
     1036    10548    2   END RETRY;
     1037    10549
     1038    10550        %EJECT;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:202  
     1039    10551    1   RECOVERY: PROC ;

  10551   3 000185  EFC7 000A            RECOVERY        STB,B6   DCW$+2,AUTO

     1040    10552
     1041    10553    2        IF KJ$CTX.STATE ~= %KJ_STATE_RUNNING

  10553   3 000187  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          3 00018A  E805                                 LDR,R6   ,B5
          3 00018B  6D03                                 CMV,R6   3
          3 00018C  0901 0005                            BE       s:10557,PREL

     1042    10554    2        THEN
     1043    10555    2             RETURN;

  10555   3 00018E  ECC7 000A                            LDB,B6   DCW$+2,AUTO
          3 000190  C3C6 0001                            LNJ,B4   1,B6

     1044    10556
     1045    10557    2        KJ_TERM_MSG.LDCTX = KJ_LDCTX;

  10557   3 000192  D800 0000 0000  xsym                 LDR,R5   KJ_LDCTX
          3 000195  DF00 0000 0001  xsym                 STR,R5   KJ_TERM_MSG+1

     1046    10558    2        CALL M$WRITE (KJ_WRT_TERM);

  10558   3 000198  BB80 0000 0000  xsym                 LAB,B3   KJ_WRT_TERM
          3 00019B  B870 1543                            LDR,R3   5443,IMO
          3 00019D  0001                                 MCL
          3 00019E       0000                            DC       s:10558+6,PREL

     1047    10559    2        KNH$QHDR.SCQ.IPTR=0;

  10559   3 00019F  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 0001A2  8746 0004                            CL       4,B6

     1048    10560    2        KNH$QHDR.SCQ.RPTR=0;
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:203  

  10560   3 0001A4  8746 0005                            CL       5,B6

     1049    10561    2        KJ$CTX.ICQ.IPTR=0;

  10561   3 0001A6  DC80 0000 0000  xsym                 LDB,B5   KJ_CTX$
          3 0001A9  8745 000A                            CL       10,B5
          3 0001AB  8745 000B                            CL       11,B5

     1050    10562    2        KJ$CTX.ICQ.RPTR=0;

  10562   3 0001AD  8745 000D                            CL       13,B5
          3 0001AF  8745 000E                            CL       14,B5

     1051    10563    2        KJ$CTX.OCQ.IPTR=0;

  10563   3 0001B1  8745 001F                            CL       31,B5
          3 0001B3  8745 0020                            CL       32,B5

     1052    10564    2        KJ$CTX.OCQ.RPTR=0;

  10564   3 0001B5  8745 0022                            CL       34,B5
          3 0001B7  8745 0023                            CL       35,B5

     1053    10565    2        KJ$CTX.STATE = %KJ_STATE_RECOVERY;

  10565   3 0001B9  6C04                                 LDV,R6   4
          3 0001BA  EF05                                 STR,R6   ,B5

     1054    10566    2        KJ$CTX.CURRENT_FUNCTION = %KJ_CF_NONE;

  10566   3 0001BB  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          3 0001BE  8746 0001                            CL       1,B6

     1055    10567    2        RETURN;

  10567   3 0001C0  ECC7 000A                            LDB,B6   DCW$+2,AUTO
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:204  
          3 0001C2  C3C6 0001                            LNJ,B4   1,B6
     1056    10568
     1057    10569    2   END RECOVERY;
     1058    10570
     1059    10571    1   END KJF$FIX;
     1060    10572        %EOD;

PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:205  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$FIX.
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:206  

 **** Variables and constants ****

  ****  Section 001 RoData KJF$FIX

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (16)    r     1 HARDWARE_STATUS1           1-0-0/b BIT (16)    r     1 HARDWARE_STATUS2
     2-0-0/b BIT (16)    r     1 SOFTWARE_STATUS1           3-0-0/b BIT (16)    r     1 SOFTWARE_STATUS2

  ****  Section 002  Data  KJF$FIX

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(32)    r     1 GH_IO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @STATUS1                   6-0-0/w PTR         r     1 @STATUS2
     8-0-0/w PTR         r     1 DCW$                      *0-0-0/w STRC(16)    r     1 STATUS1
    *0-0-0/w STRC(16)    r     1 STATUS2

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 CPLR_IO                    0-0-0/w PTR         r     1 G$HAND_Q$
     0-0-0/w STRC(48)    r     1 HOSTABRT                   0-0-0/w STRC(48)    r     1 HOSTBADMSG
     0-0-0/w STRC(48)    r     1 HOSTFLT                    0-0-0/w STRC(48)    r     1 HOSTOREQ
     0-0-0/w STRC(48)    r     1 HOSTTO                     0-0-0/w PTR         r     1 KJ_CTX$
     0-0-0/w STRC(96)    r     1 KJ_DCW_DTL66L6             0-0-0/w STRC(96)    r     1 KJ_DCW_DTL6L66
     0-0-0/w STRC(96)    r     1 KJ_DCW_JUMP                0-0-0/w STRC(32)    r     1 KJ_GH_IO_INIT
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:207  
     0-0-0/w UBIN(16)    r     1 KJ_LDCTX                   0-0-0/w STRC(864)   r     1 KJ_STATS
     0-0-0/c STRC(128)   r     1 KJ_TERM_MSG                0-0-0/w STRC(288)   r     1 KJ_WRT_TERM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3680)  r     1 KJ$CTX                     0-0-0/w STRC(96)    r     1 KJ$DCW
     0-0-0/w STRC(384)   r     1 KNH$QHDR


   Procedure KJF$FIX requires 452 words for executable code.
   Procedure KJF$FIX requires 16 words of local(AUTO) storage.
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:208  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:209  
          MINI XREF LISTING

CPLR_IO
      9789**DCL     10360<>CALL
DCW$
     10307**DCL     10432<<ASSIGN  10442>>ASSIGN  10448>>ASSIGN  10451>>ASSIGN  10454>>ASSIGN  10457>>ASSIGN
     10459<<ASSIGN  10459>>ASSIGN  10468>>ASSIGN  10477>>ASSIGN  10480>>ASSIGN  10483>>ASSIGN  10485<<ASSIGN
     10485>>ASSIGN  10494>>ASSIGN  10495>>ASSIGN  10509<<ASSIGN  10509>>ASSIGN
G$HAND_Q$
      9027**DCL     10327--IMP-PTR 10457>>ASSIGN  10483>>ASSIGN  10559>>ASSIGN  10560>>ASSIGN
GH_IO
     10319**DCL     10535<<ASSIGN  10538<>CALL
GH_IO.CAS.CHN
     10319**DCL     10319--REDEF   10536<<ASSIGN
GH_IO.CAS.FNC
     10320**DCL     10537<<ASSIGN
GH_IO.DAS
     10320**DCL     10321--REDEF   10322--REDEF
GH_IO.RANGE
     10321**DCL     10542>>IF
HARDWARE_STATUS1
     10286**DCL     10344>>IF
HARDWARE_STATUS2
     10292**DCL     10344>>IF
HOSTABRT
      9972**DCL     10381<>CALL
HOSTBADMSG
     10216**DCL     10398<>CALL
HOSTFLT
     10094**DCL     10407<>CALL
HOSTOREQ
     10155**DCL     10416<>CALL
HOSTTO
     10033**DCL     10389<>CALL
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:210  
KJ$CTX.CHAN0
      9038**DCL     10536>>ASSIGN
KJ$CTX.CURRENT_FUNCTION
      9032**DCL     10425>>IF      10512<<ASSIGN  10528>>IF      10566<<ASSIGN
KJ$CTX.DCWS
      9063**DCL     10432--ASSIGN  10542--IF      10544<<ASSIGN
KJ$CTX.HOST_NODE
      9038**DCL     10483--ASSIGN
KJ$CTX.ICQ.IPTR
      9039**DCL     10561<<ASSIGN
KJ$CTX.ICQ.RPTR
      9039**DCL     10562<<ASSIGN
KJ$CTX.OCQ.IPTR
      9041**DCL     10563<<ASSIGN
KJ$CTX.OCQ.RPTR
      9041**DCL     10564<<ASSIGN
KJ$CTX.OCQ.SIZE
      9041**DCL     10457--ASSIGN
KJ$CTX.PTR_DCW
      9103**DCL     10542--IF
KJ$CTX.STATE
      9027**DCL     10362>>IF      10516<<ASSIGN  10553>>IF      10565<<ASSIGN
KJ$DCW
      8902**DCL     10442<<ASSIGN  10459--ASSIGN  10468<<ASSIGN  10485--ASSIGN  10494<<ASSIGN  10509--ASSIGN
KJ$DCW.L66A
      8925**DCL     10454<<ASSIGN  10480<<ASSIGN
KJ$DCW.L6A
      8926**DCL     10457<<ASSIGN  10483<<ASSIGN
KJ$DCW.MODE
      8918**DCL     10448<<ASSIGN
KJ$DCW.OPERATION
      8913**DCL     10495<<ASSIGN
KJ$DCW.TALLY
      8923**DCL     10451<<ASSIGN  10477<<ASSIGN
KJF$DATA
     10302**DCL-ENT 10427--CALL
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:211  
KJF$DCWLIST
     10301**DCL-ENT 10514--CALL
KJF$IO_IN
     10304**DCL-ENT 10538--CALL
KJ_CTX$
      9027**DCL      9027--IMP-PTR 10362>>IF      10425>>IF      10432>>ASSIGN  10457>>ASSIGN  10483>>ASSIGN
     10512>>ASSIGN  10516>>ASSIGN  10528>>IF      10536>>ASSIGN  10542>>IF      10542>>IF      10544>>ASSIGN
     10553>>IF      10561>>ASSIGN  10562>>ASSIGN  10563>>ASSIGN  10564>>ASSIGN  10565>>ASSIGN  10566>>ASSIGN
KJ_DCW_DTL66L6
      8782**DCL     10442>>ASSIGN  10468>>ASSIGN
KJ_DCW_DTL6L66
      8822**DCL     10494>>ASSIGN
KJ_DCW_JUMP
      8862**DCL     10544>>ASSIGN
KJ_GH_IO_INIT
      9741**DCL     10535>>ASSIGN
KJ_GH_IO_INIT.CAS.CHN
      9741**DCL      9741--REDEF
KJ_GH_IO_INIT.DAS
      9742**DCL      9743--REDEF    9744--REDEF
KJ_GH_IO_INTL66.CAS.CHN
      9757**DCL      9757--REDEF
KJ_GH_IO_INTL66.DAS
      9758**DCL      9759--REDEF    9760--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9584**DCL      9585--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9585**DCL      9585--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9573**DCL      9582--REDEF
KJ_INIT_MSG.FUNCTION
      9498**DCL      9498--REDEF
KJ_INIT_MSG.UID
      9528**DCL      9528--REDEF    9528--REDEF
KJ_IOLD_BARR.CHN
      9711**DCL      9711--REDEF
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:212  
KJ_IOLD_DCWLIST.CHN
      9726**DCL      9726--REDEF
KJ_LDCTX
      9127**DCL     10557>>ASSIGN
KJ_STATS.DCW_ABRT
      9469**DCL     10532<<ASSIGN  10532>>ASSIGN
KJ_STATS.REQSTATS.DSPMSK
      9390**DCL      9396--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9431**DCL      9438--REDEF
KJ_TERM_MSG.FUNCTION
      9616**DCL      9616--REDEF
KJ_TERM_MSG.LDCTX
      9621**DCL     10557<<ASSIGN
KJ_TERM_MSG.UID
      9646**DCL      9646--REDEF    9646--REDEF
KJ_WRT_TERM
      9689**DCL     10558<>CALL
KNH$QHDR.RCQ
     10327**DCL     10327--REDEF
KNH$QHDR.SCQ.IPTR
     10328**DCL     10559<<ASSIGN
KNH$QHDR.SCQ.RPTR
     10328**DCL     10560<<ASSIGN
M$SCREECH
      4284**DCL-ENT 10360--CALL    10381--CALL    10389--CALL    10398--CALL    10407--CALL    10416--CALL
M$WRITE
      4305**DCL-ENT 10558--CALL
RECOVERY
     10551**PROC    10367--CALL    10378--CALL    10431--CALL
RETRY
     10527**PROC    10350--CALL    10521--CALL
SOFTWARE_STATUS1
     10293**DCL     10355>>IF
SOFTWARE_STATUS2
     10294**DCL     10355>>IF
PL6.E3A0      #005=KJF$FIX File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:49 Page:213  
STATUS1
     10253**DCL         6--PROC    10344>>IF      10355>>IF
STATUS1.ATT
     10255**DCL     10348>>IF      10519>>IF
STATUS1.CNOP
     10259**DCL     10365>>IF
STATUS1.MY
     10266**DCL     10370>>IF
STATUS1.TT
     10264**DCL     10362>>IF
STATUS2
     10272**DCL         6--PROC    10344>>IF      10355>>IF
STATUS2.IL6PARM
     10283**DCL     10375>>DOCASE

PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:214  
     1061        1        /*T***********************************************************/
     1062        2        /*T*                                                         */
     1063        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1064        4        /*T*                                                         */
     1065        5        /*T***********************************************************/
     1066        6        KJF$IO: PROC(GH_IO) ALTRET;
     1067        7
     1068        8        %INCLUDE KJ_DATA_R;
     1069    10249
     1070    10250        /* Parameter definitions */
     1071    10251        %GH_IO(STCLASS="");
     1072    10267
     1073    10268        /* Entry point references */
     1074    10269    1   DCL GHH$IO ENTRY(1) ALTRET;
     1075    10270    1   DCL GHH$IO_IN ENTRY(1) ALTRET;
     1076    10271
     1077    10272        /* Local */
     1078    10273
     1079    10274    2        DO WHILE ('1'B);
     1080    10275    3             CALL GHH$IO (GH_IO) WHENRETURN DO;
     1081    10276    3                  RETURN;
     1082    10277    3                END;
     1083    10278    2           END;
     1084    10279
     1085    10280    1   KJF$IO_IN: ENTRY (GH_IO) ALTRET;
     1086    10281
     1087    10282    2        DO WHILE ('1'B);
     1088    10283    3             CALL GHH$IO_IN (GH_IO) WHENRETURN DO;
     1089    10284    3                  RETURN;
     1090    10285    3                END;
     1091    10286    2           END;
     1092    10287    1   END KJF$IO;
     1093    10288        %EOD;

PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:215  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$IO.

   Procedure KJF$IO requires 34 words for executable code.
   Procedure KJF$IO requires 6 words of local(AUTO) storage.

PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:216  

 Object Unit name= KJF$IO                                     File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:50:35.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Proc  even  none    34     22  KJF$IO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KJF$IO
     1     11          yes     yes      Std        1  KJF$IO_IN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 GHH$IO
 yes     yes           Std       1 GHH$IO_IN
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                                  KJ_CTX$                          r    G$ROS$
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:217  


     1061        1        /*T***********************************************************/
     1062        2        /*T*                                                         */
     1063        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1064        4        /*T*                                                         */
     1065        5        /*T***********************************************************/
     1066        6        KJF$IO: PROC(GH_IO) ALTRET;

      6   1 000000  D380 0000 0000  xent KJF$IO          LNJ,B5   X6A_AUTO_1
          1 000003       0006 0001                       DC       6,1

     1067        7
     1068        8        %INCLUDE KJ_DATA_R;
     1069    10249
     1070    10250        /* Parameter definitions */
     1071    10251        %GH_IO(STCLASS="");
     1072    10267
     1073    10268        /* Entry point references */
     1074    10269    1   DCL GHH$IO ENTRY(1) ALTRET;
     1075    10270    1   DCL GHH$IO_IN ENTRY(1) ALTRET;
     1076    10271
     1077    10272        /* Local */
     1078    10273
     1079    10274    2        DO WHILE ('1'B);

     1080    10275    3             CALL GHH$IO (GH_IO) WHENRETURN DO;

  10275   1 000005  BBC7 0004                            LAB,B3   @GH_IO,AUTO
          1 000007  CBF0 0100                            LAB,B4   256,IMO
          1 000009  E380 0000 0000  xent                 LNJ,B6   GHH$IO
          1 00000C       0004                            DC       s:10278,PREL

     1081    10276    3                  RETURN;

  10276   1 00000D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1082    10277    3                END;
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:218  
     1083    10278    2           END;

  10278   1 000010  0FF5                                 B        s:10275,SPREL

     1084    10279
     1085    10280    1   KJF$IO_IN: ENTRY (GH_IO) ALTRET;

  10280   1 000011  D380 0000 0000  xent KJF$IO_IN       LNJ,B5   X6A_AUTO_1
          1 000014       0006 0001                       DC       6,1

     1086    10281
     1087    10282    2        DO WHILE ('1'B);

     1088    10283    3             CALL GHH$IO_IN (GH_IO) WHENRETURN DO;

  10283   1 000016  BBC7 0004                            LAB,B3   @GH_IO,AUTO
          1 000018  CBF0 0100                            LAB,B4   256,IMO
          1 00001A  E380 0000 0000  xent                 LNJ,B6   GHH$IO_IN
          1 00001D       0004                            DC       s:10286,PREL

     1089    10284    3                  RETURN;

  10284   1 00001E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1090    10285    3                END;
     1091    10286    2           END;

  10286   1 000021  0FF5                                 B        s:10283,SPREL
     1092    10287    1   END KJF$IO;
     1093    10288        %EOD;

PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:219  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$IO.
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:220  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @GH_IO                    *0-0-0/w STRC(32)    r     1 GH_IO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KJ_CTX$


   Procedure KJF$IO requires 34 words for executable code.
   Procedure KJF$IO requires 6 words of local(AUTO) storage.
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:221  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:222  
          MINI XREF LISTING

GHH$IO
     10269**DCL-ENT 10275--CALL
GHH$IO_IN
     10270**DCL-ENT 10283--CALL
GH_IO
     10262**DCL         6--PROC    10275<>CALL    10280--ENTRY   10283<>CALL
GH_IO.CAS.CHN
     10262**DCL     10262--REDEF
GH_IO.DAS
     10263**DCL     10264--REDEF   10265--REDEF
KJ_CTX$
      9026**DCL      9026--IMP-PTR
KJ_GH_IO_INIT.CAS.CHN
      9740**DCL      9740--REDEF
KJ_GH_IO_INIT.DAS
      9741**DCL      9742--REDEF    9743--REDEF
KJ_GH_IO_INTL66.CAS.CHN
      9756**DCL      9756--REDEF
KJ_GH_IO_INTL66.DAS
      9757**DCL      9758--REDEF    9759--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9583**DCL      9584--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9584**DCL      9584--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9572**DCL      9581--REDEF
KJ_INIT_MSG.FUNCTION
      9497**DCL      9497--REDEF
KJ_INIT_MSG.UID
      9527**DCL      9527--REDEF    9527--REDEF
KJ_IOLD_BARR.CHN
      9710**DCL      9710--REDEF
PL6.E3A0      #006=KJF$IO File=KJF$FEI.:E05TSI                                   WED 07/30/97 00:50 Page:223  
KJ_IOLD_DCWLIST.CHN
      9725**DCL      9725--REDEF
KJ_STATS.REQSTATS.DSPMSK
      9389**DCL      9395--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9430**DCL      9437--REDEF
KJ_TERM_MSG.FUNCTION
      9615**DCL      9615--REDEF
KJ_TERM_MSG.UID
      9645**DCL      9645--REDEF    9645--REDEF

PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:224  
     1094        1        /*T***********************************************************/
     1095        2        /*T*                                                         */
     1096        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1097        4        /*T*                                                         */
     1098        5        /*T***********************************************************/
     1099        6        KJF$DCWLIST: PROC;
     1100        7
     1101        8        %INCLUDE KJ_DATA_R;
     1102    10249
     1103    10250
     1104    10251        /* Entry references */
     1105    10252    1   DCL GHH$IOLD ENTRY(1) ALTRET;
     1106    10253    1   DCL KJF$FIX ENTRY(2) ALTRET;
     1107    10254    1   DCL KJF$GETSTATUS ENTRY ALTRET;
     1108    10255
     1109    10256        /* Begin program */
     1110    10257
     1111    10258    1        CALL KJF$GETSTATUS;
     1112    10259    1        IF KJ$CTX.STATUS1 ~= %KJ_STATUS_DR
     1113    10260    1        THEN
     1114    10261    1             CALL KJF$FIX (KJ$CTX.STATUS1,KJ$CTX.STATUS2);
     1115    10262
     1116    10263    2        DO WHILE ('1'B);
     1117    10264    3             CALL GHH$IOLD (KJ_IOLD_BARR) WHENRETURN DO;
     1118    10265    4                  CALL GHH$IOLD(KJ_IOLD_DCWLIST) WHENRETURN DO;
     1119    10266    4                       RETURN;
     1120    10267    4                     END;
     1121    10268    3                END;
     1122    10269
     1123    10270    2             CALL KJF$GETSTATUS;
     1124    10271    2             CALL KJF$FIX(KJ$CTX.STATUS1,KJ$CTX.STATUS2);
     1125    10272    2           END;
     1126    10273
     1127    10274    1   END KJF$DCWLIST;
     1128    10275        %EOD;

PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:225  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$DCWLIST.

   Procedure KJF$DCWLIST requires 83 words for executable code.
   Procedure KJF$DCWLIST requires 8 words of local(AUTO) storage.

PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:226  

 Object Unit name= KJF$DCWLIST                                File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:51:22.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Proc  even  none    83     53  KJF$DCWLIST
    2  RoData even  none     4      4  KJF$DCWLIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  KJF$DCWLIST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 KJF$GETSTATUS
 yes     yes           Std       2 KJF$FIX
 yes     yes           Std       1 GHH$IOLD
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                                  KJ_CTX$                               KJ_IOLD_BARR
     KJ_IOLD_DCWLIST                  r    G$ROS$
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:227  


     1094        1        /*T***********************************************************/
     1095        2        /*T*                                                         */
     1096        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1097        4        /*T*                                                         */
     1098        5        /*T***********************************************************/
     1099        6        KJF$DCWLIST: PROC;

      6   1 000000  D380 0000 0000  xent KJF$DCWLIST     LNJ,B5   X6A_AUTO_0
          1 000003       0008 0000                       DC       8,0

     1100        7
     1101        8        %INCLUDE KJ_DATA_R;
     1102    10249
     1103    10250
     1104    10251        /* Entry references */
     1105    10252    1   DCL GHH$IOLD ENTRY(1) ALTRET;
     1106    10253    1   DCL KJF$FIX ENTRY(2) ALTRET;
     1107    10254    1   DCL KJF$GETSTATUS ENTRY ALTRET;
     1108    10255
     1109    10256        /* Begin program */
     1110    10257
     1111    10258    1        CALL KJF$GETSTATUS;

  10258   1 000005  CBF0 0000                            LAB,B4   0,IMO
          1 000007  E380 0000 0000  xent                 LNJ,B6   KJF$GETSTATUS
          1 00000A       0001                            DC       s:10259,PREL

     1112    10259    1        IF KJ$CTX.STATUS1 ~= %KJ_STATUS_DR

  10259   1 00000B  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 00000E  E846 0005                            LDR,R6   5,B6
          1 000010  E970 8000                            CMR,R6   -32768,IMO
          1 000012  0901 0011                            BE       s:10264,PREL

     1113    10260    1        THEN
     1114    10261    1             CALL KJF$FIX (KJ$CTX.STATUS1,KJ$CTX.STATUS2);
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:228  

  10261   1 000014  DBC6 0006                            LAB,B5   6,B6
          1 000016  DFC7 0006                            STB,B5   +6,AUTO
          1 000018  CBC6 0005                            LAB,B4   5,B6
          1 00001A  CFC7 0004                            STB,B4   +4,AUTO
          1 00001C  BBC7 0004                            LAB,B3   +4,AUTO
          1 00001E  CBF0 0200                            LAB,B4   512,IMO
          1 000020  E380 0000 0000  xent                 LNJ,B6   KJF$FIX
          1 000023       0001                            DC       s:10264,PREL

     1115    10262
     1116    10263    2        DO WHILE ('1'B);

     1117    10264    3             CALL GHH$IOLD (KJ_IOLD_BARR) WHENRETURN DO;

  10264   1 000024  BB80 0000 0000  02                   LAB,B3   0
          1 000027  CBF0 0100                            LAB,B4   256,IMO
          1 000029  E380 0000 0000  xent                 LNJ,B6   GHH$IOLD
          1 00002C       000D                            DC       s:10270,PREL

     1118    10265    4                  CALL GHH$IOLD(KJ_IOLD_DCWLIST) WHENRETURN DO;

  10265   1 00002D  BB80 0000 0002  02                   LAB,B3   +2
          1 000030  CBF0 0100                            LAB,B4   256,IMO
          1 000032  E380 0000 0000  xent                 LNJ,B6   GHH$IOLD
          1 000035       0004                            DC       s:10270,PREL

     1119    10266    4                       RETURN;

  10266   1 000036  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1120    10267    4                     END;
     1121    10268    3                END;

     1122    10269
     1123    10270    2             CALL KJF$GETSTATUS;

PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:229  
  10270   1 000039  CBF0 0000                            LAB,B4   0,IMO
          1 00003B  E380 0000 0000  xent                 LNJ,B6   KJF$GETSTATUS
          1 00003E       0001                            DC       s:10271,PREL

     1124    10271    2             CALL KJF$FIX(KJ$CTX.STATUS1,KJ$CTX.STATUS2);

  10271   1 00003F  EC80 0000 0000  xsym                 LDB,B6   KJ_CTX$
          1 000042  DBC6 0006                            LAB,B5   6,B6
          1 000044  DFC7 0006                            STB,B5   +6,AUTO
          1 000046  CBC6 0005                            LAB,B4   5,B6
          1 000048  CFC7 0004                            STB,B4   +4,AUTO
          1 00004A  BBC7 0004                            LAB,B3   +4,AUTO
          1 00004C  CBF0 0200                            LAB,B4   512,IMO
          1 00004E  E380 0000 0000  xent                 LNJ,B6   KJF$FIX
          1 000051       0001                            DC       s:10272,PREL

     1125    10272    2           END;

  10272   1 000052  0FD2                                 B        s:10264,SPREL
     1126    10273
     1127    10274    1   END KJF$DCWLIST;
     1128    10275        %EOD;

PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:230  
--  Include file information  --

   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KJF$DCWLIST.
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:231  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KJ_CTX$                    0-0-0/w STRC(80)    r     1 KJ_IOLD_BARR
     0-0-0/w STRC(80)    r     1 KJ_IOLD_DCWLIST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3680)  r     1 KJ$CTX


   Procedure KJF$DCWLIST requires 83 words for executable code.
   Procedure KJF$DCWLIST requires 8 words of local(AUTO) storage.
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:232  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:233  
          MINI XREF LISTING

GHH$IOLD
     10252**DCL-ENT 10264--CALL    10265--CALL
KJ$CTX.STATUS1
      9037**DCL     10259>>IF      10261<>CALL    10271<>CALL
KJ$CTX.STATUS2
      9037**DCL     10261<>CALL    10271<>CALL
KJF$FIX
     10253**DCL-ENT 10261--CALL    10271--CALL
KJF$GETSTATUS
     10254**DCL-ENT 10258--CALL    10270--CALL
KJ_CTX$
      9026**DCL      9026--IMP-PTR 10259>>IF      10261>>CALL    10261>>CALL    10271>>CALL    10271>>CALL
KJ_GH_IO_INIT.CAS.CHN
      9740**DCL      9740--REDEF
KJ_GH_IO_INIT.DAS
      9741**DCL      9742--REDEF    9743--REDEF
KJ_GH_IO_INTL66.CAS.CHN
      9756**DCL      9756--REDEF
KJ_GH_IO_INTL66.DAS
      9757**DCL      9758--REDEF    9759--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
      9583**DCL      9584--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
      9584**DCL      9584--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
      9572**DCL      9581--REDEF
KJ_INIT_MSG.FUNCTION
      9497**DCL      9497--REDEF
KJ_INIT_MSG.UID
      9527**DCL      9527--REDEF    9527--REDEF
KJ_IOLD_BARR
      9710**DCL     10264<>CALL
PL6.E3A0      #007=KJF$DCWLIST File=KJF$FEI.:E05TSI                              WED 07/30/97 00:51 Page:234  
KJ_IOLD_BARR.CHN
      9710**DCL      9710--REDEF
KJ_IOLD_DCWLIST
      9725**DCL     10265<>CALL
KJ_IOLD_DCWLIST.CHN
      9725**DCL      9725--REDEF
KJ_STATS.REQSTATS.DSPMSK
      9389**DCL      9395--REDEF
KJ_STATS.REQSTATS.SLCMSK
      9430**DCL      9437--REDEF
KJ_TERM_MSG.FUNCTION
      9615**DCL      9615--REDEF
KJ_TERM_MSG.UID
      9645**DCL      9645--REDEF    9645--REDEF

PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:235  
     1129        1        /*T***********************************************************/
     1130        2        /*T*                                                         */
     1131        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1132        4        /*T*                                                         */
     1133        5        /*T***********************************************************/
     1134        6        KJF$ADM: PROC (KH$ADMIN_FPT) ALTRET;
     1135        7
     1136        8        /* Includes */
     1137        9        %INCLUDE KH_MACRO_C;
     1138      752        %INCLUDE KJ_DATA_R;
     1139    10993        %INCLUDE KH$CHN;
     1140    11115        %INCLUDE KHA_FNC_E;
     1141    11215        %INCLUDE KN_ERRORS_C;
     1142    11279        %INCLUDE K_ID_E;
     1143    11329        /*ent defs */
     1144    11330    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
     1145    11331    1   DCL KHC$XEQ2 ENTRY(1) ALTRET;
     1146    11332    1   DCL CURXEQTIM UBIN(32);
     1147    11333        /**/
     1148    11334        %KL_REQSTATS;
     1149    11628        %K#ENTID_E;
     1150    11647
     1151    11648
     1152    11649        /* Parameters */
     1153    11650        %KH$ADMIN_FPT (STCLASS="");
     1154    11861        %KH$CHN (STCLASS="BASED(CHN$)");
     1155    11985
     1156    11986    1   DCL CHN$ PTR;
     1157    11987
     1158    11988        %EJECT;
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:236  
     1159    11989
     1160    11990    2        DO CASE (KH$ADMIN_FPT.FNC);
     1161    11991
     1162    11992    2        CASE (%KHA_FNC_ENABLE);
     1163    11993    2           IF KJ_CONTROL.CHAN ~= 0
     1164    11994    3           THEN DO;
     1165    11995    3                KH$ADMIN_FPT.RESULTS.ERR# = %E$ILGLTRANS;
     1166    11996    3                ALTRETURN;
     1167    11997    3              END;
     1168    11998    2           CHN$ = KH$ADMIN_FPT.CHN$;
     1169    11999    2           KJ_CONTROL.CHAN = KH$CHN.CHNBIT0_9 * 64;
     1170    12000
     1171    12001    2        CASE (%KHA_FNC_DISABLE,
     1172    12002    2                %KHA_FNC_KILL,
     1173    12003    2                %KHA_FNC_PARTITION,
     1174    12004    2                %KHA_FNC_DISCONNECT_RQS);
     1175    12005    2           KJ_CONTROL.CHAN = 0;
     1176    12006    2        CASE (%KHA_FNC_REQSTATS);
     1177    12007    2           CALL KHC$XEQ2(CURXEQTIM);
     1178    12008    2           KJ_STATS.SCHXEQTIM = CURXEQTIM - KJ_STATS.USRSTT.INPINTISATIM;
     1179    12009    2           IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_FEI) AND
     1180    12010    2                KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_FEI) THEN
     1181    12011    2                CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(KJ_STATS));
     1182    12012    2        END;
     1183    12013    1        RETURN;
     1184    12014
     1185    12015    1   END KJF$ADM;

PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:237  
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KJF$ADM.

   Procedure KJF$ADM requires 113 words for executable code.
   Procedure KJF$ADM requires 14 words of local(AUTO) storage.

    No errors detected in file KJF$FEI.:E05TSI    .

PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:238  

 Object Unit name= KJF$ADM                                    File name= KJF$FEI.:E05TOU
 UTS= JUL 30 '97 00:52:02.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   DCB   even  none     0      0  M$CQ
    1   Proc  even  none   113     71  KJF$ADM
    2  RoData even  none     3      3  KJF$ADM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KJF$ADM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KHC$XEQ2
 yes     yes           Std       2 KHA$SNDSTT
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_AALT
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CQ                                  KJ_CTX$                               KJ_CONTROL
     KJ_STATS                         r    G$ROS$
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:239  


     1129        1        /*T***********************************************************/
     1130        2        /*T*                                                         */
     1131        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1132        4        /*T*                                                         */
     1133        5        /*T***********************************************************/
     1134        6        KJF$ADM: PROC (KH$ADMIN_FPT) ALTRET;

      6   1 000000  D380 0000 0000  xent KJF$ADM         LNJ,B5   X6A_AUTO_1
          1 000003       000E 0001                       DC       14,1

     1135        7
     1136        8        /* Includes */
     1137        9        %INCLUDE KH_MACRO_C;
     1138      752        %INCLUDE KJ_DATA_R;
     1139    10993        %INCLUDE KH$CHN;
     1140    11115        %INCLUDE KHA_FNC_E;
     1141    11215        %INCLUDE KN_ERRORS_C;
     1142    11279        %INCLUDE K_ID_E;
     1143    11329        /*ent defs */
     1144    11330    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
     1145    11331    1   DCL KHC$XEQ2 ENTRY(1) ALTRET;
     1146    11332    1   DCL CURXEQTIM UBIN(32);
     1147    11333        /**/
     1148    11334        %KL_REQSTATS;
     1149    11628        %K#ENTID_E;
     1150    11647
     1151    11648
     1152    11649        /* Parameters */
     1153    11650        %KH$ADMIN_FPT (STCLASS="");
     1154    11861        %KH$CHN (STCLASS="BASED(CHN$)");
     1155    11985
     1156    11986    1   DCL CHN$ PTR;
     1157    11987
     1158    11988        %EJECT;
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:240  
     1159    11989
     1160    11990    2        DO CASE (KH$ADMIN_FPT.FNC);

  11990   1 000005  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          1 000007  B806                                 LDR,R3   ,B6
          1 000008  3D0E                                 CMV,R3   14
          1 000009  0281 0064                            BGE      s:12013,PREL
          1 00000B  A830 0000 0011  01                   LDR,R2   s:11990+12,R3
          1 00000E  83A0 0000 001F  01                   JMP      s:11993,R2
          1 000011       004F                            DC       s:12013,PREL
          1 000012       0000                            DC       s:11993,PREL
          1 000013       0019                            DC       s:12005,PREL
          1 000014       0019                            DC       s:12005,PREL
          1 000015       001E                            DC       s:12007,PREL
          1 000016       004F                            DC       s:12013,PREL
          1 000017       004F                            DC       s:12013,PREL
          1 000018       0019                            DC       s:12005,PREL
          1 000019       004F                            DC       s:12013,PREL
          1 00001A       004F                            DC       s:12013,PREL
          1 00001B       004F                            DC       s:12013,PREL
          1 00001C       004F                            DC       s:12013,PREL
          1 00001D       004F                            DC       s:12013,PREL
          1 00001E       0019                            DC       s:12005,PREL

     1161    11991
     1162    11992    2        CASE (%KHA_FNC_ENABLE);

     1163    11993    2           IF KJ_CONTROL.CHAN ~= 0

  11993   1 00001F  E800 0000 0004  xsym                 LDR,R6   KJ_CONTROL+4
          1 000022  6901 0009                            BEZ,R6   s:11998,PREL

     1164    11994    3           THEN DO;

     1165    11995    3                KH$ADMIN_FPT.RESULTS.ERR# = %E$ILGLTRANS;

  11995   1 000024  D870 2758                            LDR,R5   10072,IMO
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:241  
          1 000026  DAC6 0010                            SRM,R5,'FFF8'X    16,B6
          1 000028       FFF8

     1166    11996    3                ALTRETURN;

  11996   1 000029  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     1167    11997    3              END;
     1168    11998    2           CHN$ = KH$ADMIN_FPT.CHN$;

  11998   1 00002C  DCC6 000B                            LDB,B5   11,B6
          1 00002E  DFC7 0008                            STB,B5   CHN$,AUTO

     1169    11999    2           KJ_CONTROL.CHAN = KH$CHN.CHNBIT0_9 * 64;

  11999   1 000030  E805                                 LDR,R6   ,B5
          1 000031  E570 FFC0                            AND,R6   -64,IMO
          1 000033  EF00 0000 0004  xsym                 STR,R6   KJ_CONTROL+4
          1 000036  0F81 0037                            B        s:12013,PREL

     1170    12000
     1171    12001    2        CASE (%KHA_FNC_DISABLE,

     1172    12002    2                %KHA_FNC_KILL,
     1173    12003    2                %KHA_FNC_PARTITION,
     1174    12004    2                %KHA_FNC_DISCONNECT_RQS);
     1175    12005    2           KJ_CONTROL.CHAN = 0;

  12005   1 000038  8700 0000 0004  xsym                 CL       KJ_CONTROL+4
          1 00003B  0F81 0032                            B        s:12013,PREL

     1176    12006    2        CASE (%KHA_FNC_REQSTATS);

     1177    12007    2           CALL KHC$XEQ2(CURXEQTIM);

  12007   1 00003D  DBC7 0006                            LAB,B5   CURXEQTIM,AUTO
          1 00003F  DFC7 000A                            STB,B5   CHN$+2,AUTO
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:242  
          1 000041  BBC7 000A                            LAB,B3   CHN$+2,AUTO
          1 000043  CBF0 0100                            LAB,B4   256,IMO
          1 000045  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          1 000048       0001                            DC       s:12008,PREL

     1178    12008    2           KJ_STATS.SCHXEQTIM = CURXEQTIM - KJ_STATS.USRSTT.INPINTISATIM;

  12008   1 000049  8CC7 0006                            LDI      CURXEQTIM,AUTO
          1 00004B  8480 0000 0018  xsym                 SID      KJ_STATS+24
          1 00004E  8D00 0000 002C  xsym                 SDI      KJ_STATS+44

     1179    12009    2           IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_FEI) AND

  12009   1 000051  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          1 000053  DCC6 0009                            LDB,B5   9,B6
          1 000055  82C5 0012                            LB,'1000'X        18,B5
          1 000057       1000
          1 000058  0581 0015                            BBF      s:12013,PREL
          1 00005A  82C5 0010                            LB,'1000'X        16,B5
          1 00005C       1000
          1 00005D  0581 0010                            BBF      s:12013,PREL

     1180    12010    2                KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_FEI) THEN
     1181    12011    2                CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(KJ_STATS));

  12011   1 00005F  CB80 0000 0000  02                   LAB,B4   0
          1 000062  CFC7 000C                            STB,B4   CHN$+4,AUTO
          1 000064  DFC7 000A                            STB,B5   CHN$+2,AUTO
          1 000066  BBC7 000A                            LAB,B3   CHN$+2,AUTO
          1 000068  CBF0 0200                            LAB,B4   512,IMO
          1 00006A  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          1 00006D       0001                            DC       s:12013,PREL

     1182    12012    2        END;

     1183    12013    1        RETURN;

PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:243  
  12013   1 00006E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
     1184    12014
     1185    12015    1   END KJF$ADM;

PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:244  
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KJ_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KJ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KJF$ADM.
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:245  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KH$ADMIN_FPT              8-0-0/w PTR         r     1 CHN$
     6-0-0/w UBIN(32)    r     1 CURXEQTIM                 *0-0-0/w STRC(288)   r     1 KH$ADMIN_FPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(160)   r     1 KJ_CONTROL                 0-0-0/w PTR         r     1 KJ_CTX$
     0-0-0/w STRC(864)   r     1 KJ_STATS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(320)   r     1 KL_REQSTATS


   Procedure KJF$ADM requires 113 words for executable code.
   Procedure KJF$ADM requires 14 words of local(AUTO) storage.

    No errors detected in file KJF$FEI.:E05TSI    .
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:246  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:247  
          MINI XREF LISTING

CHN$
     11986**DCL     11876--IMP-PTR 11998<<ASSIGN  11999>>ASSIGN
CURXEQTIM
     11332**DCL     12007<>CALL    12008>>ASSIGN
KH$ADMIN_FPT
     11665**DCL         6--PROC
KH$ADMIN_FPT.CHN$
     11792**DCL     11998>>ASSIGN
KH$ADMIN_FPT.CTX$
     11721**DCL     12009>>IF      12009>>IF      12011>>CALL
KH$ADMIN_FPT.FNC
     11666**DCL     11990>>DOCASE
KH$ADMIN_FPT.RESULTS.ERR#
     11844**DCL     11995<<ASSIGN
KH$ADMIN_FPT.TERMID.TERM
     11689**DCL     11698--REDEF
KH$CHN.CHNBIT0_9
     11883**DCL     11999>>ASSIGN
KH$CHN.TERMID.TERM
     11972**DCL     11981--REDEF
KHA$SNDSTT
     11330**DCL-ENT 12011--CALL
KHC$XEQ2
     11331**DCL-ENT 12007--CALL
KJ_CONTROL.CHAN
      9871**DCL     11993>>IF      11999<<ASSIGN  12005<<ASSIGN
KJ_CTX$
      9770**DCL      9770--IMP-PTR
KJ_GH_IO_INIT.CAS.CHN
     10484**DCL     10484--REDEF
KJ_GH_IO_INIT.DAS
     10485**DCL     10486--REDEF   10487--REDEF
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:248  
KJ_GH_IO_INTL66.CAS.CHN
     10500**DCL     10500--REDEF
KJ_GH_IO_INTL66.DAS
     10501**DCL     10502--REDEF   10503--REDEF
KJ_INIT_MSG.FPT.RLCID.GENERATION
     10327**DCL     10328--REDEF
KJ_INIT_MSG.FPT.RLCID.LDCTX
     10328**DCL     10328--REDEF
KJ_INIT_MSG.FPT.TERMINAL_ID.TERM
     10316**DCL     10325--REDEF
KJ_INIT_MSG.FUNCTION
     10241**DCL     10241--REDEF
KJ_INIT_MSG.UID
     10271**DCL     10271--REDEF   10271--REDEF
KJ_IOLD_BARR.CHN
     10454**DCL     10454--REDEF
KJ_IOLD_DCWLIST.CHN
     10469**DCL     10469--REDEF
KJ_STATS
      9887**DCL     12011--CALL
KJ_STATS.REQSTATS.DSPMSK
     10133**DCL     10139--REDEF
KJ_STATS.REQSTATS.SLCMSK
     10174**DCL     10181--REDEF
KJ_STATS.SCHXEQTIM
     10213**DCL     12008<<ASSIGN
KJ_STATS.USRSTT.INPINTISATIM
     10204**DCL     12008>>ASSIGN
KJ_TERM_MSG.FUNCTION
     10359**DCL     10359--REDEF
KJ_TERM_MSG.UID
     10389**DCL     10389--REDEF   10389--REDEF
KL_REQSTATS
     11486**DCL     12011<>CALL
KL_REQSTATS.DSPENT
     11582**DCL     12009>>IF
PL6.E3A0      #008=KJF$ADM File=KJF$FEI.:E05TSI                                  WED 07/30/97 00:52 Page:249  
KL_REQSTATS.DSPMSK
     11576**DCL     11582--REDEF
KL_REQSTATS.SLCENT
     11624**DCL     12009>>IF
KL_REQSTATS.SLCMSK
     11617**DCL     11624--REDEF
