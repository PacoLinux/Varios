VERSION A06

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8ES$SCANNER :PROC NOAUTO;
        7        7        /*M* Z8ES$SCANNER - Scans next symbol */
        8        8
        9        9        /*P*
       10       10               NAME:  Z8ES$SCANNER
       11       11            PURPOSE:  Locates the next token in the current source line and returns
       12       12                      it in LEX_SYMBOL.
       13       13        */
       14       14
       15       15        /*D*
       16       16               NAME:  Z8ES$SCANNER
       17       17               CALL:  CALL Z8ES$SCANNER
       18       18
       19       19             OUTPUT:  LEX_SYMBOL -- Symbol that was scanned.
       20       20
       21       21        DESCRIPTION:  This procedure places the next symbol in LEX_SYMBOL.  The PL6
       22       22                      built-in subroutine SEARCH is used to scan the symbols.
       23       23                      Source lines are operated on one at a time and SEARCH is used
       24       24                      to find the next non-blank character.  This drives a case
       25       25                      statement which breaks the symbol into a certain class.
       26       26
       27       27                      The scanner searches for a COBOL separator for this type
       28       28                      of symbol.  The scanner determines if the separator is valid
       29       29                      and returns the symbol.  No errors for illegal symbols are
       30       30                      handled by the scanner.  In the case where the separator is
       31       31                      invalid, either the token type is set to illegal, or
       32       32                      LEX_SYMBOL.B.DELIM_ERROR is set to indicate the error.
       33       33        */
       34       34
       35       35        %SET PHASE = 1;
       36       36
       37       37        %INCLUDE Z9A_FLAGS;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:2    
       38       51        %INCLUDE Z8A_DEFC;
       39      119        %INCLUDE Z8A_COMCOM;
       40      769        %INCLUDE Z8A_DNT;
       41      990        %INCLUDE Z8E_WINDOW;
       42     3060        %INCLUDE Z8E_TABLES;
       43     3613        %INCLUDE Z8E_STACKS;
       44     5879        %INCLUDE Z8E_BUFFERS;
       45     6069        %INCLUDE Z8E_O1COM ;
       46     6830
       47     6831
       48     6832    1   DCL STOP_SCAN_FLAG BOOLEAN;
       49     6833
       50     6834    1   DCL 1 RESTART_INFO STATIC,
       51     6835    1         2 LINE SBIN WORD,
       52     6836    1         2 COLUMN SBIN WORD,
       53     6837    1         2 LEVEL  SBIN WORD,
       54     6838    1         2 DEBUG_TOKEN BOOLEAN;
       55     6839
       56     6840    1   DCL 1 BASED$TABLE ALIGNED BASED(TABLE$),
       57     6841    1         2 * (0:511) UBIN(9) CALIGNED;
       58     6842    1   DCL TABLE$ PTR;
       59     6843
       60     6844        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:3    
       61     6845        /*
       62     6846          BUFFER.CLASS is composed of:
       63     6847
       64     6848             %SPACE
       65     6849             %COMMA              ,
       66     6850             %SEMICOLON          ;
       67     6851             %ILLEGAL_CHARACTER
       68     6852             %DOUBLE_QUOTE       "
       69     6853             %SINGLE_QUOTE       ' or `' ;
       70     6854             %LEFT_PAREN         (
       71     6855             %RIGHT_PAREN        )
       72     6856             %STAR               *
       73     6857             %PLUS               +
       74     6858             %MINUS              -
       75     6859             %PERIOD             .
       76     6860             %SLASH              /
       77     6861             %COLON              :
       78     6862             %LESS_THAN          <
       79     6863             %GREATER_THAN       >
       80     6864             %EQUAL              =
       81     6865             %UP_ARROW           ^
       82     6866             %DOLLAR             $
       83     6867             %UNDER_SCORE        _
       84     6868             %DIGIT              0-9
       85     6869             %LETTER             a-z, A-Z, except e and E
       86     6870             %LETTER_E           e or E
       87     6871        */
       88     6872        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:4    
       89     6873        /* GET_NEXT_SCANNER_LINE is called to obtain continuation lines
       90     6874           when required */
       91     6875    1   DCL GET_NEXT_SCANNER_LINE EPTR EXT;
       92     6876
       93     6877        /*B*
       94     6878            SIZE_VARS:
       95     6879
       96     6880               SEARCH_SIZE -- Length of the current string being scanned
       97     6881                              (BUFFER.COLUMN - SYMBOL_START_LOCATION).  Used when placing
       98     6882                              the symbol in LEX_SYMBOL.SYMBOL.
       99     6883
      100     6884               SYMBOL_START_LOCATION -- Starting column of the current string being
      101     6885                                        scanned.
      102     6886
      103     6887        */
      104     6888
      105     6889    1   DCL SEARCH_SIZE SBIN WORD;
      106     6890    1   DCL SYMBOL_START_LOCATION SBIN WORD;
      107     6891
      108     6892        /* Temporary label creation */
      109     6893        %SET LABNUM = 1;
      110     6894
      111     6895        /*V* GCOS_PRECAUTION -- Because of a known hardware bug it is necessary to
      112     6896                                make sure certain read-only tables are in real
      113     6897                                memory before they are referenced by EIS
      114     6898                                instructions, under penalty of IPR ON MISSING PAGE.
      115     6899                                                                            */
      116     6900
      117     6901        %IF GCOS;
      119     6903        %ENDIF;
      120     6904        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:5    
      121     6905        /*V*
      122     6906            CONCAT_SYMBOL -- Concatenate the characters in the source line starting at
      123     6907                            the symbol start and includes all characters up to the
      124     6908                            current buffer position.   The size field is then updated
      125     6909                            to be the total size.
      126     6910        */
      127     6911
      128     6912
      129     6913        %MACRO CONCAT_SYMBOL ;
      130     6914             DO;
      131     6915               SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
      132     6916               IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
      133     6917                 SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
      134     6918               SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
      135     6919                   = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
      136     6920               LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
      137     6921               SYMBOL_START_LOCATION = BUFFER.COLUMN;
      138     6922             END;
      139     6923        %MEND;
      140     6924        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:6    
      141     6925        %MACRO SCAN_SEARCH_THIS_LINE(TABLE=);
      142     6926
      143     6927          DO;
      144     6928            CALL SEARCH(BUFFER.COLUMN,
      145     6929                        BUFFER.CLASS,
      146     6930                        TABLE,
      147     6931                        BUFFER_LINE,
      148     6932                        BUFFER.COLUMN);
      149     6933          END;
      150     6934
      151     6935        %MEND;
      152     6936        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:7    
      153     6937        %MACRO SCAN_SEARCH(TABLE=);
      154     6938
      155     6939          DO;
      156     6940            CALL SEARCH(BUFFER.COLUMN,
      157     6941                        BUFFER.CLASS,
      158     6942                        TABLE,
      159     6943                        BUFFER_LINE,
      160     6944                        BUFFER.COLUMN)
      161     6945                 WHENALTRETURN
      162     6946                   DO;
      163     6947                     IF BUFFER.CLASS = %END_OF_LINE
      164     6948                          AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      165     6949                       CALL CONTINUATION (TABLE);
      166     6950                   END;
      167     6951          END;
      168     6952
      169     6953        %MEND;
      170     6954        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:8    
      171     6955        /*V*
      172     6956            SCAN_BLANKS -- Beginning at the current column scan through all delimiters.
      173     6957                           BUFFER.COLUMN and BUFFER.CLASS will be updated to the new
      174     6958                           symbol.
      175     6959        */
      176     6960
      177     6961
      178     6962        %MACRO SCAN_BLANKS;
      179     6963
      180     6964             DO;
      181     6965               %SCAN_SEARCH(TABLE=BLANK_SCAN_TABLE);
      182     6966             END;
      183     6967        %MEND;
      184     6968
      185     6969        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:9    
      186     6970        %MACRO ADV_BUFFER_COLUMN_THIS_LINE(TABLE=ASCII_SEARCH_TABLE);
      187     6971
      188     6972          DO;
      189     6973            BUFFER.COLUMN = BUFFER.COLUMN + 1;
      190     6974            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
      191     6975          END;
      192     6976
      193     6977        %MEND;
      194     6978        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:10   
      195     6979        %MACRO ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=ASCII_SEARCH_TABLE);
      196     6980                DO;
      197     6981                  %CONCAT_SYMBOL;
      198     6982                  CALL GET_NEXT_SCANNER_LINE;
      199     6983                  SYMBOL_START_LOCATION = BUFFER.COLUMN;
      200     6984                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
      201     6985                END;
      202     6986        %MEND;
      203     6987        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:11   
      204     6988        %MACRO ADV_BUFFER_COLUMN(TABLE=ASCII_SEARCH_TABLE);
      205     6989
      206     6990          DO;
      207     6991            BUFFER.COLUMN = BUFFER.COLUMN + 1;
      208     6992            CALL SEARCH(BUFFER.COLUMN,
      209     6993                        BUFFER.CLASS,
      210     6994                        TABLE,
      211     6995                        BUFFER_LINE,
      212     6996                        BUFFER.COLUMN)
      213     6997             WHENALTRETURN
      214     6998              DO;
      215     6999                IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      216     7000                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
      217     7001              END;
      218     7002          END;
      219     7003        %MEND;
      220     7004        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:12   
      221     7005        %MACRO INITIALIZE_SYMBOL;
      222     7006          DO;
      223     7007             /* Initialize token */
      224     7008             LEX_SYMBOL.LINE    = BUFFER.ISN;
      225     7009             LEX_SYMBOL.COLUMN  = BUFFER.COLUMN;
      226     7010             LEX_SYMBOL.FLAGS   = FALSE;
      227     7011             LEX_SYMBOL.TYPE    = BUFFER.CLASS;
      228     7012             LEX_SYMBOL.SIZE    = 0;
      229     7013             LEX_SYMBOL.LEVEL  = BUFFER.LEVEL;
      230     7014             LEX_SYMBOL.NEXT$ = ADDR(NIL);
      231     7015             LEX_SYMBOL.B.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
      232     7016          END;
      233     7017        %MEND;
      234     7018        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:13   
      235     7019        %MACRO MARK_END_OF_SYMBOL;
      236     7020          DO;
      237     7021            LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
      238     7022            LEX_SYMBOL.END_LINE   = BUFFER.ISN;
      239     7023          END;
      240     7024        %MEND;
      241     7025        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:14   
      242     7026        %MACRO SAVE_RESTART_INFO;
      243     7027          DO;
      244     7028            RESTART_INFO.LINE   = BUFFER.ISN;
      245     7029            RESTART_INFO.COLUMN = BUFFER.COLUMN;
      246     7030            RESTART_INFO.LEVEL = BUFFER.LEVEL;
      247     7031            RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
      248     7032          END;
      249     7033        %MEND;
      250     7034        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:15   
      251     7035        %MACRO TRANSLATE_TO_UPPER_CASE;
      252     7036           CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),
      253     7037                      LOWER_TO_UPPER_CASE,
      254     7038                      SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
      255     7039        %MEND;
      256     7040        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:16   
      257     7041        %MACRO NEXT_TWO_CHARS_ARE_PSEUDO;
      258     7042
      259     7043          (BUFFER.CLASS = %EQUAL
      260     7044            AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
      261     7045            AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      262     7046
      263     7047        %MEND;
      264     7048        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:17   
      265     7049        %LIST;
      266     7050    1   CONTINUATION : PROC (TABLE);
      267     7051
      268     7052    2     DCL TABLE(0:511) UBIN(9) ALIGNED;
      269     7053
      270     7054    3     DO WHILE BUFFER.CLASS = %END_OF_LINE
      271     7055    3                 AND BUFFER.LINE_TYPE.LINE_CONTINUED;
      272     7056            %CONCAT_SYMBOL;
              7057    4        DO;
              7058    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7059    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7060    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7061    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7062    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7063    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7064    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7065    4        END;
      273     7067    3       LEX_SYMBOL.B.CONTINUED_TOKEN = TRUE;
      274     7068    3       CALL GET_NEXT_SCANNER_LINE;
      275     7069    3       SYMBOL_START_LOCATION = BUFFER.COLUMN;
      276     7070            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7071    4     DO;
              7072    4       CALL SEARCH(BUFFER.COLUMN,
              7073    4                   BUFFER.CLASS,
              7074    4                   TABLE,
              7075    4                   BUFFER_LINE,
              7076    4                   BUFFER.COLUMN);
              7077    4     END;
      277     7079    3     END;
      278     7080
      279     7081    2   END CONTINUATION;
      280     7082        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:18   
      281     7083    1   CHECK_RELATIONAL_SEPARATOR : PROC;
      282     7084    3     DO CASE (BUFFER.CLASS);
      283     7085    3       CASE (%DIGIT, %LETTER, %LETTER_E, %PLUS, %MINUS);
      284     7086              %CONCAT_SYMBOL;
              7087    4        DO;
              7088    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7089    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7090    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7091    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7092    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7093    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7094    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7095    4        END;
      285     7097              %MARK_END_OF_SYMBOL;
              7098    4     DO;
              7099    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7100    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7101    4     END;
      286     7103    3       CASE (ELSE);
      287     7104    3         CALL CHECK_NORMAL_SEPARATOR;
      288     7105    3     END; /* CASE */
      289     7106    2   END CHECK_RELATIONAL_SEPARATOR;
      290     7107        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:19   
      291     7108    1   CHECK_NORMAL_SEPARATOR : PROC;
      292     7109
      293     7110    2   CHECK_SEPARATOR:
      294     7111
      295     7112    3     DO CASE (BUFFER.CLASS);
      296     7113
      297     7114    3       CASE(%SPACE, %END_OF_LINE, %COLON, %LEFT_PAREN, %RIGHT_PAREN);
      298     7115
      299     7116              %CONCAT_SYMBOL;
              7117    4        DO;
              7118    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7119    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7120    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7121    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7122    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7123    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7124    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7125    4        END;
      300     7127              %MARK_END_OF_SYMBOL;
              7128    4     DO;
              7129    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7130    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7131    4     END;
      301     7133
      302     7134    3       CASE(%COMMA, %SEMICOLON);
      303     7135
      304     7136              %MARK_END_OF_SYMBOL;
              7137    4     DO;
              7138    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7139    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7140    4     END;
      305     7142              %ADV_BUFFER_COLUMN;
              7143    4     DO;
              7144    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7145    4       CALL SEARCH(BUFFER.COLUMN,
              7146    4                   BUFFER.CLASS,
              7147    4                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:20   
              7148    4                   BUFFER_LINE,
              7149    4                   BUFFER.COLUMN)
              7150    4        WHENALTRETURN
              7151    5         DO;
              7152    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7153                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7154    6           DO;
              7155                  %CONCAT_SYMBOL;
              7156    7        DO;
              7157    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7158    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7159    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7160    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7161    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7162    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7163    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7164    7        END;
              7166    6             CALL GET_NEXT_SCANNER_LINE;
              7167    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7168                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7169    7     DO;
              7170    7       CALL SEARCH(BUFFER.COLUMN,
              7171    7                   BUFFER.CLASS,
              7172    7                   TABLE,
              7173    7                   BUFFER_LINE,
              7174    7                   BUFFER.COLUMN);
              7175    7     END;
              7177    6           END;
              7179    5         END;
              7180    4     END;
      306     7182              %CONCAT_SYMBOL;
              7183    4        DO;
              7184    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7185    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7186    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7187    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7188    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:21   
              7189    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7190    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7191    4        END;
      307     7193    3         IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      308     7194                    %NEXT_TWO_CHARS_ARE_PSEUDO;
              7195    3     (BUFFER.CLASS = %EQUAL
              7196    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7197    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      309     7199    3                                           THEN
      310     7200    4           DO;
      311     7201    4             LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;
      312     7202    4           END;
      313     7203    3         ELSE
      314     7204    4           DO;
      315     7205    4             GOTO SCAN_SEPARATOR;
      316     7206    4           END;
      317     7207
      318     7208    3       CASE(%PERIOD);
      319     7209
      320     7210              %SAVE_RESTART_INFO;
              7211    4     DO;
              7212    4       RESTART_INFO.LINE   = BUFFER.ISN;
              7213    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;
              7214    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;
              7215    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              7216    4     END;
      321     7218              %CONCAT_SYMBOL;
              7219    4        DO;
              7220    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7221    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7222    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7223    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7224    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7225    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7226    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7227    4        END;
      322     7229              %MARK_END_OF_SYMBOL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:22   
              7230    4     DO;
              7231    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7232    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7233    4     END;
      323     7235              %ADV_BUFFER_COLUMN;
              7236    4     DO;
              7237    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7238    4       CALL SEARCH(BUFFER.COLUMN,
              7239    4                   BUFFER.CLASS,
              7240    4                   TABLE,
              7241    4                   BUFFER_LINE,
              7242    4                   BUFFER.COLUMN)
              7243    4        WHENALTRETURN
              7244    5         DO;
              7245    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7246                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7247    6           DO;
              7248                  %CONCAT_SYMBOL;
              7249    7        DO;
              7250    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7251    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7252    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7253    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7254    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7255    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7256    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7257    7        END;
              7259    6             CALL GET_NEXT_SCANNER_LINE;
              7260    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7261                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7262    7     DO;
              7263    7       CALL SEARCH(BUFFER.COLUMN,
              7264    7                   BUFFER.CLASS,
              7265    7                   TABLE,
              7266    7                   BUFFER_LINE,
              7267    7                   BUFFER.COLUMN);
              7268    7     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:23   
              7270    6           END;
              7272    5         END;
              7273    4     END;
      324     7275    3         IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      325     7276                    %NEXT_TWO_CHARS_ARE_PSEUDO;
              7277    3     (BUFFER.CLASS = %EQUAL
              7278    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7279    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      326     7281    3                                           THEN
      327     7282    4           DO;
      328     7283    4             SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;
      329     7284    4           END;
      330     7285    3         ELSE
      331     7286    4           DO;
      332     7287    4             GOTO SCAN_SEPARATOR;
      333     7288    4           END;
      334     7289
      335     7290    3       CASE(%EQUAL);
      336     7291
      337     7292              %SAVE_RESTART_INFO;
              7293    4     DO;
              7294    4       RESTART_INFO.LINE   = BUFFER.ISN;
              7295    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;
              7296    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;
              7297    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              7298    4     END;
      338     7300              %CONCAT_SYMBOL;
              7301    4        DO;
              7302    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7303    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7304    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7305    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7306    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7307    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7308    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7309    4        END;
      339     7311              %MARK_END_OF_SYMBOL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:24   
              7312    4     DO;
              7313    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7314    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7315    4     END;
      340     7317              %ADV_BUFFER_COLUMN_THIS_LINE;
              7318    4     DO;
              7319    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7320            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7321    5     DO;
              7322    5       CALL SEARCH(BUFFER.COLUMN,
              7323    5                   BUFFER.CLASS,
              7324    5                   TABLE,
              7325    5                   BUFFER_LINE,
              7326    5                   BUFFER.COLUMN);
              7327    5     END;
              7329    4     END;
      341     7331    3         IF BUFFER.CLASS = %EQUAL THEN
      342     7332    4           DO;
      343     7333    4             SCANNER_STATE = %SCANNER_STATE_RESTART_EQUAL;
      344     7334    4           END;
      345     7335    3         ELSE
      346     7336    4           DO;
      347     7337    4             GOTO SCAN_SEPARATOR;
      348     7338    4           END;
      349     7339
      350     7340    3       CASE(%DOUBLE_QUOTE, %SINGLE_QUOTE);
      351     7341
      352     7342              %CONCAT_SYMBOL;
              7343    4        DO;
              7344    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7345    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7346    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7347    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7348    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7349    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7350    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7351    4        END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:25   
      353     7353              %MARK_END_OF_SYMBOL;
              7354    4     DO;
              7355    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7356    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7357    4     END;
      354     7359    3         IF NOT O1COM.PSEUDO_TEXT_FLAG THEN
      355     7360    3           LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      356     7361
      357     7362    3       CASE(ELSE);
      358     7363
      359     7364    3         GOTO SCAN_SEPARATOR;
      360     7365
      361     7366    3     END;  /* DO CASE */
      362     7367
      363     7368    2     RETURN;
      364     7369
      365     7370
      366     7371    2   SCAN_SEPARATOR:
      367     7372
      368     7373    2     LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      369     7374          %SCAN_SEARCH(TABLE=SEPARATORS_TABLE);
              7375    3     DO;
              7376    3       CALL SEARCH(BUFFER.COLUMN,
              7377    3                   BUFFER.CLASS,
              7378    3                   TABLE,
              7379    3                   BUFFER_LINE,
              7380    3                   BUFFER.COLUMN)
              7381    3            WHENALTRETURN
              7382    4              DO;
              7383    4                IF BUFFER.CLASS = %END_OF_LINE
              7384    4                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7385    4                  CALL CONTINUATION (TABLE);
              7386    4              END;
              7387    3     END;
      370     7389    2     GOTO CHECK_SEPARATOR;
      371     7390
      372     7391    2   END CHECK_NORMAL_SEPARATOR;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:26   
      373     7392        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:27   
      374     7393    1   SCAN_EXPONENT : PROC;
      375     7394
      376     7395    2     IF BUFFER.CLASS = %LETTER_E THEN
      377     7396    3       DO;
      378     7397    3         SUBSTR(BUFFER_LINE,BUFFER.COLUMN,1) = 'E';  /* UPPER CASE */
      379     7398              %ADV_BUFFER_COLUMN;
              7399    4     DO;
              7400    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7401    4       CALL SEARCH(BUFFER.COLUMN,
              7402    4                   BUFFER.CLASS,
              7403    4                   TABLE,
              7404    4                   BUFFER_LINE,
              7405    4                   BUFFER.COLUMN)
              7406    4        WHENALTRETURN
              7407    5         DO;
              7408    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7409                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7410    6           DO;
              7411                  %CONCAT_SYMBOL;
              7412    7        DO;
              7413    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7414    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7415    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7416    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7417    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7418    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7419    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7420    7        END;
              7422    6             CALL GET_NEXT_SCANNER_LINE;
              7423    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7424                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7425    7     DO;
              7426    7       CALL SEARCH(BUFFER.COLUMN,
              7427    7                   BUFFER.CLASS,
              7428    7                   TABLE,
              7429    7                   BUFFER_LINE,
              7430    7                   BUFFER.COLUMN);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:28   
              7431    7     END;
              7433    6           END;
              7435    5         END;
              7436    4     END;
      380     7438    3         IF BUFFER.CLASS = %PLUS
      381     7439    3              OR BUFFER.CLASS = %MINUS THEN
      382     7440    4           DO;
      383     7441                  %ADV_BUFFER_COLUMN;
              7442    5     DO;
              7443    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7444    5       CALL SEARCH(BUFFER.COLUMN,
              7445    5                   BUFFER.CLASS,
              7446    5                   TABLE,
              7447    5                   BUFFER_LINE,
              7448    5                   BUFFER.COLUMN)
              7449    5        WHENALTRETURN
              7450    6         DO;
              7451    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7452                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7453    7           DO;
              7454                  %CONCAT_SYMBOL;
              7455    8        DO;
              7456    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7457    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7458    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7459    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7460    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7461    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7462    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7463    8        END;
              7465    7             CALL GET_NEXT_SCANNER_LINE;
              7466    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7467                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7468    8     DO;
              7469    8       CALL SEARCH(BUFFER.COLUMN,
              7470    8                   BUFFER.CLASS,
              7471    8                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:29   
              7472    8                   BUFFER_LINE,
              7473    8                   BUFFER.COLUMN);
              7474    8     END;
              7476    7           END;
              7478    6         END;
              7479    5     END;
      384     7481                  %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7482    5     DO;
              7483    5       CALL SEARCH(BUFFER.COLUMN,
              7484    5                   BUFFER.CLASS,
              7485    5                   TABLE,
              7486    5                   BUFFER_LINE,
              7487    5                   BUFFER.COLUMN)
              7488    5            WHENALTRETURN
              7489    6              DO;
              7490    6                IF BUFFER.CLASS = %END_OF_LINE
              7491    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7492    6                  CALL CONTINUATION (TABLE);
              7493    6              END;
              7494    5     END;
      385     7496    4           END;
      386     7497    3         ELSE
      387     7498    4           DO;
      388     7499    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      389     7500    4           END;
      390     7501    3       END;
      391     7502
      392     7503    2     CALL CHECK_NORMAL_SEPARATOR;
      393     7504
      394     7505    2   END SCAN_EXPONENT;
      395     7506        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:30   
      396     7507    1   SCAN_NUMERIC_LITERAL : PROC;
      397     7508
      398     7509          %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7510    3     DO;
              7511    3       CALL SEARCH(BUFFER.COLUMN,
              7512    3                   BUFFER.CLASS,
              7513    3                   TABLE,
              7514    3                   BUFFER_LINE,
              7515    3                   BUFFER.COLUMN)
              7516    3            WHENALTRETURN
              7517    4              DO;
              7518    4                IF BUFFER.CLASS = %END_OF_LINE
              7519    4                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7520    4                  CALL CONTINUATION (TABLE);
              7521    4              END;
              7522    3     END;
      399     7524
      400     7525    3     DO CASE(BUFFER.CLASS);
      401     7526
      402     7527    3       CASE(%PERIOD);
      403     7528
      404     7529              %MARK_END_OF_SYMBOL;
              7530    4     DO;
              7531    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7532    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7533    4     END;
      405     7535              %SAVE_RESTART_INFO;
              7536    4     DO;
              7537    4       RESTART_INFO.LINE   = BUFFER.ISN;
              7538    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;
              7539    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;
              7540    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              7541    4     END;
      406     7543              %ADV_BUFFER_COLUMN;
              7544    4     DO;
              7545    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7546    4       CALL SEARCH(BUFFER.COLUMN,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:31   
              7547    4                   BUFFER.CLASS,
              7548    4                   TABLE,
              7549    4                   BUFFER_LINE,
              7550    4                   BUFFER.COLUMN)
              7551    4        WHENALTRETURN
              7552    5         DO;
              7553    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7554                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7555    6           DO;
              7556                  %CONCAT_SYMBOL;
              7557    7        DO;
              7558    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7559    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7560    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7561    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7562    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7563    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7564    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7565    7        END;
              7567    6             CALL GET_NEXT_SCANNER_LINE;
              7568    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7569                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7570    7     DO;
              7571    7       CALL SEARCH(BUFFER.COLUMN,
              7572    7                   BUFFER.CLASS,
              7573    7                   TABLE,
              7574    7                   BUFFER_LINE,
              7575    7                   BUFFER.COLUMN);
              7576    7     END;
              7578    6           END;
              7580    5         END;
              7581    4     END;
      407     7583              %CONCAT_SYMBOL;
              7584    4        DO;
              7585    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7586    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7587    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:32   
              7588    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7589    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7590    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7591    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7592    4        END;
      408     7594    3         IF BUFFER.CLASS = %DIGIT
      409     7595    3              OR BUFFER.CLASS = %LETTER_E THEN
      410     7596    4           DO;
      411     7597    4             IF BUFFER.CLASS = %DIGIT THEN
      412     7598                    %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7599    5     DO;
              7600    5       CALL SEARCH(BUFFER.COLUMN,
              7601    5                   BUFFER.CLASS,
              7602    5                   TABLE,
              7603    5                   BUFFER_LINE,
              7604    5                   BUFFER.COLUMN)
              7605    5            WHENALTRETURN
              7606    6              DO;
              7607    6                IF BUFFER.CLASS = %END_OF_LINE
              7608    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7609    6                  CALL CONTINUATION (TABLE);
              7610    6              END;
              7611    5     END;
      413     7613    4             LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      414     7614    4             CALL SCAN_EXPONENT;
      415     7615    4           END;
      416     7616    3         ELSE
      417     7617    3           IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      418     7618                      %NEXT_TWO_CHARS_ARE_PSEUDO;
              7619    3     (BUFFER.CLASS = %EQUAL
              7620    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7621    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      419     7623    3                                                  THEN
      420     7624    4             DO;
      421     7625    4               SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;
      422     7626    4               LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;
      423     7627    4             END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:33   
      424     7628    3           ELSE
      425     7629    4             DO;
      426     7630    4               LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      427     7631    4               CALL CHECK_NORMAL_SEPARATOR;
      428     7632    4             END;
      429     7633
      430     7634    3       CASE(%COMMA);
      431     7635
      432     7636              %MARK_END_OF_SYMBOL;
              7637    4     DO;
              7638    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7639    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7640    4     END;
      433     7642              %SAVE_RESTART_INFO;
              7643    4     DO;
              7644    4       RESTART_INFO.LINE   = BUFFER.ISN;
              7645    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;
              7646    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;
              7647    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              7648    4     END;
      434     7650              %ADV_BUFFER_COLUMN;
              7651    4     DO;
              7652    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7653    4       CALL SEARCH(BUFFER.COLUMN,
              7654    4                   BUFFER.CLASS,
              7655    4                   TABLE,
              7656    4                   BUFFER_LINE,
              7657    4                   BUFFER.COLUMN)
              7658    4        WHENALTRETURN
              7659    5         DO;
              7660    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7661                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7662    6           DO;
              7663                  %CONCAT_SYMBOL;
              7664    7        DO;
              7665    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7666    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:34   
              7667    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7668    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7669    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7670    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7671    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7672    7        END;
              7674    6             CALL GET_NEXT_SCANNER_LINE;
              7675    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7676                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7677    7     DO;
              7678    7       CALL SEARCH(BUFFER.COLUMN,
              7679    7                   BUFFER.CLASS,
              7680    7                   TABLE,
              7681    7                   BUFFER_LINE,
              7682    7                   BUFFER.COLUMN);
              7683    7     END;
              7685    6           END;
              7687    5         END;
              7688    4     END;
      435     7690              %CONCAT_SYMBOL;
              7691    4        DO;
              7692    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7693    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7694    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7695    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7696    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7697    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7698    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7699    4        END;
      436     7701    3         IF BUFFER.CLASS = %DIGIT
      437     7702    3               OR BUFFER.CLASS = %LETTER_E THEN
      438     7703    4            DO;
      439     7704                   %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7705    5     DO;
              7706    5       CALL SEARCH(BUFFER.COLUMN,
              7707    5                   BUFFER.CLASS,
              7708    5                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:35   
              7709    5                   BUFFER_LINE,
              7710    5                   BUFFER.COLUMN)
              7711    5            WHENALTRETURN
              7712    6              DO;
              7713    6                IF BUFFER.CLASS = %END_OF_LINE
              7714    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7715    6                  CALL CONTINUATION (TABLE);
              7716    6              END;
              7717    5     END;
      440     7719    4              LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      441     7720    4              CALL SCAN_EXPONENT;
      442     7721    4            END;
      443     7722    3          ELSE
      444     7723    3            IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      445     7724                      %NEXT_TWO_CHARS_ARE_PSEUDO;
              7725    3     (BUFFER.CLASS = %EQUAL
              7726    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7727    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      446     7729    3                                                  THEN
      447     7730    4              DO;
      448     7731    4                LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;
      449     7732    4              END;
      450     7733    3            ELSE
      451     7734    4              DO;
      452     7735    4                LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      453     7736    4                CALL CHECK_NORMAL_SEPARATOR;
      454     7737    4              END;
      455     7738
      456     7739    3       CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE, %MINUS);
      457     7740
      458     7741    3         IF LEX_SYMBOL.TYPE = %NUMBER THEN
      459     7742    3           LEX_SYMBOL.TYPE = %USER_WORD;
      460     7743    3         ELSE
      461     7744    3           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      462     7745              %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
              7746    4     DO;
              7747    4       CALL SEARCH(BUFFER.COLUMN,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:36   
              7748    4                   BUFFER.CLASS,
              7749    4                   TABLE,
              7750    4                   BUFFER_LINE,
              7751    4                   BUFFER.COLUMN)
              7752    4            WHENALTRETURN
              7753    5              DO;
              7754    5                IF BUFFER.CLASS = %END_OF_LINE
              7755    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7756    5                  CALL CONTINUATION (TABLE);
              7757    5              END;
              7758    4     END;
      463     7760    3         CALL CHECK_NORMAL_SEPARATOR;
      464     7761
      465     7762    3       CASE(ELSE);
      466     7763
      467     7764    3         CALL CHECK_NORMAL_SEPARATOR;
      468     7765
      469     7766    3     END;  /* do case */
      470     7767
      471     7768    2   END SCAN_NUMERIC_LITERAL;
      472     7769        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:37   
      473     7770    1   SCAN_QUOTE_LITERAL : PROC;
      474     7771
      475     7772    2     CONTINUE_DOUBLE_QUOTED_STRING : PROC;
      476     7773
      477     7774            /* Line_continued should have been checked;
      478     7775                   We should be at end_of_line */
      479     7776
      480     7777            %ADV_BUFFER_COLUMN_NEXT_LINE;
              7778    4           DO;
              7779                  %CONCAT_SYMBOL;
              7780    5        DO;
              7781    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7782    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7783    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7784    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7785    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7786    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7787    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7788    5        END;
              7790    4             CALL GET_NEXT_SCANNER_LINE;
              7791    4             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7792                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7793    5     DO;
              7794    5       CALL SEARCH(BUFFER.COLUMN,
              7795    5                   BUFFER.CLASS,
              7796    5                   TABLE,
              7797    5                   BUFFER_LINE,
              7798    5                   BUFFER.COLUMN);
              7799    5     END;
              7801    4           END;
      481     7803    3       IF BUFFER.CLASS = %DOUBLE_QUOTE THEN
      482     7804    4         DO;
      483     7805                %CONCAT_SYMBOL;
              7806    5        DO;
              7807    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7808    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7809    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:38   
              7810    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7811    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7812    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7813    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7814    5        END;
      484     7816    4           SYMBOL_START_LOCATION = BUFFER.COLUMN + 1;
      485     7817    4           STOP_SCAN_FLAG = FALSE;
      486     7818                %ADV_BUFFER_COLUMN_THIS_LINE;
              7819    5     DO;
              7820    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7821            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7822    6     DO;
              7823    6       CALL SEARCH(BUFFER.COLUMN,
              7824    6                   BUFFER.CLASS,
              7825    6                   TABLE,
              7826    6                   BUFFER_LINE,
              7827    6                   BUFFER.COLUMN);
              7828    6     END;
              7830    5     END;
      487     7832    4         END;
      488     7833    3       ELSE
      489     7834    4         DO;
      490     7835    4           LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      491     7836    4         END;
      492     7837
      493     7838    3     END CONTINUE_DOUBLE_QUOTED_STRING;
      494     7839
      495     7840
      496     7841    2     SCAN_QUOTED_NUMERIC_REP : PROC;
      497     7842
      498     7843            %ADV_BUFFER_COLUMN_THIS_LINE;
              7844    4     DO;
              7845    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7846            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7847    5     DO;
              7848    5       CALL SEARCH(BUFFER.COLUMN,
              7849    5                   BUFFER.CLASS,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:39   
              7850    5                   TABLE,
              7851    5                   BUFFER_LINE,
              7852    5                   BUFFER.COLUMN);
              7853    5     END;
              7855    4     END;
      499     7857            %SCAN_SEARCH_THIS_LINE(TABLE=DOUBLE_QUOTE_SEARCH_TABLE);
              7858    4     DO;
              7859    4       CALL SEARCH(BUFFER.COLUMN,
              7860    4                   BUFFER.CLASS,
              7861    4                   TABLE,
              7862    4                   BUFFER_LINE,
              7863    4                   BUFFER.COLUMN);
              7864    4     END;
      500     7866
      501     7867    4       DO WHILE BUFFER.CLASS = %END_OF_LINE AND BUFFER.LINE_TYPE.LINE_CONTINUED ;
      502     7868    4         CALL CONTINUE_DOUBLE_QUOTED_STRING;
      503     7869              %SCAN_SEARCH_THIS_LINE(TABLE=DOUBLE_QUOTE_SEARCH_TABLE);
              7870    5     DO;
              7871    5       CALL SEARCH(BUFFER.COLUMN,
              7872    5                   BUFFER.CLASS,
              7873    5                   TABLE,
              7874    5                   BUFFER_LINE,
              7875    5                   BUFFER.COLUMN);
              7876    5     END;
      504     7878    4       END;
      505     7879
      506     7880    3       IF BUFFER.CLASS = %DOUBLE_QUOTE THEN
      507     7881    3         STOP_SCAN_FLAG = FALSE;
      508     7882    3       ELSE
      509     7883    3         LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      510     7884
      511     7885    3     END SCAN_QUOTED_NUMERIC_REP;
      512     7886
      513     7887
      514     7888    3     DO UNTIL STOP_SCAN_FLAG;
      515     7889    3       STOP_SCAN_FLAG = TRUE;
      516     7890    3       IF O1COM.PSEUDO_TEXT_FLAG
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:40   
      517     7891    3         THEN TABLE$ = ADDR(DBL_QUOTE_PSEUDO_SEARCH_TABLE);
      518     7892    3         ELSE TABLE$ = ADDR(DOUBLE_QUOTE_SEARCH_TABLE);
      519     7893            %ADV_BUFFER_COLUMN_THIS_LINE(TABLE=BASED$TABLE);
              7894    4     DO;
              7895    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7896            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7897    5     DO;
              7898    5       CALL SEARCH(BUFFER.COLUMN,
              7899    5                   BUFFER.CLASS,
              7900    5                   TABLE,
              7901    5                   BUFFER_LINE,
              7902    5                   BUFFER.COLUMN);
              7903    5     END;
              7905    4     END;
      520     7907
      521     7908    4       DO CASE(BUFFER.CLASS);
      522     7909
      523     7910    4         CASE(%DOUBLE_QUOTE);
      524     7911                %ADV_BUFFER_COLUMN_THIS_LINE;
              7912    5     DO;
              7913    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              7914            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7915    6     DO;
              7916    6       CALL SEARCH(BUFFER.COLUMN,
              7917    6                   BUFFER.CLASS,
              7918    6                   TABLE,
              7919    6                   BUFFER_LINE,
              7920    6                   BUFFER.COLUMN);
              7921    6     END;
              7923    5     END;
      525     7925    4           IF BUFFER.CLASS = %END_OF_LINE
      526     7926    4                AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      527     7927    4             CALL CONTINUE_DOUBLE_QUOTED_STRING;
      528     7928    4           IF BUFFER.CLASS = %DOUBLE_QUOTE THEN
      529     7929    5             DO;
      530     7930    5               STOP_SCAN_FLAG = FALSE;
      531     7931    5             END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:41   
      532     7932    4           ELSE
      533     7933    4             IF BUFFER.CLASS = %DIGIT THEN
      534     7934    4               CALL SCAN_QUOTED_NUMERIC_REP;
      535     7935    4             ELSE
      536     7936    4               STOP_SCAN_FLAG = TRUE;
      537     7937
      538     7938    4         CASE(%EQUAL);
      539     7939    4           IF SUBSTR(BUFFER_LINE, BUFFER.COLUMN + 1, 1) ~= '='
      540     7940    4             THEN STOP_SCAN_FLAG = FALSE;
      541     7941    4             ELSE LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      542     7942
      543     7943    4         CASE(%END_OF_LINE);
      544     7944                %CONCAT_SYMBOL;
              7945    5        DO;
              7946    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7947    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7948    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7949    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7950    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7951    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7952    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7953    5        END;
      545     7955                /*N* Free Format -- IF NOT COMCOM.OB.FORMAT THEN */
      546     7956    5             DO;
      547     7957    5               IF BUFFER.COLUMN < O1COM.MARGIN_R THEN
      548     7958    6                 DO;
      549     7959    6                   SEARCH_SIZE = MINIMUM( O1COM.MARGIN_R - BUFFER.COLUMN,
      550     7960    6                                     %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE);
      551     7961    6                   CALL INSERT(LEX_SYMBOL.SYMBOL,
      552     7962    6                               LEX_SYMBOL.SIZE,
      553     7963    6                               SEARCH_SIZE,
      554     7964    6                               ' ');
      555     7965    6                   LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
      556     7966    6                 END;
      557     7967    5             END;
      558     7968    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      559     7969    5             DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:42   
      560     7970    5               CALL CONTINUE_DOUBLE_QUOTED_STRING;
      561     7971    5               IF NOT STOP_SCAN_FLAG THEN
      562     7972    5                 BUFFER.COLUMN = BUFFER.COLUMN - 1;
      563     7973    5             END;
      564     7974    4           ELSE
      565     7975    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      566     7976
      567     7977    4       END;
      568     7978    3     END;
      569     7979
      570     7980        %CONCAT_SYMBOL;
              7981    3        DO;
              7982    3          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              7983    3          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              7984    3            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              7985    3          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              7986    3              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7987    3          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              7988    3          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              7989    3        END;
      571     7991        %MARK_END_OF_SYMBOL;
              7992    3     DO;
              7993    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              7994    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              7995    3     END;
      572     7997
      573     7998    2   IF BUFFER.CLASS ~= %SPACE
      574     7999    2        AND BUFFER.CLASS ~= %END_OF_LINE
      575     8000    2        AND BUFFER.CLASS ~= %COMMA
      576     8001    2        AND BUFFER.CLASS ~= %SEMICOLON
      577     8002    2        AND BUFFER.CLASS ~= %PERIOD
      578     8003    2        AND BUFFER.CLASS ~= %RIGHT_PAREN
      579     8004    2        AND NOT O1COM.PSEUDO_TEXT_FLAG
      580     8005    2        AND NOT
      581     8006                     %NEXT_TWO_CHARS_ARE_PSEUDO;
              8007    2     (BUFFER.CLASS = %EQUAL
              8008    2       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:43   
              8009    2       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      582     8011    2                                           THEN
      583     8012    2     LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      584     8013
      585     8014    2   END SCAN_QUOTE_LITERAL;
      586     8015        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:44   
      587     8016    1   SCAN_APOSTROPHE_LITERAL  : PROC;
      588     8017
      589     8018    2     CONTINUE_SINGLE_QUOTED_STRING : PROC;
      590     8019
      591     8020            /* Line_continued should have been checked;
      592     8021                   We should be at end_of_line */
      593     8022
      594     8023            %ADV_BUFFER_COLUMN_NEXT_LINE;
              8024    4           DO;
              8025                  %CONCAT_SYMBOL;
              8026    5        DO;
              8027    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8028    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8029    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8030    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8031    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8032    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8033    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8034    5        END;
              8036    4             CALL GET_NEXT_SCANNER_LINE;
              8037    4             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8038                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8039    5     DO;
              8040    5       CALL SEARCH(BUFFER.COLUMN,
              8041    5                   BUFFER.CLASS,
              8042    5                   TABLE,
              8043    5                   BUFFER_LINE,
              8044    5                   BUFFER.COLUMN);
              8045    5     END;
              8047    4           END;
      595     8049    3       IF BUFFER.CLASS = %SINGLE_QUOTE THEN
      596     8050    4         DO;
      597     8051                %CONCAT_SYMBOL;
              8052    5        DO;
              8053    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8054    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8055    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:45   
              8056    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8057    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8058    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8059    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8060    5        END;
      598     8062    4           SYMBOL_START_LOCATION = BUFFER.COLUMN + 1;
      599     8063    4           STOP_SCAN_FLAG = FALSE;
      600     8064                %ADV_BUFFER_COLUMN_THIS_LINE;
              8065    5     DO;
              8066    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8067            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8068    6     DO;
              8069    6       CALL SEARCH(BUFFER.COLUMN,
              8070    6                   BUFFER.CLASS,
              8071    6                   TABLE,
              8072    6                   BUFFER_LINE,
              8073    6                   BUFFER.COLUMN);
              8074    6     END;
              8076    5     END;
      601     8078    4         END;
      602     8079    3       ELSE
      603     8080    4         DO;
      604     8081    4           LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      605     8082    4         END;
      606     8083
      607     8084    3     END CONTINUE_SINGLE_QUOTED_STRING;
      608     8085
      609     8086
      610     8087
      611     8088    3     DO UNTIL STOP_SCAN_FLAG;
      612     8089    3       STOP_SCAN_FLAG = TRUE;
      613     8090    3       IF O1COM.PSEUDO_TEXT_FLAG
      614     8091    3         THEN TABLE$ = ADDR(SNGL_QUOTE_PSEUDO_SEARCH_TABLE);
      615     8092    3         ELSE TABLE$ = ADDR(SINGLE_QUOTE_SEARCH_TABLE);
      616     8093            %ADV_BUFFER_COLUMN_THIS_LINE(TABLE=BASED$TABLE);
              8094    4     DO;
              8095    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:46   
              8096            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8097    5     DO;
              8098    5       CALL SEARCH(BUFFER.COLUMN,
              8099    5                   BUFFER.CLASS,
              8100    5                   TABLE,
              8101    5                   BUFFER_LINE,
              8102    5                   BUFFER.COLUMN);
              8103    5     END;
              8105    4     END;
      617     8107
      618     8108    4       DO CASE(BUFFER.CLASS);
      619     8109
      620     8110    4         CASE(%SINGLE_QUOTE);
      621     8111                %ADV_BUFFER_COLUMN_THIS_LINE;
              8112    5     DO;
              8113    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8114            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8115    6     DO;
              8116    6       CALL SEARCH(BUFFER.COLUMN,
              8117    6                   BUFFER.CLASS,
              8118    6                   TABLE,
              8119    6                   BUFFER_LINE,
              8120    6                   BUFFER.COLUMN);
              8121    6     END;
              8123    5     END;
      622     8125    4           IF BUFFER.CLASS = %END_OF_LINE
      623     8126    4                AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      624     8127    4             CALL CONTINUE_SINGLE_QUOTED_STRING;
      625     8128    4           IF BUFFER.CLASS = %SINGLE_QUOTE THEN
      626     8129    5             DO;
      627     8130    5               STOP_SCAN_FLAG = FALSE;
      628     8131    5             END;
      629     8132
      630     8133    4         CASE(%EQUAL);
      631     8134    4           IF SUBSTR(BUFFER_LINE, BUFFER.COLUMN + 1, 1) ~= '='
      632     8135    4             THEN STOP_SCAN_FLAG = FALSE;
      633     8136    4             ELSE LEX_SYMBOL.B.DELIM_ERROR = TRUE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:47   
      634     8137
      635     8138    4         CASE(%END_OF_LINE);
      636     8139                %CONCAT_SYMBOL;
              8140    5        DO;
              8141    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8142    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8143    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8144    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8145    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8146    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8147    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8148    5        END;
      637     8150                 /*N* Free Format -- IF NOT COMCOM.OB.FORMAT THEN */
      638     8151    5             DO;
      639     8152    5               IF BUFFER.COLUMN < O1COM.MARGIN_R THEN
      640     8153    6                 DO;
      641     8154    6                   SEARCH_SIZE = MINIMUM( O1COM.MARGIN_R - BUFFER.COLUMN,
      642     8155    6                                     %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE);
      643     8156    6                   CALL INSERT(LEX_SYMBOL.SYMBOL,
      644     8157    6                               LEX_SYMBOL.SIZE,
      645     8158    6                               SEARCH_SIZE,
      646     8159    6                               ' ');
      647     8160    6                   LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
      648     8161    6                 END;
      649     8162    5             END;
      650     8163    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      651     8164    5             DO;
      652     8165    5               CALL CONTINUE_SINGLE_QUOTED_STRING;
      653     8166    5               IF NOT STOP_SCAN_FLAG THEN
      654     8167    5                 BUFFER.COLUMN = BUFFER.COLUMN - 1;
      655     8168    5             END;
      656     8169    4           ELSE
      657     8170    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      658     8171
      659     8172    4       END;
      660     8173    3     END;
      661     8174
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:48   
      662     8175        %CONCAT_SYMBOL;
              8176    3        DO;
              8177    3          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8178    3          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8179    3            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8180    3          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8181    3              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8182    3          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8183    3          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8184    3        END;
      663     8186        %MARK_END_OF_SYMBOL;
              8187    3     DO;
              8188    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              8189    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              8190    3     END;
      664     8192
      665     8193    2   IF BUFFER.CLASS ~= %SPACE
      666     8194    2        AND BUFFER.CLASS ~= %END_OF_LINE
      667     8195    2        AND BUFFER.CLASS ~= %COMMA
      668     8196    2        AND BUFFER.CLASS ~= %SEMICOLON
      669     8197    2        AND BUFFER.CLASS ~= %PERIOD
      670     8198    2        AND BUFFER.CLASS ~= %RIGHT_PAREN
      671     8199    2        AND NOT O1COM.PSEUDO_TEXT_FLAG
      672     8200    2        AND NOT
      673     8201                     %NEXT_TWO_CHARS_ARE_PSEUDO;
              8202    2     (BUFFER.CLASS = %EQUAL
              8203    2       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8204    2       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      674     8206    2                                           THEN
      675     8207    2     LEX_SYMBOL.B.DELIM_ERROR = TRUE;
      676     8208
      677     8209    2   END SCAN_APOSTROPHE_LITERAL;
      678     8210        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:49   
      679     8211        %MACRO SCAN_SYMBOL;
      680     8212
      681     8213        /*V*
      682     8214            SCAN_SYMBOL -- Scan the symbol using the first character as a guide
      683     8215                           to its type.
      684     8216        */
      685     8217
      686     8218
      687     8219          DO;
      688     8220
      689     8221              DO CASE (BUFFER.CLASS);
      690     8222
      691     8223                CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE);
      692     8224
      693     8225
      694     8226                  LEX_SYMBOL.TYPE = %USER_WORD;
      695     8227                  %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
      696     8228                  CALL CHECK_NORMAL_SEPARATOR;
      697     8229                  %TRANSLATE_TO_UPPER_CASE;
      698     8230
      699     8231
      700     8232
      701     8233                CASE(%DIGIT);
      702     8234
      703     8235                  LEX_SYMBOL.TYPE = %NUMBER;
      704     8236                  CALL SCAN_NUMERIC_LITERAL;
      705     8237                  IF LEX_SYMBOL.TYPE = %USER_WORD THEN
      706     8238                    %TRANSLATE_TO_UPPER_CASE;
      707     8239
      708     8240
      709     8241               CASE (%PLUS, %MINUS);
      710     8242
      711     8243                 %ADV_BUFFER_COLUMN;
      712     8244                 DO CASE (BUFFER.CLASS);
      713     8245
      714     8246                   CASE (%DIGIT);
      715     8247                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:50   
      716     8248                     CALL SCAN_NUMERIC_LITERAL;
      717     8249
      718     8250                   CASE(%PERIOD);
      719     8251                     %SAVE_RESTART_INFO;
      720     8252                     %CONCAT_SYMBOL;
      721     8253                     %MARK_END_OF_SYMBOL;
      722     8254                     %ADV_BUFFER_COLUMN;
      723     8255                     IF BUFFER.CLASS = %DIGIT THEN
      724     8256                       DO;
      725     8257                         LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      726     8258                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      727     8259                         CALL SCAN_EXPONENT;
      728     8260                       END;
      729     8261                     ELSE
      730     8262                       IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      731     8263                              %NEXT_TWO_CHARS_ARE_PSEUDO;
      732     8264                                                           THEN
      733     8265                         DO;
      734     8266                           SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;
      735     8267                         END;
      736     8268                       ELSE
      737     8269                         DO;
      738     8270                           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      739     8271                           CALL CHECK_NORMAL_SEPARATOR;
      740     8272                         END;
      741     8273
      742     8274                   CASE(%COMMA);
      743     8275                     %ADV_BUFFER_COLUMN;
      744     8276                     IF BUFFER.CLASS = %DIGIT THEN
      745     8277                       DO;
      746     8278                         LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      747     8279                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      748     8280                         CALL SCAN_EXPONENT;
      749     8281                       END;
      750     8282                     ELSE
      751     8283                       IF BUFFER.CLASS = %SPACE
      752     8284                              OR BUFFER.CLASS = %END_OF_LINE OR
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:51   
      753     8285                                 %NEXT_TWO_CHARS_ARE_PSEUDO;
      754     8286                                                             THEN
      755     8287                         DO;
      756     8288                           %CONCAT_SYMBOL;
      757     8289                           %MARK_END_OF_SYMBOL;
      758     8290                           LEX_SYMBOL.SIZE = 1;  /* Throw away comma */
      759     8291                         END;
      760     8292                       ELSE
      761     8293                         DO;
      762     8294                           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      763     8295                           CALL CHECK_NORMAL_SEPARATOR;
      764     8296                         END;
      765     8297
      766     8298                   CASE(ELSE);
      767     8299                     CALL CHECK_NORMAL_SEPARATOR;
      768     8300                 END;
      769     8301
      770     8302
      771     8303               CASE (%PERIOD);
      772     8304
      773     8305                 %ADV_BUFFER_COLUMN;
      774     8306                 IF BUFFER.CLASS = %DIGIT THEN
      775     8307                   DO;
      776     8308                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      777     8309                     %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      778     8310                     CALL SCAN_EXPONENT;
      779     8311                   END;
      780     8312                 ELSE
      781     8313                   IF BUFFER.CLASS = %SPACE
      782     8314                         OR BUFFER.CLASS =%END_OF_LINE OR
      783     8315                            %NEXT_TWO_CHARS_ARE_PSEUDO;
      784     8316                                                       THEN
      785     8317                     DO;
      786     8318                       %CONCAT_SYMBOL;
      787     8319                       %MARK_END_OF_SYMBOL;
      788     8320                     END;
      789     8321                   ELSE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:52   
      790     8322                     DO;
      791     8323                       LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      792     8324                       CALL CHECK_NORMAL_SEPARATOR;
      793     8325                     END;
      794     8326
      795     8327
      796     8328               CASE (%COMMA);
      797     8329
      798     8330                 %ADV_BUFFER_COLUMN;
      799     8331                 IF BUFFER.CLASS = %DIGIT THEN
      800     8332                   DO;
      801     8333                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      802     8334                     %SCAN_SEARCH (TABLE=DIGIT_SCAN_TABLE);
      803     8335                     CALL SCAN_EXPONENT;
      804     8336                   END;
      805     8337                 ELSE
      806     8338                   IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS =%END_OF_LINE OR
      807     8339                         %NEXT_TWO_CHARS_ARE_PSEUDO;
      808     8340                                                      THEN
      809     8341                     GOTO RESTART_FROM_SEPARATOR;
      810     8342                   ELSE
      811     8343                     DO;
      812     8344                       LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      813     8345                       CALL CHECK_NORMAL_SEPARATOR;
      814     8346                     END;
      815     8347
      816     8348
      817     8349               CASE (%SEMICOLON);
      818     8350
      819     8351                 %ADV_BUFFER_COLUMN;
      820     8352                 IF BUFFER.CLASS =%SPACE
      821     8353                      OR BUFFER.CLASS =%END_OF_LINE OR
      822     8354                            %NEXT_TWO_CHARS_ARE_PSEUDO;
      823     8355                                                    THEN
      824     8356                   GOTO RESTART_FROM_SEPARATOR;
      825     8357                 ELSE
      826     8358                   DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:53   
      827     8359                     LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      828     8360                     CALL CHECK_NORMAL_SEPARATOR;
      829     8361                   END;
      830     8362
      831     8363
      832     8364               CASE (%LEFT_PAREN, %RIGHT_PAREN, %COLON);
      833     8365
      834     8366                 %ADV_BUFFER_COLUMN;
      835     8367                 %CONCAT_SYMBOL;
      836     8368                 %MARK_END_OF_SYMBOL;
      837     8369
      838     8370
      839     8371               CASE (%LESS_THAN);
      840     8372
      841     8373                 %ADV_BUFFER_COLUMN;
      842     8374                 IF BUFFER.CLASS = %EQUAL THEN
      843     8375                   DO;
      844     8376                     LEX_SYMBOL.TYPE = %LESS_THAN_OR_EQUAL;
      845     8377                     %ADV_BUFFER_COLUMN;
      846     8378                   END;
      847     8379                 CALL CHECK_RELATIONAL_SEPARATOR;
      848     8380
      849     8381               CASE (%GREATER_THAN);
      850     8382
      851     8383                 %ADV_BUFFER_COLUMN;
      852     8384                 IF BUFFER.CLASS = %EQUAL THEN
      853     8385                   DO;
      854     8386                     LEX_SYMBOL.TYPE = %GREATER_THAN_OR_EQUAL;
      855     8387                     %ADV_BUFFER_COLUMN;
      856     8388                   END;
      857     8389                 CALL CHECK_RELATIONAL_SEPARATOR;
      858     8390
      859     8391
      860     8392
      861     8393               CASE (%DOUBLE_QUOTE) ;
      862     8394
      863     8395                 CALL SCAN_QUOTE_LITERAL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:54   
      864     8396
      865     8397               CASE(%SINGLE_QUOTE) ;
      866     8398
      867     8399                 CALL SCAN_APOSTROPHE_LITERAL;
      868     8400
      869     8401
      870     8402               CASE (%STAR);
      871     8403
      872     8404                 /*V*
      873     8405                     STAR --
      874     8406                       The line is searched for the next symbol.  If it's another star
      875     8407                       then the entire symbol is an exponentiation otherwise it is
      876     8408                       a multiply.
      877     8409                 */
      878     8410
      879     8411                 %ADV_BUFFER_COLUMN;
      880     8412
      881     8413                 IF BUFFER.CLASS = %STAR THEN
      882     8414                   DO;
      883     8415                     LEX_SYMBOL.TYPE = %STAR_STAR;
      884     8416                     %ADV_BUFFER_COLUMN;
      885     8417                   END;
      886     8418
      887     8419                 CALL CHECK_NORMAL_SEPARATOR;
      888     8420
      889     8421
      890     8422               CASE (%EQUAL);
      891     8423
      892     8424                 /*V*
      893     8425                     EQUAL --
      894     8426                        The line is searched for the next symbol.  If it's an equal sign
      895     8427                        then the entire symbol is a pseudo text symbol otherwise it
      896     8428                        is an equal sign.
      897     8429                 */
      898     8430
      899     8431                 %ADV_BUFFER_COLUMN_THIS_LINE;  /* == must be on same line */
      900     8432
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:55   
      901     8433                 IF BUFFER.CLASS = %EQUAL THEN
      902     8434                   DO;
      903     8435                     LEX_SYMBOL.TYPE = %PSEUDO;
      904     8436                     O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;
      905     8437                     %ADV_BUFFER_COLUMN;
      906     8438                     %CONCAT_SYMBOL;
      907     8439                     %MARK_END_OF_SYMBOL;
      908     8440                   END;
      909     8441                 ELSE
      910     8442                   DO;
      911     8443                     IF BUFFER.CLASS = %END_OF_LINE
      912     8444                          AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      913     8445                         %ADV_BUFFER_COLUMN_NEXT_LINE;
      914     8446                     CALL CHECK_RELATIONAL_SEPARATOR;
      915     8447                   END;
      916     8448
      917     8449
      918     8450
      919     8451               CASE (%END_OF_FILE);
      920     8452                 /* do nothing */
      921     8453
      922     8454               CASE (%END_OF_LINE);
      923     8455                  /* Do nothing */
      924     8456
      925     8457
      926     8458               CASE (ELSE);
      927     8459
      928     8460                 /*V*
      929     8461                     ELSE --
      930     8462                             This includes parentheses, division, etc.  The
      931     8463                             symbol is built and returned.
      932     8464                 */
      933     8465
      934     8466                 %ADV_BUFFER_COLUMN;
      935     8467                 CALL CHECK_NORMAL_SEPARATOR;
      936     8468             END;
      937     8469
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:56   
      938     8470             IF LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL THEN
      939     8471               %TRANSLATE_TO_UPPER_CASE;
      940     8472
      941     8473          END;  /* SCAN_SYMBOL MACRO */
      942     8474        %MEND;
      943     8475
      944     8476
      945     8477        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:57   
      946     8478        /*V*
      947     8479            MAIN_PROGRAM -- This is the executive driver of the Z8ES module.
      948     8480                            If the end of file has been reached then no further
      949     8481                            scanning is done and we return to the calling routine.
      950     8482                            We scan past all delimiters to reach the first meaningful
      951     8483                            symbol.
      952     8484
      953     8485                            A new source line is loaded if needed and the column
      954     8486                            number and symbol size are initialized.  SCAN is used
      955     8487                            to acquire the symbol and then VERIFY is used to check the
      956     8488                            legality of the symbol.
      957     8489        */
      958     8490
      959     8491        %IF GCOS;
      963     8495        %ENDIF;
      964     8496
      965     8497    1   RESTART_FROM_SEPARATOR:
      966     8498
      967     8499    2     DO CASE (SCANNER_STATE);
      968     8500
      969     8501    2       CASE (%SCANNER_STATE_NEW_TOKEN);
      970     8502
      971     8503    2        IF BUFFER.CLASS = %SPACE THEN
      972     8504               %SCAN_BLANKS;
              8505    3        DO;
              8506               %SCAN_SEARCH(TABLE=BLANK_SCAN_TABLE);
              8507    4     DO;
              8508    4       CALL SEARCH(BUFFER.COLUMN,
              8509    4                   BUFFER.CLASS,
              8510    4                   TABLE,
              8511    4                   BUFFER_LINE,
              8512    4                   BUFFER.COLUMN)
              8513    4            WHENALTRETURN
              8514    5              DO;
              8515    5                IF BUFFER.CLASS = %END_OF_LINE
              8516    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8517    5                  CALL CONTINUATION (TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:58   
              8518    5              END;
              8519    4     END;
              8521    3        END;
      973     8523
      974     8524             %INITIALIZE_SYMBOL;
              8525    3     DO;
              8526             /* Initialize token */
              8527    3        LEX_SYMBOL.LINE    = BUFFER.ISN;
              8528    3        LEX_SYMBOL.COLUMN  = BUFFER.COLUMN;
              8529    3        LEX_SYMBOL.FLAGS   = FALSE;
              8530    3        LEX_SYMBOL.TYPE    = BUFFER.CLASS;
              8531    3        LEX_SYMBOL.SIZE    = 0;
              8532    3        LEX_SYMBOL.LEVEL  = BUFFER.LEVEL;
              8533    3        LEX_SYMBOL.NEXT$ = ADDR(NIL);
              8534    3        LEX_SYMBOL.B.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              8535    3     END;
      975     8537
      976     8538    2        SYMBOL_START_LOCATION = BUFFER.COLUMN;
      977     8539
      978     8540             %SCAN_SYMBOL;
              8541        /*V*
              8542            SCAN_SYMBOL -- Scan the symbol using the first character as a guide
              8543                           to its type.
              8544        */
              8545    3     DO;
              8546    4         DO CASE (BUFFER.CLASS);
              8547    4           CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE);
              8548    4             LEX_SYMBOL.TYPE = %USER_WORD;
              8549                  %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
              8550    5     DO;
              8551    5       CALL SEARCH(BUFFER.COLUMN,
              8552    5                   BUFFER.CLASS,
              8553    5                   TABLE,
              8554    5                   BUFFER_LINE,
              8555    5                   BUFFER.COLUMN)
              8556    5            WHENALTRETURN
              8557    6              DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:59   
              8558    6                IF BUFFER.CLASS = %END_OF_LINE
              8559    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8560    6                  CALL CONTINUATION (TABLE);
              8561    6              END;
              8562    5     END;
              8564    4             CALL CHECK_NORMAL_SEPARATOR;
              8565                  %TRANSLATE_TO_UPPER_CASE;
              8566    4      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),
              8567    4                 LOWER_TO_UPPER_CASE,
              8568    4                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              8570    4           CASE(%DIGIT);
              8571    4             LEX_SYMBOL.TYPE = %NUMBER;
              8572    4             CALL SCAN_NUMERIC_LITERAL;
              8573    4             IF LEX_SYMBOL.TYPE = %USER_WORD THEN
              8574                    %TRANSLATE_TO_UPPER_CASE;
              8575    4      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),
              8576    4                 LOWER_TO_UPPER_CASE,
              8577    4                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              8579    4          CASE (%PLUS, %MINUS);
              8580                 %ADV_BUFFER_COLUMN;
              8581    5     DO;
              8582    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8583    5       CALL SEARCH(BUFFER.COLUMN,
              8584    5                   BUFFER.CLASS,
              8585    5                   TABLE,
              8586    5                   BUFFER_LINE,
              8587    5                   BUFFER.COLUMN)
              8588    5        WHENALTRETURN
              8589    6         DO;
              8590    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8591                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8592    7           DO;
              8593                  %CONCAT_SYMBOL;
              8594    8        DO;
              8595    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8596    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8597    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:60   
              8598    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8599    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8600    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8601    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8602    8        END;
              8604    7             CALL GET_NEXT_SCANNER_LINE;
              8605    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8606                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8607    8     DO;
              8608    8       CALL SEARCH(BUFFER.COLUMN,
              8609    8                   BUFFER.CLASS,
              8610    8                   TABLE,
              8611    8                   BUFFER_LINE,
              8612    8                   BUFFER.COLUMN);
              8613    8     END;
              8615    7           END;
              8617    6         END;
              8618    5     END;
              8620    5            DO CASE (BUFFER.CLASS);
              8621    5              CASE (%DIGIT);
              8622    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
              8623    5                CALL SCAN_NUMERIC_LITERAL;
              8624    5              CASE(%PERIOD);
              8625                     %SAVE_RESTART_INFO;
              8626    6     DO;
              8627    6       RESTART_INFO.LINE   = BUFFER.ISN;
              8628    6       RESTART_INFO.COLUMN = BUFFER.COLUMN;
              8629    6       RESTART_INFO.LEVEL = BUFFER.LEVEL;
              8630    6       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
              8631    6     END;
              8633                     %CONCAT_SYMBOL;
              8634    6        DO;
              8635    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8636    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8637    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8638    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8639    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:61   
              8640    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8641    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8642    6        END;
              8644                     %MARK_END_OF_SYMBOL;
              8645    6     DO;
              8646    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              8647    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              8648    6     END;
              8650                     %ADV_BUFFER_COLUMN;
              8651    6     DO;
              8652    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8653    6       CALL SEARCH(BUFFER.COLUMN,
              8654    6                   BUFFER.CLASS,
              8655    6                   TABLE,
              8656    6                   BUFFER_LINE,
              8657    6                   BUFFER.COLUMN)
              8658    6        WHENALTRETURN
              8659    7         DO;
              8660    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8661                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8662    8           DO;
              8663                  %CONCAT_SYMBOL;
              8664    9        DO;
              8665    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8666    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8667    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8668    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8669    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8670    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8671    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8672    9        END;
              8674    8             CALL GET_NEXT_SCANNER_LINE;
              8675    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8676                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8677    9     DO;
              8678    9       CALL SEARCH(BUFFER.COLUMN,
              8679    9                   BUFFER.CLASS,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:62   
              8680    9                   TABLE,
              8681    9                   BUFFER_LINE,
              8682    9                   BUFFER.COLUMN);
              8683    9     END;
              8685    8           END;
              8687    7         END;
              8688    6     END;
              8690    5                IF BUFFER.CLASS = %DIGIT THEN
              8691    6                  DO;
              8692    6                    LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
              8693                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8694    7     DO;
              8695    7       CALL SEARCH(BUFFER.COLUMN,
              8696    7                   BUFFER.CLASS,
              8697    7                   TABLE,
              8698    7                   BUFFER_LINE,
              8699    7                   BUFFER.COLUMN)
              8700    7            WHENALTRETURN
              8701    8              DO;
              8702    8                IF BUFFER.CLASS = %END_OF_LINE
              8703    8                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8704    8                  CALL CONTINUATION (TABLE);
              8705    8              END;
              8706    7     END;
              8708    6                    CALL SCAN_EXPONENT;
              8709    6                  END;
              8710    5                ELSE
              8711    5                  IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
              8712                              %NEXT_TWO_CHARS_ARE_PSEUDO;
              8713    5     (BUFFER.CLASS = %EQUAL
              8714    5       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8715    5       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8717    5                                                      THEN
              8718    6                    DO;
              8719    6                      SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;
              8720    6                    END;
              8721    5                  ELSE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:63   
              8722    6                    DO;
              8723    6                      LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
              8724    6                      CALL CHECK_NORMAL_SEPARATOR;
              8725    6                    END;
              8726    5              CASE(%COMMA);
              8727                     %ADV_BUFFER_COLUMN;
              8728    6     DO;
              8729    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8730    6       CALL SEARCH(BUFFER.COLUMN,
              8731    6                   BUFFER.CLASS,
              8732    6                   TABLE,
              8733    6                   BUFFER_LINE,
              8734    6                   BUFFER.COLUMN)
              8735    6        WHENALTRETURN
              8736    7         DO;
              8737    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8738                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8739    8           DO;
              8740                  %CONCAT_SYMBOL;
              8741    9        DO;
              8742    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8743    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8744    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8745    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8746    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8747    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8748    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8749    9        END;
              8751    8             CALL GET_NEXT_SCANNER_LINE;
              8752    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8753                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8754    9     DO;
              8755    9       CALL SEARCH(BUFFER.COLUMN,
              8756    9                   BUFFER.CLASS,
              8757    9                   TABLE,
              8758    9                   BUFFER_LINE,
              8759    9                   BUFFER.COLUMN);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:64   
              8760    9     END;
              8762    8           END;
              8764    7         END;
              8765    6     END;
              8767    5                IF BUFFER.CLASS = %DIGIT THEN
              8768    6                  DO;
              8769    6                    LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
              8770                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8771    7     DO;
              8772    7       CALL SEARCH(BUFFER.COLUMN,
              8773    7                   BUFFER.CLASS,
              8774    7                   TABLE,
              8775    7                   BUFFER_LINE,
              8776    7                   BUFFER.COLUMN)
              8777    7            WHENALTRETURN
              8778    8              DO;
              8779    8                IF BUFFER.CLASS = %END_OF_LINE
              8780    8                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8781    8                  CALL CONTINUATION (TABLE);
              8782    8              END;
              8783    7     END;
              8785    6                    CALL SCAN_EXPONENT;
              8786    6                  END;
              8787    5                ELSE
              8788    5                  IF BUFFER.CLASS = %SPACE
              8789    5                         OR BUFFER.CLASS = %END_OF_LINE OR
              8790                                 %NEXT_TWO_CHARS_ARE_PSEUDO;
              8791    5     (BUFFER.CLASS = %EQUAL
              8792    5       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8793    5       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8795    5                                                        THEN
              8796    6                    DO;
              8797                           %CONCAT_SYMBOL;
              8798    7        DO;
              8799    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8800    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8801    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:65   
              8802    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8803    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8804    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8805    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8806    7        END;
              8808                           %MARK_END_OF_SYMBOL;
              8809    7     DO;
              8810    7       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              8811    7       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              8812    7     END;
              8814    6                      LEX_SYMBOL.SIZE = 1;  /* Throw away comma */
              8815    6                    END;
              8816    5                  ELSE
              8817    6                    DO;
              8818    6                      LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
              8819    6                      CALL CHECK_NORMAL_SEPARATOR;
              8820    6                    END;
              8821    5              CASE(ELSE);
              8822    5                CALL CHECK_NORMAL_SEPARATOR;
              8823    5            END;
              8824    4          CASE (%PERIOD);
              8825                 %ADV_BUFFER_COLUMN;
              8826    5     DO;
              8827    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8828    5       CALL SEARCH(BUFFER.COLUMN,
              8829    5                   BUFFER.CLASS,
              8830    5                   TABLE,
              8831    5                   BUFFER_LINE,
              8832    5                   BUFFER.COLUMN)
              8833    5        WHENALTRETURN
              8834    6         DO;
              8835    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8836                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8837    7           DO;
              8838                  %CONCAT_SYMBOL;
              8839    8        DO;
              8840    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:66   
              8841    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8842    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8843    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8844    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8845    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8846    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8847    8        END;
              8849    7             CALL GET_NEXT_SCANNER_LINE;
              8850    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8851                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8852    8     DO;
              8853    8       CALL SEARCH(BUFFER.COLUMN,
              8854    8                   BUFFER.CLASS,
              8855    8                   TABLE,
              8856    8                   BUFFER_LINE,
              8857    8                   BUFFER.COLUMN);
              8858    8     END;
              8860    7           END;
              8862    6         END;
              8863    5     END;
              8865    4            IF BUFFER.CLASS = %DIGIT THEN
              8866    5              DO;
              8867    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
              8868                     %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8869    6     DO;
              8870    6       CALL SEARCH(BUFFER.COLUMN,
              8871    6                   BUFFER.CLASS,
              8872    6                   TABLE,
              8873    6                   BUFFER_LINE,
              8874    6                   BUFFER.COLUMN)
              8875    6            WHENALTRETURN
              8876    7              DO;
              8877    7                IF BUFFER.CLASS = %END_OF_LINE
              8878    7                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8879    7                  CALL CONTINUATION (TABLE);
              8880    7              END;
              8881    6     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:67   
              8883    5                CALL SCAN_EXPONENT;
              8884    5              END;
              8885    4            ELSE
              8886    4              IF BUFFER.CLASS = %SPACE
              8887    4                    OR BUFFER.CLASS =%END_OF_LINE OR
              8888                            %NEXT_TWO_CHARS_ARE_PSEUDO;
              8889    4     (BUFFER.CLASS = %EQUAL
              8890    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8891    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8893    4                                                  THEN
              8894    5                DO;
              8895                       %CONCAT_SYMBOL;
              8896    6        DO;
              8897    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8898    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8899    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8900    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8901    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8902    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8903    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8904    6        END;
              8906                       %MARK_END_OF_SYMBOL;
              8907    6     DO;
              8908    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              8909    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              8910    6     END;
              8912    5                END;
              8913    4              ELSE
              8914    5                DO;
              8915    5                  LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
              8916    5                  CALL CHECK_NORMAL_SEPARATOR;
              8917    5                END;
              8918    4          CASE (%COMMA);
              8919                 %ADV_BUFFER_COLUMN;
              8920    5     DO;
              8921    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8922    5       CALL SEARCH(BUFFER.COLUMN,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:68   
              8923    5                   BUFFER.CLASS,
              8924    5                   TABLE,
              8925    5                   BUFFER_LINE,
              8926    5                   BUFFER.COLUMN)
              8927    5        WHENALTRETURN
              8928    6         DO;
              8929    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8930                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8931    7           DO;
              8932                  %CONCAT_SYMBOL;
              8933    8        DO;
              8934    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              8935    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              8936    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              8937    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              8938    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8939    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              8940    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8941    8        END;
              8943    7             CALL GET_NEXT_SCANNER_LINE;
              8944    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              8945                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8946    8     DO;
              8947    8       CALL SEARCH(BUFFER.COLUMN,
              8948    8                   BUFFER.CLASS,
              8949    8                   TABLE,
              8950    8                   BUFFER_LINE,
              8951    8                   BUFFER.COLUMN);
              8952    8     END;
              8954    7           END;
              8956    6         END;
              8957    5     END;
              8959    4            IF BUFFER.CLASS = %DIGIT THEN
              8960    5              DO;
              8961    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
              8962                     %SCAN_SEARCH (TABLE=DIGIT_SCAN_TABLE);
              8963    6     DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:69   
              8964    6       CALL SEARCH(BUFFER.COLUMN,
              8965    6                   BUFFER.CLASS,
              8966    6                   TABLE,
              8967    6                   BUFFER_LINE,
              8968    6                   BUFFER.COLUMN)
              8969    6            WHENALTRETURN
              8970    7              DO;
              8971    7                IF BUFFER.CLASS = %END_OF_LINE
              8972    7                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8973    7                  CALL CONTINUATION (TABLE);
              8974    7              END;
              8975    6     END;
              8977    5                CALL SCAN_EXPONENT;
              8978    5              END;
              8979    4            ELSE
              8980    4              IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS =%END_OF_LINE OR
              8981                         %NEXT_TWO_CHARS_ARE_PSEUDO;
              8982    4     (BUFFER.CLASS = %EQUAL
              8983    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8984    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8986    4                                                 THEN
              8987    4                GOTO RESTART_FROM_SEPARATOR;
              8988    4              ELSE
              8989    5                DO;
              8990    5                  LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
              8991    5                  CALL CHECK_NORMAL_SEPARATOR;
              8992    5                END;
              8993    4          CASE (%SEMICOLON);
              8994                 %ADV_BUFFER_COLUMN;
              8995    5     DO;
              8996    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              8997    5       CALL SEARCH(BUFFER.COLUMN,
              8998    5                   BUFFER.CLASS,
              8999    5                   TABLE,
              9000    5                   BUFFER_LINE,
              9001    5                   BUFFER.COLUMN)
              9002    5        WHENALTRETURN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:70   
              9003    6         DO;
              9004    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9005                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9006    7           DO;
              9007                  %CONCAT_SYMBOL;
              9008    8        DO;
              9009    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9010    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9011    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9012    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9013    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9014    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9015    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9016    8        END;
              9018    7             CALL GET_NEXT_SCANNER_LINE;
              9019    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9020                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9021    8     DO;
              9022    8       CALL SEARCH(BUFFER.COLUMN,
              9023    8                   BUFFER.CLASS,
              9024    8                   TABLE,
              9025    8                   BUFFER_LINE,
              9026    8                   BUFFER.COLUMN);
              9027    8     END;
              9029    7           END;
              9031    6         END;
              9032    5     END;
              9034    4            IF BUFFER.CLASS =%SPACE
              9035    4                 OR BUFFER.CLASS =%END_OF_LINE OR
              9036                            %NEXT_TWO_CHARS_ARE_PSEUDO;
              9037    4     (BUFFER.CLASS = %EQUAL
              9038    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              9039    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              9041    4                                               THEN
              9042    4              GOTO RESTART_FROM_SEPARATOR;
              9043    4            ELSE
              9044    5              DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:71   
              9045    5                LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
              9046    5                CALL CHECK_NORMAL_SEPARATOR;
              9047    5              END;
              9048    4          CASE (%LEFT_PAREN, %RIGHT_PAREN, %COLON);
              9049                 %ADV_BUFFER_COLUMN;
              9050    5     DO;
              9051    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9052    5       CALL SEARCH(BUFFER.COLUMN,
              9053    5                   BUFFER.CLASS,
              9054    5                   TABLE,
              9055    5                   BUFFER_LINE,
              9056    5                   BUFFER.COLUMN)
              9057    5        WHENALTRETURN
              9058    6         DO;
              9059    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9060                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9061    7           DO;
              9062                  %CONCAT_SYMBOL;
              9063    8        DO;
              9064    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9065    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9066    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9067    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9068    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9069    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9070    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9071    8        END;
              9073    7             CALL GET_NEXT_SCANNER_LINE;
              9074    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9075                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9076    8     DO;
              9077    8       CALL SEARCH(BUFFER.COLUMN,
              9078    8                   BUFFER.CLASS,
              9079    8                   TABLE,
              9080    8                   BUFFER_LINE,
              9081    8                   BUFFER.COLUMN);
              9082    8     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:72   
              9084    7           END;
              9086    6         END;
              9087    5     END;
              9089                 %CONCAT_SYMBOL;
              9090    5        DO;
              9091    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9092    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9093    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9094    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9095    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9096    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9097    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9098    5        END;
              9100                 %MARK_END_OF_SYMBOL;
              9101    5     DO;
              9102    5       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              9103    5       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              9104    5     END;
              9106    4          CASE (%LESS_THAN);
              9107                 %ADV_BUFFER_COLUMN;
              9108    5     DO;
              9109    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9110    5       CALL SEARCH(BUFFER.COLUMN,
              9111    5                   BUFFER.CLASS,
              9112    5                   TABLE,
              9113    5                   BUFFER_LINE,
              9114    5                   BUFFER.COLUMN)
              9115    5        WHENALTRETURN
              9116    6         DO;
              9117    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9118                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9119    7           DO;
              9120                  %CONCAT_SYMBOL;
              9121    8        DO;
              9122    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9123    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9124    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:73   
              9125    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9126    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9127    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9128    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9129    8        END;
              9131    7             CALL GET_NEXT_SCANNER_LINE;
              9132    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9133                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9134    8     DO;
              9135    8       CALL SEARCH(BUFFER.COLUMN,
              9136    8                   BUFFER.CLASS,
              9137    8                   TABLE,
              9138    8                   BUFFER_LINE,
              9139    8                   BUFFER.COLUMN);
              9140    8     END;
              9142    7           END;
              9144    6         END;
              9145    5     END;
              9147    4            IF BUFFER.CLASS = %EQUAL THEN
              9148    5              DO;
              9149    5                LEX_SYMBOL.TYPE = %LESS_THAN_OR_EQUAL;
              9150                     %ADV_BUFFER_COLUMN;
              9151    6     DO;
              9152    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9153    6       CALL SEARCH(BUFFER.COLUMN,
              9154    6                   BUFFER.CLASS,
              9155    6                   TABLE,
              9156    6                   BUFFER_LINE,
              9157    6                   BUFFER.COLUMN)
              9158    6        WHENALTRETURN
              9159    7         DO;
              9160    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9161                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9162    8           DO;
              9163                  %CONCAT_SYMBOL;
              9164    9        DO;
              9165    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:74   
              9166    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9167    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9168    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9169    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9170    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9171    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9172    9        END;
              9174    8             CALL GET_NEXT_SCANNER_LINE;
              9175    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9176                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9177    9     DO;
              9178    9       CALL SEARCH(BUFFER.COLUMN,
              9179    9                   BUFFER.CLASS,
              9180    9                   TABLE,
              9181    9                   BUFFER_LINE,
              9182    9                   BUFFER.COLUMN);
              9183    9     END;
              9185    8           END;
              9187    7         END;
              9188    6     END;
              9190    5              END;
              9191    4            CALL CHECK_RELATIONAL_SEPARATOR;
              9192    4          CASE (%GREATER_THAN);
              9193                 %ADV_BUFFER_COLUMN;
              9194    5     DO;
              9195    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9196    5       CALL SEARCH(BUFFER.COLUMN,
              9197    5                   BUFFER.CLASS,
              9198    5                   TABLE,
              9199    5                   BUFFER_LINE,
              9200    5                   BUFFER.COLUMN)
              9201    5        WHENALTRETURN
              9202    6         DO;
              9203    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9204                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9205    7           DO;
              9206                  %CONCAT_SYMBOL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:75   
              9207    8        DO;
              9208    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9209    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9210    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9211    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9212    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9213    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9214    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9215    8        END;
              9217    7             CALL GET_NEXT_SCANNER_LINE;
              9218    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9219                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9220    8     DO;
              9221    8       CALL SEARCH(BUFFER.COLUMN,
              9222    8                   BUFFER.CLASS,
              9223    8                   TABLE,
              9224    8                   BUFFER_LINE,
              9225    8                   BUFFER.COLUMN);
              9226    8     END;
              9228    7           END;
              9230    6         END;
              9231    5     END;
              9233    4            IF BUFFER.CLASS = %EQUAL THEN
              9234    5              DO;
              9235    5                LEX_SYMBOL.TYPE = %GREATER_THAN_OR_EQUAL;
              9236                     %ADV_BUFFER_COLUMN;
              9237    6     DO;
              9238    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9239    6       CALL SEARCH(BUFFER.COLUMN,
              9240    6                   BUFFER.CLASS,
              9241    6                   TABLE,
              9242    6                   BUFFER_LINE,
              9243    6                   BUFFER.COLUMN)
              9244    6        WHENALTRETURN
              9245    7         DO;
              9246    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9247                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:76   
              9248    8           DO;
              9249                  %CONCAT_SYMBOL;
              9250    9        DO;
              9251    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9252    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9253    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9254    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9255    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9256    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9257    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9258    9        END;
              9260    8             CALL GET_NEXT_SCANNER_LINE;
              9261    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9262                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9263    9     DO;
              9264    9       CALL SEARCH(BUFFER.COLUMN,
              9265    9                   BUFFER.CLASS,
              9266    9                   TABLE,
              9267    9                   BUFFER_LINE,
              9268    9                   BUFFER.COLUMN);
              9269    9     END;
              9271    8           END;
              9273    7         END;
              9274    6     END;
              9276    5              END;
              9277    4            CALL CHECK_RELATIONAL_SEPARATOR;
              9278    4          CASE (%DOUBLE_QUOTE) ;
              9279    4            CALL SCAN_QUOTE_LITERAL;
              9280    4          CASE(%SINGLE_QUOTE) ;
              9281    4            CALL SCAN_APOSTROPHE_LITERAL;
              9282    4          CASE (%STAR);
              9283                 /*V*
              9284                     STAR --
              9285                       The line is searched for the next symbol.  If it's another star
              9286                       then the entire symbol is an exponentiation otherwise it is
              9287                       a multiply.
              9288                 */
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:77   
              9289                 %ADV_BUFFER_COLUMN;
              9290    5     DO;
              9291    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9292    5       CALL SEARCH(BUFFER.COLUMN,
              9293    5                   BUFFER.CLASS,
              9294    5                   TABLE,
              9295    5                   BUFFER_LINE,
              9296    5                   BUFFER.COLUMN)
              9297    5        WHENALTRETURN
              9298    6         DO;
              9299    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9300                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9301    7           DO;
              9302                  %CONCAT_SYMBOL;
              9303    8        DO;
              9304    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9305    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9306    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9307    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9308    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9309    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9310    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9311    8        END;
              9313    7             CALL GET_NEXT_SCANNER_LINE;
              9314    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9315                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9316    8     DO;
              9317    8       CALL SEARCH(BUFFER.COLUMN,
              9318    8                   BUFFER.CLASS,
              9319    8                   TABLE,
              9320    8                   BUFFER_LINE,
              9321    8                   BUFFER.COLUMN);
              9322    8     END;
              9324    7           END;
              9326    6         END;
              9327    5     END;
              9329    4            IF BUFFER.CLASS = %STAR THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:78   
              9330    5              DO;
              9331    5                LEX_SYMBOL.TYPE = %STAR_STAR;
              9332                     %ADV_BUFFER_COLUMN;
              9333    6     DO;
              9334    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9335    6       CALL SEARCH(BUFFER.COLUMN,
              9336    6                   BUFFER.CLASS,
              9337    6                   TABLE,
              9338    6                   BUFFER_LINE,
              9339    6                   BUFFER.COLUMN)
              9340    6        WHENALTRETURN
              9341    7         DO;
              9342    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9343                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9344    8           DO;
              9345                  %CONCAT_SYMBOL;
              9346    9        DO;
              9347    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9348    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9349    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9350    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9351    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9352    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9353    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9354    9        END;
              9356    8             CALL GET_NEXT_SCANNER_LINE;
              9357    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9358                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9359    9     DO;
              9360    9       CALL SEARCH(BUFFER.COLUMN,
              9361    9                   BUFFER.CLASS,
              9362    9                   TABLE,
              9363    9                   BUFFER_LINE,
              9364    9                   BUFFER.COLUMN);
              9365    9     END;
              9367    8           END;
              9369    7         END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:79   
              9370    6     END;
              9372    5              END;
              9373    4            CALL CHECK_NORMAL_SEPARATOR;
              9374    4          CASE (%EQUAL);
              9375                 /*V*
              9376                     EQUAL --
              9377                        The line is searched for the next symbol.  If it's an equal sign
              9378                        then the entire symbol is a pseudo text symbol otherwise it
              9379                        is an equal sign.
              9380                 */
              9381                 %ADV_BUFFER_COLUMN_THIS_LINE;  /* == must be on same line */
              9382    5     DO;
              9383    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9384            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9385    6     DO;
              9386    6       CALL SEARCH(BUFFER.COLUMN,
              9387    6                   BUFFER.CLASS,
              9388    6                   TABLE,
              9389    6                   BUFFER_LINE,
              9390    6                   BUFFER.COLUMN);
              9391    6     END;
              9393    5     END;
              9395    4            IF BUFFER.CLASS = %EQUAL THEN
              9396    5              DO;
              9397    5                LEX_SYMBOL.TYPE = %PSEUDO;
              9398    5                O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;
              9399                     %ADV_BUFFER_COLUMN;
              9400    6     DO;
              9401    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9402    6       CALL SEARCH(BUFFER.COLUMN,
              9403    6                   BUFFER.CLASS,
              9404    6                   TABLE,
              9405    6                   BUFFER_LINE,
              9406    6                   BUFFER.COLUMN)
              9407    6        WHENALTRETURN
              9408    7         DO;
              9409    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:80   
              9410                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9411    8           DO;
              9412                  %CONCAT_SYMBOL;
              9413    9        DO;
              9414    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9415    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9416    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9417    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9418    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9419    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9420    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9421    9        END;
              9423    8             CALL GET_NEXT_SCANNER_LINE;
              9424    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9425                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9426    9     DO;
              9427    9       CALL SEARCH(BUFFER.COLUMN,
              9428    9                   BUFFER.CLASS,
              9429    9                   TABLE,
              9430    9                   BUFFER_LINE,
              9431    9                   BUFFER.COLUMN);
              9432    9     END;
              9434    8           END;
              9436    7         END;
              9437    6     END;
              9439                     %CONCAT_SYMBOL;
              9440    6        DO;
              9441    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9442    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9443    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9444    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9445    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9446    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9447    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9448    6        END;
              9450                     %MARK_END_OF_SYMBOL;
              9451    6     DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:81   
              9452    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              9453    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              9454    6     END;
              9456    5              END;
              9457    4            ELSE
              9458    5              DO;
              9459    5                IF BUFFER.CLASS = %END_OF_LINE
              9460    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9461                         %ADV_BUFFER_COLUMN_NEXT_LINE;
              9462    6           DO;
              9463                  %CONCAT_SYMBOL;
              9464    7        DO;
              9465    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9466    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9467    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9468    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9469    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9470    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9471    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9472    7        END;
              9474    6             CALL GET_NEXT_SCANNER_LINE;
              9475    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9476                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9477    7     DO;
              9478    7       CALL SEARCH(BUFFER.COLUMN,
              9479    7                   BUFFER.CLASS,
              9480    7                   TABLE,
              9481    7                   BUFFER_LINE,
              9482    7                   BUFFER.COLUMN);
              9483    7     END;
              9485    6           END;
              9487    5                CALL CHECK_RELATIONAL_SEPARATOR;
              9488    5              END;
              9489    4          CASE (%END_OF_FILE);
              9490                 /* do nothing */
              9491    4          CASE (%END_OF_LINE);
              9492                  /* Do nothing */
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:82   
              9493    4          CASE (ELSE);
              9494                 /*V*
              9495                     ELSE --
              9496                             This includes parentheses, division, etc.  The
              9497                             symbol is built and returned.
              9498                 */
              9499                 %ADV_BUFFER_COLUMN;
              9500    5     DO;
              9501    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9502    5       CALL SEARCH(BUFFER.COLUMN,
              9503    5                   BUFFER.CLASS,
              9504    5                   TABLE,
              9505    5                   BUFFER_LINE,
              9506    5                   BUFFER.COLUMN)
              9507    5        WHENALTRETURN
              9508    6         DO;
              9509    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9510                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9511    7           DO;
              9512                  %CONCAT_SYMBOL;
              9513    8        DO;
              9514    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9515    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9516    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9517    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9518    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9519    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9520    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9521    8        END;
              9523    7             CALL GET_NEXT_SCANNER_LINE;
              9524    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9525                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9526    8     DO;
              9527    8       CALL SEARCH(BUFFER.COLUMN,
              9528    8                   BUFFER.CLASS,
              9529    8                   TABLE,
              9530    8                   BUFFER_LINE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:83   
              9531    8                   BUFFER.COLUMN);
              9532    8     END;
              9534    7           END;
              9536    6         END;
              9537    5     END;
              9539    4            CALL CHECK_NORMAL_SEPARATOR;
              9540    4        END;
              9541    3        IF LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL THEN
              9542               %TRANSLATE_TO_UPPER_CASE;
              9543    3      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),
              9544    3                 LOWER_TO_UPPER_CASE,
              9545    3                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              9547    3     END;  /* SCAN_SYMBOL MACRO */
      979     9549
      980     9550
      981     9551    2       CASE (%SCANNER_STATE_RESTART_PERIOD);
      982     9552               /* The separator period was found */
      983     9553    2          LEX_SYMBOL.LINE = RESTART_INFO.LINE;
      984     9554    2          LEX_SYMBOL.COLUMN = RESTART_INFO.COLUMN;
      985     9555    2          LEX_SYMBOL.FLAGS = FALSE;
      986     9556    2          LEX_SYMBOL.B.DEBUG_TOKEN = RESTART_INFO.DEBUG_TOKEN;
      987     9557    2          LEX_SYMBOL.TYPE = %PERIOD;
      988     9558    2          LEX_SYMBOL.SIZE = 1;
      989     9559    2          LEX_SYMBOL.LEVEL = RESTART_INFO.LEVEL;
      990     9560    2          LEX_SYMBOL.NEXT$ = ADDR(NIL);
      991     9561    2          SUBSTR(LEX_SYMBOL.SYMBOL,0,1) = '.';
      992     9562               %MARK_END_OF_SYMBOL;
              9563    3     DO;
              9564    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              9565    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              9566    3     END;
      993     9568    2          SCANNER_STATE = %SCANNER_STATE_NEW_TOKEN;
      994     9569
      995     9570    2       CASE (%SCANNER_STATE_RESTART_EQUAL);
      996     9571              /* The separator == was found */
      997     9572              %ADV_BUFFER_COLUMN;
              9573    3     DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:84   
              9574    3       BUFFER.COLUMN = BUFFER.COLUMN + 1;
              9575    3       CALL SEARCH(BUFFER.COLUMN,
              9576    3                   BUFFER.CLASS,
              9577    3                   TABLE,
              9578    3                   BUFFER_LINE,
              9579    3                   BUFFER.COLUMN)
              9580    3        WHENALTRETURN
              9581    4         DO;
              9582    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9583                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9584    5           DO;
              9585                  %CONCAT_SYMBOL;
              9586    6        DO;
              9587    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
              9588    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
              9589    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
              9590    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
              9591    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9592    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
              9593    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9594    6        END;
              9596    5             CALL GET_NEXT_SCANNER_LINE;
              9597    5             SYMBOL_START_LOCATION = BUFFER.COLUMN;
              9598                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9599    6     DO;
              9600    6       CALL SEARCH(BUFFER.COLUMN,
              9601    6                   BUFFER.CLASS,
              9602    6                   TABLE,
              9603    6                   BUFFER_LINE,
              9604    6                   BUFFER.COLUMN);
              9605    6     END;
              9607    5           END;
              9609    4         END;
              9610    3     END;
      998     9612    2         LEX_SYMBOL.LINE = RESTART_INFO.LINE;
      999     9613    2         LEX_SYMBOL.COLUMN = RESTART_INFO.COLUMN;
     1000     9614    2         LEX_SYMBOL.LEVEL = RESTART_INFO.LEVEL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:85   
     1001     9615    2         LEX_SYMBOL.NEXT$ = ADDR(NIL);
     1002     9616    2         LEX_SYMBOL.FLAGS = FALSE;
     1003     9617    2         LEX_SYMBOL.B.DEBUG_TOKEN = RESTART_INFO.DEBUG_TOKEN;
     1004     9618    2         LEX_SYMBOL.TYPE = %PSEUDO;
     1005     9619    2         O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;
     1006     9620    2         LEX_SYMBOL.SIZE = 2;
     1007     9621    2         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = '==';
     1008     9622               %MARK_END_OF_SYMBOL;
              9623    3     DO;
              9624    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
              9625    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;
              9626    3     END;
     1009     9628    2         SCANNER_STATE = %SCANNER_STATE_NEW_TOKEN;
     1010     9629
     1011     9630
     1012     9631    2     END; /* DO CASE */
     1013     9632
     1014     9633
     1015     9634
     1016     9635    1   END Z8ES$SCANNER;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:86   
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8ES$SCANNER.

   Procedure Z8ES$SCANNER requires 3455 words for executable code.
   Procedure Z8ES$SCANNER is declared NOAUTO and requires 22 words of local(STATIC) storage.

    No errors detected in file Z8ES.:Z8A6TSI    .

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:87   

 Object Unit name= Z8ES$SCANNER                               File name= Z8ES.:Z8A6TOU
 UTS= AUG 09 '97 12:36:11.12 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    22     26  Z8ES$SCANNER
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  DNT$
    3  LblCom even  none     5      5  DNT_
    4  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    5  LblCom even  none     1      1  DNT_OF_1$
    6  LblCom even  none    90    132  LEX_SYMBOL
    7  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    8  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    9  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   10  LblCom even  none     1      1  SCANNER_STATE
   11  LblCom even  none     1      1  CURRENT_BUFFER$
   12  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   13  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   14  LblCom even  none     1      1  LINE_LIST$
   15  LblCom even  none     7      7  BUFFER
   16  LblCom even  none     1      1  ORIGINAL_ISN
   17  LblCom even  none     1      1  EXPANDED_ISN
   18  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   19  LblCom even  none     1      1  GET_NEXT_SCANNER_LINE
   20  RoData even  UTS      1      1  Z8ES$SCANNER
   21   Proc  even  none  3455   6577  Z8ES$SCANNER
   22  RoData even  none    13     15  Z8ES$SCANNER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:88   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        0  Z8ES$SCANNER

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    USERWORD_SCAN_TABLE              r    ANSI_USERWORD_SCAN_TABLE
r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE                 r    DIGIT_SCAN_TABLE
r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE        r    SINGLE_QUOTE_SEARCH_TABLE
r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r    SNGL_QUOTE_PSEUDO_SEARCH_TABLE   r    SEPARATORS_TABLE
r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS                   O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:89   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8ES$SCANNER :PROC NOAUTO;

      6 21 000000   000000 741200 0     Z8ES$SCANNER STX1  ! 0
        21 000001   003305 710000 21                 TRA     RESTART_FROM_SEPARATOR

        7        7        /*M* Z8ES$SCANNER - Scans next symbol */
        8        8
        9        9        /*P*
       10       10               NAME:  Z8ES$SCANNER
       11       11            PURPOSE:  Locates the next token in the current source line and returns
       12       12                      it in LEX_SYMBOL.
       13       13        */
       14       14
       15       15        /*D*
       16       16               NAME:  Z8ES$SCANNER
       17       17               CALL:  CALL Z8ES$SCANNER
       18       18
       19       19             OUTPUT:  LEX_SYMBOL -- Symbol that was scanned.
       20       20
       21       21        DESCRIPTION:  This procedure places the next symbol in LEX_SYMBOL.  The PL6
       22       22                      built-in subroutine SEARCH is used to scan the symbols.
       23       23                      Source lines are operated on one at a time and SEARCH is used
       24       24                      to find the next non-blank character.  This drives a case
       25       25                      statement which breaks the symbol into a certain class.
       26       26
       27       27                      The scanner searches for a COBOL separator for this type
       28       28                      of symbol.  The scanner determines if the separator is valid
       29       29                      and returns the symbol.  No errors for illegal symbols are
       30       30                      handled by the scanner.  In the case where the separator is
       31       31                      invalid, either the token type is set to illegal, or
       32       32                      LEX_SYMBOL.B.DELIM_ERROR is set to indicate the error.
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:90   
       33       33        */
       34       34
       35       35        %SET PHASE = 1;
       36       36
       37       37        %INCLUDE Z9A_FLAGS;
       38       51        %INCLUDE Z8A_DEFC;
       39      119        %INCLUDE Z8A_COMCOM;
       40      769        %INCLUDE Z8A_DNT;
       41      990        %INCLUDE Z8E_WINDOW;
       42     3060        %INCLUDE Z8E_TABLES;
       43     3613        %INCLUDE Z8E_STACKS;
       44     5879        %INCLUDE Z8E_BUFFERS;
       45     6069        %INCLUDE Z8E_O1COM ;
       46     6830
       47     6831
       48     6832    1   DCL STOP_SCAN_FLAG BOOLEAN;
       49     6833
       50     6834    1   DCL 1 RESTART_INFO STATIC,
       51     6835    1         2 LINE SBIN WORD,
       52     6836    1         2 COLUMN SBIN WORD,
       53     6837    1         2 LEVEL  SBIN WORD,
       54     6838    1         2 DEBUG_TOKEN BOOLEAN;
       55     6839
       56     6840    1   DCL 1 BASED$TABLE ALIGNED BASED(TABLE$),
       57     6841    1         2 * (0:511) UBIN(9) CALIGNED;
       58     6842    1   DCL TABLE$ PTR;
       59     6843
       60     6844        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:91   
       61     6845        /*
       62     6846          BUFFER.CLASS is composed of:
       63     6847
       64     6848             %SPACE
       65     6849             %COMMA              ,
       66     6850             %SEMICOLON          ;
       67     6851             %ILLEGAL_CHARACTER
       68     6852             %DOUBLE_QUOTE       "
       69     6853             %SINGLE_QUOTE       ' or `' ;
       70     6854             %LEFT_PAREN         (
       71     6855             %RIGHT_PAREN        )
       72     6856             %STAR               *
       73     6857             %PLUS               +
       74     6858             %MINUS              -
       75     6859             %PERIOD             .
       76     6860             %SLASH              /
       77     6861             %COLON              :
       78     6862             %LESS_THAN          <
       79     6863             %GREATER_THAN       >
       80     6864             %EQUAL              =
       81     6865             %UP_ARROW           ^
       82     6866             %DOLLAR             $
       83     6867             %UNDER_SCORE        _
       84     6868             %DIGIT              0-9
       85     6869             %LETTER             a-z, A-Z, except e and E
       86     6870             %LETTER_E           e or E
       87     6871        */
       88     6872        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:92   
       89     6873        /* GET_NEXT_SCANNER_LINE is called to obtain continuation lines
       90     6874           when required */
       91     6875    1   DCL GET_NEXT_SCANNER_LINE EPTR EXT;
       92     6876
       93     6877        /*B*
       94     6878            SIZE_VARS:
       95     6879
       96     6880               SEARCH_SIZE -- Length of the current string being scanned
       97     6881                              (BUFFER.COLUMN - SYMBOL_START_LOCATION).  Used when placing
       98     6882                              the symbol in LEX_SYMBOL.SYMBOL.
       99     6883
      100     6884               SYMBOL_START_LOCATION -- Starting column of the current string being
      101     6885                                        scanned.
      102     6886
      103     6887        */
      104     6888
      105     6889    1   DCL SEARCH_SIZE SBIN WORD;
      106     6890    1   DCL SYMBOL_START_LOCATION SBIN WORD;
      107     6891
      108     6892        /* Temporary label creation */
      109     6893        %SET LABNUM = 1;
      110     6894
      111     6895        /*V* GCOS_PRECAUTION -- Because of a known hardware bug it is necessary to
      112     6896                                make sure certain read-only tables are in real
      113     6897                                memory before they are referenced by EIS
      114     6898                                instructions, under penalty of IPR ON MISSING PAGE.
      115     6899                                                                            */
      116     6900
      117     6901        %IF GCOS;
      119     6903        %ENDIF;
      120     6904        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:93   
      121     6905        /*V*
      122     6906            CONCAT_SYMBOL -- Concatenate the characters in the source line starting at
      123     6907                            the symbol start and includes all characters up to the
      124     6908                            current buffer position.   The size field is then updated
      125     6909                            to be the total size.
      126     6910        */
      127     6911
      128     6912
      129     6913        %MACRO CONCAT_SYMBOL ;
      130     6914             DO;
      131     6915               SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
      132     6916               IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
      133     6917                 SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
      134     6918               SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
      135     6919                   = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
      136     6920               LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
      137     6921               SYMBOL_START_LOCATION = BUFFER.COLUMN;
      138     6922             END;
      139     6923        %MEND;
      140     6924        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:94   
      141     6925        %MACRO SCAN_SEARCH_THIS_LINE(TABLE=);
      142     6926
      143     6927          DO;
      144     6928            CALL SEARCH(BUFFER.COLUMN,
      145     6929                        BUFFER.CLASS,
      146     6930                        TABLE,
      147     6931                        BUFFER_LINE,
      148     6932                        BUFFER.COLUMN);
      149     6933          END;
      150     6934
      151     6935        %MEND;
      152     6936        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:95   
      153     6937        %MACRO SCAN_SEARCH(TABLE=);
      154     6938
      155     6939          DO;
      156     6940            CALL SEARCH(BUFFER.COLUMN,
      157     6941                        BUFFER.CLASS,
      158     6942                        TABLE,
      159     6943                        BUFFER_LINE,
      160     6944                        BUFFER.COLUMN)
      161     6945                 WHENALTRETURN
      162     6946                   DO;
      163     6947                     IF BUFFER.CLASS = %END_OF_LINE
      164     6948                          AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      165     6949                       CALL CONTINUATION (TABLE);
      166     6950                   END;
      167     6951          END;
      168     6952
      169     6953        %MEND;
      170     6954        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:96   
      171     6955        /*V*
      172     6956            SCAN_BLANKS -- Beginning at the current column scan through all delimiters.
      173     6957                           BUFFER.COLUMN and BUFFER.CLASS will be updated to the new
      174     6958                           symbol.
      175     6959        */
      176     6960
      177     6961
      178     6962        %MACRO SCAN_BLANKS;
      179     6963
      180     6964             DO;
      181     6965               %SCAN_SEARCH(TABLE=BLANK_SCAN_TABLE);
      182     6966             END;
      183     6967        %MEND;
      184     6968
      185     6969        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:97   
      186     6970        %MACRO ADV_BUFFER_COLUMN_THIS_LINE(TABLE=ASCII_SEARCH_TABLE);
      187     6971
      188     6972          DO;
      189     6973            BUFFER.COLUMN = BUFFER.COLUMN + 1;
      190     6974            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
      191     6975          END;
      192     6976
      193     6977        %MEND;
      194     6978        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:98   
      195     6979        %MACRO ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=ASCII_SEARCH_TABLE);
      196     6980                DO;
      197     6981                  %CONCAT_SYMBOL;
      198     6982                  CALL GET_NEXT_SCANNER_LINE;
      199     6983                  SYMBOL_START_LOCATION = BUFFER.COLUMN;
      200     6984                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
      201     6985                END;
      202     6986        %MEND;
      203     6987        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:99   
      204     6988        %MACRO ADV_BUFFER_COLUMN(TABLE=ASCII_SEARCH_TABLE);
      205     6989
      206     6990          DO;
      207     6991            BUFFER.COLUMN = BUFFER.COLUMN + 1;
      208     6992            CALL SEARCH(BUFFER.COLUMN,
      209     6993                        BUFFER.CLASS,
      210     6994                        TABLE,
      211     6995                        BUFFER_LINE,
      212     6996                        BUFFER.COLUMN)
      213     6997             WHENALTRETURN
      214     6998              DO;
      215     6999                IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      216     7000                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
      217     7001              END;
      218     7002          END;
      219     7003        %MEND;
      220     7004        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:100  
      221     7005        %MACRO INITIALIZE_SYMBOL;
      222     7006          DO;
      223     7007             /* Initialize token */
      224     7008             LEX_SYMBOL.LINE    = BUFFER.ISN;
      225     7009             LEX_SYMBOL.COLUMN  = BUFFER.COLUMN;
      226     7010             LEX_SYMBOL.FLAGS   = FALSE;
      227     7011             LEX_SYMBOL.TYPE    = BUFFER.CLASS;
      228     7012             LEX_SYMBOL.SIZE    = 0;
      229     7013             LEX_SYMBOL.LEVEL  = BUFFER.LEVEL;
      230     7014             LEX_SYMBOL.NEXT$ = ADDR(NIL);
      231     7015             LEX_SYMBOL.B.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
      232     7016          END;
      233     7017        %MEND;
      234     7018        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:101  
      235     7019        %MACRO MARK_END_OF_SYMBOL;
      236     7020          DO;
      237     7021            LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
      238     7022            LEX_SYMBOL.END_LINE   = BUFFER.ISN;
      239     7023          END;
      240     7024        %MEND;
      241     7025        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:102  
      242     7026        %MACRO SAVE_RESTART_INFO;
      243     7027          DO;
      244     7028            RESTART_INFO.LINE   = BUFFER.ISN;
      245     7029            RESTART_INFO.COLUMN = BUFFER.COLUMN;
      246     7030            RESTART_INFO.LEVEL = BUFFER.LEVEL;
      247     7031            RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;
      248     7032          END;
      249     7033        %MEND;
      250     7034        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:103  
      251     7035        %MACRO TRANSLATE_TO_UPPER_CASE;
      252     7036           CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),
      253     7037                      LOWER_TO_UPPER_CASE,
      254     7038                      SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
      255     7039        %MEND;
      256     7040        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:104  
      257     7041        %MACRO NEXT_TWO_CHARS_ARE_PSEUDO;
      258     7042
      259     7043          (BUFFER.CLASS = %EQUAL
      260     7044            AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
      261     7045            AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      262     7046
      263     7047        %MEND;
      264     7048        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:105  
      265     7049        %LIST;
      266     7050    1   CONTINUATION : PROC (TABLE);

   7050 21 000002   000011 741200 0     CONTINUATION STX1  ! SYMBOL_START_LOCATION+1

      267     7051
      268     7052    2     DCL TABLE(0:511) UBIN(9) ALIGNED;
      269     7053
      270     7054    3     DO WHILE BUFFER.CLASS = %END_OF_LINE

   7054 21 000003   000060 710000 21                 TRA     s:7079

      271     7055    3                 AND BUFFER.LINE_TYPE.LINE_CONTINUED;
      272     7056            %CONCAT_SYMBOL;
              7057    4        DO;

              7058    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7058 21 000004   000000 236000 15                 LDQ     BUFFER
        21 000005   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000006   000007 756000 0                  STQ     SEARCH_SIZE

              7059    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7059 21 000007   000504 236007                    LDQ     324,DL
        21 000010   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000011   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000012   000014 605000 21                 TPL     s:7061

              7060    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7060 21 000013   000007 756000 0                  STQ     SEARCH_SIZE

              7061    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7061 21 000014   000006 470400 15                 LDP0    BUFFER+6
        21 000015   000007 720000 0                  LXL0    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:106  
        21 000016   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000017   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000020   040046 100545                    MLR     fill='040'O
        21 000021   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000022   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7062    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7063    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7063 21 000023   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000024   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000025   000010 756000 6                  STQ     LEX_SYMBOL+8

              7064    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7064 21 000026   000000 235000 15                 LDA     BUFFER
        21 000027   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7065    4        END;

      273     7067    3       LEX_SYMBOL.B.CONTINUED_TOKEN = TRUE;

   7067 21 000030   040000 236003                    LDQ     16384,DU
        21 000031   000002 256000 6                  ORSQ    LEX_SYMBOL+2

      274     7068    3       CALL GET_NEXT_SCANNER_LINE;

   7068 21 000032   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 000033   000000 631400 22                 EPPR1   0
        21 000034   000000 701011                    TSX1    0,X1
        21 000035   000000 011000                    NOP     0

      275     7069    3       SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7069 21 000036   000000 235000 15                 LDA     BUFFER
        21 000037   000010 755000 0                  STA     SYMBOL_START_LOCATION

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:107  
      276     7070            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7071    4     DO;

              7072    4       CALL SEARCH(BUFFER.COLUMN,

   7072 21 000040   000005 236000 15                 LDQ     BUFFER+5
        21 000041   000000 136000 15                 SBLQ    BUFFER
        21 000042   000024 756000 0                  STQ     @TABLE+10
        21 000043   000000 236000 15                 LDQ     BUFFER
        21 000044   000012 470400 0                  LDP0    @TABLE
        21 000045   000006 471400 15                 LDP1    BUFFER+6
        21 000046   000024 720000 0                  LXL0    @TABLE+10
        21 000047   000000 164546                    TCT
        21 000050   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        21 000051   000000 000100                    ARG     0,,PR0
        21 000052   000000 000000 15                 ARG     BUFFER
        21 000053   000000 235000 15                 LDA     BUFFER
        21 000054   000033 771000                    ARL     27
        21 000055   000001 755000 15                 STA     BUFFER+1
        21 000056   000000 551040 15                 STBA    BUFFER,'40'O
        21 000057   000000 056000 15                 ASQ     BUFFER

              7073    4                   BUFFER.CLASS,
              7074    4                   TABLE,
              7075    4                   BUFFER_LINE,
              7076    4                   BUFFER.COLUMN);
              7077    4     END;

      277     7079    3     END;

   7079 21 000060   000001 235000 15                 LDA     BUFFER+1
        21 000061   000065 601000 21                 TNZ     s:7081
        21 000062   000004 236000 15                 LDQ     BUFFER+4
        21 000063   100000 316003                    CANQ    32768,DU
        21 000064   000004 601000 21                 TNZ     s:7058

      278     7080
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:108  
      279     7081    2   END CONTINUATION;

   7081 21 000065   000011 221200 0                  LDX1  ! SYMBOL_START_LOCATION+1
        21 000066   000001 702211                    TSX2  ! 1,X1

      280     7082        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:109  
      281     7083    1   CHECK_RELATIONAL_SEPARATOR : PROC;

   7083 21 000067   000013 741200 0     CHECK_RELAT* STX1  ! @TABLE+1

      282     7084    3     DO CASE (BUFFER.CLASS);

   7084 21 000070   000001 235000 15                 LDA     BUFFER+1
        21 000071   000042 115007                    CMPA    34,DL
        21 000072   000074 602005 21                 TNC     s:7084+4,AL
        21 000073   000166 710000 21                 TRA     s:7104
        21 000074   000166 710000 21                 TRA     s:7104
        21 000075   000166 710000 21                 TRA     s:7104
        21 000076   000136 710000 21                 TRA     s:7088
        21 000077   000166 710000 21                 TRA     s:7104
        21 000100   000166 710000 21                 TRA     s:7104
        21 000101   000136 710000 21                 TRA     s:7088
        21 000102   000166 710000 21                 TRA     s:7104
        21 000103   000166 710000 21                 TRA     s:7104
        21 000104   000166 710000 21                 TRA     s:7104
        21 000105   000166 710000 21                 TRA     s:7104
        21 000106   000136 710000 21                 TRA     s:7088
        21 000107   000136 710000 21                 TRA     s:7088
        21 000110   000166 710000 21                 TRA     s:7104
        21 000111   000166 710000 21                 TRA     s:7104
        21 000112   000166 710000 21                 TRA     s:7104
        21 000113   000166 710000 21                 TRA     s:7104
        21 000114   000166 710000 21                 TRA     s:7104
        21 000115   000166 710000 21                 TRA     s:7104
        21 000116   000166 710000 21                 TRA     s:7104
        21 000117   000166 710000 21                 TRA     s:7104
        21 000120   000166 710000 21                 TRA     s:7104
        21 000121   000166 710000 21                 TRA     s:7104
        21 000122   000166 710000 21                 TRA     s:7104
        21 000123   000166 710000 21                 TRA     s:7104
        21 000124   000166 710000 21                 TRA     s:7104
        21 000125   000166 710000 21                 TRA     s:7104
        21 000126   000166 710000 21                 TRA     s:7104
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:110  
        21 000127   000166 710000 21                 TRA     s:7104
        21 000130   000166 710000 21                 TRA     s:7104
        21 000131   000166 710000 21                 TRA     s:7104
        21 000132   000166 710000 21                 TRA     s:7104
        21 000133   000166 710000 21                 TRA     s:7104
        21 000134   000166 710000 21                 TRA     s:7104
        21 000135   000136 710000 21                 TRA     s:7088

      283     7085    3       CASE (%DIGIT, %LETTER, %LETTER_E, %PLUS, %MINUS);

      284     7086              %CONCAT_SYMBOL;
              7087    4        DO;

              7088    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7088 21 000136   000000 236000 15                 LDQ     BUFFER
        21 000137   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000140   000007 756000 0                  STQ     SEARCH_SIZE

              7089    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7089 21 000141   000504 236007                    LDQ     324,DL
        21 000142   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000143   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000144   000146 605000 21                 TPL     s:7091

              7090    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7090 21 000145   000007 756000 0                  STQ     SEARCH_SIZE

              7091    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7091 21 000146   000006 470400 15                 LDP0    BUFFER+6
        21 000147   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000150   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000151   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000152   040046 100545                    MLR     fill='040'O
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:111  
        21 000153   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000154   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7092    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7093    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7093 21 000155   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000156   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000157   000010 756000 6                  STQ     LEX_SYMBOL+8

              7094    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7094 21 000160   000000 235000 15                 LDA     BUFFER
        21 000161   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7095    4        END;

      285     7097              %MARK_END_OF_SYMBOL;
              7098    4     DO;

              7099    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7099 21 000162   000007 755000 6                  STA     LEX_SYMBOL+7

              7100    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7100 21 000163   000002 235000 15                 LDA     BUFFER+2
        21 000164   000006 755000 6                  STA     LEX_SYMBOL+6

              7101    4     END;

   7101 21 000165   000170 710000 21                 TRA     s:7106

      286     7103    3       CASE (ELSE);

      287     7104    3         CALL CHECK_NORMAL_SEPARATOR;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:112  
   7104 21 000166   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 000167   000000 011000                    NOP     0

      288     7105    3     END; /* CASE */

      289     7106    2   END CHECK_RELATIONAL_SEPARATOR;

   7106 21 000170   000013 221200 0                  LDX1  ! @TABLE+1
        21 000171   000001 702211                    TSX2  ! 1,X1

      290     7107        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:113  
      291     7108    1   CHECK_NORMAL_SEPARATOR : PROC;

   7108 21 000172   000014 741200 0     CHECK_NORMA* STX1  ! @TABLE+2

      292     7109
      293     7110    2   CHECK_SEPARATOR:
      294     7111
      295     7112    3     DO CASE (BUFFER.CLASS);

   7112 21 000173   000001 235000 15    CHECK_SEPAR* LDA     BUFFER+1
        21 000174   000044 115007                    CMPA    36,DL
        21 000175   000177 602005 21                 TNC     CHECK_SEPARATOR+4,AL
        21 000176   000752 710000 21                 TRA     s:7364
        21 000177   000243 710000 21                 TRA     s:7118
        21 000200   000752 710000 21                 TRA     s:7364
        21 000201   000752 710000 21                 TRA     s:7364
        21 000202   000716 710000 21                 TRA     s:7344
        21 000203   000716 710000 21                 TRA     s:7344
        21 000204   000752 710000 21                 TRA     s:7364
        21 000205   000243 710000 21                 TRA     s:7118
        21 000206   000243 710000 21                 TRA     s:7118
        21 000207   000752 710000 21                 TRA     s:7364
        21 000210   000752 710000 21                 TRA     s:7364
        21 000211   000752 710000 21                 TRA     s:7364
        21 000212   000752 710000 21                 TRA     s:7364
        21 000213   000445 710000 21                 TRA     s:7212
        21 000214   000752 710000 21                 TRA     s:7364
        21 000215   000243 710000 21                 TRA     s:7118
        21 000216   000752 710000 21                 TRA     s:7364
        21 000217   000752 710000 21                 TRA     s:7364
        21 000220   000630 710000 21                 TRA     s:7294
        21 000221   000752 710000 21                 TRA     s:7364
        21 000222   000752 710000 21                 TRA     s:7364
        21 000223   000752 710000 21                 TRA     s:7364
        21 000224   000752 710000 21                 TRA     s:7364
        21 000225   000752 710000 21                 TRA     s:7364
        21 000226   000752 710000 21                 TRA     s:7364
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:114  
        21 000227   000752 710000 21                 TRA     s:7364
        21 000230   000752 710000 21                 TRA     s:7364
        21 000231   000752 710000 21                 TRA     s:7364
        21 000232   000752 710000 21                 TRA     s:7364
        21 000233   000752 710000 21                 TRA     s:7364
        21 000234   000273 710000 21                 TRA     s:7138
        21 000235   000752 710000 21                 TRA     s:7364
        21 000236   000752 710000 21                 TRA     s:7364
        21 000237   000752 710000 21                 TRA     s:7364
        21 000240   000752 710000 21                 TRA     s:7364
        21 000241   000243 710000 21                 TRA     s:7118
        21 000242   000273 710000 21                 TRA     s:7138

      296     7113
      297     7114    3       CASE(%SPACE, %END_OF_LINE, %COLON, %LEFT_PAREN, %RIGHT_PAREN);

      298     7115
      299     7116              %CONCAT_SYMBOL;
              7117    4        DO;

              7118    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7118 21 000243   000000 236000 15                 LDQ     BUFFER
        21 000244   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000245   000007 756000 0                  STQ     SEARCH_SIZE

              7119    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7119 21 000246   000504 236007                    LDQ     324,DL
        21 000247   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000250   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000251   000253 605000 21                 TPL     s:7121

              7120    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7120 21 000252   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:115  
              7121    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7121 21 000253   000006 470400 15                 LDP0    BUFFER+6
        21 000254   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000255   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000256   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000257   040046 100545                    MLR     fill='040'O
        21 000260   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000261   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7122    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7123    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7123 21 000262   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000263   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000264   000010 756000 6                  STQ     LEX_SYMBOL+8

              7124    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7124 21 000265   000000 235000 15                 LDA     BUFFER
        21 000266   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7125    4        END;

      300     7127              %MARK_END_OF_SYMBOL;
              7128    4     DO;

              7129    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7129 21 000267   000007 755000 6                  STA     LEX_SYMBOL+7

              7130    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7130 21 000270   000002 235000 15                 LDA     BUFFER+2
        21 000271   000006 755000 6                  STA     LEX_SYMBOL+6

              7131    4     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:116  

   7131 21 000272   000753 710000 21                 TRA     s:7368

      301     7133
      302     7134    3       CASE(%COMMA, %SEMICOLON);

      303     7135
      304     7136              %MARK_END_OF_SYMBOL;
              7137    4     DO;

              7138    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7138 21 000273   000000 236000 15                 LDQ     BUFFER
        21 000274   000007 756000 6                  STQ     LEX_SYMBOL+7

              7139    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7139 21 000275   000002 235000 15                 LDA     BUFFER+2
        21 000276   000006 755000 6                  STA     LEX_SYMBOL+6

              7140    4     END;

      305     7142              %ADV_BUFFER_COLUMN;
              7143    4     DO;

              7144    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7144 21 000277   000000 054000 15                 AOS     BUFFER

              7145    4       CALL SEARCH(BUFFER.COLUMN,

   7145 21 000300   000005 236000 15                 LDQ     BUFFER+5
        21 000301   000000 136000 15                 SBLQ    BUFFER
        21 000302   000024 756000 0                  STQ     @TABLE+10
        21 000303   000000 236000 15                 LDQ     BUFFER
        21 000304   000006 470400 15                 LDP0    BUFFER+6
        21 000305   000024 720000 0                  LXL0    @TABLE+10
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:117  
        21 000306   000000 164546                    TCT
        21 000307   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 000310   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 000311   000000 000000 15                 ARG     BUFFER
        21 000312   000000 235000 15                 LDA     BUFFER
        21 000313   000033 771000                    ARL     27
        21 000314   000001 755000 15                 STA     BUFFER+1
        21 000315   000000 551040 15                 STBA    BUFFER,'40'O
        21 000316   000000 056000 15                 ASQ     BUFFER
        21 000317   000321 606400 21                 TTN     s:7152
        21 000320   000375 710000 21                 TRA     s:7184

              7146    4                   BUFFER.CLASS,
              7147    4                   TABLE,
              7148    4                   BUFFER_LINE,
              7149    4                   BUFFER.COLUMN)
              7150    4        WHENALTRETURN
              7151    5         DO;

              7152    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7152 21 000321   000004 236000 15                 LDQ     BUFFER+4
        21 000322   100000 316003                    CANQ    32768,DU
        21 000323   000375 600000 21                 TZE     s:7184

              7153                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7154    6           DO;

              7155                  %CONCAT_SYMBOL;
              7156    7        DO;

              7157    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7157 21 000324   000000 236000 15                 LDQ     BUFFER
        21 000325   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000326   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:118  
              7158    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7158 21 000327   000504 236007                    LDQ     324,DL
        21 000330   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000331   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000332   000334 605000 21                 TPL     s:7160

              7159    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7159 21 000333   000007 756000 0                  STQ     SEARCH_SIZE

              7160    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7160 21 000334   000006 470400 15                 LDP0    BUFFER+6
        21 000335   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000336   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000337   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000340   040046 100545                    MLR     fill='040'O
        21 000341   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000342   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7161    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7162    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7162 21 000343   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000344   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000345   000010 756000 6                  STQ     LEX_SYMBOL+8

              7163    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7163 21 000346   000000 235000 15                 LDA     BUFFER
        21 000347   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7164    7        END;

              7166    6             CALL GET_NEXT_SCANNER_LINE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:119  
   7166 21 000350   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 000351   000000 631400 22                 EPPR1   0
        21 000352   000000 701011                    TSX1    0,X1
        21 000353   000000 011000                    NOP     0

              7167    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7167 21 000354   000000 235000 15                 LDA     BUFFER
        21 000355   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7168                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7169    7     DO;

              7170    7       CALL SEARCH(BUFFER.COLUMN,

   7170 21 000356   000005 236000 15                 LDQ     BUFFER+5
        21 000357   000000 136000 15                 SBLQ    BUFFER
        21 000360   000024 756000 0                  STQ     @TABLE+10
        21 000361   000000 236000 15                 LDQ     BUFFER
        21 000362   000006 470400 15                 LDP0    BUFFER+6
        21 000363   000024 720000 0                  LXL0    @TABLE+10
        21 000364   000000 164546                    TCT
        21 000365   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 000366   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 000367   000000 000000 15                 ARG     BUFFER
        21 000370   000000 235000 15                 LDA     BUFFER
        21 000371   000033 771000                    ARL     27
        21 000372   000001 755000 15                 STA     BUFFER+1
        21 000373   000000 551040 15                 STBA    BUFFER,'40'O
        21 000374   000000 056000 15                 ASQ     BUFFER

              7171    7                   BUFFER.CLASS,
              7172    7                   TABLE,
              7173    7                   BUFFER_LINE,
              7174    7                   BUFFER.COLUMN);
              7175    7     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:120  
              7177    6           END;

              7179    5         END;

              7180    4     END;

      306     7182              %CONCAT_SYMBOL;
              7183    4        DO;

              7184    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7184 21 000375   000000 236000 15                 LDQ     BUFFER
        21 000376   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000377   000007 756000 0                  STQ     SEARCH_SIZE

              7185    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7185 21 000400   000504 236007                    LDQ     324,DL
        21 000401   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000402   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000403   000405 605000 21                 TPL     s:7187

              7186    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7186 21 000404   000007 756000 0                  STQ     SEARCH_SIZE

              7187    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7187 21 000405   000006 470400 15                 LDP0    BUFFER+6
        21 000406   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000407   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000410   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000411   040046 100545                    MLR     fill='040'O
        21 000412   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000413   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7188    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:121  
              7189    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7189 21 000414   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000415   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000416   000010 756000 6                  STQ     LEX_SYMBOL+8

              7190    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7190 21 000417   000000 235000 15                 LDA     BUFFER
        21 000420   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7191    4        END;

      307     7193    3         IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR

   7193 21 000421   000001 235000 15                 LDA     BUFFER+1
        21 000422   000042 115007                    CMPA    34,DL
        21 000423   000441 600000 21                 TZE     s:7201
        21 000424   000000 115003                    CMPA    0,DU
        21 000425   000441 600000 21                 TZE     s:7201
        21 000426   000021 115007                    CMPA    17,DL
        21 000427   000444 601000 21                 TNZ     s:7205
        21 000430   000000 236000 15                 LDQ     BUFFER
        21 000431   000001 036007                    ADLQ    1,DL
        21 000432   000005 116000 15                 CMPQ    BUFFER+5
        21 000433   000444 605000 21                 TPL     s:7205
        21 000434   000000 235000 15                 LDA     BUFFER
        21 000435   040000 106505                    CMPC    fill='040'O
        21 000436   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 000437   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 000440   000444 601000 21                 TNZ     s:7205

      308     7194                    %NEXT_TWO_CHARS_ARE_PSEUDO;
              7195    3     (BUFFER.CLASS = %EQUAL
              7196    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7197    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      309     7199    3                                           THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:122  
      310     7200    4           DO;

      311     7201    4             LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;

   7201 21 000441   000001 336007                    LCQ     1,DL
        21 000442   000010 056000 6                  ASQ     LEX_SYMBOL+8

      312     7202    4           END;

   7202 21 000443   000753 710000 21                 TRA     s:7368

      313     7203    3         ELSE
      314     7204    4           DO;

      315     7205    4             GOTO SCAN_SEPARATOR;

   7205 21 000444   000755 710000 21                 TRA     SCAN_SEPARATOR

      316     7206    4           END;
      317     7207
      318     7208    3       CASE(%PERIOD);

      319     7209
      320     7210              %SAVE_RESTART_INFO;
              7211    4     DO;

              7212    4       RESTART_INFO.LINE   = BUFFER.ISN;

   7212 21 000445   000002 236000 15                 LDQ     BUFFER+2
        21 000446   000002 756000 0                  STQ     RESTART_INFO

              7213    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;

   7213 21 000447   000000 235000 15                 LDA     BUFFER
        21 000450   000003 755000 0                  STA     RESTART_INFO+1

              7214    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:123  

   7214 21 000451   000003 235000 15                 LDA     BUFFER+3
        21 000452   000004 755000 0                  STA     RESTART_INFO+2

              7215    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   7215 21 000453   000004 236000 15                 LDQ     BUFFER+4
        21 000454   000001 736000                    QLS     1
        21 000455   400000 376003                    ANQ     -131072,DU
        21 000456   000005 756000 0                  STQ     RESTART_INFO+3

              7216    4     END;

      321     7218              %CONCAT_SYMBOL;
              7219    4        DO;

              7220    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7220 21 000457   000000 236000 15                 LDQ     BUFFER
        21 000460   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000461   000007 756000 0                  STQ     SEARCH_SIZE

              7221    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7221 21 000462   000504 236007                    LDQ     324,DL
        21 000463   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000464   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000465   000467 605000 21                 TPL     s:7223

              7222    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7222 21 000466   000007 756000 0                  STQ     SEARCH_SIZE

              7223    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7223 21 000467   000006 470400 15                 LDP0    BUFFER+6
        21 000470   000007 720000 0                  LXL0    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:124  
        21 000471   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000472   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000473   040046 100545                    MLR     fill='040'O
        21 000474   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000475   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7224    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7225    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7225 21 000476   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000477   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000500   000010 756000 6                  STQ     LEX_SYMBOL+8

              7226    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7226 21 000501   000000 235000 15                 LDA     BUFFER
        21 000502   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7227    4        END;

      322     7229              %MARK_END_OF_SYMBOL;
              7230    4     DO;

              7231    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7231 21 000503   000007 755000 6                  STA     LEX_SYMBOL+7

              7232    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7232 21 000504   000002 235000 15                 LDA     BUFFER+2
        21 000505   000006 755000 6                  STA     LEX_SYMBOL+6

              7233    4     END;

      323     7235              %ADV_BUFFER_COLUMN;
              7236    4     DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:125  
              7237    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7237 21 000506   000000 054000 15                 AOS     BUFFER

              7238    4       CALL SEARCH(BUFFER.COLUMN,

   7238 21 000507   000005 236000 15                 LDQ     BUFFER+5
        21 000510   000000 136000 15                 SBLQ    BUFFER
        21 000511   000024 756000 0                  STQ     @TABLE+10
        21 000512   000000 236000 15                 LDQ     BUFFER
        21 000513   000024 721000 0                  LXL1    @TABLE+10
        21 000514   000000 164546                    TCT
        21 000515   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 000516   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 000517   000000 000000 15                 ARG     BUFFER
        21 000520   000000 235000 15                 LDA     BUFFER
        21 000521   000033 771000                    ARL     27
        21 000522   000001 755000 15                 STA     BUFFER+1
        21 000523   000000 551040 15                 STBA    BUFFER,'40'O
        21 000524   000000 056000 15                 ASQ     BUFFER
        21 000525   000527 606400 21                 TTN     s:7245
        21 000526   000603 710000 21                 TRA     s:7275

              7239    4                   BUFFER.CLASS,
              7240    4                   TABLE,
              7241    4                   BUFFER_LINE,
              7242    4                   BUFFER.COLUMN)
              7243    4        WHENALTRETURN
              7244    5         DO;

              7245    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7245 21 000527   000004 236000 15                 LDQ     BUFFER+4
        21 000530   100000 316003                    CANQ    32768,DU
        21 000531   000603 600000 21                 TZE     s:7275

              7246                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:126  
              7247    6           DO;

              7248                  %CONCAT_SYMBOL;
              7249    7        DO;

              7250    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7250 21 000532   000000 236000 15                 LDQ     BUFFER
        21 000533   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000534   000007 756000 0                  STQ     SEARCH_SIZE

              7251    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7251 21 000535   000504 236007                    LDQ     324,DL
        21 000536   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000537   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000540   000542 605000 21                 TPL     s:7253

              7252    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7252 21 000541   000007 756000 0                  STQ     SEARCH_SIZE

              7253    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7253 21 000542   000006 470400 15                 LDP0    BUFFER+6
        21 000543   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000544   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000545   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000546   040046 100545                    MLR     fill='040'O
        21 000547   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000550   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7254    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7255    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7255 21 000551   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000552   000007 036000 0                  ADLQ    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:127  
        21 000553   000010 756000 6                  STQ     LEX_SYMBOL+8

              7256    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7256 21 000554   000000 235000 15                 LDA     BUFFER
        21 000555   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7257    7        END;

              7259    6             CALL GET_NEXT_SCANNER_LINE;

   7259 21 000556   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 000557   000000 631400 22                 EPPR1   0
        21 000560   000000 701011                    TSX1    0,X1
        21 000561   000000 011000                    NOP     0

              7260    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7260 21 000562   000000 235000 15                 LDA     BUFFER
        21 000563   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7261                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7262    7     DO;

              7263    7       CALL SEARCH(BUFFER.COLUMN,

   7263 21 000564   000005 236000 15                 LDQ     BUFFER+5
        21 000565   000000 136000 15                 SBLQ    BUFFER
        21 000566   000024 756000 0                  STQ     @TABLE+10
        21 000567   000000 236000 15                 LDQ     BUFFER
        21 000570   000006 470400 15                 LDP0    BUFFER+6
        21 000571   000024 720000 0                  LXL0    @TABLE+10
        21 000572   000000 164546                    TCT
        21 000573   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 000574   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 000575   000000 000000 15                 ARG     BUFFER
        21 000576   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:128  
        21 000577   000033 771000                    ARL     27
        21 000600   000001 755000 15                 STA     BUFFER+1
        21 000601   000000 551040 15                 STBA    BUFFER,'40'O
        21 000602   000000 056000 15                 ASQ     BUFFER

              7264    7                   BUFFER.CLASS,
              7265    7                   TABLE,
              7266    7                   BUFFER_LINE,
              7267    7                   BUFFER.COLUMN);
              7268    7     END;

              7270    6           END;

              7272    5         END;

              7273    4     END;

      324     7275    3         IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR

   7275 21 000603   000001 235000 15                 LDA     BUFFER+1
        21 000604   000042 115007                    CMPA    34,DL
        21 000605   000624 600000 21                 TZE     s:7283
        21 000606   000000 115003                    CMPA    0,DU
        21 000607   000624 600000 21                 TZE     s:7283
        21 000610   000021 115007                    CMPA    17,DL
        21 000611   000627 601000 21                 TNZ     s:7287
        21 000612   000000 236000 15                 LDQ     BUFFER
        21 000613   000001 036007                    ADLQ    1,DL
        21 000614   000005 116000 15                 CMPQ    BUFFER+5
        21 000615   000627 605000 21                 TPL     s:7287
        21 000616   000006 470400 15                 LDP0    BUFFER+6
        21 000617   000000 235000 15                 LDA     BUFFER
        21 000620   040000 106505                    CMPC    fill='040'O
        21 000621   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 000622   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 000623   000627 601000 21                 TNZ     s:7287

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:129  
      325     7276                    %NEXT_TWO_CHARS_ARE_PSEUDO;
              7277    3     (BUFFER.CLASS = %EQUAL
              7278    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7279    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      326     7281    3                                           THEN
      327     7282    4           DO;

      328     7283    4             SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;

   7283 21 000624   000001 235007                    LDA     1,DL
        21 000625   000000 755000 10                 STA     SCANNER_STATE

      329     7284    4           END;

   7284 21 000626   000753 710000 21                 TRA     s:7368

      330     7285    3         ELSE
      331     7286    4           DO;

      332     7287    4             GOTO SCAN_SEPARATOR;

   7287 21 000627   000755 710000 21                 TRA     SCAN_SEPARATOR

      333     7288    4           END;
      334     7289
      335     7290    3       CASE(%EQUAL);

      336     7291
      337     7292              %SAVE_RESTART_INFO;
              7293    4     DO;

              7294    4       RESTART_INFO.LINE   = BUFFER.ISN;

   7294 21 000630   000002 236000 15                 LDQ     BUFFER+2
        21 000631   000002 756000 0                  STQ     RESTART_INFO

              7295    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:130  

   7295 21 000632   000000 235000 15                 LDA     BUFFER
        21 000633   000003 755000 0                  STA     RESTART_INFO+1

              7296    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;

   7296 21 000634   000003 235000 15                 LDA     BUFFER+3
        21 000635   000004 755000 0                  STA     RESTART_INFO+2

              7297    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   7297 21 000636   000004 236000 15                 LDQ     BUFFER+4
        21 000637   000001 736000                    QLS     1
        21 000640   400000 376003                    ANQ     -131072,DU
        21 000641   000005 756000 0                  STQ     RESTART_INFO+3

              7298    4     END;

      338     7300              %CONCAT_SYMBOL;
              7301    4        DO;

              7302    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7302 21 000642   000000 236000 15                 LDQ     BUFFER
        21 000643   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000644   000007 756000 0                  STQ     SEARCH_SIZE

              7303    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7303 21 000645   000504 236007                    LDQ     324,DL
        21 000646   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000647   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000650   000652 605000 21                 TPL     s:7305

              7304    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7304 21 000651   000007 756000 0                  STQ     SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:131  

              7305    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7305 21 000652   000006 470400 15                 LDP0    BUFFER+6
        21 000653   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000654   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000655   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000656   040046 100545                    MLR     fill='040'O
        21 000657   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000660   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7306    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7307    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7307 21 000661   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000662   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000663   000010 756000 6                  STQ     LEX_SYMBOL+8

              7308    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7308 21 000664   000000 235000 15                 LDA     BUFFER
        21 000665   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7309    4        END;

      339     7311              %MARK_END_OF_SYMBOL;
              7312    4     DO;

              7313    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7313 21 000666   000007 755000 6                  STA     LEX_SYMBOL+7

              7314    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7314 21 000667   000002 235000 15                 LDA     BUFFER+2
        21 000670   000006 755000 6                  STA     LEX_SYMBOL+6

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:132  
              7315    4     END;

      340     7317              %ADV_BUFFER_COLUMN_THIS_LINE;
              7318    4     DO;

              7319    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7319 21 000671   000000 054000 15                 AOS     BUFFER

              7320            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7321    5     DO;

              7322    5       CALL SEARCH(BUFFER.COLUMN,

   7322 21 000672   000005 236000 15                 LDQ     BUFFER+5
        21 000673   000000 136000 15                 SBLQ    BUFFER
        21 000674   000024 756000 0                  STQ     @TABLE+10
        21 000675   000000 236000 15                 LDQ     BUFFER
        21 000676   000024 721000 0                  LXL1    @TABLE+10
        21 000677   000000 164546                    TCT
        21 000700   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 000701   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 000702   000000 000000 15                 ARG     BUFFER
        21 000703   000000 235000 15                 LDA     BUFFER
        21 000704   000033 771000                    ARL     27
        21 000705   000001 755000 15                 STA     BUFFER+1
        21 000706   000000 551040 15                 STBA    BUFFER,'40'O
        21 000707   000000 056000 15                 ASQ     BUFFER

              7323    5                   BUFFER.CLASS,
              7324    5                   TABLE,
              7325    5                   BUFFER_LINE,
              7326    5                   BUFFER.COLUMN);
              7327    5     END;

              7329    4     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:133  
      341     7331    3         IF BUFFER.CLASS = %EQUAL THEN

   7331 21 000710   000021 115007                    CMPA    17,DL
        21 000711   000715 601000 21                 TNZ     s:7337

      342     7332    4           DO;

      343     7333    4             SCANNER_STATE = %SCANNER_STATE_RESTART_EQUAL;

   7333 21 000712   000002 236007                    LDQ     2,DL
        21 000713   000000 756000 10                 STQ     SCANNER_STATE

      344     7334    4           END;

   7334 21 000714   000753 710000 21                 TRA     s:7368

      345     7335    3         ELSE
      346     7336    4           DO;

      347     7337    4             GOTO SCAN_SEPARATOR;

   7337 21 000715   000755 710000 21                 TRA     SCAN_SEPARATOR

      348     7338    4           END;
      349     7339
      350     7340    3       CASE(%DOUBLE_QUOTE, %SINGLE_QUOTE);

      351     7341
      352     7342              %CONCAT_SYMBOL;
              7343    4        DO;

              7344    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7344 21 000716   000000 236000 15                 LDQ     BUFFER
        21 000717   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 000720   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:134  
              7345    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7345 21 000721   000504 236007                    LDQ     324,DL
        21 000722   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 000723   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 000724   000726 605000 21                 TPL     s:7347

              7346    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7346 21 000725   000007 756000 0                  STQ     SEARCH_SIZE

              7347    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7347 21 000726   000006 470400 15                 LDP0    BUFFER+6
        21 000727   000007 720000 0                  LXL0    SEARCH_SIZE
        21 000730   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 000731   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000732   040046 100545                    MLR     fill='040'O
        21 000733   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 000734   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7348    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7349    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7349 21 000735   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 000736   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 000737   000010 756000 6                  STQ     LEX_SYMBOL+8

              7350    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7350 21 000740   000000 235000 15                 LDA     BUFFER
        21 000741   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7351    4        END;

      353     7353              %MARK_END_OF_SYMBOL;
              7354    4     DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:135  

              7355    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7355 21 000742   000007 755000 6                  STA     LEX_SYMBOL+7

              7356    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7356 21 000743   000002 235000 15                 LDA     BUFFER+2
        21 000744   000006 755000 6                  STA     LEX_SYMBOL+6

              7357    4     END;

      354     7359    3         IF NOT O1COM.PSEUDO_TEXT_FLAG THEN

   7359 21 000745   001330 234000 xsym               SZN     O1COM+728
        21 000746   000753 604000 21                 TMI     s:7368

      355     7360    3           LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   7360 21 000747   400000 236003                    LDQ     -131072,DU
        21 000750   000002 256000 6                  ORSQ    LEX_SYMBOL+2
        21 000751   000753 710000 21                 TRA     s:7368

      356     7361
      357     7362    3       CASE(ELSE);

      358     7363
      359     7364    3         GOTO SCAN_SEPARATOR;

   7364 21 000752   000755 710000 21                 TRA     SCAN_SEPARATOR

      360     7365
      361     7366    3     END;  /* DO CASE */

      362     7367
      363     7368    2     RETURN;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:136  
   7368 21 000753   000014 221200 0                  LDX1  ! @TABLE+2
        21 000754   000001 702211                    TSX2  ! 1,X1

      364     7369
      365     7370
      366     7371    2   SCAN_SEPARATOR:
      367     7372
      368     7373    2     LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7373 21 000755   000033 235007       SCAN_SEPARA* LDA     27,DL
        21 000756   000001 755000 6                  STA     LEX_SYMBOL+1

      369     7374          %SCAN_SEARCH(TABLE=SEPARATORS_TABLE);
              7375    3     DO;

              7376    3       CALL SEARCH(BUFFER.COLUMN,

   7376 21 000757   000005 236000 15                 LDQ     BUFFER+5
        21 000760   000000 136000 15                 SBLQ    BUFFER
        21 000761   000024 756000 0                  STQ     @TABLE+10
        21 000762   000000 236000 15                 LDQ     BUFFER
        21 000763   000006 470400 15                 LDP0    BUFFER+6
        21 000764   000024 720000 0                  LXL0    @TABLE+10
        21 000765   000000 164546                    TCT
        21 000766   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 000767   000000 000000 xsym               ARG     SEPARATORS_TABLE
        21 000770   000000 000000 15                 ARG     BUFFER
        21 000771   000000 235000 15                 LDA     BUFFER
        21 000772   000033 771000                    ARL     27
        21 000773   000001 755000 15                 STA     BUFFER+1
        21 000774   000000 551040 15                 STBA    BUFFER,'40'O
        21 000775   000000 056000 15                 ASQ     BUFFER
        21 000776   001000 606400 21                 TTN     s:7383
        21 000777   001011 710000 21                 TRA     s:7389

              7377    3                   BUFFER.CLASS,
              7378    3                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:137  
              7379    3                   BUFFER_LINE,
              7380    3                   BUFFER.COLUMN)
              7381    3            WHENALTRETURN
              7382    4              DO;

              7383    4                IF BUFFER.CLASS = %END_OF_LINE

   7383 21 001000   000001 235000 15                 LDA     BUFFER+1
        21 001001   001011 601000 21                 TNZ     s:7389
        21 001002   000004 236000 15                 LDQ     BUFFER+4
        21 001003   100000 316003                    CANQ    32768,DU
        21 001004   001011 600000 21                 TZE     s:7389

              7384    4                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7385    4                  CALL CONTINUATION (TABLE);

   7385 21 001005   000002 236000 22                 LDQ     2
        21 001006   000012 756000 0                  STQ     @TABLE
        21 001007   000002 701000 21                 TSX1    CONTINUATION
        21 001010   000000 011000                    NOP     0

              7386    4              END;

              7387    3     END;

      370     7389    2     GOTO CHECK_SEPARATOR;

   7389 21 001011   000173 710000 21                 TRA     CHECK_SEPARATOR

      371     7390
      372     7391    2   END CHECK_NORMAL_SEPARATOR;
      373     7392        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:138  
      374     7393    1   SCAN_EXPONENT : PROC;

   7393 21 001012   000015 741200 0     SCAN_EXPONE* STX1  ! @TABLE+3

      375     7394
      376     7395    2     IF BUFFER.CLASS = %LETTER_E THEN

   7395 21 001013   000001 235000 15                 LDA     BUFFER+1
        21 001014   000041 115007                    CMPA    33,DL
        21 001015   001261 601000 21                 TNZ     s:7503

      377     7396    3       DO;

      378     7397    3         SUBSTR(BUFFER_LINE,BUFFER.COLUMN,1) = 'E';  /* UPPER CASE */

   7397 21 001016   000006 470400 15                 LDP0    BUFFER+6
        21 001017   000000 236000 15                 LDQ     BUFFER
        21 001020   040106 100400                    MLR     fill='040'O
        21 001021   000003 000001 22                 ADSC9   3                        cn=0,n=1
        21 001022   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      379     7398              %ADV_BUFFER_COLUMN;
              7399    4     DO;

              7400    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7400 21 001023   000000 054000 15                 AOS     BUFFER

              7401    4       CALL SEARCH(BUFFER.COLUMN,

   7401 21 001024   000005 236000 15                 LDQ     BUFFER+5
        21 001025   000000 136000 15                 SBLQ    BUFFER
        21 001026   000024 756000 0                  STQ     @TABLE+10
        21 001027   000000 236000 15                 LDQ     BUFFER
        21 001030   000006 470400 15                 LDP0    BUFFER+6
        21 001031   000024 720000 0                  LXL0    @TABLE+10
        21 001032   000000 164546                    TCT
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:139  
        21 001033   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001034   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001035   000000 000000 15                 ARG     BUFFER
        21 001036   000000 235000 15                 LDA     BUFFER
        21 001037   000033 771000                    ARL     27
        21 001040   000001 755000 15                 STA     BUFFER+1
        21 001041   000000 551040 15                 STBA    BUFFER,'40'O
        21 001042   000000 056000 15                 ASQ     BUFFER
        21 001043   001045 606400 21                 TTN     s:7408
        21 001044   001121 710000 21                 TRA     s:7438

              7402    4                   BUFFER.CLASS,
              7403    4                   TABLE,
              7404    4                   BUFFER_LINE,
              7405    4                   BUFFER.COLUMN)
              7406    4        WHENALTRETURN
              7407    5         DO;

              7408    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7408 21 001045   000004 236000 15                 LDQ     BUFFER+4
        21 001046   100000 316003                    CANQ    32768,DU
        21 001047   001121 600000 21                 TZE     s:7438

              7409                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7410    6           DO;

              7411                  %CONCAT_SYMBOL;
              7412    7        DO;

              7413    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7413 21 001050   000000 236000 15                 LDQ     BUFFER
        21 001051   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001052   000007 756000 0                  STQ     SEARCH_SIZE

              7414    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:140  

   7414 21 001053   000504 236007                    LDQ     324,DL
        21 001054   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001055   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001056   001060 605000 21                 TPL     s:7416

              7415    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7415 21 001057   000007 756000 0                  STQ     SEARCH_SIZE

              7416    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7416 21 001060   000006 470400 15                 LDP0    BUFFER+6
        21 001061   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001062   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001063   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001064   040046 100545                    MLR     fill='040'O
        21 001065   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001066   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7417    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7418    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7418 21 001067   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001070   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001071   000010 756000 6                  STQ     LEX_SYMBOL+8

              7419    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7419 21 001072   000000 235000 15                 LDA     BUFFER
        21 001073   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7420    7        END;

              7422    6             CALL GET_NEXT_SCANNER_LINE;

   7422 21 001074   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:141  
        21 001075   000000 631400 22                 EPPR1   0
        21 001076   000000 701011                    TSX1    0,X1
        21 001077   000000 011000                    NOP     0

              7423    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7423 21 001100   000000 235000 15                 LDA     BUFFER
        21 001101   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7424                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7425    7     DO;

              7426    7       CALL SEARCH(BUFFER.COLUMN,

   7426 21 001102   000005 236000 15                 LDQ     BUFFER+5
        21 001103   000000 136000 15                 SBLQ    BUFFER
        21 001104   000024 756000 0                  STQ     @TABLE+10
        21 001105   000000 236000 15                 LDQ     BUFFER
        21 001106   000006 470400 15                 LDP0    BUFFER+6
        21 001107   000024 720000 0                  LXL0    @TABLE+10
        21 001110   000000 164546                    TCT
        21 001111   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001112   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001113   000000 000000 15                 ARG     BUFFER
        21 001114   000000 235000 15                 LDA     BUFFER
        21 001115   000033 771000                    ARL     27
        21 001116   000001 755000 15                 STA     BUFFER+1
        21 001117   000000 551040 15                 STBA    BUFFER,'40'O
        21 001120   000000 056000 15                 ASQ     BUFFER

              7427    7                   BUFFER.CLASS,
              7428    7                   TABLE,
              7429    7                   BUFFER_LINE,
              7430    7                   BUFFER.COLUMN);
              7431    7     END;

              7433    6           END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:142  

              7435    5         END;

              7436    4     END;

      380     7438    3         IF BUFFER.CLASS = %PLUS

   7438 21 001121   000001 235000 15                 LDA     BUFFER+1
        21 001122   000012 115007                    CMPA    10,DL
        21 001123   001126 600000 21                 TZE     s:7443
        21 001124   000013 115007                    CMPA    11,DL
        21 001125   001257 601000 21                 TNZ     s:7499

      381     7439    3              OR BUFFER.CLASS = %MINUS THEN
      382     7440    4           DO;

      383     7441                  %ADV_BUFFER_COLUMN;
              7442    5     DO;

              7443    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7443 21 001126   000000 054000 15                 AOS     BUFFER

              7444    5       CALL SEARCH(BUFFER.COLUMN,

   7444 21 001127   000005 236000 15                 LDQ     BUFFER+5
        21 001130   000000 136000 15                 SBLQ    BUFFER
        21 001131   000024 756000 0                  STQ     @TABLE+10
        21 001132   000000 236000 15                 LDQ     BUFFER
        21 001133   000006 470400 15                 LDP0    BUFFER+6
        21 001134   000024 720000 0                  LXL0    @TABLE+10
        21 001135   000000 164546                    TCT
        21 001136   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001137   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001140   000000 000000 15                 ARG     BUFFER
        21 001141   000000 235000 15                 LDA     BUFFER
        21 001142   000033 771000                    ARL     27
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:143  
        21 001143   000001 755000 15                 STA     BUFFER+1
        21 001144   000000 551040 15                 STBA    BUFFER,'40'O
        21 001145   000000 056000 15                 ASQ     BUFFER
        21 001146   001150 606400 21                 TTN     s:7451
        21 001147   001224 710000 21                 TRA     s:7483

              7445    5                   BUFFER.CLASS,
              7446    5                   TABLE,
              7447    5                   BUFFER_LINE,
              7448    5                   BUFFER.COLUMN)
              7449    5        WHENALTRETURN
              7450    6         DO;

              7451    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7451 21 001150   000004 236000 15                 LDQ     BUFFER+4
        21 001151   100000 316003                    CANQ    32768,DU
        21 001152   001224 600000 21                 TZE     s:7483

              7452                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7453    7           DO;

              7454                  %CONCAT_SYMBOL;
              7455    8        DO;

              7456    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7456 21 001153   000000 236000 15                 LDQ     BUFFER
        21 001154   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001155   000007 756000 0                  STQ     SEARCH_SIZE

              7457    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7457 21 001156   000504 236007                    LDQ     324,DL
        21 001157   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001160   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001161   001163 605000 21                 TPL     s:7459
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:144  

              7458    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7458 21 001162   000007 756000 0                  STQ     SEARCH_SIZE

              7459    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7459 21 001163   000006 470400 15                 LDP0    BUFFER+6
        21 001164   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001165   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001166   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001167   040046 100545                    MLR     fill='040'O
        21 001170   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001171   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7460    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7461    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7461 21 001172   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001173   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001174   000010 756000 6                  STQ     LEX_SYMBOL+8

              7462    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7462 21 001175   000000 235000 15                 LDA     BUFFER
        21 001176   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7463    8        END;

              7465    7             CALL GET_NEXT_SCANNER_LINE;

   7465 21 001177   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 001200   000000 631400 22                 EPPR1   0
        21 001201   000000 701011                    TSX1    0,X1
        21 001202   000000 011000                    NOP     0

              7466    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:145  

   7466 21 001203   000000 235000 15                 LDA     BUFFER
        21 001204   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7467                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7468    8     DO;

              7469    8       CALL SEARCH(BUFFER.COLUMN,

   7469 21 001205   000005 236000 15                 LDQ     BUFFER+5
        21 001206   000000 136000 15                 SBLQ    BUFFER
        21 001207   000024 756000 0                  STQ     @TABLE+10
        21 001210   000000 236000 15                 LDQ     BUFFER
        21 001211   000006 470400 15                 LDP0    BUFFER+6
        21 001212   000024 720000 0                  LXL0    @TABLE+10
        21 001213   000000 164546                    TCT
        21 001214   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001215   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001216   000000 000000 15                 ARG     BUFFER
        21 001217   000000 235000 15                 LDA     BUFFER
        21 001220   000033 771000                    ARL     27
        21 001221   000001 755000 15                 STA     BUFFER+1
        21 001222   000000 551040 15                 STBA    BUFFER,'40'O
        21 001223   000000 056000 15                 ASQ     BUFFER

              7470    8                   BUFFER.CLASS,
              7471    8                   TABLE,
              7472    8                   BUFFER_LINE,
              7473    8                   BUFFER.COLUMN);
              7474    8     END;

              7476    7           END;

              7478    6         END;

              7479    5     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:146  
      384     7481                  %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7482    5     DO;

              7483    5       CALL SEARCH(BUFFER.COLUMN,

   7483 21 001224   000005 236000 15                 LDQ     BUFFER+5
        21 001225   000000 136000 15                 SBLQ    BUFFER
        21 001226   000024 756000 0                  STQ     @TABLE+10
        21 001227   000000 236000 15                 LDQ     BUFFER
        21 001230   000006 470400 15                 LDP0    BUFFER+6
        21 001231   000024 720000 0                  LXL0    @TABLE+10
        21 001232   000000 164546                    TCT
        21 001233   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001234   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 001235   000000 000000 15                 ARG     BUFFER
        21 001236   000000 235000 15                 LDA     BUFFER
        21 001237   000033 771000                    ARL     27
        21 001240   000001 755000 15                 STA     BUFFER+1
        21 001241   000000 551040 15                 STBA    BUFFER,'40'O
        21 001242   000000 056000 15                 ASQ     BUFFER
        21 001243   001245 606400 21                 TTN     s:7490
        21 001244   001256 710000 21                 TRA     s:7496

              7484    5                   BUFFER.CLASS,
              7485    5                   TABLE,
              7486    5                   BUFFER_LINE,
              7487    5                   BUFFER.COLUMN)
              7488    5            WHENALTRETURN
              7489    6              DO;

              7490    6                IF BUFFER.CLASS = %END_OF_LINE

   7490 21 001245   000001 235000 15                 LDA     BUFFER+1
        21 001246   001256 601000 21                 TNZ     s:7496
        21 001247   000004 236000 15                 LDQ     BUFFER+4
        21 001250   100000 316003                    CANQ    32768,DU
        21 001251   001256 600000 21                 TZE     s:7496
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:147  

              7491    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7492    6                  CALL CONTINUATION (TABLE);

   7492 21 001252   000004 236000 22                 LDQ     4
        21 001253   000012 756000 0                  STQ     @TABLE
        21 001254   000002 701000 21                 TSX1    CONTINUATION
        21 001255   000000 011000                    NOP     0

              7493    6              END;

              7494    5     END;

      385     7496    4           END;

   7496 21 001256   001261 710000 21                 TRA     s:7503

      386     7497    3         ELSE
      387     7498    4           DO;

      388     7499    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7499 21 001257   000033 236007                    LDQ     27,DL
        21 001260   000001 756000 6                  STQ     LEX_SYMBOL+1

      389     7500    4           END;

      390     7501    3       END;

      391     7502
      392     7503    2     CALL CHECK_NORMAL_SEPARATOR;

   7503 21 001261   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 001262   000000 011000                    NOP     0

      393     7504
      394     7505    2   END SCAN_EXPONENT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:148  

   7505 21 001263   000015 221200 0                  LDX1  ! @TABLE+3
        21 001264   000001 702211                    TSX2  ! 1,X1

      395     7506        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:149  
      396     7507    1   SCAN_NUMERIC_LITERAL : PROC;

   7507 21 001265   000016 741200 0     SCAN_NUMERI* STX1  ! @TABLE+4

      397     7508
      398     7509          %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7510    3     DO;

              7511    3       CALL SEARCH(BUFFER.COLUMN,

   7511 21 001266   000005 236000 15                 LDQ     BUFFER+5
        21 001267   000000 136000 15                 SBLQ    BUFFER
        21 001270   000024 756000 0                  STQ     @TABLE+10
        21 001271   000000 236000 15                 LDQ     BUFFER
        21 001272   000006 470400 15                 LDP0    BUFFER+6
        21 001273   000024 720000 0                  LXL0    @TABLE+10
        21 001274   000000 164546                    TCT
        21 001275   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001276   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 001277   000000 000000 15                 ARG     BUFFER
        21 001300   000000 235000 15                 LDA     BUFFER
        21 001301   000033 771000                    ARL     27
        21 001302   000001 755000 15                 STA     BUFFER+1
        21 001303   000000 551040 15                 STBA    BUFFER,'40'O
        21 001304   000000 056000 15                 ASQ     BUFFER
        21 001305   001307 606400 21                 TTN     s:7518
        21 001306   001320 710000 21                 TRA     s:7525

              7512    3                   BUFFER.CLASS,
              7513    3                   TABLE,
              7514    3                   BUFFER_LINE,
              7515    3                   BUFFER.COLUMN)
              7516    3            WHENALTRETURN
              7517    4              DO;

              7518    4                IF BUFFER.CLASS = %END_OF_LINE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:150  
   7518 21 001307   000001 235000 15                 LDA     BUFFER+1
        21 001310   001320 601000 21                 TNZ     s:7525
        21 001311   000004 236000 15                 LDQ     BUFFER+4
        21 001312   100000 316003                    CANQ    32768,DU
        21 001313   001320 600000 21                 TZE     s:7525

              7519    4                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7520    4                  CALL CONTINUATION (TABLE);

   7520 21 001314   000004 236000 22                 LDQ     4
        21 001315   000012 756000 0                  STQ     @TABLE
        21 001316   000002 701000 21                 TSX1    CONTINUATION
        21 001317   000000 011000                    NOP     0

              7521    4              END;

              7522    3     END;

      399     7524
      400     7525    3     DO CASE(BUFFER.CLASS);

   7525 21 001320   000001 235000 15                 LDA     BUFFER+1
        21 001321   000005 135007                    SBLA    5,DL
        21 001322   000035 115007                    CMPA    29,DL
        21 001323   001325 602005 21                 TNC     s:7525+5,AL
        21 001324   002113 710000 21                 TRA     s:7764
        21 001325   002046 710000 21                 TRA     s:7741
        21 001326   002113 710000 21                 TRA     s:7764
        21 001327   002113 710000 21                 TRA     s:7764
        21 001330   002113 710000 21                 TRA     s:7764
        21 001331   002113 710000 21                 TRA     s:7764
        21 001332   002113 710000 21                 TRA     s:7764
        21 001333   002046 710000 21                 TRA     s:7741
        21 001334   001362 710000 21                 TRA     s:7531
        21 001335   002113 710000 21                 TRA     s:7764
        21 001336   002113 710000 21                 TRA     s:7764
        21 001337   002113 710000 21                 TRA     s:7764
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:151  
        21 001340   002113 710000 21                 TRA     s:7764
        21 001341   002113 710000 21                 TRA     s:7764
        21 001342   002113 710000 21                 TRA     s:7764
        21 001343   002113 710000 21                 TRA     s:7764
        21 001344   002113 710000 21                 TRA     s:7764
        21 001345   002113 710000 21                 TRA     s:7764
        21 001346   002113 710000 21                 TRA     s:7764
        21 001347   002113 710000 21                 TRA     s:7764
        21 001350   002113 710000 21                 TRA     s:7764
        21 001351   002113 710000 21                 TRA     s:7764
        21 001352   002113 710000 21                 TRA     s:7764
        21 001353   002113 710000 21                 TRA     s:7764
        21 001354   002113 710000 21                 TRA     s:7764
        21 001355   001616 710000 21                 TRA     s:7638
        21 001356   002046 710000 21                 TRA     s:7741
        21 001357   002046 710000 21                 TRA     s:7741
        21 001360   002113 710000 21                 TRA     s:7764
        21 001361   002046 710000 21                 TRA     s:7741

      401     7526
      402     7527    3       CASE(%PERIOD);

      403     7528
      404     7529              %MARK_END_OF_SYMBOL;
              7530    4     DO;

              7531    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7531 21 001362   000000 236000 15                 LDQ     BUFFER
        21 001363   000007 756000 6                  STQ     LEX_SYMBOL+7

              7532    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7532 21 001364   000002 235000 15                 LDA     BUFFER+2
        21 001365   000006 755000 6                  STA     LEX_SYMBOL+6

              7533    4     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:152  

      405     7535              %SAVE_RESTART_INFO;
              7536    4     DO;

              7537    4       RESTART_INFO.LINE   = BUFFER.ISN;

   7537 21 001366   000002 755000 0                  STA     RESTART_INFO

              7538    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;

   7538 21 001367   000003 756000 0                  STQ     RESTART_INFO+1

              7539    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;

   7539 21 001370   000003 235000 15                 LDA     BUFFER+3
        21 001371   000004 755000 0                  STA     RESTART_INFO+2

              7540    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   7540 21 001372   000004 236000 15                 LDQ     BUFFER+4
        21 001373   000001 736000                    QLS     1
        21 001374   400000 376003                    ANQ     -131072,DU
        21 001375   000005 756000 0                  STQ     RESTART_INFO+3

              7541    4     END;

      406     7543              %ADV_BUFFER_COLUMN;
              7544    4     DO;

              7545    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7545 21 001376   000000 054000 15                 AOS     BUFFER

              7546    4       CALL SEARCH(BUFFER.COLUMN,

   7546 21 001377   000005 236000 15                 LDQ     BUFFER+5
        21 001400   000000 136000 15                 SBLQ    BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:153  
        21 001401   000024 756000 0                  STQ     @TABLE+10
        21 001402   000000 236000 15                 LDQ     BUFFER
        21 001403   000006 470400 15                 LDP0    BUFFER+6
        21 001404   000024 720000 0                  LXL0    @TABLE+10
        21 001405   000000 164546                    TCT
        21 001406   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001407   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001410   000000 000000 15                 ARG     BUFFER
        21 001411   000000 235000 15                 LDA     BUFFER
        21 001412   000033 771000                    ARL     27
        21 001413   000001 755000 15                 STA     BUFFER+1
        21 001414   000000 551040 15                 STBA    BUFFER,'40'O
        21 001415   000000 056000 15                 ASQ     BUFFER
        21 001416   001420 606400 21                 TTN     s:7553
        21 001417   001474 710000 21                 TRA     s:7585

              7547    4                   BUFFER.CLASS,
              7548    4                   TABLE,
              7549    4                   BUFFER_LINE,
              7550    4                   BUFFER.COLUMN)
              7551    4        WHENALTRETURN
              7552    5         DO;

              7553    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7553 21 001420   000004 236000 15                 LDQ     BUFFER+4
        21 001421   100000 316003                    CANQ    32768,DU
        21 001422   001474 600000 21                 TZE     s:7585

              7554                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7555    6           DO;

              7556                  %CONCAT_SYMBOL;
              7557    7        DO;

              7558    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:154  
   7558 21 001423   000000 236000 15                 LDQ     BUFFER
        21 001424   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001425   000007 756000 0                  STQ     SEARCH_SIZE

              7559    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7559 21 001426   000504 236007                    LDQ     324,DL
        21 001427   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001430   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001431   001433 605000 21                 TPL     s:7561

              7560    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7560 21 001432   000007 756000 0                  STQ     SEARCH_SIZE

              7561    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7561 21 001433   000006 470400 15                 LDP0    BUFFER+6
        21 001434   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001435   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001436   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001437   040046 100545                    MLR     fill='040'O
        21 001440   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001441   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7562    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7563    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7563 21 001442   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001443   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001444   000010 756000 6                  STQ     LEX_SYMBOL+8

              7564    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7564 21 001445   000000 235000 15                 LDA     BUFFER
        21 001446   000010 755000 0                  STA     SYMBOL_START_LOCATION

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:155  
              7565    7        END;

              7567    6             CALL GET_NEXT_SCANNER_LINE;

   7567 21 001447   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 001450   000000 631400 22                 EPPR1   0
        21 001451   000000 701011                    TSX1    0,X1
        21 001452   000000 011000                    NOP     0

              7568    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7568 21 001453   000000 235000 15                 LDA     BUFFER
        21 001454   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7569                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7570    7     DO;

              7571    7       CALL SEARCH(BUFFER.COLUMN,

   7571 21 001455   000005 236000 15                 LDQ     BUFFER+5
        21 001456   000000 136000 15                 SBLQ    BUFFER
        21 001457   000024 756000 0                  STQ     @TABLE+10
        21 001460   000000 236000 15                 LDQ     BUFFER
        21 001461   000006 470400 15                 LDP0    BUFFER+6
        21 001462   000024 720000 0                  LXL0    @TABLE+10
        21 001463   000000 164546                    TCT
        21 001464   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001465   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001466   000000 000000 15                 ARG     BUFFER
        21 001467   000000 235000 15                 LDA     BUFFER
        21 001470   000033 771000                    ARL     27
        21 001471   000001 755000 15                 STA     BUFFER+1
        21 001472   000000 551040 15                 STBA    BUFFER,'40'O
        21 001473   000000 056000 15                 ASQ     BUFFER

              7572    7                   BUFFER.CLASS,
              7573    7                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:156  
              7574    7                   BUFFER_LINE,
              7575    7                   BUFFER.COLUMN);
              7576    7     END;

              7578    6           END;

              7580    5         END;

              7581    4     END;

      407     7583              %CONCAT_SYMBOL;
              7584    4        DO;

              7585    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7585 21 001474   000000 236000 15                 LDQ     BUFFER
        21 001475   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001476   000007 756000 0                  STQ     SEARCH_SIZE

              7586    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7586 21 001477   000504 236007                    LDQ     324,DL
        21 001500   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001501   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001502   001504 605000 21                 TPL     s:7588

              7587    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7587 21 001503   000007 756000 0                  STQ     SEARCH_SIZE

              7588    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7588 21 001504   000006 470400 15                 LDP0    BUFFER+6
        21 001505   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001506   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001507   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001510   040046 100545                    MLR     fill='040'O
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:157  
        21 001511   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001512   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7589    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7590    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7590 21 001513   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001514   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001515   000010 756000 6                  STQ     LEX_SYMBOL+8

              7591    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7591 21 001516   000000 235000 15                 LDA     BUFFER
        21 001517   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7592    4        END;

      408     7594    3         IF BUFFER.CLASS = %DIGIT

   7594 21 001520   000001 235000 15                 LDA     BUFFER+1
        21 001521   000002 115007                    CMPA    2,DL
        21 001522   001525 600000 21                 TZE     s:7597
        21 001523   000041 115007                    CMPA    33,DL
        21 001524   001565 601000 21                 TNZ     s:7617

      409     7595    3              OR BUFFER.CLASS = %LETTER_E THEN
      410     7596    4           DO;

      411     7597    4             IF BUFFER.CLASS = %DIGIT THEN

   7597 21 001525   000002 115007                    CMPA    2,DL
        21 001526   001560 601000 21                 TNZ     s:7613

      412     7598                    %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7599    5     DO;

              7600    5       CALL SEARCH(BUFFER.COLUMN,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:158  

   7600 21 001527   000005 236000 15                 LDQ     BUFFER+5
        21 001530   000000 136000 15                 SBLQ    BUFFER
        21 001531   000024 756000 0                  STQ     @TABLE+10
        21 001532   000000 236000 15                 LDQ     BUFFER
        21 001533   000024 721000 0                  LXL1    @TABLE+10
        21 001534   000000 164546                    TCT
        21 001535   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 001536   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 001537   000000 000000 15                 ARG     BUFFER
        21 001540   000000 235000 15                 LDA     BUFFER
        21 001541   000033 771000                    ARL     27
        21 001542   000001 755000 15                 STA     BUFFER+1
        21 001543   000000 551040 15                 STBA    BUFFER,'40'O
        21 001544   000000 056000 15                 ASQ     BUFFER
        21 001545   001547 606400 21                 TTN     s:7607
        21 001546   001560 710000 21                 TRA     s:7613

              7601    5                   BUFFER.CLASS,
              7602    5                   TABLE,
              7603    5                   BUFFER_LINE,
              7604    5                   BUFFER.COLUMN)
              7605    5            WHENALTRETURN
              7606    6              DO;

              7607    6                IF BUFFER.CLASS = %END_OF_LINE

   7607 21 001547   000001 235000 15                 LDA     BUFFER+1
        21 001550   001560 601000 21                 TNZ     s:7613
        21 001551   000004 236000 15                 LDQ     BUFFER+4
        21 001552   100000 316003                    CANQ    32768,DU
        21 001553   001560 600000 21                 TZE     s:7613

              7608    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7609    6                  CALL CONTINUATION (TABLE);

   7609 21 001554   000004 236000 22                 LDQ     4
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:159  
        21 001555   000012 756000 0                  STQ     @TABLE
        21 001556   000002 701000 21                 TSX1    CONTINUATION
        21 001557   000000 011000                    NOP     0

              7610    6              END;

              7611    5     END;

      413     7613    4             LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   7613 21 001560   000026 235007                    LDA     22,DL
        21 001561   000001 755000 6                  STA     LEX_SYMBOL+1

      414     7614    4             CALL SCAN_EXPONENT;

   7614 21 001562   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 001563   000000 011000                    NOP     0

      415     7615    4           END;

   7615 21 001564   002115 710000 21                 TRA     s:7768

      416     7616    3         ELSE
      417     7617    3           IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR

   7617 21 001565   000042 115007                    CMPA    34,DL
        21 001566   001604 600000 21                 TZE     s:7625
        21 001567   000000 115003                    CMPA    0,DU
        21 001570   001604 600000 21                 TZE     s:7625
        21 001571   000021 115007                    CMPA    17,DL
        21 001572   001611 601000 21                 TNZ     s:7630
        21 001573   000000 236000 15                 LDQ     BUFFER
        21 001574   000001 036007                    ADLQ    1,DL
        21 001575   000005 116000 15                 CMPQ    BUFFER+5
        21 001576   001611 605000 21                 TPL     s:7630
        21 001577   000000 235000 15                 LDA     BUFFER
        21 001600   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:160  
        21 001601   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 001602   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 001603   001611 601000 21                 TNZ     s:7630

      418     7618                      %NEXT_TWO_CHARS_ARE_PSEUDO;
              7619    3     (BUFFER.CLASS = %EQUAL
              7620    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7621    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      419     7623    3                                                  THEN
      420     7624    4             DO;

      421     7625    4               SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;

   7625 21 001604   000001 235007                    LDA     1,DL
        21 001605   000000 755000 10                 STA     SCANNER_STATE

      422     7626    4               LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;

   7626 21 001606   000001 336007                    LCQ     1,DL
        21 001607   000010 056000 6                  ASQ     LEX_SYMBOL+8

      423     7627    4             END;

   7627 21 001610   002115 710000 21                 TRA     s:7768

      424     7628    3           ELSE
      425     7629    4             DO;

      426     7630    4               LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7630 21 001611   000033 235007                    LDA     27,DL
        21 001612   000001 755000 6                  STA     LEX_SYMBOL+1

      427     7631    4               CALL CHECK_NORMAL_SEPARATOR;

   7631 21 001613   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 001614   000000 011000                    NOP     0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:161  

      428     7632    4             END;

   7632 21 001615   002115 710000 21                 TRA     s:7768

      429     7633
      430     7634    3       CASE(%COMMA);

      431     7635
      432     7636              %MARK_END_OF_SYMBOL;
              7637    4     DO;

              7638    4       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7638 21 001616   000000 236000 15                 LDQ     BUFFER
        21 001617   000007 756000 6                  STQ     LEX_SYMBOL+7

              7639    4       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7639 21 001620   000002 235000 15                 LDA     BUFFER+2
        21 001621   000006 755000 6                  STA     LEX_SYMBOL+6

              7640    4     END;

      433     7642              %SAVE_RESTART_INFO;
              7643    4     DO;

              7644    4       RESTART_INFO.LINE   = BUFFER.ISN;

   7644 21 001622   000002 755000 0                  STA     RESTART_INFO

              7645    4       RESTART_INFO.COLUMN = BUFFER.COLUMN;

   7645 21 001623   000003 756000 0                  STQ     RESTART_INFO+1

              7646    4       RESTART_INFO.LEVEL = BUFFER.LEVEL;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:162  
   7646 21 001624   000003 235000 15                 LDA     BUFFER+3
        21 001625   000004 755000 0                  STA     RESTART_INFO+2

              7647    4       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   7647 21 001626   000004 236000 15                 LDQ     BUFFER+4
        21 001627   000001 736000                    QLS     1
        21 001630   400000 376003                    ANQ     -131072,DU
        21 001631   000005 756000 0                  STQ     RESTART_INFO+3

              7648    4     END;

      434     7650              %ADV_BUFFER_COLUMN;
              7651    4     DO;

              7652    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7652 21 001632   000000 054000 15                 AOS     BUFFER

              7653    4       CALL SEARCH(BUFFER.COLUMN,

   7653 21 001633   000005 236000 15                 LDQ     BUFFER+5
        21 001634   000000 136000 15                 SBLQ    BUFFER
        21 001635   000024 756000 0                  STQ     @TABLE+10
        21 001636   000000 236000 15                 LDQ     BUFFER
        21 001637   000006 470400 15                 LDP0    BUFFER+6
        21 001640   000024 720000 0                  LXL0    @TABLE+10
        21 001641   000000 164546                    TCT
        21 001642   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001643   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001644   000000 000000 15                 ARG     BUFFER
        21 001645   000000 235000 15                 LDA     BUFFER
        21 001646   000033 771000                    ARL     27
        21 001647   000001 755000 15                 STA     BUFFER+1
        21 001650   000000 551040 15                 STBA    BUFFER,'40'O
        21 001651   000000 056000 15                 ASQ     BUFFER
        21 001652   001654 606400 21                 TTN     s:7660
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:163  
        21 001653   001730 710000 21                 TRA     s:7692

              7654    4                   BUFFER.CLASS,
              7655    4                   TABLE,
              7656    4                   BUFFER_LINE,
              7657    4                   BUFFER.COLUMN)
              7658    4        WHENALTRETURN
              7659    5         DO;

              7660    5           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7660 21 001654   000004 236000 15                 LDQ     BUFFER+4
        21 001655   100000 316003                    CANQ    32768,DU
        21 001656   001730 600000 21                 TZE     s:7692

              7661                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              7662    6           DO;

              7663                  %CONCAT_SYMBOL;
              7664    7        DO;

              7665    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7665 21 001657   000000 236000 15                 LDQ     BUFFER
        21 001660   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001661   000007 756000 0                  STQ     SEARCH_SIZE

              7666    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7666 21 001662   000504 236007                    LDQ     324,DL
        21 001663   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001664   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001665   001667 605000 21                 TPL     s:7668

              7667    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7667 21 001666   000007 756000 0                  STQ     SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:164  

              7668    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7668 21 001667   000006 470400 15                 LDP0    BUFFER+6
        21 001670   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001671   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001672   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001673   040046 100545                    MLR     fill='040'O
        21 001674   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001675   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7669    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7670    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7670 21 001676   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001677   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001700   000010 756000 6                  STQ     LEX_SYMBOL+8

              7671    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7671 21 001701   000000 235000 15                 LDA     BUFFER
        21 001702   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7672    7        END;

              7674    6             CALL GET_NEXT_SCANNER_LINE;

   7674 21 001703   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 001704   000000 631400 22                 EPPR1   0
        21 001705   000000 701011                    TSX1    0,X1
        21 001706   000000 011000                    NOP     0

              7675    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7675 21 001707   000000 235000 15                 LDA     BUFFER
        21 001710   000010 755000 0                  STA     SYMBOL_START_LOCATION

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:165  
              7676                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7677    7     DO;

              7678    7       CALL SEARCH(BUFFER.COLUMN,

   7678 21 001711   000005 236000 15                 LDQ     BUFFER+5
        21 001712   000000 136000 15                 SBLQ    BUFFER
        21 001713   000024 756000 0                  STQ     @TABLE+10
        21 001714   000000 236000 15                 LDQ     BUFFER
        21 001715   000006 470400 15                 LDP0    BUFFER+6
        21 001716   000024 720000 0                  LXL0    @TABLE+10
        21 001717   000000 164546                    TCT
        21 001720   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 001721   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 001722   000000 000000 15                 ARG     BUFFER
        21 001723   000000 235000 15                 LDA     BUFFER
        21 001724   000033 771000                    ARL     27
        21 001725   000001 755000 15                 STA     BUFFER+1
        21 001726   000000 551040 15                 STBA    BUFFER,'40'O
        21 001727   000000 056000 15                 ASQ     BUFFER

              7679    7                   BUFFER.CLASS,
              7680    7                   TABLE,
              7681    7                   BUFFER_LINE,
              7682    7                   BUFFER.COLUMN);
              7683    7     END;

              7685    6           END;

              7687    5         END;

              7688    4     END;

      435     7690              %CONCAT_SYMBOL;
              7691    4        DO;

              7692    4          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:166  

   7692 21 001730   000000 236000 15                 LDQ     BUFFER
        21 001731   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 001732   000007 756000 0                  STQ     SEARCH_SIZE

              7693    4          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7693 21 001733   000504 236007                    LDQ     324,DL
        21 001734   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 001735   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 001736   001740 605000 21                 TPL     s:7695

              7694    4            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7694 21 001737   000007 756000 0                  STQ     SEARCH_SIZE

              7695    4          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7695 21 001740   000006 470400 15                 LDP0    BUFFER+6
        21 001741   000007 720000 0                  LXL0    SEARCH_SIZE
        21 001742   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 001743   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001744   040046 100545                    MLR     fill='040'O
        21 001745   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 001746   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7696    4              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7697    4          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7697 21 001747   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 001750   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 001751   000010 756000 6                  STQ     LEX_SYMBOL+8

              7698    4          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7698 21 001752   000000 235000 15                 LDA     BUFFER
        21 001753   000010 755000 0                  STA     SYMBOL_START_LOCATION
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:167  

              7699    4        END;

      436     7701    3         IF BUFFER.CLASS = %DIGIT

   7701 21 001754   000001 235000 15                 LDA     BUFFER+1
        21 001755   000002 115007                    CMPA    2,DL
        21 001756   001761 600000 21                 TZE     s:7706
        21 001757   000041 115007                    CMPA    33,DL
        21 001760   002017 601000 21                 TNZ     s:7723

      437     7702    3               OR BUFFER.CLASS = %LETTER_E THEN
      438     7703    4            DO;

      439     7704                   %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              7705    5     DO;

              7706    5       CALL SEARCH(BUFFER.COLUMN,

   7706 21 001761   000005 236000 15                 LDQ     BUFFER+5
        21 001762   000000 136000 15                 SBLQ    BUFFER
        21 001763   000024 756000 0                  STQ     @TABLE+10
        21 001764   000000 236000 15                 LDQ     BUFFER
        21 001765   000024 721000 0                  LXL1    @TABLE+10
        21 001766   000000 164546                    TCT
        21 001767   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 001770   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 001771   000000 000000 15                 ARG     BUFFER
        21 001772   000000 235000 15                 LDA     BUFFER
        21 001773   000033 771000                    ARL     27
        21 001774   000001 755000 15                 STA     BUFFER+1
        21 001775   000000 551040 15                 STBA    BUFFER,'40'O
        21 001776   000000 056000 15                 ASQ     BUFFER
        21 001777   002001 606400 21                 TTN     s:7713
        21 002000   002012 710000 21                 TRA     s:7719

              7707    5                   BUFFER.CLASS,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:168  
              7708    5                   TABLE,
              7709    5                   BUFFER_LINE,
              7710    5                   BUFFER.COLUMN)
              7711    5            WHENALTRETURN
              7712    6              DO;

              7713    6                IF BUFFER.CLASS = %END_OF_LINE

   7713 21 002001   000001 235000 15                 LDA     BUFFER+1
        21 002002   002012 601000 21                 TNZ     s:7719
        21 002003   000004 236000 15                 LDQ     BUFFER+4
        21 002004   100000 316003                    CANQ    32768,DU
        21 002005   002012 600000 21                 TZE     s:7719

              7714    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7715    6                  CALL CONTINUATION (TABLE);

   7715 21 002006   000004 236000 22                 LDQ     4
        21 002007   000012 756000 0                  STQ     @TABLE
        21 002010   000002 701000 21                 TSX1    CONTINUATION
        21 002011   000000 011000                    NOP     0

              7716    6              END;

              7717    5     END;

      440     7719    4              LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   7719 21 002012   000026 235007                    LDA     22,DL
        21 002013   000001 755000 6                  STA     LEX_SYMBOL+1

      441     7720    4              CALL SCAN_EXPONENT;

   7720 21 002014   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 002015   000000 011000                    NOP     0

      442     7721    4            END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:169  

   7721 21 002016   002115 710000 21                 TRA     s:7768

      443     7722    3          ELSE
      444     7723    3            IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR

   7723 21 002017   000042 115007                    CMPA    34,DL
        21 002020   002036 600000 21                 TZE     s:7731
        21 002021   000000 115003                    CMPA    0,DU
        21 002022   002036 600000 21                 TZE     s:7731
        21 002023   000021 115007                    CMPA    17,DL
        21 002024   002041 601000 21                 TNZ     s:7735
        21 002025   000000 236000 15                 LDQ     BUFFER
        21 002026   000001 036007                    ADLQ    1,DL
        21 002027   000005 116000 15                 CMPQ    BUFFER+5
        21 002030   002041 605000 21                 TPL     s:7735
        21 002031   000000 235000 15                 LDA     BUFFER
        21 002032   040000 106505                    CMPC    fill='040'O
        21 002033   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 002034   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 002035   002041 601000 21                 TNZ     s:7735

      445     7724                      %NEXT_TWO_CHARS_ARE_PSEUDO;
              7725    3     (BUFFER.CLASS = %EQUAL
              7726    3       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              7727    3       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      446     7729    3                                                  THEN
      447     7730    4              DO;

      448     7731    4                LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE - 1;

   7731 21 002036   000001 336007                    LCQ     1,DL
        21 002037   000010 056000 6                  ASQ     LEX_SYMBOL+8

      449     7732    4              END;

   7732 21 002040   002115 710000 21                 TRA     s:7768
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:170  

      450     7733    3            ELSE
      451     7734    4              DO;

      452     7735    4                LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7735 21 002041   000033 235007                    LDA     27,DL
        21 002042   000001 755000 6                  STA     LEX_SYMBOL+1

      453     7736    4                CALL CHECK_NORMAL_SEPARATOR;

   7736 21 002043   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 002044   000000 011000                    NOP     0

      454     7737    4              END;

   7737 21 002045   002115 710000 21                 TRA     s:7768

      455     7738
      456     7739    3       CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE, %MINUS);

      457     7740
      458     7741    3         IF LEX_SYMBOL.TYPE = %NUMBER THEN

   7741 21 002046   000001 236000 6                  LDQ     LEX_SYMBOL+1
        21 002047   000025 116007                    CMPQ    21,DL
        21 002050   002054 601000 21                 TNZ     s:7744

      459     7742    3           LEX_SYMBOL.TYPE = %USER_WORD;

   7742 21 002051   000005 235007                    LDA     5,DL
        21 002052   000001 755000 6                  STA     LEX_SYMBOL+1
        21 002053   002056 710000 21                 TRA     s:7747

      460     7743    3         ELSE
      461     7744    3           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:171  
   7744 21 002054   000033 235007                    LDA     27,DL
        21 002055   000001 755000 6                  STA     LEX_SYMBOL+1

      462     7745              %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
              7746    4     DO;

              7747    4       CALL SEARCH(BUFFER.COLUMN,

   7747 21 002056   000005 236000 15                 LDQ     BUFFER+5
        21 002057   000000 136000 15                 SBLQ    BUFFER
        21 002060   000024 756000 0                  STQ     @TABLE+10
        21 002061   000000 236000 15                 LDQ     BUFFER
        21 002062   000006 470400 15                 LDP0    BUFFER+6
        21 002063   000024 720000 0                  LXL0    @TABLE+10
        21 002064   000000 164546                    TCT
        21 002065   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002066   000000 000000 xsym               ARG     USERWORD_SCAN_TABLE
        21 002067   000000 000000 15                 ARG     BUFFER
        21 002070   000000 235000 15                 LDA     BUFFER
        21 002071   000033 771000                    ARL     27
        21 002072   000001 755000 15                 STA     BUFFER+1
        21 002073   000000 551040 15                 STBA    BUFFER,'40'O
        21 002074   000000 056000 15                 ASQ     BUFFER
        21 002075   002077 606400 21                 TTN     s:7754
        21 002076   002110 710000 21                 TRA     s:7760

              7748    4                   BUFFER.CLASS,
              7749    4                   TABLE,
              7750    4                   BUFFER_LINE,
              7751    4                   BUFFER.COLUMN)
              7752    4            WHENALTRETURN
              7753    5              DO;

              7754    5                IF BUFFER.CLASS = %END_OF_LINE

   7754 21 002077   000001 235000 15                 LDA     BUFFER+1
        21 002100   002110 601000 21                 TNZ     s:7760
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:172  
        21 002101   000004 236000 15                 LDQ     BUFFER+4
        21 002102   100000 316003                    CANQ    32768,DU
        21 002103   002110 600000 21                 TZE     s:7760

              7755    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              7756    5                  CALL CONTINUATION (TABLE);

   7756 21 002104   000005 236000 22                 LDQ     5
        21 002105   000012 756000 0                  STQ     @TABLE
        21 002106   000002 701000 21                 TSX1    CONTINUATION
        21 002107   000000 011000                    NOP     0

              7757    5              END;

              7758    4     END;

      463     7760    3         CALL CHECK_NORMAL_SEPARATOR;

   7760 21 002110   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 002111   000000 011000                    NOP     0
        21 002112   002115 710000 21                 TRA     s:7768

      464     7761
      465     7762    3       CASE(ELSE);

      466     7763
      467     7764    3         CALL CHECK_NORMAL_SEPARATOR;

   7764 21 002113   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 002114   000000 011000                    NOP     0

      468     7765
      469     7766    3     END;  /* do case */

      470     7767
      471     7768    2   END SCAN_NUMERIC_LITERAL;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:173  
   7768 21 002115   000016 221200 0                  LDX1  ! @TABLE+4
        21 002116   000001 702211                    TSX2  ! 1,X1

      472     7769        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:174  
      473     7770    1   SCAN_QUOTE_LITERAL : PROC;

   7770 21 002117   000017 741200 0     SCAN_QUOTE_* STX1  ! @TABLE+5
        21 002120   002345 710000 21                 TRA     s:7889

      474     7771
      475     7772    2     CONTINUE_DOUBLE_QUOTED_STRING : PROC;

   7772 21 002121   000020 741200 0     CONTINUE_DO* STX1  ! @TABLE+6

      476     7773
      477     7774            /* Line_continued should have been checked;
      478     7775                   We should be at end_of_line */
      479     7776
      480     7777            %ADV_BUFFER_COLUMN_NEXT_LINE;
              7778    4           DO;

              7779                  %CONCAT_SYMBOL;
              7780    5        DO;

              7781    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7781 21 002122   000000 236000 15                 LDQ     BUFFER
        21 002123   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002124   000007 756000 0                  STQ     SEARCH_SIZE

              7782    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7782 21 002125   000504 236007                    LDQ     324,DL
        21 002126   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002127   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002130   002132 605000 21                 TPL     s:7784

              7783    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7783 21 002131   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:175  
              7784    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7784 21 002132   000006 470400 15                 LDP0    BUFFER+6
        21 002133   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002134   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002135   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002136   040046 100545                    MLR     fill='040'O
        21 002137   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 002140   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7785    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7786    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7786 21 002141   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002142   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002143   000010 756000 6                  STQ     LEX_SYMBOL+8

              7787    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7787 21 002144   000000 235000 15                 LDA     BUFFER
        21 002145   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7788    5        END;

              7790    4             CALL GET_NEXT_SCANNER_LINE;

   7790 21 002146   000000 222000 19                 LDX2    GET_NEXT_SCANNER_LINE
        21 002147   000000 631400 22                 EPPR1   0
        21 002150   000000 701012                    TSX1    0,X2
        21 002151   000000 011000                    NOP     0

              7791    4             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7791 21 002152   000000 235000 15                 LDA     BUFFER
        21 002153   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7792                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:176  
              7793    5     DO;

              7794    5       CALL SEARCH(BUFFER.COLUMN,

   7794 21 002154   000005 236000 15                 LDQ     BUFFER+5
        21 002155   000000 136000 15                 SBLQ    BUFFER
        21 002156   000024 756000 0                  STQ     @TABLE+10
        21 002157   000000 236000 15                 LDQ     BUFFER
        21 002160   000006 470400 15                 LDP0    BUFFER+6
        21 002161   000024 720000 0                  LXL0    @TABLE+10
        21 002162   000000 164546                    TCT
        21 002163   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002164   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002165   000000 000000 15                 ARG     BUFFER
        21 002166   000000 235000 15                 LDA     BUFFER
        21 002167   000033 771000                    ARL     27
        21 002170   000001 755000 15                 STA     BUFFER+1
        21 002171   000000 551040 15                 STBA    BUFFER,'40'O
        21 002172   000000 056000 15                 ASQ     BUFFER

              7795    5                   BUFFER.CLASS,
              7796    5                   TABLE,
              7797    5                   BUFFER_LINE,
              7798    5                   BUFFER.COLUMN);
              7799    5     END;

              7801    4           END;

      481     7803    3       IF BUFFER.CLASS = %DOUBLE_QUOTE THEN

   7803 21 002173   000003 115007                    CMPA    3,DL
        21 002174   002243 601000 21                 TNZ     s:7835

      482     7804    4         DO;

      483     7805                %CONCAT_SYMBOL;
              7806    5        DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:177  

              7807    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7807 21 002175   000000 236000 15                 LDQ     BUFFER
        21 002176   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002177   000007 756000 0                  STQ     SEARCH_SIZE

              7808    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7808 21 002200   000504 236007                    LDQ     324,DL
        21 002201   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002202   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002203   002205 605000 21                 TPL     s:7810

              7809    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7809 21 002204   000007 756000 0                  STQ     SEARCH_SIZE

              7810    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7810 21 002205   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002206   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002207   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002210   040046 100545                    MLR     fill='040'O
        21 002211   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 002212   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7811    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7812    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7812 21 002213   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002214   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002215   000010 756000 6                  STQ     LEX_SYMBOL+8

              7813    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7813 21 002216   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:178  
        21 002217   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7814    5        END;

      484     7816    4           SYMBOL_START_LOCATION = BUFFER.COLUMN + 1;

   7816 21 002220   000001 035007                    ADLA    1,DL
        21 002221   000010 755000 0                  STA     SYMBOL_START_LOCATION

      485     7817    4           STOP_SCAN_FLAG = FALSE;

   7817 21 002222   000001 450000 0                  STZ     STOP_SCAN_FLAG

      486     7818                %ADV_BUFFER_COLUMN_THIS_LINE;
              7819    5     DO;

              7820    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7820 21 002223   000000 054000 15                 AOS     BUFFER

              7821            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7822    6     DO;

              7823    6       CALL SEARCH(BUFFER.COLUMN,

   7823 21 002224   000005 236000 15                 LDQ     BUFFER+5
        21 002225   000000 136000 15                 SBLQ    BUFFER
        21 002226   000024 756000 0                  STQ     @TABLE+10
        21 002227   000000 236000 15                 LDQ     BUFFER
        21 002230   000024 721000 0                  LXL1    @TABLE+10
        21 002231   000000 164546                    TCT
        21 002232   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 002233   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002234   000000 000000 15                 ARG     BUFFER
        21 002235   000000 235000 15                 LDA     BUFFER
        21 002236   000033 771000                    ARL     27
        21 002237   000001 755000 15                 STA     BUFFER+1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:179  
        21 002240   000000 551040 15                 STBA    BUFFER,'40'O
        21 002241   000000 056000 15                 ASQ     BUFFER

              7824    6                   BUFFER.CLASS,
              7825    6                   TABLE,
              7826    6                   BUFFER_LINE,
              7827    6                   BUFFER.COLUMN);
              7828    6     END;

              7830    5     END;

      487     7832    4         END;

   7832 21 002242   002245 710000 21                 TRA     s:7838

      488     7833    3       ELSE
      489     7834    4         DO;

      490     7835    4           LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   7835 21 002243   400000 236003                    LDQ     -131072,DU
        21 002244   000002 256000 6                  ORSQ    LEX_SYMBOL+2

      491     7836    4         END;

      492     7837
      493     7838    3     END CONTINUE_DOUBLE_QUOTED_STRING;

   7838 21 002245   000020 221200 0                  LDX1  ! @TABLE+6
        21 002246   000001 702211                    TSX2  ! 1,X1

      494     7839
      495     7840
      496     7841    2     SCAN_QUOTED_NUMERIC_REP : PROC;

   7841 21 002247   000021 741200 0     SCAN_QUOTED* STX1  ! @TABLE+7

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:180  
      497     7842
      498     7843            %ADV_BUFFER_COLUMN_THIS_LINE;
              7844    4     DO;

              7845    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7845 21 002250   000000 054000 15                 AOS     BUFFER

              7846            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7847    5     DO;

              7848    5       CALL SEARCH(BUFFER.COLUMN,

   7848 21 002251   000005 236000 15                 LDQ     BUFFER+5
        21 002252   000000 136000 15                 SBLQ    BUFFER
        21 002253   000024 756000 0                  STQ     @TABLE+10
        21 002254   000000 236000 15                 LDQ     BUFFER
        21 002255   000006 470400 15                 LDP0    BUFFER+6
        21 002256   000024 720000 0                  LXL0    @TABLE+10
        21 002257   000000 164546                    TCT
        21 002260   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002261   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002262   000000 000000 15                 ARG     BUFFER
        21 002263   000000 235000 15                 LDA     BUFFER
        21 002264   000033 771000                    ARL     27
        21 002265   000001 755000 15                 STA     BUFFER+1
        21 002266   000000 551040 15                 STBA    BUFFER,'40'O
        21 002267   000000 056000 15                 ASQ     BUFFER

              7849    5                   BUFFER.CLASS,
              7850    5                   TABLE,
              7851    5                   BUFFER_LINE,
              7852    5                   BUFFER.COLUMN);
              7853    5     END;

              7855    4     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:181  
      499     7857            %SCAN_SEARCH_THIS_LINE(TABLE=DOUBLE_QUOTE_SEARCH_TABLE);
              7858    4     DO;

              7859    4       CALL SEARCH(BUFFER.COLUMN,

   7859 21 002270   000005 236000 15                 LDQ     BUFFER+5
        21 002271   000000 136000 15                 SBLQ    BUFFER
        21 002272   000024 756000 0                  STQ     @TABLE+10
        21 002273   000000 236000 15                 LDQ     BUFFER
        21 002274   000024 720000 0                  LXL0    @TABLE+10
        21 002275   000000 164546                    TCT
        21 002276   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002277   000000 000000 xsym               ARG     DOUBLE_QUOTE_SEARCH_TABLE
        21 002300   000000 000000 15                 ARG     BUFFER
        21 002301   000000 235000 15                 LDA     BUFFER
        21 002302   000033 771000                    ARL     27
        21 002303   000001 755000 15                 STA     BUFFER+1
        21 002304   000000 551040 15                 STBA    BUFFER,'40'O
        21 002305   000000 056000 15                 ASQ     BUFFER

              7860    4                   BUFFER.CLASS,
              7861    4                   TABLE,
              7862    4                   BUFFER_LINE,
              7863    4                   BUFFER.COLUMN);
              7864    4     END;

      500     7866
      501     7867    4       DO WHILE BUFFER.CLASS = %END_OF_LINE AND BUFFER.LINE_TYPE.LINE_CONTINUED ;

   7867 21 002306   002330 710000 21                 TRA     s:7878

      502     7868    4         CALL CONTINUE_DOUBLE_QUOTED_STRING;

   7868 21 002307   002121 701000 21                 TSX1    CONTINUE_DOUBLE_QUOTED_STRING
        21 002310   000000 011000                    NOP     0

      503     7869              %SCAN_SEARCH_THIS_LINE(TABLE=DOUBLE_QUOTE_SEARCH_TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:182  
              7870    5     DO;

              7871    5       CALL SEARCH(BUFFER.COLUMN,

   7871 21 002311   000005 236000 15                 LDQ     BUFFER+5
        21 002312   000000 136000 15                 SBLQ    BUFFER
        21 002313   000024 756000 0                  STQ     @TABLE+10
        21 002314   000000 236000 15                 LDQ     BUFFER
        21 002315   000006 470400 15                 LDP0    BUFFER+6
        21 002316   000024 720000 0                  LXL0    @TABLE+10
        21 002317   000000 164546                    TCT
        21 002320   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002321   000000 000000 xsym               ARG     DOUBLE_QUOTE_SEARCH_TABLE
        21 002322   000000 000000 15                 ARG     BUFFER
        21 002323   000000 235000 15                 LDA     BUFFER
        21 002324   000033 771000                    ARL     27
        21 002325   000001 755000 15                 STA     BUFFER+1
        21 002326   000000 551040 15                 STBA    BUFFER,'40'O
        21 002327   000000 056000 15                 ASQ     BUFFER

              7872    5                   BUFFER.CLASS,
              7873    5                   TABLE,
              7874    5                   BUFFER_LINE,
              7875    5                   BUFFER.COLUMN);
              7876    5     END;

      504     7878    4       END;

   7878 21 002330   000000 115003                    CMPA    0,DU
        21 002331   002335 601000 21                 TNZ     s:7880
        21 002332   000004 236000 15                 LDQ     BUFFER+4
        21 002333   100000 316003                    CANQ    32768,DU
        21 002334   002307 601000 21                 TNZ     s:7868

      505     7879
      506     7880    3       IF BUFFER.CLASS = %DOUBLE_QUOTE THEN

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:183  
   7880 21 002335   000003 115007                    CMPA    3,DL
        21 002336   002341 601000 21                 TNZ     s:7883

      507     7881    3         STOP_SCAN_FLAG = FALSE;

   7881 21 002337   000001 450000 0                  STZ     STOP_SCAN_FLAG
        21 002340   002343 710000 21                 TRA     s:7885

      508     7882    3       ELSE
      509     7883    3         LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7883 21 002341   000033 236007                    LDQ     27,DL
        21 002342   000001 756000 6                  STQ     LEX_SYMBOL+1

      510     7884
      511     7885    3     END SCAN_QUOTED_NUMERIC_REP;

   7885 21 002343   000021 221200 0                  LDX1  ! @TABLE+7
        21 002344   000001 702211                    TSX2  ! 1,X1

      512     7886
      513     7887
      514     7888    3     DO UNTIL STOP_SCAN_FLAG;

      515     7889    3       STOP_SCAN_FLAG = TRUE;

   7889 21 002345   400000 236003                    LDQ     -131072,DU
        21 002346   000001 756000 0                  STQ     STOP_SCAN_FLAG

      516     7890    3       IF O1COM.PSEUDO_TEXT_FLAG

   7890 21 002347   001330 234000 xsym               SZN     O1COM+728
        21 002350   002354 605000 21                 TPL     s:7892

      517     7891    3         THEN TABLE$ = ADDR(DBL_QUOTE_PSEUDO_SEARCH_TABLE);

   7891 21 002351   000006 236000 22                 LDQ     6
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:184  
        21 002352   000006 756000 0                  STQ     TABLE$
        21 002353   002356 710000 21                 TRA     s:7895

      518     7892    3         ELSE TABLE$ = ADDR(DOUBLE_QUOTE_SEARCH_TABLE);

   7892 21 002354   000007 236000 22                 LDQ     7
        21 002355   000006 756000 0                  STQ     TABLE$

      519     7893            %ADV_BUFFER_COLUMN_THIS_LINE(TABLE=BASED$TABLE);
              7894    4     DO;

              7895    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7895 21 002356   000000 054000 15                 AOS     BUFFER

              7896            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7897    5     DO;

              7898    5       CALL SEARCH(BUFFER.COLUMN,

   7898 21 002357   000005 236000 15                 LDQ     BUFFER+5
        21 002360   000000 136000 15                 SBLQ    BUFFER
        21 002361   000024 756000 0                  STQ     @TABLE+10
        21 002362   000000 236000 15                 LDQ     BUFFER
        21 002363   000006 470400 0                  LDP0    TABLE$
        21 002364   000006 471400 15                 LDP1    BUFFER+6
        21 002365   000024 720000 0                  LXL0    @TABLE+10
        21 002366   000000 164546                    TCT
        21 002367   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        21 002370   000000 000100                    ARG     0,,PR0
        21 002371   000000 000000 15                 ARG     BUFFER
        21 002372   000000 235000 15                 LDA     BUFFER
        21 002373   000033 771000                    ARL     27
        21 002374   000001 755000 15                 STA     BUFFER+1
        21 002375   000000 551040 15                 STBA    BUFFER,'40'O
        21 002376   000000 056000 15                 ASQ     BUFFER

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:185  
              7899    5                   BUFFER.CLASS,
              7900    5                   TABLE,
              7901    5                   BUFFER_LINE,
              7902    5                   BUFFER.COLUMN);
              7903    5     END;

              7905    4     END;

      520     7907
      521     7908    4       DO CASE(BUFFER.CLASS);

   7908 21 002377   000022 115007                    CMPA    18,DL
        21 002400   002402 602005 21                 TNC     s:7908+3,AL
        21 002401   002566 710000 21                 TRA     s:7978
        21 002402   002501 710000 21                 TRA     s:7946
        21 002403   002566 710000 21                 TRA     s:7978
        21 002404   002566 710000 21                 TRA     s:7978
        21 002405   002424 710000 21                 TRA     s:7913
        21 002406   002566 710000 21                 TRA     s:7978
        21 002407   002566 710000 21                 TRA     s:7978
        21 002410   002566 710000 21                 TRA     s:7978
        21 002411   002566 710000 21                 TRA     s:7978
        21 002412   002566 710000 21                 TRA     s:7978
        21 002413   002566 710000 21                 TRA     s:7978
        21 002414   002566 710000 21                 TRA     s:7978
        21 002415   002566 710000 21                 TRA     s:7978
        21 002416   002566 710000 21                 TRA     s:7978
        21 002417   002566 710000 21                 TRA     s:7978
        21 002420   002566 710000 21                 TRA     s:7978
        21 002421   002566 710000 21                 TRA     s:7978
        21 002422   002566 710000 21                 TRA     s:7978
        21 002423   002467 710000 21                 TRA     s:7939

      522     7909
      523     7910    4         CASE(%DOUBLE_QUOTE);

      524     7911                %ADV_BUFFER_COLUMN_THIS_LINE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:186  
              7912    5     DO;

              7913    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   7913 21 002424   000000 054000 15                 AOS     BUFFER

              7914            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              7915    6     DO;

              7916    6       CALL SEARCH(BUFFER.COLUMN,

   7916 21 002425   000005 236000 15                 LDQ     BUFFER+5
        21 002426   000000 136000 15                 SBLQ    BUFFER
        21 002427   000024 756000 0                  STQ     @TABLE+10
        21 002430   000000 236000 15                 LDQ     BUFFER
        21 002431   000024 720000 0                  LXL0    @TABLE+10
        21 002432   000000 164546                    TCT
        21 002433   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        21 002434   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002435   000000 000000 15                 ARG     BUFFER
        21 002436   000000 235000 15                 LDA     BUFFER
        21 002437   000033 771000                    ARL     27
        21 002440   000001 755000 15                 STA     BUFFER+1
        21 002441   000000 551040 15                 STBA    BUFFER,'40'O
        21 002442   000000 056000 15                 ASQ     BUFFER

              7917    6                   BUFFER.CLASS,
              7918    6                   TABLE,
              7919    6                   BUFFER_LINE,
              7920    6                   BUFFER.COLUMN);
              7921    6     END;

              7923    5     END;

      525     7925    4           IF BUFFER.CLASS = %END_OF_LINE

   7925 21 002443   000000 115003                    CMPA    0,DU
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:187  
        21 002444   002452 601000 21                 TNZ     s:7928
        21 002445   000004 236000 15                 LDQ     BUFFER+4
        21 002446   100000 316003                    CANQ    32768,DU
        21 002447   002452 600000 21                 TZE     s:7928

      526     7926    4                AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      527     7927    4             CALL CONTINUE_DOUBLE_QUOTED_STRING;

   7927 21 002450   002121 701000 21                 TSX1    CONTINUE_DOUBLE_QUOTED_STRING
        21 002451   000000 011000                    NOP     0

      528     7928    4           IF BUFFER.CLASS = %DOUBLE_QUOTE THEN

   7928 21 002452   000001 235000 15                 LDA     BUFFER+1
        21 002453   000003 115007                    CMPA    3,DL
        21 002454   002457 601000 21                 TNZ     s:7933

      529     7929    5             DO;

      530     7930    5               STOP_SCAN_FLAG = FALSE;

   7930 21 002455   000001 450000 0                  STZ     STOP_SCAN_FLAG

      531     7931    5             END;

   7931 21 002456   002566 710000 21                 TRA     s:7978

      532     7932    4           ELSE
      533     7933    4             IF BUFFER.CLASS = %DIGIT THEN

   7933 21 002457   000002 115007                    CMPA    2,DL
        21 002460   002464 601000 21                 TNZ     s:7936

      534     7934    4               CALL SCAN_QUOTED_NUMERIC_REP;

   7934 21 002461   002247 701000 21                 TSX1    SCAN_QUOTED_NUMERIC_REP
        21 002462   000000 011000                    NOP     0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:188  
        21 002463   002566 710000 21                 TRA     s:7978

      535     7935    4             ELSE
      536     7936    4               STOP_SCAN_FLAG = TRUE;

   7936 21 002464   400000 236003                    LDQ     -131072,DU
        21 002465   000001 756000 0                  STQ     STOP_SCAN_FLAG
        21 002466   002566 710000 21                 TRA     s:7978

      537     7937
      538     7938    4         CASE(%EQUAL);

      539     7939    4           IF SUBSTR(BUFFER_LINE, BUFFER.COLUMN + 1, 1) ~= '='

   7939 21 002467   000000 236000 15                 LDQ     BUFFER
        21 002470   040000 106506                    CMPC    fill='040'O
        21 002471   100000 200001                    ADSC9   0,Q,PR1                  cn=1,n=1
        21 002472   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 002473   002476 600000 21                 TZE     s:7941

      540     7940    4             THEN STOP_SCAN_FLAG = FALSE;

   7940 21 002474   000001 450000 0                  STZ     STOP_SCAN_FLAG
        21 002475   002566 710000 21                 TRA     s:7978

      541     7941    4             ELSE LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   7941 21 002476   400000 236003                    LDQ     -131072,DU
        21 002477   000002 256000 6                  ORSQ    LEX_SYMBOL+2
        21 002500   002566 710000 21                 TRA     s:7978

      542     7942
      543     7943    4         CASE(%END_OF_LINE);

      544     7944                %CONCAT_SYMBOL;
              7945    5        DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:189  
              7946    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7946 21 002501   000000 236000 15                 LDQ     BUFFER
        21 002502   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002503   000007 756000 0                  STQ     SEARCH_SIZE

              7947    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7947 21 002504   000504 236007                    LDQ     324,DL
        21 002505   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002506   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002507   002511 605000 21                 TPL     s:7949

              7948    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7948 21 002510   000007 756000 0                  STQ     SEARCH_SIZE

              7949    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7949 21 002511   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002512   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002513   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002514   040046 100545                    MLR     fill='040'O
        21 002515   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        21 002516   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7950    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7951    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7951 21 002517   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002520   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002521   000010 756000 6                  STQ     LEX_SYMBOL+8

              7952    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7952 21 002522   000000 235000 15                 LDA     BUFFER
        21 002523   000010 755000 0                  STA     SYMBOL_START_LOCATION
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:190  

              7953    5        END;

      545     7955                /*N* Free Format -- IF NOT COMCOM.OB.FORMAT THEN */
      546     7956    5             DO;

      547     7957    5               IF BUFFER.COLUMN < O1COM.MARGIN_R THEN

   7957 21 002524   000000 236000 15                 LDQ     BUFFER
        21 002525   000123 116000 xsym               CMPQ    O1COM+83
        21 002526   002552 605000 21                 TPL     s:7968

      548     7958    6                 DO;

      549     7959    6                   SEARCH_SIZE = MINIMUM( O1COM.MARGIN_R - BUFFER.COLUMN,

   7959 21 002527   000123 236000 xsym               LDQ     O1COM+83
        21 002530   000000 136000 15                 SBLQ    BUFFER
        21 002531   000024 756000 0                  STQ     @TABLE+10
        21 002532   000504 236007                    LDQ     324,DL
        21 002533   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002534   000025 756000 0                  STQ     @TABLE+11
        21 002535   000024 236000 0                  LDQ     @TABLE+10
        21 002536   000025 116000 0                  CMPQ    @TABLE+11
        21 002537   002541 604400 21                 TMOZ    s:7959+10
        21 002540   000025 236000 0                  LDQ     @TABLE+11
        21 002541   000007 756000 0                  STQ     SEARCH_SIZE

      550     7960    6                                     %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE);
      551     7961    6                   CALL INSERT(LEX_SYMBOL.SYMBOL,

   7961 21 002542   000000 620006                    EAX0    0,QL
        21 002543   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002544   040046 100400                    MLR     fill='040'O
        21 002545   000010 000001 22                 ADSC9   8                        cn=0,n=1
        21 002546   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:191  
      552     7962    6                               LEX_SYMBOL.SIZE,
      553     7963    6                               SEARCH_SIZE,
      554     7964    6                               ' ');
      555     7965    6                   LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7965 21 002547   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002550   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002551   000010 756000 6                  STQ     LEX_SYMBOL+8

      556     7966    6                 END;

      557     7967    5             END;

      558     7968    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   7968 21 002552   000004 236000 15                 LDQ     BUFFER+4
        21 002553   100000 316003                    CANQ    32768,DU
        21 002554   002564 600000 21                 TZE     s:7975

      559     7969    5             DO;

      560     7970    5               CALL CONTINUE_DOUBLE_QUOTED_STRING;

   7970 21 002555   002121 701000 21                 TSX1    CONTINUE_DOUBLE_QUOTED_STRING
        21 002556   000000 011000                    NOP     0

      561     7971    5               IF NOT STOP_SCAN_FLAG THEN

   7971 21 002557   000001 234000 0                  SZN     STOP_SCAN_FLAG
        21 002560   002566 604000 21                 TMI     s:7978

      562     7972    5                 BUFFER.COLUMN = BUFFER.COLUMN - 1;

   7972 21 002561   000001 336007                    LCQ     1,DL
        21 002562   000000 056000 15                 ASQ     BUFFER

      563     7973    5             END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:192  

   7973 21 002563   002566 710000 21                 TRA     s:7978

      564     7974    4           ELSE
      565     7975    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   7975 21 002564   000033 235007                    LDA     27,DL
        21 002565   000001 755000 6                  STA     LEX_SYMBOL+1

      566     7976
      567     7977    4       END;

      568     7978    3     END;

   7978 21 002566   000001 234000 0                  SZN     STOP_SCAN_FLAG
        21 002567   002345 605000 21                 TPL     s:7889

      569     7979
      570     7980        %CONCAT_SYMBOL;
              7981    3        DO;

              7982    3          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   7982 21 002570   000000 236000 15                 LDQ     BUFFER
        21 002571   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002572   000007 756000 0                  STQ     SEARCH_SIZE

              7983    3          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   7983 21 002573   000504 236007                    LDQ     324,DL
        21 002574   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002575   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002576   002600 605000 21                 TPL     s:7985

              7984    3            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   7984 21 002577   000007 756000 0                  STQ     SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:193  

              7985    3          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   7985 21 002600   000006 470400 15                 LDP0    BUFFER+6
        21 002601   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002602   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002603   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002604   040046 100545                    MLR     fill='040'O
        21 002605   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 002606   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              7986    3              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              7987    3          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   7987 21 002607   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002610   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002611   000010 756000 6                  STQ     LEX_SYMBOL+8

              7988    3          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   7988 21 002612   000000 235000 15                 LDA     BUFFER
        21 002613   000010 755000 0                  STA     SYMBOL_START_LOCATION

              7989    3        END;

      571     7991        %MARK_END_OF_SYMBOL;
              7992    3     DO;

              7993    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   7993 21 002614   000007 755000 6                  STA     LEX_SYMBOL+7

              7994    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   7994 21 002615   000002 235000 15                 LDA     BUFFER+2
        21 002616   000006 755000 6                  STA     LEX_SYMBOL+6

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:194  
              7995    3     END;

      572     7997
      573     7998    2   IF BUFFER.CLASS ~= %SPACE

   7998 21 002617   000001 235000 15                 LDA     BUFFER+1
        21 002620   000042 115007                    CMPA    34,DL
        21 002621   002653 600000 21                 TZE     s:8014
        21 002622   000000 115003                    CMPA    0,DU
        21 002623   002653 600000 21                 TZE     s:8014
        21 002624   000035 115007                    CMPA    29,DL
        21 002625   002653 600000 21                 TZE     s:8014
        21 002626   000043 115007                    CMPA    35,DL
        21 002627   002653 600000 21                 TZE     s:8014
        21 002630   000014 115007                    CMPA    12,DL
        21 002631   002653 600000 21                 TZE     s:8014
        21 002632   000007 115007                    CMPA    7,DL
        21 002633   002653 600000 21                 TZE     s:8014
        21 002634   001330 234000 xsym               SZN     O1COM+728
        21 002635   002653 604000 21                 TMI     s:8014
        21 002636   000021 115007                    CMPA    17,DL
        21 002637   002651 601000 21                 TNZ     s:8012
        21 002640   000000 236000 15                 LDQ     BUFFER
        21 002641   000001 036007                    ADLQ    1,DL
        21 002642   000005 116000 15                 CMPQ    BUFFER+5
        21 002643   002651 605000 21                 TPL     s:8012
        21 002644   000000 235000 15                 LDA     BUFFER
        21 002645   040000 106505                    CMPC    fill='040'O
        21 002646   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 002647   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 002650   002653 600000 21                 TZE     s:8014

      574     7999    2        AND BUFFER.CLASS ~= %END_OF_LINE
      575     8000    2        AND BUFFER.CLASS ~= %COMMA
      576     8001    2        AND BUFFER.CLASS ~= %SEMICOLON
      577     8002    2        AND BUFFER.CLASS ~= %PERIOD
      578     8003    2        AND BUFFER.CLASS ~= %RIGHT_PAREN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:195  
      579     8004    2        AND NOT O1COM.PSEUDO_TEXT_FLAG
      580     8005    2        AND NOT
      581     8006                     %NEXT_TWO_CHARS_ARE_PSEUDO;
              8007    2     (BUFFER.CLASS = %EQUAL
              8008    2       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8009    2       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      582     8011    2                                           THEN
      583     8012    2     LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   8012 21 002651   400000 236003                    LDQ     -131072,DU
        21 002652   000002 256000 6                  ORSQ    LEX_SYMBOL+2

      584     8013
      585     8014    2   END SCAN_QUOTE_LITERAL;

   8014 21 002653   000017 221200 0                  LDX1  ! @TABLE+5
        21 002654   000001 702211                    TSX2  ! 1,X1

      586     8015        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:196  
      587     8016    1   SCAN_APOSTROPHE_LITERAL  : PROC;

   8016 21 002655   000022 741200 0     SCAN_APOSTR* STX1  ! @TABLE+8
        21 002656   003005 710000 21                 TRA     s:8089

      588     8017
      589     8018    2     CONTINUE_SINGLE_QUOTED_STRING : PROC;

   8018 21 002657   000023 741200 0     CONTINUE_SI* STX1  ! @TABLE+9

      590     8019
      591     8020            /* Line_continued should have been checked;
      592     8021                   We should be at end_of_line */
      593     8022
      594     8023            %ADV_BUFFER_COLUMN_NEXT_LINE;
              8024    4           DO;

              8025                  %CONCAT_SYMBOL;
              8026    5        DO;

              8027    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8027 21 002660   000000 236000 15                 LDQ     BUFFER
        21 002661   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002662   000007 756000 0                  STQ     SEARCH_SIZE

              8028    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8028 21 002663   000504 236007                    LDQ     324,DL
        21 002664   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002665   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002666   002670 605000 21                 TPL     s:8030

              8029    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8029 21 002667   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:197  
              8030    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8030 21 002670   000006 470400 15                 LDP0    BUFFER+6
        21 002671   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002672   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002673   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002674   040046 100545                    MLR     fill='040'O
        21 002675   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 002676   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8031    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8032    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8032 21 002677   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002700   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002701   000010 756000 6                  STQ     LEX_SYMBOL+8

              8033    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8033 21 002702   000000 235000 15                 LDA     BUFFER
        21 002703   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8034    5        END;

              8036    4             CALL GET_NEXT_SCANNER_LINE;

   8036 21 002704   000000 222000 19                 LDX2    GET_NEXT_SCANNER_LINE
        21 002705   000000 631400 22                 EPPR1   0
        21 002706   000000 701012                    TSX1    0,X2
        21 002707   000000 011000                    NOP     0

              8037    4             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8037 21 002710   000000 235000 15                 LDA     BUFFER
        21 002711   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8038                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:198  
              8039    5     DO;

              8040    5       CALL SEARCH(BUFFER.COLUMN,

   8040 21 002712   000005 236000 15                 LDQ     BUFFER+5
        21 002713   000000 136000 15                 SBLQ    BUFFER
        21 002714   000024 756000 0                  STQ     @TABLE+10
        21 002715   000000 236000 15                 LDQ     BUFFER
        21 002716   000006 470400 15                 LDP0    BUFFER+6
        21 002717   000024 720000 0                  LXL0    @TABLE+10
        21 002720   000000 164546                    TCT
        21 002721   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 002722   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002723   000000 000000 15                 ARG     BUFFER
        21 002724   000000 235000 15                 LDA     BUFFER
        21 002725   000033 771000                    ARL     27
        21 002726   000001 755000 15                 STA     BUFFER+1
        21 002727   000000 551040 15                 STBA    BUFFER,'40'O
        21 002730   000000 056000 15                 ASQ     BUFFER

              8041    5                   BUFFER.CLASS,
              8042    5                   TABLE,
              8043    5                   BUFFER_LINE,
              8044    5                   BUFFER.COLUMN);
              8045    5     END;

              8047    4           END;

      595     8049    3       IF BUFFER.CLASS = %SINGLE_QUOTE THEN

   8049 21 002731   000004 115007                    CMPA    4,DL
        21 002732   003001 601000 21                 TNZ     s:8081

      596     8050    4         DO;

      597     8051                %CONCAT_SYMBOL;
              8052    5        DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:199  

              8053    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8053 21 002733   000000 236000 15                 LDQ     BUFFER
        21 002734   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 002735   000007 756000 0                  STQ     SEARCH_SIZE

              8054    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8054 21 002736   000504 236007                    LDQ     324,DL
        21 002737   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 002740   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 002741   002743 605000 21                 TPL     s:8056

              8055    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8055 21 002742   000007 756000 0                  STQ     SEARCH_SIZE

              8056    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8056 21 002743   000007 720000 0                  LXL0    SEARCH_SIZE
        21 002744   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 002745   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002746   040046 100545                    MLR     fill='040'O
        21 002747   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 002750   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8057    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8058    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8058 21 002751   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 002752   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 002753   000010 756000 6                  STQ     LEX_SYMBOL+8

              8059    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8059 21 002754   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:200  
        21 002755   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8060    5        END;

      598     8062    4           SYMBOL_START_LOCATION = BUFFER.COLUMN + 1;

   8062 21 002756   000001 035007                    ADLA    1,DL
        21 002757   000010 755000 0                  STA     SYMBOL_START_LOCATION

      599     8063    4           STOP_SCAN_FLAG = FALSE;

   8063 21 002760   000001 450000 0                  STZ     STOP_SCAN_FLAG

      600     8064                %ADV_BUFFER_COLUMN_THIS_LINE;
              8065    5     DO;

              8066    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8066 21 002761   000000 054000 15                 AOS     BUFFER

              8067            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8068    6     DO;

              8069    6       CALL SEARCH(BUFFER.COLUMN,

   8069 21 002762   000005 236000 15                 LDQ     BUFFER+5
        21 002763   000000 136000 15                 SBLQ    BUFFER
        21 002764   000024 756000 0                  STQ     @TABLE+10
        21 002765   000000 236000 15                 LDQ     BUFFER
        21 002766   000024 721000 0                  LXL1    @TABLE+10
        21 002767   000000 164546                    TCT
        21 002770   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 002771   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 002772   000000 000000 15                 ARG     BUFFER
        21 002773   000000 235000 15                 LDA     BUFFER
        21 002774   000033 771000                    ARL     27
        21 002775   000001 755000 15                 STA     BUFFER+1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:201  
        21 002776   000000 551040 15                 STBA    BUFFER,'40'O
        21 002777   000000 056000 15                 ASQ     BUFFER

              8070    6                   BUFFER.CLASS,
              8071    6                   TABLE,
              8072    6                   BUFFER_LINE,
              8073    6                   BUFFER.COLUMN);
              8074    6     END;

              8076    5     END;

      601     8078    4         END;

   8078 21 003000   003003 710000 21                 TRA     s:8084

      602     8079    3       ELSE
      603     8080    4         DO;

      604     8081    4           LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   8081 21 003001   400000 236003                    LDQ     -131072,DU
        21 003002   000002 256000 6                  ORSQ    LEX_SYMBOL+2

      605     8082    4         END;

      606     8083
      607     8084    3     END CONTINUE_SINGLE_QUOTED_STRING;

   8084 21 003003   000023 221200 0                  LDX1  ! @TABLE+9
        21 003004   000001 702211                    TSX2  ! 1,X1

      608     8085
      609     8086
      610     8087
      611     8088    3     DO UNTIL STOP_SCAN_FLAG;

      612     8089    3       STOP_SCAN_FLAG = TRUE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:202  

   8089 21 003005   400000 236003                    LDQ     -131072,DU
        21 003006   000001 756000 0                  STQ     STOP_SCAN_FLAG

      613     8090    3       IF O1COM.PSEUDO_TEXT_FLAG

   8090 21 003007   001330 234000 xsym               SZN     O1COM+728
        21 003010   003014 605000 21                 TPL     s:8092

      614     8091    3         THEN TABLE$ = ADDR(SNGL_QUOTE_PSEUDO_SEARCH_TABLE);

   8091 21 003011   000011 236000 22                 LDQ     9
        21 003012   000006 756000 0                  STQ     TABLE$
        21 003013   003016 710000 21                 TRA     s:8095

      615     8092    3         ELSE TABLE$ = ADDR(SINGLE_QUOTE_SEARCH_TABLE);

   8092 21 003014   000012 236000 22                 LDQ     10
        21 003015   000006 756000 0                  STQ     TABLE$

      616     8093            %ADV_BUFFER_COLUMN_THIS_LINE(TABLE=BASED$TABLE);
              8094    4     DO;

              8095    4       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8095 21 003016   000000 054000 15                 AOS     BUFFER

              8096            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8097    5     DO;

              8098    5       CALL SEARCH(BUFFER.COLUMN,

   8098 21 003017   000005 236000 15                 LDQ     BUFFER+5
        21 003020   000000 136000 15                 SBLQ    BUFFER
        21 003021   000024 756000 0                  STQ     @TABLE+10
        21 003022   000000 236000 15                 LDQ     BUFFER
        21 003023   000006 470400 0                  LDP0    TABLE$
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:203  
        21 003024   000006 471400 15                 LDP1    BUFFER+6
        21 003025   000024 720000 0                  LXL0    @TABLE+10
        21 003026   000000 164546                    TCT
        21 003027   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        21 003030   000000 000100                    ARG     0,,PR0
        21 003031   000000 000000 15                 ARG     BUFFER
        21 003032   000000 235000 15                 LDA     BUFFER
        21 003033   000033 771000                    ARL     27
        21 003034   000001 755000 15                 STA     BUFFER+1
        21 003035   000000 551040 15                 STBA    BUFFER,'40'O
        21 003036   000000 056000 15                 ASQ     BUFFER

              8099    5                   BUFFER.CLASS,
              8100    5                   TABLE,
              8101    5                   BUFFER_LINE,
              8102    5                   BUFFER.COLUMN);
              8103    5     END;

              8105    4     END;

      617     8107
      618     8108    4       DO CASE(BUFFER.CLASS);

   8108 21 003037   000022 115007                    CMPA    18,DL
        21 003040   003042 602005 21                 TNC     s:8108+3,AL
        21 003041   003216 710000 21                 TRA     s:8173
        21 003042   003131 710000 21                 TRA     s:8141
        21 003043   003216 710000 21                 TRA     s:8173
        21 003044   003216 710000 21                 TRA     s:8173
        21 003045   003216 710000 21                 TRA     s:8173
        21 003046   003064 710000 21                 TRA     s:8113
        21 003047   003216 710000 21                 TRA     s:8173
        21 003050   003216 710000 21                 TRA     s:8173
        21 003051   003216 710000 21                 TRA     s:8173
        21 003052   003216 710000 21                 TRA     s:8173
        21 003053   003216 710000 21                 TRA     s:8173
        21 003054   003216 710000 21                 TRA     s:8173
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:204  
        21 003055   003216 710000 21                 TRA     s:8173
        21 003056   003216 710000 21                 TRA     s:8173
        21 003057   003216 710000 21                 TRA     s:8173
        21 003060   003216 710000 21                 TRA     s:8173
        21 003061   003216 710000 21                 TRA     s:8173
        21 003062   003216 710000 21                 TRA     s:8173
        21 003063   003117 710000 21                 TRA     s:8134

      619     8109
      620     8110    4         CASE(%SINGLE_QUOTE);

      621     8111                %ADV_BUFFER_COLUMN_THIS_LINE;
              8112    5     DO;

              8113    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8113 21 003064   000000 054000 15                 AOS     BUFFER

              8114            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8115    6     DO;

              8116    6       CALL SEARCH(BUFFER.COLUMN,

   8116 21 003065   000005 236000 15                 LDQ     BUFFER+5
        21 003066   000000 136000 15                 SBLQ    BUFFER
        21 003067   000024 756000 0                  STQ     @TABLE+10
        21 003070   000000 236000 15                 LDQ     BUFFER
        21 003071   000024 720000 0                  LXL0    @TABLE+10
        21 003072   000000 164546                    TCT
        21 003073   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        21 003074   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 003075   000000 000000 15                 ARG     BUFFER
        21 003076   000000 235000 15                 LDA     BUFFER
        21 003077   000033 771000                    ARL     27
        21 003100   000001 755000 15                 STA     BUFFER+1
        21 003101   000000 551040 15                 STBA    BUFFER,'40'O
        21 003102   000000 056000 15                 ASQ     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:205  

              8117    6                   BUFFER.CLASS,
              8118    6                   TABLE,
              8119    6                   BUFFER_LINE,
              8120    6                   BUFFER.COLUMN);
              8121    6     END;

              8123    5     END;

      622     8125    4           IF BUFFER.CLASS = %END_OF_LINE

   8125 21 003103   000000 115003                    CMPA    0,DU
        21 003104   003112 601000 21                 TNZ     s:8128
        21 003105   000004 236000 15                 LDQ     BUFFER+4
        21 003106   100000 316003                    CANQ    32768,DU
        21 003107   003112 600000 21                 TZE     s:8128

      623     8126    4                AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      624     8127    4             CALL CONTINUE_SINGLE_QUOTED_STRING;

   8127 21 003110   002657 701000 21                 TSX1    CONTINUE_SINGLE_QUOTED_STRING
        21 003111   000000 011000                    NOP     0

      625     8128    4           IF BUFFER.CLASS = %SINGLE_QUOTE THEN

   8128 21 003112   000001 235000 15                 LDA     BUFFER+1
        21 003113   000004 115007                    CMPA    4,DL
        21 003114   003216 601000 21                 TNZ     s:8173

      626     8129    5             DO;

      627     8130    5               STOP_SCAN_FLAG = FALSE;

   8130 21 003115   000001 450000 0                  STZ     STOP_SCAN_FLAG

      628     8131    5             END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:206  
   8131 21 003116   003216 710000 21                 TRA     s:8173

      629     8132
      630     8133    4         CASE(%EQUAL);

      631     8134    4           IF SUBSTR(BUFFER_LINE, BUFFER.COLUMN + 1, 1) ~= '='

   8134 21 003117   000000 236000 15                 LDQ     BUFFER
        21 003120   040000 106506                    CMPC    fill='040'O
        21 003121   100000 200001                    ADSC9   0,Q,PR1                  cn=1,n=1
        21 003122   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 003123   003126 600000 21                 TZE     s:8136

      632     8135    4             THEN STOP_SCAN_FLAG = FALSE;

   8135 21 003124   000001 450000 0                  STZ     STOP_SCAN_FLAG
        21 003125   003216 710000 21                 TRA     s:8173

      633     8136    4             ELSE LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   8136 21 003126   400000 236003                    LDQ     -131072,DU
        21 003127   000002 256000 6                  ORSQ    LEX_SYMBOL+2
        21 003130   003216 710000 21                 TRA     s:8173

      634     8137
      635     8138    4         CASE(%END_OF_LINE);

      636     8139                %CONCAT_SYMBOL;
              8140    5        DO;

              8141    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8141 21 003131   000000 236000 15                 LDQ     BUFFER
        21 003132   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 003133   000007 756000 0                  STQ     SEARCH_SIZE

              8142    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:207  

   8142 21 003134   000504 236007                    LDQ     324,DL
        21 003135   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003136   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 003137   003141 605000 21                 TPL     s:8144

              8143    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8143 21 003140   000007 756000 0                  STQ     SEARCH_SIZE

              8144    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8144 21 003141   000007 720000 0                  LXL0    SEARCH_SIZE
        21 003142   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 003143   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003144   040046 100545                    MLR     fill='040'O
        21 003145   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        21 003146   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8145    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8146    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8146 21 003147   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003150   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 003151   000010 756000 6                  STQ     LEX_SYMBOL+8

              8147    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8147 21 003152   000000 235000 15                 LDA     BUFFER
        21 003153   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8148    5        END;

      637     8150                 /*N* Free Format -- IF NOT COMCOM.OB.FORMAT THEN */
      638     8151    5             DO;

      639     8152    5               IF BUFFER.COLUMN < O1COM.MARGIN_R THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:208  

   8152 21 003154   000000 236000 15                 LDQ     BUFFER
        21 003155   000123 116000 xsym               CMPQ    O1COM+83
        21 003156   003202 605000 21                 TPL     s:8163

      640     8153    6                 DO;

      641     8154    6                   SEARCH_SIZE = MINIMUM( O1COM.MARGIN_R - BUFFER.COLUMN,

   8154 21 003157   000123 236000 xsym               LDQ     O1COM+83
        21 003160   000000 136000 15                 SBLQ    BUFFER
        21 003161   000024 756000 0                  STQ     @TABLE+10
        21 003162   000504 236007                    LDQ     324,DL
        21 003163   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003164   000025 756000 0                  STQ     @TABLE+11
        21 003165   000024 236000 0                  LDQ     @TABLE+10
        21 003166   000025 116000 0                  CMPQ    @TABLE+11
        21 003167   003171 604400 21                 TMOZ    s:8154+10
        21 003170   000025 236000 0                  LDQ     @TABLE+11
        21 003171   000007 756000 0                  STQ     SEARCH_SIZE

      642     8155    6                                     %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE);
      643     8156    6                   CALL INSERT(LEX_SYMBOL.SYMBOL,

   8156 21 003172   000000 620006                    EAX0    0,QL
        21 003173   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003174   040046 100400                    MLR     fill='040'O
        21 003175   000010 000001 22                 ADSC9   8                        cn=0,n=1
        21 003176   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

      644     8157    6                               LEX_SYMBOL.SIZE,
      645     8158    6                               SEARCH_SIZE,
      646     8159    6                               ' ');
      647     8160    6                   LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8160 21 003177   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003200   000007 036000 0                  ADLQ    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:209  
        21 003201   000010 756000 6                  STQ     LEX_SYMBOL+8

      648     8161    6                 END;

      649     8162    5             END;

      650     8163    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8163 21 003202   000004 236000 15                 LDQ     BUFFER+4
        21 003203   100000 316003                    CANQ    32768,DU
        21 003204   003214 600000 21                 TZE     s:8170

      651     8164    5             DO;

      652     8165    5               CALL CONTINUE_SINGLE_QUOTED_STRING;

   8165 21 003205   002657 701000 21                 TSX1    CONTINUE_SINGLE_QUOTED_STRING
        21 003206   000000 011000                    NOP     0

      653     8166    5               IF NOT STOP_SCAN_FLAG THEN

   8166 21 003207   000001 234000 0                  SZN     STOP_SCAN_FLAG
        21 003210   003216 604000 21                 TMI     s:8173

      654     8167    5                 BUFFER.COLUMN = BUFFER.COLUMN - 1;

   8167 21 003211   000001 336007                    LCQ     1,DL
        21 003212   000000 056000 15                 ASQ     BUFFER

      655     8168    5             END;

   8168 21 003213   003216 710000 21                 TRA     s:8173

      656     8169    4           ELSE
      657     8170    4             LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   8170 21 003214   000033 235007                    LDA     27,DL
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:210  
        21 003215   000001 755000 6                  STA     LEX_SYMBOL+1

      658     8171
      659     8172    4       END;

      660     8173    3     END;

   8173 21 003216   000001 234000 0                  SZN     STOP_SCAN_FLAG
        21 003217   003005 605000 21                 TPL     s:8089

      661     8174
      662     8175        %CONCAT_SYMBOL;
              8176    3        DO;

              8177    3          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8177 21 003220   000000 236000 15                 LDQ     BUFFER
        21 003221   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 003222   000007 756000 0                  STQ     SEARCH_SIZE

              8178    3          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8178 21 003223   000504 236007                    LDQ     324,DL
        21 003224   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003225   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 003226   003230 605000 21                 TPL     s:8180

              8179    3            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8179 21 003227   000007 756000 0                  STQ     SEARCH_SIZE

              8180    3          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8180 21 003230   000006 470400 15                 LDP0    BUFFER+6
        21 003231   000007 720000 0                  LXL0    SEARCH_SIZE
        21 003232   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 003233   000010 236000 6                  LDQ     LEX_SYMBOL+8
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:211  
        21 003234   040046 100545                    MLR     fill='040'O
        21 003235   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 003236   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8181    3              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8182    3          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8182 21 003237   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003240   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 003241   000010 756000 6                  STQ     LEX_SYMBOL+8

              8183    3          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8183 21 003242   000000 235000 15                 LDA     BUFFER
        21 003243   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8184    3        END;

      663     8186        %MARK_END_OF_SYMBOL;
              8187    3     DO;

              8188    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   8188 21 003244   000007 755000 6                  STA     LEX_SYMBOL+7

              8189    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   8189 21 003245   000002 235000 15                 LDA     BUFFER+2
        21 003246   000006 755000 6                  STA     LEX_SYMBOL+6

              8190    3     END;

      664     8192
      665     8193    2   IF BUFFER.CLASS ~= %SPACE

   8193 21 003247   000001 235000 15                 LDA     BUFFER+1
        21 003250   000042 115007                    CMPA    34,DL
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:212  
        21 003251   003303 600000 21                 TZE     s:8209
        21 003252   000000 115003                    CMPA    0,DU
        21 003253   003303 600000 21                 TZE     s:8209
        21 003254   000035 115007                    CMPA    29,DL
        21 003255   003303 600000 21                 TZE     s:8209
        21 003256   000043 115007                    CMPA    35,DL
        21 003257   003303 600000 21                 TZE     s:8209
        21 003260   000014 115007                    CMPA    12,DL
        21 003261   003303 600000 21                 TZE     s:8209
        21 003262   000007 115007                    CMPA    7,DL
        21 003263   003303 600000 21                 TZE     s:8209
        21 003264   001330 234000 xsym               SZN     O1COM+728
        21 003265   003303 604000 21                 TMI     s:8209
        21 003266   000021 115007                    CMPA    17,DL
        21 003267   003301 601000 21                 TNZ     s:8207
        21 003270   000000 236000 15                 LDQ     BUFFER
        21 003271   000001 036007                    ADLQ    1,DL
        21 003272   000005 116000 15                 CMPQ    BUFFER+5
        21 003273   003301 605000 21                 TPL     s:8207
        21 003274   000000 235000 15                 LDA     BUFFER
        21 003275   040000 106505                    CMPC    fill='040'O
        21 003276   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 003277   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 003300   003303 600000 21                 TZE     s:8209

      666     8194    2        AND BUFFER.CLASS ~= %END_OF_LINE
      667     8195    2        AND BUFFER.CLASS ~= %COMMA
      668     8196    2        AND BUFFER.CLASS ~= %SEMICOLON
      669     8197    2        AND BUFFER.CLASS ~= %PERIOD
      670     8198    2        AND BUFFER.CLASS ~= %RIGHT_PAREN
      671     8199    2        AND NOT O1COM.PSEUDO_TEXT_FLAG
      672     8200    2        AND NOT
      673     8201                     %NEXT_TWO_CHARS_ARE_PSEUDO;
              8202    2     (BUFFER.CLASS = %EQUAL
              8203    2       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8204    2       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
      674     8206    2                                           THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:213  
      675     8207    2     LEX_SYMBOL.B.DELIM_ERROR = TRUE;

   8207 21 003301   400000 236003                    LDQ     -131072,DU
        21 003302   000002 256000 6                  ORSQ    LEX_SYMBOL+2

      676     8208
      677     8209    2   END SCAN_APOSTROPHE_LITERAL;

   8209 21 003303   000022 221200 0                  LDX1  ! @TABLE+8
        21 003304   000001 702211                    TSX2  ! 1,X1

      678     8210        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:214  
      679     8211        %MACRO SCAN_SYMBOL;
      680     8212
      681     8213        /*V*
      682     8214            SCAN_SYMBOL -- Scan the symbol using the first character as a guide
      683     8215                           to its type.
      684     8216        */
      685     8217
      686     8218
      687     8219          DO;
      688     8220
      689     8221              DO CASE (BUFFER.CLASS);
      690     8222
      691     8223                CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE);
      692     8224
      693     8225
      694     8226                  LEX_SYMBOL.TYPE = %USER_WORD;
      695     8227                  %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
      696     8228                  CALL CHECK_NORMAL_SEPARATOR;
      697     8229                  %TRANSLATE_TO_UPPER_CASE;
      698     8230
      699     8231
      700     8232
      701     8233                CASE(%DIGIT);
      702     8234
      703     8235                  LEX_SYMBOL.TYPE = %NUMBER;
      704     8236                  CALL SCAN_NUMERIC_LITERAL;
      705     8237                  IF LEX_SYMBOL.TYPE = %USER_WORD THEN
      706     8238                    %TRANSLATE_TO_UPPER_CASE;
      707     8239
      708     8240
      709     8241               CASE (%PLUS, %MINUS);
      710     8242
      711     8243                 %ADV_BUFFER_COLUMN;
      712     8244                 DO CASE (BUFFER.CLASS);
      713     8245
      714     8246                   CASE (%DIGIT);
      715     8247                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:215  
      716     8248                     CALL SCAN_NUMERIC_LITERAL;
      717     8249
      718     8250                   CASE(%PERIOD);
      719     8251                     %SAVE_RESTART_INFO;
      720     8252                     %CONCAT_SYMBOL;
      721     8253                     %MARK_END_OF_SYMBOL;
      722     8254                     %ADV_BUFFER_COLUMN;
      723     8255                     IF BUFFER.CLASS = %DIGIT THEN
      724     8256                       DO;
      725     8257                         LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      726     8258                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      727     8259                         CALL SCAN_EXPONENT;
      728     8260                       END;
      729     8261                     ELSE
      730     8262                       IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR
      731     8263                              %NEXT_TWO_CHARS_ARE_PSEUDO;
      732     8264                                                           THEN
      733     8265                         DO;
      734     8266                           SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;
      735     8267                         END;
      736     8268                       ELSE
      737     8269                         DO;
      738     8270                           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      739     8271                           CALL CHECK_NORMAL_SEPARATOR;
      740     8272                         END;
      741     8273
      742     8274                   CASE(%COMMA);
      743     8275                     %ADV_BUFFER_COLUMN;
      744     8276                     IF BUFFER.CLASS = %DIGIT THEN
      745     8277                       DO;
      746     8278                         LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      747     8279                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      748     8280                         CALL SCAN_EXPONENT;
      749     8281                       END;
      750     8282                     ELSE
      751     8283                       IF BUFFER.CLASS = %SPACE
      752     8284                              OR BUFFER.CLASS = %END_OF_LINE OR
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:216  
      753     8285                                 %NEXT_TWO_CHARS_ARE_PSEUDO;
      754     8286                                                             THEN
      755     8287                         DO;
      756     8288                           %CONCAT_SYMBOL;
      757     8289                           %MARK_END_OF_SYMBOL;
      758     8290                           LEX_SYMBOL.SIZE = 1;  /* Throw away comma */
      759     8291                         END;
      760     8292                       ELSE
      761     8293                         DO;
      762     8294                           LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      763     8295                           CALL CHECK_NORMAL_SEPARATOR;
      764     8296                         END;
      765     8297
      766     8298                   CASE(ELSE);
      767     8299                     CALL CHECK_NORMAL_SEPARATOR;
      768     8300                 END;
      769     8301
      770     8302
      771     8303               CASE (%PERIOD);
      772     8304
      773     8305                 %ADV_BUFFER_COLUMN;
      774     8306                 IF BUFFER.CLASS = %DIGIT THEN
      775     8307                   DO;
      776     8308                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      777     8309                     %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      778     8310                     CALL SCAN_EXPONENT;
      779     8311                   END;
      780     8312                 ELSE
      781     8313                   IF BUFFER.CLASS = %SPACE
      782     8314                         OR BUFFER.CLASS =%END_OF_LINE OR
      783     8315                            %NEXT_TWO_CHARS_ARE_PSEUDO;
      784     8316                                                       THEN
      785     8317                     DO;
      786     8318                       %CONCAT_SYMBOL;
      787     8319                       %MARK_END_OF_SYMBOL;
      788     8320                     END;
      789     8321                   ELSE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:217  
      790     8322                     DO;
      791     8323                       LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      792     8324                       CALL CHECK_NORMAL_SEPARATOR;
      793     8325                     END;
      794     8326
      795     8327
      796     8328               CASE (%COMMA);
      797     8329
      798     8330                 %ADV_BUFFER_COLUMN;
      799     8331                 IF BUFFER.CLASS = %DIGIT THEN
      800     8332                   DO;
      801     8333                     LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;
      802     8334                     %SCAN_SEARCH (TABLE=DIGIT_SCAN_TABLE);
      803     8335                     CALL SCAN_EXPONENT;
      804     8336                   END;
      805     8337                 ELSE
      806     8338                   IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS =%END_OF_LINE OR
      807     8339                         %NEXT_TWO_CHARS_ARE_PSEUDO;
      808     8340                                                      THEN
      809     8341                     GOTO RESTART_FROM_SEPARATOR;
      810     8342                   ELSE
      811     8343                     DO;
      812     8344                       LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      813     8345                       CALL CHECK_NORMAL_SEPARATOR;
      814     8346                     END;
      815     8347
      816     8348
      817     8349               CASE (%SEMICOLON);
      818     8350
      819     8351                 %ADV_BUFFER_COLUMN;
      820     8352                 IF BUFFER.CLASS =%SPACE
      821     8353                      OR BUFFER.CLASS =%END_OF_LINE OR
      822     8354                            %NEXT_TWO_CHARS_ARE_PSEUDO;
      823     8355                                                    THEN
      824     8356                   GOTO RESTART_FROM_SEPARATOR;
      825     8357                 ELSE
      826     8358                   DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:218  
      827     8359                     LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      828     8360                     CALL CHECK_NORMAL_SEPARATOR;
      829     8361                   END;
      830     8362
      831     8363
      832     8364               CASE (%LEFT_PAREN, %RIGHT_PAREN, %COLON);
      833     8365
      834     8366                 %ADV_BUFFER_COLUMN;
      835     8367                 %CONCAT_SYMBOL;
      836     8368                 %MARK_END_OF_SYMBOL;
      837     8369
      838     8370
      839     8371               CASE (%LESS_THAN);
      840     8372
      841     8373                 %ADV_BUFFER_COLUMN;
      842     8374                 IF BUFFER.CLASS = %EQUAL THEN
      843     8375                   DO;
      844     8376                     LEX_SYMBOL.TYPE = %LESS_THAN_OR_EQUAL;
      845     8377                     %ADV_BUFFER_COLUMN;
      846     8378                   END;
      847     8379                 CALL CHECK_RELATIONAL_SEPARATOR;
      848     8380
      849     8381               CASE (%GREATER_THAN);
      850     8382
      851     8383                 %ADV_BUFFER_COLUMN;
      852     8384                 IF BUFFER.CLASS = %EQUAL THEN
      853     8385                   DO;
      854     8386                     LEX_SYMBOL.TYPE = %GREATER_THAN_OR_EQUAL;
      855     8387                     %ADV_BUFFER_COLUMN;
      856     8388                   END;
      857     8389                 CALL CHECK_RELATIONAL_SEPARATOR;
      858     8390
      859     8391
      860     8392
      861     8393               CASE (%DOUBLE_QUOTE) ;
      862     8394
      863     8395                 CALL SCAN_QUOTE_LITERAL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:219  
      864     8396
      865     8397               CASE(%SINGLE_QUOTE) ;
      866     8398
      867     8399                 CALL SCAN_APOSTROPHE_LITERAL;
      868     8400
      869     8401
      870     8402               CASE (%STAR);
      871     8403
      872     8404                 /*V*
      873     8405                     STAR --
      874     8406                       The line is searched for the next symbol.  If it's another star
      875     8407                       then the entire symbol is an exponentiation otherwise it is
      876     8408                       a multiply.
      877     8409                 */
      878     8410
      879     8411                 %ADV_BUFFER_COLUMN;
      880     8412
      881     8413                 IF BUFFER.CLASS = %STAR THEN
      882     8414                   DO;
      883     8415                     LEX_SYMBOL.TYPE = %STAR_STAR;
      884     8416                     %ADV_BUFFER_COLUMN;
      885     8417                   END;
      886     8418
      887     8419                 CALL CHECK_NORMAL_SEPARATOR;
      888     8420
      889     8421
      890     8422               CASE (%EQUAL);
      891     8423
      892     8424                 /*V*
      893     8425                     EQUAL --
      894     8426                        The line is searched for the next symbol.  If it's an equal sign
      895     8427                        then the entire symbol is a pseudo text symbol otherwise it
      896     8428                        is an equal sign.
      897     8429                 */
      898     8430
      899     8431                 %ADV_BUFFER_COLUMN_THIS_LINE;  /* == must be on same line */
      900     8432
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:220  
      901     8433                 IF BUFFER.CLASS = %EQUAL THEN
      902     8434                   DO;
      903     8435                     LEX_SYMBOL.TYPE = %PSEUDO;
      904     8436                     O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;
      905     8437                     %ADV_BUFFER_COLUMN;
      906     8438                     %CONCAT_SYMBOL;
      907     8439                     %MARK_END_OF_SYMBOL;
      908     8440                   END;
      909     8441                 ELSE
      910     8442                   DO;
      911     8443                     IF BUFFER.CLASS = %END_OF_LINE
      912     8444                          AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
      913     8445                         %ADV_BUFFER_COLUMN_NEXT_LINE;
      914     8446                     CALL CHECK_RELATIONAL_SEPARATOR;
      915     8447                   END;
      916     8448
      917     8449
      918     8450
      919     8451               CASE (%END_OF_FILE);
      920     8452                 /* do nothing */
      921     8453
      922     8454               CASE (%END_OF_LINE);
      923     8455                  /* Do nothing */
      924     8456
      925     8457
      926     8458               CASE (ELSE);
      927     8459
      928     8460                 /*V*
      929     8461                     ELSE --
      930     8462                             This includes parentheses, division, etc.  The
      931     8463                             symbol is built and returned.
      932     8464                 */
      933     8465
      934     8466                 %ADV_BUFFER_COLUMN;
      935     8467                 CALL CHECK_NORMAL_SEPARATOR;
      936     8468             END;
      937     8469
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:221  
      938     8470             IF LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL THEN
      939     8471               %TRANSLATE_TO_UPPER_CASE;
      940     8472
      941     8473          END;  /* SCAN_SYMBOL MACRO */
      942     8474        %MEND;
      943     8475
      944     8476
      945     8477        %EJECT;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:222  
      946     8478        /*V*
      947     8479            MAIN_PROGRAM -- This is the executive driver of the Z8ES module.
      948     8480                            If the end of file has been reached then no further
      949     8481                            scanning is done and we return to the calling routine.
      950     8482                            We scan past all delimiters to reach the first meaningful
      951     8483                            symbol.
      952     8484
      953     8485                            A new source line is loaded if needed and the column
      954     8486                            number and symbol size are initialized.  SCAN is used
      955     8487                            to acquire the symbol and then VERIFY is used to check the
      956     8488                            legality of the symbol.
      957     8489        */
      958     8490
      959     8491        %IF GCOS;
      963     8495        %ENDIF;
      964     8496
      965     8497    1   RESTART_FROM_SEPARATOR:
      966     8498
      967     8499    2     DO CASE (SCANNER_STATE);

   8499 21 003305   000000 235000 10    RESTART_FRO* LDA     SCANNER_STATE
        21 003306   000003 115007                    CMPA    3,DL
        21 003307   003311 602005 21                 TNC     RESTART_FROM_SEPARATOR+4,AL
        21 003310   006575 710000 21                 TRA     s:9635
        21 003311   003314 710000 21                 TRA     s:8503
        21 003312   006410 710000 21                 TRA     s:9553
        21 003313   006442 710000 21                 TRA     s:9574

      968     8500
      969     8501    2       CASE (%SCANNER_STATE_NEW_TOKEN);

      970     8502
      971     8503    2        IF BUFFER.CLASS = %SPACE THEN

   8503 21 003314   000001 236000 15                 LDQ     BUFFER+1
        21 003315   000042 116007                    CMPQ    34,DL
        21 003316   003351 601000 21                 TNZ     s:8527
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:223  

      972     8504               %SCAN_BLANKS;
              8505    3        DO;

              8506               %SCAN_SEARCH(TABLE=BLANK_SCAN_TABLE);
              8507    4     DO;

              8508    4       CALL SEARCH(BUFFER.COLUMN,

   8508 21 003317   000005 236000 15                 LDQ     BUFFER+5
        21 003320   000000 136000 15                 SBLQ    BUFFER
        21 003321   000024 756000 0                  STQ     @TABLE+10
        21 003322   000000 236000 15                 LDQ     BUFFER
        21 003323   000006 470400 15                 LDP0    BUFFER+6
        21 003324   000024 720000 0                  LXL0    @TABLE+10
        21 003325   000000 164546                    TCT
        21 003326   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 003327   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        21 003330   000000 000000 15                 ARG     BUFFER
        21 003331   000000 235000 15                 LDA     BUFFER
        21 003332   000033 771000                    ARL     27
        21 003333   000001 755000 15                 STA     BUFFER+1
        21 003334   000000 551040 15                 STBA    BUFFER,'40'O
        21 003335   000000 056000 15                 ASQ     BUFFER
        21 003336   003340 606400 21                 TTN     s:8515
        21 003337   003351 710000 21                 TRA     s:8527

              8509    4                   BUFFER.CLASS,
              8510    4                   TABLE,
              8511    4                   BUFFER_LINE,
              8512    4                   BUFFER.COLUMN)
              8513    4            WHENALTRETURN
              8514    5              DO;

              8515    5                IF BUFFER.CLASS = %END_OF_LINE

   8515 21 003340   000001 235000 15                 LDA     BUFFER+1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:224  
        21 003341   003351 601000 21                 TNZ     s:8527
        21 003342   000004 236000 15                 LDQ     BUFFER+4
        21 003343   100000 316003                    CANQ    32768,DU
        21 003344   003351 600000 21                 TZE     s:8527

              8516    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8517    5                  CALL CONTINUATION (TABLE);

   8517 21 003345   000013 236000 22                 LDQ     11
        21 003346   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 003347   000002 701000 21                 TSX1    CONTINUATION
        21 003350   000000 011000                    NOP     0

              8518    5              END;

              8519    4     END;

              8521    3        END;

      973     8523
      974     8524             %INITIALIZE_SYMBOL;
              8525    3     DO;

              8526             /* Initialize token */
              8527    3        LEX_SYMBOL.LINE    = BUFFER.ISN;

   8527 21 003351   000002 235000 15                 LDA     BUFFER+2
        21 003352   000004 755000 6                  STA     LEX_SYMBOL+4

              8528    3        LEX_SYMBOL.COLUMN  = BUFFER.COLUMN;

   8528 21 003353   000000 236000 15                 LDQ     BUFFER
        21 003354   000005 756000 6                  STQ     LEX_SYMBOL+5

              8529    3        LEX_SYMBOL.FLAGS   = FALSE;

   8529 21 003355   000002 450000 6                  STZ     LEX_SYMBOL+2
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:225  

              8530    3        LEX_SYMBOL.TYPE    = BUFFER.CLASS;

   8530 21 003356   000001 235000 15                 LDA     BUFFER+1
        21 003357   000001 755000 6                  STA     LEX_SYMBOL+1

              8531    3        LEX_SYMBOL.SIZE    = 0;

   8531 21 003360   000010 450000 6                  STZ     LEX_SYMBOL+8

              8532    3        LEX_SYMBOL.LEVEL  = BUFFER.LEVEL;

   8532 21 003361   000003 235000 15                 LDA     BUFFER+3
        21 003362   000003 755000 6                  STA     LEX_SYMBOL+3

              8533    3        LEX_SYMBOL.NEXT$ = ADDR(NIL);

   8533 21 003363   000014 236000 22                 LDQ     12
        21 003364   000000 756000 6                  STQ     LEX_SYMBOL

              8534    3        LEX_SYMBOL.B.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   8534 21 003365   000004 236000 15                 LDQ     BUFFER+4
        21 003366   000001 772000                    QRL     1
        21 003367   000002 676000 6                  ERQ     LEX_SYMBOL+2
        21 003370   100000 376003                    ANQ     32768,DU
        21 003371   000002 656000 6                  ERSQ    LEX_SYMBOL+2

              8535    3     END;

      975     8537
      976     8538    2        SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8538 21 003372   000000 236000 15                 LDQ     BUFFER
        21 003373   000010 756000 0                  STQ     SYMBOL_START_LOCATION

      977     8539
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:226  
      978     8540             %SCAN_SYMBOL;
              8541        /*V*
              8542            SCAN_SYMBOL -- Scan the symbol using the first character as a guide
              8543                           to its type.
              8544        */
              8545    3     DO;

              8546    4         DO CASE (BUFFER.CLASS);

   8546 21 003374   000001 235000 15                 LDA     BUFFER+1
        21 003375   000044 115007                    CMPA    36,DL
        21 003376   003400 602005 21                 TNC     s:8546+4,AL
        21 003377   006277 710000 21                 TRA     s:9501
        21 003400   006377 710000 21                 TRA     s:9541
        21 003401   006377 710000 21                 TRA     s:9541
        21 003402   003510 710000 21                 TRA     s:8571
        21 003403   005630 710000 21                 TRA     s:9279
        21 003404   005633 710000 21                 TRA     s:9281
        21 003405   003444 710000 21                 TRA     s:8548
        21 003406   005072 710000 21                 TRA     s:9051
        21 003407   005072 710000 21                 TRA     s:9051
        21 003410   005636 710000 21                 TRA     s:9291
        21 003411   006277 710000 21                 TRA     s:9501
        21 003412   003525 710000 21                 TRA     s:8582
        21 003413   003525 710000 21                 TRA     s:8582
        21 003414   004344 710000 21                 TRA     s:8827
        21 003415   006277 710000 21                 TRA     s:9501
        21 003416   005072 710000 21                 TRA     s:9051
        21 003417   005220 710000 21                 TRA     s:9109
        21 003420   006277 710000 21                 TRA     s:9501
        21 003421   006042 710000 21                 TRA     s:9383
        21 003422   005424 710000 21                 TRA     s:9195
        21 003423   006277 710000 21                 TRA     s:9501
        21 003424   006277 710000 21                 TRA     s:9501
        21 003425   006277 710000 21                 TRA     s:9501
        21 003426   006277 710000 21                 TRA     s:9501
        21 003427   006277 710000 21                 TRA     s:9501
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:227  
        21 003430   006277 710000 21                 TRA     s:9501
        21 003431   006277 710000 21                 TRA     s:9501
        21 003432   006277 710000 21                 TRA     s:9501
        21 003433   006277 710000 21                 TRA     s:9501
        21 003434   006277 710000 21                 TRA     s:9501
        21 003435   004561 710000 21                 TRA     s:8921
        21 003436   003444 710000 21                 TRA     s:8548
        21 003437   003444 710000 21                 TRA     s:8548
        21 003440   006277 710000 21                 TRA     s:9501
        21 003441   003444 710000 21                 TRA     s:8548
        21 003442   006277 710000 21                 TRA     s:9501
        21 003443   004746 710000 21                 TRA     s:8996

              8547    4           CASE(%LETTER, %LETTER_E, %DOLLAR, %UNDER_SCORE);

              8548    4             LEX_SYMBOL.TYPE = %USER_WORD;

   8548 21 003444   000005 235007                    LDA     5,DL
        21 003445   000001 755000 6                  STA     LEX_SYMBOL+1

              8549                  %SCAN_SEARCH(TABLE=USERWORD_SCAN_TABLE);
              8550    5     DO;

              8551    5       CALL SEARCH(BUFFER.COLUMN,

   8551 21 003446   000005 236000 15                 LDQ     BUFFER+5
        21 003447   000000 136000 15                 SBLQ    BUFFER
        21 003450   000024 756000 0                  STQ     @TABLE+10
        21 003451   000000 236000 15                 LDQ     BUFFER
        21 003452   000006 470400 15                 LDP0    BUFFER+6
        21 003453   000024 720000 0                  LXL0    @TABLE+10
        21 003454   000000 164546                    TCT
        21 003455   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 003456   000000 000000 xsym               ARG     USERWORD_SCAN_TABLE
        21 003457   000000 000000 15                 ARG     BUFFER
        21 003460   000000 235000 15                 LDA     BUFFER
        21 003461   000033 771000                    ARL     27
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:228  
        21 003462   000001 755000 15                 STA     BUFFER+1
        21 003463   000000 551040 15                 STBA    BUFFER,'40'O
        21 003464   000000 056000 15                 ASQ     BUFFER
        21 003465   003467 606400 21                 TTN     s:8558
        21 003466   003500 710000 21                 TRA     s:8564

              8552    5                   BUFFER.CLASS,
              8553    5                   TABLE,
              8554    5                   BUFFER_LINE,
              8555    5                   BUFFER.COLUMN)
              8556    5            WHENALTRETURN
              8557    6              DO;

              8558    6                IF BUFFER.CLASS = %END_OF_LINE

   8558 21 003467   000001 235000 15                 LDA     BUFFER+1
        21 003470   003500 601000 21                 TNZ     s:8564
        21 003471   000004 236000 15                 LDQ     BUFFER+4
        21 003472   100000 316003                    CANQ    32768,DU
        21 003473   003500 600000 21                 TZE     s:8564

              8559    6                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8560    6                  CALL CONTINUATION (TABLE);

   8560 21 003474   000005 236000 22                 LDQ     5
        21 003475   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 003476   000002 701000 21                 TSX1    CONTINUATION
        21 003477   000000 011000                    NOP     0

              8561    6              END;

              8562    5     END;

              8564    4             CALL CHECK_NORMAL_SEPARATOR;

   8564 21 003500   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 003501   000000 011000                    NOP     0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:229  

              8565                  %TRANSLATE_TO_UPPER_CASE;
              8566    4      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),

   8566 21 003502   000010 720000 6                  LXL0    LEX_SYMBOL+8
        21 003503   040040 160440                    MVT     fill='040'O
        21 003504   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        21 003505   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        21 003506   000000 000000 xsym               ARG     LOWER_TO_UPPER_CASE
        21 003507   006377 710000 21                 TRA     s:9541

              8567    4                 LOWER_TO_UPPER_CASE,
              8568    4                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              8570    4           CASE(%DIGIT);

              8571    4             LEX_SYMBOL.TYPE = %NUMBER;

   8571 21 003510   000025 235007                    LDA     21,DL
        21 003511   000001 755000 6                  STA     LEX_SYMBOL+1

              8572    4             CALL SCAN_NUMERIC_LITERAL;

   8572 21 003512   001265 701000 21                 TSX1    SCAN_NUMERIC_LITERAL
        21 003513   000000 011000                    NOP     0

              8573    4             IF LEX_SYMBOL.TYPE = %USER_WORD THEN

   8573 21 003514   000001 235000 6                  LDA     LEX_SYMBOL+1
        21 003515   000005 115007                    CMPA    5,DL
        21 003516   006377 601000 21                 TNZ     s:9541

              8574                    %TRANSLATE_TO_UPPER_CASE;
              8575    4      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),

   8575 21 003517   000010 720000 6                  LXL0    LEX_SYMBOL+8
        21 003520   040040 160440                    MVT     fill='040'O
        21 003521   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:230  
        21 003522   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        21 003523   000000 000000 xsym               ARG     LOWER_TO_UPPER_CASE
        21 003524   006377 710000 21                 TRA     s:9541

              8576    4                 LOWER_TO_UPPER_CASE,
              8577    4                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              8579    4          CASE (%PLUS, %MINUS);

              8580                 %ADV_BUFFER_COLUMN;
              8581    5     DO;

              8582    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8582 21 003525   000000 054000 15                 AOS     BUFFER

              8583    5       CALL SEARCH(BUFFER.COLUMN,

   8583 21 003526   000005 236000 15                 LDQ     BUFFER+5
        21 003527   000000 136000 15                 SBLQ    BUFFER
        21 003530   000024 756000 0                  STQ     @TABLE+10
        21 003531   000000 236000 15                 LDQ     BUFFER
        21 003532   000006 470400 15                 LDP0    BUFFER+6
        21 003533   000024 720000 0                  LXL0    @TABLE+10
        21 003534   000000 164546                    TCT
        21 003535   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 003536   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 003537   000000 000000 15                 ARG     BUFFER
        21 003540   000000 235000 15                 LDA     BUFFER
        21 003541   000033 771000                    ARL     27
        21 003542   000001 755000 15                 STA     BUFFER+1
        21 003543   000000 551040 15                 STBA    BUFFER,'40'O
        21 003544   000000 056000 15                 ASQ     BUFFER
        21 003545   003547 606400 21                 TTN     s:8590
        21 003546   003623 710000 21                 TRA     s:8620

              8584    5                   BUFFER.CLASS,
              8585    5                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:231  
              8586    5                   BUFFER_LINE,
              8587    5                   BUFFER.COLUMN)
              8588    5        WHENALTRETURN
              8589    6         DO;

              8590    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8590 21 003547   000004 236000 15                 LDQ     BUFFER+4
        21 003550   100000 316003                    CANQ    32768,DU
        21 003551   003623 600000 21                 TZE     s:8620

              8591                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8592    7           DO;

              8593                  %CONCAT_SYMBOL;
              8594    8        DO;

              8595    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8595 21 003552   000000 236000 15                 LDQ     BUFFER
        21 003553   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 003554   000007 756000 0                  STQ     SEARCH_SIZE

              8596    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8596 21 003555   000504 236007                    LDQ     324,DL
        21 003556   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003557   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 003560   003562 605000 21                 TPL     s:8598

              8597    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8597 21 003561   000007 756000 0                  STQ     SEARCH_SIZE

              8598    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8598 21 003562   000006 470400 15                 LDP0    BUFFER+6
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:232  
        21 003563   000007 720000 0                  LXL0    SEARCH_SIZE
        21 003564   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 003565   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003566   040046 100545                    MLR     fill='040'O
        21 003567   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 003570   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8599    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8600    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8600 21 003571   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003572   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 003573   000010 756000 6                  STQ     LEX_SYMBOL+8

              8601    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8601 21 003574   000000 235000 15                 LDA     BUFFER
        21 003575   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8602    8        END;

              8604    7             CALL GET_NEXT_SCANNER_LINE;

   8604 21 003576   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 003577   000000 631400 22                 EPPR1   0
        21 003600   000000 701011                    TSX1    0,X1
        21 003601   000000 011000                    NOP     0

              8605    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8605 21 003602   000000 235000 15                 LDA     BUFFER
        21 003603   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8606                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8607    8     DO;

              8608    8       CALL SEARCH(BUFFER.COLUMN,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:233  

   8608 21 003604   000005 236000 15                 LDQ     BUFFER+5
        21 003605   000000 136000 15                 SBLQ    BUFFER
        21 003606   000024 756000 0                  STQ     @TABLE+10
        21 003607   000000 236000 15                 LDQ     BUFFER
        21 003610   000006 470400 15                 LDP0    BUFFER+6
        21 003611   000024 720000 0                  LXL0    @TABLE+10
        21 003612   000000 164546                    TCT
        21 003613   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 003614   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 003615   000000 000000 15                 ARG     BUFFER
        21 003616   000000 235000 15                 LDA     BUFFER
        21 003617   000033 771000                    ARL     27
        21 003620   000001 755000 15                 STA     BUFFER+1
        21 003621   000000 551040 15                 STBA    BUFFER,'40'O
        21 003622   000000 056000 15                 ASQ     BUFFER

              8609    8                   BUFFER.CLASS,
              8610    8                   TABLE,
              8611    8                   BUFFER_LINE,
              8612    8                   BUFFER.COLUMN);
              8613    8     END;

              8615    7           END;

              8617    6         END;

              8618    5     END;

              8620    5            DO CASE (BUFFER.CLASS);

   8620 21 003623   000001 235000 15                 LDA     BUFFER+1
        21 003624   000036 115007                    CMPA    30,DL
        21 003625   003627 602005 21                 TNC     s:8620+4,AL
        21 003626   004341 710000 21                 TRA     s:8822
        21 003627   004341 710000 21                 TRA     s:8822
        21 003630   004341 710000 21                 TRA     s:8822
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:234  
        21 003631   003665 710000 21                 TRA     s:8622
        21 003632   004341 710000 21                 TRA     s:8822
        21 003633   004341 710000 21                 TRA     s:8822
        21 003634   004341 710000 21                 TRA     s:8822
        21 003635   004341 710000 21                 TRA     s:8822
        21 003636   004341 710000 21                 TRA     s:8822
        21 003637   004341 710000 21                 TRA     s:8822
        21 003640   004341 710000 21                 TRA     s:8822
        21 003641   004341 710000 21                 TRA     s:8822
        21 003642   004341 710000 21                 TRA     s:8822
        21 003643   003672 710000 21                 TRA     s:8627
        21 003644   004341 710000 21                 TRA     s:8822
        21 003645   004341 710000 21                 TRA     s:8822
        21 003646   004341 710000 21                 TRA     s:8822
        21 003647   004341 710000 21                 TRA     s:8822
        21 003650   004341 710000 21                 TRA     s:8822
        21 003651   004341 710000 21                 TRA     s:8822
        21 003652   004341 710000 21                 TRA     s:8822
        21 003653   004341 710000 21                 TRA     s:8822
        21 003654   004341 710000 21                 TRA     s:8822
        21 003655   004341 710000 21                 TRA     s:8822
        21 003656   004341 710000 21                 TRA     s:8822
        21 003657   004341 710000 21                 TRA     s:8822
        21 003660   004341 710000 21                 TRA     s:8822
        21 003661   004341 710000 21                 TRA     s:8822
        21 003662   004341 710000 21                 TRA     s:8822
        21 003663   004341 710000 21                 TRA     s:8822
        21 003664   004122 710000 21                 TRA     s:8729

              8621    5              CASE (%DIGIT);

              8622    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   8622 21 003665   000026 236007                    LDQ     22,DL
        21 003666   000001 756000 6                  STQ     LEX_SYMBOL+1

              8623    5                CALL SCAN_NUMERIC_LITERAL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:235  

   8623 21 003667   001265 701000 21                 TSX1    SCAN_NUMERIC_LITERAL
        21 003670   000000 011000                    NOP     0
        21 003671   006377 710000 21                 TRA     s:9541

              8624    5              CASE(%PERIOD);

              8625                     %SAVE_RESTART_INFO;
              8626    6     DO;

              8627    6       RESTART_INFO.LINE   = BUFFER.ISN;

   8627 21 003672   000002 236000 15                 LDQ     BUFFER+2
        21 003673   000002 756000 0                  STQ     RESTART_INFO

              8628    6       RESTART_INFO.COLUMN = BUFFER.COLUMN;

   8628 21 003674   000000 235000 15                 LDA     BUFFER
        21 003675   000003 755000 0                  STA     RESTART_INFO+1

              8629    6       RESTART_INFO.LEVEL = BUFFER.LEVEL;

   8629 21 003676   000003 235000 15                 LDA     BUFFER+3
        21 003677   000004 755000 0                  STA     RESTART_INFO+2

              8630    6       RESTART_INFO.DEBUG_TOKEN = BUFFER.LINE_TYPE.DEBUG_LINE;

   8630 21 003700   000004 236000 15                 LDQ     BUFFER+4
        21 003701   000001 736000                    QLS     1
        21 003702   400000 376003                    ANQ     -131072,DU
        21 003703   000005 756000 0                  STQ     RESTART_INFO+3

              8631    6     END;

              8633                     %CONCAT_SYMBOL;
              8634    6        DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:236  
              8635    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8635 21 003704   000000 236000 15                 LDQ     BUFFER
        21 003705   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 003706   000007 756000 0                  STQ     SEARCH_SIZE

              8636    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8636 21 003707   000504 236007                    LDQ     324,DL
        21 003710   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003711   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 003712   003714 605000 21                 TPL     s:8638

              8637    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8637 21 003713   000007 756000 0                  STQ     SEARCH_SIZE

              8638    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8638 21 003714   000006 470400 15                 LDP0    BUFFER+6
        21 003715   000007 720000 0                  LXL0    SEARCH_SIZE
        21 003716   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 003717   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003720   040046 100545                    MLR     fill='040'O
        21 003721   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 003722   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8639    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8640    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8640 21 003723   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003724   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 003725   000010 756000 6                  STQ     LEX_SYMBOL+8

              8641    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8641 21 003726   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:237  
        21 003727   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8642    6        END;

              8644                     %MARK_END_OF_SYMBOL;
              8645    6     DO;

              8646    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   8646 21 003730   000007 755000 6                  STA     LEX_SYMBOL+7

              8647    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   8647 21 003731   000002 235000 15                 LDA     BUFFER+2
        21 003732   000006 755000 6                  STA     LEX_SYMBOL+6

              8648    6     END;

              8650                     %ADV_BUFFER_COLUMN;
              8651    6     DO;

              8652    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8652 21 003733   000000 054000 15                 AOS     BUFFER

              8653    6       CALL SEARCH(BUFFER.COLUMN,

   8653 21 003734   000005 236000 15                 LDQ     BUFFER+5
        21 003735   000000 136000 15                 SBLQ    BUFFER
        21 003736   000024 756000 0                  STQ     @TABLE+10
        21 003737   000000 236000 15                 LDQ     BUFFER
        21 003740   000024 721000 0                  LXL1    @TABLE+10
        21 003741   000000 164546                    TCT
        21 003742   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        21 003743   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 003744   000000 000000 15                 ARG     BUFFER
        21 003745   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:238  
        21 003746   000033 771000                    ARL     27
        21 003747   000001 755000 15                 STA     BUFFER+1
        21 003750   000000 551040 15                 STBA    BUFFER,'40'O
        21 003751   000000 056000 15                 ASQ     BUFFER
        21 003752   003754 606400 21                 TTN     s:8660
        21 003753   004030 710000 21                 TRA     s:8690

              8654    6                   BUFFER.CLASS,
              8655    6                   TABLE,
              8656    6                   BUFFER_LINE,
              8657    6                   BUFFER.COLUMN)
              8658    6        WHENALTRETURN
              8659    7         DO;

              8660    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8660 21 003754   000004 236000 15                 LDQ     BUFFER+4
        21 003755   100000 316003                    CANQ    32768,DU
        21 003756   004030 600000 21                 TZE     s:8690

              8661                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8662    8           DO;

              8663                  %CONCAT_SYMBOL;
              8664    9        DO;

              8665    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8665 21 003757   000000 236000 15                 LDQ     BUFFER
        21 003760   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 003761   000007 756000 0                  STQ     SEARCH_SIZE

              8666    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8666 21 003762   000504 236007                    LDQ     324,DL
        21 003763   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 003764   000007 116000 0                  CMPQ    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:239  
        21 003765   003767 605000 21                 TPL     s:8668

              8667    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8667 21 003766   000007 756000 0                  STQ     SEARCH_SIZE

              8668    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8668 21 003767   000006 470400 15                 LDP0    BUFFER+6
        21 003770   000007 720000 0                  LXL0    SEARCH_SIZE
        21 003771   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 003772   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003773   040046 100545                    MLR     fill='040'O
        21 003774   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 003775   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8669    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8670    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8670 21 003776   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 003777   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004000   000010 756000 6                  STQ     LEX_SYMBOL+8

              8671    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8671 21 004001   000000 235000 15                 LDA     BUFFER
        21 004002   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8672    9        END;

              8674    8             CALL GET_NEXT_SCANNER_LINE;

   8674 21 004003   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 004004   000000 631400 22                 EPPR1   0
        21 004005   000000 701011                    TSX1    0,X1
        21 004006   000000 011000                    NOP     0

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:240  
              8675    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8675 21 004007   000000 235000 15                 LDA     BUFFER
        21 004010   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8676                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8677    9     DO;

              8678    9       CALL SEARCH(BUFFER.COLUMN,

   8678 21 004011   000005 236000 15                 LDQ     BUFFER+5
        21 004012   000000 136000 15                 SBLQ    BUFFER
        21 004013   000024 756000 0                  STQ     @TABLE+10
        21 004014   000000 236000 15                 LDQ     BUFFER
        21 004015   000006 470400 15                 LDP0    BUFFER+6
        21 004016   000024 720000 0                  LXL0    @TABLE+10
        21 004017   000000 164546                    TCT
        21 004020   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004021   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004022   000000 000000 15                 ARG     BUFFER
        21 004023   000000 235000 15                 LDA     BUFFER
        21 004024   000033 771000                    ARL     27
        21 004025   000001 755000 15                 STA     BUFFER+1
        21 004026   000000 551040 15                 STBA    BUFFER,'40'O
        21 004027   000000 056000 15                 ASQ     BUFFER

              8679    9                   BUFFER.CLASS,
              8680    9                   TABLE,
              8681    9                   BUFFER_LINE,
              8682    9                   BUFFER.COLUMN);
              8683    9     END;

              8685    8           END;

              8687    7         END;

              8688    6     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:241  

              8690    5                IF BUFFER.CLASS = %DIGIT THEN

   8690 21 004030   000001 235000 15                 LDA     BUFFER+1
        21 004031   000002 115007                    CMPA    2,DL
        21 004032   004072 601000 21                 TNZ     s:8711

              8691    6                  DO;

              8692    6                    LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   8692 21 004033   000026 236007                    LDQ     22,DL
        21 004034   000001 756000 6                  STQ     LEX_SYMBOL+1

              8693                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8694    7     DO;

              8695    7       CALL SEARCH(BUFFER.COLUMN,

   8695 21 004035   000005 236000 15                 LDQ     BUFFER+5
        21 004036   000000 136000 15                 SBLQ    BUFFER
        21 004037   000024 756000 0                  STQ     @TABLE+10
        21 004040   000000 236000 15                 LDQ     BUFFER
        21 004041   000006 470400 15                 LDP0    BUFFER+6
        21 004042   000024 720000 0                  LXL0    @TABLE+10
        21 004043   000000 164546                    TCT
        21 004044   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004045   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 004046   000000 000000 15                 ARG     BUFFER
        21 004047   000000 235000 15                 LDA     BUFFER
        21 004050   000033 771000                    ARL     27
        21 004051   000001 755000 15                 STA     BUFFER+1
        21 004052   000000 551040 15                 STBA    BUFFER,'40'O
        21 004053   000000 056000 15                 ASQ     BUFFER
        21 004054   004056 606400 21                 TTN     s:8702
        21 004055   004067 710000 21                 TRA     s:8708

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:242  
              8696    7                   BUFFER.CLASS,
              8697    7                   TABLE,
              8698    7                   BUFFER_LINE,
              8699    7                   BUFFER.COLUMN)
              8700    7            WHENALTRETURN
              8701    8              DO;

              8702    8                IF BUFFER.CLASS = %END_OF_LINE

   8702 21 004056   000001 235000 15                 LDA     BUFFER+1
        21 004057   004067 601000 21                 TNZ     s:8708
        21 004060   000004 236000 15                 LDQ     BUFFER+4
        21 004061   100000 316003                    CANQ    32768,DU
        21 004062   004067 600000 21                 TZE     s:8708

              8703    8                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8704    8                  CALL CONTINUATION (TABLE);

   8704 21 004063   000004 236000 22                 LDQ     4
        21 004064   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 004065   000002 701000 21                 TSX1    CONTINUATION
        21 004066   000000 011000                    NOP     0

              8705    8              END;

              8706    7     END;

              8708    6                    CALL SCAN_EXPONENT;

   8708 21 004067   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 004070   000000 011000                    NOP     0

              8709    6                  END;

   8709 21 004071   006377 710000 21                 TRA     s:9541

              8710    5                ELSE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:243  
              8711    5                  IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS = %END_OF_LINE OR

   8711 21 004072   000042 115007                    CMPA    34,DL
        21 004073   004112 600000 21                 TZE     s:8719
        21 004074   000000 115003                    CMPA    0,DU
        21 004075   004112 600000 21                 TZE     s:8719
        21 004076   000021 115007                    CMPA    17,DL
        21 004077   004115 601000 21                 TNZ     s:8723
        21 004100   000000 236000 15                 LDQ     BUFFER
        21 004101   000001 036007                    ADLQ    1,DL
        21 004102   000005 116000 15                 CMPQ    BUFFER+5
        21 004103   004115 605000 21                 TPL     s:8723
        21 004104   000006 470400 15                 LDP0    BUFFER+6
        21 004105   000000 235000 15                 LDA     BUFFER
        21 004106   040000 106505                    CMPC    fill='040'O
        21 004107   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 004110   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 004111   004115 601000 21                 TNZ     s:8723

              8712                              %NEXT_TWO_CHARS_ARE_PSEUDO;
              8713    5     (BUFFER.CLASS = %EQUAL
              8714    5       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8715    5       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8717    5                                                      THEN
              8718    6                    DO;

              8719    6                      SCANNER_STATE = %SCANNER_STATE_RESTART_PERIOD;

   8719 21 004112   000001 235007                    LDA     1,DL
        21 004113   000000 755000 10                 STA     SCANNER_STATE

              8720    6                    END;

   8720 21 004114   006377 710000 21                 TRA     s:9541

              8721    5                  ELSE
              8722    6                    DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:244  

              8723    6                      LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   8723 21 004115   000033 235007                    LDA     27,DL
        21 004116   000001 755000 6                  STA     LEX_SYMBOL+1

              8724    6                      CALL CHECK_NORMAL_SEPARATOR;

   8724 21 004117   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 004120   000000 011000                    NOP     0

              8725    6                    END;

   8725 21 004121   006377 710000 21                 TRA     s:9541

              8726    5              CASE(%COMMA);

              8727                     %ADV_BUFFER_COLUMN;
              8728    6     DO;

              8729    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8729 21 004122   000000 054000 15                 AOS     BUFFER

              8730    6       CALL SEARCH(BUFFER.COLUMN,

   8730 21 004123   000005 236000 15                 LDQ     BUFFER+5
        21 004124   000000 136000 15                 SBLQ    BUFFER
        21 004125   000024 756000 0                  STQ     @TABLE+10
        21 004126   000000 236000 15                 LDQ     BUFFER
        21 004127   000006 470400 15                 LDP0    BUFFER+6
        21 004130   000024 720000 0                  LXL0    @TABLE+10
        21 004131   000000 164546                    TCT
        21 004132   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004133   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004134   000000 000000 15                 ARG     BUFFER
        21 004135   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:245  
        21 004136   000033 771000                    ARL     27
        21 004137   000001 755000 15                 STA     BUFFER+1
        21 004140   000000 551040 15                 STBA    BUFFER,'40'O
        21 004141   000000 056000 15                 ASQ     BUFFER
        21 004142   004144 606400 21                 TTN     s:8737
        21 004143   004220 710000 21                 TRA     s:8767

              8731    6                   BUFFER.CLASS,
              8732    6                   TABLE,
              8733    6                   BUFFER_LINE,
              8734    6                   BUFFER.COLUMN)
              8735    6        WHENALTRETURN
              8736    7         DO;

              8737    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8737 21 004144   000004 236000 15                 LDQ     BUFFER+4
        21 004145   100000 316003                    CANQ    32768,DU
        21 004146   004220 600000 21                 TZE     s:8767

              8738                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8739    8           DO;

              8740                  %CONCAT_SYMBOL;
              8741    9        DO;

              8742    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8742 21 004147   000000 236000 15                 LDQ     BUFFER
        21 004150   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004151   000007 756000 0                  STQ     SEARCH_SIZE

              8743    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8743 21 004152   000504 236007                    LDQ     324,DL
        21 004153   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 004154   000007 116000 0                  CMPQ    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:246  
        21 004155   004157 605000 21                 TPL     s:8745

              8744    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8744 21 004156   000007 756000 0                  STQ     SEARCH_SIZE

              8745    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8745 21 004157   000006 470400 15                 LDP0    BUFFER+6
        21 004160   000007 720000 0                  LXL0    SEARCH_SIZE
        21 004161   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 004162   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004163   040046 100545                    MLR     fill='040'O
        21 004164   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 004165   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8746    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8747    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8747 21 004166   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004167   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004170   000010 756000 6                  STQ     LEX_SYMBOL+8

              8748    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8748 21 004171   000000 235000 15                 LDA     BUFFER
        21 004172   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8749    9        END;

              8751    8             CALL GET_NEXT_SCANNER_LINE;

   8751 21 004173   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 004174   000000 631400 22                 EPPR1   0
        21 004175   000000 701011                    TSX1    0,X1
        21 004176   000000 011000                    NOP     0

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:247  
              8752    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8752 21 004177   000000 235000 15                 LDA     BUFFER
        21 004200   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8753                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8754    9     DO;

              8755    9       CALL SEARCH(BUFFER.COLUMN,

   8755 21 004201   000005 236000 15                 LDQ     BUFFER+5
        21 004202   000000 136000 15                 SBLQ    BUFFER
        21 004203   000024 756000 0                  STQ     @TABLE+10
        21 004204   000000 236000 15                 LDQ     BUFFER
        21 004205   000006 470400 15                 LDP0    BUFFER+6
        21 004206   000024 720000 0                  LXL0    @TABLE+10
        21 004207   000000 164546                    TCT
        21 004210   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004211   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004212   000000 000000 15                 ARG     BUFFER
        21 004213   000000 235000 15                 LDA     BUFFER
        21 004214   000033 771000                    ARL     27
        21 004215   000001 755000 15                 STA     BUFFER+1
        21 004216   000000 551040 15                 STBA    BUFFER,'40'O
        21 004217   000000 056000 15                 ASQ     BUFFER

              8756    9                   BUFFER.CLASS,
              8757    9                   TABLE,
              8758    9                   BUFFER_LINE,
              8759    9                   BUFFER.COLUMN);
              8760    9     END;

              8762    8           END;

              8764    7         END;

              8765    6     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:248  

              8767    5                IF BUFFER.CLASS = %DIGIT THEN

   8767 21 004220   000001 235000 15                 LDA     BUFFER+1
        21 004221   000002 115007                    CMPA    2,DL
        21 004222   004262 601000 21                 TNZ     s:8788

              8768    6                  DO;

              8769    6                    LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   8769 21 004223   000026 236007                    LDQ     22,DL
        21 004224   000001 756000 6                  STQ     LEX_SYMBOL+1

              8770                         %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8771    7     DO;

              8772    7       CALL SEARCH(BUFFER.COLUMN,

   8772 21 004225   000005 236000 15                 LDQ     BUFFER+5
        21 004226   000000 136000 15                 SBLQ    BUFFER
        21 004227   000024 756000 0                  STQ     @TABLE+10
        21 004230   000000 236000 15                 LDQ     BUFFER
        21 004231   000006 470400 15                 LDP0    BUFFER+6
        21 004232   000024 720000 0                  LXL0    @TABLE+10
        21 004233   000000 164546                    TCT
        21 004234   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004235   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 004236   000000 000000 15                 ARG     BUFFER
        21 004237   000000 235000 15                 LDA     BUFFER
        21 004240   000033 771000                    ARL     27
        21 004241   000001 755000 15                 STA     BUFFER+1
        21 004242   000000 551040 15                 STBA    BUFFER,'40'O
        21 004243   000000 056000 15                 ASQ     BUFFER
        21 004244   004246 606400 21                 TTN     s:8779
        21 004245   004257 710000 21                 TRA     s:8785

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:249  
              8773    7                   BUFFER.CLASS,
              8774    7                   TABLE,
              8775    7                   BUFFER_LINE,
              8776    7                   BUFFER.COLUMN)
              8777    7            WHENALTRETURN
              8778    8              DO;

              8779    8                IF BUFFER.CLASS = %END_OF_LINE

   8779 21 004246   000001 235000 15                 LDA     BUFFER+1
        21 004247   004257 601000 21                 TNZ     s:8785
        21 004250   000004 236000 15                 LDQ     BUFFER+4
        21 004251   100000 316003                    CANQ    32768,DU
        21 004252   004257 600000 21                 TZE     s:8785

              8780    8                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8781    8                  CALL CONTINUATION (TABLE);

   8781 21 004253   000004 236000 22                 LDQ     4
        21 004254   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 004255   000002 701000 21                 TSX1    CONTINUATION
        21 004256   000000 011000                    NOP     0

              8782    8              END;

              8783    7     END;

              8785    6                    CALL SCAN_EXPONENT;

   8785 21 004257   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 004260   000000 011000                    NOP     0

              8786    6                  END;

   8786 21 004261   006377 710000 21                 TRA     s:9541

              8787    5                ELSE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:250  
              8788    5                  IF BUFFER.CLASS = %SPACE

   8788 21 004262   000042 115007                    CMPA    34,DL
        21 004263   004302 600000 21                 TZE     s:8799
        21 004264   000000 115003                    CMPA    0,DU
        21 004265   004302 600000 21                 TZE     s:8799
        21 004266   000021 115007                    CMPA    17,DL
        21 004267   004334 601000 21                 TNZ     s:8818
        21 004270   000000 236000 15                 LDQ     BUFFER
        21 004271   000001 036007                    ADLQ    1,DL
        21 004272   000005 116000 15                 CMPQ    BUFFER+5
        21 004273   004334 605000 21                 TPL     s:8818
        21 004274   000006 470400 15                 LDP0    BUFFER+6
        21 004275   000000 235000 15                 LDA     BUFFER
        21 004276   040000 106505                    CMPC    fill='040'O
        21 004277   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 004300   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 004301   004334 601000 21                 TNZ     s:8818

              8789    5                         OR BUFFER.CLASS = %END_OF_LINE OR
              8790                                 %NEXT_TWO_CHARS_ARE_PSEUDO;
              8791    5     (BUFFER.CLASS = %EQUAL
              8792    5       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8793    5       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8795    5                                                        THEN
              8796    6                    DO;

              8797                           %CONCAT_SYMBOL;
              8798    7        DO;

              8799    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8799 21 004302   000000 236000 15                 LDQ     BUFFER
        21 004303   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004304   000007 756000 0                  STQ     SEARCH_SIZE

              8800    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:251  

   8800 21 004305   000504 236007                    LDQ     324,DL
        21 004306   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 004307   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 004310   004312 605000 21                 TPL     s:8802

              8801    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8801 21 004311   000007 756000 0                  STQ     SEARCH_SIZE

              8802    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8802 21 004312   000006 470400 15                 LDP0    BUFFER+6
        21 004313   000007 720000 0                  LXL0    SEARCH_SIZE
        21 004314   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 004315   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004316   040046 100545                    MLR     fill='040'O
        21 004317   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 004320   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8803    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8804    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8804 21 004321   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004322   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004323   000010 756000 6                  STQ     LEX_SYMBOL+8

              8805    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8805 21 004324   000000 235000 15                 LDA     BUFFER
        21 004325   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8806    7        END;

              8808                           %MARK_END_OF_SYMBOL;
              8809    7     DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:252  
              8810    7       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   8810 21 004326   000007 755000 6                  STA     LEX_SYMBOL+7

              8811    7       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   8811 21 004327   000002 235000 15                 LDA     BUFFER+2
        21 004330   000006 755000 6                  STA     LEX_SYMBOL+6

              8812    7     END;

              8814    6                      LEX_SYMBOL.SIZE = 1;  /* Throw away comma */

   8814 21 004331   000001 235007                    LDA     1,DL
        21 004332   000010 755000 6                  STA     LEX_SYMBOL+8

              8815    6                    END;

   8815 21 004333   006377 710000 21                 TRA     s:9541

              8816    5                  ELSE
              8817    6                    DO;

              8818    6                      LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   8818 21 004334   000033 235007                    LDA     27,DL
        21 004335   000001 755000 6                  STA     LEX_SYMBOL+1

              8819    6                      CALL CHECK_NORMAL_SEPARATOR;

   8819 21 004336   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 004337   000000 011000                    NOP     0

              8820    6                    END;

   8820 21 004340   006377 710000 21                 TRA     s:9541

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:253  
              8821    5              CASE(ELSE);

              8822    5                CALL CHECK_NORMAL_SEPARATOR;

   8822 21 004341   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 004342   000000 011000                    NOP     0

              8823    5            END;

   8823 21 004343   006377 710000 21                 TRA     s:9541

              8824    4          CASE (%PERIOD);

              8825                 %ADV_BUFFER_COLUMN;
              8826    5     DO;

              8827    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8827 21 004344   000000 054000 15                 AOS     BUFFER

              8828    5       CALL SEARCH(BUFFER.COLUMN,

   8828 21 004345   000005 236000 15                 LDQ     BUFFER+5
        21 004346   000000 136000 15                 SBLQ    BUFFER
        21 004347   000024 756000 0                  STQ     @TABLE+10
        21 004350   000000 236000 15                 LDQ     BUFFER
        21 004351   000006 470400 15                 LDP0    BUFFER+6
        21 004352   000024 720000 0                  LXL0    @TABLE+10
        21 004353   000000 164546                    TCT
        21 004354   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004355   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004356   000000 000000 15                 ARG     BUFFER
        21 004357   000000 235000 15                 LDA     BUFFER
        21 004360   000033 771000                    ARL     27
        21 004361   000001 755000 15                 STA     BUFFER+1
        21 004362   000000 551040 15                 STBA    BUFFER,'40'O
        21 004363   000000 056000 15                 ASQ     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:254  
        21 004364   004366 606400 21                 TTN     s:8835
        21 004365   004442 710000 21                 TRA     s:8865

              8829    5                   BUFFER.CLASS,
              8830    5                   TABLE,
              8831    5                   BUFFER_LINE,
              8832    5                   BUFFER.COLUMN)
              8833    5        WHENALTRETURN
              8834    6         DO;

              8835    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8835 21 004366   000004 236000 15                 LDQ     BUFFER+4
        21 004367   100000 316003                    CANQ    32768,DU
        21 004370   004442 600000 21                 TZE     s:8865

              8836                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8837    7           DO;

              8838                  %CONCAT_SYMBOL;
              8839    8        DO;

              8840    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8840 21 004371   000000 236000 15                 LDQ     BUFFER
        21 004372   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004373   000007 756000 0                  STQ     SEARCH_SIZE

              8841    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8841 21 004374   000504 236007                    LDQ     324,DL
        21 004375   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 004376   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 004377   004401 605000 21                 TPL     s:8843

              8842    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:255  
   8842 21 004400   000007 756000 0                  STQ     SEARCH_SIZE

              8843    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8843 21 004401   000006 470400 15                 LDP0    BUFFER+6
        21 004402   000007 720000 0                  LXL0    SEARCH_SIZE
        21 004403   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 004404   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004405   040046 100545                    MLR     fill='040'O
        21 004406   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 004407   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8844    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8845    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8845 21 004410   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004411   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004412   000010 756000 6                  STQ     LEX_SYMBOL+8

              8846    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8846 21 004413   000000 235000 15                 LDA     BUFFER
        21 004414   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8847    8        END;

              8849    7             CALL GET_NEXT_SCANNER_LINE;

   8849 21 004415   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 004416   000000 631400 22                 EPPR1   0
        21 004417   000000 701011                    TSX1    0,X1
        21 004420   000000 011000                    NOP     0

              8850    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8850 21 004421   000000 235000 15                 LDA     BUFFER
        21 004422   000010 755000 0                  STA     SYMBOL_START_LOCATION
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:256  

              8851                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8852    8     DO;

              8853    8       CALL SEARCH(BUFFER.COLUMN,

   8853 21 004423   000005 236000 15                 LDQ     BUFFER+5
        21 004424   000000 136000 15                 SBLQ    BUFFER
        21 004425   000024 756000 0                  STQ     @TABLE+10
        21 004426   000000 236000 15                 LDQ     BUFFER
        21 004427   000006 470400 15                 LDP0    BUFFER+6
        21 004430   000024 720000 0                  LXL0    @TABLE+10
        21 004431   000000 164546                    TCT
        21 004432   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004433   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004434   000000 000000 15                 ARG     BUFFER
        21 004435   000000 235000 15                 LDA     BUFFER
        21 004436   000033 771000                    ARL     27
        21 004437   000001 755000 15                 STA     BUFFER+1
        21 004440   000000 551040 15                 STBA    BUFFER,'40'O
        21 004441   000000 056000 15                 ASQ     BUFFER

              8854    8                   BUFFER.CLASS,
              8855    8                   TABLE,
              8856    8                   BUFFER_LINE,
              8857    8                   BUFFER.COLUMN);
              8858    8     END;

              8860    7           END;

              8862    6         END;

              8863    5     END;

              8865    4            IF BUFFER.CLASS = %DIGIT THEN

   8865 21 004442   000001 235000 15                 LDA     BUFFER+1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:257  
        21 004443   000002 115007                    CMPA    2,DL
        21 004444   004504 601000 21                 TNZ     s:8886

              8866    5              DO;

              8867    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   8867 21 004445   000026 236007                    LDQ     22,DL
        21 004446   000001 756000 6                  STQ     LEX_SYMBOL+1

              8868                     %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
              8869    6     DO;

              8870    6       CALL SEARCH(BUFFER.COLUMN,

   8870 21 004447   000005 236000 15                 LDQ     BUFFER+5
        21 004450   000000 136000 15                 SBLQ    BUFFER
        21 004451   000024 756000 0                  STQ     @TABLE+10
        21 004452   000000 236000 15                 LDQ     BUFFER
        21 004453   000006 470400 15                 LDP0    BUFFER+6
        21 004454   000024 720000 0                  LXL0    @TABLE+10
        21 004455   000000 164546                    TCT
        21 004456   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004457   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 004460   000000 000000 15                 ARG     BUFFER
        21 004461   000000 235000 15                 LDA     BUFFER
        21 004462   000033 771000                    ARL     27
        21 004463   000001 755000 15                 STA     BUFFER+1
        21 004464   000000 551040 15                 STBA    BUFFER,'40'O
        21 004465   000000 056000 15                 ASQ     BUFFER
        21 004466   004470 606400 21                 TTN     s:8877
        21 004467   004501 710000 21                 TRA     s:8883

              8871    6                   BUFFER.CLASS,
              8872    6                   TABLE,
              8873    6                   BUFFER_LINE,
              8874    6                   BUFFER.COLUMN)
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:258  
              8875    6            WHENALTRETURN
              8876    7              DO;

              8877    7                IF BUFFER.CLASS = %END_OF_LINE

   8877 21 004470   000001 235000 15                 LDA     BUFFER+1
        21 004471   004501 601000 21                 TNZ     s:8883
        21 004472   000004 236000 15                 LDQ     BUFFER+4
        21 004473   100000 316003                    CANQ    32768,DU
        21 004474   004501 600000 21                 TZE     s:8883

              8878    7                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8879    7                  CALL CONTINUATION (TABLE);

   8879 21 004475   000004 236000 22                 LDQ     4
        21 004476   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 004477   000002 701000 21                 TSX1    CONTINUATION
        21 004500   000000 011000                    NOP     0

              8880    7              END;

              8881    6     END;

              8883    5                CALL SCAN_EXPONENT;

   8883 21 004501   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 004502   000000 011000                    NOP     0

              8884    5              END;

   8884 21 004503   006377 710000 21                 TRA     s:9541

              8885    4            ELSE
              8886    4              IF BUFFER.CLASS = %SPACE

   8886 21 004504   000042 115007                    CMPA    34,DL
        21 004505   004524 600000 21                 TZE     s:8897
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:259  
        21 004506   000000 115003                    CMPA    0,DU
        21 004507   004524 600000 21                 TZE     s:8897
        21 004510   000021 115007                    CMPA    17,DL
        21 004511   004554 601000 21                 TNZ     s:8915
        21 004512   000000 236000 15                 LDQ     BUFFER
        21 004513   000001 036007                    ADLQ    1,DL
        21 004514   000005 116000 15                 CMPQ    BUFFER+5
        21 004515   004554 605000 21                 TPL     s:8915
        21 004516   000006 470400 15                 LDP0    BUFFER+6
        21 004517   000000 235000 15                 LDA     BUFFER
        21 004520   040000 106505                    CMPC    fill='040'O
        21 004521   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 004522   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 004523   004554 601000 21                 TNZ     s:8915

              8887    4                    OR BUFFER.CLASS =%END_OF_LINE OR
              8888                            %NEXT_TWO_CHARS_ARE_PSEUDO;
              8889    4     (BUFFER.CLASS = %EQUAL
              8890    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8891    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8893    4                                                  THEN
              8894    5                DO;

              8895                       %CONCAT_SYMBOL;
              8896    6        DO;

              8897    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8897 21 004524   000000 236000 15                 LDQ     BUFFER
        21 004525   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004526   000007 756000 0                  STQ     SEARCH_SIZE

              8898    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8898 21 004527   000504 236007                    LDQ     324,DL
        21 004530   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 004531   000007 116000 0                  CMPQ    SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:260  
        21 004532   004534 605000 21                 TPL     s:8900

              8899    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8899 21 004533   000007 756000 0                  STQ     SEARCH_SIZE

              8900    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8900 21 004534   000006 470400 15                 LDP0    BUFFER+6
        21 004535   000007 720000 0                  LXL0    SEARCH_SIZE
        21 004536   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 004537   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004540   040046 100545                    MLR     fill='040'O
        21 004541   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 004542   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8901    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8902    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8902 21 004543   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004544   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004545   000010 756000 6                  STQ     LEX_SYMBOL+8

              8903    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8903 21 004546   000000 235000 15                 LDA     BUFFER
        21 004547   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8904    6        END;

              8906                       %MARK_END_OF_SYMBOL;
              8907    6     DO;

              8908    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   8908 21 004550   000007 755000 6                  STA     LEX_SYMBOL+7

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:261  
              8909    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   8909 21 004551   000002 235000 15                 LDA     BUFFER+2
        21 004552   000006 755000 6                  STA     LEX_SYMBOL+6

              8910    6     END;

              8912    5                END;

   8912 21 004553   006377 710000 21                 TRA     s:9541

              8913    4              ELSE
              8914    5                DO;

              8915    5                  LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   8915 21 004554   000033 235007                    LDA     27,DL
        21 004555   000001 755000 6                  STA     LEX_SYMBOL+1

              8916    5                  CALL CHECK_NORMAL_SEPARATOR;

   8916 21 004556   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 004557   000000 011000                    NOP     0

              8917    5                END;

   8917 21 004560   006377 710000 21                 TRA     s:9541

              8918    4          CASE (%COMMA);

              8919                 %ADV_BUFFER_COLUMN;
              8920    5     DO;

              8921    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8921 21 004561   000000 054000 15                 AOS     BUFFER

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:262  
              8922    5       CALL SEARCH(BUFFER.COLUMN,

   8922 21 004562   000005 236000 15                 LDQ     BUFFER+5
        21 004563   000000 136000 15                 SBLQ    BUFFER
        21 004564   000024 756000 0                  STQ     @TABLE+10
        21 004565   000000 236000 15                 LDQ     BUFFER
        21 004566   000006 470400 15                 LDP0    BUFFER+6
        21 004567   000024 720000 0                  LXL0    @TABLE+10
        21 004570   000000 164546                    TCT
        21 004571   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004572   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004573   000000 000000 15                 ARG     BUFFER
        21 004574   000000 235000 15                 LDA     BUFFER
        21 004575   000033 771000                    ARL     27
        21 004576   000001 755000 15                 STA     BUFFER+1
        21 004577   000000 551040 15                 STBA    BUFFER,'40'O
        21 004600   000000 056000 15                 ASQ     BUFFER
        21 004601   004603 606400 21                 TTN     s:8929
        21 004602   004657 710000 21                 TRA     s:8959

              8923    5                   BUFFER.CLASS,
              8924    5                   TABLE,
              8925    5                   BUFFER_LINE,
              8926    5                   BUFFER.COLUMN)
              8927    5        WHENALTRETURN
              8928    6         DO;

              8929    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   8929 21 004603   000004 236000 15                 LDQ     BUFFER+4
        21 004604   100000 316003                    CANQ    32768,DU
        21 004605   004657 600000 21                 TZE     s:8959

              8930                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              8931    7           DO;

              8932                  %CONCAT_SYMBOL;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:263  
              8933    8        DO;

              8934    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   8934 21 004606   000000 236000 15                 LDQ     BUFFER
        21 004607   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004610   000007 756000 0                  STQ     SEARCH_SIZE

              8935    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   8935 21 004611   000504 236007                    LDQ     324,DL
        21 004612   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 004613   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 004614   004616 605000 21                 TPL     s:8937

              8936    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   8936 21 004615   000007 756000 0                  STQ     SEARCH_SIZE

              8937    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   8937 21 004616   000006 470400 15                 LDP0    BUFFER+6
        21 004617   000007 720000 0                  LXL0    SEARCH_SIZE
        21 004620   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 004621   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004622   040046 100545                    MLR     fill='040'O
        21 004623   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 004624   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              8938    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              8939    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   8939 21 004625   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 004626   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 004627   000010 756000 6                  STQ     LEX_SYMBOL+8

              8940    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:264  

   8940 21 004630   000000 235000 15                 LDA     BUFFER
        21 004631   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8941    8        END;

              8943    7             CALL GET_NEXT_SCANNER_LINE;

   8943 21 004632   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 004633   000000 631400 22                 EPPR1   0
        21 004634   000000 701011                    TSX1    0,X1
        21 004635   000000 011000                    NOP     0

              8944    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   8944 21 004636   000000 235000 15                 LDA     BUFFER
        21 004637   000010 755000 0                  STA     SYMBOL_START_LOCATION

              8945                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              8946    8     DO;

              8947    8       CALL SEARCH(BUFFER.COLUMN,

   8947 21 004640   000005 236000 15                 LDQ     BUFFER+5
        21 004641   000000 136000 15                 SBLQ    BUFFER
        21 004642   000024 756000 0                  STQ     @TABLE+10
        21 004643   000000 236000 15                 LDQ     BUFFER
        21 004644   000006 470400 15                 LDP0    BUFFER+6
        21 004645   000024 720000 0                  LXL0    @TABLE+10
        21 004646   000000 164546                    TCT
        21 004647   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004650   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004651   000000 000000 15                 ARG     BUFFER
        21 004652   000000 235000 15                 LDA     BUFFER
        21 004653   000033 771000                    ARL     27
        21 004654   000001 755000 15                 STA     BUFFER+1
        21 004655   000000 551040 15                 STBA    BUFFER,'40'O
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:265  
        21 004656   000000 056000 15                 ASQ     BUFFER

              8948    8                   BUFFER.CLASS,
              8949    8                   TABLE,
              8950    8                   BUFFER_LINE,
              8951    8                   BUFFER.COLUMN);
              8952    8     END;

              8954    7           END;

              8956    6         END;

              8957    5     END;

              8959    4            IF BUFFER.CLASS = %DIGIT THEN

   8959 21 004657   000001 235000 15                 LDA     BUFFER+1
        21 004660   000002 115007                    CMPA    2,DL
        21 004661   004721 601000 21                 TNZ     s:8980

              8960    5              DO;

              8961    5                LEX_SYMBOL.TYPE = %NUMERIC_LITERAL;

   8961 21 004662   000026 236007                    LDQ     22,DL
        21 004663   000001 756000 6                  STQ     LEX_SYMBOL+1

              8962                     %SCAN_SEARCH (TABLE=DIGIT_SCAN_TABLE);
              8963    6     DO;

              8964    6       CALL SEARCH(BUFFER.COLUMN,

   8964 21 004664   000005 236000 15                 LDQ     BUFFER+5
        21 004665   000000 136000 15                 SBLQ    BUFFER
        21 004666   000024 756000 0                  STQ     @TABLE+10
        21 004667   000000 236000 15                 LDQ     BUFFER
        21 004670   000006 470400 15                 LDP0    BUFFER+6
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:266  
        21 004671   000024 720000 0                  LXL0    @TABLE+10
        21 004672   000000 164546                    TCT
        21 004673   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 004674   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        21 004675   000000 000000 15                 ARG     BUFFER
        21 004676   000000 235000 15                 LDA     BUFFER
        21 004677   000033 771000                    ARL     27
        21 004700   000001 755000 15                 STA     BUFFER+1
        21 004701   000000 551040 15                 STBA    BUFFER,'40'O
        21 004702   000000 056000 15                 ASQ     BUFFER
        21 004703   004705 606400 21                 TTN     s:8971
        21 004704   004716 710000 21                 TRA     s:8977

              8965    6                   BUFFER.CLASS,
              8966    6                   TABLE,
              8967    6                   BUFFER_LINE,
              8968    6                   BUFFER.COLUMN)
              8969    6            WHENALTRETURN
              8970    7              DO;

              8971    7                IF BUFFER.CLASS = %END_OF_LINE

   8971 21 004705   000001 235000 15                 LDA     BUFFER+1
        21 004706   004716 601000 21                 TNZ     s:8977
        21 004707   000004 236000 15                 LDQ     BUFFER+4
        21 004710   100000 316003                    CANQ    32768,DU
        21 004711   004716 600000 21                 TZE     s:8977

              8972    7                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              8973    7                  CALL CONTINUATION (TABLE);

   8973 21 004712   000004 236000 22                 LDQ     4
        21 004713   000012 756000 0                  STQ     SYMBOL_START_LOCATION+2
        21 004714   000002 701000 21                 TSX1    CONTINUATION
        21 004715   000000 011000                    NOP     0

              8974    7              END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:267  

              8975    6     END;

              8977    5                CALL SCAN_EXPONENT;

   8977 21 004716   001012 701000 21                 TSX1    SCAN_EXPONENT
        21 004717   000000 011000                    NOP     0

              8978    5              END;

   8978 21 004720   006377 710000 21                 TRA     s:9541

              8979    4            ELSE
              8980    4              IF BUFFER.CLASS = %SPACE OR BUFFER.CLASS =%END_OF_LINE OR

   8980 21 004721   000042 115007                    CMPA    34,DL
        21 004722   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR
        21 004723   000000 115003                    CMPA    0,DU
        21 004724   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR
        21 004725   000021 115007                    CMPA    17,DL
        21 004726   004741 601000 21                 TNZ     s:8990
        21 004727   000000 236000 15                 LDQ     BUFFER
        21 004730   000001 036007                    ADLQ    1,DL
        21 004731   000005 116000 15                 CMPQ    BUFFER+5
        21 004732   004741 605000 21                 TPL     s:8990
        21 004733   000006 470400 15                 LDP0    BUFFER+6
        21 004734   000000 235000 15                 LDA     BUFFER
        21 004735   040000 106505                    CMPC    fill='040'O
        21 004736   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 004737   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 004740   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR

              8981                         %NEXT_TWO_CHARS_ARE_PSEUDO;
              8982    4     (BUFFER.CLASS = %EQUAL
              8983    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              8984    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              8986    4                                                 THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:268  
              8987    4                GOTO RESTART_FROM_SEPARATOR;
              8988    4              ELSE
              8989    5                DO;

              8990    5                  LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   8990 21 004741   000033 235007                    LDA     27,DL
        21 004742   000001 755000 6                  STA     LEX_SYMBOL+1

              8991    5                  CALL CHECK_NORMAL_SEPARATOR;

   8991 21 004743   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 004744   000000 011000                    NOP     0

              8992    5                END;

   8992 21 004745   006377 710000 21                 TRA     s:9541

              8993    4          CASE (%SEMICOLON);

              8994                 %ADV_BUFFER_COLUMN;
              8995    5     DO;

              8996    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   8996 21 004746   000000 054000 15                 AOS     BUFFER

              8997    5       CALL SEARCH(BUFFER.COLUMN,

   8997 21 004747   000005 236000 15                 LDQ     BUFFER+5
        21 004750   000000 136000 15                 SBLQ    BUFFER
        21 004751   000024 756000 0                  STQ     @TABLE+10
        21 004752   000000 236000 15                 LDQ     BUFFER
        21 004753   000006 470400 15                 LDP0    BUFFER+6
        21 004754   000024 720000 0                  LXL0    @TABLE+10
        21 004755   000000 164546                    TCT
        21 004756   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:269  
        21 004757   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 004760   000000 000000 15                 ARG     BUFFER
        21 004761   000000 235000 15                 LDA     BUFFER
        21 004762   000033 771000                    ARL     27
        21 004763   000001 755000 15                 STA     BUFFER+1
        21 004764   000000 551040 15                 STBA    BUFFER,'40'O
        21 004765   000000 056000 15                 ASQ     BUFFER
        21 004766   004770 606400 21                 TTN     s:9004
        21 004767   005044 710000 21                 TRA     s:9034

              8998    5                   BUFFER.CLASS,
              8999    5                   TABLE,
              9000    5                   BUFFER_LINE,
              9001    5                   BUFFER.COLUMN)
              9002    5        WHENALTRETURN
              9003    6         DO;

              9004    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9004 21 004770   000004 236000 15                 LDQ     BUFFER+4
        21 004771   100000 316003                    CANQ    32768,DU
        21 004772   005044 600000 21                 TZE     s:9034

              9005                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9006    7           DO;

              9007                  %CONCAT_SYMBOL;
              9008    8        DO;

              9009    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9009 21 004773   000000 236000 15                 LDQ     BUFFER
        21 004774   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 004775   000007 756000 0                  STQ     SEARCH_SIZE

              9010    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:270  
   9010 21 004776   000504 236007                    LDQ     324,DL
        21 004777   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005000   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005001   005003 605000 21                 TPL     s:9012

              9011    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9011 21 005002   000007 756000 0                  STQ     SEARCH_SIZE

              9012    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9012 21 005003   000006 470400 15                 LDP0    BUFFER+6
        21 005004   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005005   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005006   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005007   040046 100545                    MLR     fill='040'O
        21 005010   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005011   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9013    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9014    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9014 21 005012   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005013   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005014   000010 756000 6                  STQ     LEX_SYMBOL+8

              9015    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9015 21 005015   000000 235000 15                 LDA     BUFFER
        21 005016   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9016    8        END;

              9018    7             CALL GET_NEXT_SCANNER_LINE;

   9018 21 005017   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005020   000000 631400 22                 EPPR1   0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:271  
        21 005021   000000 701011                    TSX1    0,X1
        21 005022   000000 011000                    NOP     0

              9019    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9019 21 005023   000000 235000 15                 LDA     BUFFER
        21 005024   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9020                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9021    8     DO;

              9022    8       CALL SEARCH(BUFFER.COLUMN,

   9022 21 005025   000005 236000 15                 LDQ     BUFFER+5
        21 005026   000000 136000 15                 SBLQ    BUFFER
        21 005027   000024 756000 0                  STQ     @TABLE+10
        21 005030   000000 236000 15                 LDQ     BUFFER
        21 005031   000006 470400 15                 LDP0    BUFFER+6
        21 005032   000024 720000 0                  LXL0    @TABLE+10
        21 005033   000000 164546                    TCT
        21 005034   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005035   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005036   000000 000000 15                 ARG     BUFFER
        21 005037   000000 235000 15                 LDA     BUFFER
        21 005040   000033 771000                    ARL     27
        21 005041   000001 755000 15                 STA     BUFFER+1
        21 005042   000000 551040 15                 STBA    BUFFER,'40'O
        21 005043   000000 056000 15                 ASQ     BUFFER

              9023    8                   BUFFER.CLASS,
              9024    8                   TABLE,
              9025    8                   BUFFER_LINE,
              9026    8                   BUFFER.COLUMN);
              9027    8     END;

              9029    7           END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:272  
              9031    6         END;

              9032    5     END;

              9034    4            IF BUFFER.CLASS =%SPACE

   9034 21 005044   000001 235000 15                 LDA     BUFFER+1
        21 005045   000042 115007                    CMPA    34,DL
        21 005046   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR
        21 005047   000000 115003                    CMPA    0,DU
        21 005050   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR
        21 005051   000021 115007                    CMPA    17,DL
        21 005052   005065 601000 21                 TNZ     s:9045
        21 005053   000000 236000 15                 LDQ     BUFFER
        21 005054   000001 036007                    ADLQ    1,DL
        21 005055   000005 116000 15                 CMPQ    BUFFER+5
        21 005056   005065 605000 21                 TPL     s:9045
        21 005057   000006 470400 15                 LDP0    BUFFER+6
        21 005060   000000 235000 15                 LDA     BUFFER
        21 005061   040000 106505                    CMPC    fill='040'O
        21 005062   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
        21 005063   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 005064   003305 600000 21                 TZE     RESTART_FROM_SEPARATOR

              9035    4                 OR BUFFER.CLASS =%END_OF_LINE OR
              9036                            %NEXT_TWO_CHARS_ARE_PSEUDO;
              9037    4     (BUFFER.CLASS = %EQUAL
              9038    4       AND BUFFER.COLUMN+1 < BUFFER.LINE_LENGTH
              9039    4       AND SUBSTR(BUFFER_LINE, BUFFER.COLUMN+1, 1) = '=')
              9041    4                                               THEN
              9042    4              GOTO RESTART_FROM_SEPARATOR;
              9043    4            ELSE
              9044    5              DO;

              9045    5                LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

   9045 21 005065   000033 235007                    LDA     27,DL
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:273  
        21 005066   000001 755000 6                  STA     LEX_SYMBOL+1

              9046    5                CALL CHECK_NORMAL_SEPARATOR;

   9046 21 005067   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 005070   000000 011000                    NOP     0

              9047    5              END;

   9047 21 005071   006377 710000 21                 TRA     s:9541

              9048    4          CASE (%LEFT_PAREN, %RIGHT_PAREN, %COLON);

              9049                 %ADV_BUFFER_COLUMN;
              9050    5     DO;

              9051    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9051 21 005072   000000 054000 15                 AOS     BUFFER

              9052    5       CALL SEARCH(BUFFER.COLUMN,

   9052 21 005073   000005 236000 15                 LDQ     BUFFER+5
        21 005074   000000 136000 15                 SBLQ    BUFFER
        21 005075   000024 756000 0                  STQ     @TABLE+10
        21 005076   000000 236000 15                 LDQ     BUFFER
        21 005077   000006 470400 15                 LDP0    BUFFER+6
        21 005100   000024 720000 0                  LXL0    @TABLE+10
        21 005101   000000 164546                    TCT
        21 005102   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005103   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005104   000000 000000 15                 ARG     BUFFER
        21 005105   000000 235000 15                 LDA     BUFFER
        21 005106   000033 771000                    ARL     27
        21 005107   000001 755000 15                 STA     BUFFER+1
        21 005110   000000 551040 15                 STBA    BUFFER,'40'O
        21 005111   000000 056000 15                 ASQ     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:274  
        21 005112   005114 606400 21                 TTN     s:9059
        21 005113   005170 710000 21                 TRA     s:9091

              9053    5                   BUFFER.CLASS,
              9054    5                   TABLE,
              9055    5                   BUFFER_LINE,
              9056    5                   BUFFER.COLUMN)
              9057    5        WHENALTRETURN
              9058    6         DO;

              9059    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9059 21 005114   000004 236000 15                 LDQ     BUFFER+4
        21 005115   100000 316003                    CANQ    32768,DU
        21 005116   005170 600000 21                 TZE     s:9091

              9060                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9061    7           DO;

              9062                  %CONCAT_SYMBOL;
              9063    8        DO;

              9064    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9064 21 005117   000000 236000 15                 LDQ     BUFFER
        21 005120   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005121   000007 756000 0                  STQ     SEARCH_SIZE

              9065    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9065 21 005122   000504 236007                    LDQ     324,DL
        21 005123   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005124   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005125   005127 605000 21                 TPL     s:9067

              9066    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:275  
   9066 21 005126   000007 756000 0                  STQ     SEARCH_SIZE

              9067    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9067 21 005127   000006 470400 15                 LDP0    BUFFER+6
        21 005130   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005131   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005132   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005133   040046 100545                    MLR     fill='040'O
        21 005134   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005135   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9068    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9069    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9069 21 005136   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005137   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005140   000010 756000 6                  STQ     LEX_SYMBOL+8

              9070    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9070 21 005141   000000 235000 15                 LDA     BUFFER
        21 005142   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9071    8        END;

              9073    7             CALL GET_NEXT_SCANNER_LINE;

   9073 21 005143   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005144   000000 631400 22                 EPPR1   0
        21 005145   000000 701011                    TSX1    0,X1
        21 005146   000000 011000                    NOP     0

              9074    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9074 21 005147   000000 235000 15                 LDA     BUFFER
        21 005150   000010 755000 0                  STA     SYMBOL_START_LOCATION
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:276  

              9075                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9076    8     DO;

              9077    8       CALL SEARCH(BUFFER.COLUMN,

   9077 21 005151   000005 236000 15                 LDQ     BUFFER+5
        21 005152   000000 136000 15                 SBLQ    BUFFER
        21 005153   000024 756000 0                  STQ     @TABLE+10
        21 005154   000000 236000 15                 LDQ     BUFFER
        21 005155   000006 470400 15                 LDP0    BUFFER+6
        21 005156   000024 720000 0                  LXL0    @TABLE+10
        21 005157   000000 164546                    TCT
        21 005160   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005161   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005162   000000 000000 15                 ARG     BUFFER
        21 005163   000000 235000 15                 LDA     BUFFER
        21 005164   000033 771000                    ARL     27
        21 005165   000001 755000 15                 STA     BUFFER+1
        21 005166   000000 551040 15                 STBA    BUFFER,'40'O
        21 005167   000000 056000 15                 ASQ     BUFFER

              9078    8                   BUFFER.CLASS,
              9079    8                   TABLE,
              9080    8                   BUFFER_LINE,
              9081    8                   BUFFER.COLUMN);
              9082    8     END;

              9084    7           END;

              9086    6         END;

              9087    5     END;

              9089                 %CONCAT_SYMBOL;
              9090    5        DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:277  
              9091    5          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9091 21 005170   000000 236000 15                 LDQ     BUFFER
        21 005171   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005172   000007 756000 0                  STQ     SEARCH_SIZE

              9092    5          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9092 21 005173   000504 236007                    LDQ     324,DL
        21 005174   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005175   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005176   005200 605000 21                 TPL     s:9094

              9093    5            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9093 21 005177   000007 756000 0                  STQ     SEARCH_SIZE

              9094    5          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9094 21 005200   000006 470400 15                 LDP0    BUFFER+6
        21 005201   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005202   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005203   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005204   040046 100545                    MLR     fill='040'O
        21 005205   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005206   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9095    5              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9096    5          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9096 21 005207   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005210   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005211   000010 756000 6                  STQ     LEX_SYMBOL+8

              9097    5          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9097 21 005212   000000 235000 15                 LDA     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:278  
        21 005213   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9098    5        END;

              9100                 %MARK_END_OF_SYMBOL;
              9101    5     DO;

              9102    5       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   9102 21 005214   000007 755000 6                  STA     LEX_SYMBOL+7

              9103    5       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   9103 21 005215   000002 235000 15                 LDA     BUFFER+2
        21 005216   000006 755000 6                  STA     LEX_SYMBOL+6

              9104    5     END;

   9104 21 005217   006377 710000 21                 TRA     s:9541

              9106    4          CASE (%LESS_THAN);

              9107                 %ADV_BUFFER_COLUMN;
              9108    5     DO;

              9109    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9109 21 005220   000000 054000 15                 AOS     BUFFER

              9110    5       CALL SEARCH(BUFFER.COLUMN,

   9110 21 005221   000005 236000 15                 LDQ     BUFFER+5
        21 005222   000000 136000 15                 SBLQ    BUFFER
        21 005223   000024 756000 0                  STQ     @TABLE+10
        21 005224   000000 236000 15                 LDQ     BUFFER
        21 005225   000006 470400 15                 LDP0    BUFFER+6
        21 005226   000024 720000 0                  LXL0    @TABLE+10
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:279  
        21 005227   000000 164546                    TCT
        21 005230   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005231   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005232   000000 000000 15                 ARG     BUFFER
        21 005233   000000 235000 15                 LDA     BUFFER
        21 005234   000033 771000                    ARL     27
        21 005235   000001 755000 15                 STA     BUFFER+1
        21 005236   000000 551040 15                 STBA    BUFFER,'40'O
        21 005237   000000 056000 15                 ASQ     BUFFER
        21 005240   005242 606400 21                 TTN     s:9117
        21 005241   005316 710000 21                 TRA     s:9147

              9111    5                   BUFFER.CLASS,
              9112    5                   TABLE,
              9113    5                   BUFFER_LINE,
              9114    5                   BUFFER.COLUMN)
              9115    5        WHENALTRETURN
              9116    6         DO;

              9117    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9117 21 005242   000004 236000 15                 LDQ     BUFFER+4
        21 005243   100000 316003                    CANQ    32768,DU
        21 005244   005316 600000 21                 TZE     s:9147

              9118                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9119    7           DO;

              9120                  %CONCAT_SYMBOL;
              9121    8        DO;

              9122    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9122 21 005245   000000 236000 15                 LDQ     BUFFER
        21 005246   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005247   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:280  
              9123    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9123 21 005250   000504 236007                    LDQ     324,DL
        21 005251   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005252   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005253   005255 605000 21                 TPL     s:9125

              9124    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9124 21 005254   000007 756000 0                  STQ     SEARCH_SIZE

              9125    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9125 21 005255   000006 470400 15                 LDP0    BUFFER+6
        21 005256   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005257   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005260   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005261   040046 100545                    MLR     fill='040'O
        21 005262   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005263   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9126    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9127    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9127 21 005264   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005265   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005266   000010 756000 6                  STQ     LEX_SYMBOL+8

              9128    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9128 21 005267   000000 235000 15                 LDA     BUFFER
        21 005270   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9129    8        END;

              9131    7             CALL GET_NEXT_SCANNER_LINE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:281  
   9131 21 005271   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005272   000000 631400 22                 EPPR1   0
        21 005273   000000 701011                    TSX1    0,X1
        21 005274   000000 011000                    NOP     0

              9132    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9132 21 005275   000000 235000 15                 LDA     BUFFER
        21 005276   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9133                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9134    8     DO;

              9135    8       CALL SEARCH(BUFFER.COLUMN,

   9135 21 005277   000005 236000 15                 LDQ     BUFFER+5
        21 005300   000000 136000 15                 SBLQ    BUFFER
        21 005301   000024 756000 0                  STQ     @TABLE+10
        21 005302   000000 236000 15                 LDQ     BUFFER
        21 005303   000006 470400 15                 LDP0    BUFFER+6
        21 005304   000024 720000 0                  LXL0    @TABLE+10
        21 005305   000000 164546                    TCT
        21 005306   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005307   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005310   000000 000000 15                 ARG     BUFFER
        21 005311   000000 235000 15                 LDA     BUFFER
        21 005312   000033 771000                    ARL     27
        21 005313   000001 755000 15                 STA     BUFFER+1
        21 005314   000000 551040 15                 STBA    BUFFER,'40'O
        21 005315   000000 056000 15                 ASQ     BUFFER

              9136    8                   BUFFER.CLASS,
              9137    8                   TABLE,
              9138    8                   BUFFER_LINE,
              9139    8                   BUFFER.COLUMN);
              9140    8     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:282  
              9142    7           END;

              9144    6         END;

              9145    5     END;

              9147    4            IF BUFFER.CLASS = %EQUAL THEN

   9147 21 005316   000001 235000 15                 LDA     BUFFER+1
        21 005317   000021 115007                    CMPA    17,DL
        21 005320   005421 601000 21                 TNZ     s:9191

              9148    5              DO;

              9149    5                LEX_SYMBOL.TYPE = %LESS_THAN_OR_EQUAL;

   9149 21 005321   000020 236007                    LDQ     16,DL
        21 005322   000001 756000 6                  STQ     LEX_SYMBOL+1

              9150                     %ADV_BUFFER_COLUMN;
              9151    6     DO;

              9152    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9152 21 005323   000000 054000 15                 AOS     BUFFER

              9153    6       CALL SEARCH(BUFFER.COLUMN,

   9153 21 005324   000005 236000 15                 LDQ     BUFFER+5
        21 005325   000000 136000 15                 SBLQ    BUFFER
        21 005326   000024 756000 0                  STQ     @TABLE+10
        21 005327   000000 236000 15                 LDQ     BUFFER
        21 005330   000006 470400 15                 LDP0    BUFFER+6
        21 005331   000024 720000 0                  LXL0    @TABLE+10
        21 005332   000000 164546                    TCT
        21 005333   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005334   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:283  
        21 005335   000000 000000 15                 ARG     BUFFER
        21 005336   000000 235000 15                 LDA     BUFFER
        21 005337   000033 771000                    ARL     27
        21 005340   000001 755000 15                 STA     BUFFER+1
        21 005341   000000 551040 15                 STBA    BUFFER,'40'O
        21 005342   000000 056000 15                 ASQ     BUFFER
        21 005343   005345 606400 21                 TTN     s:9160
        21 005344   005421 710000 21                 TRA     s:9191

              9154    6                   BUFFER.CLASS,
              9155    6                   TABLE,
              9156    6                   BUFFER_LINE,
              9157    6                   BUFFER.COLUMN)
              9158    6        WHENALTRETURN
              9159    7         DO;

              9160    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9160 21 005345   000004 236000 15                 LDQ     BUFFER+4
        21 005346   100000 316003                    CANQ    32768,DU
        21 005347   005421 600000 21                 TZE     s:9191

              9161                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9162    8           DO;

              9163                  %CONCAT_SYMBOL;
              9164    9        DO;

              9165    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9165 21 005350   000000 236000 15                 LDQ     BUFFER
        21 005351   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005352   000007 756000 0                  STQ     SEARCH_SIZE

              9166    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9166 21 005353   000504 236007                    LDQ     324,DL
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:284  
        21 005354   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005355   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005356   005360 605000 21                 TPL     s:9168

              9167    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9167 21 005357   000007 756000 0                  STQ     SEARCH_SIZE

              9168    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9168 21 005360   000006 470400 15                 LDP0    BUFFER+6
        21 005361   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005362   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005363   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005364   040046 100545                    MLR     fill='040'O
        21 005365   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005366   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9169    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9170    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9170 21 005367   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005370   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005371   000010 756000 6                  STQ     LEX_SYMBOL+8

              9171    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9171 21 005372   000000 235000 15                 LDA     BUFFER
        21 005373   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9172    9        END;

              9174    8             CALL GET_NEXT_SCANNER_LINE;

   9174 21 005374   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005375   000000 631400 22                 EPPR1   0
        21 005376   000000 701011                    TSX1    0,X1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:285  
        21 005377   000000 011000                    NOP     0

              9175    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9175 21 005400   000000 235000 15                 LDA     BUFFER
        21 005401   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9176                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9177    9     DO;

              9178    9       CALL SEARCH(BUFFER.COLUMN,

   9178 21 005402   000005 236000 15                 LDQ     BUFFER+5
        21 005403   000000 136000 15                 SBLQ    BUFFER
        21 005404   000024 756000 0                  STQ     @TABLE+10
        21 005405   000000 236000 15                 LDQ     BUFFER
        21 005406   000006 470400 15                 LDP0    BUFFER+6
        21 005407   000024 720000 0                  LXL0    @TABLE+10
        21 005410   000000 164546                    TCT
        21 005411   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005412   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005413   000000 000000 15                 ARG     BUFFER
        21 005414   000000 235000 15                 LDA     BUFFER
        21 005415   000033 771000                    ARL     27
        21 005416   000001 755000 15                 STA     BUFFER+1
        21 005417   000000 551040 15                 STBA    BUFFER,'40'O
        21 005420   000000 056000 15                 ASQ     BUFFER

              9179    9                   BUFFER.CLASS,
              9180    9                   TABLE,
              9181    9                   BUFFER_LINE,
              9182    9                   BUFFER.COLUMN);
              9183    9     END;

              9185    8           END;

              9187    7         END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:286  

              9188    6     END;

              9190    5              END;

              9191    4            CALL CHECK_RELATIONAL_SEPARATOR;

   9191 21 005421   000067 701000 21                 TSX1    CHECK_RELATIONAL_SEPARATOR
        21 005422   000000 011000                    NOP     0
        21 005423   006377 710000 21                 TRA     s:9541

              9192    4          CASE (%GREATER_THAN);

              9193                 %ADV_BUFFER_COLUMN;
              9194    5     DO;

              9195    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9195 21 005424   000000 054000 15                 AOS     BUFFER

              9196    5       CALL SEARCH(BUFFER.COLUMN,

   9196 21 005425   000005 236000 15                 LDQ     BUFFER+5
        21 005426   000000 136000 15                 SBLQ    BUFFER
        21 005427   000024 756000 0                  STQ     @TABLE+10
        21 005430   000000 236000 15                 LDQ     BUFFER
        21 005431   000006 470400 15                 LDP0    BUFFER+6
        21 005432   000024 720000 0                  LXL0    @TABLE+10
        21 005433   000000 164546                    TCT
        21 005434   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005435   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005436   000000 000000 15                 ARG     BUFFER
        21 005437   000000 235000 15                 LDA     BUFFER
        21 005440   000033 771000                    ARL     27
        21 005441   000001 755000 15                 STA     BUFFER+1
        21 005442   000000 551040 15                 STBA    BUFFER,'40'O
        21 005443   000000 056000 15                 ASQ     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:287  
        21 005444   005446 606400 21                 TTN     s:9203
        21 005445   005522 710000 21                 TRA     s:9233

              9197    5                   BUFFER.CLASS,
              9198    5                   TABLE,
              9199    5                   BUFFER_LINE,
              9200    5                   BUFFER.COLUMN)
              9201    5        WHENALTRETURN
              9202    6         DO;

              9203    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9203 21 005446   000004 236000 15                 LDQ     BUFFER+4
        21 005447   100000 316003                    CANQ    32768,DU
        21 005450   005522 600000 21                 TZE     s:9233

              9204                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9205    7           DO;

              9206                  %CONCAT_SYMBOL;
              9207    8        DO;

              9208    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9208 21 005451   000000 236000 15                 LDQ     BUFFER
        21 005452   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005453   000007 756000 0                  STQ     SEARCH_SIZE

              9209    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9209 21 005454   000504 236007                    LDQ     324,DL
        21 005455   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005456   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005457   005461 605000 21                 TPL     s:9211

              9210    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:288  
   9210 21 005460   000007 756000 0                  STQ     SEARCH_SIZE

              9211    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9211 21 005461   000006 470400 15                 LDP0    BUFFER+6
        21 005462   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005463   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005464   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005465   040046 100545                    MLR     fill='040'O
        21 005466   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005467   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9212    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9213    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9213 21 005470   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005471   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005472   000010 756000 6                  STQ     LEX_SYMBOL+8

              9214    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9214 21 005473   000000 235000 15                 LDA     BUFFER
        21 005474   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9215    8        END;

              9217    7             CALL GET_NEXT_SCANNER_LINE;

   9217 21 005475   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005476   000000 631400 22                 EPPR1   0
        21 005477   000000 701011                    TSX1    0,X1
        21 005500   000000 011000                    NOP     0

              9218    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9218 21 005501   000000 235000 15                 LDA     BUFFER
        21 005502   000010 755000 0                  STA     SYMBOL_START_LOCATION
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:289  

              9219                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9220    8     DO;

              9221    8       CALL SEARCH(BUFFER.COLUMN,

   9221 21 005503   000005 236000 15                 LDQ     BUFFER+5
        21 005504   000000 136000 15                 SBLQ    BUFFER
        21 005505   000024 756000 0                  STQ     @TABLE+10
        21 005506   000000 236000 15                 LDQ     BUFFER
        21 005507   000006 470400 15                 LDP0    BUFFER+6
        21 005510   000024 720000 0                  LXL0    @TABLE+10
        21 005511   000000 164546                    TCT
        21 005512   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005513   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005514   000000 000000 15                 ARG     BUFFER
        21 005515   000000 235000 15                 LDA     BUFFER
        21 005516   000033 771000                    ARL     27
        21 005517   000001 755000 15                 STA     BUFFER+1
        21 005520   000000 551040 15                 STBA    BUFFER,'40'O
        21 005521   000000 056000 15                 ASQ     BUFFER

              9222    8                   BUFFER.CLASS,
              9223    8                   TABLE,
              9224    8                   BUFFER_LINE,
              9225    8                   BUFFER.COLUMN);
              9226    8     END;

              9228    7           END;

              9230    6         END;

              9231    5     END;

              9233    4            IF BUFFER.CLASS = %EQUAL THEN

   9233 21 005522   000001 235000 15                 LDA     BUFFER+1
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:290  
        21 005523   000021 115007                    CMPA    17,DL
        21 005524   005625 601000 21                 TNZ     s:9277

              9234    5              DO;

              9235    5                LEX_SYMBOL.TYPE = %GREATER_THAN_OR_EQUAL;

   9235 21 005525   000023 236007                    LDQ     19,DL
        21 005526   000001 756000 6                  STQ     LEX_SYMBOL+1

              9236                     %ADV_BUFFER_COLUMN;
              9237    6     DO;

              9238    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9238 21 005527   000000 054000 15                 AOS     BUFFER

              9239    6       CALL SEARCH(BUFFER.COLUMN,

   9239 21 005530   000005 236000 15                 LDQ     BUFFER+5
        21 005531   000000 136000 15                 SBLQ    BUFFER
        21 005532   000024 756000 0                  STQ     @TABLE+10
        21 005533   000000 236000 15                 LDQ     BUFFER
        21 005534   000006 470400 15                 LDP0    BUFFER+6
        21 005535   000024 720000 0                  LXL0    @TABLE+10
        21 005536   000000 164546                    TCT
        21 005537   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005540   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005541   000000 000000 15                 ARG     BUFFER
        21 005542   000000 235000 15                 LDA     BUFFER
        21 005543   000033 771000                    ARL     27
        21 005544   000001 755000 15                 STA     BUFFER+1
        21 005545   000000 551040 15                 STBA    BUFFER,'40'O
        21 005546   000000 056000 15                 ASQ     BUFFER
        21 005547   005551 606400 21                 TTN     s:9246
        21 005550   005625 710000 21                 TRA     s:9277

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:291  
              9240    6                   BUFFER.CLASS,
              9241    6                   TABLE,
              9242    6                   BUFFER_LINE,
              9243    6                   BUFFER.COLUMN)
              9244    6        WHENALTRETURN
              9245    7         DO;

              9246    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9246 21 005551   000004 236000 15                 LDQ     BUFFER+4
        21 005552   100000 316003                    CANQ    32768,DU
        21 005553   005625 600000 21                 TZE     s:9277

              9247                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9248    8           DO;

              9249                  %CONCAT_SYMBOL;
              9250    9        DO;

              9251    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9251 21 005554   000000 236000 15                 LDQ     BUFFER
        21 005555   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005556   000007 756000 0                  STQ     SEARCH_SIZE

              9252    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9252 21 005557   000504 236007                    LDQ     324,DL
        21 005560   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005561   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005562   005564 605000 21                 TPL     s:9254

              9253    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9253 21 005563   000007 756000 0                  STQ     SEARCH_SIZE

              9254    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:292  

   9254 21 005564   000006 470400 15                 LDP0    BUFFER+6
        21 005565   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005566   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005567   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005570   040046 100545                    MLR     fill='040'O
        21 005571   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005572   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9255    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9256    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9256 21 005573   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005574   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005575   000010 756000 6                  STQ     LEX_SYMBOL+8

              9257    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9257 21 005576   000000 235000 15                 LDA     BUFFER
        21 005577   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9258    9        END;

              9260    8             CALL GET_NEXT_SCANNER_LINE;

   9260 21 005600   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005601   000000 631400 22                 EPPR1   0
        21 005602   000000 701011                    TSX1    0,X1
        21 005603   000000 011000                    NOP     0

              9261    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9261 21 005604   000000 235000 15                 LDA     BUFFER
        21 005605   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9262                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9263    9     DO;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:293  

              9264    9       CALL SEARCH(BUFFER.COLUMN,

   9264 21 005606   000005 236000 15                 LDQ     BUFFER+5
        21 005607   000000 136000 15                 SBLQ    BUFFER
        21 005610   000024 756000 0                  STQ     @TABLE+10
        21 005611   000000 236000 15                 LDQ     BUFFER
        21 005612   000006 470400 15                 LDP0    BUFFER+6
        21 005613   000024 720000 0                  LXL0    @TABLE+10
        21 005614   000000 164546                    TCT
        21 005615   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005616   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005617   000000 000000 15                 ARG     BUFFER
        21 005620   000000 235000 15                 LDA     BUFFER
        21 005621   000033 771000                    ARL     27
        21 005622   000001 755000 15                 STA     BUFFER+1
        21 005623   000000 551040 15                 STBA    BUFFER,'40'O
        21 005624   000000 056000 15                 ASQ     BUFFER

              9265    9                   BUFFER.CLASS,
              9266    9                   TABLE,
              9267    9                   BUFFER_LINE,
              9268    9                   BUFFER.COLUMN);
              9269    9     END;

              9271    8           END;

              9273    7         END;

              9274    6     END;

              9276    5              END;

              9277    4            CALL CHECK_RELATIONAL_SEPARATOR;

   9277 21 005625   000067 701000 21                 TSX1    CHECK_RELATIONAL_SEPARATOR
        21 005626   000000 011000                    NOP     0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:294  
        21 005627   006377 710000 21                 TRA     s:9541

              9278    4          CASE (%DOUBLE_QUOTE) ;

              9279    4            CALL SCAN_QUOTE_LITERAL;

   9279 21 005630   002117 701000 21                 TSX1    SCAN_QUOTE_LITERAL
        21 005631   000000 011000                    NOP     0
        21 005632   006377 710000 21                 TRA     s:9541

              9280    4          CASE(%SINGLE_QUOTE) ;

              9281    4            CALL SCAN_APOSTROPHE_LITERAL;

   9281 21 005633   002655 701000 21                 TSX1    SCAN_APOSTROPHE_LITERAL
        21 005634   000000 011000                    NOP     0
        21 005635   006377 710000 21                 TRA     s:9541

              9282    4          CASE (%STAR);

              9283                 /*V*
              9284                     STAR --
              9285                       The line is searched for the next symbol.  If it's another star
              9286                       then the entire symbol is an exponentiation otherwise it is
              9287                       a multiply.
              9288                 */
              9289                 %ADV_BUFFER_COLUMN;
              9290    5     DO;

              9291    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9291 21 005636   000000 054000 15                 AOS     BUFFER

              9292    5       CALL SEARCH(BUFFER.COLUMN,

   9292 21 005637   000005 236000 15                 LDQ     BUFFER+5
        21 005640   000000 136000 15                 SBLQ    BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:295  
        21 005641   000024 756000 0                  STQ     @TABLE+10
        21 005642   000000 236000 15                 LDQ     BUFFER
        21 005643   000006 470400 15                 LDP0    BUFFER+6
        21 005644   000024 720000 0                  LXL0    @TABLE+10
        21 005645   000000 164546                    TCT
        21 005646   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005647   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005650   000000 000000 15                 ARG     BUFFER
        21 005651   000000 235000 15                 LDA     BUFFER
        21 005652   000033 771000                    ARL     27
        21 005653   000001 755000 15                 STA     BUFFER+1
        21 005654   000000 551040 15                 STBA    BUFFER,'40'O
        21 005655   000000 056000 15                 ASQ     BUFFER
        21 005656   005660 606400 21                 TTN     s:9299
        21 005657   005734 710000 21                 TRA     s:9329

              9293    5                   BUFFER.CLASS,
              9294    5                   TABLE,
              9295    5                   BUFFER_LINE,
              9296    5                   BUFFER.COLUMN)
              9297    5        WHENALTRETURN
              9298    6         DO;

              9299    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9299 21 005660   000004 236000 15                 LDQ     BUFFER+4
        21 005661   100000 316003                    CANQ    32768,DU
        21 005662   005734 600000 21                 TZE     s:9329

              9300                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9301    7           DO;

              9302                  %CONCAT_SYMBOL;
              9303    8        DO;

              9304    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:296  
   9304 21 005663   000000 236000 15                 LDQ     BUFFER
        21 005664   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005665   000007 756000 0                  STQ     SEARCH_SIZE

              9305    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9305 21 005666   000504 236007                    LDQ     324,DL
        21 005667   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005670   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005671   005673 605000 21                 TPL     s:9307

              9306    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9306 21 005672   000007 756000 0                  STQ     SEARCH_SIZE

              9307    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9307 21 005673   000006 470400 15                 LDP0    BUFFER+6
        21 005674   000007 720000 0                  LXL0    SEARCH_SIZE
        21 005675   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 005676   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005677   040046 100545                    MLR     fill='040'O
        21 005700   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 005701   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9308    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9309    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9309 21 005702   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 005703   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 005704   000010 756000 6                  STQ     LEX_SYMBOL+8

              9310    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9310 21 005705   000000 235000 15                 LDA     BUFFER
        21 005706   000010 755000 0                  STA     SYMBOL_START_LOCATION

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:297  
              9311    8        END;

              9313    7             CALL GET_NEXT_SCANNER_LINE;

   9313 21 005707   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 005710   000000 631400 22                 EPPR1   0
        21 005711   000000 701011                    TSX1    0,X1
        21 005712   000000 011000                    NOP     0

              9314    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9314 21 005713   000000 235000 15                 LDA     BUFFER
        21 005714   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9315                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9316    8     DO;

              9317    8       CALL SEARCH(BUFFER.COLUMN,

   9317 21 005715   000005 236000 15                 LDQ     BUFFER+5
        21 005716   000000 136000 15                 SBLQ    BUFFER
        21 005717   000024 756000 0                  STQ     @TABLE+10
        21 005720   000000 236000 15                 LDQ     BUFFER
        21 005721   000006 470400 15                 LDP0    BUFFER+6
        21 005722   000024 720000 0                  LXL0    @TABLE+10
        21 005723   000000 164546                    TCT
        21 005724   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005725   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005726   000000 000000 15                 ARG     BUFFER
        21 005727   000000 235000 15                 LDA     BUFFER
        21 005730   000033 771000                    ARL     27
        21 005731   000001 755000 15                 STA     BUFFER+1
        21 005732   000000 551040 15                 STBA    BUFFER,'40'O
        21 005733   000000 056000 15                 ASQ     BUFFER

              9318    8                   BUFFER.CLASS,
              9319    8                   TABLE,
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:298  
              9320    8                   BUFFER_LINE,
              9321    8                   BUFFER.COLUMN);
              9322    8     END;

              9324    7           END;

              9326    6         END;

              9327    5     END;

              9329    4            IF BUFFER.CLASS = %STAR THEN

   9329 21 005734   000001 235000 15                 LDA     BUFFER+1
        21 005735   000010 115007                    CMPA    8,DL
        21 005736   006037 601000 21                 TNZ     s:9373

              9330    5              DO;

              9331    5                LEX_SYMBOL.TYPE = %STAR_STAR;

   9331 21 005737   000011 236007                    LDQ     9,DL
        21 005740   000001 756000 6                  STQ     LEX_SYMBOL+1

              9332                     %ADV_BUFFER_COLUMN;
              9333    6     DO;

              9334    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9334 21 005741   000000 054000 15                 AOS     BUFFER

              9335    6       CALL SEARCH(BUFFER.COLUMN,

   9335 21 005742   000005 236000 15                 LDQ     BUFFER+5
        21 005743   000000 136000 15                 SBLQ    BUFFER
        21 005744   000024 756000 0                  STQ     @TABLE+10
        21 005745   000000 236000 15                 LDQ     BUFFER
        21 005746   000006 470400 15                 LDP0    BUFFER+6
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:299  
        21 005747   000024 720000 0                  LXL0    @TABLE+10
        21 005750   000000 164546                    TCT
        21 005751   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 005752   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 005753   000000 000000 15                 ARG     BUFFER
        21 005754   000000 235000 15                 LDA     BUFFER
        21 005755   000033 771000                    ARL     27
        21 005756   000001 755000 15                 STA     BUFFER+1
        21 005757   000000 551040 15                 STBA    BUFFER,'40'O
        21 005760   000000 056000 15                 ASQ     BUFFER
        21 005761   005763 606400 21                 TTN     s:9342
        21 005762   006037 710000 21                 TRA     s:9373

              9336    6                   BUFFER.CLASS,
              9337    6                   TABLE,
              9338    6                   BUFFER_LINE,
              9339    6                   BUFFER.COLUMN)
              9340    6        WHENALTRETURN
              9341    7         DO;

              9342    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9342 21 005763   000004 236000 15                 LDQ     BUFFER+4
        21 005764   100000 316003                    CANQ    32768,DU
        21 005765   006037 600000 21                 TZE     s:9373

              9343                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9344    8           DO;

              9345                  %CONCAT_SYMBOL;
              9346    9        DO;

              9347    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9347 21 005766   000000 236000 15                 LDQ     BUFFER
        21 005767   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 005770   000007 756000 0                  STQ     SEARCH_SIZE
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:300  

              9348    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9348 21 005771   000504 236007                    LDQ     324,DL
        21 005772   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 005773   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 005774   005776 605000 21                 TPL     s:9350

              9349    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9349 21 005775   000007 756000 0                  STQ     SEARCH_SIZE

              9350    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9350 21 005776   000006 470400 15                 LDP0    BUFFER+6
        21 005777   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006000   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006001   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006002   040046 100545                    MLR     fill='040'O
        21 006003   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 006004   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9351    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9352    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9352 21 006005   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006006   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006007   000010 756000 6                  STQ     LEX_SYMBOL+8

              9353    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9353 21 006010   000000 235000 15                 LDA     BUFFER
        21 006011   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9354    9        END;

              9356    8             CALL GET_NEXT_SCANNER_LINE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:301  

   9356 21 006012   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 006013   000000 631400 22                 EPPR1   0
        21 006014   000000 701011                    TSX1    0,X1
        21 006015   000000 011000                    NOP     0

              9357    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9357 21 006016   000000 235000 15                 LDA     BUFFER
        21 006017   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9358                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9359    9     DO;

              9360    9       CALL SEARCH(BUFFER.COLUMN,

   9360 21 006020   000005 236000 15                 LDQ     BUFFER+5
        21 006021   000000 136000 15                 SBLQ    BUFFER
        21 006022   000024 756000 0                  STQ     @TABLE+10
        21 006023   000000 236000 15                 LDQ     BUFFER
        21 006024   000006 470400 15                 LDP0    BUFFER+6
        21 006025   000024 720000 0                  LXL0    @TABLE+10
        21 006026   000000 164546                    TCT
        21 006027   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006030   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006031   000000 000000 15                 ARG     BUFFER
        21 006032   000000 235000 15                 LDA     BUFFER
        21 006033   000033 771000                    ARL     27
        21 006034   000001 755000 15                 STA     BUFFER+1
        21 006035   000000 551040 15                 STBA    BUFFER,'40'O
        21 006036   000000 056000 15                 ASQ     BUFFER

              9361    9                   BUFFER.CLASS,
              9362    9                   TABLE,
              9363    9                   BUFFER_LINE,
              9364    9                   BUFFER.COLUMN);
              9365    9     END;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:302  

              9367    8           END;

              9369    7         END;

              9370    6     END;

              9372    5              END;

              9373    4            CALL CHECK_NORMAL_SEPARATOR;

   9373 21 006037   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 006040   000000 011000                    NOP     0
        21 006041   006377 710000 21                 TRA     s:9541

              9374    4          CASE (%EQUAL);

              9375                 /*V*
              9376                     EQUAL --
              9377                        The line is searched for the next symbol.  If it's an equal sign
              9378                        then the entire symbol is a pseudo text symbol otherwise it
              9379                        is an equal sign.
              9380                 */
              9381                 %ADV_BUFFER_COLUMN_THIS_LINE;  /* == must be on same line */
              9382    5     DO;

              9383    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9383 21 006042   000000 054000 15                 AOS     BUFFER

              9384            %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9385    6     DO;

              9386    6       CALL SEARCH(BUFFER.COLUMN,

   9386 21 006043   000005 236000 15                 LDQ     BUFFER+5
        21 006044   000000 136000 15                 SBLQ    BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:303  
        21 006045   000024 756000 0                  STQ     @TABLE+10
        21 006046   000000 236000 15                 LDQ     BUFFER
        21 006047   000006 470400 15                 LDP0    BUFFER+6
        21 006050   000024 720000 0                  LXL0    @TABLE+10
        21 006051   000000 164546                    TCT
        21 006052   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006053   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006054   000000 000000 15                 ARG     BUFFER
        21 006055   000000 235000 15                 LDA     BUFFER
        21 006056   000033 771000                    ARL     27
        21 006057   000001 755000 15                 STA     BUFFER+1
        21 006060   000000 551040 15                 STBA    BUFFER,'40'O
        21 006061   000000 056000 15                 ASQ     BUFFER

              9387    6                   BUFFER.CLASS,
              9388    6                   TABLE,
              9389    6                   BUFFER_LINE,
              9390    6                   BUFFER.COLUMN);
              9391    6     END;

              9393    5     END;

              9395    4            IF BUFFER.CLASS = %EQUAL THEN

   9395 21 006062   000021 115007                    CMPA    17,DL
        21 006063   006217 601000 21                 TNZ     s:9459

              9396    5              DO;

              9397    5                LEX_SYMBOL.TYPE = %PSEUDO;

   9397 21 006064   000040 236007                    LDQ     32,DL
        21 006065   000001 756000 6                  STQ     LEX_SYMBOL+1

              9398    5                O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;

   9398 21 006066   001330 236000 xsym               LDQ     O1COM+728
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:304  
        21 006067   400000 376003                    ANQ     -131072,DU
        21 006070   400000 676003                    ERQ     -131072,DU
        21 006071   001330 756000 xsym               STQ     O1COM+728

              9399                     %ADV_BUFFER_COLUMN;
              9400    6     DO;

              9401    6       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9401 21 006072   000000 054000 15                 AOS     BUFFER

              9402    6       CALL SEARCH(BUFFER.COLUMN,

   9402 21 006073   000005 236000 15                 LDQ     BUFFER+5
        21 006074   000000 136000 15                 SBLQ    BUFFER
        21 006075   000024 756000 0                  STQ     @TABLE+10
        21 006076   000000 236000 15                 LDQ     BUFFER
        21 006077   000024 720000 0                  LXL0    @TABLE+10
        21 006100   000000 164546                    TCT
        21 006101   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006102   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006103   000000 000000 15                 ARG     BUFFER
        21 006104   000000 235000 15                 LDA     BUFFER
        21 006105   000033 771000                    ARL     27
        21 006106   000001 755000 15                 STA     BUFFER+1
        21 006107   000000 551040 15                 STBA    BUFFER,'40'O
        21 006110   000000 056000 15                 ASQ     BUFFER
        21 006111   006113 606400 21                 TTN     s:9409
        21 006112   006167 710000 21                 TRA     s:9441

              9403    6                   BUFFER.CLASS,
              9404    6                   TABLE,
              9405    6                   BUFFER_LINE,
              9406    6                   BUFFER.COLUMN)
              9407    6        WHENALTRETURN
              9408    7         DO;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:305  
              9409    7           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9409 21 006113   000004 236000 15                 LDQ     BUFFER+4
        21 006114   100000 316003                    CANQ    32768,DU
        21 006115   006167 600000 21                 TZE     s:9441

              9410                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9411    8           DO;

              9412                  %CONCAT_SYMBOL;
              9413    9        DO;

              9414    9          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9414 21 006116   000000 236000 15                 LDQ     BUFFER
        21 006117   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 006120   000007 756000 0                  STQ     SEARCH_SIZE

              9415    9          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9415 21 006121   000504 236007                    LDQ     324,DL
        21 006122   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 006123   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 006124   006126 605000 21                 TPL     s:9417

              9416    9            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9416 21 006125   000007 756000 0                  STQ     SEARCH_SIZE

              9417    9          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9417 21 006126   000006 470400 15                 LDP0    BUFFER+6
        21 006127   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006130   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006131   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006132   040046 100545                    MLR     fill='040'O
        21 006133   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:306  
        21 006134   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9418    9              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9419    9          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9419 21 006135   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006136   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006137   000010 756000 6                  STQ     LEX_SYMBOL+8

              9420    9          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9420 21 006140   000000 235000 15                 LDA     BUFFER
        21 006141   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9421    9        END;

              9423    8             CALL GET_NEXT_SCANNER_LINE;

   9423 21 006142   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 006143   000000 631400 22                 EPPR1   0
        21 006144   000000 701011                    TSX1    0,X1
        21 006145   000000 011000                    NOP     0

              9424    8             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9424 21 006146   000000 235000 15                 LDA     BUFFER
        21 006147   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9425                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9426    9     DO;

              9427    9       CALL SEARCH(BUFFER.COLUMN,

   9427 21 006150   000005 236000 15                 LDQ     BUFFER+5
        21 006151   000000 136000 15                 SBLQ    BUFFER
        21 006152   000024 756000 0                  STQ     @TABLE+10
        21 006153   000000 236000 15                 LDQ     BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:307  
        21 006154   000006 470400 15                 LDP0    BUFFER+6
        21 006155   000024 720000 0                  LXL0    @TABLE+10
        21 006156   000000 164546                    TCT
        21 006157   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006160   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006161   000000 000000 15                 ARG     BUFFER
        21 006162   000000 235000 15                 LDA     BUFFER
        21 006163   000033 771000                    ARL     27
        21 006164   000001 755000 15                 STA     BUFFER+1
        21 006165   000000 551040 15                 STBA    BUFFER,'40'O
        21 006166   000000 056000 15                 ASQ     BUFFER

              9428    9                   BUFFER.CLASS,
              9429    9                   TABLE,
              9430    9                   BUFFER_LINE,
              9431    9                   BUFFER.COLUMN);
              9432    9     END;

              9434    8           END;

              9436    7         END;

              9437    6     END;

              9439                     %CONCAT_SYMBOL;
              9440    6        DO;

              9441    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9441 21 006167   000000 236000 15                 LDQ     BUFFER
        21 006170   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 006171   000007 756000 0                  STQ     SEARCH_SIZE

              9442    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9442 21 006172   000504 236007                    LDQ     324,DL
        21 006173   000010 136000 6                  SBLQ    LEX_SYMBOL+8
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:308  
        21 006174   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 006175   006177 605000 21                 TPL     s:9444

              9443    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9443 21 006176   000007 756000 0                  STQ     SEARCH_SIZE

              9444    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9444 21 006177   000006 470400 15                 LDP0    BUFFER+6
        21 006200   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006201   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006202   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006203   040046 100545                    MLR     fill='040'O
        21 006204   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 006205   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9445    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9446    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9446 21 006206   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006207   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006210   000010 756000 6                  STQ     LEX_SYMBOL+8

              9447    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9447 21 006211   000000 235000 15                 LDA     BUFFER
        21 006212   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9448    6        END;

              9450                     %MARK_END_OF_SYMBOL;
              9451    6     DO;

              9452    6       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   9452 21 006213   000007 755000 6                  STA     LEX_SYMBOL+7
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:309  

              9453    6       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   9453 21 006214   000002 235000 15                 LDA     BUFFER+2
        21 006215   000006 755000 6                  STA     LEX_SYMBOL+6

              9454    6     END;

              9456    5              END;

   9456 21 006216   006377 710000 21                 TRA     s:9541

              9457    4            ELSE
              9458    5              DO;

              9459    5                IF BUFFER.CLASS = %END_OF_LINE

   9459 21 006217   000000 115003                    CMPA    0,DU
        21 006220   006274 601000 21                 TNZ     s:9487
        21 006221   000004 236000 15                 LDQ     BUFFER+4
        21 006222   100000 316003                    CANQ    32768,DU
        21 006223   006274 600000 21                 TZE     s:9487

              9460    5                     AND BUFFER.LINE_TYPE.LINE_CONTINUED THEN
              9461                         %ADV_BUFFER_COLUMN_NEXT_LINE;
              9462    6           DO;

              9463                  %CONCAT_SYMBOL;
              9464    7        DO;

              9465    7          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9465 21 006224   000000 236000 15                 LDQ     BUFFER
        21 006225   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 006226   000007 756000 0                  STQ     SEARCH_SIZE

              9466    7          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:310  

   9466 21 006227   000504 236007                    LDQ     324,DL
        21 006230   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 006231   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 006232   006234 605000 21                 TPL     s:9468

              9467    7            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9467 21 006233   000007 756000 0                  STQ     SEARCH_SIZE

              9468    7          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9468 21 006234   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006235   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006236   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006237   040046 100545                    MLR     fill='040'O
        21 006240   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 006241   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9469    7              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9470    7          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9470 21 006242   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006243   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006244   000010 756000 6                  STQ     LEX_SYMBOL+8

              9471    7          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9471 21 006245   000000 235000 15                 LDA     BUFFER
        21 006246   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9472    7        END;

              9474    6             CALL GET_NEXT_SCANNER_LINE;

   9474 21 006247   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 006250   000000 631400 22                 EPPR1   0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:311  
        21 006251   000000 701011                    TSX1    0,X1
        21 006252   000000 011000                    NOP     0

              9475    6             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9475 21 006253   000000 235000 15                 LDA     BUFFER
        21 006254   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9476                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9477    7     DO;

              9478    7       CALL SEARCH(BUFFER.COLUMN,

   9478 21 006255   000005 236000 15                 LDQ     BUFFER+5
        21 006256   000000 136000 15                 SBLQ    BUFFER
        21 006257   000024 756000 0                  STQ     @TABLE+10
        21 006260   000000 236000 15                 LDQ     BUFFER
        21 006261   000006 470400 15                 LDP0    BUFFER+6
        21 006262   000024 720000 0                  LXL0    @TABLE+10
        21 006263   000000 164546                    TCT
        21 006264   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006265   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006266   000000 000000 15                 ARG     BUFFER
        21 006267   000000 235000 15                 LDA     BUFFER
        21 006270   000033 771000                    ARL     27
        21 006271   000001 755000 15                 STA     BUFFER+1
        21 006272   000000 551040 15                 STBA    BUFFER,'40'O
        21 006273   000000 056000 15                 ASQ     BUFFER

              9479    7                   BUFFER.CLASS,
              9480    7                   TABLE,
              9481    7                   BUFFER_LINE,
              9482    7                   BUFFER.COLUMN);
              9483    7     END;

              9485    6           END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:312  
              9487    5                CALL CHECK_RELATIONAL_SEPARATOR;

   9487 21 006274   000067 701000 21                 TSX1    CHECK_RELATIONAL_SEPARATOR
        21 006275   000000 011000                    NOP     0

              9488    5              END;

   9488 21 006276   006377 710000 21                 TRA     s:9541

              9489    4          CASE (%END_OF_FILE);

              9490                 /* do nothing */
              9491    4          CASE (%END_OF_LINE);

              9492                  /* Do nothing */
              9493    4          CASE (ELSE);

              9494                 /*V*
              9495                     ELSE --
              9496                             This includes parentheses, division, etc.  The
              9497                             symbol is built and returned.
              9498                 */
              9499                 %ADV_BUFFER_COLUMN;
              9500    5     DO;

              9501    5       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9501 21 006277   000000 054000 15                 AOS     BUFFER

              9502    5       CALL SEARCH(BUFFER.COLUMN,

   9502 21 006300   000005 236000 15                 LDQ     BUFFER+5
        21 006301   000000 136000 15                 SBLQ    BUFFER
        21 006302   000024 756000 0                  STQ     @TABLE+10
        21 006303   000000 236000 15                 LDQ     BUFFER
        21 006304   000006 470400 15                 LDP0    BUFFER+6
        21 006305   000024 720000 0                  LXL0    @TABLE+10
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:313  
        21 006306   000000 164546                    TCT
        21 006307   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006310   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006311   000000 000000 15                 ARG     BUFFER
        21 006312   000000 235000 15                 LDA     BUFFER
        21 006313   000033 771000                    ARL     27
        21 006314   000001 755000 15                 STA     BUFFER+1
        21 006315   000000 551040 15                 STBA    BUFFER,'40'O
        21 006316   000000 056000 15                 ASQ     BUFFER
        21 006317   006321 606400 21                 TTN     s:9509
        21 006320   006375 710000 21                 TRA     s:9539

              9503    5                   BUFFER.CLASS,
              9504    5                   TABLE,
              9505    5                   BUFFER_LINE,
              9506    5                   BUFFER.COLUMN)
              9507    5        WHENALTRETURN
              9508    6         DO;

              9509    6           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9509 21 006321   000004 236000 15                 LDQ     BUFFER+4
        21 006322   100000 316003                    CANQ    32768,DU
        21 006323   006375 600000 21                 TZE     s:9539

              9510                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9511    7           DO;

              9512                  %CONCAT_SYMBOL;
              9513    8        DO;

              9514    8          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9514 21 006324   000000 236000 15                 LDQ     BUFFER
        21 006325   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 006326   000007 756000 0                  STQ     SEARCH_SIZE

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:314  
              9515    8          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9515 21 006327   000504 236007                    LDQ     324,DL
        21 006330   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 006331   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 006332   006334 605000 21                 TPL     s:9517

              9516    8            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9516 21 006333   000007 756000 0                  STQ     SEARCH_SIZE

              9517    8          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9517 21 006334   000006 470400 15                 LDP0    BUFFER+6
        21 006335   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006336   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006337   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006340   040046 100545                    MLR     fill='040'O
        21 006341   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 006342   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9518    8              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9519    8          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;

   9519 21 006343   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006344   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006345   000010 756000 6                  STQ     LEX_SYMBOL+8

              9520    8          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9520 21 006346   000000 235000 15                 LDA     BUFFER
        21 006347   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9521    8        END;

              9523    7             CALL GET_NEXT_SCANNER_LINE;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:315  
   9523 21 006350   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 006351   000000 631400 22                 EPPR1   0
        21 006352   000000 701011                    TSX1    0,X1
        21 006353   000000 011000                    NOP     0

              9524    7             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9524 21 006354   000000 235000 15                 LDA     BUFFER
        21 006355   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9525                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9526    8     DO;

              9527    8       CALL SEARCH(BUFFER.COLUMN,

   9527 21 006356   000005 236000 15                 LDQ     BUFFER+5
        21 006357   000000 136000 15                 SBLQ    BUFFER
        21 006360   000024 756000 0                  STQ     @TABLE+10
        21 006361   000000 236000 15                 LDQ     BUFFER
        21 006362   000006 470400 15                 LDP0    BUFFER+6
        21 006363   000024 720000 0                  LXL0    @TABLE+10
        21 006364   000000 164546                    TCT
        21 006365   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006366   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006367   000000 000000 15                 ARG     BUFFER
        21 006370   000000 235000 15                 LDA     BUFFER
        21 006371   000033 771000                    ARL     27
        21 006372   000001 755000 15                 STA     BUFFER+1
        21 006373   000000 551040 15                 STBA    BUFFER,'40'O
        21 006374   000000 056000 15                 ASQ     BUFFER

              9528    8                   BUFFER.CLASS,
              9529    8                   TABLE,
              9530    8                   BUFFER_LINE,
              9531    8                   BUFFER.COLUMN);
              9532    8     END;

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:316  
              9534    7           END;

              9536    6         END;

              9537    5     END;

              9539    4            CALL CHECK_NORMAL_SEPARATOR;

   9539 21 006375   000172 701000 21                 TSX1    CHECK_NORMAL_SEPARATOR
        21 006376   000000 011000                    NOP     0

              9540    4        END;

              9541    3        IF LEX_SYMBOL.TYPE = %ILLEGAL_SYMBOL THEN

   9541 21 006377   000001 235000 6                  LDA     LEX_SYMBOL+1
        21 006400   000033 115007                    CMPA    27,DL
        21 006401   006575 601000 21                 TNZ     s:9635

              9542               %TRANSLATE_TO_UPPER_CASE;
              9543    3      CALL XLATE(SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE),

   9543 21 006402   000010 720000 6                  LXL0    LEX_SYMBOL+8
        21 006403   040040 160440                    MVT     fill='040'O
        21 006404   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        21 006405   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        21 006406   000000 000000 xsym               ARG     LOWER_TO_UPPER_CASE

              9544    3                 LOWER_TO_UPPER_CASE,
              9545    3                 SUBSTR(LEX_SYMBOL.SYMBOL,0,LEX_SYMBOL.SIZE));
              9547    3     END;  /* SCAN_SYMBOL MACRO */

   9547 21 006407   006575 710000 21                 TRA     s:9635

      979     9549
      980     9550
      981     9551    2       CASE (%SCANNER_STATE_RESTART_PERIOD);
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:317  

      982     9552               /* The separator period was found */
      983     9553    2          LEX_SYMBOL.LINE = RESTART_INFO.LINE;

   9553 21 006410   000002 236000 0                  LDQ     RESTART_INFO
        21 006411   000004 756000 6                  STQ     LEX_SYMBOL+4

      984     9554    2          LEX_SYMBOL.COLUMN = RESTART_INFO.COLUMN;

   9554 21 006412   000003 235000 0                  LDA     RESTART_INFO+1
        21 006413   000005 755000 6                  STA     LEX_SYMBOL+5

      985     9555    2          LEX_SYMBOL.FLAGS = FALSE;

   9555 21 006414   000002 450000 6                  STZ     LEX_SYMBOL+2

      986     9556    2          LEX_SYMBOL.B.DEBUG_TOKEN = RESTART_INFO.DEBUG_TOKEN;

   9556 21 006415   000005 236000 0                  LDQ     RESTART_INFO+3
        21 006416   000002 772000                    QRL     2
        21 006417   000002 676000 6                  ERQ     LEX_SYMBOL+2
        21 006420   100000 376003                    ANQ     32768,DU
        21 006421   000002 656000 6                  ERSQ    LEX_SYMBOL+2

      987     9557    2          LEX_SYMBOL.TYPE = %PERIOD;

   9557 21 006422   000014 236007                    LDQ     12,DL
        21 006423   000001 756000 6                  STQ     LEX_SYMBOL+1

      988     9558    2          LEX_SYMBOL.SIZE = 1;

   9558 21 006424   000001 235007                    LDA     1,DL
        21 006425   000010 755000 6                  STA     LEX_SYMBOL+8

      989     9559    2          LEX_SYMBOL.LEVEL = RESTART_INFO.LEVEL;

   9559 21 006426   000004 235000 0                  LDA     RESTART_INFO+2
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:318  
        21 006427   000003 755000 6                  STA     LEX_SYMBOL+3

      990     9560    2          LEX_SYMBOL.NEXT$ = ADDR(NIL);

   9560 21 006430   000014 236000 22                 LDQ     12
        21 006431   000000 756000 6                  STQ     LEX_SYMBOL

      991     9561    2          SUBSTR(LEX_SYMBOL.SYMBOL,0,1) = '.';

   9561 21 006432   056000 236003                    LDQ     23552,DU
        21 006433   000011 552040 6                  STBQ    LEX_SYMBOL+9,'40'O

      992     9562               %MARK_END_OF_SYMBOL;
              9563    3     DO;

              9564    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   9564 21 006434   000000 235000 15                 LDA     BUFFER
        21 006435   000007 755000 6                  STA     LEX_SYMBOL+7

              9565    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   9565 21 006436   000002 235000 15                 LDA     BUFFER+2
        21 006437   000006 755000 6                  STA     LEX_SYMBOL+6

              9566    3     END;

      993     9568    2          SCANNER_STATE = %SCANNER_STATE_NEW_TOKEN;

   9568 21 006440   000000 450000 10                 STZ     SCANNER_STATE
        21 006441   006575 710000 21                 TRA     s:9635

      994     9569
      995     9570    2       CASE (%SCANNER_STATE_RESTART_EQUAL);

      996     9571              /* The separator == was found */
      997     9572              %ADV_BUFFER_COLUMN;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:319  
              9573    3     DO;

              9574    3       BUFFER.COLUMN = BUFFER.COLUMN + 1;

   9574 21 006442   000000 054000 15                 AOS     BUFFER

              9575    3       CALL SEARCH(BUFFER.COLUMN,

   9575 21 006443   000005 236000 15                 LDQ     BUFFER+5
        21 006444   000000 136000 15                 SBLQ    BUFFER
        21 006445   000024 756000 0                  STQ     @TABLE+10
        21 006446   000000 236000 15                 LDQ     BUFFER
        21 006447   000006 470400 15                 LDP0    BUFFER+6
        21 006450   000024 720000 0                  LXL0    @TABLE+10
        21 006451   000000 164546                    TCT
        21 006452   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        21 006453   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006454   000000 000000 15                 ARG     BUFFER
        21 006455   000000 235000 15                 LDA     BUFFER
        21 006456   000033 771000                    ARL     27
        21 006457   000001 755000 15                 STA     BUFFER+1
        21 006460   000000 551040 15                 STBA    BUFFER,'40'O
        21 006461   000000 056000 15                 ASQ     BUFFER
        21 006462   006464 606400 21                 TTN     s:9582
        21 006463   006540 710000 21                 TRA     s:9612

              9576    3                   BUFFER.CLASS,
              9577    3                   TABLE,
              9578    3                   BUFFER_LINE,
              9579    3                   BUFFER.COLUMN)
              9580    3        WHENALTRETURN
              9581    4         DO;

              9582    4           IF BUFFER.LINE_TYPE.LINE_CONTINUED THEN

   9582 21 006464   000004 236000 15                 LDQ     BUFFER+4
        21 006465   100000 316003                    CANQ    32768,DU
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:320  
        21 006466   006540 600000 21                 TZE     s:9612

              9583                  %ADV_BUFFER_COLUMN_NEXT_LINE(TABLE=TABLE);
              9584    5           DO;

              9585                  %CONCAT_SYMBOL;
              9586    6        DO;

              9587    6          SEARCH_SIZE = BUFFER.COLUMN - SYMBOL_START_LOCATION;

   9587 21 006467   000000 236000 15                 LDQ     BUFFER
        21 006470   000010 136000 0                  SBLQ    SYMBOL_START_LOCATION
        21 006471   000007 756000 0                  STQ     SEARCH_SIZE

              9588    6          IF SEARCH_SIZE > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE THEN

   9588 21 006472   000504 236007                    LDQ     324,DL
        21 006473   000010 136000 6                  SBLQ    LEX_SYMBOL+8
        21 006474   000007 116000 0                  CMPQ    SEARCH_SIZE
        21 006475   006477 605000 21                 TPL     s:9590

              9589    6            SEARCH_SIZE = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

   9589 21 006476   000007 756000 0                  STQ     SEARCH_SIZE

              9590    6          SUBSTR(LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, SEARCH_SIZE)

   9590 21 006477   000006 470400 15                 LDP0    BUFFER+6
        21 006500   000007 720000 0                  LXL0    SEARCH_SIZE
        21 006501   000010 235000 0                  LDA     SYMBOL_START_LOCATION
        21 006502   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006503   040046 100545                    MLR     fill='040'O
        21 006504   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        21 006505   000011 000010 6                  ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X0

              9591    6              = SUBSTR(BUFFER_LINE, SYMBOL_START_LOCATION, SEARCH_SIZE);
              9592    6          LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + SEARCH_SIZE;
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:321  

   9592 21 006506   000010 236000 6                  LDQ     LEX_SYMBOL+8
        21 006507   000007 036000 0                  ADLQ    SEARCH_SIZE
        21 006510   000010 756000 6                  STQ     LEX_SYMBOL+8

              9593    6          SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9593 21 006511   000000 235000 15                 LDA     BUFFER
        21 006512   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9594    6        END;

              9596    5             CALL GET_NEXT_SCANNER_LINE;

   9596 21 006513   000000 221000 19                 LDX1    GET_NEXT_SCANNER_LINE
        21 006514   000000 631400 22                 EPPR1   0
        21 006515   000000 701011                    TSX1    0,X1
        21 006516   000000 011000                    NOP     0

              9597    5             SYMBOL_START_LOCATION = BUFFER.COLUMN;

   9597 21 006517   000000 235000 15                 LDA     BUFFER
        21 006520   000010 755000 0                  STA     SYMBOL_START_LOCATION

              9598                  %SCAN_SEARCH_THIS_LINE(TABLE=TABLE);
              9599    6     DO;

              9600    6       CALL SEARCH(BUFFER.COLUMN,

   9600 21 006521   000005 236000 15                 LDQ     BUFFER+5
        21 006522   000000 136000 15                 SBLQ    BUFFER
        21 006523   000024 756000 0                  STQ     @TABLE+10
        21 006524   000000 236000 15                 LDQ     BUFFER
        21 006525   000006 470400 15                 LDP0    BUFFER+6
        21 006526   000024 720000 0                  LXL0    @TABLE+10
        21 006527   000000 164546                    TCT
        21 006530   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:322  
        21 006531   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        21 006532   000000 000000 15                 ARG     BUFFER
        21 006533   000000 235000 15                 LDA     BUFFER
        21 006534   000033 771000                    ARL     27
        21 006535   000001 755000 15                 STA     BUFFER+1
        21 006536   000000 551040 15                 STBA    BUFFER,'40'O
        21 006537   000000 056000 15                 ASQ     BUFFER

              9601    6                   BUFFER.CLASS,
              9602    6                   TABLE,
              9603    6                   BUFFER_LINE,
              9604    6                   BUFFER.COLUMN);
              9605    6     END;

              9607    5           END;

              9609    4         END;

              9610    3     END;

      998     9612    2         LEX_SYMBOL.LINE = RESTART_INFO.LINE;

   9612 21 006540   000002 235000 0                  LDA     RESTART_INFO
        21 006541   000004 755000 6                  STA     LEX_SYMBOL+4

      999     9613    2         LEX_SYMBOL.COLUMN = RESTART_INFO.COLUMN;

   9613 21 006542   000003 236000 0                  LDQ     RESTART_INFO+1
        21 006543   000005 756000 6                  STQ     LEX_SYMBOL+5

     1000     9614    2         LEX_SYMBOL.LEVEL = RESTART_INFO.LEVEL;

   9614 21 006544   000004 235000 0                  LDA     RESTART_INFO+2
        21 006545   000003 755000 6                  STA     LEX_SYMBOL+3

     1001     9615    2         LEX_SYMBOL.NEXT$ = ADDR(NIL);

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:323  
   9615 21 006546   000014 236000 22                 LDQ     12
        21 006547   000000 756000 6                  STQ     LEX_SYMBOL

     1002     9616    2         LEX_SYMBOL.FLAGS = FALSE;

   9616 21 006550   000002 450000 6                  STZ     LEX_SYMBOL+2

     1003     9617    2         LEX_SYMBOL.B.DEBUG_TOKEN = RESTART_INFO.DEBUG_TOKEN;

   9617 21 006551   000005 236000 0                  LDQ     RESTART_INFO+3
        21 006552   000002 772000                    QRL     2
        21 006553   000002 676000 6                  ERQ     LEX_SYMBOL+2
        21 006554   100000 376003                    ANQ     32768,DU
        21 006555   000002 656000 6                  ERSQ    LEX_SYMBOL+2

     1004     9618    2         LEX_SYMBOL.TYPE = %PSEUDO;

   9618 21 006556   000040 236007                    LDQ     32,DL
        21 006557   000001 756000 6                  STQ     LEX_SYMBOL+1

     1005     9619    2         O1COM.PSEUDO_TEXT_FLAG = O1COM.PSEUDO_TEXT_FLAG \ '1'B;

   9619 21 006560   001330 236000 xsym               LDQ     O1COM+728
        21 006561   400000 376003                    ANQ     -131072,DU
        21 006562   400000 676003                    ERQ     -131072,DU
        21 006563   001330 756000 xsym               STQ     O1COM+728

     1006     9620    2         LEX_SYMBOL.SIZE = 2;

   9620 21 006564   000002 235007                    LDA     2,DL
        21 006565   000010 755000 6                  STA     LEX_SYMBOL+8

     1007     9621    2         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = '==';

   9621 21 006566   000000 220000 20                 LDX0    0
        21 006567   000011 740000 6                  STX0    LEX_SYMBOL+9

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:324  
     1008     9622               %MARK_END_OF_SYMBOL;
              9623    3     DO;

              9624    3       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

   9624 21 006570   000000 235000 15                 LDA     BUFFER
        21 006571   000007 755000 6                  STA     LEX_SYMBOL+7

              9625    3       LEX_SYMBOL.END_LINE   = BUFFER.ISN;

   9625 21 006572   000002 235000 15                 LDA     BUFFER+2
        21 006573   000006 755000 6                  STA     LEX_SYMBOL+6

              9626    3     END;

     1009     9628    2         SCANNER_STATE = %SCANNER_STATE_NEW_TOKEN;

   9628 21 006574   000000 450000 10                 STZ     SCANNER_STATE

     1010     9629
     1011     9630
     1012     9631    2     END; /* DO CASE */

     1013     9632
     1014     9633
     1015     9634
     1016     9635    1   END Z8ES$SCANNER;

   9635 21 006575   000000 221200 0                  LDX1  ! 0
        21 006576   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:325  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8ES$SCANNER.
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:326  

 **** Variables and constants ****

  ****  Section 000  Data  Z8ES$SCANNER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w PTR         r     1 @TABLE                     2-0-0/w STRC(109)   r     1 RESTART_INFO
     7-0-0/w SBIN        r     1 SEARCH_SIZE                1-0-0/b BIT         r     1 STOP_SCAN_FLAG
    10-0-0/w SBIN        r     1 SYMBOL_START_LOCATION
    *0-0-0/w UBIN(9)     r     1 TABLE(0:511)               6-0-0/w PTR         r     1 TABLE$

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 003 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 004 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:327  

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 005 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 006 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 007 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 008 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 009 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:328  

  ****  Section 010 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SCANNER_STATE

  ****  Section 011 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 012 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 013 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 014 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 015 LblCom BUFFER
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:329  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 016 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 017 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 018 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 019 LblCom GET_NEXT_SCANNER_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 GET_NEXT_SCANNER_LINE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:330  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)  r     1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)  r     1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248)       1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)  r     1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)  r     1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)  r     1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR        r     1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)  r     1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)  r     1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)  r     1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)  r     1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(4608)  r     1 BASED$TABLE
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR        r     1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
PL6.E3A0      #001=Z8ES$SCANNER File=Z8ES.:Z8A6TSI                               SAT 08/09/97 12:36 Page:331  
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8ES$SCANNER requires 3455 words for executable code.
   Procedure Z8ES$SCANNER is declared NOAUTO and requires 22 words of local(STATIC) storage.

    No errors detected in file Z8ES.:Z8A6TSI    .
