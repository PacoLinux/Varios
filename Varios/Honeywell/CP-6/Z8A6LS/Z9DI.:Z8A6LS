VERSION A06

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:1    
        1        1        /*M* Z9DI - System dependant I/O routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z9DI$FAB_FIB_BUILD: PROC (FILE$);
        8        8         /*P*
        9        9             NAME: Z9DI$FAB_FIB_BUILD
       10       10             PURPOSE: To create the FAB for CP6 I/O.  This extracts
       11       11               information from the FILE_LTS and creates the FAB via
       12       12               scalar/qlt items and presets.
       13       13         */
       14       14
       15       15
       16       16             %INCLUDE Z8A_SYS_FILE;
       17     6291
       18     6292             %EQU PHASE = 1;
       19     6293
       20     6294             %INCLUDE Z8A_DEFC;
       21     6362             %INCLUDE Z8A_SUPP_MAC;
       22     8762             %INCLUDE Z8A_COMCOM;
       23     9412             %INCLUDE Z8A_LTS;
       24    11489             %INCLUDE Z8A_DNT;
       25    11710             %INCLUDE Z8A_ST;
       26    15369             %INCLUDE Z8A_TYPES;
       27    15543             %INCLUDE Z8A_IO_EQUS;
       28    15666             %INCLUDE Z8A_MKCN;
       29    15683             %INCLUDE Z8A_QLT;
       30    15789             %INCLUDE X9A_FAB;
       31    15976             %INCLUDE X9A_IO;
       32    16126
       33    16127             %INCLUDE Z8E_STACKS;
       34    18393             %INCLUDE Z8E_O1COM;
       35    19154             %INCLUDE Z8E_MACROS;
       36    19829             %INCLUDE Z8E_STATEMNT;
       37    19898
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:2    
       38    19899    1        DCL Z8AH$SEARCH_         ENTRY;
       39    19900    1        DCL Z8CU$BUILD_AND_LINK  ENTRY (6);
       40    19901    1        DCL Z8AC$MAKE_CONST      ENTRY (1);
       41    19902
       42    19903    1        DCL 1 FAB_CONST_LENGTH BASED ALIGNED,
       43    19904                   %FAB_CONST (@ENDING = TRUE);
       44    19969
       45    19970    1        DCL 1 FAB_VAR_LENGTH BASED ALIGNED,
       46    19971                   %FAB_VARIABLE ;
       47    20022
       48    20023    1        DCL 1 DESC ALIGNED,
       49    20024                   %DESCRIPTOR (LVL = 2, ENDING = YES);
       50    20052
       51    20053             %DCL_FAB (@NAME = FAB);
       52    20175
       53    20176    1        DCL LEN           SBIN;
       54    20177    1        DCL F_DNT$        PTR;
       55    20178    1        DCL FAB$          PTR; /* Ptr to 01 FAB (st) */
       56    20179    1        DCL DCBNUM$       PTR; /* Ptr to 02 DCBNUM (st) */
       57    20180    1        DCL RETURN$       PTR;
       58    20181    1        DCL FILE$         PTR;
       59    20182    1        DCL DNT$$         PTR;
       60    20183    1        DCL FLEN          SBIN;
       61    20184    1        DCL FNAME         CHAR(30);
       62    20185    1        DCL BLOCK$        PTR;
       63    20186    1        DCL EXTERNAL_FLAG BIT(1) ALIGNED;
       64    20187    1        DCL CURRENT_COUNT SBIN;
       65    20188        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:3    
       66    20189    1   NEW_DCBNUM: PROC (FILE$, FAB$, QLT$$, DCBNUM$);
       67    20190
       68    20191             %EQU DCBNUM_TEXT  = '_DCBNUM';
       69    20192
       70    20193    2        DCL FILE$         PTR;
       71    20194    2        DCL FAB$          PTR;
       72    20195    2        DCL QLT$$         PTR;
       73    20196    2        DCL DCBNUM$       PTR;
       74    20197    2        DCL DNT$$         PTR;
       75    20198    2        DCL LEN           SBIN;
       76    20199    2        DCL BUFFER        CHAR (60);
       77    20200
       78    20201
       79    20202             /* Build DCBNUM, using characters that are legal in
       80    20203                COBOL8X.  This allows the users access to the
       81    20204                DCBNUM.
       82    20205             */
       83    20206
       84    20207    2        LEX_SYMBOL.SIZE = FILE$ -> FILE_LTS.ST$ -> FD.DNT$ ->
       85    20208    2                          DNT.TEXT.LENGTH + 7;
       86    20209
       87    20210    2        CALL CONCAT (SUBSTR (LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE),
       88    20211    2                     FILE$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.TEXT.NAME,
       89    20212    2                     %DCBNUM_TEXT);
       90    20213
       91    20214    2        CALL Z8AH$SEARCH_;
       92    20215
       93    20216    2        DNT$$ = DNT$;
       94    20217
       95    20218
       96    20219             %NEW_SCALAR (@ST$   = DCBNUM$,
       97    20220                          @CLASS = %CLASS_NUMERIC,
       98    20221                          @TYPE  = %TYH,
       99    20222                          @DNT$  = DNT$$,
      100    20223                          @ELEMENTARY = TRUE);
      101    20423
      102    20424    2        DCBNUM$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH) + 1;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:4    
      103    20425
      104    20426    2        DCBNUM$ -> SCALAR.NDSC.N = %TYH_LENGTH;
      105    20427    2        DNT$$ -> DNT.ST$ = DCBNUM$;
      106    20428
      107    20429             %NEW_QLT (@POINTER = DCBNUM$ -> SCALAR.QLT$,
      108    20430                       @FATHER  = FAB$ -> SCALAR.QLT$,
      109    20431                       @LEVEL#  = 2,
      110    20432                       @ST$     = DCBNUM$,
      111    20433                       @DNT$    = DNT$$);
      112    20458
      113    20459    2        QLT$$ -> QLT.BROTHER = DCBNUM$ -> SCALAR.QLT$;
      114    20460    2        DCBNUM$ -> SCALAR.COUNT = CURRENT_COUNT;
      115    20461    2   END NEW_DCBNUM;
      116    20462        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:5    
      117    20463    1   NEW_01_FAB: PROC (FILE$, FAB$, EXTERNAL_FLAG);
      118    20464
      119    20465             %EQU FAB_STRING = '_FAB';
      120    20466
      121    20467    2        DCL FAB$          PTR;
      122    20468    2        DCL DNT$$         PTR;
      123    20469    2        DCL FILE$         PTR;
      124    20470    2        DCL LEN           SBIN;
      125    20471    2        DCL BUFFER        CHAR (60);
      126    20472    2        DCL EXTERNAL_FLAG BIT(1) ALIGNED;
      127    20473
      128    20474
      129    20475    2        LEX_SYMBOL.SIZE = FILE$ -> FILE_LTS.ST$ -> FD.DNT$ ->
      130    20476    2                          DNT.TEXT.LENGTH + 4;
      131    20477
      132    20478    2        CALL CONCAT (SUBSTR (LEX_SYMBOL.SYMBOL,0, LEX_SYMBOL.SIZE),
      133    20479    2                     FILE$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.TEXT.NAME,
      134    20480    2                     %FAB_STRING);
      135    20481
      136    20482    2        CALL Z8AH$SEARCH_;
      137    20483
      138    20484    2        IF FILE$ -> FILE_LTS.ST$ -> FD.B.EXTERNAL AND (DNT$ -> DNT.ST$ ~= ADDR(NIL) )
             20484                 THEN
      139    20485    3          DO;
      140    20486    3            FAB$ = DNT$ -> DNT.ST$;
      141    20487    3            EXTERNAL_FLAG = %TRUE;
      142    20488    3          END;
      143    20489    2        ELSE
      144    20490    3          DO;
      145    20491    3            DNT$$ = DNT$;
      146    20492
      147    20493                 %PACK_ADSC (@DESC = DESC,
      148    20494                             @LENGTH = "SIZEC(FAB)");
      149    20518
      150    20519                 %NEW_SCALAR (@ST$   = FAB$,
      151    20520                              @TYPE  = %TYA,
      152    20521                              @DESCL = DESC.DESCL,
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:6    
      153    20522                              @CLASS = %CLASS_ALPHANUMERIC,
      154    20523                              @ELEMENTARY = FALSE,
      155    20524                              @DNT$  = DNT$$);
      156    20724
      157    20725    3            DNT$$ -> DNT.ST$ = FAB$;
      158    20726
      159    20727                 %NEW_QLT (@POINTER = FAB$ -> SCALAR.QLT$,
      160    20728                           @LEVEL#  = 01,
      161    20729                           @ST$     = FAB$,
      162    20730                           @DNT$    = DNT$$);
      163    20755
      164    20756
      165    20757
      166    20758
      167    20759                 %UPDATE_PREV_QLT$ (@NEW_QLT$ = FAB$ -> SCALAR.QLT$);
      168    20766
      169    20767    3            EXTERNAL_FLAG = %FALSE;
      170    20768
      171    20769    3          END;
      172    20770
      173    20771    2   END NEW_01_FAB;
      174    20772        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:7    
      175    20773
      176    20774             /*
      177    20775                      Main Procedure
      178    20776             */
      179    20777
      180    20778                                      /*      This is a kludge.  Only FABS are needed
      181    20779                                              for FD's on CP-6.  GCOS needs them for
      182    20780                                              SD's also.
      183    20781                                      */
      184    20782    1        IF FILE$ -> FILE_LTS.ST$ -> ST.ID ~= %FD  THEN
      185    20783    1           RETURN;
      186    20784
      187    20785
      188    20786    1        F_DNT$ = FILE$ -> FILE_LTS.ST$ -> FD.DNT$;
      189    20787
      190    20788    1        CALL NEW_01_FAB (FILE$, FAB$, EXTERNAL_FLAG);
      191    20789
      192    20790    1        CURRENT_COUNT = FAB$ -> ST.COUNT;
      193    20791
      194    20792    1        IF NOT EXTERNAL_FLAG    THEN
      195    20793    2          DO;
      196    20794
      197    20795    2            IF FILE$ -> FILE_LTS.ST$ -> FD.B.EXTERNAL      THEN
      198    20796    3              DO;
      199    20797
      200    20798    3                FLEN = F_DNT$ -> DNT.TEXT.LENGTH;
      201    20799    3                FNAME = F_DNT$ -> DNT.TEXT.NAME;
      202    20800
      203    20801    3                LEX_SYMBOL.SIZE = FLEN + 2;
      204    20802
      205    20803    3                CALL CONCAT( SUBSTR( LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE ),
      206    20804    3                             'F#', SUBSTR( FNAME, 0, FLEN ) );
      207    20805    3                CALL Z8AH$SEARCH_;
      208    20806
      209    20807                     %NEW_BLOCK( @ST$  = BLOCK$,
      210    20808                                 @DNT$ = DNT$,
      211    20809                                 @SIZE = "SIZEC( FAB )" );
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:8    
      212    20886    3                FAB$ -> ST.COUNT = BLOCK$ -> BLOCK.COUNT;
      213    20887    3                CURRENT_COUNT = BLOCK$ -> BLOCK.COUNT;
      214    20888
      215    20889    3              END;
      216    20890
      217    20891
      218    20892                 /* Build the constant portion of the FAB */
      219    20893
      220    20894    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'CONST', 5, RETURN$);
      221    20895
      222    20896
      223    20897                 %PACK_ADSC (@DESC = DESC,
      224    20898                             @LENGTH = "SIZEC(FAB_CONST_LENGTH)");
      225    20922
      226    20923    2            RETURN$ -> ST.DESCL = DESC.DESCL;
      227    20924    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;
      228    20925
      229    20926
      230    20927                 /* Build the Length_read and DCBNUM fields of the Fab;
      231    20928                    These fields have explicit symbol table items so that
      232    20929                        they can be referenced by the compiler
      233    20930                 */
      234    20931    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, 'LENGTH_READ', 11, RETURN$);
      235    20932    2            RETURN$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH);
      236    20933    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;
      237    20934
      238    20935    2            FILE$ -> FILE_LTS.LENGTH_READ$ = RETURN$;
      239    20936
      240    20937
      241    20938    2            CALL NEW_DCBNUM (FILE$, FAB$, RETURN$ -> SCALAR.QLT$, DCBNUM$);
      242    20939
      243    20940
      244    20941                 /* Build the variable portion of the FAB;  This portion is
      245    20942                        initialized by PRESET/PTR_SET ILL items */
      246    20943
      247    20944    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'VAR', 3, RETURN$);
      248    20945    2            RETURN$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH) + 2;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:9    
      249    20946    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;
      250    20947
      251    20948                 %PACK_ADSC (@DESC = DESC,
      252    20949                             @LENGTH = "SIZEC(FAB_VAR_LENGTH)");
      253    20973
      254    20974    2            RETURN$ -> ST.DESCL = DESC.DESCL;
      255    20975
      256    20976    2          END;
      257    20977
      258    20978    1        ELSE
      259    20979                     /*  Pickup LENGTH_READ$ from QLT table  */
      260    20980    1          FILE$ -> FILE_LTS.LENGTH_READ$ = FAB$ -> SCALAR.QLT$ -> QLT.SON
      261    20981    1                           -> QLT.BROTHER -> QLT.ST$;
      262    20982
      263    20983
      264    20984
      265    20985             /* finish up */
      266    20986
      267    20987    1        FILE$ -> FILE_LTS.FAB$ = FAB$;
      268    20988
      269    20989
      270    20990
      271    20991    1   END Z9DI$FAB_FIB_BUILD;
      272    20992        %EOD;

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:10   
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z9DI$FAB_FIB_BUILD.

   Procedure Z9DI$FAB_FIB_BUILD requires 695 words for executable code.
   Procedure Z9DI$FAB_FIB_BUILD requires 114 words of local(AUTO) storage.

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:11   

 Object Unit name= Z9DI$FAB_FIB_BUILD                         File name= Z9DI.:Z8A6TOU
 UTS= AUG 09 '97 13:42:12.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  LTS$
    3  LblCom even  none     5      5  LTS_
    4  LblCom even  none     1      1  DNT$
    5  LblCom even  none     5      5  DNT_
    6  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    7  LblCom even  none     1      1  DNT_OF_1$
    8  LblCom even  none     1      1  ST$
    9  LblCom even  none     5      5  ST_
   10  LblCom even  none     2      2  MKCN
   11  LblCom even  none     1      1  QLT$
   12  LblCom even  none     1      1  PREV_01_QLT$
   13  LblCom even  none     5      5  QLT_
   14  LblCom even  none    90    132  LEX_SYMBOL
   15  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   16  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   17  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   18  RoData even  UTS     10     12  Z9DI$FAB_FIB_BUILD
   19   Proc  even  none   695   1267  Z9DI$FAB_FIB_BUILD
   20  RoData even  none    32     40  Z9DI$FAB_FIB_BUILD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    19      0   yes            yes      Std        1  Z9DI$FAB_FIB_BUILD
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       1 Z8AR$RESERVER
         yes           Std       6 Z8CU$BUILD_AND_LINK
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  COMCOM                           r    LTS_STEP
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:13   


        1        1        /*M* Z9DI - System dependant I/O routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z9DI$FAB_FIB_BUILD: PROC (FILE$);

      7 19 000000   000000 700200 xent  Z9DI$FAB_FI* TSX0  ! X66_AUTO_1
        19 000001   000162 000001                    ZERO    114,1
        19 000002   000710 710000 19                 TRA     s:20782

        8        8         /*P*
        9        9             NAME: Z9DI$FAB_FIB_BUILD
       10       10             PURPOSE: To create the FAB for CP6 I/O.  This extracts
       11       11               information from the FILE_LTS and creates the FAB via
       12       12               scalar/qlt items and presets.
       13       13         */
       14       14
       15       15
       16       16             %INCLUDE Z8A_SYS_FILE;
       17     6291
       18     6292             %EQU PHASE = 1;
       19     6293
       20     6294             %INCLUDE Z8A_DEFC;
       21     6362             %INCLUDE Z8A_SUPP_MAC;
       22     8762             %INCLUDE Z8A_COMCOM;
       23     9412             %INCLUDE Z8A_LTS;
       24    11489             %INCLUDE Z8A_DNT;
       25    11710             %INCLUDE Z8A_ST;
       26    15369             %INCLUDE Z8A_TYPES;
       27    15543             %INCLUDE Z8A_IO_EQUS;
       28    15666             %INCLUDE Z8A_MKCN;
       29    15683             %INCLUDE Z8A_QLT;
       30    15789             %INCLUDE X9A_FAB;
       31    15976             %INCLUDE X9A_IO;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:14   
       32    16126
       33    16127             %INCLUDE Z8E_STACKS;
       34    18393             %INCLUDE Z8E_O1COM;
       35    19154             %INCLUDE Z8E_MACROS;
       36    19829             %INCLUDE Z8E_STATEMNT;
       37    19898
       38    19899    1        DCL Z8AH$SEARCH_         ENTRY;
       39    19900    1        DCL Z8CU$BUILD_AND_LINK  ENTRY (6);
       40    19901    1        DCL Z8AC$MAKE_CONST      ENTRY (1);
       41    19902
       42    19903    1        DCL 1 FAB_CONST_LENGTH BASED ALIGNED,
       43    19904                   %FAB_CONST (@ENDING = TRUE);
       44    19969
       45    19970    1        DCL 1 FAB_VAR_LENGTH BASED ALIGNED,
       46    19971                   %FAB_VARIABLE ;
       47    20022
       48    20023    1        DCL 1 DESC ALIGNED,
       49    20024                   %DESCRIPTOR (LVL = 2, ENDING = YES);
       50    20052
       51    20053             %DCL_FAB (@NAME = FAB);
       52    20175
       53    20176    1        DCL LEN           SBIN;
       54    20177    1        DCL F_DNT$        PTR;
       55    20178    1        DCL FAB$          PTR; /* Ptr to 01 FAB (st) */
       56    20179    1        DCL DCBNUM$       PTR; /* Ptr to 02 DCBNUM (st) */
       57    20180    1        DCL RETURN$       PTR;
       58    20181    1        DCL FILE$         PTR;
       59    20182    1        DCL DNT$$         PTR;
       60    20183    1        DCL FLEN          SBIN;
       61    20184    1        DCL FNAME         CHAR(30);
       62    20185    1        DCL BLOCK$        PTR;
       63    20186    1        DCL EXTERNAL_FLAG BIT(1) ALIGNED;
       64    20187    1        DCL CURRENT_COUNT SBIN;
       65    20188        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:15   
       66    20189    1   NEW_DCBNUM: PROC (FILE$, FAB$, QLT$$, DCBNUM$);

  20189 19 000003   200126 741300       NEW_DCBNUM   STX1  ! CURRENT_COUNT+1,,AUTO

       67    20190
       68    20191             %EQU DCBNUM_TEXT  = '_DCBNUM';
       69    20192
       70    20193    2        DCL FILE$         PTR;
       71    20194    2        DCL FAB$          PTR;
       72    20195    2        DCL QLT$$         PTR;
       73    20196    2        DCL DCBNUM$       PTR;
       74    20197    2        DCL DNT$$         PTR;
       75    20198    2        DCL LEN           SBIN;
       76    20199    2        DCL BUFFER        CHAR (60);
       77    20200
       78    20201
       79    20202             /* Build DCBNUM, using characters that are legal in
       80    20203                COBOL8X.  This allows the users access to the
       81    20204                DCBNUM.
       82    20205             */
       83    20206
       84    20207    2        LEX_SYMBOL.SIZE = FILE$ -> FILE_LTS.ST$ -> FD.DNT$ ->

  20207 19 000004   200127 470500                    LDP0    @FILE$,,AUTO
        19 000005   000000 471500                    LDP1    0,,PR0
        19 000006   100001 473500                    LDP3    1,,PR1
        19 000007   300006 474500                    LDP4    6,,PR3
        19 000010   400004 236100                    LDQ     4,,PR4
        19 000011   000022 772000                    QRL     18
        19 000012   000007 036007                    ADLQ    7,DL
        19 000013   000010 756000 14                 STQ     LEX_SYMBOL+8

       85    20208    2                          DNT.TEXT.LENGTH + 7;
       86    20209
       87    20210    2        CALL CONCAT (SUBSTR (LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE),

  20210 19 000014   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:16   
        19 000015   100001 473500                    LDP3    1,,PR1
        19 000016   300006 474500                    LDP4    6,,PR3
        19 000017   400004 220100                    LDX0    4,,PR4
        19 000020   000000 622006                    EAX2    0,QL
        19 000021   040040 100540                    MLR     fill='040'O
        19 000022   400004 400010                    ADSC9   4,,PR4                   cn=2,n=*X0
        19 000023   000011 000012 14                 ADSC9   LEX_SYMBOL+9             cn=0,n=*X2
        19 000024   000000 635010                    EAA     0,X0
        19 000025   000022 771000                    ARL     18
        19 000026   200154 755100                    STA     BUFFER+15,,AUTO
        19 000027   000010 236000 14                 LDQ     LEX_SYMBOL+8
        19 000030   200154 136100                    SBLQ    BUFFER+15,,AUTO
        19 000031   000040 604400 19                 TMOZ    s:20214
        19 000032   000000 622006                    EAX2    0,QL
        19 000033   000000 636010                    EAQ     0,X0
        19 000034   000022 772000                    QRL     18
        19 000035   040046 100400                    MLR     fill='040'O
        19 000036   000000 000007 18                 ADSC9   0                        cn=0,n=7
        19 000037   000011 000012 14                 ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X2

       88    20211    2                     FILE$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.TEXT.NAME,
       89    20212    2                     %DCBNUM_TEXT);
       90    20213
       91    20214    2        CALL Z8AH$SEARCH_;

  20214 19 000040   000000 631400 20                 EPPR1   0
        19 000041   000000 701000 xent               TSX1    Z8AH$SEARCH_
        19 000042   000000 011000                    NOP     0

       92    20215
       93    20216    2        DNT$$ = DNT$;

  20216 19 000043   000000 236000 4                  LDQ     DNT$
        19 000044   200133 756100                    STQ     DNT$$,,AUTO

       94    20217
       95    20218
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:17   
       96    20219             %NEW_SCALAR (@ST$   = DCBNUM$,
       97    20220                          @CLASS = %CLASS_NUMERIC,
       98    20221                          @TYPE  = %TYH,
       99    20222                          @DNT$  = DNT$$,
      100    20223                          @ELEMENTARY = TRUE);

  20227 19 000045   000002 236000 9                  LDQ     ST_+2
        19 000046   000013 036007                    ADLQ    11,DL
        19 000047   000003 116000 9                  CMPQ    ST_+3
        19 000050   000061 604000 19                 TMI     s:20229

  20228 19 000051   000003 236000 20                 LDQ     3
        19 000052   200154 756100                    STQ     BUFFER+15,,AUTO
        19 000053   200154 630500                    EPPR0   BUFFER+15,,AUTO
        19 000054   200155 450500                    STP0    BUFFER+16,,AUTO
        19 000055   200155 630500                    EPPR0   BUFFER+16,,AUTO
        19 000056   000002 631400 20                 EPPR1   2
        19 000057   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000060   000000 011000                    NOP     0

  20229 19 000061   000002 236000 9                  LDQ     ST_+2
        19 000062   000022 736000                    QLS     18
        19 000063   000001 036000 9                  ADLQ    ST_+1
        19 000064   200132 470500                    LDP0    @DCBNUM$,,AUTO
        19 000065   000000 756100                    STQ     0,,PR0

  20230 19 000066   000013 236007                    LDQ     11,DL
        19 000067   000002 056000 9                  ASQ     ST_+2

  20278 19 000070   000000 471500                    LDP1    0,,PR0
        19 000071   000766 220003                    LDX0    502,DU
        19 000072   100000 740100                    STX0    0,,PR1

  20279 19 000073   000000 471500                    LDP1    0,,PR0
        19 000074   003000 236007                    LDQ     1536,DL
        19 000075   100000 552110                    STBQ    0,'10'O,PR1

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:18   
  20280 19 000076   000000 471500                    LDP1    0,,PR0
        19 000077   000001 236007                    LDQ     1,DL
        19 000100   100000 552104                    STBQ    0,'04'O,PR1

  20281 19 000101   000000 471500                    LDP1    0,,PR0
        19 000102   000000 221003                    LDX1    0,DU
        19 000103   100001 741100                    STX1    1,,PR1

  20282 19 000104   000000 471500                    LDP1    0,,PR0
        19 000105   100001 441100                    SXL1    1,,PR1

  20283 19 000106   000000 471500                    LDP1    0,,PR0
        19 000107   000133 722000 xsym               LXL2    COMCOM+91
        19 000110   100002 442100                    SXL2    2,,PR1

  20284 19 000111   000000 471500                    LDP1    0,,PR0
        19 000112   100003 450100                    STZ     3,,PR1

  20285 19 000113   000000 471500                    LDP1    0,,PR0
        19 000114   000001 236000 20                 LDQ     1
        19 000115   100004 756100                    STQ     4,,PR1

  20286 19 000116   000000 471500                    LDP1    0,,PR0
        19 000117   100005 756100                    STQ     5,,PR1

  20287 19 000120   000000 471500                    LDP1    0,,PR0
        19 000121   100007 756100                    STQ     7,,PR1

  20288 19 000122   000000 471500                    LDP1    0,,PR0
        19 000123   100010 741100                    STX1    8,,PR1

  20289 19 000124   000000 471500                    LDP1    0,,PR0
        19 000125   777777 222003                    LDX2    -1,DU
        19 000126   100010 442100                    SXL2    8,,PR1

  20293 19 000127   000000 471500                    LDP1    0,,PR0
        19 000130   100012 756100                    STQ     10,,PR1
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:19   

  20296 19 000131   000000 471500                    LDP1    0,,PR0
        19 000132   000057 236000 xsym               LDQ     O1COM+47
        19 000133   100011 756100                    STQ     9,,PR1

  20297 19 000134   000057 236000 xsym               LDQ     O1COM+47
        19 000135   000001 116000 20                 CMPQ    1
        19 000136   000162 600000 19                 TZE     s:20332

  20301 19 000137   000057 471400 xsym               LDP1    O1COM+47
        19 000140   100001 473500                    LDP3    1,,PR1
        19 000141   300012 236100                    LDQ     10,,PR3
        19 000142   000001 116000 20                 CMPQ    1
        19 000143   000153 601000 19                 TNZ     s:20308

  20303 19 000144   000000 236100                    LDQ     0,,PR0
        19 000145   300011 756100                    STQ     9,,PR3

  20304 19 000146   000057 471400 xsym               LDP1    O1COM+47
        19 000147   100001 473500                    LDP3    1,,PR1
        19 000150   000000 236100                    LDQ     0,,PR0
        19 000151   300012 756100                    STQ     10,,PR3

  20305 19 000152   000162 710000 19                 TRA     s:20332

  20308 19 000153   300012 474500                    LDP4    10,,PR3
        19 000154   000000 236100                    LDQ     0,,PR0
        19 000155   400012 756100                    STQ     10,,PR4

  20309 19 000156   000057 471400 xsym               LDP1    O1COM+47
        19 000157   100001 473500                    LDP3    1,,PR1
        19 000160   000000 236100                    LDQ     0,,PR0
        19 000161   300012 756100                    STQ     10,,PR3

  20332 19 000162   000000 471500                    LDP1    0,,PR0
        19 000163   000007 223003                    LDX3    7,DU
        19 000164   100002 743100                    STX3    2,,PR1
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:20   

  20337 19 000165   000000 471500                    LDP1    0,,PR0
        19 000166   200133 236100                    LDQ     DNT$$,,AUTO
        19 000167   100006 756100                    STQ     6,,PR1

  20354 19 000170   000000 471500                    LDP1    0,,PR0
        19 000171   010000 236003                    LDQ     4096,DU
        19 000172   100003 256100                    ORSQ    3,,PR1

  20402 19 000173   000000 471500                    LDP1    0,,PR0
        19 000174   100003 236100                    LDQ     3,,PR1
        19 000175   000004 376000 20                 ANQ     4
        19 000176   000001 276007                    ORQ     1,DL
        19 000177   100003 756100                    STQ     3,,PR1

      101    20423
      102    20424    2        DCBNUM$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH) + 1;

  20424 19 000200   000000 471500                    LDP1    0,,PR0
        19 000201   000034 224003                    LDX4    28,DU
        19 000202   100001 744100                    STX4    1,,PR1

      103    20425
      104    20426    2        DCBNUM$ -> SCALAR.NDSC.N = %TYH_LENGTH;

  20426 19 000203   000000 471500                    LDP1    0,,PR0
        19 000204   000002 236007                    LDQ     2,DL
        19 000205   100001 752101                    STCQ    1,'01'O,PR1

      105    20427    2        DNT$$ -> DNT.ST$ = DCBNUM$;

  20427 19 000206   000000 236100                    LDQ     0,,PR0
        19 000207   200133 471500                    LDP1    DNT$$,,AUTO
        19 000210   100001 756100                    STQ     1,,PR1

      106    20428
      107    20429             %NEW_QLT (@POINTER = DCBNUM$ -> SCALAR.QLT$,
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:21   
      108    20430                       @FATHER  = FAB$ -> SCALAR.QLT$,
      109    20431                       @LEVEL#  = 2,
      110    20432                       @ST$     = DCBNUM$,
      111    20433                       @DNT$    = DNT$$);

  20438 19 000211   000002 236000 13                 LDQ     QLT_+2
        19 000212   000006 036007                    ADLQ    6,DL
        19 000213   000003 116000 13                 CMPQ    QLT_+3
        19 000214   000225 602000 19                 TNC     s:20440

  20439 19 000215   000005 236000 20                 LDQ     5
        19 000216   200154 756100                    STQ     BUFFER+15,,AUTO
        19 000217   200154 633500                    EPPR3   BUFFER+15,,AUTO
        19 000220   200155 453500                    STP3    BUFFER+16,,AUTO
        19 000221   200155 630500                    EPPR0   BUFFER+16,,AUTO
        19 000222   000002 631400 20                 EPPR1   2
        19 000223   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000224   000000 011000                    NOP     0

  20440 19 000225   200132 470500                    LDP0    @DCBNUM$,,AUTO
        19 000226   000000 471500                    LDP1    0,,PR0
        19 000227   000002 236000 13                 LDQ     QLT_+2
        19 000230   000022 736000                    QLS     18
        19 000231   000001 036000 13                 ADLQ    QLT_+1
        19 000232   100007 756100                    STQ     7,,PR1

  20441 19 000233   000002 235000 13                 LDA     QLT_+2
        19 000234   000006 035007                    ADLA    6,DL
        19 000235   000002 755000 13                 STA     QLT_+2

  20442 19 000236   000000 471500                    LDP1    0,,PR0
        19 000237   100007 473500                    LDP3    7,,PR1
        19 000240   001053 220003                    LDX0    555,DU
        19 000241   300000 740100                    STX0    0,,PR3

  20445 19 000242   000000 471500                    LDP1    0,,PR0
        19 000243   100007 473500                    LDP3    7,,PR1
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:22   
        19 000244   200130 474500                    LDP4    @FAB$,,AUTO
        19 000245   400000 475500                    LDP5    0,,PR4
        19 000246   500007 236100                    LDQ     7,,PR5
        19 000247   300001 756100                    STQ     1,,PR3

  20446 19 000250   000000 471500                    LDP1    0,,PR0
        19 000251   100007 473500                    LDP3    7,,PR1
        19 000252   000001 236000 20                 LDQ     1
        19 000253   300002 756100                    STQ     2,,PR3

  20447 19 000254   000000 471500                    LDP1    0,,PR0
        19 000255   100007 473500                    LDP3    7,,PR1
        19 000256   300003 756100                    STQ     3,,PR3

  20448 19 000257   000000 471500                    LDP1    0,,PR0
        19 000260   100007 473500                    LDP3    7,,PR1
        19 000261   000000 236100                    LDQ     0,,PR0
        19 000262   300004 756100                    STQ     4,,PR3

  20449 19 000263   000000 471500                    LDP1    0,,PR0
        19 000264   100007 473500                    LDP3    7,,PR1
        19 000265   200133 236100                    LDQ     DNT$$,,AUTO
        19 000266   300005 756100                    STQ     5,,PR3

  20450 19 000267   000000 471500                    LDP1    0,,PR0
        19 000270   100007 473500                    LDP3    7,,PR1
        19 000271   000002 236007                    LDQ     2,DL
        19 000272   300000 552104                    STBQ    0,'04'O,PR3

  20451 19 000273   000000 471500                    LDP1    0,,PR0
        19 000274   100007 473500                    LDP3    7,,PR1
        19 000275   000000 236003                    LDQ     0,DU
        19 000276   300000 552110                    STBQ    0,'10'O,PR3

  20452 19 000277   000000 471500                    LDP1    0,,PR0
        19 000300   100007 473500                    LDP3    7,,PR1
        19 000301   000006 236000 20                 LDQ     6
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:23   
        19 000302   300000 356100                    ANSQ    0,,PR3

  20453 19 000303   000000 471500                    LDP1    0,,PR0
        19 000304   100007 473500                    LDP3    7,,PR1
        19 000305   000007 236000 20                 LDQ     7
        19 000306   300000 356100                    ANSQ    0,,PR3

  20454 19 000307   000000 471500                    LDP1    0,,PR0
        19 000310   100007 473500                    LDP3    7,,PR1
        19 000311   000010 236000 20                 LDQ     8
        19 000312   300000 356100                    ANSQ    0,,PR3

  20455 19 000313   000000 471500                    LDP1    0,,PR0
        19 000314   100007 473500                    LDP3    7,,PR1
        19 000315   000011 236000 20                 LDQ     9
        19 000316   300000 356100                    ANSQ    0,,PR3

      112    20458
      113    20459    2        QLT$$ -> QLT.BROTHER = DCBNUM$ -> SCALAR.QLT$;

  20459 19 000317   200131 471500                    LDP1    @QLT$$,,AUTO
        19 000320   100000 473500                    LDP3    0,,PR1
        19 000321   000000 475500                    LDP5    0,,PR0
        19 000322   500007 236100                    LDQ     7,,PR5
        19 000323   300002 756100                    STQ     2,,PR3

      114    20460    2        DCBNUM$ -> SCALAR.COUNT = CURRENT_COUNT;

  20460 19 000324   000000 473500                    LDP3    0,,PR0
        19 000325   200125 236100                    LDQ     CURRENT_COUNT,,AUTO
        19 000326   300000 552104                    STBQ    0,'04'O,PR3

      115    20461    2   END NEW_DCBNUM;

  20461 19 000327   200126 221300                    LDX1  ! CURRENT_COUNT+1,,AUTO
        19 000330   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:24   
      116    20462        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:25   
      117    20463    1   NEW_01_FAB: PROC (FILE$, FAB$, EXTERNAL_FLAG);

  20463 19 000331   200126 741300       NEW_01_FAB   STX1  ! CURRENT_COUNT+1,,AUTO

      118    20464
      119    20465             %EQU FAB_STRING = '_FAB';
      120    20466
      121    20467    2        DCL FAB$          PTR;
      122    20468    2        DCL DNT$$         PTR;
      123    20469    2        DCL FILE$         PTR;
      124    20470    2        DCL LEN           SBIN;
      125    20471    2        DCL BUFFER        CHAR (60);
      126    20472    2        DCL EXTERNAL_FLAG BIT(1) ALIGNED;
      127    20473
      128    20474
      129    20475    2        LEX_SYMBOL.SIZE = FILE$ -> FILE_LTS.ST$ -> FD.DNT$ ->

  20475 19 000332   200127 470500                    LDP0    @FILE$,,AUTO
        19 000333   000000 471500                    LDP1    0,,PR0
        19 000334   100001 473500                    LDP3    1,,PR1
        19 000335   300006 474500                    LDP4    6,,PR3
        19 000336   400004 236100                    LDQ     4,,PR4
        19 000337   000022 772000                    QRL     18
        19 000340   000004 036007                    ADLQ    4,DL
        19 000341   000010 756000 14                 STQ     LEX_SYMBOL+8

      130    20476    2                          DNT.TEXT.LENGTH + 4;
      131    20477
      132    20478    2        CALL CONCAT (SUBSTR (LEX_SYMBOL.SYMBOL,0, LEX_SYMBOL.SIZE),

  20478 19 000342   000000 471500                    LDP1    0,,PR0
        19 000343   100001 473500                    LDP3    1,,PR1
        19 000344   300006 474500                    LDP4    6,,PR3
        19 000345   400004 220100                    LDX0    4,,PR4
        19 000346   000000 622006                    EAX2    0,QL
        19 000347   040040 100540                    MLR     fill='040'O
        19 000350   400004 400010                    ADSC9   4,,PR4                   cn=2,n=*X0
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:26   
        19 000351   000011 000012 14                 ADSC9   LEX_SYMBOL+9             cn=0,n=*X2
        19 000352   000000 635010                    EAA     0,X0
        19 000353   000022 771000                    ARL     18
        19 000354   200154 755100                    STA     BUFFER+15,,AUTO
        19 000355   000010 236000 14                 LDQ     LEX_SYMBOL+8
        19 000356   200154 136100                    SBLQ    BUFFER+15,,AUTO
        19 000357   000366 604400 19                 TMOZ    s:20482
        19 000360   000000 622006                    EAX2    0,QL
        19 000361   000000 636010                    EAQ     0,X0
        19 000362   000022 772000                    QRL     18
        19 000363   040046 100400                    MLR     fill='040'O
        19 000364   000002 000004 18                 ADSC9   2                        cn=0,n=4
        19 000365   000011 000012 14                 ADSC9   LEX_SYMBOL+9,Q           cn=0,n=*X2

      133    20479    2                     FILE$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.TEXT.NAME,
      134    20480    2                     %FAB_STRING);
      135    20481
      136    20482    2        CALL Z8AH$SEARCH_;

  20482 19 000366   000000 631400 20                 EPPR1   0
        19 000367   000000 701000 xent               TSX1    Z8AH$SEARCH_
        19 000370   000000 011000                    NOP     0

      137    20483
      138    20484    2        IF FILE$ -> FILE_LTS.ST$ -> FD.B.EXTERNAL AND (DNT$ -> DNT.ST$ ~= ADDR(NIL) )
             20484                 THEN

  20484 19 000371   200127 470500                    LDP0    @FILE$,,AUTO
        19 000372   000000 471500                    LDP1    0,,PR0
        19 000373   100001 473500                    LDP3    1,,PR1
        19 000374   300003 236100                    LDQ     3,,PR3
        19 000375   000004 316003                    CANQ    4,DU
        19 000376   000411 600000 19                 TZE     s:20491
        19 000377   000000 474400 4                  LDP4    DNT$
        19 000400   400001 236100                    LDQ     1,,PR4
        19 000401   000001 116000 20                 CMPQ    1
        19 000402   000411 600000 19                 TZE     s:20491
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:27   

      139    20485    3          DO;

      140    20486    3            FAB$ = DNT$ -> DNT.ST$;

  20486 19 000403   200130 475500                    LDP5    @FAB$,,AUTO
        19 000404   500000 756100                    STQ     0,,PR5

      141    20487    3            EXTERNAL_FLAG = %TRUE;

  20487 19 000405   400000 236003                    LDQ     -131072,DU
        19 000406   200131 471500                    LDP1    @EXTERNAL_FLAG,,AUTO
        19 000407   100000 756100                    STQ     0,,PR1

      142    20488    3          END;

  20488 19 000410   000706 710000 19                 TRA     s:20771

      143    20489    2        ELSE
      144    20490    3          DO;

      145    20491    3            DNT$$ = DNT$;

  20491 19 000411   000000 236000 4                  LDQ     DNT$
        19 000412   200132 756100                    STQ     DNT$$,,AUTO

      146    20492
      147    20493                 %PACK_ADSC (@DESC = DESC,
      148    20494                             @LENGTH = "SIZEC(FAB)");

  20498 19 000413   000000 220003                    LDX0    0,DU
        19 000414   200004 740100                    STX0    DESC,,AUTO

  20500 19 000415   000012 236000 20                 LDQ     10
        19 000416   200004 356100                    ANSQ    DESC,,AUTO

  20501 19 000417   000010 236000 20                 LDQ     8
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:28   
        19 000420   200004 356100                    ANSQ    DESC,,AUTO

  20513 19 000421   000013 236000 20                 LDQ     11
        19 000422   200004 356100                    ANSQ    DESC,,AUTO

  20514 19 000423   000014 236000 20                 LDQ     12
        19 000424   200004 356100                    ANSQ    DESC,,AUTO

  20515 19 000425   000370 236007                    LDQ     248,DL
        19 000426   200004 752103                    STCQ    DESC,'03'O,AUTO

      149    20518
      150    20519                 %NEW_SCALAR (@ST$   = FAB$,
      151    20520                              @TYPE  = %TYA,
      152    20521                              @DESCL = DESC.DESCL,
      153    20522                              @CLASS = %CLASS_ALPHANUMERIC,
      154    20523                              @ELEMENTARY = FALSE,
      155    20524                              @DNT$  = DNT$$);

  20528 19 000427   000002 236000 9                  LDQ     ST_+2
        19 000430   000013 036007                    ADLQ    11,DL
        19 000431   000003 116000 9                  CMPQ    ST_+3
        19 000432   000443 604000 19                 TMI     s:20530

  20529 19 000433   000003 236000 20                 LDQ     3
        19 000434   200154 756100                    STQ     BUFFER+15,,AUTO
        19 000435   200154 631500                    EPPR1   BUFFER+15,,AUTO
        19 000436   200155 451500                    STP1    BUFFER+16,,AUTO
        19 000437   200155 630500                    EPPR0   BUFFER+16,,AUTO
        19 000440   000002 631400 20                 EPPR1   2
        19 000441   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000442   000000 011000                    NOP     0

  20530 19 000443   000002 236000 9                  LDQ     ST_+2
        19 000444   000022 736000                    QLS     18
        19 000445   000001 036000 9                  ADLQ    ST_+1
        19 000446   200130 470500                    LDP0    @FAB$,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:29   
        19 000447   000000 756100                    STQ     0,,PR0

  20531 19 000450   000013 236007                    LDQ     11,DL
        19 000451   000002 056000 9                  ASQ     ST_+2

  20579 19 000452   000000 471500                    LDP1    0,,PR0
        19 000453   000766 220003                    LDX0    502,DU
        19 000454   100000 740100                    STX0    0,,PR1

  20580 19 000455   000000 471500                    LDP1    0,,PR0
        19 000456   003000 236007                    LDQ     1536,DL
        19 000457   100000 552110                    STBQ    0,'10'O,PR1

  20581 19 000460   000000 471500                    LDP1    0,,PR0
        19 000461   000001 236007                    LDQ     1,DL
        19 000462   100000 552104                    STBQ    0,'04'O,PR1

  20582 19 000463   000000 471500                    LDP1    0,,PR0
        19 000464   000000 221003                    LDX1    0,DU
        19 000465   100001 741100                    STX1    1,,PR1

  20583 19 000466   000000 471500                    LDP1    0,,PR0
        19 000467   200004 722100                    LXL2    DESC,,AUTO
        19 000470   100001 442100                    SXL2    1,,PR1

  20584 19 000471   000000 471500                    LDP1    0,,PR0
        19 000472   000133 723000 xsym               LXL3    COMCOM+91
        19 000473   100002 443100                    SXL3    2,,PR1

  20585 19 000474   000000 471500                    LDP1    0,,PR0
        19 000475   100003 450100                    STZ     3,,PR1

  20586 19 000476   000000 471500                    LDP1    0,,PR0
        19 000477   000001 236000 20                 LDQ     1
        19 000500   100004 756100                    STQ     4,,PR1

  20587 19 000501   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:30   
        19 000502   100005 756100                    STQ     5,,PR1

  20588 19 000503   000000 471500                    LDP1    0,,PR0
        19 000504   100007 756100                    STQ     7,,PR1

  20589 19 000505   000000 471500                    LDP1    0,,PR0
        19 000506   100010 741100                    STX1    8,,PR1

  20590 19 000507   000000 471500                    LDP1    0,,PR0
        19 000510   777777 223003                    LDX3    -1,DU
        19 000511   100010 443100                    SXL3    8,,PR1

  20594 19 000512   000000 471500                    LDP1    0,,PR0
        19 000513   100012 756100                    STQ     10,,PR1

  20597 19 000514   000000 471500                    LDP1    0,,PR0
        19 000515   000057 236000 xsym               LDQ     O1COM+47
        19 000516   100011 756100                    STQ     9,,PR1

  20598 19 000517   000057 236000 xsym               LDQ     O1COM+47
        19 000520   000001 116000 20                 CMPQ    1
        19 000521   000545 600000 19                 TZE     s:20633

  20602 19 000522   000057 471400 xsym               LDP1    O1COM+47
        19 000523   100001 473500                    LDP3    1,,PR1
        19 000524   300012 236100                    LDQ     10,,PR3
        19 000525   000001 116000 20                 CMPQ    1
        19 000526   000536 601000 19                 TNZ     s:20609

  20604 19 000527   000000 236100                    LDQ     0,,PR0
        19 000530   300011 756100                    STQ     9,,PR3

  20605 19 000531   000057 471400 xsym               LDP1    O1COM+47
        19 000532   100001 473500                    LDP3    1,,PR1
        19 000533   000000 236100                    LDQ     0,,PR0
        19 000534   300012 756100                    STQ     10,,PR3

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:31   
  20606 19 000535   000545 710000 19                 TRA     s:20633

  20609 19 000536   300012 474500                    LDP4    10,,PR3
        19 000537   000000 236100                    LDQ     0,,PR0
        19 000540   400012 756100                    STQ     10,,PR4

  20610 19 000541   000057 471400 xsym               LDP1    O1COM+47
        19 000542   100001 473500                    LDP3    1,,PR1
        19 000543   000000 236100                    LDQ     0,,PR0
        19 000544   300012 756100                    STQ     10,,PR3

  20633 19 000545   000000 471500                    LDP1    0,,PR0
        19 000546   000010 224003                    LDX4    8,DU
        19 000547   100002 744100                    STX4    2,,PR1

  20638 19 000550   000000 471500                    LDP1    0,,PR0
        19 000551   200132 236100                    LDQ     DNT$$,,AUTO
        19 000552   100006 756100                    STQ     6,,PR1

  20655 19 000553   000000 471500                    LDP1    0,,PR0
        19 000554   000015 236000 20                 LDQ     13
        19 000555   100003 356100                    ANSQ    3,,PR1

  20703 19 000556   000000 471500                    LDP1    0,,PR0
        19 000557   100003 236100                    LDQ     3,,PR1
        19 000560   000004 376000 20                 ANQ     4
        19 000561   000003 276007                    ORQ     3,DL
        19 000562   100003 756100                    STQ     3,,PR1

      156    20724
      157    20725    3            DNT$$ -> DNT.ST$ = FAB$;

  20725 19 000563   000000 236100                    LDQ     0,,PR0
        19 000564   200132 471500                    LDP1    DNT$$,,AUTO
        19 000565   100001 756100                    STQ     1,,PR1

      158    20726
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:32   
      159    20727                 %NEW_QLT (@POINTER = FAB$ -> SCALAR.QLT$,
      160    20728                           @LEVEL#  = 01,
      161    20729                           @ST$     = FAB$,
      162    20730                           @DNT$    = DNT$$);

  20735 19 000566   000002 236000 13                 LDQ     QLT_+2
        19 000567   000006 036007                    ADLQ    6,DL
        19 000570   000003 116000 13                 CMPQ    QLT_+3
        19 000571   000602 602000 19                 TNC     s:20737

  20736 19 000572   000005 236000 20                 LDQ     5
        19 000573   200154 756100                    STQ     BUFFER+15,,AUTO
        19 000574   200154 633500                    EPPR3   BUFFER+15,,AUTO
        19 000575   200155 453500                    STP3    BUFFER+16,,AUTO
        19 000576   200155 630500                    EPPR0   BUFFER+16,,AUTO
        19 000577   000002 631400 20                 EPPR1   2
        19 000600   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000601   000000 011000                    NOP     0

  20737 19 000602   200130 470500                    LDP0    @FAB$,,AUTO
        19 000603   000000 471500                    LDP1    0,,PR0
        19 000604   000002 236000 13                 LDQ     QLT_+2
        19 000605   000022 736000                    QLS     18
        19 000606   000001 036000 13                 ADLQ    QLT_+1
        19 000607   100007 756100                    STQ     7,,PR1

  20738 19 000610   000002 235000 13                 LDA     QLT_+2
        19 000611   000006 035007                    ADLA    6,DL
        19 000612   000002 755000 13                 STA     QLT_+2

  20739 19 000613   000000 471500                    LDP1    0,,PR0
        19 000614   100007 473500                    LDP3    7,,PR1
        19 000615   001053 220003                    LDX0    555,DU
        19 000616   300000 740100                    STX0    0,,PR3

  20742 19 000617   000000 471500                    LDP1    0,,PR0
        19 000620   100007 473500                    LDP3    7,,PR1
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:33   
        19 000621   000001 236000 20                 LDQ     1
        19 000622   300001 756100                    STQ     1,,PR3

  20743 19 000623   000000 471500                    LDP1    0,,PR0
        19 000624   100007 473500                    LDP3    7,,PR1
        19 000625   000001 236000 20                 LDQ     1
        19 000626   300002 756100                    STQ     2,,PR3

  20744 19 000627   000000 471500                    LDP1    0,,PR0
        19 000630   100007 473500                    LDP3    7,,PR1
        19 000631   300003 756100                    STQ     3,,PR3

  20745 19 000632   000000 471500                    LDP1    0,,PR0
        19 000633   100007 473500                    LDP3    7,,PR1
        19 000634   000000 236100                    LDQ     0,,PR0
        19 000635   300004 756100                    STQ     4,,PR3

  20746 19 000636   000000 471500                    LDP1    0,,PR0
        19 000637   100007 473500                    LDP3    7,,PR1
        19 000640   200132 236100                    LDQ     DNT$$,,AUTO
        19 000641   300005 756100                    STQ     5,,PR3

  20747 19 000642   000000 471500                    LDP1    0,,PR0
        19 000643   100007 473500                    LDP3    7,,PR1
        19 000644   000001 236007                    LDQ     1,DL
        19 000645   300000 552104                    STBQ    0,'04'O,PR3

  20748 19 000646   000000 471500                    LDP1    0,,PR0
        19 000647   100007 473500                    LDP3    7,,PR1
        19 000650   000000 236003                    LDQ     0,DU
        19 000651   300000 552110                    STBQ    0,'10'O,PR3

  20749 19 000652   000000 471500                    LDP1    0,,PR0
        19 000653   100007 473500                    LDP3    7,,PR1
        19 000654   000006 236000 20                 LDQ     6
        19 000655   300000 356100                    ANSQ    0,,PR3

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:34   
  20750 19 000656   000000 471500                    LDP1    0,,PR0
        19 000657   100007 473500                    LDP3    7,,PR1
        19 000660   000007 236000 20                 LDQ     7
        19 000661   300000 356100                    ANSQ    0,,PR3

  20751 19 000662   000000 471500                    LDP1    0,,PR0
        19 000663   100007 473500                    LDP3    7,,PR1
        19 000664   000010 236000 20                 LDQ     8
        19 000665   300000 356100                    ANSQ    0,,PR3

  20752 19 000666   000000 471500                    LDP1    0,,PR0
        19 000667   100007 473500                    LDP3    7,,PR1
        19 000670   000011 236000 20                 LDQ     9
        19 000671   300000 356100                    ANSQ    0,,PR3

      163    20755
      164    20756
      165    20757
      166    20758
      167    20759                 %UPDATE_PREV_QLT$ (@NEW_QLT$ = FAB$ -> SCALAR.QLT$);

  20761 19 000672   000424 236000 xsym               LDQ     COMCOM+276
        19 000673   000001 116000 20                 CMPQ    1
        19 000674   000701 600000 19                 TZE     s:20763

  20762 19 000675   000000 471500                    LDP1    0,,PR0
        19 000676   100007 236100                    LDQ     7,,PR1
        19 000677   000424 473400 xsym               LDP3    COMCOM+276
        19 000700   300002 756100                    STQ     2,,PR3

  20763 19 000701   000000 471500                    LDP1    0,,PR0
        19 000702   100007 236100                    LDQ     7,,PR1
        19 000703   000424 756000 xsym               STQ     COMCOM+276

      168    20766
      169    20767    3            EXTERNAL_FLAG = %FALSE;

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:35   
  20767 19 000704   200131 471500                    LDP1    @EXTERNAL_FLAG,,AUTO
        19 000705   100000 450100                    STZ     0,,PR1

      170    20768
      171    20769    3          END;

      172    20770
      173    20771    2   END NEW_01_FAB;

  20771 19 000706   200126 221300                    LDX1  ! CURRENT_COUNT+1,,AUTO
        19 000707   000001 702211                    TSX2  ! 1,X1

      174    20772        %EJECT;
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:36   
      175    20773
      176    20774             /*
      177    20775                      Main Procedure
      178    20776             */
      179    20777
      180    20778                                      /*      This is a kludge.  Only FABS are needed
      181    20779                                              for FD's on CP-6.  GCOS needs them for
      182    20780                                              SD's also.
      183    20781                                      */
      184    20782    1        IF FILE$ -> FILE_LTS.ST$ -> ST.ID ~= %FD  THEN

  20782 19 000710   200003 470500                    LDP0    @FILE$,,AUTO
        19 000711   000000 471500                    LDP1    0,,PR0
        19 000712   100001 473500                    LDP3    1,,PR1
        19 000713   300000 220100                    LDX0    0,,PR3
        19 000714   001002 100003                    CMPX0   514,DU
        19 000715   000717 600000 19                 TZE     s:20786

      185    20783    1           RETURN;

  20783 19 000716   000000 702200 xent               TSX2  ! X66_ARET

      186    20784
      187    20785
      188    20786    1        F_DNT$ = FILE$ -> FILE_LTS.ST$ -> FD.DNT$;

  20786 19 000717   300006 236100                    LDQ     6,,PR3
        19 000720   200105 756100                    STQ     F_DNT$,,AUTO

      189    20787
      190    20788    1        CALL NEW_01_FAB (FILE$, FAB$, EXTERNAL_FLAG);

  20788 19 000721   200124 631500                    EPPR1   EXTERNAL_FLAG,,AUTO
        19 000722   200131 451500                    STP1    @FAB$+1,,AUTO
        19 000723   200106 633500                    EPPR3   FAB$,,AUTO
        19 000724   200130 453500                    STP3    @FILE$+1,,AUTO
        19 000725   200003 236100                    LDQ     @FILE$,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:37   
        19 000726   200127 756100                    STQ     CURRENT_COUNT+2,,AUTO
        19 000727   000331 701000 19                 TSX1    NEW_01_FAB
        19 000730   000000 011000                    NOP     0

      191    20789
      192    20790    1        CURRENT_COUNT = FAB$ -> ST.COUNT;

  20790 19 000731   200106 470500                    LDP0    FAB$,,AUTO
        19 000732   000000 236100                    LDQ     0,,PR0
        19 000733   000777 376007                    ANQ     511,DL
        19 000734   200125 756100                    STQ     CURRENT_COUNT,,AUTO

      193    20791
      194    20792    1        IF NOT EXTERNAL_FLAG    THEN

  20792 19 000735   200124 234100                    SZN     EXTERNAL_FLAG,,AUTO
        19 000736   001253 604000 19                 TMI     s:20980

      195    20793    2          DO;

      196    20794
      197    20795    2            IF FILE$ -> FILE_LTS.ST$ -> FD.B.EXTERNAL      THEN

  20795 19 000737   200003 471500                    LDP1    @FILE$,,AUTO
        19 000740   100000 473500                    LDP3    0,,PR1
        19 000741   300001 474500                    LDP4    1,,PR3
        19 000742   400003 236100                    LDQ     3,,PR4
        19 000743   000004 316003                    CANQ    4,DU
        19 000744   001104 600000 19                 TZE     s:20894

      198    20796    3              DO;

      199    20797
      200    20798    3                FLEN = F_DNT$ -> DNT.TEXT.LENGTH;

  20798 19 000745   200105 475500                    LDP5    F_DNT$,,AUTO
        19 000746   500004 236100                    LDQ     4,,PR5
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:38   
        19 000747   000022 772000                    QRL     18
        19 000750   200112 756100                    STQ     FLEN,,AUTO

      201    20799    3                FNAME = F_DNT$ -> DNT.TEXT.NAME;

  20799 19 000751   500004 220100                    LDX0    4,,PR5
        19 000752   040100 100540                    MLR     fill='040'O
        19 000753   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        19 000754   200113 000036                    ADSC9   FNAME,,AUTO              cn=0,n=30

      202    20800
      203    20801    3                LEX_SYMBOL.SIZE = FLEN + 2;

  20801 19 000755   000002 036007                    ADLQ    2,DL
        19 000756   000010 756000 14                 STQ     LEX_SYMBOL+8

      204    20802
      205    20803    3                CALL CONCAT( SUBSTR( LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE ),

  20803 19 000757   000000 620006                    EAX0    0,QL
        19 000760   040040 100400                    MLR     fill='040'O
        19 000761   000003 000002 18                 ADSC9   3                        cn=0,n=2
        19 000762   000011 000010 14                 ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        19 000763   000010 236000 14                 LDQ     LEX_SYMBOL+8
        19 000764   000002 116007                    CMPQ    2,DL
        19 000765   000773 604400 19                 TMOZ    s:20805
        19 000766   777776 620006                    EAX0    -2,QL
        19 000767   200112 721100                    LXL1    FLEN,,AUTO
        19 000770   040040 100540                    MLR     fill='040'O
        19 000771   200113 000011                    ADSC9   FNAME,,AUTO              cn=0,n=*X1
        19 000772   000011 400010 14                 ADSC9   LEX_SYMBOL+9             cn=2,n=*X0

      206    20804    3                             'F#', SUBSTR( FNAME, 0, FLEN ) );
      207    20805    3                CALL Z8AH$SEARCH_;

  20805 19 000773   000000 631400 20                 EPPR1   0
        19 000774   000000 701000 xent               TSX1    Z8AH$SEARCH_
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:39   
        19 000775   000000 011000                    NOP     0

      208    20806
      209    20807                     %NEW_BLOCK( @ST$  = BLOCK$,
      210    20808                                 @DNT$ = DNT$,
      211    20809                                 @SIZE = "SIZEC( FAB )" );

  20813 19 000776   000002 236000 9                  LDQ     ST_+2
        19 000777   000013 036007                    ADLQ    11,DL
        19 001000   000003 116000 9                  CMPQ    ST_+3
        19 001001   001012 604000 19                 TMI     s:20815

  20814 19 001002   000003 236000 20                 LDQ     3
        19 001003   200154 756100                    STQ     BUFFER+15,,AUTO
        19 001004   200154 630500                    EPPR0   BUFFER+15,,AUTO
        19 001005   200155 450500                    STP0    BUFFER+16,,AUTO
        19 001006   200155 630500                    EPPR0   BUFFER+16,,AUTO
        19 001007   000002 631400 20                 EPPR1   2
        19 001010   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001011   000000 011000                    NOP     0

  20815 19 001012   000002 236000 9                  LDQ     ST_+2
        19 001013   000022 736000                    QLS     18
        19 001014   000001 036000 9                  ADLQ    ST_+1
        19 001015   200123 756100                    STQ     BLOCK$,,AUTO

  20816 19 001016   000013 236007                    LDQ     11,DL
        19 001017   000002 056000 9                  ASQ     ST_+2

  20820 19 001020   000144 054000 xsym               AOS     COMCOM+100

  20821 19 001021   200123 470500                    LDP0    BLOCK$,,AUTO
        19 001022   000144 236000 xsym               LDQ     COMCOM+100
        19 001023   000000 552104                    STBQ    0,'04'O,PR0

  20823 19 001024   200123 236100                    LDQ     BLOCK$,,AUTO
        19 001025   000004 471400 xsym               LDP1    O1COM+4
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:40   
        19 001026   100004 756100                    STQ     4,,PR1

  20824 19 001027   000004 756000 xsym               STQ     O1COM+4

  20829 19 001030   000774 220003                    LDX0    508,DU
        19 001031   000000 740100                    STX0    0,,PR0

  20830 19 001032   003000 236007                    LDQ     1536,DL
        19 001033   000000 552110                    STBQ    0,'10'O,PR0

  20831 19 001034   000370 221003                    LDX1    248,DU
        19 001035   000002 741100                    STX1    2,,PR0

  20832 19 001036   000133 722000 xsym               LXL2    COMCOM+91
        19 001037   000002 442100                    SXL2    2,,PR0

  20833 19 001040   000003 450100                    STZ     3,,PR0

  20834 19 001041   000001 236000 20                 LDQ     1
        19 001042   000004 756100                    STQ     4,,PR0

  20835 19 001043   000000 236000 4                  LDQ     DNT$
        19 001044   000006 756100                    STQ     6,,PR0

  20836 19 001045   000001 236000 20                 LDQ     1
        19 001046   000007 756100                    STQ     7,,PR0

  20846 19 001047   000012 756100                    STQ     10,,PR0

  20849 19 001050   000057 236000 xsym               LDQ     O1COM+47
        19 001051   000011 756100                    STQ     9,,PR0

  20850 19 001052   000057 236000 xsym               LDQ     O1COM+47
        19 001053   000001 116000 20                 CMPQ    1
        19 001054   001076 600000 19                 TZE     s:20886

  20854 19 001055   000057 471400 xsym               LDP1    O1COM+47
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:41   
        19 001056   100001 473500                    LDP3    1,,PR1
        19 001057   300012 236100                    LDQ     10,,PR3
        19 001060   000001 116000 20                 CMPQ    1
        19 001061   001070 601000 19                 TNZ     s:20861

  20856 19 001062   200123 236100                    LDQ     BLOCK$,,AUTO
        19 001063   300011 756100                    STQ     9,,PR3

  20857 19 001064   000057 471400 xsym               LDP1    O1COM+47
        19 001065   100001 473500                    LDP3    1,,PR1
        19 001066   300012 756100                    STQ     10,,PR3

  20858 19 001067   001076 710000 19                 TRA     s:20886

  20861 19 001070   300012 474500                    LDP4    10,,PR3
        19 001071   200123 236100                    LDQ     BLOCK$,,AUTO
        19 001072   400012 756100                    STQ     10,,PR4

  20862 19 001073   000057 471400 xsym               LDP1    O1COM+47
        19 001074   100001 473500                    LDP3    1,,PR1
        19 001075   300012 756100                    STQ     10,,PR3

      212    20886    3                FAB$ -> ST.COUNT = BLOCK$ -> BLOCK.COUNT;

  20886 19 001076   200106 471500                    LDP1    FAB$,,AUTO
        19 001077   000000 236100                    LDQ     0,,PR0
        19 001100   100000 552104                    STBQ    0,'04'O,PR1

      213    20887    3                CURRENT_COUNT = BLOCK$ -> BLOCK.COUNT;

  20887 19 001101   000000 236100                    LDQ     0,,PR0
        19 001102   000777 376007                    ANQ     511,DL
        19 001103   200125 756100                    STQ     CURRENT_COUNT,,AUTO

      214    20888
      215    20889    3              END;

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:42   
      216    20890
      217    20891
      218    20892                 /* Build the constant portion of the FAB */
      219    20893
      220    20894    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'CONST', 5, RETURN$);

  20894 19 001104   200110 630500                    EPPR0   RETURN$,,AUTO
        19 001105   200161 450500                    STP0    BUFFER+20,,AUTO
        19 001106   000022 236000 20                 LDQ     18
        19 001107   200160 756100                    STQ     BUFFER+19,,AUTO
        19 001110   000024 237000 20                 LDAQ    20
        19 001111   200156 757100                    STAQ    BUFFER+17,,AUTO
        19 001112   000026 236000 20                 LDQ     22
        19 001113   200155 756100                    STQ     BUFFER+16,,AUTO
        19 001114   200105 631500                    EPPR1   F_DNT$,,AUTO
        19 001115   200154 451500                    STP1    BUFFER+15,,AUTO
        19 001116   200154 630500                    EPPR0   BUFFER+15,,AUTO
        19 001117   000016 631400 20                 EPPR1   14
        19 001120   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        19 001121   000000 011000                    NOP     0

      221    20895
      222    20896
      223    20897                 %PACK_ADSC (@DESC = DESC,
      224    20898                             @LENGTH = "SIZEC(FAB_CONST_LENGTH)");

  20902 19 001122   000000 220003                    LDX0    0,DU
        19 001123   200004 740100                    STX0    DESC,,AUTO

  20904 19 001124   000012 236000 20                 LDQ     10
        19 001125   200004 356100                    ANSQ    DESC,,AUTO

  20905 19 001126   000010 236000 20                 LDQ     8
        19 001127   200004 356100                    ANSQ    DESC,,AUTO

  20917 19 001130   000013 236000 20                 LDQ     11
        19 001131   200004 356100                    ANSQ    DESC,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:43   

  20918 19 001132   000014 236000 20                 LDQ     12
        19 001133   200004 356100                    ANSQ    DESC,,AUTO

  20919 19 001134   000154 236007                    LDQ     108,DL
        19 001135   200004 752103                    STCQ    DESC,'03'O,AUTO

      225    20922
      226    20923    2            RETURN$ -> ST.DESCL = DESC.DESCL;

  20923 19 001136   200004 721100                    LXL1    DESC,,AUTO
        19 001137   200110 470500                    LDP0    RETURN$,,AUTO
        19 001140   000001 441100                    SXL1    1,,PR0

      227    20924    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;

  20924 19 001141   200110 470500                    LDP0    RETURN$,,AUTO
        19 001142   200125 236100                    LDQ     CURRENT_COUNT,,AUTO
        19 001143   000000 552104                    STBQ    0,'04'O,PR0

      228    20925
      229    20926
      230    20927                 /* Build the Length_read and DCBNUM fields of the Fab;
      231    20928                    These fields have explicit symbol table items so that
      232    20929                        they can be referenced by the compiler
      233    20930                 */
      234    20931    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, 'LENGTH_READ', 11, RETURN$);

  20931 19 001144   200110 630500                    EPPR0   RETURN$,,AUTO
        19 001145   200161 450500                    STP0    BUFFER+20,,AUTO
        19 001146   000031 236000 20                 LDQ     25
        19 001147   200160 756100                    STQ     BUFFER+19,,AUTO
        19 001150   000032 237000 20                 LDAQ    26
        19 001151   200156 757100                    STAQ    BUFFER+17,,AUTO
        19 001152   000026 236000 20                 LDQ     22
        19 001153   200155 756100                    STQ     BUFFER+16,,AUTO
        19 001154   200105 631500                    EPPR1   F_DNT$,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:44   
        19 001155   200154 451500                    STP1    BUFFER+15,,AUTO
        19 001156   200154 630500                    EPPR0   BUFFER+15,,AUTO
        19 001157   000016 631400 20                 EPPR1   14
        19 001160   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        19 001161   000000 011000                    NOP     0

      235    20932    2            RETURN$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH);

  20932 19 001162   000033 220003                    LDX0    27,DU
        19 001163   200110 470500                    LDP0    RETURN$,,AUTO
        19 001164   000001 740100                    STX0    1,,PR0

      236    20933    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;

  20933 19 001165   200110 470500                    LDP0    RETURN$,,AUTO
        19 001166   200125 236100                    LDQ     CURRENT_COUNT,,AUTO
        19 001167   000000 552104                    STBQ    0,'04'O,PR0

      237    20934
      238    20935    2            FILE$ -> FILE_LTS.LENGTH_READ$ = RETURN$;

  20935 19 001170   200003 470500                    LDP0    @FILE$,,AUTO
        19 001171   000000 471500                    LDP1    0,,PR0
        19 001172   200110 236100                    LDQ     RETURN$,,AUTO
        19 001173   100053 756100                    STQ     43,,PR1

      239    20936
      240    20937
      241    20938    2            CALL NEW_DCBNUM (FILE$, FAB$, RETURN$ -> SCALAR.QLT$, DCBNUM$);

  20938 19 001174   200107 631500                    EPPR1   DCBNUM$,,AUTO
        19 001175   200132 451500                    STP1    @EXTERNAL_FLAG+1,,AUTO
        19 001176   200110 236100                    LDQ     RETURN$,,AUTO
        19 001177   000007 036003                    ADLQ    7,DU
        19 001200   200131 756100                    STQ     @FAB$+1,,AUTO
        19 001201   200106 633500                    EPPR3   FAB$,,AUTO
        19 001202   200130 453500                    STP3    @FILE$+1,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:45   
        19 001203   200003 236100                    LDQ     @FILE$,,AUTO
        19 001204   200127 756100                    STQ     CURRENT_COUNT+2,,AUTO
        19 001205   000003 701000 19                 TSX1    NEW_DCBNUM
        19 001206   000000 011000                    NOP     0

      242    20939
      243    20940
      244    20941                 /* Build the variable portion of the FAB;  This portion is
      245    20942                        initialized by PRESET/PTR_SET ILL items */
      246    20943
      247    20944    2            CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'VAR', 3, RETURN$);

  20944 19 001207   200110 630500                    EPPR0   RETURN$,,AUTO
        19 001210   200161 450500                    STP0    BUFFER+20,,AUTO
        19 001211   000035 236000 20                 LDQ     29
        19 001212   200160 756100                    STQ     BUFFER+19,,AUTO
        19 001213   000036 237000 20                 LDAQ    30
        19 001214   200156 757100                    STAQ    BUFFER+17,,AUTO
        19 001215   000026 236000 20                 LDQ     22
        19 001216   200155 756100                    STQ     BUFFER+16,,AUTO
        19 001217   200105 631500                    EPPR1   F_DNT$,,AUTO
        19 001220   200154 451500                    STP1    BUFFER+15,,AUTO
        19 001221   200154 630500                    EPPR0   BUFFER+15,,AUTO
        19 001222   000016 631400 20                 EPPR1   14
        19 001223   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        19 001224   000000 011000                    NOP     0

      248    20945    2            RETURN$ -> SCALAR.SA = SIZEW(FAB_CONST_LENGTH) + 2;

  20945 19 001225   000035 220003                    LDX0    29,DU
        19 001226   200110 470500                    LDP0    RETURN$,,AUTO
        19 001227   000001 740100                    STX0    1,,PR0

      249    20946    2            RETURN$ -> ST.COUNT = CURRENT_COUNT;

  20946 19 001230   200110 470500                    LDP0    RETURN$,,AUTO
        19 001231   200125 236100                    LDQ     CURRENT_COUNT,,AUTO
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:46   
        19 001232   000000 552104                    STBQ    0,'04'O,PR0

      250    20947
      251    20948                 %PACK_ADSC (@DESC = DESC,
      252    20949                             @LENGTH = "SIZEC(FAB_VAR_LENGTH)");

  20953 19 001233   000000 221003                    LDX1    0,DU
        19 001234   200004 741100                    STX1    DESC,,AUTO

  20955 19 001235   000012 236000 20                 LDQ     10
        19 001236   200004 356100                    ANSQ    DESC,,AUTO

  20956 19 001237   000010 236000 20                 LDQ     8
        19 001240   200004 356100                    ANSQ    DESC,,AUTO

  20968 19 001241   000013 236000 20                 LDQ     11
        19 001242   200004 356100                    ANSQ    DESC,,AUTO

  20969 19 001243   000014 236000 20                 LDQ     12
        19 001244   200004 356100                    ANSQ    DESC,,AUTO

  20970 19 001245   000210 236007                    LDQ     136,DL
        19 001246   200004 752103                    STCQ    DESC,'03'O,AUTO

      253    20973
      254    20974    2            RETURN$ -> ST.DESCL = DESC.DESCL;

  20974 19 001247   200004 722100                    LXL2    DESC,,AUTO
        19 001250   200110 470500                    LDP0    RETURN$,,AUTO
        19 001251   000001 442100                    SXL2    1,,PR0

      255    20975
      256    20976    2          END;

  20976 19 001252   001262 710000 19                 TRA     s:20987

      257    20977
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:47   
      258    20978    1        ELSE
      259    20979                     /*  Pickup LENGTH_READ$ from QLT table  */
      260    20980    1          FILE$ -> FILE_LTS.LENGTH_READ$ = FAB$ -> SCALAR.QLT$ -> QLT.SON

  20980 19 001253   200003 471500                    LDP1    @FILE$,,AUTO
        19 001254   100000 473500                    LDP3    0,,PR1
        19 001255   000007 474500                    LDP4    7,,PR0
        19 001256   400003 475500                    LDP5    3,,PR4
        19 001257   500002 476500                    LDP6    2,,PR5
        19 001260   600004 236100                    LDQ     4,,PR6
        19 001261   300053 756100                    STQ     43,,PR3

      261    20981    1                           -> QLT.BROTHER -> QLT.ST$;
      262    20982
      263    20983
      264    20984
      265    20985             /* finish up */
      266    20986
      267    20987    1        FILE$ -> FILE_LTS.FAB$ = FAB$;

  20987 19 001262   200003 470500                    LDP0    @FILE$,,AUTO
        19 001263   000000 471500                    LDP1    0,,PR0
        19 001264   200106 236100                    LDQ     FAB$,,AUTO
        19 001265   100002 756100                    STQ     2,,PR1

      268    20988
      269    20989
      270    20990
      271    20991    1   END Z9DI$FAB_FIB_BUILD;

  20991 19 001266   000000 702200 xent               TSX2  ! X66_ARET
      272    20992        %EOD;

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:48   
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z9DI$FAB_FIB_BUILD.
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:49   

 **** Variables and constants ****

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 003 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 004 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 005 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:50   
  ****  Section 006 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 007 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 008 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 009 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 010 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)          1 MKCN

  ****  Section 011 LblCom QLT$

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:51   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 012 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 013 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 QLT_

  ****  Section 014 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 015 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 016 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:52   

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 017 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   132-0-0/w PTR         r     1 @DCBNUM$                 131-0-0/w PTR         r     1 @EXTERNAL_FLAG
   130-0-0/w PTR         r     1 @FAB$                    130-0-0/w PTR         r     1 @FAB$
     3-0-0/w PTR         r     1 @FILE$                   127-0-0/w PTR         r     1 @FILE$
   127-0-0/w PTR         r     1 @FILE$                   131-0-0/w PTR         r     1 @QLT$$
   123-0-0/w PTR         r     1 BLOCK$                   135-0-0/c CHAR(60)          1 BUFFER
   134-0-0/c CHAR(60)          1 BUFFER                   125-0-0/w SBIN        r     1 CURRENT_COUNT
   107-0-0/w PTR         r     1 DCBNUM$                   *0-0-0/w PTR         r     1 DCBNUM$
     4-0-0/w STRC        r     1 DESC                     111-0-0/w PTR               1 DNT$$
   133-0-0/w PTR         r     1 DNT$$                    132-0-0/w PTR         r     1 DNT$$
   124-0-0/w BIT         r     1 EXTERNAL_FLAG             *0-0-0/w BIT         r     1 EXTERNAL_FLAG
     6-0-0/d STRC(2232)  r     1 FAB                      106-0-0/w PTR         r     1 FAB$
    *0-0-0/w PTR         r     1 FAB$                      *0-0-0/w PTR         r     1 FAB$
    *0-0-0/w PTR         r     1 FILE$                     *0-0-0/w PTR         r     1 FILE$
    *0-0-0/w PTR         r     1 FILE$                    112-0-0/w SBIN        r     1 FLEN
   113-0-0/c CHAR(30)    r     1 FNAME                    105-0-0/w PTR         r     1 F_DNT$
   104-0-0/w SBIN              1 LEN                      134-0-0/w SBIN              1 LEN
   133-0-0/w SBIN              1 LEN                       *0-0-0/w PTR         r     1 QLT$$
   110-0-0/w PTR         r     1 RETURN$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:53   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)   r     1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(972)   r     1 FAB_CONST_LENGTH           0-0-0/d STRC(1224)  r     1 FAB_VAR_LENGTH
     0-0-0/w STRC(396)   r     1 FD                         0-0-0/w STRC(1692)  r     1 FILE_LTS
PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:54   
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC              1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #001=Z9DI$FAB_FIB_BUILD File=Z9DI.:Z8A6TSI                         SAT 08/09/97 13:42 Page:55   

   Procedure Z9DI$FAB_FIB_BUILD requires 695 words for executable code.
   Procedure Z9DI$FAB_FIB_BUILD requires 114 words of local(AUTO) storage.

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:56   
      273        1        /*T***********************************************************/
      274        2        /*T*                                                         */
      275        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      276        4        /*T*                                                         */
      277        5        /*T***********************************************************/
      278        6        Z9DI$BLK_CONTAINS: PROC (LTS$$, LENGTH);
      279        7
      280        8             %EQU PHASE = 1;
      281        9             %EQU RCW_LENGTH = 4; /* Byte units */
      282       10
      283       11             %INCLUDE Z8A_DEFC;
      284       79             %INCLUDE Z8A_SUPP_MAC;
      285     2479             %INCLUDE Z8A_LTS;
      286     4556
      287     4557    1        DCL LTS$$         PTR;
      288     4558    1        DCL LENGTH        SBIN;
      289     4559    1        DCL BLOCK_IN_BYTES SBIN;
      290     4560
      291     4561
      292     4562    1        IF LTS$$ -> FILE_LTS.B.BLOCK_CONTAINS THEN
      293     4563    1          IF LTS$$ -> FILE_LTS.B.RECORDS_NOT_CHARS THEN
      294     4564    2            DO;
      295     4565    2              BLOCK_IN_BYTES = (LENGTH + %RCW_LENGTH)
      296     4566    2                             * LTS$$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;
      297     4567
      298     4568    2              LTS$$ -> FILE_LTS.BLOCK_CONTAINS.INT_2 = BLOCK_IN_BYTES;
      299     4569    2              LTS$$ -> FILE_LTS.B.RECORDS_NOT_CHARS = FALSE;
      300     4570    2            END;
      301     4571
      302     4572    1   END Z9DI$BLK_CONTAINS;
      303     4573        %EOD;

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:57   
--  Include file information  --

   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9DI$BLK_CONTAINS.

   Procedure Z9DI$BLK_CONTAINS requires 19 words for executable code.
   Procedure Z9DI$BLK_CONTAINS requires 6 words of local(AUTO) storage.

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:58   

 Object Unit name= Z9DI$BLK_CONTAINS                          File name= Z9DI.:Z8A6TOU
 UTS= AUG 09 '97 13:45:05.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  LTS$
    2  LblCom even  none     5      5  LTS_
    3   Proc  even  none    19     23  Z9DI$BLK_CONTAINS
    4  RoData even  none     1      1  Z9DI$BLK_CONTAINS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        2  Z9DI$BLK_CONTAINS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    LTS_STEP
PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:59   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:60   


      273        1        /*T***********************************************************/
      274        2        /*T*                                                         */
      275        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      276        4        /*T*                                                         */
      277        5        /*T***********************************************************/
      278        6        Z9DI$BLK_CONTAINS: PROC (LTS$$, LENGTH);

      6  3 000000   000000 700200 xent  Z9DI$BLK_CO* TSX0  ! X66_AUTO_2
         3 000001   000006 000002                    ZERO    6,2

      279        7
      280        8             %EQU PHASE = 1;
      281        9             %EQU RCW_LENGTH = 4; /* Byte units */
      282       10
      283       11             %INCLUDE Z8A_DEFC;
      284       79             %INCLUDE Z8A_SUPP_MAC;
      285     2479             %INCLUDE Z8A_LTS;
      286     4556
      287     4557    1        DCL LTS$$         PTR;
      288     4558    1        DCL LENGTH        SBIN;
      289     4559    1        DCL BLOCK_IN_BYTES SBIN;
      290     4560
      291     4561
      292     4562    1        IF LTS$$ -> FILE_LTS.B.BLOCK_CONTAINS THEN

   4562  3 000002   200003 470500                    LDP0    @LTS$$,,AUTO
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   100017 236100                    LDQ     15,,PR1
         3 000005   200000 316007                    CANQ    65536,DL
         3 000006   000022 600000 3                  TZE     s:4572

      293     4563    1          IF LTS$$ -> FILE_LTS.B.RECORDS_NOT_CHARS THEN

   4563  3 000007   020000 316007                    CANQ    8192,DL
         3 000010   000022 600000 3                  TZE     s:4572

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:61   
      294     4564    2            DO;

      295     4565    2              BLOCK_IN_BYTES = (LENGTH + %RCW_LENGTH)

   4565  3 000011   200004 473500                    LDP3    @LENGTH,,AUTO
         3 000012   300000 236100                    LDQ     0,,PR3
         3 000013   000004 036007                    ADLQ    4,DL
         3 000014   100022 402100                    MPY     18,,PR1
         3 000015   200005 756100                    STQ     BLOCK_IN_BYTES,,AUTO

      296     4566    2                             * LTS$$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;
      297     4567
      298     4568    2              LTS$$ -> FILE_LTS.BLOCK_CONTAINS.INT_2 = BLOCK_IN_BYTES;

   4568  3 000016   100022 756100                    STQ     18,,PR1

      299     4569    2              LTS$$ -> FILE_LTS.B.RECORDS_NOT_CHARS = FALSE;

   4569  3 000017   000000 471500                    LDP1    0,,PR0
         3 000020   000000 236000 4                  LDQ     0
         3 000021   100017 356100                    ANSQ    15,,PR1

      300     4570    2            END;

      301     4571
      302     4572    1   END Z9DI$BLK_CONTAINS;

   4572  3 000022   000000 702200 xent               TSX2  ! X66_ARET
      303     4573        %EOD;

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:62   
--  Include file information  --

   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9DI$BLK_CONTAINS.
PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:63   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 002 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @LENGTH                    3-0-0/w PTR         r     1 @LTS$$
     5-0-0/w SBIN        r     1 BLOCK_IN_BYTES            *0-0-0/w SBIN        r     1 LENGTH
    *0-0-0/w PTR         r     1 LTS$$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=Z9DI$BLK_CONTAINS File=Z9DI.:Z8A6TSI                          SAT 08/09/97 13:45 Page:64   
     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(1692)  r     1 FILE_LTS
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC              1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(900)         1 PROC_SUPP
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP


   Procedure Z9DI$BLK_CONTAINS requires 19 words for executable code.
   Procedure Z9DI$BLK_CONTAINS requires 6 words of local(AUTO) storage.

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:65   
      304        1        /*T***********************************************************/
      305        2        /*T*                                                         */
      306        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      307        4        /*T*                                                         */
      308        5        /*T***********************************************************/
      309        6        Z9DI$KEY_LENGTH_CHECK: PROC (ST$$) ALTRET;
      310        7
      311        8         /*P*
      312        9               NAME : Z9DI$KEY_LENGTH_CHECK
      313       10               PURPOSE : Is to check the length of an indexed key.  If
      314       11                 too long issue a diagnostic.
      315       12         */
      316       13
      317       14             %EQU PHASE = 1;
      318       15             %EQU MAX_KEY_LENGTH = 255;
      319       16
      320       17             %INCLUDE Z8A_DEFC;
      321       85             %INCLUDE Z8A_SUPP_MAC;
      322     2485             %INCLUDE Z8A_ST;
      323     6144             %INCLUDE Z8A_LTS;
      324     8221             %INCLUDE Z8A_ERR_NUMS;
      325     8985
      326     8986    1        DCL Z8AE$ERROR    ENTRY (12);
      327     8987
      328     8988    1        DCL ST$$          PTR;
      329     8989    1        DCL LEN           SBIN;
      330     8990
      331     8991
      332     8992             %GET_ADSC_LEN (ST$ = ST$$,
      333     8993                            RTN = LEN);
      334     9004
      335     9005    1        IF LEN <= %MAX_KEY_LENGTH THEN
      336     9006    1          RETURN;
      337     9007    1        ELSE
      338     9008    1          CALL Z8AE$ERROR (%E$KEY_TOO_LONG,
      339     9009    1                           BINBIT(ST$$ -> ST.LINE_NO,36), 0);
      340     9010
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:66   
      341     9011    1        ALTRETURN;
      342     9012
      343     9013    1   END Z9DI$KEY_LENGTH_CHECK;

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:67   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9DI$KEY_LENGTH_CHECK.

   Procedure Z9DI$KEY_LENGTH_CHECK requires 39 words for executable code.
   Procedure Z9DI$KEY_LENGTH_CHECK requires 12 words of local(AUTO) storage.

    No errors detected in file Z9DI.:Z8A6TSI    .

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:68   

 Object Unit name= Z9DI$KEY_LENGTH_CHECK                      File name= Z9DI.:Z8A6TOU
 UTS= AUG 09 '97 13:45:36.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ST$
    2  LblCom even  none     5      5  ST_
    3  LblCom even  none     1      1  LTS$
    4  LblCom even  none     5      5  LTS_
    5   Proc  even  none    39     47  Z9DI$KEY_LENGTH_CHECK
    6  RoData even  none     5      5  Z9DI$KEY_LENGTH_CHECK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        1  Z9DI$KEY_LENGTH_CHECK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:69   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:70   


      304        1        /*T***********************************************************/
      305        2        /*T*                                                         */
      306        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      307        4        /*T*                                                         */
      308        5        /*T***********************************************************/
      309        6        Z9DI$KEY_LENGTH_CHECK: PROC (ST$$) ALTRET;

      6  5 000000   000000 700200 xent  Z9DI$KEY_LE* TSX0  ! X66_AUTO_1
         5 000001   000014 000001                    ZERO    12,1

      310        7
      311        8         /*P*
      312        9               NAME : Z9DI$KEY_LENGTH_CHECK
      313       10               PURPOSE : Is to check the length of an indexed key.  If
      314       11                 too long issue a diagnostic.
      315       12         */
      316       13
      317       14             %EQU PHASE = 1;
      318       15             %EQU MAX_KEY_LENGTH = 255;
      319       16
      320       17             %INCLUDE Z8A_DEFC;
      321       85             %INCLUDE Z8A_SUPP_MAC;
      322     2485             %INCLUDE Z8A_ST;
      323     6144             %INCLUDE Z8A_LTS;
      324     8221             %INCLUDE Z8A_ERR_NUMS;
      325     8985
      326     8986    1        DCL Z8AE$ERROR    ENTRY (12);
      327     8987
      328     8988    1        DCL ST$$          PTR;
      329     8989    1        DCL LEN           SBIN;
      330     8990
      331     8991
      332     8992             %GET_ADSC_LEN (ST$ = ST$$,
      333     8993                            RTN = LEN);

   8995  5 000002   200003 470500                    LDP0    @ST$$,,AUTO
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:71   
         5 000003   000000 471500                    LDP1    0,,PR0
         5 000004   100003 236100                    LDQ     3,,PR1
         5 000005   004000 316003                    CANQ    2048,DU
         5 000006   000022 600000 5                  TZE     s:9001

   8996  5 000007   100005 473500                    LDP3    5,,PR1
         5 000010   300000 220100                    LDX0    0,,PR3
         5 000011   001105 100003                    CMPX0   581,DU
         5 000012   000017 601000 5                  TNZ     s:8999

   8997  5 000013   300003 474500                    LDP4    3,,PR3
         5 000014   400001 235100                    LDA     1,,PR4
         5 000015   200004 755100                    STA     LEN,,AUTO
         5 000016   000025 710000 5                  TRA     s:9005

   8999  5 000017   300001 235100                    LDA     1,,PR3
         5 000020   200004 755100                    STA     LEN,,AUTO
         5 000021   000025 710000 5                  TRA     s:9005

   9001  5 000022   100001 236100                    LDQ     1,,PR1
         5 000023   007777 376007                    ANQ     4095,DL
         5 000024   200004 756100                    STQ     LEN,,AUTO

      334     9004
      335     9005    1        IF LEN <= %MAX_KEY_LENGTH THEN

   9005  5 000025   200004 235100                    LDA     LEN,,AUTO
         5 000026   000377 115007                    CMPA    255,DL
         5 000027   000031 605400 5                  TPNZ    s:9008

      336     9006    1          RETURN;

   9006  5 000030   000000 702200 xent               TSX2  ! X66_ARET

      337     9007    1        ELSE
      338     9008    1          CALL Z8AE$ERROR (%E$KEY_TOO_LONG,

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:72   
   9008  5 000031   100002 236100                    LDQ     2,,PR1
         5 000032   777777 376007                    ANQ     -1,DL
         5 000033   200006 756100                    STQ     LEN+2,,AUTO
         5 000034   000003 236000 6                  LDQ     3
         5 000035   200012 756100                    STQ     LEN+6,,AUTO
         5 000036   200006 631500                    EPPR1   LEN+2,,AUTO
         5 000037   200011 451500                    STP1    LEN+5,,AUTO
         5 000040   000004 236000 6                  LDQ     4
         5 000041   200010 756100                    STQ     LEN+4,,AUTO
         5 000042   200010 630500                    EPPR0   LEN+4,,AUTO
         5 000043   000000 631400 6                  EPPR1   0
         5 000044   000000 701000 xent               TSX1    Z8AE$ERROR
         5 000045   000000 011000                    NOP     0

      339     9009    1                           BINBIT(ST$$ -> ST.LINE_NO,36), 0);
      340     9010
      341     9011    1        ALTRETURN;

   9011  5 000046   000000 702200 xent               TSX2  ! X66_AALT
      342     9012
      343     9013    1   END Z9DI$KEY_LENGTH_CHECK;

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:73   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9DI$KEY_LENGTH_CHECK.
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:74   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 002 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 003 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 004 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:75   
  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ST$$                      4-0-0/w SBIN        r     1 LEN
    *0-0-0/w PTR         r     1 ST$$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BT                         0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)         1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(540)         1 CONTROL_NAME_LTS           0-0-0/w STRC(1872)        1 COPY_FILE
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(36864)       1 LCNST
PL6.E3A0      #003=Z9DI$KEY_LENGTH_CHECK File=Z9DI.:Z8A6TSI                      SAT 08/09/97 13:45 Page:76   
     0-0-0/w STRC(72)    r     1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)   r     1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE


   Procedure Z9DI$KEY_LENGTH_CHECK requires 39 words for executable code.
   Procedure Z9DI$KEY_LENGTH_CHECK requires 12 words of local(AUTO) storage.

    No errors detected in file Z9DI.:Z8A6TSI    .
