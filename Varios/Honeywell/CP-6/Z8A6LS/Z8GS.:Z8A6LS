VERSION A06

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:1    
        1        1        /*M* Z8GS$SCAN_MAX -- Scan Triad Tree for Max Seq# */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*   NAME: Z8GS$SCAN_MAX
       10       10
       11       11            PURPOSE: Given a triad tree (OPND), find the compute
       12       12                     sequence (CMP_SC) of that tree.
       13       13        */
       14       14
       15       15        /*D*   NAME: Z8GS$SCAN_MAX
       16       16
       17       17               CALL: CALL Z8GS$SCAN_MAX (pointer_to_triad_tree);
       18       18
       19       19          INTERFACE: Calls itself recursively if the LOP and/or ROP
       20       20                     are triad trees.
       21       21
       22       22        DESCRIPTION: The compute sequence of a triad tree is the
       23       23                     sequence number at which one of the variables
       24       24                     in the expression is redefined.  The compute
       25       25                     sequence is where the EVALP for the triad will
       26       26                     be inserted into the ILS/ILL.  The compute
       27       27                     sequence is the maximum of the compute
       28       28                     sequences of the LOP and ROP of the triad.
       29       29
       30       30              Set the CMP_SC field of the triad pointed to by
       31       31              OPND.  CMP_SC is the compute sequence number
       32       32              (the minimum sequence number that this expression
       33       33              could be computed at).  CMP_SC = MAX (all FDPs).
       34       34
       35       35              INPUTS: OPND -- Operand to scan (ETT item).
       36       36              ======
       37       37
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:2    
       38       38            OUTPUTS: CMP_SC -- Compute sequence of OPND.
       39       39            =======  COUNT --- Number of triads below this triad.
       40       40        */
       41       41
       42       42        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:3    
       43       43        Z8GS$SCAN_MAX: PROC (OPND); /* Recursive */
       44       44
       45       45        %EQU PHASE = 3;
       46       46        %EQU Z8GS = 8719; /* 8 || G=7 || S=19 */
       47       47        %EQU MODULE = Z8GS;
       48       48        %INCLUDE Z8A_DEFC;
       49      116        %INCLUDE Z8A_SUPP_MAC;
       50     2516        %INCLUDE Z8A_COMCOM;
       51     3166        %INCLUDE Z8A_ERR_NUMS;
       52     3930        %INCLUDE Z8A_ILS;
       53     4039        %INCLUDE Z8A_ILL;
       54     4732        %INCLUDE Z8A_ETT;
       55     5033        %INCLUDE Z8A_ST;
       56     8692        %INCLUDE Z8A_QLT;
       57     8798        %INCLUDE Z8A_GST;
       58     8858        %INCLUDE Z8G_P3VEC;
       59     9138        %INCLUDE Z8G_O3COM;
       60     9178        %INCLUDE Z9G_SYS_DEP;
       61     9208
       62     9209    1   DCL   OPND       PTR;           /* Input ptr to a triad */
       63     9210    1   DCL   MAX_SEQ_NO SBIN WORD AUTO;
       64     9211    1   DCL   MIN_SEQ_NO SBIN WORD AUTO;
       65     9212    1   DCL   COUNT      SBIN WORD AUTO;
       66     9213    1   DCL   COMPUTE_SEQ SBIN WORD;
       67     9214    1   DCL   NO          BOOLEAN;
       68     9215    1   DCL   YES         BOOLEAN;
       69     9216    1   DCL   REDEFINES   BOOLEAN;
       70     9217    1   DCL   RENAMES     BOOLEAN;
       71     9218    1   DCL   ST$$        PTR;
       72     9219    1   DCL   QLT$$       PTR;
       73     9220    1   DCL   BLOCK$      PTR;
       74     9221    1   DCL   Z8GX$IS_SSOP_INITV_ABLE ENTRY (3);
       75     9222    1   DCL   Z8AE$ERROR              ENTRY (12);
       76     9223
       77     9224        %MACRO FACTOR_IN_REFD_LABEL;
       78     9225
       79     9226           DO;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:4    
       80     9227             IF O3COM.LBL ~= ADDR(NIL) THEN
       81     9228               DO;
       82     9229                 OPND -> ETT.CMP_SC = MAXIMUM(OPND -> ETT.CMP_SC,
       83     9230                                              O3COM.LBL -> ILS.SEQNO);
       84     9231               END; /* IF REFERENCED LABEL */
       85     9232           END;
       86     9233
       87     9234        %MEND;
       88     9235
       89     9236        %MACRO ON_SIZE_LABEL_CHECK;
       90     9237          DO;
       91     9238            IF O3COM.LBL ~= ADDR(NIL) AND
       92     9239              O3COM.LBL ->ILS.ILL$ -> ILL.LOP -> LABEL.B.ON_SIZE_ERROR THEN
       93     9240              DO;
       94     9241                OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
       95     9242                                              O3COM.LBL -> ILS.SEQNO);
       96     9243              END;
       97     9244          END;
       98     9245        %MEND;
       99     9246        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:5    
      100     9247
      101     9248
      102     9249            /* If OPND -> ETT.EVALP$ already has an EVALP attached
      103     9250               and the EVALP's sequence number is still valid then
      104     9251               return.
      105     9252            */
      106     9253    1       IF OPND -> ETT.EVALP$ ~= ADDR(NIL) THEN
      107     9254    1         IF OPND -> ETT.EVALP$ -> ILL.ID ~= %EVALP
      108     9255    1            OR OPND -> ETT.CMP_SC >= O3COM.CURRENT_SEQ_NO THEN
      109     9256    1           OPND -> ETT.EVALP$ = ADDR(NIL);
      110     9257    1         ELSE
      111     9258    1           RETURN;
      112     9259
      113     9260
      114     9261
      115     9262
      116     9263    2       DO CASE (P3VEC (OPND -> ETT.ID));
      117     9264
      118     9265    2         CASE (%NO_EXPRESSIONS);
      119     9266
      120     9267                /* e.g.; ARGP, ESC, TRIAD */
      121     9268
      122     9269    2             OPND -> ETT.CMP_SC = 0;
      123     9270
      124     9271    2           OPND -> ETT.CMP_BD = %MAX_SEQ#;
      125     9272    2           OPND -> ETT.COUNT  = 1;
      126     9273
      127     9274                    /* In case a base pointer on the ESC.LOP */
      128     9275    2           IF OPND -> ETT.ID = %ESC AND
      129     9276    2              OPND -> ETT.LOP -> ETT.ID = %BASE THEN
      130     9277    2             CALL Z8GS$SCAN_MAX(OPND -> ETT.LOP);
      131     9278
      132     9279
      133     9280
      134     9281    2         CASE (%ONE_EXPRESSION_NO_REDEF);
      135     9282
      136     9283                /* e.g.; USI, FISS, OFF, MPD10 */
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:6    
      137     9284
      138     9285    2           CALL Z8GS$SCAN_MAX (OPND -> ETT.LOP);
      139     9286    2           OPND -> ETT.CMP_SC = OPND -> ETT.LOP -> ETT.CMP_SC;
      140     9287    2           OPND -> ETT.CMP_BD = OPND -> ETT.LOP -> ETT.CMP_BD;
      141     9288    2           OPND -> ETT.COUNT  = OPND -> ETT.LOP -> ETT.COUNT + 1;
      142     9289
      143     9290
      144     9291
      145     9292    2         CASE (%ROP_EXPRESSION_NO_REDEF, %ILLEGAL_VALUE);
      146     9293
      147     9294    2           CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      148     9295
      149     9296    2           CALL Z8GS$SCAN_MAX (OPND -> ETT.ROP);
      150     9297
      151     9298                /* Assume that the LOP is an ST ptr */
      152     9299
      153     9300    2           OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.LOP -> VARIABLE.SEQ#.FD,
      154     9301    2                                       OPND -> ETT.ROP -> ETT.CMP_SC);
      155     9302    2           OPND -> ETT.CMP_BD = MINIMUM (OPND -> ETT.LOP -> VARIABLE.SEQ#.BD,
      156     9303    2                                       OPND -> ETT.ROP -> ETT.CMP_BD);
      157     9304    2           OPND -> ETT.COUNT = OPND -> ETT.ROP -> ETT.COUNT + 1;
      158     9305
      159     9306
      160     9307
      161     9308    2         CASE (%TWO_EXPRESSIONS_NO_REDEF, %SSOP_SIZ_BASE);
      162     9309
      163     9310                /* e.g.; ADI, SBD, MPR, DVQ */
      164     9311
      165     9312                /*V* Step#1 -- Check the ROP */
      166     9313
      167     9314    2           IF OPND -> ETT.ID = %FISS
      168     9315    2              OR OPND -> ETT.ID = %OFF THEN
      169     9316    3             DO;
      170     9317    3               MAX_SEQ_NO = 0;
      171     9318    3               MIN_SEQ_NO = %MAX_SEQ#;
      172     9319    3               COUNT = 1;
      173     9320    3             END;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:7    
      174     9321    2           ELSE
      175     9322    3             DO;
      176     9323    3               CALL Z8GS$SCAN_MAX (OPND -> ETT.ROP);
      177     9324    3               MAX_SEQ_NO = OPND -> ETT.ROP -> ETT.CMP_SC;
      178     9325    3               MIN_SEQ_NO = OPND -> ETT.ROP -> ETT.CMP_BD;
      179     9326    3               COUNT = OPND -> ETT.ROP -> ETT.COUNT + 1;
      180     9327    3             END;
      181     9328
      182     9329                /*V* Step#2 --- Create a GSA item for the ROP of a
      183     9330                     SSOP for the current DO5 loop if the FDP and BDP
      184     9331                     are OK (no redefinitions within loop). If the
      185     9332                     ROP of SSOP qualifies, it may become INITV
      186     9333                     INCRV optimizable.
      187     9334                */
      188     9335
      189     9336    2           IF O3COM.VARYING$ ~= ADDR(NIL)
      190     9337    2              AND OPND -> ETT.ID = %SSOP THEN
      191     9338    3             DO;
      192     9339    3               IF MAX_SEQ_NO <= O3COM.DO_SEQ# AND
      193     9340    3                  MIN_SEQ_NO >= O3COM.DOEND_SEQ# THEN
      194     9341    4                 DO;
      195     9342    4                   CALL Z8GX$IS_SSOP_INITV_ABLE (OPND -> ETT.ROP,
      196     9343    4                                                 NO, YES);
      197     9344
      198     9345    4                   IF NOT NO AND YES THEN
      199     9346    5                     DO;
      200     9347                            /* Search the GSA list -- Is it already there?
      201     9348                            */
      202     9349
      203     9350    5                       GST$ = O3COM.GSA$;
      204     9351
      205     9352    6                       DO WHILE ((GST$ ~= ADDR(NIL))
      206     9353    6                           AND (GST$ -> GST.ROP_OF_SSOP ~=
      207     9354    6                                OPND -> ETT.ROP));
      208     9355    6                         GST$ = GST$ -> GST.NEXT;
      209     9356    6                       END; /* WHILE */
      210     9357
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:8    
      211     9358    5                       IF GST$ = ADDR(NIL) THEN
      212     9359    6                         DO;
      213     9360                                %RESERVE_GST (ITEM = %GSA, POINTER = GST$);
      214     9369    6                           GST$ -> GST.COUNT = 1;
      215     9370    6                           GST$ -> GST.ROP_OF_SSOP = OPND -> ETT.ROP;
      216     9371    6                           GST$ -> GST.NEXT = O3COM.GSA$;
      217     9372    6                           O3COM.GSA$ = GST$;
      218     9373    6                           O3COM.GSA_COUNT = O3COM.GSA_COUNT + 1;
      219     9374    6                         END;
      220     9375    5                       ELSE
      221     9376    5                         GST$ -> GST.COUNT = GST$ -> GST.COUNT + 1;
      222     9377
      223     9378    5                     END /* If ~NO & YES */;
      224     9379    4                 END; /* If FDP and BDP OK */
      225     9380    3             END; /* If within a DO5 $ it's a SSOP */
      226     9381
      227     9382
      228     9383                /*V* Step #3 -- Check the LOP */
      229     9384
      230     9385    3           DO CASE (OPND -> ETT.LOP -> ETT.ID);
      231     9386    3             CASE(%PARA, %CONST, %POINTER, %SECTION, %BLOCK, %SYMREF_);
      232     9387                    /* Leave MAX_SEQNO and COUNT as is. */
      233     9388
      234     9389    3             CASE(%ARRAY, %SCALAR, %INDUCT, %FD, %SD, %CD,
      235     9390    3                  %RD, %DB, %TEMP);
      236     9391                    /* SEQ#.FD (alias FDP) field contains next
      237     9392                       definition.
      238     9393                    */
      239     9394    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,
      240     9395    3                              OPND -> ETT.LOP -> VARIABLE.SEQ#.FD);
      241     9396
      242     9397                    /* Flag this as a variable: MAX_SEQ_NO <> 0 */
      243     9398                    /* (Constants aren't affected by group move) */
      244     9399
      245     9400    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,
      246     9401    3                              COMCOM.FIRST_ENTRY_SEQ_NUM);
      247     9402    3               MIN_SEQ_NO = MINIMUM (MIN_SEQ_NO,
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:9    
      248     9403    3                          OPND -> ETT.LOP -> VARIABLE.SEQ#.BD);
      249     9404
      250     9405    3             CASE(ELSE);
      251     9406    3               CALL Z8GS$SCAN_MAX(OPND -> ETT.LOP);
      252     9407
      253     9408    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,
      254     9409    3                              OPND -> ETT.LOP -> ETT.CMP_SC);
      255     9410    3               MIN_SEQ_NO = MINIMUM (MIN_SEQ_NO,
      256     9411    3                              OPND -> ETT.LOP -> ETT.CMP_BD);
      257     9412    3               COUNT = COUNT + OPND -> ETT.LOP -> ETT.COUNT + 1;
      258     9413    3           END; /* CASE */
      259     9414
      260     9415    2           OPND -> ETT.CMP_SC = MAX_SEQ_NO;
      261     9416    2           OPND -> ETT.CMP_BD = MIN_SEQ_NO;
      262     9417    2           OPND -> ETT.COUNT = COUNT;
      263     9418
      264     9419    2       END; /* CASE OF P3VEC (ID) */
      265     9420
      266     9421        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:10   
      267     9422
      268     9423            /*V* Factor in the next referenced label definition,
      269     9424                 and DO -- DOEND loops.
      270     9425            */
      271     9426
      272     9427    1       IF OPND -> ETT.CMP_SC ~= 0 THEN
      273     9428    2         DO;
      274     9429
      275     9430                    /* If CMP_SC is not equal to zero we know the item
      276     9431                       has variables below it in its trees.
      277     9432                       Factor in "Common" redefinition caused by CALLs,
      278     9433                       PFORMs, and Group Moves.
      279     9434                    */
      280     9435
      281     9436    2           OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
      282     9437    2                                  COMCOM.COMMON_REDEF);
      283     9438    2           OPND -> ETT.CMP_BD = MINIMUM (OPND -> ETT.CMP_BD,
      284     9439    2                                  O3COM.LAST_OPA_REDEF);
      285     9440
      286     9441    2           IF OPND -> ETT.CMP_SC <= COMCOM.FIRST_ENTRY_SEQ_NUM + 1
      287     9442    2              AND OPND -> ETT.CMP_BD = %MAX_SEQ# THEN
      288     9443    3             DO;
      289     9444    3               IF OPND -> ETT.ID = %BASE THEN
      290     9445    4                 DO;
      291     9446                        /* For an external data item in a internal procedure
      292     9447                           might be redefined outside and we cannot tell, so
      293     9448                           check the redefine bit for the possibility and
      294     9449                           assign it the right compute sequence number     */
      295     9450    4                   ST$$ = OPND -> ETT.LOP;
      296     9451    4                   IF ST$$ -> SCALAR.COUNT > 1 THEN
      297     9452    5                     DO;
      298     9453    5                       BLOCK$ = COMCOM.BLOCK$;
      299     9454    6                       DO WHILE (BLOCK$ -> BLOCK.COUNT ~= ST$$->SCALAR.COUNT);
      300     9455    6                         BLOCK$ = BLOCK$ -> BLOCK.NEXT;
      301     9456    6                       END; /* DO WHILE */
      302     9457    5                       IF BLOCK$ -> BLOCK.B.REDEFINED THEN
      303     9458                              %FACTOR_IN_REFD_LABEL;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:11   
      304     9467    5                     END;
      305     9468    4                 END;
      306     9469    3               ELSE
      307     9470                      /* NULL - If no redefinition, then compute at entry.
      308     9471    3                 */;
      309     9472    3             END;
      310     9473    2           ELSE
      311     9474    3             DO;
      312     9475    3               IF O3COM.DO# = 0 THEN
      313     9476                      %FACTOR_IN_REFD_LABEL;
      314     9485    3               ELSE
      315     9486    4                 DO;
      316     9487
      317     9488                        /* DO# ~= 0: Item is in a loop.  Check to see
      318     9489                           if it can be moved out of the loop.
      319     9490                        */
      320     9491    4                   IF OPND -> ETT.CMP_SC < O3COM.DO#
      321     9492    4                      AND OPND -> ETT.CMP_BD > O3COM.DOEND# - 2 THEN
      322     9493    5                     DO;
      323     9494    5                       OPND -> ETT.CMP_SC = O3COM.DO# - 2;
      324     9495
      325     9496                            %ON_SIZE_LABEL_CHECK;
      326     9506    5                     END;
      327     9507    4                   ELSE
      328     9508    5                     DO;
      329     9509    5                       OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
      330     9510    5                                              O3COM.DO#);
      331     9511                            %FACTOR_IN_REFD_LABEL;
      332     9520    5                     END;
      333     9521    4                 END;
      334     9522    3             END;
      335     9523    2         END; /* If CMP_SC not equal to 0 */
      336     9524
      337     9525
      338     9526    1       IF COMCOM.H_ENTRY$ ~= ADDR(NIL) THEN
      339     9527    1         OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
      340     9528    1                                COMCOM.H_ENTRY$ -> ILS.SEQNO);
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:12   
      341     9529
      342     9530    1       IF  COMCOM.INT_SUB$ ~= ADDR(NIL)
      343     9531    1       AND OPND -> ETT.ID = %ARGP THEN
      344     9532    1         OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
      345     9533    1                                COMCOM.INT_SUB$ -> ILS.SEQNO);
      346     9534
      347     9535    1   END Z8GS$SCAN_MAX;

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:13   
--  Include file information  --

   Z9G_SYS_DEP.:Z8A6TOU  is referenced.
   Z8G_O3COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8G_P3VEC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_GST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8GS$SCAN_MAX.

   Procedure Z8GS$SCAN_MAX requires 522 words for executable code.
   Procedure Z8GS$SCAN_MAX requires 20 words of local(AUTO) storage.

    No errors detected in file Z8GS.:Z8A6TSI    .

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:14   

 Object Unit name= Z8GS$SCAN_MAX                              File name= Z8GS.:Z8A6TOU
 UTS= AUG 09 '97 13:15:23.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILS$
    2  LblCom even  none     5      5  ILS_
    3  LblCom even  none     1      1  ILL$
    4  LblCom even  none     5      5  ILL_
    5  LblCom even  none     1      1  ETT$
    6  LblCom even  none     1      1  HEAD_ETT$
    7  LblCom even  none   512   1000  ETT_BUCKETS
    8  LblCom even  none     5      5  ETT_
    9  LblCom even  none     1      1  ST$
   10  LblCom even  none     5      5  ST_
   11  LblCom even  none     1      1  QLT$
   12  LblCom even  none     1      1  PREV_01_QLT$
   13  LblCom even  none     5      5  QLT_
   14  LblCom even  none     1      1  GST$
   15  LblCom even  none     5      5  GST_
   16  LblCom even  none   295    447  P3VEC
   17  LblCom even  none    56     70  O3COM
   18   Proc  even  none   522   1012  Z8GS$SCAN_MAX
   19  RoData even  none     6      6  Z8GS$SCAN_MAX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    18      0   yes            yes      Std        1  Z8GS$SCAN_MAX
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       3 Z8GX$IS_SSOP_INITV_ABLE
         yes           Std       1 Z8AR$RESERVER
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    ILS_STEP_TABLE                   r    ILL_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:16   


        1        1        /*M* Z8GS$SCAN_MAX -- Scan Triad Tree for Max Seq# */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*   NAME: Z8GS$SCAN_MAX
       10       10
       11       11            PURPOSE: Given a triad tree (OPND), find the compute
       12       12                     sequence (CMP_SC) of that tree.
       13       13        */
       14       14
       15       15        /*D*   NAME: Z8GS$SCAN_MAX
       16       16
       17       17               CALL: CALL Z8GS$SCAN_MAX (pointer_to_triad_tree);
       18       18
       19       19          INTERFACE: Calls itself recursively if the LOP and/or ROP
       20       20                     are triad trees.
       21       21
       22       22        DESCRIPTION: The compute sequence of a triad tree is the
       23       23                     sequence number at which one of the variables
       24       24                     in the expression is redefined.  The compute
       25       25                     sequence is where the EVALP for the triad will
       26       26                     be inserted into the ILS/ILL.  The compute
       27       27                     sequence is the maximum of the compute
       28       28                     sequences of the LOP and ROP of the triad.
       29       29
       30       30              Set the CMP_SC field of the triad pointed to by
       31       31              OPND.  CMP_SC is the compute sequence number
       32       32              (the minimum sequence number that this expression
       33       33              could be computed at).  CMP_SC = MAX (all FDPs).
       34       34
       35       35              INPUTS: OPND -- Operand to scan (ETT item).
       36       36              ======
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:17   
       37       37
       38       38            OUTPUTS: CMP_SC -- Compute sequence of OPND.
       39       39            =======  COUNT --- Number of triads below this triad.
       40       40        */
       41       41
       42       42        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:18   
       43       43        Z8GS$SCAN_MAX: PROC (OPND); /* Recursive */

     43 18 000000   000000 700200 xent  Z8GS$SCAN_M* TSX0  ! X66_AUTO_1
        18 000001   000024 000001                    ZERO    20,1

       44       44
       45       45        %EQU PHASE = 3;
       46       46        %EQU Z8GS = 8719; /* 8 || G=7 || S=19 */
       47       47        %EQU MODULE = Z8GS;
       48       48        %INCLUDE Z8A_DEFC;
       49      116        %INCLUDE Z8A_SUPP_MAC;
       50     2516        %INCLUDE Z8A_COMCOM;
       51     3166        %INCLUDE Z8A_ERR_NUMS;
       52     3930        %INCLUDE Z8A_ILS;
       53     4039        %INCLUDE Z8A_ILL;
       54     4732        %INCLUDE Z8A_ETT;
       55     5033        %INCLUDE Z8A_ST;
       56     8692        %INCLUDE Z8A_QLT;
       57     8798        %INCLUDE Z8A_GST;
       58     8858        %INCLUDE Z8G_P3VEC;
       59     9138        %INCLUDE Z8G_O3COM;
       60     9178        %INCLUDE Z9G_SYS_DEP;
       61     9208
       62     9209    1   DCL   OPND       PTR;           /* Input ptr to a triad */
       63     9210    1   DCL   MAX_SEQ_NO SBIN WORD AUTO;
       64     9211    1   DCL   MIN_SEQ_NO SBIN WORD AUTO;
       65     9212    1   DCL   COUNT      SBIN WORD AUTO;
       66     9213    1   DCL   COMPUTE_SEQ SBIN WORD;
       67     9214    1   DCL   NO          BOOLEAN;
       68     9215    1   DCL   YES         BOOLEAN;
       69     9216    1   DCL   REDEFINES   BOOLEAN;
       70     9217    1   DCL   RENAMES     BOOLEAN;
       71     9218    1   DCL   ST$$        PTR;
       72     9219    1   DCL   QLT$$       PTR;
       73     9220    1   DCL   BLOCK$      PTR;
       74     9221    1   DCL   Z8GX$IS_SSOP_INITV_ABLE ENTRY (3);
       75     9222    1   DCL   Z8AE$ERROR              ENTRY (12);
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:19   
       76     9223
       77     9224        %MACRO FACTOR_IN_REFD_LABEL;
       78     9225
       79     9226           DO;
       80     9227             IF O3COM.LBL ~= ADDR(NIL) THEN
       81     9228               DO;
       82     9229                 OPND -> ETT.CMP_SC = MAXIMUM(OPND -> ETT.CMP_SC,
       83     9230                                              O3COM.LBL -> ILS.SEQNO);
       84     9231               END; /* IF REFERENCED LABEL */
       85     9232           END;
       86     9233
       87     9234        %MEND;
       88     9235
       89     9236        %MACRO ON_SIZE_LABEL_CHECK;
       90     9237          DO;
       91     9238            IF O3COM.LBL ~= ADDR(NIL) AND
       92     9239              O3COM.LBL ->ILS.ILL$ -> ILL.LOP -> LABEL.B.ON_SIZE_ERROR THEN
       93     9240              DO;
       94     9241                OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,
       95     9242                                              O3COM.LBL -> ILS.SEQNO);
       96     9243              END;
       97     9244          END;
       98     9245        %MEND;
       99     9246        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:20   
      100     9247
      101     9248
      102     9249            /* If OPND -> ETT.EVALP$ already has an EVALP attached
      103     9250               and the EVALP's sequence number is still valid then
      104     9251               return.
      105     9252            */
      106     9253    1       IF OPND -> ETT.EVALP$ ~= ADDR(NIL) THEN

   9253 18 000002   200003 470500                    LDP0    @OPND,,AUTO
        18 000003   000000 471500                    LDP1    0,,PR0
        18 000004   100003 236100                    LDQ     3,,PR1
        18 000005   000000 116000 19                 CMPQ    0
        18 000006   000023 600000 18                 TZE     s:9263

      107     9254    1         IF OPND -> ETT.EVALP$ -> ILL.ID ~= %EVALP

   9254 18 000007   100003 473500                    LDP3    3,,PR1
        18 000010   300000 220100                    LDX0    0,,PR3
        18 000011   000341 100003                    CMPX0   225,DU
        18 000012   000017 601000 18                 TNZ     s:9256
        18 000013   100004 236100                    LDQ     4,,PR1
        18 000014   000022 772000                    QRL     18
        18 000015   000000 116000 17                 CMPQ    O3COM
        18 000016   000022 604000 18                 TMI     s:9258

      108     9255    1            OR OPND -> ETT.CMP_SC >= O3COM.CURRENT_SEQ_NO THEN
      109     9256    1           OPND -> ETT.EVALP$ = ADDR(NIL);

   9256 18 000017   000000 236000 19                 LDQ     0
        18 000020   100003 756100                    STQ     3,,PR1
        18 000021   000023 710000 18                 TRA     s:9263

      110     9257    1         ELSE
      111     9258    1           RETURN;

   9258 18 000022   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:21   
      112     9259
      113     9260
      114     9261
      115     9262
      116     9263    2       DO CASE (P3VEC (OPND -> ETT.ID));

   9263 18 000023   000000 471500                    LDP1    0,,PR0
        18 000024   100000 220100                    LDX0    0,,PR1
        18 000025   000000 235010 16                 LDA     P3VEC,X0
        18 000026   000017 115007                    CMPA    15,DL
        18 000027   000031 602005 18                 TNC     s:9263+6,AL
        18 000030   000512 710000 18                 TRA     s:9427
        18 000031   000050 710000 18                 TRA     s:9269
        18 000032   000512 710000 18                 TRA     s:9427
        18 000033   000512 710000 18                 TRA     s:9427
        18 000034   000512 710000 18                 TRA     s:9427
        18 000035   000512 710000 18                 TRA     s:9427
        18 000036   000202 710000 18                 TRA     s:9314
        18 000037   000077 710000 18                 TRA     s:9285
        18 000040   000202 710000 18                 TRA     s:9314
        18 000041   000512 710000 18                 TRA     s:9427
        18 000042   000124 710000 18                 TRA     s:9294
        18 000043   000512 710000 18                 TRA     s:9427
        18 000044   000512 710000 18                 TRA     s:9427
        18 000045   000512 710000 18                 TRA     s:9427
        18 000046   000512 710000 18                 TRA     s:9427
        18 000047   000124 710000 18                 TRA     s:9294

      117     9264
      118     9265    2         CASE (%NO_EXPRESSIONS);

      119     9266
      120     9267                /* e.g.; ARGP, ESC, TRIAD */
      121     9268
      122     9269    2             OPND -> ETT.CMP_SC = 0;

   9269 18 000050   000000 221003                    LDX1    0,DU
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:22   
        18 000051   100004 741100                    STX1    4,,PR1

      123     9270
      124     9271    2           OPND -> ETT.CMP_BD = %MAX_SEQ#;

   9271 18 000052   000000 471500                    LDP1    0,,PR0
        18 000053   777777 220003                    LDX0    -1,DU
        18 000054   100004 440100                    SXL0    4,,PR1

      125     9272    2           OPND -> ETT.COUNT  = 1;

   9272 18 000055   000000 471500                    LDP1    0,,PR0
        18 000056   000001 222003                    LDX2    1,DU
        18 000057   100000 442100                    SXL2    0,,PR1

      126     9273
      127     9274                    /* In case a base pointer on the ESC.LOP */
      128     9275    2           IF OPND -> ETT.ID = %ESC AND

   9275 18 000060   000000 471500                    LDP1    0,,PR0
        18 000061   100000 223100                    LDX3    0,,PR1
        18 000062   000017 103003                    CMPX3   15,DU
        18 000063   000512 601000 18                 TNZ     s:9427
        18 000064   100001 473500                    LDP3    1,,PR1
        18 000065   300000 224100                    LDX4    0,,PR3
        18 000066   000001 104003                    CMPX4   1,DU
        18 000067   000512 601000 18                 TNZ     s:9427

      129     9276    2              OPND -> ETT.LOP -> ETT.ID = %BASE THEN
      130     9277    2             CALL Z8GS$SCAN_MAX(OPND -> ETT.LOP);

   9277 18 000070   100001 634500                    EPPR4   1,,PR1
        18 000071   200020 454500                    STP4    BLOCK$+2,,AUTO
        18 000072   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000073   000001 631400 19                 EPPR1   1
        18 000074   000000 701000 18                 TSX1    s:43
        18 000075   000000 011000                    NOP     0
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:23   
        18 000076   000512 710000 18                 TRA     s:9427

      131     9278
      132     9279
      133     9280
      134     9281    2         CASE (%ONE_EXPRESSION_NO_REDEF);

      135     9282
      136     9283                /* e.g.; USI, FISS, OFF, MPD10 */
      137     9284
      138     9285    2           CALL Z8GS$SCAN_MAX (OPND -> ETT.LOP);

   9285 18 000077   100001 633500                    EPPR3   1,,PR1
        18 000100   200020 453500                    STP3    BLOCK$+2,,AUTO
        18 000101   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000102   000001 631400 19                 EPPR1   1
        18 000103   000000 701000 18                 TSX1    s:43
        18 000104   000000 011000                    NOP     0

      139     9286    2           OPND -> ETT.CMP_SC = OPND -> ETT.LOP -> ETT.CMP_SC;

   9286 18 000105   200003 470500                    LDP0    @OPND,,AUTO
        18 000106   000000 471500                    LDP1    0,,PR0
        18 000107   100001 473500                    LDP3    1,,PR1
        18 000110   300004 220100                    LDX0    4,,PR3
        18 000111   100004 740100                    STX0    4,,PR1

      140     9287    2           OPND -> ETT.CMP_BD = OPND -> ETT.LOP -> ETT.CMP_BD;

   9287 18 000112   000000 471500                    LDP1    0,,PR0
        18 000113   100001 473500                    LDP3    1,,PR1
        18 000114   300004 720100                    LXL0    4,,PR3
        18 000115   100004 440100                    SXL0    4,,PR1

      141     9288    2           OPND -> ETT.COUNT  = OPND -> ETT.LOP -> ETT.COUNT + 1;

   9288 18 000116   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:24   
        18 000117   100001 473500                    LDP3    1,,PR1
        18 000120   300000 720100                    LXL0    0,,PR3
        18 000121   000001 621010                    EAX1    1,X0
        18 000122   100000 441100                    SXL1    0,,PR1
        18 000123   000512 710000 18                 TRA     s:9427

      142     9289
      143     9290
      144     9291
      145     9292    2         CASE (%ROP_EXPRESSION_NO_REDEF, %ILLEGAL_VALUE);

      146     9293
      147     9294    2           CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

   9294 18 000124   000003 630400 19                 EPPR0   3
        18 000125   000001 631400 19                 EPPR1   1
        18 000126   000000 701000 xent               TSX1    Z8AE$ERROR
        18 000127   000000 011000                    NOP     0

      148     9295
      149     9296    2           CALL Z8GS$SCAN_MAX (OPND -> ETT.ROP);

   9296 18 000130   200003 470500                    LDP0    @OPND,,AUTO
        18 000131   000000 471500                    LDP1    0,,PR0
        18 000132   100002 633500                    EPPR3   2,,PR1
        18 000133   200020 453500                    STP3    BLOCK$+2,,AUTO
        18 000134   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000135   000001 631400 19                 EPPR1   1
        18 000136   000000 701000 18                 TSX1    s:43
        18 000137   000000 011000                    NOP     0

      150     9297
      151     9298                /* Assume that the LOP is an ST ptr */
      152     9299
      153     9300    2           OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.LOP -> VARIABLE.SEQ#.FD,

   9300 18 000140   200003 470500                    LDP0    @OPND,,AUTO
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:25   
        18 000141   000000 471500                    LDP1    0,,PR0
        18 000142   100002 473500                    LDP3    2,,PR1
        18 000143   100001 474500                    LDP4    1,,PR1
        18 000144   300004 236100                    LDQ     4,,PR3
        18 000145   000022 772000                    QRL     18
        18 000146   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000147   400010 236100                    LDQ     8,,PR4
        18 000150   000022 772000                    QRL     18
        18 000151   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000152   000154 603000 18                 TRC     s:9300+12
        18 000153   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000154   000000 620006                    EAX0    0,QL
        18 000155   100004 740100                    STX0    4,,PR1

      154     9301    2                                       OPND -> ETT.ROP -> ETT.CMP_SC);
      155     9302    2           OPND -> ETT.CMP_BD = MINIMUM (OPND -> ETT.LOP -> VARIABLE.SEQ#.BD,

   9302 18 000156   000000 471500                    LDP1    0,,PR0
        18 000157   100002 473500                    LDP3    2,,PR1
        18 000160   100001 474500                    LDP4    1,,PR1
        18 000161   300004 236100                    LDQ     4,,PR3
        18 000162   777777 376007                    ANQ     -1,DL
        18 000163   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000164   400010 236100                    LDQ     8,,PR4
        18 000165   777777 376007                    ANQ     -1,DL
        18 000166   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000167   000172 602000 18                 TNC     s:9302+12
        18 000170   000172 600000 18                 TZE     s:9302+12
        18 000171   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000172   000000 620006                    EAX0    0,QL
        18 000173   100004 440100                    SXL0    4,,PR1

      156     9303    2                                       OPND -> ETT.ROP -> ETT.CMP_BD);
      157     9304    2           OPND -> ETT.COUNT = OPND -> ETT.ROP -> ETT.COUNT + 1;

   9304 18 000174   000000 471500                    LDP1    0,,PR0
        18 000175   100002 473500                    LDP3    2,,PR1
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:26   
        18 000176   300000 720100                    LXL0    0,,PR3
        18 000177   000001 621010                    EAX1    1,X0
        18 000200   100000 441100                    SXL1    0,,PR1
        18 000201   000512 710000 18                 TRA     s:9427

      158     9305
      159     9306
      160     9307
      161     9308    2         CASE (%TWO_EXPRESSIONS_NO_REDEF, %SSOP_SIZ_BASE);

      162     9309
      163     9310                /* e.g.; ADI, SBD, MPR, DVQ */
      164     9311
      165     9312                /*V* Step#1 -- Check the ROP */
      166     9313
      167     9314    2           IF OPND -> ETT.ID = %FISS

   9314 18 000202   000002 100003                    CMPX0   2,DU
        18 000203   000206 600000 18                 TZE     s:9317
        18 000204   000003 100003                    CMPX0   3,DU
        18 000205   000214 601000 18                 TNZ     s:9323

      168     9315    2              OR OPND -> ETT.ID = %OFF THEN
      169     9316    3             DO;

      170     9317    3               MAX_SEQ_NO = 0;

   9317 18 000206   200004 450100                    STZ     MAX_SEQ_NO,,AUTO

      171     9318    3               MIN_SEQ_NO = %MAX_SEQ#;

   9318 18 000207   777777 236007                    LDQ     -1,DL
        18 000210   200005 756100                    STQ     MIN_SEQ_NO,,AUTO

      172     9319    3               COUNT = 1;

   9319 18 000211   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:27   
        18 000212   200006 755100                    STA     COUNT,,AUTO

      173     9320    3             END;

   9320 18 000213   000237 710000 18                 TRA     s:9336

      174     9321    2           ELSE
      175     9322    3             DO;

      176     9323    3               CALL Z8GS$SCAN_MAX (OPND -> ETT.ROP);

   9323 18 000214   100002 633500                    EPPR3   2,,PR1
        18 000215   200020 453500                    STP3    BLOCK$+2,,AUTO
        18 000216   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000217   000001 631400 19                 EPPR1   1
        18 000220   000000 701000 18                 TSX1    s:43
        18 000221   000000 011000                    NOP     0

      177     9324    3               MAX_SEQ_NO = OPND -> ETT.ROP -> ETT.CMP_SC;

   9324 18 000222   200003 470500                    LDP0    @OPND,,AUTO
        18 000223   000000 471500                    LDP1    0,,PR0
        18 000224   100002 473500                    LDP3    2,,PR1
        18 000225   300004 236100                    LDQ     4,,PR3
        18 000226   000022 772000                    QRL     18
        18 000227   200004 756100                    STQ     MAX_SEQ_NO,,AUTO

      178     9325    3               MIN_SEQ_NO = OPND -> ETT.ROP -> ETT.CMP_BD;

   9325 18 000230   300004 236100                    LDQ     4,,PR3
        18 000231   777777 376007                    ANQ     -1,DL
        18 000232   200005 756100                    STQ     MIN_SEQ_NO,,AUTO

      179     9326    3               COUNT = OPND -> ETT.ROP -> ETT.COUNT + 1;

   9326 18 000233   300000 236100                    LDQ     0,,PR3
        18 000234   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:28   
        18 000235   000001 036007                    ADLQ    1,DL
        18 000236   200006 756100                    STQ     COUNT,,AUTO

      180     9327    3             END;

      181     9328
      182     9329                /*V* Step#2 --- Create a GSA item for the ROP of a
      183     9330                     SSOP for the current DO5 loop if the FDP and BDP
      184     9331                     are OK (no redefinitions within loop). If the
      185     9332                     ROP of SSOP qualifies, it may become INITV
      186     9333                     INCRV optimizable.
      187     9334                */
      188     9335
      189     9336    2           IF O3COM.VARYING$ ~= ADDR(NIL)

   9336 18 000237   000055 236000 17                 LDQ     O3COM+45
        18 000240   000000 116000 19                 CMPQ    0
        18 000241   000362 600000 18                 TZE     s:9385
        18 000242   100000 220100                    LDX0    0,,PR1
        18 000243   000005 100003                    CMPX0   5,DU
        18 000244   000362 601000 18                 TNZ     s:9385

      190     9337    2              AND OPND -> ETT.ID = %SSOP THEN
      191     9338    3             DO;

      192     9339    3               IF MAX_SEQ_NO <= O3COM.DO_SEQ# AND

   9339 18 000245   200004 236100                    LDQ     MAX_SEQ_NO,,AUTO
        18 000246   000062 116000 17                 CMPQ    O3COM+50
        18 000247   000362 605400 18                 TPNZ    s:9385
        18 000250   200005 236100                    LDQ     MIN_SEQ_NO,,AUTO
        18 000251   000063 116000 17                 CMPQ    O3COM+51
        18 000252   000362 604000 18                 TMI     s:9385

      193     9340    3                  MIN_SEQ_NO >= O3COM.DOEND_SEQ# THEN
      194     9341    4                 DO;

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:29   
      195     9342    4                   CALL Z8GX$IS_SSOP_INITV_ABLE (OPND -> ETT.ROP,

   9342 18 000253   200011 633500                    EPPR3   YES,,AUTO
        18 000254   200022 453500                    STP3    BLOCK$+4,,AUTO
        18 000255   200010 634500                    EPPR4   NO,,AUTO
        18 000256   200021 454500                    STP4    BLOCK$+3,,AUTO
        18 000257   100002 635500                    EPPR5   2,,PR1
        18 000260   200020 455500                    STP5    BLOCK$+2,,AUTO
        18 000261   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000262   000004 631400 19                 EPPR1   4
        18 000263   000000 701000 xent               TSX1    Z8GX$IS_SSOP_INITV_ABLE
        18 000264   000000 011000                    NOP     0

      196     9343    4                                                 NO, YES);
      197     9344
      198     9345    4                   IF NOT NO AND YES THEN

   9345 18 000265   200010 234100                    SZN     NO,,AUTO
        18 000266   000362 604000 18                 TMI     s:9385
        18 000267   200011 234100                    SZN     YES,,AUTO
        18 000270   000362 605000 18                 TPL     s:9385

      199     9346    5                     DO;

      200     9347                            /* Search the GSA list -- Is it already there?
      201     9348                            */
      202     9349
      203     9350    5                       GST$ = O3COM.GSA$;

   9350 18 000271   000060 236000 17                 LDQ     O3COM+48
        18 000272   000000 756000 14                 STQ     GST$

      204     9351
      205     9352    6                       DO WHILE ((GST$ ~= ADDR(NIL))

   9352 18 000273   000277 710000 18                 TRA     s:9356

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:30   
      206     9353    6                           AND (GST$ -> GST.ROP_OF_SSOP ~=
      207     9354    6                                OPND -> ETT.ROP));
      208     9355    6                         GST$ = GST$ -> GST.NEXT;

   9355 18 000274   000000 470400 14                 LDP0    GST$
        18 000275   000002 236100                    LDQ     2,,PR0
        18 000276   000000 756000 14                 STQ     GST$

      209     9356    6                       END; /* WHILE */

   9356 18 000277   000000 116000 19                 CMPQ    0
        18 000300   000307 600000 18                 TZE     s:9358
        18 000301   200003 470500                    LDP0    @OPND,,AUTO
        18 000302   000000 471500                    LDP1    0,,PR0
        18 000303   000000 473400 14                 LDP3    GST$
        18 000304   300001 236100                    LDQ     1,,PR3
        18 000305   100002 116100                    CMPQ    2,,PR1
        18 000306   000274 601000 18                 TNZ     s:9355

      210     9357
      211     9358    5                       IF GST$ = ADDR(NIL) THEN

   9358 18 000307   000000 236000 14                 LDQ     GST$
        18 000310   000000 116000 19                 CMPQ    0
        18 000311   000356 601000 18                 TNZ     s:9376

      212     9359    6                         DO;

      213     9360                                %RESERVE_GST (ITEM = %GSA, POINTER = GST$);

   9362 18 000312   000002 236000 15                 LDQ     GST_+2
        18 000313   000003 036007                    ADLQ    3,DL
        18 000314   000003 116000 15                 CMPQ    GST_+3
        18 000315   000326 602000 18                 TNC     s:9364

   9363 18 000316   000005 236000 19                 LDQ     5
        18 000317   200020 756100                    STQ     BLOCK$+2,,AUTO
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:31   
        18 000320   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000321   200021 450500                    STP0    BLOCK$+3,,AUTO
        18 000322   200021 630500                    EPPR0   BLOCK$+3,,AUTO
        18 000323   000001 631400 19                 EPPR1   1
        18 000324   000000 701000 xent               TSX1    Z8AR$RESERVER
        18 000325   000000 011000                    NOP     0

   9364 18 000326   000002 236000 15                 LDQ     GST_+2
        18 000327   000022 736000                    QLS     18
        18 000330   000001 036000 15                 ADLQ    GST_+1
        18 000331   000000 756000 14                 STQ     GST$

   9365 18 000332   000002 235000 15                 LDA     GST_+2
        18 000333   000003 035007                    ADLA    3,DL
        18 000334   000002 755000 15                 STA     GST_+2

   9366 18 000335   001055 220003                    LDX0    557,DU
        18 000336   000000 470400 14                 LDP0    GST$
        18 000337   000000 740100                    STX0    0,,PR0

      214     9369    6                           GST$ -> GST.COUNT = 1;

   9369 18 000340   000001 221003                    LDX1    1,DU
        18 000341   000000 470400 14                 LDP0    GST$
        18 000342   000000 441100                    SXL1    0,,PR0

      215     9370    6                           GST$ -> GST.ROP_OF_SSOP = OPND -> ETT.ROP;

   9370 18 000343   200003 470500                    LDP0    @OPND,,AUTO
        18 000344   000000 471500                    LDP1    0,,PR0
        18 000345   100002 236100                    LDQ     2,,PR1
        18 000346   000000 473400 14                 LDP3    GST$
        18 000347   300001 756100                    STQ     1,,PR3

      216     9371    6                           GST$ -> GST.NEXT = O3COM.GSA$;

   9371 18 000350   000060 236000 17                 LDQ     O3COM+48
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:32   
        18 000351   300002 756100                    STQ     2,,PR3

      217     9372    6                           O3COM.GSA$ = GST$;

   9372 18 000352   000000 236000 14                 LDQ     GST$
        18 000353   000060 756000 17                 STQ     O3COM+48

      218     9373    6                           O3COM.GSA_COUNT = O3COM.GSA_COUNT + 1;

   9373 18 000354   000061 054000 17                 AOS     O3COM+49

      219     9374    6                         END;

   9374 18 000355   000362 710000 18                 TRA     s:9385

      220     9375    5                       ELSE
      221     9376    5                         GST$ -> GST.COUNT = GST$ -> GST.COUNT + 1;

   9376 18 000356   000000 470400 14                 LDP0    GST$
        18 000357   000000 720100                    LXL0    0,,PR0
        18 000360   000001 621010                    EAX1    1,X0
        18 000361   000000 441100                    SXL1    0,,PR0

      222     9377
      223     9378    5                     END /* If ~NO & YES */;

      224     9379    4                 END; /* If FDP and BDP OK */

      225     9380    3             END; /* If within a DO5 $ it's a SSOP */

      226     9381
      227     9382
      228     9383                /*V* Step #3 -- Check the LOP */
      229     9384
      230     9385    3           DO CASE (OPND -> ETT.LOP -> ETT.ID);

   9385 18 000362   200003 470500                    LDP0    @OPND,,AUTO
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:33   
        18 000363   000000 471500                    LDP1    0,,PR0
        18 000364   100001 473500                    LDP3    1,,PR1
        18 000365   300000 236100                    LDQ     0,,PR3
        18 000366   000022 772000                    QRL     18
        18 000367   000760 136007                    SBLQ    496,DL
        18 000370   000027 116007                    CMPQ    23,DL
        18 000371   000373 602006 18                 TNC     s:9385+9,QL
        18 000372   000446 710000 18                 TRA     s:9406
        18 000373   000422 710000 18                 TRA     s:9394
        18 000374   000446 710000 18                 TRA     s:9406
        18 000375   000446 710000 18                 TRA     s:9406
        18 000376   000446 710000 18                 TRA     s:9406
        18 000377   000446 710000 18                 TRA     s:9406
        18 000400   000422 710000 18                 TRA     s:9394
        18 000401   000422 710000 18                 TRA     s:9394
        18 000402   000502 710000 18                 TRA     s:9415
        18 000403   000502 710000 18                 TRA     s:9415
        18 000404   000502 710000 18                 TRA     s:9415
        18 000405   000502 710000 18                 TRA     s:9415
        18 000406   000446 710000 18                 TRA     s:9406
        18 000407   000502 710000 18                 TRA     s:9415
        18 000410   000422 710000 18                 TRA     s:9394
        18 000411   000446 710000 18                 TRA     s:9406
        18 000412   000502 710000 18                 TRA     s:9415
        18 000413   000446 710000 18                 TRA     s:9406
        18 000414   000446 710000 18                 TRA     s:9406
        18 000415   000422 710000 18                 TRA     s:9394
        18 000416   000422 710000 18                 TRA     s:9394
        18 000417   000422 710000 18                 TRA     s:9394
        18 000420   000422 710000 18                 TRA     s:9394
        18 000421   000422 710000 18                 TRA     s:9394

      231     9386    3             CASE(%PARA, %CONST, %POINTER, %SECTION, %BLOCK, %SYMREF_);

      232     9387                    /* Leave MAX_SEQNO and COUNT as is. */
      233     9388
      234     9389    3             CASE(%ARRAY, %SCALAR, %INDUCT, %FD, %SD, %CD,
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:34   

      235     9390    3                  %RD, %DB, %TEMP);
      236     9391                    /* SEQ#.FD (alias FDP) field contains next
      237     9392                       definition.
      238     9393                    */
      239     9394    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,

   9394 18 000422   300010 236100                    LDQ     8,,PR3
        18 000423   000022 772000                    QRL     18
        18 000424   000430 604000 18                 TMI     s:9394+6
        18 000425   200004 116100                    CMPQ    MAX_SEQ_NO,,AUTO
        18 000426   000430 605000 18                 TPL     s:9394+6
        18 000427   200004 236100                    LDQ     MAX_SEQ_NO,,AUTO
        18 000430   200004 756100                    STQ     MAX_SEQ_NO,,AUTO

      240     9395    3                              OPND -> ETT.LOP -> VARIABLE.SEQ#.FD);
      241     9396
      242     9397                    /* Flag this as a variable: MAX_SEQ_NO <> 0 */
      243     9398                    /* (Constants aren't affected by group move) */
      244     9399
      245     9400    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,

   9400 18 000431   000440 236000 xsym               LDQ     COMCOM+288
        18 000432   200004 116100                    CMPQ    MAX_SEQ_NO,,AUTO
        18 000433   000435 605000 18                 TPL     s:9400+4
        18 000434   200004 236100                    LDQ     MAX_SEQ_NO,,AUTO
        18 000435   200004 756100                    STQ     MAX_SEQ_NO,,AUTO

      246     9401    3                              COMCOM.FIRST_ENTRY_SEQ_NUM);
      247     9402    3               MIN_SEQ_NO = MINIMUM (MIN_SEQ_NO,

   9402 18 000436   300010 236100                    LDQ     8,,PR3
        18 000437   777777 376007                    ANQ     -1,DL
        18 000440   000443 604000 18                 TMI     s:9402+5
        18 000441   200005 116100                    CMPQ    MIN_SEQ_NO,,AUTO
        18 000442   000444 604400 18                 TMOZ    s:9402+6
        18 000443   200005 236100                    LDQ     MIN_SEQ_NO,,AUTO
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:35   
        18 000444   200005 756100                    STQ     MIN_SEQ_NO,,AUTO
        18 000445   000502 710000 18                 TRA     s:9415

      248     9403    3                          OPND -> ETT.LOP -> VARIABLE.SEQ#.BD);
      249     9404
      250     9405    3             CASE(ELSE);

      251     9406    3               CALL Z8GS$SCAN_MAX(OPND -> ETT.LOP);

   9406 18 000446   100001 634500                    EPPR4   1,,PR1
        18 000447   200020 454500                    STP4    BLOCK$+2,,AUTO
        18 000450   200020 630500                    EPPR0   BLOCK$+2,,AUTO
        18 000451   000001 631400 19                 EPPR1   1
        18 000452   000000 701000 18                 TSX1    s:43
        18 000453   000000 011000                    NOP     0

      252     9407
      253     9408    3               MAX_SEQ_NO = MAXIMUM (MAX_SEQ_NO,

   9408 18 000454   200003 470500                    LDP0    @OPND,,AUTO
        18 000455   000000 471500                    LDP1    0,,PR0
        18 000456   100001 473500                    LDP3    1,,PR1
        18 000457   300004 236100                    LDQ     4,,PR3
        18 000460   000022 772000                    QRL     18
        18 000461   000465 604000 18                 TMI     s:9408+9
        18 000462   200004 116100                    CMPQ    MAX_SEQ_NO,,AUTO
        18 000463   000465 605000 18                 TPL     s:9408+9
        18 000464   200004 236100                    LDQ     MAX_SEQ_NO,,AUTO
        18 000465   200004 756100                    STQ     MAX_SEQ_NO,,AUTO

      254     9409    3                              OPND -> ETT.LOP -> ETT.CMP_SC);
      255     9410    3               MIN_SEQ_NO = MINIMUM (MIN_SEQ_NO,

   9410 18 000466   300004 236100                    LDQ     4,,PR3
        18 000467   777777 376007                    ANQ     -1,DL
        18 000470   000473 604000 18                 TMI     s:9410+5
        18 000471   200005 116100                    CMPQ    MIN_SEQ_NO,,AUTO
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:36   
        18 000472   000474 604400 18                 TMOZ    s:9410+6
        18 000473   200005 236100                    LDQ     MIN_SEQ_NO,,AUTO
        18 000474   200005 756100                    STQ     MIN_SEQ_NO,,AUTO

      256     9411    3                              OPND -> ETT.LOP -> ETT.CMP_BD);
      257     9412    3               COUNT = COUNT + OPND -> ETT.LOP -> ETT.COUNT + 1;

   9412 18 000475   300000 236100                    LDQ     0,,PR3
        18 000476   777777 376007                    ANQ     -1,DL
        18 000477   200006 036100                    ADLQ    COUNT,,AUTO
        18 000500   000001 036007                    ADLQ    1,DL
        18 000501   200006 756100                    STQ     COUNT,,AUTO

      258     9413    3           END; /* CASE */

      259     9414
      260     9415    2           OPND -> ETT.CMP_SC = MAX_SEQ_NO;

   9415 18 000502   200004 720100                    LXL0    MAX_SEQ_NO,,AUTO
        18 000503   100004 740100                    STX0    4,,PR1

      261     9416    2           OPND -> ETT.CMP_BD = MIN_SEQ_NO;

   9416 18 000504   000000 471500                    LDP1    0,,PR0
        18 000505   200005 721100                    LXL1    MIN_SEQ_NO,,AUTO
        18 000506   100004 441100                    SXL1    4,,PR1

      262     9417    2           OPND -> ETT.COUNT = COUNT;

   9417 18 000507   000000 471500                    LDP1    0,,PR0
        18 000510   200006 722100                    LXL2    COUNT,,AUTO
        18 000511   100000 442100                    SXL2    0,,PR1

      263     9418
      264     9419    2       END; /* CASE OF P3VEC (ID) */

      265     9420
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:37   
      266     9421        %EJECT;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:38   
      267     9422
      268     9423            /*V* Factor in the next referenced label definition,
      269     9424                 and DO -- DOEND loops.
      270     9425            */
      271     9426
      272     9427    1       IF OPND -> ETT.CMP_SC ~= 0 THEN

   9427 18 000512   200003 470500                    LDP0    @OPND,,AUTO
        18 000513   000000 471500                    LDP1    0,,PR0
        18 000514   100004 220100                    LDX0    4,,PR1
        18 000515   000746 600000 18                 TZE     s:9526

      273     9428    2         DO;

      274     9429
      275     9430                    /* If CMP_SC is not equal to zero we know the item
      276     9431                       has variables below it in its trees.
      277     9432                       Factor in "Common" redefinition caused by CALLs,
      278     9433                       PFORMs, and Group Moves.
      279     9434                    */
      280     9435
      281     9436    2           OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,

   9436 18 000516   100004 236100                    LDQ     4,,PR1
        18 000517   000022 772000                    QRL     18
        18 000520   000373 116000 xsym               CMPQ    COMCOM+251
        18 000521   000523 603000 18                 TRC     s:9436+5
        18 000522   000373 236000 xsym               LDQ     COMCOM+251
        18 000523   000000 621006                    EAX1    0,QL
        18 000524   100004 741100                    STX1    4,,PR1

      282     9437    2                                  COMCOM.COMMON_REDEF);
      283     9438    2           OPND -> ETT.CMP_BD = MINIMUM (OPND -> ETT.CMP_BD,

   9438 18 000525   000000 471500                    LDP1    0,,PR0
        18 000526   100004 236100                    LDQ     4,,PR1
        18 000527   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:39   
        18 000530   000533 604000 18                 TMI     s:9438+6
        18 000531   000010 116000 17                 CMPQ    O3COM+8
        18 000532   000534 604400 18                 TMOZ    s:9438+7
        18 000533   000010 236000 17                 LDQ     O3COM+8
        18 000534   000000 620006                    EAX0    0,QL
        18 000535   100004 440100                    SXL0    4,,PR1

      284     9439    2                                  O3COM.LAST_OPA_REDEF);
      285     9440
      286     9441    2           IF OPND -> ETT.CMP_SC <= COMCOM.FIRST_ENTRY_SEQ_NUM + 1

   9441 18 000536   000000 471500                    LDP1    0,,PR0
        18 000537   000440 235000 xsym               LDA     COMCOM+288
        18 000540   000001 035007                    ADLA    1,DL
        18 000541   200020 755100                    STA     BLOCK$+2,,AUTO
        18 000542   100004 236100                    LDQ     4,,PR1
        18 000543   000022 772000                    QRL     18
        18 000544   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000545   000630 605400 18                 TPNZ    s:9475
        18 000546   000000 471500                    LDP1    0,,PR0
        18 000547   100004 720100                    LXL0    4,,PR1
        18 000550   777777 100003                    CMPX0   -1,DU
        18 000551   000630 601000 18                 TNZ     s:9475

      287     9442    2              AND OPND -> ETT.CMP_BD = %MAX_SEQ# THEN
      288     9443    3             DO;

      289     9444    3               IF OPND -> ETT.ID = %BASE THEN

   9444 18 000552   100000 221100                    LDX1    0,,PR1
        18 000553   000001 101003                    CMPX1   1,DU
        18 000554   000746 601000 18                 TNZ     s:9526

      290     9445    4                 DO;

      291     9446                        /* For an external data item in a internal procedure
      292     9447                           might be redefined outside and we cannot tell, so
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:40   
      293     9448                           check the redefine bit for the possibility and
      294     9449                           assign it the right compute sequence number     */
      295     9450    4                   ST$$ = OPND -> ETT.LOP;

   9450 18 000555   100001 236100                    LDQ     1,,PR1
        18 000556   200014 756100                    STQ     ST$$,,AUTO

      296     9451    4                   IF ST$$ -> SCALAR.COUNT > 1 THEN

   9451 18 000557   200014 473500                    LDP3    ST$$,,AUTO
        18 000560   300000 236100                    LDQ     0,,PR3
        18 000561   000777 376007                    ANQ     511,DL
        18 000562   000002 116007                    CMPQ    2,DL
        18 000563   000746 602000 18                 TNC     s:9526

      297     9452    5                     DO;

      298     9453    5                       BLOCK$ = COMCOM.BLOCK$;

   9453 18 000564   000145 236000 xsym               LDQ     COMCOM+101
        18 000565   200016 756100                    STQ     BLOCK$,,AUTO

      299     9454    6                       DO WHILE (BLOCK$ -> BLOCK.COUNT ~= ST$$->SCALAR.COUNT);

   9454 18 000566   200016 474500                    LDP4    BLOCK$,,AUTO
        18 000567   400000 236100                    LDQ     0,,PR4
        18 000570   300000 676100                    ERQ     0,,PR3
        18 000571   000777 376007                    ANQ     511,DL
        18 000572   000604 600000 18                 TZE     s:9457

      300     9455    6                         BLOCK$ = BLOCK$ -> BLOCK.NEXT;

   9455 18 000573   200016 470500                    LDP0    BLOCK$,,AUTO
        18 000574   000004 236100                    LDQ     4,,PR0
        18 000575   200016 756100                    STQ     BLOCK$,,AUTO

      301     9456    6                       END; /* DO WHILE */
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:41   

   9456 18 000576   200014 470500                    LDP0    ST$$,,AUTO
        18 000577   200016 471500                    LDP1    BLOCK$,,AUTO
        18 000600   100000 236100                    LDQ     0,,PR1
        18 000601   000000 676100                    ERQ     0,,PR0
        18 000602   000777 376007                    ANQ     511,DL
        18 000603   000573 601000 18                 TNZ     s:9455

      302     9457    5                       IF BLOCK$ -> BLOCK.B.REDEFINED THEN

   9457 18 000604   200016 470500                    LDP0    BLOCK$,,AUTO
        18 000605   000003 234100                    SZN     3,,PR0
        18 000606   000746 605000 18                 TPL     s:9526

      303     9458                              %FACTOR_IN_REFD_LABEL;

   9460 18 000607   000003 236000 17                 LDQ     O3COM+3
        18 000610   000000 116000 19                 CMPQ    0
        18 000611   000746 600000 18                 TZE     s:9526

   9462 18 000612   200003 471500                    LDP1    @OPND,,AUTO
        18 000613   100000 473500                    LDP3    0,,PR1
        18 000614   000003 474400 17                 LDP4    O3COM+3
        18 000615   400000 236100                    LDQ     0,,PR4
        18 000616   777777 376007                    ANQ     -1,DL
        18 000617   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000620   300004 236100                    LDQ     4,,PR3
        18 000621   000022 772000                    QRL     18
        18 000622   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000623   000625 603000 18                 TRC     s:9462+11
        18 000624   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000625   000000 620006                    EAX0    0,QL
        18 000626   300004 740100                    STX0    4,,PR3

      304     9467    5                     END;

      305     9468    4                 END;
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:42   

      306     9469    3               ELSE
      307     9470                      /* NULL - If no redefinition, then compute at entry.
      308     9471    3                 */;
      309     9472    3             END;

   9472 18 000627   000746 710000 18                 TRA     s:9526

      310     9473    2           ELSE
      311     9474    3             DO;

      312     9475    3               IF O3COM.DO# = 0 THEN

   9475 18 000630   000004 236000 17                 LDQ     O3COM+4
        18 000631   000652 601000 18                 TNZ     s:9491

      313     9476                      %FACTOR_IN_REFD_LABEL;

   9478 18 000632   000003 236000 17                 LDQ     O3COM+3
        18 000633   000000 116000 19                 CMPQ    0
        18 000634   000746 600000 18                 TZE     s:9526

   9480 18 000635   000000 471500                    LDP1    0,,PR0
        18 000636   000003 473400 17                 LDP3    O3COM+3
        18 000637   300000 236100                    LDQ     0,,PR3
        18 000640   777777 376007                    ANQ     -1,DL
        18 000641   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000642   100004 236100                    LDQ     4,,PR1
        18 000643   000022 772000                    QRL     18
        18 000644   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000645   000647 603000 18                 TRC     s:9480+10
        18 000646   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000647   000000 620006                    EAX0    0,QL
        18 000650   100004 740100                    STX0    4,,PR1

   9483 18 000651   000746 710000 18                 TRA     s:9526

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:43   
      314     9485    3               ELSE
      315     9486    4                 DO;

      316     9487
      317     9488                        /* DO# ~= 0: Item is in a loop.  Check to see
      318     9489                           if it can be moved out of the loop.
      319     9490                        */
      320     9491    4                   IF OPND -> ETT.CMP_SC < O3COM.DO#

   9491 18 000652   000000 471500                    LDP1    0,,PR0
        18 000653   100004 236100                    LDQ     4,,PR1
        18 000654   000022 772000                    QRL     18
        18 000655   000004 116000 17                 CMPQ    O3COM+4
        18 000656   000717 603000 18                 TRC     s:9509
        18 000657   100004 236100                    LDQ     4,,PR1
        18 000660   777777 376007                    ANQ     -1,DL
        18 000661   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000662   000005 236000 17                 LDQ     O3COM+5
        18 000663   000002 136007                    SBLQ    2,DL
        18 000664   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000665   000717 605000 18                 TPL     s:9509

      321     9492    4                      AND OPND -> ETT.CMP_BD > O3COM.DOEND# - 2 THEN
      322     9493    5                     DO;

      323     9494    5                       OPND -> ETT.CMP_SC = O3COM.DO# - 2;

   9494 18 000666   000000 471500                    LDP1    0,,PR0
        18 000667   000004 720000 17                 LXL0    O3COM+4
        18 000670   777776 621010                    EAX1    -2,X0
        18 000671   100004 741100                    STX1    4,,PR1

      324     9495
      325     9496                            %ON_SIZE_LABEL_CHECK;

   9498 18 000672   000003 236000 17                 LDQ     O3COM+3
        18 000673   000000 116000 19                 CMPQ    0
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:44   
        18 000674   000746 600000 18                 TZE     s:9526
        18 000675   000003 471400 17                 LDP1    O3COM+3
        18 000676   100003 473500                    LDP3    3,,PR1
        18 000677   300001 474500                    LDP4    1,,PR3
        18 000700   400003 236100                    LDQ     3,,PR4
        18 000701   040000 316007                    CANQ    16384,DL
        18 000702   000746 600000 18                 TZE     s:9526

   9501 18 000703   000000 475500                    LDP5    0,,PR0
        18 000704   100000 236100                    LDQ     0,,PR1
        18 000705   777777 376007                    ANQ     -1,DL
        18 000706   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000707   500004 236100                    LDQ     4,,PR5
        18 000710   000022 772000                    QRL     18
        18 000711   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000712   000714 603000 18                 TRC     s:9501+9
        18 000713   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000714   000000 620006                    EAX0    0,QL
        18 000715   500004 740100                    STX0    4,,PR5

      326     9506    5                     END;

   9506 18 000716   000746 710000 18                 TRA     s:9526

      327     9507    4                   ELSE
      328     9508    5                     DO;

      329     9509    5                       OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,

   9509 18 000717   000000 471500                    LDP1    0,,PR0
        18 000720   100004 236100                    LDQ     4,,PR1
        18 000721   000022 772000                    QRL     18
        18 000722   000004 116000 17                 CMPQ    O3COM+4
        18 000723   000725 603000 18                 TRC     s:9509+6
        18 000724   000004 236000 17                 LDQ     O3COM+4
        18 000725   000000 620006                    EAX0    0,QL
        18 000726   100004 740100                    STX0    4,,PR1
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:45   

      330     9510    5                                              O3COM.DO#);
      331     9511                            %FACTOR_IN_REFD_LABEL;

   9513 18 000727   000003 236000 17                 LDQ     O3COM+3
        18 000730   000000 116000 19                 CMPQ    0
        18 000731   000746 600000 18                 TZE     s:9526

   9515 18 000732   000000 471500                    LDP1    0,,PR0
        18 000733   000003 473400 17                 LDP3    O3COM+3
        18 000734   300000 236100                    LDQ     0,,PR3
        18 000735   777777 376007                    ANQ     -1,DL
        18 000736   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000737   100004 236100                    LDQ     4,,PR1
        18 000740   000022 772000                    QRL     18
        18 000741   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000742   000744 603000 18                 TRC     s:9515+10
        18 000743   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000744   000000 620006                    EAX0    0,QL
        18 000745   100004 740100                    STX0    4,,PR1

      332     9520    5                     END;

      333     9521    4                 END;

      334     9522    3             END;

      335     9523    2         END; /* If CMP_SC not equal to 0 */

      336     9524
      337     9525
      338     9526    1       IF COMCOM.H_ENTRY$ ~= ADDR(NIL) THEN

   9526 18 000746   000423 236000 xsym               LDQ     COMCOM+275
        18 000747   000000 116000 19                 CMPQ    0
        18 000750   000766 600000 18                 TZE     s:9530

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:46   
      339     9527    1         OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,

   9527 18 000751   200003 470500                    LDP0    @OPND,,AUTO
        18 000752   000000 471500                    LDP1    0,,PR0
        18 000753   000423 473400 xsym               LDP3    COMCOM+275
        18 000754   300000 236100                    LDQ     0,,PR3
        18 000755   777777 376007                    ANQ     -1,DL
        18 000756   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 000757   100004 236100                    LDQ     4,,PR1
        18 000760   000022 772000                    QRL     18
        18 000761   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 000762   000764 603000 18                 TRC     s:9527+11
        18 000763   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 000764   000000 620006                    EAX0    0,QL
        18 000765   100004 740100                    STX0    4,,PR1

      340     9528    1                                COMCOM.H_ENTRY$ -> ILS.SEQNO);
      341     9529
      342     9530    1       IF  COMCOM.INT_SUB$ ~= ADDR(NIL)

   9530 18 000766   000361 236000 xsym               LDQ     COMCOM+241
        18 000767   000000 116000 19                 CMPQ    0
        18 000770   001011 600000 18                 TZE     s:9535
        18 000771   200003 470500                    LDP0    @OPND,,AUTO
        18 000772   000000 471500                    LDP1    0,,PR0
        18 000773   100000 220100                    LDX0    0,,PR1
        18 000774   000016 100003                    CMPX0   14,DU
        18 000775   001011 601000 18                 TNZ     s:9535

      343     9531    1       AND OPND -> ETT.ID = %ARGP THEN
      344     9532    1         OPND -> ETT.CMP_SC = MAXIMUM (OPND -> ETT.CMP_SC,

   9532 18 000776   000361 473400 xsym               LDP3    COMCOM+241
        18 000777   300000 236100                    LDQ     0,,PR3
        18 001000   777777 376007                    ANQ     -1,DL
        18 001001   200020 756100                    STQ     BLOCK$+2,,AUTO
        18 001002   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:47   
        18 001003   000022 772000                    QRL     18
        18 001004   200020 116100                    CMPQ    BLOCK$+2,,AUTO
        18 001005   001007 603000 18                 TRC     s:9532+9
        18 001006   200020 236100                    LDQ     BLOCK$+2,,AUTO
        18 001007   000000 620006                    EAX0    0,QL
        18 001010   100004 740100                    STX0    4,,PR1

      345     9533    1                                COMCOM.INT_SUB$ -> ILS.SEQNO);
      346     9534
      347     9535    1   END Z8GS$SCAN_MAX;

   9535 18 001011   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:48   
--  Include file information  --

   Z9G_SYS_DEP.:Z8A6TOU  is referenced.
   Z8G_O3COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8G_P3VEC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_GST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8GS$SCAN_MAX.
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:49   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 002 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 003 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 004 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:50   
  ****  Section 005 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 006 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 007 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 008 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 009 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 010 LblCom ST_

PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:51   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 011 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 012 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 013 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 014 LblCom GST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 GST$

  ****  Section 015 LblCom GST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:52   

     0-0-0/w STRC(180)   r     1 GST_

  ****  Section 016 LblCom P3VEC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 P3VEC(0:294)

  ****  Section 017 LblCom O3COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2016)  r     1 O3COM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OPND                     16-0-0/w PTR         r     1 BLOCK$
     7-0-0/w SBIN              1 COMPUTE_SEQ                6-0-0/w SBIN        r     1 COUNT
     4-0-0/w SBIN        r     1 MAX_SEQ_NO                 5-0-0/w SBIN        r     1 MIN_SEQ_NO
    10-0-0/b BIT         r     1 NO                        *0-0-0/w PTR         r     1 OPND
    15-0-0/w PTR               1 QLT$$                     12-0-0/b BIT               1 REDEFINES
    13-0-0/b BIT               1 RENAMES                   14-0-0/w PTR         r     1 ST$$
    11-0-0/b BIT         r     1 YES

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:53   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(396)   r     1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(216)         1 CCOSU                      0-0-0/w STRC(396)         1 CD
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)         1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(108)   r     1 GST                        0-0-0/w STRC(180)   r     1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)   r     1 ILS
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(396)   r     1 LABEL
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)         1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(396)         1 ST                         0-0-0/w STRC(72)          1 STP2
PL6.E3A0      #001=Z8GS$SCAN_MAX File=Z8GS.:Z8A6TSI                              SAT 08/09/97 13:15 Page:54   
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN


   Procedure Z8GS$SCAN_MAX requires 522 words for executable code.
   Procedure Z8GS$SCAN_MAX requires 20 words of local(AUTO) storage.

    No errors detected in file Z8GS.:Z8A6TSI    .
