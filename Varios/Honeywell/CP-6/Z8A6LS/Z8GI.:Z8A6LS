VERSION A06

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:1    
        1        1        /*M* Z8GI$INSERT_EVALP -- Insert an EVALP item into the ILS/ILL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*   NAME: Z8GI$INSERT_EVALP
       10       10
       11       11            PURPOSE: Insert an EVALP item into the ILS/ILL at the
       12       12                     compute sequence indicated by the CMP_SC field
       13       13                     of the triad pointed to by OPND.
       14       14             AUTHOR: John Heath.
       15       15        */
       16       16
       17       17        /*D*   NAME: Z8GI$INSERT_EVALP
       18       18
       19       19               CALL:: CALL Z8GI$INSERT_EVALP (Pointer_to_Triad) ;
       20       20                     Usually called via INCR_COUNT macro in Z8GO.
       21       21
       22       22          INTERFACE: %RESERVE_ILL if an EVALP item needs to be created.
       23       23
       24       24        DESCRIPTION::
       25       25
       26       26           Create an EVALP for the expression pointed to
       27       27           by OPND.  Insert that EVALP into the ILS at the
       28       28           compute sequence indicated by the CMP_SC field
       29       29           of the triad.
       30       30
       31       31           INPUTS: OPND -- Points to a triad.
       32       32           ======
       33       33
       34       34           OUTPUTS: An EVALP item linked into the ILS/ILL.
       35       35           =======
       36       36
       37       37           This function is done in four steps:
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:2    
       38       38
       39       39           (1) Walk back thru the ILS to find the item whose sequence
       40       40               number matches the CMP_SC [compute sequence = MAX (FDPs)].
       41       41
       42       42           (2) Search thru the EVALPs attached to that ILS
       43       43               item to see if an EVALP already exists for
       44       44               this item.  If an EVALP already exists, then
       45       45               update its count (CNTE), update its LSEQ (the
       46       46               low sequence number of reference), and exit.
       47       47
       48       48           (3) If an EVALP doesn't exist, then create an EVALP
       49       49               and add it to the list.
       50       50
       51       51           (4) Exit (stage left).
       52       52
       53       53           Note: There are two counts involved here that shouldn't
       54       54                 be confused:
       55       55
       56       56                 (1) EVALP.CNTE -- the count of the number of
       57       57                     references to a triad within a redefinition
       58       58                     range;
       59       59
       60       60                 (2) ETT.COUNT -- the count of the number of
       61       61                     triads below this triad.  This is used in
       62       62                     ordering the EVALPs for a given sequence
       63       63                     number.
       64       64        */
       65       65
       66       66        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:3    
       67       67        Z8GI$INSERT_EVALP: PROC (OPND) ;
       68       68
       69       69        %EQU PHASE = 3 ;
       70       70        %EQU Z8GI = 879 ; /* 8 || G=7 || I=9 */
       71       71        %EQU MODULE = Z8GI ;
       72       72        %INCLUDE Z8A_DEFC ;
       73      140        %INCLUDE Z8A_SUPP_MAC ;
       74     2540        %INCLUDE Z8A_COMCOM ;
       75     3190        %INCLUDE Z8A_ILS ;
       76     3299        %INCLUDE Z8A_ILL ;
       77     3992        %INCLUDE Z8A_ETT ;
       78     4293        %INCLUDE Z8G_O3COM ;
       79     4333
       80     4334    1   DCL   OPND       PTR ;       /* The triad in question */
       81     4335    1   DCL   SEQ$       PTR ;       /* Insertion Sequence No */
       82     4336    1   DCL   COUNT      SBIN WORD ; /* # triads below OPND   */
       83     4337    1   DCL   NEXT$      PTR ;       /* Next EVALP in list    */
       84     4338    1   DCL   PREV$      PTR ;       /* Previous EVALP        */
       85     4339    1   DCL   ILL$$      PTR ;       /* Local ILL pointer     */
       86     4340    1   DCL   COMPUTE_SEQ SBIN ;     /* Seq# to link it in at */
       87     4341    1   DCL   PREV_SEQ$   PTR ;
       88     4342    1   DCL   ILS$$       PTR ;                                /*#28761*/
       89     4343    1   DCL   VAL_REC_COUNT SBIN WORD ;
       90     4344    1   DCL   I           SBIN WORD ;
       91     4345    1   DCL   SEQ#        SBIN WORD ;
       92     4346    1   DCL   INCR        SBIN WORD ;
       93     4347
       94     4348        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:4    
       95     4349        /*F*   NAME: Z8GI_Step_1
       96     4350
       97     4351        DESCRIPTION::
       98     4352
       99     4353           STEP (1): Find the ILS item at which the EVALP for the triad
      100     4354           ========  indicated by OPND will be linked in.
      101     4355                     A triad whose compute sequence is 32, will
      102     4356                     be linked in at ILS sequence number 33.
      103     4357        */
      104     4358
      105     4359               /*V* Seq#3 is the seq# of the LINOI after the ENTRY. */
      106     4360
      107     4361    1          COMPUTE_SEQ = MAXIMUM (OPND->ETT.CMP_SC, COMCOM.FIRST_ENTRY_SEQ_NUM) ;
      108     4362
      109     4363    1          IF COMPUTE_SEQ = COMCOM.FIRST_ENTRY_SEQ_NUM
      110     4364    1          THEN SEQ$ = O3COM.SEQ#1$ ;
      111     4365    2          ELSE DO ;
      112     4366    2            IF  COMPUTE_SEQ < O3COM.SL.SEQ# (O3COM.SL_INDEX)
      113     4367    2            AND O3COM.CURRENT_SEQ_NO > O3COM.SL.SEQ# (O3COM.SL_INDEX)
      114     4368    3            THEN DO ;
      115     4369    4              DO I = O3COM.SL_INDEX TO 14 ;
      116     4370    4                IF COMPUTE_SEQ >= O3COM.SL.SEQ# (I+1)
      117     4371    4                THEN GOTO EXIT_LOOP ;
      118     4372    4              END ;
      119     4373    3              I = 15 ;
      120     4374    3   EXIT_LOOP: ;
      121     4375    3              SEQ$ = O3COM.SL.SEQ$ (I) ;
      122     4376    3            END ;
      123     4377    2            ELSE SEQ$ = ILS$ ;
      124     4378    2            PREV_SEQ$ = SEQ$ ;
      125     4379    3            DO WHILE (SEQ$ ~= ADDR (NIL) AND
      126     4380    3                 SEQ$->ILS.SEQNO > COMPUTE_SEQ) ;
      127     4381    3              PREV_SEQ$ = SEQ$ ;
      128     4382    3              SEQ$ = SEQ$ -> ILS.NEXT ;
      129     4383
      130     4384                   /* Skip over preset ILL items (seq_no = 0) */
      131     4385    4              DO WHILE (SEQ$ ~= ADDR(NIL) AND SEQ$ -> ILS.SEQNO = 0) ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:5    
      132     4386    4                SEQ$ = SEQ$ -> ILS.NEXT ;
      133     4387    3              END ; /* ILS.ILL -> ID = PRESET, PREOFF, PTR_SET, ... */;
      134     4388
      135     4389    3            END ;
      136     4390
      137     4391    2            SEQ$ = PREV_SEQ$ ;
      138     4392
      139     4393    2          END /* Else Do */ ;
      140     4394                                                               /*#28761*/
      141     4395    1   STEP_1_5: ;
      142     4396
      143     4397        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:6    
      144     4398        /*F*   NAME: Z8GI_Step_1.5
      145     4399
      146     4400        DESCRIPTION::
      147     4401
      148     4402          STEP(1.5): Check to see if this EVALP will be in the midst of a
      149     4403                     VAL/VAL_END pair.  If so, move it out to the VAL_END.
      150     4404        */
      151     4405
      152     4406    1          IF  COMCOM.MAX_RECEIVING_ITEMS > 1
      153     4407    2          AND COMPUTE_SEQ > COMCOM.FIRST_ENTRY_SEQ_NUM THEN DO ;
      154     4408
      155     4409    2            ILS$$ = SEQ$ ;
      156     4410
      157     4411    3    LOOP:   DO VAL_REC_COUNT = 1 TO COMCOM.MAX_RECEIVING_ITEMS + 1 ;
      158     4412
      159     4413    3     ONE_MORE_TIME: ;
      160     4414
      161     4415    3              ILL$$ = ILS$$ -> ILS.ILL$ ;
      162     4416
      163     4417    3     AGAIN: ;
      164     4418
      165     4419    4              DO CASE (ILL$$ -> ILL.ID) ;
      166     4420
      167     4421    4                CASE (%LINOI) ;
      168     4422
      169     4423    4                  ILS$$ = ILS$$ -> ILS.NEXT ;
      170     4424    4                  IF ILS$$ = ADDR(NIL) THEN EXIT LOOP ;
      171     4425    4                  GOTO ONE_MORE_TIME ; /* Don't incr Val_Rec_Count */
      172     4426
      173     4427    4                CASE (%EVALP) ;
      174     4428
      175     4429    5                  DO WHILE (ILL$$ -> ILL.ID = %EVALP) ;
      176     4430    5                    ILL$$ = ILL$$ -> CCOSU.ILL$ ;
      177     4431    5                  END ;
      178     4432
      179     4433    4                  GOTO AGAIN ;
      180     4434
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:7    
      181     4435    4                CASE (%VAL_END) ;
      182     4436
      183     4437    4                  EXIT LOOP ;
      184     4438
      185     4439    4                CASE (%VAL) ;
      186     4440
      187     4441    4                  IF VAL_REC_COUNT = 1 THEN
      188     4442    4                    EXIT LOOP ;
      189     4443    5                  ELSE DO ;
      190     4444    5                    IF O3COM.CURRENT_SEQ_NO >
      191     4445    5                       ILL$$ -> VAL.VAL_END$ -> ILS.SEQNO THEN
      192     4446    5                       SEQ$ = ILL$$ -> VAL.VAL_END$ -> ILS.ILL$ ->
      193     4447    5                                       VAL_END.LINOI$ ;
      194     4448    5                    EXIT LOOP ;
      195     4449    5                  END ;
      196     4450
      197     4451    4              END ; /* Case of ILL ID */
      198     4452
      199     4453    3            ILS$$ = ILS$$ -> ILS.NEXT ;
      200     4454    3            IF ILS$$ = ADDR(NIL) THEN EXIT ;
      201     4455
      202     4456    3            END ; /* Do LOOP */
      203     4457
      204     4458    2          END ; /* COMCOM.MAX_RECEIVING_ITEMS > 1 */
      205     4459
      206     4460    1   STEP_2: ; /* Use this label for DELTA AT commands */
      207     4461
      208     4462        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:8    
      209     4463        /*F*   NAME: Z8GI_Step_2
      210     4464
      211     4465        DESCRIPTION::
      212     4466
      213     4467           STEP (2): SEQ$ points to the ILS item whose sequence
      214     4468           ========  number is one greater than our triad's
      215     4469                     sequence number.  Now we need to search
      216     4470                     thru the EVALPs (starting at SEQ$->ILS.ILL$)
      217     4471                     to see if our triad already has an EVALP.
      218     4472                     If the EVALP is found, then update its
      219     4473                     CNTE (#references) and LSEQ (low seq no.).
      220     4474                     Note: The EVALPs are linked by descending
      221     4475                     ETT.COUNTs.
      222     4476        */
      223     4477    2          IF SEQ$ = ILS$ THEN DO ;
      224     4478    3            IF O3COM.EVALP$ = ADDR(NIL) THEN DO ;
      225     4479    3              SEQ$ = ILS$ -> ILS.NEXT ;
      226     4480    4              DO WHILE (SEQ$ ~= ADDR(NIL)) ;
      227     4481    4                IF SEQ$->ILS.ILL$ ~= ADDR (NIL) THEN
      228     4482    4                  IF SEQ$->ILS.ILL$->ILL.ID = %LINOI
      229     4483    4                  OR SEQ$->ILS.ILL$->ILL.ID = %EVALP THEN
      230     4484    4                    EXIT ;
      231     4485    4                SEQ$ = SEQ$ -> ILS.NEXT ;
      232     4486    4              END ; /* DO WHILE */
      233     4487    3              IF SEQ$ = ADDR(NIL)
      234     4488    3              THEN GOTO STEP_4 ;
      235     4489    3              ELSE ILL$$ = SEQ$ -> ILS.ILL$ ;
      236     4490    3            END ; /* O3COM.EVALP$ = ADDR(NIL) */
      237     4491    2            ELSE ILL$$ = O3COM.EVALP$ ;
      238     4492    2          END ; /* SEQ$ = ILS$ */
      239     4493    1          ELSE ILL$$ = SEQ$ -> ILS.ILL$ ;
      240     4494    1          COUNT = OPND -> ETT.COUNT ;
      241     4495    1          PREV$ = ADDR(NIL) ;
      242     4496
      243     4497    2          DO WHILE (ILL$$->ILL.ID = %EVALP
      244     4498    2                 OR ILL$$->ILL.ID = %CCOSU
      245     4499    2                 OR ILL$$->ILL.ID = %INITV
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:9    
      246     4500    2                 OR ILL$$->ILL.ID = %INCRV) ;
      247     4501
      248     4502    2            IF ILL$$->ILL.ID = %EVALP
      249     4503    3            OR ILL$$->ILL.ID = %CCOSU THEN DO ;
      250     4504
      251     4505    4              IF ILL$$->CCOSU.EVEX->ETT.COUNT = COUNT THEN DO ;
      252     4506    5                IF ILL$$->CCOSU.EVEX = OPND THEN DO ;
      253     4507    5                  OPND->ETT.EVALP$ = ILL$$ ; /* See Note (1) below */
      254     4508    5                  ILL$$->CCOSU.CNTE = ILL$$->CCOSU.CNTE + 1 ;
      255     4509    5                  ILL$$->CCOSU.LSEQ = O3COM.CURRENT_SEQ_NO ;
      256     4510    5                  ILL$$->CCOSU.LEVEL = MAXIMUM (ILL$$->CCOSU.LEVEL,
      257     4511    5                                               O3COM.LOOP_LEVEL) ;
      258     4512    5                  GOTO STEP_4 ;
      259     4513    5                END /* If Then Do */ ;
      260     4514    4              END /* If Then Do */ ;
      261     4515    3              ELSE /* The counts are not equal */
      262     4516    3              IF ILL$$->CCOSU.EVEX->ETT.COUNT < COUNT
      263     4517    3              THEN GOTO STEP_3 ;
      264     4518
      265     4519    3            END /* If ID = EVALP */ ;
      266     4520
      267     4521    2            PREV$ = ILL$$ ;
      268     4522    2            ILL$$ = ILL$$ -> CCOSU.ILL$ ;
      269     4523
      270     4524    2          END /* Do While ILL.ID = %EVALP */ ;
      271     4525
      272     4526        /* Note (1): EVALP$ must be reset since Z8GS may have reset this
      273     4527                     field to nil in the case of two GO items in a row
      274     4528                     that use the same triad which contains redefined
      275     4529                     variables (CMP_SC = current seq#). (test case =
      276     4530                     PF0041B).
      277     4531        */
      278     4532
      279     4533    1   STEP_3: ;
      280     4534
      281     4535        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:10   
      282     4536        /*F*   NAME: Z8GI_Step_3
      283     4537
      284     4538        DESCRIPTION::
      285     4539
      286     4540           STEP (3): An EVALP for our triad doesn't yet exist,
      287     4541           ========  so we shall create one.  We stopped the
      288     4542                     DO WHILE in STEP(2) at the point (in the
      289     4543                     EVALP linked list) where we want to insert
      290     4544                     the EVALP we are now creating (between
      291     4545                     PREV$ and ILL$$).
      292     4546        */
      293     4547    1          NEXT$ = ILL$$ ;
      294     4548                           /* Get an EVALP item from the pool if one is
      295     4549                              available, otherwise reserve a new one.
      296     4550                           */
      297     4551    1          IF O3COM.HEAD_EVALP$ = ADDR(NIL) THEN
      298     4552                 %RESERVE_ILL(ITEM=%EVALP,
      299     4553                              POINTER=ILL$$);
      300     4563    1          ELSE
      301     4564    2            DO;
      302     4565                   %REMOVE_FROM_SL_LIST(PTR=ILL$$,
      303     4566                                        ITEM=CCOSU,
      304     4567                                        HEAD=O3COM.HEAD_EVALP$,
      305     4568                                        NEXT=NEXT$);
      306     4581    2              ILL$$ -> CCOSU = '0'O;
      307     4582    2              ILL$$ -> CCOSU.ID = %EVALP;
      308     4583    2            END;
      309     4584
      310     4585
      311     4586    1          ILL$$->CCOSU.CNTE = 1 ;
      312     4587    1          ILL$$->CCOSU.EVEX = OPND ;
      313     4588    1          ILL$$->CCOSU.HSEQ = O3COM.CURRENT_SEQ_NO ;
      314     4589    1          ILL$$->CCOSU.LEVEL = O3COM.LOOP_LEVEL ;
      315     4590    1          OPND->ETT.EVALP$ = ILL$$ ;
      316     4591
      317     4592    2          IF PREV$ = ADDR(NIL) THEN DO ;
      318     4593                 /* This will be the first EVALP in the chain */
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:11   
      319     4594    2            ILL$$->CCOSU.ILL$ = NEXT$ ;
      320     4595    2            SEQ$->ILS.ILL$ = ILL$$ ;
      321     4596    2          END ;
      322     4597    2          ELSE DO ; /* This is not the first in the chain */
      323     4598    2            PREV$->CCOSU.ILL$ = ILL$$ ;
      324     4599    2            ILL$$->CCOSU.ILL$ = NEXT$ ;
      325     4600    2          END ;
      326     4601
      327     4602    1   STEP_4: ; /* Exit */
      328     4603
      329     4604    1          RETURN ;
      330     4605
      331     4606        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:12   
      332     4607    1   Z8GI$MAKE_SEQ_LIST: ENTRY ;
      333     4608
      334     4609        /*F*       NAME: Z8GI$MAKE_SEQ_LIST
      335     4610
      336     4611            DESCRIPTION: For large programs, the linked search back
      337     4612                         thru the ILS to insert an EVALP is time
      338     4613                         consuming.  This routine sets up a short
      339     4614                         cut for use by the ILS linker by creating a
      340     4615                         16-element array splitting the ILS into 16 pieces.
      341     4616        */
      342     4617
      343     4618    1          I = 0 ; /* O3COM.SL index */
      344     4619    1          SEQ# = O3COM.MAX_SEQ# ;
      345     4620    1          SEQ$ = COMCOM.FIRST_ILS ;
      346     4621    1          INCR = (SEQ# - COMCOM.FIRST_ENTRY_SEQ_NUM) / 16 ;
      347     4622    1          SEQ# = SEQ# - INCR ;
      348     4623
      349     4624    2          DO WHILE (SEQ$ ~= ADDR(NIL) AND
      350     4625    2               SEQ$->ILS.SEQNO > COMCOM.FIRST_ENTRY_SEQ_NUM) ;
      351     4626
      352     4627    2            IF  SEQ$->ILS.SEQNO = SEQ#
      353     4628    3            AND I <= 14 THEN DO ;
      354     4629    3              O3COM.SL.SEQ# (I) = SEQ# ;
      355     4630    3              O3COM.SL.SEQ$ (I) = SEQ$ ;
      356     4631    3              I = I + 1;
      357     4632    3              SEQ# = SEQ# - INCR ;
      358     4633    3            END ;
      359     4634    2            SEQ$ = SEQ$ -> ILS.NEXT ;
      360     4635
      361     4636                 /* Skip over preset ILL items (seq_no = 0) */
      362     4637    3            DO WHILE (SEQ$ ~= ADDR(NIL) AND SEQ$ -> ILS.SEQNO = 0) ;
      363     4638    3              SEQ$ = SEQ$ -> ILS.NEXT ;
      364     4639    3            END ; /* ILS.ILL -> ID = PRESET, PREOFF, PTR_SET, ... */
      365     4640
      366     4641    2          END ;
      367     4642
      368     4643    1          O3COM.SEQ#1$ = SEQ$ ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:13   
      369     4644    1          O3COM.SL_INDEX = 0 ;
      370     4645
      371     4646    1   END Z8GI$INSERT_EVALP ;

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:14   
--  Include file information  --

   Z8G_O3COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8GI$INSERT_EVALP.

   Procedure Z8GI$INSERT_EVALP requires 370 words for executable code.
   Procedure Z8GI$INSERT_EVALP requires 18 words of local(AUTO) storage.

    No errors detected in file Z8GI.:Z8A6TSI    .

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:15   

 Object Unit name= Z8GI$INSERT_EVALP                          File name= Z8GI.:Z8A6TOU
 UTS= AUG 09 '97 13:15:00.08 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILS$
    2  LblCom even  none     5      5  ILS_
    3  LblCom even  none     1      1  ILL$
    4  LblCom even  none     5      5  ILL_
    5  LblCom even  none     1      1  ETT$
    6  LblCom even  none     1      1  HEAD_ETT$
    7  LblCom even  none   512   1000  ETT_BUCKETS
    8  LblCom even  none     5      5  ETT_
    9  LblCom even  none    56     70  O3COM
   10   Proc  even  none   370    562  Z8GI$INSERT_EVALP
   11  RoData even  none     4      4  Z8GI$INSERT_EVALP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes            yes      Std        1  Z8GI$INSERT_EVALP
    10    473                  yes      Std        0  Z8GI$MAKE_SEQ_LIST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    ILS_STEP_TABLE                   r    ILL_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:17   


        1        1        /*M* Z8GI$INSERT_EVALP -- Insert an EVALP item into the ILS/ILL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*   NAME: Z8GI$INSERT_EVALP
       10       10
       11       11            PURPOSE: Insert an EVALP item into the ILS/ILL at the
       12       12                     compute sequence indicated by the CMP_SC field
       13       13                     of the triad pointed to by OPND.
       14       14             AUTHOR: John Heath.
       15       15        */
       16       16
       17       17        /*D*   NAME: Z8GI$INSERT_EVALP
       18       18
       19       19               CALL:: CALL Z8GI$INSERT_EVALP (Pointer_to_Triad) ;
       20       20                     Usually called via INCR_COUNT macro in Z8GO.
       21       21
       22       22          INTERFACE: %RESERVE_ILL if an EVALP item needs to be created.
       23       23
       24       24        DESCRIPTION::
       25       25
       26       26           Create an EVALP for the expression pointed to
       27       27           by OPND.  Insert that EVALP into the ILS at the
       28       28           compute sequence indicated by the CMP_SC field
       29       29           of the triad.
       30       30
       31       31           INPUTS: OPND -- Points to a triad.
       32       32           ======
       33       33
       34       34           OUTPUTS: An EVALP item linked into the ILS/ILL.
       35       35           =======
       36       36
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:18   
       37       37           This function is done in four steps:
       38       38
       39       39           (1) Walk back thru the ILS to find the item whose sequence
       40       40               number matches the CMP_SC [compute sequence = MAX (FDPs)].
       41       41
       42       42           (2) Search thru the EVALPs attached to that ILS
       43       43               item to see if an EVALP already exists for
       44       44               this item.  If an EVALP already exists, then
       45       45               update its count (CNTE), update its LSEQ (the
       46       46               low sequence number of reference), and exit.
       47       47
       48       48           (3) If an EVALP doesn't exist, then create an EVALP
       49       49               and add it to the list.
       50       50
       51       51           (4) Exit (stage left).
       52       52
       53       53           Note: There are two counts involved here that shouldn't
       54       54                 be confused:
       55       55
       56       56                 (1) EVALP.CNTE -- the count of the number of
       57       57                     references to a triad within a redefinition
       58       58                     range;
       59       59
       60       60                 (2) ETT.COUNT -- the count of the number of
       61       61                     triads below this triad.  This is used in
       62       62                     ordering the EVALPs for a given sequence
       63       63                     number.
       64       64        */
       65       65
       66       66        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:19   
       67       67        Z8GI$INSERT_EVALP: PROC (OPND) ;

     67 10 000000   000000 700200 xent  Z8GI$INSERT* TSX0  ! X66_AUTO_1
        10 000001   000022 000001                    ZERO    18,1

       68       68
       69       69        %EQU PHASE = 3 ;
       70       70        %EQU Z8GI = 879 ; /* 8 || G=7 || I=9 */
       71       71        %EQU MODULE = Z8GI ;
       72       72        %INCLUDE Z8A_DEFC ;
       73      140        %INCLUDE Z8A_SUPP_MAC ;
       74     2540        %INCLUDE Z8A_COMCOM ;
       75     3190        %INCLUDE Z8A_ILS ;
       76     3299        %INCLUDE Z8A_ILL ;
       77     3992        %INCLUDE Z8A_ETT ;
       78     4293        %INCLUDE Z8G_O3COM ;
       79     4333
       80     4334    1   DCL   OPND       PTR ;       /* The triad in question */
       81     4335    1   DCL   SEQ$       PTR ;       /* Insertion Sequence No */
       82     4336    1   DCL   COUNT      SBIN WORD ; /* # triads below OPND   */
       83     4337    1   DCL   NEXT$      PTR ;       /* Next EVALP in list    */
       84     4338    1   DCL   PREV$      PTR ;       /* Previous EVALP        */
       85     4339    1   DCL   ILL$$      PTR ;       /* Local ILL pointer     */
       86     4340    1   DCL   COMPUTE_SEQ SBIN ;     /* Seq# to link it in at */
       87     4341    1   DCL   PREV_SEQ$   PTR ;
       88     4342    1   DCL   ILS$$       PTR ;                                /*#28761*/
       89     4343    1   DCL   VAL_REC_COUNT SBIN WORD ;
       90     4344    1   DCL   I           SBIN WORD ;
       91     4345    1   DCL   SEQ#        SBIN WORD ;
       92     4346    1   DCL   INCR        SBIN WORD ;
       93     4347
       94     4348        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:20   
       95     4349        /*F*   NAME: Z8GI_Step_1
       96     4350
       97     4351        DESCRIPTION::
       98     4352
       99     4353           STEP (1): Find the ILS item at which the EVALP for the triad
      100     4354           ========  indicated by OPND will be linked in.
      101     4355                     A triad whose compute sequence is 32, will
      102     4356                     be linked in at ILS sequence number 33.
      103     4357        */
      104     4358
      105     4359               /*V* Seq#3 is the seq# of the LINOI after the ENTRY. */
      106     4360
      107     4361    1          COMPUTE_SEQ = MAXIMUM (OPND->ETT.CMP_SC, COMCOM.FIRST_ENTRY_SEQ_NUM) ;

   4361 10 000002   200003 470500                    LDP0    @OPND,,AUTO
        10 000003   000000 471500                    LDP1    0,,PR0
        10 000004   100004 236100                    LDQ     4,,PR1
        10 000005   000022 772000                    QRL     18
        10 000006   000012 604000 10                 TMI     s:4361+8
        10 000007   000440 116000 xsym               CMPQ    COMCOM+288
        10 000010   000012 605000 10                 TPL     s:4361+8
        10 000011   000440 236000 xsym               LDQ     COMCOM+288
        10 000012   200011 756100                    STQ     COMPUTE_SEQ,,AUTO

      108     4362
      109     4363    1          IF COMPUTE_SEQ = COMCOM.FIRST_ENTRY_SEQ_NUM

   4363 10 000013   000440 116000 xsym               CMPQ    COMCOM+288
        10 000014   000020 601000 10                 TNZ     s:4366

      110     4364    1          THEN SEQ$ = O3COM.SEQ#1$ ;

   4364 10 000015   000001 236000 9                  LDQ     O3COM+1
        10 000016   200004 756100                    STQ     SEQ$,,AUTO
        10 000017   000105 710000 10                 TRA     STEP_1_5

      111     4365    2          ELSE DO ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:21   

      112     4366    2            IF  COMPUTE_SEQ < O3COM.SL.SEQ# (O3COM.SL_INDEX)

   4366 10 000020   000013 235000 9                  LDA     O3COM+11
        10 000021   000001 735000                    ALS     1
        10 000022   000014 116005 9                  CMPQ    O3COM+12,AL
        10 000023   000052 605000 10                 TPL     s:4377
        10 000024   000000 236000 9                  LDQ     O3COM
        10 000025   000014 116005 9                  CMPQ    O3COM+12,AL
        10 000026   000052 604400 10                 TMOZ    s:4377

      113     4367    2            AND O3COM.CURRENT_SEQ_NO > O3COM.SL.SEQ# (O3COM.SL_INDEX)
      114     4368    3            THEN DO ;

      115     4369    4              DO I = O3COM.SL_INDEX TO 14 ;

   4369 10 000027   000013 235000 9                  LDA     O3COM+11
        10 000030   200015 755100                    STA     I,,AUTO
        10 000031   000040 710000 10                 TRA     s:4372+1

      116     4370    4                IF COMPUTE_SEQ >= O3COM.SL.SEQ# (I+1)

   4370 10 000032   200015 235100                    LDA     I,,AUTO
        10 000033   000001 735000                    ALS     1
        10 000034   200011 236100                    LDQ     COMPUTE_SEQ,,AUTO
        10 000035   000016 116005 9                  CMPQ    O3COM+14,AL
        10 000036   000045 605000 10                 TPL     EXIT_LOOP

      117     4371    4                THEN GOTO EXIT_LOOP ;
      118     4372    4              END ;

   4372 10 000037   200015 054100                    AOS     I,,AUTO
        10 000040   200015 235100                    LDA     I,,AUTO
        10 000041   000016 115007                    CMPA    14,DL
        10 000042   000032 604400 10                 TMOZ    s:4370

      119     4373    3              I = 15 ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:22   

   4373 10 000043   000017 236007                    LDQ     15,DL
        10 000044   200015 756100                    STQ     I,,AUTO

   4373 10 000045                       EXIT_LOOP    null
      120     4374    3   EXIT_LOOP: ;
      121     4375    3              SEQ$ = O3COM.SL.SEQ$ (I) ;

   4375 10 000045   200015 235100                    LDA     I,,AUTO
        10 000046   000001 735000                    ALS     1
        10 000047   000015 236005 9                  LDQ     O3COM+13,AL
        10 000050   200004 756100                    STQ     SEQ$,,AUTO

      122     4376    3            END ;

   4376 10 000051   000054 710000 10                 TRA     s:4378

      123     4377    2            ELSE SEQ$ = ILS$ ;

   4377 10 000052   000000 236000 1                  LDQ     ILS$
        10 000053   200004 756100                    STQ     SEQ$,,AUTO

      124     4378    2            PREV_SEQ$ = SEQ$ ;

   4378 10 000054   200012 756100                    STQ     PREV_SEQ$,,AUTO

      125     4379    3            DO WHILE (SEQ$ ~= ADDR (NIL) AND

   4379 10 000055   000074 710000 10                 TRA     s:4389

      126     4380    3                 SEQ$->ILS.SEQNO > COMPUTE_SEQ) ;
      127     4381    3              PREV_SEQ$ = SEQ$ ;

   4381 10 000056   200004 236100                    LDQ     SEQ$,,AUTO
        10 000057   200012 756100                    STQ     PREV_SEQ$,,AUTO

      128     4382    3              SEQ$ = SEQ$ -> ILS.NEXT ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:23   

   4382 10 000060   200004 470500                    LDP0    SEQ$,,AUTO
        10 000061   000002 236100                    LDQ     2,,PR0
        10 000062   200004 756100                    STQ     SEQ$,,AUTO

      129     4383
      130     4384                   /* Skip over preset ILL items (seq_no = 0) */
      131     4385    4              DO WHILE (SEQ$ ~= ADDR(NIL) AND SEQ$ -> ILS.SEQNO = 0) ;

   4385 10 000063   000067 710000 10                 TRA     s:4387

      132     4386    4                SEQ$ = SEQ$ -> ILS.NEXT ;

   4386 10 000064   200004 470500                    LDP0    SEQ$,,AUTO
        10 000065   000002 236100                    LDQ     2,,PR0
        10 000066   200004 756100                    STQ     SEQ$,,AUTO

      133     4387    3              END ; /* ILS.ILL -> ID = PRESET, PREOFF, PTR_SET, ... */;

   4387 10 000067   000000 116000 11                 CMPQ    0
        10 000070   000074 600000 10                 TZE     s:4389
        10 000071   200004 470500                    LDP0    SEQ$,,AUTO
        10 000072   000000 720100                    LXL0    0,,PR0
        10 000073   000064 600000 10                 TZE     s:4386

      134     4388
      135     4389    3            END ;

   4389 10 000074   000000 116000 11                 CMPQ    0
        10 000075   000103 600000 10                 TZE     s:4391
        10 000076   200004 470500                    LDP0    SEQ$,,AUTO
        10 000077   000000 236100                    LDQ     0,,PR0
        10 000100   777777 376007                    ANQ     -1,DL
        10 000101   200011 116100                    CMPQ    COMPUTE_SEQ,,AUTO
        10 000102   000056 605400 10                 TPNZ    s:4381

      136     4390
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:24   
      137     4391    2            SEQ$ = PREV_SEQ$ ;

   4391 10 000103   200012 236100                    LDQ     PREV_SEQ$,,AUTO
        10 000104   200004 756100                    STQ     SEQ$,,AUTO

      138     4392
      139     4393    2          END /* Else Do */ ;

   4386 10 000105                       STEP_1_5     null
      140     4394                                                               /*#28761*/
      141     4395    1   STEP_1_5: ;
      142     4396
      143     4397        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:25   
      144     4398        /*F*   NAME: Z8GI_Step_1.5
      145     4399
      146     4400        DESCRIPTION::
      147     4401
      148     4402          STEP(1.5): Check to see if this EVALP will be in the midst of a
      149     4403                     VAL/VAL_END pair.  If so, move it out to the VAL_END.
      150     4404        */
      151     4405
      152     4406    1          IF  COMCOM.MAX_RECEIVING_ITEMS > 1

   4406 10 000105   000360 235000 xsym               LDA     COMCOM+240
        10 000106   000001 115007                    CMPA    1,DL
        10 000107   000235 604400 10                 TMOZ    STEP_2
        10 000110   200011 236100                    LDQ     COMPUTE_SEQ,,AUTO
        10 000111   000440 116000 xsym               CMPQ    COMCOM+288
        10 000112   000235 604400 10                 TMOZ    STEP_2

      153     4407    2          AND COMPUTE_SEQ > COMCOM.FIRST_ENTRY_SEQ_NUM THEN DO ;

      154     4408
      155     4409    2            ILS$$ = SEQ$ ;

   4409 10 000113   200004 236100                    LDQ     SEQ$,,AUTO
        10 000114   200013 756100                    STQ     ILS$$,,AUTO

      156     4410
      157     4411    3    LOOP:   DO VAL_REC_COUNT = 1 TO COMCOM.MAX_RECEIVING_ITEMS + 1 ;

   4411 10 000115   000001 235007       LOOP         LDA     1,DL
        10 000116   200014 755100                    STA     VAL_REC_COUNT,,AUTO
        10 000117   000231 710000 10                 TRA     s:4456+1

   4411 10 000120                       ONE_MORE_TI* null
      158     4412
      159     4413    3     ONE_MORE_TIME: ;
      160     4414
      161     4415    3              ILL$$ = ILS$$ -> ILS.ILL$ ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:26   

   4415 10 000120   200013 470500                    LDP0    ILS$$,,AUTO
        10 000121   000003 236100                    LDQ     3,,PR0
        10 000122   200010 756100                    STQ     ILL$$,,AUTO

   4415 10 000123                       AGAIN        null
      162     4416
      163     4417    3     AGAIN: ;
      164     4418
      165     4419    4              DO CASE (ILL$$ -> ILL.ID) ;

   4419 10 000123   200010 470500                    LDP0    ILL$$,,AUTO
        10 000124   000000 236100                    LDQ     0,,PR0
        10 000125   000022 772000                    QRL     18
        10 000126   000341 136007                    SBLQ    225,DL
        10 000127   000033 116007                    CMPQ    27,DL
        10 000130   000132 602006 10                 TNC     AGAIN+7,QL
        10 000131   000223 710000 10                 TRA     s:4453
        10 000132   000173 710000 10                 TRA     s:4429
        10 000133   000223 710000 10                 TRA     s:4453
        10 000134   000223 710000 10                 TRA     s:4453
        10 000135   000223 710000 10                 TRA     s:4453
        10 000136   000223 710000 10                 TRA     s:4453
        10 000137   000223 710000 10                 TRA     s:4453
        10 000140   000223 710000 10                 TRA     s:4453
        10 000141   000223 710000 10                 TRA     s:4453
        10 000142   000223 710000 10                 TRA     s:4453
        10 000143   000223 710000 10                 TRA     s:4453
        10 000144   000223 710000 10                 TRA     s:4453
        10 000145   000223 710000 10                 TRA     s:4453
        10 000146   000223 710000 10                 TRA     s:4453
        10 000147   000223 710000 10                 TRA     s:4453
        10 000150   000223 710000 10                 TRA     s:4453
        10 000151   000223 710000 10                 TRA     s:4453
        10 000152   000223 710000 10                 TRA     s:4453
        10 000153   000223 710000 10                 TRA     s:4453
        10 000154   000223 710000 10                 TRA     s:4453
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:27   
        10 000155   000223 710000 10                 TRA     s:4453
        10 000156   000223 710000 10                 TRA     s:4453
        10 000157   000223 710000 10                 TRA     s:4453
        10 000160   000207 710000 10                 TRA     s:4441
        10 000161   000206 710000 10                 TRA     s:4437
        10 000162   000223 710000 10                 TRA     s:4453
        10 000163   000223 710000 10                 TRA     s:4453
        10 000164   000165 710000 10                 TRA     s:4423

      166     4420
      167     4421    4                CASE (%LINOI) ;

      168     4422
      169     4423    4                  ILS$$ = ILS$$ -> ILS.NEXT ;

   4423 10 000165   200013 471500                    LDP1    ILS$$,,AUTO
        10 000166   100002 236100                    LDQ     2,,PR1
        10 000167   200013 756100                    STQ     ILS$$,,AUTO

      170     4424    4                  IF ILS$$ = ADDR(NIL) THEN EXIT LOOP ;

   4424 10 000170   000000 116000 11                 CMPQ    0
        10 000171   000235 600000 10                 TZE     STEP_2

      171     4425    4                  GOTO ONE_MORE_TIME ; /* Don't incr Val_Rec_Count */

   4425 10 000172   000120 710000 10                 TRA     ONE_MORE_TIME

      172     4426
      173     4427    4                CASE (%EVALP) ;

      174     4428
      175     4429    5                  DO WHILE (ILL$$ -> ILL.ID = %EVALP) ;

   4429 10 000173   000000 220100                    LDX0    0,,PR0
        10 000174   000341 100003                    CMPX0   225,DU
        10 000175   000205 601000 10                 TNZ     s:4433
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:28   

      176     4430    5                    ILL$$ = ILL$$ -> CCOSU.ILL$ ;

   4430 10 000176   200010 470500                    LDP0    ILL$$,,AUTO
        10 000177   000003 236100                    LDQ     3,,PR0
        10 000200   200010 756100                    STQ     ILL$$,,AUTO

      177     4431    5                  END ;

   4431 10 000201   200010 470500                    LDP0    ILL$$,,AUTO
        10 000202   000000 220100                    LDX0    0,,PR0
        10 000203   000341 100003                    CMPX0   225,DU
        10 000204   000176 600000 10                 TZE     s:4430

      178     4432
      179     4433    4                  GOTO AGAIN ;

   4433 10 000205   000123 710000 10                 TRA     AGAIN

      180     4434
      181     4435    4                CASE (%VAL_END) ;

      182     4436
      183     4437    4                  EXIT LOOP ;

   4437 10 000206   000235 710000 10                 TRA     STEP_2

      184     4438
      185     4439    4                CASE (%VAL) ;

      186     4440
      187     4441    4                  IF VAL_REC_COUNT = 1 THEN

   4441 10 000207   200014 235100                    LDA     VAL_REC_COUNT,,AUTO
        10 000210   000001 115007                    CMPA    1,DL
        10 000211   000235 600000 10                 TZE     STEP_2

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:29   
      188     4442    4                    EXIT LOOP ;
      189     4443    5                  ELSE DO ;

      190     4444    5                    IF O3COM.CURRENT_SEQ_NO >

   4444 10 000212   000002 471500                    LDP1    2,,PR0
        10 000213   100000 236100                    LDQ     0,,PR1
        10 000214   777777 376007                    ANQ     -1,DL
        10 000215   000000 116000 9                  CMPQ    O3COM
        10 000216   000222 605000 10                 TPL     s:4448

      191     4445    5                       ILL$$ -> VAL.VAL_END$ -> ILS.SEQNO THEN
      192     4446    5                       SEQ$ = ILL$$ -> VAL.VAL_END$ -> ILS.ILL$ ->

   4446 10 000217   100003 473500                    LDP3    3,,PR1
        10 000220   300002 236100                    LDQ     2,,PR3
        10 000221   200004 756100                    STQ     SEQ$,,AUTO

      193     4447    5                                       VAL_END.LINOI$ ;
      194     4448    5                    EXIT LOOP ;

   4448 10 000222   000235 710000 10                 TRA     STEP_2

      195     4449    5                  END ;
      196     4450
      197     4451    4              END ; /* Case of ILL ID */

      198     4452
      199     4453    3            ILS$$ = ILS$$ -> ILS.NEXT ;

   4453 10 000223   200013 471500                    LDP1    ILS$$,,AUTO
        10 000224   100002 236100                    LDQ     2,,PR1
        10 000225   200013 756100                    STQ     ILS$$,,AUTO

      200     4454    3            IF ILS$$ = ADDR(NIL) THEN EXIT ;

   4454 10 000226   000000 116000 11                 CMPQ    0
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:30   
        10 000227   000235 600000 10                 TZE     STEP_2

      201     4455
      202     4456    3            END ; /* Do LOOP */

   4456 10 000230   200014 054100                    AOS     VAL_REC_COUNT,,AUTO
        10 000231   000360 236000 xsym               LDQ     COMCOM+240
        10 000232   000001 036007                    ADLQ    1,DL
        10 000233   200014 116100                    CMPQ    VAL_REC_COUNT,,AUTO
        10 000234   000120 605000 10                 TPL     ONE_MORE_TIME

      203     4457
      204     4458    2          END ; /* COMCOM.MAX_RECEIVING_ITEMS > 1 */

   4446 10 000235                       STEP_2       null
      205     4459
      206     4460    1   STEP_2: ; /* Use this label for DELTA AT commands */
      207     4461
      208     4462        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:31   
      209     4463        /*F*   NAME: Z8GI_Step_2
      210     4464
      211     4465        DESCRIPTION::
      212     4466
      213     4467           STEP (2): SEQ$ points to the ILS item whose sequence
      214     4468           ========  number is one greater than our triad's
      215     4469                     sequence number.  Now we need to search
      216     4470                     thru the EVALPs (starting at SEQ$->ILS.ILL$)
      217     4471                     to see if our triad already has an EVALP.
      218     4472                     If the EVALP is found, then update its
      219     4473                     CNTE (#references) and LSEQ (low seq no.).
      220     4474                     Note: The EVALPs are linked by descending
      221     4475                     ETT.COUNTs.
      222     4476        */
      223     4477    2          IF SEQ$ = ILS$ THEN DO ;

   4477 10 000235   200004 236100                    LDQ     SEQ$,,AUTO
        10 000236   000000 116000 1                  CMPQ    ILS$
        10 000237   000276 601000 10                 TNZ     s:4493

      224     4478    3            IF O3COM.EVALP$ = ADDR(NIL) THEN DO ;

   4478 10 000240   000002 236000 9                  LDQ     O3COM+2
        10 000241   000000 116000 11                 CMPQ    0
        10 000242   000274 601000 10                 TNZ     s:4491

      225     4479    3              SEQ$ = ILS$ -> ILS.NEXT ;

   4479 10 000243   000000 470400 1                  LDP0    ILS$
        10 000244   000002 236100                    LDQ     2,,PR0
        10 000245   200004 756100                    STQ     SEQ$,,AUTO

      226     4480    4              DO WHILE (SEQ$ ~= ADDR(NIL)) ;

   4480 10 000246   000263 710000 10                 TRA     s:4486

      227     4481    4                IF SEQ$->ILS.ILL$ ~= ADDR (NIL) THEN
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:32   

   4481 10 000247   200004 470500                    LDP0    SEQ$,,AUTO
        10 000250   000003 236100                    LDQ     3,,PR0
        10 000251   000000 116000 11                 CMPQ    0
        10 000252   000261 600000 10                 TZE     s:4485

      228     4482    4                  IF SEQ$->ILS.ILL$->ILL.ID = %LINOI

   4482 10 000253   000003 471500                    LDP1    3,,PR0
        10 000254   100000 220100                    LDX0    0,,PR1
        10 000255   000373 100003                    CMPX0   251,DU
        10 000256   000265 600000 10                 TZE     s:4487
        10 000257   000341 100003                    CMPX0   225,DU
        10 000260   000265 600000 10                 TZE     s:4487

      229     4483    4                  OR SEQ$->ILS.ILL$->ILL.ID = %EVALP THEN
      230     4484    4                    EXIT ;
      231     4485    4                SEQ$ = SEQ$ -> ILS.NEXT ;

   4485 10 000261   000002 236100                    LDQ     2,,PR0
        10 000262   200004 756100                    STQ     SEQ$,,AUTO

      232     4486    4              END ; /* DO WHILE */

   4486 10 000263   000000 116000 11                 CMPQ    0
        10 000264   000247 601000 10                 TNZ     s:4481

      233     4487    3              IF SEQ$ = ADDR(NIL)

   4487 10 000265   200004 236100                    LDQ     SEQ$,,AUTO
        10 000266   000000 116000 11                 CMPQ    0
        10 000267   000472 600000 10                 TZE     STEP_4

      234     4488    3              THEN GOTO STEP_4 ;
      235     4489    3              ELSE ILL$$ = SEQ$ -> ILS.ILL$ ;

   4489 10 000270   200004 470500                    LDP0    SEQ$,,AUTO
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:33   
        10 000271   000003 236100                    LDQ     3,,PR0
        10 000272   200010 756100                    STQ     ILL$$,,AUTO

      236     4490    3            END ; /* O3COM.EVALP$ = ADDR(NIL) */

   4490 10 000273   000301 710000 10                 TRA     s:4494

      237     4491    2            ELSE ILL$$ = O3COM.EVALP$ ;

   4491 10 000274   200010 756100                    STQ     ILL$$,,AUTO

      238     4492    2          END ; /* SEQ$ = ILS$ */

   4492 10 000275   000301 710000 10                 TRA     s:4494

      239     4493    1          ELSE ILL$$ = SEQ$ -> ILS.ILL$ ;

   4493 10 000276   200004 470500                    LDP0    SEQ$,,AUTO
        10 000277   000003 236100                    LDQ     3,,PR0
        10 000300   200010 756100                    STQ     ILL$$,,AUTO

      240     4494    1          COUNT = OPND -> ETT.COUNT ;

   4494 10 000301   200003 470500                    LDP0    @OPND,,AUTO
        10 000302   000000 471500                    LDP1    0,,PR0
        10 000303   100000 236100                    LDQ     0,,PR1
        10 000304   777777 376007                    ANQ     -1,DL
        10 000305   200005 756100                    STQ     COUNT,,AUTO

      241     4495    1          PREV$ = ADDR(NIL) ;

   4495 10 000306   000000 236000 11                 LDQ     0
        10 000307   200007 756100                    STQ     PREV$,,AUTO

      242     4496
      243     4497    2          DO WHILE (ILL$$->ILL.ID = %EVALP

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:34   
   4497 10 000310   000356 710000 10                 TRA     s:4524

      244     4498    2                 OR ILL$$->ILL.ID = %CCOSU
      245     4499    2                 OR ILL$$->ILL.ID = %INITV
      246     4500    2                 OR ILL$$->ILL.ID = %INCRV) ;
      247     4501
      248     4502    2            IF ILL$$->ILL.ID = %EVALP

   4502 10 000311   200010 470500                    LDP0    ILL$$,,AUTO
        10 000312   000000 220100                    LDX0    0,,PR0
        10 000313   000341 100003                    CMPX0   225,DU
        10 000314   000317 600000 10                 TZE     s:4505
        10 000315   000342 100003                    CMPX0   226,DU
        10 000316   000352 601000 10                 TNZ     s:4521

      249     4503    3            OR ILL$$->ILL.ID = %CCOSU THEN DO ;

      250     4504
      251     4505    4              IF ILL$$->CCOSU.EVEX->ETT.COUNT = COUNT THEN DO ;

   4505 10 000317   000004 471500                    LDP1    4,,PR0
        10 000320   100000 236100                    LDQ     0,,PR1
        10 000321   777777 376007                    ANQ     -1,DL
        10 000322   200005 116100                    CMPQ    COUNT,,AUTO
        10 000323   000351 601000 10                 TNZ     s:4516

      252     4506    5                IF ILL$$->CCOSU.EVEX = OPND THEN DO ;

   4506 10 000324   200003 473500                    LDP3    @OPND,,AUTO
        10 000325   000004 236100                    LDQ     4,,PR0
        10 000326   300000 116100                    CMPQ    0,,PR3
        10 000327   000352 601000 10                 TNZ     s:4521

      253     4507    5                  OPND->ETT.EVALP$ = ILL$$ ; /* See Note (1) below */

   4507 10 000330   300000 474500                    LDP4    0,,PR3
        10 000331   200010 236100                    LDQ     ILL$$,,AUTO
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:35   
        10 000332   400003 756100                    STQ     3,,PR4

      254     4508    5                  ILL$$->CCOSU.CNTE = ILL$$->CCOSU.CNTE + 1 ;

   4508 10 000333   000000 720100                    LXL0    0,,PR0
        10 000334   000001 621010                    EAX1    1,X0
        10 000335   000000 441100                    SXL1    0,,PR0

      255     4509    5                  ILL$$->CCOSU.LSEQ = O3COM.CURRENT_SEQ_NO ;

   4509 10 000336   000000 720000 9                  LXL0    O3COM
        10 000337   000005 740100                    STX0    5,,PR0

      256     4510    5                  ILL$$->CCOSU.LEVEL = MAXIMUM (ILL$$->CCOSU.LEVEL,

   4510 10 000340   000001 236100                    LDQ     1,,PR0
        10 000341   000022 732000                    QRS     18
        10 000342   000345 604000 10                 TMI     s:4510+5
        10 000343   000011 116000 9                  CMPQ    O3COM+9
        10 000344   000346 603000 10                 TRC     s:4510+6
        10 000345   000011 236000 9                  LDQ     O3COM+9
        10 000346   000000 622006                    EAX2    0,QL
        10 000347   000001 742100                    STX2    1,,PR0

      257     4511    5                                               O3COM.LOOP_LEVEL) ;
      258     4512    5                  GOTO STEP_4 ;

   4512 10 000350   000472 710000 10                 TRA     STEP_4

      259     4513    5                END /* If Then Do */ ;
      260     4514    4              END /* If Then Do */ ;
      261     4515    3              ELSE /* The counts are not equal */
      262     4516    3              IF ILL$$->CCOSU.EVEX->ETT.COUNT < COUNT

   4516 10 000351   000370 604000 10                 TMI     STEP_3

      263     4517    3              THEN GOTO STEP_3 ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:36   
      264     4518
      265     4519    3            END /* If ID = EVALP */ ;

      266     4520
      267     4521    2            PREV$ = ILL$$ ;

   4521 10 000352   200010 236100                    LDQ     ILL$$,,AUTO
        10 000353   200007 756100                    STQ     PREV$,,AUTO

      268     4522    2            ILL$$ = ILL$$ -> CCOSU.ILL$ ;

   4522 10 000354   000003 236100                    LDQ     3,,PR0
        10 000355   200010 756100                    STQ     ILL$$,,AUTO

      269     4523
      270     4524    2          END /* Do While ILL.ID = %EVALP */ ;

   4524 10 000356   200010 470500                    LDP0    ILL$$,,AUTO
        10 000357   000000 220100                    LDX0    0,,PR0
        10 000360   000341 100003                    CMPX0   225,DU
        10 000361   000311 600000 10                 TZE     s:4502
        10 000362   000342 100003                    CMPX0   226,DU
        10 000363   000311 600000 10                 TZE     s:4502
        10 000364   000347 100003                    CMPX0   231,DU
        10 000365   000311 600000 10                 TZE     s:4502
        10 000366   000350 100003                    CMPX0   232,DU
        10 000367   000311 600000 10                 TZE     s:4502

   4519 10 000370                       STEP_3       null
      271     4525
      272     4526        /* Note (1): EVALP$ must be reset since Z8GS may have reset this
      273     4527                     field to nil in the case of two GO items in a row
      274     4528                     that use the same triad which contains redefined
      275     4529                     variables (CMP_SC = current seq#). (test case =
      276     4530                     PF0041B).
      277     4531        */
      278     4532
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:37   
      279     4533    1   STEP_3: ;
      280     4534
      281     4535        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:38   
      282     4536        /*F*   NAME: Z8GI_Step_3
      283     4537
      284     4538        DESCRIPTION::
      285     4539
      286     4540           STEP (3): An EVALP for our triad doesn't yet exist,
      287     4541           ========  so we shall create one.  We stopped the
      288     4542                     DO WHILE in STEP(2) at the point (in the
      289     4543                     EVALP linked list) where we want to insert
      290     4544                     the EVALP we are now creating (between
      291     4545                     PREV$ and ILL$$).
      292     4546        */
      293     4547    1          NEXT$ = ILL$$ ;

   4547 10 000370   200010 236100                    LDQ     ILL$$,,AUTO
        10 000371   200006 756100                    STQ     NEXT$,,AUTO

      294     4548                           /* Get an EVALP item from the pool if one is
      295     4549                              available, otherwise reserve a new one.
      296     4550                           */
      297     4551    1          IF O3COM.HEAD_EVALP$ = ADDR(NIL) THEN

   4551 10 000372   000066 236000 9                  LDQ     O3COM+54
        10 000373   000000 116000 11                 CMPQ    0
        10 000374   000426 601000 10                 TNZ     s:4571

      298     4552                 %RESERVE_ILL(ITEM=%EVALP,
      299     4553                              POINTER=ILL$$);

   4555 10 000375   000113 235000 xsym               LDA     ILL_STEP+75
        10 000376   000000 755000 0                  STA     ITERATION

   4556 10 000377   000002 236000 4                  LDQ     ILL_+2
        10 000400   000000 036000 0                  ADLQ    ITERATION
        10 000401   000003 116000 4                  CMPQ    ILL_+3
        10 000402   000413 604000 10                 TMI     s:4558

   4557 10 000403   000002 236000 11                 LDQ     2
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:39   
        10 000404   200020 756100                    STQ     INCR+1,,AUTO
        10 000405   200020 631500                    EPPR1   INCR+1,,AUTO
        10 000406   200021 451500                    STP1    INCR+2,,AUTO
        10 000407   200021 630500                    EPPR0   INCR+2,,AUTO
        10 000410   000001 631400 11                 EPPR1   1
        10 000411   000000 701000 xent               TSX1    Z8AR$RESERVER
        10 000412   000000 011000                    NOP     0

   4558 10 000413   000002 236000 4                  LDQ     ILL_+2
        10 000414   000022 736000                    QLS     18
        10 000415   000001 036000 4                  ADLQ    ILL_+1
        10 000416   200010 756100                    STQ     ILL$$,,AUTO

   4559 10 000417   000002 236000 4                  LDQ     ILL_+2
        10 000420   000000 036000 0                  ADLQ    ITERATION
        10 000421   000002 756000 4                  STQ     ILL_+2

   4560 10 000422   000341 220003                    LDX0    225,DU
        10 000423   200010 470500                    LDP0    ILL$$,,AUTO
        10 000424   000000 740100                    STX0    0,,PR0

   4561 10 000425   000440 710000 10                 TRA     s:4586

      300     4563    1          ELSE
      301     4564    2            DO;

      302     4565                   %REMOVE_FROM_SL_LIST(PTR=ILL$$,
      303     4566                                        ITEM=CCOSU,
      304     4567                                        HEAD=O3COM.HEAD_EVALP$,
      305     4568                                        NEXT=NEXT$);

   4571 10 000426   200010 756100                    STQ     ILL$$,,AUTO

   4572 10 000427   000066 470400 9                  LDP0    O3COM+54
        10 000430   000003 236100                    LDQ     3,,PR0
        10 000431   000066 756000 9                  STQ     O3COM+54

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:40   
      306     4581    2              ILL$$ -> CCOSU = '0'O;

   4581 10 000432   200010 470500                    LDP0    ILL$$,,AUTO
        10 000433   000100 100400                    MLR     fill='000'O
        10 000434   000003 000001 11                 ADSC9   3                        cn=0,n=1
        10 000435   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24

      307     4582    2              ILL$$ -> CCOSU.ID = %EVALP;

   4582 10 000436   000341 220003                    LDX0    225,DU
        10 000437   000000 740100                    STX0    0,,PR0

      308     4583    2            END;

      309     4584
      310     4585
      311     4586    1          ILL$$->CCOSU.CNTE = 1 ;

   4586 10 000440   000001 221003                    LDX1    1,DU
        10 000441   000000 441100                    SXL1    0,,PR0

      312     4587    1          ILL$$->CCOSU.EVEX = OPND ;

   4587 10 000442   200003 471500                    LDP1    @OPND,,AUTO
        10 000443   100000 236100                    LDQ     0,,PR1
        10 000444   000004 756100                    STQ     4,,PR0

      313     4588    1          ILL$$->CCOSU.HSEQ = O3COM.CURRENT_SEQ_NO ;

   4588 10 000445   000000 722000 9                  LXL2    O3COM
        10 000446   000001 442100                    SXL2    1,,PR0

      314     4589    1          ILL$$->CCOSU.LEVEL = O3COM.LOOP_LEVEL ;

   4589 10 000447   000011 723000 9                  LXL3    O3COM+9
        10 000450   000001 743100                    STX3    1,,PR0

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:41   
      315     4590    1          OPND->ETT.EVALP$ = ILL$$ ;

   4590 10 000451   100000 473500                    LDP3    0,,PR1
        10 000452   200010 236100                    LDQ     ILL$$,,AUTO
        10 000453   300003 756100                    STQ     3,,PR3

      316     4591
      317     4592    2          IF PREV$ = ADDR(NIL) THEN DO ;

   4592 10 000454   200007 236100                    LDQ     PREV$,,AUTO
        10 000455   000000 116000 11                 CMPQ    0
        10 000456   000465 601000 10                 TNZ     s:4598

      318     4593                 /* This will be the first EVALP in the chain */
      319     4594    2            ILL$$->CCOSU.ILL$ = NEXT$ ;

   4594 10 000457   200006 236100                    LDQ     NEXT$,,AUTO
        10 000460   000003 756100                    STQ     3,,PR0

      320     4595    2            SEQ$->ILS.ILL$ = ILL$$ ;

   4595 10 000461   200010 236100                    LDQ     ILL$$,,AUTO
        10 000462   200004 473500                    LDP3    SEQ$,,AUTO
        10 000463   300003 756100                    STQ     3,,PR3

      321     4596    2          END ;

   4596 10 000464   000472 710000 10                 TRA     STEP_4

      322     4597    2          ELSE DO ; /* This is not the first in the chain */

      323     4598    2            PREV$->CCOSU.ILL$ = ILL$$ ;

   4598 10 000465   200010 236100                    LDQ     ILL$$,,AUTO
        10 000466   200007 473500                    LDP3    PREV$,,AUTO
        10 000467   300003 756100                    STQ     3,,PR3

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:42   
      324     4599    2            ILL$$->CCOSU.ILL$ = NEXT$ ;

   4599 10 000470   200006 236100                    LDQ     NEXT$,,AUTO
        10 000471   000003 756100                    STQ     3,,PR0

      325     4600    2          END ;

   4592 10 000472                       STEP_4       null
      326     4601
      327     4602    1   STEP_4: ; /* Exit */
      328     4603
      329     4604    1          RETURN ;

   4604 10 000472   000000 702200 xent               TSX2  ! X66_ARET

      330     4605
      331     4606        %EJECT;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:43   
      332     4607    1   Z8GI$MAKE_SEQ_LIST: ENTRY ;

   4607 10 000473   000000 700200 xent  Z8GI$MAKE_S* TSX0  ! X66_AUTO_1
        10 000474   000022 000001                    ZERO    18,1

      333     4608
      334     4609        /*F*       NAME: Z8GI$MAKE_SEQ_LIST
      335     4610
      336     4611            DESCRIPTION: For large programs, the linked search back
      337     4612                         thru the ILS to insert an EVALP is time
      338     4613                         consuming.  This routine sets up a short
      339     4614                         cut for use by the ILS linker by creating a
      340     4615                         16-element array splitting the ILS into 16 pieces.
      341     4616        */
      342     4617
      343     4618    1          I = 0 ; /* O3COM.SL index */

   4618 10 000475   200015 450100                    STZ     I,,AUTO

      344     4619    1          SEQ# = O3COM.MAX_SEQ# ;

   4619 10 000476   000054 235000 9                  LDA     O3COM+44
        10 000477   200016 755100                    STA     SEQ#,,AUTO

      345     4620    1          SEQ$ = COMCOM.FIRST_ILS ;

   4620 10 000500   000010 236000 xsym               LDQ     COMCOM+8
        10 000501   200004 756100                    STQ     SEQ$,,AUTO

      346     4621    1          INCR = (SEQ# - COMCOM.FIRST_ENTRY_SEQ_NUM) / 16 ;

   4621 10 000502   200016 236100                    LDQ     SEQ#,,AUTO
        10 000503   000440 136000 xsym               SBLQ    COMCOM+288
        10 000504   000020 506007                    DIV     16,DL
        10 000505   200017 756100                    STQ     INCR,,AUTO

      347     4622    1          SEQ# = SEQ# - INCR ;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:44   

   4622 10 000506   200016 236100                    LDQ     SEQ#,,AUTO
        10 000507   200017 136100                    SBLQ    INCR,,AUTO
        10 000510   200016 756100                    STQ     SEQ#,,AUTO

      348     4623
      349     4624    2          DO WHILE (SEQ$ ~= ADDR(NIL) AND

   4624 10 000511   000546 710000 10                 TRA     s:4641

      350     4625    2               SEQ$->ILS.SEQNO > COMCOM.FIRST_ENTRY_SEQ_NUM) ;
      351     4626
      352     4627    2            IF  SEQ$->ILS.SEQNO = SEQ#

   4627 10 000512   200004 470500                    LDP0    SEQ$,,AUTO
        10 000513   000000 236100                    LDQ     0,,PR0
        10 000514   777777 376007                    ANQ     -1,DL
        10 000515   200016 116100                    CMPQ    SEQ#,,AUTO
        10 000516   000533 601000 10                 TNZ     s:4634
        10 000517   200015 235100                    LDA     I,,AUTO
        10 000520   000016 115007                    CMPA    14,DL
        10 000521   000533 605400 10                 TPNZ    s:4634

      353     4628    3            AND I <= 14 THEN DO ;

      354     4629    3              O3COM.SL.SEQ# (I) = SEQ# ;

   4629 10 000522   000001 735000                    ALS     1
        10 000523   200016 236100                    LDQ     SEQ#,,AUTO
        10 000524   000014 756005 9                  STQ     O3COM+12,AL

      355     4630    3              O3COM.SL.SEQ$ (I) = SEQ$ ;

   4630 10 000525   200004 236100                    LDQ     SEQ$,,AUTO
        10 000526   000015 756005 9                  STQ     O3COM+13,AL

      356     4631    3              I = I + 1;
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:45   

   4631 10 000527   200015 054100                    AOS     I,,AUTO

      357     4632    3              SEQ# = SEQ# - INCR ;

   4632 10 000530   200016 236100                    LDQ     SEQ#,,AUTO
        10 000531   200017 136100                    SBLQ    INCR,,AUTO
        10 000532   200016 756100                    STQ     SEQ#,,AUTO

      358     4633    3            END ;

      359     4634    2            SEQ$ = SEQ$ -> ILS.NEXT ;

   4634 10 000533   000002 236100                    LDQ     2,,PR0
        10 000534   200004 756100                    STQ     SEQ$,,AUTO

      360     4635
      361     4636                 /* Skip over preset ILL items (seq_no = 0) */
      362     4637    3            DO WHILE (SEQ$ ~= ADDR(NIL) AND SEQ$ -> ILS.SEQNO = 0) ;

   4637 10 000535   000541 710000 10                 TRA     s:4639

      363     4638    3              SEQ$ = SEQ$ -> ILS.NEXT ;

   4638 10 000536   200004 470500                    LDP0    SEQ$,,AUTO
        10 000537   000002 236100                    LDQ     2,,PR0
        10 000540   200004 756100                    STQ     SEQ$,,AUTO

      364     4639    3            END ; /* ILS.ILL -> ID = PRESET, PREOFF, PTR_SET, ... */

   4639 10 000541   000000 116000 11                 CMPQ    0
        10 000542   000546 600000 10                 TZE     s:4641
        10 000543   200004 470500                    LDP0    SEQ$,,AUTO
        10 000544   000000 720100                    LXL0    0,,PR0
        10 000545   000536 600000 10                 TZE     s:4638

      365     4640
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:46   
      366     4641    2          END ;

   4641 10 000546   200004 236100                    LDQ     SEQ$,,AUTO
        10 000547   000000 116000 11                 CMPQ    0
        10 000550   000556 600000 10                 TZE     s:4643
        10 000551   200004 470500                    LDP0    SEQ$,,AUTO
        10 000552   000000 236100                    LDQ     0,,PR0
        10 000553   777777 376007                    ANQ     -1,DL
        10 000554   000440 116000 xsym               CMPQ    COMCOM+288
        10 000555   000512 605400 10                 TPNZ    s:4627

      367     4642
      368     4643    1          O3COM.SEQ#1$ = SEQ$ ;

   4643 10 000556   200004 236100                    LDQ     SEQ$,,AUTO
        10 000557   000001 756000 9                  STQ     O3COM+1

      369     4644    1          O3COM.SL_INDEX = 0 ;

   4644 10 000560   000013 450000 9                  STZ     O3COM+11

      370     4645
      371     4646    1   END Z8GI$INSERT_EVALP ;

   4646 10 000561   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:47   
--  Include file information  --

   Z8G_O3COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8GI$INSERT_EVALP.
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:48   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 002 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 003 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 004 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILL_

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:49   
  ****  Section 005 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 006 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 007 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 008 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 009 LblCom O3COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2016)  r     1 O3COM

  ****  Auto variables  ****

PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:50   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OPND                     11-0-0/w SBIN        r     1 COMPUTE_SEQ
     5-0-0/w SBIN        r     1 COUNT                     15-0-0/w SBIN        r     1 I
    10-0-0/w PTR         r     1 ILL$$                     13-0-0/w PTR         r     1 ILS$$
    17-0-0/w SBIN        r     1 INCR                       6-0-0/w PTR         r     1 NEXT$
    *0-0-0/w PTR         r     1 OPND                       7-0-0/w PTR         r     1 PREV$
    12-0-0/w PTR         r     1 PREV_SEQ$                 16-0-0/w SBIN        r     1 SEQ#
     4-0-0/w PTR         r     1 SEQ$                      14-0-0/w SBIN        r     1 VAL_REC_COUNT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(216)   r     1 CCOSU
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(144)         1 DEFLB
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)   r     1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)   r     1 ILS
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
PL6.E3A0      #001=Z8GI$INSERT_EVALP File=Z8GI.:Z8A6TSI                          SAT 08/09/97 13:15 Page:51   
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(108)   r     1 VAL                        0-0-0/w STRC(108)   r     1 VAL_END
     0-0-0/w STRC(72)          1 WHEN


   Procedure Z8GI$INSERT_EVALP requires 370 words for executable code.
   Procedure Z8GI$INSERT_EVALP requires 18 words of local(AUTO) storage.

    No errors detected in file Z8GI.:Z8A6TSI    .
