VERSION A06

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:1    
        1        1        /*M* Z9EW - System dependant I/O routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z9EW$IO_INTERFACE: PROC (FILE$);
        8        8         /*P*
        9        9             NAME: Z9EW$IO_INTERFACE
       10       10             PURPOSE: To create the FAB for CP6 I/O.  This extracts
       11       11               information from the FILE_LTS and creates the FAB via
       12       12               scalar/qlt items and presets.
       13       13         */
       14       14
       15       15
       16       16             %INCLUDE Z8A_SYS_FILE;
       17     6291
       18     6292             %EQU PHASE = 1;
       19     6293
       20     6294             %INCLUDE Z8A_DEFC;
       21     6362             %INCLUDE Z8A_SUPP_MAC;
       22     8762             %INCLUDE Z8A_COMCOM;
       23     9412             %INCLUDE Z8A_LTS;
       24    11489             %INCLUDE Z8A_DNT;
       25    11710             %INCLUDE Z8A_ST;
       26    15369             %INCLUDE Z8A_TYPES;
       27    15543             %INCLUDE Z8A_ILL;
       28    16236             %INCLUDE Z8A_ETT;
       29    16537             %INCLUDE Z8A_IO_EQUS;
       30    16660             %INCLUDE Z8A_ERR_NUMS;
       31    17424             %INCLUDE Z8A_MKCN;
       32    17441             %INCLUDE Z8A_QLT;
       33    17547             %INCLUDE X9A_FAB;
       34    17734             %INCLUDE X9A_IO;
       35    17884
       36    17885             %INCLUDE Z8E_STACKS;
       37    20151             %INCLUDE Z8E_O1COM;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:2    
       38    20912             %INCLUDE Z8E_MACROS;
       39    21587             %INCLUDE Z8E_STATEMNT;
       40    21656
       41    21657    1        DCL Z8AH$SEARCH_         ENTRY;
       42    21658    1        DCL Z8CU$BUILD_AND_LINK  ENTRY (6);
       43    21659    1        DCL Z8AC$MAKE_CONST      ENTRY (1);
       44    21660    1        DCL Z8AE$ERROR           ENTRY (12);
       45    21661    1        DCL Z8DC$SIZE_CALC       ENTRY (2);
       46    21662    1        DCL Z8DS$SPAN__CALC       ENTRY (1);
       47    21663    1        DCL Z9EO$RUNTIME_DESC_FROM_ETT  ENTRY (5) ALTRET;
       48    21664
       49    21665    1        DCL 1 FAB_CONST_LENGTH BASED ALIGNED,
       50    21666                   %FAB_CONST (@ENDING = TRUE);
       51    21731
       52    21732    1        DCL 1 FAB_VAR_LENGTH BASED ALIGNED,
       53    21733                   %FAB_VARIABLE ;
       54    21784
       55    21785    1        DCL 1 DESC ALIGNED,
       56    21786                   %DESCRIPTOR (LVL = 2, ENDING = YES);
       57    21814
       58    21815             %DCL_FAB (@NAME = FAB);
       59    21937             %XSA_PARAM (FPTN = XSA_PARAM, LVL = 1, STCLASS = CONSTANT);
       60    21967
       61    21968    1        DCL LEN           SBIN;
       62    21969    1        DCL F_DNT$        PTR;
       63    21970    1        DCL ALT_KEY$      PTR;
       64    21971    1        DCL MAX_BOUND     UBIN;
       65    21972    1        DCL ROP$$         PTR;
       66    21973    1        DCL FAB$          PTR; /* Ptr to 01 FAB (st) */
       67    21974    1        DCL USE_BLOCK$    PTR;
       68    21975    1        DCL DCBNUM$       PTR; /* Ptr to 02 DCBNUM (st) */
       69    21976    1        DCL FAB_C$        PTR;
       70    21977    1        DCL FAB_V$        PTR;
       71    21978    1        DCL FILE$         PTR;
       72    21979    1        DCL DNT$$         PTR;
       73    21980    1        DCL UNIT_RECORD   BIT (1) ALIGNED;
       74    21981
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:3    
       75    21982    1        DCL EPTR_NIL_VAL  EPTR CONSTANT INIT (ENTADDR(NIL));
       76    21983    1        DCL EPTR_NIL REDEF EPTR_NIL_VAL  SBIN WORD;
       77    21984    1        DCL EPTR_NIL_CONST$              PTR;
       78    21985        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:4    
       79    21986        %MACRO SBIN_PRESET (@FIELD = );
       80    21987
       81    21988               DO;
       82    21989                 CALL NEW_SBIN_CONST (FILE$ -> FILE_LTS.@FIELD, ROP$$);
       83    21990                 CALL PRESET (FAB_V$, ROP$$);
       84    21991               END;
       85    21992
       86    21993        %MEND;
       87    21994        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:5    
       88    21995        %MACRO DESC_PRESET (@FIELD = , @OFFSET =0);
       89    21996
       90    21997             IF FILE$ -> FILE_LTS.@FIELD = ADDR(NIL) THEN
       91    21998               LCONST$ -> LCNST.CONSTW.VAL(@OFFSET) = 0;
       92    21999             ELSE
       93    22000               DO;
       94    22001                 CALL Z9EO$RUNTIME_DESC_FROM_ETT (FILE$ -> FILE_LTS.@FIELD,
       95    22002                                                  LCONST$ -> LCNST.CONSTW.VAL(@OFFSET));
       96    22003               END;
       97    22004
       98    22005        %MEND;
       99    22006        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:6    
      100    22007        %MACRO PTR_PRESET (@FIELD = , @OFFSET =0);
      101    22008
      102    22009        %LSET FIELDN = CHARTEXT(CONCAT('FILE$ -> FILE_LTS.',TEXTCHAR(@FIELD)));
      103    22010               DO;
      104    22011                 %NEW_ILL (@ID = %PTR_SET,
      105    22012                           @LOP = FAB_V$,
      106    22013                           @ROP = %FIELDN,
      107    22014                           @OFFSET = @OFFSET);
      108    22015               END;
      109    22016
      110    22017        %MEND;
      111    22018        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:7    
      112    22019    1   PTR_SET: PROC (LOP, ROP, OFFSET);
      113    22020
      114    22021    2        DCL LOP           PTR;
      115    22022    2        DCL ROP           PTR;
      116    22023    2        DCL OFFSET        SBIN;
      117    22024
      118    22025
      119    22026               %NEW_ILL (@ID    = %PTR_SET,
      120    22027                         @LOP   = LOP,
      121    22028                         @ROP   = ROP,
      122    22029                         @OFFSET = OFFSET);
      123    22408
      124    22409    2   END PTR_SET;
      125    22410        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:8    
      126    22411    1   PRESET: PROC (LOP, ROP);
      127    22412
      128    22413    2        DCL LOP           PTR;
      129    22414    2        DCL ROP           PTR;
      130    22415
      131    22416
      132    22417               %NEW_ILL (@ID    = %PRESET,
      133    22418                         @LOP   = LOP,
      134    22419                         @ROP   = ROP);
      135    22798
      136    22799    2   END PRESET;
      137    22800        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:9    
      138    22801    1   NEW_SBIN_CONST: PROC (NUM, RETURN$);
      139    22802
      140    22803    2        DCL NUM           SBIN;
      141    22804    2        DCL RETURN$       PTR;
      142    22805
      143    22806
      144    22807    2        MKCN.CON = NUM;
      145    22808    2        CALL Z8AC$MAKE_CONST (RETURN$);
      146    22809
      147    22810    2        RETURN$ = RETURN$ -> ETT.LOP;
      148    22811
      149    22812    2   END NEW_SBIN_CONST;
      150    22813        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:10   
      151    22814    1   DEVICE_TO_CP6_DEVICE: PROC (RETURN_VAL, UNIT_RECORD);
      152    22815
      153    22816    2        DCL RETURN_VAL       SBIN;
      154    22817    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      155    22818
      156    22819
      157    22820    2        UNIT_RECORD = TRUE;
      158    22821
      159    22822    3        DO SELECT (FILE$ -> FILE_LTS.ASSIGN$ ->
      160    22823    3                   LTS_PTR_ARRAY.P$ (0) -> DNT.TEXT.NAME);
      161    22824
      162    22825    3          SELECT (%MAGNETIC_TAPE);
      163    22826    3            RETURN_VAL = %CP6_MAGNETIC_TAPE;
      164    22827    3            UNIT_RECORD = FALSE;
      165    22828
      166    22829    3          SELECT (%DISK);
      167    22830    3            RETURN_VAL = %CP6_DISK;
      168    22831    3            UNIT_RECORD = FALSE;
      169    22832
      170    22833    3          SELECT (%PRINTER);
      171    22834    3            RETURN_VAL = %CP6_PRINTER;
      172    22835
      173    22836    3          SELECT (%PRINTER_F);
      174    22837    3            RETURN_VAL = %CP6_PRINTER_F;
      175    22838
      176    22839    3          SELECT (%SYSOUT);
      177    22840    3            RETURN_VAL = %CP6_SYSOUT;
      178    22841
      179    22842    3          SELECT (%SYSIN);
      180    22843    3            RETURN_VAL = %CP6_SYSIN;
      181    22844
      182    22845    3          SELECT (%CARD_READER);
      183    22846    3            RETURN_VAL = %CP6_CARD_READER;
      184    22847
      185    22848    3          SELECT (%CARD_PUNCH);
      186    22849    3            RETURN_VAL = %CP6_CARD_PUNCH;
      187    22850
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:11   
      188    22851    3          SELECT (ELSE);
      189    22852    3            CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      190    22853    3            RETURN_VAL = %CP6_DISK;
      191    22854    3            UNIT_RECORD = FALSE;
      192    22855
      193    22856    3        END; /* Select */
      194    22857
      195    22858    2   END DEVICE_TO_CP6_DEVICE;
      196    22859        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:12   
      197    22860    1   ORG_TO_CP6_ORG: PROC (UNIT_RECORD, RETURN_VAL);
      198    22861
      199    22862    2        DCL RETURN_VAL       SBIN;
      200    22863    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      201    22864
      202    22865
      203    22866    3        DO CASE (FILE$ -> FILE_LTS.ORGANIZATION);
      204    22867
      205    22868    3          CASE (%SEQUENTIAL);
      206    22869    3            IF UNIT_RECORD THEN
      207    22870    3              RETURN_VAL = %CP6_UR;
      208    22871    3            ELSE
      209    22872    3              IF FILE$ -> FILE_LTS.B.EBCDIC THEN
      210    22873    3                RETURN_VAL = %CP6_FIXED;
      211    22874    3              ELSE
      212    22875    3                RETURN_VAL = %CP6_SEQUENTIAL;
      213    22876
      214    22877    3          CASE (%KEYED);
      215    22878    3            RETURN_VAL = %CP6_KEYED;
      216    22879
      217    22880    3          CASE (%INDEXED);
      218    22881    3            RETURN_VAL = %CP6_INDEXED;
      219    22882
      220    22883    3          CASE (%RELATIVE);
      221    22884    3            RETURN_VAL = %CP6_RELATIVE;
      222    22885
      223    22886    3          CASE (ELSE);
      224    22887    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      225    22888    3            RETURN_VAL = %CP6_SEQUENTIAL;
      226    22889
      227    22890    3        END; /* Case */
      228    22891
      229    22892    2   END ORG_TO_CP6_ORG;
      230    22893        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:13   
      231    22894    1   ACCESS_TO_FAB_ACCESS: PROC (RETURN_VAL);
      232    22895
      233    22896    2        DCL RETURN_VAL       SBIN;
      234    22897
      235    22898
      236    22899    3        DO CASE (FILE$ -> FILE_LTS.ACCESS_MODE);
      237    22900
      238    22901    3          CASE (%RANDOM_ACCESS);
      239    22902    3            RETURN_VAL = %FAB_RANDOM_ACCESS;
      240    22903
      241    22904    3          CASE (%SEQUENTIAL_ACCESS);
      242    22905    3            RETURN_VAL = %FAB_SEQUENTIAL_ACCESS;
      243    22906
      244    22907    3          CASE (%DYNAMIC_ACCESS);
      245    22908    3            RETURN_VAL = %FAB_DYNAMIC_ACCESS;
      246    22909
      247    22910    3          CASE (ELSE);
      248    22911    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      249    22912    3            RETURN_VAL = %FAB_SEQUENTIAL_ACCESS;
      250    22913
      251    22914    3        END; /* Case */
      252    22915
      253    22916    2   END ACCESS_TO_FAB_ACCESS;
      254    22917        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:14   
      255    22918    1   BUILD_SHARED_ALT_KEY : PROC;
      256    22919
      257    22920    2   DCL RETURN$    PTR;
      258    22921
      259    22922    2   IF FILE$ -> FILE_LTS.ALT_RECORD_KEY$ = ADDR(NIL)   OR
      260    22923    2           FILE$ -> FILE_LTS.ACCESS_MODE = %RANDOM_ACCESS  THEN
      261    22924    2     RETURN;
      262    22925
      263    22926    2   CALL Z8CU$BUILD_AND_LINK( F_DNT$, 1, %TYA, 'SHARED', 6, RETURN$ );
      264    22927    2   RETURN$ -> SCALAR.ADSC.N = 272;
      265    22928
      266    22929    2   CALL PTR_SET( FAB_V$, RETURN$, 2 );
      267    22930
      268    22931    2   END BUILD_SHARED_ALT_KEY;
      269    22932        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:15   
      270    22933    1   NEW_DCB: PROC (UNIT_RECORD, FILE_LTS$, DCB_NUM$);
      271    22934
      272    22935
      273    22936    2        DCL Z8AT$CREATE_TEMPORARY       ENTRY (2);
      274    22937
      275    22938    2        DCL DCB_TEMPLATE  DCB;
      276    22939    2        DCL DCB$          PTR;
      277    22940
      278    22941             %F$DCB (DCBN = DCBN, BASED = "BASED (DCB$)");
      279    22998
      280    22999    2        DCL DCB_LEN       UBIN;
      281    23000    2        DCL DCB_LEN_NO_NAME UBIN;
      282    23001    2        DCL DCB_BASED     BASED CHAR (DCB_LEN);
      283    23002    2        DCL DCB_ADDR$     PTR;
      284    23003
      285    23004    2        DCL FILE_LTS$     PTR;
      286    23005    2        DCL P$            PTR;
      287    23006    2        DCL DCB_NUM$      PTR;
      288    23007    2        DCL DCB_NAME$     PTR;
      289    23008    2        DCL DCB_ST$       PTR STATIC;
      290    23009    2        DCL RTN$          PTR;
      291    23010    2        DCL STAR_NAME     CHAR (31);
      292    23011    2        DCL LENGTH        SBIN;
      293    23012    2        DCL DCB_VAR$      PTR;
      294    23013    2        DCL DCB_TEMPLATE$ PTR;
      295    23014    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      296    23015    2        DCL RETURN_VAL    SBIN;
      297    23016             %FPT_OPEN (FPTN = FAKE_OPEN, STCLASS = STATIC,
      298    23017                        REASSIGN = NO, SCRUB = YES,
      299    23018                        SETDCB = YES, DCB = DCB_TEMPLATE);
      300    23127        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:16   
      301    23128             %NEW_DCB (@ST$   = DCB_ST$,
      302    23129                       @R     = %BLOCK_,
      303    23130                       @SIZE  = 0,
      304    23131                       @DNT$  = F_DNT$);
      305    23193
      306    23194    2        COMCOM.BLOCKC = COMCOM.BLOCKC + 1;
      307    23195    2        DCB_ST$ -> DCB_.COUNT = COMCOM.BLOCKC;
      308    23196
      309    23197    2        O1COM.LAST_BLOCK$ -> VARIABLE.NEXT = DCB_ST$;
      310    23198    2        O1COM.LAST_BLOCK$ = DCB_ST$;
      311    23199
      312    23200    2        CALL PTR_SET( DCB_NUM$, DCB_ST$, 0 );
      313    23201
      314    23202    2        RETURN;
      315    23203        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:17   
      316    23204    2   INIT_DCB : ENTRY (UNIT_RECORD, FILE_LTS$, DCB_NUM$);
      317    23205
      318    23206    2        IF COMCOM.OB.OPTZ THEN   /* Compile time open, otherwise let runtime do it */
      319    23207    3          DO;
      320    23208    3            CALL M$OPEN (FAKE_OPEN);
      321    23209
      322    23210    3            DCB_ADDR$ = DCBADDR (DCBNUM (DCB_TEMPLATE));
      323    23211
      324    23212    3            DCB_LEN = LENGTHC(DCB_ADDR$ -> DCBN)                /*#39131*/
      325    23213    3                - DCB_ADDR$ -> DCBN.DCBNAME.L
      326    23214    3                    + F_DNT$ -> DNT.TEXT.LENGTH;
      327    23215
      328    23216    3            DCB_LEN_NO_NAME = LENGTHC(DCB_ADDR$ -> DCBN)        /*#39131*/
      329    23217    3                - DCB_ADDR$ -> DCBN.DCBNAME.L
      330    23218    3                - 1;
      331    23219
      332    23220    3            CALL Z8AT$CREATE_TEMPORARY (%SCALAR, DCB_VAR$);
      333    23221
      334    23222    3            DCB_VAR$ -> SCALAR.TYPE     = %TYA;
      335    23223    3            DCB_VAR$ -> SCALAR.ADSC.N   = DCB_LEN_NO_NAME;
      336    23224    3            DCB_VAR$ -> SCALAR.COUNT    = DCB_ST$ -> DCB_.COUNT;
      337    23225    3            DCB_VAR$ -> SCALAR.B.CLASS  = %CLASS_ALPHANUMERIC;
      338    23226
      339    23227    3            CALL Z8AT$CREATE_TEMPORARY (%SCALAR, DCB_NAME$);
      340    23228
      341    23229    3            DCB_NAME$ -> SCALAR.TYPE    = %TYA;
      342    23230    3            DCB_NAME$ -> SCALAR.ADSC.N  = DCB_LEN - DCB_LEN_NO_NAME;
      343    23231    3            DCB_NAME$ -> SCALAR.COUNT   = DCB_ST$ -> DCB_.COUNT;
      344    23232    3            DCB_NAME$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;
      345    23233
      346    23234                 %NEW_CONST (@ST$   = DCB_TEMPLATE$,
      347    23235                             @TYPE  = %TYA,
      348    23236                             @LONG_CONSTANT = TRUE);
      349    23277
      350    23278    3            DCB_TEMPLATE$ -> CONST.ADSC.N = DCB_LEN_NO_NAME;
      351    23279
      352    23280                 %NEW_LCNST (@POINTER = DCB_TEMPLATE$ -> CONST.CONST$.PTR$,
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:18   
      353    23281                             @SIZE    = "((7 + DCB_LEN) / 4)"); /*#35094*/
      354    23374
      355    23375    3            DCB$ = PINCRW (DCB_TEMPLATE$ -> CONST.CONST$.PTR$, 1);
      356    23376
      357    23377    3            SUBSTR (DCB_TEMPLATE$ -> CONST.CONST$.PTR$ -> LCNST.CONST, 0,
             23377                     DCB_LEN_NO_NAME) =
      358    23378    3            SUBSTR (DCB_ADDR$ -> DCB_BASED, 0, DCB_LEN_NO_NAME);
      359    23379
      360    23380    3            DCB$ -> DCBN.NAME#.L = F_DNT$ -> DNT.TEXT.LENGTH + 1;
      361    23381    3            CALL CONCAT (DCB$ -> DCBN.NAME#.C, '*', F_DNT$ -> DNT.TEXT.NAME);
      362    23382
      363    23383
      364    23384    3            DCB$ -> DCBN.DCBNAME.L = F_DNT$ -> DNT.TEXT.LENGTH;
      365    23385    3            DCB$ -> DCBN.DCBNAME.N = F_DNT$ -> DNT.TEXT.NAME;
      366    23386
      367    23387    4            DO CASE (FILE$ -> FILE_LTS.ACCESS_MODE);
      368    23388
      369    23389    4              CASE (%RANDOM_ACCESS);
      370    23390    4                RETURN_VAL = %CP6_RANDOM_ACCESS;
      371    23391
      372    23392    4              CASE (%SEQUENTIAL_ACCESS);
      373    23393    4                RETURN_VAL = %CP6_SEQUENTIAL_ACCESS;
      374    23394
      375    23395    4              CASE (%DYNAMIC_ACCESS);
      376    23396    4                RETURN_VAL = %CP6_DYNAMIC_ACCESS;
      377    23397
      378    23398    4              CASE (ELSE);
      379    23399    4                CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      380    23400    4                RETURN_VAL = %CP6_SEQUENTIAL_ACCESS;
      381    23401
      382    23402    4            END; /* Case */
      383    23403    3            DCB$ -> DCBN.ACS# = RETURN_VAL;
      384    23404
      385    23405    3            CALL ORG_TO_CP6_ORG (UNIT_RECORD, RETURN_VAL);
      386    23406    3            DCB$ -> DCBN.ORG# = RETURN_VAL;
      387    23407
      388    23408    3            DCB$ -> DCBN.NRECS# = 1000; /* ~~ 1K */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:19   
      389    23409
      390    23410    4            DO CASE (FILE$ -> FILE_LTS.ORGANIZATION);
      391    23411
      392    23412    4              CASE (
      393    23413                         %SET_OF_INDEXED_ORGANIZATION;
      394    23417    4                   );
      395    23418    4                IF FILE$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN
      396    23419    5                  DO;
      397    23420                         /* Set KEYX# and KEYL# */
      398    23421                         %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.RECORD_KEY$,
      399    23422                                        RTN = DCB$ -> DCBN.KEYL#);
      400    23433
      401    23434    5                    DCB$ -> DCBN.KEYX# = FILE$ -> FILE_LTS.RECORD_KEY$ ->
      402    23435    5                                         SCALAR.SA * 4 + FILE$ ->
      403    23436    5                                         FILE_LTS.RECORD_KEY$ -> SCALAR.ADSC.CN;
      404    23437    5                  END;
      405    23438
      406    23439    4              CASE (ELSE);
      407    23440    4            END; /* Case */
      408    23441
      409    23442
      410    23443    3            DCB$ -> DCBN.BLKL# = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;
      411    23444    3            DCB$ -> DCBN.RECL# = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_2;
      412    23445
      413    23446    3            DCB$ -> DCBN.CNVRT#  = FILE$ -> FILE_LTS.B.EBCDIC_CODE_SET;
      414    23447    3            DCB$ -> DCBN.EBCDIC# = FILE$ -> FILE_LTS.B.EBCDIC;
      415    23448
      416    23449    3            CALL DEVICE_TO_CP6_DEVICE (RETURN_VAL, UNIT_RECORD);
      417    23450
      418    23451    4            DO CASE (RETURN_VAL);
      419    23452
      420    23453    4              CASE (%CP6_CARD_PUNCH);
      421    23454    4                DCB$ -> DCBN.ASN# = %CP6_DEVICE;
      422    23455    4                DCB$ -> DCBN.RES# = 'CP';
      423    23456
      424    23457    4              CASE (%CP6_DISK);
      425    23458    4                DCB$ -> DCBN.ASN# = %CP6_FILE;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:20   
      426    23459
      427    23460    4              CASE (%CP6_MAGNETIC_TAPE);
      428    23461    4                DCB$ -> DCBN.ASN# = %CP6_TAPE;
      429    23462    4                DCB$ -> DCBN.RES# = 'MT';
      430    23463
      431    23464    4              CASE (ELSE);
      432    23465    4                DCB$ -> DCBN.ASN# = %CP6_DEVICE;
      433    23466    4                DCB$ -> DCBN.RES# = 'ME';
      434    23467
      435    23468    4            END; /* Case */
      436    23469
      437    23470
      438    23471    3            CALL PRESET( DCB_VAR$, DCB_TEMPLATE$ );
      439    23472    3          END;
      440    23473
      441    23474    2   END NEW_DCB;
      442    23475        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:21   
      443    23476    1   NEW_USE_BLOCK: PROC (BLOCK$, FILE$, OFFSET);
      444    23477
      445    23478    2        DCL BLOCK$        PTR;
      446    23479    2        DCL FILE$         PTR;
      447    23480    2        DCL OFFSET        SBIN;
      448    23481    2        DCL FILE_DNT$     PTR;
      449    23482    2        DCL P$            PTR;
      450    23483
      451    23484
      452    23485    2        IF COMCOM.USE_BLOCK_ST$ = ADDR(NIL) THEN
      453    23486    3          DO;
      454    23487    3            LEX_SYMBOL.SIZE = 4;
      455    23488    3            LEX_SYMBOL.SYMBOL = 'FILE';
      456    23489    3            CALL Z8AH$SEARCH_;
      457    23490    3            FILE_DNT$ = DNT$;
      458    23491    3            CALL Z8CU$BUILD_AND_LINK (FILE_DNT$, 1, %TYA, 'USE_BLOCK', 9, COMCOM.
             23491                     USE_BLOCK_ST$);
      459    23492    3            COMCOM.USE_BLOCK_ST$ -> SCALAR.ADSC.N = 16;
      460    23493
      461    23494    3          END;
      462    23495
      463    23496    2        IF FILE$ -> FILE_LTS.B.EXTERNAL OR FILE$ -> FILE_LTS.B.BLOCK THEN
      464    23497    3          DO;
      465    23498    3            P$ = FILE$ -> FILE_LTS.ST$ -> FD.PROC$;
      466    23499    4            DO WHILE P$ -> PROC_.FATHER ~= ADDR (NIL);
      467    23500    4              P$ = P$ -> PROC_.FATHER;
      468    23501    4            END;
      469    23502    3            IF NOT P$ -> PROC_.B.MAIN_PROG THEN
      470    23503    3              RETURN;
      471    23504    3          END;
      472    23505
      473    23506    2        CALL PTR_SET( BLOCK$, COMCOM.USE_BLOCK_ST$, OFFSET );
      474    23507
      475    23508
      476    23509    2   END NEW_USE_BLOCK;
      477    23510        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:22   
      478    23511    1   NEW_ALT_KEYS: PROC (ALT$, FILE$, OFFSET);
      479    23512
      480    23513             %EQU ALT_KEY_TEXT = 'ALT_KEY';
      481    23514             %EQU ALT_KEY_LEN  = 7 + 1 + 2; /* Lengthc (alt_key_text) +
      482    23515                                               lengthc ('#') +
      483    23516                                               lengthc (key#_text)      */
      484    23517
      485    23518    2        DCL ALT$          PTR;
      486    23519    2        DCL FILE$         PTR;
      487    23520    2        DCL RETURN$         PTR;
      488    23521    2        DCL I             SBIN;
      489    23522    2        DCL ALT_KEY$      PTR;
      490    23523    2        DCL UNIQUE        BIT(1) ALIGNED;
      491    23524    2        DCL ROP$$         PTR;
      492    23525    2        DCL OFFSET        SBIN;
      493    23526    2        DCL NAME          CHAR(10);
      494    23527    2        DCL KEY#          UBIN;
      495    23528    2        DCL KEY#_TEXT     CHAR (2);
      496    23529
      497    23530    2        IF FILE$ -> FILE_LTS.ALT_RECORD_KEY$ = ADDR(NIL) THEN
      498    23531    3          DO;
      499    23532                 %PTR_PRESET( @FIELD = ALT_RECORD_KEY$,
      500    23533                              @OFFSET = OFFSET );
      501    23920    3            RETURN;
      502    23921    3          END;
      503    23922
      504    23923    2        ALT_KEY$ = FILE$ -> FILE_LTS.ALT_RECORD_KEY$;
      505    23924
      506    23925
      507    23926    2        CALL Z8CU$BUILD_AND_LINK (F_DNT$, 1, %TYA, 'ALT_KEYS', 8, RETURN$);
      508    23927    2        CALL PTR_SET( ALT$, RETURN$, OFFSET );
      509    23928
      510    23929             %PACK_ADSC (@DESC = DESC,
      511    23930                         @LENGTH = "ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1 * 4 + 8");
      512    23954    2        RETURN$ -> ST.DESCL = DESC.DESCL;
      513    23955    2        RETURN$ -> VARIABLE.B.ELEMENTARY = FALSE;
      514    23956
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:23   
      515    23957
      516    23958    2        CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'ALT_KEY_SIZ', 11, RETURN$);
      517    23959             %PACK_ADSC (@DESC = DESC,
      518    23960                         @LENGTH = 4);
      519    23984    2        RETURN$ -> ST.DESCL = DESC.DESCL;
      520    23985    2        CALL NEW_SBIN_CONST (ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1 + 1,
      521    23986    2                             ROP$$);
      522    23987    2        CALL PRESET (RETURN$, ROP$$);
      523    23988
      524    23989
      525    23990    2        KEY# = 0;
      526    23991    3        DO I = 0 TO ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1;
      527    23992    3          KEY# = KEY# + 1;
      528    23993    3          CALL BINCHAR (KEY#_TEXT, KEY#);
      529    23994
      530    23995    3          CALL CONCAT (NAME, %ALT_KEY_TEXT, '#', KEY#_TEXT);
      531    23996    3          CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, NAME, 10, RETURN$);
      532    23997    3          RETURN$ -> SCALAR.SA = KEY#;
      533    23998
      534    23999    3          UNIQUE = ALT_KEY$ -> ALT_KEY.P.UNIQUE (I);
      535    24000
      536    24001    3          CALL PRESET_KEY (ALT_KEY$ -> ALT_KEY.P.P$(I),
      537    24002    3                           RETURN$, UNIQUE);
      538    24003    3        END;
      539    24004
      540    24005         /*  CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, 'PRIM_KEY', 8, RETURN$);
      541    24006             RETURN$ -> SCALAR.SA = KEY# + 1;
      542    24007             CALL PRESET_KEY (FILE$ -> FILE_LTS.RECORD_KEY$,
      543    24008                              RETURN$, TRUE);   */                 /*#29940*/
      544    24009
      545    24010    2   END NEW_ALT_KEYS;
      546    24011        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:24   
      547    24012    1   PRESET_KEY: PROC (KEY_ST$, FAB_KEY$, UNIQUE);
      548    24013
      549    24014    2        DCL KEY_ST$       PTR;
      550    24015    2        DCL FAB_KEY$      PTR;
      551    24016    2        DCL UNIQUE        BIT(1) ALIGNED;
      552    24017    2        DCL OFFSET        SBIN;
      553    24018    2        DCL ROP$$         PTR;
      554    24019
      555    24020             %VLP_ALTKEYS (FPTN = VLP_ALT_KEY, STCLASS = "AUTO", N = 2);
      556    24035
      557    24036
      558    24037    2        OFFSET = KEY_ST$ -> ST.SA * 4
      559    24038    2               + KEY_ST$ -> ST.ADSC.CN;
      560    24039
      561    24040    2        VLP_ALT_KEY.K.KEYX# (1) = OFFSET;
      562    24041
      563    24042             %GET_ADSC_LEN (ST$ = KEY_ST$,
      564    24043                            RTN = "VLP_ALT_KEY.K.KEYL# (1)");
      565    24054
      566    24055    2        VLP_ALT_KEY.K.UNIQUE# (1) = UNIQUE;
      567    24056
      568    24057    2        CALL NEW_SBIN_CONST (VLP_ALT_KEY.K (1), ROP$$);
      569    24058    2        CALL PRESET (FAB_KEY$, ROP$$);
      570    24059
      571    24060    2   END PRESET_KEY;
      572    24061        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:25   
      573    24062    1   SET_ATTR_BITS: PROC (FILE$, RETURN_VAL);
      574    24063
      575    24064    2        DCL FILE$         PTR;
      576    24065    2        DCL RETURN_VAL        BIT(36) ALIGNED;
      577    24066    2        DCL 1 FAB_BITS    ALIGNED,
      578    24067                   %FAB_BITS   (@LVL = 2, @ENDING = YES);
      579    24102
      580    24103
      581    24104    2        FAB_BITS = FALSE;
      582    24105
      583    24106    2        FAB_BITS.MULTIPLE_FILE_TAPE = FILE$ -> FILE_LTS.B.MULTIPLE_FILE_TAPE;
      584    24107    2        FAB_BITS.OPTIONAL_FILE      = FILE$ -> FILE_LTS.B.OPTIONAL_FILE;
      585    24108    2        FAB_BITS.PROCESS_AREA       = FILE$ -> FILE_LTS.B.PROCESS_AREA;
      586    24109    2        FAB_BITS.BSN                = FILE$ -> FILE_LTS.B.BSN;
      587    24110    2        FAB_BITS.FLR                = FILE$ -> FILE_LTS.B.FLR;
      588    24111    2        FAB_BITS.VLR                = FILE$ -> FILE_LTS.B.VLR;
      589    24112    2        FAB_BITS.SSF                = FILE$ -> FILE_LTS.B.SSF;
      590    24113    2        FAB_BITS.UNBANNERED         = FILE$ -> FILE_LTS.B.UNBANNERED;
      591    24114    2        FAB_BITS.SPANNED            = FILE$ -> FILE_LTS.B.SPANNED;
      592    24115    2        FAB_BITS.LABEL_OMITTED      = FILE$ -> FILE_LTS.B.LABEL_OMITTED;
      593    24116    2        FAB_BITS.LABEL_STANDARD     = FILE$ -> FILE_LTS.B.LABEL_STANDARD;
      594    24117    2        FAB_BITS.BEGIN_TAPE_LABEL   = FILE$ -> FILE_LTS.B.BEGIN_TAPE_LABEL;
      595    24118    2        FAB_BITS.BEGIN_FILE_LABEL   = FILE$ -> FILE_LTS.B.BEGIN_FILE_LABEL;
      596    24119    2        FAB_BITS.END_FILE_LABEL     = FILE$ -> FILE_LTS.B.END_FILE_LABEL;
      597    24120    2        FAB_BITS.END_TAPE_LABEL     = FILE$ -> FILE_LTS.B.END_TAPE_LABEL;
      598    24121    2        FAB_BITS.FAST_SEQUENTIAL    = FALSE;
      599    24122    2        FAB_BITS.CNVRT#             = FILE$ -> FILE_LTS.B.EBCDIC_CODE_SET;
      600    24123    2        FAB_BITS.EBCDIC#            = FILE$ -> FILE_LTS.B.EBCDIC;
      601    24124    2        FAB_BITS.DCB_INIT           = COMCOM.OB.OPTZ;
      602    24125
      603    24126    2        IF FAB_BITS.VLR = FAB_BITS.FLR      THEN
      604    24127    2          IF FILE$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ ~= ADDR(NIL) OR
      605    24128    2            (FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_1 ~= FILE$ -> FILE_LTS.
             24128                     RECORD_CONTAINS.INT_2) THEN
      606    24129    3            DO;
      607    24130    3              FAB_BITS.VLR = %TRUE;
      608    24131    3              FAB_BITS.FLR = %FALSE;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:26   
      609    24132    3            END;
      610    24133
      611    24134    2          ELSE
      612    24135
      613    24136    3            DO;
      614    24137    3              FAB_BITS.VLR = %FALSE;
      615    24138    3              FAB_BITS.FLR = %TRUE;
      616    24139    3            END;
      617    24140
      618    24141
      619    24142             /* end of bit assignments*/
      620    24143
      621    24144    2        RETURN_VAL = FAB_BITS;
      622    24145
      623    24146    2   END SET_ATTR_BITS;
      624    24147        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:27   
      625    24148    1   INIT_FAB_CONST : PROC;
      626    24149
      627    24150    2     DCL FAB_CONST$ PTR;
      628    24151    2     DCL LCONST$    PTR;
      629    24152
      630    24153        %NEW_CONST (@ST$ = FAB_CONST$,
      631    24154                    @TYPE = %TYA,
      632    24155                    @LONG_CONSTANT = TRUE);
      633    24196
      634    24197    2   FAB_CONST$ -> CONST.ADSC.N = SIZEC(FAB_CONST_LENGTH);
      635    24198
      636    24199        %NEW_LCNST (@POINTER = FAB_CONST$ -> CONST.CONST$.PTR$,
      637    24200                    @SIZE = "1 + (SIZEC(FAB_CONST_LENGTH)/4)");
      638    24293    2   LCONST$ = FAB_CONST$ -> CONST.CONST$.PTR$;
      639    24294
      640    24295        /* Assign */
      641    24296    2   CALL DEVICE_TO_CP6_DEVICE (LCONST$ -> LCNST.CONSTW.VAL(0),
      642    24297    2                              UNIT_RECORD);
      643    24298
      644    24299        /* Areas */
      645    24300    2   LCONST$ -> LCNST.CONSTW.VAL(1) = FILE$ -> FILE_LTS.NO_OF_AREAS;
      646    24301
      647    24302        /* Organization */
      648    24303    2   CALL ORG_TO_CP6_ORG (UNIT_RECORD,                 /*#31542*/
      649    24304    2                        LCONST$ -> LCNST.CONSTW.VAL(2));
      650    24305
      651    24306        /* Record Delim */
      652    24307    2   LCONST$ -> LCNST.CONSTW.VAL(3) = FILE$ -> FILE_LTS.RECORD_DELIM;
      653    24308
      654    24309        /* Access */
      655    24310    2   CALL ACCESS_TO_FAB_ACCESS (LCONST$ -> LCNST.CONSTW.VAL(4));
      656    24311
      657    24312        /* Min block len */
      658    24313    2   LCONST$ -> LCNST.CONSTW.VAL(5) = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_1;
      659    24314
      660    24315        /* Max block len */
      661    24316    2   LCONST$ -> LCNST.CONSTW.VAL(6) = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:28   
      662    24317
      663    24318        /* Min rec len */
      664    24319    2   LCONST$ -> LCNST.CONSTW.VAL(7) = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_1;
      665    24320
      666    24321        /* Max rec len */
      667    24322    2   LCONST$ -> LCNST.CONSTW.VAL(8) = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_2;
      668    24323
      669    24324        /* Depending Desc */
      670    24325        %DESC_PRESET (@FIELD = "RECORD_CONTAINS.DEPENDING$",
      671    24326                      @OFFSET = 9);
      672    24335
      673    24336        /* File id len */
      674    24337    2   IF FILE$ -> FILE_LTS.FILE_ID$ = ADDR(NIL) THEN
      675    24338    2     LCONST$ -> LCNST.CONSTW.VAL(10) = 0;
      676    24339    2   ELSE
      677    24340    3     DO;
      678    24341            %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.FILE_ID$,
      679    24342                           RTN = "LCONST$ -> LCNST.CONSTW.VAL(10)");
      680    24353    3     END;
      681    24354
      682    24355        /* Retention Desc */
      683    24356        %DESC_PRESET (@FIELD = RETENTION$,
      684    24357                      @OFFSET = 11);
      685    24366
      686    24367        /* Catalog Desc */
      687    24368        %DESC_PRESET (@FIELD = CATALOG$,
      688    24369                      @OFFSET = 12);
      689    24378
      690    24379        /* Linage lines desc */
      691    24380        %DESC_PRESET (@FIELD = "LINAGE.NO_OF_LINES$",
      692    24381                      @OFFSET = 13);
      693    24390
      694    24391        /* Footing desc */
      695    24392        %DESC_PRESET (@FIELD = "LINAGE.FOOTING$",
      696    24393                      @OFFSET = 14);
      697    24402
      698    24403        /* Top desc */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:29   
      699    24404        %DESC_PRESET (@FIELD = "LINAGE.TOP$",
      700    24405                      @OFFSET = 15);
      701    24414
      702    24415        /* Bottom desc */
      703    24416        %DESC_PRESET (@FIELD = "LINAGE.BOTTOM$",
      704    24417                      @OFFSET = 16);
      705    24426
      706    24427        /* Linage */
      707    24428    2   LCONST$ -> LCNST.CONSTW.VAL(17) = 0;
      708    24429
      709    24430        /* Footing */
      710    24431    2   LCONST$ -> LCNST.CONSTW.VAL(18) = 0;
      711    24432
      712    24433        /* Top */
      713    24434    2   LCONST$ -> LCNST.CONSTW.VAL(19) = 0;
      714    24435
      715    24436        /* Bottom */
      716    24437    2   LCONST$ -> LCNST.CONSTW.VAL(20) = 0;
      717    24438
      718    24439        /* Last IO */
      719    24440    2   LCONST$ -> LCNST.CONSTW.VAL(21) = 0;
      720    24441
      721    24442        /* File status */
      722    24443    2   LCONST$ -> LCNST.CONSTW.VAL(22) = 0;
      723    24444
      724    24445        /* Relative Key */
      725    24446    2   LCONST$ -> LCNST.CONSTW.VAL(23) = 0;
      726    24447
      727    24448        /* Relative desc */
      728    24449        %DESC_PRESET (@FIELD = RELATIVE_KEY$,
      729    24450                      @OFFSET = 24);
      730    24459
      731    24460        /* Record key len */
      732    24461    2   IF FILE$ -> FILE_LTS.RECORD_KEY$ = ADDR(NIL) THEN
      733    24462    2     LCONST$ -> LCNST.CONSTW.VAL (25) = 0;
      734    24463    2   ELSE
      735    24464    3     DO;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:30   
      736    24465            %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.RECORD_KEY$,
      737    24466                           RTN = "LCONST$ -> LCNST.CONSTW.VAL(25)");
      738    24477    3     END;
      739    24478
      740    24479        /* Attribute bits */
      741    24480    2   CALL SET_ATTR_BITS (FILE$,
      742    24481    2                       LCONST$ -> LCNST.CONSTW.VAL(26));
      743    24482
      744    24483        /* Preset the constant Fab area */
      745    24484    2   CALL PRESET( FAB_C$, FAB_CONST$ );
      746    24485
      747    24486    2   END INIT_FAB_CONST;
      748    24487        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:31   
      749    24488    1   INIT_FAB_VAR : PROC;
      750    24489
      751    24490    2     DCL PROC$ PTR;
      752    24491
      753    24492        /* Pad char */
      754    24493        %PTR_PRESET (@FIELD = PAD_CHAR$,
      755    24494                     @OFFSET = 0);
      756    24881
      757    24882        /* IO status */
      758    24883        %PTR_PRESET (@FIELD = FILE_STATUS$,
      759    24884                     @OFFSET = 1);
      760    25271
      761    25272        /* Shared Alt Key */
      762    25273    2   IF FILE$ -> FILE_LTS.ORGANIZATION = %INDEXED  THEN
      763    25274    2     CALL BUILD_SHARED_ALT_KEY;                    /*#24102*/
      764    25275
      765    25276        /* Depending */
      766    25277        %PTR_PRESET (@FIELD = LABEL_EXIT$,
      767    25278                     @OFFSET = 3);
      768    25665
      769    25666        /* Label Recs */
      770    25667        %PTR_PRESET (@FIELD = LABEL_RECORDS$,
      771    25668                     @OFFSET = 4);
      772    26055
      773    26056        /* File id */
      774    26057        %PTR_PRESET (@FIELD = FILE_ID$,
      775    26058                     @OFFSET = 5);
      776    26445
      777    26446        /* Retention */
      778    26447        %PTR_PRESET (@FIELD = RETENTION$,
      779    26448                     @OFFSET = 6);
      780    26835
      781    26836        /* Catalog */
      782    26837        %PTR_PRESET (@FIELD = CATALOG$,
      783    26838                     @OFFSET = 7);
      784    27225
      785    27226        /* Linage lines */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:32   
      786    27227        %PTR_PRESET (@FIELD = LINAGE.NO_OF_LINES$,
      787    27228                     @OFFSET = 8);
      788    27615
      789    27616        /* Footing */
      790    27617        %PTR_PRESET (@FIELD = LINAGE.FOOTING$,
      791    27618                     @OFFSET = 9);
      792    28005
      793    28006        /* Top */
      794    28007        %PTR_PRESET (@FIELD = LINAGE.TOP$,
      795    28008                     @OFFSET = 10);
      796    28395
      797    28396        /* Bottom */
      798    28397        %PTR_PRESET (@FIELD = LINAGE.BOTTOM$,
      799    28398                     @OFFSET = 11);
      800    28785
      801    28786        /* Linage Counter */
      802    28787    2   IF FILE$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = ADDR(NIL) THEN
      803    28788          %PTR_PRESET(@FIELD = LINAGE.NO_OF_LINES$,
      804    28789                      @OFFSET = 12);
      805    29176    2   ELSE
      806    29177    3     DO;
      807    29178    3       ROP$$ = FILE$ -> FILE_LTS.ST$ -> FD.QLT$ -> QLT.SON;
      808    29179    4       DO WHILE (ROP$$ -> QLT.BROTHER ~= ADDR(NIL));
      809    29180    4         ROP$$ = ROP$$ -> QLT.BROTHER;
      810    29181    4       END;
      811    29182    3       CALL PTR_SET( FAB_V$, ROP$$ -> QLT.ST$, 12 );
      812    29183    3     END;
      813    29184
      814    29185        /* Buffer */
      815    29186        %PTR_PRESET(@FIELD = ST$,
      816    29187                    @OFFSET = 13);
      817    29574
      818    29575        /* Relative key */
      819    29576        %PTR_PRESET (@FIELD = RELATIVE_KEY$,
      820    29577                     @OFFSET = 14);
      821    29964
      822    29965        /* Record key */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:33   
      823    29966        %PTR_PRESET (@FIELD = RECORD_KEY$,
      824    29967                     @OFFSET = 15);
      825    30354
      826    30355        /* Alt key */
      827    30356    2   CALL NEW_ALT_KEYS (FAB_V$,
      828    30357    2                     FILE$,
      829    30358    2                     16);
      830    30359
      831    30360        /* Use block */
      832    30361    2   CALL NEW_USE_BLOCK (FAB_V$,
      833    30362    2                       FILE$,
      834    30363    2                       17);
      835    30364
      836    30365        /* Use proc */
      837    30366    2   IF FILE$ -> FILE_LTS.USE_PROC_LABEL_EPTR = EPTR_NIL_VAL   THEN
      838    30367    2   NIL_USE:
      839    30368    3     DO;
      840    30369    3       IF (FILE$ -> FILE_LTS.B.EXTERNAL OR FILE$ -> FILE_LTS.B.BLOCK) AND
      841    30370    3           NOT COMCOM.OB.MAIN_PROG THEN
      842    30371    4         DO;
      843    30372    4           IF COMCOM.OB.SUB THEN EXIT NIL_USE;
      844    30373    4           PROC$ = FILE$ -> FILE_LTS.ST$ -> FD.PROC$;
      845    30374    5           DO WHILE PROC$ -> PROC_.FATHER ~= ADDR (NIL);
      846    30375    5             PROC$ = PROC$ -> PROC_.FATHER;
      847    30376    5           END;
      848    30377    4           IF PROC$ -> PROC_.PROC_DEF$ -> PROC_DEF.ARGLIST$ ~= ADDR (NIL) THEN
      849    30378    4             EXIT NIL_USE;
      850    30379    4         END;
      851    30380    3       MKCN.CON = EPTR_NIL;
      852    30381    3       CALL Z8AC$MAKE_CONST( EPTR_NIL_CONST$ );
      853    30382
      854    30383            %NEW_ILL( @ID = %PREOFF,
      855    30384                      @LOP = FAB_V$,
      856    30385                      @OFFSET = 18,
      857    30386                      @N = 1,
      858    30387                      @ROP = EPTR_NIL_CONST$ -> ETT.LOP );
      859    30766    3     END; /* NIL_USE */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:34   
      860    30767    2   ELSE
      861    30768          %PTR_PRESET (@FIELD = USE_PROC_LABEL$,
      862    30769                       @OFFSET = 18);
      863    31156
      864    31157    2   END INIT_FAB_VAR;
      865    31158        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:35   
      866    31159             /*
      867    31160                      Main Procedure
      868    31161             */
      869    31162
      870    31163    1        IF FILE$ -> FILE_LTS.ST$ -> ST.ID ~= %FD    OR   /*  NOT SORT  */
      871    31164    1             FILE$ -> FILE_LTS.FAB$ -> SCALAR.B.FAB_FIB_BUILT    THEN
      872    31165    1           RETURN;
      873    31166
      874    31167             %SET_PHASE_1_POSITION (@LINE = FILE$ -> FILE_LTS.ST$ -> FD.LINE_NO,
      875    31168                                    @COLUMN = 0,
      876    31169                                    @TYPE   = %S_TYPE_VALUE_IS);
      877    31558
      878    31559    1        IF FILE$ -> FILE_LTS.DCB_DNT$ = ADDR(NIL)  THEN   /*#34313*/
      879    31560    1          F_DNT$ = FILE$ -> FILE_LTS.ST$ -> FD.DNT$;
      880    31561    1        ELSE
      881    31562    1          F_DNT$ = FILE$ -> FILE_LTS.DCB_DNT$;
      882    31563
      883    31564    1        FAB$ = FILE$ -> FILE_LTS.FAB$;
      884    31565    1        FAB$ -> SCALAR.B.FAB_FIB_BUILT = %TRUE;
      885    31566
      886    31567
      887    31568             /* Build and initialize the constant portion of the FAB */
      888    31569
      889    31570    1        FAB_C$ = FAB$ -> SCALAR.QLT$ -> QLT.SON -> QLT.ST$;
      890    31571
      891    31572    1        CALL INIT_FAB_CONST;
      892    31573
      893    31574
      894    31575             /* Build the Length_read and DCBNUM fields of the Fab;
      895    31576                These fields have explicit symbol table items so that
      896    31577                    they can be referenced by the compiler
      897    31578             */
      898    31579
      899    31580    1        CALL PRESET( FILE$ -> FILE_LTS.LENGTH_READ$, COMCOM.VALUE_0 -> ETT.LOP);
      900    31581
      901    31582    1        DCBNUM$ = FILE$ -> FILE_LTS.LENGTH_READ$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.
             31582                 ST$;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:36   
      902    31583
      903    31584    1        CALL NEW_DCB (UNIT_RECORD,
      904    31585    1                      FILE$,
      905    31586    1                      DCBNUM$);
      906    31587
      907    31588             /* Build the variable portion of the FAB;  This portion is
      908    31589                    initialized by PRESET/PTR_SET ILL items */
      909    31590
      910    31591    1        FAB_V$ = DCBNUM$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$;
      911    31592
      912    31593    1        CALL INIT_FAB_VAR;
      913    31594
      914    31595    1        CALL INIT_DCB (UNIT_RECORD, FILE$, DCBNUM$);
      915    31596
      916    31597             /* finish up */
      917    31598
      918    31599    1   END Z9EW$IO_INTERFACE;
      919    31600        %EOD;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:37   
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z9EW$IO_INTERFACE.

   Procedure Z9EW$IO_INTERFACE requires 2048 words for executable code.
   Procedure Z9EW$IO_INTERFACE requires 120 words of local(AUTO) storage.
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:38   

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:39   

 Object Unit name= Z9EW$IO_INTERFACE                          File name= Z9EW.:Z8A6TOU
 UTS= AUG 09 '97 13:51:14.40 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  LTS$
    3  LblCom even  none     5      5  LTS_
    4  LblCom even  none     1      1  DNT$
    5  LblCom even  none     5      5  DNT_
    6  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    7  LblCom even  none     1      1  DNT_OF_1$
    8  LblCom even  none     1      1  ST$
    9  LblCom even  none     5      5  ST_
   10  LblCom even  none     1      1  ILL$
   11  LblCom even  none     5      5  ILL_
   12  LblCom even  none     1      1  ETT$
   13  LblCom even  none     1      1  HEAD_ETT$
   14  LblCom even  none   512   1000  ETT_BUCKETS
   15  LblCom even  none     5      5  ETT_
   16  LblCom even  none     2      2  MKCN
   17  LblCom even  none     1      1  QLT$
   18  LblCom even  none     1      1  PREV_01_QLT$
   19  LblCom even  none     5      5  QLT_
   20  LblCom even  none    90    132  LEX_SYMBOL
   21  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   22  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   23  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   24  RoData even  UTS     47     57  Z9EW$IO_INTERFACE
   25   DCB   even  none     0      0  DCB_TEMPLATE
   26   Data  even  none    60     74  Z9EW$IO_INTERFACE
   27   Proc  even  none  2048   4000  Z9EW$IO_INTERFACE
   28  RoData even  none    68    104  Z9EW$IO_INTERFACE
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:40   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    27      0   yes            yes      Std        1  Z9EW$IO_INTERFACE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std      12 Z8AE$ERROR
         yes           Std       6 Z8CU$BUILD_AND_LINK
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       0 Z8AH$SEARCH_
 yes     yes           Std       5 Z9EO$RUNTIME_DESC_FROM_ETT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  COMCOM                           r    LTS_STEP
r    ILL_STEP                              O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                               DCB_TEMPLATE
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:41   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:42   


        1        1        /*M* Z9EW - System dependant I/O routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z9EW$IO_INTERFACE: PROC (FILE$);

      7 27 000000   000000 700200 xent  Z9EW$IO_INT* TSX0  ! X66_AUTO_1
        27 000001   000170 000001                    ZERO    120,1
        27 000002   003643 710000 27                 TRA     s:31163

        8        8         /*P*
        9        9             NAME: Z9EW$IO_INTERFACE
       10       10             PURPOSE: To create the FAB for CP6 I/O.  This extracts
       11       11               information from the FILE_LTS and creates the FAB via
       12       12               scalar/qlt items and presets.
       13       13         */
       14       14
       15       15
       16       16             %INCLUDE Z8A_SYS_FILE;
       17     6291
       18     6292             %EQU PHASE = 1;
       19     6293
       20     6294             %INCLUDE Z8A_DEFC;
       21     6362             %INCLUDE Z8A_SUPP_MAC;
       22     8762             %INCLUDE Z8A_COMCOM;
       23     9412             %INCLUDE Z8A_LTS;
       24    11489             %INCLUDE Z8A_DNT;
       25    11710             %INCLUDE Z8A_ST;
       26    15369             %INCLUDE Z8A_TYPES;
       27    15543             %INCLUDE Z8A_ILL;
       28    16236             %INCLUDE Z8A_ETT;
       29    16537             %INCLUDE Z8A_IO_EQUS;
       30    16660             %INCLUDE Z8A_ERR_NUMS;
       31    17424             %INCLUDE Z8A_MKCN;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:43   
       32    17441             %INCLUDE Z8A_QLT;
       33    17547             %INCLUDE X9A_FAB;
       34    17734             %INCLUDE X9A_IO;
       35    17884
       36    17885             %INCLUDE Z8E_STACKS;
       37    20151             %INCLUDE Z8E_O1COM;
       38    20912             %INCLUDE Z8E_MACROS;
       39    21587             %INCLUDE Z8E_STATEMNT;
       40    21656
       41    21657    1        DCL Z8AH$SEARCH_         ENTRY;
       42    21658    1        DCL Z8CU$BUILD_AND_LINK  ENTRY (6);
       43    21659    1        DCL Z8AC$MAKE_CONST      ENTRY (1);
       44    21660    1        DCL Z8AE$ERROR           ENTRY (12);
       45    21661    1        DCL Z8DC$SIZE_CALC       ENTRY (2);
       46    21662    1        DCL Z8DS$SPAN__CALC       ENTRY (1);
       47    21663    1        DCL Z9EO$RUNTIME_DESC_FROM_ETT  ENTRY (5) ALTRET;
       48    21664
       49    21665    1        DCL 1 FAB_CONST_LENGTH BASED ALIGNED,
       50    21666                   %FAB_CONST (@ENDING = TRUE);
       51    21731
       52    21732    1        DCL 1 FAB_VAR_LENGTH BASED ALIGNED,
       53    21733                   %FAB_VARIABLE ;
       54    21784
       55    21785    1        DCL 1 DESC ALIGNED,
       56    21786                   %DESCRIPTOR (LVL = 2, ENDING = YES);
       57    21814
       58    21815             %DCL_FAB (@NAME = FAB);
       59    21937             %XSA_PARAM (FPTN = XSA_PARAM, LVL = 1, STCLASS = CONSTANT);
       60    21967
       61    21968    1        DCL LEN           SBIN;
       62    21969    1        DCL F_DNT$        PTR;
       63    21970    1        DCL ALT_KEY$      PTR;
       64    21971    1        DCL MAX_BOUND     UBIN;
       65    21972    1        DCL ROP$$         PTR;
       66    21973    1        DCL FAB$          PTR; /* Ptr to 01 FAB (st) */
       67    21974    1        DCL USE_BLOCK$    PTR;
       68    21975    1        DCL DCBNUM$       PTR; /* Ptr to 02 DCBNUM (st) */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:44   
       69    21976    1        DCL FAB_C$        PTR;
       70    21977    1        DCL FAB_V$        PTR;
       71    21978    1        DCL FILE$         PTR;
       72    21979    1        DCL DNT$$         PTR;
       73    21980    1        DCL UNIT_RECORD   BIT (1) ALIGNED;
       74    21981
       75    21982    1        DCL EPTR_NIL_VAL  EPTR CONSTANT INIT (ENTADDR(NIL));
       76    21983    1        DCL EPTR_NIL REDEF EPTR_NIL_VAL  SBIN WORD;
       77    21984    1        DCL EPTR_NIL_CONST$              PTR;
       78    21985        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:45   
       79    21986        %MACRO SBIN_PRESET (@FIELD = );
       80    21987
       81    21988               DO;
       82    21989                 CALL NEW_SBIN_CONST (FILE$ -> FILE_LTS.@FIELD, ROP$$);
       83    21990                 CALL PRESET (FAB_V$, ROP$$);
       84    21991               END;
       85    21992
       86    21993        %MEND;
       87    21994        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:46   
       88    21995        %MACRO DESC_PRESET (@FIELD = , @OFFSET =0);
       89    21996
       90    21997             IF FILE$ -> FILE_LTS.@FIELD = ADDR(NIL) THEN
       91    21998               LCONST$ -> LCNST.CONSTW.VAL(@OFFSET) = 0;
       92    21999             ELSE
       93    22000               DO;
       94    22001                 CALL Z9EO$RUNTIME_DESC_FROM_ETT (FILE$ -> FILE_LTS.@FIELD,
       95    22002                                                  LCONST$ -> LCNST.CONSTW.VAL(@OFFSET));
       96    22003               END;
       97    22004
       98    22005        %MEND;
       99    22006        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:47   
      100    22007        %MACRO PTR_PRESET (@FIELD = , @OFFSET =0);
      101    22008
      102    22009        %LSET FIELDN = CHARTEXT(CONCAT('FILE$ -> FILE_LTS.',TEXTCHAR(@FIELD)));
      103    22010               DO;
      104    22011                 %NEW_ILL (@ID = %PTR_SET,
      105    22012                           @LOP = FAB_V$,
      106    22013                           @ROP = %FIELDN,
      107    22014                           @OFFSET = @OFFSET);
      108    22015               END;
      109    22016
      110    22017        %MEND;
      111    22018        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:48   
      112    22019    1   PTR_SET: PROC (LOP, ROP, OFFSET);

  22019 27 000003   200152 741300       PTR_SET      STX1  ! VLP_ALT_KEY+2,,AUTO

      113    22020
      114    22021    2        DCL LOP           PTR;
      115    22022    2        DCL ROP           PTR;
      116    22023    2        DCL OFFSET        SBIN;
      117    22024
      118    22025
      119    22026               %NEW_ILL (@ID    = %PTR_SET,
      120    22027                         @LOP   = LOP,
      121    22028                         @ROP   = ROP,
      122    22029                         @OFFSET = OFFSET);

  22249 27 000004   000003 236000 28                 LDQ     3
        27 000005   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000006   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000007   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 000010   000004 236000 28                 LDQ     4
        27 000011   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 000012   000006 237000 28                 LDAQ    6
        27 000013   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 000014   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 000015   000000 631400 28                 EPPR1   0
        27 000016   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 000017   000000 011000                    NOP     0

  22253 27 000020   200155 470500                    LDP0    @OFFSET,,AUTO
        27 000021   000000 720100                    LXL0    0,,PR0
        27 000022   000000 471400 10                 LDP1    ILL$
        27 000023   100000 440100                    SXL0    0,,PR1

  22255 27 000024   200153 471500                    LDP1    @LOP,,AUTO
        27 000025   100000 236100                    LDQ     0,,PR1
        27 000026   000000 473400 10                 LDP3    ILL$
        27 000027   300001 756100                    STQ     1,,PR3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:49   

  22256 27 000030   200154 474500                    LDP4    @ROP,,AUTO
        27 000031   400000 236100                    LDQ     0,,PR4
        27 000032   300002 756100                    STQ     2,,PR3

      123    22408
      124    22409    2   END PTR_SET;

  22409 27 000033   200152 221300                    LDX1  ! VLP_ALT_KEY+2,,AUTO
        27 000034   000001 702211                    TSX2  ! 1,X1

      125    22410        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:50   
      126    22411    1   PRESET: PROC (LOP, ROP);

  22411 27 000035   200154 741300       PRESET       STX1  ! @ROP,,AUTO

      127    22412
      128    22413    2        DCL LOP           PTR;
      129    22414    2        DCL ROP           PTR;
      130    22415
      131    22416
      132    22417               %NEW_ILL (@ID    = %PRESET,
      133    22418                         @LOP   = LOP,
      134    22419                         @ROP   = ROP);

  22639 27 000036   000003 236000 28                 LDQ     3
        27 000037   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000040   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000041   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 000042   000004 236000 28                 LDQ     4
        27 000043   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 000044   000012 237000 28                 LDAQ    10
        27 000045   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 000046   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 000047   000000 631400 28                 EPPR1   0
        27 000050   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 000051   000000 011000                    NOP     0

  22641 27 000052   000000 220003                    LDX0    0,DU
        27 000053   000000 470400 10                 LDP0    ILL$
        27 000054   000000 440100                    SXL0    0,,PR0

  22645 27 000055   200155 470500                    LDP0    @LOP,,AUTO
        27 000056   000000 236100                    LDQ     0,,PR0
        27 000057   000000 471400 10                 LDP1    ILL$
        27 000060   100001 756100                    STQ     1,,PR1

  22646 27 000061   200156 473500                    LDP3    @ROP,,AUTO
        27 000062   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:51   
        27 000063   100002 756100                    STQ     2,,PR1

      135    22798
      136    22799    2   END PRESET;

  22799 27 000064   200154 221300                    LDX1  ! @ROP,,AUTO
        27 000065   000001 702211                    TSX2  ! 1,X1

      137    22800        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:52   
      138    22801    1   NEW_SBIN_CONST: PROC (NUM, RETURN$);

  22801 27 000066   200154 741300       NEW_SBIN_CO* STX1  ! @ROP,,AUTO

      139    22802
      140    22803    2        DCL NUM           SBIN;
      141    22804    2        DCL RETURN$       PTR;
      142    22805
      143    22806
      144    22807    2        MKCN.CON = NUM;

  22807 27 000067   200155 470500                    LDP0    @NUM,,AUTO
        27 000070   000000 235100                    LDA     0,,PR0
        27 000071   000000 755000 16                 STA     MKCN

      145    22808    2        CALL Z8AC$MAKE_CONST (RETURN$);

  22808 27 000072   200156 630500                    EPPR0   @RETURN$,,AUTO
        27 000073   000011 631400 28                 EPPR1   9
        27 000074   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        27 000075   000000 011000                    NOP     0

      146    22809
      147    22810    2        RETURN$ = RETURN$ -> ETT.LOP;

  22810 27 000076   200156 470500                    LDP0    @RETURN$,,AUTO
        27 000077   000000 471500                    LDP1    0,,PR0
        27 000100   100001 236100                    LDQ     1,,PR1
        27 000101   000000 756100                    STQ     0,,PR0

      148    22811
      149    22812    2   END NEW_SBIN_CONST;

  22812 27 000102   200154 221300                    LDX1  ! @ROP,,AUTO
        27 000103   000001 702211                    TSX2  ! 1,X1

      150    22813        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:53   
      151    22814    1   DEVICE_TO_CP6_DEVICE: PROC (RETURN_VAL, UNIT_RECORD);

  22814 27 000104   200152 741300       DEVICE_TO_C* STX1  ! VLP_ALT_KEY+2,,AUTO

      152    22815
      153    22816    2        DCL RETURN_VAL       SBIN;
      154    22817    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      155    22818
      156    22819
      157    22820    2        UNIT_RECORD = TRUE;

  22820 27 000105   400000 236003                    LDQ     -131072,DU
        27 000106   200154 470500                    LDP0    @UNIT_RECORD,,AUTO
        27 000107   000000 756100                    STQ     0,,PR0

      158    22821
      159    22822    3        DO SELECT (FILE$ -> FILE_LTS.ASSIGN$ ->

  22822 27 000110   200003 471500                    LDP1    @FILE$,,AUTO
        27 000111   100000 473500                    LDP3    0,,PR1
        27 000112   300004 474500                    LDP4    4,,PR3
        27 000113   400002 475500                    LDP5    2,,PR4
        27 000114   500004 220100                    LDX0    4,,PR5
        27 000115   040000 106540                    CMPC    fill='040'O
        27 000116   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000117   000017 000011 24                 ADSC9   EPTR_NIL_VAL+1           cn=0,n=9
        27 000120   000135 602000 27                 TNC     s:22822+21
        27 000121   000203 600000 27                 TZE     s:22837
        27 000122   040000 106540                    CMPC    fill='040'O
        27 000123   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000124   000022 000006 24                 ADSC9   EPTR_NIL_VAL+4           cn=0,n=6
        27 000125   000130 602000 27                 TNC     s:22822+16
        27 000126   000207 600000 27                 TZE     s:22840
        27 000127   000227 710000 27                 TRA     s:22852
        27 000130   040000 106540                    CMPC    fill='040'O
        27 000131   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000132   000024 000005 24                 ADSC9   EPTR_NIL_VAL+6           cn=0,n=5
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:54   
        27 000133   000227 601000 27                 TNZ     s:22852
        27 000134   000213 710000 27                 TRA     s:22843
        27 000135   040000 106540                    CMPC    fill='040'O
        27 000136   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000137   000026 000015 24                 ADSC9   EPTR_NIL_VAL+8           cn=0,n=13
        27 000140   000147 602000 27                 TNC     s:22822+31
        27 000141   000166 600000 27                 TZE     s:22826
        27 000142   040000 106540                    CMPC    fill='040'O
        27 000143   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000144   000017 000007 24                 ADSC9   EPTR_NIL_VAL+1           cn=0,n=7
        27 000145   000227 601000 27                 TNZ     s:22852
        27 000146   000200 710000 27                 TRA     s:22834
        27 000147   040000 106540                    CMPC    fill='040'O
        27 000150   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000151   000032 000013 24                 ADSC9   EPTR_NIL_VAL+12          cn=0,n=11
        27 000152   000161 602000 27                 TNC     s:22822+41
        27 000153   000217 600000 27                 TZE     s:22846
        27 000154   040000 106540                    CMPC    fill='040'O
        27 000155   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000156   000035 000004 24                 ADSC9   EPTR_NIL_VAL+15          cn=0,n=4
        27 000157   000227 601000 27                 TNZ     s:22852
        27 000160   000173 710000 27                 TRA     s:22830
        27 000161   040000 106540                    CMPC    fill='040'O
        27 000162   500004 400010                    ADSC9   4,,PR5                   cn=2,n=*X0
        27 000163   000036 000012 24                 ADSC9   EPTR_NIL_VAL+16          cn=0,n=10
        27 000164   000227 601000 27                 TNZ     s:22852
        27 000165   000223 710000 27                 TRA     s:22849

      160    22823    3                   LTS_PTR_ARRAY.P$ (0) -> DNT.TEXT.NAME);
      161    22824
      162    22825    3          SELECT (%MAGNETIC_TAPE);

      163    22826    3            RETURN_VAL = %CP6_MAGNETIC_TAPE;

  22826 27 000166   000002 235007                    LDA     2,DL
        27 000167   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000170   600000 755100                    STA     0,,PR6
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:55   

      164    22827    3            UNIT_RECORD = FALSE;

  22827 27 000171   000000 450100                    STZ     0,,PR0
        27 000172   000240 710000 27                 TRA     s:22858

      165    22828
      166    22829    3          SELECT (%DISK);

      167    22830    3            RETURN_VAL = %CP6_DISK;

  22830 27 000173   000005 235007                    LDA     5,DL
        27 000174   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000175   600000 755100                    STA     0,,PR6

      168    22831    3            UNIT_RECORD = FALSE;

  22831 27 000176   000000 450100                    STZ     0,,PR0
        27 000177   000240 710000 27                 TRA     s:22858

      169    22832
      170    22833    3          SELECT (%PRINTER);

      171    22834    3            RETURN_VAL = %CP6_PRINTER;

  22834 27 000200   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000201   600000 450100                    STZ     0,,PR6
        27 000202   000240 710000 27                 TRA     s:22858

      172    22835
      173    22836    3          SELECT (%PRINTER_F);

      174    22837    3            RETURN_VAL = %CP6_PRINTER_F;

  22837 27 000203   000001 235007                    LDA     1,DL
        27 000204   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000205   600000 755100                    STA     0,,PR6
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:56   
        27 000206   000240 710000 27                 TRA     s:22858

      175    22838
      176    22839    3          SELECT (%SYSOUT);

      177    22840    3            RETURN_VAL = %CP6_SYSOUT;

  22840 27 000207   000003 235007                    LDA     3,DL
        27 000210   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000211   600000 755100                    STA     0,,PR6
        27 000212   000240 710000 27                 TRA     s:22858

      178    22841
      179    22842    3          SELECT (%SYSIN);

      180    22843    3            RETURN_VAL = %CP6_SYSIN;

  22843 27 000213   000004 235007                    LDA     4,DL
        27 000214   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000215   600000 755100                    STA     0,,PR6
        27 000216   000240 710000 27                 TRA     s:22858

      181    22844
      182    22845    3          SELECT (%CARD_READER);

      183    22846    3            RETURN_VAL = %CP6_CARD_READER;

  22846 27 000217   000007 235007                    LDA     7,DL
        27 000220   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000221   600000 755100                    STA     0,,PR6
        27 000222   000240 710000 27                 TRA     s:22858

      184    22847
      185    22848    3          SELECT (%CARD_PUNCH);

      186    22849    3            RETURN_VAL = %CP6_CARD_PUNCH;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:57   
  22849 27 000223   000006 235007                    LDA     6,DL
        27 000224   200153 476500                    LDP6    @RETURN_VAL,,AUTO
        27 000225   600000 755100                    STA     0,,PR6
        27 000226   000240 710000 27                 TRA     s:22858

      187    22850
      188    22851    3          SELECT (ELSE);

      189    22852    3            CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  22852 27 000227   000015 630400 28                 EPPR0   13
        27 000230   000011 631400 28                 EPPR1   9
        27 000231   000000 701000 xent               TSX1    Z8AE$ERROR
        27 000232   000000 011000                    NOP     0

      190    22853    3            RETURN_VAL = %CP6_DISK;

  22853 27 000233   000005 235007                    LDA     5,DL
        27 000234   200153 470500                    LDP0    @RETURN_VAL,,AUTO
        27 000235   000000 755100                    STA     0,,PR0

      191    22854    3            UNIT_RECORD = FALSE;

  22854 27 000236   200154 471500                    LDP1    @UNIT_RECORD,,AUTO
        27 000237   100000 450100                    STZ     0,,PR1

      192    22855
      193    22856    3        END; /* Select */

      194    22857
      195    22858    2   END DEVICE_TO_CP6_DEVICE;

  22858 27 000240   200152 221300                    LDX1  ! VLP_ALT_KEY+2,,AUTO
        27 000241   000001 702211                    TSX2  ! 1,X1

      196    22859        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:58   
      197    22860    1   ORG_TO_CP6_ORG: PROC (UNIT_RECORD, RETURN_VAL);

  22860 27 000242   200152 741300       ORG_TO_CP6_* STX1  ! VLP_ALT_KEY+2,,AUTO

      198    22861
      199    22862    2        DCL RETURN_VAL       SBIN;
      200    22863    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      201    22864
      202    22865
      203    22866    3        DO CASE (FILE$ -> FILE_LTS.ORGANIZATION);

  22866 27 000243   200003 470500                    LDP0    @FILE$,,AUTO
        27 000244   000000 471500                    LDP1    0,,PR0
        27 000245   100006 235100                    LDA     6,,PR1
        27 000246   000005 115007                    CMPA    5,DL
        27 000247   000251 602005 27                 TNC     s:22866+6,AL
        27 000250   000314 710000 27                 TRA     s:22887
        27 000251   000314 710000 27                 TRA     s:22887
        27 000252   000256 710000 27                 TRA     s:22869
        27 000253   000310 710000 27                 TRA     s:22884
        27 000254   000304 710000 27                 TRA     s:22881
        27 000255   000300 710000 27                 TRA     s:22878

      204    22867
      205    22868    3          CASE (%SEQUENTIAL);

      206    22869    3            IF UNIT_RECORD THEN

  22869 27 000256   200153 473500                    LDP3    @UNIT_RECORD,,AUTO
        27 000257   300000 234100                    SZN     0,,PR3
        27 000260   000265 605000 27                 TPL     s:22872

      207    22870    3              RETURN_VAL = %CP6_UR;

  22870 27 000261   000004 236007                    LDQ     4,DL
        27 000262   200154 474500                    LDP4    @RETURN_VAL,,AUTO
        27 000263   400000 756100                    STQ     0,,PR4
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:59   
        27 000264   000323 710000 27                 TRA     s:22892

      208    22871    3            ELSE
      209    22872    3              IF FILE$ -> FILE_LTS.B.EBCDIC THEN

  22872 27 000265   100017 236100                    LDQ     15,,PR1
        27 000266   004000 316007                    CANQ    2048,DL
        27 000267   000274 600000 27                 TZE     s:22875

      210    22873    3                RETURN_VAL = %CP6_FIXED;

  22873 27 000270   000017 235007                    LDA     15,DL
        27 000271   200154 474500                    LDP4    @RETURN_VAL,,AUTO
        27 000272   400000 755100                    STA     0,,PR4
        27 000273   000323 710000 27                 TRA     s:22892

      211    22874    3              ELSE
      212    22875    3                RETURN_VAL = %CP6_SEQUENTIAL;

  22875 27 000274   000001 235007                    LDA     1,DL
        27 000275   200154 474500                    LDP4    @RETURN_VAL,,AUTO
        27 000276   400000 755100                    STA     0,,PR4
        27 000277   000323 710000 27                 TRA     s:22892

      213    22876
      214    22877    3          CASE (%KEYED);

      215    22878    3            RETURN_VAL = %CP6_KEYED;

  22878 27 000300   000002 236007                    LDQ     2,DL
        27 000301   200154 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000302   300000 756100                    STQ     0,,PR3
        27 000303   000323 710000 27                 TRA     s:22892

      216    22879
      217    22880    3          CASE (%INDEXED);

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:60   
      218    22881    3            RETURN_VAL = %CP6_INDEXED;

  22881 27 000304   000006 236007                    LDQ     6,DL
        27 000305   200154 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000306   300000 756100                    STQ     0,,PR3
        27 000307   000323 710000 27                 TRA     s:22892

      219    22882
      220    22883    3          CASE (%RELATIVE);

      221    22884    3            RETURN_VAL = %CP6_RELATIVE;

  22884 27 000310   000005 236007                    LDQ     5,DL
        27 000311   200154 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000312   300000 756100                    STQ     0,,PR3
        27 000313   000323 710000 27                 TRA     s:22892

      222    22885
      223    22886    3          CASE (ELSE);

      224    22887    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  22887 27 000314   000015 630400 28                 EPPR0   13
        27 000315   000011 631400 28                 EPPR1   9
        27 000316   000000 701000 xent               TSX1    Z8AE$ERROR
        27 000317   000000 011000                    NOP     0

      225    22888    3            RETURN_VAL = %CP6_SEQUENTIAL;

  22888 27 000320   000001 235007                    LDA     1,DL
        27 000321   200154 470500                    LDP0    @RETURN_VAL,,AUTO
        27 000322   000000 755100                    STA     0,,PR0

      226    22889
      227    22890    3        END; /* Case */

      228    22891
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:61   
      229    22892    2   END ORG_TO_CP6_ORG;

  22892 27 000323   200152 221300                    LDX1  ! VLP_ALT_KEY+2,,AUTO
        27 000324   000001 702211                    TSX2  ! 1,X1

      230    22893        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:62   
      231    22894    1   ACCESS_TO_FAB_ACCESS: PROC (RETURN_VAL);

  22894 27 000325   200126 741300       ACCESS_TO_F* STX1  ! @ALT$+1,,AUTO

      232    22895
      233    22896    2        DCL RETURN_VAL       SBIN;
      234    22897
      235    22898
      236    22899    3        DO CASE (FILE$ -> FILE_LTS.ACCESS_MODE);

  22899 27 000326   200003 470500                    LDP0    @FILE$,,AUTO
        27 000327   000000 471500                    LDP1    0,,PR0
        27 000330   100011 235100                    LDA     9,,PR1
        27 000331   000004 115007                    CMPA    4,DL
        27 000332   000334 602005 27                 TNC     s:22899+6,AL
        27 000333   000354 710000 27                 TRA     s:22911
        27 000334   000354 710000 27                 TRA     s:22911
        27 000335   000344 710000 27                 TRA     s:22905
        27 000336   000340 710000 27                 TRA     s:22902
        27 000337   000350 710000 27                 TRA     s:22908

      237    22900
      238    22901    3          CASE (%RANDOM_ACCESS);

      239    22902    3            RETURN_VAL = %FAB_RANDOM_ACCESS;

  22902 27 000340   000003 236007                    LDQ     3,DL
        27 000341   200127 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000342   300000 756100                    STQ     0,,PR3
        27 000343   000363 710000 27                 TRA     s:22916

      240    22903
      241    22904    3          CASE (%SEQUENTIAL_ACCESS);

      242    22905    3            RETURN_VAL = %FAB_SEQUENTIAL_ACCESS;

  22905 27 000344   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:63   
        27 000345   200127 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000346   300000 756100                    STQ     0,,PR3
        27 000347   000363 710000 27                 TRA     s:22916

      243    22906
      244    22907    3          CASE (%DYNAMIC_ACCESS);

      245    22908    3            RETURN_VAL = %FAB_DYNAMIC_ACCESS;

  22908 27 000350   000002 236007                    LDQ     2,DL
        27 000351   200127 473500                    LDP3    @RETURN_VAL,,AUTO
        27 000352   300000 756100                    STQ     0,,PR3
        27 000353   000363 710000 27                 TRA     s:22916

      246    22909
      247    22910    3          CASE (ELSE);

      248    22911    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  22911 27 000354   000015 630400 28                 EPPR0   13
        27 000355   000011 631400 28                 EPPR1   9
        27 000356   000000 701000 xent               TSX1    Z8AE$ERROR
        27 000357   000000 011000                    NOP     0

      249    22912    3            RETURN_VAL = %FAB_SEQUENTIAL_ACCESS;

  22912 27 000360   000001 235007                    LDA     1,DL
        27 000361   200127 470500                    LDP0    @RETURN_VAL,,AUTO
        27 000362   000000 755100                    STA     0,,PR0

      250    22913
      251    22914    3        END; /* Case */

      252    22915
      253    22916    2   END ACCESS_TO_FAB_ACCESS;

  22916 27 000363   200126 221300                    LDX1  ! @ALT$+1,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:64   
        27 000364   000001 702211                    TSX2  ! 1,X1

      254    22917        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:65   
      255    22918    1   BUILD_SHARED_ALT_KEY : PROC;

  22918 27 000365   200124 741300       BUILD_SHARE* STX1  ! PROC$+1,,AUTO

      256    22919
      257    22920    2   DCL RETURN$    PTR;
      258    22921
      259    22922    2   IF FILE$ -> FILE_LTS.ALT_RECORD_KEY$ = ADDR(NIL)   OR

  22922 27 000366   200003 470500                    LDP0    @FILE$,,AUTO
        27 000367   000000 471500                    LDP1    0,,PR0
        27 000370   100016 236100                    LDQ     14,,PR1
        27 000371   000016 116000 28                 CMPQ    14
        27 000372   000376 600000 27                 TZE     s:22924
        27 000373   100011 235100                    LDA     9,,PR1
        27 000374   000002 115007                    CMPA    2,DL
        27 000375   000377 601000 27                 TNZ     s:22926

      260    22923    2           FILE$ -> FILE_LTS.ACCESS_MODE = %RANDOM_ACCESS  THEN
      261    22924    2     RETURN;

  22924 27 000376   000001 702211                    TSX2  ! 1,X1

      262    22925
      263    22926    2   CALL Z8CU$BUILD_AND_LINK( F_DNT$, 1, %TYA, 'SHARED', 6, RETURN$ );

  22926 27 000377   200125 633500                    EPPR3   RETURN$,,AUTO
        27 000400   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 000401   000023 236000 28                 LDQ     19
        27 000402   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 000403   000024 237000 28                 LDAQ    20
        27 000404   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 000405   000026 236000 28                 LDQ     22
        27 000406   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 000407   200105 631500                    EPPR1   F_DNT$,,AUTO
        27 000410   200160 451500                    STP1    @RETURN$+2,,AUTO
        27 000411   200160 630500                    EPPR0   @RETURN$+2,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:66   
        27 000412   000017 631400 28                 EPPR1   15
        27 000413   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        27 000414   000000 011000                    NOP     0

      264    22927    2   RETURN$ -> SCALAR.ADSC.N = 272;

  22927 27 000415   200125 470500                    LDP0    RETURN$,,AUTO
        27 000416   000420 236007                    LDQ     272,DL
        27 000417   000001 752103                    STCQ    1,'03'O,PR0

      265    22928
      266    22929    2   CALL PTR_SET( FAB_V$, RETURN$, 2 );

  22929 27 000420   000030 236000 28                 LDQ     24
        27 000421   200155 756100                    STQ     @NUM,,AUTO
        27 000422   200125 630500                    EPPR0   RETURN$,,AUTO
        27 000423   200154 450500                    STP0    @RETURN_VAL,,AUTO
        27 000424   200115 631500                    EPPR1   FAB_V$,,AUTO
        27 000425   200153 451500                    STP1    @UNIT_RECORD,,AUTO
        27 000426   000003 701000 27                 TSX1    PTR_SET
        27 000427   000000 011000                    NOP     0

      267    22930
      268    22931    2   END BUILD_SHARED_ALT_KEY;

  22931 27 000430   200124 221300                    LDX1  ! PROC$+1,,AUTO
        27 000431   000001 702211                    TSX2  ! 1,X1

      269    22932        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:67   
      270    22933    1   NEW_DCB: PROC (UNIT_RECORD, FILE_LTS$, DCB_NUM$);

  22933 27 000432   200122 741300       NEW_DCB      STX1  ! EPTR_NIL_CONST$+2,,AUTO

      271    22934
      272    22935
      273    22936    2        DCL Z8AT$CREATE_TEMPORARY       ENTRY (2);
      274    22937
      275    22938    2        DCL DCB_TEMPLATE  DCB;
      276    22939    2        DCL DCB$          PTR;
      277    22940
      278    22941             %F$DCB (DCBN = DCBN, BASED = "BASED (DCB$)");
      279    22998
      280    22999    2        DCL DCB_LEN       UBIN;
      281    23000    2        DCL DCB_LEN_NO_NAME UBIN;
      282    23001    2        DCL DCB_BASED     BASED CHAR (DCB_LEN);
      283    23002    2        DCL DCB_ADDR$     PTR;
      284    23003
      285    23004    2        DCL FILE_LTS$     PTR;
      286    23005    2        DCL P$            PTR;
      287    23006    2        DCL DCB_NUM$      PTR;
      288    23007    2        DCL DCB_NAME$     PTR;
      289    23008    2        DCL DCB_ST$       PTR STATIC;
      290    23009    2        DCL RTN$          PTR;
      291    23010    2        DCL STAR_NAME     CHAR (31);
      292    23011    2        DCL LENGTH        SBIN;
      293    23012    2        DCL DCB_VAR$      PTR;
      294    23013    2        DCL DCB_TEMPLATE$ PTR;
      295    23014    2        DCL UNIT_RECORD   BIT (1) ALIGNED;
      296    23015    2        DCL RETURN_VAL    SBIN;
      297    23016             %FPT_OPEN (FPTN = FAKE_OPEN, STCLASS = STATIC,
      298    23017                        REASSIGN = NO, SCRUB = YES,
      299    23018                        SETDCB = YES, DCB = DCB_TEMPLATE);
      300    23127        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:68   
      301    23128             %NEW_DCB (@ST$   = DCB_ST$,
      302    23129                       @R     = %BLOCK_,
      303    23130                       @SIZE  = 0,
      304    23131                       @DNT$  = F_DNT$);

  23135 27 000433   000002 236000 9                  LDQ     ST_+2
        27 000434   000013 036007                    ADLQ    11,DL
        27 000435   000003 116000 9                  CMPQ    ST_+3
        27 000436   000447 604000 27                 TMI     s:23137

  23136 27 000437   000031 236000 28                 LDQ     25
        27 000440   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000441   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000442   200161 450500                    STP0    @RETURN$+3,,AUTO
        27 000443   200161 630500                    EPPR0   @RETURN$+3,,AUTO
        27 000444   000011 631400 28                 EPPR1   9
        27 000445   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000446   000000 011000                    NOP     0

  23137 27 000447   000002 236000 9                  LDQ     ST_+2
        27 000450   000022 736000                    QLS     18
        27 000451   000001 036000 9                  ADLQ    ST_+1
        27 000452   000000 756000 26                 STQ     DCB_ST$

  23138 27 000453   000013 236007                    LDQ     11,DL
        27 000454   000002 056000 9                  ASQ     ST_+2

  23141 27 000455   001007 220003                    LDX0    519,DU
        27 000456   000000 470400 26                 LDP0    DCB_ST$
        27 000457   000000 740100                    STX0    0,,PR0

  23142 27 000460   000000 470400 26                 LDP0    DCB_ST$
        27 000461   003000 236007                    LDQ     1536,DL
        27 000462   000000 552110                    STBQ    0,'10'O,PR0

  23143 27 000463   000000 470400 26                 LDP0    DCB_ST$
        27 000464   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:69   
        27 000465   000000 552104                    STBQ    0,'04'O,PR0

  23144 27 000466   000000 221003                    LDX1    0,DU
        27 000467   000000 470400 26                 LDP0    DCB_ST$
        27 000470   000002 741100                    STX1    2,,PR0

  23145 27 000471   000133 722000 xsym               LXL2    COMCOM+91
        27 000472   000002 442100                    SXL2    2,,PR0

  23146 27 000473   000003 450100                    STZ     3,,PR0

  23147 27 000474   000016 236000 28                 LDQ     14
        27 000475   000004 756100                    STQ     4,,PR0

  23148 27 000476   200105 236100                    LDQ     F_DNT$,,AUTO
        27 000477   000006 756100                    STQ     6,,PR0

  23149 27 000500   000016 236000 28                 LDQ     14
        27 000501   000007 756100                    STQ     7,,PR0

  23153 27 000502   000016 236000 28                 LDQ     14
        27 000503   000012 756100                    STQ     10,,PR0

  23156 27 000504   000057 236000 xsym               LDQ     O1COM+47
        27 000505   000011 756100                    STQ     9,,PR0

  23157 27 000506   000057 236000 xsym               LDQ     O1COM+47
        27 000507   000016 116000 28                 CMPQ    14
        27 000510   000532 600000 27                 TZE     s:23194

  23161 27 000511   000057 471400 xsym               LDP1    O1COM+47
        27 000512   100001 473500                    LDP3    1,,PR1
        27 000513   300012 236100                    LDQ     10,,PR3
        27 000514   000016 116000 28                 CMPQ    14
        27 000515   000524 601000 27                 TNZ     s:23168

  23163 27 000516   000000 236000 26                 LDQ     DCB_ST$
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:70   
        27 000517   300011 756100                    STQ     9,,PR3

  23164 27 000520   000057 471400 xsym               LDP1    O1COM+47
        27 000521   100001 473500                    LDP3    1,,PR1
        27 000522   300012 756100                    STQ     10,,PR3

  23165 27 000523   000532 710000 27                 TRA     s:23194

  23168 27 000524   300012 474500                    LDP4    10,,PR3
        27 000525   000000 236000 26                 LDQ     DCB_ST$
        27 000526   400012 756100                    STQ     10,,PR4

  23169 27 000527   000057 471400 xsym               LDP1    O1COM+47
        27 000530   100001 473500                    LDP3    1,,PR1
        27 000531   300012 756100                    STQ     10,,PR3

      305    23193
      306    23194    2        COMCOM.BLOCKC = COMCOM.BLOCKC + 1;

  23194 27 000532   000144 054000 xsym               AOS     COMCOM+100

      307    23195    2        DCB_ST$ -> DCB_.COUNT = COMCOM.BLOCKC;

  23195 27 000533   000144 236000 xsym               LDQ     COMCOM+100
        27 000534   000000 552104                    STBQ    0,'04'O,PR0

      308    23196
      309    23197    2        O1COM.LAST_BLOCK$ -> VARIABLE.NEXT = DCB_ST$;

  23197 27 000535   000000 236000 26                 LDQ     DCB_ST$
        27 000536   000004 470400 xsym               LDP0    O1COM+4
        27 000537   000004 756100                    STQ     4,,PR0

      310    23198    2        O1COM.LAST_BLOCK$ = DCB_ST$;

  23198 27 000540   000004 756000 xsym               STQ     O1COM+4

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:71   
      311    23199
      312    23200    2        CALL PTR_SET( DCB_NUM$, DCB_ST$, 0 );

  23200 27 000541   000032 237000 28                 LDAQ    26
        27 000542   200154 757100                    STAQ    @RETURN_VAL,,AUTO
        27 000543   200125 236100                    LDQ     @DCB_NUM$,,AUTO
        27 000544   200153 756100                    STQ     @UNIT_RECORD,,AUTO
        27 000545   000003 701000 27                 TSX1    PTR_SET
        27 000546   000000 011000                    NOP     0

      313    23201
      314    23202    2        RETURN;

  23202 27 000547   200122 221300                    LDX1  ! EPTR_NIL_CONST$+2,,AUTO
        27 000550   000001 702211                    TSX2  ! 1,X1

      315    23203        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:72   
      316    23204    2   INIT_DCB : ENTRY (UNIT_RECORD, FILE_LTS$, DCB_NUM$);

  23204 27 000551   200122 741300       INIT_DCB     STX1  ! EPTR_NIL_CONST$+2,,AUTO

      317    23205
      318    23206    2        IF COMCOM.OB.OPTZ THEN   /* Compile time open, otherwise let runtime do it */

  23206 27 000552   000014 234000 xsym               SZN     COMCOM+12
        27 000553   001350 605000 27                 TPL     s:23474

      319    23207    3          DO;

      320    23208    3            CALL M$OPEN (FAKE_OPEN);

  23208 27 000554   000002 630400 26                 EPPR0   FAKE_OPEN
        27 000555   050000 713400                    CLIMB   open
        27 000556   410400 401760                    pmme    nvectors=18

      321    23209
      322    23210    3            DCB_ADDR$ = DCBADDR (DCBNUM (DCB_TEMPLATE));

  23210 27 000557   000000 236007 xsym               LDQ     DCB_TEMPLATE,DL
        27 000560   000034 470400 28                 LDP0    28
        27 000561   000000 471500                    LDP1    0,,PR0
        27 000562   100000 236106                    LDQ     0,QL,PR1
        27 000563   200131 756100                    STQ     DCB_ADDR$,,AUTO

      323    23211
      324    23212    3            DCB_LEN = LENGTHC(DCB_ADDR$ -> DCBN)                /*#39131*/

  23212 27 000564   200131 473500                    LDP3    DCB_ADDR$,,AUTO
        27 000565   300140 236100                    LDQ     96,,PR3
        27 000566   000033 772000                    QRL     27
        27 000567   000037 376007                    ANQ     31,DL
        27 000570   000601 620006                    EAX0    385,QL
        27 000571   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000572   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:73   
        27 000573   000022 772000                    QRL     18
        27 000574   200160 136100                    SBLQ    @RETURN$+2,,AUTO
        27 000575   200105 474500                    LDP4    F_DNT$,,AUTO
        27 000576   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 000577   400004 236100                    LDQ     4,,PR4
        27 000600   000022 772000                    QRL     18
        27 000601   200162 756100                    STQ     @RETURN$+4,,AUTO
        27 000602   200161 236100                    LDQ     @RETURN$+3,,AUTO
        27 000603   200162 036100                    ADLQ    @RETURN$+4,,AUTO
        27 000604   200127 756100                    STQ     DCB_LEN,,AUTO

      325    23213    3                - DCB_ADDR$ -> DCBN.DCBNAME.L
      326    23214    3                    + F_DNT$ -> DNT.TEXT.LENGTH;
      327    23215
      328    23216    3            DCB_LEN_NO_NAME = LENGTHC(DCB_ADDR$ -> DCBN)        /*#39131*/

  23216 27 000605   300140 236100                    LDQ     96,,PR3
        27 000606   000033 772000                    QRL     27
        27 000607   000037 376007                    ANQ     31,DL
        27 000610   000601 620006                    EAX0    385,QL
        27 000611   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000612   000000 636010                    EAQ     0,X0
        27 000613   000022 772000                    QRL     18
        27 000614   200160 136100                    SBLQ    @RETURN$+2,,AUTO
        27 000615   000001 136007                    SBLQ    1,DL
        27 000616   200130 756100                    STQ     DCB_LEN_NO_NAME,,AUTO

      329    23217    3                - DCB_ADDR$ -> DCBN.DCBNAME.L
      330    23218    3                - 1;
      331    23219
      332    23220    3            CALL Z8AT$CREATE_TEMPORARY (%SCALAR, DCB_VAR$);

  23220 27 000617   200146 635500                    EPPR5   DCB_VAR$,,AUTO
        27 000620   200161 455500                    STP5    @RETURN$+3,,AUTO
        27 000621   000037 236000 28                 LDQ     31
        27 000622   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000623   200160 630500                    EPPR0   @RETURN$+2,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:74   
        27 000624   000035 631400 28                 EPPR1   29
        27 000625   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 000626   000000 011000                    NOP     0

      333    23221
      334    23222    3            DCB_VAR$ -> SCALAR.TYPE     = %TYA;

  23222 27 000627   000010 220003                    LDX0    8,DU
        27 000630   200146 470500                    LDP0    DCB_VAR$,,AUTO
        27 000631   000002 740100                    STX0    2,,PR0

      335    23223    3            DCB_VAR$ -> SCALAR.ADSC.N   = DCB_LEN_NO_NAME;

  23223 27 000632   200146 470500                    LDP0    DCB_VAR$,,AUTO
        27 000633   200130 236100                    LDQ     DCB_LEN_NO_NAME,,AUTO
        27 000634   000001 752103                    STCQ    1,'03'O,PR0

      336    23224    3            DCB_VAR$ -> SCALAR.COUNT    = DCB_ST$ -> DCB_.COUNT;

  23224 27 000635   000000 470400 26                 LDP0    DCB_ST$
        27 000636   200146 471500                    LDP1    DCB_VAR$,,AUTO
        27 000637   000000 236100                    LDQ     0,,PR0
        27 000640   100000 552104                    STBQ    0,'04'O,PR1

      337    23225    3            DCB_VAR$ -> SCALAR.B.CLASS  = %CLASS_ALPHANUMERIC;

  23225 27 000641   200146 470500                    LDP0    DCB_VAR$,,AUTO
        27 000642   000003 236100                    LDQ     3,,PR0
        27 000643   000040 376000 28                 ANQ     32
        27 000644   000003 276007                    ORQ     3,DL
        27 000645   000003 756100                    STQ     3,,PR0

      338    23226
      339    23227    3            CALL Z8AT$CREATE_TEMPORARY (%SCALAR, DCB_NAME$);

  23227 27 000646   200133 630500                    EPPR0   DCB_NAME$,,AUTO
        27 000647   200161 450500                    STP0    @RETURN$+3,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:75   
        27 000650   000037 236000 28                 LDQ     31
        27 000651   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000652   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000653   000035 631400 28                 EPPR1   29
        27 000654   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 000655   000000 011000                    NOP     0

      340    23228
      341    23229    3            DCB_NAME$ -> SCALAR.TYPE    = %TYA;

  23229 27 000656   000010 220003                    LDX0    8,DU
        27 000657   200133 470500                    LDP0    DCB_NAME$,,AUTO
        27 000660   000002 740100                    STX0    2,,PR0

      342    23230    3            DCB_NAME$ -> SCALAR.ADSC.N  = DCB_LEN - DCB_LEN_NO_NAME;

  23230 27 000661   200127 236100                    LDQ     DCB_LEN,,AUTO
        27 000662   200130 136100                    SBLQ    DCB_LEN_NO_NAME,,AUTO
        27 000663   200133 470500                    LDP0    DCB_NAME$,,AUTO
        27 000664   000001 752103                    STCQ    1,'03'O,PR0

      343    23231    3            DCB_NAME$ -> SCALAR.COUNT   = DCB_ST$ -> DCB_.COUNT;

  23231 27 000665   000000 470400 26                 LDP0    DCB_ST$
        27 000666   200133 471500                    LDP1    DCB_NAME$,,AUTO
        27 000667   000000 236100                    LDQ     0,,PR0
        27 000670   100000 552104                    STBQ    0,'04'O,PR1

      344    23232    3            DCB_NAME$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;

  23232 27 000671   200133 470500                    LDP0    DCB_NAME$,,AUTO
        27 000672   000003 236100                    LDQ     3,,PR0
        27 000673   000040 376000 28                 ANQ     32
        27 000674   000003 276007                    ORQ     3,DL
        27 000675   000003 756100                    STQ     3,,PR0

      345    23233
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:76   
      346    23234                 %NEW_CONST (@ST$   = DCB_TEMPLATE$,
      347    23235                             @TYPE  = %TYA,
      348    23236                             @LONG_CONSTANT = TRUE);

  23240 27 000676   000002 236000 9                  LDQ     ST_+2
        27 000677   000013 036007                    ADLQ    11,DL
        27 000700   000003 116000 9                  CMPQ    ST_+3
        27 000701   000712 604000 27                 TMI     s:23242

  23241 27 000702   000031 236000 28                 LDQ     25
        27 000703   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000704   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000705   200161 450500                    STP0    @RETURN$+3,,AUTO
        27 000706   200161 630500                    EPPR0   @RETURN$+3,,AUTO
        27 000707   000011 631400 28                 EPPR1   9
        27 000710   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000711   000000 011000                    NOP     0

  23242 27 000712   000002 236000 9                  LDQ     ST_+2
        27 000713   000022 736000                    QLS     18
        27 000714   000001 036000 9                  ADLQ    ST_+1
        27 000715   200147 756100                    STQ     DCB_TEMPLATE$,,AUTO

  23243 27 000716   000013 236007                    LDQ     11,DL
        27 000717   000002 056000 9                  ASQ     ST_+2

  23246 27 000720   000767 220003                    LDX0    503,DU
        27 000721   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000722   000000 740100                    STX0    0,,PR0

  23247 27 000723   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000724   001000 236007                    LDQ     512,DL
        27 000725   000000 552110                    STBQ    0,'10'O,PR0

  23248 27 000726   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000727   000126 236000 xsym               LDQ     O1COM+86
        27 000730   000000 552104                    STBQ    0,'04'O,PR0
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:77   

  23249 27 000731   000010 221003                    LDX1    8,DU
        27 000732   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000733   000002 741100                    STX1    2,,PR0

  23250 27 000734   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000735   000003 450100                    STZ     3,,PR0

  23251 27 000736   000016 236000 28                 LDQ     14
        27 000737   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000740   000004 756100                    STQ     4,,PR0

  23252 27 000741   000016 236000 28                 LDQ     14
        27 000742   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000743   000005 756100                    STQ     5,,PR0

  23253 27 000744   000016 236000 28                 LDQ     14
        27 000745   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000746   000006 756100                    STQ     6,,PR0

  23255 27 000747   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000750   400000 236003                    LDQ     -131072,DU
        27 000751   000003 256100                    ORSQ    3,,PR0

      349    23277
      350    23278    3            DCB_TEMPLATE$ -> CONST.ADSC.N = DCB_LEN_NO_NAME;

  23278 27 000752   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 000753   200130 236100                    LDQ     DCB_LEN_NO_NAME,,AUTO
        27 000754   000001 752103                    STCQ    1,'03'O,PR0

      351    23279
      352    23280                 %NEW_LCNST (@POINTER = DCB_TEMPLATE$ -> CONST.CONST$.PTR$,
      353    23281                             @SIZE    = "((7 + DCB_LEN) / 4)"); /*#35094*/

  23283 27 000755   200127 236100                    LDQ     DCB_LEN,,AUTO
        27 000756   000007 036007                    ADLQ    7,DL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:78   
        27 000757   000002 772000                    QRL     2
        27 000760   000000 756000 1                  STQ     ITERATION

  23361 27 000761   000002 036000 3                  ADLQ    LTS_+2
        27 000762   000003 116000 3                  CMPQ    LTS_+3
        27 000763   000774 604000 27                 TMI     s:23363

  23362 27 000764   000041 236000 28                 LDQ     33
        27 000765   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 000766   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 000767   200161 450500                    STP0    @RETURN$+3,,AUTO
        27 000770   200161 630500                    EPPR0   @RETURN$+3,,AUTO
        27 000771   000011 631400 28                 EPPR1   9
        27 000772   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000773   000000 011000                    NOP     0

  23363 27 000774   000002 236000 3                  LDQ     LTS_+2
        27 000775   000022 736000                    QLS     18
        27 000776   000001 036000 3                  ADLQ    LTS_+1
        27 000777   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 001000   000010 756100                    STQ     8,,PR0

  23364 27 001001   000002 236000 3                  LDQ     LTS_+2
        27 001002   000000 036000 1                  ADLQ    ITERATION
        27 001003   000002 756000 3                  STQ     LTS_+2

  23365 27 001004   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 001005   000010 471500                    LDP1    8,,PR0
        27 001006   001106 220003                    LDX0    582,DU
        27 001007   100000 740100                    STX0    0,,PR1

  23367 27 001010   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 001011   000010 471500                    LDP1    8,,PR0
        27 001012   000000 721000 1                  LXL1    ITERATION
        27 001013   100000 441100                    SXL1    0,,PR1

  23371 27 001014   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:79   
        27 001015   000010 471500                    LDP1    8,,PR0
        27 001016   200127 236100                    LDQ     DCB_LEN,,AUTO
        27 001017   000007 036007                    ADLQ    7,DL
        27 001020   000002 772000                    QRL     2
        27 001021   000002 736000                    QLS     2
        27 001022   777774 621006                    EAX1    -4,QL
        27 001023   040140 100400                    MLR     fill='040'O
        27 001024   000042 000001 28                 ADSC9   34                       cn=0,n=1
        27 001025   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1

      354    23374
      355    23375    3            DCB$ = PINCRW (DCB_TEMPLATE$ -> CONST.CONST$.PTR$, 1);

  23375 27 001026   200147 470500                    LDP0    DCB_TEMPLATE$,,AUTO
        27 001027   000010 236100                    LDQ     8,,PR0
        27 001030   000001 036003                    ADLQ    1,DU
        27 001031   200126 756100                    STQ     DCB$,,AUTO

      356    23376
      357    23377    3            SUBSTR (DCB_TEMPLATE$ -> CONST.CONST$.PTR$ -> LCNST.CONST, 0,
             23377                     DCB_LEN_NO_NAME) =

  23377 27 001032   000010 471500                    LDP1    8,,PR0
        27 001033   200131 473500                    LDP3    DCB_ADDR$,,AUTO
        27 001034   200130 721100                    LXL1    DCB_LEN_NO_NAME,,AUTO
        27 001035   040140 100540                    MLR     fill='040'O
        27 001036   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
        27 001037   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1

      358    23378    3            SUBSTR (DCB_ADDR$ -> DCB_BASED, 0, DCB_LEN_NO_NAME);
      359    23379
      360    23380    3            DCB$ -> DCBN.NAME#.L = F_DNT$ -> DNT.TEXT.LENGTH + 1;

  23380 27 001040   200126 470500                    LDP0    DCB$,,AUTO
        27 001041   200105 471500                    LDP1    F_DNT$,,AUTO
        27 001042   100004 236100                    LDQ     4,,PR1
        27 001043   000022 772000                    QRL     18
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:80   
        27 001044   000001 036007                    ADLQ    1,DL
        27 001045   000033 736000                    QLS     27
        27 001046   000010 552140                    STBQ    8,'40'O,PR0

      361    23381    3            CALL CONCAT (DCB$ -> DCBN.NAME#.C, '*', F_DNT$ -> DNT.TEXT.NAME);

  23381 27 001047   200105 471500                    LDP1    F_DNT$,,AUTO
        27 001050   100004 222100                    LDX2    4,,PR1
        27 001051   000052 236003                    LDQ     42,DU
        27 001052   000010 552120                    STBQ    8,'20'O,PR0
        27 001053   200105 471500                    LDP1    F_DNT$,,AUTO
        27 001054   040100 100540                    MLR     fill='040'O
        27 001055   100004 400012                    ADSC9   4,,PR1                   cn=2,n=*X2
        27 001056   000010 400036                    ADSC9   8,,PR0                   cn=2,n=30

      362    23382
      363    23383
      364    23384    3            DCB$ -> DCBN.DCBNAME.L = F_DNT$ -> DNT.TEXT.LENGTH;

  23384 27 001057   200126 470500                    LDP0    DCB$,,AUTO
        27 001060   200105 471500                    LDP1    F_DNT$,,AUTO
        27 001061   100004 236100                    LDQ     4,,PR1
        27 001062   000011 736000                    QLS     9
        27 001063   000140 676100                    ERQ     96,,PR0
        27 001064   037000 376003                    ANQ     15872,DU
        27 001065   000140 656100                    ERSQ    96,,PR0

      365    23385    3            DCB$ -> DCBN.DCBNAME.N = F_DNT$ -> DNT.TEXT.NAME;

  23385 27 001066   000140 236100                    LDQ     96,,PR0
        27 001067   000033 772000                    QRL     27
        27 001070   000037 376007                    ANQ     31,DL
        27 001071   100004 220100                    LDX0    4,,PR1
        27 001072   000000 621006                    EAX1    0,QL
        27 001073   040140 100540                    MLR     fill='040'O
        27 001074   100004 400010                    ADSC9   4,,PR1                   cn=2,n=*X0
        27 001075   000140 200011                    ADSC9   96,,PR0                  cn=1,n=*X1
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:81   

      366    23386
      367    23387    4            DO CASE (FILE$ -> FILE_LTS.ACCESS_MODE);

  23387 27 001076   200003 473500                    LDP3    @FILE$,,AUTO
        27 001077   300000 474500                    LDP4    0,,PR3
        27 001100   400011 235100                    LDA     9,,PR4
        27 001101   000004 115007                    CMPA    4,DL
        27 001102   001104 602005 27                 TNC     s:23387+6,AL
        27 001103   001121 710000 27                 TRA     s:23399
        27 001104   001121 710000 27                 TRA     s:23399
        27 001105   001113 710000 27                 TRA     s:23393
        27 001106   001110 710000 27                 TRA     s:23390
        27 001107   001116 710000 27                 TRA     s:23396

      368    23388
      369    23389    4              CASE (%RANDOM_ACCESS);

      370    23390    4                RETURN_VAL = %CP6_RANDOM_ACCESS;

  23390 27 001110   000002 235007                    LDA     2,DL
        27 001111   200150 755100                    STA     RETURN_VAL,,AUTO
        27 001112   001127 710000 27                 TRA     s:23403

      371    23391
      372    23392    4              CASE (%SEQUENTIAL_ACCESS);

      373    23393    4                RETURN_VAL = %CP6_SEQUENTIAL_ACCESS;

  23393 27 001113   000001 235007                    LDA     1,DL
        27 001114   200150 755100                    STA     RETURN_VAL,,AUTO
        27 001115   001127 710000 27                 TRA     s:23403

      374    23394
      375    23395    4              CASE (%DYNAMIC_ACCESS);

      376    23396    4                RETURN_VAL = %CP6_DYNAMIC_ACCESS;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:82   

  23396 27 001116   000002 235007                    LDA     2,DL
        27 001117   200150 755100                    STA     RETURN_VAL,,AUTO
        27 001120   001127 710000 27                 TRA     s:23403

      377    23397
      378    23398    4              CASE (ELSE);

      379    23399    4                CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  23399 27 001121   000015 630400 28                 EPPR0   13
        27 001122   000011 631400 28                 EPPR1   9
        27 001123   000000 701000 xent               TSX1    Z8AE$ERROR
        27 001124   000000 011000                    NOP     0

      380    23400    4                RETURN_VAL = %CP6_SEQUENTIAL_ACCESS;

  23400 27 001125   000001 235007                    LDA     1,DL
        27 001126   200150 755100                    STA     RETURN_VAL,,AUTO

      381    23401
      382    23402    4            END; /* Case */

      383    23403    3            DCB$ -> DCBN.ACS# = RETURN_VAL;

  23403 27 001127   200126 470500                    LDP0    DCB$,,AUTO
        27 001130   200150 236100                    LDQ     RETURN_VAL,,AUTO
        27 001131   000036 552104                    STBQ    30,'04'O,PR0

      384    23404
      385    23405    3            CALL ORG_TO_CP6_ORG (UNIT_RECORD, RETURN_VAL);

  23405 27 001132   200150 631500                    EPPR1   RETURN_VAL,,AUTO
        27 001133   200154 451500                    STP1    @RETURN_VAL,,AUTO
        27 001134   200123 236100                    LDQ     @UNIT_RECORD,,AUTO
        27 001135   200153 756100                    STQ     @UNIT_RECORD,,AUTO
        27 001136   000242 701000 27                 TSX1    ORG_TO_CP6_ORG
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:83   
        27 001137   000000 011000                    NOP     0

      386    23406    3            DCB$ -> DCBN.ORG# = RETURN_VAL;

  23406 27 001140   200126 470500                    LDP0    DCB$,,AUTO
        27 001141   200150 236100                    LDQ     RETURN_VAL,,AUTO
        27 001142   000033 736000                    QLS     27
        27 001143   000032 552140                    STBQ    26,'40'O,PR0

      387    23407
      388    23408    3            DCB$ -> DCBN.NRECS# = 1000; /* ~~ 1K */

  23408 27 001144   001750 235007                    LDA     1000,DL
        27 001145   000042 755100                    STA     34,,PR0

      389    23409
      390    23410    4            DO CASE (FILE$ -> FILE_LTS.ORGANIZATION);

  23410 27 001146   200003 471500                    LDP1    @FILE$,,AUTO
        27 001147   100000 473500                    LDP3    0,,PR1
        27 001150   300006 235100                    LDA     6,,PR3
        27 001151   000024 115007                    CMPA    20,DL
        27 001152   001154 602005 27                 TNC     s:23410+6,AL
        27 001153   001244 710000 27                 TRA     s:23443
        27 001154   001244 710000 27                 TRA     s:23443
        27 001155   001244 710000 27                 TRA     s:23443
        27 001156   001244 710000 27                 TRA     s:23443
        27 001157   001200 710000 27                 TRA     s:23418
        27 001160   001244 710000 27                 TRA     s:23443
        27 001161   001244 710000 27                 TRA     s:23443
        27 001162   001244 710000 27                 TRA     s:23443
        27 001163   001244 710000 27                 TRA     s:23443
        27 001164   001244 710000 27                 TRA     s:23443
        27 001165   001244 710000 27                 TRA     s:23443
        27 001166   001244 710000 27                 TRA     s:23443
        27 001167   001200 710000 27                 TRA     s:23418
        27 001170   001244 710000 27                 TRA     s:23443
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:84   
        27 001171   001244 710000 27                 TRA     s:23443
        27 001172   001200 710000 27                 TRA     s:23418
        27 001173   001244 710000 27                 TRA     s:23443
        27 001174   001244 710000 27                 TRA     s:23443
        27 001175   001244 710000 27                 TRA     s:23443
        27 001176   001244 710000 27                 TRA     s:23443
        27 001177   001200 710000 27                 TRA     s:23418

      391    23411
      392    23412    4              CASE (

      393    23413                         %SET_OF_INDEXED_ORGANIZATION;
      394    23417    4                   );
      395    23418    4                IF FILE$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN

  23418 27 001200   300015 236100                    LDQ     13,,PR3
        27 001201   000016 116000 28                 CMPQ    14
        27 001202   001244 600000 27                 TZE     s:23443

      396    23419    5                  DO;

      397    23420                         /* Set KEYX# and KEYL# */
      398    23421                         %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.RECORD_KEY$,
      399    23422                                        RTN = DCB$ -> DCBN.KEYL#);

  23424 27 001203   300015 474500                    LDP4    13,,PR3
        27 001204   400003 236100                    LDQ     3,,PR4
        27 001205   004000 316003                    CANQ    2048,DU
        27 001206   001224 600000 27                 TZE     s:23430

  23425 27 001207   400005 475500                    LDP5    5,,PR4
        27 001210   500000 220100                    LDX0    0,,PR5
        27 001211   001105 100003                    CMPX0   581,DU
        27 001212   001220 601000 27                 TNZ     s:23428

  23426 27 001213   500003 476500                    LDP6    3,,PR5
        27 001214   600001 236100                    LDQ     1,,PR6
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:85   
        27 001215   000011 736000                    QLS     9
        27 001216   000036 552110                    STBQ    30,'10'O,PR0
        27 001217   001227 710000 27                 TRA     s:23434

  23428 27 001220   500001 236100                    LDQ     1,,PR5
        27 001221   000011 736000                    QLS     9
        27 001222   000036 552110                    STBQ    30,'10'O,PR0
        27 001223   001227 710000 27                 TRA     s:23434

  23430 27 001224   400001 236100                    LDQ     1,,PR4
        27 001225   000011 736000                    QLS     9
        27 001226   000036 552110                    STBQ    30,'10'O,PR0

      400    23433
      401    23434    5                    DCB$ -> DCBN.KEYX# = FILE$ -> FILE_LTS.RECORD_KEY$ ->

  23434 27 001227   100000 473500                    LDP3    0,,PR1
        27 001230   300015 474500                    LDP4    13,,PR3
        27 001231   400001 236100                    LDQ     1,,PR4
        27 001232   000020 772000                    QRL     16
        27 001233   000003 376007                    ANQ     3,DL
        27 001234   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 001235   400001 236100                    LDQ     1,,PR4
        27 001236   000020 772000                    QRL     16
        27 001237   000043 376000 28                 ANQ     35
        27 001240   200160 036100                    ADLQ    @RETURN$+2,,AUTO
        27 001241   000000 620006                    EAX0    0,QL
        27 001242   000036 740100                    STX0    30,,PR0

      402    23435    5                                         SCALAR.SA * 4 + FILE$ ->
      403    23436    5                                         FILE_LTS.RECORD_KEY$ -> SCALAR.ADSC.CN;
      404    23437    5                  END;

  23437 27 001243   001244 710000 27                 TRA     s:23443

      405    23438
      406    23439    4              CASE (ELSE);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:86   

      407    23440    4            END; /* Case */

      408    23441
      409    23442
      410    23443    3            DCB$ -> DCBN.BLKL# = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;

  23443 27 001244   100000 473500                    LDP3    0,,PR1
        27 001245   300022 720100                    LXL0    18,,PR3
        27 001246   000033 740100                    STX0    27,,PR0

      411    23444    3            DCB$ -> DCBN.RECL# = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_2;

  23444 27 001247   100000 473500                    LDP3    0,,PR1
        27 001250   300024 721100                    LXL1    20,,PR3
        27 001251   000033 441100                    SXL1    27,,PR0

      412    23445
      413    23446    3            DCB$ -> DCBN.CNVRT#  = FILE$ -> FILE_LTS.B.EBCDIC_CODE_SET;

  23446 27 001252   100000 473500                    LDP3    0,,PR1
        27 001253   300017 236100                    LDQ     15,,PR3
        27 001254   000006 736000                    QLS     6
        27 001255   000031 676100                    ERQ     25,,PR0
        27 001256   200000 376007                    ANQ     65536,DL
        27 001257   000031 656100                    ERSQ    25,,PR0

      414    23447    3            DCB$ -> DCBN.EBCDIC# = FILE$ -> FILE_LTS.B.EBCDIC;

  23447 27 001260   100000 473500                    LDP3    0,,PR1
        27 001261   300017 236100                    LDQ     15,,PR3
        27 001262   000004 736000                    QLS     4
        27 001263   000031 676100                    ERQ     25,,PR0
        27 001264   100000 376007                    ANQ     32768,DL
        27 001265   000031 656100                    ERSQ    25,,PR0

      415    23448
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:87   
      416    23449    3            CALL DEVICE_TO_CP6_DEVICE (RETURN_VAL, UNIT_RECORD);

  23449 27 001266   200123 236100                    LDQ     @UNIT_RECORD,,AUTO
        27 001267   200154 756100                    STQ     @RETURN_VAL,,AUTO
        27 001270   200150 633500                    EPPR3   RETURN_VAL,,AUTO
        27 001271   200153 453500                    STP3    @UNIT_RECORD,,AUTO
        27 001272   000104 701000 27                 TSX1    DEVICE_TO_CP6_DEVICE
        27 001273   000000 011000                    NOP     0

      417    23450
      418    23451    4            DO CASE (RETURN_VAL);

  23451 27 001274   200150 235100                    LDA     RETURN_VAL,,AUTO
        27 001275   000007 115007                    CMPA    7,DL
        27 001276   001300 602005 27                 TNC     s:23451+4,AL
        27 001277   001333 710000 27                 TRA     s:23465
        27 001300   001333 710000 27                 TRA     s:23465
        27 001301   001333 710000 27                 TRA     s:23465
        27 001302   001323 710000 27                 TRA     s:23461
        27 001303   001333 710000 27                 TRA     s:23465
        27 001304   001333 710000 27                 TRA     s:23465
        27 001305   001317 710000 27                 TRA     s:23458
        27 001306   001307 710000 27                 TRA     s:23454

      419    23452
      420    23453    4              CASE (%CP6_CARD_PUNCH);

      421    23454    4                DCB$ -> DCBN.ASN# = %CP6_DEVICE;

  23454 27 001307   200126 470500                    LDP0    DCB$,,AUTO
        27 001310   003000 236007                    LDQ     1536,DL
        27 001311   000032 552110                    STBQ    26,'10'O,PR0

      422    23455    4                DCB$ -> DCBN.RES# = 'CP';

  23455 27 001312   000043 236000 24                 LDQ     EPTR_NIL_VAL+21
        27 001313   777777 376003                    ANQ     -1,DU
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:88   
        27 001314   040040 276007                    ORQ     16416,DL
        27 001315   000026 756100                    STQ     22,,PR0
        27 001316   001342 710000 27                 TRA     s:23471

      423    23456
      424    23457    4              CASE (%CP6_DISK);

      425    23458    4                DCB$ -> DCBN.ASN# = %CP6_FILE;

  23458 27 001317   200126 470500                    LDP0    DCB$,,AUTO
        27 001320   001000 236007                    LDQ     512,DL
        27 001321   000032 552110                    STBQ    26,'10'O,PR0
        27 001322   001342 710000 27                 TRA     s:23471

      426    23459
      427    23460    4              CASE (%CP6_MAGNETIC_TAPE);

      428    23461    4                DCB$ -> DCBN.ASN# = %CP6_TAPE;

  23461 27 001323   200126 470500                    LDP0    DCB$,,AUTO
        27 001324   002000 236007                    LDQ     1024,DL
        27 001325   000032 552110                    STBQ    26,'10'O,PR0

      429    23462    4                DCB$ -> DCBN.RES# = 'MT';

  23462 27 001326   000044 236000 24                 LDQ     EPTR_NIL_VAL+22
        27 001327   777777 376003                    ANQ     -1,DU
        27 001330   040040 276007                    ORQ     16416,DL
        27 001331   000026 756100                    STQ     22,,PR0
        27 001332   001342 710000 27                 TRA     s:23471

      430    23463
      431    23464    4              CASE (ELSE);

      432    23465    4                DCB$ -> DCBN.ASN# = %CP6_DEVICE;

  23465 27 001333   200126 470500                    LDP0    DCB$,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:89   
        27 001334   003000 236007                    LDQ     1536,DL
        27 001335   000032 552110                    STBQ    26,'10'O,PR0

      433    23466    4                DCB$ -> DCBN.RES# = 'ME';

  23466 27 001336   000045 236000 24                 LDQ     EPTR_NIL_VAL+23
        27 001337   777777 376003                    ANQ     -1,DU
        27 001340   040040 276007                    ORQ     16416,DL
        27 001341   000026 756100                    STQ     22,,PR0

      434    23467
      435    23468    4            END; /* Case */

      436    23469
      437    23470
      438    23471    3            CALL PRESET( DCB_VAR$, DCB_TEMPLATE$ );

  23471 27 001342   200147 631500                    EPPR1   DCB_TEMPLATE$,,AUTO
        27 001343   200156 451500                    STP1    @RETURN$,,AUTO
        27 001344   200146 633500                    EPPR3   DCB_VAR$,,AUTO
        27 001345   200155 453500                    STP3    @NUM,,AUTO
        27 001346   000035 701000 27                 TSX1    PRESET
        27 001347   000000 011000                    NOP     0

      439    23472    3          END;

      440    23473
      441    23474    2   END NEW_DCB;

  23474 27 001350   200122 221300                    LDX1  ! EPTR_NIL_CONST$+2,,AUTO
        27 001351   000001 702211                    TSX2  ! 1,X1

      442    23475        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:90   
      443    23476    1   NEW_USE_BLOCK: PROC (BLOCK$, FILE$, OFFSET);

  23476 27 001352   200124 741300       NEW_USE_BLO* STX1  ! @FILE_LTS$,,AUTO

      444    23477
      445    23478    2        DCL BLOCK$        PTR;
      446    23479    2        DCL FILE$         PTR;
      447    23480    2        DCL OFFSET        SBIN;
      448    23481    2        DCL FILE_DNT$     PTR;
      449    23482    2        DCL P$            PTR;
      450    23483
      451    23484
      452    23485    2        IF COMCOM.USE_BLOCK_ST$ = ADDR(NIL) THEN

  23485 27 001353   000443 236000 xsym               LDQ     COMCOM+291
        27 001354   000016 116000 28                 CMPQ    14
        27 001355   001407 601000 27                 TNZ     s:23496

      453    23486    3          DO;

      454    23487    3            LEX_SYMBOL.SIZE = 4;

  23487 27 001356   000004 235007                    LDA     4,DL
        27 001357   000010 755000 20                 STA     LEX_SYMBOL+8

      455    23488    3            LEX_SYMBOL.SYMBOL = 'FILE';

  23488 27 001360   040000 100400                    MLR     fill='040'O
        27 001361   000046 000004 24                 ADSC9   EPTR_NIL_VAL+24          cn=0,n=4
        27 001362   000011 000504 20                 ADSC9   LEX_SYMBOL+9             cn=0,n=324

      456    23489    3            CALL Z8AH$SEARCH_;

  23489 27 001363   000001 631400 28                 EPPR1   1
        27 001364   000000 701000 xent               TSX1    Z8AH$SEARCH_
        27 001365   000000 011000                    NOP     0

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:91   
      457    23490    3            FILE_DNT$ = DNT$;

  23490 27 001366   000000 236000 4                  LDQ     DNT$
        27 001367   200130 756100                    STQ     FILE_DNT$,,AUTO

      458    23491    3            CALL Z8CU$BUILD_AND_LINK (FILE_DNT$, 1, %TYA, 'USE_BLOCK', 9, COMCOM.
             23491                     USE_BLOCK_ST$);

  23491 27 001370   000046 237000 28                 LDAQ    38
        27 001371   200164 757100                    STAQ    @RETURN$+6,,AUTO
        27 001372   000050 237000 28                 LDAQ    40
        27 001373   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 001374   000026 236000 28                 LDQ     22
        27 001375   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 001376   200130 630500                    EPPR0   FILE_DNT$,,AUTO
        27 001377   200160 450500                    STP0    @RETURN$+2,,AUTO
        27 001400   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 001401   000017 631400 28                 EPPR1   15
        27 001402   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        27 001403   000000 011000                    NOP     0

      459    23492    3            COMCOM.USE_BLOCK_ST$ -> SCALAR.ADSC.N = 16;

  23492 27 001404   000443 470400 xsym               LDP0    COMCOM+291
        27 001405   000020 236007                    LDQ     16,DL
        27 001406   000001 752103                    STCQ    1,'03'O,PR0

      460    23493
      461    23494    3          END;

      462    23495
      463    23496    2        IF FILE$ -> FILE_LTS.B.EXTERNAL OR FILE$ -> FILE_LTS.B.BLOCK THEN

  23496 27 001407   200126 470500                    LDP0    @FILE$,,AUTO
        27 001410   000000 471500                    LDP1    0,,PR0
        27 001411   100017 236100                    LDQ     15,,PR1
        27 001412   000400 316003                    CANQ    256,DU
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:92   
        27 001413   001416 601000 27                 TNZ     s:23498
        27 001414   000010 316007                    CANQ    8,DL
        27 001415   001436 600000 27                 TZE     s:23506

      464    23497    3          DO;

      465    23498    3            P$ = FILE$ -> FILE_LTS.ST$ -> FD.PROC$;

  23498 27 001416   100001 473500                    LDP3    1,,PR1
        27 001417   300011 236100                    LDQ     9,,PR3
        27 001420   200131 756100                    STQ     P$,,AUTO

      466    23499    4            DO WHILE P$ -> PROC_.FATHER ~= ADDR (NIL);

  23499 27 001421   001425 710000 27                 TRA     s:23501

      467    23500    4              P$ = P$ -> PROC_.FATHER;

  23500 27 001422   200131 470500                    LDP0    P$,,AUTO
        27 001423   000011 236100                    LDQ     9,,PR0
        27 001424   200131 756100                    STQ     P$,,AUTO

      468    23501    4            END;

  23501 27 001425   200131 470500                    LDP0    P$,,AUTO
        27 001426   000011 236100                    LDQ     9,,PR0
        27 001427   000016 116000 28                 CMPQ    14
        27 001430   001422 601000 27                 TNZ     s:23500

      469    23502    3            IF NOT P$ -> PROC_.B.MAIN_PROG THEN

  23502 27 001431   000003 236100                    LDQ     3,,PR0
        27 001432   000400 316003                    CANQ    256,DU
        27 001433   001436 601000 27                 TNZ     s:23506

      470    23503    3              RETURN;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:93   
  23503 27 001434   200124 221300                    LDX1  ! @FILE_LTS$,,AUTO
        27 001435   000001 702211                    TSX2  ! 1,X1

      471    23504    3          END;
      472    23505
      473    23506    2        CALL PTR_SET( BLOCK$, COMCOM.USE_BLOCK_ST$, OFFSET );

  23506 27 001436   200127 236100                    LDQ     @OFFSET,,AUTO
        27 001437   000047 235000 28                 LDA     39
        27 001440   200154 757100                    STAQ    @RETURN_VAL,,AUTO
        27 001441   200125 236100                    LDQ     @BLOCK$,,AUTO
        27 001442   200153 756100                    STQ     @UNIT_RECORD,,AUTO
        27 001443   000003 701000 27                 TSX1    PTR_SET
        27 001444   000000 011000                    NOP     0

      474    23507
      475    23508
      476    23509    2   END NEW_USE_BLOCK;

  23509 27 001445   200124 221300                    LDX1  ! @FILE_LTS$,,AUTO
        27 001446   000001 702211                    TSX2  ! 1,X1

      477    23510        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:94   
      478    23511    1   NEW_ALT_KEYS: PROC (ALT$, FILE$, OFFSET);

  23511 27 001447   200124 741300       NEW_ALT_KEYS STX1  ! @FILE_LTS$,,AUTO

      479    23512
      480    23513             %EQU ALT_KEY_TEXT = 'ALT_KEY';
      481    23514             %EQU ALT_KEY_LEN  = 7 + 1 + 2; /* Lengthc (alt_key_text) +
      482    23515                                               lengthc ('#') +
      483    23516                                               lengthc (key#_text)      */
      484    23517
      485    23518    2        DCL ALT$          PTR;
      486    23519    2        DCL FILE$         PTR;
      487    23520    2        DCL RETURN$         PTR;
      488    23521    2        DCL I             SBIN;
      489    23522    2        DCL ALT_KEY$      PTR;
      490    23523    2        DCL UNIQUE        BIT(1) ALIGNED;
      491    23524    2        DCL ROP$$         PTR;
      492    23525    2        DCL OFFSET        SBIN;
      493    23526    2        DCL NAME          CHAR(10);
      494    23527    2        DCL KEY#          UBIN;
      495    23528    2        DCL KEY#_TEXT     CHAR (2);
      496    23529
      497    23530    2        IF FILE$ -> FILE_LTS.ALT_RECORD_KEY$ = ADDR(NIL) THEN

  23530 27 001450   200126 470500                    LDP0    @FILE$,,AUTO
        27 001451   000000 471500                    LDP1    0,,PR0
        27 001452   100016 236100                    LDQ     14,,PR1
        27 001453   000016 116000 28                 CMPQ    14
        27 001454   001506 601000 27                 TNZ     s:23923

      498    23531    3          DO;

      499    23532                 %PTR_PRESET( @FIELD = ALT_RECORD_KEY$,
      500    23533                              @OFFSET = OFFSET );

  23759 27 001455   000003 236000 28                 LDQ     3
        27 001456   200160 756100                    STQ     @RETURN$+2,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:95   
        27 001457   200160 631500                    EPPR1   @RETURN$+2,,AUTO
        27 001460   200165 451500                    STP1    @RETURN$+7,,AUTO
        27 001461   000004 236000 28                 LDQ     4
        27 001462   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 001463   000006 237000 28                 LDAQ    6
        27 001464   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 001465   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 001466   000000 631400 28                 EPPR1   0
        27 001467   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 001470   000000 011000                    NOP     0

  23763 27 001471   200127 470500                    LDP0    @OFFSET,,AUTO
        27 001472   000000 720100                    LXL0    0,,PR0
        27 001473   000000 471400 10                 LDP1    ILL$
        27 001474   100000 440100                    SXL0    0,,PR1

  23765 27 001475   200115 236100                    LDQ     FAB_V$,,AUTO
        27 001476   000000 471400 10                 LDP1    ILL$
        27 001477   100001 756100                    STQ     1,,PR1

  23766 27 001500   200126 473500                    LDP3    @FILE$,,AUTO
        27 001501   300000 474500                    LDP4    0,,PR3
        27 001502   400016 236100                    LDQ     14,,PR4
        27 001503   100002 756100                    STQ     2,,PR1

      501    23920    3            RETURN;

  23920 27 001504   200124 221300                    LDX1  ! @FILE_LTS$,,AUTO
        27 001505   000001 702211                    TSX2  ! 1,X1

      502    23921    3          END;
      503    23922
      504    23923    2        ALT_KEY$ = FILE$ -> FILE_LTS.ALT_RECORD_KEY$;

  23923 27 001506   200132 756100                    STQ     ALT_KEY$,,AUTO

      505    23924
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:96   
      506    23925
      507    23926    2        CALL Z8CU$BUILD_AND_LINK (F_DNT$, 1, %TYA, 'ALT_KEYS', 8, RETURN$);

  23926 27 001507   200130 633500                    EPPR3   RETURN$,,AUTO
        27 001510   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 001511   000024 236000 28                 LDQ     20
        27 001512   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 001513   000052 237000 28                 LDAQ    42
        27 001514   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 001515   000026 236000 28                 LDQ     22
        27 001516   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 001517   200105 631500                    EPPR1   F_DNT$,,AUTO
        27 001520   200160 451500                    STP1    @RETURN$+2,,AUTO
        27 001521   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 001522   000017 631400 28                 EPPR1   15
        27 001523   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        27 001524   000000 011000                    NOP     0

      508    23927    2        CALL PTR_SET( ALT$, RETURN$, OFFSET );

  23927 27 001525   200127 236100                    LDQ     @OFFSET,,AUTO
        27 001526   200155 756100                    STQ     @NUM,,AUTO
        27 001527   200130 630500                    EPPR0   RETURN$,,AUTO
        27 001530   200154 450500                    STP0    @RETURN_VAL,,AUTO
        27 001531   200125 236100                    LDQ     @ALT$,,AUTO
        27 001532   200153 756100                    STQ     @UNIT_RECORD,,AUTO
        27 001533   000003 701000 27                 TSX1    PTR_SET
        27 001534   000000 011000                    NOP     0

      509    23928
      510    23929             %PACK_ADSC (@DESC = DESC,
      511    23930                         @LENGTH = "ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1 * 4 + 8");

  23934 27 001535   000000 220003                    LDX0    0,DU
        27 001536   200004 740100                    STX0    DESC,,AUTO

  23936 27 001537   000045 236000 28                 LDQ     37
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:97   
        27 001540   200004 356100                    ANSQ    DESC,,AUTO

  23937 27 001541   000054 236000 28                 LDQ     44
        27 001542   200004 356100                    ANSQ    DESC,,AUTO

  23949 27 001543   000055 236000 28                 LDQ     45
        27 001544   200004 356100                    ANSQ    DESC,,AUTO

  23950 27 001545   000056 236000 28                 LDQ     46
        27 001546   200004 356100                    ANSQ    DESC,,AUTO

  23951 27 001547   200132 470500                    LDP0    ALT_KEY$,,AUTO
        27 001550   000001 236100                    LDQ     1,,PR0
        27 001551   000002 736000                    QLS     2
        27 001552   000010 036007                    ADLQ    8,DL
        27 001553   200004 752103                    STCQ    DESC,'03'O,AUTO

      512    23954    2        RETURN$ -> ST.DESCL = DESC.DESCL;

  23954 27 001554   200004 721100                    LXL1    DESC,,AUTO
        27 001555   200130 471500                    LDP1    RETURN$,,AUTO
        27 001556   100001 441100                    SXL1    1,,PR1

      513    23955    2        RETURN$ -> VARIABLE.B.ELEMENTARY = FALSE;

  23955 27 001557   200130 471500                    LDP1    RETURN$,,AUTO
        27 001560   000057 236000 28                 LDQ     47
        27 001561   100003 356100                    ANSQ    3,,PR1

      514    23956
      515    23957
      516    23958    2        CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYA, 'ALT_KEY_SIZ', 11, RETURN$);

  23958 27 001562   200130 631500                    EPPR1   RETURN$,,AUTO
        27 001563   200165 451500                    STP1    @RETURN$+7,,AUTO
        27 001564   000061 236000 28                 LDQ     49
        27 001565   200164 756100                    STQ     @RETURN$+6,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:98   
        27 001566   000062 237000 28                 LDAQ    50
        27 001567   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 001570   000030 236000 28                 LDQ     24
        27 001571   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 001572   200105 633500                    EPPR3   F_DNT$,,AUTO
        27 001573   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 001574   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 001575   000017 631400 28                 EPPR1   15
        27 001576   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        27 001577   000000 011000                    NOP     0

      517    23959             %PACK_ADSC (@DESC = DESC,
      518    23960                         @LENGTH = 4);

  23964 27 001600   000000 220003                    LDX0    0,DU
        27 001601   200004 740100                    STX0    DESC,,AUTO

  23966 27 001602   000045 236000 28                 LDQ     37
        27 001603   200004 356100                    ANSQ    DESC,,AUTO

  23967 27 001604   000054 236000 28                 LDQ     44
        27 001605   200004 356100                    ANSQ    DESC,,AUTO

  23979 27 001606   000055 236000 28                 LDQ     45
        27 001607   200004 356100                    ANSQ    DESC,,AUTO

  23980 27 001610   000056 236000 28                 LDQ     46
        27 001611   200004 356100                    ANSQ    DESC,,AUTO

  23981 27 001612   000004 236007                    LDQ     4,DL
        27 001613   200004 752103                    STCQ    DESC,'03'O,AUTO

      519    23984    2        RETURN$ -> ST.DESCL = DESC.DESCL;

  23984 27 001614   200004 721100                    LXL1    DESC,,AUTO
        27 001615   200130 470500                    LDP0    RETURN$,,AUTO
        27 001616   000001 441100                    SXL1    1,,PR0
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:99   

      520    23985    2        CALL NEW_SBIN_CONST (ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1 + 1,

  23985 27 001617   200132 470500                    LDP0    ALT_KEY$,,AUTO
        27 001620   000001 235100                    LDA     1,,PR0
        27 001621   000001 035007                    ADLA    1,DL
        27 001622   200166 755100                    STA     @RETURN$+8,,AUTO
        27 001623   200134 631500                    EPPR1   ROP$$,,AUTO
        27 001624   200156 451500                    STP1    @RETURN$,,AUTO
        27 001625   200166 633500                    EPPR3   @RETURN$+8,,AUTO
        27 001626   200155 453500                    STP3    @NUM,,AUTO
        27 001627   000066 701000 27                 TSX1    NEW_SBIN_CONST
        27 001630   000000 011000                    NOP     0

      521    23986    2                             ROP$$);
      522    23987    2        CALL PRESET (RETURN$, ROP$$);

  23987 27 001631   200134 630500                    EPPR0   ROP$$,,AUTO
        27 001632   200156 450500                    STP0    @RETURN$,,AUTO
        27 001633   200130 631500                    EPPR1   RETURN$,,AUTO
        27 001634   200155 451500                    STP1    @NUM,,AUTO
        27 001635   000035 701000 27                 TSX1    PRESET
        27 001636   000000 011000                    NOP     0

      523    23988
      524    23989
      525    23990    2        KEY# = 0;

  23990 27 001637   200140 450100                    STZ     KEY#,,AUTO

      526    23991    3        DO I = 0 TO ALT_KEY$ -> ALT_KEY.NUM_KEYS_MINUS_1;

  23991 27 001640   200131 450100                    STZ     I,,AUTO
        27 001641   001726 710000 27                 TRA     s:24003+1

      527    23992    3          KEY# = KEY# + 1;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:100  
  23992 27 001642   200140 235100                    LDA     KEY#,,AUTO
        27 001643   000001 035007                    ADLA    1,DL
        27 001644   200140 755100                    STA     KEY#,,AUTO

      528    23993    3          CALL BINCHAR (KEY#_TEXT, KEY#);

  23993 27 001645   000044 773000                    LRL     36
        27 001646   200160 757100                    STAQ    @RETURN$+2,,AUTO
        27 001647   000100 301500                    BTD
        27 001650   200160 000010                    NDSC9   @RETURN$+2,,AUTO         cn=0,s=lsgnf,sf=0,n=8
        27 001651   200141 030002                    NDSC9   KEY#_TEXT,,AUTO          cn=0,s=nosgn,sf=0,n=2

      529    23994
      530    23995    3          CALL CONCAT (NAME, %ALT_KEY_TEXT, '#', KEY#_TEXT);

  23995 27 001652   040100 100400                    MLR     fill='040'O
        27 001653   000052 000007 24                 ADSC9   EPTR_NIL_VAL+28          cn=0,n=7
        27 001654   200135 000007                    ADSC9   NAME,,AUTO               cn=0,n=7
        27 001655   000043 236007                    LDQ     35,DL
        27 001656   200136 552104                    STBQ    NAME+1,'04'O,AUTO
        27 001657   200141 220100                    LDX0    KEY#_TEXT,,AUTO
        27 001660   200137 740100                    STX0    NAME+2,,AUTO

      531    23996    3          CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, NAME, 10, RETURN$);

  23996 27 001661   200130 630500                    EPPR0   RETURN$,,AUTO
        27 001662   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 001663   000065 236000 28                 LDQ     53
        27 001664   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 001665   200135 631500                    EPPR1   NAME,,AUTO
        27 001666   200163 451500                    STP1    @RETURN$+5,,AUTO
        27 001667   000026 236000 28                 LDQ     22
        27 001670   200162 756100                    STQ     @RETURN$+4,,AUTO
        27 001671   000030 236000 28                 LDQ     24
        27 001672   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 001673   200105 633500                    EPPR3   F_DNT$,,AUTO
        27 001674   200160 453500                    STP3    @RETURN$+2,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:101  
        27 001675   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 001676   000017 631400 28                 EPPR1   15
        27 001677   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        27 001700   000000 011000                    NOP     0

      532    23997    3          RETURN$ -> SCALAR.SA = KEY#;

  23997 27 001701   200140 720100                    LXL0    KEY#,,AUTO
        27 001702   200130 470500                    LDP0    RETURN$,,AUTO
        27 001703   000001 740100                    STX0    1,,PR0

      533    23998
      534    23999    3          UNIQUE = ALT_KEY$ -> ALT_KEY.P.UNIQUE (I);

  23999 27 001704   200131 235100                    LDA     I,,AUTO
        27 001705   000001 735000                    ALS     1
        27 001706   200132 470500                    LDP0    ALT_KEY$,,AUTO
        27 001707   000002 236105                    LDQ     2,AL,PR0
        27 001710   400000 376003                    ANQ     -131072,DU
        27 001711   200133 756100                    STQ     UNIQUE,,AUTO

      535    24000
      536    24001    3          CALL PRESET_KEY (ALT_KEY$ -> ALT_KEY.P.P$(I),

  24001 27 001712   200133 631500                    EPPR1   UNIQUE,,AUTO
        27 001713   200145 451500                    STP1    LENGTH,,AUTO
        27 001714   200130 633500                    EPPR3   RETURN$,,AUTO
        27 001715   200144 453500                    STP3    @KEY_ST$+1,,AUTO
        27 001716   200131 236100                    LDQ     I,,AUTO
        27 001717   000023 736000                    QLS     19
        27 001720   000003 036003                    ADLQ    3,DU
        27 001721   200132 036100                    ADLQ    ALT_KEY$,,AUTO
        27 001722   200143 756100                    STQ     KEY#_TEXT+2,,AUTO
        27 001723   001734 701000 27                 TSX1    PRESET_KEY
        27 001724   000000 011000                    NOP     0

      537    24002    3                           RETURN$, UNIQUE);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:102  
      538    24003    3        END;

  24003 27 001725   200131 054100                    AOS     I,,AUTO
        27 001726   200132 470500                    LDP0    ALT_KEY$,,AUTO
        27 001727   200131 236100                    LDQ     I,,AUTO
        27 001730   000001 116100                    CMPQ    1,,PR0
        27 001731   001642 604400 27                 TMOZ    s:23992

      539    24004
      540    24005         /*  CALL Z8CU$BUILD_AND_LINK (F_DNT$, 2, %TYI, 'PRIM_KEY', 8, RETURN$);
      541    24006             RETURN$ -> SCALAR.SA = KEY# + 1;
      542    24007             CALL PRESET_KEY (FILE$ -> FILE_LTS.RECORD_KEY$,
      543    24008                              RETURN$, TRUE);   */                 /*#29940*/
      544    24009
      545    24010    2   END NEW_ALT_KEYS;

  24010 27 001732   200124 221300                    LDX1  ! @FILE_LTS$,,AUTO
        27 001733   000001 702211                    TSX2  ! 1,X1

      546    24011        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:103  
      547    24012    1   PRESET_KEY: PROC (KEY_ST$, FAB_KEY$, UNIQUE);

  24012 27 001734   200142 741300       PRESET_KEY   STX1  ! KEY#_TEXT+1,,AUTO

      548    24013
      549    24014    2        DCL KEY_ST$       PTR;
      550    24015    2        DCL FAB_KEY$      PTR;
      551    24016    2        DCL UNIQUE        BIT(1) ALIGNED;
      552    24017    2        DCL OFFSET        SBIN;
      553    24018    2        DCL ROP$$         PTR;
      554    24019
      555    24020             %VLP_ALTKEYS (FPTN = VLP_ALT_KEY, STCLASS = "AUTO", N = 2);
      556    24035
      557    24036
      558    24037    2        OFFSET = KEY_ST$ -> ST.SA * 4

  24037 27 001735   200143 470500                    LDP0    @KEY_ST$,,AUTO
        27 001736   000000 471500                    LDP1    0,,PR0
        27 001737   100001 236100                    LDQ     1,,PR1
        27 001740   000020 772000                    QRL     16
        27 001741   000003 376007                    ANQ     3,DL
        27 001742   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 001743   100001 236100                    LDQ     1,,PR1
        27 001744   000020 772000                    QRL     16
        27 001745   000043 376000 28                 ANQ     35
        27 001746   200160 036100                    ADLQ    @RETURN$+2,,AUTO
        27 001747   200146 756100                    STQ     OFFSET,,AUTO

      559    24038    2               + KEY_ST$ -> ST.ADSC.CN;
      560    24039
      561    24040    2        VLP_ALT_KEY.K.KEYX# (1) = OFFSET;

  24040 27 001750   000000 620006                    EAX0    0,QL
        27 001751   200152 440100                    SXL0    VLP_ALT_KEY+2,,AUTO

      562    24041
      563    24042             %GET_ADSC_LEN (ST$ = KEY_ST$,
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:104  
      564    24043                            RTN = "VLP_ALT_KEY.K.KEYL# (1)");

  24045 27 001752   000000 471500                    LDP1    0,,PR0
        27 001753   100003 236100                    LDQ     3,,PR1
        27 001754   004000 316003                    CANQ    2048,DU
        27 001755   001773 600000 27                 TZE     s:24051

  24046 27 001756   100005 473500                    LDP3    5,,PR1
        27 001757   300000 222100                    LDX2    0,,PR3
        27 001760   001105 102003                    CMPX2   581,DU
        27 001761   001767 601000 27                 TNZ     s:24049

  24047 27 001762   300003 474500                    LDP4    3,,PR3
        27 001763   400001 236100                    LDQ     1,,PR4
        27 001764   000022 736000                    QLS     18
        27 001765   200152 552120                    STBQ    VLP_ALT_KEY+2,'20'O,AUTO
        27 001766   001776 710000 27                 TRA     s:24055

  24049 27 001767   300001 236100                    LDQ     1,,PR3
        27 001770   000022 736000                    QLS     18
        27 001771   200152 552120                    STBQ    VLP_ALT_KEY+2,'20'O,AUTO
        27 001772   001776 710000 27                 TRA     s:24055

  24051 27 001773   100001 236100                    LDQ     1,,PR1
        27 001774   000022 736000                    QLS     18
        27 001775   200152 552120                    STBQ    VLP_ALT_KEY+2,'20'O,AUTO

      565    24054
      566    24055    2        VLP_ALT_KEY.K.UNIQUE# (1) = UNIQUE;

  24055 27 001776   200145 471500                    LDP1    @UNIQUE,,AUTO
        27 001777   100000 236100                    LDQ     0,,PR1
        27 002000   200152 676100                    ERQ     VLP_ALT_KEY+2,,AUTO
        27 002001   400000 376003                    ANQ     -131072,DU
        27 002002   200152 656100                    ERSQ    VLP_ALT_KEY+2,,AUTO

      567    24056
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:105  
      568    24057    2        CALL NEW_SBIN_CONST (VLP_ALT_KEY.K (1), ROP$$);

  24057 27 002003   200147 633500                    EPPR3   ROP$$,,AUTO
        27 002004   200156 453500                    STP3    @RETURN$,,AUTO
        27 002005   200152 634500                    EPPR4   VLP_ALT_KEY+2,,AUTO
        27 002006   200155 454500                    STP4    @NUM,,AUTO
        27 002007   000066 701000 27                 TSX1    NEW_SBIN_CONST
        27 002010   000000 011000                    NOP     0

      569    24058    2        CALL PRESET (FAB_KEY$, ROP$$);

  24058 27 002011   200147 630500                    EPPR0   ROP$$,,AUTO
        27 002012   200156 450500                    STP0    @RETURN$,,AUTO
        27 002013   200144 236100                    LDQ     @FAB_KEY$,,AUTO
        27 002014   200155 756100                    STQ     @NUM,,AUTO
        27 002015   000035 701000 27                 TSX1    PRESET
        27 002016   000000 011000                    NOP     0

      570    24059
      571    24060    2   END PRESET_KEY;

  24060 27 002017   200142 221300                    LDX1  ! KEY#_TEXT+1,,AUTO
        27 002020   000001 702211                    TSX2  ! 1,X1

      572    24061        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:106  
      573    24062    1   SET_ATTR_BITS: PROC (FILE$, RETURN_VAL);

  24062 27 002021   200126 741300       SET_ATTR_BI* STX1  ! @FILE$,,AUTO

      574    24063
      575    24064    2        DCL FILE$         PTR;
      576    24065    2        DCL RETURN_VAL        BIT(36) ALIGNED;
      577    24066    2        DCL 1 FAB_BITS    ALIGNED,
      578    24067                   %FAB_BITS   (@LVL = 2, @ENDING = YES);
      579    24102
      580    24103
      581    24104    2        FAB_BITS = FALSE;

  24104 27 002022   200131 450100                    STZ     FAB_BITS,,AUTO

      582    24105
      583    24106    2        FAB_BITS.MULTIPLE_FILE_TAPE = FILE$ -> FILE_LTS.B.MULTIPLE_FILE_TAPE;

  24106 27 002023   200127 470500                    LDP0    @FILE$,,AUTO
        27 002024   000000 471500                    LDP1    0,,PR0
        27 002025   100017 236100                    LDQ     15,,PR1
        27 002026   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002027   400000 376003                    ANQ     -131072,DU
        27 002030   200131 656100                    ERSQ    FAB_BITS,,AUTO

      584    24107    2        FAB_BITS.OPTIONAL_FILE      = FILE$ -> FILE_LTS.B.OPTIONAL_FILE;

  24107 27 002031   100017 236100                    LDQ     15,,PR1
        27 002032   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002033   200000 376003                    ANQ     65536,DU
        27 002034   200131 656100                    ERSQ    FAB_BITS,,AUTO

      585    24108    2        FAB_BITS.PROCESS_AREA       = FILE$ -> FILE_LTS.B.PROCESS_AREA;

  24108 27 002035   100017 236100                    LDQ     15,,PR1
        27 002036   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002037   100000 376003                    ANQ     32768,DU
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:107  
        27 002040   200131 656100                    ERSQ    FAB_BITS,,AUTO

      586    24109    2        FAB_BITS.BSN                = FILE$ -> FILE_LTS.B.BSN;

  24109 27 002041   100017 236100                    LDQ     15,,PR1
        27 002042   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002043   040000 376003                    ANQ     16384,DU
        27 002044   200131 656100                    ERSQ    FAB_BITS,,AUTO

      587    24110    2        FAB_BITS.FLR                = FILE$ -> FILE_LTS.B.FLR;

  24110 27 002045   100017 236100                    LDQ     15,,PR1
        27 002046   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002047   020000 376003                    ANQ     8192,DU
        27 002050   200131 656100                    ERSQ    FAB_BITS,,AUTO

      588    24111    2        FAB_BITS.VLR                = FILE$ -> FILE_LTS.B.VLR;

  24111 27 002051   100017 236100                    LDQ     15,,PR1
        27 002052   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002053   010000 376003                    ANQ     4096,DU
        27 002054   200131 656100                    ERSQ    FAB_BITS,,AUTO

      589    24112    2        FAB_BITS.SSF                = FILE$ -> FILE_LTS.B.SSF;

  24112 27 002055   100017 236100                    LDQ     15,,PR1
        27 002056   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002057   004000 376003                    ANQ     2048,DU
        27 002060   200131 656100                    ERSQ    FAB_BITS,,AUTO

      590    24113    2        FAB_BITS.UNBANNERED         = FILE$ -> FILE_LTS.B.UNBANNERED;

  24113 27 002061   100017 236100                    LDQ     15,,PR1
        27 002062   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002063   002000 376003                    ANQ     1024,DU
        27 002064   200131 656100                    ERSQ    FAB_BITS,,AUTO

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:108  
      591    24114    2        FAB_BITS.SPANNED            = FILE$ -> FILE_LTS.B.SPANNED;

  24114 27 002065   100017 236100                    LDQ     15,,PR1
        27 002066   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002067   001000 376003                    ANQ     512,DU
        27 002070   200131 656100                    ERSQ    FAB_BITS,,AUTO

      592    24115    2        FAB_BITS.LABEL_OMITTED      = FILE$ -> FILE_LTS.B.LABEL_OMITTED;

  24115 27 002071   100017 236100                    LDQ     15,,PR1
        27 002072   000003 736000                    QLS     3
        27 002073   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002074   000400 376003                    ANQ     256,DU
        27 002075   200131 656100                    ERSQ    FAB_BITS,,AUTO

      593    24116    2        FAB_BITS.LABEL_STANDARD     = FILE$ -> FILE_LTS.B.LABEL_STANDARD;

  24116 27 002076   100017 236100                    LDQ     15,,PR1
        27 002077   000003 736000                    QLS     3
        27 002100   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002101   000200 376003                    ANQ     128,DU
        27 002102   200131 656100                    ERSQ    FAB_BITS,,AUTO

      594    24117    2        FAB_BITS.BEGIN_TAPE_LABEL   = FILE$ -> FILE_LTS.B.BEGIN_TAPE_LABEL;

  24117 27 002103   100017 236100                    LDQ     15,,PR1
        27 002104   000003 736000                    QLS     3
        27 002105   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002106   000100 376003                    ANQ     64,DU
        27 002107   200131 656100                    ERSQ    FAB_BITS,,AUTO

      595    24118    2        FAB_BITS.BEGIN_FILE_LABEL   = FILE$ -> FILE_LTS.B.BEGIN_FILE_LABEL;

  24118 27 002110   100017 236100                    LDQ     15,,PR1
        27 002111   000003 736000                    QLS     3
        27 002112   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002113   000040 376003                    ANQ     32,DU
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:109  
        27 002114   200131 656100                    ERSQ    FAB_BITS,,AUTO

      596    24119    2        FAB_BITS.END_FILE_LABEL     = FILE$ -> FILE_LTS.B.END_FILE_LABEL;

  24119 27 002115   100017 236100                    LDQ     15,,PR1
        27 002116   000003 736000                    QLS     3
        27 002117   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002120   000010 376003                    ANQ     8,DU
        27 002121   200131 656100                    ERSQ    FAB_BITS,,AUTO

      597    24120    2        FAB_BITS.END_TAPE_LABEL     = FILE$ -> FILE_LTS.B.END_TAPE_LABEL;

  24120 27 002122   100017 236100                    LDQ     15,,PR1
        27 002123   000003 736000                    QLS     3
        27 002124   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002125   000020 376003                    ANQ     16,DU
        27 002126   200131 656100                    ERSQ    FAB_BITS,,AUTO

      598    24121    2        FAB_BITS.FAST_SEQUENTIAL    = FALSE;

  24121 27 002127   000066 236000 28                 LDQ     54
        27 002130   200131 356100                    ANSQ    FAB_BITS,,AUTO

      599    24122    2        FAB_BITS.CNVRT#             = FILE$ -> FILE_LTS.B.EBCDIC_CODE_SET;

  24122 27 002131   100017 236100                    LDQ     15,,PR1
        27 002132   000010 736000                    QLS     8
        27 002133   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002134   000001 376003                    ANQ     1,DU
        27 002135   200131 656100                    ERSQ    FAB_BITS,,AUTO

      600    24123    2        FAB_BITS.EBCDIC#            = FILE$ -> FILE_LTS.B.EBCDIC;

  24123 27 002136   100017 236100                    LDQ     15,,PR1
        27 002137   000006 736000                    QLS     6
        27 002140   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002141   400000 376007                    ANQ     -131072,DL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:110  
        27 002142   200131 656100                    ERSQ    FAB_BITS,,AUTO

      601    24124    2        FAB_BITS.DCB_INIT           = COMCOM.OB.OPTZ;

  24124 27 002143   000014 236000 xsym               LDQ     COMCOM+12
        27 002144   000023 772000                    QRL     19
        27 002145   200131 676100                    ERQ     FAB_BITS,,AUTO
        27 002146   200000 376007                    ANQ     65536,DL
        27 002147   200131 656100                    ERSQ    FAB_BITS,,AUTO

      602    24125
      603    24126    2        IF FAB_BITS.VLR = FAB_BITS.FLR      THEN

  24126 27 002150   000100 066500                    CMPB    filb='0'B
        27 002151   200131 050001                    BDSC    FAB_BITS,,AUTO           by=0,bit=5,n=1
        27 002152   200131 040001                    BDSC    FAB_BITS,,AUTO           by=0,bit=4,n=1
        27 002153   002173 601000 27                 TNZ     s:24144

      604    24127    2          IF FILE$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ ~= ADDR(NIL) OR

  24127 27 002154   100025 236100                    LDQ     21,,PR1
        27 002155   000016 116000 28                 CMPQ    14
        27 002156   002162 601000 27                 TNZ     s:24130
        27 002157   100023 236100                    LDQ     19,,PR1
        27 002160   100024 116100                    CMPQ    20,,PR1
        27 002161   002167 600000 27                 TZE     s:24137

      605    24128    2            (FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_1 ~= FILE$ -> FILE_LTS.
             24128                     RECORD_CONTAINS.INT_2) THEN
      606    24129    3            DO;

      607    24130    3              FAB_BITS.VLR = %TRUE;

  24130 27 002162   010000 236003                    LDQ     4096,DU
        27 002163   200131 256100                    ORSQ    FAB_BITS,,AUTO

      608    24131    3              FAB_BITS.FLR = %FALSE;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:111  

  24131 27 002164   000067 236000 28                 LDQ     55
        27 002165   200131 356100                    ANSQ    FAB_BITS,,AUTO

      609    24132    3            END;

  24132 27 002166   002173 710000 27                 TRA     s:24144

      610    24133
      611    24134    2          ELSE
      612    24135
      613    24136    3            DO;

      614    24137    3              FAB_BITS.VLR = %FALSE;

  24137 27 002167   000057 236000 28                 LDQ     47
        27 002170   200131 356100                    ANSQ    FAB_BITS,,AUTO

      615    24138    3              FAB_BITS.FLR = %TRUE;

  24138 27 002171   020000 236003                    LDQ     8192,DU
        27 002172   200131 256100                    ORSQ    FAB_BITS,,AUTO

      616    24139    3            END;

      617    24140
      618    24141
      619    24142             /* end of bit assignments*/
      620    24143
      621    24144    2        RETURN_VAL = FAB_BITS;

  24144 27 002173   200131 236100                    LDQ     FAB_BITS,,AUTO
        27 002174   200130 473500                    LDP3    @RETURN_VAL,,AUTO
        27 002175   300000 756100                    STQ     0,,PR3

      622    24145
      623    24146    2   END SET_ATTR_BITS;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:112  

  24146 27 002176   200126 221300                    LDX1  ! @FILE$,,AUTO
        27 002177   000001 702211                    TSX2  ! 1,X1

      624    24147        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:113  
      625    24148    1   INIT_FAB_CONST : PROC;

  24148 27 002200   200122 741300       INIT_FAB_CO* STX1  ! EPTR_NIL_CONST$+2,,AUTO

      626    24149
      627    24150    2     DCL FAB_CONST$ PTR;
      628    24151    2     DCL LCONST$    PTR;
      629    24152
      630    24153        %NEW_CONST (@ST$ = FAB_CONST$,
      631    24154                    @TYPE = %TYA,
      632    24155                    @LONG_CONSTANT = TRUE);

  24159 27 002201   000002 236000 9                  LDQ     ST_+2
        27 002202   000013 036007                    ADLQ    11,DL
        27 002203   000003 116000 9                  CMPQ    ST_+3
        27 002204   002215 604000 27                 TMI     s:24161

  24160 27 002205   000031 236000 28                 LDQ     25
        27 002206   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 002207   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002210   200161 450500                    STP0    @RETURN$+3,,AUTO
        27 002211   200161 630500                    EPPR0   @RETURN$+3,,AUTO
        27 002212   000011 631400 28                 EPPR1   9
        27 002213   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 002214   000000 011000                    NOP     0

  24161 27 002215   000002 236000 9                  LDQ     ST_+2
        27 002216   000022 736000                    QLS     18
        27 002217   000001 036000 9                  ADLQ    ST_+1
        27 002220   200123 756100                    STQ     FAB_CONST$,,AUTO

  24162 27 002221   000013 236007                    LDQ     11,DL
        27 002222   000002 056000 9                  ASQ     ST_+2

  24165 27 002223   000767 220003                    LDX0    503,DU
        27 002224   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002225   000000 740100                    STX0    0,,PR0
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:114  

  24166 27 002226   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002227   001000 236007                    LDQ     512,DL
        27 002230   000000 552110                    STBQ    0,'10'O,PR0

  24167 27 002231   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002232   000126 236000 xsym               LDQ     O1COM+86
        27 002233   000000 552104                    STBQ    0,'04'O,PR0

  24168 27 002234   000010 221003                    LDX1    8,DU
        27 002235   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002236   000002 741100                    STX1    2,,PR0

  24169 27 002237   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002240   000003 450100                    STZ     3,,PR0

  24170 27 002241   000016 236000 28                 LDQ     14
        27 002242   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002243   000004 756100                    STQ     4,,PR0

  24171 27 002244   000016 236000 28                 LDQ     14
        27 002245   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002246   000005 756100                    STQ     5,,PR0

  24172 27 002247   000016 236000 28                 LDQ     14
        27 002250   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002251   000006 756100                    STQ     6,,PR0

  24174 27 002252   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002253   400000 236003                    LDQ     -131072,DU
        27 002254   000003 256100                    ORSQ    3,,PR0

      633    24196
      634    24197    2   FAB_CONST$ -> CONST.ADSC.N = SIZEC(FAB_CONST_LENGTH);

  24197 27 002255   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002256   000154 236007                    LDQ     108,DL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:115  
        27 002257   000001 752103                    STCQ    1,'03'O,PR0

      635    24198
      636    24199        %NEW_LCNST (@POINTER = FAB_CONST$ -> CONST.CONST$.PTR$,
      637    24200                    @SIZE = "1 + (SIZEC(FAB_CONST_LENGTH)/4)");

  24202 27 002260   000034 235007                    LDA     28,DL
        27 002261   000000 755000 1                  STA     ITERATION

  24280 27 002262   000002 236000 3                  LDQ     LTS_+2
        27 002263   000000 036000 1                  ADLQ    ITERATION
        27 002264   000003 116000 3                  CMPQ    LTS_+3
        27 002265   002276 604000 27                 TMI     s:24282

  24281 27 002266   000041 236000 28                 LDQ     33
        27 002267   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 002270   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002271   200161 450500                    STP0    @RETURN$+3,,AUTO
        27 002272   200161 630500                    EPPR0   @RETURN$+3,,AUTO
        27 002273   000011 631400 28                 EPPR1   9
        27 002274   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 002275   000000 011000                    NOP     0

  24282 27 002276   000002 236000 3                  LDQ     LTS_+2
        27 002277   000022 736000                    QLS     18
        27 002300   000001 036000 3                  ADLQ    LTS_+1
        27 002301   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002302   000010 756100                    STQ     8,,PR0

  24283 27 002303   000002 236000 3                  LDQ     LTS_+2
        27 002304   000000 036000 1                  ADLQ    ITERATION
        27 002305   000002 756000 3                  STQ     LTS_+2

  24284 27 002306   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002307   000010 471500                    LDP1    8,,PR0
        27 002310   001106 220003                    LDX0    582,DU
        27 002311   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:116  

  24286 27 002312   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002313   000010 471500                    LDP1    8,,PR0
        27 002314   000000 721000 1                  LXL1    ITERATION
        27 002315   100000 441100                    SXL1    0,,PR1

  24290 27 002316   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002317   000010 471500                    LDP1    8,,PR0
        27 002320   040100 100400                    MLR     fill='040'O
        27 002321   000042 000001 28                 ADSC9   34                       cn=0,n=1
        27 002322   100001 000154                    ADSC9   1,,PR1                   cn=0,n=108

      638    24293    2   LCONST$ = FAB_CONST$ -> CONST.CONST$.PTR$;

  24293 27 002323   200123 470500                    LDP0    FAB_CONST$,,AUTO
        27 002324   000010 236100                    LDQ     8,,PR0
        27 002325   200124 756100                    STQ     LCONST$,,AUTO

      639    24294
      640    24295        /* Assign */
      641    24296    2   CALL DEVICE_TO_CP6_DEVICE (LCONST$ -> LCNST.CONSTW.VAL(0),

  24296 27 002326   200117 631500                    EPPR1   UNIT_RECORD,,AUTO
        27 002327   200154 451500                    STP1    @RETURN_VAL,,AUTO
        27 002330   000001 036003                    ADLQ    1,DU
        27 002331   200153 756100                    STQ     @UNIT_RECORD,,AUTO
        27 002332   000104 701000 27                 TSX1    DEVICE_TO_CP6_DEVICE
        27 002333   000000 011000                    NOP     0

      642    24297    2                              UNIT_RECORD);
      643    24298
      644    24299        /* Areas */
      645    24300    2   LCONST$ -> LCNST.CONSTW.VAL(1) = FILE$ -> FILE_LTS.NO_OF_AREAS;

  24300 27 002334   200003 470500                    LDP0    @FILE$,,AUTO
        27 002335   000000 471500                    LDP1    0,,PR0
        27 002336   200124 473500                    LDP3    LCONST$,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:117  
        27 002337   100005 235100                    LDA     5,,PR1
        27 002340   300002 755100                    STA     2,,PR3

      646    24301
      647    24302        /* Organization */
      648    24303    2   CALL ORG_TO_CP6_ORG (UNIT_RECORD,                 /*#31542*/

  24303 27 002341   200124 236100                    LDQ     LCONST$,,AUTO
        27 002342   000003 036003                    ADLQ    3,DU
        27 002343   200154 756100                    STQ     @RETURN_VAL,,AUTO
        27 002344   200117 631500                    EPPR1   UNIT_RECORD,,AUTO
        27 002345   200153 451500                    STP1    @UNIT_RECORD,,AUTO
        27 002346   000242 701000 27                 TSX1    ORG_TO_CP6_ORG
        27 002347   000000 011000                    NOP     0

      649    24304    2                        LCONST$ -> LCNST.CONSTW.VAL(2));
      650    24305
      651    24306        /* Record Delim */
      652    24307    2   LCONST$ -> LCNST.CONSTW.VAL(3) = FILE$ -> FILE_LTS.RECORD_DELIM;

  24307 27 002350   200003 470500                    LDP0    @FILE$,,AUTO
        27 002351   000000 471500                    LDP1    0,,PR0
        27 002352   200124 473500                    LDP3    LCONST$,,AUTO
        27 002353   100010 235100                    LDA     8,,PR1
        27 002354   300004 755100                    STA     4,,PR3

      653    24308
      654    24309        /* Access */
      655    24310    2   CALL ACCESS_TO_FAB_ACCESS (LCONST$ -> LCNST.CONSTW.VAL(4));

  24310 27 002355   200124 236100                    LDQ     LCONST$,,AUTO
        27 002356   000005 036003                    ADLQ    5,DU
        27 002357   200127 756100                    STQ     @FILE$,,AUTO
        27 002360   000325 701000 27                 TSX1    ACCESS_TO_FAB_ACCESS
        27 002361   000000 011000                    NOP     0

      656    24311
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:118  
      657    24312        /* Min block len */
      658    24313    2   LCONST$ -> LCNST.CONSTW.VAL(5) = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_1;

  24313 27 002362   200003 470500                    LDP0    @FILE$,,AUTO
        27 002363   000000 471500                    LDP1    0,,PR0
        27 002364   200124 473500                    LDP3    LCONST$,,AUTO
        27 002365   100021 235100                    LDA     17,,PR1
        27 002366   300006 755100                    STA     6,,PR3

      659    24314
      660    24315        /* Max block len */
      661    24316    2   LCONST$ -> LCNST.CONSTW.VAL(6) = FILE$ -> FILE_LTS.BLOCK_CONTAINS.INT_2;

  24316 27 002367   000000 471500                    LDP1    0,,PR0
        27 002370   100022 235100                    LDA     18,,PR1
        27 002371   300007 755100                    STA     7,,PR3

      662    24317
      663    24318        /* Min rec len */
      664    24319    2   LCONST$ -> LCNST.CONSTW.VAL(7) = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_1;

  24319 27 002372   000000 471500                    LDP1    0,,PR0
        27 002373   100023 235100                    LDA     19,,PR1
        27 002374   300010 755100                    STA     8,,PR3

      665    24320
      666    24321        /* Max rec len */
      667    24322    2   LCONST$ -> LCNST.CONSTW.VAL(8) = FILE$ -> FILE_LTS.RECORD_CONTAINS.INT_2;

  24322 27 002375   000000 471500                    LDP1    0,,PR0
        27 002376   100024 235100                    LDA     20,,PR1
        27 002377   300011 755100                    STA     9,,PR3

      668    24323
      669    24324        /* Depending Desc */
      670    24325        %DESC_PRESET (@FIELD = "RECORD_CONTAINS.DEPENDING$",
      671    24326                      @OFFSET = 9);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:119  

  24327 27 002400   000000 471500                    LDP1    0,,PR0
        27 002401   100025 236100                    LDQ     21,,PR1
        27 002402   000016 116000 28                 CMPQ    14
        27 002403   002406 601000 27                 TNZ     s:24331

  24328 27 002404   300012 450100                    STZ     10,,PR3
        27 002405   002417 710000 27                 TRA     s:24337

  24331 27 002406   200124 236100                    LDQ     LCONST$,,AUTO
        27 002407   000012 036003                    ADLQ    10,DU
        27 002410   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002411   100025 634500                    EPPR4   21,,PR1
        27 002412   200160 454500                    STP4    @RETURN$+2,,AUTO
        27 002413   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002414   000035 631400 28                 EPPR1   29
        27 002415   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002416   000000 011000                    NOP     0

      672    24335
      673    24336        /* File id len */
      674    24337    2   IF FILE$ -> FILE_LTS.FILE_ID$ = ADDR(NIL) THEN

  24337 27 002417   200003 470500                    LDP0    @FILE$,,AUTO
        27 002420   000000 471500                    LDP1    0,,PR0
        27 002421   100027 236100                    LDQ     23,,PR1
        27 002422   000016 116000 28                 CMPQ    14
        27 002423   002427 601000 27                 TNZ     s:24344

      675    24338    2     LCONST$ -> LCNST.CONSTW.VAL(10) = 0;

  24338 27 002424   200124 473500                    LDP3    LCONST$,,AUTO
        27 002425   300013 450100                    STZ     11,,PR3
        27 002426   002454 710000 27                 TRA     s:24358

      676    24339    2   ELSE
      677    24340    3     DO;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:120  

      678    24341            %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.FILE_ID$,
      679    24342                           RTN = "LCONST$ -> LCNST.CONSTW.VAL(10)");

  24344 27 002427   100027 473500                    LDP3    23,,PR1
        27 002430   300003 236100                    LDQ     3,,PR3
        27 002431   004000 316003                    CANQ    2048,DU
        27 002432   002450 600000 27                 TZE     s:24350

  24345 27 002433   300005 474500                    LDP4    5,,PR3
        27 002434   400000 220100                    LDX0    0,,PR4
        27 002435   001105 100003                    CMPX0   581,DU
        27 002436   002444 601000 27                 TNZ     s:24348

  24346 27 002437   400003 475500                    LDP5    3,,PR4
        27 002440   500001 235100                    LDA     1,,PR5
        27 002441   200124 476500                    LDP6    LCONST$,,AUTO
        27 002442   600013 755100                    STA     11,,PR6
        27 002443   002454 710000 27                 TRA     s:24358

  24348 27 002444   400001 235100                    LDA     1,,PR4
        27 002445   200124 475500                    LDP5    LCONST$,,AUTO
        27 002446   500013 755100                    STA     11,,PR5
        27 002447   002454 710000 27                 TRA     s:24358

  24350 27 002450   300001 236100                    LDQ     1,,PR3
        27 002451   007777 376007                    ANQ     4095,DL
        27 002452   200124 474500                    LDP4    LCONST$,,AUTO
        27 002453   400013 756100                    STQ     11,,PR4

      680    24353    3     END;

      681    24354
      682    24355        /* Retention Desc */
      683    24356        %DESC_PRESET (@FIELD = RETENTION$,
      684    24357                      @OFFSET = 11);

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:121  
  24358 27 002454   000000 471500                    LDP1    0,,PR0
        27 002455   100030 236100                    LDQ     24,,PR1
        27 002456   000016 116000 28                 CMPQ    14
        27 002457   002463 601000 27                 TNZ     s:24362

  24359 27 002460   200124 473500                    LDP3    LCONST$,,AUTO
        27 002461   300014 450100                    STZ     12,,PR3
        27 002462   002474 710000 27                 TRA     s:24370

  24362 27 002463   200124 236100                    LDQ     LCONST$,,AUTO
        27 002464   000014 036003                    ADLQ    12,DU
        27 002465   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002466   100030 633500                    EPPR3   24,,PR1
        27 002467   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002470   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002471   000035 631400 28                 EPPR1   29
        27 002472   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002473   000000 011000                    NOP     0

      685    24366
      686    24367        /* Catalog Desc */
      687    24368        %DESC_PRESET (@FIELD = CATALOG$,
      688    24369                      @OFFSET = 12);

  24370 27 002474   200003 470500                    LDP0    @FILE$,,AUTO
        27 002475   000000 471500                    LDP1    0,,PR0
        27 002476   100031 236100                    LDQ     25,,PR1
        27 002477   000016 116000 28                 CMPQ    14
        27 002500   002504 601000 27                 TNZ     s:24374

  24371 27 002501   200124 473500                    LDP3    LCONST$,,AUTO
        27 002502   300015 450100                    STZ     13,,PR3
        27 002503   002515 710000 27                 TRA     s:24382

  24374 27 002504   200124 236100                    LDQ     LCONST$,,AUTO
        27 002505   000015 036003                    ADLQ    13,DU
        27 002506   200161 756100                    STQ     @RETURN$+3,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:122  
        27 002507   100031 633500                    EPPR3   25,,PR1
        27 002510   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002511   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002512   000035 631400 28                 EPPR1   29
        27 002513   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002514   000000 011000                    NOP     0

      689    24378
      690    24379        /* Linage lines desc */
      691    24380        %DESC_PRESET (@FIELD = "LINAGE.NO_OF_LINES$",
      692    24381                      @OFFSET = 13);

  24382 27 002515   200003 470500                    LDP0    @FILE$,,AUTO
        27 002516   000000 471500                    LDP1    0,,PR0
        27 002517   100033 236100                    LDQ     27,,PR1
        27 002520   000016 116000 28                 CMPQ    14
        27 002521   002525 601000 27                 TNZ     s:24386

  24383 27 002522   200124 473500                    LDP3    LCONST$,,AUTO
        27 002523   300016 450100                    STZ     14,,PR3
        27 002524   002536 710000 27                 TRA     s:24394

  24386 27 002525   200124 236100                    LDQ     LCONST$,,AUTO
        27 002526   000016 036003                    ADLQ    14,DU
        27 002527   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002530   100033 633500                    EPPR3   27,,PR1
        27 002531   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002532   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002533   000035 631400 28                 EPPR1   29
        27 002534   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002535   000000 011000                    NOP     0

      693    24390
      694    24391        /* Footing desc */
      695    24392        %DESC_PRESET (@FIELD = "LINAGE.FOOTING$",
      696    24393                      @OFFSET = 14);

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:123  
  24394 27 002536   200003 470500                    LDP0    @FILE$,,AUTO
        27 002537   000000 471500                    LDP1    0,,PR0
        27 002540   100034 236100                    LDQ     28,,PR1
        27 002541   000016 116000 28                 CMPQ    14
        27 002542   002546 601000 27                 TNZ     s:24398

  24395 27 002543   200124 473500                    LDP3    LCONST$,,AUTO
        27 002544   300017 450100                    STZ     15,,PR3
        27 002545   002557 710000 27                 TRA     s:24406

  24398 27 002546   200124 236100                    LDQ     LCONST$,,AUTO
        27 002547   000017 036003                    ADLQ    15,DU
        27 002550   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002551   100034 633500                    EPPR3   28,,PR1
        27 002552   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002553   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002554   000035 631400 28                 EPPR1   29
        27 002555   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002556   000000 011000                    NOP     0

      697    24402
      698    24403        /* Top desc */
      699    24404        %DESC_PRESET (@FIELD = "LINAGE.TOP$",
      700    24405                      @OFFSET = 15);

  24406 27 002557   200003 470500                    LDP0    @FILE$,,AUTO
        27 002560   000000 471500                    LDP1    0,,PR0
        27 002561   100035 236100                    LDQ     29,,PR1
        27 002562   000016 116000 28                 CMPQ    14
        27 002563   002567 601000 27                 TNZ     s:24410

  24407 27 002564   200124 473500                    LDP3    LCONST$,,AUTO
        27 002565   300020 450100                    STZ     16,,PR3
        27 002566   002600 710000 27                 TRA     s:24418

  24410 27 002567   200124 236100                    LDQ     LCONST$,,AUTO
        27 002570   000020 036003                    ADLQ    16,DU
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:124  
        27 002571   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002572   100035 633500                    EPPR3   29,,PR1
        27 002573   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002574   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002575   000035 631400 28                 EPPR1   29
        27 002576   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002577   000000 011000                    NOP     0

      701    24414
      702    24415        /* Bottom desc */
      703    24416        %DESC_PRESET (@FIELD = "LINAGE.BOTTOM$",
      704    24417                      @OFFSET = 16);

  24418 27 002600   200003 470500                    LDP0    @FILE$,,AUTO
        27 002601   000000 471500                    LDP1    0,,PR0
        27 002602   100036 236100                    LDQ     30,,PR1
        27 002603   000016 116000 28                 CMPQ    14
        27 002604   002610 601000 27                 TNZ     s:24422

  24419 27 002605   200124 473500                    LDP3    LCONST$,,AUTO
        27 002606   300021 450100                    STZ     17,,PR3
        27 002607   002621 710000 27                 TRA     s:24428

  24422 27 002610   200124 236100                    LDQ     LCONST$,,AUTO
        27 002611   000021 036003                    ADLQ    17,DU
        27 002612   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002613   100036 633500                    EPPR3   30,,PR1
        27 002614   200160 453500                    STP3    @RETURN$+2,,AUTO
        27 002615   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002616   000035 631400 28                 EPPR1   29
        27 002617   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002620   000000 011000                    NOP     0

      705    24426
      706    24427        /* Linage */
      707    24428    2   LCONST$ -> LCNST.CONSTW.VAL(17) = 0;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:125  
  24428 27 002621   200124 470500                    LDP0    LCONST$,,AUTO
        27 002622   000022 450100                    STZ     18,,PR0

      708    24429
      709    24430        /* Footing */
      710    24431    2   LCONST$ -> LCNST.CONSTW.VAL(18) = 0;

  24431 27 002623   000023 450100                    STZ     19,,PR0

      711    24432
      712    24433        /* Top */
      713    24434    2   LCONST$ -> LCNST.CONSTW.VAL(19) = 0;

  24434 27 002624   000024 450100                    STZ     20,,PR0

      714    24435
      715    24436        /* Bottom */
      716    24437    2   LCONST$ -> LCNST.CONSTW.VAL(20) = 0;

  24437 27 002625   000025 450100                    STZ     21,,PR0

      717    24438
      718    24439        /* Last IO */
      719    24440    2   LCONST$ -> LCNST.CONSTW.VAL(21) = 0;

  24440 27 002626   000026 450100                    STZ     22,,PR0

      720    24441
      721    24442        /* File status */
      722    24443    2   LCONST$ -> LCNST.CONSTW.VAL(22) = 0;

  24443 27 002627   000027 450100                    STZ     23,,PR0

      723    24444
      724    24445        /* Relative Key */
      725    24446    2   LCONST$ -> LCNST.CONSTW.VAL(23) = 0;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:126  
  24446 27 002630   000030 450100                    STZ     24,,PR0

      726    24447
      727    24448        /* Relative desc */
      728    24449        %DESC_PRESET (@FIELD = RELATIVE_KEY$,
      729    24450                      @OFFSET = 24);

  24451 27 002631   200003 471500                    LDP1    @FILE$,,AUTO
        27 002632   100000 473500                    LDP3    0,,PR1
        27 002633   300014 236100                    LDQ     12,,PR3
        27 002634   000016 116000 28                 CMPQ    14
        27 002635   002640 601000 27                 TNZ     s:24455

  24452 27 002636   000031 450100                    STZ     25,,PR0
        27 002637   002651 710000 27                 TRA     s:24461

  24455 27 002640   200124 236100                    LDQ     LCONST$,,AUTO
        27 002641   000031 036003                    ADLQ    25,DU
        27 002642   200161 756100                    STQ     @RETURN$+3,,AUTO
        27 002643   300014 634500                    EPPR4   12,,PR3
        27 002644   200160 454500                    STP4    @RETURN$+2,,AUTO
        27 002645   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002646   000035 631400 28                 EPPR1   29
        27 002647   000000 701000 xent               TSX1    Z9EO$RUNTIME_DESC_FROM_ETT
        27 002650   000000 011000                    NOP     0

      730    24459
      731    24460        /* Record key len */
      732    24461    2   IF FILE$ -> FILE_LTS.RECORD_KEY$ = ADDR(NIL) THEN

  24461 27 002651   200003 470500                    LDP0    @FILE$,,AUTO
        27 002652   000000 471500                    LDP1    0,,PR0
        27 002653   100015 236100                    LDQ     13,,PR1
        27 002654   000016 116000 28                 CMPQ    14
        27 002655   002661 601000 27                 TNZ     s:24468

      733    24462    2     LCONST$ -> LCNST.CONSTW.VAL (25) = 0;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:127  

  24462 27 002656   200124 473500                    LDP3    LCONST$,,AUTO
        27 002657   300032 450100                    STZ     26,,PR3
        27 002660   002706 710000 27                 TRA     s:24480

      734    24463    2   ELSE
      735    24464    3     DO;

      736    24465            %GET_ADSC_LEN (ST$ = FILE$ -> FILE_LTS.RECORD_KEY$,
      737    24466                           RTN = "LCONST$ -> LCNST.CONSTW.VAL(25)");

  24468 27 002661   100015 473500                    LDP3    13,,PR1
        27 002662   300003 236100                    LDQ     3,,PR3
        27 002663   004000 316003                    CANQ    2048,DU
        27 002664   002702 600000 27                 TZE     s:24474

  24469 27 002665   300005 474500                    LDP4    5,,PR3
        27 002666   400000 220100                    LDX0    0,,PR4
        27 002667   001105 100003                    CMPX0   581,DU
        27 002670   002676 601000 27                 TNZ     s:24472

  24470 27 002671   400003 475500                    LDP5    3,,PR4
        27 002672   500001 235100                    LDA     1,,PR5
        27 002673   200124 476500                    LDP6    LCONST$,,AUTO
        27 002674   600032 755100                    STA     26,,PR6
        27 002675   002706 710000 27                 TRA     s:24480

  24472 27 002676   400001 235100                    LDA     1,,PR4
        27 002677   200124 475500                    LDP5    LCONST$,,AUTO
        27 002700   500032 755100                    STA     26,,PR5
        27 002701   002706 710000 27                 TRA     s:24480

  24474 27 002702   300001 236100                    LDQ     1,,PR3
        27 002703   007777 376007                    ANQ     4095,DL
        27 002704   200124 474500                    LDP4    LCONST$,,AUTO
        27 002705   400032 756100                    STQ     26,,PR4

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:128  
      738    24477    3     END;

      739    24478
      740    24479        /* Attribute bits */
      741    24480    2   CALL SET_ATTR_BITS (FILE$,

  24480 27 002706   200124 236100                    LDQ     LCONST$,,AUTO
        27 002707   000033 036003                    ADLQ    27,DU
        27 002710   200130 756100                    STQ     @RETURN_VAL,,AUTO
        27 002711   200003 236100                    LDQ     @FILE$,,AUTO
        27 002712   200127 756100                    STQ     @FILE$,,AUTO
        27 002713   002021 701000 27                 TSX1    SET_ATTR_BITS
        27 002714   000000 011000                    NOP     0

      742    24481    2                       LCONST$ -> LCNST.CONSTW.VAL(26));
      743    24482
      744    24483        /* Preset the constant Fab area */
      745    24484    2   CALL PRESET( FAB_C$, FAB_CONST$ );

  24484 27 002715   200123 630500                    EPPR0   FAB_CONST$,,AUTO
        27 002716   200156 450500                    STP0    @RETURN$,,AUTO
        27 002717   200114 631500                    EPPR1   FAB_C$,,AUTO
        27 002720   200155 451500                    STP1    @NUM,,AUTO
        27 002721   000035 701000 27                 TSX1    PRESET
        27 002722   000000 011000                    NOP     0

      746    24485
      747    24486    2   END INIT_FAB_CONST;

  24486 27 002723   200122 221300                    LDX1  ! EPTR_NIL_CONST$+2,,AUTO
        27 002724   000001 702211                    TSX2  ! 1,X1

      748    24487        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:129  
      749    24488    1   INIT_FAB_VAR : PROC;

  24488 27 002725   200122 741300       INIT_FAB_VAR STX1  ! EPTR_NIL_CONST$+2,,AUTO

      750    24489
      751    24490    2     DCL PROC$ PTR;
      752    24491
      753    24492        /* Pad char */
      754    24493        %PTR_PRESET (@FIELD = PAD_CHAR$,
      755    24494                     @OFFSET = 0);

  24720 27 002726   000003 236000 28                 LDQ     3
        27 002727   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 002730   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 002731   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 002732   000004 236000 28                 LDQ     4
        27 002733   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 002734   000006 237000 28                 LDAQ    6
        27 002735   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 002736   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 002737   000000 631400 28                 EPPR1   0
        27 002740   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 002741   000000 011000                    NOP     0

  24724 27 002742   000000 220003                    LDX0    0,DU
        27 002743   000000 470400 10                 LDP0    ILL$
        27 002744   000000 440100                    SXL0    0,,PR0

  24726 27 002745   200115 236100                    LDQ     FAB_V$,,AUTO
        27 002746   000000 470400 10                 LDP0    ILL$
        27 002747   000001 756100                    STQ     1,,PR0

  24727 27 002750   200003 471500                    LDP1    @FILE$,,AUTO
        27 002751   100000 473500                    LDP3    0,,PR1
        27 002752   300007 236100                    LDQ     7,,PR3
        27 002753   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:130  
      756    24881
      757    24882        /* IO status */
      758    24883        %PTR_PRESET (@FIELD = FILE_STATUS$,
      759    24884                     @OFFSET = 1);

  25110 27 002754   000003 236000 28                 LDQ     3
        27 002755   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 002756   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 002757   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 002760   000004 236000 28                 LDQ     4
        27 002761   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 002762   000006 237000 28                 LDAQ    6
        27 002763   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 002764   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 002765   000000 631400 28                 EPPR1   0
        27 002766   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 002767   000000 011000                    NOP     0

  25114 27 002770   000001 220003                    LDX0    1,DU
        27 002771   000000 470400 10                 LDP0    ILL$
        27 002772   000000 440100                    SXL0    0,,PR0

  25116 27 002773   200115 236100                    LDQ     FAB_V$,,AUTO
        27 002774   000000 470400 10                 LDP0    ILL$
        27 002775   000001 756100                    STQ     1,,PR0

  25117 27 002776   200003 471500                    LDP1    @FILE$,,AUTO
        27 002777   100000 473500                    LDP3    0,,PR1
        27 003000   300012 236100                    LDQ     10,,PR3
        27 003001   000002 756100                    STQ     2,,PR0

      760    25271
      761    25272        /* Shared Alt Key */
      762    25273    2   IF FILE$ -> FILE_LTS.ORGANIZATION = %INDEXED  THEN

  25273 27 003002   100000 473500                    LDP3    0,,PR1
        27 003003   300006 235100                    LDA     6,,PR3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:131  
        27 003004   000003 115007                    CMPA    3,DL
        27 003005   003010 601000 27                 TNZ     s:25504

      763    25274    2     CALL BUILD_SHARED_ALT_KEY;                    /*#24102*/

  25274 27 003006   000365 701000 27                 TSX1    BUILD_SHARED_ALT_KEY
        27 003007   000000 011000                    NOP     0

      764    25275
      765    25276        /* Depending */
      766    25277        %PTR_PRESET (@FIELD = LABEL_EXIT$,
      767    25278                     @OFFSET = 3);

  25504 27 003010   000003 236000 28                 LDQ     3
        27 003011   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003012   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 003013   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 003014   000004 236000 28                 LDQ     4
        27 003015   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003016   000006 237000 28                 LDAQ    6
        27 003017   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003020   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003021   000000 631400 28                 EPPR1   0
        27 003022   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003023   000000 011000                    NOP     0

  25508 27 003024   000003 220003                    LDX0    3,DU
        27 003025   000000 470400 10                 LDP0    ILL$
        27 003026   000000 440100                    SXL0    0,,PR0

  25510 27 003027   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003030   000000 470400 10                 LDP0    ILL$
        27 003031   000001 756100                    STQ     1,,PR0

  25511 27 003032   200003 471500                    LDP1    @FILE$,,AUTO
        27 003033   100000 473500                    LDP3    0,,PR1
        27 003034   300056 236100                    LDQ     46,,PR3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:132  
        27 003035   000002 756100                    STQ     2,,PR0

      768    25665
      769    25666        /* Label Recs */
      770    25667        %PTR_PRESET (@FIELD = LABEL_RECORDS$,
      771    25668                     @OFFSET = 4);

  25894 27 003036   000003 236000 28                 LDQ     3
        27 003037   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003040   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003041   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003042   000004 236000 28                 LDQ     4
        27 003043   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003044   000006 237000 28                 LDAQ    6
        27 003045   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003046   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003047   000000 631400 28                 EPPR1   0
        27 003050   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003051   000000 011000                    NOP     0

  25898 27 003052   000004 220003                    LDX0    4,DU
        27 003053   000000 470400 10                 LDP0    ILL$
        27 003054   000000 440100                    SXL0    0,,PR0

  25900 27 003055   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003056   000000 470400 10                 LDP0    ILL$
        27 003057   000001 756100                    STQ     1,,PR0

  25901 27 003060   200003 471500                    LDP1    @FILE$,,AUTO
        27 003061   100000 473500                    LDP3    0,,PR1
        27 003062   300026 236100                    LDQ     22,,PR3
        27 003063   000002 756100                    STQ     2,,PR0

      772    26055
      773    26056        /* File id */
      774    26057        %PTR_PRESET (@FIELD = FILE_ID$,
      775    26058                     @OFFSET = 5);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:133  

  26284 27 003064   000003 236000 28                 LDQ     3
        27 003065   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003066   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003067   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003070   000004 236000 28                 LDQ     4
        27 003071   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003072   000006 237000 28                 LDAQ    6
        27 003073   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003074   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003075   000000 631400 28                 EPPR1   0
        27 003076   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003077   000000 011000                    NOP     0

  26288 27 003100   000005 220003                    LDX0    5,DU
        27 003101   000000 470400 10                 LDP0    ILL$
        27 003102   000000 440100                    SXL0    0,,PR0

  26290 27 003103   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003104   000000 470400 10                 LDP0    ILL$
        27 003105   000001 756100                    STQ     1,,PR0

  26291 27 003106   200003 471500                    LDP1    @FILE$,,AUTO
        27 003107   100000 473500                    LDP3    0,,PR1
        27 003110   300027 236100                    LDQ     23,,PR3
        27 003111   000002 756100                    STQ     2,,PR0

      776    26445
      777    26446        /* Retention */
      778    26447        %PTR_PRESET (@FIELD = RETENTION$,
      779    26448                     @OFFSET = 6);

  26674 27 003112   000003 236000 28                 LDQ     3
        27 003113   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003114   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003115   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003116   000004 236000 28                 LDQ     4
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:134  
        27 003117   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003120   000006 237000 28                 LDAQ    6
        27 003121   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003122   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003123   000000 631400 28                 EPPR1   0
        27 003124   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003125   000000 011000                    NOP     0

  26678 27 003126   000006 220003                    LDX0    6,DU
        27 003127   000000 470400 10                 LDP0    ILL$
        27 003130   000000 440100                    SXL0    0,,PR0

  26680 27 003131   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003132   000000 470400 10                 LDP0    ILL$
        27 003133   000001 756100                    STQ     1,,PR0

  26681 27 003134   200003 471500                    LDP1    @FILE$,,AUTO
        27 003135   100000 473500                    LDP3    0,,PR1
        27 003136   300030 236100                    LDQ     24,,PR3
        27 003137   000002 756100                    STQ     2,,PR0

      780    26835
      781    26836        /* Catalog */
      782    26837        %PTR_PRESET (@FIELD = CATALOG$,
      783    26838                     @OFFSET = 7);

  27064 27 003140   000003 236000 28                 LDQ     3
        27 003141   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003142   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003143   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003144   000004 236000 28                 LDQ     4
        27 003145   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003146   000006 237000 28                 LDAQ    6
        27 003147   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003150   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003151   000000 631400 28                 EPPR1   0
        27 003152   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:135  
        27 003153   000000 011000                    NOP     0

  27068 27 003154   000007 220003                    LDX0    7,DU
        27 003155   000000 470400 10                 LDP0    ILL$
        27 003156   000000 440100                    SXL0    0,,PR0

  27070 27 003157   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003160   000000 470400 10                 LDP0    ILL$
        27 003161   000001 756100                    STQ     1,,PR0

  27071 27 003162   200003 471500                    LDP1    @FILE$,,AUTO
        27 003163   100000 473500                    LDP3    0,,PR1
        27 003164   300031 236100                    LDQ     25,,PR3
        27 003165   000002 756100                    STQ     2,,PR0

      784    27225
      785    27226        /* Linage lines */
      786    27227        %PTR_PRESET (@FIELD = LINAGE.NO_OF_LINES$,
      787    27228                     @OFFSET = 8);

  27454 27 003166   000003 236000 28                 LDQ     3
        27 003167   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003170   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003171   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003172   000004 236000 28                 LDQ     4
        27 003173   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003174   000006 237000 28                 LDAQ    6
        27 003175   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003176   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003177   000000 631400 28                 EPPR1   0
        27 003200   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003201   000000 011000                    NOP     0

  27458 27 003202   000010 220003                    LDX0    8,DU
        27 003203   000000 470400 10                 LDP0    ILL$
        27 003204   000000 440100                    SXL0    0,,PR0

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:136  
  27460 27 003205   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003206   000000 470400 10                 LDP0    ILL$
        27 003207   000001 756100                    STQ     1,,PR0

  27461 27 003210   200003 471500                    LDP1    @FILE$,,AUTO
        27 003211   100000 473500                    LDP3    0,,PR1
        27 003212   300033 236100                    LDQ     27,,PR3
        27 003213   000002 756100                    STQ     2,,PR0

      788    27615
      789    27616        /* Footing */
      790    27617        %PTR_PRESET (@FIELD = LINAGE.FOOTING$,
      791    27618                     @OFFSET = 9);

  27844 27 003214   000003 236000 28                 LDQ     3
        27 003215   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003216   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003217   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003220   000004 236000 28                 LDQ     4
        27 003221   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003222   000006 237000 28                 LDAQ    6
        27 003223   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003224   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003225   000000 631400 28                 EPPR1   0
        27 003226   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003227   000000 011000                    NOP     0

  27848 27 003230   000011 220003                    LDX0    9,DU
        27 003231   000000 470400 10                 LDP0    ILL$
        27 003232   000000 440100                    SXL0    0,,PR0

  27850 27 003233   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003234   000000 470400 10                 LDP0    ILL$
        27 003235   000001 756100                    STQ     1,,PR0

  27851 27 003236   200003 471500                    LDP1    @FILE$,,AUTO
        27 003237   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:137  
        27 003240   300034 236100                    LDQ     28,,PR3
        27 003241   000002 756100                    STQ     2,,PR0

      792    28005
      793    28006        /* Top */
      794    28007        %PTR_PRESET (@FIELD = LINAGE.TOP$,
      795    28008                     @OFFSET = 10);

  28234 27 003242   000003 236000 28                 LDQ     3
        27 003243   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003244   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003245   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003246   000004 236000 28                 LDQ     4
        27 003247   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003250   000006 237000 28                 LDAQ    6
        27 003251   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003252   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003253   000000 631400 28                 EPPR1   0
        27 003254   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003255   000000 011000                    NOP     0

  28238 27 003256   000012 220003                    LDX0    10,DU
        27 003257   000000 470400 10                 LDP0    ILL$
        27 003260   000000 440100                    SXL0    0,,PR0

  28240 27 003261   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003262   000000 470400 10                 LDP0    ILL$
        27 003263   000001 756100                    STQ     1,,PR0

  28241 27 003264   200003 471500                    LDP1    @FILE$,,AUTO
        27 003265   100000 473500                    LDP3    0,,PR1
        27 003266   300035 236100                    LDQ     29,,PR3
        27 003267   000002 756100                    STQ     2,,PR0

      796    28395
      797    28396        /* Bottom */
      798    28397        %PTR_PRESET (@FIELD = LINAGE.BOTTOM$,
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:138  
      799    28398                     @OFFSET = 11);

  28624 27 003270   000003 236000 28                 LDQ     3
        27 003271   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003272   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003273   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003274   000004 236000 28                 LDQ     4
        27 003275   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003276   000006 237000 28                 LDAQ    6
        27 003277   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003300   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003301   000000 631400 28                 EPPR1   0
        27 003302   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003303   000000 011000                    NOP     0

  28628 27 003304   000013 220003                    LDX0    11,DU
        27 003305   000000 470400 10                 LDP0    ILL$
        27 003306   000000 440100                    SXL0    0,,PR0

  28630 27 003307   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003310   000000 470400 10                 LDP0    ILL$
        27 003311   000001 756100                    STQ     1,,PR0

  28631 27 003312   200003 471500                    LDP1    @FILE$,,AUTO
        27 003313   100000 473500                    LDP3    0,,PR1
        27 003314   300036 236100                    LDQ     30,,PR3
        27 003315   000002 756100                    STQ     2,,PR0

      800    28785
      801    28786        /* Linage Counter */
      802    28787    2   IF FILE$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = ADDR(NIL) THEN

  28787 27 003316   100000 473500                    LDP3    0,,PR1
        27 003317   300033 236100                    LDQ     27,,PR3
        27 003320   000016 116000 28                 CMPQ    14
        27 003321   003351 601000 27                 TNZ     s:29178

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:139  
      803    28788          %PTR_PRESET(@FIELD = LINAGE.NO_OF_LINES$,
      804    28789                      @OFFSET = 12);

  29015 27 003322   000003 236000 28                 LDQ     3
        27 003323   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003324   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003325   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003326   000004 236000 28                 LDQ     4
        27 003327   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003330   000006 237000 28                 LDAQ    6
        27 003331   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003332   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003333   000000 631400 28                 EPPR1   0
        27 003334   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003335   000000 011000                    NOP     0

  29019 27 003336   000014 220003                    LDX0    12,DU
        27 003337   000000 470400 10                 LDP0    ILL$
        27 003340   000000 440100                    SXL0    0,,PR0

  29021 27 003341   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003342   000000 470400 10                 LDP0    ILL$
        27 003343   000001 756100                    STQ     1,,PR0

  29022 27 003344   200003 471500                    LDP1    @FILE$,,AUTO
        27 003345   100000 473500                    LDP3    0,,PR1
        27 003346   300033 236100                    LDQ     27,,PR3
        27 003347   000002 756100                    STQ     2,,PR0

  29174 27 003350   003376 710000 27                 TRA     s:29413

      805    29176    2   ELSE
      806    29177    3     DO;

      807    29178    3       ROP$$ = FILE$ -> FILE_LTS.ST$ -> FD.QLT$ -> QLT.SON;

  29178 27 003351   300001 474500                    LDP4    1,,PR3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:140  
        27 003352   400007 475500                    LDP5    7,,PR4
        27 003353   500003 236100                    LDQ     3,,PR5
        27 003354   200110 756100                    STQ     ROP$$,,AUTO

      808    29179    4       DO WHILE (ROP$$ -> QLT.BROTHER ~= ADDR(NIL));

  29179 27 003355   003361 710000 27                 TRA     s:29181

      809    29180    4         ROP$$ = ROP$$ -> QLT.BROTHER;

  29180 27 003356   200110 470500                    LDP0    ROP$$,,AUTO
        27 003357   000002 236100                    LDQ     2,,PR0
        27 003360   200110 756100                    STQ     ROP$$,,AUTO

      810    29181    4       END;

  29181 27 003361   200110 470500                    LDP0    ROP$$,,AUTO
        27 003362   000002 236100                    LDQ     2,,PR0
        27 003363   000016 116000 28                 CMPQ    14
        27 003364   003356 601000 27                 TNZ     s:29180

      811    29182    3       CALL PTR_SET( FAB_V$, ROP$$ -> QLT.ST$, 12 );

  29182 27 003365   000071 236000 28                 LDQ     57
        27 003366   200155 756100                    STQ     @NUM,,AUTO
        27 003367   200110 236100                    LDQ     ROP$$,,AUTO
        27 003370   000004 036003                    ADLQ    4,DU
        27 003371   200154 756100                    STQ     @RETURN_VAL,,AUTO
        27 003372   200115 631500                    EPPR1   FAB_V$,,AUTO
        27 003373   200153 451500                    STP1    @UNIT_RECORD,,AUTO
        27 003374   000003 701000 27                 TSX1    PTR_SET
        27 003375   000000 011000                    NOP     0

      812    29183    3     END;

      813    29184
      814    29185        /* Buffer */
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:141  
      815    29186        %PTR_PRESET(@FIELD = ST$,
      816    29187                    @OFFSET = 13);

  29413 27 003376   000003 236000 28                 LDQ     3
        27 003377   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003400   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 003401   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 003402   000004 236000 28                 LDQ     4
        27 003403   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003404   000006 237000 28                 LDAQ    6
        27 003405   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003406   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003407   000000 631400 28                 EPPR1   0
        27 003410   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003411   000000 011000                    NOP     0

  29417 27 003412   000015 220003                    LDX0    13,DU
        27 003413   000000 470400 10                 LDP0    ILL$
        27 003414   000000 440100                    SXL0    0,,PR0

  29419 27 003415   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003416   000000 470400 10                 LDP0    ILL$
        27 003417   000001 756100                    STQ     1,,PR0

  29420 27 003420   200003 471500                    LDP1    @FILE$,,AUTO
        27 003421   100000 473500                    LDP3    0,,PR1
        27 003422   300001 236100                    LDQ     1,,PR3
        27 003423   000002 756100                    STQ     2,,PR0

      817    29574
      818    29575        /* Relative key */
      819    29576        %PTR_PRESET (@FIELD = RELATIVE_KEY$,
      820    29577                     @OFFSET = 14);

  29803 27 003424   000003 236000 28                 LDQ     3
        27 003425   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003426   200160 633500                    EPPR3   @RETURN$+2,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:142  
        27 003427   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003430   000004 236000 28                 LDQ     4
        27 003431   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003432   000006 237000 28                 LDAQ    6
        27 003433   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003434   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003435   000000 631400 28                 EPPR1   0
        27 003436   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003437   000000 011000                    NOP     0

  29807 27 003440   000016 220003                    LDX0    14,DU
        27 003441   000000 470400 10                 LDP0    ILL$
        27 003442   000000 440100                    SXL0    0,,PR0

  29809 27 003443   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003444   000000 470400 10                 LDP0    ILL$
        27 003445   000001 756100                    STQ     1,,PR0

  29810 27 003446   200003 471500                    LDP1    @FILE$,,AUTO
        27 003447   100000 473500                    LDP3    0,,PR1
        27 003450   300014 236100                    LDQ     12,,PR3
        27 003451   000002 756100                    STQ     2,,PR0

      821    29964
      822    29965        /* Record key */
      823    29966        %PTR_PRESET (@FIELD = RECORD_KEY$,
      824    29967                     @OFFSET = 15);

  30193 27 003452   000003 236000 28                 LDQ     3
        27 003453   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003454   200160 633500                    EPPR3   @RETURN$+2,,AUTO
        27 003455   200165 453500                    STP3    @RETURN$+7,,AUTO
        27 003456   000004 236000 28                 LDQ     4
        27 003457   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003460   000006 237000 28                 LDAQ    6
        27 003461   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003462   200162 630500                    EPPR0   @RETURN$+4,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:143  
        27 003463   000000 631400 28                 EPPR1   0
        27 003464   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003465   000000 011000                    NOP     0

  30197 27 003466   000017 220003                    LDX0    15,DU
        27 003467   000000 470400 10                 LDP0    ILL$
        27 003470   000000 440100                    SXL0    0,,PR0

  30199 27 003471   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003472   000000 470400 10                 LDP0    ILL$
        27 003473   000001 756100                    STQ     1,,PR0

  30200 27 003474   200003 471500                    LDP1    @FILE$,,AUTO
        27 003475   100000 473500                    LDP3    0,,PR1
        27 003476   300015 236100                    LDQ     13,,PR3
        27 003477   000002 756100                    STQ     2,,PR0

      825    30354
      826    30355        /* Alt key */
      827    30356    2   CALL NEW_ALT_KEYS (FAB_V$,

  30356 27 003500   000073 236000 28                 LDQ     59
        27 003501   200003 235100                    LDA     @FILE$,,AUTO
        27 003502   200126 757100                    STAQ    @FILE$,,AUTO
        27 003503   200115 633500                    EPPR3   FAB_V$,,AUTO
        27 003504   200125 453500                    STP3    @ALT$,,AUTO
        27 003505   001447 701000 27                 TSX1    NEW_ALT_KEYS
        27 003506   000000 011000                    NOP     0

      828    30357    2                     FILE$,
      829    30358    2                     16);
      830    30359
      831    30360        /* Use block */
      832    30361    2   CALL NEW_USE_BLOCK (FAB_V$,

  30361 27 003507   000075 236000 28                 LDQ     61
        27 003510   200003 235100                    LDA     @FILE$,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:144  
        27 003511   200126 757100                    STAQ    @FILE$,,AUTO
        27 003512   200115 630500                    EPPR0   FAB_V$,,AUTO
        27 003513   200125 450500                    STP0    @ALT$,,AUTO
        27 003514   001352 701000 27                 TSX1    NEW_USE_BLOCK
        27 003515   000000 011000                    NOP     0

      833    30362    2                       FILE$,
      834    30363    2                       17);
      835    30364
      836    30365        /* Use proc */
      837    30366    2   IF FILE$ -> FILE_LTS.USE_PROC_LABEL_EPTR = EPTR_NIL_VAL   THEN

  30366 27 003516   200003 470500                    LDP0    @FILE$,,AUTO
        27 003517   000000 471500                    LDP1    0,,PR0
        27 003520   100052 236100                    LDQ     42,,PR1
        27 003521   000016 116000 24                 CMPQ    EPTR_NIL_VAL
        27 003522   003613 601000 27                 TNZ     s:30995

      838    30367    2   NIL_USE:
      839    30368    3     DO;

  30368 27 003523                       NIL_USE      null
      840    30369    3       IF (FILE$ -> FILE_LTS.B.EXTERNAL OR FILE$ -> FILE_LTS.B.BLOCK) AND

  30369 27 003523   100017 236100                    LDQ     15,,PR1
        27 003524   000400 316003                    CANQ    256,DU
        27 003525   003530 601000 27                 TNZ     NIL_USE+5
        27 003526   000010 316007                    CANQ    8,DL
        27 003527   003553 600000 27                 TZE     s:30380
        27 003530   000045 234000 xsym               SZN     COMCOM+37
        27 003531   003553 604000 27                 TMI     s:30380

      841    30370    3           NOT COMCOM.OB.MAIN_PROG THEN
      842    30371    4         DO;

      843    30372    4           IF COMCOM.OB.SUB THEN EXIT NIL_USE;

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:145  
  30372 27 003532   000062 234000 xsym               SZN     COMCOM+50
        27 003533   003612 604000 27                 TMI     s:30766

      844    30373    4           PROC$ = FILE$ -> FILE_LTS.ST$ -> FD.PROC$;

  30373 27 003534   100001 473500                    LDP3    1,,PR1
        27 003535   300011 236100                    LDQ     9,,PR3
        27 003536   200123 756100                    STQ     PROC$,,AUTO

      845    30374    5           DO WHILE PROC$ -> PROC_.FATHER ~= ADDR (NIL);

  30374 27 003537   003543 710000 27                 TRA     s:30376

      846    30375    5             PROC$ = PROC$ -> PROC_.FATHER;

  30375 27 003540   200123 470500                    LDP0    PROC$,,AUTO
        27 003541   000011 236100                    LDQ     9,,PR0
        27 003542   200123 756100                    STQ     PROC$,,AUTO

      847    30376    5           END;

  30376 27 003543   200123 470500                    LDP0    PROC$,,AUTO
        27 003544   000011 236100                    LDQ     9,,PR0
        27 003545   000016 116000 28                 CMPQ    14
        27 003546   003540 601000 27                 TNZ     s:30375

      848    30377    4           IF PROC$ -> PROC_.PROC_DEF$ -> PROC_DEF.ARGLIST$ ~= ADDR (NIL) THEN

  30377 27 003547   000006 471500                    LDP1    6,,PR0
        27 003550   100005 236100                    LDQ     5,,PR1
        27 003551   000016 116000 28                 CMPQ    14
        27 003552   003612 601000 27                 TNZ     s:30766

      849    30378    4             EXIT NIL_USE;
      850    30379    4         END;

      851    30380    3       MKCN.CON = EPTR_NIL;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:146  

  30380 27 003553   000016 235000 24                 LDA     EPTR_NIL_VAL
        27 003554   000000 755000 16                 STA     MKCN

      852    30381    3       CALL Z8AC$MAKE_CONST( EPTR_NIL_CONST$ );

  30381 27 003555   200120 630500                    EPPR0   EPTR_NIL_CONST$,,AUTO
        27 003556   200160 450500                    STP0    @RETURN$+2,,AUTO
        27 003557   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 003560   000011 631400 28                 EPPR1   9
        27 003561   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        27 003562   000000 011000                    NOP     0

      853    30382
      854    30383            %NEW_ILL( @ID = %PREOFF,
      855    30384                      @LOP = FAB_V$,
      856    30385                      @OFFSET = 18,
      857    30386                      @N = 1,
      858    30387                      @ROP = EPTR_NIL_CONST$ -> ETT.LOP );

  30616 27 003563   000003 236000 28                 LDQ     3
        27 003564   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003565   200160 630500                    EPPR0   @RETURN$+2,,AUTO
        27 003566   200165 450500                    STP0    @RETURN$+7,,AUTO
        27 003567   000004 236000 28                 LDQ     4
        27 003570   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003571   000100 237000 28                 LDAQ    64
        27 003572   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003573   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003574   000000 631400 28                 EPPR1   0
        27 003575   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003576   000000 011000                    NOP     0

  30620 27 003577   000022 220003                    LDX0    18,DU
        27 003600   000000 470400 10                 LDP0    ILL$
        27 003601   000000 440100                    SXL0    0,,PR0

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:147  
  30625 27 003602   000001 235007                    LDA     1,DL
        27 003603   000000 470400 10                 LDP0    ILL$
        27 003604   000003 755100                    STA     3,,PR0

  30627 27 003605   200115 236100                    LDQ     FAB_V$,,AUTO
        27 003606   000001 756100                    STQ     1,,PR0

  30628 27 003607   200120 471500                    LDP1    EPTR_NIL_CONST$,,AUTO
        27 003610   100001 236100                    LDQ     1,,PR1
        27 003611   000002 756100                    STQ     2,,PR0

      859    30766    3     END; /* NIL_USE */

  30766 27 003612   003641 710000 27                 TRA     s:31157

      860    30767    2   ELSE
      861    30768          %PTR_PRESET (@FIELD = USE_PROC_LABEL$,
      862    30769                       @OFFSET = 18);

  30995 27 003613   000003 236000 28                 LDQ     3
        27 003614   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003615   200160 631500                    EPPR1   @RETURN$+2,,AUTO
        27 003616   200165 451500                    STP1    @RETURN$+7,,AUTO
        27 003617   000004 236000 28                 LDQ     4
        27 003620   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003621   000006 237000 28                 LDAQ    6
        27 003622   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003623   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003624   000000 631400 28                 EPPR1   0
        27 003625   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003626   000000 011000                    NOP     0

  30999 27 003627   000022 220003                    LDX0    18,DU
        27 003630   000000 470400 10                 LDP0    ILL$
        27 003631   000000 440100                    SXL0    0,,PR0

  31001 27 003632   200115 236100                    LDQ     FAB_V$,,AUTO
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:148  
        27 003633   000000 470400 10                 LDP0    ILL$
        27 003634   000001 756100                    STQ     1,,PR0

  31002 27 003635   200003 471500                    LDP1    @FILE$,,AUTO
        27 003636   100000 473500                    LDP3    0,,PR1
        27 003637   300052 236100                    LDQ     42,,PR3
        27 003640   000002 756100                    STQ     2,,PR0

      863    31156
      864    31157    2   END INIT_FAB_VAR;

  31157 27 003641   200122 221300                    LDX1  ! EPTR_NIL_CONST$+2,,AUTO
        27 003642   000001 702211                    TSX2  ! 1,X1

      865    31158        %EJECT;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:149  
      866    31159             /*
      867    31160                      Main Procedure
      868    31161             */
      869    31162
      870    31163    1        IF FILE$ -> FILE_LTS.ST$ -> ST.ID ~= %FD    OR   /*  NOT SORT  */

  31163 27 003643   200003 470500                    LDP0    @FILE$,,AUTO
        27 003644   000000 471500                    LDP1    0,,PR0
        27 003645   100001 473500                    LDP3    1,,PR1
        27 003646   300000 220100                    LDX0    0,,PR3
        27 003647   001002 100003                    CMPX0   514,DU
        27 003650   003655 601000 27                 TNZ     s:31165
        27 003651   100002 474500                    LDP4    2,,PR1
        27 003652   400003 236100                    LDQ     3,,PR4
        27 003653   000100 316007                    CANQ    64,DL
        27 003654   003656 600000 27                 TZE     s:31171

      871    31164    1             FILE$ -> FILE_LTS.FAB$ -> SCALAR.B.FAB_FIB_BUILT    THEN
      872    31165    1           RETURN;

  31165 27 003655   000000 702200 xent               TSX2  ! X66_ARET

      873    31166
      874    31167             %SET_PHASE_1_POSITION (@LINE = FILE$ -> FILE_LTS.ST$ -> FD.LINE_NO,
      875    31168                                    @COLUMN = 0,
      876    31169                                    @TYPE   = %S_TYPE_VALUE_IS);

  31171 27 003656   300002 236100                    LDQ     2,,PR3
        27 003657   777777 376007                    ANQ     -1,DL
        27 003660   000007 756000 xsym               STQ     O1COM+7

  31172 27 003661   000010 450000 xsym               STZ     O1COM+8

  31173 27 003662   000011 235000 xsym               LDA     O1COM+9
        27 003663   003700 600000 27                 TZE     s:31555

  31208 27 003664   000003 236000 28                 LDQ     3
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:150  
        27 003665   200160 756100                    STQ     @RETURN$+2,,AUTO
        27 003666   200160 631500                    EPPR1   @RETURN$+2,,AUTO
        27 003667   200165 451500                    STP1    @RETURN$+7,,AUTO
        27 003670   000004 236000 28                 LDQ     4
        27 003671   200164 756100                    STQ     @RETURN$+6,,AUTO
        27 003672   000102 237000 28                 LDAQ    66
        27 003673   200162 757100                    STAQ    @RETURN$+4,,AUTO
        27 003674   200162 630500                    EPPR0   @RETURN$+4,,AUTO
        27 003675   000000 631400 28                 EPPR1   0
        27 003676   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        27 003677   000000 011000                    NOP     0

  31555 27 003700   000076 235007                    LDA     62,DL
        27 003701   000011 755000 xsym               STA     O1COM+9

      877    31558
      878    31559    1        IF FILE$ -> FILE_LTS.DCB_DNT$ = ADDR(NIL)  THEN   /*#34313*/

  31559 27 003702   200003 470500                    LDP0    @FILE$,,AUTO
        27 003703   000000 471500                    LDP1    0,,PR0
        27 003704   100051 236100                    LDQ     41,,PR1
        27 003705   000016 116000 28                 CMPQ    14
        27 003706   003713 601000 27                 TNZ     s:31562

      879    31560    1          F_DNT$ = FILE$ -> FILE_LTS.ST$ -> FD.DNT$;

  31560 27 003707   100001 473500                    LDP3    1,,PR1
        27 003710   300006 236100                    LDQ     6,,PR3
        27 003711   200105 756100                    STQ     F_DNT$,,AUTO
        27 003712   003714 710000 27                 TRA     s:31564

      880    31561    1        ELSE
      881    31562    1          F_DNT$ = FILE$ -> FILE_LTS.DCB_DNT$;

  31562 27 003713   200105 756100                    STQ     F_DNT$,,AUTO

      882    31563
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:151  
      883    31564    1        FAB$ = FILE$ -> FILE_LTS.FAB$;

  31564 27 003714   000000 471500                    LDP1    0,,PR0
        27 003715   100002 236100                    LDQ     2,,PR1
        27 003716   200111 756100                    STQ     FAB$,,AUTO

      884    31565    1        FAB$ -> SCALAR.B.FAB_FIB_BUILT = %TRUE;

  31565 27 003717   200111 473500                    LDP3    FAB$,,AUTO
        27 003720   000100 236007                    LDQ     64,DL
        27 003721   300003 256100                    ORSQ    3,,PR3

      885    31566
      886    31567
      887    31568             /* Build and initialize the constant portion of the FAB */
      888    31569
      889    31570    1        FAB_C$ = FAB$ -> SCALAR.QLT$ -> QLT.SON -> QLT.ST$;

  31570 27 003722   300007 471500                    LDP1    7,,PR3
        27 003723   100003 474500                    LDP4    3,,PR1
        27 003724   400004 236100                    LDQ     4,,PR4
        27 003725   200114 756100                    STQ     FAB_C$,,AUTO

      890    31571
      891    31572    1        CALL INIT_FAB_CONST;

  31572 27 003726   002200 701000 27                 TSX1    INIT_FAB_CONST
        27 003727   000000 011000                    NOP     0

      892    31573
      893    31574
      894    31575             /* Build the Length_read and DCBNUM fields of the Fab;
      895    31576                These fields have explicit symbol table items so that
      896    31577                    they can be referenced by the compiler
      897    31578             */
      898    31579
      899    31580    1        CALL PRESET( FILE$ -> FILE_LTS.LENGTH_READ$, COMCOM.VALUE_0 -> ETT.LOP);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:152  

  31580 27 003730   200003 470500                    LDP0    @FILE$,,AUTO
        27 003731   000000 471500                    LDP1    0,,PR0
        27 003732   000124 236000 xsym               LDQ     COMCOM+84
        27 003733   000001 036003                    ADLQ    1,DU
        27 003734   200156 756100                    STQ     @NUM+1,,AUTO
        27 003735   100053 633500                    EPPR3   43,,PR1
        27 003736   200155 453500                    STP3    @RETURN_VAL+1,,AUTO
        27 003737   000035 701000 27                 TSX1    PRESET
        27 003740   000000 011000                    NOP     0

      900    31581
      901    31582    1        DCBNUM$ = FILE$ -> FILE_LTS.LENGTH_READ$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.
             31582                 ST$;

  31582 27 003741   200003 470500                    LDP0    @FILE$,,AUTO
        27 003742   000000 471500                    LDP1    0,,PR0
        27 003743   100053 473500                    LDP3    43,,PR1
        27 003744   300007 474500                    LDP4    7,,PR3
        27 003745   400002 475500                    LDP5    2,,PR4
        27 003746   500004 236100                    LDQ     4,,PR5
        27 003747   200113 756100                    STQ     DCBNUM$,,AUTO

      902    31583
      903    31584    1        CALL NEW_DCB (UNIT_RECORD,

  31584 27 003750   200113 631500                    EPPR1   DCBNUM$,,AUTO
        27 003751   200125 451500                    STP1    LCONST$+1,,AUTO
        27 003752   200003 236100                    LDQ     @FILE$,,AUTO
        27 003753   200124 756100                    STQ     PROC$+1,,AUTO
        27 003754   200117 633500                    EPPR3   UNIT_RECORD,,AUTO
        27 003755   200123 453500                    STP3    EPTR_NIL_CONST$+3,,AUTO
        27 003756   000432 701000 27                 TSX1    NEW_DCB
        27 003757   000000 011000                    NOP     0

      904    31585    1                      FILE$,
      905    31586    1                      DCBNUM$);
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:153  
      906    31587
      907    31588             /* Build the variable portion of the FAB;  This portion is
      908    31589                    initialized by PRESET/PTR_SET ILL items */
      909    31590
      910    31591    1        FAB_V$ = DCBNUM$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$;

  31591 27 003760   200113 470500                    LDP0    DCBNUM$,,AUTO
        27 003761   000007 471500                    LDP1    7,,PR0
        27 003762   100002 473500                    LDP3    2,,PR1
        27 003763   300004 236100                    LDQ     4,,PR3
        27 003764   200115 756100                    STQ     FAB_V$,,AUTO

      911    31592
      912    31593    1        CALL INIT_FAB_VAR;

  31593 27 003765   002725 701000 27                 TSX1    INIT_FAB_VAR
        27 003766   000000 011000                    NOP     0

      913    31594
      914    31595    1        CALL INIT_DCB (UNIT_RECORD, FILE$, DCBNUM$);

  31595 27 003767   200113 630500                    EPPR0   DCBNUM$,,AUTO
        27 003770   200125 450500                    STP0    LCONST$+1,,AUTO
        27 003771   200003 236100                    LDQ     @FILE$,,AUTO
        27 003772   200124 756100                    STQ     PROC$+1,,AUTO
        27 003773   200117 631500                    EPPR1   UNIT_RECORD,,AUTO
        27 003774   200123 451500                    STP1    EPTR_NIL_CONST$+3,,AUTO
        27 003775   000551 701000 27                 TSX1    INIT_DCB
        27 003776   000000 011000                    NOP     0

      915    31596
      916    31597             /* finish up */
      917    31598
      918    31599    1   END Z9EW$IO_INTERFACE;

  31599 27 003777   000000 702200 xent               TSX2  ! X66_ARET
      919    31600        %EOD;
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:154  

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:155  
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z9EW$IO_INTERFACE.
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:156  

 **** Variables and constants ****

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 002 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 003 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 004 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 005 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:157  
  ****  Section 006 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 007 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 008 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 009 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 010 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 011 LblCom ILL_

PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:158  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 012 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 013 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 014 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 015 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 016 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:159  

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 017 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 018 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 019 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 020 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 021 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:160  

  ****  Section 022 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 023 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 024 RoData Z9EW$IO_INTERFACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w SBIN        r     1 EPTR_NIL                  16-0-0/w EPTR        r     1 EPTR_NIL_VAL
     0-0-0/d STRC(504)         1 XSA_PARAM

  ****  Section 026  Data  Z9EW$IO_INTERFACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DCB_ST$                    2-0-0/d STRC(2088)  r     1 FAKE_OPEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   125-0-0/w PTR         r     1 @ALT$                    125-0-0/w PTR         r     1 @BLOCK$
   125-0-0/w PTR         r     1 @DCB_NUM$                144-0-0/w PTR         r     1 @FAB_KEY$
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:161  
     3-0-0/w PTR         r     1 @FILE$                   126-0-0/w PTR         r     1 @FILE$
   126-0-0/w PTR         r     1 @FILE$                   127-0-0/w PTR         r     1 @FILE$
   124-0-0/w PTR         r     1 @FILE_LTS$               143-0-0/w PTR         r     1 @KEY_ST$
   153-0-0/w PTR         r     1 @LOP                     155-0-0/w PTR         r     1 @LOP
   155-0-0/w PTR         r     1 @NUM                     155-0-0/w PTR         r     1 @OFFSET
   127-0-0/w PTR         r     1 @OFFSET                  127-0-0/w PTR         r     1 @OFFSET
   156-0-0/w PTR         r     1 @RETURN$                 153-0-0/w PTR         r     1 @RETURN_VAL
   154-0-0/w PTR         r     1 @RETURN_VAL              127-0-0/w PTR         r     1 @RETURN_VAL
   130-0-0/w PTR         r     1 @RETURN_VAL              154-0-0/w PTR         r     1 @ROP
   156-0-0/w PTR         r     1 @ROP                     145-0-0/w PTR         r     1 @UNIQUE
   154-0-0/w PTR         r     1 @UNIT_RECORD             153-0-0/w PTR         r     1 @UNIT_RECORD
   123-0-0/w PTR         r     1 @UNIT_RECORD              *0-0-0/w PTR         r     1 ALT$
   106-0-0/w PTR               1 ALT_KEY$                 132-0-0/w PTR         r     1 ALT_KEY$
    *0-0-0/w PTR         r     1 BLOCK$                   126-0-0/w PTR         r     1 DCB$
   113-0-0/w PTR         r     1 DCBNUM$                  131-0-0/w PTR         r     1 DCB_ADDR$
   127-0-0/w UBIN        r     1 DCB_LEN                  130-0-0/w UBIN        r     1 DCB_LEN_NO_NAME
   133-0-0/w PTR         r     1 DCB_NAME$                 *0-0-0/w PTR         r     1 DCB_NUM$
   147-0-0/w PTR         r     1 DCB_TEMPLATE$            146-0-0/w PTR         r     1 DCB_VAR$
     4-0-0/w STRC        r     1 DESC                     116-0-0/w PTR               1 DNT$$
   120-0-0/w PTR         r     1 EPTR_NIL_CONST$            6-0-0/d STRC(2232)        1 FAB
   111-0-0/w PTR         r     1 FAB$                     131-0-0/w STRC        r     1 FAB_BITS
   114-0-0/w PTR         r     1 FAB_C$                   123-0-0/w PTR         r     1 FAB_CONST$
    *0-0-0/w PTR         r     1 FAB_KEY$                 115-0-0/w PTR         r     1 FAB_V$
    *0-0-0/w PTR         r     1 FILE$                     *0-0-0/w PTR         r     1 FILE$
    *0-0-0/w PTR         r     1 FILE$                     *0-0-0/w PTR         r     1 FILE$
   130-0-0/w PTR         r     1 FILE_DNT$                 *0-0-0/w PTR         r     1 FILE_LTS$
   105-0-0/w PTR         r     1 F_DNT$                   131-0-0/w SBIN        r     1 I
   140-0-0/w UBIN        r     1 KEY#                     141-0-0/c CHAR(2)     r     1 KEY#_TEXT
    *0-0-0/w PTR         r     1 KEY_ST$                  124-0-0/w PTR         r     1 LCONST$
   104-0-0/w SBIN              1 LEN                      145-0-0/w SBIN              1 LENGTH
    *0-0-0/w PTR         r     1 LOP                       *0-0-0/w PTR         r     1 LOP
   107-0-0/w UBIN              1 MAX_BOUND                135-0-0/c CHAR(10)    r     1 NAME
    *0-0-0/w SBIN        r     1 NUM                       *0-0-0/w SBIN        r     1 OFFSET
    *0-0-0/w SBIN        r     1 OFFSET                    *0-0-0/w SBIN        r     1 OFFSET
   146-0-0/w SBIN        r     1 OFFSET                   132-0-0/w PTR               1 P$
   131-0-0/w PTR         r     1 P$                       123-0-0/w PTR         r     1 PROC$
    *0-0-0/w PTR         r     1 RETURN$                  125-0-0/w PTR         r     1 RETURN$
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:162  
   130-0-0/w PTR         r     1 RETURN$                   *0-0-0/w SBIN        r     1 RETURN_VAL
    *0-0-0/w SBIN        r     1 RETURN_VAL                *0-0-0/w SBIN        r     1 RETURN_VAL
   150-0-0/w SBIN        r     1 RETURN_VAL                *0-0-0/w BIT         r     1 RETURN_VAL
    *0-0-0/w PTR         r     1 ROP                       *0-0-0/w PTR         r     1 ROP
   110-0-0/w PTR         r     1 ROP$$                    134-0-0/w PTR         r     1 ROP$$
   147-0-0/w PTR         r     1 ROP$$                    134-0-0/w PTR               1 RTN$
   135-0-0/c CHAR(31)          1 STAR_NAME                133-0-0/w BIT         r     1 UNIQUE
    *0-0-0/w BIT         r     1 UNIQUE                   117-0-0/w BIT         r     1 UNIT_RECORD
    *0-0-0/w BIT         r     1 UNIT_RECORD               *0-0-0/w BIT         r     1 UNIT_RECORD
    *0-0-0/w BIT         r     1 UNIT_RECORD              112-0-0/w PTR               1 USE_BLOCK$
   150-0-0/d STRC(108)   r     1 VLP_ALT_KEY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)  r     1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:163  
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/d ASTR(3528)  r     1 DCBN                       0-0-0/w STRC(396)   r     1 DCB_
     0-0-0/c ACHR        r     1 DCB_BASED                  0-0-0N  NULL        r     1 DCB_TEMPLATE
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(972)   r     1 FAB_CONST_LENGTH
     0-0-0/d STRC(1224)        1 FAB_VAR_LENGTH             0-0-0/w STRC(396)   r     1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864) r     1 LCNST
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)    r     1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:164  
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)   r     1 PREOFF                     0-0-0/w STRC(108)   r     1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)   r     1 PROC_DEF                   0-0-0/w STRC(900)   r     1 PROC_SUPP
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(216)   r     1 QLT                        0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z9EW$IO_INTERFACE requires 2048 words for executable code.
PL6.E3A0      #001=Z9EW$IO_INTERFACE File=Z9EW.:Z8A6TSI                          SAT 08/09/97 13:51 Page:165  
   Procedure Z9EW$IO_INTERFACE requires 120 words of local(AUTO) storage.

PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:166  
      920        1        /*T***********************************************************/
      921        2        /*T*                                                         */
      922        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      923        4        /*T*                                                         */
      924        5        /*T***********************************************************/
      925        6        /*================*/
      926        7          Z9EW$OPEN_WRAPUP :  PROC ( OPEN_LTS$ );
      927        8        /*================*/
      928        9
      929       10    1     DCL OPEN_LTS$     PTR;
      930       11
      931       12    1     RETURN;          /*  NOT USED FOR CP-6    */
      932       13
      933       14    1   END Z9EW$OPEN_WRAPUP;

PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:167  
      No diagnostics issued in procedure Z9EW$OPEN_WRAPUP.

   Procedure Z9EW$OPEN_WRAPUP requires 3 words for executable code.
   Procedure Z9EW$OPEN_WRAPUP requires 4 words of local(AUTO) storage.

    No errors detected in file Z9EW.:Z8A6TSI    .

PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:168  

 Object Unit name= Z9EW$OPEN_WRAPUP                           File name= Z9EW.:Z8A6TOU
 UTS= AUG 09 '97 13:55:50.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     3      3  Z9EW$OPEN_WRAPUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  Z9EW$OPEN_WRAPUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:169  


      920        1        /*T***********************************************************/
      921        2        /*T*                                                         */
      922        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      923        4        /*T*                                                         */
      924        5        /*T***********************************************************/
      925        6        /*================*/
      926        7          Z9EW$OPEN_WRAPUP :  PROC ( OPEN_LTS$ );

      7  0 000000   000000 700200 xent  Z9EW$OPEN_W* TSX0  ! X66_AUTO_1
         0 000001   000004 000001                    ZERO    4,1

      927        8        /*================*/
      928        9
      929       10    1     DCL OPEN_LTS$     PTR;
      930       11
      931       12    1     RETURN;          /*  NOT USED FOR CP-6    */

     12  0 000002   000000 702200 xent               TSX2  ! X66_ARET
      932       13
      933       14    1   END Z9EW$OPEN_WRAPUP;

PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:170  
      No diagnostics issued in procedure Z9EW$OPEN_WRAPUP.
PL6.E3A0      #002=Z9EW$OPEN_WRAPUP File=Z9EW.:Z8A6TSI                           SAT 08/09/97 13:55 Page:171  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OPEN_LTS$                *0-0-0/w PTR         r     1 OPEN_LTS$


   Procedure Z9EW$OPEN_WRAPUP requires 3 words for executable code.
   Procedure Z9EW$OPEN_WRAPUP requires 4 words of local(AUTO) storage.

    No errors detected in file Z9EW.:Z8A6TSI    .
