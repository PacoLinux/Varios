VERSION A06

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EX$SET_INDEX: PROC (REC$, SEND$) ;
        7        7        /*P*
        8        8               NAME: Z8EX$SET_INDEX,
        9        9                     Z8EX$SET_UP_BY,
       10       10                     Z8EX$SET_DOWN_BY
       11       11            PURPOSE: To generate the correct conversions and moves for the
       12       12                     INDEX data type
       13       13        */
       14       14
       15       15        %EQU PHASE = 1 ;
       16       16
       17       17
       18       18    1   DCL REC$          PTR ;
       19       19    1   DCL SEND$          PTR ;
       20       20
       21       21        %INCLUDE Z8A_DEFC ;
       22       89        %INCLUDE Z8A_SUPP_MAC ;
       23     2489        %INCLUDE Z8A_ILL ;
       24     3182        %INCLUDE Z8A_ETT ;
       25     3483        %INCLUDE Z8A_LTS ;
       26     5560        %INCLUDE Z8A_COMCOM ;
       27     6210        %INCLUDE Z8A_TYPES;
       28     6384        %INCLUDE Z8A_ST ;
       29    10043        %INCLUDE Z8A_ERR_NUMS ;
       30    10807        %INCLUDE Z8A_SRCH ;
       31    10856        %INCLUDE Z8A_ILS ;
       32    10965        %INCLUDE Z8E_STACKS ;
       33    13231        %INCLUDE Z8E_HEAP;
       34    13287        %INCLUDE Z8A_QLT;
       35    13393        %INCLUDE Z8E_O1COM ;
       36    14154        %INCLUDE Z8E_MACROS ;
       37    14829        %INCLUDE Z8E_WINDOW;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:2    
       38    16899
       39    16900    1   DCL Z8AE$ERROR         ENTRY (12) ;
       40    16901    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
       41    16902    1   DCL Z8E7$MOVE          ENTRY (2) ;
       42    16903    1   DCL Z8EU$CREATE_IDENTIFIER_FROM_ST ENTRY (4);
       43    16904    1   DCL Z8E5$MATH_PACK     ENTRY(2);
       44    16905    1   DCL Z8CO$CHECK_POS_INT_TERM ENTRY(1) ALTRET;
       45    16906    1   DCL Z8CO$INTEGER_CHECK ENTRY(1) ALTRET;
       46    16907    1   DCL Z8CO$CHECK_INTEGER_TERMINAL ENTRY(1) ALTRET;
       47    16908    1   DCL Z8AC$MAKE_TYA_CONST ENTRY(4);
       48    16909    1   DCL Z8EV$CONVERT ENTRY(3);
       49    16910    1   DCL Z8EY$SUBSCRIPT ENTRY(2);
       50    16911    1   DCL Z8AF$FORME ENTRY(4);
       51    16912
       52    16913    1   DCL EXPR_ID            UBIN WORD ;
       53    16914    1   DCL VAL_REC_COUNT      SBIN WORD ;                     /*#28761*/
       54    16915    1   DCL R$ PTR;
       55    16916    1   DCL VAL_REQUIRED BOOLEAN;
       56    16917    1   DCL VAL_TYA_REQUIRED BOOLEAN;
       57    16918    1   DCL VAL_SPAN_OCC_REQUIRED BOOLEAN;
       58    16919
       59    16920        %MACRO INDEX_INFO;
       60    16921
       61    16922          2 ST$        PTR,      /* to symbol table */
       62    16923          2 ARRAY$     PTR,      /* to symbol table or NIL */
       63    16924          2 TYA,
       64    16925            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
       65    16926          2 OCC,
       66    16927            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
       67    16928          2 SPAN_OCC,
       68    16929            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
       69    16930          2 LINE SBIN WORD,
       70    16931          2 COLUMN SBIN WORD,
       71    16932          2 TYPE SBIN WORD,
       72    16933          2 INDEX_TYPE BOOLEAN,
       73    16934          2 SPAN       SBIN WORD;
       74    16935
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:3    
       75    16936        %MEND;
       76    16937
       77    16938        %DCL_AUTO_LX_ITEM (@NAME = REC_NODE);
       78    16942        %DCL_AUTO_LX_ITEM (@NAME = SEND_NODE);
       79    16946        %DCL_AUTO_LX_ITEM (@NAME = ADD_NODE);
       80    16950        %DCL_AUTO_LX_ITEM (@NAME = OCC_NODE);
       81    16954          %DCL_AUTO_LX_ITEM (@NAME = SPAN_OCC_NODE);
       82    16958          %DCL_AUTO_LX_ITEM (@NAME = REC_SPAN_NODE);
       83    16962          %DCL_AUTO_LX_ITEM (@NAME = MULT_NODE);
       84    16966          %DCL_AUTO_LX_ITEM (@NAME = ETT_NODE);
       85    16970          %DCL_AUTO_LX_ITEM (@NAME = ONE);
       86    16974
       87    16975
       88    16976    1   DCL 1 REC_INFO,
       89    16977              %INDEX_INFO;
       90    16992
       91    16993    1   DCL 1 SEND_INFO,
       92    16994               %INDEX_INFO;
       93    17009
       94    17010        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:4    
       95    17011    1   SET_INDEX_FROM_OCC : PROC (OCC$);
       96    17012
       97    17013    2     DCL OCC$ PTR;  /* to LX_ITEM */
       98    17014
       99    17015    2     DCL 1 LDAQSTAQ,
      100    17016    2           2 WORD1 SBIN,
      101    17017    2           2 WORD2 SBIN;
      102    17018    2     DCL 1 CHAR_LDAQSTAQ REDEF LDAQSTAQ CHAR(8);
      103    17019
      104    17020
      105    17021          /* Semantic checks for SET_INDEX_FROM_OCC:
      106    17022                  Identifier must be integer;
      107    17023                  Number must be integer (possibly signed, although
      108    17024                                          sign must be positive)
      109    17025          */
      110    17026    3     DO SELECT (OCC$ -> LX_ITEM.ID);
      111    17027
      112    17028    3       SELECT(%LX_TERMINAL);
      113    17029    3         CALL Z8CO$CHECK_POS_INT_TERM (OCC$)
      114    17030    3           WHENALTRETURN
      115    17031    4             DO;
      116    17032                    %CONDITIONAL_ERROR (@LX_ITEM$ = OCC$,
      117    17033                                        @ERROR# = %E$POSITIVE_INTEGER_EXPECTED,
      118    17034                                        @LINE = OCC$ -> LX_TERMINAL.LINE,
      119    17035                                        @COLUMN = OCC$ -> LX_TERMINAL.COLUMN);
      120    17065    4             END;
      121    17066
      122    17067    3       SELECT(%LX_ETT_ITEM);
      123    17068    3         CALL Z8CO$INTEGER_CHECK(OCC$);
      124    17069
      125    17070    3       SELECT(ELSE);
      126    17071    3         CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      127    17072    3     END;
      128    17073
      129    17074    2   IF REC_INFO.ARRAY$ = ADDR(NIL) THEN
      130    17075    2     CALL Z8AE$ERROR (%E$INVALID_SET,
      131    17076    2                      REC_INFO.LINE,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:5    
      132    17077    2                      REC_INFO.COLUMN);
      133    17078    2   ELSE
      134    17079    2     IF OCC$ -> LX_ITEM.ID = %LX_TERMINAL
      135    17080    2          AND OCC$ -> LX_TERMINAL.SYMBOL = %NUMBER
      136    17081    2          AND REC_INFO.ST$ -> VARIABLE.TYPE = %TYX THEN
      137    17082    3       DO;
      138    17083              /* Local opt to build a 2 word constant so that a
      139    17084                 LDAQ/STAQ may be done
      140    17085              */
      141    17086    3         CALL Z8EV$CONVERT (%TYI,
      142    17087    3                            OCC$,
      143    17088    3                            ADDR(ETT_NODE));
      144    17089
      145    17090    3         LDAQSTAQ.WORD2 = ADDR(ETT_NODE) -> LX_ETT_ITEM.ETT$ ->
      146    17091    3                              ETT.LOP -> CONST.CONSTI.WORD1;
      147    17092
      148    17093    3         LDAQSTAQ.WORD1 = LDAQSTAQ.WORD2 * REC_INFO.SPAN;
      149    17094
      150    17095              %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_NODE)",
      151    17096                                 @TYPE = %TYA,
      152    17097                                 @LINE = OCC$ -> LX_TERMINAL.LINE,
      153    17098                                 @COLUMN = OCC$ -> LX_TERMINAL.COLUMN);
      154    17120
      155    17121    3         CALL Z8AC$MAKE_TYA_CONST (CHAR_LDAQSTAQ,
      156    17122    3                                   8,
      157    17123    3                                   0,
      158    17124    3                                   ADDR(ETT_NODE) -> LX_ETT_ITEM.ETT$);
      159    17125
      160    17126    3         CALL Z8E7$MOVE (ADDR(REC_INFO.TYA),
      161    17127    3                         ADDR(ETT_NODE));
      162    17128    3       END;
      163    17129    2     ELSE
      164    17130    3       DO;
      165    17131              /* Set each field of the index item separately */
      166    17132
      167    17133    3         CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),
      168    17134    3                         OCC$);
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:6    
      169    17135
      170    17136    3         CALL Z8AC$LX_ETT_ITEM_TYI_CONST ( REC_INFO.SPAN,
      171    17137    3                                                ADDR(REC_SPAN_NODE));
      172    17138
      173    17139              %INIT_BINARY_OP (@POINTER = "ADDR(MULT_NODE)",
      174    17140                               @LINE = "REC_INFO.LINE",
      175    17141                               @BERR = OCC$ -> LX_ITEM.B.ERROR,
      176    17142                               @COLUMN = "REC_INFO.COLUMN",
      177    17143                               @ROP$ = OCC$,
      178    17144                               @LOP$ = "ADDR(REC_SPAN_NODE)",
      179    17145                               @OP = %OP_STAR);
      180    17163
      181    17164              /* Local opt to use binary values when possible */
      182    17165    3         IF ADDR(REC_INFO.OCC) -> VARIABLE.TYPE = %TYI THEN
      183    17166    3           ADDR(MULT_NODE) -> BINARY_OP.ROP$ = ADDR(REC_INFO.OCC);
      184    17167
      185    17168    3         CALL Z8E5$MATH_PACK (ADDR(MULT_NODE),
      186    17169    3                              ADDR(ETT_NODE));
      187    17170
      188    17171    3         CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),
      189    17172    3                         ADDR(ETT_NODE));
      190    17173
      191    17174    3       END;
      192    17175    2   END SET_INDEX_FROM_OCC;
      193    17176
      194    17177        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:7    
      195    17178    1   RESOLVE_INDEX_REFERENCES : PROC (INDEX$,
      196    17179    1                                    INDEX_INFO,
      197    17180    1                                    SUBSCRIPT$);
      198    17181
      199    17182    2     DCL INDEX$ PTR;  /* to LX_ETT_ITEM */
      200    17183    2     DCL 1 INDEX_INFO ALIGNED,
      201    17184                %INDEX_INFO;
      202    17199    2     DCL SUBSCRIPT$ PTR;
      203    17200
      204    17201    2     DCL DIMS$ PTR;
      205    17202    2     DCL DIM SBIN WORD;
      206    17203
      207    17204
      208    17205    2   INDEX_INFO.INDEX_TYPE = TRUE;
      209    17206
      210    17207        %FISH (TRIAD = "INDEX$ -> LX_ETT_ITEM.ETT$",
      211    17208               RTN = INDEX_INFO.ST$);
      212    17216
      213    17217    2   INDEX_INFO.LINE = INDEX$ -> LX_ETT_ITEM.LINE;
      214    17218    2   INDEX_INFO.COLUMN = INDEX$ -> LX_ETT_ITEM.COLUMN;
      215    17219    2   INDEX_INFO.TYPE = INDEX$ -> LX_ETT_ITEM.TYPE;
      216    17220
      217    17221    3   DO SELECT (INDEX_INFO.ST$ -> SCALAR.TYPE);
      218    17222
      219    17223    3     SELECT(%TYY);
      220    17224    3       INDEX_INFO.ARRAY$ = ADDR(NIL);
      221    17225    3       INDEX_INFO.SPAN   = 0;
      222    17226
      223    17227    3     SELECT(%TYX);
      224    17228
      225    17229    3       IF INDEX_INFO.ST$ -> ST.ID = %ARRAY
      226    17230    3             OR INDEX_INFO.ST$ -> SCALAR.LTS$ = ADDR(NIL)
      227    17231    3             OR INDEX_INFO.ST$ -> SCALAR.LTS$ -> ST.ID ~= %ARRAY THEN
      228    17232    4         DO;
      229    17233                /* This must be an optimized TYY item */
      230    17234    4           INDEX_INFO.ARRAY$ = ADDR(NIL);
      231    17235    4           INDEX_INFO.SPAN   = 0;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:8    
      232    17236    4         END;
      233    17237    3       ELSE
      234    17238    4         DO;  /* This is a real TYX */
      235    17239    4           INDEX_INFO.ARRAY$ = INDEX_INFO.ST$ -> SCALAR.LTS$;
      236    17240
      237    17241                %GET_LTS (@ID = %DIMS,
      238    17242                          @ST$ = INDEX_INFO.ARRAY$,
      239    17243                          @RETURN$ = DIMS$);
      240    17286
      241    17287                %FIND_LAST_DIM (POINTER = DIMS$,
      242    17288                                 VARIABLE = DIM);
      243    17293
      244    17294    4           INDEX_INFO.SPAN = DIMS$ -> DIMS.D.SPAN(DIM);
      245    17295    4         END;
      246    17296
      247    17297    3     SELECT(ELSE);
      248    17298    3       CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      249    17299    3   END;  /* DO SELECT */
      250    17300
      251    17301    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST(
      252    17302    2           INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$,
      253    17303    2           ADDR(INDEX_INFO.TYA),
      254    17304    2           INDEX_INFO.LINE,
      255    17305    2           INDEX_INFO.COLUMN);
      256    17306
      257    17307    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST (
      258    17308    2               INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER
      259    17309    2                               -> QLT.SON -> QLT.ST$,
      260    17310    2               ADDR(INDEX_INFO.SPAN_OCC),
      261    17311    2               INDEX_INFO.LINE,
      262    17312    2               INDEX_INFO.COLUMN);
      263    17313
      264    17314    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST(
      265    17315    2               INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.SON
      266    17316    2                          -> QLT.BROTHER -> QLT.ST$,
      267    17317    2               ADDR(INDEX_INFO.OCC),
      268    17318    2               INDEX_INFO.LINE,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:9    
      269    17319    2               INDEX_INFO.COLUMN);
      270    17320
      271    17321    2   IF ADDR(SUBSCRIPT$) ~= ADDR(NIL)
      272    17322    2        AND SUBSCRIPT$ ~= ADDR(NIL) THEN
      273    17323    3     DO;
      274    17324    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,
      275    17325    3                            ADDR(INDEX_INFO.TYA));
      276    17326    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,
      277    17327    3                            ADDR(INDEX_INFO.SPAN_OCC));
      278    17328    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,
      279    17329    3                            ADDR(INDEX_INFO.OCC));
      280    17330    3     END;
      281    17331
      282    17332    2   END RESOLVE_INDEX_REFERENCES;
      283    17333        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:10   
      284    17334    1   SET_UP_DOWN : PROC (SEND$,
      285    17335    1                       EXPR_ID);
      286    17336
      287    17337    2     DCL SEND$ PTR;  /* To arith expr for incremental value */
      288    17338    2     DCL EXPR_ID SBIN WORD;  /* operation code (add or subtract) */
      289    17339
      290    17340          /* Semantic checks for SET UP or DOWN:
      291    17341                Identifier must be integer;
      292    17342                Number must be integer (possibly signed)
      293    17343          */
      294    17344    3     DO SELECT (SEND$ -> LX_ITEM.ID);
      295    17345
      296    17346    3       SELECT(%LX_TERMINAL);
      297    17347    3         CALL Z8CO$CHECK_INTEGER_TERMINAL (SEND$)
      298    17348    3           WHENALTRETURN
      299    17349    4             DO;
      300    17350                    %CONDITIONAL_ERROR (@LX_ITEM$ = SEND$,
      301    17351                                        @ERROR# = %E$MUST_BE_INTEGER,
      302    17352                                        @LINE = SEND$ -> LX_TERMINAL.LINE,
      303    17353                                        @COLUMN = SEND$ -> LX_TERMINAL.COLUMN);
      304    17383    4             END;
      305    17384
      306    17385    3       SELECT(%LX_ETT_ITEM);
      307    17386
      308    17387    4         DO SELECT (SEND$ -> LX_ETT_ITEM.TYPE);
      309    17388
      310    17389    4           SELECT(%TYX, %TYY);
      311    17390
      312    17391    4           SELECT(ELSE);
      313    17392    4             CALL Z8CO$INTEGER_CHECK(SEND$);
      314    17393    4         END;
      315    17394
      316    17395    3       SELECT(ELSE);
      317    17396
      318    17397    3         CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      319    17398    3     END;
      320    17399
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:11   
      321    17400          %INIT_BINARY_OP (@POINTER = "ADDR(ADD_NODE)",
      322    17401                           @LINE = "REC_INFO.LINE",
      323    17402                           @BERR = SEND$ -> LX_ITEM.B.ERROR,
      324    17403                           @COLUMN = "REC_INFO.COLUMN",
      325    17404                           @LOP$ = "ADDR(REC_INFO.OCC)",
      326    17405                           @ROP$ = SEND$,
      327    17406                           @OP = EXPR_ID);
      328    17424
      329    17425    2     CALL Z8E5$MATH_PACK (ADDR(ADD_NODE),
      330    17426    2                          ADDR(ETT_NODE));
      331    17427
      332    17428    2     CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),
      333    17429    2                     ADDR(ETT_NODE));
      334    17430
      335    17431    2     CALL Z8AC$LX_ETT_ITEM_TYI_CONST (REC_INFO.SPAN,
      336    17432    2                                      ADDR(REC_SPAN_NODE));
      337    17433
      338    17434          %INIT_BINARY_OP (@POINTER = "ADDR(MULT_NODE)",
      339    17435                           @LINE = "REC_INFO.LINE",
      340    17436                           @BERR = SEND$ -> LX_ITEM.B.ERROR,
      341    17437                           @COLUMN = "REC_INFO.COLUMN",
      342    17438                           @LOP$ = "ADDR(REC_SPAN_NODE)",
      343    17439                           @ROP$ = SEND$,
      344    17440                           @OP = %OP_STAR);
      345    17458
      346    17459    2     ADDR(ADD_NODE) -> BINARY_OP.LOP$ = ADDR(REC_INFO.SPAN_OCC);
      347    17460    2     ADDR(ADD_NODE) -> BINARY_OP.ROP$ = ADDR(MULT_NODE);
      348    17461
      349    17462    2     CALL Z8E5$MATH_PACK (ADDR(ADD_NODE),
      350    17463    2                          ADDR(ETT_NODE));
      351    17464
      352    17465    2     CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),
      353    17466    2                     ADDR(ETT_NODE));
      354    17467
      355    17468    2   END SET_UP_DOWN;
      356    17469
      357    17470        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:12   
      358    17471    1   MOVE_INDEX : PROC ;
      359    17472
      360    17473
      361    17474                    /* Moves between index items are as follows:
      362    17475
      363    17476                        TYPE   REC    SEND   SPAN   MOVE
      364    17477                        ----   ----   ----   ----   ----
      365    17478                         L      A      A      =      TYA
      366    17479                         L      A      A      ~=     OCC
      367    17480                         L      A      I      NA     TYA
      368    17481                         L      I      A      NA     TYA
      369    17482                         L      I      I      NA     TYA
      370    17483                         U      A      A      =      OCC, OCC*SPAN
      371    17484                         U      A      A      ~=     OCC
      372    17485                         U      A      I      NA     OCC
      373    17486                         U      I      A      NA     OCC, OCC*SPAN
      374    17487                         U      I      I      NA     OCC, OCC*SPAN
      375    17488
      376    17489                       U => Type of REC index ~= type of SEND index
      377    17490                       L => Type of REC index = type of SEND index
      378    17491                       A => Variable is associated with an array
      379    17492                       I => Variable is a data item, not assoc. with an array
      380    17493                       NA => Not applicable
      381    17494                       TYA => Move the entire structure without conversion
      382    17495                       OCC => Build a new index item based on the SEND occurrence #
      383    17496                       OCC, OCC*SPAN => Move each field separately, so that conversion
      384    17497                                           will change COMP-6 <=> COMP-1,COMP-2
      385    17498                    */
      386    17499
      387    17500    2               IF REC_INFO.TYPE = SEND_INFO.TYPE
      388    17501    2                   AND (REC_INFO.ARRAY$ = ADDR(NIL)
      389    17502    2                         OR (REC_INFO.ARRAY$ ~= ADDR(NIL)
      390    17503    2                              AND (SEND_INFO.ARRAY$ = ADDR(NIL)
      391    17504    2                                    OR REC_INFO.SPAN = SEND_INFO.SPAN))) THEN
      392    17505    3                 DO;
      393    17506    3                   CALL Z8E7$MOVE (ADDR(REC_INFO.TYA),
      394    17507    3                                   ADDR(SEND_INFO.TYA));
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:13   
      395    17508    3                 END;
      396    17509    2               ELSE
      397    17510    2                 IF REC_INFO.TYPE ~= SEND_INFO.TYPE
      398    17511    2                     AND (REC_INFO.ARRAY$ = ADDR(NIL)
      399    17512    2                           OR (REC_INFO.ARRAY$ ~= ADDR(NIL)
      400    17513    2                           AND (SEND_INFO.ARRAY$ = ADDR(NIL)
      401    17514    2                                 OR REC_INFO.SPAN = SEND_INFO.SPAN))) THEN
      402    17515    3                   DO;
      403    17516    3                     CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),
      404    17517    3                                     ADDR(SEND_INFO.SPAN_OCC));
      405    17518    3                     CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),
      406    17519    3                                     ADDR(SEND_INFO.OCC));
      407    17520    3                   END;
      408    17521    2                 ELSE
      409    17522    3                   DO;
      410    17523    3                     CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));
      411    17524    3                   END;
      412    17525    2   END MOVE_INDEX;
      413    17526
      414    17527        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:14   
      415    17528        /* Main body of SET$INDEX */
      416    17529
      417    17530        /* Resolve sending reference */
      418    17531
      419    17532    1   SEND_INFO.INDEX_TYPE = FALSE;
      420    17533
      421    17534    2   DO CASE (SEND$ -> LX_ITEM.ID);
      422    17535
      423    17536    2     CASE(%LX_TERMINAL);
      424    17537
      425    17538    2       SEND_INFO.OCC = SEND$ -> LX_TERMINAL;
      426    17539
      427    17540    2     CASE(%LX_ETT_ITEM);
      428    17541
      429    17542    2       IF SEND$ -> LX_ETT_ITEM.TYPE = %TYX
      430    17543    2            OR SEND$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      431    17544    2           CALL RESOLVE_INDEX_REFERENCES (SEND$,
      432    17545    2                                          SEND_INFO);
      433    17546    2       ELSE
      434    17547    2         SEND_INFO.OCC = SEND$ -> LX_ETT_ITEM;
      435    17548
      436    17549    2     CASE(%LX_LIST);
      437    17550
      438    17551    2       IF SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYX
      439    17552    2           OR SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      440    17553    2           CALL RESOLVE_INDEX_REFERENCES (SEND$ -> LX_LIST.HEAD$,
      441    17554    2                                          SEND_INFO,
      442    17555    2                                          SEND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK);
      443    17556    2       ELSE
      444    17557    3         DO;
      445    17558    3           SEND_INFO.OCC = SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM;
      446    17559    3           IF SEND$ -> LX_LIST.COUNT > 1 THEN
      447    17560    3             CALL Z8EY$SUBSCRIPT (SEND$ -> LX_LIST.TAIL$,
      448    17561    3                                  ADDR(SEND_INFO.OCC));
      449    17562    3         END;
      450    17563    2   END;  /* Case */
      451    17564
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:15   
      452    17565
      453    17566        /* Resolve Receiving Items */
      454    17567
      455    17568
      456    17569    2   DO CASE (REC$ -> LX_ITEM.ID);
      457    17570
      458    17571    2     CASE(%LX_ETT_ITEM);
      459    17572
      460    17573    2       IF REC$ -> LX_ETT_ITEM.TYPE = %TYP THEN
      461    17574    3         DO;
      462    17575                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
      463    17576                                    @ERROR# = %E$INVALID_SET,
      464    17577                                    @LINE = REC$ -> LX_ETT_ITEM.LINE,
      465    17578                                    @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);
      466    17608
      467    17609    3           REC$ -> LX_ETT_ITEM.TYPE = %TYI;
      468    17610    3         END;
      469    17611
      470    17612    2       REC_INFO.INDEX_TYPE = FALSE;
      471    17613
      472    17614    2       IF REC$ -> LX_ETT_ITEM.TYPE = %TYX
      473    17615    2            OR REC$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      474    17616    3         DO;
      475    17617    3           CALL RESOLVE_INDEX_REFERENCES (REC$,
      476    17618    3                               REC_INFO);
      477    17619    3           IF SEND_INFO.INDEX_TYPE THEN
      478    17620    3             CALL MOVE_INDEX;
      479    17621    3           ELSE
      480    17622    3             CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));
      481    17623    3         END;
      482    17624    2       ELSE
      483    17625    2         CALL Z8E7$MOVE (REC$,
      484    17626    2                         ADDR(SEND_INFO.OCC));
      485    17627    2         IF COMCOM.OB.FIPS.LEVEL > 0
      486    17628    2         AND NOT SEND_INFO.INDEX_TYPE THEN
      487    17629                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
      488    17630                                    @ERROR# = %E$SET_NOT_ANSI,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:16   
      489    17631                                    @LINE = REC$ -> LX_ETT_ITEM.LINE,
      490    17632                                    @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);
      491    17662
      492    17663    2     CASE(%LX_LIST); /* Receiving */
      493    17664
      494    17665    2       VAL_REQUIRED = FALSE;
      495    17666    2       VAL_TYA_REQUIRED = FALSE;
      496    17667    2       VAL_SPAN_OCC_REQUIRED = FALSE;
      497    17668    2       VAL_REC_COUNT = 0 ;                                /*#28761*/
      498    17669
      499    17670    2       IF REC$ -> LX_LIST.COUNT > 1 THEN
      500    17671    3         DO;
      501    17672    3           IF  ADDR(SEND_INFO.OCC) ->  LX_ITEM.ID = %LX_ETT_ITEM
      502    17673    3              AND  ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      503    17674    4             DO;
      504    17675    4               CALL Z8AF$FORME (%EVAL,
      505    17676    4                                ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$,
      506    17677    4                                ADDR(NIL),
      507    17678    4                                ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$);
      508    17679
      509    17680                    %NEW_ILL (@ID = %VAL,
      510    17681                              @ETT$ = "ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$");
      511    18060    4               VAL_REQUIRED = TRUE;
      512    18061    4             END;
      513    18062
      514    18063    3           IF SEND_INFO.INDEX_TYPE THEN
      515    18064    4             DO;
      516    18065    4               IF ADDR(SEND_INFO.TYA) -> LX_ITEM.ID = %LX_ETT_ITEM
      517    18066    4                   AND ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      518    18067    5                 DO;
      519    18068    5                   CALL Z8AF$FORME (%EVAL,
      520    18069    5                                    ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$,
      521    18070    5                                    ADDR(NIL),
      522    18071    5                                    ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$);
      523    18072                        %NEW_ILL (@ID = %VAL,
      524    18073                                  @ETT$ = "ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$");
      525    18452    5                   VAL_TYA_REQUIRED = TRUE;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:17   
      526    18453    5                 END;
      527    18454
      528    18455    4               IF ADDR(SEND_INFO.SPAN_OCC) -> LX_ITEM.ID = %LX_ETT_ITEM
      529    18456    4                   AND ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD
             18456                            THEN
      530    18457    5                 DO;
      531    18458    5                   CALL Z8AF$FORME (%EVAL,
      532    18459    5                                    ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$,
      533    18460    5                                    ADDR(NIL),
      534    18461    5                                    ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$);
      535    18462                        %NEW_ILL (@ID = %VAL,
      536    18463                                  @ETT$ = "ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$");
      537    18842    5                   VAL_SPAN_OCC_REQUIRED = TRUE;
      538    18843    5                 END;
      539    18844    4             END;
      540    18845    3         END;
      541    18846
      542    18847    2       R$ = REC$ -> LX_LIST.HEAD$;
      543    18848    3       DO WHILE R$ ~= ADDR(NIL);
      544    18849
      545    18850    3       IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYP THEN
      546    18851    4         DO;
      547    18852                %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
      548    18853                                    @ERROR# = %E$INVALID_SET,
      549    18854                                    @LINE = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      550    18855                                    @COLUMN = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
      551    18885
      552    18886    4           R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYI;
      553    18887    4         END;
      554    18888
      555    18889    3         VAL_REC_COUNT = VAL_REC_COUNT + 1 ;              /*#28761*/
      556    18890    3         REC_INFO.INDEX_TYPE = FALSE;
      557    18891
      558    18892    3         IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYX
      559    18893    3             OR R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      560    18894    4           DO;
      561    18895    4             CALL RESOLVE_INDEX_REFERENCES (R$ -> LX_LIST.HEAD$,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:18   
      562    18896    4                                            REC_INFO,
      563    18897    4                                            R$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK);
      564    18898    4             IF SEND_INFO.INDEX_TYPE THEN
      565    18899    4               CALL MOVE_INDEX;
      566    18900    4             ELSE
      567    18901    4               CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));
      568    18902    4           END;
      569    18903    3         ELSE
      570    18904    4           DO;
      571    18905    4             REC_INFO.OCC = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM;
      572    18906    4             IF R$ -> LX_LIST.COUNT > 1 THEN
      573    18907    4               CALL Z8EY$SUBSCRIPT (R$ -> LX_LIST.TAIL$,
      574    18908    4                                    ADDR(REC_INFO.OCC));
      575    18909    4             CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),
      576    18910    4                             ADDR(SEND_INFO.OCC));
      577    18911    4             IF COMCOM.OB.FIPS.LEVEL > 0
      578    18912    4             AND NOT SEND_INFO.INDEX_TYPE THEN
      579    18913                    %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
      580    18914                                        @ERROR# = %E$SET_NOT_ANSI,
      581    18915                                        @LINE = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      582    18916                                        @COLUMN = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN)
             18916                                            ;
      583    18946    4           END;
      584    18947
      585    18948    3         R$ = R$ -> LX_LIST.LINK;
      586    18949    3       END;  /* Do While */
      587    18950                                                               /*#28761*/
      588    18951    2       IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN
      589    18952    2         COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;
      590    18953
      591    18954    2       IF VAL_SPAN_OCC_REQUIRED THEN
      592    18955              %NEW_ILL(@ID = %VAL_END);
      593    19334
      594    19335    2       IF VAL_TYA_REQUIRED THEN
      595    19336              %NEW_ILL (@ID = %VAL_END);
      596    19715
      597    19716    2       IF VAL_REQUIRED THEN
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:19   
      598    19717              %NEW_ILL (@ID = %VAL_END);
      599    20096
      600    20097    2     CASE (ELSE);
      601    20098
      602    20099    2       CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      603    20100    2   END;
      604    20101
      605    20102
      606    20103    1   RETURN;
      607    20104        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:20   
      608    20105    1   Z8EX$SET_UP_BY : ENTRY (REC$, SEND$);
      609    20106
      610    20107
      611    20108    1     EXPR_ID = %OP_PLUS;
      612    20109    1     GOTO SET_UP_DOWN;
      613    20110
      614    20111
      615    20112    1   Z8EX$SET_DOWN_BY : ENTRY (REC$, SEND$);
      616    20113
      617    20114
      618    20115    1     EXPR_ID = %OP_BINARY_MINUS;
      619    20116
      620    20117
      621    20118    1   SET_UP_DOWN:
      622    20119
      623    20120    1     IF REC$ -> LX_ETT_ITEM.TYPE ~= %TYX
      624    20121    1          AND REC$ -> LX_ETT_ITEM.TYPE ~= %TYY THEN
      625    20122    1       CALL Z8AE$ERROR (%E$INVALID_SET,
      626    20123    1                        REC$ -> LX_ETT_ITEM.LINE,
      627    20124    1                        REC$ -> LX_ETT_ITEM.COLUMN);
      628    20125    1     ELSE
      629    20126    2       DO;
      630    20127    2         CALL RESOLVE_INDEX_REFERENCES (REC$,
      631    20128    2                                       REC_INFO);
      632    20129
      633    20130    2         IF REC_INFO.ARRAY$ = ADDR(NIL) THEN
      634    20131    2           CALL Z8AE$ERROR (%E$INVALID_SET,
      635    20132    2                            REC$ -> LX_ETT_ITEM.LINE,
      636    20133    2                            REC$ -> LX_ETT_ITEM.COLUMN);
      637    20134    2         ELSE
      638    20135    3           DO;
      639    20136    3             CALL SET_UP_DOWN (SEND$,
      640    20137    3                               EXPR_ID);
      641    20138    3           END;
      642    20139    2       END;
      643    20140
      644    20141    1   RETURN;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:21   
      645    20142        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:22   
      646    20143    1   Z8EX$SET_UP_FOR_SEARCH : ENTRY (REC$, SEND$);
      647    20144
      648    20145        /* This is a special entry for the SEARCH statement.
      649    20146           REC$ points to VARYING identifier which is to be set
      650    20147           up by the same amount as a SET_UP_BY 1 would use
      651    20148           for SEND$
      652    20149        */
      653    20150
      654    20151    1     CALL RESOLVE_INDEX_REFERENCES (REC$,
      655    20152    1                                    REC_INFO);
      656    20153
      657    20154    1     CALL RESOLVE_INDEX_REFERENCES (SEND$,
      658    20155    1                                    SEND_INFO);
      659    20156
      660    20157    1     IF REC_INFO.ARRAY$ = ADDR(NIL) THEN
      661    20158    2       DO;
      662    20159    2         REC_INFO.ARRAY$ = SEND_INFO.ARRAY$;
      663    20160    2         REC_INFO.SPAN = SEND_INFO.SPAN;
      664    20161    2       END;
      665    20162
      666    20163    1     CALL Z8AC$LX_ETT_ITEM_TYI_CONST (1,
      667    20164    1                                      ADDR(ONE));
      668    20165
      669    20166    1     CALL SET_UP_DOWN (ADDR(ONE),
      670    20167    1                       %OP_PLUS);
      671    20168
      672    20169    1     RETURN;
      673    20170
      674    20171    1   END Z8EX$SET_INDEX;
      675    20172        %EOD;

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:23   
--  Include file information  --

   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EX$SET_INDEX.

   Procedure Z8EX$SET_INDEX requires 1202 words for executable code.
   Procedure Z8EX$SET_INDEX requires 162 words of local(AUTO) storage.

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:24   

 Object Unit name= Z8EX$SET_INDEX                             File name= Z8EX.:Z8A6TOU
 UTS= AUG 09 '97 12:54:45.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILL$
    2  LblCom even  none     5      5  ILL_
    3  LblCom even  none     1      1  ETT$
    4  LblCom even  none     1      1  HEAD_ETT$
    5  LblCom even  none   512   1000  ETT_BUCKETS
    6  LblCom even  none     5      5  ETT_
    7  LblCom even  none     1      1  LTS$
    8  LblCom even  none     5      5  LTS_
    9  LblCom even  none     1      1  ST$
   10  LblCom even  none     5      5  ST_
   11  LblCom even  none     3      3  SRCH
   12  LblCom even  none     1      1  ILS$
   13  LblCom even  none     5      5  ILS_
   14  LblCom even  none    90    132  LEX_SYMBOL
   15  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   16  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   17  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   18  LblCom even  none     1      1  HEAP$
   19  LblCom even  none     1      1  QLT$
   20  LblCom even  none     1      1  PREV_01_QLT$
   21  LblCom even  none     5      5  QLT_
   22   Proc  even  none  1202   2262  Z8EX$SET_INDEX
   23  RoData even  none    33     41  Z8EX$SET_INDEX
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:25   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes            yes      Std        2  Z8EX$SET_INDEX
    22   2114                  yes      Std        2  Z8EX$SET_UP_BY
    22   2121                  yes      Std        2  Z8EX$SET_DOWN_BY
    22   2206                  yes      Std        2  Z8EX$SET_UP_FOR_SEARCH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8EY$SUBSCRIPT
         yes           Std      12 Z8AE$ERROR
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       2 Z8E7$MOVE
         yes           Std       4 Z8AF$FORME
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
 yes     yes           Std       1 Z8CO$CHECK_POS_INT_TERM
         yes           Std       3 Z8EV$CONVERT
         yes           Std       4 Z8AC$MAKE_TYA_CONST
 yes     yes           Std       1 Z8CO$INTEGER_CHECK
         yes           Std       2 Z8E5$MATH_PACK
         yes           Std       4 Z8EU$CREATE_IDENTIFIER_FROM_ST
 yes     yes           Std       1 Z8CO$CHECK_INTEGER_TERMINAL
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:26   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                         r    LTS_STEP                              COMCOM
r    ILS_STEP_TABLE                        O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:27   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EX$SET_INDEX: PROC (REC$, SEND$) ;

      6 22 000000   000000 700200 xent  Z8EX$SET_IN* TSX0  ! X66_AUTO_2
        22 000001   000242 000002                    ZERO    162,2
        22 000002   001177 710000 22                 TRA     s:17532

        7        7        /*P*
        8        8               NAME: Z8EX$SET_INDEX,
        9        9                     Z8EX$SET_UP_BY,
       10       10                     Z8EX$SET_DOWN_BY
       11       11            PURPOSE: To generate the correct conversions and moves for the
       12       12                     INDEX data type
       13       13        */
       14       14
       15       15        %EQU PHASE = 1 ;
       16       16
       17       17
       18       18    1   DCL REC$          PTR ;
       19       19    1   DCL SEND$          PTR ;
       20       20
       21       21        %INCLUDE Z8A_DEFC ;
       22       89        %INCLUDE Z8A_SUPP_MAC ;
       23     2489        %INCLUDE Z8A_ILL ;
       24     3182        %INCLUDE Z8A_ETT ;
       25     3483        %INCLUDE Z8A_LTS ;
       26     5560        %INCLUDE Z8A_COMCOM ;
       27     6210        %INCLUDE Z8A_TYPES;
       28     6384        %INCLUDE Z8A_ST ;
       29    10043        %INCLUDE Z8A_ERR_NUMS ;
       30    10807        %INCLUDE Z8A_SRCH ;
       31    10856        %INCLUDE Z8A_ILS ;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:28   
       32    10965        %INCLUDE Z8E_STACKS ;
       33    13231        %INCLUDE Z8E_HEAP;
       34    13287        %INCLUDE Z8A_QLT;
       35    13393        %INCLUDE Z8E_O1COM ;
       36    14154        %INCLUDE Z8E_MACROS ;
       37    14829        %INCLUDE Z8E_WINDOW;
       38    16899
       39    16900    1   DCL Z8AE$ERROR         ENTRY (12) ;
       40    16901    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
       41    16902    1   DCL Z8E7$MOVE          ENTRY (2) ;
       42    16903    1   DCL Z8EU$CREATE_IDENTIFIER_FROM_ST ENTRY (4);
       43    16904    1   DCL Z8E5$MATH_PACK     ENTRY(2);
       44    16905    1   DCL Z8CO$CHECK_POS_INT_TERM ENTRY(1) ALTRET;
       45    16906    1   DCL Z8CO$INTEGER_CHECK ENTRY(1) ALTRET;
       46    16907    1   DCL Z8CO$CHECK_INTEGER_TERMINAL ENTRY(1) ALTRET;
       47    16908    1   DCL Z8AC$MAKE_TYA_CONST ENTRY(4);
       48    16909    1   DCL Z8EV$CONVERT ENTRY(3);
       49    16910    1   DCL Z8EY$SUBSCRIPT ENTRY(2);
       50    16911    1   DCL Z8AF$FORME ENTRY(4);
       51    16912
       52    16913    1   DCL EXPR_ID            UBIN WORD ;
       53    16914    1   DCL VAL_REC_COUNT      SBIN WORD ;                     /*#28761*/
       54    16915    1   DCL R$ PTR;
       55    16916    1   DCL VAL_REQUIRED BOOLEAN;
       56    16917    1   DCL VAL_TYA_REQUIRED BOOLEAN;
       57    16918    1   DCL VAL_SPAN_OCC_REQUIRED BOOLEAN;
       58    16919
       59    16920        %MACRO INDEX_INFO;
       60    16921
       61    16922          2 ST$        PTR,      /* to symbol table */
       62    16923          2 ARRAY$     PTR,      /* to symbol table or NIL */
       63    16924          2 TYA,
       64    16925            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
       65    16926          2 OCC,
       66    16927            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
       67    16928          2 SPAN_OCC,
       68    16929            3 * (0:%(LENGTH_LX_ITEM - 1)) SBIN WORD,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:29   
       69    16930          2 LINE SBIN WORD,
       70    16931          2 COLUMN SBIN WORD,
       71    16932          2 TYPE SBIN WORD,
       72    16933          2 INDEX_TYPE BOOLEAN,
       73    16934          2 SPAN       SBIN WORD;
       74    16935
       75    16936        %MEND;
       76    16937
       77    16938        %DCL_AUTO_LX_ITEM (@NAME = REC_NODE);
       78    16942        %DCL_AUTO_LX_ITEM (@NAME = SEND_NODE);
       79    16946        %DCL_AUTO_LX_ITEM (@NAME = ADD_NODE);
       80    16950        %DCL_AUTO_LX_ITEM (@NAME = OCC_NODE);
       81    16954          %DCL_AUTO_LX_ITEM (@NAME = SPAN_OCC_NODE);
       82    16958          %DCL_AUTO_LX_ITEM (@NAME = REC_SPAN_NODE);
       83    16962          %DCL_AUTO_LX_ITEM (@NAME = MULT_NODE);
       84    16966          %DCL_AUTO_LX_ITEM (@NAME = ETT_NODE);
       85    16970          %DCL_AUTO_LX_ITEM (@NAME = ONE);
       86    16974
       87    16975
       88    16976    1   DCL 1 REC_INFO,
       89    16977              %INDEX_INFO;
       90    16992
       91    16993    1   DCL 1 SEND_INFO,
       92    16994               %INDEX_INFO;
       93    17009
       94    17010        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:30   
       95    17011    1   SET_INDEX_FROM_OCC : PROC (OCC$);

  17011 22 000003   200224 741300       SET_INDEX_F* STX1  ! @SEND$+1,,AUTO

       96    17012
       97    17013    2     DCL OCC$ PTR;  /* to LX_ITEM */
       98    17014
       99    17015    2     DCL 1 LDAQSTAQ,
      100    17016    2           2 WORD1 SBIN,
      101    17017    2           2 WORD2 SBIN;
      102    17018    2     DCL 1 CHAR_LDAQSTAQ REDEF LDAQSTAQ CHAR(8);
      103    17019
      104    17020
      105    17021          /* Semantic checks for SET_INDEX_FROM_OCC:
      106    17022                  Identifier must be integer;
      107    17023                  Number must be integer (possibly signed, although
      108    17024                                          sign must be positive)
      109    17025          */
      110    17026    3     DO SELECT (OCC$ -> LX_ITEM.ID);

  17026 22 000004   200225 470500                    LDP0    @OCC$,,AUTO
        22 000005   000000 471500                    LDP1    0,,PR0
        22 000006   100000 220100                    LDX0    0,,PR1
        22 000007   000013 600000 22                 TZE     s:17029
        22 000010   000004 100003                    CMPX0   4,DU
        22 000011   000051 601000 22                 TNZ     s:17071
        22 000012   000044 710000 22                 TRA     s:17068

      111    17027
      112    17028    3       SELECT(%LX_TERMINAL);

      113    17029    3         CALL Z8CO$CHECK_POS_INT_TERM (OCC$)

  17029 22 000013   200225 630500                    EPPR0   @OCC$,,AUTO
        22 000014   000000 631400 23                 EPPR1   0
        22 000015   000000 701000 xent               TSX1    Z8CO$CHECK_POS_INT_TERM
        22 000016   000020 702000 22                 TSX2    s:17045
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:31   
        22 000017   000043 710000 22                 TRA     s:17065

      114    17030    3           WHENALTRETURN
      115    17031    4             DO;

      116    17032                    %CONDITIONAL_ERROR (@LX_ITEM$ = OCC$,
      117    17033                                        @ERROR# = %E$POSITIVE_INTEGER_EXPECTED,
      118    17034                                        @LINE = OCC$ -> LX_TERMINAL.LINE,
      119    17035                                        @COLUMN = OCC$ -> LX_TERMINAL.COLUMN);

  17045 22 000020   200225 470500                    LDP0    @OCC$,,AUTO
        22 000021   000000 471500                    LDP1    0,,PR0
        22 000022   100000 236100                    LDQ     0,,PR1
        22 000023   400000 316007                    CANQ    -131072,DL
        22 000024   000043 601000 22                 TNZ     s:17065

  17047 22 000025   100006 633500                    EPPR3   6,,PR1
        22 000026   200232 453500                    STP3    DIM+3,,AUTO
        22 000027   100005 634500                    EPPR4   5,,PR1
        22 000030   200231 454500                    STP4    DIM+2,,AUTO
        22 000031   000003 236000 23                 LDQ     3
        22 000032   200230 756100                    STQ     DIM+1,,AUTO
        22 000033   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000034   000001 631400 23                 EPPR1   1
        22 000035   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000036   000000 011000                    NOP     0

  17056 22 000037   200225 470500                    LDP0    @OCC$,,AUTO
        22 000040   000000 471500                    LDP1    0,,PR0
        22 000041   400000 236007                    LDQ     -131072,DL
        22 000042   100000 256100                    ORSQ    0,,PR1

      120    17065    4             END;

  17065 22 000043   000055 710000 22                 TRA     s:17074

      121    17066
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:32   
      122    17067    3       SELECT(%LX_ETT_ITEM);

      123    17068    3         CALL Z8CO$INTEGER_CHECK(OCC$);

  17068 22 000044   200225 630500                    EPPR0   @OCC$,,AUTO
        22 000045   000000 631400 23                 EPPR1   0
        22 000046   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        22 000047   000000 011000                    NOP     0
        22 000050   000055 710000 22                 TRA     s:17074

      124    17069
      125    17070    3       SELECT(ELSE);

      126    17071    3         CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  17071 22 000051   000005 630400 23                 EPPR0   5
        22 000052   000000 631400 23                 EPPR1   0
        22 000053   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000054   000000 011000                    NOP     0

      127    17072    3     END;

      128    17073
      129    17074    2   IF REC_INFO.ARRAY$ = ADDR(NIL) THEN

  17074 22 000055   200125 236100                    LDQ     REC_INFO+1,,AUTO
        22 000056   000006 116000 23                 CMPQ    6
        22 000057   000073 601000 22                 TNZ     s:17079

      130    17075    2     CALL Z8AE$ERROR (%E$INVALID_SET,

  17075 22 000060   200157 630500                    EPPR0   REC_INFO+27,,AUTO
        22 000061   200232 450500                    STP0    DIM+3,,AUTO
        22 000062   200156 631500                    EPPR1   REC_INFO+26,,AUTO
        22 000063   200231 451500                    STP1    DIM+2,,AUTO
        22 000064   000010 236000 23                 LDQ     8
        22 000065   200230 756100                    STQ     DIM+1,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:33   
        22 000066   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000067   000001 631400 23                 EPPR1   1
        22 000070   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000071   000000 011000                    NOP     0
        22 000072   000312 710000 22                 TRA     s:17175

      131    17076    2                      REC_INFO.LINE,
      132    17077    2                      REC_INFO.COLUMN);
      133    17078    2   ELSE
      134    17079    2     IF OCC$ -> LX_ITEM.ID = %LX_TERMINAL

  17079 22 000073   200225 470500                    LDP0    @OCC$,,AUTO
        22 000074   000000 471500                    LDP1    0,,PR0
        22 000075   100000 220100                    LDX0    0,,PR1
        22 000076   000203 601000 22                 TNZ     s:17133
        22 000077   100003 235100                    LDA     3,,PR1
        22 000100   000025 115007                    CMPA    21,DL
        22 000101   000203 601000 22                 TNZ     s:17133
        22 000102   200124 473500                    LDP3    REC_INFO,,AUTO
        22 000103   300002 221100                    LDX1    2,,PR3
        22 000104   000011 101003                    CMPX1   9,DU
        22 000105   000203 601000 22                 TNZ     s:17133

      135    17080    2          AND OCC$ -> LX_TERMINAL.SYMBOL = %NUMBER
      136    17081    2          AND REC_INFO.ST$ -> VARIABLE.TYPE = %TYX THEN
      137    17082    3       DO;

      138    17083              /* Local opt to build a 2 word constant so that a
      139    17084                 LDAQ/STAQ may be done
      140    17085              */
      141    17086    3         CALL Z8EV$CONVERT (%TYI,

  17086 22 000106   200104 634500                    EPPR4   ETT_NODE,,AUTO
        22 000107   200230 454500                    STP4    DIM+1,,AUTO
        22 000110   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000111   200233 451500                    STP1    DIM+4,,AUTO
        22 000112   200225 236100                    LDQ     @OCC$,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:34   
        22 000113   200232 756100                    STQ     DIM+3,,AUTO
        22 000114   000012 236000 23                 LDQ     10
        22 000115   200231 756100                    STQ     DIM+2,,AUTO
        22 000116   200231 630500                    EPPR0   DIM+2,,AUTO
        22 000117   000001 631400 23                 EPPR1   1
        22 000120   000000 701000 xent               TSX1    Z8EV$CONVERT
        22 000121   000000 011000                    NOP     0

      142    17087    3                            OCC$,
      143    17088    3                            ADDR(ETT_NODE));
      144    17089
      145    17090    3         LDAQSTAQ.WORD2 = ADDR(ETT_NODE) -> LX_ETT_ITEM.ETT$ ->

  17090 22 000122   200105 470500                    LDP0    ETT_NODE+1,,AUTO
        22 000123   000001 471500                    LDP1    1,,PR0
        22 000124   100010 235100                    LDA     8,,PR1
        22 000125   200227 755100                    STA     DIMS$+1,,AUTO

      146    17091    3                              ETT.LOP -> CONST.CONSTI.WORD1;
      147    17092
      148    17093    3         LDAQSTAQ.WORD1 = LDAQSTAQ.WORD2 * REC_INFO.SPAN;

  17093 22 000126   200227 236100                    LDQ     DIMS$+1,,AUTO
        22 000127   200162 402100                    MPY     REC_INFO+30,,AUTO
        22 000130   200226 756100                    STQ     LDAQSTAQ,,AUTO

      149    17094
      150    17095              %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_NODE)",
      151    17096                                 @TYPE = %TYA,
      152    17097                                 @LINE = OCC$ -> LX_TERMINAL.LINE,
      153    17098                                 @COLUMN = OCC$ -> LX_TERMINAL.COLUMN);

  17100 22 000131   000004 220003                    LDX0    4,DU
        22 000132   200104 740100                    STX0    ETT_NODE,,AUTO

  17101 22 000133   000000 221003                    LDX1    0,DU
        22 000134   200104 441100                    SXL1    ETT_NODE,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:35   

  17102 22 000135   000010 235007                    LDA     8,DL
        22 000136   200110 755100                    STA     ETT_NODE+4,,AUTO

  17103 22 000137   000006 236000 23                 LDQ     6
        22 000140   200113 756100                    STQ     ETT_NODE+7,,AUTO

  17104 22 000141   200105 756100                    STQ     ETT_NODE+1,,AUTO

  17105 22 000142   200106 756100                    STQ     ETT_NODE+2,,AUTO

  17107 22 000143   200225 470500                    LDP0    @OCC$,,AUTO
        22 000144   000000 471500                    LDP1    0,,PR0
        22 000145   100005 235100                    LDA     5,,PR1
        22 000146   200111 755100                    STA     ETT_NODE+5,,AUTO

  17108 22 000147   000000 471500                    LDP1    0,,PR0
        22 000150   100006 235100                    LDA     6,,PR1
        22 000151   200112 755100                    STA     ETT_NODE+6,,AUTO

      154    17120
      155    17121    3         CALL Z8AC$MAKE_TYA_CONST (CHAR_LDAQSTAQ,

  17121 22 000152   200105 631500                    EPPR1   ETT_NODE+1,,AUTO
        22 000153   200233 451500                    STP1    DIM+4,,AUTO
        22 000154   000016 236000 23                 LDQ     14
        22 000155   200232 756100                    STQ     DIM+3,,AUTO
        22 000156   000017 236000 23                 LDQ     15
        22 000157   200231 756100                    STQ     DIM+2,,AUTO
        22 000160   200226 633500                    EPPR3   LDAQSTAQ,,AUTO
        22 000161   200230 453500                    STP3    DIM+1,,AUTO
        22 000162   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000163   000013 631400 23                 EPPR1   11
        22 000164   000000 701000 xent               TSX1    Z8AC$MAKE_TYA_CONST
        22 000165   000000 011000                    NOP     0

      156    17122    3                                   8,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:36   
      157    17123    3                                   0,
      158    17124    3                                   ADDR(ETT_NODE) -> LX_ETT_ITEM.ETT$);
      159    17125
      160    17126    3         CALL Z8E7$MOVE (ADDR(REC_INFO.TYA),

  17126 22 000166   200126 630500                    EPPR0   REC_INFO+2,,AUTO
        22 000167   200230 450500                    STP0    DIM+1,,AUTO
        22 000170   200104 631500                    EPPR1   ETT_NODE,,AUTO
        22 000171   200231 451500                    STP1    DIM+2,,AUTO
        22 000172   200231 633500                    EPPR3   DIM+2,,AUTO
        22 000173   200233 453500                    STP3    DIM+4,,AUTO
        22 000174   200230 634500                    EPPR4   DIM+1,,AUTO
        22 000175   200232 454500                    STP4    DIM+3,,AUTO
        22 000176   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000177   000020 631400 23                 EPPR1   16
        22 000200   000000 701000 xent               TSX1    Z8E7$MOVE
        22 000201   000000 011000                    NOP     0

      161    17127    3                         ADDR(ETT_NODE));
      162    17128    3       END;

  17128 22 000202   000312 710000 22                 TRA     s:17175

      163    17129    2     ELSE
      164    17130    3       DO;

      165    17131              /* Set each field of the index item separately */
      166    17132
      167    17133    3         CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),

  17133 22 000203   200136 633500                    EPPR3   REC_INFO+10,,AUTO
        22 000204   200230 453500                    STP3    DIM+1,,AUTO
        22 000205   200225 236100                    LDQ     @OCC$,,AUTO
        22 000206   200233 756100                    STQ     DIM+4,,AUTO
        22 000207   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000210   200232 451500                    STP1    DIM+3,,AUTO
        22 000211   200232 630500                    EPPR0   DIM+3,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:37   
        22 000212   000020 631400 23                 EPPR1   16
        22 000213   000000 701000 xent               TSX1    Z8E7$MOVE
        22 000214   000000 011000                    NOP     0

      168    17134    3                         OCC$);
      169    17135
      170    17136    3         CALL Z8AC$LX_ETT_ITEM_TYI_CONST ( REC_INFO.SPAN,

  17136 22 000215   200064 630500                    EPPR0   REC_SPAN_NODE,,AUTO
        22 000216   200230 450500                    STP0    DIM+1,,AUTO
        22 000217   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000220   200233 451500                    STP1    DIM+4,,AUTO
        22 000221   200162 633500                    EPPR3   REC_INFO+30,,AUTO
        22 000222   200232 453500                    STP3    DIM+3,,AUTO
        22 000223   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000224   000020 631400 23                 EPPR1   16
        22 000225   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 000226   000000 011000                    NOP     0

      171    17137    3                                                ADDR(REC_SPAN_NODE));
      172    17138
      173    17139              %INIT_BINARY_OP (@POINTER = "ADDR(MULT_NODE)",
      174    17140                               @LINE = "REC_INFO.LINE",
      175    17141                               @BERR = OCC$ -> LX_ITEM.B.ERROR,
      176    17142                               @COLUMN = "REC_INFO.COLUMN",
      177    17143                               @ROP$ = OCC$,
      178    17144                               @LOP$ = "ADDR(REC_SPAN_NODE)",
      179    17145                               @OP = %OP_STAR);

  17147 22 000227   000005 220003                    LDX0    5,DU
        22 000230   200074 740100                    STX0    MULT_NODE,,AUTO

  17148 22 000231   000000 221003                    LDX1    0,DU
        22 000232   200074 441100                    SXL1    MULT_NODE,,AUTO

  17150 22 000233   200225 470500                    LDP0    @OCC$,,AUTO
        22 000234   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:38   
        22 000235   100000 236100                    LDQ     0,,PR1
        22 000236   200074 676100                    ERQ     MULT_NODE,,AUTO
        22 000237   400000 376007                    ANQ     -131072,DL
        22 000240   200074 656100                    ERSQ    MULT_NODE,,AUTO

  17155 22 000241   200156 235100                    LDA     REC_INFO+26,,AUTO
        22 000242   200101 755100                    STA     MULT_NODE+5,,AUTO

  17156 22 000243   200157 236100                    LDQ     REC_INFO+27,,AUTO
        22 000244   200102 756100                    STQ     MULT_NODE+6,,AUTO

  17157 22 000245   000000 236100                    LDQ     0,,PR0
        22 000246   200076 756100                    STQ     MULT_NODE+2,,AUTO

  17158 22 000247   200064 631500                    EPPR1   REC_SPAN_NODE,,AUTO
        22 000250   200075 451500                    STP1    MULT_NODE+1,,AUTO

  17159 22 000251   000022 235007                    LDA     18,DL
        22 000252   200077 755100                    STA     MULT_NODE+3,,AUTO

  17160 22 000253   000006 236000 23                 LDQ     6
        22 000254   200103 756100                    STQ     MULT_NODE+7,,AUTO

      180    17163
      181    17164              /* Local opt to use binary values when possible */
      182    17165    3         IF ADDR(REC_INFO.OCC) -> VARIABLE.TYPE = %TYI THEN

  17165 22 000255   200140 222100                    LDX2    REC_INFO+12,,AUTO
        22 000256   000001 102003                    CMPX2   1,DU
        22 000257   000262 601000 22                 TNZ     s:17168

      183    17166    3           ADDR(MULT_NODE) -> BINARY_OP.ROP$ = ADDR(REC_INFO.OCC);

  17166 22 000260   200136 633500                    EPPR3   REC_INFO+10,,AUTO
        22 000261   200076 453500                    STP3    MULT_NODE+2,,AUTO

      184    17167
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:39   
      185    17168    3         CALL Z8E5$MATH_PACK (ADDR(MULT_NODE),

  17168 22 000262   200074 633500                    EPPR3   MULT_NODE,,AUTO
        22 000263   200230 453500                    STP3    DIM+1,,AUTO
        22 000264   200104 634500                    EPPR4   ETT_NODE,,AUTO
        22 000265   200231 454500                    STP4    DIM+2,,AUTO
        22 000266   200231 635500                    EPPR5   DIM+2,,AUTO
        22 000267   200233 455500                    STP5    DIM+4,,AUTO
        22 000270   200230 636500                    EPPR6   DIM+1,,AUTO
        22 000271   200232 456500                    STP6    DIM+3,,AUTO
        22 000272   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000273   000020 631400 23                 EPPR1   16
        22 000274   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 000275   000000 011000                    NOP     0

      186    17169    3                              ADDR(ETT_NODE));
      187    17170
      188    17171    3         CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),

  17171 22 000276   200146 630500                    EPPR0   REC_INFO+18,,AUTO
        22 000277   200230 450500                    STP0    DIM+1,,AUTO
        22 000300   200104 631500                    EPPR1   ETT_NODE,,AUTO
        22 000301   200231 451500                    STP1    DIM+2,,AUTO
        22 000302   200231 633500                    EPPR3   DIM+2,,AUTO
        22 000303   200233 453500                    STP3    DIM+4,,AUTO
        22 000304   200230 634500                    EPPR4   DIM+1,,AUTO
        22 000305   200232 454500                    STP4    DIM+3,,AUTO
        22 000306   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000307   000020 631400 23                 EPPR1   16
        22 000310   000000 701000 xent               TSX1    Z8E7$MOVE
        22 000311   000000 011000                    NOP     0

      189    17172    3                         ADDR(ETT_NODE));
      190    17173
      191    17174    3       END;

      192    17175    2   END SET_INDEX_FROM_OCC;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:40   

  17175 22 000312   200224 221300                    LDX1  ! @SEND$+1,,AUTO
        22 000313   000001 702211                    TSX2  ! 1,X1

      193    17176
      194    17177        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:41   
      195    17178    1   RESOLVE_INDEX_REFERENCES : PROC (INDEX$,

  17178 22 000314   200222 741300       RESOLVE_IND* STX1  ! SEND_INFO+31,,AUTO

      196    17179    1                                    INDEX_INFO,
      197    17180    1                                    SUBSCRIPT$);
      198    17181
      199    17182    2     DCL INDEX$ PTR;  /* to LX_ETT_ITEM */
      200    17183    2     DCL 1 INDEX_INFO ALIGNED,
      201    17184                %INDEX_INFO;
      202    17199    2     DCL SUBSCRIPT$ PTR;
      203    17200
      204    17201    2     DCL DIMS$ PTR;
      205    17202    2     DCL DIM SBIN WORD;
      206    17203
      207    17204
      208    17205    2   INDEX_INFO.INDEX_TYPE = TRUE;

  17205 22 000315   400000 236003                    LDQ     -131072,DU
        22 000316   200224 470500                    LDP0    @INDEX_INFO,,AUTO
        22 000317   000035 756100                    STQ     29,,PR0

      209    17206
      210    17207        %FISH (TRIAD = "INDEX$ -> LX_ETT_ITEM.ETT$",
      211    17208               RTN = INDEX_INFO.ST$);

  17210 22 000320   200223 471500                    LDP1    @INDEX$,,AUTO
        22 000321   100000 473500                    LDP3    0,,PR1
        22 000322   300001 236100                    LDQ     1,,PR3
        22 000323   000000 756100                    STQ     0,,PR0

  17211 22 000324   000000 473500                    LDP3    0,,PR0
        22 000325   300000 220100                    LDX0    0,,PR3
        22 000326   000751 100003                    CMPX0   489,DU
        22 000327   000340 603000 22                 TRC     s:17217

  17212 22 000330   200224 470500                    LDP0    @INDEX_INFO,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:42   
        22 000331   000000 471500                    LDP1    0,,PR0
        22 000332   100001 236100                    LDQ     1,,PR1
        22 000333   000000 756100                    STQ     0,,PR0

  17213 22 000334   000000 471500                    LDP1    0,,PR0
        22 000335   100000 220100                    LDX0    0,,PR1
        22 000336   000751 100003                    CMPX0   489,DU
        22 000337   000330 602000 22                 TNC     s:17212

      212    17216
      213    17217    2   INDEX_INFO.LINE = INDEX$ -> LX_ETT_ITEM.LINE;

  17217 22 000340   200223 471500                    LDP1    @INDEX$,,AUTO
        22 000341   100000 473500                    LDP3    0,,PR1
        22 000342   300005 235100                    LDA     5,,PR3
        22 000343   000032 755100                    STA     26,,PR0

      214    17218    2   INDEX_INFO.COLUMN = INDEX$ -> LX_ETT_ITEM.COLUMN;

  17218 22 000344   100000 473500                    LDP3    0,,PR1
        22 000345   300006 235100                    LDA     6,,PR3
        22 000346   000033 755100                    STA     27,,PR0

      215    17219    2   INDEX_INFO.TYPE = INDEX$ -> LX_ETT_ITEM.TYPE;

  17219 22 000347   100000 473500                    LDP3    0,,PR1
        22 000350   300004 235100                    LDA     4,,PR3
        22 000351   000034 755100                    STA     28,,PR0

      216    17220
      217    17221    3   DO SELECT (INDEX_INFO.ST$ -> SCALAR.TYPE);

  17221 22 000352   000000 473500                    LDP3    0,,PR0
        22 000353   300002 236100                    LDQ     2,,PR3
        22 000354   000022 772000                    QRL     18
        22 000355   000012 116007                    CMPQ    10,DL
        22 000356   000361 602000 22                 TNC     s:17221+7
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:43   
        22 000357   000365 600000 22                 TZE     s:17224
        22 000360   000447 710000 22                 TRA     s:17298
        22 000361   300002 220100                    LDX0    2,,PR3
        22 000362   000011 100003                    CMPX0   9,DU
        22 000363   000447 601000 22                 TNZ     s:17298
        22 000364   000371 710000 22                 TRA     s:17229

      218    17222
      219    17223    3     SELECT(%TYY);

      220    17224    3       INDEX_INFO.ARRAY$ = ADDR(NIL);

  17224 22 000365   000006 236000 23                 LDQ     6
        22 000366   000001 756100                    STQ     1,,PR0

      221    17225    3       INDEX_INFO.SPAN   = 0;

  17225 22 000367   000036 450100                    STZ     30,,PR0
        22 000370   000453 710000 22                 TRA     s:17301

      222    17226
      223    17227    3     SELECT(%TYX);

      224    17228
      225    17229    3       IF INDEX_INFO.ST$ -> ST.ID = %ARRAY

  17229 22 000371   300000 221100                    LDX1    0,,PR3
        22 000372   000765 101003                    CMPX1   501,DU
        22 000373   000403 600000 22                 TZE     s:17234
        22 000374   300005 236100                    LDQ     5,,PR3
        22 000375   000006 116000 23                 CMPQ    6
        22 000376   000403 600000 22                 TZE     s:17234
        22 000377   300005 474500                    LDP4    5,,PR3
        22 000400   400000 222100                    LDX2    0,,PR4
        22 000401   000765 102003                    CMPX2   501,DU
        22 000402   000407 600000 22                 TZE     s:17239

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:44   
      226    17230    3             OR INDEX_INFO.ST$ -> SCALAR.LTS$ = ADDR(NIL)
      227    17231    3             OR INDEX_INFO.ST$ -> SCALAR.LTS$ -> ST.ID ~= %ARRAY THEN
      228    17232    4         DO;

      229    17233                /* This must be an optimized TYY item */
      230    17234    4           INDEX_INFO.ARRAY$ = ADDR(NIL);

  17234 22 000403   000006 236000 23                 LDQ     6
        22 000404   000001 756100                    STQ     1,,PR0

      231    17235    4           INDEX_INFO.SPAN   = 0;

  17235 22 000405   000036 450100                    STZ     30,,PR0

      232    17236    4         END;

  17236 22 000406   000453 710000 22                 TRA     s:17301

      233    17237    3       ELSE
      234    17238    4         DO;  /* This is a real TYX */

      235    17239    4           INDEX_INFO.ARRAY$ = INDEX_INFO.ST$ -> SCALAR.LTS$;

  17239 22 000407   000001 756100                    STQ     1,,PR0

      236    17240
      237    17241                %GET_LTS (@ID = %DIMS,
      238    17242                          @ST$ = INDEX_INFO.ARRAY$,
      239    17243                          @RETURN$ = DIMS$);

  17245 22 000410   000001 474500                    LDP4    1,,PR0
        22 000411   400005 236100                    LDQ     5,,PR4
        22 000412   000006 116000 23                 CMPQ    6
        22 000413   000423 600000 22                 TZE     s:17279
        22 000414   400005 475500                    LDP5    5,,PR4
        22 000415   500000 220100                    LDX0    0,,PR5
        22 000416   001105 100003                    CMPX0   581,DU
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:45   
        22 000417   000423 601000 22                 TNZ     s:17279

  17249 22 000420   500001 236100                    LDQ     1,,PR5
        22 000421   200226 756100                    STQ     DIMS$,,AUTO

  17277 22 000422   000435 710000 22                 TRA     s:17290

  17279 22 000423   000006 116000 23                 CMPQ    6
        22 000424   000433 600000 22                 TZE     s:17283
        22 000425   400005 475500                    LDP5    5,,PR4
        22 000426   500000 220100                    LDX0    0,,PR5
        22 000427   001104 100003                    CMPX0   580,DU
        22 000430   000433 601000 22                 TNZ     s:17283

  17281 22 000431   200226 756100                    STQ     DIMS$,,AUTO
        22 000432   000435 710000 22                 TRA     s:17290

  17283 22 000433   000006 236000 23                 LDQ     6
        22 000434   200226 756100                    STQ     DIMS$,,AUTO

      240    17286
      241    17287                %FIND_LAST_DIM (POINTER = DIMS$,
      242    17288                                 VARIABLE = DIM);

  17290 22 000435   200226 475500                    LDP5    DIMS$,,AUTO
        22 000436   500000 236100                    LDQ     0,,PR5
        22 000437   777777 376007                    ANQ     -1,DL
        22 000440   000005 136007                    SBLQ    5,DL
        22 000441   000003 506007                    DIV     3,DL
        22 000442   200227 756100                    STQ     DIM,,AUTO

      243    17293
      244    17294    4           INDEX_INFO.SPAN = DIMS$ -> DIMS.D.SPAN(DIM);

  17294 22 000443   000003 402007                    MPY     3,DL
        22 000444   500002 235106                    LDA     2,QL,PR5
        22 000445   000036 755100                    STA     30,,PR0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:46   

      245    17295    4         END;

  17295 22 000446   000453 710000 22                 TRA     s:17301

      246    17296
      247    17297    3     SELECT(ELSE);

      248    17298    3       CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  17298 22 000447   000005 630400 23                 EPPR0   5
        22 000450   000000 631400 23                 EPPR1   0
        22 000451   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000452   000000 011000                    NOP     0

      249    17299    3   END;  /* DO SELECT */

      250    17300
      251    17301    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST(

  17301 22 000453   200224 470500                    LDP0    @INDEX_INFO,,AUTO
        22 000454   000000 471500                    LDP1    0,,PR0
        22 000455   100007 473500                    LDP3    7,,PR1
        22 000456   300002 474500                    LDP4    2,,PR3
        22 000457   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000460   000002 036003                    ADLQ    2,DU
        22 000461   200230 756100                    STQ     DIM+1,,AUTO
        22 000462   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000463   000033 036003                    ADLQ    27,DU
        22 000464   200235 756100                    STQ     DIM+6,,AUTO
        22 000465   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000466   000032 036003                    ADLQ    26,DU
        22 000467   200234 756100                    STQ     DIM+5,,AUTO
        22 000470   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000471   200233 451500                    STP1    DIM+4,,AUTO
        22 000472   400004 633500                    EPPR3   4,,PR4
        22 000473   200232 453500                    STP3    DIM+3,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:47   
        22 000474   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000475   000013 631400 23                 EPPR1   11
        22 000476   000000 701000 xent               TSX1    Z8EU$CREATE_IDENTIFIER_FROM_ST
        22 000477   000000 011000                    NOP     0

      252    17302    2           INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.ST$,
      253    17303    2           ADDR(INDEX_INFO.TYA),
      254    17304    2           INDEX_INFO.LINE,
      255    17305    2           INDEX_INFO.COLUMN);
      256    17306
      257    17307    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST (

  17307 22 000500   200224 470500                    LDP0    @INDEX_INFO,,AUTO
        22 000501   000000 471500                    LDP1    0,,PR0
        22 000502   100007 473500                    LDP3    7,,PR1
        22 000503   300002 474500                    LDP4    2,,PR3
        22 000504   400003 475500                    LDP5    3,,PR4
        22 000505   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000506   000022 036003                    ADLQ    18,DU
        22 000507   200230 756100                    STQ     DIM+1,,AUTO
        22 000510   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000511   000033 036003                    ADLQ    27,DU
        22 000512   200235 756100                    STQ     DIM+6,,AUTO
        22 000513   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000514   000032 036003                    ADLQ    26,DU
        22 000515   200234 756100                    STQ     DIM+5,,AUTO
        22 000516   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000517   200233 451500                    STP1    DIM+4,,AUTO
        22 000520   500004 633500                    EPPR3   4,,PR5
        22 000521   200232 453500                    STP3    DIM+3,,AUTO
        22 000522   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000523   000013 631400 23                 EPPR1   11
        22 000524   000000 701000 xent               TSX1    Z8EU$CREATE_IDENTIFIER_FROM_ST
        22 000525   000000 011000                    NOP     0

      258    17308    2               INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER
      259    17309    2                               -> QLT.SON -> QLT.ST$,
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:48   
      260    17310    2               ADDR(INDEX_INFO.SPAN_OCC),
      261    17311    2               INDEX_INFO.LINE,
      262    17312    2               INDEX_INFO.COLUMN);
      263    17313
      264    17314    2   CALL Z8EU$CREATE_IDENTIFIER_FROM_ST(

  17314 22 000526   200224 470500                    LDP0    @INDEX_INFO,,AUTO
        22 000527   000000 471500                    LDP1    0,,PR0
        22 000530   100007 473500                    LDP3    7,,PR1
        22 000531   300002 474500                    LDP4    2,,PR3
        22 000532   400003 475500                    LDP5    3,,PR4
        22 000533   500002 476500                    LDP6    2,,PR5
        22 000534   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000535   000012 036003                    ADLQ    10,DU
        22 000536   200230 756100                    STQ     DIM+1,,AUTO
        22 000537   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000540   000033 036003                    ADLQ    27,DU
        22 000541   200235 756100                    STQ     DIM+6,,AUTO
        22 000542   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000543   000032 036003                    ADLQ    26,DU
        22 000544   200234 756100                    STQ     DIM+5,,AUTO
        22 000545   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000546   200233 451500                    STP1    DIM+4,,AUTO
        22 000547   600004 633500                    EPPR3   4,,PR6
        22 000550   200232 453500                    STP3    DIM+3,,AUTO
        22 000551   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000552   000013 631400 23                 EPPR1   11
        22 000553   000000 701000 xent               TSX1    Z8EU$CREATE_IDENTIFIER_FROM_ST
        22 000554   000000 011000                    NOP     0

      265    17315    2               INDEX_INFO.ST$ -> SCALAR.QLT$ -> QLT.BROTHER -> QLT.SON
      266    17316    2                          -> QLT.BROTHER -> QLT.ST$,
      267    17317    2               ADDR(INDEX_INFO.OCC),
      268    17318    2               INDEX_INFO.LINE,
      269    17319    2               INDEX_INFO.COLUMN);
      270    17320
      271    17321    2   IF ADDR(SUBSCRIPT$) ~= ADDR(NIL)
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:49   

  17321 22 000555   200225 236100                    LDQ     @SUBSCRIPT$,,AUTO
        22 000556   000006 116000 23                 CMPQ    6
        22 000557   000625 600000 22                 TZE     s:17332
        22 000560   200225 470500                    LDP0    @SUBSCRIPT$,,AUTO
        22 000561   000000 236100                    LDQ     0,,PR0
        22 000562   000006 116000 23                 CMPQ    6
        22 000563   000625 600000 22                 TZE     s:17332

      272    17322    2        AND SUBSCRIPT$ ~= ADDR(NIL) THEN
      273    17323    3     DO;

      274    17324    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,

  17324 22 000564   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000565   000002 036003                    ADLQ    2,DU
        22 000566   200230 756100                    STQ     DIM+1,,AUTO
        22 000567   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000570   200233 451500                    STP1    DIM+4,,AUTO
        22 000571   200225 236100                    LDQ     @SUBSCRIPT$,,AUTO
        22 000572   200232 756100                    STQ     DIM+3,,AUTO
        22 000573   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000574   000020 631400 23                 EPPR1   16
        22 000575   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 000576   000000 011000                    NOP     0

      275    17325    3                            ADDR(INDEX_INFO.TYA));
      276    17326    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,

  17326 22 000577   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000600   000022 036003                    ADLQ    18,DU
        22 000601   200230 756100                    STQ     DIM+1,,AUTO
        22 000602   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000603   200233 450500                    STP0    DIM+4,,AUTO
        22 000604   200225 236100                    LDQ     @SUBSCRIPT$,,AUTO
        22 000605   200232 756100                    STQ     DIM+3,,AUTO
        22 000606   200232 630500                    EPPR0   DIM+3,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:50   
        22 000607   000020 631400 23                 EPPR1   16
        22 000610   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 000611   000000 011000                    NOP     0

      277    17327    3                            ADDR(INDEX_INFO.SPAN_OCC));
      278    17328    3       CALL Z8EY$SUBSCRIPT (SUBSCRIPT$,

  17328 22 000612   200224 236100                    LDQ     @INDEX_INFO,,AUTO
        22 000613   000012 036003                    ADLQ    10,DU
        22 000614   200230 756100                    STQ     DIM+1,,AUTO
        22 000615   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000616   200233 450500                    STP0    DIM+4,,AUTO
        22 000617   200225 236100                    LDQ     @SUBSCRIPT$,,AUTO
        22 000620   200232 756100                    STQ     DIM+3,,AUTO
        22 000621   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000622   000020 631400 23                 EPPR1   16
        22 000623   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 000624   000000 011000                    NOP     0

      279    17329    3                            ADDR(INDEX_INFO.OCC));
      280    17330    3     END;

      281    17331
      282    17332    2   END RESOLVE_INDEX_REFERENCES;

  17332 22 000625   200222 221300                    LDX1  ! SEND_INFO+31,,AUTO
        22 000626   000001 702211                    TSX2  ! 1,X1

      283    17333        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:51   
      284    17334    1   SET_UP_DOWN : PROC (SEND$,

  17334 22 000627   200222 741300       SET_UP_DOWN  STX1  ! SEND_INFO+31,,AUTO

      285    17335    1                       EXPR_ID);
      286    17336
      287    17337    2     DCL SEND$ PTR;  /* To arith expr for incremental value */
      288    17338    2     DCL EXPR_ID SBIN WORD;  /* operation code (add or subtract) */
      289    17339
      290    17340          /* Semantic checks for SET UP or DOWN:
      291    17341                Identifier must be integer;
      292    17342                Number must be integer (possibly signed)
      293    17343          */
      294    17344    3     DO SELECT (SEND$ -> LX_ITEM.ID);

  17344 22 000630   200223 470500                    LDP0    @SEND$,,AUTO
        22 000631   000000 471500                    LDP1    0,,PR0
        22 000632   100000 220100                    LDX0    0,,PR1
        22 000633   000637 600000 22                 TZE     s:17347
        22 000634   000004 100003                    CMPX0   4,DU
        22 000635   000705 601000 22                 TNZ     s:17397
        22 000636   000670 710000 22                 TRA     s:17387

      295    17345
      296    17346    3       SELECT(%LX_TERMINAL);

      297    17347    3         CALL Z8CO$CHECK_INTEGER_TERMINAL (SEND$)

  17347 22 000637   200223 630500                    EPPR0   @SEND$,,AUTO
        22 000640   000000 631400 23                 EPPR1   0
        22 000641   000000 701000 xent               TSX1    Z8CO$CHECK_INTEGER_TERMINAL
        22 000642   000644 702000 22                 TSX2    s:17363
        22 000643   000667 710000 22                 TRA     s:17383

      298    17348    3           WHENALTRETURN
      299    17349    4             DO;

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:52   
      300    17350                    %CONDITIONAL_ERROR (@LX_ITEM$ = SEND$,
      301    17351                                        @ERROR# = %E$MUST_BE_INTEGER,
      302    17352                                        @LINE = SEND$ -> LX_TERMINAL.LINE,
      303    17353                                        @COLUMN = SEND$ -> LX_TERMINAL.COLUMN);

  17363 22 000644   200223 470500                    LDP0    @SEND$,,AUTO
        22 000645   000000 471500                    LDP1    0,,PR0
        22 000646   100000 236100                    LDQ     0,,PR1
        22 000647   400000 316007                    CANQ    -131072,DL
        22 000650   000667 601000 22                 TNZ     s:17383

  17365 22 000651   100006 633500                    EPPR3   6,,PR1
        22 000652   200232 453500                    STP3    DIM+3,,AUTO
        22 000653   100005 634500                    EPPR4   5,,PR1
        22 000654   200231 454500                    STP4    DIM+2,,AUTO
        22 000655   000022 236000 23                 LDQ     18
        22 000656   200230 756100                    STQ     DIM+1,,AUTO
        22 000657   200230 630500                    EPPR0   DIM+1,,AUTO
        22 000660   000001 631400 23                 EPPR1   1
        22 000661   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000662   000000 011000                    NOP     0

  17374 22 000663   200223 470500                    LDP0    @SEND$,,AUTO
        22 000664   000000 471500                    LDP1    0,,PR0
        22 000665   400000 236007                    LDQ     -131072,DL
        22 000666   100000 256100                    ORSQ    0,,PR1

      304    17383    4             END;

  17383 22 000667   000711 710000 22                 TRA     s:17408

      305    17384
      306    17385    3       SELECT(%LX_ETT_ITEM);

      307    17386
      308    17387    4         DO SELECT (SEND$ -> LX_ETT_ITEM.TYPE);

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:53   
  17387 22 000670   100004 236100                    LDQ     4,,PR1
        22 000671   000011 116007                    CMPQ    9,DL
        22 000672   000700 602000 22                 TNC     s:17392
        22 000673   000677 600000 22                 TZE     s:17389
        22 000674   000012 116007                    CMPQ    10,DL
        22 000675   000700 601000 22                 TNZ     s:17392
        22 000676   000677 710000 22                 TRA     s:17389

      309    17388
      310    17389    4           SELECT(%TYX, %TYY);

  17389 22 000677   000711 710000 22                 TRA     s:17408

      311    17390
      312    17391    4           SELECT(ELSE);

      313    17392    4             CALL Z8CO$INTEGER_CHECK(SEND$);

  17392 22 000700   200223 630500                    EPPR0   @SEND$,,AUTO
        22 000701   000000 631400 23                 EPPR1   0
        22 000702   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        22 000703   000000 011000                    NOP     0

      314    17393    4         END;

  17393 22 000704   000711 710000 22                 TRA     s:17408

      315    17394
      316    17395    3       SELECT(ELSE);

      317    17396
      318    17397    3         CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  17397 22 000705   000005 630400 23                 EPPR0   5
        22 000706   000000 631400 23                 EPPR1   0
        22 000707   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000710   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:54   

      319    17398    3     END;

      320    17399
      321    17400          %INIT_BINARY_OP (@POINTER = "ADDR(ADD_NODE)",
      322    17401                           @LINE = "REC_INFO.LINE",
      323    17402                           @BERR = SEND$ -> LX_ITEM.B.ERROR,
      324    17403                           @COLUMN = "REC_INFO.COLUMN",
      325    17404                           @LOP$ = "ADDR(REC_INFO.OCC)",
      326    17405                           @ROP$ = SEND$,
      327    17406                           @OP = EXPR_ID);

  17408 22 000711   000005 220003                    LDX0    5,DU
        22 000712   200034 740100                    STX0    ADD_NODE,,AUTO

  17409 22 000713   000000 221003                    LDX1    0,DU
        22 000714   200034 441100                    SXL1    ADD_NODE,,AUTO

  17411 22 000715   200223 470500                    LDP0    @SEND$,,AUTO
        22 000716   000000 471500                    LDP1    0,,PR0
        22 000717   100000 236100                    LDQ     0,,PR1
        22 000720   200034 676100                    ERQ     ADD_NODE,,AUTO
        22 000721   400000 376007                    ANQ     -131072,DL
        22 000722   200034 656100                    ERSQ    ADD_NODE,,AUTO

  17416 22 000723   200156 235100                    LDA     REC_INFO+26,,AUTO
        22 000724   200041 755100                    STA     ADD_NODE+5,,AUTO

  17417 22 000725   200157 236100                    LDQ     REC_INFO+27,,AUTO
        22 000726   200042 756100                    STQ     ADD_NODE+6,,AUTO

  17418 22 000727   000000 236100                    LDQ     0,,PR0
        22 000730   200036 756100                    STQ     ADD_NODE+2,,AUTO

  17419 22 000731   200136 631500                    EPPR1   REC_INFO+10,,AUTO
        22 000732   200035 451500                    STP1    ADD_NODE+1,,AUTO

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:55   
  17420 22 000733   200224 473500                    LDP3    @EXPR_ID,,AUTO
        22 000734   300000 235100                    LDA     0,,PR3
        22 000735   200037 755100                    STA     ADD_NODE+3,,AUTO

  17421 22 000736   000006 236000 23                 LDQ     6
        22 000737   200043 756100                    STQ     ADD_NODE+7,,AUTO

      328    17424
      329    17425    2     CALL Z8E5$MATH_PACK (ADDR(ADD_NODE),

  17425 22 000740   200034 634500                    EPPR4   ADD_NODE,,AUTO
        22 000741   200230 454500                    STP4    DIM+1,,AUTO
        22 000742   200104 635500                    EPPR5   ETT_NODE,,AUTO
        22 000743   200231 455500                    STP5    DIM+2,,AUTO
        22 000744   200231 636500                    EPPR6   DIM+2,,AUTO
        22 000745   200233 456500                    STP6    DIM+4,,AUTO
        22 000746   200230 637500                    EPPR7   DIM+1,,AUTO
        22 000747   200232 457500                    STP7    DIM+3,,AUTO
        22 000750   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000751   000020 631400 23                 EPPR1   16
        22 000752   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 000753   000000 011000                    NOP     0

      330    17426    2                          ADDR(ETT_NODE));
      331    17427
      332    17428    2     CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),

  17428 22 000754   200136 630500                    EPPR0   REC_INFO+10,,AUTO
        22 000755   200230 450500                    STP0    DIM+1,,AUTO
        22 000756   200104 631500                    EPPR1   ETT_NODE,,AUTO
        22 000757   200231 451500                    STP1    DIM+2,,AUTO
        22 000760   200231 633500                    EPPR3   DIM+2,,AUTO
        22 000761   200233 453500                    STP3    DIM+4,,AUTO
        22 000762   200230 634500                    EPPR4   DIM+1,,AUTO
        22 000763   200232 454500                    STP4    DIM+3,,AUTO
        22 000764   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000765   000020 631400 23                 EPPR1   16
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:56   
        22 000766   000000 701000 xent               TSX1    Z8E7$MOVE
        22 000767   000000 011000                    NOP     0

      333    17429    2                     ADDR(ETT_NODE));
      334    17430
      335    17431    2     CALL Z8AC$LX_ETT_ITEM_TYI_CONST (REC_INFO.SPAN,

  17431 22 000770   200064 630500                    EPPR0   REC_SPAN_NODE,,AUTO
        22 000771   200230 450500                    STP0    DIM+1,,AUTO
        22 000772   200230 631500                    EPPR1   DIM+1,,AUTO
        22 000773   200233 451500                    STP1    DIM+4,,AUTO
        22 000774   200162 633500                    EPPR3   REC_INFO+30,,AUTO
        22 000775   200232 453500                    STP3    DIM+3,,AUTO
        22 000776   200232 630500                    EPPR0   DIM+3,,AUTO
        22 000777   000020 631400 23                 EPPR1   16
        22 001000   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 001001   000000 011000                    NOP     0

      336    17432    2                                      ADDR(REC_SPAN_NODE));
      337    17433
      338    17434          %INIT_BINARY_OP (@POINTER = "ADDR(MULT_NODE)",
      339    17435                           @LINE = "REC_INFO.LINE",
      340    17436                           @BERR = SEND$ -> LX_ITEM.B.ERROR,
      341    17437                           @COLUMN = "REC_INFO.COLUMN",
      342    17438                           @LOP$ = "ADDR(REC_SPAN_NODE)",
      343    17439                           @ROP$ = SEND$,
      344    17440                           @OP = %OP_STAR);

  17442 22 001002   000005 220003                    LDX0    5,DU
        22 001003   200074 740100                    STX0    MULT_NODE,,AUTO

  17443 22 001004   000000 221003                    LDX1    0,DU
        22 001005   200074 441100                    SXL1    MULT_NODE,,AUTO

  17445 22 001006   200223 470500                    LDP0    @SEND$,,AUTO
        22 001007   000000 471500                    LDP1    0,,PR0
        22 001010   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:57   
        22 001011   200074 676100                    ERQ     MULT_NODE,,AUTO
        22 001012   400000 376007                    ANQ     -131072,DL
        22 001013   200074 656100                    ERSQ    MULT_NODE,,AUTO

  17450 22 001014   200156 235100                    LDA     REC_INFO+26,,AUTO
        22 001015   200101 755100                    STA     MULT_NODE+5,,AUTO

  17451 22 001016   200157 236100                    LDQ     REC_INFO+27,,AUTO
        22 001017   200102 756100                    STQ     MULT_NODE+6,,AUTO

  17452 22 001020   000000 236100                    LDQ     0,,PR0
        22 001021   200076 756100                    STQ     MULT_NODE+2,,AUTO

  17453 22 001022   200064 631500                    EPPR1   REC_SPAN_NODE,,AUTO
        22 001023   200075 451500                    STP1    MULT_NODE+1,,AUTO

  17454 22 001024   000022 235007                    LDA     18,DL
        22 001025   200077 755100                    STA     MULT_NODE+3,,AUTO

  17455 22 001026   000006 236000 23                 LDQ     6
        22 001027   200103 756100                    STQ     MULT_NODE+7,,AUTO

      345    17458
      346    17459    2     ADDR(ADD_NODE) -> BINARY_OP.LOP$ = ADDR(REC_INFO.SPAN_OCC);

  17459 22 001030   200146 633500                    EPPR3   REC_INFO+18,,AUTO
        22 001031   200035 453500                    STP3    ADD_NODE+1,,AUTO

      347    17460    2     ADDR(ADD_NODE) -> BINARY_OP.ROP$ = ADDR(MULT_NODE);

  17460 22 001032   200074 634500                    EPPR4   MULT_NODE,,AUTO
        22 001033   200036 454500                    STP4    ADD_NODE+2,,AUTO

      348    17461
      349    17462    2     CALL Z8E5$MATH_PACK (ADDR(ADD_NODE),

  17462 22 001034   200034 635500                    EPPR5   ADD_NODE,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:58   
        22 001035   200230 455500                    STP5    DIM+1,,AUTO
        22 001036   200104 636500                    EPPR6   ETT_NODE,,AUTO
        22 001037   200231 456500                    STP6    DIM+2,,AUTO
        22 001040   200231 637500                    EPPR7   DIM+2,,AUTO
        22 001041   200233 457500                    STP7    DIM+4,,AUTO
        22 001042   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001043   200232 450500                    STP0    DIM+3,,AUTO
        22 001044   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001045   000020 631400 23                 EPPR1   16
        22 001046   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 001047   000000 011000                    NOP     0

      350    17463    2                          ADDR(ETT_NODE));
      351    17464
      352    17465    2     CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),

  17465 22 001050   200146 630500                    EPPR0   REC_INFO+18,,AUTO
        22 001051   200230 450500                    STP0    DIM+1,,AUTO
        22 001052   200104 631500                    EPPR1   ETT_NODE,,AUTO
        22 001053   200231 451500                    STP1    DIM+2,,AUTO
        22 001054   200231 633500                    EPPR3   DIM+2,,AUTO
        22 001055   200233 453500                    STP3    DIM+4,,AUTO
        22 001056   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001057   200232 454500                    STP4    DIM+3,,AUTO
        22 001060   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001061   000020 631400 23                 EPPR1   16
        22 001062   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001063   000000 011000                    NOP     0

      353    17466    2                     ADDR(ETT_NODE));
      354    17467
      355    17468    2   END SET_UP_DOWN;

  17468 22 001064   200222 221300                    LDX1  ! SEND_INFO+31,,AUTO
        22 001065   000001 702211                    TSX2  ! 1,X1

      356    17469
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:59   
      357    17470        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:60   
      358    17471    1   MOVE_INDEX : PROC ;

  17471 22 001066   200222 741300       MOVE_INDEX   STX1  ! SEND_INFO+31,,AUTO

      359    17472
      360    17473
      361    17474                    /* Moves between index items are as follows:
      362    17475
      363    17476                        TYPE   REC    SEND   SPAN   MOVE
      364    17477                        ----   ----   ----   ----   ----
      365    17478                         L      A      A      =      TYA
      366    17479                         L      A      A      ~=     OCC
      367    17480                         L      A      I      NA     TYA
      368    17481                         L      I      A      NA     TYA
      369    17482                         L      I      I      NA     TYA
      370    17483                         U      A      A      =      OCC, OCC*SPAN
      371    17484                         U      A      A      ~=     OCC
      372    17485                         U      A      I      NA     OCC
      373    17486                         U      I      A      NA     OCC, OCC*SPAN
      374    17487                         U      I      I      NA     OCC, OCC*SPAN
      375    17488
      376    17489                       U => Type of REC index ~= type of SEND index
      377    17490                       L => Type of REC index = type of SEND index
      378    17491                       A => Variable is associated with an array
      379    17492                       I => Variable is a data item, not assoc. with an array
      380    17493                       NA => Not applicable
      381    17494                       TYA => Move the entire structure without conversion
      382    17495                       OCC => Build a new index item based on the SEND occurrence #
      383    17496                       OCC, OCC*SPAN => Move each field separately, so that conversion
      384    17497                                           will change COMP-6 <=> COMP-1,COMP-2
      385    17498                    */
      386    17499
      387    17500    2               IF REC_INFO.TYPE = SEND_INFO.TYPE

  17500 22 001067   200160 236100                    LDQ     REC_INFO+28,,AUTO
        22 001070   200217 116100                    CMPQ    SEND_INFO+28,,AUTO
        22 001071   001121 601000 22                 TNZ     s:17510
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:61   
        22 001072   200125 236100                    LDQ     REC_INFO+1,,AUTO
        22 001073   000006 116000 23                 CMPQ    6
        22 001074   001104 600000 22                 TZE     s:17506
        22 001075   001121 600000 22                 TZE     s:17510
        22 001076   200164 236100                    LDQ     SEND_INFO+1,,AUTO
        22 001077   000006 116000 23                 CMPQ    6
        22 001100   001104 600000 22                 TZE     s:17506
        22 001101   200162 236100                    LDQ     REC_INFO+30,,AUTO
        22 001102   200221 116100                    CMPQ    SEND_INFO+30,,AUTO
        22 001103   001121 601000 22                 TNZ     s:17510

      388    17501    2                   AND (REC_INFO.ARRAY$ = ADDR(NIL)
      389    17502    2                         OR (REC_INFO.ARRAY$ ~= ADDR(NIL)
      390    17503    2                              AND (SEND_INFO.ARRAY$ = ADDR(NIL)
      391    17504    2                                    OR REC_INFO.SPAN = SEND_INFO.SPAN))) THEN
      392    17505    3                 DO;

      393    17506    3                   CALL Z8E7$MOVE (ADDR(REC_INFO.TYA),

  17506 22 001104   200126 630500                    EPPR0   REC_INFO+2,,AUTO
        22 001105   200230 450500                    STP0    DIM+1,,AUTO
        22 001106   200165 631500                    EPPR1   SEND_INFO+2,,AUTO
        22 001107   200231 451500                    STP1    DIM+2,,AUTO
        22 001110   200231 633500                    EPPR3   DIM+2,,AUTO
        22 001111   200233 453500                    STP3    DIM+4,,AUTO
        22 001112   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001113   200232 454500                    STP4    DIM+3,,AUTO
        22 001114   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001115   000020 631400 23                 EPPR1   16
        22 001116   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001117   000000 011000                    NOP     0

      394    17507    3                                   ADDR(SEND_INFO.TYA));
      395    17508    3                 END;

  17508 22 001120   001175 710000 22                 TRA     s:17525

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:62   
      396    17509    2               ELSE
      397    17510    2                 IF REC_INFO.TYPE ~= SEND_INFO.TYPE

  17510 22 001121   200160 236100                    LDQ     REC_INFO+28,,AUTO
        22 001122   200217 116100                    CMPQ    SEND_INFO+28,,AUTO
        22 001123   001167 600000 22                 TZE     s:17523
        22 001124   200125 236100                    LDQ     REC_INFO+1,,AUTO
        22 001125   000006 116000 23                 CMPQ    6
        22 001126   001136 600000 22                 TZE     s:17516
        22 001127   001167 600000 22                 TZE     s:17523
        22 001130   200164 236100                    LDQ     SEND_INFO+1,,AUTO
        22 001131   000006 116000 23                 CMPQ    6
        22 001132   001136 600000 22                 TZE     s:17516
        22 001133   200162 236100                    LDQ     REC_INFO+30,,AUTO
        22 001134   200221 116100                    CMPQ    SEND_INFO+30,,AUTO
        22 001135   001167 601000 22                 TNZ     s:17523

      398    17511    2                     AND (REC_INFO.ARRAY$ = ADDR(NIL)
      399    17512    2                           OR (REC_INFO.ARRAY$ ~= ADDR(NIL)
      400    17513    2                           AND (SEND_INFO.ARRAY$ = ADDR(NIL)
      401    17514    2                                 OR REC_INFO.SPAN = SEND_INFO.SPAN))) THEN
      402    17515    3                   DO;

      403    17516    3                     CALL Z8E7$MOVE (ADDR(REC_INFO.SPAN_OCC),

  17516 22 001136   200146 630500                    EPPR0   REC_INFO+18,,AUTO
        22 001137   200230 450500                    STP0    DIM+1,,AUTO
        22 001140   200205 631500                    EPPR1   SEND_INFO+18,,AUTO
        22 001141   200231 451500                    STP1    DIM+2,,AUTO
        22 001142   200231 633500                    EPPR3   DIM+2,,AUTO
        22 001143   200233 453500                    STP3    DIM+4,,AUTO
        22 001144   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001145   200232 454500                    STP4    DIM+3,,AUTO
        22 001146   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001147   000020 631400 23                 EPPR1   16
        22 001150   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001151   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:63   

      404    17517    3                                     ADDR(SEND_INFO.SPAN_OCC));
      405    17518    3                     CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),

  17518 22 001152   200136 630500                    EPPR0   REC_INFO+10,,AUTO
        22 001153   200230 450500                    STP0    DIM+1,,AUTO
        22 001154   200175 631500                    EPPR1   SEND_INFO+10,,AUTO
        22 001155   200231 451500                    STP1    DIM+2,,AUTO
        22 001156   200231 633500                    EPPR3   DIM+2,,AUTO
        22 001157   200233 453500                    STP3    DIM+4,,AUTO
        22 001160   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001161   200232 454500                    STP4    DIM+3,,AUTO
        22 001162   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001163   000020 631400 23                 EPPR1   16
        22 001164   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001165   000000 011000                    NOP     0

      406    17519    3                                     ADDR(SEND_INFO.OCC));
      407    17520    3                   END;

  17520 22 001166   001175 710000 22                 TRA     s:17525

      408    17521    2                 ELSE
      409    17522    3                   DO;

      410    17523    3                     CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));

  17523 22 001167   200175 630500                    EPPR0   SEND_INFO+10,,AUTO
        22 001170   200236 450500                    STP0    DIM+7,,AUTO
        22 001171   200236 631500                    EPPR1   DIM+7,,AUTO
        22 001172   200225 451500                    STP1    @SUBSCRIPT$,,AUTO
        22 001173   000003 701000 22                 TSX1    SET_INDEX_FROM_OCC
        22 001174   000000 011000                    NOP     0

      411    17524    3                   END;

      412    17525    2   END MOVE_INDEX;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:64   

  17525 22 001175   200222 221300                    LDX1  ! SEND_INFO+31,,AUTO
        22 001176   000001 702211                    TSX2  ! 1,X1

      413    17526
      414    17527        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:65   
      415    17528        /* Main body of SET$INDEX */
      416    17529
      417    17530        /* Resolve sending reference */
      418    17531
      419    17532    1   SEND_INFO.INDEX_TYPE = FALSE;

  17532 22 001177   200220 450100                    STZ     SEND_INFO+29,,AUTO

      420    17533
      421    17534    2   DO CASE (SEND$ -> LX_ITEM.ID);

  17534 22 001200   200004 470500                    LDP0    @SEND$,,AUTO
        22 001201   000000 471500                    LDP1    0,,PR0
        22 001202   100000 220100                    LDX0    0,,PR1
        22 001203   000005 100003                    CMPX0   5,DU
        22 001204   001206 602010 22                 TNC     s:17534+6,X0
        22 001205   001301 710000 22                 TRA     s:17569
        22 001206   001213 710000 22                 TRA     s:17538
        22 001207   001301 710000 22                 TRA     s:17569
        22 001210   001241 710000 22                 TRA     s:17551
        22 001211   001301 710000 22                 TRA     s:17569
        22 001212   001217 710000 22                 TRA     s:17542

      422    17535
      423    17536    2     CASE(%LX_TERMINAL);

      424    17537
      425    17538    2       SEND_INFO.OCC = SEND$ -> LX_TERMINAL;

  17538 22 001213   000100 100500                    MLR     fill='000'O
        22 001214   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 001215   200175 000040                    ADSC9   SEND_INFO+10,,AUTO       cn=0,n=32
        22 001216   001301 710000 22                 TRA     s:17569

      426    17539
      427    17540    2     CASE(%LX_ETT_ITEM);

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:66   
      428    17541
      429    17542    2       IF SEND$ -> LX_ETT_ITEM.TYPE = %TYX

  17542 22 001217   100004 235100                    LDA     4,,PR1
        22 001220   000011 115007                    CMPA    9,DL
        22 001221   001224 600000 22                 TZE     s:17544
        22 001222   000012 115007                    CMPA    10,DL
        22 001223   001235 601000 22                 TNZ     s:17547

      430    17543    2            OR SEND$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      431    17544    2           CALL RESOLVE_INDEX_REFERENCES (SEND$,

  17544 22 001224   000006 236000 23                 LDQ     6
        22 001225   200225 756100                    STQ     @EXPR_ID+1,,AUTO
        22 001226   200163 631500                    EPPR1   SEND_INFO,,AUTO
        22 001227   200224 451500                    STP1    @SEND$+1,,AUTO
        22 001230   200004 236100                    LDQ     @SEND$,,AUTO
        22 001231   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 001232   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 001233   000000 011000                    NOP     0
        22 001234   001301 710000 22                 TRA     s:17569

      432    17545    2                                          SEND_INFO);
      433    17546    2       ELSE
      434    17547    2         SEND_INFO.OCC = SEND$ -> LX_ETT_ITEM;

  17547 22 001235   000100 100500                    MLR     fill='000'O
        22 001236   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 001237   200175 000040                    ADSC9   SEND_INFO+10,,AUTO       cn=0,n=32
        22 001240   001301 710000 22                 TRA     s:17569

      435    17548
      436    17549    2     CASE(%LX_LIST);

      437    17550
      438    17551    2       IF SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYX

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:67   
  17551 22 001241   100004 473500                    LDP3    4,,PR1
        22 001242   300004 235100                    LDA     4,,PR3
        22 001243   000011 115007                    CMPA    9,DL
        22 001244   001247 600000 22                 TZE     s:17553
        22 001245   000012 115007                    CMPA    10,DL
        22 001246   001260 601000 22                 TNZ     s:17558

      439    17552    2           OR SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      440    17553    2           CALL RESOLVE_INDEX_REFERENCES (SEND$ -> LX_LIST.HEAD$,

  17553 22 001247   300007 634500                    EPPR4   7,,PR3
        22 001250   200225 454500                    STP4    @EXPR_ID+1,,AUTO
        22 001251   200163 633500                    EPPR3   SEND_INFO,,AUTO
        22 001252   200224 453500                    STP3    @SEND$+1,,AUTO
        22 001253   100004 635500                    EPPR5   4,,PR1
        22 001254   200223 455500                    STP5    SEND_INFO+32,,AUTO
        22 001255   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 001256   000000 011000                    NOP     0
        22 001257   001301 710000 22                 TRA     s:17569

      441    17554    2                                          SEND_INFO,
      442    17555    2                                          SEND$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK);
      443    17556    2       ELSE
      444    17557    3         DO;

      445    17558    3           SEND_INFO.OCC = SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM;

  17558 22 001260   000100 100500                    MLR     fill='000'O
        22 001261   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
        22 001262   200175 000040                    ADSC9   SEND_INFO+10,,AUTO       cn=0,n=32

      446    17559    3           IF SEND$ -> LX_LIST.COUNT > 1 THEN

  17559 22 001263   000000 471500                    LDP1    0,,PR0
        22 001264   100002 235100                    LDA     2,,PR1
        22 001265   000001 115007                    CMPA    1,DL
        22 001266   001301 604400 22                 TMOZ    s:17569
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:68   

      447    17560    3             CALL Z8EY$SUBSCRIPT (SEND$ -> LX_LIST.TAIL$,

  17560 22 001267   200175 633500                    EPPR3   SEND_INFO+10,,AUTO
        22 001270   200230 453500                    STP3    DIM+1,,AUTO
        22 001271   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001272   200233 454500                    STP4    DIM+4,,AUTO
        22 001273   100001 635500                    EPPR5   1,,PR1
        22 001274   200232 455500                    STP5    DIM+3,,AUTO
        22 001275   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001276   000020 631400 23                 EPPR1   16
        22 001277   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 001300   000000 011000                    NOP     0

      448    17561    3                                  ADDR(SEND_INFO.OCC));
      449    17562    3         END;

      450    17563    2   END;  /* Case */

      451    17564
      452    17565
      453    17566        /* Resolve Receiving Items */
      454    17567
      455    17568
      456    17569    2   DO CASE (REC$ -> LX_ITEM.ID);

  17569 22 001301   200003 470500                    LDP0    @REC$,,AUTO
        22 001302   000000 471500                    LDP1    0,,PR0
        22 001303   100000 220100                    LDX0    0,,PR1
        22 001304   000005 100003                    CMPX0   5,DU
        22 001305   001307 602010 22                 TNC     s:17569+6,X0
        22 001306   002107 710000 22                 TRA     s:20099
        22 001307   002107 710000 22                 TRA     s:20099
        22 001310   002107 710000 22                 TRA     s:20099
        22 001311   001440 710000 22                 TRA     s:17665
        22 001312   002107 710000 22                 TRA     s:20099
        22 001313   001314 710000 22                 TRA     s:17573
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:69   

      457    17570
      458    17571    2     CASE(%LX_ETT_ITEM);

      459    17572
      460    17573    2       IF REC$ -> LX_ETT_ITEM.TYPE = %TYP THEN

  17573 22 001314   100004 235100                    LDA     4,,PR1
        22 001315   000022 115007                    CMPA    18,DL
        22 001316   001343 601000 22                 TNZ     s:17612

      461    17574    3         DO;

      462    17575                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
      463    17576                                    @ERROR# = %E$INVALID_SET,
      464    17577                                    @LINE = REC$ -> LX_ETT_ITEM.LINE,
      465    17578                                    @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);

  17588 22 001317   100000 236100                    LDQ     0,,PR1
        22 001320   400000 316007                    CANQ    -131072,DL
        22 001321   001340 601000 22                 TNZ     s:17609

  17590 22 001322   100006 633500                    EPPR3   6,,PR1
        22 001323   200232 453500                    STP3    DIM+3,,AUTO
        22 001324   100005 634500                    EPPR4   5,,PR1
        22 001325   200231 454500                    STP4    DIM+2,,AUTO
        22 001326   000010 236000 23                 LDQ     8
        22 001327   200230 756100                    STQ     DIM+1,,AUTO
        22 001330   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001331   000001 631400 23                 EPPR1   1
        22 001332   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001333   000000 011000                    NOP     0

  17599 22 001334   200003 470500                    LDP0    @REC$,,AUTO
        22 001335   000000 471500                    LDP1    0,,PR0
        22 001336   400000 236007                    LDQ     -131072,DL
        22 001337   100000 256100                    ORSQ    0,,PR1
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:70   

      466    17608
      467    17609    3           REC$ -> LX_ETT_ITEM.TYPE = %TYI;

  17609 22 001340   000000 471500                    LDP1    0,,PR0
        22 001341   000001 235007                    LDA     1,DL
        22 001342   100004 755100                    STA     4,,PR1

      468    17610    3         END;

      469    17611
      470    17612    2       REC_INFO.INDEX_TYPE = FALSE;

  17612 22 001343   200161 450100                    STZ     REC_INFO+29,,AUTO

      471    17613
      472    17614    2       IF REC$ -> LX_ETT_ITEM.TYPE = %TYX

  17614 22 001344   000000 471500                    LDP1    0,,PR0
        22 001345   100004 235100                    LDA     4,,PR1
        22 001346   000011 115007                    CMPA    9,DL
        22 001347   001352 600000 22                 TZE     s:17617
        22 001350   000012 115007                    CMPA    10,DL
        22 001351   001376 601000 22                 TNZ     s:17625

      473    17615    2            OR REC$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      474    17616    3         DO;

      475    17617    3           CALL RESOLVE_INDEX_REFERENCES (REC$,

  17617 22 001352   000006 236000 23                 LDQ     6
        22 001353   200225 756100                    STQ     @EXPR_ID+1,,AUTO
        22 001354   200124 631500                    EPPR1   REC_INFO,,AUTO
        22 001355   200224 451500                    STP1    @SEND$+1,,AUTO
        22 001356   200003 236100                    LDQ     @REC$,,AUTO
        22 001357   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 001360   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:71   
        22 001361   000000 011000                    NOP     0

      476    17618    3                               REC_INFO);
      477    17619    3           IF SEND_INFO.INDEX_TYPE THEN

  17619 22 001362   200220 234100                    SZN     SEND_INFO+29,,AUTO
        22 001363   001367 605000 22                 TPL     s:17622

      478    17620    3             CALL MOVE_INDEX;

  17620 22 001364   001066 701000 22                 TSX1    MOVE_INDEX
        22 001365   000000 011000                    NOP     0
        22 001366   001410 710000 22                 TRA     s:17627

      479    17621    3           ELSE
      480    17622    3             CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));

  17622 22 001367   200175 630500                    EPPR0   SEND_INFO+10,,AUTO
        22 001370   200237 450500                    STP0    DIM+8,,AUTO
        22 001371   200237 631500                    EPPR1   DIM+8,,AUTO
        22 001372   200225 451500                    STP1    @EXPR_ID+1,,AUTO
        22 001373   000003 701000 22                 TSX1    SET_INDEX_FROM_OCC
        22 001374   000000 011000                    NOP     0

      481    17623    3         END;

  17623 22 001375   001410 710000 22                 TRA     s:17627

      482    17624    2       ELSE
      483    17625    2         CALL Z8E7$MOVE (REC$,

  17625 22 001376   200175 633500                    EPPR3   SEND_INFO+10,,AUTO
        22 001377   200230 453500                    STP3    DIM+1,,AUTO
        22 001400   200230 631500                    EPPR1   DIM+1,,AUTO
        22 001401   200233 451500                    STP1    DIM+4,,AUTO
        22 001402   200003 236100                    LDQ     @REC$,,AUTO
        22 001403   200232 756100                    STQ     DIM+3,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:72   
        22 001404   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001405   000020 631400 23                 EPPR1   16
        22 001406   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001407   000000 011000                    NOP     0

      484    17626    2                         ADDR(SEND_INFO.OCC));
      485    17627    2         IF COMCOM.OB.FIPS.LEVEL > 0

  17627 22 001410   000036 720000 xsym               LXL0    COMCOM+30
        22 001411   002113 604400 22                 TMOZ    s:20103
        22 001412   200220 234100                    SZN     SEND_INFO+29,,AUTO
        22 001413   002113 604000 22                 TMI     s:20103

      486    17628    2         AND NOT SEND_INFO.INDEX_TYPE THEN
      487    17629                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
      488    17630                                    @ERROR# = %E$SET_NOT_ANSI,
      489    17631                                    @LINE = REC$ -> LX_ETT_ITEM.LINE,
      490    17632                                    @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);

  17642 22 001414   200003 470500                    LDP0    @REC$,,AUTO
        22 001415   000000 471500                    LDP1    0,,PR0
        22 001416   100000 236100                    LDQ     0,,PR1
        22 001417   400000 316007                    CANQ    -131072,DL
        22 001420   002113 601000 22                 TNZ     s:20103

  17644 22 001421   100006 633500                    EPPR3   6,,PR1
        22 001422   200232 453500                    STP3    DIM+3,,AUTO
        22 001423   100005 634500                    EPPR4   5,,PR1
        22 001424   200231 454500                    STP4    DIM+2,,AUTO
        22 001425   000024 236000 23                 LDQ     20
        22 001426   200230 756100                    STQ     DIM+1,,AUTO
        22 001427   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001430   000001 631400 23                 EPPR1   1
        22 001431   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001432   000000 011000                    NOP     0

  17653 22 001433   200003 470500                    LDP0    @REC$,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:73   
        22 001434   000000 471500                    LDP1    0,,PR0
        22 001435   400000 236007                    LDQ     -131072,DL
        22 001436   100000 256100                    ORSQ    0,,PR1

  17660 22 001437   002113 710000 22                 TRA     s:20103

      491    17662
      492    17663    2     CASE(%LX_LIST); /* Receiving */

      493    17664
      494    17665    2       VAL_REQUIRED = FALSE;

  17665 22 001440   200010 450100                    STZ     VAL_REQUIRED,,AUTO

      495    17666    2       VAL_TYA_REQUIRED = FALSE;

  17666 22 001441   200011 450100                    STZ     VAL_TYA_REQUIRED,,AUTO

      496    17667    2       VAL_SPAN_OCC_REQUIRED = FALSE;

  17667 22 001442   200012 450100                    STZ     VAL_SPAN_OCC_REQUIRED,,AUTO

      497    17668    2       VAL_REC_COUNT = 0 ;                                /*#28761*/

  17668 22 001443   200006 450100                    STZ     VAL_REC_COUNT,,AUTO

      498    17669
      499    17670    2       IF REC$ -> LX_LIST.COUNT > 1 THEN

  17670 22 001444   100002 235100                    LDA     2,,PR1
        22 001445   000001 115007                    CMPA    1,DL
        22 001446   001633 604400 22                 TMOZ    s:18847

      500    17671    3         DO;

      501    17672    3           IF  ADDR(SEND_INFO.OCC) ->  LX_ITEM.ID = %LX_ETT_ITEM

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:74   
  17672 22 001447   200175 221100                    LDX1    SEND_INFO+10,,AUTO
        22 001450   000004 101003                    CMPX1   4,DU
        22 001451   001515 601000 22                 TNZ     s:18063
        22 001452   200176 473500                    LDP3    SEND_INFO+11,,AUTO
        22 001453   300000 222100                    LDX2    0,,PR3
        22 001454   000015 102003                    CMPX2   13,DU
        22 001455   001515 600000 22                 TZE     s:18063

      502    17673    3              AND  ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      503    17674    4             DO;

      504    17675    4               CALL Z8AF$FORME (%EVAL,

  17675 22 001456   000006 236000 23                 LDQ     6
        22 001457   200230 756100                    STQ     DIM+1,,AUTO
        22 001460   200176 631500                    EPPR1   SEND_INFO+11,,AUTO
        22 001461   200235 451500                    STP1    DIM+6,,AUTO
        22 001462   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001463   200234 454500                    STP4    DIM+5,,AUTO
        22 001464   200176 635500                    EPPR5   SEND_INFO+11,,AUTO
        22 001465   200233 455500                    STP5    DIM+4,,AUTO
        22 001466   000026 236000 23                 LDQ     22
        22 001467   200232 756100                    STQ     DIM+3,,AUTO
        22 001470   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001471   000013 631400 23                 EPPR1   11
        22 001472   000000 701000 xent               TSX1    Z8AF$FORME
        22 001473   000000 011000                    NOP     0

      505    17676    4                                ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$,
      506    17677    4                                ADDR(NIL),
      507    17678    4                                ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$);
      508    17679
      509    17680                    %NEW_ILL (@ID = %VAL,
      510    17681                              @ETT$ = "ADDR(SEND_INFO.OCC) -> LX_ETT_ITEM.ETT$");

  17749 22 001474   000030 236000 23                 LDQ     24
        22 001475   200230 756100                    STQ     DIM+1,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:75   
        22 001476   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001477   200235 450500                    STP0    DIM+6,,AUTO
        22 001500   000031 236000 23                 LDQ     25
        22 001501   200234 756100                    STQ     DIM+5,,AUTO
        22 001502   000032 237000 23                 LDAQ    26
        22 001503   200232 757100                    STAQ    DIM+3,,AUTO
        22 001504   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001505   000013 631400 23                 EPPR1   11
        22 001506   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 001507   000000 011000                    NOP     0

  17750 22 001510   200176 236100                    LDQ     SEND_INFO+11,,AUTO
        22 001511   000000 470400 1                  LDP0    ILL$
        22 001512   000001 756100                    STQ     1,,PR0

      511    18060    4               VAL_REQUIRED = TRUE;

  18060 22 001513   400000 236003                    LDQ     -131072,DU
        22 001514   200010 756100                    STQ     VAL_REQUIRED,,AUTO

      512    18061    4             END;

      513    18062
      514    18063    3           IF SEND_INFO.INDEX_TYPE THEN

  18063 22 001515   200220 234100                    SZN     SEND_INFO+29,,AUTO
        22 001516   001633 605000 22                 TPL     s:18847

      515    18064    4             DO;

      516    18065    4               IF ADDR(SEND_INFO.TYA) -> LX_ITEM.ID = %LX_ETT_ITEM

  18065 22 001517   200165 220100                    LDX0    SEND_INFO+2,,AUTO
        22 001520   000004 100003                    CMPX0   4,DU
        22 001521   001565 601000 22                 TNZ     s:18455
        22 001522   200166 470500                    LDP0    SEND_INFO+3,,AUTO
        22 001523   000000 221100                    LDX1    0,,PR0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:76   
        22 001524   000015 101003                    CMPX1   13,DU
        22 001525   001565 600000 22                 TZE     s:18455

      517    18066    4                  AND ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      518    18067    5                 DO;

      519    18068    5                   CALL Z8AF$FORME (%EVAL,

  18068 22 001526   000006 236000 23                 LDQ     6
        22 001527   200230 756100                    STQ     DIM+1,,AUTO
        22 001530   200166 631500                    EPPR1   SEND_INFO+3,,AUTO
        22 001531   200235 451500                    STP1    DIM+6,,AUTO
        22 001532   200230 633500                    EPPR3   DIM+1,,AUTO
        22 001533   200234 453500                    STP3    DIM+5,,AUTO
        22 001534   200166 634500                    EPPR4   SEND_INFO+3,,AUTO
        22 001535   200233 454500                    STP4    DIM+4,,AUTO
        22 001536   000026 236000 23                 LDQ     22
        22 001537   200232 756100                    STQ     DIM+3,,AUTO
        22 001540   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001541   000013 631400 23                 EPPR1   11
        22 001542   000000 701000 xent               TSX1    Z8AF$FORME
        22 001543   000000 011000                    NOP     0

      520    18069    5                                    ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$,
      521    18070    5                                    ADDR(NIL),
      522    18071    5                                    ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$);
      523    18072                        %NEW_ILL (@ID = %VAL,
      524    18073                                  @ETT$ = "ADDR(SEND_INFO.TYA) -> LX_ETT_ITEM.ETT$");

  18141 22 001544   000030 236000 23                 LDQ     24
        22 001545   200230 756100                    STQ     DIM+1,,AUTO
        22 001546   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001547   200235 450500                    STP0    DIM+6,,AUTO
        22 001550   000031 236000 23                 LDQ     25
        22 001551   200234 756100                    STQ     DIM+5,,AUTO
        22 001552   000032 237000 23                 LDAQ    26
        22 001553   200232 757100                    STAQ    DIM+3,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:77   
        22 001554   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001555   000013 631400 23                 EPPR1   11
        22 001556   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 001557   000000 011000                    NOP     0

  18142 22 001560   200166 236100                    LDQ     SEND_INFO+3,,AUTO
        22 001561   000000 470400 1                  LDP0    ILL$
        22 001562   000001 756100                    STQ     1,,PR0

      525    18452    5                   VAL_TYA_REQUIRED = TRUE;

  18452 22 001563   400000 236003                    LDQ     -131072,DU
        22 001564   200011 756100                    STQ     VAL_TYA_REQUIRED,,AUTO

      526    18453    5                 END;

      527    18454
      528    18455    4               IF ADDR(SEND_INFO.SPAN_OCC) -> LX_ITEM.ID = %LX_ETT_ITEM

  18455 22 001565   200205 220100                    LDX0    SEND_INFO+18,,AUTO
        22 001566   000004 100003                    CMPX0   4,DU
        22 001567   001633 601000 22                 TNZ     s:18847
        22 001570   200206 470500                    LDP0    SEND_INFO+19,,AUTO
        22 001571   000000 221100                    LDX1    0,,PR0
        22 001572   000015 101003                    CMPX1   13,DU
        22 001573   001633 600000 22                 TZE     s:18847

      529    18456    4                  AND ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD
             18456                            THEN
      530    18457    5                 DO;

      531    18458    5                   CALL Z8AF$FORME (%EVAL,

  18458 22 001574   000006 236000 23                 LDQ     6
        22 001575   200230 756100                    STQ     DIM+1,,AUTO
        22 001576   200206 631500                    EPPR1   SEND_INFO+19,,AUTO
        22 001577   200235 451500                    STP1    DIM+6,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:78   
        22 001600   200230 633500                    EPPR3   DIM+1,,AUTO
        22 001601   200234 453500                    STP3    DIM+5,,AUTO
        22 001602   200206 634500                    EPPR4   SEND_INFO+19,,AUTO
        22 001603   200233 454500                    STP4    DIM+4,,AUTO
        22 001604   000026 236000 23                 LDQ     22
        22 001605   200232 756100                    STQ     DIM+3,,AUTO
        22 001606   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001607   000013 631400 23                 EPPR1   11
        22 001610   000000 701000 xent               TSX1    Z8AF$FORME
        22 001611   000000 011000                    NOP     0

      532    18459    5                                    ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$,
      533    18460    5                                    ADDR(NIL),
      534    18461    5                                    ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$);
      535    18462                        %NEW_ILL (@ID = %VAL,
      536    18463                                  @ETT$ = "ADDR(SEND_INFO.SPAN_OCC) -> LX_ETT_ITEM.ETT$");

  18531 22 001612   000030 236000 23                 LDQ     24
        22 001613   200230 756100                    STQ     DIM+1,,AUTO
        22 001614   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001615   200235 450500                    STP0    DIM+6,,AUTO
        22 001616   000031 236000 23                 LDQ     25
        22 001617   200234 756100                    STQ     DIM+5,,AUTO
        22 001620   000032 237000 23                 LDAQ    26
        22 001621   200232 757100                    STAQ    DIM+3,,AUTO
        22 001622   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001623   000013 631400 23                 EPPR1   11
        22 001624   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 001625   000000 011000                    NOP     0

  18532 22 001626   200206 236100                    LDQ     SEND_INFO+19,,AUTO
        22 001627   000000 470400 1                  LDP0    ILL$
        22 001630   000001 756100                    STQ     1,,PR0

      537    18842    5                   VAL_SPAN_OCC_REQUIRED = TRUE;

  18842 22 001631   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:79   
        22 001632   200012 756100                    STQ     VAL_SPAN_OCC_REQUIRED,,AUTO

      538    18843    5                 END;

      539    18844    4             END;

      540    18845    3         END;

      541    18846
      542    18847    2       R$ = REC$ -> LX_LIST.HEAD$;

  18847 22 001633   200003 470500                    LDP0    @REC$,,AUTO
        22 001634   000000 471500                    LDP1    0,,PR0
        22 001635   100004 236100                    LDQ     4,,PR1
        22 001636   200007 756100                    STQ     R$,,AUTO

      543    18848    3       DO WHILE R$ ~= ADDR(NIL);

  18848 22 001637   002015 710000 22                 TRA     s:18949

      544    18849
      545    18850    3       IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYP THEN

  18850 22 001640   200007 470500                    LDP0    R$,,AUTO
        22 001641   000004 471500                    LDP1    4,,PR0
        22 001642   100004 235100                    LDA     4,,PR1
        22 001643   000022 115007                    CMPA    18,DL
        22 001644   001671 601000 22                 TNZ     s:18889

      546    18851    4         DO;

      547    18852                %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
      548    18853                                    @ERROR# = %E$INVALID_SET,
      549    18854                                    @LINE = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      550    18855                                    @COLUMN = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  18865 22 001645   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:80   
        22 001646   400000 316007                    CANQ    -131072,DL
        22 001647   001666 601000 22                 TNZ     s:18886

  18867 22 001650   100006 633500                    EPPR3   6,,PR1
        22 001651   200232 453500                    STP3    DIM+3,,AUTO
        22 001652   100005 634500                    EPPR4   5,,PR1
        22 001653   200231 454500                    STP4    DIM+2,,AUTO
        22 001654   000010 236000 23                 LDQ     8
        22 001655   200230 756100                    STQ     DIM+1,,AUTO
        22 001656   200230 630500                    EPPR0   DIM+1,,AUTO
        22 001657   000001 631400 23                 EPPR1   1
        22 001660   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001661   000000 011000                    NOP     0

  18876 22 001662   200007 470500                    LDP0    R$,,AUTO
        22 001663   000004 471500                    LDP1    4,,PR0
        22 001664   400000 236007                    LDQ     -131072,DL
        22 001665   100000 256100                    ORSQ    0,,PR1

      551    18885
      552    18886    4           R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYI;

  18886 22 001666   000004 471500                    LDP1    4,,PR0
        22 001667   000001 235007                    LDA     1,DL
        22 001670   100004 755100                    STA     4,,PR1

      553    18887    4         END;

      554    18888
      555    18889    3         VAL_REC_COUNT = VAL_REC_COUNT + 1 ;              /*#28761*/

  18889 22 001671   200006 054100                    AOS     VAL_REC_COUNT,,AUTO

      556    18890    3         REC_INFO.INDEX_TYPE = FALSE;

  18890 22 001672   200161 450100                    STZ     REC_INFO+29,,AUTO

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:81   
      557    18891
      558    18892    3         IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYX

  18892 22 001673   000004 471500                    LDP1    4,,PR0
        22 001674   100004 235100                    LDA     4,,PR1
        22 001675   000011 115007                    CMPA    9,DL
        22 001676   001701 600000 22                 TZE     s:18895
        22 001677   000012 115007                    CMPA    10,DL
        22 001700   001726 601000 22                 TNZ     s:18905

      559    18893    3             OR R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYY THEN
      560    18894    4           DO;

      561    18895    4             CALL RESOLVE_INDEX_REFERENCES (R$ -> LX_LIST.HEAD$,

  18895 22 001701   100007 633500                    EPPR3   7,,PR1
        22 001702   200225 453500                    STP3    @EXPR_ID+1,,AUTO
        22 001703   200124 631500                    EPPR1   REC_INFO,,AUTO
        22 001704   200224 451500                    STP1    @SEND$+1,,AUTO
        22 001705   200007 236100                    LDQ     R$,,AUTO
        22 001706   000004 036003                    ADLQ    4,DU
        22 001707   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 001710   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 001711   000000 011000                    NOP     0

      562    18896    4                                            REC_INFO,
      563    18897    4                                            R$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK);
      564    18898    4             IF SEND_INFO.INDEX_TYPE THEN

  18898 22 001712   200220 234100                    SZN     SEND_INFO+29,,AUTO
        22 001713   001717 605000 22                 TPL     s:18901

      565    18899    4               CALL MOVE_INDEX;

  18899 22 001714   001066 701000 22                 TSX1    MOVE_INDEX
        22 001715   000000 011000                    NOP     0
        22 001716   002012 710000 22                 TRA     s:18948
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:82   

      566    18900    4             ELSE
      567    18901    4               CALL SET_INDEX_FROM_OCC (ADDR(SEND_INFO.OCC));

  18901 22 001717   200175 630500                    EPPR0   SEND_INFO+10,,AUTO
        22 001720   200240 450500                    STP0    DIM+9,,AUTO
        22 001721   200240 631500                    EPPR1   DIM+9,,AUTO
        22 001722   200225 451500                    STP1    @EXPR_ID+1,,AUTO
        22 001723   000003 701000 22                 TSX1    SET_INDEX_FROM_OCC
        22 001724   000000 011000                    NOP     0

      568    18902    4           END;

  18902 22 001725   002012 710000 22                 TRA     s:18948

      569    18903    3         ELSE
      570    18904    4           DO;

      571    18905    4             REC_INFO.OCC = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM;

  18905 22 001726   000100 100500                    MLR     fill='000'O
        22 001727   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 001730   200136 000040                    ADSC9   REC_INFO+10,,AUTO        cn=0,n=32

      572    18906    4             IF R$ -> LX_LIST.COUNT > 1 THEN

  18906 22 001731   000002 235100                    LDA     2,,PR0
        22 001732   000001 115007                    CMPA    1,DL
        22 001733   001747 604400 22                 TMOZ    s:18909

      573    18907    4               CALL Z8EY$SUBSCRIPT (R$ -> LX_LIST.TAIL$,

  18907 22 001734   200136 631500                    EPPR1   REC_INFO+10,,AUTO
        22 001735   200230 451500                    STP1    DIM+1,,AUTO
        22 001736   200230 633500                    EPPR3   DIM+1,,AUTO
        22 001737   200233 453500                    STP3    DIM+4,,AUTO
        22 001740   200007 236100                    LDQ     R$,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:83   
        22 001741   000001 036003                    ADLQ    1,DU
        22 001742   200232 756100                    STQ     DIM+3,,AUTO
        22 001743   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001744   000020 631400 23                 EPPR1   16
        22 001745   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        22 001746   000000 011000                    NOP     0

      574    18908    4                                    ADDR(REC_INFO.OCC));
      575    18909    4             CALL Z8E7$MOVE (ADDR(REC_INFO.OCC),

  18909 22 001747   200136 630500                    EPPR0   REC_INFO+10,,AUTO
        22 001750   200230 450500                    STP0    DIM+1,,AUTO
        22 001751   200175 631500                    EPPR1   SEND_INFO+10,,AUTO
        22 001752   200231 451500                    STP1    DIM+2,,AUTO
        22 001753   200231 633500                    EPPR3   DIM+2,,AUTO
        22 001754   200233 453500                    STP3    DIM+4,,AUTO
        22 001755   200230 634500                    EPPR4   DIM+1,,AUTO
        22 001756   200232 454500                    STP4    DIM+3,,AUTO
        22 001757   200232 630500                    EPPR0   DIM+3,,AUTO
        22 001760   000020 631400 23                 EPPR1   16
        22 001761   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001762   000000 011000                    NOP     0

      576    18910    4                             ADDR(SEND_INFO.OCC));
      577    18911    4             IF COMCOM.OB.FIPS.LEVEL > 0

  18911 22 001763   000036 720000 xsym               LXL0    COMCOM+30
        22 001764   002012 604400 22                 TMOZ    s:18948
        22 001765   200220 234100                    SZN     SEND_INFO+29,,AUTO
        22 001766   002012 604000 22                 TMI     s:18948

      578    18912    4             AND NOT SEND_INFO.INDEX_TYPE THEN
      579    18913                    %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
      580    18914                                        @ERROR# = %E$SET_NOT_ANSI,
      581    18915                                        @LINE = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      582    18916                                       @COLUMN = R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN)
             18916                                            ;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:84   

  18926 22 001767   200007 470500                    LDP0    R$,,AUTO
        22 001770   000004 471500                    LDP1    4,,PR0
        22 001771   100000 236100                    LDQ     0,,PR1
        22 001772   400000 316007                    CANQ    -131072,DL
        22 001773   002012 601000 22                 TNZ     s:18948

  18928 22 001774   100006 633500                    EPPR3   6,,PR1
        22 001775   200232 453500                    STP3    DIM+3,,AUTO
        22 001776   100005 634500                    EPPR4   5,,PR1
        22 001777   200231 454500                    STP4    DIM+2,,AUTO
        22 002000   000024 236000 23                 LDQ     20
        22 002001   200230 756100                    STQ     DIM+1,,AUTO
        22 002002   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002003   000001 631400 23                 EPPR1   1
        22 002004   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002005   000000 011000                    NOP     0

  18937 22 002006   200007 470500                    LDP0    R$,,AUTO
        22 002007   000004 471500                    LDP1    4,,PR0
        22 002010   400000 236007                    LDQ     -131072,DL
        22 002011   100000 256100                    ORSQ    0,,PR1

      583    18946    4           END;

      584    18947
      585    18948    3         R$ = R$ -> LX_LIST.LINK;

  18948 22 002012   200007 470500                    LDP0    R$,,AUTO
        22 002013   000007 236100                    LDQ     7,,PR0
        22 002014   200007 756100                    STQ     R$,,AUTO

      586    18949    3       END;  /* Do While */

  18949 22 002015   000006 116000 23                 CMPQ    6
        22 002016   001640 601000 22                 TNZ     s:18850

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:85   
      587    18950                                                               /*#28761*/
      588    18951    2       IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN

  18951 22 002017   200006 236100                    LDQ     VAL_REC_COUNT,,AUTO
        22 002020   000360 116000 xsym               CMPQ    COMCOM+240
        22 002021   002023 604400 22                 TMOZ    s:18954

      589    18952    2         COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;

  18952 22 002022   000360 756000 xsym               STQ     COMCOM+240

      590    18953
      591    18954    2       IF VAL_SPAN_OCC_REQUIRED THEN

  18954 22 002023   200012 234100                    SZN     VAL_SPAN_OCC_REQUIRED,,AUTO
        22 002024   002044 605000 22                 TPL     s:19335

      592    18955              %NEW_ILL(@ID = %VAL_END);

  19026 22 002025   000030 236000 23                 LDQ     24
        22 002026   200230 756100                    STQ     DIM+1,,AUTO
        22 002027   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002030   200235 450500                    STP0    DIM+6,,AUTO
        22 002031   000031 236000 23                 LDQ     25
        22 002032   200234 756100                    STQ     DIM+5,,AUTO
        22 002033   000036 237000 23                 LDAQ    30
        22 002034   200232 757100                    STAQ    DIM+3,,AUTO
        22 002035   200232 630500                    EPPR0   DIM+3,,AUTO
        22 002036   000013 631400 23                 EPPR1   11
        22 002037   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 002040   000000 011000                    NOP     0

  19027 22 002041   000006 236000 23                 LDQ     6
        22 002042   000000 470400 1                  LDP0    ILL$
        22 002043   000001 756100                    STQ     1,,PR0

      593    19334
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:86   
      594    19335    2       IF VAL_TYA_REQUIRED THEN

  19335 22 002044   200011 234100                    SZN     VAL_TYA_REQUIRED,,AUTO
        22 002045   002065 605000 22                 TPL     s:19716

      595    19336              %NEW_ILL (@ID = %VAL_END);

  19407 22 002046   000030 236000 23                 LDQ     24
        22 002047   200230 756100                    STQ     DIM+1,,AUTO
        22 002050   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002051   200235 450500                    STP0    DIM+6,,AUTO
        22 002052   000031 236000 23                 LDQ     25
        22 002053   200234 756100                    STQ     DIM+5,,AUTO
        22 002054   000036 237000 23                 LDAQ    30
        22 002055   200232 757100                    STAQ    DIM+3,,AUTO
        22 002056   200232 630500                    EPPR0   DIM+3,,AUTO
        22 002057   000013 631400 23                 EPPR1   11
        22 002060   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 002061   000000 011000                    NOP     0

  19408 22 002062   000006 236000 23                 LDQ     6
        22 002063   000000 470400 1                  LDP0    ILL$
        22 002064   000001 756100                    STQ     1,,PR0

      596    19715
      597    19716    2       IF VAL_REQUIRED THEN

  19716 22 002065   200010 234100                    SZN     VAL_REQUIRED,,AUTO
        22 002066   002113 605000 22                 TPL     s:20103

      598    19717              %NEW_ILL (@ID = %VAL_END);

  19788 22 002067   000030 236000 23                 LDQ     24
        22 002070   200230 756100                    STQ     DIM+1,,AUTO
        22 002071   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002072   200235 450500                    STP0    DIM+6,,AUTO
        22 002073   000031 236000 23                 LDQ     25
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:87   
        22 002074   200234 756100                    STQ     DIM+5,,AUTO
        22 002075   000036 237000 23                 LDAQ    30
        22 002076   200232 757100                    STAQ    DIM+3,,AUTO
        22 002077   200232 630500                    EPPR0   DIM+3,,AUTO
        22 002100   000013 631400 23                 EPPR1   11
        22 002101   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 002102   000000 011000                    NOP     0

  19789 22 002103   000006 236000 23                 LDQ     6
        22 002104   000000 470400 1                  LDP0    ILL$
        22 002105   000001 756100                    STQ     1,,PR0

  20066 22 002106   002113 710000 22                 TRA     s:20103

      599    20096
      600    20097    2     CASE (ELSE);

      601    20098
      602    20099    2       CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  20099 22 002107   000005 630400 23                 EPPR0   5
        22 002110   000000 631400 23                 EPPR1   0
        22 002111   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002112   000000 011000                    NOP     0

      603    20100    2   END;

      604    20101
      605    20102
      606    20103    1   RETURN;

  20103 22 002113   000000 702200 xent               TSX2  ! X66_ARET

      607    20104        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:88   
      608    20105    1   Z8EX$SET_UP_BY : ENTRY (REC$, SEND$);

  20105 22 002114   000000 700200 xent  Z8EX$SET_UP* TSX0  ! X66_AUTO_2
        22 002115   000242 000002                    ZERO    162,2

      609    20106
      610    20107
      611    20108    1     EXPR_ID = %OP_PLUS;

  20108 22 002116   000020 235007                    LDA     16,DL
        22 002117   200005 755100                    STA     EXPR_ID,,AUTO

      612    20109    1     GOTO SET_UP_DOWN;

  20109 22 002120   002125 710000 22                 TRA     SET_UP_DOWN

      613    20110
      614    20111
      615    20112    1   Z8EX$SET_DOWN_BY : ENTRY (REC$, SEND$);

  20112 22 002121   000000 700200 xent  Z8EX$SET_DO* TSX0  ! X66_AUTO_2
        22 002122   000242 000002                    ZERO    162,2

      616    20113
      617    20114
      618    20115    1     EXPR_ID = %OP_BINARY_MINUS;

  20115 22 002123   000021 235007                    LDA     17,DL
        22 002124   200005 755100                    STA     EXPR_ID,,AUTO

      619    20116
      620    20117
      621    20118    1   SET_UP_DOWN:
      622    20119
      623    20120    1     IF REC$ -> LX_ETT_ITEM.TYPE ~= %TYX

  20120 22 002125   200003 470500       SET_UP_DOWN  LDP0    @REC$,,AUTO
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:89   
        22 002126   000000 471500                    LDP1    0,,PR0
        22 002127   100004 235100                    LDA     4,,PR1
        22 002130   000011 115007                    CMPA    9,DL
        22 002131   002147 600000 22                 TZE     s:20127
        22 002132   000012 115007                    CMPA    10,DL
        22 002133   002147 600000 22                 TZE     s:20127

      624    20121    1          AND REC$ -> LX_ETT_ITEM.TYPE ~= %TYY THEN
      625    20122    1       CALL Z8AE$ERROR (%E$INVALID_SET,

  20122 22 002134   100006 633500                    EPPR3   6,,PR1
        22 002135   200232 453500                    STP3    DIM+3,,AUTO
        22 002136   100005 634500                    EPPR4   5,,PR1
        22 002137   200231 454500                    STP4    DIM+2,,AUTO
        22 002140   000010 236000 23                 LDQ     8
        22 002141   200230 756100                    STQ     DIM+1,,AUTO
        22 002142   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002143   000001 631400 23                 EPPR1   1
        22 002144   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002145   000000 011000                    NOP     0
        22 002146   002205 710000 22                 TRA     s:20141

      626    20123    1                        REC$ -> LX_ETT_ITEM.LINE,
      627    20124    1                        REC$ -> LX_ETT_ITEM.COLUMN);
      628    20125    1     ELSE
      629    20126    2       DO;

      630    20127    2         CALL RESOLVE_INDEX_REFERENCES (REC$,

  20127 22 002147   000006 236000 23                 LDQ     6
        22 002150   200225 756100                    STQ     @EXPR_ID+1,,AUTO
        22 002151   200124 631500                    EPPR1   REC_INFO,,AUTO
        22 002152   200224 451500                    STP1    @SEND$+1,,AUTO
        22 002153   200003 236100                    LDQ     @REC$,,AUTO
        22 002154   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 002155   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 002156   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:90   

      631    20128    2                                       REC_INFO);
      632    20129
      633    20130    2         IF REC_INFO.ARRAY$ = ADDR(NIL) THEN

  20130 22 002157   200125 236100                    LDQ     REC_INFO+1,,AUTO
        22 002160   000006 116000 23                 CMPQ    6
        22 002161   002177 601000 22                 TNZ     s:20136

      634    20131    2           CALL Z8AE$ERROR (%E$INVALID_SET,

  20131 22 002162   200003 470500                    LDP0    @REC$,,AUTO
        22 002163   000000 471500                    LDP1    0,,PR0
        22 002164   100006 633500                    EPPR3   6,,PR1
        22 002165   200232 453500                    STP3    DIM+3,,AUTO
        22 002166   100005 634500                    EPPR4   5,,PR1
        22 002167   200231 454500                    STP4    DIM+2,,AUTO
        22 002170   000010 236000 23                 LDQ     8
        22 002171   200230 756100                    STQ     DIM+1,,AUTO
        22 002172   200230 630500                    EPPR0   DIM+1,,AUTO
        22 002173   000001 631400 23                 EPPR1   1
        22 002174   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002175   000000 011000                    NOP     0
        22 002176   002205 710000 22                 TRA     s:20141

      635    20132    2                            REC$ -> LX_ETT_ITEM.LINE,
      636    20133    2                            REC$ -> LX_ETT_ITEM.COLUMN);
      637    20134    2         ELSE
      638    20135    3           DO;

      639    20136    3             CALL SET_UP_DOWN (SEND$,

  20136 22 002177   200005 630500                    EPPR0   EXPR_ID,,AUTO
        22 002200   200224 450500                    STP0    @SEND$+1,,AUTO
        22 002201   200004 236100                    LDQ     @SEND$,,AUTO
        22 002202   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 002203   000627 701000 22                 TSX1    SET_UP_DOWN
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:91   
        22 002204   000000 011000                    NOP     0

      640    20137    3                               EXPR_ID);
      641    20138    3           END;

      642    20139    2       END;

      643    20140
      644    20141    1   RETURN;

  20141 22 002205   000000 702200 xent               TSX2  ! X66_ARET

      645    20142        %EJECT;
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:92   
      646    20143    1   Z8EX$SET_UP_FOR_SEARCH : ENTRY (REC$, SEND$);

  20143 22 002206   000000 700200 xent  Z8EX$SET_UP* TSX0  ! X66_AUTO_2
        22 002207   000242 000002                    ZERO    162,2

      647    20144
      648    20145        /* This is a special entry for the SEARCH statement.
      649    20146           REC$ points to VARYING identifier which is to be set
      650    20147           up by the same amount as a SET_UP_BY 1 would use
      651    20148           for SEND$
      652    20149        */
      653    20150
      654    20151    1     CALL RESOLVE_INDEX_REFERENCES (REC$,

  20151 22 002210   000006 236000 23                 LDQ     6
        22 002211   200225 756100                    STQ     @EXPR_ID+1,,AUTO
        22 002212   200124 630500                    EPPR0   REC_INFO,,AUTO
        22 002213   200224 450500                    STP0    @SEND$+1,,AUTO
        22 002214   200003 236100                    LDQ     @REC$,,AUTO
        22 002215   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 002216   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 002217   000000 011000                    NOP     0

      655    20152    1                                    REC_INFO);
      656    20153
      657    20154    1     CALL RESOLVE_INDEX_REFERENCES (SEND$,

  20154 22 002220   000006 236000 23                 LDQ     6
        22 002221   200225 756100                    STQ     @EXPR_ID+1,,AUTO
        22 002222   200163 630500                    EPPR0   SEND_INFO,,AUTO
        22 002223   200224 450500                    STP0    @SEND$+1,,AUTO
        22 002224   200004 236100                    LDQ     @SEND$,,AUTO
        22 002225   200223 756100                    STQ     SEND_INFO+32,,AUTO
        22 002226   000314 701000 22                 TSX1    RESOLVE_INDEX_REFERENCES
        22 002227   000000 011000                    NOP     0

      658    20155    1                                    SEND_INFO);
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:93   
      659    20156
      660    20157    1     IF REC_INFO.ARRAY$ = ADDR(NIL) THEN

  20157 22 002230   200125 236100                    LDQ     REC_INFO+1,,AUTO
        22 002231   000006 116000 23                 CMPQ    6
        22 002232   002237 601000 22                 TNZ     s:20163

      661    20158    2       DO;

      662    20159    2         REC_INFO.ARRAY$ = SEND_INFO.ARRAY$;

  20159 22 002233   200164 236100                    LDQ     SEND_INFO+1,,AUTO
        22 002234   200125 756100                    STQ     REC_INFO+1,,AUTO

      663    20160    2         REC_INFO.SPAN = SEND_INFO.SPAN;

  20160 22 002235   200221 235100                    LDA     SEND_INFO+30,,AUTO
        22 002236   200162 755100                    STA     REC_INFO+30,,AUTO

      664    20161    2       END;

      665    20162
      666    20163    1     CALL Z8AC$LX_ETT_ITEM_TYI_CONST (1,

  20163 22 002237   200114 630500                    EPPR0   ONE,,AUTO
        22 002240   200230 450500                    STP0    DIM+1,,AUTO
        22 002241   200230 631500                    EPPR1   DIM+1,,AUTO
        22 002242   200233 451500                    STP1    DIM+4,,AUTO
        22 002243   000012 236000 23                 LDQ     10
        22 002244   200232 756100                    STQ     DIM+3,,AUTO
        22 002245   200232 630500                    EPPR0   DIM+3,,AUTO
        22 002246   000020 631400 23                 EPPR1   16
        22 002247   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 002250   000000 011000                    NOP     0

      667    20164    1                                      ADDR(ONE));
      668    20165
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:94   
      669    20166    1     CALL SET_UP_DOWN (ADDR(ONE),

  20166 22 002251   200114 630500                    EPPR0   ONE,,AUTO
        22 002252   200241 450500                    STP0    DIM+10,,AUTO
        22 002253   000040 236000 23                 LDQ     32
        22 002254   200224 756100                    STQ     @SEND$+1,,AUTO
        22 002255   200241 631500                    EPPR1   DIM+10,,AUTO
        22 002256   200223 451500                    STP1    SEND_INFO+32,,AUTO
        22 002257   000627 701000 22                 TSX1    SET_UP_DOWN
        22 002260   000000 011000                    NOP     0

      670    20167    1                       %OP_PLUS);
      671    20168
      672    20169    1     RETURN;

  20169 22 002261   000000 702200 xent               TSX2  ! X66_ARET
      673    20170
      674    20171    1   END Z8EX$SET_INDEX;
      675    20172        %EOD;

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:95   
--  Include file information  --

   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EX$SET_INDEX.
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:96   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 002 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 003 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 004 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:97   
  ****  Section 005 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 006 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 007 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 008 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 009 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 010 LblCom ST_

PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:98   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 011 LblCom SRCH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 SRCH

  ****  Section 012 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 013 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 014 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 015 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:99   

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 016 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 017 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 018 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 019 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 020 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:100  

  ****  Section 021 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   224-0-0/w PTR         r     1 @EXPR_ID                 223-0-0/w PTR         r     1 @INDEX$
   224-0-0/w PTR         r     1 @INDEX_INFO              225-0-0/w PTR         r     1 @OCC$
     3-0-0/w PTR         r     1 @REC$                      4-0-0/w PTR         r     1 @SEND$
   223-0-0/w PTR         r     1 @SEND$                   225-0-0/w PTR         r     1 @SUBSCRIPT$
    34-0-0/d STRC(288)   r     1 ADD_NODE                 226-0-0/w CHAR(8)     r     1 CHAR_LDAQSTAQ
   227-0-0/w SBIN        r     1 DIM                      226-0-0/w PTR         r     1 DIMS$
   104-0-0/d STRC(288)   r     1 ETT_NODE                   5-0-0/w UBIN        r     1 EXPR_ID
    *0-0-0/w SBIN        r     1 EXPR_ID                   *0-0-0/w PTR         r     1 INDEX$
    *0-0-0/w STRC(1116)  r     1 INDEX_INFO               226-0-0/w STRC(72)    r     1 LDAQSTAQ
    74-0-0/d STRC(288)   r     1 MULT_NODE                 *0-0-0/w PTR         r     1 OCC$
    44-0-0/d STRC(288)         1 OCC_NODE                 114-0-0/d STRC(288)   r     1 ONE
     7-0-0/w PTR         r     1 R$                        *0-0-0/w PTR         r     1 REC$
   124-0-0/w STRC(1116)  r     1 REC_INFO                  14-0-0/d STRC(288)         1 REC_NODE
    64-0-0/d STRC(288)   r     1 REC_SPAN_NODE             *0-0-0/w PTR         r     1 SEND$
    *0-0-0/w PTR         r     1 SEND$                    163-0-0/w STRC(1116)  r     1 SEND_INFO
    24-0-0/d STRC(288)         1 SEND_NODE                 54-0-0/d STRC(288)         1 SPAN_OCC_NODE
    *0-0-0/w PTR         r     1 SUBSCRIPT$                 6-0-0/w SBIN        r     1 VAL_REC_COUNT
    10-0-0/b BIT         r     1 VAL_REQUIRED
    12-0-0/b BIT         r     1 VAL_SPAN_OCC_REQUIRED
    11-0-0/b BIT         r     1 VAL_TYA_REQUIRED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:101  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)  r     1 DIMS
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:102  
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)         1 ILS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(144)         1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)         1 PREOFF                     0-0-0/w STRC(108)         1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)         1 PROC_SUPP
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(216)   r     1 QLT                        0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
PL6.E3A0      #001=Z8EX$SET_INDEX File=Z8EX.:Z8A6TSI                             SAT 08/09/97 12:54 Page:103  
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)   r     1 VAL
     0-0-0/w STRC(108)   r     1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EX$SET_INDEX requires 1202 words for executable code.
   Procedure Z8EX$SET_INDEX requires 162 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:104  
      676        1        /*T***********************************************************/
      677        2        /*T*                                                         */
      678        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      679        4        /*T*                                                         */
      680        5        /*T***********************************************************/
      681        6        /*------------------*/
      682        7          Z8EX$SET_STATEMENT : PROC ( KEY_WORD$,
      683        8        /*------------------*/        RECEIVE$,
      684        9                                      SEND$,
      685       10                                      SET_TYPE);
      686       11
      687       12        /*I*
      688       13                 NAME: SET_STATEMENT
      689       14
      690       15          DESCRIPTION: The particular type of SET is isolated.  The routines
      691       16                               Z8EX$SET_INDEX
      692       17                               Z8EX$SET_UP_BY
      693       18                               Z8EX$SET_DOWN_BY
      694       19                       are used to set INDEX variables.  Setting switches is
      695       20                       handled by emitting %ON_SWITCH and %OFF_SWITCH ILL
      696       21                       items.  Z8E7$RESTRICTED_MOVE is used to set <conditions>
      697       22                       to true, because these moves do not conform to the
      698       23                       standard move rules.
      699       24        */
      700       25
      701       26        %EQU PHASE = 1;
      702       27
      703       28        %INCLUDE Z8A_DEFC;
      704       96        %INCLUDE Z8A_SUPP_MAC ;
      705     2496        %INCLUDE Z8A_COMCOM ;
      706     3146        %INCLUDE Z8E_WINDOW ;
      707     5216        %INCLUDE Z8E_STACKS ;
      708     7482        %INCLUDE Z8E_O1COM;
      709     8243        %INCLUDE Z8E_MACROS;
      710     8918        %INCLUDE Z8E_ILS_LIST;
      711     9002        %INCLUDE Z8A_ERR_NUMS ;
      712     9766        %INCLUDE Z8A_MKCN;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:105  
      713     9783        %INCLUDE Z8E_DML;
      714     9903        %INCLUDE Z8A_DNT ;
      715    10124        %INCLUDE Z8A_ST;
      716    13783        %INCLUDE Z8A_TYPES;
      717    13957        %INCLUDE Z8A_ETT ;
      718    14258        %INCLUDE Z8A_ILL ;
      719    14951        %INCLUDE Z8E_HEAP;
      720    15007        %INCLUDE Z8E_ABSSYN;
      721    15213        %INCLUDE Z8E_STATEMNT;
      722    15282
      723    15283    1   DCL Z8EK$BRANCH_FALSE             ENTRY(2);
      724    15284    1   DCL Z8EK$BRANCH                   ENTRY(1);
      725    15285    1   DCL Z8ED$DISPOSE_ABSSYN_TREE      ENTRY(1);
      726    15286    1   DCL Z8AF$FORME                    ENTRY(4);
      727    15287    1   DCL Z8AC$MAKE_CONST               ENTRY(1);
      728    15288    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST    ENTRY(2);
      729    15289    1   DCL Z8E7$MOVE                     ENTRY(2);
      730    15290    1   DCL Z8E7$RESTRICTED_MOVE          ENTRY(2);
      731    15291    1   DCL Z8E7$MOVE_STATEMENT           ENTRY(4);
      732    15292    1   DCL Z8E7$POINTER_MOVE             ENTRY(2);
      733    15293    1   DCL Z8EU$CREATE_IDENTIFIER_FROM_ST ENTRY(4);
      734    15294    1   DCL Z8AE$ERROR                    ENTRY(12);
      735    15295    1   DCL Z8EX$SET_INDEX                ENTRY(2);
      736    15296    1   DCL Z8EX$SET_UP_BY                ENTRY(2);
      737    15297    1   DCL Z8EX$SET_DOWN_BY              ENTRY(2);
      738    15298    1   DCL Z8EY$SUBSCRIPT                ENTRY(2);
      739    15299    1   DCL Z8AT$CREATE_TEMPORARY         ENTRY(2);
      740    15300    1   DCL Z8CO$INTEGER_CHECK            ENTRY(1) ALTRET;
      741    15301
      742    15302    1     DCL VAL_REC_COUNT SBIN WORD;
      743    15303
      744    15304    1     DCL KEY_WORD$ PTR;
      745    15305    1     DCL RECEIVE$ PTR;
      746    15306    1     DCL SEND$ PTR;
      747    15307    1     DCL SET_TYPE SBIN;
      748    15308
      749    15309        /*-------------*/
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:106  
      750    15310    1     SET_STATEMENT : PROC;
      751    15311        /*-------------*/
      752    15312        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:107  
      753    15313    2     DCL P$   PTR;
      754    15314    2     DCL P1$  PTR;
      755    15315    2     DCL P2$  PTR;
      756    15316    2     DCL P3$  PTR;
      757    15317    2     DCL P4$  PTR;
      758    15318    2     DCL T$ PTR;
      759    15319    2     DCL ORIG_LINE# SBIN;
      760    15320    2     DCL ORIG_COLUMN# SBIN;
      761    15321    2     DCL REC$ PTR;
      762    15322    2     DCL R$   PTR ;
      763    15323    2     DCL ST$ PTR;
      764    15324    2     DCL ST2$ PTR;
      765    15325    2     DCL CONST$ PTR;
      766    15326    2     DCL END_LABEL$ PTR;
      767    15327    2     DCL OFF_SW_LABEL$ PTR;
      768    15328    2     DCL SW# SBIN WORD;
      769    15329    2     DCL SW2# SBIN WORD;
      770    15330    2     DCL VAL_REQUIRED BOOLEAN;
      771    15331
      772    15332          %DCL_AUTO_LX_ITEM(@NAME = SW_VALUE);
      773    15336          %DCL_AUTO_LX_ITEM(@NAME = SW_ON_COND);
      774    15340          %DCL_AUTO_LX_ITEM(@NAME = ASS_VAR);
      775    15344
      776    15345          /* Internal Procedures */
      777    15346
      778    15347    2     SET_UP_DOWN: PROC (RECEIVE$, SEND$, SET_TYPE) ;
      779    15348
      780    15349    3     DCL  RECEIVE$    PTR ; /* LX_LIST                    */
      781    15350    3     DCL  SEND$       PTR ; /* LX_ETT_ITEM or whatever    */
      782    15351    3     DCL  SET_TYPE    SBIN; /* %SET_UP_BY or %SET_DOWN_BY */
      783    15352    3     DCL  REC$        PTR ;
      784    15353
      785    15354    3       CALL Z8CO$INTEGER_CHECK(SEND$);
      786    15355
      787    15356    3       IF NOT SEND$ -> LX_ITEM.B.ERROR     AND
      788    15357    3          NOT RECEIVE$ -> LX_ITEM.B.ERROR     THEN
      789    15358    4         DO;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:108  
      790    15359    4           IF SEND$ -> LX_ITEM.ID = %LX_ETT_ITEM
      791    15360    4                AND SEND$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      792    15361    5             DO;
      793    15362    5               CALL Z8AF$FORME (%EVAL,
      794    15363    5                                SEND$ -> LX_ETT_ITEM.ETT$,
      795    15364    5                                ADDR(NIL),
      796    15365    5                                SEND$ -> LX_ETT_ITEM.ETT$);
      797    15366                    %NEW_ILL  (@ID = %VAL,
      798    15367                               @ETT$ = "SEND$ -> LX_ETT_ITEM.ETT$ ");
      799    15746    5               VAL_REQUIRED = TRUE;
      800    15747    5               VAL_REC_COUNT = 0 ;                             /*#28761*/
      801    15748    5             END;
      802    15749    4           ELSE
      803    15750    4             VAL_REQUIRED = FALSE;
      804    15751
      805    15752    4           REC$ = RECEIVE$ ->  LX_LIST.HEAD$;
      806    15753    5           DO WHILE REC$ ~= ADDR(NIL) ;
      807    15754
      808    15755    5             IF REC$ -> LX_LIST.COUNT > 1 THEN
      809    15756    5               CALL Z8EY$SUBSCRIPT (REC$ -> LX_LIST.TAIL$,
      810    15757    5                                    REC$ -> LX_LIST.HEAD$);
      811    15758
      812    15759    5             IF SET_TYPE = %SET_UP_BY THEN
      813    15760    5               CALL Z8EX$SET_UP_BY(REC$ -> LX_LIST.HEAD$,
      814    15761    5                                   SEND$);
      815    15762    5             ELSE
      816    15763    5               CALL Z8EX$SET_DOWN_BY (REC$ -> LX_LIST.HEAD$,
      817    15764    5                                      SEND$);
      818    15765    5             REC$ = REC$ -> LX_LIST.LINK;
      819    15766    5             VAL_REC_COUNT = VAL_REC_COUNT + 1 ;               /*#28761*/
      820    15767    5           END; /* Do while REC$ non-nil */
      821    15768
      822    15769    5           IF VAL_REQUIRED THEN DO ;                           /*#28761*/
      823    15770                  %NEW_ILL (@ID = %VAL_END);
      824    16149    5             IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN /*#28761*/
      825    16150    5               COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;
      826    16151    5           END ;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:109  
      827    16152    4         END; /* Sending field not in error */
      828    16153
      829    16154    3     END SET_UP_DOWN ;
      830    16155
      831    16156    2     SET_TO: PROC (RECEIVE$, SEND$) ;
      832    16157
      833    16158    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      834    16159    3     DCL  SEND$     PTR ; /* mnemonic switch, id, or literal */
      835    16160    3     DCL  REC$      PTR ;
      836    16161    3     DCL  R$        PTR ;
      837    16162
      838    16163    4       DO CASE (SEND$ -> LX_ITEM.ID);
      839    16164
      840    16165    4         CASE(%LX_LIST);
      841    16166
      842    16167    4           IF SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYP THEN
      843    16168    5             DO;
      844    16169    5               CALL PROCESS_POINTER_SET (RECEIVE$, SEND$);
      845    16170
      846    16171    5               RETURN;
      847    16172    5             END;
      848    16173
      849    16174                %FISH(TRIAD = SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      850    16175                      RTN = ST$);
      851    16183
      852    16184    4           IF ST$ -> ST.ID ~= %SWITCH THEN
      853    16185    5             DO;  /* Rec should be INDEX */
      854    16186    5               CALL Z8EX$SET_INDEX (RECEIVE$,
      855    16187    5                                    SEND$);
      856    16188    5             END;
      857    16189    4           ELSE
      858    16190    5             DO;
      859    16191    5               REC$ = RECEIVE$ -> LX_LIST.HEAD$;
      860    16192    6               DO WHILE REC$ ~= ADDR(NIL);
      861    16193    6                 IF REC$ -> LX_ITEM.ID = %LX_LIST THEN
      862    16194    6                   R$ = REC$ -> LX_LIST.HEAD$ ;
      863    16195    6                 ELSE
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:110  
      864    16196    6                   R$ = REC$ ;
      865    16197
      866    16198    6                 IF R$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      867    16199    6                   ST2$ = ADDR(NIL) ;
      868    16200    6                 ELSE
      869    16201                        %FISH (TRIAD = R$ -> LX_ETT_ITEM.ETT$,
      870    16202                               RTN = ST2$);
      871    16210
      872    16211    6                 IF ST2$ = ADDR(NIL)
      873    16212    6                 OR ST2$ -> ST.ID ~= %SWITCH THEN
      874    16213    7                   DO;
      875    16214                           %CONDITIONAL_ERROR (@LX_ITEM$ = R$,
      876    16215                                  @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
      877    16216                                  @LINE = R$ -> LX_ETT_ITEM.LINE,
      878    16217                                  @COLUMN = R$ -> LX_ETT_ITEM.COLUMN);
      879    16247    7                   END;
      880    16248    6                 ELSE
      881    16249    7                   DO;  /* Have a SET mnemonic-name to mnemonic-name */
      882    16250    7                     CALL SET_SWITCH_FROM_SWITCH
      883    16251    7                        (BINBIT(ST2$ -> SWITCH.SWITCH#, 36),
      884    16252    7                         BINBIT(ST$ -> SWITCH.SWITCH#, 36));
      885    16253    7                   END;
      886    16254    6                 REC$ = REC$ -> LX_ITEM.LINK;
      887    16255    6               END;
      888    16256    5             END;
      889    16257    4           CALL Z8ED$DISPOSE_ABSSYN_TREE (SEND$ -> LX_LIST.HEAD$);
      890    16258
      891    16259    4         CASE(ELSE);
      892    16260
      893    16261    4           CALL Z8EX$SET_INDEX(RECEIVE$,
      894    16262    4                               SEND$);
      895    16263    4       END;
      896    16264
      897    16265    3     END SET_TO ;
      898    16266
      899    16267    2     SET_TO_TRUE: PROC (RECEIVE$) ;
      900    16268
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:111  
      901    16269    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      902    16270    3     DCL  REC$      PTR ;
      903    16271
      904    16272    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;
      905    16273    4       DO WHILE REC$ ~= ADDR(NIL);
      906    16274
      907    16275              %FISH (TRIAD = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      908    16276                     RTN = ST$);
      909    16284
      910    16285    4         IF ST$ -> ST.ID = %CONDITION THEN
      911    16286    5           DO;
      912    16287    6             DO CASE (ST$ -> CONDITION.ASSOC_VAR$ -> ST.ID);
      913    16288
      914    16289    6               CASE (%SCALAR, %ARRAY);
      915    16290
      916    16291    6                 IF ST$ -> CONDITION.VALUE_LIST$ = ADDR(NIL)
      917    16292    6                   THEN RETURN;
      918    16293
      919    16294    6                 CALL Z8EU$CREATE_IDENTIFIER_FROM_ST (ST$ -> CONDITION.ASSOC_VAR$,
      920    16295    6                                                      ADDR(ASS_VAR),
      921    16296    6                                                      REC$ -> LX_LIST.HEAD$ ->
             16296                                                               LX_ETT_ITEM.LINE,
      922    16297    6                                                      REC$ -> LX_LIST.HEAD$ ->
             16297                                                               LX_ETT_ITEM.COLUMN);
      923    16298    6                 IF REC$ -> LX_LIST.COUNT > 1 THEN
      924    16299    6                   CALL Z8EY$SUBSCRIPT (REC$ -> LX_LIST.TAIL$,
      925    16300    6                                        ADDR(ASS_VAR));
      926    16301
      927    16302                      /* swap line & column for possible error message */
      928    16303    6                 T$ = ST$ -> CONDITION.VALUE_LIST$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;
      929    16304    6                 ORIG_LINE# = T$ -> LX_ITEM.LINE;
      930    16305    6                 ORIG_COLUMN# = T$ -> LX_ITEM.COLUMN;
      931    16306    6                 T$ -> LX_ITEM.LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE;
      932    16307    6                 T$ -> LX_ITEM.COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN;
      933    16308
      934    16309    6                 CALL Z8E7$RESTRICTED_MOVE (ADDR(ASS_VAR),
      935    16310    6                                 ST$ -> CONDITION.VALUE_LIST$ -> LX_LIST.HEAD$
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:112  
      936    16311    6                                               -> LX_LIST.HEAD$);
      937    16312
      938    16313                      /* restore line & column to original value is clause */
      939    16314    6                 T$ -> LX_ITEM.LINE = ORIG_LINE#;
      940    16315    6                 T$ -> LX_ITEM.COLUMN = ORIG_COLUMN#;
      941    16316
      942    16317    6               CASE(%SWITCH);
      943    16318
      944    16319    6                 CALL CREATE_SWITCH_TRIAD (BINBIT(ST$ -> CONDITION.ASSOC_VAR$ -> SWITCH
             16319                          .SWITCH#, 36),
      945    16320    6                                           CONST$);
      946    16321
      947    16322    6                 IF ST$ -> CONDITION.ASSOC_VAR$ -> SWITCH.ON$ = ST$ THEN
      948    16323                        %NEW_ILL (@ID = %ON_SWITCH,
      949    16324                                  @LOP = CONST$);
      950    16703    6                 ELSE
      951    16704                        %NEW_ILL (@ID = %OFF_SWITCH,
      952    16705                                  @LOP = CONST$);
      953    17084
      954    17085    6               CASE (ELSE);
      955    17086
      956    17087    6                 CALL Z8AE$ERROR (%E$CONDITION_NAME_EXPECTED,
      957    17088    6                                  REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      958    17089    6                                  REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
      959    17090
      960    17091    6             END;
      961    17092    5           END;
      962    17093    4         ELSE
      963    17094                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
      964    17095                                    @ERROR# = %E$CONDITION_NAME_EXPECTED,
      965    17096                                    @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      966    17097                                    @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
      967    17127
      968    17128    4         REC$ = REC$ -> LX_ITEM.LINK;
      969    17129    4       END;
      970    17130
      971    17131    3     END SET_TO_TRUE ;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:113  
      972    17132
      973    17133
      974    17134    2     SET_TO_SWITCH: PROC (RECEIVE$, SEND$) ;
      975    17135
      976    17136    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      977    17137    3     DCL  SEND$     PTR ; /* mnemonic switch, id, or literal */
      978    17138    3     DCL  REC$      PTR ;
      979    17139
      980    17140    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;
      981    17141    4       DO WHILE REC$ ~= ADDR(NIL);
      982    17142
      983    17143    4         CALL CHARBIN(SW#,
      984    17144    4                      SUBSTR(SEND$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME,
      985    17145    4                             7));
      986    17146
      987    17147              %FISH (TRIAD = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      988    17148                     RTN = ST$);
      989    17156
      990    17157    4         IF REC$ -> LX_LIST.COUNT > 1
      991    17158    4              OR ST$ -> ST.ID ~= %SWITCH THEN
      992    17159                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
      993    17160                                    @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
      994    17161                                    @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      995    17162                                    @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
      996    17192    4         ELSE
      997    17193    4           CALL SET_SWITCH_FROM_SWITCH (BINBIT(ST$ -> SWITCH.SWITCH#, 36),
      998    17194    4                                        SW#);
      999    17195    4         REC$ = REC$ -> LX_ITEM.LINK;
     1000    17196    4       END;
     1001    17197
     1002    17198    3     END SET_TO_SWITCH ;
     1003    17199
     1004    17200
     1005    17201    2     SET_SWITCH_TO: PROC (RECEIVE$, SEND$) ; /* SET SWITCH ... TO ___ */
     1006    17202
     1007    17203    3     DCL  RECEIVE$  PTR ; /* LX_LIST of switches */
     1008    17204    3     DCL  SEND$     PTR ; /* LX_TERMINAL, LX_ETT_ITEM */
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:114  
     1009    17205    3     DCL  REC$      PTR ;
     1010    17206    3     DCL  S$        PTR ;
     1011    17207
     1012    17208    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$ ;
     1013    17209    4       DO WHILE (REC$ ~= ADDR(NIL)) ;
     1014    17210
     1015    17211    5         IF REC$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;
     1016    17212
     1017    17213    5           CALL CHARBIN (SW#,
     1018    17214    5                         SUBSTR (REC$ -> LX_TERMINAL.DNT$
     1019    17215    5                                            -> DNT.TEXT.NAME,
     1020    17216    5                                 7));
     1021    17217
     1022    17218    6           DO CASE(SEND$ -> LX_ITEM.ID);
     1023    17219
     1024    17220    6             CASE(%LX_TERMINAL);
     1025    17221
     1026    17222    7               DO SELECT(SEND$ -> LX_TERMINAL.SYMBOL);
     1027    17223
     1028    17224    7                 SELECT(%RSV_WRD_ON);
     1029    17225
     1030    17226    7                   CALL CREATE_SWITCH_TRIAD (SW#, CONST$);
     1031    17227
     1032    17228                        %NEW_ILL (@ID = %ON_SWITCH,
     1033    17229                                  @LOP = CONST$);
     1034    17608
     1035    17609    7                 SELECT(%RSV_WRD_OFF);
     1036    17610
     1037    17611    7                   CALL CREATE_SWITCH_TRIAD (SW#, CONST$);
     1038    17612
     1039    17613                        %NEW_ILL (@ID = %OFF_SWITCH,
     1040    17614                                  @LOP = CONST$);
     1041    17993
     1042    17994    7                 SELECT(%RSV_WRD_SWITCH);
     1043    17995
     1044    17996    7                   CALL CHARBIN(SW2#,
     1045    17997    7                                SUBSTR(SEND$ -> LX_TERMINAL.DNT$
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:115  
     1046    17998    7                                              -> DNT.TEXT.NAME,
     1047    17999    7                                       7));
     1048    18000
     1049    18001    7                   CALL SET_SWITCH_FROM_SWITCH (SW#,
     1050    18002    7                                                SW2#);
     1051    18003
     1052    18004    7               END;
     1053    18005
     1054    18006    6             CASE(%LX_ETT_ITEM, %LX_LIST);
     1055    18007
     1056    18008    6               IF SEND$ -> LX_ITEM.ID = %LX_LIST THEN
     1057    18009    6                 S$ = SEND$ -> LX_LIST.HEAD$ ;
     1058    18010    6               ELSE
     1059    18011    6                 S$ = SEND$ ;
     1060    18012
     1061    18013                    %FISH (TRIAD = S$ -> LX_ETT_ITEM.ETT$,
     1062    18014                           RTN = ST$);
     1063    18022
     1064    18023    6               IF ST$ -> ST.ID = %SWITCH THEN
     1065    18024    6                  CALL SET_SWITCH_FROM_SWITCH (SW#,
     1066    18025    6                           BINBIT(ST$ -> SWITCH.SWITCH#, 36));
     1067    18026    6               ELSE
     1068    18027                      %CONDITIONAL_ERROR (@LX_ITEM$ = S$,
     1069    18028                                @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
     1070    18029                                @LINE = S$ -> LX_ETT_ITEM.LINE,
     1071    18030                                @COLUMN = S$ -> LX_ETT_ITEM.COLUMN);
     1072    18060
     1073    18061    6           END; /* Do case ID of TAIL of REC */
     1074    18062
     1075    18063    5         END ; /* REC$ is an LX_TERMINAL (SWITCH) */
     1076    18064    4         ELSE
     1077    18065    4           IF REC$ -> LX_ITEM.ID = %LX_LIST THEN
     1078    18066                  %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
     1079    18067                            @ERROR# = %E$SWITCH_EXPECTED,
     1080    18068                            @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1081    18069                            @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
     1082    18099    4           ELSE
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:116  
     1083    18100                  %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
     1084    18101                            @ERROR# = %E$SWITCH_EXPECTED,
     1085    18102                            @LINE = REC$ -> LX_ETT_ITEM.LINE,
     1086    18103                            @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);
     1087    18133    4         REC$ = REC$ -> LX_ITEM.LINK ;
     1088    18134    4       END ; /* Do while on REC$ */
     1089    18135
     1090    18136    3     END SET_SWITCH_TO ;
     1091    18137
     1092    18138
     1093    18139    2     CREATE_SWITCH_TRIAD : PROC (SW#, CONST$);
     1094    18140
     1095    18141    3       DCL SW# SBIN WORD;
     1096    18142    3       DCL CONST$ PTR;
     1097    18143
     1098    18144    3       DCL 1 SW_VALUE (0:35) CONSTANT BIT(36)
     1099    18145    3              INIT ('100000000000000000000000000000000000'B,
     1100    18146    3                    '010000000000000000000000000000000000'B,
     1101    18147    3                    '001000000000000000000000000000000000'B,
     1102    18148    3                    '000100000000000000000000000000000000'B,
     1103    18149    3                    '000010000000000000000000000000000000'B,
     1104    18150    3                    '000001000000000000000000000000000000'B,
     1105    18151    3                    '000000100000000000000000000000000000'B,
     1106    18152    3                    '000000010000000000000000000000000000'B,
     1107    18153    3                    '000000001000000000000000000000000000'B,
     1108    18154    3                    '000000000100000000000000000000000000'B,
     1109    18155    3                    '000000000010000000000000000000000000'B,
     1110    18156    3                    '000000000001000000000000000000000000'B,
     1111    18157    3                    '000000000000100000000000000000000000'B,
     1112    18158    3                    '000000000000010000000000000000000000'B,
     1113    18159    3                    '000000000000001000000000000000000000'B,
     1114    18160    3                    '000000000000000100000000000000000000'B,
     1115    18161    3                    '000000000000000010000000000000000000'B,
     1116    18162    3                    '000000000000000001000000000000000000'B,
     1117    18163    3                    '000000000000000000100000000000000000'B,
     1118    18164    3                    '000000000000000000010000000000000000'B,
     1119    18165    3                    '000000000000000000001000000000000000'B,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:117  
     1120    18166    3                    '000000000000000000000100000000000000'B,
     1121    18167    3                    '000000000000000000000010000000000000'B,
     1122    18168    3                    '000000000000000000000001000000000000'B,
     1123    18169    3                    '000000000000000000000000100000000000'B,
     1124    18170    3                    '000000000000000000000000010000000000'B,
     1125    18171    3                    '000000000000000000000000001000000000'B,
     1126    18172    3                    '000000000000000000000000000100000000'B,
     1127    18173    3                    '000000000000000000000000000010000000'B,
     1128    18174    3                    '000000000000000000000000000001000000'B,
     1129    18175    3                    '000000000000000000000000000000100000'B,
     1130    18176    3                    '000000000000000000000000000000010000'B,
     1131    18177    3                    '000000000000000000000000000000001000'B,
     1132    18178    3                    '000000000000000000000000000000000100'B,
     1133    18179    3                    '000000000000000000000000000000000010'B,
     1134    18180    3                    '000000000000000000000000000000000001'B);
     1135    18181
     1136    18182    3       MKCN.CON = BITBIN(SW_VALUE(SW#));
     1137    18183    3       CALL Z8AC$MAKE_CONST (CONST$);
     1138    18184
     1139    18185    3     END CREATE_SWITCH_TRIAD;
     1140    18186
     1141    18187    2     CHECK_FOR_DML_SET: PROC ALTRET ;
     1142    18188
     1143    18189    3       P3$ = REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;
     1144    18190    3       P4$ = REC$ -> LX_LIST.TAIL$ ; /* Sending field */
     1145    18191
     1146    18192    3       IF P4$-> LX_ITEM.ID = %LX_TERMINAL      THEN
     1147    18193    3           RETURN ; /* Not a DML SET */
     1148    18194    3       ELSE
     1149    18195    4         DO;
     1150    18196
     1151    18197                %FISH(TRIAD = P3$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$, RTN = P1$);
     1152    18205                %FISH(TRIAD = P4$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$, RTN = P2$);
     1153    18213    4           IF (P1$ -> VARIABLE.B.DML_TYPE = %DATA_BASE_KEY)   OR
     1154    18214    4                (P1$ -> VARIABLE.B.DML_TYPE = %DIRECT_REFERENCE)  OR
     1155    18215    4                   ((P2$ -> VARIABLE.B.DML_TYPE = %DIRECT_REFERENCE)  OR
     1156    18216    4                       (P2$ -> VARIABLE.B.DML_TYPE = %DATA_BASE_KEY)) AND
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:118  
     1157    18217    4                           (P4$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %ADDR
             18217                                    ) THEN
     1158    18218
     1159    18219                /*    A DML SET statment is treated as a MOVE.           */
     1160    18220
     1161    18221    5             DO;
     1162    18222
     1163    18223                 /*  Check for a subscript on the sending item and take care of it here.  */
     1164    18224                    /*   Other items will be checked in MOVE.        */
     1165    18225    5               IF P4$ -> LX_LIST.HEAD$ ~= P4$ -> LX_LIST.TAIL$   THEN
     1166    18226    5                 CALL Z8EY$SUBSCRIPT(P4$ -> LX_LIST.TAIL$,
     1167    18227    5                                     P4$ -> LX_LIST.HEAD$);
     1168    18228    5               CALL MOVE_STATEMENT( KEY_WORD$,
     1169    18229    5                                    P4$ -> LX_LIST.HEAD$,
     1170    18230    5                                    REC$ -> LX_LIST.HEAD$,
     1171    18231    5                                    %S_TYPE_DML_SET);
     1172    18232    5               CALL Z8ED$DISPOSE_ABSSYN_TREE(REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$);
     1173    18233    5               CALL Z8ED$DISPOSE_ABSSYN_TREE(P4$ -> LX_LIST.HEAD$);
     1174    18234    5               ALTRETURN ;
     1175    18235    5             END;
     1176    18236    4           ELSE
     1177    18237    4               RETURN ; /* Not a DML SET */
     1178    18238    4       END;
     1179    18239
     1180    18240    3     END CHECK_FOR_DML_SET ;
     1181    18241
     1182    18242
     1183    18243    2     SET_ON_OR_OFF: PROC (RECEIVE$, ON_OR_OFF) ;
     1184    18244
     1185    18245    3     DCL  RECEIVE$  PTR ;  /* mnemonic-name or SWITCH-nn */
     1186    18246    3     DCL  ON_OR_OFF SBIN ; /* %ON_SWITCH or %OFF_SWITCH   */
     1187    18247
     1188    18248    4       IF RECEIVE$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;
     1189    18249
     1190    18250              /* SET SWITCH-nn TO ON (or OFF) */
     1191    18251
     1192    18252    4         CALL CHARBIN (SW#, SUBSTR (RECEIVE$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME, 7))
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:119  
             18252                  ;
     1193    18253    4         CALL CREATE_SWITCH_TRIAD (SW#, CONST$) ;
     1194    18254    4         IF ON_OR_OFF = %ON_SWITCH THEN
     1195    18255                %NEW_ILL (@ID = %ON_SWITCH, @LOP = CONST$) ;
     1196    18634    4         ELSE
     1197    18635                %NEW_ILL (@ID = %OFF_SWITCH, @LOP = CONST$) ;
     1198    19014
     1199    19015    4       END ; /* Receiving guy is a SWITCH */
     1200    19016
     1201    19017    4       ELSE DO ; /* It ain't no SWITCH */
     1202    19018
     1203    19019              /* SET mnemonic-name TO ON (or OFF) */
     1204    19020
     1205    19021              %FISH (TRIAD = RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
     1206    19022                     RTN = ST$);
     1207    19030
     1208    19031    4         IF ST$ -> ST.ID = %SWITCH THEN
     1209    19032    5           DO;
     1210    19033    5             CALL CREATE_SWITCH_TRIAD (BINBIT(ST$ -> SWITCH.SWITCH#, 36),
     1211    19034    5                                       CONST$);
     1212    19035
     1213    19036    5             IF ON_OR_OFF = %ON_SWITCH THEN
     1214    19037                    %NEW_ILL (@ID = %ON_SWITCH, @LOP = CONST$) ;
     1215    19416    5             ELSE
     1216    19417                    %NEW_ILL (@ID = %OFF_SWITCH, @LOP = CONST$) ;
     1217    19796    5           END;
     1218    19797    4         ELSE
     1219    19798                %CONDITIONAL_ERROR (@LX_ITEM$ = RECEIVE$ -> LX_LIST.HEAD$,
     1220    19799                                    @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
     1221    19800                                    @LINE = RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1222    19801                                    @COLUMN =
             19801                                        RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
     1223    19831
     1224    19832    4       END ; /* Receiving guy is a mnemonic-name */
     1225    19833
     1226    19834    3     END SET_ON_OR_OFF ;
     1227    19835
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:120  
     1228    19836
     1229    19837    2     SET_SWITCH_FROM_SWITCH : PROC (REC_SW#,
     1230    19838    2                                    SEND_SW#);
     1231    19839
     1232    19840    3       DCL REC_SW# SBIN WORD;
     1233    19841    3       DCL SEND_SW# SBIN WORD;
     1234    19842
     1235    19843    3       CALL Z8AT$CREATE_TEMPORARY (%PARA,
     1236    19844    3                                   END_LABEL$);
     1237    19845    3       CALL Z8AT$CREATE_TEMPORARY (%PARA,
     1238    19846    3                                   OFF_SW_LABEL$);
     1239    19847
     1240    19848            %INIT_UNARY_OP (@POINTER = "ADDR(SW_ON_COND)",
     1241    19849                            @OP = %OP_SWITCH_IS_ON,
     1242    19850                            @LOP$ = "ADDR(SW_VALUE)");
     1243    19867
     1244    19868    3       CALL Z8AC$LX_ETT_ITEM_TYI_CONST
     1245    19869    3              (SEND_SW#,
     1246    19870    3               ADDR(SW_VALUE));
     1247    19871
     1248    19872    3       CALL Z8EK$BRANCH_FALSE (OFF_SW_LABEL$,
     1249    19873    3                               ADDR(SW_ON_COND));
     1250    19874
     1251    19875    3       CALL CREATE_SWITCH_TRIAD (REC_SW#, CONST$);
     1252    19876
     1253    19877            %NEW_ILL (@ID = %ON_SWITCH,
     1254    19878                      @LOP = CONST$);
     1255    20257
     1256    20258    3       CALL Z8EK$BRANCH (END_LABEL$);
     1257    20259
     1258    20260            %NEW_ILL (@ID = %DEFLB,
     1259    20261                      @LABEL$ = OFF_SW_LABEL$);
     1260    20640
     1261    20641            %NEW_ILL (@ID = %OFF_SWITCH,
     1262    20642                      @LOP = CONST$);
     1263    21021
     1264    21022            %NEW_ILL (@ID = %DEFLB,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:121  
     1265    21023                      @LABEL$ = END_LABEL$);
     1266    21402
     1267    21403    3     END SET_SWITCH_FROM_SWITCH;
     1268    21404
     1269    21405
     1270    21406    2      PROCESS_POINTER_SET: PROC (REC$, SEND$);
     1271    21407
     1272    21408    3        DCL REC$      PTR; /* LX_LIST to <id_or_switch_list> */
     1273    21409    3        DCL SEND$     PTR; /* LX_LIST to <SET_send_item>     */
     1274    21410    3        DCL R$        PTR;
     1275    21411
     1276    21412
     1277    21413    3        IF SEND$ -> LX_LIST.COUNT > 1 THEN   /* array item */
     1278    21414    3          CALL Z8EY$SUBSCRIPT (SEND$ -> LX_LIST.TAIL$,
     1279    21415    3                               SEND$ -> LX_LIST.HEAD$);
     1280    21416
     1281    21417    4        DO CASE (REC$ -> LX_ITEM.ID);
     1282    21418    4          CASE(%LX_ETT_ITEM);
     1283    21419
     1284    21420    4              IF REC$ -> LX_ETT_ITEM.TYPE ~= %TYP THEN
     1285    21421    5                DO;
     1286    21422                       %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
     1287    21423                           @ERROR# =%E$POINTER_INCOMPATIBLE,
     1288    21424                           @LINE   = REC$ -> LX_ETT_ITEM.LINE,
     1289    21425                           @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);
     1290    21455    5                END;
     1291    21456    4              ELSE
     1292    21457    4                CALL Z8E7$POINTER_MOVE (REC$, SEND$ -> LX_LIST.HEAD$);
     1293    21458
     1294    21459    4          CASE(%LX_LIST);
     1295    21460
     1296    21461    4              R$ = REC$ -> LX_LIST.HEAD$;
     1297    21462
     1298    21463    5            DO WHILE (R$ ~= ADDR(NIL));
     1299    21464    5              IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE ~= %TYP THEN
     1300    21465    6                DO;
     1301    21466                       %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:122  
     1302    21467                           @ERROR# =%E$POINTER_INCOMPATIBLE,
     1303    21468                           @LINE   = R$->LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1304    21469                           @COLUMN = R$->LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
     1305    21499    6                END;
     1306    21500    5              ELSE
     1307    21501    6                DO;
     1308    21502    6                  IF R$ -> LX_LIST.COUNT > 1 THEN
     1309    21503    6                    CALL Z8EY$SUBSCRIPT(R$ -> LX_LIST.TAIL$,
     1310    21504    6                                        R$ -> LX_LIST.HEAD$);
     1311    21505
     1312    21506    6                  CALL Z8E7$POINTER_MOVE (R$ -> LX_LIST.HEAD$,
     1313    21507    6                                          SEND$ -> LX_LIST.HEAD$);
     1314    21508    6                END;
     1315    21509
     1316    21510    5              R$ = R$ -> LX_LIST.LINK;
     1317    21511
     1318    21512    5            END; /* DO WHILE */
     1319    21513
     1320    21514    4          CASE (ELSE);
     1321    21515    4              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
     1322    21516
     1323    21517    4        END; /* DO CASE */
     1324    21518
     1325    21519    3     END PROCESS_POINTER_SET;
     1326    21520
     1327    21521
     1328    21522        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:123  
     1329    21523        /* Body of SET_STATEMENT */
     1330    21524
     1331    21525        %STATEMENT_START_FROM_LX_TERM (@POINTER = KEY_WORD$,
     1332    21526                                       @TYPE = %S_TYPE_SET);
     1333    22302
     1334    22303
     1335    22304
     1336    22305    3   DO CASE (SET_TYPE);
     1337    22306
     1338    22307    3     CASE (%SET_ON);
     1339    22308
     1340    22309    3       CALL SET_ON_OR_OFF (RECEIVE$, %ON_SWITCH) ;
     1341    22310
     1342    22311    3     CASE (%SET_OFF);
     1343    22312
     1344    22313    3       CALL SET_ON_OR_OFF (RECEIVE$, %OFF_SWITCH) ;
     1345    22314
     1346    22315    3     CASE (%SET_SWITCH);
     1347    22316
     1348    22317    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;
     1349    22318    4       DO WHILE REC$ ~= ADDR(NIL);
     1350    22319
     1351    22320    5         DO SELECT (REC$ -> LX_LIST.HEAD$ -> LX_LIST.LINK -> LX_TERMINAL.SYMBOL) ;
     1352    22321
     1353    22322    5           SELECT (%RSV_WRD_UP) ; /* SET ... id1 UP BY id2 ... */
     1354    22323
     1355    22324    5             CALL SET_UP_DOWN (REC$ -> LX_LIST.HEAD$,
     1356    22325    5                               REC$ -> LX_LIST.TAIL$,
     1357    22326    5                               %SET_UP_BY) ;
     1358    22327
     1359    22328    5           SELECT (%RSV_WRD_DOWN) ; /* SET ... id1 DOWN BY id2 ... */
     1360    22329
     1361    22330    5             CALL SET_UP_DOWN (REC$ -> LX_LIST.HEAD$,
     1362    22331    5                               REC$ -> LX_LIST.TAIL$,
     1363    22332    5                               %SET_DOWN_BY) ;
     1364    22333    5           SELECT (%RSV_WRD_TO) ; /* SET ... id1 TO id2 ... */
     1365    22334
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:124  
     1366    22335    5             IF REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ -> LX_ITEM.ID
     1367    22336    5              = %LX_TERMINAL THEN
     1368    22337    5               CALL SET_SWITCH_TO (REC$ -> LX_LIST.HEAD$,
     1369    22338    5                                   REC$ -> LX_LIST.TAIL$) ;
     1370    22339    6             ELSE DO ; /* Receiving list is not SWITCHs */
     1371    22340
     1372    22341    7               IF REC$ -> LX_LIST.TAIL$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;
     1373    22342
     1374    22343    8                 DO SELECT (REC$ -> LX_LIST.TAIL$ -> LX_TERMINAL.SYMBOL) ;
     1375    22344
     1376    22345    8                   SELECT (%RSV_WRD_ON, %RSV_WRD_OFF) ;
     1377    22346
     1378    22347    8                     R$ = REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ ;
     1379    22348    9                     DO WHILE R$ ~= ADDR(NIL) ;
     1380    22349
     1381    22350    9                       IF REC$ -> LX_LIST.TAIL$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_ON
             22350                                THEN
     1382    22351    9                         CALL SET_ON_OR_OFF (R$, %ON_SWITCH) ;
     1383    22352    9                       ELSE
     1384    22353    9                         CALL SET_ON_OR_OFF (R$, %OFF_SWITCH) ;
     1385    22354
     1386    22355    9                       R$ = R$ -> LX_ITEM.LINK ;
     1387    22356
     1388    22357    9                     END ; /* Do while R$ is non-nil */
     1389    22358
     1390    22359    8                   SELECT (%RSV_WRD_TRUE) ;
     1391    22360
     1392    22361    8                     IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN
     1393    22362    8                       CALL Z8AE$ERROR (%E$LEVEL_CHECK,
     1394    22363    8                                        KEY_WORD$ -> LX_ITEM.LINE,
     1395    22364    8                                        KEY_WORD$ -> LX_ITEM.COLUMN);
     1396    22365
     1397    22366    8                     CALL SET_TO_TRUE (REC$ -> LX_LIST.HEAD$) ;
     1398    22367
     1399    22368    8                   SELECT (%RSV_WRD_SWITCH) ;
     1400    22369
     1401    22370    8                     CALL SET_TO_SWITCH (REC$ -> LX_LIST.HEAD$,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:125  
     1402    22371    8                                         REC$ -> LX_LIST.TAIL$) ;
     1403    22372
     1404    22373    8                   SELECT (%RSV_WRD_NULL) ;
     1405    22374
     1406    22375    8                     CALL MOVE_STATEMENT (KEY_WORD$,
     1407    22376    8                                          REC$ -> LX_LIST.TAIL$,
     1408    22377    8                                          REC$ -> LX_LIST.HEAD$,
     1409    22378    8                                          %S_TYPE_DML_SET) ;
     1410    22379
     1411    22380    8                     CALL Z8ED$DISPOSE_ABSSYN_TREE (REC$ -> LX_LIST.HEAD$ -> LX_LIST.
             22380                              HEAD$) ;
     1412    22381
     1413    22382    8                   SELECT (ELSE) ; /* Must be a number */
     1414    22383
     1415    22384    8                     CALL CHECK_FOR_DML_SET
     1416    22385    9                     WHENRETURN DO ; /* not a DML SET */
     1417    22386
     1418    22387    9                       CALL SET_TO (REC$ -> LX_LIST.HEAD$,
     1419    22388    9                                    REC$ -> LX_LIST.TAIL$) ;
     1420    22389    9                     END ;
     1421    22390
     1422    22391    8                 END ; /* Do select REC$ -> TAIL$ -> SYMBOL */
     1423    22392
     1424    22393    7               END ; /* REC$ -> TAIL$ is a terminal */
     1425    22394
     1426    22395    7               ELSE DO ; /* REC$ -> TAIL$ is not a terminal */
     1427    22396
     1428    22397    7                 CALL CHECK_FOR_DML_SET
     1429    22398    8                 WHENRETURN DO ; /* not a DML SET */
     1430    22399
     1431    22400    8                   CALL SET_TO (REC$ -> LX_LIST.HEAD$,
     1432    22401    8                                REC$ -> LX_LIST.TAIL$) ;
     1433    22402    8                 END ;
     1434    22403
     1435    22404    7               END ; /* Sending guy is an identifier */
     1436    22405    6             END ; /* Receiving list is not SWITCHs */
     1437    22406    5         END ; /* Do Select of SYMBOL of 2nd LX_ITEM in list */
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:126  
     1438    22407    4         REC$ = REC$ -> LX_ITEM.LINK;
     1439    22408    4       END; /* Do while REC$ is non-nil */
     1440    22409    3   END; /* Do case of SET type */
     1441    22410
     1442    22411    2   IF RECEIVE$ -> LX_ITEM.ID = %LX_LIST THEN
     1443    22412    2     CALL Z8ED$DISPOSE_ABSSYN_TREE (RECEIVE$ -> LX_LIST.HEAD$);
     1444    22413
     1445    22414    2   END SET_STATEMENT;
     1446    22415        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:127  
     1447    22416        /*--------------*/
     1448    22417    1     MOVE_STATEMENT : PROC ( KEY_WORD$,
     1449    22418    1   /*--------------*/        SEND$,
     1450    22419    1                             REC$,
     1451    22420    1                             STATEMENT_TYPE);
     1452    22421
     1453    22422        /*I*
     1454    22423                 NAME: MOVE_STATEMENT
     1455    22424
     1456    22425          DESCRIPTION: Z8E7$MOVE_STATEMENT handles all MOVE statement semantics.
     1457    22426        */
     1458    22427
     1459    22428
     1460    22429    2     DCL KEY_WORD$ PTR;  /* To MOVE keyword */
     1461    22430    2     DCL SEND$     PTR;  /* To <ident_lit> */
     1462    22431    2     DCL REC$      PTR;  /* To <identifier_list> */
     1463    22432    2     DCL STATEMENT_TYPE  SBIN;     /* Type to check for DML SET  */
     1464    22433
     1465    22434    2     DCL IDENT$    PTR;
     1466    22435    2     DCL VAL_REQUIRED BOOLEAN;
     1467    22436
     1468    22437
     1469    22438          %STATEMENT_START_FROM_LX_TERM (@POINTER = KEY_WORD$,
     1470    22439                                         @TYPE = %S_TYPE_MOVE);
     1471    23215
     1472    23216    2     IF REC$ -> LX_LIST.COUNT > 1
     1473    23217    2          AND SEND$ -> LX_ITEM.ID = %LX_ETT_ITEM
     1474    23218    2          AND SEND$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
     1475    23219    3       DO;
     1476    23220    3         CALL Z8AF$FORME (%EVAL,
     1477    23221    3                          SEND$ -> LX_ETT_ITEM.ETT$,
     1478    23222    3                          ADDR(NIL),
     1479    23223    3                          SEND$ -> LX_ETT_ITEM.ETT$);
     1480    23224              %NEW_ILL(@ID = %VAL,
     1481    23225                       @ETT$ = SEND$ -> LX_ETT_ITEM.ETT$);
     1482    23604    3         VAL_REQUIRED = TRUE;
     1483    23605    3         VAL_REC_COUNT = 0 ;                                   /*#28761*/
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:128  
     1484    23606    3       END;
     1485    23607    2     ELSE
     1486    23608    2       VAL_REQUIRED = FALSE;
     1487    23609
     1488    23610
     1489    23611    2     IDENT$ = REC$ -> LX_LIST.HEAD$;
     1490    23612
     1491    23613    3     DO WHILE IDENT$ ~= ADDR(NIL);
     1492    23614
     1493    23615    3       IF STATEMENT_TYPE = %S_TYPE_MOVE    THEN
     1494    23616    3           CALL Z8E7$MOVE_STATEMENT (IDENT$, SEND$, ,STATEMENT_TYPE);
     1495    23617    3       ELSE
     1496    23618            /* This is a DML SET and needs to have an extra level of indirection
     1497    23619               and subscript modifcation if needed since the grammar is set up
     1498    23620               for SET of index items not data base keys.                   */
     1499    23621
     1500    23622    4         DO;
     1501    23623    4           IF IDENT$ -> LX_LIST.HEAD$ ~= IDENT$ -> LX_LIST.TAIL$   THEN
     1502    23624
     1503    23625                       /*   We have a subscript     */
     1504    23626    4              CALL Z8EY$SUBSCRIPT(IDENT$ -> LX_LIST.TAIL$,
     1505    23627    4                                  IDENT$ -> LX_LIST.HEAD$);
     1506    23628
     1507    23629    4           CALL Z8E7$MOVE_STATEMENT(IDENT$->LX_LIST.HEAD$,SEND$, ,STATEMENT_TYPE);
     1508    23630    4         END;
     1509    23631
     1510    23632    3       IDENT$ = IDENT$ -> LX_ETT_ITEM.LINK;
     1511    23633    3       VAL_REC_COUNT = VAL_REC_COUNT + 1 ;                     /*#28761*/
     1512    23634
     1513    23635    3     END;  /* DO WHILE */
     1514    23636
     1515    23637    3     IF VAL_REQUIRED THEN DO ;                                 /*#28761*/
     1516    23638            %NEW_ILL (@ID = %VAL_END);
     1517    24017    3       IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN      /*#28761*/
     1518    24018    3         COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;
     1519    24019    3     END ;
     1520    24020
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:129  
     1521    24021    2   END MOVE_STATEMENT;
     1522    24022        %EJECT ;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:130  
     1523    24023
     1524    24024           /* Main program  */
     1525    24025
     1526    24026    1      CALL SET_STATEMENT;
     1527    24027
     1528    24028    1    END Z8EX$SET_STATEMENT;
     1529    24029         %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:131  

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:132  
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_DML.:Z8A6TOU  is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EX$SET_STATEMENT.

   Procedure Z8EX$SET_STATEMENT requires 1644 words for executable code.
   Procedure Z8EX$SET_STATEMENT requires 84 words of local(AUTO) storage.

    No errors detected in file Z8EX.:Z8A6TSI    .

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:133  

 Object Unit name= Z8EX$SET_STATEMENT                         File name= Z8EX.:Z8A6TOU
 UTS= AUG 09 '97 12:58:12.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     2      2  MKCN
    6  LblCom even  none     1      1  DNT$
    7  LblCom even  none     5      5  DNT_
    8  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    9  LblCom even  none     1      1  DNT_OF_1$
   10  LblCom even  none     1      1  ST$
   11  LblCom even  none     5      5  ST_
   12  LblCom even  none     1      1  ETT$
   13  LblCom even  none     1      1  HEAD_ETT$
   14  LblCom even  none   512   1000  ETT_BUCKETS
   15  LblCom even  none     5      5  ETT_
   16  LblCom even  none     1      1  ILL$
   17  LblCom even  none     5      5  ILL_
   18  LblCom even  none     1      1  HEAP$
   19  LblCom even  none     8     10  TEMP_LX_NODE
   20  RoData even  UTS     36     44  Z8EX$SET_STATEMENT
   21   Proc  even  none  1644   3154  Z8EX$SET_STATEMENT
   22  RoData even  none    50     62  Z8EX$SET_STATEMENT
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:134  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        4  Z8EX$SET_STATEMENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std      12 Z8AE$ERROR
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
 yes     yes           Std       1 Z8CO$INTEGER_CHECK
         yes           Std       4 Z8AF$FORME
         yes           Std       2 Z8EX$SET_DOWN_BY
         yes           Std       2 Z8EY$SUBSCRIPT
         yes           Std       2 Z8EX$SET_UP_BY
         yes           Std       2 Z8EX$SET_INDEX
         yes           Std       4 Z8EU$CREATE_IDENTIFIER_FROM_ST
         yes           Std       2 Z8E7$RESTRICTED_MOVE
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       1 Z8EK$BRANCH
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
         yes           Std       2 Z8EK$BRANCH_FALSE
         yes           Std       2 Z8E7$POINTER_MOVE
         yes           Std       4 Z8E7$MOVE_STATEMENT
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:135  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                          r    ILL_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:136  


      676        1        /*T***********************************************************/
      677        2        /*T*                                                         */
      678        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      679        4        /*T*                                                         */
      680        5        /*T***********************************************************/
      681        6        /*------------------*/
      682        7          Z8EX$SET_STATEMENT : PROC ( KEY_WORD$,

      7 21 000000   000000 700200 xent  Z8EX$SET_ST* TSX0  ! X66_AUTO_4
        21 000001   000124 000004                    ZERO    84,4
        21 000002   003151 710000 21                 TRA     s:24026

      683        8        /*------------------*/        RECEIVE$,
      684        9                                      SEND$,
      685       10                                      SET_TYPE);
      686       11
      687       12        /*I*
      688       13                 NAME: SET_STATEMENT
      689       14
      690       15          DESCRIPTION: The particular type of SET is isolated.  The routines
      691       16                               Z8EX$SET_INDEX
      692       17                               Z8EX$SET_UP_BY
      693       18                               Z8EX$SET_DOWN_BY
      694       19                       are used to set INDEX variables.  Setting switches is
      695       20                       handled by emitting %ON_SWITCH and %OFF_SWITCH ILL
      696       21                       items.  Z8E7$RESTRICTED_MOVE is used to set <conditions>
      697       22                       to true, because these moves do not conform to the
      698       23                       standard move rules.
      699       24        */
      700       25
      701       26        %EQU PHASE = 1;
      702       27
      703       28        %INCLUDE Z8A_DEFC;
      704       96        %INCLUDE Z8A_SUPP_MAC ;
      705     2496        %INCLUDE Z8A_COMCOM ;
      706     3146        %INCLUDE Z8E_WINDOW ;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:137  
      707     5216        %INCLUDE Z8E_STACKS ;
      708     7482        %INCLUDE Z8E_O1COM;
      709     8243        %INCLUDE Z8E_MACROS;
      710     8918        %INCLUDE Z8E_ILS_LIST;
      711     9002        %INCLUDE Z8A_ERR_NUMS ;
      712     9766        %INCLUDE Z8A_MKCN;
      713     9783        %INCLUDE Z8E_DML;
      714     9903        %INCLUDE Z8A_DNT ;
      715    10124        %INCLUDE Z8A_ST;
      716    13783        %INCLUDE Z8A_TYPES;
      717    13957        %INCLUDE Z8A_ETT ;
      718    14258        %INCLUDE Z8A_ILL ;
      719    14951        %INCLUDE Z8E_HEAP;
      720    15007        %INCLUDE Z8E_ABSSYN;
      721    15213        %INCLUDE Z8E_STATEMNT;
      722    15282
      723    15283    1   DCL Z8EK$BRANCH_FALSE             ENTRY(2);
      724    15284    1   DCL Z8EK$BRANCH                   ENTRY(1);
      725    15285    1   DCL Z8ED$DISPOSE_ABSSYN_TREE      ENTRY(1);
      726    15286    1   DCL Z8AF$FORME                    ENTRY(4);
      727    15287    1   DCL Z8AC$MAKE_CONST               ENTRY(1);
      728    15288    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST    ENTRY(2);
      729    15289    1   DCL Z8E7$MOVE                     ENTRY(2);
      730    15290    1   DCL Z8E7$RESTRICTED_MOVE          ENTRY(2);
      731    15291    1   DCL Z8E7$MOVE_STATEMENT           ENTRY(4);
      732    15292    1   DCL Z8E7$POINTER_MOVE             ENTRY(2);
      733    15293    1   DCL Z8EU$CREATE_IDENTIFIER_FROM_ST ENTRY(4);
      734    15294    1   DCL Z8AE$ERROR                    ENTRY(12);
      735    15295    1   DCL Z8EX$SET_INDEX                ENTRY(2);
      736    15296    1   DCL Z8EX$SET_UP_BY                ENTRY(2);
      737    15297    1   DCL Z8EX$SET_DOWN_BY              ENTRY(2);
      738    15298    1   DCL Z8EY$SUBSCRIPT                ENTRY(2);
      739    15299    1   DCL Z8AT$CREATE_TEMPORARY         ENTRY(2);
      740    15300    1   DCL Z8CO$INTEGER_CHECK            ENTRY(1) ALTRET;
      741    15301
      742    15302    1     DCL VAL_REC_COUNT SBIN WORD;
      743    15303
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:138  
      744    15304    1     DCL KEY_WORD$ PTR;
      745    15305    1     DCL RECEIVE$ PTR;
      746    15306    1     DCL SEND$ PTR;
      747    15307    1     DCL SET_TYPE SBIN;
      748    15308
      749    15309        /*-------------*/
      750    15310    1     SET_STATEMENT : PROC;

  15310 21 000003   200010 741300       SET_STATEME* STX1  ! VAL_REC_COUNT+1,,AUTO
        21 000004   002317 710000 21                 TRA     s:21534

      751    15311        /*-------------*/
      752    15312        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:139  
      753    15313    2     DCL P$   PTR;
      754    15314    2     DCL P1$  PTR;
      755    15315    2     DCL P2$  PTR;
      756    15316    2     DCL P3$  PTR;
      757    15317    2     DCL P4$  PTR;
      758    15318    2     DCL T$ PTR;
      759    15319    2     DCL ORIG_LINE# SBIN;
      760    15320    2     DCL ORIG_COLUMN# SBIN;
      761    15321    2     DCL REC$ PTR;
      762    15322    2     DCL R$   PTR ;
      763    15323    2     DCL ST$ PTR;
      764    15324    2     DCL ST2$ PTR;
      765    15325    2     DCL CONST$ PTR;
      766    15326    2     DCL END_LABEL$ PTR;
      767    15327    2     DCL OFF_SW_LABEL$ PTR;
      768    15328    2     DCL SW# SBIN WORD;
      769    15329    2     DCL SW2# SBIN WORD;
      770    15330    2     DCL VAL_REQUIRED BOOLEAN;
      771    15331
      772    15332          %DCL_AUTO_LX_ITEM(@NAME = SW_VALUE);
      773    15336          %DCL_AUTO_LX_ITEM(@NAME = SW_ON_COND);
      774    15340          %DCL_AUTO_LX_ITEM(@NAME = ASS_VAR);
      775    15344
      776    15345          /* Internal Procedures */
      777    15346
      778    15347    2     SET_UP_DOWN: PROC (RECEIVE$, SEND$, SET_TYPE) ;

  15347 21 000005   200064 741300       SET_UP_DOWN  STX1  ! ASS_VAR+8,,AUTO

      779    15348
      780    15349    3     DCL  RECEIVE$    PTR ; /* LX_LIST                    */
      781    15350    3     DCL  SEND$       PTR ; /* LX_ETT_ITEM or whatever    */
      782    15351    3     DCL  SET_TYPE    SBIN; /* %SET_UP_BY or %SET_DOWN_BY */
      783    15352    3     DCL  REC$        PTR ;
      784    15353
      785    15354    3       CALL Z8CO$INTEGER_CHECK(SEND$);

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:140  
  15354 21 000006   200066 630500                    EPPR0   @SEND$,,AUTO
        21 000007   000000 631400 22                 EPPR1   0
        21 000010   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        21 000011   000000 011000                    NOP     0

      786    15355
      787    15356    3       IF NOT SEND$ -> LX_ITEM.B.ERROR     AND

  15356 21 000012   200066 470500                    LDP0    @SEND$,,AUTO
        21 000013   000000 471500                    LDP1    0,,PR0
        21 000014   100000 236100                    LDQ     0,,PR1
        21 000015   400000 316007                    CANQ    -131072,DL
        21 000016   000204 601000 21                 TNZ     s:16154
        21 000017   200065 473500                    LDP3    @RECEIVE$,,AUTO
        21 000020   300000 474500                    LDP4    0,,PR3
        21 000021   400000 236100                    LDQ     0,,PR4
        21 000022   400000 316007                    CANQ    -131072,DL
        21 000023   000204 601000 21                 TNZ     s:16154

      788    15357    3          NOT RECEIVE$ -> LX_ITEM.B.ERROR     THEN
      789    15358    4         DO;

      790    15359    4           IF SEND$ -> LX_ITEM.ID = %LX_ETT_ITEM

  15359 21 000024   100000 220100                    LDX0    0,,PR1
        21 000025   000004 100003                    CMPX0   4,DU
        21 000026   000076 601000 21                 TNZ     s:15750
        21 000027   100001 475500                    LDP5    1,,PR1
        21 000030   500000 221100                    LDX1    0,,PR5
        21 000031   000015 101003                    CMPX1   13,DU
        21 000032   000076 600000 21                 TZE     s:15750

      791    15360    4                AND SEND$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
      792    15361    5             DO;

      793    15362    5               CALL Z8AF$FORME (%EVAL,

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:141  
  15362 21 000033   000001 236000 22                 LDQ     1
        21 000034   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000035   100001 634500                    EPPR4   1,,PR1
        21 000036   200107 454500                    STP4    @CONST$+7,,AUTO
        21 000037   200102 635500                    EPPR5   @CONST$+2,,AUTO
        21 000040   200106 455500                    STP5    @CONST$+6,,AUTO
        21 000041   100001 636500                    EPPR6   1,,PR1
        21 000042   200105 456500                    STP6    @CONST$+5,,AUTO
        21 000043   000004 236000 22                 LDQ     4
        21 000044   200104 756100                    STQ     @CONST$+4,,AUTO
        21 000045   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000046   000002 631400 22                 EPPR1   2
        21 000047   000000 701000 xent               TSX1    Z8AF$FORME
        21 000050   000000 011000                    NOP     0

      794    15363    5                                SEND$ -> LX_ETT_ITEM.ETT$,
      795    15364    5                                ADDR(NIL),
      796    15365    5                                SEND$ -> LX_ETT_ITEM.ETT$);
      797    15366                    %NEW_ILL  (@ID = %VAL,
      798    15367                               @ETT$ = "SEND$ -> LX_ETT_ITEM.ETT$ ");

  15435 21 000051   000007 236000 22                 LDQ     7
        21 000052   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000053   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000054   200107 450500                    STP0    @CONST$+7,,AUTO
        21 000055   000010 236000 22                 LDQ     8
        21 000056   200106 756100                    STQ     @CONST$+6,,AUTO
        21 000057   000012 237000 22                 LDAQ    10
        21 000060   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 000061   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000062   000002 631400 22                 EPPR1   2
        21 000063   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 000064   000000 011000                    NOP     0

  15436 21 000065   200066 470500                    LDP0    @SEND$,,AUTO
        21 000066   000000 471500                    LDP1    0,,PR0
        21 000067   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:142  
        21 000070   000000 473400 16                 LDP3    ILL$
        21 000071   300001 756100                    STQ     1,,PR3

      799    15746    5               VAL_REQUIRED = TRUE;

  15746 21 000072   400000 236003                    LDQ     -131072,DU
        21 000073   200032 756100                    STQ     VAL_REQUIRED,,AUTO

      800    15747    5               VAL_REC_COUNT = 0 ;                             /*#28761*/

  15747 21 000074   200007 450100                    STZ     VAL_REC_COUNT,,AUTO

      801    15748    5             END;

  15748 21 000075   000077 710000 21                 TRA     s:15752

      802    15749    4           ELSE
      803    15750    4             VAL_REQUIRED = FALSE;

  15750 21 000076   200032 450100                    STZ     VAL_REQUIRED,,AUTO

      804    15751
      805    15752    4           REC$ = RECEIVE$ ->  LX_LIST.HEAD$;

  15752 21 000077   200065 471500                    LDP1    @RECEIVE$,,AUTO
        21 000100   100000 473500                    LDP3    0,,PR1
        21 000101   300004 236100                    LDQ     4,,PR3
        21 000102   200070 756100                    STQ     REC$,,AUTO

      806    15753    5           DO WHILE REC$ ~= ADDR(NIL) ;

  15753 21 000103   000155 710000 21                 TRA     s:15767

      807    15754
      808    15755    5             IF REC$ -> LX_LIST.COUNT > 1 THEN

  15755 21 000104   200070 470500                    LDP0    REC$,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:143  
        21 000105   000002 235100                    LDA     2,,PR0
        21 000106   000001 115007                    CMPA    1,DL
        21 000107   000122 604400 21                 TMOZ    s:15759

      809    15756    5               CALL Z8EY$SUBSCRIPT (REC$ -> LX_LIST.TAIL$,

  15756 21 000110   200070 236100                    LDQ     REC$,,AUTO
        21 000111   000004 036003                    ADLQ    4,DU
        21 000112   200103 756100                    STQ     @CONST$+3,,AUTO
        21 000113   200070 236100                    LDQ     REC$,,AUTO
        21 000114   000001 036003                    ADLQ    1,DU
        21 000115   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000116   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000117   000014 631400 22                 EPPR1   12
        21 000120   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 000121   000000 011000                    NOP     0

      810    15757    5                                    REC$ -> LX_LIST.HEAD$);
      811    15758
      812    15759    5             IF SET_TYPE = %SET_UP_BY THEN

  15759 21 000122   200067 470500                    LDP0    @SET_TYPE,,AUTO
        21 000123   000000 235100                    LDA     0,,PR0
        21 000124   000001 115007                    CMPA    1,DL
        21 000125   000140 601000 21                 TNZ     s:15763

      813    15760    5               CALL Z8EX$SET_UP_BY(REC$ -> LX_LIST.HEAD$,

  15760 21 000126   200066 236100                    LDQ     @SEND$,,AUTO
        21 000127   200103 756100                    STQ     @CONST$+3,,AUTO
        21 000130   200070 236100                    LDQ     REC$,,AUTO
        21 000131   000004 036003                    ADLQ    4,DU
        21 000132   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000133   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000134   000014 631400 22                 EPPR1   12
        21 000135   000000 701000 xent               TSX1    Z8EX$SET_UP_BY
        21 000136   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:144  
        21 000137   000151 710000 21                 TRA     s:15765

      814    15761    5                                   SEND$);
      815    15762    5             ELSE
      816    15763    5               CALL Z8EX$SET_DOWN_BY (REC$ -> LX_LIST.HEAD$,

  15763 21 000140   200066 236100                    LDQ     @SEND$,,AUTO
        21 000141   200103 756100                    STQ     @CONST$+3,,AUTO
        21 000142   200070 236100                    LDQ     REC$,,AUTO
        21 000143   000004 036003                    ADLQ    4,DU
        21 000144   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000145   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000146   000014 631400 22                 EPPR1   12
        21 000147   000000 701000 xent               TSX1    Z8EX$SET_DOWN_BY
        21 000150   000000 011000                    NOP     0

      817    15764    5                                      SEND$);
      818    15765    5             REC$ = REC$ -> LX_LIST.LINK;

  15765 21 000151   200070 470500                    LDP0    REC$,,AUTO
        21 000152   000007 236100                    LDQ     7,,PR0
        21 000153   200070 756100                    STQ     REC$,,AUTO

      819    15766    5             VAL_REC_COUNT = VAL_REC_COUNT + 1 ;               /*#28761*/

  15766 21 000154   200007 054100                    AOS     VAL_REC_COUNT,,AUTO

      820    15767    5           END; /* Do while REC$ non-nil */

  15767 21 000155   000001 116000 22                 CMPQ    1
        21 000156   000104 601000 21                 TNZ     s:15755

      821    15768
      822    15769    5           IF VAL_REQUIRED THEN DO ;                           /*#28761*/

  15769 21 000157   200032 234100                    SZN     VAL_REQUIRED,,AUTO
        21 000160   000204 605000 21                 TPL     s:16154
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:145  

      823    15770                  %NEW_ILL (@ID = %VAL_END);

  15841 21 000161   000007 236000 22                 LDQ     7
        21 000162   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000163   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000164   200107 450500                    STP0    @CONST$+7,,AUTO
        21 000165   000010 236000 22                 LDQ     8
        21 000166   200106 756100                    STQ     @CONST$+6,,AUTO
        21 000167   000016 237000 22                 LDAQ    14
        21 000170   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 000171   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000172   000002 631400 22                 EPPR1   2
        21 000173   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 000174   000000 011000                    NOP     0

  15842 21 000175   000001 236000 22                 LDQ     1
        21 000176   000000 470400 16                 LDP0    ILL$
        21 000177   000001 756100                    STQ     1,,PR0

      824    16149    5             IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN /*#28761*/

  16149 21 000200   200007 236100                    LDQ     VAL_REC_COUNT,,AUTO
        21 000201   000360 116000 xsym               CMPQ    COMCOM+240
        21 000202   000204 604400 21                 TMOZ    s:16154

      825    16150    5               COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;

  16150 21 000203   000360 756000 xsym               STQ     COMCOM+240

      826    16151    5           END ;

      827    16152    4         END; /* Sending field not in error */

      828    16153
      829    16154    3     END SET_UP_DOWN ;

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:146  
  16154 21 000204   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 000205   000001 702211                    TSX2  ! 1,X1

      830    16155
      831    16156    2     SET_TO: PROC (RECEIVE$, SEND$) ;

  16156 21 000206   200064 741300       SET_TO       STX1  ! ASS_VAR+8,,AUTO

      832    16157
      833    16158    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      834    16159    3     DCL  SEND$     PTR ; /* mnemonic switch, id, or literal */
      835    16160    3     DCL  REC$      PTR ;
      836    16161    3     DCL  R$        PTR ;
      837    16162
      838    16163    4       DO CASE (SEND$ -> LX_ITEM.ID);

  16163 21 000207   200066 470500                    LDP0    @SEND$,,AUTO
        21 000210   000000 471500                    LDP1    0,,PR0
        21 000211   100000 220100                    LDX0    0,,PR1
        21 000212   000003 100003                    CMPX0   3,DU
        21 000213   000215 602010 21                 TNC     s:16163+6,X0
        21 000214   000413 710000 21                 TRA     s:16261
        21 000215   000413 710000 21                 TRA     s:16261
        21 000216   000413 710000 21                 TRA     s:16261
        21 000217   000220 710000 21                 TRA     s:16167

      839    16164
      840    16165    4         CASE(%LX_LIST);

      841    16166
      842    16167    4           IF SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE = %TYP THEN

  16167 21 000220   100004 473500                    LDP3    4,,PR1
        21 000221   300004 235100                    LDA     4,,PR3
        21 000222   000022 115007                    CMPA    18,DL
        21 000223   000234 601000 21                 TNZ     s:16177

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:147  
      843    16168    5             DO;

      844    16169    5               CALL PROCESS_POINTER_SET (RECEIVE$, SEND$);

  16169 21 000224   200066 236100                    LDQ     @SEND$,,AUTO
        21 000225   200074 756100                    STQ     IDENT$+1,,AUTO
        21 000226   200065 236100                    LDQ     @RECEIVE$,,AUTO
        21 000227   200073 756100                    STQ     @STATEMENT_TYPE+1,,AUTO
        21 000230   002130 701000 21                 TSX1    PROCESS_POINTER_SET
        21 000231   000000 011000                    NOP     0

      845    16170
      846    16171    5               RETURN;

  16171 21 000232   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 000233   000001 702211                    TSX2  ! 1,X1

      847    16172    5             END;
      848    16173
      849    16174                %FISH(TRIAD = SEND$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      850    16175                      RTN = ST$);

  16177 21 000234   300001 236100                    LDQ     1,,PR3
        21 000235   200023 756100                    STQ     ST$,,AUTO

  16178 21 000236   200023 474500                    LDP4    ST$,,AUTO
        21 000237   400000 222100                    LDX2    0,,PR4
        21 000240   000751 102003                    CMPX2   489,DU
        21 000241   000251 603000 21                 TRC     s:16184

  16179 21 000242   200023 470500                    LDP0    ST$,,AUTO
        21 000243   000001 236100                    LDQ     1,,PR0
        21 000244   200023 756100                    STQ     ST$,,AUTO

  16180 21 000245   200023 470500                    LDP0    ST$,,AUTO
        21 000246   000000 220100                    LDX0    0,,PR0
        21 000247   000751 100003                    CMPX0   489,DU
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:148  
        21 000250   000242 602000 21                 TNC     s:16179

      851    16183
      852    16184    4           IF ST$ -> ST.ID ~= %SWITCH THEN

  16184 21 000251   200023 470500                    LDP0    ST$,,AUTO
        21 000252   000000 220100                    LDX0    0,,PR0
        21 000253   000762 100003                    CMPX0   498,DU
        21 000254   000262 600000 21                 TZE     s:16191

      853    16185    5             DO;  /* Rec should be INDEX */

      854    16186    5               CALL Z8EX$SET_INDEX (RECEIVE$,

  16186 21 000255   200065 630500                    EPPR0   @RECEIVE$,,AUTO
        21 000256   000014 631400 22                 EPPR1   12
        21 000257   000000 701000 xent               TSX1    Z8EX$SET_INDEX
        21 000260   000000 011000                    NOP     0

      855    16187    5                                    SEND$);
      856    16188    5             END;

  16188 21 000261   000402 710000 21                 TRA     s:16257

      857    16189    4           ELSE
      858    16190    5             DO;

      859    16191    5               REC$ = RECEIVE$ -> LX_LIST.HEAD$;

  16191 21 000262   200065 471500                    LDP1    @RECEIVE$,,AUTO
        21 000263   100000 473500                    LDP3    0,,PR1
        21 000264   300004 236100                    LDQ     4,,PR3
        21 000265   200067 756100                    STQ     REC$,,AUTO

      860    16192    6               DO WHILE REC$ ~= ADDR(NIL);

  16192 21 000266   000400 710000 21                 TRA     s:16255
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:149  

      861    16193    6                 IF REC$ -> LX_ITEM.ID = %LX_LIST THEN

  16193 21 000267   200067 470500                    LDP0    REC$,,AUTO
        21 000270   000000 220100                    LDX0    0,,PR0
        21 000271   000002 100003                    CMPX0   2,DU
        21 000272   000276 601000 21                 TNZ     s:16196

      862    16194    6                   R$ = REC$ -> LX_LIST.HEAD$ ;

  16194 21 000273   000004 236100                    LDQ     4,,PR0
        21 000274   200070 756100                    STQ     R$,,AUTO
        21 000275   000300 710000 21                 TRA     s:16198

      863    16195    6                 ELSE
      864    16196    6                   R$ = REC$ ;

  16196 21 000276   200067 236100                    LDQ     REC$,,AUTO
        21 000277   200070 756100                    STQ     R$,,AUTO

      865    16197
      866    16198    6                 IF R$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  16198 21 000300   200070 471500                    LDP1    R$,,AUTO
        21 000301   100000 221100                    LDX1    0,,PR1
        21 000302   000306 601000 21                 TNZ     s:16204

      867    16199    6                   ST2$ = ADDR(NIL) ;

  16199 21 000303   000001 236000 22                 LDQ     1
        21 000304   200024 756100                    STQ     ST2$,,AUTO
        21 000305   000323 710000 21                 TRA     s:16211

      868    16200    6                 ELSE
      869    16201                        %FISH (TRIAD = R$ -> LX_ETT_ITEM.ETT$,
      870    16202                               RTN = ST2$);

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:150  
  16204 21 000306   100001 236100                    LDQ     1,,PR1
        21 000307   200024 756100                    STQ     ST2$,,AUTO

  16205 21 000310   200024 473500                    LDP3    ST2$,,AUTO
        21 000311   300000 222100                    LDX2    0,,PR3
        21 000312   000751 102003                    CMPX2   489,DU
        21 000313   000323 603000 21                 TRC     s:16211

  16206 21 000314   200024 470500                    LDP0    ST2$,,AUTO
        21 000315   000001 236100                    LDQ     1,,PR0
        21 000316   200024 756100                    STQ     ST2$,,AUTO

  16207 21 000317   200024 470500                    LDP0    ST2$,,AUTO
        21 000320   000000 220100                    LDX0    0,,PR0
        21 000321   000751 100003                    CMPX0   489,DU
        21 000322   000314 602000 21                 TNC     s:16206

      871    16210
      872    16211    6                 IF ST2$ = ADDR(NIL)

  16211 21 000323   000001 116000 22                 CMPQ    1
        21 000324   000331 600000 21                 TZE     s:16227
        21 000325   200024 470500                    LDP0    ST2$,,AUTO
        21 000326   000000 220100                    LDX0    0,,PR0
        21 000327   000762 100003                    CMPX0   498,DU
        21 000330   000354 600000 21                 TZE     s:16250

      873    16212    6                 OR ST2$ -> ST.ID ~= %SWITCH THEN
      874    16213    7                   DO;

      875    16214                           %CONDITIONAL_ERROR (@LX_ITEM$ = R$,
      876    16215                                  @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
      877    16216                                  @LINE = R$ -> LX_ETT_ITEM.LINE,
      878    16217                                  @COLUMN = R$ -> LX_ETT_ITEM.COLUMN);

  16227 21 000331   200070 470500                    LDP0    R$,,AUTO
        21 000332   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:151  
        21 000333   400000 316007                    CANQ    -131072,DL
        21 000334   000375 601000 21                 TNZ     s:16254

  16229 21 000335   200070 236100                    LDQ     R$,,AUTO
        21 000336   000006 036003                    ADLQ    6,DU
        21 000337   200104 756100                    STQ     @CONST$+4,,AUTO
        21 000340   200070 236100                    LDQ     R$,,AUTO
        21 000341   000005 036003                    ADLQ    5,DU
        21 000342   000022 235000 22                 LDA     18
        21 000343   200102 757100                    STAQ    @CONST$+2,,AUTO
        21 000344   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000345   000020 631400 22                 EPPR1   16
        21 000346   000000 701000 xent               TSX1    Z8AE$ERROR
        21 000347   000000 011000                    NOP     0

  16238 21 000350   200070 470500                    LDP0    R$,,AUTO
        21 000351   400000 236007                    LDQ     -131072,DL
        21 000352   000000 256100                    ORSQ    0,,PR0

      879    16247    7                   END;

  16247 21 000353   000375 710000 21                 TRA     s:16254

      880    16248    6                 ELSE
      881    16249    7                   DO;  /* Have a SET mnemonic-name to mnemonic-name */

      882    16250    7                     CALL SET_SWITCH_FROM_SWITCH

  16250 21 000354   000003 236100                    LDQ     3,,PR0
        21 000355   777777 376007                    ANQ     -1,DL
        21 000356   200023 471500                    LDP1    ST$,,AUTO
        21 000357   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000360   100003 236100                    LDQ     3,,PR1
        21 000361   777777 376007                    ANQ     -1,DL
        21 000362   200103 756100                    STQ     @CONST$+3,,AUTO
        21 000363   200102 236100                    LDQ     @CONST$+2,,AUTO
        21 000364   200110 756100                    STQ     @CONST$+8,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:152  
        21 000365   200103 236100                    LDQ     @CONST$+3,,AUTO
        21 000366   200112 756100                    STQ     @CONST$+10,,AUTO
        21 000367   200112 633500                    EPPR3   @CONST$+10,,AUTO
        21 000370   200074 453500                    STP3    IDENT$+1,,AUTO
        21 000371   200110 634500                    EPPR4   @CONST$+8,,AUTO
        21 000372   200073 454500                    STP4    @STATEMENT_TYPE+1,,AUTO
        21 000373   001733 701000 21                 TSX1    SET_SWITCH_FROM_SWITCH
        21 000374   000000 011000                    NOP     0

      883    16251    7                        (BINBIT(ST2$ -> SWITCH.SWITCH#, 36),
      884    16252    7                         BINBIT(ST$ -> SWITCH.SWITCH#, 36));
      885    16253    7                   END;

      886    16254    6                 REC$ = REC$ -> LX_ITEM.LINK;

  16254 21 000375   200067 470500                    LDP0    REC$,,AUTO
        21 000376   000007 236100                    LDQ     7,,PR0
        21 000377   200067 756100                    STQ     REC$,,AUTO

      887    16255    6               END;

  16255 21 000400   000001 116000 22                 CMPQ    1
        21 000401   000267 601000 21                 TNZ     s:16193

      888    16256    5             END;

      889    16257    4           CALL Z8ED$DISPOSE_ABSSYN_TREE (SEND$ -> LX_LIST.HEAD$);

  16257 21 000402   200066 470500                    LDP0    @SEND$,,AUTO
        21 000403   000000 471500                    LDP1    0,,PR0
        21 000404   100004 633500                    EPPR3   4,,PR1
        21 000405   200102 453500                    STP3    @CONST$+2,,AUTO
        21 000406   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000407   000000 631400 22                 EPPR1   0
        21 000410   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        21 000411   000000 011000                    NOP     0
        21 000412   000417 710000 21                 TRA     s:16265
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:153  

      890    16258
      891    16259    4         CASE(ELSE);

      892    16260
      893    16261    4           CALL Z8EX$SET_INDEX(RECEIVE$,

  16261 21 000413   200065 630500                    EPPR0   @RECEIVE$,,AUTO
        21 000414   000014 631400 22                 EPPR1   12
        21 000415   000000 701000 xent               TSX1    Z8EX$SET_INDEX
        21 000416   000000 011000                    NOP     0

      894    16262    4                               SEND$);
      895    16263    4       END;

      896    16264
      897    16265    3     END SET_TO ;

  16265 21 000417   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 000420   000001 702211                    TSX2  ! 1,X1

      898    16266
      899    16267    2     SET_TO_TRUE: PROC (RECEIVE$) ;

  16267 21 000421   200064 741300       SET_TO_TRUE  STX1  ! ASS_VAR+8,,AUTO

      900    16268
      901    16269    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      902    16270    3     DCL  REC$      PTR ;
      903    16271
      904    16272    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;

  16272 21 000422   200065 470500                    LDP0    @RECEIVE$,,AUTO
        21 000423   000000 471500                    LDP1    0,,PR0
        21 000424   100004 236100                    LDQ     4,,PR1
        21 000425   200066 756100                    STQ     REC$,,AUTO

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:154  
      905    16273    4       DO WHILE REC$ ~= ADDR(NIL);

  16273 21 000426   000717 710000 21                 TRA     s:17129

      906    16274
      907    16275              %FISH (TRIAD = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      908    16276                     RTN = ST$);

  16278 21 000427   200066 470500                    LDP0    REC$,,AUTO
        21 000430   000004 471500                    LDP1    4,,PR0
        21 000431   100001 236100                    LDQ     1,,PR1
        21 000432   200023 756100                    STQ     ST$,,AUTO

  16279 21 000433   200023 473500                    LDP3    ST$,,AUTO
        21 000434   300000 220100                    LDX0    0,,PR3
        21 000435   000751 100003                    CMPX0   489,DU
        21 000436   000446 603000 21                 TRC     s:16285

  16280 21 000437   200023 470500                    LDP0    ST$,,AUTO
        21 000440   000001 236100                    LDQ     1,,PR0
        21 000441   200023 756100                    STQ     ST$,,AUTO

  16281 21 000442   200023 470500                    LDP0    ST$,,AUTO
        21 000443   000000 220100                    LDX0    0,,PR0
        21 000444   000751 100003                    CMPX0   489,DU
        21 000445   000437 602000 21                 TNC     s:16280

      909    16284
      910    16285    4         IF ST$ -> ST.ID = %CONDITION THEN

  16285 21 000446   200023 470500                    LDP0    ST$,,AUTO
        21 000447   000000 220100                    LDX0    0,,PR0
        21 000450   000764 100003                    CMPX0   500,DU
        21 000451   000671 601000 21                 TNZ     s:17107

      911    16286    5           DO;

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:155  
      912    16287    6             DO CASE (ST$ -> CONDITION.ASSOC_VAR$ -> ST.ID);

  16287 21 000452   000010 471500                    LDP1    8,,PR0
        21 000453   100000 236100                    LDQ     0,,PR1
        21 000454   000022 772000                    QRL     18
        21 000455   000762 136007                    SBLQ    498,DL
        21 000456   000005 116007                    CMPQ    5,DL
        21 000457   000461 602006 21                 TNC     s:16287+7,QL
        21 000460   000654 710000 21                 TRA     s:17087
        21 000461   000576 710000 21                 TRA     s:16319
        21 000462   000654 710000 21                 TRA     s:17087
        21 000463   000654 710000 21                 TRA     s:17087
        21 000464   000466 710000 21                 TRA     s:16291
        21 000465   000466 710000 21                 TRA     s:16291

      913    16288
      914    16289    6               CASE (%SCALAR, %ARRAY);

      915    16290
      916    16291    6                 IF ST$ -> CONDITION.VALUE_LIST$ = ADDR(NIL)

  16291 21 000466   000005 236100                    LDQ     5,,PR0
        21 000467   000001 116000 22                 CMPQ    1
        21 000470   000473 601000 21                 TNZ     s:16294

      917    16292    6                   THEN RETURN;

  16292 21 000471   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 000472   000001 702211                    TSX2  ! 1,X1

      918    16293
      919    16294    6                 CALL Z8EU$CREATE_IDENTIFIER_FROM_ST (ST$ -> CONDITION.ASSOC_VAR$,

  16294 21 000473   200066 473500                    LDP3    REC$,,AUTO
        21 000474   300004 474500                    LDP4    4,,PR3
        21 000475   200054 635500                    EPPR5   ASS_VAR,,AUTO
        21 000476   200102 455500                    STP5    @CONST$+2,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:156  
        21 000477   400006 631500                    EPPR1   6,,PR4
        21 000500   200107 451500                    STP1    @CONST$+7,,AUTO
        21 000501   400005 636500                    EPPR6   5,,PR4
        21 000502   200106 456500                    STP6    @CONST$+6,,AUTO
        21 000503   200102 634500                    EPPR4   @CONST$+2,,AUTO
        21 000504   200105 454500                    STP4    @CONST$+5,,AUTO
        21 000505   200023 236100                    LDQ     ST$,,AUTO
        21 000506   000010 036003                    ADLQ    8,DU
        21 000507   200104 756100                    STQ     @CONST$+4,,AUTO
        21 000510   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000511   000002 631400 22                 EPPR1   2
        21 000512   000000 701000 xent               TSX1    Z8EU$CREATE_IDENTIFIER_FROM_ST
        21 000513   000000 011000                    NOP     0

      920    16295    6                                                      ADDR(ASS_VAR),
      921    16296    6                                                      REC$ -> LX_LIST.HEAD$ ->
             16296                                                               LX_ETT_ITEM.LINE,
      922    16297    6                                                      REC$ -> LX_LIST.HEAD$ ->
             16297                                                               LX_ETT_ITEM.COLUMN);
      923    16298    6                 IF REC$ -> LX_LIST.COUNT > 1 THEN

  16298 21 000514   200066 470500                    LDP0    REC$,,AUTO
        21 000515   000002 235100                    LDA     2,,PR0
        21 000516   000001 115007                    CMPA    1,DL
        21 000517   000533 604400 21                 TMOZ    s:16303

      924    16299    6                   CALL Z8EY$SUBSCRIPT (REC$ -> LX_LIST.TAIL$,

  16299 21 000520   200054 631500                    EPPR1   ASS_VAR,,AUTO
        21 000521   200102 451500                    STP1    @CONST$+2,,AUTO
        21 000522   200102 633500                    EPPR3   @CONST$+2,,AUTO
        21 000523   200105 453500                    STP3    @CONST$+5,,AUTO
        21 000524   200066 236100                    LDQ     REC$,,AUTO
        21 000525   000001 036003                    ADLQ    1,DU
        21 000526   200104 756100                    STQ     @CONST$+4,,AUTO
        21 000527   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000530   000014 631400 22                 EPPR1   12
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:157  
        21 000531   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 000532   000000 011000                    NOP     0

      925    16300    6                                        ADDR(ASS_VAR));
      926    16301
      927    16302                      /* swap line & column for possible error message */
      928    16303    6                 T$ = ST$ -> CONDITION.VALUE_LIST$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;

  16303 21 000533   200023 470500                    LDP0    ST$,,AUTO
        21 000534   000005 471500                    LDP1    5,,PR0
        21 000535   100004 473500                    LDP3    4,,PR1
        21 000536   300004 236100                    LDQ     4,,PR3
        21 000537   200016 756100                    STQ     T$,,AUTO

      929    16304    6                 ORIG_LINE# = T$ -> LX_ITEM.LINE;

  16304 21 000540   200016 474500                    LDP4    T$,,AUTO
        21 000541   400005 235100                    LDA     5,,PR4
        21 000542   200017 755100                    STA     ORIG_LINE#,,AUTO

      930    16305    6                 ORIG_COLUMN# = T$ -> LX_ITEM.COLUMN;

  16305 21 000543   400006 235100                    LDA     6,,PR4
        21 000544   200020 755100                    STA     ORIG_COLUMN#,,AUTO

      931    16306    6                 T$ -> LX_ITEM.LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE;

  16306 21 000545   200066 475500                    LDP5    REC$,,AUTO
        21 000546   500004 476500                    LDP6    4,,PR5
        21 000547   600005 235100                    LDA     5,,PR6
        21 000550   400005 755100                    STA     5,,PR4

      932    16307    6                 T$ -> LX_ITEM.COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN;

  16307 21 000551   500004 471500                    LDP1    4,,PR5
        21 000552   100006 235100                    LDA     6,,PR1
        21 000553   400006 755100                    STA     6,,PR4
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:158  

      933    16308
      934    16309    6                 CALL Z8E7$RESTRICTED_MOVE (ADDR(ASS_VAR),

  16309 21 000554   000005 471500                    LDP1    5,,PR0
        21 000555   100004 473500                    LDP3    4,,PR1
        21 000556   200054 636500                    EPPR6   ASS_VAR,,AUTO
        21 000557   200102 456500                    STP6    @CONST$+2,,AUTO
        21 000560   300004 631500                    EPPR1   4,,PR3
        21 000561   200105 451500                    STP1    @CONST$+5,,AUTO
        21 000562   200102 633500                    EPPR3   @CONST$+2,,AUTO
        21 000563   200104 453500                    STP3    @CONST$+4,,AUTO
        21 000564   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000565   000014 631400 22                 EPPR1   12
        21 000566   000000 701000 xent               TSX1    Z8E7$RESTRICTED_MOVE
        21 000567   000000 011000                    NOP     0

      935    16310    6                                 ST$ -> CONDITION.VALUE_LIST$ -> LX_LIST.HEAD$
      936    16311    6                                               -> LX_LIST.HEAD$);
      937    16312
      938    16313                      /* restore line & column to original value is clause */
      939    16314    6                 T$ -> LX_ITEM.LINE = ORIG_LINE#;

  16314 21 000570   200017 235100                    LDA     ORIG_LINE#,,AUTO
        21 000571   200016 470500                    LDP0    T$,,AUTO
        21 000572   000005 755100                    STA     5,,PR0

      940    16315    6                 T$ -> LX_ITEM.COLUMN = ORIG_COLUMN#;

  16315 21 000573   200020 236100                    LDQ     ORIG_COLUMN#,,AUTO
        21 000574   000006 756100                    STQ     6,,PR0
        21 000575   000714 710000 21                 TRA     s:17128

      941    16316
      942    16317    6               CASE(%SWITCH);

      943    16318
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:159  
      944    16319    6                CALL CREATE_SWITCH_TRIAD (BINBIT(ST$ -> CONDITION.ASSOC_VAR$ -> SWITCH
             16319                          .SWITCH#, 36),

  16319 21 000576   100003 236100                    LDQ     3,,PR1
        21 000577   777777 376007                    ANQ     -1,DL
        21 000600   200114 756100                    STQ     @CONST$+12,,AUTO
        21 000601   200025 631500                    EPPR1   CONST$,,AUTO
        21 000602   200100 451500                    STP1    @SW#+1,,AUTO
        21 000603   200114 633500                    EPPR3   @CONST$+12,,AUTO
        21 000604   200077 453500                    STP3    R$+2,,AUTO
        21 000605   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 000606   000000 011000                    NOP     0

      945    16320    6                                           CONST$);
      946    16321
      947    16322    6                 IF ST$ -> CONDITION.ASSOC_VAR$ -> SWITCH.ON$ = ST$ THEN

  16322 21 000607   200023 470500                    LDP0    ST$,,AUTO
        21 000610   000010 471500                    LDP1    8,,PR0
        21 000611   100005 236100                    LDQ     5,,PR1
        21 000612   200023 116100                    CMPQ    ST$,,AUTO
        21 000613   000634 601000 21                 TNZ     s:17029

      948    16323                        %NEW_ILL (@ID = %ON_SWITCH,
      949    16324                                  @LOP = CONST$);

  16648 21 000614   000007 236000 22                 LDQ     7
        21 000615   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000616   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 000617   200107 451500                    STP1    @CONST$+7,,AUTO
        21 000620   000010 236000 22                 LDQ     8
        21 000621   200106 756100                    STQ     @CONST$+6,,AUTO
        21 000622   000024 237000 22                 LDAQ    20
        21 000623   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 000624   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000625   000002 631400 22                 EPPR1   2
        21 000626   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:160  
        21 000627   000000 011000                    NOP     0

  16654 21 000630   200025 236100                    LDQ     CONST$,,AUTO
        21 000631   000000 470400 16                 LDP0    ILL$
        21 000632   000001 756100                    STQ     1,,PR0

  16673 21 000633   000714 710000 21                 TRA     s:17128

      950    16703    6                 ELSE
      951    16704                        %NEW_ILL (@ID = %OFF_SWITCH,
      952    16705                                  @LOP = CONST$);

  17029 21 000634   000007 236000 22                 LDQ     7
        21 000635   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000636   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 000637   200107 451500                    STP1    @CONST$+7,,AUTO
        21 000640   000010 236000 22                 LDQ     8
        21 000641   200106 756100                    STQ     @CONST$+6,,AUTO
        21 000642   000030 237000 22                 LDAQ    24
        21 000643   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 000644   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 000645   000002 631400 22                 EPPR1   2
        21 000646   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 000647   000000 011000                    NOP     0

  17035 21 000650   200025 236100                    LDQ     CONST$,,AUTO
        21 000651   000000 470400 16                 LDP0    ILL$
        21 000652   000001 756100                    STQ     1,,PR0

  17054 21 000653   000714 710000 21                 TRA     s:17128

      953    17084
      954    17085    6               CASE (ELSE);

      955    17086
      956    17087    6                 CALL Z8AE$ERROR (%E$CONDITION_NAME_EXPECTED,

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:161  
  17087 21 000654   200066 473500                    LDP3    REC$,,AUTO
        21 000655   300004 474500                    LDP4    4,,PR3
        21 000656   400006 635500                    EPPR5   6,,PR4
        21 000657   200104 455500                    STP5    @CONST$+4,,AUTO
        21 000660   400005 631500                    EPPR1   5,,PR4
        21 000661   200103 451500                    STP1    @CONST$+3,,AUTO
        21 000662   000032 236000 22                 LDQ     26
        21 000663   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000664   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000665   000020 631400 22                 EPPR1   16
        21 000666   000000 701000 xent               TSX1    Z8AE$ERROR
        21 000667   000000 011000                    NOP     0

      957    17088    6                                  REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      958    17089    6                                  REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);
      959    17090
      960    17091    6             END;

      961    17092    5           END;

  17092 21 000670   000714 710000 21                 TRA     s:17128

      962    17093    4         ELSE
      963    17094                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
      964    17095                                    @ERROR# = %E$CONDITION_NAME_EXPECTED,
      965    17096                                    @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      966    17097                                    @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  17107 21 000671   200066 471500                    LDP1    REC$,,AUTO
        21 000672   100004 473500                    LDP3    4,,PR1
        21 000673   300000 236100                    LDQ     0,,PR3
        21 000674   400000 316007                    CANQ    -131072,DL
        21 000675   000714 601000 21                 TNZ     s:17128

  17109 21 000676   300006 634500                    EPPR4   6,,PR3
        21 000677   200104 454500                    STP4    @CONST$+4,,AUTO
        21 000700   300005 635500                    EPPR5   5,,PR3
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:162  
        21 000701   200103 455500                    STP5    @CONST$+3,,AUTO
        21 000702   000032 236000 22                 LDQ     26
        21 000703   200102 756100                    STQ     @CONST$+2,,AUTO
        21 000704   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 000705   000020 631400 22                 EPPR1   16
        21 000706   000000 701000 xent               TSX1    Z8AE$ERROR
        21 000707   000000 011000                    NOP     0

  17118 21 000710   200066 470500                    LDP0    REC$,,AUTO
        21 000711   000004 471500                    LDP1    4,,PR0
        21 000712   400000 236007                    LDQ     -131072,DL
        21 000713   100000 256100                    ORSQ    0,,PR1

      967    17127
      968    17128    4         REC$ = REC$ -> LX_ITEM.LINK;

  17128 21 000714   200066 470500                    LDP0    REC$,,AUTO
        21 000715   000007 236100                    LDQ     7,,PR0
        21 000716   200066 756100                    STQ     REC$,,AUTO

      969    17129    4       END;

  17129 21 000717   000001 116000 22                 CMPQ    1
        21 000720   000427 601000 21                 TNZ     s:16278

      970    17130
      971    17131    3     END SET_TO_TRUE ;

  17131 21 000721   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 000722   000001 702211                    TSX2  ! 1,X1

      972    17132
      973    17133
      974    17134    2     SET_TO_SWITCH: PROC (RECEIVE$, SEND$) ;

  17134 21 000723   200064 741300       SET_TO_SWIT* STX1  ! ASS_VAR+8,,AUTO

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:163  
      975    17135
      976    17136    3     DCL  RECEIVE$  PTR ; /* LX_LIST */
      977    17137    3     DCL  SEND$     PTR ; /* mnemonic switch, id, or literal */
      978    17138    3     DCL  REC$      PTR ;
      979    17139
      980    17140    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;

  17140 21 000724   200065 470500                    LDP0    @RECEIVE$,,AUTO
        21 000725   000000 471500                    LDP1    0,,PR0
        21 000726   100004 236100                    LDQ     4,,PR1
        21 000727   200067 756100                    STQ     REC$,,AUTO

      981    17141    4       DO WHILE REC$ ~= ADDR(NIL);

  17141 21 000730   001027 710000 21                 TRA     s:17196

      982    17142
      983    17143    4         CALL CHARBIN(SW#,

  17143 21 000731   200066 470500                    LDP0    @SEND$,,AUTO
        21 000732   000000 471500                    LDP1    0,,PR0
        21 000733   100002 473500                    LDP3    2,,PR1
        21 000734   300004 220100                    LDX0    4,,PR3
        21 000735   777771 621010                    EAX1    -7,X0
        21 000736   000100 305540                    DTB
        21 000737   300006 230011                    NDSC9   6,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
        21 000740   200030 000004                    NDSC9   SW#,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      984    17144    4                      SUBSTR(SEND$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME,
      985    17145    4                             7));
      986    17146
      987    17147              %FISH (TRIAD = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
      988    17148                     RTN = ST$);

  17150 21 000741   200067 471500                    LDP1    REC$,,AUTO
        21 000742   100004 473500                    LDP3    4,,PR1
        21 000743   300001 236100                    LDQ     1,,PR3
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:164  
        21 000744   200023 756100                    STQ     ST$,,AUTO

  17151 21 000745   200023 474500                    LDP4    ST$,,AUTO
        21 000746   400000 220100                    LDX0    0,,PR4
        21 000747   000751 100003                    CMPX0   489,DU
        21 000750   000760 603000 21                 TRC     s:17157

  17152 21 000751   200023 470500                    LDP0    ST$,,AUTO
        21 000752   000001 236100                    LDQ     1,,PR0
        21 000753   200023 756100                    STQ     ST$,,AUTO

  17153 21 000754   200023 470500                    LDP0    ST$,,AUTO
        21 000755   000000 220100                    LDX0    0,,PR0
        21 000756   000751 100003                    CMPX0   489,DU
        21 000757   000751 602000 21                 TNC     s:17152

      989    17156
      990    17157    4         IF REC$ -> LX_LIST.COUNT > 1

  17157 21 000760   200067 470500                    LDP0    REC$,,AUTO
        21 000761   000002 235100                    LDA     2,,PR0
        21 000762   000001 115007                    CMPA    1,DL
        21 000763   000770 605400 21                 TPNZ    s:17172
        21 000764   200023 471500                    LDP1    ST$,,AUTO
        21 000765   100000 220100                    LDX0    0,,PR1
        21 000766   000762 100003                    CMPX0   498,DU
        21 000767   001013 600000 21                 TZE     s:17193

      991    17158    4              OR ST$ -> ST.ID ~= %SWITCH THEN
      992    17159                %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
      993    17160                                    @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
      994    17161                                    @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
      995    17162                                    @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  17172 21 000770   000004 471500                    LDP1    4,,PR0
        21 000771   100000 236100                    LDQ     0,,PR1
        21 000772   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:165  
        21 000773   001024 601000 21                 TNZ     s:17195

  17174 21 000774   100006 633500                    EPPR3   6,,PR1
        21 000775   200104 453500                    STP3    @CONST$+4,,AUTO
        21 000776   100005 634500                    EPPR4   5,,PR1
        21 000777   200103 454500                    STP4    @CONST$+3,,AUTO
        21 001000   000022 236000 22                 LDQ     18
        21 001001   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001002   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001003   000020 631400 22                 EPPR1   16
        21 001004   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001005   000000 011000                    NOP     0

  17183 21 001006   200067 470500                    LDP0    REC$,,AUTO
        21 001007   000004 471500                    LDP1    4,,PR0
        21 001010   400000 236007                    LDQ     -131072,DL
        21 001011   100000 256100                    ORSQ    0,,PR1

  17190 21 001012   001024 710000 21                 TRA     s:17195

      996    17192    4         ELSE
      997    17193    4           CALL SET_SWITCH_FROM_SWITCH (BINBIT(ST$ -> SWITCH.SWITCH#, 36),

  17193 21 001013   100003 236100                    LDQ     3,,PR1
        21 001014   777777 376007                    ANQ     -1,DL
        21 001015   200116 756100                    STQ     @CONST$+14,,AUTO
        21 001016   200030 633500                    EPPR3   SW#,,AUTO
        21 001017   200074 453500                    STP3    IDENT$+1,,AUTO
        21 001020   200116 634500                    EPPR4   @CONST$+14,,AUTO
        21 001021   200073 454500                    STP4    @STATEMENT_TYPE+1,,AUTO
        21 001022   001733 701000 21                 TSX1    SET_SWITCH_FROM_SWITCH
        21 001023   000000 011000                    NOP     0

      998    17194    4                                        SW#);
      999    17195    4         REC$ = REC$ -> LX_ITEM.LINK;

  17195 21 001024   200067 470500                    LDP0    REC$,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:166  
        21 001025   000007 236100                    LDQ     7,,PR0
        21 001026   200067 756100                    STQ     REC$,,AUTO

     1000    17196    4       END;

  17196 21 001027   000001 116000 22                 CMPQ    1
        21 001030   000731 601000 21                 TNZ     s:17143

     1001    17197
     1002    17198    3     END SET_TO_SWITCH ;

  17198 21 001031   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 001032   000001 702211                    TSX2  ! 1,X1

     1003    17199
     1004    17200
     1005    17201    2     SET_SWITCH_TO: PROC (RECEIVE$, SEND$) ; /* SET SWITCH ... TO ___ */

  17201 21 001033   200064 741300       SET_SWITCH_* STX1  ! ASS_VAR+8,,AUTO

     1006    17202
     1007    17203    3     DCL  RECEIVE$  PTR ; /* LX_LIST of switches */
     1008    17204    3     DCL  SEND$     PTR ; /* LX_TERMINAL, LX_ETT_ITEM */
     1009    17205    3     DCL  REC$      PTR ;
     1010    17206    3     DCL  S$        PTR ;
     1011    17207
     1012    17208    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$ ;

  17208 21 001034   200065 470500                    LDP0    @RECEIVE$,,AUTO
        21 001035   000000 471500                    LDP1    0,,PR0
        21 001036   100004 236100                    LDQ     4,,PR1
        21 001037   200067 756100                    STQ     REC$,,AUTO

     1013    17209    4       DO WHILE (REC$ ~= ADDR(NIL)) ;

  17209 21 001040   001327 710000 21                 TRA     s:18134

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:167  
     1014    17210
     1015    17211    5         IF REC$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;

  17211 21 001041   200067 470500                    LDP0    REC$,,AUTO
        21 001042   000000 220100                    LDX0    0,,PR0
        21 001043   001256 601000 21                 TNZ     s:18065

     1016    17212
     1017    17213    5           CALL CHARBIN (SW#,

  17213 21 001044   000002 471500                    LDP1    2,,PR0
        21 001045   100004 221100                    LDX1    4,,PR1
        21 001046   777771 622011                    EAX2    -7,X1
        21 001047   000100 305540                    DTB
        21 001050   100006 230012                    NDSC9   6,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
        21 001051   200030 000004                    NDSC9   SW#,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     1018    17214    5                         SUBSTR (REC$ -> LX_TERMINAL.DNT$
     1019    17215    5                                            -> DNT.TEXT.NAME,
     1020    17216    5                                 7));
     1021    17217
     1022    17218    6           DO CASE(SEND$ -> LX_ITEM.ID);

  17218 21 001052   200066 471500                    LDP1    @SEND$,,AUTO
        21 001053   100000 473500                    LDP3    0,,PR1
        21 001054   300000 220100                    LDX0    0,,PR3
        21 001055   000005 100003                    CMPX0   5,DU
        21 001056   001060 602010 21                 TNC     s:17218+6,X0
        21 001057   001324 710000 21                 TRA     s:18133
        21 001060   001065 710000 21                 TRA     s:17222
        21 001061   001255 710000 21                 TRA     s:18063
        21 001062   001170 710000 21                 TRA     s:18008
        21 001063   001255 710000 21                 TRA     s:18063
        21 001064   001170 710000 21                 TRA     s:18008

     1023    17219
     1024    17220    6             CASE(%LX_TERMINAL);
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:168  

     1025    17221
     1026    17222    7               DO SELECT(SEND$ -> LX_TERMINAL.SYMBOL);

  17222 21 001065   300003 236100                    LDQ     3,,PR3
        21 001066   000475 116007                    CMPQ    317,DL
        21 001067   001074 604000 21                 TMI     s:17222+7
        21 001070   001077 600000 21                 TZE     s:17226
        21 001071   000675 116007                    CMPQ    445,DL
        21 001072   001324 601000 21                 TNZ     s:18133
        21 001073   001153 710000 21                 TRA     s:17996
        21 001074   000473 116007                    CMPQ    315,DL
        21 001075   001324 601000 21                 TNZ     s:18133
        21 001076   001125 710000 21                 TRA     s:17611

     1027    17223
     1028    17224    7                 SELECT(%RSV_WRD_ON);

     1029    17225
     1030    17226    7                   CALL CREATE_SWITCH_TRIAD (SW#, CONST$);

  17226 21 001077   200025 634500                    EPPR4   CONST$,,AUTO
        21 001100   200100 454500                    STP4    @SW#+1,,AUTO
        21 001101   200030 633500                    EPPR3   SW#,,AUTO
        21 001102   200077 453500                    STP3    R$+2,,AUTO
        21 001103   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 001104   000000 011000                    NOP     0

     1031    17227
     1032    17228                        %NEW_ILL (@ID = %ON_SWITCH,
     1033    17229                                  @LOP = CONST$);

  17553 21 001105   000007 236000 22                 LDQ     7
        21 001106   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001107   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001110   200107 450500                    STP0    @CONST$+7,,AUTO
        21 001111   000010 236000 22                 LDQ     8
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:169  
        21 001112   200106 756100                    STQ     @CONST$+6,,AUTO
        21 001113   000024 237000 22                 LDAQ    20
        21 001114   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001115   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 001116   000002 631400 22                 EPPR1   2
        21 001117   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001120   000000 011000                    NOP     0

  17559 21 001121   200025 236100                    LDQ     CONST$,,AUTO
        21 001122   000000 470400 16                 LDP0    ILL$
        21 001123   000001 756100                    STQ     1,,PR0

  17578 21 001124   001324 710000 21                 TRA     s:18133

     1034    17608
     1035    17609    7                 SELECT(%RSV_WRD_OFF);

     1036    17610
     1037    17611    7                   CALL CREATE_SWITCH_TRIAD (SW#, CONST$);

  17611 21 001125   200025 634500                    EPPR4   CONST$,,AUTO
        21 001126   200100 454500                    STP4    @SW#+1,,AUTO
        21 001127   200030 633500                    EPPR3   SW#,,AUTO
        21 001130   200077 453500                    STP3    R$+2,,AUTO
        21 001131   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 001132   000000 011000                    NOP     0

     1038    17612
     1039    17613                        %NEW_ILL (@ID = %OFF_SWITCH,
     1040    17614                                  @LOP = CONST$);

  17938 21 001133   000007 236000 22                 LDQ     7
        21 001134   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001135   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001136   200107 450500                    STP0    @CONST$+7,,AUTO
        21 001137   000010 236000 22                 LDQ     8
        21 001140   200106 756100                    STQ     @CONST$+6,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:170  
        21 001141   000030 237000 22                 LDAQ    24
        21 001142   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001143   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 001144   000002 631400 22                 EPPR1   2
        21 001145   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001146   000000 011000                    NOP     0

  17944 21 001147   200025 236100                    LDQ     CONST$,,AUTO
        21 001150   000000 470400 16                 LDP0    ILL$
        21 001151   000001 756100                    STQ     1,,PR0

  17963 21 001152   001324 710000 21                 TRA     s:18133

     1041    17993
     1042    17994    7                 SELECT(%RSV_WRD_SWITCH);

     1043    17995
     1044    17996    7                   CALL CHARBIN(SW2#,

  17996 21 001153   300002 474500                    LDP4    2,,PR3
        21 001154   400004 221100                    LDX1    4,,PR4
        21 001155   777771 622011                    EAX2    -7,X1
        21 001156   000100 305540                    DTB
        21 001157   400006 230012                    NDSC9   6,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        21 001160   200031 000004                    NDSC9   SW2#,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     1045    17997    7                                SUBSTR(SEND$ -> LX_TERMINAL.DNT$
     1046    17998    7                                              -> DNT.TEXT.NAME,
     1047    17999    7                                       7));
     1048    18000
     1049    18001    7                   CALL SET_SWITCH_FROM_SWITCH (SW#,

  18001 21 001161   200031 633500                    EPPR3   SW2#,,AUTO
        21 001162   200074 453500                    STP3    IDENT$+1,,AUTO
        21 001163   200030 634500                    EPPR4   SW#,,AUTO
        21 001164   200073 454500                    STP4    @STATEMENT_TYPE+1,,AUTO
        21 001165   001733 701000 21                 TSX1    SET_SWITCH_FROM_SWITCH
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:171  
        21 001166   000000 011000                    NOP     0

     1050    18002    7                                                SW2#);
     1051    18003
     1052    18004    7               END;

  18004 21 001167   001324 710000 21                 TRA     s:18133

     1053    18005
     1054    18006    6             CASE(%LX_ETT_ITEM, %LX_LIST);

     1055    18007
     1056    18008    6               IF SEND$ -> LX_ITEM.ID = %LX_LIST THEN

  18008 21 001170   000002 100003                    CMPX0   2,DU
        21 001171   001175 601000 21                 TNZ     s:18011

     1057    18009    6                 S$ = SEND$ -> LX_LIST.HEAD$ ;

  18009 21 001172   300004 236100                    LDQ     4,,PR3
        21 001173   200070 756100                    STQ     S$,,AUTO
        21 001174   001177 710000 21                 TRA     s:18016

     1058    18010    6               ELSE
     1059    18011    6                 S$ = SEND$ ;

  18011 21 001175   100000 236100                    LDQ     0,,PR1
        21 001176   200070 756100                    STQ     S$,,AUTO

     1060    18012
     1061    18013                    %FISH (TRIAD = S$ -> LX_ETT_ITEM.ETT$,
     1062    18014                           RTN = ST$);

  18016 21 001177   200070 474500                    LDP4    S$,,AUTO
        21 001200   400001 236100                    LDQ     1,,PR4
        21 001201   200023 756100                    STQ     ST$,,AUTO

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:172  
  18017 21 001202   200023 475500                    LDP5    ST$,,AUTO
        21 001203   500000 221100                    LDX1    0,,PR5
        21 001204   000751 101003                    CMPX1   489,DU
        21 001205   001215 603000 21                 TRC     s:18023

  18018 21 001206   200023 470500                    LDP0    ST$,,AUTO
        21 001207   000001 236100                    LDQ     1,,PR0
        21 001210   200023 756100                    STQ     ST$,,AUTO

  18019 21 001211   200023 470500                    LDP0    ST$,,AUTO
        21 001212   000000 220100                    LDX0    0,,PR0
        21 001213   000751 100003                    CMPX0   489,DU
        21 001214   001206 602000 21                 TNC     s:18018

     1063    18022
     1064    18023    6               IF ST$ -> ST.ID = %SWITCH THEN

  18023 21 001215   200023 470500                    LDP0    ST$,,AUTO
        21 001216   000000 220100                    LDX0    0,,PR0
        21 001217   000762 100003                    CMPX0   498,DU
        21 001220   001233 601000 21                 TNZ     s:18040

     1065    18024    6                  CALL SET_SWITCH_FROM_SWITCH (SW#,

  18024 21 001221   000003 236100                    LDQ     3,,PR0
        21 001222   777777 376007                    ANQ     -1,DL
        21 001223   200120 756100                    STQ     @CONST$+16,,AUTO
        21 001224   200120 631500                    EPPR1   @CONST$+16,,AUTO
        21 001225   200074 451500                    STP1    IDENT$+1,,AUTO
        21 001226   200030 633500                    EPPR3   SW#,,AUTO
        21 001227   200073 453500                    STP3    @STATEMENT_TYPE+1,,AUTO
        21 001230   001733 701000 21                 TSX1    SET_SWITCH_FROM_SWITCH
        21 001231   000000 011000                    NOP     0
        21 001232   001324 710000 21                 TRA     s:18133

     1066    18025    6                           BINBIT(ST$ -> SWITCH.SWITCH#, 36));
     1067    18026    6               ELSE
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:173  
     1068    18027                      %CONDITIONAL_ERROR (@LX_ITEM$ = S$,
     1069    18028                                @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
     1070    18029                                @LINE = S$ -> LX_ETT_ITEM.LINE,
     1071    18030                                @COLUMN = S$ -> LX_ETT_ITEM.COLUMN);

  18040 21 001233   200070 471500                    LDP1    S$,,AUTO
        21 001234   100000 236100                    LDQ     0,,PR1
        21 001235   400000 316007                    CANQ    -131072,DL
        21 001236   001324 601000 21                 TNZ     s:18133

  18042 21 001237   200070 236100                    LDQ     S$,,AUTO
        21 001240   000006 036003                    ADLQ    6,DU
        21 001241   200104 756100                    STQ     @CONST$+4,,AUTO
        21 001242   200070 236100                    LDQ     S$,,AUTO
        21 001243   000005 036003                    ADLQ    5,DU
        21 001244   000022 235000 22                 LDA     18
        21 001245   200102 757100                    STAQ    @CONST$+2,,AUTO
        21 001246   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001247   000020 631400 22                 EPPR1   16
        21 001250   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001251   000000 011000                    NOP     0

  18051 21 001252   200070 470500                    LDP0    S$,,AUTO
        21 001253   400000 236007                    LDQ     -131072,DL
        21 001254   000000 256100                    ORSQ    0,,PR0

     1072    18060
     1073    18061    6           END; /* Do case ID of TAIL of REC */

     1074    18062
     1075    18063    5         END ; /* REC$ is an LX_TERMINAL (SWITCH) */

  18063 21 001255   001324 710000 21                 TRA     s:18133

     1076    18064    4         ELSE
     1077    18065    4           IF REC$ -> LX_ITEM.ID = %LX_LIST THEN

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:174  
  18065 21 001256   000002 100003                    CMPX0   2,DU
        21 001257   001303 601000 21                 TNZ     s:18113

     1078    18066                  %CONDITIONAL_ERROR (@LX_ITEM$ = REC$ -> LX_LIST.HEAD$,
     1079    18067                            @ERROR# = %E$SWITCH_EXPECTED,
     1080    18068                            @LINE = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1081    18069                            @COLUMN = REC$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  18079 21 001260   000004 471500                    LDP1    4,,PR0
        21 001261   100000 236100                    LDQ     0,,PR1
        21 001262   400000 316007                    CANQ    -131072,DL
        21 001263   001324 601000 21                 TNZ     s:18133

  18081 21 001264   100006 633500                    EPPR3   6,,PR1
        21 001265   200104 453500                    STP3    @CONST$+4,,AUTO
        21 001266   100005 634500                    EPPR4   5,,PR1
        21 001267   200103 454500                    STP4    @CONST$+3,,AUTO
        21 001270   000034 236000 22                 LDQ     28
        21 001271   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001272   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001273   000020 631400 22                 EPPR1   16
        21 001274   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001275   000000 011000                    NOP     0

  18090 21 001276   200067 470500                    LDP0    REC$,,AUTO
        21 001277   000004 471500                    LDP1    4,,PR0
        21 001300   400000 236007                    LDQ     -131072,DL
        21 001301   100000 256100                    ORSQ    0,,PR1

  18097 21 001302   001324 710000 21                 TRA     s:18133

     1082    18099    4           ELSE
     1083    18100                  %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
     1084    18101                            @ERROR# = %E$SWITCH_EXPECTED,
     1085    18102                            @LINE = REC$ -> LX_ETT_ITEM.LINE,
     1086    18103                            @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:175  
  18113 21 001303   000000 236100                    LDQ     0,,PR0
        21 001304   400000 316007                    CANQ    -131072,DL
        21 001305   001324 601000 21                 TNZ     s:18133

  18115 21 001306   200067 236100                    LDQ     REC$,,AUTO
        21 001307   000006 036003                    ADLQ    6,DU
        21 001310   200104 756100                    STQ     @CONST$+4,,AUTO
        21 001311   200067 236100                    LDQ     REC$,,AUTO
        21 001312   000005 036003                    ADLQ    5,DU
        21 001313   000034 235000 22                 LDA     28
        21 001314   200102 757100                    STAQ    @CONST$+2,,AUTO
        21 001315   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001316   000020 631400 22                 EPPR1   16
        21 001317   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001320   000000 011000                    NOP     0

  18124 21 001321   200067 470500                    LDP0    REC$,,AUTO
        21 001322   400000 236007                    LDQ     -131072,DL
        21 001323   000000 256100                    ORSQ    0,,PR0

     1087    18133    4         REC$ = REC$ -> LX_ITEM.LINK ;

  18133 21 001324   200067 470500                    LDP0    REC$,,AUTO
        21 001325   000007 236100                    LDQ     7,,PR0
        21 001326   200067 756100                    STQ     REC$,,AUTO

     1088    18134    4       END ; /* Do while on REC$ */

  18134 21 001327   000001 116000 22                 CMPQ    1
        21 001330   001041 601000 21                 TNZ     s:17211

     1089    18135
     1090    18136    3     END SET_SWITCH_TO ;

  18136 21 001331   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 001332   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:176  
     1091    18137
     1092    18138
     1093    18139    2     CREATE_SWITCH_TRIAD : PROC (SW#, CONST$);

  18139 21 001333   200076 741300       CREATE_SWIT* STX1  ! R$+1,,AUTO

     1094    18140
     1095    18141    3       DCL SW# SBIN WORD;
     1096    18142    3       DCL CONST$ PTR;
     1097    18143
     1098    18144    3       DCL 1 SW_VALUE (0:35) CONSTANT BIT(36)
     1099    18145    3              INIT ('100000000000000000000000000000000000'B,
     1100    18146    3                    '010000000000000000000000000000000000'B,
     1101    18147    3                    '001000000000000000000000000000000000'B,
     1102    18148    3                    '000100000000000000000000000000000000'B,
     1103    18149    3                    '000010000000000000000000000000000000'B,
     1104    18150    3                    '000001000000000000000000000000000000'B,
     1105    18151    3                    '000000100000000000000000000000000000'B,
     1106    18152    3                    '000000010000000000000000000000000000'B,
     1107    18153    3                    '000000001000000000000000000000000000'B,
     1108    18154    3                    '000000000100000000000000000000000000'B,
     1109    18155    3                    '000000000010000000000000000000000000'B,
     1110    18156    3                    '000000000001000000000000000000000000'B,
     1111    18157    3                    '000000000000100000000000000000000000'B,
     1112    18158    3                    '000000000000010000000000000000000000'B,
     1113    18159    3                    '000000000000001000000000000000000000'B,
     1114    18160    3                    '000000000000000100000000000000000000'B,
     1115    18161    3                    '000000000000000010000000000000000000'B,
     1116    18162    3                    '000000000000000001000000000000000000'B,
     1117    18163    3                    '000000000000000000100000000000000000'B,
     1118    18164    3                    '000000000000000000010000000000000000'B,
     1119    18165    3                    '000000000000000000001000000000000000'B,
     1120    18166    3                    '000000000000000000000100000000000000'B,
     1121    18167    3                    '000000000000000000000010000000000000'B,
     1122    18168    3                    '000000000000000000000001000000000000'B,
     1123    18169    3                    '000000000000000000000000100000000000'B,
     1124    18170    3                    '000000000000000000000000010000000000'B,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:177  
     1125    18171    3                    '000000000000000000000000001000000000'B,
     1126    18172    3                    '000000000000000000000000000100000000'B,
     1127    18173    3                    '000000000000000000000000000010000000'B,
     1128    18174    3                    '000000000000000000000000000001000000'B,
     1129    18175    3                    '000000000000000000000000000000100000'B,
     1130    18176    3                    '000000000000000000000000000000010000'B,
     1131    18177    3                    '000000000000000000000000000000001000'B,
     1132    18178    3                    '000000000000000000000000000000000100'B,
     1133    18179    3                    '000000000000000000000000000000000010'B,
     1134    18180    3                    '000000000000000000000000000000000001'B);
     1135    18181
     1136    18182    3       MKCN.CON = BITBIN(SW_VALUE(SW#));

  18182 21 001334   200077 470500                    LDP0    @SW#,,AUTO
        21 001335   000000 720100                    LXL0    0,,PR0
        21 001336   000000 235010 20                 LDA     SW_VALUE,X0
        21 001337   000000 755000 5                  STA     MKCN

     1137    18183    3       CALL Z8AC$MAKE_CONST (CONST$);

  18183 21 001340   200100 630500                    EPPR0   @CONST$,,AUTO
        21 001341   000000 631400 22                 EPPR1   0
        21 001342   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        21 001343   000000 011000                    NOP     0

     1138    18184
     1139    18185    3     END CREATE_SWITCH_TRIAD;

  18185 21 001344   200076 221300                    LDX1  ! R$+1,,AUTO
        21 001345   000001 702211                    TSX2  ! 1,X1

     1140    18186
     1141    18187    2     CHECK_FOR_DML_SET: PROC ALTRET ;

  18187 21 001346   200064 741300       CHECK_FOR_D* STX1  ! ASS_VAR+8,,AUTO

     1142    18188
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:178  
     1143    18189    3       P3$ = REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;

  18189 21 001347   200021 470500                    LDP0    REC$,,AUTO
        21 001350   000004 471500                    LDP1    4,,PR0
        21 001351   100004 236100                    LDQ     4,,PR1
        21 001352   200014 756100                    STQ     P3$,,AUTO

     1144    18190    3       P4$ = REC$ -> LX_LIST.TAIL$ ; /* Sending field */

  18190 21 001353   000001 236100                    LDQ     1,,PR0
        21 001354   200015 756100                    STQ     P4$,,AUTO

     1145    18191
     1146    18192    3       IF P4$-> LX_ITEM.ID = %LX_TERMINAL      THEN

  18192 21 001355   200015 473500                    LDP3    P4$,,AUTO
        21 001356   300000 220100                    LDX0    0,,PR3
        21 001357   001361 601000 21                 TNZ     s:18199

     1147    18193    3           RETURN ; /* Not a DML SET */

  18193 21 001360   000001 702211                    TSX2  ! 1,X1

     1148    18194    3       ELSE
     1149    18195    4         DO;

     1150    18196
     1151    18197                %FISH(TRIAD = P3$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$, RTN = P1$);

  18199 21 001361   200014 474500                    LDP4    P3$,,AUTO
        21 001362   400004 475500                    LDP5    4,,PR4
        21 001363   500001 236100                    LDQ     1,,PR5
        21 001364   200012 756100                    STQ     P1$,,AUTO

  18200 21 001365   200012 476500                    LDP6    P1$,,AUTO
        21 001366   600000 222100                    LDX2    0,,PR6
        21 001367   000751 102003                    CMPX2   489,DU
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:179  
        21 001370   001400 603000 21                 TRC     s:18207

  18201 21 001371   200012 470500                    LDP0    P1$,,AUTO
        21 001372   000001 236100                    LDQ     1,,PR0
        21 001373   200012 756100                    STQ     P1$,,AUTO

  18202 21 001374   200012 470500                    LDP0    P1$,,AUTO
        21 001375   000000 220100                    LDX0    0,,PR0
        21 001376   000751 100003                    CMPX0   489,DU
        21 001377   001371 602000 21                 TNC     s:18201

     1152    18205                %FISH(TRIAD = P4$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$, RTN = P2$);

  18207 21 001400   200015 470500                    LDP0    P4$,,AUTO
        21 001401   000004 471500                    LDP1    4,,PR0
        21 001402   100001 236100                    LDQ     1,,PR1
        21 001403   200013 756100                    STQ     P2$,,AUTO

  18208 21 001404   200013 473500                    LDP3    P2$,,AUTO
        21 001405   300000 220100                    LDX0    0,,PR3
        21 001406   000751 100003                    CMPX0   489,DU
        21 001407   001417 603000 21                 TRC     s:18213

  18209 21 001410   200013 470500                    LDP0    P2$,,AUTO
        21 001411   000001 236100                    LDQ     1,,PR0
        21 001412   200013 756100                    STQ     P2$,,AUTO

  18210 21 001413   200013 470500                    LDP0    P2$,,AUTO
        21 001414   000000 220100                    LDX0    0,,PR0
        21 001415   000751 100003                    CMPX0   489,DU
        21 001416   001410 602000 21                 TNC     s:18209

     1153    18213    4           IF (P1$ -> VARIABLE.B.DML_TYPE = %DATA_BASE_KEY)   OR

  18213 21 001417   200012 470500                    LDP0    P1$,,AUTO
        21 001420   000003 236100                    LDQ     3,,PR0
        21 001421   160000 376007                    ANQ     57344,DL
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:180  
        21 001422   040000 116007                    CMPQ    16384,DL
        21 001423   001443 600000 21                 TZE     s:18225
        21 001424   120000 116007                    CMPQ    40960,DL
        21 001425   001443 600000 21                 TZE     s:18225
        21 001426   200013 471500                    LDP1    P2$,,AUTO
        21 001427   100003 236100                    LDQ     3,,PR1
        21 001430   160000 376007                    ANQ     57344,DL
        21 001431   120000 116007                    CMPQ    40960,DL
        21 001432   001435 600000 21                 TZE     s:18213+14
        21 001433   040000 116007                    CMPQ    16384,DL
        21 001434   001516 601000 21                 TNZ     s:18237
        21 001435   200015 473500                    LDP3    P4$,,AUTO
        21 001436   300004 474500                    LDP4    4,,PR3
        21 001437   400001 475500                    LDP5    1,,PR4
        21 001440   500000 220100                    LDX0    0,,PR5
        21 001441   000175 100003                    CMPX0   125,DU
        21 001442   001516 600000 21                 TZE     s:18237

     1154    18214    4                (P1$ -> VARIABLE.B.DML_TYPE = %DIRECT_REFERENCE)  OR
     1155    18215    4                   ((P2$ -> VARIABLE.B.DML_TYPE = %DIRECT_REFERENCE)  OR
     1156    18216    4                       (P2$ -> VARIABLE.B.DML_TYPE = %DATA_BASE_KEY)) AND
     1157    18217    4                          (P4$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %ADDR
             18217                                    ) THEN
     1158    18218
     1159    18219                /*    A DML SET statment is treated as a MOVE.           */
     1160    18220
     1161    18221    5             DO;

     1162    18222
     1163    18223                 /*  Check for a subscript on the sending item and take care of it here. */
     1164    18224                    /*   Other items will be checked in MOVE.        */
     1165    18225    5               IF P4$ -> LX_LIST.HEAD$ ~= P4$ -> LX_LIST.TAIL$   THEN

  18225 21 001443   200015 471500                    LDP1    P4$,,AUTO
        21 001444   100004 236100                    LDQ     4,,PR1
        21 001445   100001 116100                    CMPQ    1,,PR1
        21 001446   001461 600000 21                 TZE     s:18228
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:181  

     1166    18226    5                 CALL Z8EY$SUBSCRIPT(P4$ -> LX_LIST.TAIL$,

  18226 21 001447   200015 236100                    LDQ     P4$,,AUTO
        21 001450   000004 036003                    ADLQ    4,DU
        21 001451   200103 756100                    STQ     @CONST$+3,,AUTO
        21 001452   200015 236100                    LDQ     P4$,,AUTO
        21 001453   000001 036003                    ADLQ    1,DU
        21 001454   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001455   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001456   000014 631400 22                 EPPR1   12
        21 001457   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 001460   000000 011000                    NOP     0

     1167    18227    5                                     P4$ -> LX_LIST.HEAD$);
     1168    18228    5               CALL MOVE_STATEMENT( KEY_WORD$,

  18228 21 001461   000036 236000 22                 LDQ     30
        21 001462   200072 756100                    STQ     @REC$+1,,AUTO
        21 001463   200021 236100                    LDQ     REC$,,AUTO
        21 001464   000004 036003                    ADLQ    4,DU
        21 001465   200071 756100                    STQ     @SEND$+1,,AUTO
        21 001466   200015 236100                    LDQ     P4$,,AUTO
        21 001467   000004 036003                    ADLQ    4,DU
        21 001470   200070 756100                    STQ     S$,,AUTO
        21 001471   200003 236100                    LDQ     @KEY_WORD$,,AUTO
        21 001472   200067 756100                    STQ     REC$,,AUTO
        21 001473   002707 701000 21                 TSX1    MOVE_STATEMENT
        21 001474   000000 011000                    NOP     0

     1169    18229    5                                    P4$ -> LX_LIST.HEAD$,
     1170    18230    5                                    REC$ -> LX_LIST.HEAD$,
     1171    18231    5                                    %S_TYPE_DML_SET);
     1172    18232    5               CALL Z8ED$DISPOSE_ABSSYN_TREE(REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$);

  18232 21 001475   200021 470500                    LDP0    REC$,,AUTO
        21 001476   000004 471500                    LDP1    4,,PR0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:182  
        21 001477   100004 633500                    EPPR3   4,,PR1
        21 001500   200102 453500                    STP3    @CONST$+2,,AUTO
        21 001501   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001502   000000 631400 22                 EPPR1   0
        21 001503   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        21 001504   000000 011000                    NOP     0

     1173    18233    5               CALL Z8ED$DISPOSE_ABSSYN_TREE(P4$ -> LX_LIST.HEAD$);

  18233 21 001505   200015 236100                    LDQ     P4$,,AUTO
        21 001506   000004 036003                    ADLQ    4,DU
        21 001507   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001510   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001511   000000 631400 22                 EPPR1   0
        21 001512   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        21 001513   000000 011000                    NOP     0

     1174    18234    5               ALTRETURN ;

  18234 21 001514   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 001515   000000 702211                    TSX2  ! 0,X1

     1175    18235    5             END;
     1176    18236    4           ELSE
     1177    18237    4               RETURN ; /* Not a DML SET */

  18237 21 001516   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 001517   000001 702211                    TSX2  ! 1,X1

     1178    18238    4       END;
     1179    18239
     1180    18240    3     END CHECK_FOR_DML_SET ;
     1181    18241
     1182    18242
     1183    18243    2     SET_ON_OR_OFF: PROC (RECEIVE$, ON_OR_OFF) ;

  18243 21 001520   200064 741300       SET_ON_OR_O* STX1  ! ASS_VAR+8,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:183  

     1184    18244
     1185    18245    3     DCL  RECEIVE$  PTR ;  /* mnemonic-name or SWITCH-nn */
     1186    18246    3     DCL  ON_OR_OFF SBIN ; /* %ON_SWITCH or %OFF_SWITCH   */
     1187    18247
     1188    18248    4       IF RECEIVE$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;

  18248 21 001521   200065 470500                    LDP0    @RECEIVE$,,AUTO
        21 001522   000000 471500                    LDP1    0,,PR0
        21 001523   100000 220100                    LDX0    0,,PR1
        21 001524   001605 601000 21                 TNZ     s:19024

     1189    18249
     1190    18250              /* SET SWITCH-nn TO ON (or OFF) */
     1191    18251
     1192    18252    4         CALL CHARBIN (SW#, SUBSTR (RECEIVE$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME, 7))
             18252                  ;

  18252 21 001525   100002 473500                    LDP3    2,,PR1
        21 001526   300004 222100                    LDX2    4,,PR3
        21 001527   777771 623012                    EAX3    -7,X2
        21 001530   000100 305540                    DTB
        21 001531   300006 230013                    NDSC9   6,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
        21 001532   200030 000004                    NDSC9   SW#,,AUTO                cn=0,s=lsgnf,sf=0,n=4

     1193    18253    4         CALL CREATE_SWITCH_TRIAD (SW#, CONST$) ;

  18253 21 001533   200025 631500                    EPPR1   CONST$,,AUTO
        21 001534   200100 451500                    STP1    @CONST$,,AUTO
        21 001535   200030 633500                    EPPR3   SW#,,AUTO
        21 001536   200077 453500                    STP3    @SW#,,AUTO
        21 001537   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 001540   000000 011000                    NOP     0

     1194    18254    4         IF ON_OR_OFF = %ON_SWITCH THEN

  18254 21 001541   200066 470500                    LDP0    @ON_OR_OFF,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:184  
        21 001542   000000 235100                    LDA     0,,PR0
        21 001543   000354 115007                    CMPA    236,DL
        21 001544   001565 601000 21                 TNZ     s:18959

     1195    18255                %NEW_ILL (@ID = %ON_SWITCH, @LOP = CONST$) ;

  18579 21 001545   000007 236000 22                 LDQ     7
        21 001546   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001547   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 001550   200107 451500                    STP1    @CONST$+7,,AUTO
        21 001551   000010 236000 22                 LDQ     8
        21 001552   200106 756100                    STQ     @CONST$+6,,AUTO
        21 001553   000024 237000 22                 LDAQ    20
        21 001554   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001555   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 001556   000002 631400 22                 EPPR1   2
        21 001557   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001560   000000 011000                    NOP     0

  18585 21 001561   200025 236100                    LDQ     CONST$,,AUTO
        21 001562   000000 470400 16                 LDP0    ILL$
        21 001563   000001 756100                    STQ     1,,PR0

  18604 21 001564   001731 710000 21                 TRA     s:19834

     1196    18634    4         ELSE
     1197    18635                %NEW_ILL (@ID = %OFF_SWITCH, @LOP = CONST$) ;

  18959 21 001565   000007 236000 22                 LDQ     7
        21 001566   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001567   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 001570   200107 451500                    STP1    @CONST$+7,,AUTO
        21 001571   000010 236000 22                 LDQ     8
        21 001572   200106 756100                    STQ     @CONST$+6,,AUTO
        21 001573   000030 237000 22                 LDAQ    24
        21 001574   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001575   200104 630500                    EPPR0   @CONST$+4,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:185  
        21 001576   000002 631400 22                 EPPR1   2
        21 001577   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001600   000000 011000                    NOP     0

  18965 21 001601   200025 236100                    LDQ     CONST$,,AUTO
        21 001602   000000 470400 16                 LDP0    ILL$
        21 001603   000001 756100                    STQ     1,,PR0

     1198    19014
     1199    19015    4       END ; /* Receiving guy is a SWITCH */

  19015 21 001604   001731 710000 21                 TRA     s:19834

     1200    19016
     1201    19017    4       ELSE DO ; /* It ain't no SWITCH */

     1202    19018
     1203    19019              /* SET mnemonic-name TO ON (or OFF) */
     1204    19020
     1205    19021              %FISH (TRIAD = RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.ETT$,
     1206    19022                     RTN = ST$);

  19024 21 001605   100004 473500                    LDP3    4,,PR1
        21 001606   300001 236100                    LDQ     1,,PR3
        21 001607   200023 756100                    STQ     ST$,,AUTO

  19025 21 001610   200023 474500                    LDP4    ST$,,AUTO
        21 001611   400000 222100                    LDX2    0,,PR4
        21 001612   000751 102003                    CMPX2   489,DU
        21 001613   001623 603000 21                 TRC     s:19031

  19026 21 001614   200023 470500                    LDP0    ST$,,AUTO
        21 001615   000001 236100                    LDQ     1,,PR0
        21 001616   200023 756100                    STQ     ST$,,AUTO

  19027 21 001617   200023 470500                    LDP0    ST$,,AUTO
        21 001620   000000 220100                    LDX0    0,,PR0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:186  
        21 001621   000751 100003                    CMPX0   489,DU
        21 001622   001614 602000 21                 TNC     s:19026

     1207    19030
     1208    19031    4         IF ST$ -> ST.ID = %SWITCH THEN

  19031 21 001623   200023 470500                    LDP0    ST$,,AUTO
        21 001624   000000 220100                    LDX0    0,,PR0
        21 001625   000762 100003                    CMPX0   498,DU
        21 001626   001704 601000 21                 TNZ     s:19811

     1209    19032    5           DO;

     1210    19033    5             CALL CREATE_SWITCH_TRIAD (BINBIT(ST$ -> SWITCH.SWITCH#, 36),

  19033 21 001627   000003 236100                    LDQ     3,,PR0
        21 001630   777777 376007                    ANQ     -1,DL
        21 001631   200122 756100                    STQ     @CONST$+18,,AUTO
        21 001632   200025 631500                    EPPR1   CONST$,,AUTO
        21 001633   200100 451500                    STP1    @CONST$,,AUTO
        21 001634   200122 633500                    EPPR3   @CONST$+18,,AUTO
        21 001635   200077 453500                    STP3    @SW#,,AUTO
        21 001636   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 001637   000000 011000                    NOP     0

     1211    19034    5                                       CONST$);
     1212    19035
     1213    19036    5             IF ON_OR_OFF = %ON_SWITCH THEN

  19036 21 001640   200066 470500                    LDP0    @ON_OR_OFF,,AUTO
        21 001641   000000 235100                    LDA     0,,PR0
        21 001642   000354 115007                    CMPA    236,DL
        21 001643   001664 601000 21                 TNZ     s:19741

     1214    19037                    %NEW_ILL (@ID = %ON_SWITCH, @LOP = CONST$) ;

  19361 21 001644   000007 236000 22                 LDQ     7
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:187  
        21 001645   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001646   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 001647   200107 451500                    STP1    @CONST$+7,,AUTO
        21 001650   000010 236000 22                 LDQ     8
        21 001651   200106 756100                    STQ     @CONST$+6,,AUTO
        21 001652   000024 237000 22                 LDAQ    20
        21 001653   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001654   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 001655   000002 631400 22                 EPPR1   2
        21 001656   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001657   000000 011000                    NOP     0

  19367 21 001660   200025 236100                    LDQ     CONST$,,AUTO
        21 001661   000000 470400 16                 LDP0    ILL$
        21 001662   000001 756100                    STQ     1,,PR0

  19386 21 001663   001731 710000 21                 TRA     s:19834

     1215    19416    5             ELSE
     1216    19417                    %NEW_ILL (@ID = %OFF_SWITCH, @LOP = CONST$) ;

  19741 21 001664   000007 236000 22                 LDQ     7
        21 001665   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001666   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 001667   200107 451500                    STP1    @CONST$+7,,AUTO
        21 001670   000010 236000 22                 LDQ     8
        21 001671   200106 756100                    STQ     @CONST$+6,,AUTO
        21 001672   000030 237000 22                 LDAQ    24
        21 001673   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 001674   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 001675   000002 631400 22                 EPPR1   2
        21 001676   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 001677   000000 011000                    NOP     0

  19747 21 001700   200025 236100                    LDQ     CONST$,,AUTO
        21 001701   000000 470400 16                 LDP0    ILL$
        21 001702   000001 756100                    STQ     1,,PR0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:188  

     1217    19796    5           END;

  19796 21 001703   001731 710000 21                 TRA     s:19834

     1218    19797    4         ELSE
     1219    19798                %CONDITIONAL_ERROR (@LX_ITEM$ = RECEIVE$ -> LX_LIST.HEAD$,
     1220    19799                                    @ERROR# = %E$MNEMONIC_NAME_EXPECTED,
     1221    19800                                    @LINE = RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1222    19801                                    @COLUMN =
             19801                                        RECEIVE$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  19811 21 001704   200065 471500                    LDP1    @RECEIVE$,,AUTO
        21 001705   100000 473500                    LDP3    0,,PR1
        21 001706   300004 474500                    LDP4    4,,PR3
        21 001707   400000 236100                    LDQ     0,,PR4
        21 001710   400000 316007                    CANQ    -131072,DL
        21 001711   001731 601000 21                 TNZ     s:19834

  19813 21 001712   400006 635500                    EPPR5   6,,PR4
        21 001713   200104 455500                    STP5    @CONST$+4,,AUTO
        21 001714   400005 633500                    EPPR3   5,,PR4
        21 001715   200103 453500                    STP3    @CONST$+3,,AUTO
        21 001716   000022 236000 22                 LDQ     18
        21 001717   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001720   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001721   000020 631400 22                 EPPR1   16
        21 001722   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001723   000000 011000                    NOP     0

  19822 21 001724   200065 470500                    LDP0    @RECEIVE$,,AUTO
        21 001725   000000 471500                    LDP1    0,,PR0
        21 001726   100004 473500                    LDP3    4,,PR1
        21 001727   400000 236007                    LDQ     -131072,DL
        21 001730   300000 256100                    ORSQ    0,,PR3

     1223    19831
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:189  
     1224    19832    4       END ; /* Receiving guy is a mnemonic-name */

     1225    19833
     1226    19834    3     END SET_ON_OR_OFF ;

  19834 21 001731   200064 221300                    LDX1  ! ASS_VAR+8,,AUTO
        21 001732   000001 702211                    TSX2  ! 1,X1

     1227    19835
     1228    19836
     1229    19837    2     SET_SWITCH_FROM_SWITCH : PROC (REC_SW#,

  19837 21 001733   200072 741300       SET_SWITCH_* STX1  ! @REC$+1,,AUTO

     1230    19838    2                                    SEND_SW#);
     1231    19839
     1232    19840    3       DCL REC_SW# SBIN WORD;
     1233    19841    3       DCL SEND_SW# SBIN WORD;
     1234    19842
     1235    19843    3       CALL Z8AT$CREATE_TEMPORARY (%PARA,

  19843 21 001734   200026 630500                    EPPR0   END_LABEL$,,AUTO
        21 001735   200103 450500                    STP0    @CONST$+3,,AUTO
        21 001736   000040 236000 22                 LDQ     32
        21 001737   200102 756100                    STQ     @CONST$+2,,AUTO
        21 001740   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001741   000014 631400 22                 EPPR1   12
        21 001742   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        21 001743   000000 011000                    NOP     0

     1236    19844    3                                   END_LABEL$);
     1237    19845    3       CALL Z8AT$CREATE_TEMPORARY (%PARA,

  19845 21 001744   200027 630500                    EPPR0   OFF_SW_LABEL$,,AUTO
        21 001745   200103 450500                    STP0    @CONST$+3,,AUTO
        21 001746   000040 236000 22                 LDQ     32
        21 001747   200102 756100                    STQ     @CONST$+2,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:190  
        21 001750   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 001751   000014 631400 22                 EPPR1   12
        21 001752   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        21 001753   000000 011000                    NOP     0

     1238    19846    3                                   OFF_SW_LABEL$);
     1239    19847
     1240    19848            %INIT_UNARY_OP (@POINTER = "ADDR(SW_ON_COND)",
     1241    19849                            @OP = %OP_SWITCH_IS_ON,
     1242    19850                            @LOP$ = "ADDR(SW_VALUE)");

  19852 21 001754   000006 220003                    LDX0    6,DU
        21 001755   200044 740100                    STX0    SW_ON_COND,,AUTO

  19853 21 001756   000000 221003                    LDX1    0,DU
        21 001757   200044 441100                    SXL1    SW_ON_COND,,AUTO

  19860 21 001760   000133 235000 xsym               LDA     COMCOM+91
        21 001761   200051 755100                    STA     SW_ON_COND+5,,AUTO

  19861 21 001762   000134 236000 xsym               LDQ     COMCOM+92
        21 001763   200052 756100                    STQ     SW_ON_COND+6,,AUTO

  19862 21 001764   200034 630500                    EPPR0   SW_VALUE,,AUTO
        21 001765   200045 450500                    STP0    SW_ON_COND+1,,AUTO

  19863 21 001766   000036 235007                    LDA     30,DL
        21 001767   200047 755100                    STA     SW_ON_COND+3,,AUTO

  19864 21 001770   000001 236000 22                 LDQ     1
        21 001771   200053 756100                    STQ     SW_ON_COND+7,,AUTO

     1243    19867
     1244    19868    3       CALL Z8AC$LX_ETT_ITEM_TYI_CONST

  19868 21 001772   200034 631500                    EPPR1   SW_VALUE,,AUTO
        21 001773   200102 451500                    STP1    @CONST$+2,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:191  
        21 001774   200102 633500                    EPPR3   @CONST$+2,,AUTO
        21 001775   200105 453500                    STP3    @CONST$+5,,AUTO
        21 001776   200074 236100                    LDQ     @SEND_SW#,,AUTO
        21 001777   200104 756100                    STQ     @CONST$+4,,AUTO
        21 002000   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002001   000014 631400 22                 EPPR1   12
        21 002002   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        21 002003   000000 011000                    NOP     0

     1245    19869    3              (SEND_SW#,
     1246    19870    3               ADDR(SW_VALUE));
     1247    19871
     1248    19872    3       CALL Z8EK$BRANCH_FALSE (OFF_SW_LABEL$,

  19872 21 002004   200044 630500                    EPPR0   SW_ON_COND,,AUTO
        21 002005   200102 450500                    STP0    @CONST$+2,,AUTO
        21 002006   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 002007   200105 451500                    STP1    @CONST$+5,,AUTO
        21 002010   200027 633500                    EPPR3   OFF_SW_LABEL$,,AUTO
        21 002011   200104 453500                    STP3    @CONST$+4,,AUTO
        21 002012   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002013   000014 631400 22                 EPPR1   12
        21 002014   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        21 002015   000000 011000                    NOP     0

     1249    19873    3                               ADDR(SW_ON_COND));
     1250    19874
     1251    19875    3       CALL CREATE_SWITCH_TRIAD (REC_SW#, CONST$);

  19875 21 002016   200025 630500                    EPPR0   CONST$,,AUTO
        21 002017   200100 450500                    STP0    @CONST$,,AUTO
        21 002020   200073 236100                    LDQ     @REC_SW#,,AUTO
        21 002021   200077 756100                    STQ     @SW#,,AUTO
        21 002022   001333 701000 21                 TSX1    CREATE_SWITCH_TRIAD
        21 002023   000000 011000                    NOP     0

     1252    19876
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:192  
     1253    19877            %NEW_ILL (@ID = %ON_SWITCH,
     1254    19878                      @LOP = CONST$);

  20202 21 002024   000007 236000 22                 LDQ     7
        21 002025   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002026   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002027   200107 450500                    STP0    @CONST$+7,,AUTO
        21 002030   000010 236000 22                 LDQ     8
        21 002031   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002032   000024 237000 22                 LDAQ    20
        21 002033   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002034   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002035   000002 631400 22                 EPPR1   2
        21 002036   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002037   000000 011000                    NOP     0

  20208 21 002040   200025 236100                    LDQ     CONST$,,AUTO
        21 002041   000000 470400 16                 LDP0    ILL$
        21 002042   000001 756100                    STQ     1,,PR0

     1255    20257
     1256    20258    3       CALL Z8EK$BRANCH (END_LABEL$);

  20258 21 002043   200026 631500                    EPPR1   END_LABEL$,,AUTO
        21 002044   200102 451500                    STP1    @CONST$+2,,AUTO
        21 002045   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002046   000000 631400 22                 EPPR1   0
        21 002047   000000 701000 xent               TSX1    Z8EK$BRANCH
        21 002050   000000 011000                    NOP     0

     1257    20259
     1258    20260            %NEW_ILL (@ID = %DEFLB,
     1259    20261                      @LABEL$ = OFF_SW_LABEL$);

  20593 21 002051   000007 236000 22                 LDQ     7
        21 002052   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002053   200102 630500                    EPPR0   @CONST$+2,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:193  
        21 002054   200107 450500                    STP0    @CONST$+7,,AUTO
        21 002055   000010 236000 22                 LDQ     8
        21 002056   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002057   000044 237000 22                 LDAQ    36
        21 002060   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002061   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002062   000002 631400 22                 EPPR1   2
        21 002063   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002064   000000 011000                    NOP     0

  20594 21 002065   200027 236100                    LDQ     OFF_SW_LABEL$,,AUTO
        21 002066   000000 470400 16                 LDP0    ILL$
        21 002067   000001 756100                    STQ     1,,PR0

     1260    20640
     1261    20641            %NEW_ILL (@ID = %OFF_SWITCH,
     1262    20642                      @LOP = CONST$);

  20966 21 002070   000007 236000 22                 LDQ     7
        21 002071   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002072   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 002073   200107 451500                    STP1    @CONST$+7,,AUTO
        21 002074   000010 236000 22                 LDQ     8
        21 002075   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002076   000030 237000 22                 LDAQ    24
        21 002077   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002100   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002101   000002 631400 22                 EPPR1   2
        21 002102   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002103   000000 011000                    NOP     0

  20972 21 002104   200025 236100                    LDQ     CONST$,,AUTO
        21 002105   000000 470400 16                 LDP0    ILL$
        21 002106   000001 756100                    STQ     1,,PR0

     1263    21021
     1264    21022            %NEW_ILL (@ID = %DEFLB,
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:194  
     1265    21023                      @LABEL$ = END_LABEL$);

  21355 21 002107   000007 236000 22                 LDQ     7
        21 002110   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002111   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 002112   200107 451500                    STP1    @CONST$+7,,AUTO
        21 002113   000010 236000 22                 LDQ     8
        21 002114   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002115   000044 237000 22                 LDAQ    36
        21 002116   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002117   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002120   000002 631400 22                 EPPR1   2
        21 002121   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002122   000000 011000                    NOP     0

  21356 21 002123   200026 236100                    LDQ     END_LABEL$,,AUTO
        21 002124   000000 470400 16                 LDP0    ILL$
        21 002125   000001 756100                    STQ     1,,PR0

     1266    21402
     1267    21403    3     END SET_SWITCH_FROM_SWITCH;

  21403 21 002126   200072 221300                    LDX1  ! @REC$+1,,AUTO
        21 002127   000001 702211                    TSX2  ! 1,X1

     1268    21404
     1269    21405
     1270    21406    2      PROCESS_POINTER_SET: PROC (REC$, SEND$);

  21406 21 002130   200072 741300       PROCESS_POI* STX1  ! @REC$+1,,AUTO

     1271    21407
     1272    21408    3        DCL REC$      PTR; /* LX_LIST to <id_or_switch_list> */
     1273    21409    3        DCL SEND$     PTR; /* LX_LIST to <SET_send_item>     */
     1274    21410    3        DCL R$        PTR;
     1275    21411
     1276    21412
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:195  
     1277    21413    3        IF SEND$ -> LX_LIST.COUNT > 1 THEN   /* array item */

  21413 21 002131   200074 470500                    LDP0    @SEND$,,AUTO
        21 002132   000000 471500                    LDP1    0,,PR0
        21 002133   100002 235100                    LDA     2,,PR1
        21 002134   000001 115007                    CMPA    1,DL
        21 002135   002146 604400 21                 TMOZ    s:21417

     1278    21414    3          CALL Z8EY$SUBSCRIPT (SEND$ -> LX_LIST.TAIL$,

  21414 21 002136   100004 633500                    EPPR3   4,,PR1
        21 002137   200103 453500                    STP3    @CONST$+3,,AUTO
        21 002140   100001 634500                    EPPR4   1,,PR1
        21 002141   200102 454500                    STP4    @CONST$+2,,AUTO
        21 002142   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002143   000014 631400 22                 EPPR1   12
        21 002144   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 002145   000000 011000                    NOP     0

     1279    21415    3                               SEND$ -> LX_LIST.HEAD$);
     1280    21416
     1281    21417    4        DO CASE (REC$ -> LX_ITEM.ID);

  21417 21 002146   200073 470500                    LDP0    @REC$,,AUTO
        21 002147   000000 471500                    LDP1    0,,PR0
        21 002150   100000 220100                    LDX0    0,,PR1
        21 002151   000005 100003                    CMPX0   5,DU
        21 002152   002154 602010 21                 TNC     s:21417+6,X0
        21 002153   002311 710000 21                 TRA     s:21515
        21 002154   002311 710000 21                 TRA     s:21515
        21 002155   002311 710000 21                 TRA     s:21515
        21 002156   002221 710000 21                 TRA     s:21461
        21 002157   002311 710000 21                 TRA     s:21515
        21 002160   002161 710000 21                 TRA     s:21420

     1282    21418    4          CASE(%LX_ETT_ITEM);

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:196  
     1283    21419
     1284    21420    4              IF REC$ -> LX_ETT_ITEM.TYPE ~= %TYP THEN

  21420 21 002161   100004 235100                    LDA     4,,PR1
        21 002162   000022 115007                    CMPA    18,DL
        21 002163   002206 600000 21                 TZE     s:21457

     1285    21421    5                DO;

     1286    21422                       %CONDITIONAL_ERROR (@LX_ITEM$ = REC$,
     1287    21423                           @ERROR# =%E$POINTER_INCOMPATIBLE,
     1288    21424                           @LINE   = REC$ -> LX_ETT_ITEM.LINE,
     1289    21425                           @COLUMN = REC$ -> LX_ETT_ITEM.COLUMN);

  21435 21 002164   100000 236100                    LDQ     0,,PR1
        21 002165   400000 316007                    CANQ    -131072,DL
        21 002166   002315 601000 21                 TNZ     s:21519

  21437 21 002167   100006 633500                    EPPR3   6,,PR1
        21 002170   200104 453500                    STP3    @CONST$+4,,AUTO
        21 002171   100005 634500                    EPPR4   5,,PR1
        21 002172   200103 454500                    STP4    @CONST$+3,,AUTO
        21 002173   000046 236000 22                 LDQ     38
        21 002174   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002175   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002176   000020 631400 22                 EPPR1   16
        21 002177   000000 701000 xent               TSX1    Z8AE$ERROR
        21 002200   000000 011000                    NOP     0

  21446 21 002201   200073 470500                    LDP0    @REC$,,AUTO
        21 002202   000000 471500                    LDP1    0,,PR0
        21 002203   400000 236007                    LDQ     -131072,DL
        21 002204   100000 256100                    ORSQ    0,,PR1

     1290    21455    5                END;

  21455 21 002205   002315 710000 21                 TRA     s:21519
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:197  

     1291    21456    4              ELSE
     1292    21457    4                CALL Z8E7$POINTER_MOVE (REC$, SEND$ -> LX_LIST.HEAD$);

  21457 21 002206   200074 473500                    LDP3    @SEND$,,AUTO
        21 002207   300000 474500                    LDP4    0,,PR3
        21 002210   400004 635500                    EPPR5   4,,PR4
        21 002211   200103 455500                    STP5    @CONST$+3,,AUTO
        21 002212   200073 236100                    LDQ     @REC$,,AUTO
        21 002213   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002214   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002215   000014 631400 22                 EPPR1   12
        21 002216   000000 701000 xent               TSX1    Z8E7$POINTER_MOVE
        21 002217   000000 011000                    NOP     0
        21 002220   002315 710000 21                 TRA     s:21519

     1293    21458
     1294    21459    4          CASE(%LX_LIST);

     1295    21460
     1296    21461    4              R$ = REC$ -> LX_LIST.HEAD$;

  21461 21 002221   100004 236100                    LDQ     4,,PR1
        21 002222   200075 756100                    STQ     R$,,AUTO

     1297    21462
     1298    21463    5            DO WHILE (R$ ~= ADDR(NIL));

  21463 21 002223   002306 710000 21                 TRA     s:21512

     1299    21464    5              IF R$ -> LX_LIST.HEAD$ -> LX_ETT_ITEM.TYPE ~= %TYP THEN

  21464 21 002224   200075 470500                    LDP0    R$,,AUTO
        21 002225   000004 471500                    LDP1    4,,PR0
        21 002226   100004 235100                    LDA     4,,PR1
        21 002227   000022 115007                    CMPA    18,DL
        21 002230   002253 600000 21                 TZE     s:21502
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:198  

     1300    21465    6                DO;

     1301    21466                       %CONDITIONAL_ERROR (@LX_ITEM$ = R$ -> LX_LIST.HEAD$,
     1302    21467                           @ERROR# =%E$POINTER_INCOMPATIBLE,
     1303    21468                           @LINE   = R$->LX_LIST.HEAD$ -> LX_ETT_ITEM.LINE,
     1304    21469                           @COLUMN = R$->LX_LIST.HEAD$ -> LX_ETT_ITEM.COLUMN);

  21479 21 002231   100000 236100                    LDQ     0,,PR1
        21 002232   400000 316007                    CANQ    -131072,DL
        21 002233   002303 601000 21                 TNZ     s:21510

  21481 21 002234   100006 633500                    EPPR3   6,,PR1
        21 002235   200104 453500                    STP3    @CONST$+4,,AUTO
        21 002236   100005 634500                    EPPR4   5,,PR1
        21 002237   200103 454500                    STP4    @CONST$+3,,AUTO
        21 002240   000046 236000 22                 LDQ     38
        21 002241   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002242   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002243   000020 631400 22                 EPPR1   16
        21 002244   000000 701000 xent               TSX1    Z8AE$ERROR
        21 002245   000000 011000                    NOP     0

  21490 21 002246   200075 470500                    LDP0    R$,,AUTO
        21 002247   000004 471500                    LDP1    4,,PR0
        21 002250   400000 236007                    LDQ     -131072,DL
        21 002251   100000 256100                    ORSQ    0,,PR1

     1305    21499    6                END;

  21499 21 002252   002303 710000 21                 TRA     s:21510

     1306    21500    5              ELSE
     1307    21501    6                DO;

     1308    21502    6                  IF R$ -> LX_LIST.COUNT > 1 THEN

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:199  
  21502 21 002253   000002 235100                    LDA     2,,PR0
        21 002254   000001 115007                    CMPA    1,DL
        21 002255   002270 604400 21                 TMOZ    s:21506

     1309    21503    6                    CALL Z8EY$SUBSCRIPT(R$ -> LX_LIST.TAIL$,

  21503 21 002256   200075 236100                    LDQ     R$,,AUTO
        21 002257   000004 036003                    ADLQ    4,DU
        21 002260   200103 756100                    STQ     @CONST$+3,,AUTO
        21 002261   200075 236100                    LDQ     R$,,AUTO
        21 002262   000001 036003                    ADLQ    1,DU
        21 002263   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002264   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002265   000014 631400 22                 EPPR1   12
        21 002266   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 002267   000000 011000                    NOP     0

     1310    21504    6                                        R$ -> LX_LIST.HEAD$);
     1311    21505
     1312    21506    6                  CALL Z8E7$POINTER_MOVE (R$ -> LX_LIST.HEAD$,

  21506 21 002270   200074 470500                    LDP0    @SEND$,,AUTO
        21 002271   000000 471500                    LDP1    0,,PR0
        21 002272   100004 633500                    EPPR3   4,,PR1
        21 002273   200103 453500                    STP3    @CONST$+3,,AUTO
        21 002274   200075 236100                    LDQ     R$,,AUTO
        21 002275   000004 036003                    ADLQ    4,DU
        21 002276   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002277   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002300   000014 631400 22                 EPPR1   12
        21 002301   000000 701000 xent               TSX1    Z8E7$POINTER_MOVE
        21 002302   000000 011000                    NOP     0

     1313    21507    6                                          SEND$ -> LX_LIST.HEAD$);
     1314    21508    6                END;

     1315    21509
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:200  
     1316    21510    5              R$ = R$ -> LX_LIST.LINK;

  21510 21 002303   200075 470500                    LDP0    R$,,AUTO
        21 002304   000007 236100                    LDQ     7,,PR0
        21 002305   200075 756100                    STQ     R$,,AUTO

     1317    21511
     1318    21512    5            END; /* DO WHILE */

  21512 21 002306   000001 116000 22                 CMPQ    1
        21 002307   002224 601000 21                 TNZ     s:21464
        21 002310   002315 710000 21                 TRA     s:21519

     1319    21513
     1320    21514    4          CASE (ELSE);

     1321    21515    4              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  21515 21 002311   000050 630400 22                 EPPR0   40
        21 002312   000000 631400 22                 EPPR1   0
        21 002313   000000 701000 xent               TSX1    Z8AE$ERROR
        21 002314   000000 011000                    NOP     0

     1322    21516
     1323    21517    4        END; /* DO CASE */

     1324    21518
     1325    21519    3     END PROCESS_POINTER_SET;

  21519 21 002315   200072 221300                    LDX1  ! @REC$+1,,AUTO
        21 002316   000001 702211                    TSX2  ! 1,X1

     1326    21520
     1327    21521
     1328    21522        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:201  
     1329    21523        /* Body of SET_STATEMENT */
     1330    21524
     1331    21525        %STATEMENT_START_FROM_LX_TERM (@POINTER = KEY_WORD$,
     1332    21526                                       @TYPE = %S_TYPE_SET);

  21534 21 002317   200003 470500                    LDP0    @KEY_WORD$,,AUTO
        21 002320   000000 471500                    LDP1    0,,PR0
        21 002321   100005 235100                    LDA     5,,PR1
        21 002322   000007 755000 xsym               STA     O1COM+7

  21535 21 002323   000000 471500                    LDP1    0,,PR0
        21 002324   100006 235100                    LDA     6,,PR1
        21 002325   000010 755000 xsym               STA     O1COM+8

  21536 21 002326   000011 236000 xsym               LDQ     O1COM+9
        21 002327   002344 600000 21                 TZE     s:21918

  21571 21 002330   000007 236000 22                 LDQ     7
        21 002331   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002332   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 002333   200107 451500                    STP1    @CONST$+7,,AUTO
        21 002334   000010 236000 22                 LDQ     8
        21 002335   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002336   000052 237000 22                 LDAQ    42
        21 002337   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002340   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002341   000002 631400 22                 EPPR1   2
        21 002342   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002343   000000 011000                    NOP     0

  21918 21 002344   000045 235007                    LDA     37,DL
        21 002345   000011 755000 xsym               STA     O1COM+9

  21954 21 002346   000007 236000 22                 LDQ     7
        21 002347   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002350   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002351   200107 450500                    STP0    @CONST$+7,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:202  
        21 002352   000010 236000 22                 LDQ     8
        21 002353   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002354   000052 237000 22                 LDAQ    42
        21 002355   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002356   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002357   000002 631400 22                 EPPR1   2
        21 002360   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002361   000000 011000                    NOP     0

     1333    22302
     1334    22303
     1335    22304
     1336    22305    3   DO CASE (SET_TYPE);

  22305 21 002362   200006 470500                    LDP0    @SET_TYPE,,AUTO
        21 002363   000000 235100                    LDA     0,,PR0
        21 002364   000004 135007                    SBLA    4,DL
        21 002365   000003 115007                    CMPA    3,DL
        21 002366   002370 602005 21                 TNC     s:22305+6,AL
        21 002367   002672 710000 21                 TRA     s:22411
        21 002370   002373 710000 21                 TRA     s:22309
        21 002371   002402 710000 21                 TRA     s:22313
        21 002372   002411 710000 21                 TRA     s:22317

     1337    22306
     1338    22307    3     CASE (%SET_ON);

     1339    22308
     1340    22309    3       CALL SET_ON_OR_OFF (RECEIVE$, %ON_SWITCH) ;

  22309 21 002373   000025 236000 22                 LDQ     21
        21 002374   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002375   200004 236100                    LDQ     @RECEIVE$,,AUTO
        21 002376   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002377   001520 701000 21                 TSX1    SET_ON_OR_OFF
        21 002400   000000 011000                    NOP     0
        21 002401   002672 710000 21                 TRA     s:22411
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:203  

     1341    22310
     1342    22311    3     CASE (%SET_OFF);

     1343    22312
     1344    22313    3       CALL SET_ON_OR_OFF (RECEIVE$, %OFF_SWITCH) ;

  22313 21 002402   000031 236000 22                 LDQ     25
        21 002403   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002404   200004 236100                    LDQ     @RECEIVE$,,AUTO
        21 002405   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002406   001520 701000 21                 TSX1    SET_ON_OR_OFF
        21 002407   000000 011000                    NOP     0
        21 002410   002672 710000 21                 TRA     s:22411

     1345    22314
     1346    22315    3     CASE (%SET_SWITCH);

     1347    22316
     1348    22317    3       REC$ = RECEIVE$ -> LX_LIST.HEAD$;

  22317 21 002411   200004 471500                    LDP1    @RECEIVE$,,AUTO
        21 002412   100000 473500                    LDP3    0,,PR1
        21 002413   300004 236100                    LDQ     4,,PR3
        21 002414   200021 756100                    STQ     REC$,,AUTO

     1349    22318    4       DO WHILE REC$ ~= ADDR(NIL);

  22318 21 002415   002670 710000 21                 TRA     s:22408

     1350    22319
     1351    22320    5         DO SELECT (REC$ -> LX_LIST.HEAD$ -> LX_LIST.LINK -> LX_TERMINAL.SYMBOL) ;

  22320 21 002416   200021 470500                    LDP0    REC$,,AUTO
        21 002417   000004 471500                    LDP1    4,,PR0
        21 002420   100007 473500                    LDP3    7,,PR1
        21 002421   300003 236100                    LDQ     3,,PR3
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:204  
        21 002422   000721 116007                    CMPQ    465,DL
        21 002423   002430 604000 21                 TMI     s:22320+10
        21 002424   002461 600000 21                 TZE     s:22335
        21 002425   000735 116007                    CMPQ    477,DL
        21 002426   002665 601000 21                 TNZ     s:22407
        21 002427   002433 710000 21                 TRA     s:22324
        21 002430   000232 116007                    CMPQ    154,DL
        21 002431   002665 601000 21                 TNZ     s:22407
        21 002432   002446 710000 21                 TRA     s:22330

     1352    22321
     1353    22322    5           SELECT (%RSV_WRD_UP) ; /* SET ... id1 UP BY id2 ... */

     1354    22323
     1355    22324    5             CALL SET_UP_DOWN (REC$ -> LX_LIST.HEAD$,

  22324 21 002433   000055 236000 22                 LDQ     45
        21 002434   200067 756100                    STQ     @ON_OR_OFF+1,,AUTO
        21 002435   200021 236100                    LDQ     REC$,,AUTO
        21 002436   000001 036003                    ADLQ    1,DU
        21 002437   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002440   200021 236100                    LDQ     REC$,,AUTO
        21 002441   000004 036003                    ADLQ    4,DU
        21 002442   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002443   000005 701000 21                 TSX1    SET_UP_DOWN
        21 002444   000000 011000                    NOP     0
        21 002445   002665 710000 21                 TRA     s:22407

     1356    22325    5                               REC$ -> LX_LIST.TAIL$,
     1357    22326    5                               %SET_UP_BY) ;
     1358    22327
     1359    22328    5           SELECT (%RSV_WRD_DOWN) ; /* SET ... id1 DOWN BY id2 ... */

     1360    22329
     1361    22330    5             CALL SET_UP_DOWN (REC$ -> LX_LIST.HEAD$,

  22330 21 002446   000057 236000 22                 LDQ     47
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:205  
        21 002447   200067 756100                    STQ     @ON_OR_OFF+1,,AUTO
        21 002450   200021 236100                    LDQ     REC$,,AUTO
        21 002451   000001 036003                    ADLQ    1,DU
        21 002452   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002453   200021 236100                    LDQ     REC$,,AUTO
        21 002454   000004 036003                    ADLQ    4,DU
        21 002455   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002456   000005 701000 21                 TSX1    SET_UP_DOWN
        21 002457   000000 011000                    NOP     0
        21 002460   002665 710000 21                 TRA     s:22407

     1362    22331    5                               REC$ -> LX_LIST.TAIL$,
     1363    22332    5                               %SET_DOWN_BY) ;
     1364    22333    5           SELECT (%RSV_WRD_TO) ; /* SET ... id1 TO id2 ... */

     1365    22334
     1366    22335    5             IF REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ -> LX_ITEM.ID

  22335 21 002461   100004 474500                    LDP4    4,,PR1
        21 002462   400000 220100                    LDX0    0,,PR4
        21 002463   002475 601000 21                 TNZ     s:22341

     1367    22336    5              = %LX_TERMINAL THEN
     1368    22337    5               CALL SET_SWITCH_TO (REC$ -> LX_LIST.HEAD$,

  22337 21 002464   200021 236100                    LDQ     REC$,,AUTO
        21 002465   000001 036003                    ADLQ    1,DU
        21 002466   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002467   200021 236100                    LDQ     REC$,,AUTO
        21 002470   000004 036003                    ADLQ    4,DU
        21 002471   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002472   001033 701000 21                 TSX1    SET_SWITCH_TO
        21 002473   000000 011000                    NOP     0
        21 002474   002665 710000 21                 TRA     s:22407

     1369    22338    5                                   REC$ -> LX_LIST.TAIL$) ;
     1370    22339    6             ELSE DO ; /* Receiving list is not SWITCHs */
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:206  

     1371    22340
     1372    22341    7               IF REC$ -> LX_LIST.TAIL$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;

  22341 21 002475   000001 475500                    LDP5    1,,PR0
        21 002476   500000 221100                    LDX1    0,,PR5
        21 002477   002653 601000 21                 TNZ     s:22397

     1373    22342
     1374    22343    8                 DO SELECT (REC$ -> LX_LIST.TAIL$ -> LX_TERMINAL.SYMBOL) ;

  22343 21 002500   500003 236100                    LDQ     3,,PR5
        21 002501   000475 116007                    CMPQ    317,DL
        21 002502   002513 604000 21                 TMI     s:22343+11
        21 002503   002522 600000 21                 TZE     s:22347
        21 002504   000725 116007                    CMPQ    469,DL
        21 002505   002510 604000 21                 TMI     s:22343+8
        21 002506   002555 600000 21                 TZE     s:22361
        21 002507   002640 710000 21                 TRA     s:22384
        21 002510   000675 116007                    CMPQ    445,DL
        21 002511   002640 601000 21                 TNZ     s:22384
        21 002512   002602 710000 21                 TRA     s:22370
        21 002513   000473 116007                    CMPQ    315,DL
        21 002514   002517 604000 21                 TMI     s:22343+15
        21 002515   002522 600000 21                 TZE     s:22347
        21 002516   002640 710000 21                 TRA     s:22384
        21 002517   000463 116007                    CMPQ    307,DL
        21 002520   002640 601000 21                 TNZ     s:22384
        21 002521   002613 710000 21                 TRA     s:22375

     1375    22344
     1376    22345    8                   SELECT (%RSV_WRD_ON, %RSV_WRD_OFF) ;

     1377    22346
     1378    22347    8                     R$ = REC$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ ;

  22347 21 002522   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:207  
        21 002523   200022 756100                    STQ     R$,,AUTO

     1379    22348    9                     DO WHILE R$ ~= ADDR(NIL) ;

  22348 21 002524   002552 710000 21                 TRA     s:22357

     1380    22349
     1381    22350    9                       IF REC$ -> LX_LIST.TAIL$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_ON
             22350                                THEN

  22350 21 002525   200021 470500                    LDP0    REC$,,AUTO
        21 002526   000001 471500                    LDP1    1,,PR0
        21 002527   100003 235100                    LDA     3,,PR1
        21 002530   000475 115007                    CMPA    317,DL
        21 002531   002541 601000 21                 TNZ     s:22353

     1382    22351    9                         CALL SET_ON_OR_OFF (R$, %ON_SWITCH) ;

  22351 21 002532   000025 236000 22                 LDQ     21
        21 002533   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002534   200022 631500                    EPPR1   R$,,AUTO
        21 002535   200065 451500                    STP1    ASS_VAR+9,,AUTO
        21 002536   001520 701000 21                 TSX1    SET_ON_OR_OFF
        21 002537   000000 011000                    NOP     0
        21 002540   002547 710000 21                 TRA     s:22355

     1383    22352    9                       ELSE
     1384    22353    9                         CALL SET_ON_OR_OFF (R$, %OFF_SWITCH) ;

  22353 21 002541   000031 236000 22                 LDQ     25
        21 002542   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002543   200022 631500                    EPPR1   R$,,AUTO
        21 002544   200065 451500                    STP1    ASS_VAR+9,,AUTO
        21 002545   001520 701000 21                 TSX1    SET_ON_OR_OFF
        21 002546   000000 011000                    NOP     0

     1385    22354
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:208  
     1386    22355    9                       R$ = R$ -> LX_ITEM.LINK ;

  22355 21 002547   200022 470500                    LDP0    R$,,AUTO
        21 002550   000007 236100                    LDQ     7,,PR0
        21 002551   200022 756100                    STQ     R$,,AUTO

     1387    22356
     1388    22357    9                     END ; /* Do while R$ is non-nil */

  22357 21 002552   000001 116000 22                 CMPQ    1
        21 002553   002525 601000 21                 TNZ     s:22350
        21 002554   002665 710000 21                 TRA     s:22407

     1389    22358
     1390    22359    8                   SELECT (%RSV_WRD_TRUE) ;

     1391    22360
     1392    22361    8                     IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN

  22361 21 002555   000036 722000 xsym               LXL2    COMCOM+30
        21 002556   000002 102003                    CMPX2   2,DU
        21 002557   002574 604000 21                 TMI     s:22366

     1393    22362    8                       CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  22362 21 002560   200003 476500                    LDP6    @KEY_WORD$,,AUTO
        21 002561   600000 477500                    LDP7    0,,PR6
        21 002562   700006 630500                    EPPR0   6,,PR7
        21 002563   200104 450500                    STP0    @CONST$+4,,AUTO
        21 002564   700005 631500                    EPPR1   5,,PR7
        21 002565   200103 451500                    STP1    @CONST$+3,,AUTO
        21 002566   000061 236000 22                 LDQ     49
        21 002567   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002570   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002571   000020 631400 22                 EPPR1   16
        21 002572   000000 701000 xent               TSX1    Z8AE$ERROR
        21 002573   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:209  

     1394    22363    8                                        KEY_WORD$ -> LX_ITEM.LINE,
     1395    22364    8                                        KEY_WORD$ -> LX_ITEM.COLUMN);
     1396    22365
     1397    22366    8                     CALL SET_TO_TRUE (REC$ -> LX_LIST.HEAD$) ;

  22366 21 002574   200021 236100                    LDQ     REC$,,AUTO
        21 002575   000004 036003                    ADLQ    4,DU
        21 002576   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002577   000421 701000 21                 TSX1    SET_TO_TRUE
        21 002600   000000 011000                    NOP     0
        21 002601   002665 710000 21                 TRA     s:22407

     1398    22367
     1399    22368    8                   SELECT (%RSV_WRD_SWITCH) ;

     1400    22369
     1401    22370    8                     CALL SET_TO_SWITCH (REC$ -> LX_LIST.HEAD$,

  22370 21 002602   200021 236100                    LDQ     REC$,,AUTO
        21 002603   000001 036003                    ADLQ    1,DU
        21 002604   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002605   200021 236100                    LDQ     REC$,,AUTO
        21 002606   000004 036003                    ADLQ    4,DU
        21 002607   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002610   000723 701000 21                 TSX1    SET_TO_SWITCH
        21 002611   000000 011000                    NOP     0
        21 002612   002665 710000 21                 TRA     s:22407

     1402    22371    8                                         REC$ -> LX_LIST.TAIL$) ;
     1403    22372
     1404    22373    8                   SELECT (%RSV_WRD_NULL) ;

     1405    22374
     1406    22375    8                     CALL MOVE_STATEMENT (KEY_WORD$,

  22375 21 002613   000036 236000 22                 LDQ     30
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:210  
        21 002614   200072 756100                    STQ     @REC$+1,,AUTO
        21 002615   200021 236100                    LDQ     REC$,,AUTO
        21 002616   000004 036003                    ADLQ    4,DU
        21 002617   200071 756100                    STQ     @SEND$+1,,AUTO
        21 002620   200021 236100                    LDQ     REC$,,AUTO
        21 002621   000001 036003                    ADLQ    1,DU
        21 002622   200070 756100                    STQ     @KEY_WORD$+1,,AUTO
        21 002623   200003 236100                    LDQ     @KEY_WORD$,,AUTO
        21 002624   200067 756100                    STQ     @ON_OR_OFF+1,,AUTO
        21 002625   002707 701000 21                 TSX1    MOVE_STATEMENT
        21 002626   000000 011000                    NOP     0

     1407    22376    8                                          REC$ -> LX_LIST.TAIL$,
     1408    22377    8                                          REC$ -> LX_LIST.HEAD$,
     1409    22378    8                                          %S_TYPE_DML_SET) ;
     1410    22379
     1411    22380    8                     CALL Z8ED$DISPOSE_ABSSYN_TREE (REC$ -> LX_LIST.HEAD$ -> LX_LIST.
             22380                              HEAD$) ;

  22380 21 002627   200021 470500                    LDP0    REC$,,AUTO
        21 002630   000004 471500                    LDP1    4,,PR0
        21 002631   100004 633500                    EPPR3   4,,PR1
        21 002632   200102 453500                    STP3    @CONST$+2,,AUTO
        21 002633   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002634   000000 631400 22                 EPPR1   0
        21 002635   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        21 002636   000000 011000                    NOP     0
        21 002637   002665 710000 21                 TRA     s:22407

     1412    22381
     1413    22382    8                   SELECT (ELSE) ; /* Must be a number */

     1414    22383
     1415    22384    8                     CALL CHECK_FOR_DML_SET

  22384 21 002640   001346 701000 21                 TSX1    CHECK_FOR_DML_SET
        21 002641   002652 702000 21                 TSX2    s:22393
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:211  

     1416    22385    9                     WHENRETURN DO ; /* not a DML SET */

     1417    22386
     1418    22387    9                       CALL SET_TO (REC$ -> LX_LIST.HEAD$,

  22387 21 002642   200021 236100                    LDQ     REC$,,AUTO
        21 002643   000001 036003                    ADLQ    1,DU
        21 002644   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002645   200021 236100                    LDQ     REC$,,AUTO
        21 002646   000004 036003                    ADLQ    4,DU
        21 002647   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002650   000206 701000 21                 TSX1    SET_TO
        21 002651   000000 011000                    NOP     0

     1419    22388    9                                    REC$ -> LX_LIST.TAIL$) ;
     1420    22389    9                     END ;

     1421    22390
     1422    22391    8                 END ; /* Do select REC$ -> TAIL$ -> SYMBOL */

     1423    22392
     1424    22393    7               END ; /* REC$ -> TAIL$ is a terminal */

  22393 21 002652   002665 710000 21                 TRA     s:22407

     1425    22394
     1426    22395    7               ELSE DO ; /* REC$ -> TAIL$ is not a terminal */

     1427    22396
     1428    22397    7                 CALL CHECK_FOR_DML_SET

  22397 21 002653   001346 701000 21                 TSX1    CHECK_FOR_DML_SET
        21 002654   002665 702000 21                 TSX2    s:22407

     1429    22398    8                 WHENRETURN DO ; /* not a DML SET */

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:212  
     1430    22399
     1431    22400    8                   CALL SET_TO (REC$ -> LX_LIST.HEAD$,

  22400 21 002655   200021 236100                    LDQ     REC$,,AUTO
        21 002656   000001 036003                    ADLQ    1,DU
        21 002657   200066 756100                    STQ     @RECEIVE$+1,,AUTO
        21 002660   200021 236100                    LDQ     REC$,,AUTO
        21 002661   000004 036003                    ADLQ    4,DU
        21 002662   200065 756100                    STQ     ASS_VAR+9,,AUTO
        21 002663   000206 701000 21                 TSX1    SET_TO
        21 002664   000000 011000                    NOP     0

     1432    22401    8                                REC$ -> LX_LIST.TAIL$) ;
     1433    22402    8                 END ;

     1434    22403
     1435    22404    7               END ; /* Sending guy is an identifier */

     1436    22405    6             END ; /* Receiving list is not SWITCHs */

     1437    22406    5         END ; /* Do Select of SYMBOL of 2nd LX_ITEM in list */

     1438    22407    4         REC$ = REC$ -> LX_ITEM.LINK;

  22407 21 002665   200021 470500                    LDP0    REC$,,AUTO
        21 002666   000007 236100                    LDQ     7,,PR0
        21 002667   200021 756100                    STQ     REC$,,AUTO

     1439    22408    4       END; /* Do while REC$ is non-nil */

  22408 21 002670   000001 116000 22                 CMPQ    1
        21 002671   002416 601000 21                 TNZ     s:22320

     1440    22409    3   END; /* Do case of SET type */

     1441    22410
     1442    22411    2   IF RECEIVE$ -> LX_ITEM.ID = %LX_LIST THEN
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:213  

  22411 21 002672   200004 470500                    LDP0    @RECEIVE$,,AUTO
        21 002673   000000 471500                    LDP1    0,,PR0
        21 002674   100000 220100                    LDX0    0,,PR1
        21 002675   000002 100003                    CMPX0   2,DU
        21 002676   002705 601000 21                 TNZ     s:22414

     1443    22412    2     CALL Z8ED$DISPOSE_ABSSYN_TREE (RECEIVE$ -> LX_LIST.HEAD$);

  22412 21 002677   100004 633500                    EPPR3   4,,PR1
        21 002700   200102 453500                    STP3    @CONST$+2,,AUTO
        21 002701   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002702   000000 631400 22                 EPPR1   0
        21 002703   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        21 002704   000000 011000                    NOP     0

     1444    22413
     1445    22414    2   END SET_STATEMENT;

  22414 21 002705   200010 221300                    LDX1  ! VAL_REC_COUNT+1,,AUTO
        21 002706   000001 702211                    TSX2  ! 1,X1

     1446    22415        %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:214  
     1447    22416        /*--------------*/
     1448    22417    1     MOVE_STATEMENT : PROC ( KEY_WORD$,

  22417 21 002707   200066 741300       MOVE_STATEM* STX1  ! @ON_OR_OFF,,AUTO

     1449    22418    1   /*--------------*/        SEND$,
     1450    22419    1                             REC$,
     1451    22420    1                             STATEMENT_TYPE);
     1452    22421
     1453    22422        /*I*
     1454    22423                 NAME: MOVE_STATEMENT
     1455    22424
     1456    22425          DESCRIPTION: Z8E7$MOVE_STATEMENT handles all MOVE statement semantics.
     1457    22426        */
     1458    22427
     1459    22428
     1460    22429    2     DCL KEY_WORD$ PTR;  /* To MOVE keyword */
     1461    22430    2     DCL SEND$     PTR;  /* To <ident_lit> */
     1462    22431    2     DCL REC$      PTR;  /* To <identifier_list> */
     1463    22432    2     DCL STATEMENT_TYPE  SBIN;     /* Type to check for DML SET  */
     1464    22433
     1465    22434    2     DCL IDENT$    PTR;
     1466    22435    2     DCL VAL_REQUIRED BOOLEAN;
     1467    22436
     1468    22437
     1469    22438          %STATEMENT_START_FROM_LX_TERM (@POINTER = KEY_WORD$,
     1470    22439                                         @TYPE = %S_TYPE_MOVE);

  22447 21 002710   200067 470500                    LDP0    @KEY_WORD$,,AUTO
        21 002711   000000 471500                    LDP1    0,,PR0
        21 002712   100005 235100                    LDA     5,,PR1
        21 002713   000007 755000 xsym               STA     O1COM+7

  22448 21 002714   000000 471500                    LDP1    0,,PR0
        21 002715   100006 235100                    LDA     6,,PR1
        21 002716   000010 755000 xsym               STA     O1COM+8

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:215  
  22449 21 002717   000011 236000 xsym               LDQ     O1COM+9
        21 002720   002735 600000 21                 TZE     s:22831

  22484 21 002721   000007 236000 22                 LDQ     7
        21 002722   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002723   200102 631500                    EPPR1   @CONST$+2,,AUTO
        21 002724   200107 451500                    STP1    @CONST$+7,,AUTO
        21 002725   000010 236000 22                 LDQ     8
        21 002726   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002727   000052 237000 22                 LDAQ    42
        21 002730   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002731   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002732   000002 631400 22                 EPPR1   2
        21 002733   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002734   000000 011000                    NOP     0

  22831 21 002735   000031 235007                    LDA     25,DL
        21 002736   000011 755000 xsym               STA     O1COM+9

  22867 21 002737   000007 236000 22                 LDQ     7
        21 002740   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002741   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 002742   200107 450500                    STP0    @CONST$+7,,AUTO
        21 002743   000010 236000 22                 LDQ     8
        21 002744   200106 756100                    STQ     @CONST$+6,,AUTO
        21 002745   000052 237000 22                 LDAQ    42
        21 002746   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 002747   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 002750   000002 631400 22                 EPPR1   2
        21 002751   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 002752   000000 011000                    NOP     0

     1471    23215
     1472    23216    2     IF REC$ -> LX_LIST.COUNT > 1

  23216 21 002753   200071 470500                    LDP0    @REC$,,AUTO
        21 002754   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:216  
        21 002755   100002 235100                    LDA     2,,PR1
        21 002756   000001 115007                    CMPA    1,DL
        21 002757   003034 604400 21                 TMOZ    s:23608
        21 002760   200070 473500                    LDP3    @SEND$,,AUTO
        21 002761   300000 474500                    LDP4    0,,PR3
        21 002762   400000 220100                    LDX0    0,,PR4
        21 002763   000004 100003                    CMPX0   4,DU
        21 002764   003034 601000 21                 TNZ     s:23608
        21 002765   400001 475500                    LDP5    1,,PR4
        21 002766   500000 221100                    LDX1    0,,PR5
        21 002767   000015 101003                    CMPX1   13,DU
        21 002770   003034 600000 21                 TZE     s:23608

     1473    23217    2          AND SEND$ -> LX_ITEM.ID = %LX_ETT_ITEM
     1474    23218    2          AND SEND$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD THEN
     1475    23219    3       DO;

     1476    23220    3         CALL Z8AF$FORME (%EVAL,

  23220 21 002771   000001 236000 22                 LDQ     1
        21 002772   200102 756100                    STQ     @CONST$+2,,AUTO
        21 002773   400001 631500                    EPPR1   1,,PR4
        21 002774   200107 451500                    STP1    @CONST$+7,,AUTO
        21 002775   200102 635500                    EPPR5   @CONST$+2,,AUTO
        21 002776   200106 455500                    STP5    @CONST$+6,,AUTO
        21 002777   400001 636500                    EPPR6   1,,PR4
        21 003000   200105 456500                    STP6    @CONST$+5,,AUTO
        21 003001   000004 236000 22                 LDQ     4
        21 003002   200104 756100                    STQ     @CONST$+4,,AUTO
        21 003003   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 003004   000002 631400 22                 EPPR1   2
        21 003005   000000 701000 xent               TSX1    Z8AF$FORME
        21 003006   000000 011000                    NOP     0

     1477    23221    3                          SEND$ -> LX_ETT_ITEM.ETT$,
     1478    23222    3                          ADDR(NIL),
     1479    23223    3                          SEND$ -> LX_ETT_ITEM.ETT$);
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:217  
     1480    23224              %NEW_ILL(@ID = %VAL,
     1481    23225                       @ETT$ = SEND$ -> LX_ETT_ITEM.ETT$);

  23293 21 003007   000007 236000 22                 LDQ     7
        21 003010   200102 756100                    STQ     @CONST$+2,,AUTO
        21 003011   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 003012   200107 450500                    STP0    @CONST$+7,,AUTO
        21 003013   000010 236000 22                 LDQ     8
        21 003014   200106 756100                    STQ     @CONST$+6,,AUTO
        21 003015   000012 237000 22                 LDAQ    10
        21 003016   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 003017   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 003020   000002 631400 22                 EPPR1   2
        21 003021   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 003022   000000 011000                    NOP     0

  23294 21 003023   200070 470500                    LDP0    @SEND$,,AUTO
        21 003024   000000 471500                    LDP1    0,,PR0
        21 003025   100001 236100                    LDQ     1,,PR1
        21 003026   000000 473400 16                 LDP3    ILL$
        21 003027   300001 756100                    STQ     1,,PR3

     1482    23604    3         VAL_REQUIRED = TRUE;

  23604 21 003030   400000 236003                    LDQ     -131072,DU
        21 003031   200074 756100                    STQ     VAL_REQUIRED,,AUTO

     1483    23605    3         VAL_REC_COUNT = 0 ;                                   /*#28761*/

  23605 21 003032   200007 450100                    STZ     VAL_REC_COUNT,,AUTO

     1484    23606    3       END;

  23606 21 003033   003035 710000 21                 TRA     s:23611

     1485    23607    2     ELSE
     1486    23608    2       VAL_REQUIRED = FALSE;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:218  

  23608 21 003034   200074 450100                    STZ     VAL_REQUIRED,,AUTO

     1487    23609
     1488    23610
     1489    23611    2     IDENT$ = REC$ -> LX_LIST.HEAD$;

  23611 21 003035   200071 470500                    LDP0    @REC$,,AUTO
        21 003036   000000 471500                    LDP1    0,,PR0
        21 003037   100004 236100                    LDQ     4,,PR1
        21 003040   200073 756100                    STQ     IDENT$,,AUTO

     1490    23612
     1491    23613    3     DO WHILE IDENT$ ~= ADDR(NIL);

  23613 21 003041   003120 710000 21                 TRA     s:23635

     1492    23614
     1493    23615    3       IF STATEMENT_TYPE = %S_TYPE_MOVE    THEN

  23615 21 003042   200072 470500                    LDP0    @STATEMENT_TYPE,,AUTO
        21 003043   000000 235100                    LDA     0,,PR0
        21 003044   000031 115007                    CMPA    25,DL
        21 003045   003062 601000 21                 TNZ     s:23623

     1494    23616    3           CALL Z8E7$MOVE_STATEMENT (IDENT$, SEND$, ,STATEMENT_TYPE);

  23616 21 003046   200072 236100                    LDQ     @STATEMENT_TYPE,,AUTO
        21 003047   000001 235000 22                 LDA     1
        21 003050   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 003051   200070 236100                    LDQ     @SEND$,,AUTO
        21 003052   200103 756100                    STQ     @CONST$+3,,AUTO
        21 003053   200073 631500                    EPPR1   IDENT$,,AUTO
        21 003054   200102 451500                    STP1    @CONST$+2,,AUTO
        21 003055   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 003056   000002 631400 22                 EPPR1   2
        21 003057   000000 701000 xent               TSX1    Z8E7$MOVE_STATEMENT
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:219  
        21 003060   000000 011000                    NOP     0
        21 003061   003114 710000 21                 TRA     s:23632

     1495    23617    3       ELSE
     1496    23618            /* This is a DML SET and needs to have an extra level of indirection
     1497    23619               and subscript modifcation if needed since the grammar is set up
     1498    23620               for SET of index items not data base keys.                   */
     1499    23621
     1500    23622    4         DO;

     1501    23623    4           IF IDENT$ -> LX_LIST.HEAD$ ~= IDENT$ -> LX_LIST.TAIL$   THEN

  23623 21 003062   200073 471500                    LDP1    IDENT$,,AUTO
        21 003063   100004 236100                    LDQ     4,,PR1
        21 003064   100001 116100                    CMPQ    1,,PR1
        21 003065   003100 600000 21                 TZE     s:23629

     1502    23624
     1503    23625                       /*   We have a subscript     */
     1504    23626    4              CALL Z8EY$SUBSCRIPT(IDENT$ -> LX_LIST.TAIL$,

  23626 21 003066   200073 236100                    LDQ     IDENT$,,AUTO
        21 003067   000004 036003                    ADLQ    4,DU
        21 003070   200103 756100                    STQ     @CONST$+3,,AUTO
        21 003071   200073 236100                    LDQ     IDENT$,,AUTO
        21 003072   000001 036003                    ADLQ    1,DU
        21 003073   200102 756100                    STQ     @CONST$+2,,AUTO
        21 003074   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 003075   000014 631400 22                 EPPR1   12
        21 003076   000000 701000 xent               TSX1    Z8EY$SUBSCRIPT
        21 003077   000000 011000                    NOP     0

     1505    23627    4                                  IDENT$ -> LX_LIST.HEAD$);
     1506    23628
     1507    23629    4           CALL Z8E7$MOVE_STATEMENT(IDENT$->LX_LIST.HEAD$,SEND$, ,STATEMENT_TYPE);

  23629 21 003100   200072 236100                    LDQ     @STATEMENT_TYPE,,AUTO
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:220  
        21 003101   000001 235000 22                 LDA     1
        21 003102   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 003103   200070 236100                    LDQ     @SEND$,,AUTO
        21 003104   200103 756100                    STQ     @CONST$+3,,AUTO
        21 003105   200073 236100                    LDQ     IDENT$,,AUTO
        21 003106   000004 036003                    ADLQ    4,DU
        21 003107   200102 756100                    STQ     @CONST$+2,,AUTO
        21 003110   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 003111   000002 631400 22                 EPPR1   2
        21 003112   000000 701000 xent               TSX1    Z8E7$MOVE_STATEMENT
        21 003113   000000 011000                    NOP     0

     1508    23630    4         END;

     1509    23631
     1510    23632    3       IDENT$ = IDENT$ -> LX_ETT_ITEM.LINK;

  23632 21 003114   200073 470500                    LDP0    IDENT$,,AUTO
        21 003115   000007 236100                    LDQ     7,,PR0
        21 003116   200073 756100                    STQ     IDENT$,,AUTO

     1511    23633    3       VAL_REC_COUNT = VAL_REC_COUNT + 1 ;                     /*#28761*/

  23633 21 003117   200007 054100                    AOS     VAL_REC_COUNT,,AUTO

     1512    23634
     1513    23635    3     END;  /* DO WHILE */

  23635 21 003120   000001 116000 22                 CMPQ    1
        21 003121   003042 601000 21                 TNZ     s:23615

     1514    23636
     1515    23637    3     IF VAL_REQUIRED THEN DO ;                                 /*#28761*/

  23637 21 003122   200074 234100                    SZN     VAL_REQUIRED,,AUTO
        21 003123   003147 605000 21                 TPL     s:24021

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:221  
     1516    23638            %NEW_ILL (@ID = %VAL_END);

  23709 21 003124   000007 236000 22                 LDQ     7
        21 003125   200102 756100                    STQ     @CONST$+2,,AUTO
        21 003126   200102 630500                    EPPR0   @CONST$+2,,AUTO
        21 003127   200107 450500                    STP0    @CONST$+7,,AUTO
        21 003130   000010 236000 22                 LDQ     8
        21 003131   200106 756100                    STQ     @CONST$+6,,AUTO
        21 003132   000016 237000 22                 LDAQ    14
        21 003133   200104 757100                    STAQ    @CONST$+4,,AUTO
        21 003134   200104 630500                    EPPR0   @CONST$+4,,AUTO
        21 003135   000002 631400 22                 EPPR1   2
        21 003136   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        21 003137   000000 011000                    NOP     0

  23710 21 003140   000001 236000 22                 LDQ     1
        21 003141   000000 470400 16                 LDP0    ILL$
        21 003142   000001 756100                    STQ     1,,PR0

     1517    24017    3       IF VAL_REC_COUNT > COMCOM.MAX_RECEIVING_ITEMS THEN      /*#28761*/

  24017 21 003143   200007 236100                    LDQ     VAL_REC_COUNT,,AUTO
        21 003144   000360 116000 xsym               CMPQ    COMCOM+240
        21 003145   003147 604400 21                 TMOZ    s:24021

     1518    24018    3         COMCOM.MAX_RECEIVING_ITEMS = VAL_REC_COUNT ;

  24018 21 003146   000360 756000 xsym               STQ     COMCOM+240

     1519    24019    3     END ;

     1520    24020
     1521    24021    2   END MOVE_STATEMENT;

  24021 21 003147   200066 221300                    LDX1  ! @ON_OR_OFF,,AUTO
        21 003150   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:222  
     1522    24022        %EJECT ;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:223  
     1523    24023
     1524    24024           /* Main program  */
     1525    24025
     1526    24026    1      CALL SET_STATEMENT;

  24026 21 003151   000003 701000 21                 TSX1    SET_STATEMENT
        21 003152   000000 011000                    NOP     0

     1527    24027
     1528    24028    1    END Z8EX$SET_STATEMENT;

  24028 21 003153   000000 702200 xent               TSX2  ! X66_ARET
     1529    24029         %EJECT;
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:224  

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:225  
--  Include file information  --

   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_DML.:Z8A6TOU  is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EX$SET_STATEMENT.
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:226  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:227  
  ****  Section 005 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 006 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 007 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 008 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 009 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 010 LblCom ST$

PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:228  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 011 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 012 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 013 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 014 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 015 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:229  

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 016 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 017 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 018 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 019 LblCom TEMP_LX_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)         1 TEMP_LX_NODE

  ****  Section 020 RoData Z8EX$SET_STATEMENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 SW_VALUE(0:35)
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:230  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   100-0-0/w PTR         r     1 @CONST$                    3-0-0/w PTR         r     1 @KEY_WORD$
    67-0-0/w PTR         r     1 @KEY_WORD$                66-0-0/w PTR         r     1 @ON_OR_OFF
    73-0-0/w PTR         r     1 @REC$                     71-0-0/w PTR         r     1 @REC$
     4-0-0/w PTR         r     1 @RECEIVE$                 65-0-0/w PTR         r     1 @RECEIVE$
    65-0-0/w PTR         r     1 @RECEIVE$                 65-0-0/w PTR         r     1 @RECEIVE$
    65-0-0/w PTR         r     1 @RECEIVE$                 65-0-0/w PTR         r     1 @RECEIVE$
    65-0-0/w PTR         r     1 @RECEIVE$                 73-0-0/w PTR         r     1 @REC_SW#
     5-0-0/w PTR         r     1 @SEND$                    66-0-0/w PTR         r     1 @SEND$
    66-0-0/w PTR         r     1 @SEND$                    66-0-0/w PTR         r     1 @SEND$
    66-0-0/w PTR         r     1 @SEND$                    74-0-0/w PTR         r     1 @SEND$
    70-0-0/w PTR         r     1 @SEND$                    74-0-0/w PTR         r     1 @SEND_SW#
     6-0-0/w PTR         r     1 @SET_TYPE                 67-0-0/w PTR         r     1 @SET_TYPE
    72-0-0/w PTR         r     1 @STATEMENT_TYPE           77-0-0/w PTR         r     1 @SW#
    54-0-0/d STRC(288)   r     1 ASS_VAR                   25-0-0/w PTR         r     1 CONST$
    *0-0-0/w PTR         r     1 CONST$                    26-0-0/w PTR         r     1 END_LABEL$
    73-0-0/w PTR         r     1 IDENT$                    *0-0-0/w PTR         r     1 KEY_WORD$
    *0-0-0/w PTR         r     1 KEY_WORD$                 27-0-0/w PTR         r     1 OFF_SW_LABEL$
    *0-0-0/w SBIN        r     1 ON_OR_OFF                 20-0-0/w SBIN        r     1 ORIG_COLUMN#
    17-0-0/w SBIN        r     1 ORIG_LINE#                11-0-0/w PTR               1 P$
    12-0-0/w PTR         r     1 P1$                       13-0-0/w PTR         r     1 P2$
    14-0-0/w PTR         r     1 P3$                       15-0-0/w PTR         r     1 P4$
    22-0-0/w PTR         r     1 R$                        70-0-0/w PTR         r     1 R$
    75-0-0/w PTR         r     1 R$                        21-0-0/w PTR         r     1 REC$
    70-0-0/w PTR         r     1 REC$                      67-0-0/w PTR         r     1 REC$
    66-0-0/w PTR         r     1 REC$                      67-0-0/w PTR         r     1 REC$
    67-0-0/w PTR         r     1 REC$                      *0-0-0/w PTR         r     1 REC$
    *0-0-0/w PTR         r     1 REC$                      *0-0-0/w PTR         r     1 RECEIVE$
    *0-0-0/w PTR         r     1 RECEIVE$                  *0-0-0/w PTR         r     1 RECEIVE$
    *0-0-0/w PTR         r     1 RECEIVE$                  *0-0-0/w PTR         r     1 RECEIVE$
    *0-0-0/w PTR         r     1 RECEIVE$                  *0-0-0/w PTR         r     1 RECEIVE$
    *0-0-0/w SBIN        r     1 REC_SW#                   70-0-0/w PTR         r     1 S$
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:231  
    *0-0-0/w PTR         r     1 SEND$                     *0-0-0/w PTR         r     1 SEND$
    *0-0-0/w PTR         r     1 SEND$                     *0-0-0/w PTR         r     1 SEND$
    *0-0-0/w PTR         r     1 SEND$                     *0-0-0/w PTR         r     1 SEND$
    *0-0-0/w PTR         r     1 SEND$                     *0-0-0/w SBIN        r     1 SEND_SW#
    *0-0-0/w SBIN        r     1 SET_TYPE                  *0-0-0/w SBIN        r     1 SET_TYPE
    23-0-0/w PTR         r     1 ST$                       24-0-0/w PTR         r     1 ST2$
    *0-0-0/w SBIN        r     1 STATEMENT_TYPE            30-0-0/w SBIN        r     1 SW#
    *0-0-0/w SBIN        r     1 SW#                       31-0-0/w SBIN        r     1 SW2#
    44-0-0/d STRC(288)   r     1 SW_ON_COND                34-0-0/d STRC(288)   r     1 SW_VALUE
    16-0-0/w PTR         r     1 T$                         7-0-0/w SBIN        r     1 VAL_REC_COUNT
    32-0-0/b BIT         r     1 VAL_REQUIRED              74-0-0/b BIT         r     1 VAL_REQUIRED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:232  
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(396)   r     1 CONDITION
     0-0-0/w STRC(396)         1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)   r     1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)   r     1 ST
PL6.E3A0      #002=Z8EX$SET_STATEMENT File=Z8EX.:Z8A6TSI                         SAT 08/09/97 12:58 Page:233  
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(396)   r     1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)    r     1 UNARY_ILL                  0-0-0/w STRC(288)   r     1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(108)   r     1 VAL                        0-0-0/w STRC(108)   r     1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EX$SET_STATEMENT requires 1644 words for executable code.
   Procedure Z8EX$SET_STATEMENT requires 84 words of local(AUTO) storage.

    No errors detected in file Z8EX.:Z8A6TSI    .
