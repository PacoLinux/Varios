VERSION A06

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:1    
        1        1        /*M* Z8DI -- I/O after DD cleanup routines. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z8DI$IO_WRAPUP: PROC;
        8        8
        9        9        /*P*
       10       10             NAME : Z8DI$IO_WRAPUP
       11       11             PURPOSE : To do any remaining semantic checks and cleanup
       12       12              processing of the FILE_LTS's after the DATA DIVISION.
       13       13        */
       14       14
       15       15             %EQU PHASE = 1;
       16       16
       17       17             %INCLUDE Z8A_DEFC;
       18       85             %INCLUDE Z8A_SUPP_MAC;
       19     2485             %INCLUDE Z8A_COMCOM;
       20     3135             %INCLUDE Z8A_DNT;
       21     3356             %INCLUDE Z8A_LTS;
       22     5433             %INCLUDE Z8A_ETT;
       23     5734             %INCLUDE Z8A_ST;
       24     9393             %INCLUDE Z8A_TYPES;
       25     9567             %INCLUDE Z8A_ERR_NUMS;
       26    10331             %INCLUDE Z8A_IO_EQUS;
       27    10454             %INCLUDE Z8A_QLT;
       28    10560             %INCLUDE Z8A_MKCN;
       29    10577
       30    10578             %INCLUDE Z8E_STACKS;
       31    12844             %INCLUDE Z8E_O1COM;
       32    13605             %INCLUDE Z8E_MACROS;
       33    14280             %INCLUDE Z8E_WINDOW;
       34    16350             %INCLUDE Z8E_ABSSYN;
       35    16556             %INCLUDE Z8E_HEAP;
       36    16612
       37    16613    1        DCL Z8ED$DISPOSE_ABSSYN_TREE    ENTRY (1);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:2    
       38    16614    1        DCL Z9DI$BLK_CONTAINS         ENTRY (2);
       39    16615    1        DCL Z9DI$KEY_LENGTH_CHECK       ENTRY (1) ALTRET;
       40    16616    1        DCL Z8AE$ERROR                  ENTRY (12);
       41    16617    1        DCL Z8AF$NEW_BASE               ENTRY (3);
       42    16618    1        DCL Z8EC$CREATE_CONST           ENTRY (3) ALTRET;
       43    16619    1        DCL Z8AC$MAKE_CONST_D           ENTRY(1);
       44    16620    1        DCL Z8CO$QUALIFY_VARIABLE       ENTRY (2) ALTRET;
       45    16621    1        DCL Z8DO$LINK_WITH_LTS          ENTRY (2);
       46    16622    1        DCL Z8CO$INTEGER_CHECK          ENTRY (1) ALTRET;
       47    16623    1        DCL Z8CO$P_CHECK                ENTRY (1) ALTRET;
       48    16624    1        DCL Z8CO$UNSIGNED_CHECK         ENTRY (1) ALTRET;
       49    16625    1        DCL Z8CO$CHECK_NON_NEG_INT_TERM ENTRY (1) ALTRET;
       50    16626    1        DCL Z8CO$DISPL_CHECK            ENTRY (1) ALTRET;
       51    16627    1        DCL Z8DI$CHECK_CODE_SET               ENTRY (1);
       52    16628    1        DCL Z8AT$CREATE_TEMPORARY       ENTRY (2);
       53    16629    1        DCL Z8EV$CONVERT                ENTRY (3);
       54    16630    1        DCL Z9DI$FAB_FIB_BUILD          ENTRY (1);
       55    16631
       56    16632
       57    16633    1        DCL DNT$_FROM_RSWNO (0:0) PTR SYMREF READONLY;
       58    16634
       59    16635    1        DCL LTS$$                       PTR; /* To Current file_lts */
       60    16636
       61    16637
       62    16638        %EQU FORMAT_0 = 0;
       63    16639        %EQU FORMAT_1 = 1;
       64    16640        %EQU FORMAT_2 = 2;
       65    16641        %EQU FORMAT_3 = 3;
       66    16642        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:3    
       67    16643    1   SEQ_ORG: PROC (LTS$$);
       68    16644
       69    16645    2        DCL LTS$$         PTR; /* To current file_lts */
       70    16646    2        DCL P$            PTR;
       71    16647    2        DCL DCB_NUM$      PTR;
       72    16648
       73    16649
       74    16650             /* Items resolved
       75    16651                   1. Padding Character
       76    16652                   2. Linage Clause
       77    16653                   3. File Status
       78    16654                   4. Record Contains Clause
       79    16655             */
       80    16656
       81    16657    2        CALL PAD_CHAR (LTS$$);
       82    16658    2        CALL LINAGE (LTS$$);
       83    16659    2        CALL FILE_STATUS (LTS$$);
       84    16660    2        CALL RECORD_CLAUSE (LTS$$);
       85    16661    2        CALL RETENTION (LTS$$);
       86    16662    2        CALL FILE_ID (LTS$$);
       87    16663
       88    16664    2        IF LTS$$ -> FILE_LTS.CODE_SET$ ~= ADDR(NIL) THEN
       89    16665    2          CALL Z8DI$CHECK_CODE_SET (LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ -> QLT.SON);
       90    16666
       91    16667    2        IF LTS$$ -> FILE_LTS.RELATIVE_KEY$ ~= ADDR(NIL) THEN
       92    16668    3          DO;
       93    16669    3            P$ = LTS$$ -> FILE_LTS.RELATIVE_KEY$ -> LX_LIST.HEAD$;
       94    16670
       95    16671                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
       96    16672                              @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
       97    16673                              @LINE     = P$ -> LX_ITEM.LINE,
       98    16674                              @COLUMN   = P$ -> LX_ITEM.COLUMN,
       99    16675                              @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");
      100    16705    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RELATIVE_KEY$);
      101    16706    3          END;
      102    16707
      103    16708    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:4    
      104    16709    3          DO;
      105    16710    3            P$ = LTS$$ -> FILE_LTS.RECORD_KEY$ -> LX_LIST.HEAD$;
      106    16711
      107    16712                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
      108    16713                                     @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
      109    16714                                     @LINE     = P$ -> LX_ITEM.LINE,
      110    16715                                     @COLUMN   = P$ -> LX_ITEM.COLUMN,
      111    16716                                     @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");
      112    16746    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);
      113    16747    3          END;
      114    16748
      115    16749    2        IF LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ ~= ADDR(NIL) THEN
      116    16750    3          DO;
      117    16751    3            P$ = LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ -> LX_LIST.HEAD$ ->
      118    16752    3                 LX_LIST.HEAD$ -> LX_LIST.HEAD$;
      119    16753
      120    16754                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
      121    16755                                     @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
      122    16756                                     @LINE     = P$ -> LX_ITEM.LINE,
      123    16757                                     @COLUMN   = P$ -> LX_ITEM.COLUMN,
      124    16758                                     @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");
      125    16788    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.ALT_RECORD_KEY$);
      126    16789    3          END;
      127    16790
      128    16791
      129    16792    2   END SEQ_ORG;
      130    16793        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:5    
      131    16794    1   RETENTION: PROC (LTS$$);
      132    16795
      133    16796    2        DCL LTS$$         PTR;
      134    16797    2        DCL RET$          PTR;
      135    16798    2        DCL RETURN_ETT$   PTR;
      136    16799    2        DCL RET_ST$       PTR;
      137    16800    2        DCL LINE          SBIN;
      138    16801    2        DCL COLUMN        SBIN;
      139    16802             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      140    16806
      141    16807
      142    16808
      143    16809    2        IF LTS$$ -> FILE_LTS.RETENTION$ = ADDR(NIL) THEN
      144    16810    2          RETURN;
      145    16811
      146    16812    2        RET$ = LTS$$ -> FILE_LTS.RETENTION$;
      147    16813
      148    16814    3        DO CASE (RET$ -> LX_ITEM.ID);
      149    16815
      150    16816    3          CASE (%LX_TERMINAL);
      151    16817    4            DO CASE (RET$ -> LX_TERMINAL.SYMBOL);
      152    16818
      153    16819    4              CASE (%NUMBER,         %NUMBER_OR_PARAGRAPH,
      154    16820    4                    %NUMERIC_LITERAL,%RSV_WRD_ZEROES);
      155    16821    4                CALL Z8CO$CHECK_NON_NEG_INT_TERM (RET$)
      156    16822    4                  WHENALTRETURN
      157    16823    5                    DO;
      158    16824                           %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      159    16825                                       @ERROR#   = %E$INVALID_RETENTION_ITEM,
      160    16826                                       @LINE     = RET$ -> LX_ITEM.LINE,
      161    16827                                       @COLUMN   = RET$ -> LX_ITEM.COLUMN);
      162    16857
      163    16858    5                      CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ ->
      164    16859    5                                                     FILE_LTS.RETENTION$);
      165    16860    5                      RETURN;
      166    16861    5                    END;
      167    16862
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:6    
      168    16863    4                MKCN.CONA = RET$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME;
      169    16864    4                CALL Z8AC$MAKE_CONST_D( RETURN_ETT$ );
      170    16865
      171    16866    4                IF RET$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.LENGTH  >  3  THEN
      172    16867    5                  DO;
      173    16868                         %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      174    16869                                             @ERROR#   = %E$INVALID_RETENTION_ITEM,
      175    16870                                             @LINE     = RET$ -> LX_ITEM.LINE,
      176    16871                                             @COLUMN   = RET$ -> LX_ITEM.COLUMN);
      177    16901
      178    16902    5                    CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      179    16903    5                    RETURN;
      180    16904    5                  END;
      181    16905
      182    16906    4                RETURN_ETT$ -> ETT.LOP -> CONST.NDSC.N = RET$ -> LX_TERMINAL.DNT$ ->
             16906                         DNT.TEXT.LENGTH;
      183    16907    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      184    16908
      185    16909    4                LTS$$ -> FILE_LTS.RETENTION$ = RETURN_ETT$ -> ETT.LOP;
      186    16910
      187    16911    4              CASE (ELSE);
      188    16912                     %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      189    16913                                         @ERROR#   = %E$INVALID_RETENTION_ITEM,
      190    16914                                         @LINE     = RET$ -> LX_ITEM.LINE,
      191    16915                                         @COLUMN   = RET$ -> LX_ITEM.COLUMN);
      192    16945
      193    16946    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      194    16947    4            END; /* Case -- RET.symbol */
      195    16948
      196    16949    3          CASE (%LX_LIST);
      197    16950    3            LINE   = RET$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
      198    16951    3            COLUMN = RET$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;
      199    16952
      200    16953    3            CALL Z8CO$QUALIFY_VARIABLE (RET$, RET_ST$) ALTRET (BAD_RET);
      201    16954
      202    16955                 %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      203    16956                                    @ETT$    = RET_ST$,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:7    
      204    16957                                    @TYPE    = RET_ST$ -> ST.TYPE,
      205    16958                                    @LINE    = LINE,
      206    16959                                    @COLUMN  = COLUMN);
      207    16981
      208    16982    3            CALL Z8CO$DISPL_CHECK (ADDR(ETT_ITEM)) ALTRET (BAD_RET);
      209    16983
      210    16984    3            CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM)) ALTRET (BAD_RET);
      211    16985
      212    16986    3            CALL CHECK_FOR_WORKING_STORAGE (RET_ST$, RET$, LINE, COLUMN)
      213    16987    3                                            ALTRET (BAD_RET);
      214    16988
      215    16989    3            IF RET_ST$ -> SCALAR.B.SUB_CLASS.TYPE ~= %CLASS_NUMERIC
      216    16990    3            OR RET_ST$ -> ST.NDSC.N > 3 THEN
      217    16991    4              DO;
      218    16992                     %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      219    16993                                         @ERROR#   = %E$INVALID_RETENTION_ITEM,
      220    16994                                         @LINE     = LINE,
      221    16995                                         @COLUMN   = COLUMN);
      222    17025
      223    17026    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      224    17027    4                RETURN;
      225    17028    4              END;
      226    17029
      227    17030    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      228    17031
      229    17032    3            LTS$$ -> FILE_LTS.RETENTION$ = RET_ST$;
      230    17033
      231    17034    3          CASE (ELSE);
      232    17035    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      233    17036
      234    17037    3        END; /* Case */
      235    17038
      236    17039    2        RETURN;
      237    17040
      238    17041    2   BAD_RET:
      239    17042    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
      240    17043    2        RETURN;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:8    
      241    17044
      242    17045    2   END RETENTION;
      243    17046        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:9    
      244    17047    1   PAD_CHAR: PROC (LTS$$);
      245    17048
      246    17049    2        DCL LTS$$         PTR;
      247    17050    2        DCL PAD_ST$       PTR;
      248    17051    2        DCL PAD_CHAR$     PTR;
      249    17052    2        DCL FATHER$       PTR;
      250    17053    2        DCL LINE#         SBIN;
      251    17054    2        DCL COLUMN#       SBIN;
      252    17055
      253    17056
      254    17057    2        IF LTS$$ -> FILE_LTS.PAD_CHAR$ = ADDR(NIL) THEN
      255    17058    2          RETURN;
      256    17059
      257    17060    2        PAD_CHAR$ = LTS$$ -> FILE_LTS.PAD_CHAR$;
      258    17061
      259    17062    2        IF PAD_CHAR$ -> LX_ITEM.ID = %LX_LIST THEN
      260    17063    3          DO;
      261    17064                 /* Pad char is a data name, possibly qualified */
      262    17065    3            CALL Z8CO$QUALIFY_VARIABLE (PAD_CHAR$,
      263    17066    3                                        PAD_ST$)
      264    17067    3              WHENALTRETURN
      265    17068    4                DO;
      266    17069    4                  CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);
      267    17070    4                  RETURN;
      268    17071    4                END;
      269    17072
      270    17073    3            COLUMN# = PAD_CHAR$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;
      271    17074    3            LINE#   = PAD_CHAR$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
      272    17075    3          END;
      273    17076    2        ELSE
      274    17077    3          DO;
      275    17078                 /* Pad char is a nonnumeric literal, not a fig const */
      276    17079    3            CALL Z8EC$CREATE_CONST (%TYA,
      277    17080    3                                    PAD_CHAR$,
      278    17081    3                                    PAD_ST$);
      279    17082
      280    17083    3            COLUMN# = PAD_CHAR$ -> LX_TERMINAL.COLUMN;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:10   
      281    17084    3            LINE#   = PAD_CHAR$ -> LX_TERMINAL.LINE;
      282    17085
      283    17086    3            PAD_ST$ = PAD_ST$ -> ETT.LOP; /* Triad returned from const */
      284    17087    3          END;
      285    17088
      286    17089    2        IF PAD_ST$ -> ST.TYPE ~= %TYA THEN
      287    17090    3          DO;
      288    17091                 %CONDITIONAL_ERROR (@LX_ITEM$ = PAD_CHAR$,
      289    17092                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      290    17093                                     @LINE     = LINE#,
      291    17094                                     @COLUMN   = COLUMN#);
      292    17124    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);
      293    17125    3            RETURN;
      294    17126    3          END;
      295    17127
      296    17128    2        IF PAD_ST$ -> ST.ADSC.N ~= 1 THEN
      297    17129    3          DO;
      298    17130                 %CONDITIONAL_ERROR (@LX_ITEM$ = PAD_CHAR$,
      299    17131                                     @ERROR#   = %E$MUST_BE_1_CHAR_LONG,
      300    17132                                     @LINE     = LINE#,
      301    17133                                     @COLUMN   = COLUMN#);
      302    17163
      303    17164    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);
      304    17165    3            RETURN;
      305    17166    3          END;
      306    17167
      307    17168    2        CALL CHECK_FOR_WORKING_STORAGE (PAD_ST$,
      308    17169    2                                        PAD_CHAR$,
      309    17170    2                                        LINE#,
      310    17171    2                                        COLUMN#)
      311    17172    2          WHENALTRETURN
      312    17173    3            DO;
      313    17174    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);
      314    17175    3              RETURN;
      315    17176    3            END;
      316    17177
      317    17178    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:11   
      318    17179
      319    17180    2        LTS$$ -> FILE_LTS.PAD_CHAR$ = PAD_ST$;
      320    17181
      321    17182    2   END PAD_CHAR;
      322    17183        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:12   
      323    17184    1   FILE_ID: PROC (LTS$$);
      324    17185
      325    17186    2        DCL LTS$$         PTR;
      326    17187
      327    17188    2        CALL CHECK_ID (LTS$$ -> FILE_LTS.FILE_ID$);
      328    17189
      329    17190    2        CALL CHECK_ID (LTS$$ -> FILE_LTS.CATALOG$);
      330    17191
      331    17192    2   END FILE_ID;
      332    17193        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:13   
      333    17194    1   CHECK_ID: PROC (ID$);
      334    17195    2        DCL ID$           PTR;
      335    17196    2        DCL ITEM_ST$      PTR;
      336    17197    2        DCL LINE          SBIN;
      337    17198    2        DCL LENGTH        SBIN;
      338    17199    2        DCL COLUMN        SBIN;
      339    17200
      340    17201
      341    17202    2        IF ID$ = ADDR(NIL) THEN
      342    17203    2          RETURN;
      343    17204
      344    17205
      345    17206    3        DO CASE (ID$ -> LX_ITEM.ID);
      346    17207
      347    17208    3          CASE (%LX_TERMINAL);
      348    17209    4            DO CASE (ID$ -> LX_ITEM.SYMBOL);
      349    17210
      350    17211    4              CASE (%ALPHA_LITERAL);
      351    17212    4                IF ID$ -> LX_ITEM.DNT$ -> DNT.ST$ ~= ADDR (NIL) THEN
      352    17213    5                  IF ID$ -> LX_ITEM.DNT$ -> DNT.ST$ -> ST.ID = %SYM_CHAR THEN DO ;
      353    17214                         /* Symbolic characters are illegal here. */
      354    17215                         %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      355    17216                                             @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      356    17217                                             @LINE     = ID$ -> LX_ITEM.LINE,
      357    17218                                             @COLUMN   = ID$ -> LX_ITEM.COLUMN);
      358    17248
      359    17249    5                    CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      360    17250    5                    RETURN;
      361    17251    5                  END;
      362    17252
      363    17253    4                CALL Z8EC$CREATE_CONST (%TYA, ID$, ETT$);
      364    17254    4                ETT$ = ETT$ -> ETT.LOP;
      365    17255
      366    17256    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      367    17257    4                ID$ = ETT$;
      368    17258
      369    17259    4              CASE (%SINGLE_QUOTE);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:14   
      370    17260    4                CALL Z8EC$CREATE_CONST (%TYA, ID$, ETT$);
      371    17261    4                ETT$ = ETT$ -> ETT.LOP;
      372    17262
      373    17263    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      374    17264    4                ID$ = ETT$;
      375    17265
      376    17266    4              CASE (ELSE);
      377    17267                     %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      378    17268                                         @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      379    17269                                         @LINE     = ID$ -> LX_ITEM.LINE,
      380    17270                                         @COLUMN   = ID$ -> LX_ITEM.COLUMN);
      381    17300
      382    17301    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      383    17302    4                RETURN;
      384    17303
      385    17304    4            END; /* Case */
      386    17305
      387    17306    3          CASE (%LX_LIST);
      388    17307    3            LINE   = ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
      389    17308    3            COLUMN = ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;
      390    17309
      391    17310    3            CALL Z8CO$QUALIFY_VARIABLE (ID$, ITEM_ST$)
      392    17311    3              WHENALTRETURN
      393    17312    4                DO;
      394    17313    4                  CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      395    17314    4                  RETURN;
      396    17315    4                END;
      397    17316
      398    17317    3            IF (ITEM_ST$ -> SCALAR.ID ~= %SCALAR AND
      399    17318    3                ITEM_ST$ -> SCALAR.ID ~= %ARRAY) OR
      400    17319    3                ITEM_ST$ -> SCALAR.B.SUB_CLASS.TYPE ~= %CLASS_ALPHANUMERIC THEN
      401    17320    4              DO;
      402    17321                     %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      403    17322                                         @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      404    17323                                         @LINE     = LINE,
      405    17324                                         @COLUMN   = COLUMN);
      406    17354
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:15   
      407    17355    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      408    17356    4                RETURN;
      409    17357    4              END;
      410    17358
      411    17359                 %GET_ADSC_LEN (ST$ = ITEM_ST$,
      412    17360                                RTN = LENGTH);
      413    17371
      414    17372    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);
      415    17373
      416    17374    3            ID$ = ITEM_ST$;
      417    17375
      418    17376
      419    17377    3          CASE (ELSE);
      420    17378
      421    17379    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      422    17380
      423    17381    3        END; /* Case */
      424    17382
      425    17383    2   END CHECK_ID;
      426    17384        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:16   
      427    17385    1   NEW_IO_STATUS_TEMP: PROC (ST$$);
      428    17386
      429    17387    2        DCL ST$$          PTR;
      430    17388
      431    17389
      432    17390    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ST$$);
      433    17391
      434    17392    2        ST$$ -> SCALAR.TYPE = %TYA;
      435    17393    2        ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;
      436    17394    2        ST$$ -> SCALAR.ADSC.N  = 2;
      437    17395
      438    17396
      439    17397    2   END NEW_IO_STATUS_TEMP;
      440    17398        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:17   
      441    17399    1   FILE_STATUS: PROC (LTS$$);
      442    17400
      443    17401    2        DCL LTS$$         PTR;
      444    17402    2        DCL IO_STAT$      PTR;
      445    17403    2        DCL LINE          SBIN;
      446    17404    2        DCL COLUMN        SBIN;
      447    17405
      448    17406
      449    17407    2        IF LTS$$ -> FILE_LTS.FILE_STATUS$ = ADDR(NIL) THEN
      450    17408    3          DO;
      451    17409    3            CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);
      452    17410    3            RETURN;
      453    17411    3          END;
      454    17412
      455    17413    2        CALL Z8CO$QUALIFY_VARIABLE (LTS$$ -> FILE_LTS.FILE_STATUS$,
      456    17414    2                                    IO_STAT$)
      457    17415    2          WHENALTRETURN
      458    17416    3            DO;
      459    17417    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);
      460    17418    3              CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);
      461    17419    3              RETURN;
      462    17420    3            END;
      463    17421
      464    17422    2        COLUMN = LTS$$ -> FILE_LTS.FILE_STATUS$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;
      465    17423    2        LINE   = LTS$$ -> FILE_LTS.FILE_STATUS$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
      466    17424
      467    17425    2        IF IO_STAT$ -> ST.TYPE ~= %TYA
      468    17426    2        OR IO_STAT$ -> SCALAR.B.CLASS ~= %CLASS_ALPHANUMERIC THEN
      469    17427    3          DO;
      470    17428                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.FILE_STATUS$,
      471    17429                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      472    17430                                     @LINE     = LINE,
      473    17431                                     @COLUMN   = COLUMN);
      474    17461    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);
      475    17462    3            RETURN;
      476    17463    3          END;
      477    17464
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:18   
      478    17465    2        IF IO_STAT$ -> ST.ADSC.N ~= 2 THEN
      479    17466    3          DO;
      480    17467                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.FILE_STATUS$,
      481    17468                                     @ERROR#   = %E$MUST_BE_2_CHAR_LONG,
      482    17469                                     @LINE     = LINE,
      483    17470                                     @COLUMN   = COLUMN);
      484    17500
      485    17501    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);
      486    17502    3            CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);
      487    17503    3            RETURN;
      488    17504    3          END;
      489    17505
      490    17506    2        CALL CHECK_FOR_WORKING_STORAGE (IO_STAT$,
      491    17507    2                                        LTS$$ -> FILE_LTS.FILE_STATUS$,
      492    17508    2                                        LINE, COLUMN)
      493    17509    2          WHENALTRETURN
      494    17510    3            DO;
      495    17511    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);
      496    17512    3              RETURN;
      497    17513    3            END;
      498    17514
      499    17515    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);
      500    17516
      501    17517    2        LTS$$ -> FILE_LTS.FILE_STATUS$ = IO_STAT$;
      502    17518    2        LTS$$ -> FILE_LTS.FILE_STATUS2$ = ADDR(NIL);
      503    17519
      504    17520    2   END FILE_STATUS;
      505    17521        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:19   
      506    17522    1   CHECK_FOR_WORKING_STORAGE: PROC (ST$$, ITEM$, LINE#, COLUMN#) ALTRET;
      507    17523
      508    17524    2        DCL ST$$          PTR;
      509    17525    2        DCL ITEM$         PTR;
      510    17526    2        DCL FATHER$       PTR;
      511    17527    2        DCL LINE#         SBIN;
      512    17528    2        DCL COLUMN#       SBIN;
      513    17529
      514    17530
      515    17531    2        IF ST$$ -> ST.ID ~= %CONST THEN
      516    17532    3          DO;
      517    17533    3            IF ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY THEN
      518    17534    4              DO;
      519    17535                     %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      520    17536                                         @ERROR#   = %E$MUST_BE_IN_WORK_STORAGE,
      521    17537                                         @LINE     = LINE#,
      522    17538                                         @COLUMN   = COLUMN#);
      523    17568
      524    17569    4                ALTRETURN;
      525    17570    4              END;
      526    17571    3            FATHER$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;
      527    17572
      528    17573    4            DO WHILE (FATHER$ ~= ADDR(NIL));
      529    17574    4              IF FATHER$ -> QLT.ST$ -> ST.ID = %FD
      530    17575    4              OR FATHER$ -> QLT.ST$ -> ST.ID = %RD
      531    17576    4              OR FATHER$ -> QLT.ST$ -> ST.ID = %CD THEN
      532    17577    5                DO;
      533    17578                       %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      534    17579                                           @ERROR#   = %E$MUST_BE_IN_WORK_STORAGE,
      535    17580                                           @LINE     = LINE#,
      536    17581                                           @COLUMN   = COLUMN#);
      537    17611
      538    17612    5                  ALTRETURN;
      539    17613    5                END;
      540    17614
      541    17615    4              FATHER$ = FATHER$ -> QLT.FATHER;
      542    17616    4            END; /* While */
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:20   
      543    17617    3          END;
      544    17618
      545    17619    2   END CHECK_FOR_WORKING_STORAGE;
      546    17620        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:21   
      547    17621    1   LINAGE: PROC (LTS$$);
      548    17622
      549    17623    2        DCL LTS$$         PTR;
      550    17624    2        DCL LINES$        PTR;
      551    17625    2        DCL FOOT$         PTR;
      552    17626    2        DCL TOP$          PTR;
      553    17627    2        DCL BOTTOM$       PTR;
      554    17628    2        DCL LINE          SBIN;
      555    17629    2        DCL COLUMN        SBIN;
      556    17630    2        DCL ST$$          PTR;
      557    17631
      558    17632             %MACRO LINAGE_ERROR (@FIELD$ = , @ERROR# = );
      559    17633
      560    17634                 %LSET @@@ITEM_LINE = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      561    17635                                                '-> LX_ITEM.LINE'));
      562    17636                 %LSET @@@ITEM_COL  = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      563    17637                                                '-> LX_ITEM.COLUMN'));
      564    17638                 %LSET @@@LIST_LINE = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      565    17639                                                '-> LX_LIST.HEAD$ -> LX_ITEM.LINE'));
      566    17640                 %LSET @@@LIST_COL  = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      567    17641                                                '-> LX_LIST.HEAD$ -> LX_ITEM.COLUMN'));
      568    17642                 DO;
      569    17643                   IF @FIELD$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      570    17644                     %CONDITIONAL_ERROR (@LX_ITEM$ = @FIELD$,
      571    17645                         @ERROR# = @ERROR#,
      572    17646                         @LINE   = "%@@@ITEM_LINE",
      573    17647                         @COLUMN = "%@@@ITEM_COL");
      574    17648                   ELSE
      575    17649                     %CONDITIONAL_ERROR (@LX_ITEM$ = @FIELD$,
      576    17650                         @ERROR# = @ERROR#,
      577    17651                         @LINE   = "%@@@LIST_LINE",
      578    17652                         @COLUMN = "%@@@LIST_COL");
      579    17653
      580    17654                   CALL Z8ED$DISPOSE_ABSSYN_TREE (@FIELD$);
      581    17655                 END;
      582    17656             %MEND;
      583    17657             %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:22   
      584    17658    2        IF LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = ADDR(NIL) THEN
      585    17659    3          DO;
      586    17660    3            IF LTS$$ -> FILE_LTS.LINAGE.FOOTING$ ~= ADDR(NIL) THEN
      587    17661                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      588    17662                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);
      589    17743
      590    17744    3            IF LTS$$ -> FILE_LTS.LINAGE.BOTTOM$ ~= ADDR(NIL) THEN
      591    17745                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.BOTTOM$,
      592    17746                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);
      593    17827
      594    17828    3            IF LTS$$ -> FILE_LTS.LINAGE.TOP$ ~= ADDR(NIL) THEN
      595    17829                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.TOP$,
      596    17830                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);
      597    17911
      598    17912    3            RETURN;
      599    17913    3          END;
      600    17914
      601    17915    2        LINES$   = ADDR(NIL);
      602    17916    2        BOTTOM$  = ADDR(NIL);
      603    17917    2        FOOT$    = ADDR(NIL);
      604    17918    2        TOP$     = ADDR(NIL);
      605    17919
      606    17920    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$,
      607    17921    2                                 LINES$);
      608    17922    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      609    17923    2                                 FOOT$);
      610    17924    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.BOTTOM$,
      611    17925    2                                 BOTTOM$);
      612    17926    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.TOP$,
      613    17927    2                                 TOP$);
      614    17928
      615    17929    2        IF FOOT$ ~= ADDR(NIL)
      616    17930    2        AND FOOT$ = COMCOM.VALUE_0 -> ETT.LOP THEN
      617    17931    3          DO;
      618    17932                 %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      619    17933                                @ERROR# = %E$MUST_BE_GTR_ZERO);
      620    18014    3            FOOT$ = COMCOM.VALUE_1 -> ETT.LOP;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:23   
      621    18015    3          END;
      622    18016
      623    18017    2        IF LINES$ = COMCOM.VALUE_0 -> ETT.LOP THEN
      624    18018    3          DO;
      625    18019                 %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$,
      626    18020                                @ERROR# = %E$MUST_BE_GTR_ZERO);
      627    18101    3            LINES$ = COMCOM.ARGS2 -> ETT.LOP;
      628    18102    3          END;
      629    18103
      630    18104    2        IF  FOOT$ ~= ADDR(NIL)
      631    18105    2        AND FOOT$ -> ST.ID = %CONST THEN
      632    18106    2          IF LINES$ -> ST.ID = %CONST THEN
      633    18107    2            IF FOOT$ -> CONST.CONSTI.WORD1 > LINES$ -> CONST.CONSTI.WORD1 THEN
      634    18108    3              DO;
      635    18109                     %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      636    18110                                    @ERROR# = %E$FOOTING_GTR_LINES);
      637    18191    3                ST$$ = FOOT$;
      638    18192    3                FOOT$ = LINES$;
      639    18193    3                LINES$ = ST$$;
      640    18194    3              END;
      641    18195
      642    18196    2        IF LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ ~= ADDR(NIL) THEN
      643    18197    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$);
      644    18198
      645    18199    2        IF LTS$$ -> FILE_LTS.LINAGE.BOTTOM$ ~= ADDR(NIL) THEN
      646    18200    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.BOTTOM$);
      647    18201
      648    18202    2        IF LTS$$ -> FILE_LTS.LINAGE.TOP$ ~= ADDR(NIL) THEN
      649    18203    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.TOP$);
      650    18204
      651    18205    2        IF LTS$$ -> FILE_LTS.LINAGE.FOOTING$ ~= ADDR(NIL) THEN
      652    18206    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.FOOTING$);
      653    18207
      654    18208    2        LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = LINES$;
      655    18209    2        LTS$$ -> FILE_LTS.LINAGE.FOOTING$     = FOOT$;
      656    18210    2        LTS$$ -> FILE_LTS.LINAGE.BOTTOM$      = BOTTOM$;
      657    18211    2        LTS$$ -> FILE_LTS.LINAGE.TOP$         = TOP$;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:24   
      658    18212
      659    18213
      660    18214    2   END LINAGE;
      661    18215        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:25   
      662    18216    1   VERIFY_LINAGE_ITEM: PROC (ITEM$, ST$$);
      663    18217
      664    18218    2        DCL ITEM$         PTR;
      665    18219    2        DCL ST$$          PTR;
      666    18220
      667    18221             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      668    18225
      669    18226
      670    18227    2        IF ITEM$ = ADDR(NIL) THEN
      671    18228    2          RETURN;
      672    18229
      673    18230    2        IF ITEM$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      674    18231    3          DO;
      675    18232    3            CALL Z8EC$CREATE_CONST (%TYI, ITEM$, ST$$)
      676    18233    3              WHENALTRETURN
      677    18234    4                DO;
      678    18235                       %CONDITIONAL_ERROR
      679    18236                         (@LX_ITEM$ = ITEM$,
      680    18237                          @ERROR#   = %E$VALUE_OVERFLOW,
      681    18238                          @LINE     = ITEM$ -> LX_TERMINAL.LINE,
      682    18239                          @COLUMN   = ITEM$ -> LX_TERMINAL.COLUMN);
      683    18269    4                END;
      684    18270    3            ST$$ = ST$$ -> ETT.LOP;
      685    18271    3            RETURN;
      686    18272    3          END;
      687    18273
      688    18274    2        CALL Z8CO$QUALIFY_VARIABLE (ITEM$, ST$$);
      689    18275
      690    18276             %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      691    18277                                @ETT$    = ST$$,
      692    18278                                @LINE    = ITEM$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      693    18279                                @COLUMN  = ITEM$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
      694    18280                                @TYPE    = ST$$ -> ST.TYPE);
      695    18302
      696    18303    2        IF NOT ST$$ -> SCALAR.B.ELEMENTARY THEN
      697    18304    3          DO;
      698    18305                 /* Must be elementary */
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:26   
      699    18306                 %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      700    18307                                     @ERROR#   = %E$MUST_BE_ELEMENTARY,
      701    18308                                     @LINE     = "ADDR(ETT_ITEM) -> LX_ITEM.LINE",
      702    18309                                     @COLUMN   = "ADDR(ETT_ITEM) -> LX_ITEM.COLUMN");
      703    18339    3            ST$$ = COMCOM.VALUE_1 -> ETT.LOP;
      704    18340    3            RETURN;
      705    18341    3          END;
      706    18342
      707    18343    2        CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))
      708    18344    2          WHENALTRETURN
      709    18345    3            DO;
      710    18346    3              ST$$ = COMCOM.VALUE_1 -> ETT.LOP;
      711    18347    3              RETURN;
      712    18348    3            END;
      713    18349
      714    18350    2        CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))
      715    18351    2          WHENALTRETURN
      716    18352    3            DO;
      717    18353    3              ST$$ = COMCOM.VALUE_1 -> ETT.LOP;
      718    18354    3              RETURN;
      719    18355    3            END;
      720    18356
      721    18357    2   END VERIFY_LINAGE_ITEM;
      722    18358        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:27   
      723    18359    1   RECORD_CLAUSE: PROC (LTS$$);
      724    18360
      725    18361    2   DCL LTS$$         PTR;
      726    18362    2   DCL INT1          SBIN;
      727    18363    2   DCL INT2          SBIN;
      728    18364    2   DCL FORMAT        SBIN;
      729    18365
      730    18366
      731    18367    2   IF LTS$$ -> FILE_LTS.B.RECORD_CONTAINS     THEN
      732    18368    3     DO;
      733    18369    3       IF LTS$$ -> FILE_LTS.B.RECORD_FORMAT_2     THEN
      734    18370    3         CALL RECORD_FORMAT_2( LTS$$, FORMAT );
      735    18371    3       ELSE
      736    18372    3         IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 0    THEN
      737    18373    3           FORMAT = %FORMAT_1;
      738    18374    3         ELSE
      739    18375    3           FORMAT = %FORMAT_3;
      740    18376    3      END;
      741    18377    2   ELSE
      742    18378    2     FORMAT = %FORMAT_0;
      743    18379
      744    18380    2   CALL CALC_MAX_BYTES( LTS$$, INT1, INT2, FORMAT );
      745    18381
      746    18382    2   IF FORMAT = %FORMAT_2  THEN
      747    18383    2     LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = MINIMUM( INT1, LTS$$ ->
      748    18384    2                              FILE_LTS.RECORD_CONTAINS.INT_1);
      749    18385    2   ELSE
      750    18386    3     DO;
      751    18387    3       LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2 = INT2;
      752    18388    3       IF FORMAT = %FORMAT_0 AND LTS$$ -> FILE_LTS.B.RECORD_FORMAT_2  THEN
      753    18389    4         DO;
      754    18390    4           IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 0     THEN
      755    18391    4             LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 1;
      756    18392    4           ELSE
      757    18393    4             LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = MINIMUM( INT1, LTS$$
      758    18394    4                   -> FILE_LTS.RECORD_CONTAINS.INT_1 );
      759    18395    4         END;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:28   
      760    18396    3       ELSE
      761    18397    3         LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = INT1;
      762    18398    3     END;
      763    18399
      764    18400    2   IF LTS$$ -> FILE_LTS.B.FLR AND
      765    18401    2       LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 < LTS$$ -> FILE_LTS.RECORD_CONTAINS.
             18401                INT_2 THEN
      766    18402            /* INT_1 and INT_2 are the lower and upper bounds from the
      767    18403               RECORD CONTAINS or RECORD VARYING clause, or if neither of
      768    18404               these clauses is present then the lengths of the shortest
      769    18405               and longest records defined in the FD or SD. */
      770    18406    2     CALL Z8AE$ERROR (%E$FLR_ILLEGAL,
      771    18407    2                      BINBIT(LTS$$ -> FILE_LTS.ST$ -> ST.LINE_NO,36),
      772    18408    2                      0);
      773    18409
      774    18410    2   CALL Z9DI$BLK_CONTAINS (LTS$$, LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2);
      775    18411
      776    18412    2   END RECORD_CLAUSE;
      777    18413        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:29   
      778    18414    1   ASSIGN_ADSC_DESC: PROC (ST$$, LENGTH);
      779    18415
      780    18416    2        DCL ST$$          PTR;
      781    18417    2        DCL LENGTH        SBIN;
      782    18418
      783    18419    2        DCL LONG$$        PTR;
      784    18420    2        DCL 1 DESC        ALIGNED,
      785    18421                   %DESCRIPTOR (LVL = 2, ENDING = YES);
      786    18449
      787    18450
      788    18451    2        ST$$ -> ST.TYPE = %TYA;
      789    18452
      790    18453    2        IF LENGTH > 4095 THEN
      791    18454    3          DO;
      792    18455    3            ST$$ -> SCALAR.B.LENGTH_4096 = TRUE;
      793    18456
      794    18457    3            IF LENGTH >= %#256K THEN
      795    18458    3              ST$$ -> SCALAR.B.GREATER_256K = TRUE;
      796    18459
      797    18460                 %NEW_LONG (@POINTER = LONG$$,
      798    18461                            @LENGTH  = LENGTH);
      799    18553
      800    18554    3            CALL Z8DO$LINK_WITH_LTS (ST$$ -> SCALAR.LTS$, LONG$$);
      801    18555
      802    18556                 %PACK_ADSC (@DESC = DESC, @LENGTH = LENGTH);
      803    18580    3          END;
      804    18581    2        ELSE
      805    18582               %PACK_ADSC (@DESC = DESC, @LENGTH = LENGTH);
      806    18606
      807    18607    2        ST$$ -> ST.DESCL = DESC.DESCL;
      808    18608
      809    18609    2   END ASSIGN_ADSC_DESC;
      810    18610        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:30   
      811    18611    1   CALC_BYTES: PROC (ST$$, LEN);
      812    18612
      813    18613    2        DCL ST$$          PTR;
      814    18614    2        DCL LEN        SBIN;
      815    18615
      816    18616    3       DO CASE (ST$$ -> ST.TYPE);
      817    18617
      818    18618    3         CASE (%TYA, %TYE, %TYB);
      819    18619                %GET_ADSC_LEN (ST$ = ST$$, RTN = LEN);
      820    18630
      821    18631    3         CASE (%TYD);
      822    18632    3           IF ST$$ -> ST.NDSC.TN = %NDSC4 THEN
      823    18633    3             LEN = (ST$$ -> ST.NDSC.N + 1) / 2;
      824    18634    3           ELSE
      825    18635    3             LEN = ST$$ -> ST.NDSC.N;
      826    18636
      827    18637    3         CASE (ELSE);
      828    18638    3           LEN = ST$$ -> ST.NDSC.N;
      829    18639
      830    18640    3       END; /* Case */
      831    18641
      832    18642    2   END CALC_BYTES;
      833    18643        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:31   
      834    18644    1   CALC_MAX_BYTES: PROC (LTS$$, MIN, MAX, FORMAT);
      835    18645
      836    18646    2        DCL LTS$$         PTR;
      837    18647    2        DCL LEN           SBIN;
      838    18648    2        DCL MAX           SBIN;
      839    18649    2        DCL MIN           SBIN;
      840    18650    2        DCL ST$$          PTR;
      841    18651    2        DCL QLT$$         PTR;
      842    18652    2        DCL INT_1         SBIN;
      843    18653    2        DCL INT_2         SBIN;
      844    18654    2        DCL FORMAT        SBIN;
      845    18655    2        DCL OCCURS_MIN    SBIN;
      846    18656    2        DCL DEP_SIZE$     PTR;
      847    18657
      848    18658
      849    18659    2        QLT$$ = LTS$$ -> FILE_LTS.ST$ -> SCALAR.QLT$ -> QLT.SON
      850    18660    2                     -> QLT.ST$ -> SCALAR.QLT$ -> QLT.BROTHER;
      851    18661
      852    18662    2        INT_1 = LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1;
      853    18663    2        INT_2 = LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2;
      854    18664    2        MAX  = 0;
      855    18665    2        MIN = 9999999;
      856    18666
      857    18667    3        DO WHILE (QLT$$ ~= ADDR(NIL));
      858    18668    3          ST$$ = QLT$$ -> QLT.ST$;
      859    18669
      860    18670    3          CALL CALC_BYTES (ST$$, LEN);
      861    18671
      862    18672    3          IF LEN > MAX THEN
      863    18673    3            MAX = LEN;
      864    18674
      865    18675    3          IF LEN < MIN  THEN
      866    18676    3            MIN = LEN;
      867    18677
      868    18678    3          IF ST$$ -> SCALAR.B.OCCURS_DEPENDING      THEN
      869    18679    4            DO;
      870    18680                   %GET_LTS( @ID = %DEPENDING_SIZE,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:32   
      871    18681                             @ST$ = ST$$,
      872    18682                             @RETURN$ = DEP_SIZE$ );
      873    18725    4              OCCURS_MIN = DEP_SIZE$ -> DEPENDING_SIZE.MIN_SIZE + DEP_SIZE$ ->
      874    18726    4                 DEPENDING_SIZE.DIMS$ -> DIMS.OD.INT1 * DEP_SIZE$ -> DEPENDING_SIZE.
             18726                          DIMS$
      875    18727    4                    -> DIMS.OD.TOTAL_SPAN;
      876    18728
      877    18729    4               IF OCCURS_MIN < MIN   THEN
      878    18730    4                 MIN = OCCURS_MIN;
      879    18731
      880    18732    4             END;
      881    18733
      882    18734    3          IF FORMAT ~= %FORMAT_0    THEN
      883    18735    4            DO;
      884    18736
      885    18737    4              IF LEN > INT_2            THEN
      886    18738    4                CALL Z8AE$ERROR( %E$RECORD_DEFN_GTR_REC_CLAUSE,
      887    18739    4                                 BINBIT( ST$$ -> ST.LINE_NO, 36), 0 );
      888    18740
      889    18741    4              IF FORMAT = %FORMAT_1     THEN
      890    18742    5                DO;
      891    18743    5                  IF LEN < INT_2        THEN
      892    18744    5                    CALL Z8AE$ERROR( %E$RECORD_CONTAINS_WARN,
      893    18745    5                                    BINBIT( ST$$ -> ST.LINE_NO,36), 0 );
      894    18746    5                END;
      895    18747    4              ELSE
      896    18748    4                IF LEN < INT_1          THEN
      897    18749    4                  CALL Z8AE$ERROR( %E$RECORD_DEFN_LSS_REC_CLAUSE,
      898    18750    4                                   BINBIT( ST$$ -> ST.LINE_NO,36), 0 );
      899    18751
      900    18752    4            END;
      901    18753
      902    18754    3          IF QLT$$ -> QLT.BROTHER ~= ADDR(NIL)
      903    18755    3          AND QLT$$ -> QLT.BROTHER -> QLT.ST$ -> SCALAR.B.RECORD_AREA THEN
      904    18756    3            QLT$$ = QLT$$ -> QLT.BROTHER;
      905    18757    3          ELSE
      906    18758    3            EXIT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:33   
      907    18759    3        END;
      908    18760
      909    18761    2   END CALC_MAX_BYTES;
      910    18762        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:34   
      911    18763    1   RECORD_FORMAT_2: PROC (LTS$$, FORMAT);
      912    18764
      913    18765    2        DCL LTS$$         PTR;
      914    18766    2        DCL ST$$          PTR;
      915    18767    2        DCL DEPEND$       PTR;
      916    18768    2        DCL LINE          SBIN;
      917    18769    2        DCL COLUMN        SBIN;
      918    18770    2        DCL FORMAT        SBIN;
      919    18771             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      920    18775
      921    18776    2        IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2 = 0 THEN
      922    18777    2          FORMAT = %FORMAT_0;
      923    18778    2        ELSE
      924    18779    2          FORMAT = %FORMAT_2;
      925    18780
      926    18781    2        DEPEND$ = LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$;
      927    18782
      928    18783    2        IF DEPEND$ ~= ADDR(NIL) THEN
      929    18784    3          DO;
      930    18785    3            LINE    = DEPEND$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE;
      931    18786    3            COLUMN  = DEPEND$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN;
      932    18787
      933    18788    3            CALL Z8CO$QUALIFY_VARIABLE (DEPEND$,
      934    18789    3                                        ST$$);
      935    18790
      936    18791    3            IF NOT ST$$ -> SCALAR.B.ELEMENTARY THEN
      937    18792    4              DO;
      938    18793                     %CONDITIONAL_ERROR (@LX_ITEM$ = DEPEND$,
      939    18794                                         @ERROR#   = %E$MUST_BE_ELEMENTARY,
      940    18795                                         @LINE     = LINE,
      941    18796                                         @COLUMN   = COLUMN);
      942    18826    4                CALL RECORD_RECOVERY (LTS$$);
      943    18827    4                RETURN;
      944    18828    4              END;
      945    18829    3            ELSE
      946    18830    4              DO;
      947    18831    4                CALL CHECK_FOR_WORKING_STORAGE (ST$$,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:35   
      948    18832    4                                                DEPEND$,
      949    18833    4                                                LINE,
      950    18834    4                                                COLUMN)
      951    18835    4                  WHENALTRETURN
      952    18836    5                    DO;
      953    18837    5                      CALL RECORD_RECOVERY (LTS$$);
      954    18838    5                      RETURN;
      955    18839    5                    END;
      956    18840
      957    18841                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      958    18842                                        @ETT$    = ST$$,
      959    18843                                        @TYPE    = ST$$ -> ST.TYPE,
      960    18844                                        @LINE    = LINE,
      961    18845                                        @COLUMN  = COLUMN);
      962    18867
      963    18868    4                CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))
      964    18869    4                  WHENALTRETURN
      965    18870    5                    DO;
      966    18871    5                      CALL RECORD_RECOVERY (LTS$$);
      967    18872    5                      RETURN;
      968    18873    5                    END;
      969    18874
      970    18875    4                CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))
      971    18876    4                  WHENALTRETURN
      972    18877    5                    DO;
      973    18878    5                      CALL RECORD_RECOVERY (LTS$$);
      974    18879    5                      RETURN;
      975    18880    5                    END;
      976    18881        /*#26938*/
      977    18882    4                CALL Z8AF$NEW_BASE (ADDR(ETT_ITEM)-> LX_ETT_ITEM.ETT$,
      978    18883    4                                    ADDR(NIL),
      979    18884    4                                    ADDR(ETT_ITEM)-> LX_ETT_ITEM.ETT$);
      980    18885
      981    18886    4                CALL Z8EV$CONVERT (%TYI, ADDR(ETT_ITEM), ADDR(ETT_ITEM));
      982    18887
      983    18888    4                CALL NEW_DEPEND_SIZE (ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$,
      984    18889    4                                      LTS$$ -> FILE_LTS.ST$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:36   
      985    18890    4              END; /* If elementary */
      986    18891    3          END; /* Depend ~= addr(NIL) */
      987    18892    2        ELSE
      988    18893    2          RETURN;
      989    18894
      990    18895    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ ->
      991    18896    2                                 FILE_LTS.RECORD_CONTAINS.DEPENDING$);
      992    18897
      993    18898    2        LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ = ST$$;
      994    18899
      995    18900    2   END RECORD_FORMAT_2;
      996    18901        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:37   
      997    18902    1   RECORD_RECOVERY: PROC (LTS$$);
      998    18903
      999    18904    2        DCL LTS$$         PTR;
     1000    18905    2        DCL ST$$          PTR;
     1001    18906
     1002    18907
     1003    18908    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ST$$);
     1004    18909
     1005    18910    2        ST$$ -> SCALAR.B.CLASS = %CLASS_NUMERIC;
     1006    18911    2        ST$$ -> SCALAR.TYPE    = %TYI;
     1007    18912    2        ST$$ -> SCALAR.NDSC.N  = %TYI_LENGTH;
     1008    18913
     1009    18914    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$);
     1010    18915
     1011    18916    2        LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ = ST$$;
     1012    18917
     1013    18918    2        CALL NEW_DEPEND_SIZE (ST$$, LTS$$ -> FILE_LTS.ST$);
     1014    18919
     1015    18920    2   END RECORD_RECOVERY;
     1016    18921        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:38   
     1017    18922    1   NEW_DEPEND_SIZE: PROC (DN$, FD$$);
     1018    18923
     1019    18924    2        DCL DN$             PTR;
     1020    18925    2        DCL FD$$            PTR;
     1021    18926    2        DCL TEMP$           PTR;
     1022    18927    2        DCL SON_FD$$        PTR;
     1023    18928
     1024    18929
     1025    18930
     1026    18931             %NEW_DEPENDING_SIZE (@POINTER = TEMP$,
     1027    18932                                  @SIZE$   = DN$);
     1028    19026
     1029    19027    2        FD$$ -> FD.B.OCCURS_DEPENDING = TRUE;
     1030    19028
     1031    19029    2        CALL Z8DO$LINK_WITH_LTS (FD$$ -> FD.LTS$, TEMP$);
     1032    19030
     1033    19031    2        SON_FD$$ = FD$$-> FD.QLT$-> QLT.SON-> QLT.ST$;       /*#26938*/
     1034    19032
     1035    19033    2        SON_FD$$->VARIABLE.B.OCCURS_DEPENDING = TRUE;
     1036    19034
     1037    19035    2        CALL Z8DO$LINK_WITH_LTS (SON_FD$$-> VARIABLE.LTS$, TEMP$);
     1038    19036
     1039    19037    2   END NEW_DEPEND_SIZE;
     1040    19038        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:39   
     1041    19039    1   KEY_ORG: PROC (LTS$$);
     1042    19040
     1043    19041    2        DCL LTS$$         PTR;
     1044    19042    2        DCL ST$$          PTR;
     1045    19043
     1046    19044
     1047    19045    2        CALL FILE_STATUS (LTS$$);
     1048    19046    2        CALL RECORD_CLAUSE (LTS$$);
     1049    19047    2        CALL FILE_ID (LTS$$);
     1050    19048
     1051    19049    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN
     1052    19050    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
     1053    19051
     1054    19052    2        CALL CATALOG (LTS$$);
     1055    19053
     1056    19054    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN
     1057    19055    3          DO;
     1058    19056    3            CALL RECORD_KEY (LTS$$, LTS$$ -> FILE_LTS.RECORD_KEY$, ST$$);
     1059    19057    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);
     1060    19058    3            LTS$$ -> FILE_LTS.RECORD_KEY$ = ST$$;
     1061    19059    3          END;
     1062    19060
     1063    19061
     1064    19062    2        RETURN;
     1065    19063
     1066    19064    2   END KEY_ORG;
     1067    19065        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:40   
     1068    19066    1   IND_ORG: PROC (LTS$$);
     1069    19067
     1070    19068    2        DCL LTS$$         PTR;
     1071    19069    2        DCL ST$$          PTR;
     1072    19070
     1073    19071
     1074    19072    2        CALL FILE_STATUS (LTS$$);
     1075    19073    2        CALL RECORD_CLAUSE (LTS$$);
     1076    19074    2        CALL FILE_ID (LTS$$);
     1077    19075    2        CALL NOMINAL_KEY (LTS$$);
     1078    19076
     1079    19077    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN
     1080    19078    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
     1081    19079
     1082    19080    2        CALL CATALOG (LTS$$);
     1083    19081
     1084    19082    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN
     1085    19083    3          DO;
     1086    19084    3            CALL RECORD_KEY (LTS$$, LTS$$ -> FILE_LTS.RECORD_KEY$, ST$$);
     1087    19085    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);
     1088    19086    3            LTS$$ -> FILE_LTS.RECORD_KEY$ = ST$$;
     1089    19087    3          END;
     1090    19088
     1091    19089    2        CALL ALTERNATE_KEYS (LTS$$);
     1092    19090
     1093    19091
     1094    19092    2        RETURN;
     1095    19093
     1096    19094    2   END IND_ORG;
     1097    19095        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:41   
     1098    19096    1   RECORD_KEY: PROC (LTS$$, KEY$, ST$$);
     1099    19097
     1100    19098    2        DCL LTS$$         PTR;
     1101    19099    2        DCL ST$$          PTR;
     1102    19100    2        DCL QLT$$         PTR;
     1103    19101    2        DCL KEY$          PTR;
     1104    19102
     1105    19103
     1106    19104
     1107    19105    2        IF KEY$ = ADDR(NIL) THEN
     1108    19106    3          DO;
     1109    19107                 /* A record key is required so just create any old temp */
     1110    19108    3            CALL NEW_INTEGER (ST$$);
     1111    19109    3            RETURN;
     1112    19110    3          END;
     1113    19111
     1114    19112    2        CALL Z8CO$QUALIFY_VARIABLE (KEY$, ST$$)
     1115    19113    2          WHENALTRETURN
     1116    19114    3            DO;
     1117    19115    3              RETURN;
     1118    19116    3            END;
     1119    19117
     1120    19118    2        IF (ST$$ -> SCALAR.TYPE ~= %TYA
     1121    19119    2            AND ST$$ -> SCALAR.TYPE ~= %TYE
     1122    19120    2            AND ST$$ -> SCALAR.TYPE ~= %TYB)
     1123    19121    2        OR (ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY)
     1124    19122    2        OR ST$$ -> SCALAR.B.CLASS ~= %CLASS_ALPHANUMERIC THEN
     1125    19123    3          DO;
     1126    19124                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1127    19125                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
     1128    19126                                     @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1129    19127                                     @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     1130    19157    3            IF ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY
     1131    19158    3              THEN CALL NEW_INTEGER (ST$$);
     1132    19159                   /* Replace with a temp */
     1133    19160
     1134    19161    3            RETURN;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:42   
     1135    19162    3          END;
     1136    19163
     1137    19164    2        CALL Z9DI$KEY_LENGTH_CHECK (ST$$)
     1138    19165    2          WHENALTRETURN
     1139    19166    3            DO;
     1140    19167    3              RETURN;
     1141    19168    3            END;
     1142    19169
     1143    19170    2        IF ST$$ -> SCALAR.B.OCCURS_DEPENDING  AND
     1144    19171    2             LTS$$ -> FILE_LTS.ORGANIZATION ~= %KEYED   THEN  /*#17906*/
     1145    19172    3          DO;
     1146    19173                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1147    19174                              @ERROR#   = %E$NO_VARIABLE_OCCURRENCE,
     1148    19175                              @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1149    19176                              @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     1150    19206    3            RETURN;
     1151    19207    3          END;
     1152    19208
     1153    19209
     1154    19210    3        DO CASE (LTS$$ -> FILE_LTS.ORGANIZATION);
     1155    19211    3          CASE(
     1156    19212                    %SET_OF_KEYED_ORGANIZATION;
     1157    19215    3              );
     1158    19216
     1159    19217    3                RETURN;
     1160    19218
     1161    19219    3          CASE(ELSE);
     1162    19220                 /* Keep going */
     1163    19221    3        END; /* Case */
     1164    19222
     1165    19223    2        QLT$$ = ST$$ -> SCALAR.QLT$;
     1166    19224
     1167    19225    2   IN_RECORD_CHECK:
     1168    19226    3        DO WHILE (QLT$$ ~= ADDR(NIL));
     1169    19227    3          IF QLT$$ = LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ THEN
     1170    19228    3            EXIT;
     1171    19229
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:43   
     1172    19230    3          QLT$$ = QLT$$ -> QLT.FATHER;
     1173    19231    3        END; /* While */
     1174    19232
     1175    19233    2        IF QLT$$ = ADDR(NIL) THEN
     1176    19234    3          DO;
     1177    19235                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1178    19236                                     @ERROR#   = %E$KEY_NOT_IN_FILE_DESC,
     1179    19237                                     @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1180    19238                                     @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
     1181    19239                                     @PLUG1    = LTS$$ -> FILE_LTS.ST$ -> ST.DNT$);
     1182    19269
     1183    19270    3            RETURN;
     1184    19271    3          END;
     1185    19272
     1186    19273    2        RETURN;
     1187    19274
     1188    19275    2   END RECORD_KEY;
     1189    19276        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:44   
     1190    19277    1   NOMINAL_KEY: PROC (LTS$$);
     1191    19278
     1192    19279    2        DCL LTS$$         PTR;
     1193    19280    2        DCL ST$$          PTR;
     1194    19281    2        DCL LINE          SBIN;
     1195    19282    2        DCL COLUMN        SBIN;
     1196    19283
     1197    19284
     1198    19285    2        IF LTS$$ -> FILE_LTS.NOMINAL_KEY$ = ADDR(NIL) THEN
     1199    19286    2          RETURN;
     1200    19287
     1201    19288    2        CALL Z8CO$QUALIFY_VARIABLE (LTS$$ -> FILE_LTS.NOMINAL_KEY$, ST$$);
     1202    19289
     1203    19290    2        LINE   = LTS$$ -> FILE_LTS.NOMINAL_KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
     1204    19291    2        COLUMN = LTS$$ -> FILE_LTS.NOMINAL_KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;
     1205    19292
     1206    19293    2        IF ST$$ -> SCALAR.B.OCCURS_DEPENDING THEN
     1207    19294    3          DO;
     1208    19295                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.NOMINAL_KEY$,
     1209    19296                                     @ERROR#   = %E$NO_VARIABLE_OCCURRENCE,
     1210    19297                                     @LINE     = LINE,
     1211    19298                                     @COLUMN   = COLUMN);
     1212    19328
     1213    19329    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);
     1214    19330    3            RETURN;
     1215    19331    3          END;
     1216    19332
     1217    19333    2        CALL CHECK_FOR_WORKING_STORAGE (ST$$,
     1218    19334    2                                        LTS$$ -> FILE_LTS.NOMINAL_KEY$,
     1219    19335    2                                        LINE,
     1220    19336    2                                        COLUMN)
     1221    19337    2          WHENALTRETURN
     1222    19338    3            DO;
     1223    19339    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);
     1224    19340    3              RETURN;
     1225    19341    3            END;
     1226    19342
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:45   
     1227    19343    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);
     1228    19344
     1229    19345    2        LTS$$ -> FILE_LTS.NOMINAL_KEY$ = ST$$;
     1230    19346
     1231    19347    2   END NOMINAL_KEY;
     1232    19348        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:46   
     1233    19349    1   ALTERNATE_KEYS: PROC (LTS$$);
     1234    19350
     1235    19351    2        DCL LTS$$         PTR;
     1236    19352    2        DCL LIST$         PTR;
     1237    19353    2        DCL KEY$          PTR;
     1238    19354    2        DCL ALT_KEY$      PTR;
     1239    19355    2        DCL I             SBIN;
     1240    19356
     1241    19357
     1242    19358    2        LIST$ = LTS$$ -> FILE_LTS.ALT_RECORD_KEY$;
     1243    19359
     1244    19360    2        IF LIST$ = ADDR(NIL) THEN
     1245    19361    2          RETURN;
     1246    19362
     1247    19363    2        I = LIST$ -> LX_LIST.COUNT;
     1248    19364
     1249    19365             %NEW_ALT_KEY (@POINTER = ALT_KEY$,
     1250    19366                           @#KEYS   = I);
     1251    19459
     1252    19460    2        LIST$ = LIST$ -> LX_LIST.HEAD$;
     1253    19461    2        I = 0;
     1254    19462
     1255    19463    3        DO WHILE (LIST$ ~= ADDR(NIL));
     1256    19464    3          CALL RECORD_KEY (LTS$$, LIST$ -> LX_LIST.HEAD$, KEY$);
     1257    19465
     1258    19466    3          ALT_KEY$ -> ALT_KEY.P.P$ (I) = KEY$;
     1259    19467
     1260    19468    3          IF LIST$ -> LX_LIST.COUNT = 1 THEN
     1261    19469    3            ALT_KEY$ -> ALT_KEY.P.UNIQUE (I) = TRUE;
     1262    19470
     1263    19471    3          LIST$ = LIST$ -> LX_LIST.LINK;
     1264    19472    3          I = I + 1;
     1265    19473    3        END; /* While */
     1266    19474
     1267    19475    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.ALT_RECORD_KEY$);
     1268    19476
     1269    19477    2        LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ = ALT_KEY$;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:47   
     1270    19478
     1271    19479    2   END ALTERNATE_KEYS;
     1272    19480        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:48   
     1273    19481    1   CATALOG: PROC (LTS$$);
     1274    19482
     1275    19483    2        DCL LTS$$         PTR;
     1276    19484    2        DCL CAT$          PTR;
     1277    19485
     1278    19486
     1279    19487    2        IF LTS$$ -> FILE_LTS.CATALOG$ ~= ADDR(NIL) THEN
     1280    19488    3          DO;
     1281    19489                 %CONDITIONAL_ERROR (@LX_ITEM$ = CAT$,
     1282    19490                             @ERROR# = %E$FEATURE_NOT_SUPPORTED,
     1283    19491                             @LINE   = CAT$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1284    19492                             @COLUMN = CAT$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     1285    19522
     1286    19523    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.CATALOG$);
     1287    19524    3          END;
     1288    19525
     1289    19526    2   END CATALOG;
     1290    19527        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:49   
     1291    19528    1   REL_ORG: PROC (LTS$$);
     1292    19529
     1293    19530    2        DCL LTS$$         PTR;
     1294    19531
     1295    19532
     1296    19533    2        CALL FILE_STATUS (LTS$$);
     1297    19534    2        CALL RECORD_CLAUSE (LTS$$);
     1298    19535    2        CALL FILE_ID (LTS$$);
     1299    19536
     1300    19537    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN
     1301    19538    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);
     1302    19539
     1303    19540    2        CALL CATALOG (LTS$$);
     1304    19541
     1305    19542    2        CALL RELATIVE_KEY (LTS$$);
     1306    19543
     1307    19544
     1308    19545    2        RETURN;
     1309    19546
     1310    19547    2   END REL_ORG;
     1311    19548        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:50   
     1312    19549    1   RELATIVE_KEY: PROC (LTS$$);
     1313    19550
     1314    19551    2        DCL LTS$$         PTR;
     1315    19552    2        DCL ST$$          PTR;
     1316    19553    2        DCL QLT$$         PTR;
     1317    19554    2        DCL KEY$          PTR;
     1318    19555
     1319    19556             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     1320    19560
     1321    19561
     1322    19562    2        KEY$ = LTS$$ -> FILE_LTS.RELATIVE_KEY$;
     1323    19563
     1324    19564    2        IF KEY$ = ADDR(NIL) THEN
     1325    19565    2          RETURN; /* No RELATIVE KEY, org is sequential */
     1326    19566
     1327    19567    2        CALL Z8CO$QUALIFY_VARIABLE (KEY$, ST$$);
     1328    19568
     1329    19569             %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
     1330    19570                                @ETT$    = ST$$,
     1331    19571                                @LINE    = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1332    19572                                @COLUMN  = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
     1333    19573                                @TYPE    = ST$$ -> ST.TYPE);
     1334    19595
     1335    19596    2        CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))
     1336    19597    2          WHENALTRETURN
     1337    19598    3            DO;
     1338    19599    3              CALL NEW_INTEGER (ST$$);
     1339    19600
     1340    19601    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;
     1341    19602    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
     1342    19603    3            END;
     1343    19604
     1344    19605    2        CALL Z8CO$P_CHECK (ADDR(ETT_ITEM))
     1345    19606    2          WHENALTRETURN
     1346    19607    3            DO;
     1347    19608    3              CALL NEW_INTEGER (ST$$);
     1348    19609
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:51   
     1349    19610    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;
     1350    19611    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
     1351    19612    3            END;
     1352    19613
     1353    19614    2        CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))
     1354    19615    2          WHENALTRETURN
     1355    19616    3            DO;
     1356    19617    3              CALL NEW_INTEGER (ST$$);
     1357    19618
     1358    19619    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;
     1359    19620    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
     1360    19621    3            END;
     1361    19622
     1362    19623    2        QLT$$ = ST$$ -> SCALAR.QLT$;
     1363    19624
     1364    19625    2   SEARCH_FOR_FD:
     1365    19626    3        DO WHILE (QLT$$ ~= ADDR(NIL));
     1366    19627    3          IF QLT$$ -> QLT.ST$ = LTS$$ -> FILE_LTS.ST$ THEN
     1367    19628    4            DO;
     1368    19629                   %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1369    19630                      @ERROR# = %E$REL_KEY_IN_FD,
     1370    19631                      @LINE   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1371    19632                      @COLUMN = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);
     1372    19662
     1373    19663    4              CALL NEW_INTEGER (ST$$);
     1374    19664
     1375    19665    4              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;
     1376    19666    4              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
     1377    19667    4              EXIT SEARCH_FOR_FD;
     1378    19668    4            END;
     1379    19669
     1380    19670    3          QLT$$ = QLT$$ -> QLT.FATHER;
     1381    19671    3        END;
     1382    19672
     1383    19673    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RELATIVE_KEY$);
     1384    19674
     1385    19675    2        LTS$$ -> FILE_LTS.RELATIVE_KEY$ = ST$$;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:52   
     1386    19676
     1387    19677    2   END RELATIVE_KEY;
     1388    19678        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:53   
     1389    19679    1   NEW_INTEGER: PROC (RETURN$);
     1390    19680
     1391    19681    2        DCL RETURN$       PTR;
     1392    19682
     1393    19683
     1394    19684    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, RETURN$);
     1395    19685
     1396    19686    2        RETURN$ -> ST.TYPE = %TYI;
     1397    19687    2        RETURN$ -> SCALAR.B.CLASS = %CLASS_NUMERIC;
     1398    19688    2        RETURN$ -> ST.NDSC.N = %TYI_LENGTH;
     1399    19689
     1400    19690    2   END NEW_INTEGER;
     1401    19691        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:54   
     1402    19692    1   CHECK_FOR_FD: PROC (LTS$$);
     1403    19693
     1404    19694    2        DCL LTS$$         PTR;
     1405    19695
     1406    19696
     1407    19697
     1408    19698    2        IF LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ ->
     1409    19699    2           QLT.SON -> QLT.BROTHER = ADDR(NIL) THEN
     1410    19700    2          IF LTS$$ -> FILE_LTS.REPORT$ = ADDR(NIL) THEN
     1411    19701    3          DO;
     1412    19702                   /* No FD was specified -- error */
     1413    19703    3              IF NOT LTS$$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.B.ERROR_VARIABLE THEN
     1414    19704    3              CALL Z8AE$ERROR (%E$NO_FD_SPECIFIED,
     1415    19705    3                               BINBIT(LTS$$ -> FILE_LTS.ST$ -> ST.LINE_NO,36),
     1416    19706    3                               0, LTS$$ -> FILE_LTS.ST$ -> ST.DNT$);
     1417    19707
     1418    19708    3              LTS$$ -> FILE_LTS.ST$ -> ST.ADSC.N = 80;
     1419    19709
     1420    19710    3              IF LTS$$ -> FILE_LTS.ORGANIZATION = %NOT_SPECIFIED THEN
     1421    19711    3                LTS$$ -> FILE_LTS.ORGANIZATION = %SEQUENTIAL;
     1422    19712
     1423    19713    3              IF LTS$$ -> FILE_LTS.ACCESS_MODE = %NOT_SPECIFIED THEN
     1424    19714    3                LTS$$ -> FILE_LTS.ACCESS_MODE = %SEQUENTIAL_ACCESS;
     1425    19715    3            END;
     1426    19716
     1427    19717    2   END CHECK_FOR_FD;
     1428    19718        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:55   
     1429    19719
     1430    19720
     1431    19721    1        LTS$$ = COMCOM.FILE_LTS_CHAIN$;
     1432    19722
     1433    19723    2        DO WHILE (LTS$$ ~= ADDR(NIL));
     1434    19724    2          O1COM.CURRENT_FILE_LTS$ = LTS$$;
     1435    19725
     1436    19726    2          IF LTS$$ -> FILE_LTS.ST$ -> FD.PROC$ = O1COM.CURRENT_PROC$ THEN
     1437    19727    3            DO;
     1438    19728    3              CALL CHECK_FOR_FD (LTS$$);
     1439    19729
     1440    19730    4              DO CASE (LTS$$ -> FILE_LTS.ORGANIZATION);
     1441    19731
     1442    19732    4                CASE (
     1443    19733                           %SET_OF_SEQUENTIAL_ORGANIZATION;
     1444    19741    4                     );
     1445    19742    4                  CALL SEQ_ORG (LTS$$);
     1446    19743
     1447    19744    4                CASE (
     1448    19745                           %SET_OF_RELATIVE_ORGANIZATION;
     1449    19749    4                     );
     1450    19750    4                  CALL REL_ORG (LTS$$);
     1451    19751
     1452    19752    4                CASE (
     1453    19753                           %SET_OF_INDEXED_ORGANIZATION;
     1454    19757    4                     );
     1455    19758    4                  CALL IND_ORG (LTS$$);
     1456    19759
     1457    19760    4                CASE (
     1458    19761                           %SET_OF_KEYED_ORGANIZATION;
     1459    19764    4                     );
     1460    19765    4                  CALL KEY_ORG (LTS$$);
     1461    19766
     1462    19767    4                CASE (ELSE);
     1463    19768    4                  CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
     1464    19769
     1465    19770    4              END;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:56   
     1466    19771
     1467    19772    3              CALL Z9DI$FAB_FIB_BUILD( LTS$$ );
     1468    19773
     1469    19774    3          END; /* If */
     1470    19775
     1471    19776    2          LTS$$ = LTS$$ -> FILE_LTS.FILE_LTS_CHAIN$;
     1472    19777
     1473    19778    2        END; /* While */
     1474    19779
     1475    19780    1        O1COM.CURRENT_FILE_LTS$ = ADDR(NIL);
     1476    19781
     1477    19782    1   END Z8DI$IO_WRAPUP; /* Proc */
     1478    19783        %EOD;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:57   
--  Include file information  --

   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DI$IO_WRAPUP.

   Procedure Z8DI$IO_WRAPUP requires 3629 words for executable code.
   Procedure Z8DI$IO_WRAPUP requires 46 words of local(AUTO) storage.

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:58   

 Object Unit name= Z8DI$IO_WRAPUP                             File name= Z8DI.:Z8A6TOU
 UTS= AUG 09 '97 11:07:01.80 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  LTS$
    6  LblCom even  none     5      5  LTS_
    7  LblCom even  none     1      1  ETT$
    8  LblCom even  none     1      1  HEAD_ETT$
    9  LblCom even  none   512   1000  ETT_BUCKETS
   10  LblCom even  none     5      5  ETT_
   11  LblCom even  none     1      1  ST$
   12  LblCom even  none     5      5  ST_
   13  LblCom even  none     1      1  QLT$
   14  LblCom even  none     1      1  PREV_01_QLT$
   15  LblCom even  none     5      5  QLT_
   16  LblCom even  none     2      2  MKCN
   17  LblCom even  none    90    132  LEX_SYMBOL
   18  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   19  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   20  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   21  LblCom even  none     8     10  TEMP_LX_NODE
   22  LblCom even  none     1      1  HEAP$
   23   Proc  even  none  3629   7055  Z8DI$IO_WRAPUP
   24  RoData even  none    64    100  Z8DI$IO_WRAPUP
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:59   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    23      0   yes            yes      Std        0  Z8DI$IO_WRAPUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       1 Z9DI$FAB_FIB_BUILD
         yes           Std       1 Z8DI$CHECK_CODE_SET
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
 yes     yes           Std       1 Z8CO$CHECK_NON_NEG_INT_TERM
 yes     yes           Std       1 Z8CO$UNSIGNED_CHECK
         yes           Std       1 Z8AC$MAKE_CONST_D
 yes     yes           Std       2 Z8CO$QUALIFY_VARIABLE
 yes     yes           Std       1 Z8CO$DISPL_CHECK
 yes     yes           Std       3 Z8EC$CREATE_CONST
         yes           Std       2 Z8AT$CREATE_TEMPORARY
 yes     yes           Std       1 Z8CO$INTEGER_CHECK
         yes           Std       2 Z9DI$BLK_CONTAINS
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8DO$LINK_WITH_LTS
         yes           Std       3 Z8EV$CONVERT
         yes           Std       3 Z8AF$NEW_BASE
 yes     yes           Std       1 Z9DI$KEY_LENGTH_CHECK
 yes     yes           Std       1 Z8CO$P_CHECK
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:60   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK                          r    DNT$_FROM_RSWNO

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:61   


        1        1        /*M* Z8DI -- I/O after DD cleanup routines. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        Z8DI$IO_WRAPUP: PROC;

      7 23 000000   000000 700200 xent  Z8DI$IO_WRA* TSX0  ! X66_AUTO_0
        23 000001   000056 000000                    ZERO    46,0
        23 000002   006740 710000 23                 TRA     s:19721

        8        8
        9        9        /*P*
       10       10             NAME : Z8DI$IO_WRAPUP
       11       11             PURPOSE : To do any remaining semantic checks and cleanup
       12       12              processing of the FILE_LTS's after the DATA DIVISION.
       13       13        */
       14       14
       15       15             %EQU PHASE = 1;
       16       16
       17       17             %INCLUDE Z8A_DEFC;
       18       85             %INCLUDE Z8A_SUPP_MAC;
       19     2485             %INCLUDE Z8A_COMCOM;
       20     3135             %INCLUDE Z8A_DNT;
       21     3356             %INCLUDE Z8A_LTS;
       22     5433             %INCLUDE Z8A_ETT;
       23     5734             %INCLUDE Z8A_ST;
       24     9393             %INCLUDE Z8A_TYPES;
       25     9567             %INCLUDE Z8A_ERR_NUMS;
       26    10331             %INCLUDE Z8A_IO_EQUS;
       27    10454             %INCLUDE Z8A_QLT;
       28    10560             %INCLUDE Z8A_MKCN;
       29    10577
       30    10578             %INCLUDE Z8E_STACKS;
       31    12844             %INCLUDE Z8E_O1COM;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:62   
       32    13605             %INCLUDE Z8E_MACROS;
       33    14280             %INCLUDE Z8E_WINDOW;
       34    16350             %INCLUDE Z8E_ABSSYN;
       35    16556             %INCLUDE Z8E_HEAP;
       36    16612
       37    16613    1        DCL Z8ED$DISPOSE_ABSSYN_TREE    ENTRY (1);
       38    16614    1        DCL Z9DI$BLK_CONTAINS         ENTRY (2);
       39    16615    1        DCL Z9DI$KEY_LENGTH_CHECK       ENTRY (1) ALTRET;
       40    16616    1        DCL Z8AE$ERROR                  ENTRY (12);
       41    16617    1        DCL Z8AF$NEW_BASE               ENTRY (3);
       42    16618    1        DCL Z8EC$CREATE_CONST           ENTRY (3) ALTRET;
       43    16619    1        DCL Z8AC$MAKE_CONST_D           ENTRY(1);
       44    16620    1        DCL Z8CO$QUALIFY_VARIABLE       ENTRY (2) ALTRET;
       45    16621    1        DCL Z8DO$LINK_WITH_LTS          ENTRY (2);
       46    16622    1        DCL Z8CO$INTEGER_CHECK          ENTRY (1) ALTRET;
       47    16623    1        DCL Z8CO$P_CHECK                ENTRY (1) ALTRET;
       48    16624    1        DCL Z8CO$UNSIGNED_CHECK         ENTRY (1) ALTRET;
       49    16625    1        DCL Z8CO$CHECK_NON_NEG_INT_TERM ENTRY (1) ALTRET;
       50    16626    1        DCL Z8CO$DISPL_CHECK            ENTRY (1) ALTRET;
       51    16627    1        DCL Z8DI$CHECK_CODE_SET               ENTRY (1);
       52    16628    1        DCL Z8AT$CREATE_TEMPORARY       ENTRY (2);
       53    16629    1        DCL Z8EV$CONVERT                ENTRY (3);
       54    16630    1        DCL Z9DI$FAB_FIB_BUILD          ENTRY (1);
       55    16631
       56    16632
       57    16633    1        DCL DNT$_FROM_RSWNO (0:0) PTR SYMREF READONLY;
       58    16634
       59    16635    1        DCL LTS$$                       PTR; /* To Current file_lts */
       60    16636
       61    16637
       62    16638        %EQU FORMAT_0 = 0;
       63    16639        %EQU FORMAT_1 = 1;
       64    16640        %EQU FORMAT_2 = 2;
       65    16641        %EQU FORMAT_3 = 3;
       66    16642        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:63   
       67    16643    1   SEQ_ORG: PROC (LTS$$);

  16643 23 000003   200004 741300       SEQ_ORG      STX1  ! LTS$$+1,,AUTO

       68    16644
       69    16645    2        DCL LTS$$         PTR; /* To current file_lts */
       70    16646    2        DCL P$            PTR;
       71    16647    2        DCL DCB_NUM$      PTR;
       72    16648
       73    16649
       74    16650             /* Items resolved
       75    16651                   1. Padding Character
       76    16652                   2. Linage Clause
       77    16653                   3. File Status
       78    16654                   4. Record Contains Clause
       79    16655             */
       80    16656
       81    16657    2        CALL PAD_CHAR (LTS$$);

  16657 23 000004   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000005   200011 756100                    STQ     ST$$+1,,AUTO
        23 000006   001626 701000 23                 TSX1    PAD_CHAR
        23 000007   000000 011000                    NOP     0

       82    16658    2        CALL LINAGE (LTS$$);

  16658 23 000010   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000011   200011 756100                    STQ     ST$$+1,,AUTO
        23 000012   003010 701000 23                 TSX1    LINAGE
        23 000013   000000 011000                    NOP     0

       83    16659    2        CALL FILE_STATUS (LTS$$);

  16659 23 000014   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000015   200011 756100                    STQ     ST$$+1,,AUTO
        23 000016   002440 701000 23                 TSX1    FILE_STATUS
        23 000017   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:64   

       84    16660    2        CALL RECORD_CLAUSE (LTS$$);

  16660 23 000020   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000021   200011 756100                    STQ     ST$$+1,,AUTO
        23 000022   004111 701000 23                 TSX1    RECORD_CLAUSE
        23 000023   000000 011000                    NOP     0

       85    16661    2        CALL RETENTION (LTS$$);

  16661 23 000024   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000025   200011 756100                    STQ     ST$$+1,,AUTO
        23 000026   000231 701000 23                 TSX1    RETENTION
        23 000027   000000 011000                    NOP     0

       86    16662    2        CALL FILE_ID (LTS$$);

  16662 23 000030   200005 236100                    LDQ     @LTS$$,,AUTO
        23 000031   200011 756100                    STQ     ST$$+1,,AUTO
        23 000032   002056 701000 23                 TSX1    FILE_ID
        23 000033   000000 011000                    NOP     0

       87    16663
       88    16664    2        IF LTS$$ -> FILE_LTS.CODE_SET$ ~= ADDR(NIL) THEN

  16664 23 000034   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000035   000000 471500                    LDP1    0,,PR0
        23 000036   100037 236100                    LDQ     31,,PR1
        23 000037   000000 116000 24                 CMPQ    0
        23 000040   000051 600000 23                 TZE     s:16667

       89    16665    2          CALL Z8DI$CHECK_CODE_SET (LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ -> QLT.SON);

  16665 23 000041   100001 473500                    LDP3    1,,PR1
        23 000042   300007 474500                    LDP4    7,,PR3
        23 000043   400003 635500                    EPPR5   3,,PR4
        23 000044   200050 455500                    STP5    SON_FD$$+2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:65   
        23 000045   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000046   000001 631400 24                 EPPR1   1
        23 000047   000000 701000 xent               TSX1    Z8DI$CHECK_CODE_SET
        23 000050   000000 011000                    NOP     0

       90    16666
       91    16667    2        IF LTS$$ -> FILE_LTS.RELATIVE_KEY$ ~= ADDR(NIL) THEN

  16667 23 000051   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000052   000000 471500                    LDP1    0,,PR0
        23 000053   100014 236100                    LDQ     12,,PR1
        23 000054   000000 116000 24                 CMPQ    0
        23 000055   000115 600000 23                 TZE     s:16708

       92    16668    3          DO;

       93    16669    3            P$ = LTS$$ -> FILE_LTS.RELATIVE_KEY$ -> LX_LIST.HEAD$;

  16669 23 000056   100014 473500                    LDP3    12,,PR1
        23 000057   300004 236100                    LDQ     4,,PR3
        23 000060   200006 756100                    STQ     P$,,AUTO

       94    16670
       95    16671                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
       96    16672                              @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
       97    16673                              @LINE     = P$ -> LX_ITEM.LINE,
       98    16674                              @COLUMN   = P$ -> LX_ITEM.COLUMN,
       99    16675                              @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");

  16685 23 000061   200006 474500                    LDP4    P$,,AUTO
        23 000062   400000 236100                    LDQ     0,,PR4
        23 000063   400000 316007                    CANQ    -131072,DL
        23 000064   000105 601000 23                 TNZ     s:16705

  16687 23 000065   000004 236000 24                 LDQ     4
        23 000066   200053 756100                    STQ     SON_FD$$+5,,AUTO
        23 000067   200006 236100                    LDQ     P$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:66   
        23 000070   000006 036003                    ADLQ    6,DU
        23 000071   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 000072   200006 236100                    LDQ     P$,,AUTO
        23 000073   000005 036003                    ADLQ    5,DU
        23 000074   000005 235000 24                 LDA     5
        23 000075   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 000076   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000077   000002 631400 24                 EPPR1   2
        23 000100   000000 701000 xent               TSX1    Z8AE$ERROR
        23 000101   000000 011000                    NOP     0

  16696 23 000102   200006 470500                    LDP0    P$,,AUTO
        23 000103   400000 236007                    LDQ     -131072,DL
        23 000104   000000 256100                    ORSQ    0,,PR0

      100    16705    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RELATIVE_KEY$);

  16705 23 000105   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000106   000000 471500                    LDP1    0,,PR0
        23 000107   100014 633500                    EPPR3   12,,PR1
        23 000110   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 000111   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000112   000001 631400 24                 EPPR1   1
        23 000113   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 000114   000000 011000                    NOP     0

      101    16706    3          END;

      102    16707
      103    16708    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN

  16708 23 000115   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000116   000000 471500                    LDP1    0,,PR0
        23 000117   100015 236100                    LDQ     13,,PR1
        23 000120   000000 116000 24                 CMPQ    0
        23 000121   000161 600000 23                 TZE     s:16749

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:67   
      104    16709    3          DO;

      105    16710    3            P$ = LTS$$ -> FILE_LTS.RECORD_KEY$ -> LX_LIST.HEAD$;

  16710 23 000122   100015 473500                    LDP3    13,,PR1
        23 000123   300004 236100                    LDQ     4,,PR3
        23 000124   200006 756100                    STQ     P$,,AUTO

      106    16711
      107    16712                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
      108    16713                                     @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
      109    16714                                     @LINE     = P$ -> LX_ITEM.LINE,
      110    16715                                     @COLUMN   = P$ -> LX_ITEM.COLUMN,
      111    16716                                     @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");

  16726 23 000125   200006 474500                    LDP4    P$,,AUTO
        23 000126   400000 236100                    LDQ     0,,PR4
        23 000127   400000 316007                    CANQ    -131072,DL
        23 000130   000151 601000 23                 TNZ     s:16746

  16728 23 000131   000004 236000 24                 LDQ     4
        23 000132   200053 756100                    STQ     SON_FD$$+5,,AUTO
        23 000133   200006 236100                    LDQ     P$,,AUTO
        23 000134   000006 036003                    ADLQ    6,DU
        23 000135   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 000136   200006 236100                    LDQ     P$,,AUTO
        23 000137   000005 036003                    ADLQ    5,DU
        23 000140   000005 235000 24                 LDA     5
        23 000141   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 000142   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000143   000002 631400 24                 EPPR1   2
        23 000144   000000 701000 xent               TSX1    Z8AE$ERROR
        23 000145   000000 011000                    NOP     0

  16737 23 000146   200006 470500                    LDP0    P$,,AUTO
        23 000147   400000 236007                    LDQ     -131072,DL
        23 000150   000000 256100                    ORSQ    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:68   

      112    16746    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);

  16746 23 000151   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000152   000000 471500                    LDP1    0,,PR0
        23 000153   100015 633500                    EPPR3   13,,PR1
        23 000154   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 000155   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000156   000001 631400 24                 EPPR1   1
        23 000157   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 000160   000000 011000                    NOP     0

      113    16747    3          END;

      114    16748
      115    16749    2        IF LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ ~= ADDR(NIL) THEN

  16749 23 000161   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000162   000000 471500                    LDP1    0,,PR0
        23 000163   100016 236100                    LDQ     14,,PR1
        23 000164   000000 116000 24                 CMPQ    0
        23 000165   000227 600000 23                 TZE     s:16792

      116    16750    3          DO;

      117    16751    3            P$ = LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ -> LX_LIST.HEAD$ ->

  16751 23 000166   100016 473500                    LDP3    14,,PR1
        23 000167   300004 474500                    LDP4    4,,PR3
        23 000170   400004 475500                    LDP5    4,,PR4
        23 000171   500004 236100                    LDQ     4,,PR5
        23 000172   200006 756100                    STQ     P$,,AUTO

      118    16752    3                 LX_LIST.HEAD$ -> LX_LIST.HEAD$;
      119    16753
      120    16754                 %CONDITIONAL_ERROR (@LX_ITEM$ = P$,
      121    16755                                     @ERROR#   = %E$CLAUSE_INVALID_WITH_ORG,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:69   
      122    16756                                     @LINE     = P$ -> LX_ITEM.LINE,
      123    16757                                     @COLUMN   = P$ -> LX_ITEM.COLUMN,
      124    16758                                     @PLUG1    = "DNT$_FROM_RSWNO(%RSV_WRD_SEQUENTIAL)");

  16768 23 000173   200006 476500                    LDP6    P$,,AUTO
        23 000174   600000 236100                    LDQ     0,,PR6
        23 000175   400000 316007                    CANQ    -131072,DL
        23 000176   000217 601000 23                 TNZ     s:16788

  16770 23 000177   000004 236000 24                 LDQ     4
        23 000200   200053 756100                    STQ     SON_FD$$+5,,AUTO
        23 000201   200006 236100                    LDQ     P$,,AUTO
        23 000202   000006 036003                    ADLQ    6,DU
        23 000203   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 000204   200006 236100                    LDQ     P$,,AUTO
        23 000205   000005 036003                    ADLQ    5,DU
        23 000206   000005 235000 24                 LDA     5
        23 000207   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 000210   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000211   000002 631400 24                 EPPR1   2
        23 000212   000000 701000 xent               TSX1    Z8AE$ERROR
        23 000213   000000 011000                    NOP     0

  16779 23 000214   200006 470500                    LDP0    P$,,AUTO
        23 000215   400000 236007                    LDQ     -131072,DL
        23 000216   000000 256100                    ORSQ    0,,PR0

      125    16788    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.ALT_RECORD_KEY$);

  16788 23 000217   200005 470500                    LDP0    @LTS$$,,AUTO
        23 000220   000000 471500                    LDP1    0,,PR0
        23 000221   100016 633500                    EPPR3   14,,PR1
        23 000222   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 000223   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 000224   000001 631400 24                 EPPR1   1
        23 000225   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 000226   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:70   

      126    16789    3          END;

      127    16790
      128    16791
      129    16792    2   END SEQ_ORG;

  16792 23 000227   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 000230   000001 702211                    TSX2  ! 1,X1

      130    16793        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:71   
      131    16794    1   RETENTION: PROC (LTS$$);

  16794 23 000231   200010 741300       RETENTION    STX1  ! @LTS$$+1,,AUTO

      132    16795
      133    16796    2        DCL LTS$$         PTR;
      134    16797    2        DCL RET$          PTR;
      135    16798    2        DCL RETURN_ETT$   PTR;
      136    16799    2        DCL RET_ST$       PTR;
      137    16800    2        DCL LINE          SBIN;
      138    16801    2        DCL COLUMN        SBIN;
      139    16802             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      140    16806
      141    16807
      142    16808
      143    16809    2        IF LTS$$ -> FILE_LTS.RETENTION$ = ADDR(NIL) THEN

  16809 23 000232   200011 470500                    LDP0    @LTS$$,,AUTO
        23 000233   000000 471500                    LDP1    0,,PR0
        23 000234   100030 236100                    LDQ     24,,PR1
        23 000235   000000 116000 24                 CMPQ    0
        23 000236   000240 601000 23                 TNZ     s:16812

      144    16810    2          RETURN;

  16810 23 000237   000001 702211                    TSX2  ! 1,X1

      145    16811
      146    16812    2        RET$ = LTS$$ -> FILE_LTS.RETENTION$;

  16812 23 000240   200012 756100                    STQ     RET$,,AUTO

      147    16813
      148    16814    3        DO CASE (RET$ -> LX_ITEM.ID);

  16814 23 000241   200012 471500                    LDP1    RET$,,AUTO
        23 000242   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:72   
        23 000243   000003 100003                    CMPX0   3,DU
        23 000244   000246 602010 23                 TNC     s:16814+5,X0
        23 000245   001606 710000 23                 TRA     s:17035
        23 000246   000251 710000 23                 TRA     s:16817
        23 000247   001606 710000 23                 TRA     s:17035
        23 000250   001433 710000 23                 TRA     s:16950

      149    16815
      150    16816    3          CASE (%LX_TERMINAL);

      151    16817    4            DO CASE (RET$ -> LX_TERMINAL.SYMBOL);

  16817 23 000251   100003 235100                    LDA     3,,PR1
        23 000252   000762 115007                    CMPA    498,DL
        23 000253   000255 602005 23                 TNC     s:16817+4,AL
        23 000254   001401 710000 23                 TRA     s:16925
        23 000255   001401 710000 23                 TRA     s:16925
        23 000256   001401 710000 23                 TRA     s:16925
        23 000257   001237 710000 23                 TRA     s:16821
        23 000260   001401 710000 23                 TRA     s:16925
        23 000261   001401 710000 23                 TRA     s:16925
        23 000262   001401 710000 23                 TRA     s:16925
        23 000263   001401 710000 23                 TRA     s:16925
        23 000264   001401 710000 23                 TRA     s:16925
        23 000265   001401 710000 23                 TRA     s:16925
        23 000266   001401 710000 23                 TRA     s:16925
        23 000267   001401 710000 23                 TRA     s:16925
        23 000270   001401 710000 23                 TRA     s:16925
        23 000271   001401 710000 23                 TRA     s:16925
        23 000272   001401 710000 23                 TRA     s:16925
        23 000273   001401 710000 23                 TRA     s:16925
        23 000274   001401 710000 23                 TRA     s:16925
        23 000275   001401 710000 23                 TRA     s:16925
        23 000276   001401 710000 23                 TRA     s:16925
        23 000277   001401 710000 23                 TRA     s:16925
        23 000300   001401 710000 23                 TRA     s:16925
        23 000301   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:73   
        23 000302   001237 710000 23                 TRA     s:16821
        23 000303   001237 710000 23                 TRA     s:16821
        23 000304   001401 710000 23                 TRA     s:16925
        23 000305   001401 710000 23                 TRA     s:16925
        23 000306   001401 710000 23                 TRA     s:16925
        23 000307   001401 710000 23                 TRA     s:16925
        23 000310   001401 710000 23                 TRA     s:16925
        23 000311   001401 710000 23                 TRA     s:16925
        23 000312   001401 710000 23                 TRA     s:16925
        23 000313   001401 710000 23                 TRA     s:16925
        23 000314   001401 710000 23                 TRA     s:16925
        23 000315   001401 710000 23                 TRA     s:16925
        23 000316   001401 710000 23                 TRA     s:16925
        23 000317   001401 710000 23                 TRA     s:16925
        23 000320   001401 710000 23                 TRA     s:16925
        23 000321   001401 710000 23                 TRA     s:16925
        23 000322   001401 710000 23                 TRA     s:16925
        23 000323   001401 710000 23                 TRA     s:16925
        23 000324   001401 710000 23                 TRA     s:16925
        23 000325   001401 710000 23                 TRA     s:16925
        23 000326   001401 710000 23                 TRA     s:16925
        23 000327   001401 710000 23                 TRA     s:16925
        23 000330   001401 710000 23                 TRA     s:16925
        23 000331   001401 710000 23                 TRA     s:16925
        23 000332   001401 710000 23                 TRA     s:16925
        23 000333   001401 710000 23                 TRA     s:16925
        23 000334   001401 710000 23                 TRA     s:16925
        23 000335   001401 710000 23                 TRA     s:16925
        23 000336   001401 710000 23                 TRA     s:16925
        23 000337   001401 710000 23                 TRA     s:16925
        23 000340   001401 710000 23                 TRA     s:16925
        23 000341   001401 710000 23                 TRA     s:16925
        23 000342   001401 710000 23                 TRA     s:16925
        23 000343   001401 710000 23                 TRA     s:16925
        23 000344   001401 710000 23                 TRA     s:16925
        23 000345   001401 710000 23                 TRA     s:16925
        23 000346   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:74   
        23 000347   001401 710000 23                 TRA     s:16925
        23 000350   001401 710000 23                 TRA     s:16925
        23 000351   001401 710000 23                 TRA     s:16925
        23 000352   001401 710000 23                 TRA     s:16925
        23 000353   001401 710000 23                 TRA     s:16925
        23 000354   001401 710000 23                 TRA     s:16925
        23 000355   001401 710000 23                 TRA     s:16925
        23 000356   001401 710000 23                 TRA     s:16925
        23 000357   001401 710000 23                 TRA     s:16925
        23 000360   001401 710000 23                 TRA     s:16925
        23 000361   001401 710000 23                 TRA     s:16925
        23 000362   001401 710000 23                 TRA     s:16925
        23 000363   001401 710000 23                 TRA     s:16925
        23 000364   001401 710000 23                 TRA     s:16925
        23 000365   001401 710000 23                 TRA     s:16925
        23 000366   001401 710000 23                 TRA     s:16925
        23 000367   001401 710000 23                 TRA     s:16925
        23 000370   001401 710000 23                 TRA     s:16925
        23 000371   001401 710000 23                 TRA     s:16925
        23 000372   001401 710000 23                 TRA     s:16925
        23 000373   001401 710000 23                 TRA     s:16925
        23 000374   001401 710000 23                 TRA     s:16925
        23 000375   001401 710000 23                 TRA     s:16925
        23 000376   001401 710000 23                 TRA     s:16925
        23 000377   001401 710000 23                 TRA     s:16925
        23 000400   001401 710000 23                 TRA     s:16925
        23 000401   001401 710000 23                 TRA     s:16925
        23 000402   001401 710000 23                 TRA     s:16925
        23 000403   001401 710000 23                 TRA     s:16925
        23 000404   001401 710000 23                 TRA     s:16925
        23 000405   001401 710000 23                 TRA     s:16925
        23 000406   001401 710000 23                 TRA     s:16925
        23 000407   001401 710000 23                 TRA     s:16925
        23 000410   001401 710000 23                 TRA     s:16925
        23 000411   001401 710000 23                 TRA     s:16925
        23 000412   001401 710000 23                 TRA     s:16925
        23 000413   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:75   
        23 000414   001401 710000 23                 TRA     s:16925
        23 000415   001401 710000 23                 TRA     s:16925
        23 000416   001401 710000 23                 TRA     s:16925
        23 000417   001401 710000 23                 TRA     s:16925
        23 000420   001401 710000 23                 TRA     s:16925
        23 000421   001401 710000 23                 TRA     s:16925
        23 000422   001401 710000 23                 TRA     s:16925
        23 000423   001401 710000 23                 TRA     s:16925
        23 000424   001401 710000 23                 TRA     s:16925
        23 000425   001401 710000 23                 TRA     s:16925
        23 000426   001401 710000 23                 TRA     s:16925
        23 000427   001401 710000 23                 TRA     s:16925
        23 000430   001401 710000 23                 TRA     s:16925
        23 000431   001401 710000 23                 TRA     s:16925
        23 000432   001401 710000 23                 TRA     s:16925
        23 000433   001401 710000 23                 TRA     s:16925
        23 000434   001401 710000 23                 TRA     s:16925
        23 000435   001401 710000 23                 TRA     s:16925
        23 000436   001401 710000 23                 TRA     s:16925
        23 000437   001401 710000 23                 TRA     s:16925
        23 000440   001401 710000 23                 TRA     s:16925
        23 000441   001401 710000 23                 TRA     s:16925
        23 000442   001401 710000 23                 TRA     s:16925
        23 000443   001401 710000 23                 TRA     s:16925
        23 000444   001401 710000 23                 TRA     s:16925
        23 000445   001401 710000 23                 TRA     s:16925
        23 000446   001401 710000 23                 TRA     s:16925
        23 000447   001401 710000 23                 TRA     s:16925
        23 000450   001401 710000 23                 TRA     s:16925
        23 000451   001401 710000 23                 TRA     s:16925
        23 000452   001401 710000 23                 TRA     s:16925
        23 000453   001401 710000 23                 TRA     s:16925
        23 000454   001401 710000 23                 TRA     s:16925
        23 000455   001401 710000 23                 TRA     s:16925
        23 000456   001401 710000 23                 TRA     s:16925
        23 000457   001401 710000 23                 TRA     s:16925
        23 000460   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:76   
        23 000461   001401 710000 23                 TRA     s:16925
        23 000462   001401 710000 23                 TRA     s:16925
        23 000463   001401 710000 23                 TRA     s:16925
        23 000464   001401 710000 23                 TRA     s:16925
        23 000465   001401 710000 23                 TRA     s:16925
        23 000466   001401 710000 23                 TRA     s:16925
        23 000467   001401 710000 23                 TRA     s:16925
        23 000470   001401 710000 23                 TRA     s:16925
        23 000471   001401 710000 23                 TRA     s:16925
        23 000472   001401 710000 23                 TRA     s:16925
        23 000473   001401 710000 23                 TRA     s:16925
        23 000474   001401 710000 23                 TRA     s:16925
        23 000475   001401 710000 23                 TRA     s:16925
        23 000476   001401 710000 23                 TRA     s:16925
        23 000477   001401 710000 23                 TRA     s:16925
        23 000500   001401 710000 23                 TRA     s:16925
        23 000501   001401 710000 23                 TRA     s:16925
        23 000502   001401 710000 23                 TRA     s:16925
        23 000503   001401 710000 23                 TRA     s:16925
        23 000504   001401 710000 23                 TRA     s:16925
        23 000505   001401 710000 23                 TRA     s:16925
        23 000506   001401 710000 23                 TRA     s:16925
        23 000507   001401 710000 23                 TRA     s:16925
        23 000510   001401 710000 23                 TRA     s:16925
        23 000511   001401 710000 23                 TRA     s:16925
        23 000512   001401 710000 23                 TRA     s:16925
        23 000513   001401 710000 23                 TRA     s:16925
        23 000514   001401 710000 23                 TRA     s:16925
        23 000515   001401 710000 23                 TRA     s:16925
        23 000516   001401 710000 23                 TRA     s:16925
        23 000517   001401 710000 23                 TRA     s:16925
        23 000520   001401 710000 23                 TRA     s:16925
        23 000521   001401 710000 23                 TRA     s:16925
        23 000522   001401 710000 23                 TRA     s:16925
        23 000523   001401 710000 23                 TRA     s:16925
        23 000524   001401 710000 23                 TRA     s:16925
        23 000525   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:77   
        23 000526   001401 710000 23                 TRA     s:16925
        23 000527   001401 710000 23                 TRA     s:16925
        23 000530   001401 710000 23                 TRA     s:16925
        23 000531   001401 710000 23                 TRA     s:16925
        23 000532   001401 710000 23                 TRA     s:16925
        23 000533   001401 710000 23                 TRA     s:16925
        23 000534   001401 710000 23                 TRA     s:16925
        23 000535   001401 710000 23                 TRA     s:16925
        23 000536   001401 710000 23                 TRA     s:16925
        23 000537   001401 710000 23                 TRA     s:16925
        23 000540   001401 710000 23                 TRA     s:16925
        23 000541   001401 710000 23                 TRA     s:16925
        23 000542   001401 710000 23                 TRA     s:16925
        23 000543   001401 710000 23                 TRA     s:16925
        23 000544   001401 710000 23                 TRA     s:16925
        23 000545   001401 710000 23                 TRA     s:16925
        23 000546   001401 710000 23                 TRA     s:16925
        23 000547   001401 710000 23                 TRA     s:16925
        23 000550   001401 710000 23                 TRA     s:16925
        23 000551   001401 710000 23                 TRA     s:16925
        23 000552   001401 710000 23                 TRA     s:16925
        23 000553   001401 710000 23                 TRA     s:16925
        23 000554   001401 710000 23                 TRA     s:16925
        23 000555   001401 710000 23                 TRA     s:16925
        23 000556   001401 710000 23                 TRA     s:16925
        23 000557   001401 710000 23                 TRA     s:16925
        23 000560   001401 710000 23                 TRA     s:16925
        23 000561   001401 710000 23                 TRA     s:16925
        23 000562   001401 710000 23                 TRA     s:16925
        23 000563   001401 710000 23                 TRA     s:16925
        23 000564   001401 710000 23                 TRA     s:16925
        23 000565   001401 710000 23                 TRA     s:16925
        23 000566   001401 710000 23                 TRA     s:16925
        23 000567   001401 710000 23                 TRA     s:16925
        23 000570   001401 710000 23                 TRA     s:16925
        23 000571   001401 710000 23                 TRA     s:16925
        23 000572   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:78   
        23 000573   001401 710000 23                 TRA     s:16925
        23 000574   001401 710000 23                 TRA     s:16925
        23 000575   001401 710000 23                 TRA     s:16925
        23 000576   001401 710000 23                 TRA     s:16925
        23 000577   001401 710000 23                 TRA     s:16925
        23 000600   001401 710000 23                 TRA     s:16925
        23 000601   001401 710000 23                 TRA     s:16925
        23 000602   001401 710000 23                 TRA     s:16925
        23 000603   001401 710000 23                 TRA     s:16925
        23 000604   001401 710000 23                 TRA     s:16925
        23 000605   001401 710000 23                 TRA     s:16925
        23 000606   001401 710000 23                 TRA     s:16925
        23 000607   001401 710000 23                 TRA     s:16925
        23 000610   001401 710000 23                 TRA     s:16925
        23 000611   001401 710000 23                 TRA     s:16925
        23 000612   001401 710000 23                 TRA     s:16925
        23 000613   001401 710000 23                 TRA     s:16925
        23 000614   001401 710000 23                 TRA     s:16925
        23 000615   001401 710000 23                 TRA     s:16925
        23 000616   001401 710000 23                 TRA     s:16925
        23 000617   001401 710000 23                 TRA     s:16925
        23 000620   001401 710000 23                 TRA     s:16925
        23 000621   001401 710000 23                 TRA     s:16925
        23 000622   001401 710000 23                 TRA     s:16925
        23 000623   001401 710000 23                 TRA     s:16925
        23 000624   001401 710000 23                 TRA     s:16925
        23 000625   001401 710000 23                 TRA     s:16925
        23 000626   001401 710000 23                 TRA     s:16925
        23 000627   001401 710000 23                 TRA     s:16925
        23 000630   001401 710000 23                 TRA     s:16925
        23 000631   001401 710000 23                 TRA     s:16925
        23 000632   001401 710000 23                 TRA     s:16925
        23 000633   001401 710000 23                 TRA     s:16925
        23 000634   001401 710000 23                 TRA     s:16925
        23 000635   001401 710000 23                 TRA     s:16925
        23 000636   001401 710000 23                 TRA     s:16925
        23 000637   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:79   
        23 000640   001401 710000 23                 TRA     s:16925
        23 000641   001401 710000 23                 TRA     s:16925
        23 000642   001401 710000 23                 TRA     s:16925
        23 000643   001401 710000 23                 TRA     s:16925
        23 000644   001401 710000 23                 TRA     s:16925
        23 000645   001401 710000 23                 TRA     s:16925
        23 000646   001401 710000 23                 TRA     s:16925
        23 000647   001401 710000 23                 TRA     s:16925
        23 000650   001401 710000 23                 TRA     s:16925
        23 000651   001401 710000 23                 TRA     s:16925
        23 000652   001401 710000 23                 TRA     s:16925
        23 000653   001401 710000 23                 TRA     s:16925
        23 000654   001401 710000 23                 TRA     s:16925
        23 000655   001401 710000 23                 TRA     s:16925
        23 000656   001401 710000 23                 TRA     s:16925
        23 000657   001401 710000 23                 TRA     s:16925
        23 000660   001401 710000 23                 TRA     s:16925
        23 000661   001401 710000 23                 TRA     s:16925
        23 000662   001401 710000 23                 TRA     s:16925
        23 000663   001401 710000 23                 TRA     s:16925
        23 000664   001401 710000 23                 TRA     s:16925
        23 000665   001401 710000 23                 TRA     s:16925
        23 000666   001401 710000 23                 TRA     s:16925
        23 000667   001401 710000 23                 TRA     s:16925
        23 000670   001401 710000 23                 TRA     s:16925
        23 000671   001401 710000 23                 TRA     s:16925
        23 000672   001401 710000 23                 TRA     s:16925
        23 000673   001401 710000 23                 TRA     s:16925
        23 000674   001401 710000 23                 TRA     s:16925
        23 000675   001401 710000 23                 TRA     s:16925
        23 000676   001401 710000 23                 TRA     s:16925
        23 000677   001401 710000 23                 TRA     s:16925
        23 000700   001401 710000 23                 TRA     s:16925
        23 000701   001401 710000 23                 TRA     s:16925
        23 000702   001401 710000 23                 TRA     s:16925
        23 000703   001401 710000 23                 TRA     s:16925
        23 000704   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:80   
        23 000705   001401 710000 23                 TRA     s:16925
        23 000706   001401 710000 23                 TRA     s:16925
        23 000707   001401 710000 23                 TRA     s:16925
        23 000710   001401 710000 23                 TRA     s:16925
        23 000711   001401 710000 23                 TRA     s:16925
        23 000712   001401 710000 23                 TRA     s:16925
        23 000713   001401 710000 23                 TRA     s:16925
        23 000714   001401 710000 23                 TRA     s:16925
        23 000715   001401 710000 23                 TRA     s:16925
        23 000716   001401 710000 23                 TRA     s:16925
        23 000717   001401 710000 23                 TRA     s:16925
        23 000720   001401 710000 23                 TRA     s:16925
        23 000721   001401 710000 23                 TRA     s:16925
        23 000722   001401 710000 23                 TRA     s:16925
        23 000723   001401 710000 23                 TRA     s:16925
        23 000724   001401 710000 23                 TRA     s:16925
        23 000725   001401 710000 23                 TRA     s:16925
        23 000726   001401 710000 23                 TRA     s:16925
        23 000727   001401 710000 23                 TRA     s:16925
        23 000730   001401 710000 23                 TRA     s:16925
        23 000731   001401 710000 23                 TRA     s:16925
        23 000732   001401 710000 23                 TRA     s:16925
        23 000733   001401 710000 23                 TRA     s:16925
        23 000734   001401 710000 23                 TRA     s:16925
        23 000735   001401 710000 23                 TRA     s:16925
        23 000736   001401 710000 23                 TRA     s:16925
        23 000737   001401 710000 23                 TRA     s:16925
        23 000740   001401 710000 23                 TRA     s:16925
        23 000741   001401 710000 23                 TRA     s:16925
        23 000742   001401 710000 23                 TRA     s:16925
        23 000743   001401 710000 23                 TRA     s:16925
        23 000744   001401 710000 23                 TRA     s:16925
        23 000745   001401 710000 23                 TRA     s:16925
        23 000746   001401 710000 23                 TRA     s:16925
        23 000747   001401 710000 23                 TRA     s:16925
        23 000750   001401 710000 23                 TRA     s:16925
        23 000751   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:81   
        23 000752   001401 710000 23                 TRA     s:16925
        23 000753   001401 710000 23                 TRA     s:16925
        23 000754   001401 710000 23                 TRA     s:16925
        23 000755   001401 710000 23                 TRA     s:16925
        23 000756   001401 710000 23                 TRA     s:16925
        23 000757   001401 710000 23                 TRA     s:16925
        23 000760   001401 710000 23                 TRA     s:16925
        23 000761   001401 710000 23                 TRA     s:16925
        23 000762   001401 710000 23                 TRA     s:16925
        23 000763   001401 710000 23                 TRA     s:16925
        23 000764   001401 710000 23                 TRA     s:16925
        23 000765   001401 710000 23                 TRA     s:16925
        23 000766   001401 710000 23                 TRA     s:16925
        23 000767   001401 710000 23                 TRA     s:16925
        23 000770   001401 710000 23                 TRA     s:16925
        23 000771   001401 710000 23                 TRA     s:16925
        23 000772   001401 710000 23                 TRA     s:16925
        23 000773   001401 710000 23                 TRA     s:16925
        23 000774   001401 710000 23                 TRA     s:16925
        23 000775   001401 710000 23                 TRA     s:16925
        23 000776   001401 710000 23                 TRA     s:16925
        23 000777   001401 710000 23                 TRA     s:16925
        23 001000   001401 710000 23                 TRA     s:16925
        23 001001   001401 710000 23                 TRA     s:16925
        23 001002   001401 710000 23                 TRA     s:16925
        23 001003   001401 710000 23                 TRA     s:16925
        23 001004   001401 710000 23                 TRA     s:16925
        23 001005   001401 710000 23                 TRA     s:16925
        23 001006   001401 710000 23                 TRA     s:16925
        23 001007   001401 710000 23                 TRA     s:16925
        23 001010   001401 710000 23                 TRA     s:16925
        23 001011   001401 710000 23                 TRA     s:16925
        23 001012   001401 710000 23                 TRA     s:16925
        23 001013   001401 710000 23                 TRA     s:16925
        23 001014   001401 710000 23                 TRA     s:16925
        23 001015   001401 710000 23                 TRA     s:16925
        23 001016   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:82   
        23 001017   001401 710000 23                 TRA     s:16925
        23 001020   001401 710000 23                 TRA     s:16925
        23 001021   001401 710000 23                 TRA     s:16925
        23 001022   001401 710000 23                 TRA     s:16925
        23 001023   001401 710000 23                 TRA     s:16925
        23 001024   001401 710000 23                 TRA     s:16925
        23 001025   001401 710000 23                 TRA     s:16925
        23 001026   001401 710000 23                 TRA     s:16925
        23 001027   001401 710000 23                 TRA     s:16925
        23 001030   001401 710000 23                 TRA     s:16925
        23 001031   001401 710000 23                 TRA     s:16925
        23 001032   001401 710000 23                 TRA     s:16925
        23 001033   001401 710000 23                 TRA     s:16925
        23 001034   001401 710000 23                 TRA     s:16925
        23 001035   001401 710000 23                 TRA     s:16925
        23 001036   001401 710000 23                 TRA     s:16925
        23 001037   001401 710000 23                 TRA     s:16925
        23 001040   001401 710000 23                 TRA     s:16925
        23 001041   001401 710000 23                 TRA     s:16925
        23 001042   001401 710000 23                 TRA     s:16925
        23 001043   001401 710000 23                 TRA     s:16925
        23 001044   001401 710000 23                 TRA     s:16925
        23 001045   001401 710000 23                 TRA     s:16925
        23 001046   001401 710000 23                 TRA     s:16925
        23 001047   001401 710000 23                 TRA     s:16925
        23 001050   001401 710000 23                 TRA     s:16925
        23 001051   001401 710000 23                 TRA     s:16925
        23 001052   001401 710000 23                 TRA     s:16925
        23 001053   001401 710000 23                 TRA     s:16925
        23 001054   001401 710000 23                 TRA     s:16925
        23 001055   001401 710000 23                 TRA     s:16925
        23 001056   001401 710000 23                 TRA     s:16925
        23 001057   001401 710000 23                 TRA     s:16925
        23 001060   001401 710000 23                 TRA     s:16925
        23 001061   001401 710000 23                 TRA     s:16925
        23 001062   001401 710000 23                 TRA     s:16925
        23 001063   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:83   
        23 001064   001401 710000 23                 TRA     s:16925
        23 001065   001401 710000 23                 TRA     s:16925
        23 001066   001401 710000 23                 TRA     s:16925
        23 001067   001401 710000 23                 TRA     s:16925
        23 001070   001401 710000 23                 TRA     s:16925
        23 001071   001401 710000 23                 TRA     s:16925
        23 001072   001401 710000 23                 TRA     s:16925
        23 001073   001401 710000 23                 TRA     s:16925
        23 001074   001401 710000 23                 TRA     s:16925
        23 001075   001401 710000 23                 TRA     s:16925
        23 001076   001401 710000 23                 TRA     s:16925
        23 001077   001401 710000 23                 TRA     s:16925
        23 001100   001401 710000 23                 TRA     s:16925
        23 001101   001401 710000 23                 TRA     s:16925
        23 001102   001401 710000 23                 TRA     s:16925
        23 001103   001401 710000 23                 TRA     s:16925
        23 001104   001401 710000 23                 TRA     s:16925
        23 001105   001401 710000 23                 TRA     s:16925
        23 001106   001401 710000 23                 TRA     s:16925
        23 001107   001401 710000 23                 TRA     s:16925
        23 001110   001401 710000 23                 TRA     s:16925
        23 001111   001401 710000 23                 TRA     s:16925
        23 001112   001401 710000 23                 TRA     s:16925
        23 001113   001401 710000 23                 TRA     s:16925
        23 001114   001401 710000 23                 TRA     s:16925
        23 001115   001401 710000 23                 TRA     s:16925
        23 001116   001401 710000 23                 TRA     s:16925
        23 001117   001401 710000 23                 TRA     s:16925
        23 001120   001401 710000 23                 TRA     s:16925
        23 001121   001401 710000 23                 TRA     s:16925
        23 001122   001401 710000 23                 TRA     s:16925
        23 001123   001401 710000 23                 TRA     s:16925
        23 001124   001401 710000 23                 TRA     s:16925
        23 001125   001401 710000 23                 TRA     s:16925
        23 001126   001401 710000 23                 TRA     s:16925
        23 001127   001401 710000 23                 TRA     s:16925
        23 001130   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:84   
        23 001131   001401 710000 23                 TRA     s:16925
        23 001132   001401 710000 23                 TRA     s:16925
        23 001133   001401 710000 23                 TRA     s:16925
        23 001134   001401 710000 23                 TRA     s:16925
        23 001135   001401 710000 23                 TRA     s:16925
        23 001136   001401 710000 23                 TRA     s:16925
        23 001137   001401 710000 23                 TRA     s:16925
        23 001140   001401 710000 23                 TRA     s:16925
        23 001141   001401 710000 23                 TRA     s:16925
        23 001142   001401 710000 23                 TRA     s:16925
        23 001143   001401 710000 23                 TRA     s:16925
        23 001144   001401 710000 23                 TRA     s:16925
        23 001145   001401 710000 23                 TRA     s:16925
        23 001146   001401 710000 23                 TRA     s:16925
        23 001147   001401 710000 23                 TRA     s:16925
        23 001150   001401 710000 23                 TRA     s:16925
        23 001151   001401 710000 23                 TRA     s:16925
        23 001152   001401 710000 23                 TRA     s:16925
        23 001153   001401 710000 23                 TRA     s:16925
        23 001154   001401 710000 23                 TRA     s:16925
        23 001155   001401 710000 23                 TRA     s:16925
        23 001156   001401 710000 23                 TRA     s:16925
        23 001157   001401 710000 23                 TRA     s:16925
        23 001160   001401 710000 23                 TRA     s:16925
        23 001161   001401 710000 23                 TRA     s:16925
        23 001162   001401 710000 23                 TRA     s:16925
        23 001163   001401 710000 23                 TRA     s:16925
        23 001164   001401 710000 23                 TRA     s:16925
        23 001165   001401 710000 23                 TRA     s:16925
        23 001166   001401 710000 23                 TRA     s:16925
        23 001167   001401 710000 23                 TRA     s:16925
        23 001170   001401 710000 23                 TRA     s:16925
        23 001171   001401 710000 23                 TRA     s:16925
        23 001172   001401 710000 23                 TRA     s:16925
        23 001173   001401 710000 23                 TRA     s:16925
        23 001174   001401 710000 23                 TRA     s:16925
        23 001175   001401 710000 23                 TRA     s:16925
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:85   
        23 001176   001401 710000 23                 TRA     s:16925
        23 001177   001401 710000 23                 TRA     s:16925
        23 001200   001401 710000 23                 TRA     s:16925
        23 001201   001401 710000 23                 TRA     s:16925
        23 001202   001401 710000 23                 TRA     s:16925
        23 001203   001401 710000 23                 TRA     s:16925
        23 001204   001401 710000 23                 TRA     s:16925
        23 001205   001401 710000 23                 TRA     s:16925
        23 001206   001401 710000 23                 TRA     s:16925
        23 001207   001401 710000 23                 TRA     s:16925
        23 001210   001401 710000 23                 TRA     s:16925
        23 001211   001401 710000 23                 TRA     s:16925
        23 001212   001401 710000 23                 TRA     s:16925
        23 001213   001401 710000 23                 TRA     s:16925
        23 001214   001401 710000 23                 TRA     s:16925
        23 001215   001401 710000 23                 TRA     s:16925
        23 001216   001401 710000 23                 TRA     s:16925
        23 001217   001401 710000 23                 TRA     s:16925
        23 001220   001401 710000 23                 TRA     s:16925
        23 001221   001401 710000 23                 TRA     s:16925
        23 001222   001401 710000 23                 TRA     s:16925
        23 001223   001401 710000 23                 TRA     s:16925
        23 001224   001401 710000 23                 TRA     s:16925
        23 001225   001401 710000 23                 TRA     s:16925
        23 001226   001401 710000 23                 TRA     s:16925
        23 001227   001401 710000 23                 TRA     s:16925
        23 001230   001401 710000 23                 TRA     s:16925
        23 001231   001401 710000 23                 TRA     s:16925
        23 001232   001401 710000 23                 TRA     s:16925
        23 001233   001401 710000 23                 TRA     s:16925
        23 001234   001401 710000 23                 TRA     s:16925
        23 001235   001401 710000 23                 TRA     s:16925
        23 001236   001237 710000 23                 TRA     s:16821

      152    16818
      153    16819    4              CASE (%NUMBER,         %NUMBER_OR_PARAGRAPH,

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:86   
      154    16820    4                    %NUMERIC_LITERAL,%RSV_WRD_ZEROES);
      155    16821    4                CALL Z8CO$CHECK_NON_NEG_INT_TERM (RET$)

  16821 23 001237   200012 633500                    EPPR3   RET$,,AUTO
        23 001240   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001241   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001242   000001 631400 24                 EPPR1   1
        23 001243   000000 701000 xent               TSX1    Z8CO$CHECK_NON_NEG_INT_TERM
        23 001244   001246 702000 23                 TSX2    s:16837
        23 001245   001302 710000 23                 TRA     s:16863

      156    16822    4                  WHENALTRETURN
      157    16823    5                    DO;

      158    16824                           %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      159    16825                                       @ERROR#   = %E$INVALID_RETENTION_ITEM,
      160    16826                                       @LINE     = RET$ -> LX_ITEM.LINE,
      161    16827                                       @COLUMN   = RET$ -> LX_ITEM.COLUMN);

  16837 23 001246   200012 470500                    LDP0    RET$,,AUTO
        23 001247   000000 236100                    LDQ     0,,PR0
        23 001250   400000 316007                    CANQ    -131072,DL
        23 001251   001270 601000 23                 TNZ     s:16858

  16839 23 001252   200012 236100                    LDQ     RET$,,AUTO
        23 001253   000006 036003                    ADLQ    6,DU
        23 001254   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 001255   200012 236100                    LDQ     RET$,,AUTO
        23 001256   000005 036003                    ADLQ    5,DU
        23 001257   000010 235000 24                 LDA     8
        23 001260   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 001261   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001262   000006 631400 24                 EPPR1   6
        23 001263   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001264   000000 011000                    NOP     0

  16848 23 001265   200012 470500                    LDP0    RET$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:87   
        23 001266   400000 236007                    LDQ     -131072,DL
        23 001267   000000 256100                    ORSQ    0,,PR0

      162    16857
      163    16858    5                      CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ ->

  16858 23 001270   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001271   000000 471500                    LDP1    0,,PR0
        23 001272   100030 633500                    EPPR3   24,,PR1
        23 001273   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001274   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001275   000001 631400 24                 EPPR1   1
        23 001276   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001277   000000 011000                    NOP     0

      164    16859    5                                                     FILE_LTS.RETENTION$);
      165    16860    5                      RETURN;

  16860 23 001300   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001301   000001 702211                    TSX2  ! 1,X1

      166    16861    5                    END;
      167    16862
      168    16863    4                MKCN.CONA = RET$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME;

  16863 23 001302   200012 470500                    LDP0    RET$,,AUTO
        23 001303   000002 471500                    LDP1    2,,PR0
        23 001304   100004 220100                    LDX0    4,,PR1
        23 001305   040000 100540                    MLR     fill='040'O
        23 001306   100004 400010                    ADSC9   4,,PR1                   cn=2,n=*X0
        23 001307   000000 000004 16                 ADSC9   MKCN                     cn=0,n=4

      169    16864    4                CALL Z8AC$MAKE_CONST_D( RETURN_ETT$ );

  16864 23 001310   200013 633500                    EPPR3   RETURN_ETT$,,AUTO
        23 001311   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001312   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:88   
        23 001313   000001 631400 24                 EPPR1   1
        23 001314   000000 701000 xent               TSX1    Z8AC$MAKE_CONST_D
        23 001315   000000 011000                    NOP     0

      170    16865
      171    16866    4                IF RET$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.LENGTH  >  3  THEN

  16866 23 001316   200012 470500                    LDP0    RET$,,AUTO
        23 001317   000002 471500                    LDP1    2,,PR0
        23 001320   100004 220100                    LDX0    4,,PR1
        23 001321   000004 100003                    CMPX0   4,DU
        23 001322   001356 602000 23                 TNC     s:16906

      172    16867    5                  DO;

      173    16868                         %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      174    16869                                             @ERROR#   = %E$INVALID_RETENTION_ITEM,
      175    16870                                             @LINE     = RET$ -> LX_ITEM.LINE,
      176    16871                                             @COLUMN   = RET$ -> LX_ITEM.COLUMN);

  16881 23 001323   000000 236100                    LDQ     0,,PR0
        23 001324   400000 316007                    CANQ    -131072,DL
        23 001325   001344 601000 23                 TNZ     s:16902

  16883 23 001326   200012 236100                    LDQ     RET$,,AUTO
        23 001327   000006 036003                    ADLQ    6,DU
        23 001330   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 001331   200012 236100                    LDQ     RET$,,AUTO
        23 001332   000005 036003                    ADLQ    5,DU
        23 001333   000010 235000 24                 LDA     8
        23 001334   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 001335   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001336   000006 631400 24                 EPPR1   6
        23 001337   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001340   000000 011000                    NOP     0

  16892 23 001341   200012 470500                    LDP0    RET$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:89   
        23 001342   400000 236007                    LDQ     -131072,DL
        23 001343   000000 256100                    ORSQ    0,,PR0

      177    16901
      178    16902    5                    CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  16902 23 001344   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001345   000000 471500                    LDP1    0,,PR0
        23 001346   100030 633500                    EPPR3   24,,PR1
        23 001347   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001350   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001351   000001 631400 24                 EPPR1   1
        23 001352   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001353   000000 011000                    NOP     0

      179    16903    5                    RETURN;

  16903 23 001354   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001355   000001 702211                    TSX2  ! 1,X1

      180    16904    5                  END;
      181    16905
      182    16906    4                RETURN_ETT$ -> ETT.LOP -> CONST.NDSC.N = RET$ -> LX_TERMINAL.DNT$ ->
             16906                         DNT.TEXT.LENGTH;

  16906 23 001356   200013 473500                    LDP3    RETURN_ETT$,,AUTO
        23 001357   300001 474500                    LDP4    1,,PR3
        23 001360   100004 236100                    LDQ     4,,PR1
        23 001361   000022 772000                    QRL     18
        23 001362   400001 752101                    STCQ    1,'01'O,PR4

      183    16907    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  16907 23 001363   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001364   000000 471500                    LDP1    0,,PR0
        23 001365   100030 633500                    EPPR3   24,,PR1
        23 001366   200050 453500                    STP3    SON_FD$$+2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:90   
        23 001367   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001370   000001 631400 24                 EPPR1   1
        23 001371   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001372   000000 011000                    NOP     0

      184    16908
      185    16909    4                LTS$$ -> FILE_LTS.RETENTION$ = RETURN_ETT$ -> ETT.LOP;

  16909 23 001373   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001374   000000 471500                    LDP1    0,,PR0
        23 001375   200013 473500                    LDP3    RETURN_ETT$,,AUTO
        23 001376   300001 236100                    LDQ     1,,PR3
        23 001377   100030 756100                    STQ     24,,PR1
        23 001400   001612 710000 23                 TRA     s:17039

      186    16910
      187    16911    4              CASE (ELSE);

      188    16912                     %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      189    16913                                         @ERROR#   = %E$INVALID_RETENTION_ITEM,
      190    16914                                         @LINE     = RET$ -> LX_ITEM.LINE,
      191    16915                                         @COLUMN   = RET$ -> LX_ITEM.COLUMN);

  16925 23 001401   100000 236100                    LDQ     0,,PR1
        23 001402   400000 316007                    CANQ    -131072,DL
        23 001403   001422 601000 23                 TNZ     s:16946

  16927 23 001404   200012 236100                    LDQ     RET$,,AUTO
        23 001405   000006 036003                    ADLQ    6,DU
        23 001406   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 001407   200012 236100                    LDQ     RET$,,AUTO
        23 001410   000005 036003                    ADLQ    5,DU
        23 001411   000010 235000 24                 LDA     8
        23 001412   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 001413   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001414   000006 631400 24                 EPPR1   6
        23 001415   000000 701000 xent               TSX1    Z8AE$ERROR
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:91   
        23 001416   000000 011000                    NOP     0

  16936 23 001417   200012 470500                    LDP0    RET$,,AUTO
        23 001420   400000 236007                    LDQ     -131072,DL
        23 001421   000000 256100                    ORSQ    0,,PR0

      192    16945
      193    16946    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  16946 23 001422   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001423   000000 471500                    LDP1    0,,PR0
        23 001424   100030 633500                    EPPR3   24,,PR1
        23 001425   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001426   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001427   000001 631400 24                 EPPR1   1
        23 001430   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001431   000000 011000                    NOP     0

      194    16947    4            END; /* Case -- RET.symbol */

  16947 23 001432   001612 710000 23                 TRA     s:17039

      195    16948
      196    16949    3          CASE (%LX_LIST);

      197    16950    3            LINE   = RET$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;

  16950 23 001433   100004 473500                    LDP3    4,,PR1
        23 001434   300005 235100                    LDA     5,,PR3
        23 001435   200015 755100                    STA     LINE,,AUTO

      198    16951    3            COLUMN = RET$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;

  16951 23 001436   100004 473500                    LDP3    4,,PR1
        23 001437   300006 235100                    LDA     6,,PR3
        23 001440   200016 755100                    STA     COLUMN,,AUTO

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:92   
      199    16952
      200    16953    3            CALL Z8CO$QUALIFY_VARIABLE (RET$, RET_ST$) ALTRET (BAD_RET);

  16953 23 001441   200014 633500                    EPPR3   RET_ST$,,AUTO
        23 001442   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 001443   200012 634500                    EPPR4   RET$,,AUTO
        23 001444   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 001445   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001446   000011 631400 24                 EPPR1   9
        23 001447   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 001450   001614 702000 23                 TSX2    BAD_RET

      201    16954
      202    16955                 %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      203    16956                                    @ETT$    = RET_ST$,
      204    16957                                    @TYPE    = RET_ST$ -> ST.TYPE,
      205    16958                                    @LINE    = LINE,
      206    16959                                    @COLUMN  = COLUMN);

  16961 23 001451   000004 220003                    LDX0    4,DU
        23 001452   200020 740100                    STX0    ETT_ITEM,,AUTO

  16962 23 001453   000000 221003                    LDX1    0,DU
        23 001454   200020 441100                    SXL1    ETT_ITEM,,AUTO

  16963 23 001455   200014 470500                    LDP0    RET_ST$,,AUTO
        23 001456   000002 236100                    LDQ     2,,PR0
        23 001457   000022 772000                    QRL     18
        23 001460   200024 756100                    STQ     LINE+1,,AUTO

  16964 23 001461   000000 236000 24                 LDQ     0
        23 001462   200027 756100                    STQ     ETT_ITEM+1,,AUTO

  16965 23 001463   200014 236100                    LDQ     RET_ST$,,AUTO
        23 001464   200021 756100                    STQ     @KEY$+1,,AUTO

  16966 23 001465   000000 236000 24                 LDQ     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:93   
        23 001466   200022 756100                    STQ     @ST$$+1,,AUTO

  16968 23 001467   200015 235100                    LDA     LINE,,AUTO
        23 001470   200025 755100                    STA     COLUMN+1,,AUTO

  16969 23 001471   200016 235100                    LDA     COLUMN,,AUTO
        23 001472   200026 755100                    STA     @RETURN$+1,,AUTO

      207    16981
      208    16982    3            CALL Z8CO$DISPL_CHECK (ADDR(ETT_ITEM)) ALTRET (BAD_RET);

  16982 23 001473   200020 631500                    EPPR1   ETT_ITEM,,AUTO
        23 001474   200050 451500                    STP1    SON_FD$$+2,,AUTO
        23 001475   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 001476   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 001477   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 001500   000001 631400 24                 EPPR1   1
        23 001501   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        23 001502   001614 702000 23                 TSX2    BAD_RET

      209    16983
      210    16984    3            CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM)) ALTRET (BAD_RET);

  16984 23 001503   200020 630500                    EPPR0   ETT_ITEM,,AUTO
        23 001504   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 001505   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 001506   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 001507   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 001510   000001 631400 24                 EPPR1   1
        23 001511   000000 701000 xent               TSX1    Z8CO$UNSIGNED_CHECK
        23 001512   001614 702000 23                 TSX2    BAD_RET

      211    16985
      212    16986    3            CALL CHECK_FOR_WORKING_STORAGE (RET_ST$, RET$, LINE, COLUMN)

  16986 23 001513   200016 630500                    EPPR0   COLUMN,,AUTO
        23 001514   200042 450500                    STP0    @LINE#+1,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:94   
        23 001515   200015 631500                    EPPR1   LINE,,AUTO
        23 001516   200041 451500                    STP1    ST$$+1,,AUTO
        23 001517   200012 633500                    EPPR3   RET$,,AUTO
        23 001520   200040 453500                    STP3    @LTS$$+1,,AUTO
        23 001521   200014 634500                    EPPR4   RET_ST$,,AUTO
        23 001522   200037 454500                    STP4    @LEN+3,,AUTO
        23 001523   002703 701000 23                 TSX1    CHECK_FOR_WORKING_STORAGE
        23 001524   001614 702000 23                 TSX2    BAD_RET

      213    16987    3                                            ALTRET (BAD_RET);
      214    16988
      215    16989    3            IF RET_ST$ -> SCALAR.B.SUB_CLASS.TYPE ~= %CLASS_NUMERIC

  16989 23 001525   200014 470500                    LDP0    RET_ST$,,AUTO
        23 001526   000003 236100                    LDQ     3,,PR0
        23 001527   000003 376007                    ANQ     3,DL
        23 001530   000001 116007                    CMPQ    1,DL
        23 001531   001536 601000 23                 TNZ     s:17005
        23 001532   000001 236100                    LDQ     1,,PR0
        23 001533   000077 376007                    ANQ     63,DL
        23 001534   000004 116007                    CMPQ    4,DL
        23 001535   001571 602000 23                 TNC     s:17030

      216    16990    3            OR RET_ST$ -> ST.NDSC.N > 3 THEN
      217    16991    4              DO;

      218    16992                     %CONDITIONAL_ERROR (@LX_ITEM$ = RET$,
      219    16993                                         @ERROR#   = %E$INVALID_RETENTION_ITEM,
      220    16994                                         @LINE     = LINE,
      221    16995                                         @COLUMN   = COLUMN);

  17005 23 001536   200012 471500                    LDP1    RET$,,AUTO
        23 001537   100000 236100                    LDQ     0,,PR1
        23 001540   400000 316007                    CANQ    -131072,DL
        23 001541   001557 601000 23                 TNZ     s:17026

  17007 23 001542   200016 633500                    EPPR3   COLUMN,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:95   
        23 001543   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 001544   200015 634500                    EPPR4   LINE,,AUTO
        23 001545   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 001546   000010 236000 24                 LDQ     8
        23 001547   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 001550   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001551   000006 631400 24                 EPPR1   6
        23 001552   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001553   000000 011000                    NOP     0

  17016 23 001554   200012 470500                    LDP0    RET$,,AUTO
        23 001555   400000 236007                    LDQ     -131072,DL
        23 001556   000000 256100                    ORSQ    0,,PR0

      222    17025
      223    17026    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  17026 23 001557   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001560   000000 471500                    LDP1    0,,PR0
        23 001561   100030 633500                    EPPR3   24,,PR1
        23 001562   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001563   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001564   000001 631400 24                 EPPR1   1
        23 001565   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001566   000000 011000                    NOP     0

      224    17027    4                RETURN;

  17027 23 001567   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001570   000001 702211                    TSX2  ! 1,X1

      225    17028    4              END;
      226    17029
      227    17030    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  17030 23 001571   200011 471500                    LDP1    @LTS$$,,AUTO
        23 001572   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:96   
        23 001573   300030 634500                    EPPR4   24,,PR3
        23 001574   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 001575   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001576   000001 631400 24                 EPPR1   1
        23 001577   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001600   000000 011000                    NOP     0

      228    17031
      229    17032    3            LTS$$ -> FILE_LTS.RETENTION$ = RET_ST$;

  17032 23 001601   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001602   000000 471500                    LDP1    0,,PR0
        23 001603   200014 236100                    LDQ     RET_ST$,,AUTO
        23 001604   100030 756100                    STQ     24,,PR1
        23 001605   001612 710000 23                 TRA     s:17039

      230    17033
      231    17034    3          CASE (ELSE);

      232    17035    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  17035 23 001606   000013 630400 24                 EPPR0   11
        23 001607   000001 631400 24                 EPPR1   1
        23 001610   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001611   000000 011000                    NOP     0

      233    17036
      234    17037    3        END; /* Case */

      235    17038
      236    17039    2        RETURN;

  17039 23 001612   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001613   000001 702211                    TSX2  ! 1,X1

      237    17040
      238    17041    2   BAD_RET:
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:97   
      239    17042    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  17042 23 001614   200011 470500       BAD_RET      LDP0    @LTS$$,,AUTO
        23 001615   000000 471500                    LDP1    0,,PR0
        23 001616   100030 633500                    EPPR3   24,,PR1
        23 001617   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001620   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001621   000001 631400 24                 EPPR1   1
        23 001622   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001623   000000 011000                    NOP     0

      240    17043    2        RETURN;

  17043 23 001624   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001625   000001 702211                    TSX2  ! 1,X1

      241    17044
      242    17045    2   END RETENTION;
      243    17046        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:98   
      244    17047    1   PAD_CHAR: PROC (LTS$$);

  17047 23 001626   200010 741300       PAD_CHAR     STX1  ! @LTS$$+1,,AUTO

      245    17048
      246    17049    2        DCL LTS$$         PTR;
      247    17050    2        DCL PAD_ST$       PTR;
      248    17051    2        DCL PAD_CHAR$     PTR;
      249    17052    2        DCL FATHER$       PTR;
      250    17053    2        DCL LINE#         SBIN;
      251    17054    2        DCL COLUMN#       SBIN;
      252    17055
      253    17056
      254    17057    2        IF LTS$$ -> FILE_LTS.PAD_CHAR$ = ADDR(NIL) THEN

  17057 23 001627   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001630   000000 471500                    LDP1    0,,PR0
        23 001631   100007 236100                    LDQ     7,,PR1
        23 001632   000000 116000 24                 CMPQ    0
        23 001633   001635 601000 23                 TNZ     s:17060

      255    17058    2          RETURN;

  17058 23 001634   000001 702211                    TSX2  ! 1,X1

      256    17059
      257    17060    2        PAD_CHAR$ = LTS$$ -> FILE_LTS.PAD_CHAR$;

  17060 23 001635   200013 756100                    STQ     PAD_CHAR$,,AUTO

      258    17061
      259    17062    2        IF PAD_CHAR$ -> LX_ITEM.ID = %LX_LIST THEN

  17062 23 001636   200013 471500                    LDP1    PAD_CHAR$,,AUTO
        23 001637   100000 220100                    LDX0    0,,PR1
        23 001640   000002 100003                    CMPX0   2,DU
        23 001641   001675 601000 23                 TNZ     s:17079
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:99   

      260    17063    3          DO;

      261    17064                 /* Pad char is a data name, possibly qualified */
      262    17065    3            CALL Z8CO$QUALIFY_VARIABLE (PAD_CHAR$,

  17065 23 001642   200012 633500                    EPPR3   PAD_ST$,,AUTO
        23 001643   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 001644   200013 634500                    EPPR4   PAD_CHAR$,,AUTO
        23 001645   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 001646   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001647   000011 631400 24                 EPPR1   9
        23 001650   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 001651   001653 702000 23                 TSX2    s:17069
        23 001652   001665 710000 23                 TRA     s:17073

      263    17066    3                                        PAD_ST$)
      264    17067    3              WHENALTRETURN
      265    17068    4                DO;

      266    17069    4                  CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);

  17069 23 001653   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001654   000000 471500                    LDP1    0,,PR0
        23 001655   100007 633500                    EPPR3   7,,PR1
        23 001656   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001657   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001660   000001 631400 24                 EPPR1   1
        23 001661   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001662   000000 011000                    NOP     0

      267    17070    4                  RETURN;

  17070 23 001663   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001664   000001 702211                    TSX2  ! 1,X1

      268    17071    4                END;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:100  
      269    17072
      270    17073    3            COLUMN# = PAD_CHAR$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;

  17073 23 001665   200013 470500                    LDP0    PAD_CHAR$,,AUTO
        23 001666   000004 471500                    LDP1    4,,PR0
        23 001667   100006 235100                    LDA     6,,PR1
        23 001670   200016 755100                    STA     COLUMN#,,AUTO

      271    17074    3            LINE#   = PAD_CHAR$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;

  17074 23 001671   000004 471500                    LDP1    4,,PR0
        23 001672   100005 235100                    LDA     5,,PR1
        23 001673   200015 755100                    STA     LINE#,,AUTO

      272    17075    3          END;

  17075 23 001674   001717 710000 23                 TRA     s:17089

      273    17076    2        ELSE
      274    17077    3          DO;

      275    17078                 /* Pad char is a nonnumeric literal, not a fig const */
      276    17079    3            CALL Z8EC$CREATE_CONST (%TYA,

  17079 23 001675   200012 633500                    EPPR3   PAD_ST$,,AUTO
        23 001676   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 001677   200013 634500                    EPPR4   PAD_CHAR$,,AUTO
        23 001700   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 001701   000015 236000 24                 LDQ     13
        23 001702   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 001703   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001704   000006 631400 24                 EPPR1   6
        23 001705   000000 701000 xent               TSX1    Z8EC$CREATE_CONST
        23 001706   000000 011000                    NOP     0

      277    17080    3                                    PAD_CHAR$,
      278    17081    3                                    PAD_ST$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:101  
      279    17082
      280    17083    3            COLUMN# = PAD_CHAR$ -> LX_TERMINAL.COLUMN;

  17083 23 001707   200013 470500                    LDP0    PAD_CHAR$,,AUTO
        23 001710   000006 235100                    LDA     6,,PR0
        23 001711   200016 755100                    STA     COLUMN#,,AUTO

      281    17084    3            LINE#   = PAD_CHAR$ -> LX_TERMINAL.LINE;

  17084 23 001712   000005 235100                    LDA     5,,PR0
        23 001713   200015 755100                    STA     LINE#,,AUTO

      282    17085
      283    17086    3            PAD_ST$ = PAD_ST$ -> ETT.LOP; /* Triad returned from const */

  17086 23 001714   200012 471500                    LDP1    PAD_ST$,,AUTO
        23 001715   100001 236100                    LDQ     1,,PR1
        23 001716   200012 756100                    STQ     PAD_ST$,,AUTO

      284    17087    3          END;

      285    17088
      286    17089    2        IF PAD_ST$ -> ST.TYPE ~= %TYA THEN

  17089 23 001717   200012 471500                    LDP1    PAD_ST$,,AUTO
        23 001720   100002 220100                    LDX0    2,,PR1
        23 001721   000010 100003                    CMPX0   8,DU
        23 001722   001755 600000 23                 TZE     s:17128

      287    17090    3          DO;

      288    17091                 %CONDITIONAL_ERROR (@LX_ITEM$ = PAD_CHAR$,
      289    17092                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      290    17093                                     @LINE     = LINE#,
      291    17094                                     @COLUMN   = COLUMN#);

  17104 23 001723   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:102  
        23 001724   400000 316007                    CANQ    -131072,DL
        23 001725   001743 601000 23                 TNZ     s:17124

  17106 23 001726   200016 633500                    EPPR3   COLUMN#,,AUTO
        23 001727   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 001730   200015 634500                    EPPR4   LINE#,,AUTO
        23 001731   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 001732   000017 236000 24                 LDQ     15
        23 001733   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 001734   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001735   000006 631400 24                 EPPR1   6
        23 001736   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001737   000000 011000                    NOP     0

  17115 23 001740   200013 470500                    LDP0    PAD_CHAR$,,AUTO
        23 001741   400000 236007                    LDQ     -131072,DL
        23 001742   000000 256100                    ORSQ    0,,PR0

      292    17124    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);

  17124 23 001743   200011 470500                    LDP0    @LTS$$,,AUTO
        23 001744   000000 471500                    LDP1    0,,PR0
        23 001745   100007 633500                    EPPR3   7,,PR1
        23 001746   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 001747   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001750   000001 631400 24                 EPPR1   1
        23 001751   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 001752   000000 011000                    NOP     0

      293    17125    3            RETURN;

  17125 23 001753   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 001754   000001 702211                    TSX2  ! 1,X1

      294    17126    3          END;
      295    17127
      296    17128    2        IF PAD_ST$ -> ST.ADSC.N ~= 1 THEN
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:103  

  17128 23 001755   100001 236100                    LDQ     1,,PR1
        23 001756   007777 376007                    ANQ     4095,DL
        23 001757   000001 116007                    CMPQ    1,DL
        23 001760   002013 600000 23                 TZE     s:17168

      297    17129    3          DO;

      298    17130                 %CONDITIONAL_ERROR (@LX_ITEM$ = PAD_CHAR$,
      299    17131                                     @ERROR#   = %E$MUST_BE_1_CHAR_LONG,
      300    17132                                     @LINE     = LINE#,
      301    17133                                     @COLUMN   = COLUMN#);

  17143 23 001761   000000 236100                    LDQ     0,,PR0
        23 001762   400000 316007                    CANQ    -131072,DL
        23 001763   002001 601000 23                 TNZ     s:17164

  17145 23 001764   200016 633500                    EPPR3   COLUMN#,,AUTO
        23 001765   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 001766   200015 634500                    EPPR4   LINE#,,AUTO
        23 001767   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 001770   000021 236000 24                 LDQ     17
        23 001771   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 001772   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 001773   000006 631400 24                 EPPR1   6
        23 001774   000000 701000 xent               TSX1    Z8AE$ERROR
        23 001775   000000 011000                    NOP     0

  17154 23 001776   200013 470500                    LDP0    PAD_CHAR$,,AUTO
        23 001777   400000 236007                    LDQ     -131072,DL
        23 002000   000000 256100                    ORSQ    0,,PR0

      302    17163
      303    17164    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);

  17164 23 002001   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002002   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:104  
        23 002003   100007 633500                    EPPR3   7,,PR1
        23 002004   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002005   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002006   000001 631400 24                 EPPR1   1
        23 002007   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002010   000000 011000                    NOP     0

      304    17165    3            RETURN;

  17165 23 002011   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002012   000001 702211                    TSX2  ! 1,X1

      305    17166    3          END;
      306    17167
      307    17168    2        CALL CHECK_FOR_WORKING_STORAGE (PAD_ST$,

  17168 23 002013   200016 633500                    EPPR3   COLUMN#,,AUTO
        23 002014   200042 453500                    STP3    @LINE#+1,,AUTO
        23 002015   200015 634500                    EPPR4   LINE#,,AUTO
        23 002016   200041 454500                    STP4    ST$$+1,,AUTO
        23 002017   200013 635500                    EPPR5   PAD_CHAR$,,AUTO
        23 002020   200040 455500                    STP5    @LTS$$+1,,AUTO
        23 002021   200012 636500                    EPPR6   PAD_ST$,,AUTO
        23 002022   200037 456500                    STP6    @LEN+3,,AUTO
        23 002023   002703 701000 23                 TSX1    CHECK_FOR_WORKING_STORAGE
        23 002024   002026 702000 23                 TSX2    s:17174
        23 002025   002040 710000 23                 TRA     s:17178

      308    17169    2                                        PAD_CHAR$,
      309    17170    2                                        LINE#,
      310    17171    2                                        COLUMN#)
      311    17172    2          WHENALTRETURN
      312    17173    3            DO;

      313    17174    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);

  17174 23 002026   200011 470500                    LDP0    @LTS$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:105  
        23 002027   000000 471500                    LDP1    0,,PR0
        23 002030   100007 633500                    EPPR3   7,,PR1
        23 002031   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002032   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002033   000001 631400 24                 EPPR1   1
        23 002034   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002035   000000 011000                    NOP     0

      314    17175    3              RETURN;

  17175 23 002036   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002037   000001 702211                    TSX2  ! 1,X1

      315    17176    3            END;
      316    17177
      317    17178    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.PAD_CHAR$);

  17178 23 002040   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002041   000000 471500                    LDP1    0,,PR0
        23 002042   100007 633500                    EPPR3   7,,PR1
        23 002043   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002044   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002045   000001 631400 24                 EPPR1   1
        23 002046   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002047   000000 011000                    NOP     0

      318    17179
      319    17180    2        LTS$$ -> FILE_LTS.PAD_CHAR$ = PAD_ST$;

  17180 23 002050   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002051   000000 471500                    LDP1    0,,PR0
        23 002052   200012 236100                    LDQ     PAD_ST$,,AUTO
        23 002053   100007 756100                    STQ     7,,PR1

      320    17181
      321    17182    2   END PAD_CHAR;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:106  
  17182 23 002054   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002055   000001 702211                    TSX2  ! 1,X1

      322    17183        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:107  
      323    17184    1   FILE_ID: PROC (LTS$$);

  17184 23 002056   200010 741300       FILE_ID      STX1  ! @LTS$$+1,,AUTO

      324    17185
      325    17186    2        DCL LTS$$         PTR;
      326    17187
      327    17188    2        CALL CHECK_ID (LTS$$ -> FILE_LTS.FILE_ID$);

  17188 23 002057   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002060   000000 471500                    LDP1    0,,PR0
        23 002061   100027 633500                    EPPR3   23,,PR1
        23 002062   200013 453500                    STP3    PAD_CHAR$,,AUTO
        23 002063   002075 701000 23                 TSX1    CHECK_ID
        23 002064   000000 011000                    NOP     0

      328    17189
      329    17190    2        CALL CHECK_ID (LTS$$ -> FILE_LTS.CATALOG$);

  17190 23 002065   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002066   000000 471500                    LDP1    0,,PR0
        23 002067   100031 633500                    EPPR3   25,,PR1
        23 002070   200013 453500                    STP3    PAD_CHAR$,,AUTO
        23 002071   002075 701000 23                 TSX1    CHECK_ID
        23 002072   000000 011000                    NOP     0

      330    17191
      331    17192    2   END FILE_ID;

  17192 23 002073   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002074   000001 702211                    TSX2  ! 1,X1

      332    17193        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:108  
      333    17194    1   CHECK_ID: PROC (ID$);

  17194 23 002075   200012 741300       CHECK_ID     STX1  ! PAD_ST$,,AUTO

      334    17195    2        DCL ID$           PTR;
      335    17196    2        DCL ITEM_ST$      PTR;
      336    17197    2        DCL LINE          SBIN;
      337    17198    2        DCL LENGTH        SBIN;
      338    17199    2        DCL COLUMN        SBIN;
      339    17200
      340    17201
      341    17202    2        IF ID$ = ADDR(NIL) THEN

  17202 23 002076   200013 470500                    LDP0    @ID$,,AUTO
        23 002077   000000 236100                    LDQ     0,,PR0
        23 002100   000000 116000 24                 CMPQ    0
        23 002101   002103 601000 23                 TNZ     s:17206

      342    17203    2          RETURN;

  17203 23 002102   000001 702211                    TSX2  ! 1,X1

      343    17204
      344    17205
      345    17206    3        DO CASE (ID$ -> LX_ITEM.ID);

  17206 23 002103   000000 471500                    LDP1    0,,PR0
        23 002104   100000 220100                    LDX0    0,,PR1
        23 002105   000003 100003                    CMPX0   3,DU
        23 002106   002110 602010 23                 TNC     s:17206+5,X0
        23 002107   002404 710000 23                 TRA     s:17379
        23 002110   002113 710000 23                 TRA     s:17209
        23 002111   002404 710000 23                 TRA     s:17379
        23 002112   002262 710000 23                 TRA     s:17307

      346    17207
      347    17208    3          CASE (%LX_TERMINAL);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:109  

      348    17209    4            DO CASE (ID$ -> LX_ITEM.SYMBOL);

  17209 23 002113   100003 235100                    LDA     3,,PR1
        23 002114   000005 115007                    CMPA    5,DL
        23 002115   002117 602005 23                 TNC     s:17209+4,AL
        23 002116   002233 710000 23                 TRA     s:17280
        23 002117   002233 710000 23                 TRA     s:17280
        23 002120   002233 710000 23                 TRA     s:17280
        23 002121   002233 710000 23                 TRA     s:17280
        23 002122   002124 710000 23                 TRA     s:17212
        23 002123   002207 710000 23                 TRA     s:17260

      349    17210
      350    17211    4              CASE (%ALPHA_LITERAL);

      351    17212    4                IF ID$ -> LX_ITEM.DNT$ -> DNT.ST$ ~= ADDR (NIL) THEN

  17212 23 002124   100002 473500                    LDP3    2,,PR1
        23 002125   300001 236100                    LDQ     1,,PR3
        23 002126   000000 116000 24                 CMPQ    0
        23 002127   002163 600000 23                 TZE     s:17253

      352    17213    5                  IF ID$ -> LX_ITEM.DNT$ -> DNT.ST$ -> ST.ID = %SYM_CHAR THEN DO ;

  17213 23 002130   300001 474500                    LDP4    1,,PR3
        23 002131   400000 222100                    LDX2    0,,PR4
        23 002132   001001 102003                    CMPX2   513,DU
        23 002133   002163 601000 23                 TNZ     s:17253

      353    17214                         /* Symbolic characters are illegal here. */
      354    17215                         %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      355    17216                                             @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      356    17217                                             @LINE     = ID$ -> LX_ITEM.LINE,
      357    17218                                             @COLUMN   = ID$ -> LX_ITEM.COLUMN);

  17228 23 002134   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:110  
        23 002135   400000 316007                    CANQ    -131072,DL
        23 002136   002155 601000 23                 TNZ     s:17249

  17230 23 002137   100006 635500                    EPPR5   6,,PR1
        23 002140   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 002141   100005 633500                    EPPR3   5,,PR1
        23 002142   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 002143   000017 236000 24                 LDQ     15
        23 002144   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002145   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002146   000006 631400 24                 EPPR1   6
        23 002147   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002150   000000 011000                    NOP     0

  17239 23 002151   200013 470500                    LDP0    @ID$,,AUTO
        23 002152   000000 471500                    LDP1    0,,PR0
        23 002153   400000 236007                    LDQ     -131072,DL
        23 002154   100000 256100                    ORSQ    0,,PR1

      358    17248
      359    17249    5                    CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17249 23 002155   200013 630500                    EPPR0   @ID$,,AUTO
        23 002156   000001 631400 24                 EPPR1   1
        23 002157   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002160   000000 011000                    NOP     0

      360    17250    5                    RETURN;

  17250 23 002161   200012 221300                    LDX1  ! PAD_ST$,,AUTO
        23 002162   000001 702211                    TSX2  ! 1,X1

      361    17251    5                  END;
      362    17252
      363    17253    4                CALL Z8EC$CREATE_CONST (%TYA, ID$, ETT$);

  17253 23 002163   000022 236000 24                 LDQ     18
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:111  
        23 002164   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 002165   200013 236100                    LDQ     @ID$,,AUTO
        23 002166   000015 235000 24                 LDA     13
        23 002167   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 002170   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002171   000006 631400 24                 EPPR1   6
        23 002172   000000 701000 xent               TSX1    Z8EC$CREATE_CONST
        23 002173   000000 011000                    NOP     0

      364    17254    4                ETT$ = ETT$ -> ETT.LOP;

  17254 23 002174   000000 470400 7                  LDP0    ETT$
        23 002175   000001 236100                    LDQ     1,,PR0
        23 002176   000000 756000 7                  STQ     ETT$

      365    17255
      366    17256    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17256 23 002177   200013 630500                    EPPR0   @ID$,,AUTO
        23 002200   000001 631400 24                 EPPR1   1
        23 002201   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002202   000000 011000                    NOP     0

      367    17257    4                ID$ = ETT$;

  17257 23 002203   000000 236000 7                  LDQ     ETT$
        23 002204   200013 470500                    LDP0    @ID$,,AUTO
        23 002205   000000 756100                    STQ     0,,PR0
        23 002206   002410 710000 23                 TRA     s:17383

      368    17258
      369    17259    4              CASE (%SINGLE_QUOTE);

      370    17260    4                CALL Z8EC$CREATE_CONST (%TYA, ID$, ETT$);

  17260 23 002207   000022 236000 24                 LDQ     18
        23 002210   200052 756100                    STQ     SON_FD$$+4,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:112  
        23 002211   200013 236100                    LDQ     @ID$,,AUTO
        23 002212   000015 235000 24                 LDA     13
        23 002213   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 002214   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002215   000006 631400 24                 EPPR1   6
        23 002216   000000 701000 xent               TSX1    Z8EC$CREATE_CONST
        23 002217   000000 011000                    NOP     0

      371    17261    4                ETT$ = ETT$ -> ETT.LOP;

  17261 23 002220   000000 470400 7                  LDP0    ETT$
        23 002221   000001 236100                    LDQ     1,,PR0
        23 002222   000000 756000 7                  STQ     ETT$

      372    17262
      373    17263    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17263 23 002223   200013 630500                    EPPR0   @ID$,,AUTO
        23 002224   000001 631400 24                 EPPR1   1
        23 002225   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002226   000000 011000                    NOP     0

      374    17264    4                ID$ = ETT$;

  17264 23 002227   000000 236000 7                  LDQ     ETT$
        23 002230   200013 470500                    LDP0    @ID$,,AUTO
        23 002231   000000 756100                    STQ     0,,PR0
        23 002232   002410 710000 23                 TRA     s:17383

      375    17265
      376    17266    4              CASE (ELSE);

      377    17267                     %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      378    17268                                         @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      379    17269                                         @LINE     = ID$ -> LX_ITEM.LINE,
      380    17270                                         @COLUMN   = ID$ -> LX_ITEM.COLUMN);

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:113  
  17280 23 002233   100000 236100                    LDQ     0,,PR1
        23 002234   400000 316007                    CANQ    -131072,DL
        23 002235   002254 601000 23                 TNZ     s:17301

  17282 23 002236   100006 633500                    EPPR3   6,,PR1
        23 002237   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 002240   100005 634500                    EPPR4   5,,PR1
        23 002241   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 002242   000017 236000 24                 LDQ     15
        23 002243   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002244   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002245   000006 631400 24                 EPPR1   6
        23 002246   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002247   000000 011000                    NOP     0

  17291 23 002250   200013 470500                    LDP0    @ID$,,AUTO
        23 002251   000000 471500                    LDP1    0,,PR0
        23 002252   400000 236007                    LDQ     -131072,DL
        23 002253   100000 256100                    ORSQ    0,,PR1

      381    17300
      382    17301    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17301 23 002254   200013 630500                    EPPR0   @ID$,,AUTO
        23 002255   000001 631400 24                 EPPR1   1
        23 002256   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002257   000000 011000                    NOP     0

      383    17302    4                RETURN;

  17302 23 002260   200012 221300                    LDX1  ! PAD_ST$,,AUTO
        23 002261   000001 702211                    TSX2  ! 1,X1

      384    17303
      385    17304    4            END; /* Case */

      386    17305
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:114  
      387    17306    3          CASE (%LX_LIST);

      388    17307    3            LINE   = ID$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;

  17307 23 002262   100004 473500                    LDP3    4,,PR1
        23 002263   300005 235100                    LDA     5,,PR3
        23 002264   200015 755100                    STA     LINE,,AUTO

      389    17308    3            COLUMN = ID$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;

  17308 23 002265   000000 471500                    LDP1    0,,PR0
        23 002266   100004 473500                    LDP3    4,,PR1
        23 002267   300006 235100                    LDA     6,,PR3
        23 002270   200017 755100                    STA     COLUMN,,AUTO

      390    17309
      391    17310    3            CALL Z8CO$QUALIFY_VARIABLE (ID$, ITEM_ST$)

  17310 23 002271   200014 631500                    EPPR1   ITEM_ST$,,AUTO
        23 002272   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 002273   200013 236100                    LDQ     @ID$,,AUTO
        23 002274   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002275   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002276   000011 631400 24                 EPPR1   9
        23 002277   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 002300   002302 702000 23                 TSX2    s:17313
        23 002301   002310 710000 23                 TRA     s:17317

      392    17311    3              WHENALTRETURN
      393    17312    4                DO;

      394    17313    4                  CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17313 23 002302   200013 630500                    EPPR0   @ID$,,AUTO
        23 002303   000001 631400 24                 EPPR1   1
        23 002304   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002305   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:115  

      395    17314    4                  RETURN;

  17314 23 002306   200012 221300                    LDX1  ! PAD_ST$,,AUTO
        23 002307   000001 702211                    TSX2  ! 1,X1

      396    17315    4                END;
      397    17316
      398    17317    3            IF (ITEM_ST$ -> SCALAR.ID ~= %SCALAR AND

  17317 23 002310   200014 470500                    LDP0    ITEM_ST$,,AUTO
        23 002311   000000 220100                    LDX0    0,,PR0
        23 002312   000766 100003                    CMPX0   502,DU
        23 002313   002316 600000 23                 TZE     s:17317+6
        23 002314   000765 100003                    CMPX0   501,DU
        23 002315   002322 601000 23                 TNZ     s:17334
        23 002316   000003 236100                    LDQ     3,,PR0
        23 002317   000003 376007                    ANQ     3,DL
        23 002320   000003 116007                    CMPQ    3,DL
        23 002321   002353 600000 23                 TZE     s:17362

      399    17318    3                ITEM_ST$ -> SCALAR.ID ~= %ARRAY) OR
      400    17319    3                ITEM_ST$ -> SCALAR.B.SUB_CLASS.TYPE ~= %CLASS_ALPHANUMERIC THEN
      401    17320    4              DO;

      402    17321                     %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      403    17322                                         @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      404    17323                                         @LINE     = LINE,
      405    17324                                         @COLUMN   = COLUMN);

  17334 23 002322   200013 471500                    LDP1    @ID$,,AUTO
        23 002323   100000 473500                    LDP3    0,,PR1
        23 002324   300000 236100                    LDQ     0,,PR3
        23 002325   400000 316007                    CANQ    -131072,DL
        23 002326   002345 601000 23                 TNZ     s:17355

  17336 23 002327   200017 634500                    EPPR4   COLUMN,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:116  
        23 002330   200052 454500                    STP4    SON_FD$$+4,,AUTO
        23 002331   200015 633500                    EPPR3   LINE,,AUTO
        23 002332   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 002333   000017 236000 24                 LDQ     15
        23 002334   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002335   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002336   000006 631400 24                 EPPR1   6
        23 002337   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002340   000000 011000                    NOP     0

  17345 23 002341   200013 470500                    LDP0    @ID$,,AUTO
        23 002342   000000 471500                    LDP1    0,,PR0
        23 002343   400000 236007                    LDQ     -131072,DL
        23 002344   100000 256100                    ORSQ    0,,PR1

      406    17354
      407    17355    4                CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17355 23 002345   200013 630500                    EPPR0   @ID$,,AUTO
        23 002346   000001 631400 24                 EPPR1   1
        23 002347   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002350   000000 011000                    NOP     0

      408    17356    4                RETURN;

  17356 23 002351   200012 221300                    LDX1  ! PAD_ST$,,AUTO
        23 002352   000001 702211                    TSX2  ! 1,X1

      409    17357    4              END;
      410    17358
      411    17359                 %GET_ADSC_LEN (ST$ = ITEM_ST$,
      412    17360                                RTN = LENGTH);

  17362 23 002353   000003 236100                    LDQ     3,,PR0
        23 002354   004000 316003                    CANQ    2048,DU
        23 002355   002371 600000 23                 TZE     s:17368

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:117  
  17363 23 002356   000005 471500                    LDP1    5,,PR0
        23 002357   100000 221100                    LDX1    0,,PR1
        23 002360   001105 101003                    CMPX1   581,DU
        23 002361   002366 601000 23                 TNZ     s:17366

  17364 23 002362   100003 473500                    LDP3    3,,PR1
        23 002363   300001 235100                    LDA     1,,PR3
        23 002364   200016 755100                    STA     LENGTH,,AUTO
        23 002365   002374 710000 23                 TRA     s:17372

  17366 23 002366   100001 235100                    LDA     1,,PR1
        23 002367   200016 755100                    STA     LENGTH,,AUTO
        23 002370   002374 710000 23                 TRA     s:17372

  17368 23 002371   000001 236100                    LDQ     1,,PR0
        23 002372   007777 376007                    ANQ     4095,DL
        23 002373   200016 756100                    STQ     LENGTH,,AUTO

      413    17371
      414    17372    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (ID$);

  17372 23 002374   200013 630500                    EPPR0   @ID$,,AUTO
        23 002375   000001 631400 24                 EPPR1   1
        23 002376   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002377   000000 011000                    NOP     0

      415    17373
      416    17374    3            ID$ = ITEM_ST$;

  17374 23 002400   200014 236100                    LDQ     ITEM_ST$,,AUTO
        23 002401   200013 470500                    LDP0    @ID$,,AUTO
        23 002402   000000 756100                    STQ     0,,PR0
        23 002403   002410 710000 23                 TRA     s:17383

      417    17375
      418    17376
      419    17377    3          CASE (ELSE);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:118  

      420    17378
      421    17379    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  17379 23 002404   000013 630400 24                 EPPR0   11
        23 002405   000001 631400 24                 EPPR1   1
        23 002406   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002407   000000 011000                    NOP     0

      422    17380
      423    17381    3        END; /* Case */

      424    17382
      425    17383    2   END CHECK_ID;

  17383 23 002410   200012 221300                    LDX1  ! PAD_ST$,,AUTO
        23 002411   000001 702211                    TSX2  ! 1,X1

      426    17384        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:119  
      427    17385    1   NEW_IO_STATUS_TEMP: PROC (ST$$);

  17385 23 002412   200016 741300       NEW_IO_STAT* STX1  ! LENGTH,,AUTO

      428    17386
      429    17387    2        DCL ST$$          PTR;
      430    17388
      431    17389
      432    17390    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ST$$);

  17390 23 002413   200017 236100                    LDQ     @ST$$,,AUTO
        23 002414   000024 235000 24                 LDA     20
        23 002415   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 002416   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002417   000011 631400 24                 EPPR1   9
        23 002420   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        23 002421   000000 011000                    NOP     0

      433    17391
      434    17392    2        ST$$ -> SCALAR.TYPE = %TYA;

  17392 23 002422   200017 470500                    LDP0    @ST$$,,AUTO
        23 002423   000000 471500                    LDP1    0,,PR0
        23 002424   000010 220003                    LDX0    8,DU
        23 002425   100002 740100                    STX0    2,,PR1

      435    17393    2        ST$$ -> SCALAR.B.CLASS = %CLASS_ALPHANUMERIC;

  17393 23 002426   000000 471500                    LDP1    0,,PR0
        23 002427   100003 236100                    LDQ     3,,PR1
        23 002430   000025 376000 24                 ANQ     21
        23 002431   000003 276007                    ORQ     3,DL
        23 002432   100003 756100                    STQ     3,,PR1

      436    17394    2        ST$$ -> SCALAR.ADSC.N  = 2;

  17394 23 002433   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:120  
        23 002434   000002 236007                    LDQ     2,DL
        23 002435   100001 752103                    STCQ    1,'03'O,PR1

      437    17395
      438    17396
      439    17397    2   END NEW_IO_STATUS_TEMP;

  17397 23 002436   200016 221300                    LDX1  ! LENGTH,,AUTO
        23 002437   000001 702211                    TSX2  ! 1,X1

      440    17398        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:121  
      441    17399    1   FILE_STATUS: PROC (LTS$$);

  17399 23 002440   200010 741300       FILE_STATUS  STX1  ! @LTS$$+1,,AUTO

      442    17400
      443    17401    2        DCL LTS$$         PTR;
      444    17402    2        DCL IO_STAT$      PTR;
      445    17403    2        DCL LINE          SBIN;
      446    17404    2        DCL COLUMN        SBIN;
      447    17405
      448    17406
      449    17407    2        IF LTS$$ -> FILE_LTS.FILE_STATUS$ = ADDR(NIL) THEN

  17407 23 002441   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002442   000000 471500                    LDP1    0,,PR0
        23 002443   100012 236100                    LDQ     10,,PR1
        23 002444   000000 116000 24                 CMPQ    0
        23 002445   002454 601000 23                 TNZ     s:17413

      450    17408    3          DO;

      451    17409    3            CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17409 23 002446   100012 633500                    EPPR3   10,,PR1
        23 002447   200017 453500                    STP3    @ST$$,,AUTO
        23 002450   002412 701000 23                 TSX1    NEW_IO_STATUS_TEMP
        23 002451   000000 011000                    NOP     0

      452    17410    3            RETURN;

  17410 23 002452   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002453   000001 702211                    TSX2  ! 1,X1

      453    17411    3          END;
      454    17412
      455    17413    2        CALL Z8CO$QUALIFY_VARIABLE (LTS$$ -> FILE_LTS.FILE_STATUS$,

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:122  
  17413 23 002454   200012 633500                    EPPR3   IO_STAT$,,AUTO
        23 002455   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 002456   100012 634500                    EPPR4   10,,PR1
        23 002457   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 002460   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002461   000011 631400 24                 EPPR1   9
        23 002462   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 002463   002465 702000 23                 TSX2    s:17417
        23 002464   002505 710000 23                 TRA     s:17422

      456    17414    2                                    IO_STAT$)
      457    17415    2          WHENALTRETURN
      458    17416    3            DO;

      459    17417    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17417 23 002465   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002466   000000 471500                    LDP1    0,,PR0
        23 002467   100012 633500                    EPPR3   10,,PR1
        23 002470   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002471   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002472   000001 631400 24                 EPPR1   1
        23 002473   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002474   000000 011000                    NOP     0

      460    17418    3              CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17418 23 002475   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002476   000000 471500                    LDP1    0,,PR0
        23 002477   100012 633500                    EPPR3   10,,PR1
        23 002500   200017 453500                    STP3    @ST$$,,AUTO
        23 002501   002412 701000 23                 TSX1    NEW_IO_STATUS_TEMP
        23 002502   000000 011000                    NOP     0

      461    17419    3              RETURN;

  17419 23 002503   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:123  
        23 002504   000001 702211                    TSX2  ! 1,X1

      462    17420    3            END;
      463    17421
      464    17422    2        COLUMN = LTS$$ -> FILE_LTS.FILE_STATUS$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;

  17422 23 002505   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002506   000000 471500                    LDP1    0,,PR0
        23 002507   100012 473500                    LDP3    10,,PR1
        23 002510   300004 474500                    LDP4    4,,PR3
        23 002511   400006 235100                    LDA     6,,PR4
        23 002512   200014 755100                    STA     COLUMN,,AUTO

      465    17423    2        LINE   = LTS$$ -> FILE_LTS.FILE_STATUS$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;

  17423 23 002513   000000 471500                    LDP1    0,,PR0
        23 002514   100012 473500                    LDP3    10,,PR1
        23 002515   300004 474500                    LDP4    4,,PR3
        23 002516   400005 235100                    LDA     5,,PR4
        23 002517   200013 755100                    STA     LINE,,AUTO

      466    17424
      467    17425    2        IF IO_STAT$ -> ST.TYPE ~= %TYA

  17425 23 002520   200012 471500                    LDP1    IO_STAT$,,AUTO
        23 002521   100002 220100                    LDX0    2,,PR1
        23 002522   000010 100003                    CMPX0   8,DU
        23 002523   002530 601000 23                 TNZ     s:17441
        23 002524   100003 236100                    LDQ     3,,PR1
        23 002525   000007 376007                    ANQ     7,DL
        23 002526   000003 116007                    CMPQ    3,DL
        23 002527   002565 600000 23                 TZE     s:17465

      468    17426    2        OR IO_STAT$ -> SCALAR.B.CLASS ~= %CLASS_ALPHANUMERIC THEN
      469    17427    3          DO;

      470    17428                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.FILE_STATUS$,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:124  
      471    17429                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
      472    17430                                     @LINE     = LINE,
      473    17431                                     @COLUMN   = COLUMN);

  17441 23 002530   000000 473500                    LDP3    0,,PR0
        23 002531   300012 474500                    LDP4    10,,PR3
        23 002532   400000 236100                    LDQ     0,,PR4
        23 002533   400000 316007                    CANQ    -131072,DL
        23 002534   002554 601000 23                 TNZ     s:17461

  17443 23 002535   200014 635500                    EPPR5   COLUMN,,AUTO
        23 002536   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 002537   200013 633500                    EPPR3   LINE,,AUTO
        23 002540   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 002541   000017 236000 24                 LDQ     15
        23 002542   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002543   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002544   000006 631400 24                 EPPR1   6
        23 002545   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002546   000000 011000                    NOP     0

  17452 23 002547   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002550   000000 471500                    LDP1    0,,PR0
        23 002551   100012 473500                    LDP3    10,,PR1
        23 002552   400000 236007                    LDQ     -131072,DL
        23 002553   300000 256100                    ORSQ    0,,PR3

      474    17461    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17461 23 002554   000000 471500                    LDP1    0,,PR0
        23 002555   100012 633500                    EPPR3   10,,PR1
        23 002556   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002557   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002560   000001 631400 24                 EPPR1   1
        23 002561   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002562   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:125  
      475    17462    3            RETURN;

  17462 23 002563   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002564   000001 702211                    TSX2  ! 1,X1

      476    17463    3          END;
      477    17464
      478    17465    2        IF IO_STAT$ -> ST.ADSC.N ~= 2 THEN

  17465 23 002565   100001 236100                    LDQ     1,,PR1
        23 002566   007777 376007                    ANQ     4095,DL
        23 002567   000002 116007                    CMPQ    2,DL
        23 002570   002634 600000 23                 TZE     s:17506

      479    17466    3          DO;

      480    17467                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.FILE_STATUS$,
      481    17468                                     @ERROR#   = %E$MUST_BE_2_CHAR_LONG,
      482    17469                                     @LINE     = LINE,
      483    17470                                     @COLUMN   = COLUMN);

  17480 23 002571   000000 473500                    LDP3    0,,PR0
        23 002572   300012 474500                    LDP4    10,,PR3
        23 002573   400000 236100                    LDQ     0,,PR4
        23 002574   400000 316007                    CANQ    -131072,DL
        23 002575   002615 601000 23                 TNZ     s:17501

  17482 23 002576   200014 635500                    EPPR5   COLUMN,,AUTO
        23 002577   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 002600   200013 633500                    EPPR3   LINE,,AUTO
        23 002601   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 002602   000027 236000 24                 LDQ     23
        23 002603   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 002604   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002605   000006 631400 24                 EPPR1   6
        23 002606   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002607   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:126  

  17491 23 002610   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002611   000000 471500                    LDP1    0,,PR0
        23 002612   100012 473500                    LDP3    10,,PR1
        23 002613   400000 236007                    LDQ     -131072,DL
        23 002614   300000 256100                    ORSQ    0,,PR3

      484    17500
      485    17501    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17501 23 002615   000000 471500                    LDP1    0,,PR0
        23 002616   100012 633500                    EPPR3   10,,PR1
        23 002617   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002620   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002621   000001 631400 24                 EPPR1   1
        23 002622   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002623   000000 011000                    NOP     0

      486    17502    3            CALL NEW_IO_STATUS_TEMP (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17502 23 002624   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002625   000000 471500                    LDP1    0,,PR0
        23 002626   100012 633500                    EPPR3   10,,PR1
        23 002627   200017 453500                    STP3    @ST$$,,AUTO
        23 002630   002412 701000 23                 TSX1    NEW_IO_STATUS_TEMP
        23 002631   000000 011000                    NOP     0

      487    17503    3            RETURN;

  17503 23 002632   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002633   000001 702211                    TSX2  ! 1,X1

      488    17504    3          END;
      489    17505
      490    17506    2        CALL CHECK_FOR_WORKING_STORAGE (IO_STAT$,

  17506 23 002634   000000 473500                    LDP3    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:127  
        23 002635   200014 634500                    EPPR4   COLUMN,,AUTO
        23 002636   200042 454500                    STP4    @LINE#+1,,AUTO
        23 002637   200013 635500                    EPPR5   LINE,,AUTO
        23 002640   200041 455500                    STP5    ST$$+1,,AUTO
        23 002641   300012 636500                    EPPR6   10,,PR3
        23 002642   200040 456500                    STP6    @LTS$$+1,,AUTO
        23 002643   200012 633500                    EPPR3   IO_STAT$,,AUTO
        23 002644   200037 453500                    STP3    @LEN+3,,AUTO
        23 002645   002703 701000 23                 TSX1    CHECK_FOR_WORKING_STORAGE
        23 002646   002650 702000 23                 TSX2    s:17511
        23 002647   002662 710000 23                 TRA     s:17515

      491    17507    2                                        LTS$$ -> FILE_LTS.FILE_STATUS$,
      492    17508    2                                        LINE, COLUMN)
      493    17509    2          WHENALTRETURN
      494    17510    3            DO;

      495    17511    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);

  17511 23 002650   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002651   000000 471500                    LDP1    0,,PR0
        23 002652   100012 633500                    EPPR3   10,,PR1
        23 002653   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002654   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002655   000001 631400 24                 EPPR1   1
        23 002656   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002657   000000 011000                    NOP     0

      496    17512    3              RETURN;

  17512 23 002660   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002661   000001 702211                    TSX2  ! 1,X1

      497    17513    3            END;
      498    17514
      499    17515    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.FILE_STATUS$);

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:128  
  17515 23 002662   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002663   000000 471500                    LDP1    0,,PR0
        23 002664   100012 633500                    EPPR3   10,,PR1
        23 002665   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 002666   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002667   000001 631400 24                 EPPR1   1
        23 002670   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 002671   000000 011000                    NOP     0

      500    17516
      501    17517    2        LTS$$ -> FILE_LTS.FILE_STATUS$ = IO_STAT$;

  17517 23 002672   200011 470500                    LDP0    @LTS$$,,AUTO
        23 002673   000000 471500                    LDP1    0,,PR0
        23 002674   200012 236100                    LDQ     IO_STAT$,,AUTO
        23 002675   100012 756100                    STQ     10,,PR1

      502    17518    2        LTS$$ -> FILE_LTS.FILE_STATUS2$ = ADDR(NIL);

  17518 23 002676   000000 471500                    LDP1    0,,PR0
        23 002677   000000 236000 24                 LDQ     0
        23 002700   100013 756100                    STQ     11,,PR1

      503    17519
      504    17520    2   END FILE_STATUS;

  17520 23 002701   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 002702   000001 702211                    TSX2  ! 1,X1

      505    17521        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:129  
      506    17522    1   CHECK_FOR_WORKING_STORAGE: PROC (ST$$, ITEM$, LINE#, COLUMN#) ALTRET;

  17522 23 002703   200036 741300       CHECK_FOR_W* STX1  ! @LEN+2,,AUTO

      507    17523
      508    17524    2        DCL ST$$          PTR;
      509    17525    2        DCL ITEM$         PTR;
      510    17526    2        DCL FATHER$       PTR;
      511    17527    2        DCL LINE#         SBIN;
      512    17528    2        DCL COLUMN#       SBIN;
      513    17529
      514    17530
      515    17531    2        IF ST$$ -> ST.ID ~= %CONST THEN

  17531 23 002704   200037 470500                    LDP0    @ST$$,,AUTO
        23 002705   000000 471500                    LDP1    0,,PR0
        23 002706   100000 220100                    LDX0    0,,PR1
        23 002707   000767 100003                    CMPX0   503,DU
        23 002710   003006 600000 23                 TZE     s:17619

      516    17532    3          DO;

      517    17533    3            IF ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY THEN

  17533 23 002711   000766 100003                    CMPX0   502,DU
        23 002712   002741 600000 23                 TZE     s:17571
        23 002713   000765 100003                    CMPX0   501,DU
        23 002714   002741 600000 23                 TZE     s:17571

      518    17534    4              DO;

      519    17535                     %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      520    17536                                         @ERROR#   = %E$MUST_BE_IN_WORK_STORAGE,
      521    17537                                         @LINE     = LINE#,
      522    17538                                         @COLUMN   = COLUMN#);

  17548 23 002715   200040 473500                    LDP3    @ITEM$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:130  
        23 002716   300000 474500                    LDP4    0,,PR3
        23 002717   400000 236100                    LDQ     0,,PR4
        23 002720   400000 316007                    CANQ    -131072,DL
        23 002721   002737 601000 23                 TNZ     s:17569

  17550 23 002722   200042 236100                    LDQ     @COLUMN#,,AUTO
        23 002723   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 002724   200041 236100                    LDQ     @LINE#,,AUTO
        23 002725   000031 235000 24                 LDA     25
        23 002726   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 002727   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002730   000006 631400 24                 EPPR1   6
        23 002731   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002732   000000 011000                    NOP     0

  17559 23 002733   200040 470500                    LDP0    @ITEM$,,AUTO
        23 002734   000000 471500                    LDP1    0,,PR0
        23 002735   400000 236007                    LDQ     -131072,DL
        23 002736   100000 256100                    ORSQ    0,,PR1

      523    17568
      524    17569    4                ALTRETURN;

  17569 23 002737   200036 221300                    LDX1  ! @LEN+2,,AUTO
        23 002740   000000 702211                    TSX2  ! 0,X1

      525    17570    4              END;
      526    17571    3            FATHER$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;

  17571 23 002741   100007 473500                    LDP3    7,,PR1
        23 002742   300001 236100                    LDQ     1,,PR3
        23 002743   200043 756100                    STQ     FATHER$,,AUTO

      527    17572
      528    17573    4            DO WHILE (FATHER$ ~= ADDR(NIL));

  17573 23 002744   003004 710000 23                 TRA     s:17616
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:131  

      529    17574    4              IF FATHER$ -> QLT.ST$ -> ST.ID = %FD

  17574 23 002745   200043 470500                    LDP0    FATHER$,,AUTO
        23 002746   000004 471500                    LDP1    4,,PR0
        23 002747   100000 220100                    LDX0    0,,PR1
        23 002750   001002 100003                    CMPX0   514,DU
        23 002751   002756 600000 23                 TZE     s:17591
        23 002752   001005 100003                    CMPX0   517,DU
        23 002753   002756 600000 23                 TZE     s:17591
        23 002754   001004 100003                    CMPX0   516,DU
        23 002755   003002 601000 23                 TNZ     s:17615

      530    17575    4              OR FATHER$ -> QLT.ST$ -> ST.ID = %RD
      531    17576    4              OR FATHER$ -> QLT.ST$ -> ST.ID = %CD THEN
      532    17577    5                DO;

      533    17578                       %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      534    17579                                           @ERROR#   = %E$MUST_BE_IN_WORK_STORAGE,
      535    17580                                           @LINE     = LINE#,
      536    17581                                           @COLUMN   = COLUMN#);

  17591 23 002756   200040 473500                    LDP3    @ITEM$,,AUTO
        23 002757   300000 474500                    LDP4    0,,PR3
        23 002760   400000 236100                    LDQ     0,,PR4
        23 002761   400000 316007                    CANQ    -131072,DL
        23 002762   003000 601000 23                 TNZ     s:17612

  17593 23 002763   200042 236100                    LDQ     @COLUMN#,,AUTO
        23 002764   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 002765   200041 236100                    LDQ     @LINE#,,AUTO
        23 002766   000031 235000 24                 LDA     25
        23 002767   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 002770   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 002771   000006 631400 24                 EPPR1   6
        23 002772   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002773   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:132  

  17602 23 002774   200040 470500                    LDP0    @ITEM$,,AUTO
        23 002775   000000 471500                    LDP1    0,,PR0
        23 002776   400000 236007                    LDQ     -131072,DL
        23 002777   100000 256100                    ORSQ    0,,PR1

      537    17611
      538    17612    5                  ALTRETURN;

  17612 23 003000   200036 221300                    LDX1  ! @LEN+2,,AUTO
        23 003001   000000 702211                    TSX2  ! 0,X1

      539    17613    5                END;
      540    17614
      541    17615    4              FATHER$ = FATHER$ -> QLT.FATHER;

  17615 23 003002   000001 236100                    LDQ     1,,PR0
        23 003003   200043 756100                    STQ     FATHER$,,AUTO

      542    17616    4            END; /* While */

  17616 23 003004   000000 116000 24                 CMPQ    0
        23 003005   002745 601000 23                 TNZ     s:17574

      543    17617    3          END;

      544    17618
      545    17619    2   END CHECK_FOR_WORKING_STORAGE;

  17619 23 003006   200036 221300                    LDX1  ! @LEN+2,,AUTO
        23 003007   000001 702211                    TSX2  ! 1,X1

      546    17620        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:133  
      547    17621    1   LINAGE: PROC (LTS$$);

  17621 23 003010   200010 741300       LINAGE       STX1  ! @LTS$$+1,,AUTO

      548    17622
      549    17623    2        DCL LTS$$         PTR;
      550    17624    2        DCL LINES$        PTR;
      551    17625    2        DCL FOOT$         PTR;
      552    17626    2        DCL TOP$          PTR;
      553    17627    2        DCL BOTTOM$       PTR;
      554    17628    2        DCL LINE          SBIN;
      555    17629    2        DCL COLUMN        SBIN;
      556    17630    2        DCL ST$$          PTR;
      557    17631
      558    17632             %MACRO LINAGE_ERROR (@FIELD$ = , @ERROR# = );
      559    17633
      560    17634                 %LSET @@@ITEM_LINE = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      561    17635                                                '-> LX_ITEM.LINE'));
      562    17636                 %LSET @@@ITEM_COL  = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      563    17637                                                '-> LX_ITEM.COLUMN'));
      564    17638                 %LSET @@@LIST_LINE = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      565    17639                                                '-> LX_LIST.HEAD$ -> LX_ITEM.LINE'));
      566    17640                 %LSET @@@LIST_COL  = CHARTEXT (CONCAT (TEXTCHAR (@FIELD$),
      567    17641                                                '-> LX_LIST.HEAD$ -> LX_ITEM.COLUMN'));
      568    17642                 DO;
      569    17643                   IF @FIELD$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      570    17644                     %CONDITIONAL_ERROR (@LX_ITEM$ = @FIELD$,
      571    17645                         @ERROR# = @ERROR#,
      572    17646                         @LINE   = "%@@@ITEM_LINE",
      573    17647                         @COLUMN = "%@@@ITEM_COL");
      574    17648                   ELSE
      575    17649                     %CONDITIONAL_ERROR (@LX_ITEM$ = @FIELD$,
      576    17650                         @ERROR# = @ERROR#,
      577    17651                         @LINE   = "%@@@LIST_LINE",
      578    17652                         @COLUMN = "%@@@LIST_COL");
      579    17653
      580    17654                   CALL Z8ED$DISPOSE_ABSSYN_TREE (@FIELD$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:134  
      581    17655                 END;
      582    17656             %MEND;
      583    17657             %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:135  
      584    17658    2        IF LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = ADDR(NIL) THEN

  17658 23 003011   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003012   000000 471500                    LDP1    0,,PR0
        23 003013   100033 236100                    LDQ     27,,PR1
        23 003014   000000 116000 24                 CMPQ    0
        23 003015   003255 601000 23                 TNZ     s:17915

      585    17659    3          DO;

      586    17660    3            IF LTS$$ -> FILE_LTS.LINAGE.FOOTING$ ~= ADDR(NIL) THEN

  17660 23 003016   100034 236100                    LDQ     28,,PR1
        23 003017   000000 116000 24                 CMPQ    0
        23 003020   003101 600000 23                 TZE     s:17744

      587    17661                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      588    17662                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);

  17672 23 003021   100034 473500                    LDP3    28,,PR1
        23 003022   300000 220100                    LDX0    0,,PR3
        23 003023   003047 601000 23                 TNZ     s:17720

  17686 23 003024   300000 236100                    LDQ     0,,PR3
        23 003025   400000 316007                    CANQ    -131072,DL
        23 003026   003072 601000 23                 TNZ     s:17740

  17688 23 003027   300006 634500                    EPPR4   6,,PR3
        23 003030   200052 454500                    STP4    SON_FD$$+4,,AUTO
        23 003031   300005 631500                    EPPR1   5,,PR3
        23 003032   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003033   000033 236000 24                 LDQ     27
        23 003034   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003035   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003036   000006 631400 24                 EPPR1   6
        23 003037   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003040   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:136  

  17697 23 003041   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003042   000000 471500                    LDP1    0,,PR0
        23 003043   100034 473500                    LDP3    28,,PR1
        23 003044   400000 236007                    LDQ     -131072,DL
        23 003045   300000 256100                    ORSQ    0,,PR3

  17704 23 003046   003072 710000 23                 TRA     s:17740

  17720 23 003047   300000 236100                    LDQ     0,,PR3
        23 003050   400000 316007                    CANQ    -131072,DL
        23 003051   003072 601000 23                 TNZ     s:17740

  17722 23 003052   300004 474500                    LDP4    4,,PR3
        23 003053   400006 635500                    EPPR5   6,,PR4
        23 003054   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 003055   400005 631500                    EPPR1   5,,PR4
        23 003056   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003057   000033 236000 24                 LDQ     27
        23 003060   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003061   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003062   000006 631400 24                 EPPR1   6
        23 003063   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003064   000000 011000                    NOP     0

  17731 23 003065   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003066   000000 471500                    LDP1    0,,PR0
        23 003067   100034 473500                    LDP3    28,,PR1
        23 003070   400000 236007                    LDQ     -131072,DL
        23 003071   300000 256100                    ORSQ    0,,PR3

  17740 23 003072   000000 471500                    LDP1    0,,PR0
        23 003073   100034 633500                    EPPR3   28,,PR1
        23 003074   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003075   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003076   000001 631400 24                 EPPR1   1
        23 003077   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:137  
        23 003100   000000 011000                    NOP     0

      589    17743
      590    17744    3            IF LTS$$ -> FILE_LTS.LINAGE.BOTTOM$ ~= ADDR(NIL) THEN

  17744 23 003101   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003102   000000 471500                    LDP1    0,,PR0
        23 003103   100036 236100                    LDQ     30,,PR1
        23 003104   000000 116000 24                 CMPQ    0
        23 003105   003166 600000 23                 TZE     s:17828

      591    17745                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.BOTTOM$,
      592    17746                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);

  17756 23 003106   100036 473500                    LDP3    30,,PR1
        23 003107   300000 220100                    LDX0    0,,PR3
        23 003110   003134 601000 23                 TNZ     s:17804

  17770 23 003111   300000 236100                    LDQ     0,,PR3
        23 003112   400000 316007                    CANQ    -131072,DL
        23 003113   003157 601000 23                 TNZ     s:17824

  17772 23 003114   300006 634500                    EPPR4   6,,PR3
        23 003115   200052 454500                    STP4    SON_FD$$+4,,AUTO
        23 003116   300005 631500                    EPPR1   5,,PR3
        23 003117   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003120   000033 236000 24                 LDQ     27
        23 003121   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003122   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003123   000006 631400 24                 EPPR1   6
        23 003124   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003125   000000 011000                    NOP     0

  17781 23 003126   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003127   000000 471500                    LDP1    0,,PR0
        23 003130   100036 473500                    LDP3    30,,PR1
        23 003131   400000 236007                    LDQ     -131072,DL
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:138  
        23 003132   300000 256100                    ORSQ    0,,PR3

  17788 23 003133   003157 710000 23                 TRA     s:17824

  17804 23 003134   300000 236100                    LDQ     0,,PR3
        23 003135   400000 316007                    CANQ    -131072,DL
        23 003136   003157 601000 23                 TNZ     s:17824

  17806 23 003137   300004 474500                    LDP4    4,,PR3
        23 003140   400006 635500                    EPPR5   6,,PR4
        23 003141   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 003142   400005 631500                    EPPR1   5,,PR4
        23 003143   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003144   000033 236000 24                 LDQ     27
        23 003145   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003146   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003147   000006 631400 24                 EPPR1   6
        23 003150   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003151   000000 011000                    NOP     0

  17815 23 003152   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003153   000000 471500                    LDP1    0,,PR0
        23 003154   100036 473500                    LDP3    30,,PR1
        23 003155   400000 236007                    LDQ     -131072,DL
        23 003156   300000 256100                    ORSQ    0,,PR3

  17824 23 003157   000000 471500                    LDP1    0,,PR0
        23 003160   100036 633500                    EPPR3   30,,PR1
        23 003161   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003162   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003163   000001 631400 24                 EPPR1   1
        23 003164   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003165   000000 011000                    NOP     0

      593    17827
      594    17828    3            IF LTS$$ -> FILE_LTS.LINAGE.TOP$ ~= ADDR(NIL) THEN

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:139  
  17828 23 003166   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003167   000000 471500                    LDP1    0,,PR0
        23 003170   100035 236100                    LDQ     29,,PR1
        23 003171   000000 116000 24                 CMPQ    0
        23 003172   003253 600000 23                 TZE     s:17912

      595    17829                   %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.TOP$,
      596    17830                                  @ERROR# = %E$LINES_MUST_BE_SPECIFIED);

  17840 23 003173   100035 473500                    LDP3    29,,PR1
        23 003174   300000 220100                    LDX0    0,,PR3
        23 003175   003221 601000 23                 TNZ     s:17888

  17854 23 003176   300000 236100                    LDQ     0,,PR3
        23 003177   400000 316007                    CANQ    -131072,DL
        23 003200   003244 601000 23                 TNZ     s:17908

  17856 23 003201   300006 634500                    EPPR4   6,,PR3
        23 003202   200052 454500                    STP4    SON_FD$$+4,,AUTO
        23 003203   300005 631500                    EPPR1   5,,PR3
        23 003204   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003205   000033 236000 24                 LDQ     27
        23 003206   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003207   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003210   000006 631400 24                 EPPR1   6
        23 003211   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003212   000000 011000                    NOP     0

  17865 23 003213   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003214   000000 471500                    LDP1    0,,PR0
        23 003215   100035 473500                    LDP3    29,,PR1
        23 003216   400000 236007                    LDQ     -131072,DL
        23 003217   300000 256100                    ORSQ    0,,PR3

  17872 23 003220   003244 710000 23                 TRA     s:17908

  17888 23 003221   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:140  
        23 003222   400000 316007                    CANQ    -131072,DL
        23 003223   003244 601000 23                 TNZ     s:17908

  17890 23 003224   300004 474500                    LDP4    4,,PR3
        23 003225   400006 635500                    EPPR5   6,,PR4
        23 003226   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 003227   400005 631500                    EPPR1   5,,PR4
        23 003230   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 003231   000033 236000 24                 LDQ     27
        23 003232   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003233   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003234   000006 631400 24                 EPPR1   6
        23 003235   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003236   000000 011000                    NOP     0

  17899 23 003237   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003240   000000 471500                    LDP1    0,,PR0
        23 003241   100035 473500                    LDP3    29,,PR1
        23 003242   400000 236007                    LDQ     -131072,DL
        23 003243   300000 256100                    ORSQ    0,,PR3

  17908 23 003244   000000 471500                    LDP1    0,,PR0
        23 003245   100035 633500                    EPPR3   29,,PR1
        23 003246   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003247   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003250   000001 631400 24                 EPPR1   1
        23 003251   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003252   000000 011000                    NOP     0

      597    17911
      598    17912    3            RETURN;

  17912 23 003253   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 003254   000001 702211                    TSX2  ! 1,X1

      599    17913    3          END;
      600    17914
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:141  
      601    17915    2        LINES$   = ADDR(NIL);

  17915 23 003255   000000 236000 24                 LDQ     0
        23 003256   200012 756100                    STQ     LINES$,,AUTO

      602    17916    2        BOTTOM$  = ADDR(NIL);

  17916 23 003257   200015 756100                    STQ     BOTTOM$,,AUTO

      603    17917    2        FOOT$    = ADDR(NIL);

  17917 23 003260   200013 756100                    STQ     FOOT$,,AUTO

      604    17918    2        TOP$     = ADDR(NIL);

  17918 23 003261   200014 756100                    STQ     TOP$,,AUTO

      605    17919
      606    17920    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$,

  17920 23 003262   000000 471500                    LDP1    0,,PR0
        23 003263   200012 633500                    EPPR3   LINES$,,AUTO
        23 003264   200024 453500                    STP3    LINE+1,,AUTO
        23 003265   100033 634500                    EPPR4   27,,PR1
        23 003266   200023 454500                    STP4    QLT$$+1,,AUTO
        23 003267   003711 701000 23                 TSX1    VERIFY_LINAGE_ITEM
        23 003270   000000 011000                    NOP     0

      607    17921    2                                 LINES$);
      608    17922    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.FOOTING$,

  17922 23 003271   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003272   000000 471500                    LDP1    0,,PR0
        23 003273   200013 633500                    EPPR3   FOOT$,,AUTO
        23 003274   200024 453500                    STP3    LINE+1,,AUTO
        23 003275   100034 634500                    EPPR4   28,,PR1
        23 003276   200023 454500                    STP4    QLT$$+1,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:142  
        23 003277   003711 701000 23                 TSX1    VERIFY_LINAGE_ITEM
        23 003300   000000 011000                    NOP     0

      609    17923    2                                 FOOT$);
      610    17924    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.BOTTOM$,

  17924 23 003301   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003302   000000 471500                    LDP1    0,,PR0
        23 003303   200015 633500                    EPPR3   BOTTOM$,,AUTO
        23 003304   200024 453500                    STP3    LINE+1,,AUTO
        23 003305   100036 634500                    EPPR4   30,,PR1
        23 003306   200023 454500                    STP4    QLT$$+1,,AUTO
        23 003307   003711 701000 23                 TSX1    VERIFY_LINAGE_ITEM
        23 003310   000000 011000                    NOP     0

      611    17925    2                                 BOTTOM$);
      612    17926    2        CALL VERIFY_LINAGE_ITEM (LTS$$ -> FILE_LTS.LINAGE.TOP$,

  17926 23 003311   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003312   000000 471500                    LDP1    0,,PR0
        23 003313   200014 633500                    EPPR3   TOP$,,AUTO
        23 003314   200024 453500                    STP3    LINE+1,,AUTO
        23 003315   100035 634500                    EPPR4   29,,PR1
        23 003316   200023 454500                    STP4    QLT$$+1,,AUTO
        23 003317   003711 701000 23                 TSX1    VERIFY_LINAGE_ITEM
        23 003320   000000 011000                    NOP     0

      613    17927    2                                 TOP$);
      614    17928
      615    17929    2        IF FOOT$ ~= ADDR(NIL)

  17929 23 003321   200013 236100                    LDQ     FOOT$,,AUTO
        23 003322   000000 116000 24                 CMPQ    0
        23 003323   003415 600000 23                 TZE     s:18017
        23 003324   000124 470400 xsym               LDP0    COMCOM+84
        23 003325   000001 116100                    CMPQ    1,,PR0
        23 003326   003415 601000 23                 TNZ     s:18017
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:143  

      616    17930    2        AND FOOT$ = COMCOM.VALUE_0 -> ETT.LOP THEN
      617    17931    3          DO;

      618    17932                 %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      619    17933                                @ERROR# = %E$MUST_BE_GTR_ZERO);

  17943 23 003327   200011 471500                    LDP1    @LTS$$,,AUTO
        23 003330   100000 473500                    LDP3    0,,PR1
        23 003331   300034 474500                    LDP4    28,,PR3
        23 003332   400000 220100                    LDX0    0,,PR4
        23 003333   003357 601000 23                 TNZ     s:17991

  17957 23 003334   400000 236100                    LDQ     0,,PR4
        23 003335   400000 316007                    CANQ    -131072,DL
        23 003336   003402 601000 23                 TNZ     s:18011

  17959 23 003337   400006 635500                    EPPR5   6,,PR4
        23 003340   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 003341   400005 633500                    EPPR3   5,,PR4
        23 003342   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 003343   000035 236000 24                 LDQ     29
        23 003344   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003345   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003346   000006 631400 24                 EPPR1   6
        23 003347   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003350   000000 011000                    NOP     0

  17968 23 003351   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003352   000000 471500                    LDP1    0,,PR0
        23 003353   100034 473500                    LDP3    28,,PR1
        23 003354   400000 236007                    LDQ     -131072,DL
        23 003355   300000 256100                    ORSQ    0,,PR3

  17975 23 003356   003402 710000 23                 TRA     s:18011

  17991 23 003357   400000 236100                    LDQ     0,,PR4
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:144  
        23 003360   400000 316007                    CANQ    -131072,DL
        23 003361   003402 601000 23                 TNZ     s:18011

  17993 23 003362   400004 475500                    LDP5    4,,PR4
        23 003363   500006 636500                    EPPR6   6,,PR5
        23 003364   200052 456500                    STP6    SON_FD$$+4,,AUTO
        23 003365   500005 633500                    EPPR3   5,,PR5
        23 003366   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 003367   000035 236000 24                 LDQ     29
        23 003370   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003371   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003372   000006 631400 24                 EPPR1   6
        23 003373   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003374   000000 011000                    NOP     0

  18002 23 003375   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003376   000000 471500                    LDP1    0,,PR0
        23 003377   100034 473500                    LDP3    28,,PR1
        23 003400   400000 236007                    LDQ     -131072,DL
        23 003401   300000 256100                    ORSQ    0,,PR3

  18011 23 003402   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003403   000000 471500                    LDP1    0,,PR0
        23 003404   100034 633500                    EPPR3   28,,PR1
        23 003405   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003406   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003407   000001 631400 24                 EPPR1   1
        23 003410   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003411   000000 011000                    NOP     0

      620    18014    3            FOOT$ = COMCOM.VALUE_1 -> ETT.LOP;

  18014 23 003412   000125 470400 xsym               LDP0    COMCOM+85
        23 003413   000001 236100                    LDQ     1,,PR0
        23 003414   200013 756100                    STQ     FOOT$,,AUTO

      621    18015    3          END;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:145  

      622    18016
      623    18017    2        IF LINES$ = COMCOM.VALUE_0 -> ETT.LOP THEN

  18017 23 003415   000124 470400 xsym               LDP0    COMCOM+84
        23 003416   200012 236100                    LDQ     LINES$,,AUTO
        23 003417   000001 116100                    CMPQ    1,,PR0
        23 003420   003507 601000 23                 TNZ     s:18104

      624    18018    3          DO;

      625    18019                 %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$,
      626    18020                                @ERROR# = %E$MUST_BE_GTR_ZERO);

  18030 23 003421   200011 471500                    LDP1    @LTS$$,,AUTO
        23 003422   100000 473500                    LDP3    0,,PR1
        23 003423   300033 474500                    LDP4    27,,PR3
        23 003424   400000 220100                    LDX0    0,,PR4
        23 003425   003451 601000 23                 TNZ     s:18078

  18044 23 003426   400000 236100                    LDQ     0,,PR4
        23 003427   400000 316007                    CANQ    -131072,DL
        23 003430   003474 601000 23                 TNZ     s:18098

  18046 23 003431   400006 635500                    EPPR5   6,,PR4
        23 003432   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 003433   400005 633500                    EPPR3   5,,PR4
        23 003434   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 003435   000035 236000 24                 LDQ     29
        23 003436   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003437   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003440   000006 631400 24                 EPPR1   6
        23 003441   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003442   000000 011000                    NOP     0

  18055 23 003443   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003444   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:146  
        23 003445   100033 473500                    LDP3    27,,PR1
        23 003446   400000 236007                    LDQ     -131072,DL
        23 003447   300000 256100                    ORSQ    0,,PR3

  18062 23 003450   003474 710000 23                 TRA     s:18098

  18078 23 003451   400000 236100                    LDQ     0,,PR4
        23 003452   400000 316007                    CANQ    -131072,DL
        23 003453   003474 601000 23                 TNZ     s:18098

  18080 23 003454   400004 475500                    LDP5    4,,PR4
        23 003455   500006 636500                    EPPR6   6,,PR5
        23 003456   200052 456500                    STP6    SON_FD$$+4,,AUTO
        23 003457   500005 633500                    EPPR3   5,,PR5
        23 003460   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 003461   000035 236000 24                 LDQ     29
        23 003462   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003463   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003464   000006 631400 24                 EPPR1   6
        23 003465   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003466   000000 011000                    NOP     0

  18089 23 003467   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003470   000000 471500                    LDP1    0,,PR0
        23 003471   100033 473500                    LDP3    27,,PR1
        23 003472   400000 236007                    LDQ     -131072,DL
        23 003473   300000 256100                    ORSQ    0,,PR3

  18098 23 003474   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003475   000000 471500                    LDP1    0,,PR0
        23 003476   100033 633500                    EPPR3   27,,PR1
        23 003477   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003500   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003501   000001 631400 24                 EPPR1   1
        23 003502   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003503   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:147  
      627    18101    3            LINES$ = COMCOM.ARGS2 -> ETT.LOP;

  18101 23 003504   000005 470400 xsym               LDP0    COMCOM+5
        23 003505   000001 236100                    LDQ     1,,PR0
        23 003506   200012 756100                    STQ     LINES$,,AUTO

      628    18102    3          END;

      629    18103
      630    18104    2        IF  FOOT$ ~= ADDR(NIL)

  18104 23 003507   200013 236100                    LDQ     FOOT$,,AUTO
        23 003510   000000 116000 24                 CMPQ    0
        23 003511   003616 600000 23                 TZE     s:18196
        23 003512   200013 470500                    LDP0    FOOT$,,AUTO
        23 003513   000000 220100                    LDX0    0,,PR0
        23 003514   000767 100003                    CMPX0   503,DU
        23 003515   003616 601000 23                 TNZ     s:18196

      631    18105    2        AND FOOT$ -> ST.ID = %CONST THEN
      632    18106    2          IF LINES$ -> ST.ID = %CONST THEN

  18106 23 003516   200012 471500                    LDP1    LINES$,,AUTO
        23 003517   100000 221100                    LDX1    0,,PR1
        23 003520   000767 101003                    CMPX1   503,DU
        23 003521   003616 601000 23                 TNZ     s:18196

      633    18107    2            IF FOOT$ -> CONST.CONSTI.WORD1 > LINES$ -> CONST.CONSTI.WORD1 THEN

  18107 23 003522   000010 236100                    LDQ     8,,PR0
        23 003523   100010 116100                    CMPQ    8,,PR1
        23 003524   003616 604400 23                 TMOZ    s:18196

      634    18108    3              DO;

      635    18109                     %LINAGE_ERROR (@FIELD$ = LTS$$ -> FILE_LTS.LINAGE.FOOTING$,
      636    18110                                    @ERROR# = %E$FOOTING_GTR_LINES);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:148  

  18120 23 003525   200011 473500                    LDP3    @LTS$$,,AUTO
        23 003526   300000 474500                    LDP4    0,,PR3
        23 003527   400034 475500                    LDP5    28,,PR4
        23 003530   500000 222100                    LDX2    0,,PR5
        23 003531   003555 601000 23                 TNZ     s:18168

  18134 23 003532   500000 236100                    LDQ     0,,PR5
        23 003533   400000 316007                    CANQ    -131072,DL
        23 003534   003600 601000 23                 TNZ     s:18188

  18136 23 003535   500006 636500                    EPPR6   6,,PR5
        23 003536   200052 456500                    STP6    SON_FD$$+4,,AUTO
        23 003537   500005 634500                    EPPR4   5,,PR5
        23 003540   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 003541   000037 236000 24                 LDQ     31
        23 003542   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003543   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003544   000006 631400 24                 EPPR1   6
        23 003545   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003546   000000 011000                    NOP     0

  18145 23 003547   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003550   000000 471500                    LDP1    0,,PR0
        23 003551   100034 473500                    LDP3    28,,PR1
        23 003552   400000 236007                    LDQ     -131072,DL
        23 003553   300000 256100                    ORSQ    0,,PR3

  18152 23 003554   003600 710000 23                 TRA     s:18188

  18168 23 003555   500000 236100                    LDQ     0,,PR5
        23 003556   400000 316007                    CANQ    -131072,DL
        23 003557   003600 601000 23                 TNZ     s:18188

  18170 23 003560   500004 476500                    LDP6    4,,PR5
        23 003561   600006 637500                    EPPR7   6,,PR6
        23 003562   200052 457500                    STP7    SON_FD$$+4,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:149  
        23 003563   600005 634500                    EPPR4   5,,PR6
        23 003564   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 003565   000037 236000 24                 LDQ     31
        23 003566   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003567   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003570   000006 631400 24                 EPPR1   6
        23 003571   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003572   000000 011000                    NOP     0

  18179 23 003573   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003574   000000 471500                    LDP1    0,,PR0
        23 003575   100034 473500                    LDP3    28,,PR1
        23 003576   400000 236007                    LDQ     -131072,DL
        23 003577   300000 256100                    ORSQ    0,,PR3

  18188 23 003600   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003601   000000 471500                    LDP1    0,,PR0
        23 003602   100034 633500                    EPPR3   28,,PR1
        23 003603   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003604   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003605   000001 631400 24                 EPPR1   1
        23 003606   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003607   000000 011000                    NOP     0

      637    18191    3                ST$$ = FOOT$;

  18191 23 003610   200013 236100                    LDQ     FOOT$,,AUTO
        23 003611   200020 756100                    STQ     ST$$,,AUTO

      638    18192    3                FOOT$ = LINES$;

  18192 23 003612   200012 236100                    LDQ     LINES$,,AUTO
        23 003613   200013 756100                    STQ     FOOT$,,AUTO

      639    18193    3                LINES$ = ST$$;

  18193 23 003614   200020 236100                    LDQ     ST$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:150  
        23 003615   200012 756100                    STQ     LINES$,,AUTO

      640    18194    3              END;

      641    18195
      642    18196    2        IF LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ ~= ADDR(NIL) THEN

  18196 23 003616   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003617   000000 471500                    LDP1    0,,PR0
        23 003620   100033 236100                    LDQ     27,,PR1
        23 003621   000000 116000 24                 CMPQ    0
        23 003622   003631 600000 23                 TZE     s:18199

      643    18197    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$);

  18197 23 003623   100033 633500                    EPPR3   27,,PR1
        23 003624   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003625   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003626   000001 631400 24                 EPPR1   1
        23 003627   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003630   000000 011000                    NOP     0

      644    18198
      645    18199    2        IF LTS$$ -> FILE_LTS.LINAGE.BOTTOM$ ~= ADDR(NIL) THEN

  18199 23 003631   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003632   000000 471500                    LDP1    0,,PR0
        23 003633   100036 236100                    LDQ     30,,PR1
        23 003634   000000 116000 24                 CMPQ    0
        23 003635   003644 600000 23                 TZE     s:18202

      646    18200    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.BOTTOM$);

  18200 23 003636   100036 633500                    EPPR3   30,,PR1
        23 003637   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003640   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003641   000001 631400 24                 EPPR1   1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:151  
        23 003642   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003643   000000 011000                    NOP     0

      647    18201
      648    18202    2        IF LTS$$ -> FILE_LTS.LINAGE.TOP$ ~= ADDR(NIL) THEN

  18202 23 003644   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003645   000000 471500                    LDP1    0,,PR0
        23 003646   100035 236100                    LDQ     29,,PR1
        23 003647   000000 116000 24                 CMPQ    0
        23 003650   003657 600000 23                 TZE     s:18205

      649    18203    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.TOP$);

  18203 23 003651   100035 633500                    EPPR3   29,,PR1
        23 003652   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003653   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003654   000001 631400 24                 EPPR1   1
        23 003655   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 003656   000000 011000                    NOP     0

      650    18204
      651    18205    2        IF LTS$$ -> FILE_LTS.LINAGE.FOOTING$ ~= ADDR(NIL) THEN

  18205 23 003657   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003660   000000 471500                    LDP1    0,,PR0
        23 003661   100034 236100                    LDQ     28,,PR1
        23 003662   000000 116000 24                 CMPQ    0
        23 003663   003672 600000 23                 TZE     s:18208

      652    18206    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.LINAGE.FOOTING$);

  18206 23 003664   100034 633500                    EPPR3   28,,PR1
        23 003665   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 003666   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003667   000001 631400 24                 EPPR1   1
        23 003670   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:152  
        23 003671   000000 011000                    NOP     0

      653    18207
      654    18208    2        LTS$$ -> FILE_LTS.LINAGE.NO_OF_LINES$ = LINES$;

  18208 23 003672   200011 470500                    LDP0    @LTS$$,,AUTO
        23 003673   000000 471500                    LDP1    0,,PR0
        23 003674   200012 236100                    LDQ     LINES$,,AUTO
        23 003675   100033 756100                    STQ     27,,PR1

      655    18209    2        LTS$$ -> FILE_LTS.LINAGE.FOOTING$     = FOOT$;

  18209 23 003676   000000 471500                    LDP1    0,,PR0
        23 003677   200013 236100                    LDQ     FOOT$,,AUTO
        23 003700   100034 756100                    STQ     28,,PR1

      656    18210    2        LTS$$ -> FILE_LTS.LINAGE.BOTTOM$      = BOTTOM$;

  18210 23 003701   000000 471500                    LDP1    0,,PR0
        23 003702   200015 236100                    LDQ     BOTTOM$,,AUTO
        23 003703   100036 756100                    STQ     30,,PR1

      657    18211    2        LTS$$ -> FILE_LTS.LINAGE.TOP$         = TOP$;

  18211 23 003704   000000 471500                    LDP1    0,,PR0
        23 003705   200014 236100                    LDQ     TOP$,,AUTO
        23 003706   100035 756100                    STQ     29,,PR1

      658    18212
      659    18213
      660    18214    2   END LINAGE;

  18214 23 003707   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 003710   000001 702211                    TSX2  ! 1,X1

      661    18215        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:153  
      662    18216    1   VERIFY_LINAGE_ITEM: PROC (ITEM$, ST$$);

  18216 23 003711   200022 741300       VERIFY_LINA* STX1  ! @ST$$+1,,AUTO

      663    18217
      664    18218    2        DCL ITEM$         PTR;
      665    18219    2        DCL ST$$          PTR;
      666    18220
      667    18221             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      668    18225
      669    18226
      670    18227    2        IF ITEM$ = ADDR(NIL) THEN

  18227 23 003712   200023 470500                    LDP0    @ITEM$,,AUTO
        23 003713   000000 236100                    LDQ     0,,PR0
        23 003714   000000 116000 24                 CMPQ    0
        23 003715   003717 601000 23                 TNZ     s:18230

      671    18228    2          RETURN;

  18228 23 003716   000001 702211                    TSX2  ! 1,X1

      672    18229
      673    18230    2        IF ITEM$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  18230 23 003717   000000 471500                    LDP1    0,,PR0
        23 003720   100000 220100                    LDX0    0,,PR1
        23 003721   003761 601000 23                 TNZ     s:18274

      674    18231    3          DO;

      675    18232    3            CALL Z8EC$CREATE_CONST (%TYI, ITEM$, ST$$)

  18232 23 003722   200024 236100                    LDQ     @ST$$,,AUTO
        23 003723   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 003724   200023 236100                    LDQ     @ITEM$,,AUTO
        23 003725   000041 235000 24                 LDA     33
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:154  
        23 003726   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 003727   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003730   000006 631400 24                 EPPR1   6
        23 003731   000000 701000 xent               TSX1    Z8EC$CREATE_CONST
        23 003732   003734 702000 23                 TSX2    s:18249
        23 003733   003753 710000 23                 TRA     s:18270

      676    18233    3              WHENALTRETURN
      677    18234    4                DO;

      678    18235                       %CONDITIONAL_ERROR
      679    18236                         (@LX_ITEM$ = ITEM$,
      680    18237                          @ERROR#   = %E$VALUE_OVERFLOW,
      681    18238                          @LINE     = ITEM$ -> LX_TERMINAL.LINE,
      682    18239                          @COLUMN   = ITEM$ -> LX_TERMINAL.COLUMN);

  18249 23 003734   200023 470500                    LDP0    @ITEM$,,AUTO
        23 003735   000000 471500                    LDP1    0,,PR0
        23 003736   100000 236100                    LDQ     0,,PR1
        23 003737   400000 316007                    CANQ    -131072,DL
        23 003740   003753 601000 23                 TNZ     s:18270

  18251 23 003741   100006 633500                    EPPR3   6,,PR1
        23 003742   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 003743   100005 634500                    EPPR4   5,,PR1
        23 003744   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 003745   000043 236000 24                 LDQ     35
        23 003746   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 003747   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 003750   000006 631400 24                 EPPR1   6
        23 003751   000000 701000 xent               TSX1    Z8AE$ERROR
        23 003752   000000 011000                    NOP     0

      683    18269    4                END;

      684    18270    3            ST$$ = ST$$ -> ETT.LOP;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:155  
  18270 23 003753   200024 470500                    LDP0    @ST$$,,AUTO
        23 003754   000000 471500                    LDP1    0,,PR0
        23 003755   100001 236100                    LDQ     1,,PR1
        23 003756   000000 756100                    STQ     0,,PR0

      685    18271    3            RETURN;

  18271 23 003757   200022 221300                    LDX1  ! @ST$$+1,,AUTO
        23 003760   000001 702211                    TSX2  ! 1,X1

      686    18272    3          END;
      687    18273
      688    18274    2        CALL Z8CO$QUALIFY_VARIABLE (ITEM$, ST$$);

  18274 23 003761   200023 630500                    EPPR0   @ITEM$,,AUTO
        23 003762   000011 631400 24                 EPPR1   9
        23 003763   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 003764   000000 011000                    NOP     0

      689    18275
      690    18276             %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      691    18277                                @ETT$    = ST$$,
      692    18278                                @LINE    = ITEM$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
      693    18279                                @COLUMN  = ITEM$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
      694    18280                                @TYPE    = ST$$ -> ST.TYPE);

  18282 23 003765   000004 220003                    LDX0    4,DU
        23 003766   200026 740100                    STX0    ETT_ITEM,,AUTO

  18283 23 003767   000000 221003                    LDX1    0,DU
        23 003770   200026 441100                    SXL1    ETT_ITEM,,AUTO

  18284 23 003771   200024 470500                    LDP0    @ST$$,,AUTO
        23 003772   000000 471500                    LDP1    0,,PR0
        23 003773   100002 236100                    LDQ     2,,PR1
        23 003774   000022 772000                    QRL     18
        23 003775   200032 756100                    STQ     DEP_SIZE$+1,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:156  

  18285 23 003776   000000 236000 24                 LDQ     0
        23 003777   200035 756100                    STQ     @LEN+1,,AUTO

  18286 23 004000   000000 236100                    LDQ     0,,PR0
        23 004001   200027 756100                    STQ     ETT_ITEM+1,,AUTO

  18287 23 004002   000000 236000 24                 LDQ     0
        23 004003   200030 756100                    STQ     INT_2+1,,AUTO

  18289 23 004004   200023 471500                    LDP1    @ITEM$,,AUTO
        23 004005   100000 473500                    LDP3    0,,PR1
        23 004006   300004 474500                    LDP4    4,,PR3
        23 004007   400005 235100                    LDA     5,,PR4
        23 004010   200033 755100                    STA     DEP_SIZE$+2,,AUTO

  18290 23 004011   100000 473500                    LDP3    0,,PR1
        23 004012   300004 474500                    LDP4    4,,PR3
        23 004013   400006 235100                    LDA     6,,PR4
        23 004014   200034 755100                    STA     @ST$$+1,,AUTO

      695    18302
      696    18303    2        IF NOT ST$$ -> SCALAR.B.ELEMENTARY THEN

  18303 23 004015   000000 473500                    LDP3    0,,PR0
        23 004016   300003 236100                    LDQ     3,,PR3
        23 004017   010000 316003                    CANQ    4096,DU
        23 004020   004051 601000 23                 TNZ     s:18343

      697    18304    3          DO;

      698    18305                 /* Must be elementary */
      699    18306                 %CONDITIONAL_ERROR (@LX_ITEM$ = ITEM$,
      700    18307                                     @ERROR#   = %E$MUST_BE_ELEMENTARY,
      701    18308                                     @LINE     = "ADDR(ETT_ITEM) -> LX_ITEM.LINE",
      702    18309                                     @COLUMN   = "ADDR(ETT_ITEM) -> LX_ITEM.COLUMN");

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:157  
  18319 23 004021   100000 474500                    LDP4    0,,PR1
        23 004022   400000 236100                    LDQ     0,,PR4
        23 004023   400000 316007                    CANQ    -131072,DL
        23 004024   004043 601000 23                 TNZ     s:18339

  18321 23 004025   200034 635500                    EPPR5   @ST$$+1,,AUTO
        23 004026   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 004027   200033 633500                    EPPR3   DEP_SIZE$+2,,AUTO
        23 004030   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 004031   000045 236000 24                 LDQ     37
        23 004032   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004033   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 004034   000006 631400 24                 EPPR1   6
        23 004035   000000 701000 xent               TSX1    Z8AE$ERROR
        23 004036   000000 011000                    NOP     0

  18330 23 004037   200023 470500                    LDP0    @ITEM$,,AUTO
        23 004040   000000 471500                    LDP1    0,,PR0
        23 004041   400000 236007                    LDQ     -131072,DL
        23 004042   100000 256100                    ORSQ    0,,PR1

      703    18339    3            ST$$ = COMCOM.VALUE_1 -> ETT.LOP;

  18339 23 004043   000125 470400 xsym               LDP0    COMCOM+85
        23 004044   000001 236100                    LDQ     1,,PR0
        23 004045   200024 471500                    LDP1    @ST$$,,AUTO
        23 004046   100000 756100                    STQ     0,,PR1

      704    18340    3            RETURN;

  18340 23 004047   200022 221300                    LDX1  ! @ST$$+1,,AUTO
        23 004050   000001 702211                    TSX2  ! 1,X1

      705    18341    3          END;
      706    18342
      707    18343    2        CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:158  
  18343 23 004051   200026 634500                    EPPR4   ETT_ITEM,,AUTO
        23 004052   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 004053   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 004054   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 004055   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 004056   000001 631400 24                 EPPR1   1
        23 004057   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        23 004060   004062 702000 23                 TSX2    s:18346
        23 004061   004070 710000 23                 TRA     s:18350

      708    18344    2          WHENALTRETURN
      709    18345    3            DO;

      710    18346    3              ST$$ = COMCOM.VALUE_1 -> ETT.LOP;

  18346 23 004062   000125 470400 xsym               LDP0    COMCOM+85
        23 004063   000001 236100                    LDQ     1,,PR0
        23 004064   200024 471500                    LDP1    @ST$$,,AUTO
        23 004065   100000 756100                    STQ     0,,PR1

      711    18347    3              RETURN;

  18347 23 004066   200022 221300                    LDX1  ! @ST$$+1,,AUTO
        23 004067   000001 702211                    TSX2  ! 1,X1

      712    18348    3            END;
      713    18349
      714    18350    2        CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))

  18350 23 004070   200026 630500                    EPPR0   ETT_ITEM,,AUTO
        23 004071   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 004072   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 004073   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 004074   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 004075   000001 631400 24                 EPPR1   1
        23 004076   000000 701000 xent               TSX1    Z8CO$UNSIGNED_CHECK
        23 004077   004101 702000 23                 TSX2    s:18353
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:159  
        23 004100   004107 710000 23                 TRA     s:18357

      715    18351    2          WHENALTRETURN
      716    18352    3            DO;

      717    18353    3              ST$$ = COMCOM.VALUE_1 -> ETT.LOP;

  18353 23 004101   000125 470400 xsym               LDP0    COMCOM+85
        23 004102   000001 236100                    LDQ     1,,PR0
        23 004103   200024 471500                    LDP1    @ST$$,,AUTO
        23 004104   100000 756100                    STQ     0,,PR1

      718    18354    3              RETURN;

  18354 23 004105   200022 221300                    LDX1  ! @ST$$+1,,AUTO
        23 004106   000001 702211                    TSX2  ! 1,X1

      719    18355    3            END;
      720    18356
      721    18357    2   END VERIFY_LINAGE_ITEM;

  18357 23 004107   200022 221300                    LDX1  ! @ST$$+1,,AUTO
        23 004110   000001 702211                    TSX2  ! 1,X1

      722    18358        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:160  
      723    18359    1   RECORD_CLAUSE: PROC (LTS$$);

  18359 23 004111   200010 741300       RECORD_CLAU* STX1  ! @LTS$$+1,,AUTO

      724    18360
      725    18361    2   DCL LTS$$         PTR;
      726    18362    2   DCL INT1          SBIN;
      727    18363    2   DCL INT2          SBIN;
      728    18364    2   DCL FORMAT        SBIN;
      729    18365
      730    18366
      731    18367    2   IF LTS$$ -> FILE_LTS.B.RECORD_CONTAINS     THEN

  18367 23 004112   200011 470500                    LDP0    @LTS$$,,AUTO
        23 004113   000000 471500                    LDP1    0,,PR0
        23 004114   100017 236100                    LDQ     15,,PR1
        23 004115   400000 316007                    CANQ    -131072,DL
        23 004116   004140 600000 23                 TZE     s:18378

      732    18368    3     DO;

      733    18369    3       IF LTS$$ -> FILE_LTS.B.RECORD_FORMAT_2     THEN

  18369 23 004117   010000 316007                    CANQ    4096,DL
        23 004120   004130 600000 23                 TZE     s:18372

      734    18370    3         CALL RECORD_FORMAT_2( LTS$$, FORMAT );

  18370 23 004121   200014 633500                    EPPR3   FORMAT,,AUTO
        23 004122   200020 453500                    STP3    ST$$,,AUTO
        23 004123   200011 236100                    LDQ     @LTS$$,,AUTO
        23 004124   200017 756100                    STQ     COLUMN,,AUTO
        23 004125   004732 701000 23                 TSX1    RECORD_FORMAT_2
        23 004126   000000 011000                    NOP     0
        23 004127   004141 710000 23                 TRA     s:18380

      735    18371    3       ELSE
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:161  
      736    18372    3         IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 0    THEN

  18372 23 004130   100023 235100                    LDA     19,,PR1
        23 004131   004135 601000 23                 TNZ     s:18375

      737    18373    3           FORMAT = %FORMAT_1;

  18373 23 004132   000001 235007                    LDA     1,DL
        23 004133   200014 755100                    STA     FORMAT,,AUTO
        23 004134   004141 710000 23                 TRA     s:18380

      738    18374    3         ELSE
      739    18375    3           FORMAT = %FORMAT_3;

  18375 23 004135   000003 235007                    LDA     3,DL
        23 004136   200014 755100                    STA     FORMAT,,AUTO

      740    18376    3      END;

  18376 23 004137   004141 710000 23                 TRA     s:18380

      741    18377    2   ELSE
      742    18378    2     FORMAT = %FORMAT_0;

  18378 23 004140   200014 450100                    STZ     FORMAT,,AUTO

      743    18379
      744    18380    2   CALL CALC_MAX_BYTES( LTS$$, INT1, INT2, FORMAT );

  18380 23 004141   200014 630500                    EPPR0   FORMAT,,AUTO
        23 004142   200022 450500                    STP0    @ST$$+1,,AUTO
        23 004143   200013 631500                    EPPR1   INT2,,AUTO
        23 004144   200021 451500                    STP1    @KEY$+1,,AUTO
        23 004145   200012 633500                    EPPR3   INT1,,AUTO
        23 004146   200020 453500                    STP3    ST$$,,AUTO
        23 004147   200011 236100                    LDQ     @LTS$$,,AUTO
        23 004150   200017 756100                    STQ     COLUMN,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:162  
        23 004151   004502 701000 23                 TSX1    CALC_MAX_BYTES
        23 004152   000000 011000                    NOP     0

      745    18381
      746    18382    2   IF FORMAT = %FORMAT_2  THEN

  18382 23 004153   200014 235100                    LDA     FORMAT,,AUTO
        23 004154   000002 115007                    CMPA    2,DL
        23 004155   004166 601000 23                 TNZ     s:18387

      747    18383    2     LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = MINIMUM( INT1, LTS$$ ->

  18383 23 004156   200011 470500                    LDP0    @LTS$$,,AUTO
        23 004157   000000 471500                    LDP1    0,,PR0
        23 004160   100023 236100                    LDQ     19,,PR1
        23 004161   200012 116100                    CMPQ    INT1,,AUTO
        23 004162   004164 604400 23                 TMOZ    s:18383+6
        23 004163   200012 236100                    LDQ     INT1,,AUTO
        23 004164   100023 756100                    STQ     19,,PR1
        23 004165   004216 710000 23                 TRA     s:18400

      748    18384    2                              FILE_LTS.RECORD_CONTAINS.INT_1);
      749    18385    2   ELSE
      750    18386    3     DO;

      751    18387    3       LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2 = INT2;

  18387 23 004166   200011 470500                    LDP0    @LTS$$,,AUTO
        23 004167   000000 471500                    LDP1    0,,PR0
        23 004170   200013 236100                    LDQ     INT2,,AUTO
        23 004171   100024 756100                    STQ     20,,PR1

      752    18388    3       IF FORMAT = %FORMAT_0 AND LTS$$ -> FILE_LTS.B.RECORD_FORMAT_2  THEN

  18388 23 004172   000000 115003                    CMPA    0,DU
        23 004173   004213 601000 23                 TNZ     s:18397
        23 004174   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:163  
        23 004175   100017 236100                    LDQ     15,,PR1
        23 004176   010000 316007                    CANQ    4096,DL
        23 004177   004213 600000 23                 TZE     s:18397

      753    18389    4         DO;

      754    18390    4           IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 0     THEN

  18390 23 004200   100023 235100                    LDA     19,,PR1
        23 004201   004205 601000 23                 TNZ     s:18393

      755    18391    4             LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = 1;

  18391 23 004202   000001 235007                    LDA     1,DL
        23 004203   100023 755100                    STA     19,,PR1
        23 004204   004216 710000 23                 TRA     s:18400

      756    18392    4           ELSE
      757    18393    4             LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = MINIMUM( INT1, LTS$$

  18393 23 004205   100023 236100                    LDQ     19,,PR1
        23 004206   200012 116100                    CMPQ    INT1,,AUTO
        23 004207   004211 604400 23                 TMOZ    s:18393+4
        23 004210   200012 236100                    LDQ     INT1,,AUTO
        23 004211   100023 756100                    STQ     19,,PR1

      758    18394    4                   -> FILE_LTS.RECORD_CONTAINS.INT_1 );
      759    18395    4         END;

  18395 23 004212   004216 710000 23                 TRA     s:18400

      760    18396    3       ELSE
      761    18397    3         LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 = INT1;

  18397 23 004213   000000 471500                    LDP1    0,,PR0
        23 004214   200012 236100                    LDQ     INT1,,AUTO
        23 004215   100023 756100                    STQ     19,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:164  

      762    18398    3     END;

      763    18399
      764    18400    2   IF LTS$$ -> FILE_LTS.B.FLR AND

  18400 23 004216   000000 471500                    LDP1    0,,PR0
        23 004217   100017 236100                    LDQ     15,,PR1
        23 004220   020000 316003                    CANQ    8192,DU
        23 004221   004243 600000 23                 TZE     s:18410
        23 004222   100023 236100                    LDQ     19,,PR1
        23 004223   100024 116100                    CMPQ    20,,PR1
        23 004224   004243 605000 23                 TPL     s:18410

      765    18401    2       LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1 < LTS$$ -> FILE_LTS.RECORD_CONTAINS.
             18401                INT_2 THEN
      766    18402            /* INT_1 and INT_2 are the lower and upper bounds from the
      767    18403               RECORD CONTAINS or RECORD VARYING clause, or if neither of
      768    18404               these clauses is present then the lengths of the shortest
      769    18405               and longest records defined in the FD or SD. */
      770    18406    2     CALL Z8AE$ERROR (%E$FLR_ILLEGAL,

  18406 23 004225   100001 473500                    LDP3    1,,PR1
        23 004226   300002 236100                    LDQ     2,,PR3
        23 004227   777777 376007                    ANQ     -1,DL
        23 004230   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004231   000050 236000 24                 LDQ     40
        23 004232   200054 756100                    STQ     SON_FD$$+6,,AUTO
        23 004233   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 004234   200053 451500                    STP1    SON_FD$$+5,,AUTO
        23 004235   000051 236000 24                 LDQ     41
        23 004236   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 004237   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 004240   000006 631400 24                 EPPR1   6
        23 004241   000000 701000 xent               TSX1    Z8AE$ERROR
        23 004242   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:165  
      771    18407    2                      BINBIT(LTS$$ -> FILE_LTS.ST$ -> ST.LINE_NO,36),
      772    18408    2                      0);
      773    18409
      774    18410    2   CALL Z9DI$BLK_CONTAINS (LTS$$, LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2);

  18410 23 004243   200011 470500                    LDP0    @LTS$$,,AUTO
        23 004244   000000 471500                    LDP1    0,,PR0
        23 004245   100024 633500                    EPPR3   20,,PR1
        23 004246   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 004247   200011 236100                    LDQ     @LTS$$,,AUTO
        23 004250   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004251   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 004252   000011 631400 24                 EPPR1   9
        23 004253   000000 701000 xent               TSX1    Z9DI$BLK_CONTAINS
        23 004254   000000 011000                    NOP     0

      775    18411
      776    18412    2   END RECORD_CLAUSE;

  18412 23 004255   200010 221300                    LDX1  ! @LTS$$+1,,AUTO
        23 004256   000001 702211                    TSX2  ! 1,X1

      777    18413        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:166  
      778    18414    1   ASSIGN_ADSC_DESC: PROC (ST$$, LENGTH);

  18414 23 004257   200004 741300       ASSIGN_ADSC* STX1  ! LTS$$+1,,AUTO

      779    18415
      780    18416    2        DCL ST$$          PTR;
      781    18417    2        DCL LENGTH        SBIN;
      782    18418
      783    18419    2        DCL LONG$$        PTR;
      784    18420    2        DCL 1 DESC        ALIGNED,
      785    18421                   %DESCRIPTOR (LVL = 2, ENDING = YES);
      786    18449
      787    18450
      788    18451    2        ST$$ -> ST.TYPE = %TYA;

  18451 23 004260   200005 470500                    LDP0    @ST$$,,AUTO
        23 004261   000000 471500                    LDP1    0,,PR0
        23 004262   000010 220003                    LDX0    8,DU
        23 004263   100002 740100                    STX0    2,,PR1

      789    18452
      790    18453    2        IF LENGTH > 4095 THEN

  18453 23 004264   200006 471500                    LDP1    @LENGTH,,AUTO
        23 004265   100000 235100                    LDA     0,,PR1
        23 004266   007777 115007                    CMPA    4095,DL
        23 004267   004362 604400 23                 TMOZ    s:18586

      791    18454    3          DO;

      792    18455    3            ST$$ -> SCALAR.B.LENGTH_4096 = TRUE;

  18455 23 004270   000000 473500                    LDP3    0,,PR0
        23 004271   004000 236003                    LDQ     2048,DU
        23 004272   300003 256100                    ORSQ    3,,PR3

      793    18456
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:167  
      794    18457    3            IF LENGTH >= %#256K THEN

  18457 23 004273   100000 235100                    LDA     0,,PR1
        23 004274   000001 115003                    CMPA    1,DU
        23 004275   004301 604000 23                 TMI     s:18540

      795    18458    3              ST$$ -> SCALAR.B.GREATER_256K = TRUE;

  18458 23 004276   000000 473500                    LDP3    0,,PR0
        23 004277   020000 236003                    LDQ     8192,DU
        23 004300   300003 256100                    ORSQ    3,,PR3

      796    18459
      797    18460                 %NEW_LONG (@POINTER = LONG$$,
      798    18461                            @LENGTH  = LENGTH);

  18540 23 004301   000002 236000 6                  LDQ     LTS_+2
        23 004302   000002 036007                    ADLQ    2,DL
        23 004303   000003 116000 6                  CMPQ    LTS_+3
        23 004304   004315 604000 23                 TMI     s:18542

  18541 23 004305   000052 236000 24                 LDQ     42
        23 004306   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004307   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 004310   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 004311   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 004312   000001 631400 24                 EPPR1   1
        23 004313   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 004314   000000 011000                    NOP     0

  18542 23 004315   000002 236000 6                  LDQ     LTS_+2
        23 004316   000022 736000                    QLS     18
        23 004317   000001 036000 6                  ADLQ    LTS_+1
        23 004320   200007 756100                    STQ     LONG$$,,AUTO

  18543 23 004321   000002 236007                    LDQ     2,DL
        23 004322   000002 056000 6                  ASQ     LTS_+2
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:168  

  18544 23 004323   001110 220003                    LDX0    584,DU
        23 004324   200007 470500                    LDP0    LONG$$,,AUTO
        23 004325   000000 740100                    STX0    0,,PR0

  18550 23 004326   200006 470500                    LDP0    @LENGTH,,AUTO
        23 004327   000000 235100                    LDA     0,,PR0
        23 004330   200007 471500                    LDP1    LONG$$,,AUTO
        23 004331   100001 755100                    STA     1,,PR1

      799    18553
      800    18554    3            CALL Z8DO$LINK_WITH_LTS (ST$$ -> SCALAR.LTS$, LONG$$);

  18554 23 004332   200005 471500                    LDP1    @ST$$,,AUTO
        23 004333   100000 473500                    LDP3    0,,PR1
        23 004334   200007 634500                    EPPR4   LONG$$,,AUTO
        23 004335   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 004336   300005 635500                    EPPR5   5,,PR3
        23 004337   200050 455500                    STP5    SON_FD$$+2,,AUTO
        23 004340   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 004341   000011 631400 24                 EPPR1   9
        23 004342   000000 701000 xent               TSX1    Z8DO$LINK_WITH_LTS
        23 004343   000000 011000                    NOP     0

      801    18555
      802    18556                 %PACK_ADSC (@DESC = DESC, @LENGTH = LENGTH);

  18560 23 004344   000000 220003                    LDX0    0,DU
        23 004345   200010 740100                    STX0    DESC,,AUTO

  18562 23 004346   000053 236000 24                 LDQ     43
        23 004347   200010 356100                    ANSQ    DESC,,AUTO

  18563 23 004350   000054 236000 24                 LDQ     44
        23 004351   200010 356100                    ANSQ    DESC,,AUTO

  18575 23 004352   000055 236000 24                 LDQ     45
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:169  
        23 004353   200010 356100                    ANSQ    DESC,,AUTO

  18576 23 004354   000056 236000 24                 LDQ     46
        23 004355   200010 356100                    ANSQ    DESC,,AUTO

  18577 23 004356   200006 470500                    LDP0    @LENGTH,,AUTO
        23 004357   000000 236100                    LDQ     0,,PR0
        23 004360   200010 752103                    STCQ    DESC,'03'O,AUTO

      803    18580    3          END;

  18580 23 004361   004376 710000 23                 TRA     s:18607

      804    18581    2        ELSE
      805    18582               %PACK_ADSC (@DESC = DESC, @LENGTH = LENGTH);

  18586 23 004362   000000 221003                    LDX1    0,DU
        23 004363   200010 741100                    STX1    DESC,,AUTO

  18588 23 004364   000053 236000 24                 LDQ     43
        23 004365   200010 356100                    ANSQ    DESC,,AUTO

  18589 23 004366   000054 236000 24                 LDQ     44
        23 004367   200010 356100                    ANSQ    DESC,,AUTO

  18601 23 004370   000055 236000 24                 LDQ     45
        23 004371   200010 356100                    ANSQ    DESC,,AUTO

  18602 23 004372   000056 236000 24                 LDQ     46
        23 004373   200010 356100                    ANSQ    DESC,,AUTO

  18603 23 004374   100000 236100                    LDQ     0,,PR1
        23 004375   200010 752103                    STCQ    DESC,'03'O,AUTO

      806    18606
      807    18607    2        ST$$ -> ST.DESCL = DESC.DESCL;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:170  
  18607 23 004376   200005 470500                    LDP0    @ST$$,,AUTO
        23 004377   000000 471500                    LDP1    0,,PR0
        23 004400   200010 720100                    LXL0    DESC,,AUTO
        23 004401   100001 440100                    SXL0    1,,PR1

      808    18608
      809    18609    2   END ASSIGN_ADSC_DESC;

  18609 23 004402   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 004403   000001 702211                    TSX2  ! 1,X1

      810    18610        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:171  
      811    18611    1   CALC_BYTES: PROC (ST$$, LEN);

  18611 23 004404   200032 741300       CALC_BYTES   STX1  ! DEP_SIZE$+1,,AUTO

      812    18612
      813    18613    2        DCL ST$$          PTR;
      814    18614    2        DCL LEN        SBIN;
      815    18615
      816    18616    3       DO CASE (ST$$ -> ST.TYPE);

  18616 23 004405   200033 470500                    LDP0    @ST$$,,AUTO
        23 004406   000000 471500                    LDP1    0,,PR0
        23 004407   100002 220100                    LDX0    2,,PR1
        23 004410   000015 100003                    CMPX0   13,DU
        23 004411   004413 602010 23                 TNC     s:18616+6,X0
        23 004412   004474 710000 23                 TRA     s:18638
        23 004413   004455 710000 23                 TRA     s:18632
        23 004414   004474 710000 23                 TRA     s:18638
        23 004415   004474 710000 23                 TRA     s:18638
        23 004416   004474 710000 23                 TRA     s:18638
        23 004417   004474 710000 23                 TRA     s:18638
        23 004420   004474 710000 23                 TRA     s:18638
        23 004421   004430 710000 23                 TRA     s:18621
        23 004422   004474 710000 23                 TRA     s:18638
        23 004423   004430 710000 23                 TRA     s:18621
        23 004424   004474 710000 23                 TRA     s:18638
        23 004425   004474 710000 23                 TRA     s:18638
        23 004426   004474 710000 23                 TRA     s:18638
        23 004427   004430 710000 23                 TRA     s:18621

      817    18617
      818    18618    3         CASE (%TYA, %TYE, %TYB);

      819    18619                %GET_ADSC_LEN (ST$ = ST$$, RTN = LEN);

  18621 23 004430   100003 236100                    LDQ     3,,PR1
        23 004431   004000 316003                    CANQ    2048,DU
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:172  
        23 004432   004450 600000 23                 TZE     s:18627

  18622 23 004433   100005 473500                    LDP3    5,,PR1
        23 004434   300000 222100                    LDX2    0,,PR3
        23 004435   001105 102003                    CMPX2   581,DU
        23 004436   004444 601000 23                 TNZ     s:18625

  18623 23 004437   300003 474500                    LDP4    3,,PR3
        23 004440   400001 235100                    LDA     1,,PR4
        23 004441   200034 475500                    LDP5    @LEN,,AUTO
        23 004442   500000 755100                    STA     0,,PR5
        23 004443   004500 710000 23                 TRA     s:18642

  18625 23 004444   300001 235100                    LDA     1,,PR3
        23 004445   200034 474500                    LDP4    @LEN,,AUTO
        23 004446   400000 755100                    STA     0,,PR4
        23 004447   004500 710000 23                 TRA     s:18642

  18627 23 004450   100001 236100                    LDQ     1,,PR1
        23 004451   007777 376007                    ANQ     4095,DL
        23 004452   200034 473500                    LDP3    @LEN,,AUTO
        23 004453   300000 756100                    STQ     0,,PR3

  18628 23 004454   004500 710000 23                 TRA     s:18642

      820    18630
      821    18631    3         CASE (%TYD);

      822    18632    3           IF ST$$ -> ST.NDSC.TN = %NDSC4 THEN

  18632 23 004455   100001 236100                    LDQ     1,,PR1
        23 004456   040000 316007                    CANQ    16384,DL
        23 004457   004467 600000 23                 TZE     s:18635

      823    18633    3             LEN = (ST$$ -> ST.NDSC.N + 1) / 2;

  18633 23 004460   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:173  
        23 004461   000077 376007                    ANQ     63,DL
        23 004462   000001 036007                    ADLQ    1,DL
        23 004463   000001 772000                    QRL     1
        23 004464   200034 473500                    LDP3    @LEN,,AUTO
        23 004465   300000 756100                    STQ     0,,PR3
        23 004466   004500 710000 23                 TRA     s:18642

      824    18634    3           ELSE
      825    18635    3             LEN = ST$$ -> ST.NDSC.N;

  18635 23 004467   100001 236100                    LDQ     1,,PR1
        23 004470   000077 376007                    ANQ     63,DL
        23 004471   200034 473500                    LDP3    @LEN,,AUTO
        23 004472   300000 756100                    STQ     0,,PR3
        23 004473   004500 710000 23                 TRA     s:18642

      826    18636
      827    18637    3         CASE (ELSE);

      828    18638    3           LEN = ST$$ -> ST.NDSC.N;

  18638 23 004474   100001 236100                    LDQ     1,,PR1
        23 004475   000077 376007                    ANQ     63,DL
        23 004476   200034 473500                    LDP3    @LEN,,AUTO
        23 004477   300000 756100                    STQ     0,,PR3

      829    18639
      830    18640    3       END; /* Case */

      831    18641
      832    18642    2   END CALC_BYTES;

  18642 23 004500   200032 221300                    LDX1  ! DEP_SIZE$+1,,AUTO
        23 004501   000001 702211                    TSX2  ! 1,X1

      833    18643        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:174  
      834    18644    1   CALC_MAX_BYTES: PROC (LTS$$, MIN, MAX, FORMAT);

  18644 23 004502   200016 741300       CALC_MAX_BY* STX1  ! LINE,,AUTO

      835    18645
      836    18646    2        DCL LTS$$         PTR;
      837    18647    2        DCL LEN           SBIN;
      838    18648    2        DCL MAX           SBIN;
      839    18649    2        DCL MIN           SBIN;
      840    18650    2        DCL ST$$          PTR;
      841    18651    2        DCL QLT$$         PTR;
      842    18652    2        DCL INT_1         SBIN;
      843    18653    2        DCL INT_2         SBIN;
      844    18654    2        DCL FORMAT        SBIN;
      845    18655    2        DCL OCCURS_MIN    SBIN;
      846    18656    2        DCL DEP_SIZE$     PTR;
      847    18657
      848    18658
      849    18659    2        QLT$$ = LTS$$ -> FILE_LTS.ST$ -> SCALAR.QLT$ -> QLT.SON

  18659 23 004503   200017 470500                    LDP0    @LTS$$,,AUTO
        23 004504   000000 471500                    LDP1    0,,PR0
        23 004505   100001 473500                    LDP3    1,,PR1
        23 004506   300007 474500                    LDP4    7,,PR3
        23 004507   400003 475500                    LDP5    3,,PR4
        23 004510   500004 476500                    LDP6    4,,PR5
        23 004511   600007 477500                    LDP7    7,,PR6
        23 004512   700002 236100                    LDQ     2,,PR7
        23 004513   200025 756100                    STQ     QLT$$,,AUTO

      850    18660    2                     -> QLT.ST$ -> SCALAR.QLT$ -> QLT.BROTHER;
      851    18661
      852    18662    2        INT_1 = LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_1;

  18662 23 004514   100023 235100                    LDA     19,,PR1
        23 004515   200026 755100                    STA     INT_1,,AUTO

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:175  
      853    18663    2        INT_2 = LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2;

  18663 23 004516   100024 235100                    LDA     20,,PR1
        23 004517   200027 755100                    STA     INT_2,,AUTO

      854    18664    2        MAX  = 0;

  18664 23 004520   200021 470500                    LDP0    @MAX,,AUTO
        23 004521   000000 450100                    STZ     0,,PR0

      855    18665    2        MIN = 9999999;

  18665 23 004522   000057 235000 24                 LDA     47
        23 004523   200020 471500                    LDP1    @MIN,,AUTO
        23 004524   100000 755100                    STA     0,,PR1

      856    18666
      857    18667    3        DO WHILE (QLT$$ ~= ADDR(NIL));

  18667 23 004525   004726 710000 23                 TRA     s:18759

      858    18668    3          ST$$ = QLT$$ -> QLT.ST$;

  18668 23 004526   200025 470500                    LDP0    QLT$$,,AUTO
        23 004527   000004 236100                    LDQ     4,,PR0
        23 004530   200024 756100                    STQ     ST$$,,AUTO

      859    18669
      860    18670    3          CALL CALC_BYTES (ST$$, LEN);

  18670 23 004531   200023 631500                    EPPR1   LEN,,AUTO
        23 004532   200034 451500                    STP1    @LEN,,AUTO
        23 004533   200024 633500                    EPPR3   ST$$,,AUTO
        23 004534   200033 453500                    STP3    @ST$$,,AUTO
        23 004535   004404 701000 23                 TSX1    CALC_BYTES
        23 004536   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:176  
      861    18671
      862    18672    3          IF LEN > MAX THEN

  18672 23 004537   200021 470500                    LDP0    @MAX,,AUTO
        23 004540   200023 236100                    LDQ     LEN,,AUTO
        23 004541   000000 116100                    CMPQ    0,,PR0
        23 004542   004544 604400 23                 TMOZ    s:18675

      863    18673    3            MAX = LEN;

  18673 23 004543   000000 756100                    STQ     0,,PR0

      864    18674
      865    18675    3          IF LEN < MIN  THEN

  18675 23 004544   200020 471500                    LDP1    @MIN,,AUTO
        23 004545   200023 236100                    LDQ     LEN,,AUTO
        23 004546   100000 116100                    CMPQ    0,,PR1
        23 004547   004551 605000 23                 TPL     s:18678

      866    18676    3            MIN = LEN;

  18676 23 004550   100000 756100                    STQ     0,,PR1

      867    18677
      868    18678    3          IF ST$$ -> SCALAR.B.OCCURS_DEPENDING      THEN

  18678 23 004551   200024 473500                    LDP3    ST$$,,AUTO
        23 004552   300003 236100                    LDQ     3,,PR3
        23 004553   000200 316003                    CANQ    128,DU
        23 004554   004617 600000 23                 TZE     s:18734

      869    18679    4            DO;

      870    18680                   %GET_LTS( @ID = %DEPENDING_SIZE,
      871    18681                             @ST$ = ST$$,
      872    18682                             @RETURN$ = DEP_SIZE$ );
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:177  

  18684 23 004555   300005 236100                    LDQ     5,,PR3
        23 004556   000000 116000 24                 CMPQ    0
        23 004557   004567 600000 23                 TZE     s:18718
        23 004560   300005 474500                    LDP4    5,,PR3
        23 004561   400000 220100                    LDX0    0,,PR4
        23 004562   001105 100003                    CMPX0   581,DU
        23 004563   004567 601000 23                 TNZ     s:18718

  18696 23 004564   400004 236100                    LDQ     4,,PR4
        23 004565   200031 756100                    STQ     DEP_SIZE$,,AUTO

  18716 23 004566   004601 710000 23                 TRA     s:18725

  18718 23 004567   000000 116000 24                 CMPQ    0
        23 004570   004577 600000 23                 TZE     s:18722
        23 004571   300005 474500                    LDP4    5,,PR3
        23 004572   400000 220100                    LDX0    0,,PR4
        23 004573   001120 100003                    CMPX0   592,DU
        23 004574   004577 601000 23                 TNZ     s:18722

  18720 23 004575   200031 756100                    STQ     DEP_SIZE$,,AUTO
        23 004576   004601 710000 23                 TRA     s:18725

  18722 23 004577   000000 236000 24                 LDQ     0
        23 004600   200031 756100                    STQ     DEP_SIZE$,,AUTO

      873    18725    4              OCCURS_MIN = DEP_SIZE$ -> DEPENDING_SIZE.MIN_SIZE + DEP_SIZE$ ->

  18725 23 004601   200031 474500                    LDP4    DEP_SIZE$,,AUTO
        23 004602   400002 475500                    LDP5    2,,PR4
        23 004603   500002 236100                    LDQ     2,,PR5
        23 004604   500004 402100                    MPY     4,,PR5
        23 004605   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004606   400000 236100                    LDQ     0,,PR4
        23 004607   777777 376007                    ANQ     -1,DL
        23 004610   200051 756100                    STQ     SON_FD$$+3,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:178  
        23 004611   200050 236100                    LDQ     SON_FD$$+2,,AUTO
        23 004612   200051 036100                    ADLQ    SON_FD$$+3,,AUTO
        23 004613   200030 756100                    STQ     OCCURS_MIN,,AUTO

      874    18726    4                 DEPENDING_SIZE.DIMS$ -> DIMS.OD.INT1 * DEP_SIZE$ -> DEPENDING_SIZE.
             18726                          DIMS$
      875    18727    4                    -> DIMS.OD.TOTAL_SPAN;
      876    18728
      877    18729    4               IF OCCURS_MIN < MIN   THEN

  18729 23 004614   100000 116100                    CMPQ    0,,PR1
        23 004615   004617 605000 23                 TPL     s:18734

      878    18730    4                 MIN = OCCURS_MIN;

  18730 23 004616   100000 756100                    STQ     0,,PR1

      879    18731
      880    18732    4             END;

      881    18733
      882    18734    3          IF FORMAT ~= %FORMAT_0    THEN

  18734 23 004617   200022 473500                    LDP3    @FORMAT,,AUTO
        23 004620   300000 235100                    LDA     0,,PR3
        23 004621   004712 600000 23                 TZE     s:18754

      883    18735    4            DO;

      884    18736
      885    18737    4              IF LEN > INT_2            THEN

  18737 23 004622   200023 236100                    LDQ     LEN,,AUTO
        23 004623   200027 116100                    CMPQ    INT_2,,AUTO
        23 004624   004643 604400 23                 TMOZ    s:18741

      886    18738    4                CALL Z8AE$ERROR( %E$RECORD_DEFN_GTR_REC_CLAUSE,
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:179  

  18738 23 004625   200024 474500                    LDP4    ST$$,,AUTO
        23 004626   400002 236100                    LDQ     2,,PR4
        23 004627   777777 376007                    ANQ     -1,DL
        23 004630   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004631   000050 236000 24                 LDQ     40
        23 004632   200054 756100                    STQ     SON_FD$$+6,,AUTO
        23 004633   200050 635500                    EPPR5   SON_FD$$+2,,AUTO
        23 004634   200053 455500                    STP5    SON_FD$$+5,,AUTO
        23 004635   000061 236000 24                 LDQ     49
        23 004636   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 004637   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 004640   000006 631400 24                 EPPR1   6
        23 004641   000000 701000 xent               TSX1    Z8AE$ERROR
        23 004642   000000 011000                    NOP     0

      887    18739    4                                 BINBIT( ST$$ -> ST.LINE_NO, 36), 0 );
      888    18740
      889    18741    4              IF FORMAT = %FORMAT_1     THEN

  18741 23 004643   200022 470500                    LDP0    @FORMAT,,AUTO
        23 004644   000000 235100                    LDA     0,,PR0
        23 004645   000001 115007                    CMPA    1,DL
        23 004646   004671 601000 23                 TNZ     s:18748

      890    18742    5                DO;

      891    18743    5                  IF LEN < INT_2        THEN

  18743 23 004647   200023 236100                    LDQ     LEN,,AUTO
        23 004650   200027 116100                    CMPQ    INT_2,,AUTO
        23 004651   004712 605000 23                 TPL     s:18754

      892    18744    5                    CALL Z8AE$ERROR( %E$RECORD_CONTAINS_WARN,

  18744 23 004652   200024 471500                    LDP1    ST$$,,AUTO
        23 004653   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:180  
        23 004654   777777 376007                    ANQ     -1,DL
        23 004655   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004656   000050 236000 24                 LDQ     40
        23 004657   200054 756100                    STQ     SON_FD$$+6,,AUTO
        23 004660   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 004661   200053 453500                    STP3    SON_FD$$+5,,AUTO
        23 004662   000063 236000 24                 LDQ     51
        23 004663   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 004664   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 004665   000006 631400 24                 EPPR1   6
        23 004666   000000 701000 xent               TSX1    Z8AE$ERROR
        23 004667   000000 011000                    NOP     0

      893    18745    5                                    BINBIT( ST$$ -> ST.LINE_NO,36), 0 );
      894    18746    5                END;

  18746 23 004670   004712 710000 23                 TRA     s:18754

      895    18747    4              ELSE
      896    18748    4                IF LEN < INT_1          THEN

  18748 23 004671   200023 236100                    LDQ     LEN,,AUTO
        23 004672   200026 116100                    CMPQ    INT_1,,AUTO
        23 004673   004712 605000 23                 TPL     s:18754

      897    18749    4                  CALL Z8AE$ERROR( %E$RECORD_DEFN_LSS_REC_CLAUSE,

  18749 23 004674   200024 471500                    LDP1    ST$$,,AUTO
        23 004675   100002 236100                    LDQ     2,,PR1
        23 004676   777777 376007                    ANQ     -1,DL
        23 004677   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 004700   000050 236000 24                 LDQ     40
        23 004701   200054 756100                    STQ     SON_FD$$+6,,AUTO
        23 004702   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 004703   200053 453500                    STP3    SON_FD$$+5,,AUTO
        23 004704   000065 236000 24                 LDQ     53
        23 004705   200052 756100                    STQ     SON_FD$$+4,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:181  
        23 004706   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 004707   000006 631400 24                 EPPR1   6
        23 004710   000000 701000 xent               TSX1    Z8AE$ERROR
        23 004711   000000 011000                    NOP     0

      898    18750    4                                   BINBIT( ST$$ -> ST.LINE_NO,36), 0 );
      899    18751
      900    18752    4            END;

      901    18753
      902    18754    3          IF QLT$$ -> QLT.BROTHER ~= ADDR(NIL)

  18754 23 004712   200025 470500                    LDP0    QLT$$,,AUTO
        23 004713   000002 236100                    LDQ     2,,PR0
        23 004714   000000 116000 24                 CMPQ    0
        23 004715   004730 600000 23                 TZE     s:18761
        23 004716   000002 471500                    LDP1    2,,PR0
        23 004717   100004 473500                    LDP3    4,,PR1
        23 004720   300003 236100                    LDQ     3,,PR3
        23 004721   000040 316003                    CANQ    32,DU
        23 004722   004730 600000 23                 TZE     s:18761

      903    18755    3          AND QLT$$ -> QLT.BROTHER -> QLT.ST$ -> SCALAR.B.RECORD_AREA THEN
      904    18756    3            QLT$$ = QLT$$ -> QLT.BROTHER;

  18756 23 004723   000002 236100                    LDQ     2,,PR0
        23 004724   200025 756100                    STQ     QLT$$,,AUTO
        23 004725   004726 710000 23                 TRA     s:18759

      905    18757    3          ELSE
      906    18758    3            EXIT;
      907    18759    3        END;

  18759 23 004726   000000 116000 24                 CMPQ    0
        23 004727   004526 601000 23                 TNZ     s:18668

      908    18760
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:182  
      909    18761    2   END CALC_MAX_BYTES;

  18761 23 004730   200016 221300                    LDX1  ! LINE,,AUTO
        23 004731   000001 702211                    TSX2  ! 1,X1

      910    18762        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:183  
      911    18763    1   RECORD_FORMAT_2: PROC (LTS$$, FORMAT);

  18763 23 004732   200016 741300       RECORD_FORM* STX1  ! LINE,,AUTO

      912    18764
      913    18765    2        DCL LTS$$         PTR;
      914    18766    2        DCL ST$$          PTR;
      915    18767    2        DCL DEPEND$       PTR;
      916    18768    2        DCL LINE          SBIN;
      917    18769    2        DCL COLUMN        SBIN;
      918    18770    2        DCL FORMAT        SBIN;
      919    18771             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
      920    18775
      921    18776    2        IF LTS$$ -> FILE_LTS.RECORD_CONTAINS.INT_2 = 0 THEN

  18776 23 004733   200017 470500                    LDP0    @LTS$$,,AUTO
        23 004734   000000 471500                    LDP1    0,,PR0
        23 004735   100024 235100                    LDA     20,,PR1
        23 004736   004742 601000 23                 TNZ     s:18779

      922    18777    2          FORMAT = %FORMAT_0;

  18777 23 004737   200020 473500                    LDP3    @FORMAT,,AUTO
        23 004740   300000 450100                    STZ     0,,PR3
        23 004741   004745 710000 23                 TRA     s:18781

      923    18778    2        ELSE
      924    18779    2          FORMAT = %FORMAT_2;

  18779 23 004742   000002 236007                    LDQ     2,DL
        23 004743   200020 473500                    LDP3    @FORMAT,,AUTO
        23 004744   300000 756100                    STQ     0,,PR3

      925    18780
      926    18781    2        DEPEND$ = LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$;

  18781 23 004745   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:184  
        23 004746   100025 236100                    LDQ     21,,PR1
        23 004747   200022 756100                    STQ     DEPEND$,,AUTO

      927    18782
      928    18783    2        IF DEPEND$ ~= ADDR(NIL) THEN

  18783 23 004750   000000 116000 24                 CMPQ    0
        23 004751   005170 600000 23                 TZE     s:18893

      929    18784    3          DO;

      930    18785    3            LINE    = DEPEND$ -> LX_LIST.HEAD$ -> LX_TERMINAL.LINE;

  18785 23 004752   200022 471500                    LDP1    DEPEND$,,AUTO
        23 004753   100004 474500                    LDP4    4,,PR1
        23 004754   400005 235100                    LDA     5,,PR4
        23 004755   200023 755100                    STA     LINE,,AUTO

      931    18786    3            COLUMN  = DEPEND$ -> LX_LIST.HEAD$ -> LX_TERMINAL.COLUMN;

  18786 23 004756   100004 474500                    LDP4    4,,PR1
        23 004757   400006 235100                    LDA     6,,PR4
        23 004760   200024 755100                    STA     COLUMN,,AUTO

      932    18787
      933    18788    3            CALL Z8CO$QUALIFY_VARIABLE (DEPEND$,

  18788 23 004761   200021 634500                    EPPR4   ST$$,,AUTO
        23 004762   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 004763   200022 635500                    EPPR5   DEPEND$,,AUTO
        23 004764   200050 455500                    STP5    SON_FD$$+2,,AUTO
        23 004765   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 004766   000011 631400 24                 EPPR1   9
        23 004767   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 004770   000000 011000                    NOP     0

      934    18789    3                                        ST$$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:185  
      935    18790
      936    18791    3            IF NOT ST$$ -> SCALAR.B.ELEMENTARY THEN

  18791 23 004771   200021 470500                    LDP0    ST$$,,AUTO
        23 004772   000003 236100                    LDQ     3,,PR0
        23 004773   010000 316003                    CANQ    4096,DU
        23 004774   005024 601000 23                 TNZ     s:18831

      937    18792    4              DO;

      938    18793                     %CONDITIONAL_ERROR (@LX_ITEM$ = DEPEND$,
      939    18794                                         @ERROR#   = %E$MUST_BE_ELEMENTARY,
      940    18795                                         @LINE     = LINE,
      941    18796                                         @COLUMN   = COLUMN);

  18806 23 004775   200022 471500                    LDP1    DEPEND$,,AUTO
        23 004776   100000 236100                    LDQ     0,,PR1
        23 004777   400000 316007                    CANQ    -131072,DL
        23 005000   005016 601000 23                 TNZ     s:18826

  18808 23 005001   200024 633500                    EPPR3   COLUMN,,AUTO
        23 005002   200052 453500                    STP3    SON_FD$$+4,,AUTO
        23 005003   200023 634500                    EPPR4   LINE,,AUTO
        23 005004   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 005005   000045 236000 24                 LDQ     37
        23 005006   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005007   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005010   000006 631400 24                 EPPR1   6
        23 005011   000000 701000 xent               TSX1    Z8AE$ERROR
        23 005012   000000 011000                    NOP     0

  18817 23 005013   200022 470500                    LDP0    DEPEND$,,AUTO
        23 005014   400000 236007                    LDQ     -131072,DL
        23 005015   000000 256100                    ORSQ    0,,PR0

      942    18826    4                CALL RECORD_RECOVERY (LTS$$);

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:186  
  18826 23 005016   200017 236100                    LDQ     @LTS$$,,AUTO
        23 005017   200037 756100                    STQ     @ST$$,,AUTO
        23 005020   005210 701000 23                 TSX1    RECORD_RECOVERY
        23 005021   000000 011000                    NOP     0

      943    18827    4                RETURN;

  18827 23 005022   200016 221300                    LDX1  ! LINE,,AUTO
        23 005023   000001 702211                    TSX2  ! 1,X1

      944    18828    4              END;
      945    18829    3            ELSE
      946    18830    4              DO;

      947    18831    4                CALL CHECK_FOR_WORKING_STORAGE (ST$$,

  18831 23 005024   200024 631500                    EPPR1   COLUMN,,AUTO
        23 005025   200042 451500                    STP1    @COLUMN#,,AUTO
        23 005026   200023 633500                    EPPR3   LINE,,AUTO
        23 005027   200041 453500                    STP3    @LINE#,,AUTO
        23 005030   200022 634500                    EPPR4   DEPEND$,,AUTO
        23 005031   200040 454500                    STP4    @ITEM$,,AUTO
        23 005032   200021 635500                    EPPR5   ST$$,,AUTO
        23 005033   200037 455500                    STP5    @ST$$,,AUTO
        23 005034   002703 701000 23                 TSX1    CHECK_FOR_WORKING_STORAGE
        23 005035   005037 702000 23                 TSX2    s:18837
        23 005036   005045 710000 23                 TRA     s:18847

      948    18832    4                                                DEPEND$,
      949    18833    4                                                LINE,
      950    18834    4                                                COLUMN)
      951    18835    4                  WHENALTRETURN
      952    18836    5                    DO;

      953    18837    5                      CALL RECORD_RECOVERY (LTS$$);

  18837 23 005037   200017 236100                    LDQ     @LTS$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:187  
        23 005040   200037 756100                    STQ     @ST$$,,AUTO
        23 005041   005210 701000 23                 TSX1    RECORD_RECOVERY
        23 005042   000000 011000                    NOP     0

      954    18838    5                      RETURN;

  18838 23 005043   200016 221300                    LDX1  ! LINE,,AUTO
        23 005044   000001 702211                    TSX2  ! 1,X1

      955    18839    5                    END;
      956    18840
      957    18841                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
      958    18842                                        @ETT$    = ST$$,
      959    18843                                        @TYPE    = ST$$ -> ST.TYPE,
      960    18844                                        @LINE    = LINE,
      961    18845                                        @COLUMN  = COLUMN);

  18847 23 005045   000004 220003                    LDX0    4,DU
        23 005046   200026 740100                    STX0    ETT_ITEM,,AUTO

  18848 23 005047   000000 221003                    LDX1    0,DU
        23 005050   200026 441100                    SXL1    ETT_ITEM,,AUTO

  18849 23 005051   200021 470500                    LDP0    ST$$,,AUTO
        23 005052   000002 236100                    LDQ     2,,PR0
        23 005053   000022 772000                    QRL     18
        23 005054   200032 756100                    STQ     DEP_SIZE$+1,,AUTO

  18850 23 005055   000000 236000 24                 LDQ     0
        23 005056   200035 756100                    STQ     @LEN+1,,AUTO

  18851 23 005057   200021 236100                    LDQ     ST$$,,AUTO
        23 005060   200027 756100                    STQ     INT_2,,AUTO

  18852 23 005061   000000 236000 24                 LDQ     0
        23 005062   200030 756100                    STQ     OCCURS_MIN,,AUTO

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:188  
  18854 23 005063   200023 235100                    LDA     LINE,,AUTO
        23 005064   200033 755100                    STA     @ST$$,,AUTO

  18855 23 005065   200024 235100                    LDA     COLUMN,,AUTO
        23 005066   200034 755100                    STA     @LEN,,AUTO

      962    18867
      963    18868    4                CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))

  18868 23 005067   200026 631500                    EPPR1   ETT_ITEM,,AUTO
        23 005070   200050 451500                    STP1    SON_FD$$+2,,AUTO
        23 005071   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 005072   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 005073   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 005074   000001 631400 24                 EPPR1   1
        23 005075   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        23 005076   005100 702000 23                 TSX2    s:18871
        23 005077   005106 710000 23                 TRA     s:18875

      964    18869    4                  WHENALTRETURN
      965    18870    5                    DO;

      966    18871    5                      CALL RECORD_RECOVERY (LTS$$);

  18871 23 005100   200017 236100                    LDQ     @LTS$$,,AUTO
        23 005101   200037 756100                    STQ     @ST$$,,AUTO
        23 005102   005210 701000 23                 TSX1    RECORD_RECOVERY
        23 005103   000000 011000                    NOP     0

      967    18872    5                      RETURN;

  18872 23 005104   200016 221300                    LDX1  ! LINE,,AUTO
        23 005105   000001 702211                    TSX2  ! 1,X1

      968    18873    5                    END;
      969    18874
      970    18875    4                CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:189  

  18875 23 005106   200026 630500                    EPPR0   ETT_ITEM,,AUTO
        23 005107   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 005110   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 005111   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 005112   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 005113   000001 631400 24                 EPPR1   1
        23 005114   000000 701000 xent               TSX1    Z8CO$UNSIGNED_CHECK
        23 005115   005117 702000 23                 TSX2    s:18878
        23 005116   005125 710000 23                 TRA     s:18882

      971    18876    4                  WHENALTRETURN
      972    18877    5                    DO;

      973    18878    5                      CALL RECORD_RECOVERY (LTS$$);

  18878 23 005117   200017 236100                    LDQ     @LTS$$,,AUTO
        23 005120   200037 756100                    STQ     @ST$$,,AUTO
        23 005121   005210 701000 23                 TSX1    RECORD_RECOVERY
        23 005122   000000 011000                    NOP     0

      974    18879    5                      RETURN;

  18879 23 005123   200016 221300                    LDX1  ! LINE,,AUTO
        23 005124   000001 702211                    TSX2  ! 1,X1

      975    18880    5                    END;
      976    18881        /*#26938*/
      977    18882    4                CALL Z8AF$NEW_BASE (ADDR(ETT_ITEM)-> LX_ETT_ITEM.ETT$,

  18882 23 005125   000000 236000 24                 LDQ     0
        23 005126   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005127   200027 630500                    EPPR0   INT_2,,AUTO
        23 005130   200053 450500                    STP0    SON_FD$$+5,,AUTO
        23 005131   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 005132   200052 451500                    STP1    SON_FD$$+4,,AUTO
        23 005133   200027 633500                    EPPR3   INT_2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:190  
        23 005134   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 005135   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 005136   000006 631400 24                 EPPR1   6
        23 005137   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 005140   000000 011000                    NOP     0

      978    18883    4                                    ADDR(NIL),
      979    18884    4                                    ADDR(ETT_ITEM)-> LX_ETT_ITEM.ETT$);
      980    18885
      981    18886    4                CALL Z8EV$CONVERT (%TYI, ADDR(ETT_ITEM), ADDR(ETT_ITEM));

  18886 23 005141   200026 630500                    EPPR0   ETT_ITEM,,AUTO
        23 005142   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 005143   200026 631500                    EPPR1   ETT_ITEM,,AUTO
        23 005144   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 005145   200051 633500                    EPPR3   SON_FD$$+3,,AUTO
        23 005146   200054 453500                    STP3    SON_FD$$+6,,AUTO
        23 005147   200050 634500                    EPPR4   SON_FD$$+2,,AUTO
        23 005150   200053 454500                    STP4    SON_FD$$+5,,AUTO
        23 005151   000041 236000 24                 LDQ     33
        23 005152   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 005153   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 005154   000006 631400 24                 EPPR1   6
        23 005155   000000 701000 xent               TSX1    Z8EV$CONVERT
        23 005156   000000 011000                    NOP     0

      982    18887
      983    18888    4                CALL NEW_DEPEND_SIZE (ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$,

  18888 23 005157   200017 470500                    LDP0    @LTS$$,,AUTO
        23 005160   000000 471500                    LDP1    0,,PR0
        23 005161   100001 633500                    EPPR3   1,,PR1
        23 005162   200044 453500                    STP3    @DN$+1,,AUTO
        23 005163   200027 631500                    EPPR1   INT_2,,AUTO
        23 005164   200043 451500                    STP1    FATHER$,,AUTO
        23 005165   005261 701000 23                 TSX1    NEW_DEPEND_SIZE
        23 005166   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:191  

      984    18889    4                                      LTS$$ -> FILE_LTS.ST$);
      985    18890    4              END; /* If elementary */

      986    18891    3          END; /* Depend ~= addr(NIL) */

  18891 23 005167   005172 710000 23                 TRA     s:18895

      987    18892    2        ELSE
      988    18893    2          RETURN;

  18893 23 005170   200016 221300                    LDX1  ! LINE,,AUTO
        23 005171   000001 702211                    TSX2  ! 1,X1

      989    18894
      990    18895    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ ->

  18895 23 005172   200017 470500                    LDP0    @LTS$$,,AUTO
        23 005173   000000 471500                    LDP1    0,,PR0
        23 005174   100025 633500                    EPPR3   21,,PR1
        23 005175   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005176   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005177   000001 631400 24                 EPPR1   1
        23 005200   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005201   000000 011000                    NOP     0

      991    18896    2                                 FILE_LTS.RECORD_CONTAINS.DEPENDING$);
      992    18897
      993    18898    2        LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ = ST$$;

  18898 23 005202   200017 470500                    LDP0    @LTS$$,,AUTO
        23 005203   000000 471500                    LDP1    0,,PR0
        23 005204   200021 236100                    LDQ     ST$$,,AUTO
        23 005205   100025 756100                    STQ     21,,PR1

      994    18899
      995    18900    2   END RECORD_FORMAT_2;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:192  

  18900 23 005206   200016 221300                    LDX1  ! LINE,,AUTO
        23 005207   000001 702211                    TSX2  ! 1,X1

      996    18901        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:193  
      997    18902    1   RECORD_RECOVERY: PROC (LTS$$);

  18902 23 005210   200036 741300       RECORD_RECO* STX1  ! @LEN+2,,AUTO

      998    18903
      999    18904    2        DCL LTS$$         PTR;
     1000    18905    2        DCL ST$$          PTR;
     1001    18906
     1002    18907
     1003    18908    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ST$$);

  18908 23 005211   200040 630500                    EPPR0   ST$$,,AUTO
        23 005212   200051 450500                    STP0    SON_FD$$+3,,AUTO
        23 005213   000024 236000 24                 LDQ     20
        23 005214   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005215   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005216   000011 631400 24                 EPPR1   9
        23 005217   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        23 005220   000000 011000                    NOP     0

     1004    18909
     1005    18910    2        ST$$ -> SCALAR.B.CLASS = %CLASS_NUMERIC;

  18910 23 005221   200040 470500                    LDP0    ST$$,,AUTO
        23 005222   000003 236100                    LDQ     3,,PR0
        23 005223   000025 376000 24                 ANQ     21
        23 005224   000001 276007                    ORQ     1,DL
        23 005225   000003 756100                    STQ     3,,PR0

     1006    18911    2        ST$$ -> SCALAR.TYPE    = %TYI;

  18911 23 005226   000001 220003                    LDX0    1,DU
        23 005227   200040 470500                    LDP0    ST$$,,AUTO
        23 005230   000002 740100                    STX0    2,,PR0

     1007    18912    2        ST$$ -> SCALAR.NDSC.N  = %TYI_LENGTH;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:194  
  18912 23 005231   200040 470500                    LDP0    ST$$,,AUTO
        23 005232   000004 236007                    LDQ     4,DL
        23 005233   000001 752101                    STCQ    1,'01'O,PR0

     1008    18913
     1009    18914    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$);

  18914 23 005234   200037 470500                    LDP0    @LTS$$,,AUTO
        23 005235   000000 471500                    LDP1    0,,PR0
        23 005236   100025 633500                    EPPR3   21,,PR1
        23 005237   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005240   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005241   000001 631400 24                 EPPR1   1
        23 005242   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005243   000000 011000                    NOP     0

     1010    18915
     1011    18916    2        LTS$$ -> FILE_LTS.RECORD_CONTAINS.DEPENDING$ = ST$$;

  18916 23 005244   200037 470500                    LDP0    @LTS$$,,AUTO
        23 005245   000000 471500                    LDP1    0,,PR0
        23 005246   200040 236100                    LDQ     ST$$,,AUTO
        23 005247   100025 756100                    STQ     21,,PR1

     1012    18917
     1013    18918    2        CALL NEW_DEPEND_SIZE (ST$$, LTS$$ -> FILE_LTS.ST$);

  18918 23 005250   000000 471500                    LDP1    0,,PR0
        23 005251   100001 633500                    EPPR3   1,,PR1
        23 005252   200044 453500                    STP3    @DN$+1,,AUTO
        23 005253   200040 631500                    EPPR1   ST$$,,AUTO
        23 005254   200043 451500                    STP1    FATHER$,,AUTO
        23 005255   005261 701000 23                 TSX1    NEW_DEPEND_SIZE
        23 005256   000000 011000                    NOP     0

     1014    18919
     1015    18920    2   END RECORD_RECOVERY;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:195  

  18920 23 005257   200036 221300                    LDX1  ! @LEN+2,,AUTO
        23 005260   000001 702211                    TSX2  ! 1,X1

     1016    18921        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:196  
     1017    18922    1   NEW_DEPEND_SIZE: PROC (DN$, FD$$);

  18922 23 005261   200042 741300       NEW_DEPEND_* STX1  ! @COLUMN#,,AUTO

     1018    18923
     1019    18924    2        DCL DN$             PTR;
     1020    18925    2        DCL FD$$            PTR;
     1021    18926    2        DCL TEMP$           PTR;
     1022    18927    2        DCL SON_FD$$        PTR;
     1023    18928
     1024    18929
     1025    18930
     1026    18931             %NEW_DEPENDING_SIZE (@POINTER = TEMP$,
     1027    18932                                  @SIZE$   = DN$);

  19011 23 005262   000002 236000 6                  LDQ     LTS_+2
        23 005263   000003 036007                    ADLQ    3,DL
        23 005264   000003 116000 6                  CMPQ    LTS_+3
        23 005265   005276 604000 23                 TMI     s:19013

  19012 23 005266   000052 236000 24                 LDQ     42
        23 005267   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005270   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005271   200051 450500                    STP0    SON_FD$$+3,,AUTO
        23 005272   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 005273   000001 631400 24                 EPPR1   1
        23 005274   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 005275   000000 011000                    NOP     0

  19013 23 005276   000002 236000 6                  LDQ     LTS_+2
        23 005277   000022 736000                    QLS     18
        23 005300   000001 036000 6                  ADLQ    LTS_+1
        23 005301   200045 756100                    STQ     TEMP$,,AUTO

  19014 23 005302   000003 236007                    LDQ     3,DL
        23 005303   000002 056000 6                  ASQ     LTS_+2

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:197  
  19015 23 005304   001120 220003                    LDX0    592,DU
        23 005305   200045 470500                    LDP0    TEMP$,,AUTO
        23 005306   000000 740100                    STX0    0,,PR0

  19021 23 005307   200043 470500                    LDP0    @DN$,,AUTO
        23 005310   000000 236100                    LDQ     0,,PR0
        23 005311   200045 471500                    LDP1    TEMP$,,AUTO
        23 005312   100001 756100                    STQ     1,,PR1

  19022 23 005313   000000 221003                    LDX1    0,DU
        23 005314   200045 471500                    LDP1    TEMP$,,AUTO
        23 005315   100000 441100                    SXL1    0,,PR1

  19023 23 005316   000000 236000 24                 LDQ     0
        23 005317   200045 471500                    LDP1    TEMP$,,AUTO
        23 005320   100002 756100                    STQ     2,,PR1

     1028    19026
     1029    19027    2        FD$$ -> FD.B.OCCURS_DEPENDING = TRUE;

  19027 23 005321   200044 471500                    LDP1    @FD$$,,AUTO
        23 005322   100000 473500                    LDP3    0,,PR1
        23 005323   000200 236003                    LDQ     128,DU
        23 005324   300003 256100                    ORSQ    3,,PR3

     1030    19028
     1031    19029    2        CALL Z8DO$LINK_WITH_LTS (FD$$ -> FD.LTS$, TEMP$);

  19029 23 005325   100000 473500                    LDP3    0,,PR1
        23 005326   200045 634500                    EPPR4   TEMP$,,AUTO
        23 005327   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 005330   300005 635500                    EPPR5   5,,PR3
        23 005331   200050 455500                    STP5    SON_FD$$+2,,AUTO
        23 005332   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005333   000011 631400 24                 EPPR1   9
        23 005334   000000 701000 xent               TSX1    Z8DO$LINK_WITH_LTS
        23 005335   000000 011000                    NOP     0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:198  

     1032    19030
     1033    19031    2        SON_FD$$ = FD$$-> FD.QLT$-> QLT.SON-> QLT.ST$;       /*#26938*/

  19031 23 005336   200044 470500                    LDP0    @FD$$,,AUTO
        23 005337   000000 471500                    LDP1    0,,PR0
        23 005340   100007 473500                    LDP3    7,,PR1
        23 005341   300003 474500                    LDP4    3,,PR3
        23 005342   400004 236100                    LDQ     4,,PR4
        23 005343   200046 756100                    STQ     SON_FD$$,,AUTO

     1034    19032
     1035    19033    2        SON_FD$$->VARIABLE.B.OCCURS_DEPENDING = TRUE;

  19033 23 005344   200046 475500                    LDP5    SON_FD$$,,AUTO
        23 005345   000200 236003                    LDQ     128,DU
        23 005346   500003 256100                    ORSQ    3,,PR5

     1036    19034
     1037    19035    2        CALL Z8DO$LINK_WITH_LTS (SON_FD$$-> VARIABLE.LTS$, TEMP$);

  19035 23 005347   200045 631500                    EPPR1   TEMP$,,AUTO
        23 005350   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 005351   200046 236100                    LDQ     SON_FD$$,,AUTO
        23 005352   000005 036003                    ADLQ    5,DU
        23 005353   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005354   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005355   000011 631400 24                 EPPR1   9
        23 005356   000000 701000 xent               TSX1    Z8DO$LINK_WITH_LTS
        23 005357   000000 011000                    NOP     0

     1038    19036
     1039    19037    2   END NEW_DEPEND_SIZE;

  19037 23 005360   200042 221300                    LDX1  ! @COLUMN#,,AUTO
        23 005361   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:199  
     1040    19038        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:200  
     1041    19039    1   KEY_ORG: PROC (LTS$$);

  19039 23 005362   200004 741300       KEY_ORG      STX1  ! LTS$$+1,,AUTO

     1042    19040
     1043    19041    2        DCL LTS$$         PTR;
     1044    19042    2        DCL ST$$          PTR;
     1045    19043
     1046    19044
     1047    19045    2        CALL FILE_STATUS (LTS$$);

  19045 23 005363   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005364   200011 756100                    STQ     @LTS$$,,AUTO
        23 005365   002440 701000 23                 TSX1    FILE_STATUS
        23 005366   000000 011000                    NOP     0

     1048    19046    2        CALL RECORD_CLAUSE (LTS$$);

  19046 23 005367   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005370   200011 756100                    STQ     @LTS$$,,AUTO
        23 005371   004111 701000 23                 TSX1    RECORD_CLAUSE
        23 005372   000000 011000                    NOP     0

     1049    19047    2        CALL FILE_ID (LTS$$);

  19047 23 005373   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005374   200011 756100                    STQ     @LTS$$,,AUTO
        23 005375   002056 701000 23                 TSX1    FILE_ID
        23 005376   000000 011000                    NOP     0

     1050    19048
     1051    19049    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN

  19049 23 005377   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005400   000000 471500                    LDP1    0,,PR0
        23 005401   100030 236100                    LDQ     24,,PR1
        23 005402   000000 116000 24                 CMPQ    0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:201  
        23 005403   005412 600000 23                 TZE     s:19052

     1052    19050    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  19050 23 005404   100030 633500                    EPPR3   24,,PR1
        23 005405   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005406   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005407   000001 631400 24                 EPPR1   1
        23 005410   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005411   000000 011000                    NOP     0

     1053    19051
     1054    19052    2        CALL CATALOG (LTS$$);

  19052 23 005412   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005413   200011 756100                    STQ     @LTS$$,,AUTO
        23 005414   006302 701000 23                 TSX1    CATALOG
        23 005415   000000 011000                    NOP     0

     1055    19053
     1056    19054    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN

  19054 23 005416   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005417   000000 471500                    LDP1    0,,PR0
        23 005420   100015 236100                    LDQ     13,,PR1
        23 005421   000000 116000 24                 CMPQ    0
        23 005422   005447 600000 23                 TZE     s:19062

     1057    19055    3          DO;

     1058    19056    3            CALL RECORD_KEY (LTS$$, LTS$$ -> FILE_LTS.RECORD_KEY$, ST$$);

  19056 23 005423   200006 633500                    EPPR3   ST$$,,AUTO
        23 005424   200021 453500                    STP3    ST$$,,AUTO
        23 005425   100015 634500                    EPPR4   13,,PR1
        23 005426   200020 454500                    STP4    @FORMAT,,AUTO
        23 005427   200005 236100                    LDQ     @LTS$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:202  
        23 005430   200017 756100                    STQ     @LTS$$,,AUTO
        23 005431   005550 701000 23                 TSX1    RECORD_KEY
        23 005432   000000 011000                    NOP     0

     1059    19057    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);

  19057 23 005433   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005434   000000 471500                    LDP1    0,,PR0
        23 005435   100015 633500                    EPPR3   13,,PR1
        23 005436   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005437   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005440   000001 631400 24                 EPPR1   1
        23 005441   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005442   000000 011000                    NOP     0

     1060    19058    3            LTS$$ -> FILE_LTS.RECORD_KEY$ = ST$$;

  19058 23 005443   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005444   000000 471500                    LDP1    0,,PR0
        23 005445   200006 236100                    LDQ     ST$$,,AUTO
        23 005446   100015 756100                    STQ     13,,PR1

     1061    19059    3          END;

     1062    19060
     1063    19061
     1064    19062    2        RETURN;

  19062 23 005447   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 005450   000001 702211                    TSX2  ! 1,X1

     1065    19063
     1066    19064    2   END KEY_ORG;
     1067    19065        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:203  
     1068    19066    1   IND_ORG: PROC (LTS$$);

  19066 23 005451   200004 741300       IND_ORG      STX1  ! LTS$$+1,,AUTO

     1069    19067
     1070    19068    2        DCL LTS$$         PTR;
     1071    19069    2        DCL ST$$          PTR;
     1072    19070
     1073    19071
     1074    19072    2        CALL FILE_STATUS (LTS$$);

  19072 23 005452   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005453   200011 756100                    STQ     @LTS$$,,AUTO
        23 005454   002440 701000 23                 TSX1    FILE_STATUS
        23 005455   000000 011000                    NOP     0

     1075    19073    2        CALL RECORD_CLAUSE (LTS$$);

  19073 23 005456   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005457   200011 756100                    STQ     @LTS$$,,AUTO
        23 005460   004111 701000 23                 TSX1    RECORD_CLAUSE
        23 005461   000000 011000                    NOP     0

     1076    19074    2        CALL FILE_ID (LTS$$);

  19074 23 005462   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005463   200011 756100                    STQ     @LTS$$,,AUTO
        23 005464   002056 701000 23                 TSX1    FILE_ID
        23 005465   000000 011000                    NOP     0

     1077    19075    2        CALL NOMINAL_KEY (LTS$$);

  19075 23 005466   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005467   200011 756100                    STQ     @LTS$$,,AUTO
        23 005470   006013 701000 23                 TSX1    NOMINAL_KEY
        23 005471   000000 011000                    NOP     0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:204  
     1078    19076
     1079    19077    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN

  19077 23 005472   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005473   000000 471500                    LDP1    0,,PR0
        23 005474   100030 236100                    LDQ     24,,PR1
        23 005475   000000 116000 24                 CMPQ    0
        23 005476   005505 600000 23                 TZE     s:19080

     1080    19078    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  19078 23 005477   100030 633500                    EPPR3   24,,PR1
        23 005500   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005501   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005502   000001 631400 24                 EPPR1   1
        23 005503   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005504   000000 011000                    NOP     0

     1081    19079
     1082    19080    2        CALL CATALOG (LTS$$);

  19080 23 005505   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005506   200011 756100                    STQ     @LTS$$,,AUTO
        23 005507   006302 701000 23                 TSX1    CATALOG
        23 005510   000000 011000                    NOP     0

     1083    19081
     1084    19082    2        IF LTS$$ -> FILE_LTS.RECORD_KEY$ ~= ADDR(NIL) THEN

  19082 23 005511   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005512   000000 471500                    LDP1    0,,PR0
        23 005513   100015 236100                    LDQ     13,,PR1
        23 005514   000000 116000 24                 CMPQ    0
        23 005515   005542 600000 23                 TZE     s:19089

     1085    19083    3          DO;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:205  
     1086    19084    3            CALL RECORD_KEY (LTS$$, LTS$$ -> FILE_LTS.RECORD_KEY$, ST$$);

  19084 23 005516   200006 633500                    EPPR3   ST$$,,AUTO
        23 005517   200021 453500                    STP3    ST$$,,AUTO
        23 005520   100015 634500                    EPPR4   13,,PR1
        23 005521   200020 454500                    STP4    @FORMAT,,AUTO
        23 005522   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005523   200017 756100                    STQ     @LTS$$,,AUTO
        23 005524   005550 701000 23                 TSX1    RECORD_KEY
        23 005525   000000 011000                    NOP     0

     1087    19085    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RECORD_KEY$);

  19085 23 005526   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005527   000000 471500                    LDP1    0,,PR0
        23 005530   100015 633500                    EPPR3   13,,PR1
        23 005531   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 005532   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005533   000001 631400 24                 EPPR1   1
        23 005534   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 005535   000000 011000                    NOP     0

     1088    19086    3            LTS$$ -> FILE_LTS.RECORD_KEY$ = ST$$;

  19086 23 005536   200005 470500                    LDP0    @LTS$$,,AUTO
        23 005537   000000 471500                    LDP1    0,,PR0
        23 005540   200006 236100                    LDQ     ST$$,,AUTO
        23 005541   100015 756100                    STQ     13,,PR1

     1089    19087    3          END;

     1090    19088
     1091    19089    2        CALL ALTERNATE_KEYS (LTS$$);

  19089 23 005542   200005 236100                    LDQ     @LTS$$,,AUTO
        23 005543   200011 756100                    STQ     @LTS$$,,AUTO
        23 005544   006152 701000 23                 TSX1    ALTERNATE_KEYS
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:206  
        23 005545   000000 011000                    NOP     0

     1092    19090
     1093    19091
     1094    19092    2        RETURN;

  19092 23 005546   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 005547   000001 702211                    TSX2  ! 1,X1

     1095    19093
     1096    19094    2   END IND_ORG;
     1097    19095        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:207  
     1098    19096    1   RECORD_KEY: PROC (LTS$$, KEY$, ST$$);

  19096 23 005550   200016 741300       RECORD_KEY   STX1  ! LINE,,AUTO

     1099    19097
     1100    19098    2        DCL LTS$$         PTR;
     1101    19099    2        DCL ST$$          PTR;
     1102    19100    2        DCL QLT$$         PTR;
     1103    19101    2        DCL KEY$          PTR;
     1104    19102
     1105    19103
     1106    19104
     1107    19105    2        IF KEY$ = ADDR(NIL) THEN

  19105 23 005551   200020 470500                    LDP0    @KEY$,,AUTO
        23 005552   000000 236100                    LDQ     0,,PR0
        23 005553   000000 116000 24                 CMPQ    0
        23 005554   005563 601000 23                 TNZ     s:19112

     1108    19106    3          DO;

     1109    19107                 /* A record key is required so just create any old temp */
     1110    19108    3            CALL NEW_INTEGER (ST$$);

  19108 23 005555   200021 236100                    LDQ     @ST$$,,AUTO
        23 005556   200025 756100                    STQ     QLT$$,,AUTO
        23 005557   006632 701000 23                 TSX1    NEW_INTEGER
        23 005560   000000 011000                    NOP     0

     1111    19109    3            RETURN;

  19109 23 005561   200016 221300                    LDX1  ! LINE,,AUTO
        23 005562   000001 702211                    TSX2  ! 1,X1

     1112    19110    3          END;
     1113    19111
     1114    19112    2        CALL Z8CO$QUALIFY_VARIABLE (KEY$, ST$$)
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:208  

  19112 23 005563   200020 630500                    EPPR0   @KEY$,,AUTO
        23 005564   000011 631400 24                 EPPR1   9
        23 005565   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 005566   005570 702000 23                 TSX2    s:19115
        23 005567   005572 710000 23                 TRA     s:19118

     1115    19113    2          WHENALTRETURN
     1116    19114    3            DO;

     1117    19115    3              RETURN;

  19115 23 005570   200016 221300                    LDX1  ! LINE,,AUTO
        23 005571   000001 702211                    TSX2  ! 1,X1

     1118    19116    3            END;
     1119    19117
     1120    19118    2        IF (ST$$ -> SCALAR.TYPE ~= %TYA

  19118 23 005572   200021 470500                    LDP0    @ST$$,,AUTO
        23 005573   000000 471500                    LDP1    0,,PR0
        23 005574   100002 220100                    LDX0    2,,PR1
        23 005575   000010 100003                    CMPX0   8,DU
        23 005576   005603 600000 23                 TZE     s:19118+9
        23 005577   000006 100003                    CMPX0   6,DU
        23 005600   005603 600000 23                 TZE     s:19118+9
        23 005601   000014 100003                    CMPX0   12,DU
        23 005602   005614 601000 23                 TNZ     s:19137
        23 005603   100000 221100                    LDX1    0,,PR1
        23 005604   000766 101003                    CMPX1   502,DU
        23 005605   005610 600000 23                 TZE     s:19118+14
        23 005606   000765 101003                    CMPX1   501,DU
        23 005607   005614 601000 23                 TNZ     s:19137
        23 005610   100003 236100                    LDQ     3,,PR1
        23 005611   000007 376007                    ANQ     7,DL
        23 005612   000003 116007                    CMPQ    3,DL
        23 005613   005655 600000 23                 TZE     s:19164
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:209  

     1121    19119    2            AND ST$$ -> SCALAR.TYPE ~= %TYE
     1122    19120    2            AND ST$$ -> SCALAR.TYPE ~= %TYB)
     1123    19121    2        OR (ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY)
     1124    19122    2        OR ST$$ -> SCALAR.B.CLASS ~= %CLASS_ALPHANUMERIC THEN
     1125    19123    3          DO;

     1126    19124                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1127    19125                                     @ERROR#   = %E$ALPHANUMERIC_TYPE_EXPECTED,
     1128    19126                                     @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1129    19127                                     @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);

  19137 23 005614   200020 473500                    LDP3    @KEY$,,AUTO
        23 005615   300000 474500                    LDP4    0,,PR3
        23 005616   400000 236100                    LDQ     0,,PR4
        23 005617   400000 316007                    CANQ    -131072,DL
        23 005620   005640 601000 23                 TNZ     s:19157

  19139 23 005621   400004 475500                    LDP5    4,,PR4
        23 005622   500006 636500                    EPPR6   6,,PR5
        23 005623   200052 456500                    STP6    SON_FD$$+4,,AUTO
        23 005624   500005 631500                    EPPR1   5,,PR5
        23 005625   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 005626   000017 236000 24                 LDQ     15
        23 005627   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005630   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005631   000006 631400 24                 EPPR1   6
        23 005632   000000 701000 xent               TSX1    Z8AE$ERROR
        23 005633   000000 011000                    NOP     0

  19148 23 005634   200020 470500                    LDP0    @KEY$,,AUTO
        23 005635   000000 471500                    LDP1    0,,PR0
        23 005636   400000 236007                    LDQ     -131072,DL
        23 005637   100000 256100                    ORSQ    0,,PR1

     1130    19157    3            IF ST$$ -> ST.ID ~= %SCALAR AND ST$$ -> ST.ID ~= %ARRAY

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:210  
  19157 23 005640   200021 470500                    LDP0    @ST$$,,AUTO
        23 005641   000000 471500                    LDP1    0,,PR0
        23 005642   100000 220100                    LDX0    0,,PR1
        23 005643   000766 100003                    CMPX0   502,DU
        23 005644   005653 600000 23                 TZE     s:19161
        23 005645   000765 100003                    CMPX0   501,DU
        23 005646   005653 600000 23                 TZE     s:19161

     1131    19158    3              THEN CALL NEW_INTEGER (ST$$);

  19158 23 005647   200021 236100                    LDQ     @ST$$,,AUTO
        23 005650   200025 756100                    STQ     QLT$$,,AUTO
        23 005651   006632 701000 23                 TSX1    NEW_INTEGER
        23 005652   000000 011000                    NOP     0

     1132    19159                   /* Replace with a temp */
     1133    19160
     1134    19161    3            RETURN;

  19161 23 005653   200016 221300                    LDX1  ! LINE,,AUTO
        23 005654   000001 702211                    TSX2  ! 1,X1

     1135    19162    3          END;
     1136    19163
     1137    19164    2        CALL Z9DI$KEY_LENGTH_CHECK (ST$$)

  19164 23 005655   200021 630500                    EPPR0   @ST$$,,AUTO
        23 005656   000001 631400 24                 EPPR1   1
        23 005657   000000 701000 xent               TSX1    Z9DI$KEY_LENGTH_CHECK
        23 005660   005662 702000 23                 TSX2    s:19167
        23 005661   005664 710000 23                 TRA     s:19170

     1138    19165    2          WHENALTRETURN
     1139    19166    3            DO;

     1140    19167    3              RETURN;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:211  
  19167 23 005662   200016 221300                    LDX1  ! LINE,,AUTO
        23 005663   000001 702211                    TSX2  ! 1,X1

     1141    19168    3            END;
     1142    19169
     1143    19170    2        IF ST$$ -> SCALAR.B.OCCURS_DEPENDING  AND

  19170 23 005664   200021 470500                    LDP0    @ST$$,,AUTO
        23 005665   000000 471500                    LDP1    0,,PR0
        23 005666   100003 236100                    LDQ     3,,PR1
        23 005667   000200 316003                    CANQ    128,DU
        23 005670   005724 600000 23                 TZE     s:19210
        23 005671   200017 473500                    LDP3    @LTS$$,,AUTO
        23 005672   300000 474500                    LDP4    0,,PR3
        23 005673   400006 235100                    LDA     6,,PR4
        23 005674   000004 115007                    CMPA    4,DL
        23 005675   005724 600000 23                 TZE     s:19210

     1144    19171    2             LTS$$ -> FILE_LTS.ORGANIZATION ~= %KEYED   THEN  /*#17906*/
     1145    19172    3          DO;

     1146    19173                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1147    19174                              @ERROR#   = %E$NO_VARIABLE_OCCURRENCE,
     1148    19175                              @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1149    19176                              @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);

  19186 23 005676   200020 475500                    LDP5    @KEY$,,AUTO
        23 005677   500000 476500                    LDP6    0,,PR5
        23 005700   600000 236100                    LDQ     0,,PR6
        23 005701   400000 316007                    CANQ    -131072,DL
        23 005702   005722 601000 23                 TNZ     s:19206

  19188 23 005703   600004 477500                    LDP7    4,,PR6
        23 005704   700006 630500                    EPPR0   6,,PR7
        23 005705   200052 450500                    STP0    SON_FD$$+4,,AUTO
        23 005706   700005 631500                    EPPR1   5,,PR7
        23 005707   200051 451500                    STP1    SON_FD$$+3,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:212  
        23 005710   000067 236000 24                 LDQ     55
        23 005711   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005712   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 005713   000006 631400 24                 EPPR1   6
        23 005714   000000 701000 xent               TSX1    Z8AE$ERROR
        23 005715   000000 011000                    NOP     0

  19197 23 005716   200020 470500                    LDP0    @KEY$,,AUTO
        23 005717   000000 471500                    LDP1    0,,PR0
        23 005720   400000 236007                    LDQ     -131072,DL
        23 005721   100000 256100                    ORSQ    0,,PR1

     1150    19206    3            RETURN;

  19206 23 005722   200016 221300                    LDX1  ! LINE,,AUTO
        23 005723   000001 702211                    TSX2  ! 1,X1

     1151    19207    3          END;
     1152    19208
     1153    19209
     1154    19210    3        DO CASE (LTS$$ -> FILE_LTS.ORGANIZATION);

  19210 23 005724   200017 473500                    LDP3    @LTS$$,,AUTO
        23 005725   300000 474500                    LDP4    0,,PR3
        23 005726   400006 235100                    LDA     6,,PR4
        23 005727   000004 135007                    SBLA    4,DL
        23 005730   000001 115007                    CMPA    1,DL
        23 005731   005733 602005 23                 TNC     s:19210+7,AL
        23 005732   005736 710000 23                 TRA     s:19223
        23 005733   005734 710000 23                 TRA     s:19217

     1155    19211    3          CASE(

     1156    19212                    %SET_OF_KEYED_ORGANIZATION;
     1157    19215    3              );
     1158    19216
     1159    19217    3                RETURN;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:213  

  19217 23 005734   200016 221300                    LDX1  ! LINE,,AUTO
        23 005735   000001 702211                    TSX2  ! 1,X1

     1160    19218
     1161    19219    3          CASE(ELSE);

     1162    19220                 /* Keep going */
     1163    19221    3        END; /* Case */

     1164    19222
     1165    19223    2        QLT$$ = ST$$ -> SCALAR.QLT$;

  19223 23 005736   100007 236100                    LDQ     7,,PR1
        23 005737   200022 756100                    STQ     QLT$$,,AUTO

     1166    19224
     1167    19225    2   IN_RECORD_CHECK:
     1168    19226    3        DO WHILE (QLT$$ ~= ADDR(NIL));

  19226 23 005740   005752 710000 23    IN_RECORD_C* TRA     s:19231

     1169    19227    3          IF QLT$$ = LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ THEN

  19227 23 005741   200017 470500                    LDP0    @LTS$$,,AUTO
        23 005742   000000 471500                    LDP1    0,,PR0
        23 005743   100001 473500                    LDP3    1,,PR1
        23 005744   200022 236100                    LDQ     QLT$$,,AUTO
        23 005745   300007 116100                    CMPQ    7,,PR3
        23 005746   005754 600000 23                 TZE     s:19233

     1170    19228    3            EXIT;
     1171    19229
     1172    19230    3          QLT$$ = QLT$$ -> QLT.FATHER;

  19230 23 005747   200022 474500                    LDP4    QLT$$,,AUTO
        23 005750   400001 236100                    LDQ     1,,PR4
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:214  
        23 005751   200022 756100                    STQ     QLT$$,,AUTO

     1173    19231    3        END; /* While */

  19231 23 005752   000000 116000 24                 CMPQ    0
        23 005753   005741 601000 23                 TNZ     s:19227

     1174    19232
     1175    19233    2        IF QLT$$ = ADDR(NIL) THEN

  19233 23 005754   000000 116000 24                 CMPQ    0
        23 005755   006011 601000 23                 TNZ     s:19273

     1176    19234    3          DO;

     1177    19235                 %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1178    19236                                     @ERROR#   = %E$KEY_NOT_IN_FILE_DESC,
     1179    19237                                     @LINE     = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1180    19238                                     @COLUMN   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
     1181    19239                                     @PLUG1    = LTS$$ -> FILE_LTS.ST$ -> ST.DNT$);

  19249 23 005756   200020 470500                    LDP0    @KEY$,,AUTO
        23 005757   000000 471500                    LDP1    0,,PR0
        23 005760   100000 236100                    LDQ     0,,PR1
        23 005761   400000 316007                    CANQ    -131072,DL
        23 005762   006007 601000 23                 TNZ     s:19270

  19251 23 005763   100004 473500                    LDP3    4,,PR1
        23 005764   200017 474500                    LDP4    @LTS$$,,AUTO
        23 005765   400000 475500                    LDP5    0,,PR4
        23 005766   500001 476500                    LDP6    1,,PR5
        23 005767   600006 637500                    EPPR7   6,,PR6
        23 005770   200053 457500                    STP7    SON_FD$$+5,,AUTO
        23 005771   300006 631500                    EPPR1   6,,PR3
        23 005772   200052 451500                    STP1    SON_FD$$+4,,AUTO
        23 005773   300005 635500                    EPPR5   5,,PR3
        23 005774   200051 455500                    STP5    SON_FD$$+3,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:215  
        23 005775   000071 236000 24                 LDQ     57
        23 005776   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 005777   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006000   000002 631400 24                 EPPR1   2
        23 006001   000000 701000 xent               TSX1    Z8AE$ERROR
        23 006002   000000 011000                    NOP     0

  19260 23 006003   200020 470500                    LDP0    @KEY$,,AUTO
        23 006004   000000 471500                    LDP1    0,,PR0
        23 006005   400000 236007                    LDQ     -131072,DL
        23 006006   100000 256100                    ORSQ    0,,PR1

     1182    19269
     1183    19270    3            RETURN;

  19270 23 006007   200016 221300                    LDX1  ! LINE,,AUTO
        23 006010   000001 702211                    TSX2  ! 1,X1

     1184    19271    3          END;
     1185    19272
     1186    19273    2        RETURN;

  19273 23 006011   200016 221300                    LDX1  ! LINE,,AUTO
        23 006012   000001 702211                    TSX2  ! 1,X1

     1187    19274
     1188    19275    2   END RECORD_KEY;
     1189    19276        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:216  
     1190    19277    1   NOMINAL_KEY: PROC (LTS$$);

  19277 23 006013   200010 741300       NOMINAL_KEY  STX1  ! DESC,,AUTO

     1191    19278
     1192    19279    2        DCL LTS$$         PTR;
     1193    19280    2        DCL ST$$          PTR;
     1194    19281    2        DCL LINE          SBIN;
     1195    19282    2        DCL COLUMN        SBIN;
     1196    19283
     1197    19284
     1198    19285    2        IF LTS$$ -> FILE_LTS.NOMINAL_KEY$ = ADDR(NIL) THEN

  19285 23 006014   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006015   000000 471500                    LDP1    0,,PR0
        23 006016   100020 236100                    LDQ     16,,PR1
        23 006017   000000 116000 24                 CMPQ    0
        23 006020   006022 601000 23                 TNZ     s:19288

     1199    19286    2          RETURN;

  19286 23 006021   000001 702211                    TSX2  ! 1,X1

     1200    19287
     1201    19288    2        CALL Z8CO$QUALIFY_VARIABLE (LTS$$ -> FILE_LTS.NOMINAL_KEY$, ST$$);

  19288 23 006022   200012 633500                    EPPR3   ST$$,,AUTO
        23 006023   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 006024   100020 634500                    EPPR4   16,,PR1
        23 006025   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 006026   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006027   000011 631400 24                 EPPR1   9
        23 006030   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 006031   000000 011000                    NOP     0

     1202    19289
     1203    19290    2        LINE   = LTS$$ -> FILE_LTS.NOMINAL_KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:217  

  19290 23 006032   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006033   000000 471500                    LDP1    0,,PR0
        23 006034   100020 473500                    LDP3    16,,PR1
        23 006035   300004 474500                    LDP4    4,,PR3
        23 006036   400005 235100                    LDA     5,,PR4
        23 006037   200013 755100                    STA     LINE,,AUTO

     1204    19291    2        COLUMN = LTS$$ -> FILE_LTS.NOMINAL_KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN;

  19291 23 006040   000000 471500                    LDP1    0,,PR0
        23 006041   100020 473500                    LDP3    16,,PR1
        23 006042   300004 474500                    LDP4    4,,PR3
        23 006043   400006 235100                    LDA     6,,PR4
        23 006044   200014 755100                    STA     COLUMN,,AUTO

     1205    19292
     1206    19293    2        IF ST$$ -> SCALAR.B.OCCURS_DEPENDING THEN

  19293 23 006045   200012 471500                    LDP1    ST$$,,AUTO
        23 006046   100003 236100                    LDQ     3,,PR1
        23 006047   000200 316003                    CANQ    128,DU
        23 006050   006106 600000 23                 TZE     s:19333

     1207    19294    3          DO;

     1208    19295                 %CONDITIONAL_ERROR (@LX_ITEM$ = LTS$$ -> FILE_LTS.NOMINAL_KEY$,
     1209    19296                                     @ERROR#   = %E$NO_VARIABLE_OCCURRENCE,
     1210    19297                                     @LINE     = LINE,
     1211    19298                                     @COLUMN   = COLUMN);

  19308 23 006051   000000 473500                    LDP3    0,,PR0
        23 006052   300020 474500                    LDP4    16,,PR3
        23 006053   400000 236100                    LDQ     0,,PR4
        23 006054   400000 316007                    CANQ    -131072,DL
        23 006055   006075 601000 23                 TNZ     s:19329

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:218  
  19310 23 006056   200014 635500                    EPPR5   COLUMN,,AUTO
        23 006057   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 006060   200013 633500                    EPPR3   LINE,,AUTO
        23 006061   200051 453500                    STP3    SON_FD$$+3,,AUTO
        23 006062   000067 236000 24                 LDQ     55
        23 006063   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 006064   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006065   000006 631400 24                 EPPR1   6
        23 006066   000000 701000 xent               TSX1    Z8AE$ERROR
        23 006067   000000 011000                    NOP     0

  19319 23 006070   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006071   000000 471500                    LDP1    0,,PR0
        23 006072   100020 473500                    LDP3    16,,PR1
        23 006073   400000 236007                    LDQ     -131072,DL
        23 006074   300000 256100                    ORSQ    0,,PR3

     1212    19328
     1213    19329    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);

  19329 23 006075   000000 471500                    LDP1    0,,PR0
        23 006076   100020 633500                    EPPR3   16,,PR1
        23 006077   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006100   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006101   000001 631400 24                 EPPR1   1
        23 006102   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006103   000000 011000                    NOP     0

     1214    19330    3            RETURN;

  19330 23 006104   200010 221300                    LDX1  ! DESC,,AUTO
        23 006105   000001 702211                    TSX2  ! 1,X1

     1215    19331    3          END;
     1216    19332
     1217    19333    2        CALL CHECK_FOR_WORKING_STORAGE (ST$$,

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:219  
  19333 23 006106   000000 473500                    LDP3    0,,PR0
        23 006107   200014 634500                    EPPR4   COLUMN,,AUTO
        23 006110   200042 454500                    STP4    @COLUMN#,,AUTO
        23 006111   200013 635500                    EPPR5   LINE,,AUTO
        23 006112   200041 455500                    STP5    @LINE#,,AUTO
        23 006113   300020 636500                    EPPR6   16,,PR3
        23 006114   200040 456500                    STP6    ST$$,,AUTO
        23 006115   200012 633500                    EPPR3   ST$$,,AUTO
        23 006116   200037 453500                    STP3    @LTS$$,,AUTO
        23 006117   002703 701000 23                 TSX1    CHECK_FOR_WORKING_STORAGE
        23 006120   006122 702000 23                 TSX2    s:19339
        23 006121   006134 710000 23                 TRA     s:19343

     1218    19334    2                                        LTS$$ -> FILE_LTS.NOMINAL_KEY$,
     1219    19335    2                                        LINE,
     1220    19336    2                                        COLUMN)
     1221    19337    2          WHENALTRETURN
     1222    19338    3            DO;

     1223    19339    3              CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);

  19339 23 006122   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006123   000000 471500                    LDP1    0,,PR0
        23 006124   100020 633500                    EPPR3   16,,PR1
        23 006125   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006126   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006127   000001 631400 24                 EPPR1   1
        23 006130   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006131   000000 011000                    NOP     0

     1224    19340    3              RETURN;

  19340 23 006132   200010 221300                    LDX1  ! DESC,,AUTO
        23 006133   000001 702211                    TSX2  ! 1,X1

     1225    19341    3            END;
     1226    19342
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:220  
     1227    19343    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.NOMINAL_KEY$);

  19343 23 006134   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006135   000000 471500                    LDP1    0,,PR0
        23 006136   100020 633500                    EPPR3   16,,PR1
        23 006137   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006140   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006141   000001 631400 24                 EPPR1   1
        23 006142   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006143   000000 011000                    NOP     0

     1228    19344
     1229    19345    2        LTS$$ -> FILE_LTS.NOMINAL_KEY$ = ST$$;

  19345 23 006144   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006145   000000 471500                    LDP1    0,,PR0
        23 006146   200012 236100                    LDQ     ST$$,,AUTO
        23 006147   100020 756100                    STQ     16,,PR1

     1230    19346
     1231    19347    2   END NOMINAL_KEY;

  19347 23 006150   200010 221300                    LDX1  ! DESC,,AUTO
        23 006151   000001 702211                    TSX2  ! 1,X1

     1232    19348        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:221  
     1233    19349    1   ALTERNATE_KEYS: PROC (LTS$$);

  19349 23 006152   200010 741300       ALTERNATE_K* STX1  ! DESC,,AUTO

     1234    19350
     1235    19351    2        DCL LTS$$         PTR;
     1236    19352    2        DCL LIST$         PTR;
     1237    19353    2        DCL KEY$          PTR;
     1238    19354    2        DCL ALT_KEY$      PTR;
     1239    19355    2        DCL I             SBIN;
     1240    19356
     1241    19357
     1242    19358    2        LIST$ = LTS$$ -> FILE_LTS.ALT_RECORD_KEY$;

  19358 23 006153   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006154   000000 471500                    LDP1    0,,PR0
        23 006155   100016 236100                    LDQ     14,,PR1
        23 006156   200012 756100                    STQ     LIST$,,AUTO

     1243    19359
     1244    19360    2        IF LIST$ = ADDR(NIL) THEN

  19360 23 006157   000000 116000 24                 CMPQ    0
        23 006160   006162 601000 23                 TNZ     s:19363

     1245    19361    2          RETURN;

  19361 23 006161   000001 702211                    TSX2  ! 1,X1

     1246    19362
     1247    19363    2        I = LIST$ -> LX_LIST.COUNT;

  19363 23 006162   200012 473500                    LDP3    LIST$,,AUTO
        23 006163   300002 235100                    LDA     2,,PR3
        23 006164   200015 755100                    STA     I,,AUTO

     1248    19364
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:222  
     1249    19365             %NEW_ALT_KEY (@POINTER = ALT_KEY$,
     1250    19366                           @#KEYS   = I);

  19368 23 006165   000001 735000                    ALS     1
        23 006166   000002 035007                    ADLA    2,DL
        23 006167   000000 755000 0                  STA     ITERATION

  19446 23 006170   000002 236000 6                  LDQ     LTS_+2
        23 006171   000000 036000 0                  ADLQ    ITERATION
        23 006172   000003 116000 6                  CMPQ    LTS_+3
        23 006173   006204 604000 23                 TMI     s:19448

  19447 23 006174   000052 236000 24                 LDQ     42
        23 006175   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 006176   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 006177   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006200   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 006201   000001 631400 24                 EPPR1   1
        23 006202   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 006203   000000 011000                    NOP     0

  19448 23 006204   000002 236000 6                  LDQ     LTS_+2
        23 006205   000022 736000                    QLS     18
        23 006206   000001 036000 6                  ADLQ    LTS_+1
        23 006207   200014 756100                    STQ     ALT_KEY$,,AUTO

  19449 23 006210   000002 236000 6                  LDQ     LTS_+2
        23 006211   000000 036000 0                  ADLQ    ITERATION
        23 006212   000002 756000 6                  STQ     LTS_+2

  19450 23 006213   001123 220003                    LDX0    595,DU
        23 006214   200014 470500                    LDP0    ALT_KEY$,,AUTO
        23 006215   000000 740100                    STX0    0,,PR0

  19452 23 006216   000000 721000 0                  LXL1    ITERATION
        23 006217   000000 441100                    SXL1    0,,PR0

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:223  
  19456 23 006220   200015 235100                    LDA     I,,AUTO
        23 006221   000001 135007                    SBLA    1,DL
        23 006222   000001 755100                    STA     1,,PR0

     1251    19459
     1252    19460    2        LIST$ = LIST$ -> LX_LIST.HEAD$;

  19460 23 006223   200012 471500                    LDP1    LIST$,,AUTO
        23 006224   100004 236100                    LDQ     4,,PR1
        23 006225   200012 756100                    STQ     LIST$,,AUTO

     1253    19461    2        I = 0;

  19461 23 006226   200015 450100                    STZ     I,,AUTO

     1254    19462
     1255    19463    3        DO WHILE (LIST$ ~= ADDR(NIL));

  19463 23 006227   006262 710000 23                 TRA     s:19473

     1256    19464    3          CALL RECORD_KEY (LTS$$, LIST$ -> LX_LIST.HEAD$, KEY$);

  19464 23 006230   200013 630500                    EPPR0   KEY$,,AUTO
        23 006231   200021 450500                    STP0    @ST$$,,AUTO
        23 006232   200012 236100                    LDQ     LIST$,,AUTO
        23 006233   000004 036003                    ADLQ    4,DU
        23 006234   200020 756100                    STQ     @KEY$,,AUTO
        23 006235   200011 236100                    LDQ     @LTS$$,,AUTO
        23 006236   200017 756100                    STQ     @LTS$$,,AUTO
        23 006237   005550 701000 23                 TSX1    RECORD_KEY
        23 006240   000000 011000                    NOP     0

     1257    19465
     1258    19466    3          ALT_KEY$ -> ALT_KEY.P.P$ (I) = KEY$;

  19466 23 006241   200015 235100                    LDA     I,,AUTO
        23 006242   000001 735000                    ALS     1
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:224  
        23 006243   200013 236100                    LDQ     KEY$,,AUTO
        23 006244   200014 470500                    LDP0    ALT_KEY$,,AUTO
        23 006245   000003 756105                    STQ     3,AL,PR0

     1259    19467
     1260    19468    3          IF LIST$ -> LX_LIST.COUNT = 1 THEN

  19468 23 006246   200012 471500                    LDP1    LIST$,,AUTO
        23 006247   100002 235100                    LDA     2,,PR1
        23 006250   000001 115007                    CMPA    1,DL
        23 006251   006257 601000 23                 TNZ     s:19471

     1261    19469    3            ALT_KEY$ -> ALT_KEY.P.UNIQUE (I) = TRUE;

  19469 23 006252   200015 236100                    LDQ     I,,AUTO
        23 006253   000001 736000                    QLS     1
        23 006254   000000 620006                    EAX0    0,QL
        23 006255   400000 236003                    LDQ     -131072,DU
        23 006256   000002 756110                    STQ     2,X0,PR0

     1262    19470
     1263    19471    3          LIST$ = LIST$ -> LX_LIST.LINK;

  19471 23 006257   100007 236100                    LDQ     7,,PR1
        23 006260   200012 756100                    STQ     LIST$,,AUTO

     1264    19472    3          I = I + 1;

  19472 23 006261   200015 054100                    AOS     I,,AUTO

     1265    19473    3        END; /* While */

  19473 23 006262   000000 116000 24                 CMPQ    0
        23 006263   006230 601000 23                 TNZ     s:19464

     1266    19474
     1267    19475    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.ALT_RECORD_KEY$);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:225  

  19475 23 006264   200011 471500                    LDP1    @LTS$$,,AUTO
        23 006265   100000 473500                    LDP3    0,,PR1
        23 006266   300016 634500                    EPPR4   14,,PR3
        23 006267   200050 454500                    STP4    SON_FD$$+2,,AUTO
        23 006270   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006271   000001 631400 24                 EPPR1   1
        23 006272   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006273   000000 011000                    NOP     0

     1268    19476
     1269    19477    2        LTS$$ -> FILE_LTS.ALT_RECORD_KEY$ = ALT_KEY$;

  19477 23 006274   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006275   000000 471500                    LDP1    0,,PR0
        23 006276   200014 236100                    LDQ     ALT_KEY$,,AUTO
        23 006277   100016 756100                    STQ     14,,PR1

     1270    19478
     1271    19479    2   END ALTERNATE_KEYS;

  19479 23 006300   200010 221300                    LDX1  ! DESC,,AUTO
        23 006301   000001 702211                    TSX2  ! 1,X1

     1272    19480        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:226  
     1273    19481    1   CATALOG: PROC (LTS$$);

  19481 23 006302   200010 741300       CATALOG      STX1  ! DESC,,AUTO

     1274    19482
     1275    19483    2        DCL LTS$$         PTR;
     1276    19484    2        DCL CAT$          PTR;
     1277    19485
     1278    19486
     1279    19487    2        IF LTS$$ -> FILE_LTS.CATALOG$ ~= ADDR(NIL) THEN

  19487 23 006303   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006304   000000 471500                    LDP1    0,,PR0
        23 006305   100031 236100                    LDQ     25,,PR1
        23 006306   000000 116000 24                 CMPQ    0
        23 006307   006337 600000 23                 TZE     s:19526

     1280    19488    3          DO;

     1281    19489                 %CONDITIONAL_ERROR (@LX_ITEM$ = CAT$,
     1282    19490                             @ERROR# = %E$FEATURE_NOT_SUPPORTED,
     1283    19491                             @LINE   = CAT$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1284    19492                             @COLUMN = CAT$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);

  19502 23 006310   200012 473500                    LDP3    CAT$,,AUTO
        23 006311   300000 236100                    LDQ     0,,PR3
        23 006312   400000 316007                    CANQ    -131072,DL
        23 006313   006327 601000 23                 TNZ     s:19523

  19504 23 006314   300004 474500                    LDP4    4,,PR3
        23 006315   400006 635500                    EPPR5   6,,PR4
        23 006316   200052 455500                    STP5    SON_FD$$+4,,AUTO
        23 006317   400005 631500                    EPPR1   5,,PR4
        23 006320   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006321   000073 236000 24                 LDQ     59
        23 006322   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 006323   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:227  
        23 006324   000006 631400 24                 EPPR1   6
        23 006325   000000 701000 xent               TSX1    Z8AE$ERROR
        23 006326   000000 011000                    NOP     0

     1285    19522
     1286    19523    3            CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.CATALOG$);

  19523 23 006327   200011 470500                    LDP0    @LTS$$,,AUTO
        23 006330   000000 471500                    LDP1    0,,PR0
        23 006331   100031 633500                    EPPR3   25,,PR1
        23 006332   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006333   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006334   000001 631400 24                 EPPR1   1
        23 006335   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006336   000000 011000                    NOP     0

     1287    19524    3          END;

     1288    19525
     1289    19526    2   END CATALOG;

  19526 23 006337   200010 221300                    LDX1  ! DESC,,AUTO
        23 006340   000001 702211                    TSX2  ! 1,X1

     1290    19527        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:228  
     1291    19528    1   REL_ORG: PROC (LTS$$);

  19528 23 006341   200004 741300       REL_ORG      STX1  ! LTS$$+1,,AUTO

     1292    19529
     1293    19530    2        DCL LTS$$         PTR;
     1294    19531
     1295    19532
     1296    19533    2        CALL FILE_STATUS (LTS$$);

  19533 23 006342   200005 236100                    LDQ     @LTS$$,,AUTO
        23 006343   200011 756100                    STQ     @LTS$$,,AUTO
        23 006344   002440 701000 23                 TSX1    FILE_STATUS
        23 006345   000000 011000                    NOP     0

     1297    19534    2        CALL RECORD_CLAUSE (LTS$$);

  19534 23 006346   200005 236100                    LDQ     @LTS$$,,AUTO
        23 006347   200011 756100                    STQ     @LTS$$,,AUTO
        23 006350   004111 701000 23                 TSX1    RECORD_CLAUSE
        23 006351   000000 011000                    NOP     0

     1298    19535    2        CALL FILE_ID (LTS$$);

  19535 23 006352   200005 236100                    LDQ     @LTS$$,,AUTO
        23 006353   200011 756100                    STQ     @LTS$$,,AUTO
        23 006354   002056 701000 23                 TSX1    FILE_ID
        23 006355   000000 011000                    NOP     0

     1299    19536
     1300    19537    2        IF LTS$$ -> FILE_LTS.RETENTION$ ~= ADDR(NIL) THEN

  19537 23 006356   200005 470500                    LDP0    @LTS$$,,AUTO
        23 006357   000000 471500                    LDP1    0,,PR0
        23 006360   100030 236100                    LDQ     24,,PR1
        23 006361   000000 116000 24                 CMPQ    0
        23 006362   006371 600000 23                 TZE     s:19540
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:229  

     1301    19538    2          CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RETENTION$);

  19538 23 006363   100030 633500                    EPPR3   24,,PR1
        23 006364   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006365   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006366   000001 631400 24                 EPPR1   1
        23 006367   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006370   000000 011000                    NOP     0

     1302    19539
     1303    19540    2        CALL CATALOG (LTS$$);

  19540 23 006371   200005 236100                    LDQ     @LTS$$,,AUTO
        23 006372   200011 756100                    STQ     @LTS$$,,AUTO
        23 006373   006302 701000 23                 TSX1    CATALOG
        23 006374   000000 011000                    NOP     0

     1304    19541
     1305    19542    2        CALL RELATIVE_KEY (LTS$$);

  19542 23 006375   200005 236100                    LDQ     @LTS$$,,AUTO
        23 006376   200007 756100                    STQ     LONG$$,,AUTO
        23 006377   006403 701000 23                 TSX1    RELATIVE_KEY
        23 006400   000000 011000                    NOP     0

     1306    19543
     1307    19544
     1308    19545    2        RETURN;

  19545 23 006401   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 006402   000001 702211                    TSX2  ! 1,X1

     1309    19546
     1310    19547    2   END REL_ORG;
     1311    19548        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:230  
     1312    19549    1   RELATIVE_KEY: PROC (LTS$$);

  19549 23 006403   200006 741300       RELATIVE_KEY STX1  ! ST$$,,AUTO

     1313    19550
     1314    19551    2        DCL LTS$$         PTR;
     1315    19552    2        DCL ST$$          PTR;
     1316    19553    2        DCL QLT$$         PTR;
     1317    19554    2        DCL KEY$          PTR;
     1318    19555
     1319    19556             %DCL_AUTO_LX_ITEM (@NAME = ETT_ITEM);
     1320    19560
     1321    19561
     1322    19562    2        KEY$ = LTS$$ -> FILE_LTS.RELATIVE_KEY$;

  19562 23 006404   200007 470500                    LDP0    @LTS$$,,AUTO
        23 006405   000000 471500                    LDP1    0,,PR0
        23 006406   100014 236100                    LDQ     12,,PR1
        23 006407   200012 756100                    STQ     KEY$,,AUTO

     1323    19563
     1324    19564    2        IF KEY$ = ADDR(NIL) THEN

  19564 23 006410   000000 116000 24                 CMPQ    0
        23 006411   006413 601000 23                 TNZ     s:19567

     1325    19565    2          RETURN; /* No RELATIVE KEY, org is sequential */

  19565 23 006412   000001 702211                    TSX2  ! 1,X1

     1326    19566
     1327    19567    2        CALL Z8CO$QUALIFY_VARIABLE (KEY$, ST$$);

  19567 23 006413   200010 631500                    EPPR1   ST$$,,AUTO
        23 006414   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006415   200012 633500                    EPPR3   KEY$,,AUTO
        23 006416   200050 453500                    STP3    SON_FD$$+2,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:231  
        23 006417   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006420   000011 631400 24                 EPPR1   9
        23 006421   000000 701000 xent               TSX1    Z8CO$QUALIFY_VARIABLE
        23 006422   000000 011000                    NOP     0

     1328    19568
     1329    19569             %INIT_LX_ETT_ITEM (@POINTER = "ADDR(ETT_ITEM)",
     1330    19570                                @ETT$    = ST$$,
     1331    19571                                @LINE    = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1332    19572                                @COLUMN  = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN,
     1333    19573                                @TYPE    = ST$$ -> ST.TYPE);

  19575 23 006423   000004 220003                    LDX0    4,DU
        23 006424   200014 740100                    STX0    ETT_ITEM,,AUTO

  19576 23 006425   000000 221003                    LDX1    0,DU
        23 006426   200014 441100                    SXL1    ETT_ITEM,,AUTO

  19577 23 006427   200010 470500                    LDP0    ST$$,,AUTO
        23 006430   000002 236100                    LDQ     2,,PR0
        23 006431   000022 772000                    QRL     18
        23 006432   200020 756100                    STQ     @KEY$,,AUTO

  19578 23 006433   000000 236000 24                 LDQ     0
        23 006434   200023 756100                    STQ     LINE,,AUTO

  19579 23 006435   200010 236100                    LDQ     ST$$,,AUTO
        23 006436   200015 756100                    STQ     I,,AUTO

  19580 23 006437   000000 236000 24                 LDQ     0
        23 006440   200016 756100                    STQ     LINE,,AUTO

  19582 23 006441   200012 471500                    LDP1    KEY$,,AUTO
        23 006442   100004 473500                    LDP3    4,,PR1
        23 006443   300005 235100                    LDA     5,,PR3
        23 006444   200021 755100                    STA     @ST$$,,AUTO

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:232  
  19583 23 006445   100004 473500                    LDP3    4,,PR1
        23 006446   300006 235100                    LDA     6,,PR3
        23 006447   200022 755100                    STA     QLT$$,,AUTO

     1334    19595
     1335    19596    2        CALL Z8CO$INTEGER_CHECK (ADDR(ETT_ITEM))

  19596 23 006450   200014 633500                    EPPR3   ETT_ITEM,,AUTO
        23 006451   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006452   200050 634500                    EPPR4   SON_FD$$+2,,AUTO
        23 006453   200051 454500                    STP4    SON_FD$$+3,,AUTO
        23 006454   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 006455   000001 631400 24                 EPPR1   1
        23 006456   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        23 006457   006461 702000 23                 TSX2    s:19599
        23 006460   006473 710000 23                 TRA     s:19605

     1336    19597    2          WHENALTRETURN
     1337    19598    3            DO;

     1338    19599    3              CALL NEW_INTEGER (ST$$);

  19599 23 006461   200010 630500                    EPPR0   ST$$,,AUTO
        23 006462   200025 450500                    STP0    QLT$$,,AUTO
        23 006463   006632 701000 23                 TSX1    NEW_INTEGER
        23 006464   000000 011000                    NOP     0

     1339    19600
     1340    19601    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;

  19601 23 006465   200010 470500                    LDP0    ST$$,,AUTO
        23 006466   000002 236100                    LDQ     2,,PR0
        23 006467   000022 772000                    QRL     18
        23 006470   200020 756100                    STQ     @KEY$,,AUTO

     1341    19602    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:233  
  19602 23 006471   200010 236100                    LDQ     ST$$,,AUTO
        23 006472   200015 756100                    STQ     I,,AUTO

     1342    19603    3            END;

     1343    19604
     1344    19605    2        CALL Z8CO$P_CHECK (ADDR(ETT_ITEM))

  19605 23 006473   200014 630500                    EPPR0   ETT_ITEM,,AUTO
        23 006474   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 006475   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 006476   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006477   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 006500   000001 631400 24                 EPPR1   1
        23 006501   000000 701000 xent               TSX1    Z8CO$P_CHECK
        23 006502   006504 702000 23                 TSX2    s:19608
        23 006503   006516 710000 23                 TRA     s:19614

     1345    19606    2          WHENALTRETURN
     1346    19607    3            DO;

     1347    19608    3              CALL NEW_INTEGER (ST$$);

  19608 23 006504   200010 630500                    EPPR0   ST$$,,AUTO
        23 006505   200025 450500                    STP0    QLT$$,,AUTO
        23 006506   006632 701000 23                 TSX1    NEW_INTEGER
        23 006507   000000 011000                    NOP     0

     1348    19609
     1349    19610    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;

  19610 23 006510   200010 470500                    LDP0    ST$$,,AUTO
        23 006511   000002 236100                    LDQ     2,,PR0
        23 006512   000022 772000                    QRL     18
        23 006513   200020 756100                    STQ     @KEY$,,AUTO

     1350    19611    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:234  

  19611 23 006514   200010 236100                    LDQ     ST$$,,AUTO
        23 006515   200015 756100                    STQ     I,,AUTO

     1351    19612    3            END;

     1352    19613
     1353    19614    2        CALL Z8CO$UNSIGNED_CHECK (ADDR(ETT_ITEM))

  19614 23 006516   200014 630500                    EPPR0   ETT_ITEM,,AUTO
        23 006517   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 006520   200050 631500                    EPPR1   SON_FD$$+2,,AUTO
        23 006521   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006522   200051 630500                    EPPR0   SON_FD$$+3,,AUTO
        23 006523   000001 631400 24                 EPPR1   1
        23 006524   000000 701000 xent               TSX1    Z8CO$UNSIGNED_CHECK
        23 006525   006527 702000 23                 TSX2    s:19617
        23 006526   006541 710000 23                 TRA     s:19623

     1354    19615    2          WHENALTRETURN
     1355    19616    3            DO;

     1356    19617    3              CALL NEW_INTEGER (ST$$);

  19617 23 006527   200010 630500                    EPPR0   ST$$,,AUTO
        23 006530   200025 450500                    STP0    QLT$$,,AUTO
        23 006531   006632 701000 23                 TSX1    NEW_INTEGER
        23 006532   000000 011000                    NOP     0

     1357    19618
     1358    19619    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;

  19619 23 006533   200010 470500                    LDP0    ST$$,,AUTO
        23 006534   000002 236100                    LDQ     2,,PR0
        23 006535   000022 772000                    QRL     18
        23 006536   200020 756100                    STQ     @KEY$,,AUTO

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:235  
     1359    19620    3              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;

  19620 23 006537   200010 236100                    LDQ     ST$$,,AUTO
        23 006540   200015 756100                    STQ     I,,AUTO

     1360    19621    3            END;

     1361    19622
     1362    19623    2        QLT$$ = ST$$ -> SCALAR.QLT$;

  19623 23 006541   200010 470500                    LDP0    ST$$,,AUTO
        23 006542   000007 236100                    LDQ     7,,PR0
        23 006543   200011 756100                    STQ     QLT$$,,AUTO

     1363    19624
     1364    19625    2   SEARCH_FOR_FD:
     1365    19626    3        DO WHILE (QLT$$ ~= ADDR(NIL));

  19626 23 006544   006612 710000 23    SEARCH_FOR_* TRA     s:19671

     1366    19627    3          IF QLT$$ -> QLT.ST$ = LTS$$ -> FILE_LTS.ST$ THEN

  19627 23 006545   200007 470500                    LDP0    @LTS$$,,AUTO
        23 006546   000000 471500                    LDP1    0,,PR0
        23 006547   200011 473500                    LDP3    QLT$$,,AUTO
        23 006550   300004 236100                    LDQ     4,,PR3
        23 006551   100001 116100                    CMPQ    1,,PR1
        23 006552   006610 601000 23                 TNZ     s:19670

     1367    19628    4            DO;

     1368    19629                   %CONDITIONAL_ERROR (@LX_ITEM$ = KEY$,
     1369    19630                      @ERROR# = %E$REL_KEY_IN_FD,
     1370    19631                      @LINE   = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.LINE,
     1371    19632                      @COLUMN = KEY$ -> LX_LIST.HEAD$ -> LX_ITEM.COLUMN);

  19642 23 006553   200012 474500                    LDP4    KEY$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:236  
        23 006554   400000 236100                    LDQ     0,,PR4
        23 006555   400000 316007                    CANQ    -131072,DL
        23 006556   006575 601000 23                 TNZ     s:19663

  19644 23 006557   400004 475500                    LDP5    4,,PR4
        23 006560   500006 636500                    EPPR6   6,,PR5
        23 006561   200052 456500                    STP6    SON_FD$$+4,,AUTO
        23 006562   500005 631500                    EPPR1   5,,PR5
        23 006563   200051 451500                    STP1    SON_FD$$+3,,AUTO
        23 006564   000075 236000 24                 LDQ     61
        23 006565   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 006566   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006567   000006 631400 24                 EPPR1   6
        23 006570   000000 701000 xent               TSX1    Z8AE$ERROR
        23 006571   000000 011000                    NOP     0

  19653 23 006572   200012 470500                    LDP0    KEY$,,AUTO
        23 006573   400000 236007                    LDQ     -131072,DL
        23 006574   000000 256100                    ORSQ    0,,PR0

     1372    19662
     1373    19663    4              CALL NEW_INTEGER (ST$$);

  19663 23 006575   200010 630500                    EPPR0   ST$$,,AUTO
        23 006576   200025 450500                    STP0    QLT$$,,AUTO
        23 006577   006632 701000 23                 TSX1    NEW_INTEGER
        23 006600   000000 011000                    NOP     0

     1374    19664
     1375    19665    4              ADDR(ETT_ITEM) -> LX_ETT_ITEM.TYPE = ST$$ -> ST.TYPE;

  19665 23 006601   200010 470500                    LDP0    ST$$,,AUTO
        23 006602   000002 236100                    LDQ     2,,PR0
        23 006603   000022 772000                    QRL     18
        23 006604   200020 756100                    STQ     @KEY$,,AUTO

     1376    19666    4              ADDR(ETT_ITEM) -> LX_ETT_ITEM.ETT$ = ST$$;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:237  

  19666 23 006605   200010 236100                    LDQ     ST$$,,AUTO
        23 006606   200015 756100                    STQ     I,,AUTO

     1377    19667    4              EXIT SEARCH_FOR_FD;

  19667 23 006607   006614 710000 23                 TRA     s:19673

     1378    19668    4            END;
     1379    19669
     1380    19670    3          QLT$$ = QLT$$ -> QLT.FATHER;

  19670 23 006610   300001 236100                    LDQ     1,,PR3
        23 006611   200011 756100                    STQ     QLT$$,,AUTO

     1381    19671    3        END;

  19671 23 006612   000000 116000 24                 CMPQ    0
        23 006613   006545 601000 23                 TNZ     s:19627

     1382    19672
     1383    19673    2        CALL Z8ED$DISPOSE_ABSSYN_TREE (LTS$$ -> FILE_LTS.RELATIVE_KEY$);

  19673 23 006614   200007 470500                    LDP0    @LTS$$,,AUTO
        23 006615   000000 471500                    LDP1    0,,PR0
        23 006616   100014 633500                    EPPR3   12,,PR1
        23 006617   200050 453500                    STP3    SON_FD$$+2,,AUTO
        23 006620   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006621   000001 631400 24                 EPPR1   1
        23 006622   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        23 006623   000000 011000                    NOP     0

     1384    19674
     1385    19675    2        LTS$$ -> FILE_LTS.RELATIVE_KEY$ = ST$$;

  19675 23 006624   200007 470500                    LDP0    @LTS$$,,AUTO
        23 006625   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:238  
        23 006626   200010 236100                    LDQ     ST$$,,AUTO
        23 006627   100014 756100                    STQ     12,,PR1

     1386    19676
     1387    19677    2   END RELATIVE_KEY;

  19677 23 006630   200006 221300                    LDX1  ! ST$$,,AUTO
        23 006631   000001 702211                    TSX2  ! 1,X1

     1388    19678        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:239  
     1389    19679    1   NEW_INTEGER: PROC (RETURN$);

  19679 23 006632   200024 741300       NEW_INTEGER  STX1  ! COLUMN,,AUTO

     1390    19680
     1391    19681    2        DCL RETURN$       PTR;
     1392    19682
     1393    19683
     1394    19684    2        CALL Z8AT$CREATE_TEMPORARY (%SCALAR, RETURN$);

  19684 23 006633   200025 236100                    LDQ     @RETURN$,,AUTO
        23 006634   000024 235000 24                 LDA     20
        23 006635   200050 757100                    STAQ    SON_FD$$+2,,AUTO
        23 006636   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 006637   000011 631400 24                 EPPR1   9
        23 006640   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        23 006641   000000 011000                    NOP     0

     1395    19685
     1396    19686    2        RETURN$ -> ST.TYPE = %TYI;

  19686 23 006642   200025 470500                    LDP0    @RETURN$,,AUTO
        23 006643   000000 471500                    LDP1    0,,PR0
        23 006644   000001 220003                    LDX0    1,DU
        23 006645   100002 740100                    STX0    2,,PR1

     1397    19687    2        RETURN$ -> SCALAR.B.CLASS = %CLASS_NUMERIC;

  19687 23 006646   000000 471500                    LDP1    0,,PR0
        23 006647   100003 236100                    LDQ     3,,PR1
        23 006650   000025 376000 24                 ANQ     21
        23 006651   000001 276007                    ORQ     1,DL
        23 006652   100003 756100                    STQ     3,,PR1

     1398    19688    2        RETURN$ -> ST.NDSC.N = %TYI_LENGTH;

  19688 23 006653   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:240  
        23 006654   000004 236007                    LDQ     4,DL
        23 006655   100001 752101                    STCQ    1,'01'O,PR1

     1399    19689
     1400    19690    2   END NEW_INTEGER;

  19690 23 006656   200024 221300                    LDX1  ! COLUMN,,AUTO
        23 006657   000001 702211                    TSX2  ! 1,X1

     1401    19691        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:241  
     1402    19692    1   CHECK_FOR_FD: PROC (LTS$$);

  19692 23 006660   200004 741300       CHECK_FOR_FD STX1  ! LTS$$+1,,AUTO

     1403    19693
     1404    19694    2        DCL LTS$$         PTR;
     1405    19695
     1406    19696
     1407    19697
     1408    19698    2        IF LTS$$ -> FILE_LTS.ST$ -> FD.QLT$ ->

  19698 23 006661   200005 470500                    LDP0    @LTS$$,,AUTO
        23 006662   000000 471500                    LDP1    0,,PR0
        23 006663   100001 473500                    LDP3    1,,PR1
        23 006664   300007 474500                    LDP4    7,,PR3
        23 006665   400003 475500                    LDP5    3,,PR4
        23 006666   500002 236100                    LDQ     2,,PR5
        23 006667   000000 116000 24                 CMPQ    0
        23 006670   006736 601000 23                 TNZ     s:19717

     1409    19699    2           QLT.SON -> QLT.BROTHER = ADDR(NIL) THEN
     1410    19700    2          IF LTS$$ -> FILE_LTS.REPORT$ = ADDR(NIL) THEN

  19700 23 006671   100040 236100                    LDQ     32,,PR1
        23 006672   000000 116000 24                 CMPQ    0
        23 006673   006736 601000 23                 TNZ     s:19717

     1411    19701    3          DO;

     1412    19702                   /* No FD was specified -- error */
     1413    19703    3              IF NOT LTS$$ -> FILE_LTS.ST$ -> FD.DNT$ -> DNT.B.ERROR_VARIABLE THEN

  19703 23 006674   300006 476500                    LDP6    6,,PR3
        23 006675   600003 236100                    LDQ     3,,PR6
        23 006676   000100 316003                    CANQ    64,DU
        23 006677   006717 601000 23                 TNZ     s:19708

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:242  
     1414    19704    3              CALL Z8AE$ERROR (%E$NO_FD_SPECIFIED,

  19704 23 006700   300002 236100                    LDQ     2,,PR3
        23 006701   777777 376007                    ANQ     -1,DL
        23 006702   200050 756100                    STQ     SON_FD$$+2,,AUTO
        23 006703   300006 631500                    EPPR1   6,,PR3
        23 006704   200055 451500                    STP1    SON_FD$$+7,,AUTO
        23 006705   000050 236000 24                 LDQ     40
        23 006706   200054 756100                    STQ     SON_FD$$+6,,AUTO
        23 006707   200050 633500                    EPPR3   SON_FD$$+2,,AUTO
        23 006710   200053 453500                    STP3    SON_FD$$+5,,AUTO
        23 006711   000077 236000 24                 LDQ     63
        23 006712   200052 756100                    STQ     SON_FD$$+4,,AUTO
        23 006713   200052 630500                    EPPR0   SON_FD$$+4,,AUTO
        23 006714   000002 631400 24                 EPPR1   2
        23 006715   000000 701000 xent               TSX1    Z8AE$ERROR
        23 006716   000000 011000                    NOP     0

     1415    19705    3                               BINBIT(LTS$$ -> FILE_LTS.ST$ -> ST.LINE_NO,36),
     1416    19706    3                               0, LTS$$ -> FILE_LTS.ST$ -> ST.DNT$);
     1417    19707
     1418    19708    3              LTS$$ -> FILE_LTS.ST$ -> ST.ADSC.N = 80;

  19708 23 006717   200005 470500                    LDP0    @LTS$$,,AUTO
        23 006720   000000 471500                    LDP1    0,,PR0
        23 006721   100001 473500                    LDP3    1,,PR1
        23 006722   000120 236007                    LDQ     80,DL
        23 006723   300001 752103                    STCQ    1,'03'O,PR3

     1419    19709
     1420    19710    3              IF LTS$$ -> FILE_LTS.ORGANIZATION = %NOT_SPECIFIED THEN

  19710 23 006724   000000 471500                    LDP1    0,,PR0
        23 006725   100006 235100                    LDA     6,,PR1
        23 006726   006731 601000 23                 TNZ     s:19713

     1421    19711    3                LTS$$ -> FILE_LTS.ORGANIZATION = %SEQUENTIAL;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:243  

  19711 23 006727   000001 235007                    LDA     1,DL
        23 006730   100006 755100                    STA     6,,PR1

     1422    19712
     1423    19713    3              IF LTS$$ -> FILE_LTS.ACCESS_MODE = %NOT_SPECIFIED THEN

  19713 23 006731   000000 471500                    LDP1    0,,PR0
        23 006732   100011 235100                    LDA     9,,PR1
        23 006733   006736 601000 23                 TNZ     s:19717

     1424    19714    3                LTS$$ -> FILE_LTS.ACCESS_MODE = %SEQUENTIAL_ACCESS;

  19714 23 006734   000001 235007                    LDA     1,DL
        23 006735   100011 755100                    STA     9,,PR1

     1425    19715    3            END;

     1426    19716
     1427    19717    2   END CHECK_FOR_FD;

  19717 23 006736   200004 221300                    LDX1  ! LTS$$+1,,AUTO
        23 006737   000001 702211                    TSX2  ! 1,X1

     1428    19718        %EJECT;
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:244  
     1429    19719
     1430    19720
     1431    19721    1        LTS$$ = COMCOM.FILE_LTS_CHAIN$;

  19721 23 006740   000434 236000 xsym               LDQ     COMCOM+284
        23 006741   200003 756100                    STQ     LTS$$,,AUTO

     1432    19722
     1433    19723    2        DO WHILE (LTS$$ ~= ADDR(NIL));

  19723 23 006742   007050 710000 23                 TRA     s:19778

     1434    19724    2          O1COM.CURRENT_FILE_LTS$ = LTS$$;

  19724 23 006743   200003 236100                    LDQ     LTS$$,,AUTO
        23 006744   000045 756000 xsym               STQ     O1COM+37

     1435    19725
     1436    19726    2          IF LTS$$ -> FILE_LTS.ST$ -> FD.PROC$ = O1COM.CURRENT_PROC$ THEN

  19726 23 006745   200003 470500                    LDP0    LTS$$,,AUTO
        23 006746   000001 471500                    LDP1    1,,PR0
        23 006747   100011 236100                    LDQ     9,,PR1
        23 006750   000057 116000 xsym               CMPQ    O1COM+47
        23 006751   007045 601000 23                 TNZ     s:19776

     1437    19727    3            DO;

     1438    19728    3              CALL CHECK_FOR_FD (LTS$$);

  19728 23 006752   200003 633500                    EPPR3   LTS$$,,AUTO
        23 006753   200005 453500                    STP3    LTS$$+2,,AUTO
        23 006754   006660 701000 23                 TSX1    CHECK_FOR_FD
        23 006755   000000 011000                    NOP     0

     1439    19729
     1440    19730    4              DO CASE (LTS$$ -> FILE_LTS.ORGANIZATION);
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:245  

  19730 23 006756   200003 470500                    LDP0    LTS$$,,AUTO
        23 006757   000006 235100                    LDA     6,,PR0
        23 006760   000024 115007                    CMPA    20,DL
        23 006761   006763 602005 23                 TNC     s:19730+5,AL
        23 006762   007033 710000 23                 TRA     s:19768
        23 006763   007033 710000 23                 TRA     s:19768
        23 006764   007007 710000 23                 TRA     s:19742
        23 006765   007014 710000 23                 TRA     s:19750
        23 006766   007021 710000 23                 TRA     s:19758
        23 006767   007026 710000 23                 TRA     s:19765
        23 006770   007007 710000 23                 TRA     s:19742
        23 006771   007007 710000 23                 TRA     s:19742
        23 006772   007007 710000 23                 TRA     s:19742
        23 006773   007007 710000 23                 TRA     s:19742
        23 006774   007007 710000 23                 TRA     s:19742
        23 006775   007014 710000 23                 TRA     s:19750
        23 006776   007021 710000 23                 TRA     s:19758
        23 006777   007007 710000 23                 TRA     s:19742
        23 007000   007007 710000 23                 TRA     s:19742
        23 007001   007021 710000 23                 TRA     s:19758
        23 007002   007007 710000 23                 TRA     s:19742
        23 007003   007007 710000 23                 TRA     s:19742
        23 007004   007014 710000 23                 TRA     s:19750
        23 007005   007007 710000 23                 TRA     s:19742
        23 007006   007021 710000 23                 TRA     s:19758

     1441    19731
     1442    19732    4                CASE (

     1443    19733                           %SET_OF_SEQUENTIAL_ORGANIZATION;
     1444    19741    4                     );
     1445    19742    4                  CALL SEQ_ORG (LTS$$);

  19742 23 007007   200003 631500                    EPPR1   LTS$$,,AUTO
        23 007010   200005 451500                    STP1    LTS$$+2,,AUTO
        23 007011   000003 701000 23                 TSX1    SEQ_ORG
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:246  
        23 007012   000000 011000                    NOP     0
        23 007013   007037 710000 23                 TRA     s:19772

     1446    19743
     1447    19744    4                CASE (

     1448    19745                           %SET_OF_RELATIVE_ORGANIZATION;
     1449    19749    4                     );
     1450    19750    4                  CALL REL_ORG (LTS$$);

  19750 23 007014   200003 631500                    EPPR1   LTS$$,,AUTO
        23 007015   200005 451500                    STP1    LTS$$+2,,AUTO
        23 007016   006341 701000 23                 TSX1    REL_ORG
        23 007017   000000 011000                    NOP     0
        23 007020   007037 710000 23                 TRA     s:19772

     1451    19751
     1452    19752    4                CASE (

     1453    19753                           %SET_OF_INDEXED_ORGANIZATION;
     1454    19757    4                     );
     1455    19758    4                  CALL IND_ORG (LTS$$);

  19758 23 007021   200003 631500                    EPPR1   LTS$$,,AUTO
        23 007022   200005 451500                    STP1    LTS$$+2,,AUTO
        23 007023   005451 701000 23                 TSX1    IND_ORG
        23 007024   000000 011000                    NOP     0
        23 007025   007037 710000 23                 TRA     s:19772

     1456    19759
     1457    19760    4                CASE (

     1458    19761                           %SET_OF_KEYED_ORGANIZATION;
     1459    19764    4                     );
     1460    19765    4                  CALL KEY_ORG (LTS$$);

  19765 23 007026   200003 631500                    EPPR1   LTS$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:247  
        23 007027   200005 451500                    STP1    LTS$$+2,,AUTO
        23 007030   005362 701000 23                 TSX1    KEY_ORG
        23 007031   000000 011000                    NOP     0
        23 007032   007037 710000 23                 TRA     s:19772

     1461    19766
     1462    19767    4                CASE (ELSE);

     1463    19768    4                  CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  19768 23 007033   000013 630400 24                 EPPR0   11
        23 007034   000001 631400 24                 EPPR1   1
        23 007035   000000 701000 xent               TSX1    Z8AE$ERROR
        23 007036   000000 011000                    NOP     0

     1464    19769
     1465    19770    4              END;

     1466    19771
     1467    19772    3              CALL Z9DI$FAB_FIB_BUILD( LTS$$ );

  19772 23 007037   200003 630500                    EPPR0   LTS$$,,AUTO
        23 007040   200050 450500                    STP0    SON_FD$$+2,,AUTO
        23 007041   200050 630500                    EPPR0   SON_FD$$+2,,AUTO
        23 007042   000001 631400 24                 EPPR1   1
        23 007043   000000 701000 xent               TSX1    Z9DI$FAB_FIB_BUILD
        23 007044   000000 011000                    NOP     0

     1468    19773
     1469    19774    3          END; /* If */

     1470    19775
     1471    19776    2          LTS$$ = LTS$$ -> FILE_LTS.FILE_LTS_CHAIN$;

  19776 23 007045   200003 470500                    LDP0    LTS$$,,AUTO
        23 007046   000003 236100                    LDQ     3,,PR0
        23 007047   200003 756100                    STQ     LTS$$,,AUTO
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:248  

     1472    19777
     1473    19778    2        END; /* While */

  19778 23 007050   000000 116000 24                 CMPQ    0
        23 007051   006743 601000 23                 TNZ     s:19724

     1474    19779
     1475    19780    1        O1COM.CURRENT_FILE_LTS$ = ADDR(NIL);

  19780 23 007052   000000 236000 24                 LDQ     0
        23 007053   000045 756000 xsym               STQ     O1COM+37

     1476    19781
     1477    19782    1   END Z8DI$IO_WRAPUP; /* Proc */

  19782 23 007054   000000 702200 xent               TSX2  ! X66_ARET
     1478    19783        %EOD;

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:249  
--  Include file information  --

   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_IO_EQUS.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DI$IO_WRAPUP.
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:250  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:251  
  ****  Section 005 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 006 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 007 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 008 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 009 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 010 LblCom ETT_

PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:252  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 011 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 012 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 013 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 014 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 015 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:253  

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 016 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 017 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 018 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 019 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 020 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:254  

  ****  Section 021 LblCom TEMP_LX_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)         1 TEMP_LX_NODE

  ****  Section 022 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    42-0-0/w PTR         r     1 @COLUMN#                  43-0-0/w PTR         r     1 @DN$
    44-0-0/w PTR         r     1 @FD$$                     22-0-0/w PTR         r     1 @FORMAT
    20-0-0/w PTR         r     1 @FORMAT                   13-0-0/w PTR         r     1 @ID$
    40-0-0/w PTR         r     1 @ITEM$                    23-0-0/w PTR         r     1 @ITEM$
    20-0-0/w PTR         r     1 @KEY$                     34-0-0/w PTR         r     1 @LEN
     6-0-0/w PTR         r     1 @LENGTH                   41-0-0/w PTR         r     1 @LINE#
     5-0-0/w PTR         r     1 @LTS$$                    11-0-0/w PTR         r     1 @LTS$$
    11-0-0/w PTR         r     1 @LTS$$                    11-0-0/w PTR         r     1 @LTS$$
    11-0-0/w PTR         r     1 @LTS$$                    11-0-0/w PTR         r     1 @LTS$$
    11-0-0/w PTR         r     1 @LTS$$                    17-0-0/w PTR         r     1 @LTS$$
    17-0-0/w PTR         r     1 @LTS$$                    37-0-0/w PTR         r     1 @LTS$$
     5-0-0/w PTR         r     1 @LTS$$                     5-0-0/w PTR         r     1 @LTS$$
    17-0-0/w PTR         r     1 @LTS$$                    11-0-0/w PTR         r     1 @LTS$$
    11-0-0/w PTR         r     1 @LTS$$                    11-0-0/w PTR         r     1 @LTS$$
     5-0-0/w PTR         r     1 @LTS$$                     7-0-0/w PTR         r     1 @LTS$$
     5-0-0/w PTR         r     1 @LTS$$                    21-0-0/w PTR         r     1 @MAX
    20-0-0/w PTR         r     1 @MIN                      25-0-0/w PTR         r     1 @RETURN$
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:255  
    17-0-0/w PTR         r     1 @ST$$                     37-0-0/w PTR         r     1 @ST$$
    24-0-0/w PTR         r     1 @ST$$                      5-0-0/w PTR         r     1 @ST$$
    33-0-0/w PTR         r     1 @ST$$                     21-0-0/w PTR         r     1 @ST$$
    14-0-0/w PTR         r     1 ALT_KEY$                  15-0-0/w PTR         r     1 BOTTOM$
    12-0-0/w PTR         r     1 CAT$                      16-0-0/w SBIN        r     1 COLUMN
    17-0-0/w SBIN        r     1 COLUMN                    14-0-0/w SBIN        r     1 COLUMN
    17-0-0/w SBIN              1 COLUMN                    24-0-0/w SBIN        r     1 COLUMN
    14-0-0/w SBIN        r     1 COLUMN                    16-0-0/w SBIN        r     1 COLUMN#
    *0-0-0/w SBIN        r     1 COLUMN#                    7-0-0/w PTR               1 DCB_NUM$
    22-0-0/w PTR         r     1 DEPEND$                   31-0-0/w PTR         r     1 DEP_SIZE$
    10-0-0/w STRC        r     1 DESC                      *0-0-0/w PTR         r     1 DN$
    20-0-0/d STRC(288)   r     1 ETT_ITEM                  26-0-0/d STRC(288)   r     1 ETT_ITEM
    26-0-0/d STRC(288)   r     1 ETT_ITEM                  14-0-0/d STRC(288)   r     1 ETT_ITEM
    14-0-0/w PTR               1 FATHER$                   43-0-0/w PTR         r     1 FATHER$
    *0-0-0/w PTR         r     1 FD$$                      13-0-0/w PTR         r     1 FOOT$
    14-0-0/w SBIN        r     1 FORMAT                    *0-0-0/w SBIN        r     1 FORMAT
    *0-0-0/w SBIN        r     1 FORMAT                    15-0-0/w SBIN        r     1 I
    *0-0-0/w PTR         r     1 ID$                       12-0-0/w SBIN        r     1 INT1
    13-0-0/w SBIN        r     1 INT2                      26-0-0/w SBIN        r     1 INT_1
    27-0-0/w SBIN        r     1 INT_2                     12-0-0/w PTR         r     1 IO_STAT$
    *0-0-0/w PTR         r     1 ITEM$                     *0-0-0/w PTR         r     1 ITEM$
    14-0-0/w PTR         r     1 ITEM_ST$                  *0-0-0/w PTR         r     1 KEY$
    13-0-0/w PTR         r     1 KEY$                      12-0-0/w PTR         r     1 KEY$
    *0-0-0/w SBIN        r     1 LEN                       23-0-0/w SBIN        r     1 LEN
    16-0-0/w SBIN        r     1 LENGTH                    *0-0-0/w SBIN        r     1 LENGTH
    15-0-0/w SBIN        r     1 LINE                      15-0-0/w SBIN        r     1 LINE
    13-0-0/w SBIN        r     1 LINE                      16-0-0/w SBIN              1 LINE
    23-0-0/w SBIN        r     1 LINE                      13-0-0/w SBIN        r     1 LINE
    15-0-0/w SBIN        r     1 LINE#                     *0-0-0/w SBIN        r     1 LINE#
    12-0-0/w PTR         r     1 LINES$                    12-0-0/w PTR         r     1 LIST$
     7-0-0/w PTR         r     1 LONG$$                     3-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:256  
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w PTR         r     1 LTS$$
    *0-0-0/w PTR         r     1 LTS$$                     *0-0-0/w SBIN        r     1 MAX
    *0-0-0/w SBIN        r     1 MIN                       30-0-0/w SBIN        r     1 OCCURS_MIN
     6-0-0/w PTR         r     1 P$                        13-0-0/w PTR         r     1 PAD_CHAR$
    12-0-0/w PTR         r     1 PAD_ST$                   25-0-0/w PTR         r     1 QLT$$
    22-0-0/w PTR         r     1 QLT$$                     11-0-0/w PTR         r     1 QLT$$
    12-0-0/w PTR         r     1 RET$                      *0-0-0/w PTR         r     1 RETURN$
    13-0-0/w PTR         r     1 RETURN_ETT$               14-0-0/w PTR         r     1 RET_ST$
    46-0-0/w PTR         r     1 SON_FD$$                  *0-0-0/w PTR         r     1 ST$$
    *0-0-0/w PTR         r     1 ST$$                      20-0-0/w PTR         r     1 ST$$
    *0-0-0/w PTR         r     1 ST$$                      *0-0-0/w PTR         r     1 ST$$
    *0-0-0/w PTR         r     1 ST$$                      24-0-0/w PTR         r     1 ST$$
    21-0-0/w PTR         r     1 ST$$                      40-0-0/w PTR         r     1 ST$$
     6-0-0/w PTR         r     1 ST$$                       6-0-0/w PTR         r     1 ST$$
    *0-0-0/w PTR         r     1 ST$$                      12-0-0/w PTR         r     1 ST$$
    10-0-0/w PTR         r     1 ST$$                      45-0-0/w PTR         r     1 TEMP$
    14-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w PTR         r     1 DNT$_FROM_RSWNO(0:0)
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:257  

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)  r     1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)   r     1 DEPENDING_SIZE
     0-0-0/w STRC(5472)  r     1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)   r     1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(72)    r     1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(396)         1 MNEMONIC
PL6.E3A0      #001=Z8DI$IO_WRAPUP File=Z8DI.:Z8A6TSI                             SAT 08/09/97 11:07 Page:258  
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8DI$IO_WRAPUP requires 3629 words for executable code.
   Procedure Z8DI$IO_WRAPUP requires 46 words of local(AUTO) storage.

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:259  
     1479        1        /*T***********************************************************/
     1480        2        /*T*                                                         */
     1481        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1482        4        /*T*                                                         */
     1483        5        /*T***********************************************************/
     1484        6        /*=============*/
     1485        7          Z8DI$CHECK_CODE_SET : PROC (QLT$$);
     1486        8        /*=============*/
     1487        9
     1488       10         /*P*
     1489       11             NAME : Z8DI$CHECK_CODE_SET
     1490       12             PURPOSE : To verify all the subordinates of a %FD st item are
     1491       13               DISPLAY and sign separate.
     1492       14         */
     1493       15
     1494       16             %EQU PHASE = 1;
     1495       17
     1496       18             %INCLUDE Z8A_DEFC;
     1497       86             %INCLUDE Z8A_SUPP_MAC;
     1498     2486             %INCLUDE Z8A_COMCOM;
     1499     3136             %INCLUDE Z8A_QLT;
     1500     3242             %INCLUDE Z8A_LTS;
     1501     5319             %INCLUDE Z8A_ST;
     1502     8978             %INCLUDE Z8A_TYPES;
     1503     9152             %INCLUDE Z8A_ERR_NUMS;
     1504     9916
     1505     9917             %INCLUDE Z8E_STACKS;
     1506    12183             %INCLUDE Z8E_O1COM;
     1507    12944             %INCLUDE Z8E_MACROS;
     1508    13619
     1509    13620
     1510    13621    1        DCL Z8AU$TYPE_DESCRIPTOR ENTRY (2);
     1511    13622    1        DCL Z8AE$ERROR           ENTRY (12);
     1512    13623
     1513    13624    1        DCL QLT$$                PTR; /* IN -- Ptr to top of tree to
     1514    13625                                                    QLT to traverse.     */
     1515    13626    1        DCL 1 TYPE_DESC          ALIGNED,
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:260  
     1516    13627                  %TYPE_DESC;
     1517    13661
     1518    13662
     1519    13663    1        IF NOT QLT$$ -> QLT.B.RENAMES
     1520    13664    1        AND QLT$$ -> QLT.SON ~= ADDR(NIL) THEN
     1521    13665    1          CALL Z8DI$CHECK_CODE_SET (QLT$$ -> QLT.SON);
     1522    13666
     1523    13667    1        IF QLT$$ -> QLT.BROTHER ~= ADDR(NIL) THEN
     1524    13668    1          CALL Z8DI$CHECK_CODE_SET (QLT$$ -> QLT.BROTHER);
     1525    13669
     1526    13670    1        IF O1COM.CURRENT_FILE_LTS$ -> FILE_LTS.LINAGE_COUNTER$
     1527    13671    1           = QLT$$ -> QLT.ST$ THEN
     1528    13672    1          RETURN;
     1529    13673
     1530    13674    1        CALL Z8AU$TYPE_DESCRIPTOR (QLT$$ -> QLT.ST$, TYPE_DESC);
     1531    13675
     1532    13676    2        DO CASE (TYPE_DESC.TYPE);
     1533    13677    2          CASE (%TYA, %TYE, %TYB);
     1534    13678                 /* All ok */
     1535    13679
     1536    13680    2          CASE (%TYD, %TYF, %TYC);
     1537    13681    2            IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 THEN
     1538    13682    2              CALL Z8AE$ERROR (%E$NOT_DISPLAY_SEPARATE_SIGN,
     1539    13683    2                               BINBIT (QLT$$ -> QLT.ST$ -> ST.LINE_NO, 36),
     1540    13684    2                               0);
     1541    13685
     1542    13686    2          CASE (ELSE);
     1543    13687    2            CALL Z8AE$ERROR (%E$NOT_DISPLAY_SEPARATE_SIGN,
     1544    13688    2                             BINBIT (QLT$$ -> QLT.ST$ -> ST.LINE_NO,36),
     1545    13689    2                             0);
     1546    13690    2        END; /* Case */
     1547    13691
     1548    13692    1   END Z8DI$CHECK_CODE_SET;

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:261  
--  Include file information  --

   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DI$CHECK_CODE_SET.

   Procedure Z8DI$CHECK_CODE_SET requires 103 words for executable code.
   Procedure Z8DI$CHECK_CODE_SET requires 14 words of local(AUTO) storage.

    No errors detected in file Z8DI.:Z8A6TSI    .

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:262  

 Object Unit name= Z8DI$CHECK_CODE_SET                        File name= Z8DI.:Z8A6TOU
 UTS= AUG 09 '97 11:15:47.64 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  QLT$
    2  LblCom even  none     1      1  PREV_01_QLT$
    3  LblCom even  none     5      5  QLT_
    4  LblCom even  none     1      1  LTS$
    5  LblCom even  none     5      5  LTS_
    6  LblCom even  none     1      1  ST$
    7  LblCom even  none     5      5  ST_
    8  LblCom even  none    90    132  LEX_SYMBOL
    9  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   10  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   11  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   12   Proc  even  none   103    147  Z8DI$CHECK_CODE_SET
   13  RoData even  none     8     10  Z8DI$CHECK_CODE_SET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        1  Z8DI$CHECK_CODE_SET
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:263  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:264  


     1479        1        /*T***********************************************************/
     1480        2        /*T*                                                         */
     1481        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1482        4        /*T*                                                         */
     1483        5        /*T***********************************************************/
     1484        6        /*=============*/
     1485        7          Z8DI$CHECK_CODE_SET : PROC (QLT$$);

      7 12 000000   000000 700200 xent  Z8DI$CHECK_* TSX0  ! X66_AUTO_1
        12 000001   000016 000001                    ZERO    14,1

     1486        8        /*=============*/
     1487        9
     1488       10         /*P*
     1489       11             NAME : Z8DI$CHECK_CODE_SET
     1490       12             PURPOSE : To verify all the subordinates of a %FD st item are
     1491       13               DISPLAY and sign separate.
     1492       14         */
     1493       15
     1494       16             %EQU PHASE = 1;
     1495       17
     1496       18             %INCLUDE Z8A_DEFC;
     1497       86             %INCLUDE Z8A_SUPP_MAC;
     1498     2486             %INCLUDE Z8A_COMCOM;
     1499     3136             %INCLUDE Z8A_QLT;
     1500     3242             %INCLUDE Z8A_LTS;
     1501     5319             %INCLUDE Z8A_ST;
     1502     8978             %INCLUDE Z8A_TYPES;
     1503     9152             %INCLUDE Z8A_ERR_NUMS;
     1504     9916
     1505     9917             %INCLUDE Z8E_STACKS;
     1506    12183             %INCLUDE Z8E_O1COM;
     1507    12944             %INCLUDE Z8E_MACROS;
     1508    13619
     1509    13620
     1510    13621    1        DCL Z8AU$TYPE_DESCRIPTOR ENTRY (2);
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:265  
     1511    13622    1        DCL Z8AE$ERROR           ENTRY (12);
     1512    13623
     1513    13624    1        DCL QLT$$                PTR; /* IN -- Ptr to top of tree to
     1514    13625                                                    QLT to traverse.     */
     1515    13626    1        DCL 1 TYPE_DESC          ALIGNED,
     1516    13627                  %TYPE_DESC;
     1517    13661
     1518    13662
     1519    13663    1        IF NOT QLT$$ -> QLT.B.RENAMES

  13663 12 000002   200003 470500                    LDP0    @QLT$$,,AUTO
        12 000003   000000 471500                    LDP1    0,,PR0
        12 000004   100000 236100                    LDQ     0,,PR1
        12 000005   040000 316007                    CANQ    16384,DL
        12 000006   000020 601000 12                 TNZ     s:13667
        12 000007   100003 236100                    LDQ     3,,PR1
        12 000010   000000 116000 13                 CMPQ    0
        12 000011   000020 600000 12                 TZE     s:13667

     1520    13664    1        AND QLT$$ -> QLT.SON ~= ADDR(NIL) THEN
     1521    13665    1          CALL Z8DI$CHECK_CODE_SET (QLT$$ -> QLT.SON);

  13665 12 000012   100003 633500                    EPPR3   3,,PR1
        12 000013   200010 453500                    STP3    TYPE_DESC+4,,AUTO
        12 000014   200010 630500                    EPPR0   TYPE_DESC+4,,AUTO
        12 000015   000001 631400 13                 EPPR1   1
        12 000016   000000 701000 12                 TSX1    s:7
        12 000017   000000 011000                    NOP     0

     1522    13666
     1523    13667    1        IF QLT$$ -> QLT.BROTHER ~= ADDR(NIL) THEN

  13667 12 000020   200003 470500                    LDP0    @QLT$$,,AUTO
        12 000021   000000 471500                    LDP1    0,,PR0
        12 000022   100002 236100                    LDQ     2,,PR1
        12 000023   000000 116000 13                 CMPQ    0
        12 000024   000033 600000 12                 TZE     s:13670
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:266  

     1524    13668    1          CALL Z8DI$CHECK_CODE_SET (QLT$$ -> QLT.BROTHER);

  13668 12 000025   100002 633500                    EPPR3   2,,PR1
        12 000026   200010 453500                    STP3    TYPE_DESC+4,,AUTO
        12 000027   200010 630500                    EPPR0   TYPE_DESC+4,,AUTO
        12 000030   000001 631400 13                 EPPR1   1
        12 000031   000000 701000 12                 TSX1    s:7
        12 000032   000000 011000                    NOP     0

     1525    13669
     1526    13670    1        IF O1COM.CURRENT_FILE_LTS$ -> FILE_LTS.LINAGE_COUNTER$

  13670 12 000033   200003 470500                    LDP0    @QLT$$,,AUTO
        12 000034   000000 471500                    LDP1    0,,PR0
        12 000035   000045 473400 xsym               LDP3    O1COM+37
        12 000036   300054 236100                    LDQ     44,,PR3
        12 000037   100004 116100                    CMPQ    4,,PR1
        12 000040   000042 601000 12                 TNZ     s:13674

     1527    13671    1           = QLT$$ -> QLT.ST$ THEN
     1528    13672    1          RETURN;

  13672 12 000041   000000 702200 xent               TSX2  ! X66_ARET

     1529    13673
     1530    13674    1        CALL Z8AU$TYPE_DESCRIPTOR (QLT$$ -> QLT.ST$, TYPE_DESC);

  13674 12 000042   200004 634500                    EPPR4   TYPE_DESC,,AUTO
        12 000043   200011 454500                    STP4    TYPE_DESC+5,,AUTO
        12 000044   100004 635500                    EPPR5   4,,PR1
        12 000045   200010 455500                    STP5    TYPE_DESC+4,,AUTO
        12 000046   200010 630500                    EPPR0   TYPE_DESC+4,,AUTO
        12 000047   000002 631400 13                 EPPR1   2
        12 000050   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        12 000051   000000 011000                    NOP     0

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:267  
     1531    13675
     1532    13676    2        DO CASE (TYPE_DESC.TYPE);

  13676 12 000052   200004 235100                    LDA     TYPE_DESC,,AUTO
        12 000053   000024 115007                    CMPA    20,DL
        12 000054   000056 602005 12                 TNC     s:13676+4,AL
        12 000055   000126 710000 12                 TRA     s:13687
        12 000056   000102 710000 12                 TRA     s:13681
        12 000057   000126 710000 12                 TRA     s:13687
        12 000060   000126 710000 12                 TRA     s:13687
        12 000061   000126 710000 12                 TRA     s:13687
        12 000062   000126 710000 12                 TRA     s:13687
        12 000063   000126 710000 12                 TRA     s:13687
        12 000064   000146 710000 12                 TRA     s:13692
        12 000065   000126 710000 12                 TRA     s:13687
        12 000066   000146 710000 12                 TRA     s:13692
        12 000067   000126 710000 12                 TRA     s:13687
        12 000070   000126 710000 12                 TRA     s:13687
        12 000071   000102 710000 12                 TRA     s:13681
        12 000072   000146 710000 12                 TRA     s:13692
        12 000073   000126 710000 12                 TRA     s:13687
        12 000074   000126 710000 12                 TRA     s:13687
        12 000075   000126 710000 12                 TRA     s:13687
        12 000076   000126 710000 12                 TRA     s:13687
        12 000077   000126 710000 12                 TRA     s:13687
        12 000100   000126 710000 12                 TRA     s:13687
        12 000101   000102 710000 12                 TRA     s:13681

     1533    13677    2          CASE (%TYA, %TYE, %TYB);

     1534    13678                 /* All ok */
     1535    13679
     1536    13680    2          CASE (%TYD, %TYF, %TYC);

     1537    13681    2            IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 THEN

  13681 12 000102   200005 236100                    LDQ     TYPE_DESC+1,,AUTO
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:268  
        12 000103   040000 316007                    CANQ    16384,DL
        12 000104   000146 600000 12                 TZE     s:13692

     1538    13682    2              CALL Z8AE$ERROR (%E$NOT_DISPLAY_SEPARATE_SIGN,

  13682 12 000105   200003 470500                    LDP0    @QLT$$,,AUTO
        12 000106   000000 471500                    LDP1    0,,PR0
        12 000107   100004 473500                    LDP3    4,,PR1
        12 000110   300002 236100                    LDQ     2,,PR3
        12 000111   777777 376007                    ANQ     -1,DL
        12 000112   200010 756100                    STQ     TYPE_DESC+4,,AUTO
        12 000113   000006 236000 13                 LDQ     6
        12 000114   200014 756100                    STQ     TYPE_DESC+8,,AUTO
        12 000115   200010 631500                    EPPR1   TYPE_DESC+4,,AUTO
        12 000116   200013 451500                    STP1    TYPE_DESC+7,,AUTO
        12 000117   000007 236000 13                 LDQ     7
        12 000120   200012 756100                    STQ     TYPE_DESC+6,,AUTO
        12 000121   200012 630500                    EPPR0   TYPE_DESC+6,,AUTO
        12 000122   000003 631400 13                 EPPR1   3
        12 000123   000000 701000 xent               TSX1    Z8AE$ERROR
        12 000124   000000 011000                    NOP     0
        12 000125   000146 710000 12                 TRA     s:13692

     1539    13683    2                               BINBIT (QLT$$ -> QLT.ST$ -> ST.LINE_NO, 36),
     1540    13684    2                               0);
     1541    13685
     1542    13686    2          CASE (ELSE);

     1543    13687    2            CALL Z8AE$ERROR (%E$NOT_DISPLAY_SEPARATE_SIGN,

  13687 12 000126   200003 470500                    LDP0    @QLT$$,,AUTO
        12 000127   000000 471500                    LDP1    0,,PR0
        12 000130   100004 473500                    LDP3    4,,PR1
        12 000131   300002 236100                    LDQ     2,,PR3
        12 000132   777777 376007                    ANQ     -1,DL
        12 000133   200010 756100                    STQ     TYPE_DESC+4,,AUTO
        12 000134   000006 236000 13                 LDQ     6
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:269  
        12 000135   200014 756100                    STQ     TYPE_DESC+8,,AUTO
        12 000136   200010 631500                    EPPR1   TYPE_DESC+4,,AUTO
        12 000137   200013 451500                    STP1    TYPE_DESC+7,,AUTO
        12 000140   000007 236000 13                 LDQ     7
        12 000141   200012 756100                    STQ     TYPE_DESC+6,,AUTO
        12 000142   200012 630500                    EPPR0   TYPE_DESC+6,,AUTO
        12 000143   000003 631400 13                 EPPR1   3
        12 000144   000000 701000 xent               TSX1    Z8AE$ERROR
        12 000145   000000 011000                    NOP     0

     1544    13688    2                             BINBIT (QLT$$ -> QLT.ST$ -> ST.LINE_NO,36),
     1545    13689    2                             0);
     1546    13690    2        END; /* Case */

     1547    13691
     1548    13692    1   END Z8DI$CHECK_CODE_SET;

  13692 12 000146   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:270  
--  Include file information  --

   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8DI$CHECK_CODE_SET.
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:271  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 002 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 003 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 004 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:272  
  ****  Section 005 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 006 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 007 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 008 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 009 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 010 LblCom TEMP_LEX_SYMBOL

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:273  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 011 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @QLT$$                    *0-0-0/w PTR         r     1 QLT$$
     4-0-0/w STRC(144)   r     1 TYPE_DESC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248)       1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:274  
     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC              1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
PL6.E3A0      #002=Z8DI$CHECK_CODE_SET File=Z8DI.:Z8A6TSI                        SAT 08/09/97 11:15 Page:275  
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8DI$CHECK_CODE_SET requires 103 words for executable code.
   Procedure Z8DI$CHECK_CODE_SET requires 14 words of local(AUTO) storage.

    No errors detected in file Z8DI.:Z8A6TSI    .
