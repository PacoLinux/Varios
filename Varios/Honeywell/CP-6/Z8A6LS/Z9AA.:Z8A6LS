VERSION A06

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:1    
        1        1        /*M* Z9AA$I_O - General routines for compile time input/output. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: Z9AA$I_O
        9        9             PURPOSE:
       10       10                  Provide general input/output functions for compile time
       11       11                  file manipulation.
       12       12             DESCRIPTION:
       13       13                  This module contains entry points for opening and closing
       14       14                  files, for reading and writing files and for opening
       15       15                  copy files.
       16       16        */
       17       17
       18       18        Z9AA$I_O :PROC (FILE_CODE) ;
       19       19
       20       20        %EQU PHASE = 1;
       21       21        %INCLUDE Z8A_DEFC;
       22       89        %INCLUDE Z8A_SUPP_MAC;
       23     2489        %INCLUDE Z8A_COMCOM;
       24     3139        %INCLUDE Z8A_SYS_FILE;
       25     9414        %INCLUDE B_ERRORS_C;
       26    10540        %INCLUDE XU_MACRO_C;
       27    13634        %INCLUDE XS_MACRO_C;
       28    13678        %INCLUDE Z9A_SUPP_MAC;
       29    13967        %INCLUDE Z8E_WINDOW;
       30    16037        %INCLUDE Z8E_BUFFERS;
       31    16227        %EQU Z8E_TABLES_DEF = '0'B;
       32    16228        %INCLUDE Z8E_TABLES;
       33    16781        %INCLUDE Z8E_STACKS;
       34    19047        %INCLUDE Z8E_O1COM ;
       35    19808        %INCLUDE Z8A_ERR_NUMS ;
       36    20572        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:2    
       37    20573    1   DCL FILE_CODE SBIN WORD;
       38    20574    1   DCL END_OF_FILE BOOLEAN EXT INIT (TRUE);
       39    20575    1   DCL NO_FILE_FOUND BOOLEAN STATIC INIT(FALSE) ;
       40    20576    1   DCL LAST_READ_PARAM_LEVEL SBIN EXT INIT(0);
       41    20577    1   DCL Z8AE$ERROR ENTRY (12) ;
       42    20578    1   DCL Z9AT$TERMINATOR ENTRY ;
       43    20579
       44    20580    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       45    20581    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       46    20582    1   DCL XSA$READ ENTRY(2) ALTRET;
       47    20583    1   DCL XSA$WRITE ENTRY(2) ALTRET;
       48    20584    1   DCL XSA$PFIL  ENTRY(2) ALTRET;
       49    20585
       50    20586    1   DCL INPUT_FILES_OPEN BOOLEAN EXT;
       51    20587    1   DCL INPUT_FILE_TYPE SBIN EXT;
       52    20588    1   DCL SOURCE_LINE_BUFFER  CHAR (%MAX_INPUT_LINE_LENGTH);
       53    20589        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:3    
       54    20590    1   DCL Z9AR$ALLOCATE ENTRY(1);       /* For fast file I/O */
       55    20591    1   DCL Z9AR$RELEASE  ENTRY(1);       /*  "    "   "    "  */
       56    20592    1   DCL Z9AE$ISSUE_SYSTEM_ERROR ENTRY(2);
       57    20593    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
       58    20594
       59    20595    1   DCL M$SI DCB;
       60    20596    1   DCL M$UI DCB;
       61    20597    1   DCL M$ES DCB;
       62    20598
       63    20599        %DCBPTR;
       64    20623
       65    20624        %F$DCB;
       66    20681
       67    20682        %XUU$ENTRY;
       68    20687
       69    20688        %XUU_PARAM(FPTN=OPEN_PARAM,
       70    20689                   BASE=YES,
       71    20690                   DCB = 13,   /* M$LO */
       72    20691                   FAST_BASE=YES,
       73    20692                   ALLOCATE=Z9AR$ALLOCATE,
       74    20693                   RELEASE=Z9AR$RELEASE);
       75    21128
       76    21129        %XUU_PARAM(FPTN=READ_PARAM,
       77    21130                   ALLOCATE=Z9AR$ALLOCATE,
       78    21131                   RELEASE=Z9AR$RELEASE);
       79    21566
       80    21567        %XUU_PARAM(FPTN=CLOSE_PARAM,
       81    21568                   ALLOCATE=Z9AR$ALLOCATE,
       82    21569                   RELEASE=Z9AR$RELEASE,
       83    21570                   CLOSE_ALL = YES);
       84    22005
       85    22006        %XSA_PARAM (FPTN=ES_PARAM);
       86    22036
       87    22037        %FPT_OPEN(FPTN=ES_OPEN_OUTPUT, DCB=%M$ES, FUN=CREATE,
       88    22038                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE);
       89    22147
       90    22148        %FPT_OPEN(FPTN=ES_OPEN_INPUT, DCB=%M$ES, FUN=IN, EXIST=OLDFILE,
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:4    
       91    22149                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE);
       92    22258
       93    22259        %FPT_UNFID (DCB = %M$SI,
       94    22260                    FORCE = YES,
       95    22261                    TEXTFID = COMCOM.SOURCE_FILE_NAME,
       96    22262                    ACCT = VLP_ACCT,
       97    22263                    LEN = SOURCE_FILE_NAME_LENGTH);
       98    22281        %FPT_PFIL(FPTN=ES_POSITION, DCB=%M$ES, BOF=YES);
       99    22296
      100    22297        %VLP_ACCT;
      101    22310
      102    22311    1   DCL SOURCE_FILE_NAME_LENGTH SBIN STATIC;
      103    22312
      104    22313
      105    22314        %FPT_READ(FPTN=ES_READ, DCB=%M$ES);
      106    22353
      107    22354        %FPT_WRITE(FPTN=ES_WRITE, DCB=%M$ES);
      108    22385
      109    22386        %FPT_CLOSE(FPTN=ES_CLOSE, DCB=%M$ES, DISP=RELEASE);
      110    22428        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:5    
      111    22429        /*------------*/
      112    22430    1    Z9AA$FILE_OPEN:        ENTRY;
      113    22431        /*------------*/
      114    22432
      115    22433    2      DO CASE (INPUT_FILE_TYPE);
      116    22434    2        CASE(%SOURCE_FILE);
      117    22435    2          IF NO_FILE_FOUND THEN
      118    22436    2            RETURN ;
      119    22437    2          ELSE
      120    22438    3            DO ;
      121    22439    3              OPEN_PARAM.FLAGS.UP_DATE# = COMCOM.OB.UI;
      122    22440    3              OPEN_PARAM.FLAGS.OPT_UI# = COMCOM.OB.OPTUI;   /*#30236*/
      123    22441    3              OPEN_PARAM.FLAGS.LU_WHILE# = COMCOM.OB.LU;
      124    22442    3              CALL XUU$OPEN (OPEN_PARAM) ALTRET(SOURCE_FILE_OPEN_ERR) ;
      125    22443
      126    22444    3              END_OF_FILE = FALSE ;
      127    22445
      128    22446    3              IF COMCOM.SOURCE_FILE_NAME = ' ' THEN
      129    22447    3                CALL M$UNFID (FPT_UNFID)
      130    22448    4                    WHENALTRETURN DO; END;
      131    22449    3            END ;
      132    22450
      133    22451    2       CASE(%EXPSRC_FILE);
      134    22452    2         END_OF_FILE = FALSE;    /*#27500*/  /* deleted 3 lines */
      135    22453    2      END;
      136    22454
      137    22455    1      RETURN;
      138    22456        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:6    
      139    22457    1   SOURCE_FILE_OPEN_ERR:
      140    22458
      141    22459    1   IF OPEN_PARAM.SI_ERRCODE.ERR# ~= 0 THEN
      142    22460    1     CALL Z9AE$ISSUE_SYSTEM_ERROR(OPEN_PARAM.SI_ERRCODE, Z9A8$M$SI#);
      143    22461    1   ELSE
      144    22462    1     IF OPEN_PARAM.UI_ERRCODE.ERR# ~= 0 THEN
      145    22463    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(OPEN_PARAM.UI_ERRCODE, Z9A8$M$UI#);
      146    22464
      147    22465
      148    22466    1   CALL Z8AE$ERROR(%E$INPUT_FILE_OPEN_ERROR) ;
      149    22467
      150    22468    1   COMCOM.LINES.SOURCE = 0 ;
      151    22469    1   END_OF_FILE         = TRUE ;
      152    22470    1   NO_FILE_FOUND       = TRUE ;
      153    22471    1   CALL Z9AT$TERMINATOR ;
      154    22472
      155    22473    1   RETURN ;
      156    22474
      157    22475        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:7    
      158    22476        /*------------*/
      159    22477    1   Z9AA$FILE_READ:        ENTRY;
      160    22478        /*------------*/
      161    22479
      162    22480    1      IF END_OF_FILE THEN
      163    22481    1        GOTO NORMAL_EOF;
      164    22482
      165    22483    1      FILL_BUFFER.LINE_LENGTH = %MAX_INPUT_LINE_LENGTH;
      166    22484
      167    22485    2      DO CASE (INPUT_FILE_TYPE);
      168    22486
      169    22487    2        CASE(%SOURCE_FILE);
      170    22488
      171    22489    2          READ_PARAM.FLAGS.SOURCE_OUT# = COMCOM.OB.COMDK;
      172    22490    2          CALL XUU$READ (READ_PARAM, VECTOR (SOURCE_LINE_BUFFER))
      173    22491    2                  ALTRET (SOURCE_FILE_EOF);
      174    22492    2          FILL_BUFFER.SOURCE_LINE = SOURCE_LINE_BUFFER;
      175    22493
      176    22494               %INIT_BUFFER (@POINTER = LOOKAHEAD_BUFFER$,
      177    22495                             @LINE_LENGTH = READ_PARAM.ARS,
      178    22496                             @ESN     = READ_PARAM.ASCII_KEY,
      179    22497                             @COPY_LINE = READ_PARAM.FLAGS.INCLUDE#,
      180    22498                             @UPDATE_LINE = READ_PARAM.FLAGS.UP_DATE#,
      181    22499                             @LEVEL   = READ_PARAM.LEVEL,
      182    22500                             @ISN = "ORIGINAL_ISN + 1");
      183    22528    2          LAST_READ_PARAM_LEVEL = READ_PARAM.LEVEL;
      184    22529    2          ORIGINAL_ISN                         = ORIGINAL_ISN + 1;
      185    22530
      186    22531    2        CASE(%EXPSRC_FILE);
      187    22532    2          ES_READ.BUF_ = VECTOR(FILL_BUFFER);
      188    22533    2          CALL XSA$READ(ES_READ, ES_PARAM) ALTRET(EXPSRC_FILE_EOF);
      189    22534    2          ORIGINAL_ISN = FILL_BUFFER.ISN;
      190    22535    2          EXPANDED_ISN = FILL_BUFFER.ISN;
      191    22536
      192    22537    2      END;
      193    22538
      194    22539    1      RETURN;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:8    
      195    22540
      196    22541    1   SOURCE_FILE_EOF:
      197    22542
      198    22543    1      IF READ_PARAM.ERRCODE.ERR# ~= %E$EOF
      199    22544    1             AND READ_PARAM.ERRCODE.ERR# ~= %E$FDEOF
      200    22545    1             THEN
      201    22546    1        CALL Z9AE$ISSUE_SYSTEM_ERROR (READ_PARAM.ERRCODE, READ_PARAM.DCB#);
      202    22547
      203    22548    1      GOTO NORMAL_EOF;
      204    22549
      205    22550    1   EXPSRC_FILE_EOF:
      206    22551
      207    22552    1      IF ES_PARAM.ERR.CODE ~= %E$EOF THEN
      208    22553    1       CALL Z9AE$ISSUE_SYSTEM_ERROR (ES_PARAM.ERR, Z9A8$M$ES#);
      209    22554
      210    22555    1   NORMAL_EOF:
      211    22556    1      END_OF_FILE = TRUE;
      212    22557
      213    22558           %INIT_BUFFER (@POINTER = LOOKAHEAD_BUFFER$,
      214    22559                         @CLASS   = %END_OF_FILE,
      215    22560                         @ISN     = "ORIGINAL_ISN + 1");
      216    22588    1      LAST_READ_PARAM_LEVEL = 0;
      217    22589
      218    22590    1      RETURN;
      219    22591
      220    22592        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:9    
      221    22593        /*-------------*/
      222    22594    1   Z9AA$FILE_CLOSE:       ENTRY;
      223    22595        /*-------------*/
      224    22596
      225    22597    2      DO CASE (INPUT_FILE_TYPE);
      226    22598    2        CASE (%SOURCE_FILE);
      227    22599    2          END_OF_FILE = TRUE ;
      228    22600    2          CALL XUU$CLOSE (CLOSE_PARAM) ALTRET(CLOSE_SOURCE_FILE_ERROR);
      229    22601
      230    22602    2       CASE(%EXPSRC_FILE);
      231    22603    2         CALL XSA$CLOSE(ES_CLOSE, ES_PARAM) ALTRET(CLOSE_EXPSRC_FILE_ERROR);
      232    22604    2         CALL Z9AR$RELEASE(ES_PARAM.BBUF_);
      233    22605    2      END;
      234    22606
      235    22607    1      RETURN;
      236    22608
      237    22609    1   CLOSE_SOURCE_FILE_ERROR:
      238    22610
      239    22611    1     IF CLOSE_PARAM.SI_ERRCODE.ERR# ~= 0 THEN
      240    22612    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.SI_ERRCODE, Z9A8$M$SI#);
      241    22613
      242    22614    1     IF CLOSE_PARAM.UI_ERRCODE.ERR# ~= 0 THEN
      243    22615    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.UI_ERRCODE, Z9A8$M$UI#);
      244    22616
      245    22617    1     IF CLOSE_PARAM.C.INCL_ERRCODE.ERR# ~= 0 THEN
      246    22618    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.C.INCL_ERRCODE, CLOSE_PARAM.DCB#);
      247    22619
      248    22620    1     IF CLOSE_PARAM.C.SO_ERRCODE.ERR# ~= 0 THEN
      249    22621    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.C.SO_ERRCODE, Z9A8$M$SO#);
      250    22622
      251    22623    1     RETURN;
      252    22624
      253    22625    1   CLOSE_EXPSRC_FILE_ERROR:
      254    22626
      255    22627    1     IF ES_PARAM.ERR.CODE ~= 0 THEN
      256    22628    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);
      257    22629
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:10   
      258    22630    1     RETURN;
      259    22631
      260    22632        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:11   
      261    22633        /*-----------------*/
      262    22634    1   Z9AA$OPEN_OUTPUT_ES:   ENTRY;
      263    22635        /*-----------------*/
      264    22636
      265    22637    1     CALL Z9AR$ALLOCATE(ES_PARAM.BBUF_);
      266    22638    1     ES_PARAM.BBUF_.BOUND = 4095;
      267    22639    1     CALL XSA$OPEN(ES_OPEN_OUTPUT, ES_PARAM) ALTRET(OUTPUT_ES_OPEN_ERROR);
      268    22640    1     RETURN;
      269    22641
      270    22642    1   OUTPUT_ES_OPEN_ERROR:
      271    22643
      272    22644    1     IF ES_PARAM.ERR.CODE ~= 0 THEN
      273    22645    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);
      274    22646        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:12   
      275    22647        /*-----------------*/
      276    22648    1   Z9AA$IS_ES_REQUIRED:   ENTRY;
      277    22649        /*-----------------*/
      278    22650
      279    22651    1     IF Z9A8$M$SI$ -> F$DCB.ASN# ~= %FILE# THEN
      280    22652    2       DO;
      281    22653    2         CALL Z8EL$START_WRITING_ES_FILE(0);
      282    22654    2       END;
      283    22655    1     RETURN;
      284    22656        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:13   
      285    22657        /*------------------*/
      286    22658        /*------------------*/
      287    22659    1   Z9AA$POSITION_ES_OUT:  ENTRY;
      288    22660        /*------------------*/
      289    22661
      290    22662    1       CALL XSA$PFIL(ES_POSITION, ES_PARAM) ALTRET(ES_POSITION_ERROR);
      291    22663
      292    22664    1       RETURN;
      293    22665
      294    22666    1   ES_POSITION_ERROR:
      295    22667
      296    22668    1     IF ES_PARAM.ERR.CODE ~= 0 THEN
      297    22669    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);
      298    22670
      299    22671    1     RETURN;
      300    22672        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:14   
      301    22673        /*-----------------*/
      302    22674    1   Z9AA$FILE_REWIND_ES:   ENTRY;
      303    22675        /*-----------------*/
      304    22676
      305    22677    1       END_OF_FILE = FALSE;
      306    22678
      307    22679    1       RETURN;
      308    22680
      309    22681        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:15   
      310    22682        /*----------------*/
      311    22683    1   Z9AA$WRITE_LINE_ES:    ENTRY;
      312    22684        /*----------------*/
      313    22685
      314    22686    1     IF ISN_FOR_EXP_SRC >= 0 AND
      315    22687    1         LINE_LIST$ -> FILL_BUFFER.ISN >= ISN_FOR_EXP_SRC AND
      316    22688    2         Z9A8$M$ES$ -> F$DCB.FCD# THEN DO;
      317    22689    2       ES_WRITE.BUF_ = VECTOR(LINE_LIST$ -> FILL_BUFFER);
      318    22690    2       CALL XSA$WRITE(ES_WRITE, ES_PARAM) ALTRET(WRITE_ES_ERR);
      319    22691    2     END;
      320    22692    1     RETURN;
      321    22693
      322    22694    1   WRITE_ES_ERR:
      323    22695
      324    22696    1     IF ES_PARAM.ERR.CODE ~= 0 THEN
      325    22697    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);
      326    22698
      327    22699    1     RETURN;
      328    22700
      329    22701    1   END Z9AA$I_O;
      330    22702        %EOD;

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:16   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   XS_MACRO_C.:LIB_E04  is referenced.
   XU_MACRO_C.:LIB_E04  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9AA$I_O.

   Procedure Z9AA$I_O requires 348 words for executable code.
   Procedure Z9AA$I_O requires 74 words of local(AUTO) storage.

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:17   

 Object Unit name= Z9AA$I_O                                   File name= Z9AA.:Z8A6TOU
 UTS= AUG 09 '97 13:37:34.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1   DCB   even  none     0      0  M$UC
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11  LblCom even  none    90    132  LEX_SYMBOL
   12  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   13  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   14  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   15  LblCom even  none     1      1  END_OF_FILE
   16   Data  even  none   260    404  Z9AA$I_O
   17  LblCom even  none     1      1  LAST_READ_PARAM_LEVEL
   18  LblCom even  none     1      1  INPUT_FILES_OPEN
   19  LblCom even  none     1      1  INPUT_FILE_TYPE
   20   DCB   even  none     0      0  M$SI
   21   DCB   even  none     0      0  M$UI
   22   DCB   even  none     0      0  M$ES
   23   Proc  even  none   348    534  Z9AA$I_O
   24  RoData even  none    40     50  Z9AA$I_O
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:18   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    23      0   yes            yes      Std        1  Z9AA$I_O
    23      3                  yes      Std        0  Z9AA$FILE_OPEN
    23    111                  yes      Std        0  Z9AA$FILE_READ
    23    311                  yes      Std        0  Z9AA$FILE_CLOSE
    23    406                  yes      Std        0  Z9AA$OPEN_OUTPUT_ES
    23    435                  yes      Std        0  Z9AA$IS_ES_REQUIRED
    23    451                  yes      Std        0  Z9AA$POSITION_ES_OUT
    23    470                  yes      Std        0  Z9AA$FILE_REWIND_ES
    23    474                  yes      Std        0  Z9AA$WRITE_LINE_ES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z9AR$ALLOCATE
         yes           Std       1 Z9AR$RELEASE
 yes     yes           Std       1 XUU$OPEN
         yes           Std       2 Z9AE$ISSUE_SYSTEM_ERROR
         yes           Std      12 Z8AE$ERROR
 yes     yes           Std       2 XUU$READ
 yes     yes           Std       2 XSA$READ
 yes     yes           Std       2 XSA$PFIL
         yes           Std       0 Z9AT$TERMINATOR
 yes     yes           Std       2 XSA$CLOSE
 yes     yes           Std       2 XSA$OPEN
 yes     yes           Std       2 XSA$WRITE
 yes     yes           Std       1 XUU$CLOSE
         yes           Std       1 Z8EL$START_WRITING_ES_FILE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                M$UC                             r    USERWORD_SCAN_TABLE
r    ANSI_USERWORD_SCAN_TABLE         r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE
r    DIGIT_SCAN_TABLE                 r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE
r    SINGLE_QUOTE_SEARCH_TABLE        r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r  SNGL_QUOTE_PSEUDO_SEARCH_TABLE
r    SEPARATORS_TABLE                 r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
     M$SI                                  M$UI                                  M$ES
     Z9A8$M$ES$                            Z9A8$M$SI$                            Z9A8$M$UI$
     Z9A8$M$SO$                            Z9A8$M$OU$                            Z9A8$M$LO$
     Z9A8$M$ME$                            Z9A8$M$DO$                            Z9A8$M$OBJFILE$
     Z9A8$M$ES#                            Z9A8$M$SI#                            Z9A8$M$UI#
     Z9A8$M$SO#                            Z9A8$M$OU#                            Z9A8$M$LO#
     Z9A8$M$ME#                            Z9A8$M$DO#                            Z9A8$M$OBJFILE#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:20   


        1        1        /*M* Z9AA$I_O - General routines for compile time input/output. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: Z9AA$I_O
        9        9             PURPOSE:
       10       10                  Provide general input/output functions for compile time
       11       11                  file manipulation.
       12       12             DESCRIPTION:
       13       13                  This module contains entry points for opening and closing
       14       14                  files, for reading and writing files and for opening
       15       15                  copy files.
       16       16        */
       17       17
       18       18        Z9AA$I_O :PROC (FILE_CODE) ;

     18 23 000000   000000 700200 xent  Z9AA$I_O     TSX0  ! X66_AUTO_1
        23 000001   000112 000001                    ZERO    74,1
        23 000002   000005 710000 23                 TRA     s:22433

       19       19
       20       20        %EQU PHASE = 1;
       21       21        %INCLUDE Z8A_DEFC;
       22       89        %INCLUDE Z8A_SUPP_MAC;
       23     2489        %INCLUDE Z8A_COMCOM;
       24     3139        %INCLUDE Z8A_SYS_FILE;
       25     9414        %INCLUDE B_ERRORS_C;
       26    10540        %INCLUDE XU_MACRO_C;
       27    13634        %INCLUDE XS_MACRO_C;
       28    13678        %INCLUDE Z9A_SUPP_MAC;
       29    13967        %INCLUDE Z8E_WINDOW;
       30    16037        %INCLUDE Z8E_BUFFERS;
       31    16227        %EQU Z8E_TABLES_DEF = '0'B;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:21   
       32    16228        %INCLUDE Z8E_TABLES;
       33    16781        %INCLUDE Z8E_STACKS;
       34    19047        %INCLUDE Z8E_O1COM ;
       35    19808        %INCLUDE Z8A_ERR_NUMS ;
       36    20572        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:22   
       37    20573    1   DCL FILE_CODE SBIN WORD;
       38    20574    1   DCL END_OF_FILE BOOLEAN EXT INIT (TRUE);
       39    20575    1   DCL NO_FILE_FOUND BOOLEAN STATIC INIT(FALSE) ;
       40    20576    1   DCL LAST_READ_PARAM_LEVEL SBIN EXT INIT(0);
       41    20577    1   DCL Z8AE$ERROR ENTRY (12) ;
       42    20578    1   DCL Z9AT$TERMINATOR ENTRY ;
       43    20579
       44    20580    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       45    20581    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       46    20582    1   DCL XSA$READ ENTRY(2) ALTRET;
       47    20583    1   DCL XSA$WRITE ENTRY(2) ALTRET;
       48    20584    1   DCL XSA$PFIL  ENTRY(2) ALTRET;
       49    20585
       50    20586    1   DCL INPUT_FILES_OPEN BOOLEAN EXT;
       51    20587    1   DCL INPUT_FILE_TYPE SBIN EXT;
       52    20588    1   DCL SOURCE_LINE_BUFFER  CHAR (%MAX_INPUT_LINE_LENGTH);
       53    20589        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:23   
       54    20590    1   DCL Z9AR$ALLOCATE ENTRY(1);       /* For fast file I/O */
       55    20591    1   DCL Z9AR$RELEASE  ENTRY(1);       /*  "    "   "    "  */
       56    20592    1   DCL Z9AE$ISSUE_SYSTEM_ERROR ENTRY(2);
       57    20593    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
       58    20594
       59    20595    1   DCL M$SI DCB;
       60    20596    1   DCL M$UI DCB;
       61    20597    1   DCL M$ES DCB;
       62    20598
       63    20599        %DCBPTR;
       64    20623
       65    20624        %F$DCB;
       66    20681
       67    20682        %XUU$ENTRY;
       68    20687
       69    20688        %XUU_PARAM(FPTN=OPEN_PARAM,
       70    20689                   BASE=YES,
       71    20690                   DCB = 13,   /* M$LO */
       72    20691                   FAST_BASE=YES,
       73    20692                   ALLOCATE=Z9AR$ALLOCATE,
       74    20693                   RELEASE=Z9AR$RELEASE);
       75    21128
       76    21129        %XUU_PARAM(FPTN=READ_PARAM,
       77    21130                   ALLOCATE=Z9AR$ALLOCATE,
       78    21131                   RELEASE=Z9AR$RELEASE);
       79    21566
       80    21567        %XUU_PARAM(FPTN=CLOSE_PARAM,
       81    21568                   ALLOCATE=Z9AR$ALLOCATE,
       82    21569                   RELEASE=Z9AR$RELEASE,
       83    21570                   CLOSE_ALL = YES);
       84    22005
       85    22006        %XSA_PARAM (FPTN=ES_PARAM);
       86    22036
       87    22037        %FPT_OPEN(FPTN=ES_OPEN_OUTPUT, DCB=%M$ES, FUN=CREATE,
       88    22038                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE);
       89    22147
       90    22148        %FPT_OPEN(FPTN=ES_OPEN_INPUT, DCB=%M$ES, FUN=IN, EXIST=OLDFILE,
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:24   
       91    22149                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE);
       92    22258
       93    22259        %FPT_UNFID (DCB = %M$SI,
       94    22260                    FORCE = YES,
       95    22261                    TEXTFID = COMCOM.SOURCE_FILE_NAME,
       96    22262                    ACCT = VLP_ACCT,
       97    22263                    LEN = SOURCE_FILE_NAME_LENGTH);
       98    22281        %FPT_PFIL(FPTN=ES_POSITION, DCB=%M$ES, BOF=YES);
       99    22296
      100    22297        %VLP_ACCT;
      101    22310
      102    22311    1   DCL SOURCE_FILE_NAME_LENGTH SBIN STATIC;
      103    22312
      104    22313
      105    22314        %FPT_READ(FPTN=ES_READ, DCB=%M$ES);
      106    22353
      107    22354        %FPT_WRITE(FPTN=ES_WRITE, DCB=%M$ES);
      108    22385
      109    22386        %FPT_CLOSE(FPTN=ES_CLOSE, DCB=%M$ES, DISP=RELEASE);
      110    22428        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:25   
      111    22429        /*------------*/
      112    22430    1    Z9AA$FILE_OPEN:        ENTRY;

  22430 23 000003   000000 700200 xent  Z9AA$FILE_O* TSX0  ! X66_AUTO_1
        23 000004   000112 000001                    ZERO    74,1

      113    22431        /*------------*/
      114    22432
      115    22433    2      DO CASE (INPUT_FILE_TYPE);

  22433 23 000005   000000 235000 19                 LDA     INPUT_FILE_TYPE
        23 000006   000002 115007                    CMPA    2,DL
        23 000007   000011 602005 23                 TNC     s:22433+4,AL
        23 000010   000055 710000 23                 TRA     s:22455
        23 000011   000013 710000 23                 TRA     s:22435
        23 000012   000054 710000 23                 TRA     s:22452

      116    22434    2        CASE(%SOURCE_FILE);

      117    22435    2          IF NO_FILE_FOUND THEN

  22435 23 000013   000000 234000 16                 SZN     NO_FILE_FOUND
        23 000014   000016 605000 23                 TPL     s:22439

      118    22436    2            RETURN ;

  22436 23 000015   000000 702200 xent               TSX2  ! X66_ARET

      119    22437    2          ELSE
      120    22438    3            DO ;

      121    22439    3              OPEN_PARAM.FLAGS.UP_DATE# = COMCOM.OB.UI;

  22439 23 000016   000106 236000 xsym               LDQ     COMCOM+70
        23 000017   000001 772000                    QRL     1
        23 000020   000001 676000 16                 ERQ     OPEN_PARAM
        23 000021   200000 376003                    ANQ     65536,DU
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:26   
        23 000022   000001 656000 16                 ERSQ    OPEN_PARAM

      122    22440    3              OPEN_PARAM.FLAGS.OPT_UI# = COMCOM.OB.OPTUI;   /*#30236*/

  22440 23 000023   000113 236000 xsym               LDQ     COMCOM+75
        23 000024   000013 772000                    QRL     11
        23 000025   000001 676000 16                 ERQ     OPEN_PARAM
        23 000026   000100 376003                    ANQ     64,DU
        23 000027   000001 656000 16                 ERSQ    OPEN_PARAM

      123    22441    3              OPEN_PARAM.FLAGS.LU_WHILE# = COMCOM.OB.LU;

  22441 23 000030   000017 236000 xsym               LDQ     COMCOM+15
        23 000031   000012 772000                    QRL     10
        23 000032   000001 676000 16                 ERQ     OPEN_PARAM
        23 000033   000200 376003                    ANQ     128,DU
        23 000034   000001 656000 16                 ERSQ    OPEN_PARAM

      124    22442    3              CALL XUU$OPEN (OPEN_PARAM) ALTRET(SOURCE_FILE_OPEN_ERR) ;

  22442 23 000035   000001 630400 24                 EPPR0   1
        23 000036   000000 631400 24                 EPPR1   0
        23 000037   000000 701000 xent               TSX1    XUU$OPEN
        23 000040   000056 702000 23                 TSX2    SOURCE_FILE_OPEN_ERR

      125    22443
      126    22444    3              END_OF_FILE = FALSE ;

  22444 23 000041   000000 450000 15                 STZ     END_OF_FILE

      127    22445
      128    22446    3              IF COMCOM.SOURCE_FILE_NAME = ' ' THEN

  22446 23 000042   040000 106400                    CMPC    fill='040'O
        23 000043   000454 000033 xsym               ADSC9   COMCOM+300               cn=0,n=27
        23 000044   000002 000001 24                 ADSC9   2                        cn=0,n=1
        23 000045   000055 601000 23                 TNZ     s:22455
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:27   

      129    22447    3                CALL M$UNFID (FPT_UNFID)

  22447 23 000046   000256 630400 16                 EPPR0   FPT_UNFID
        23 000047   420021 713400                    CLIMB   alt,+8209
        23 000050   404400 401760                    pmme    nvectors=10
        23 000051   000053 702000 23                 TSX2    s:22449
        23 000052   000053 710000 23                 TRA     s:22449

      130    22448    4                    WHENALTRETURN DO; END;

      131    22449    3            END ;

  22449 23 000053   000055 710000 23                 TRA     s:22455

      132    22450
      133    22451    2       CASE(%EXPSRC_FILE);

      134    22452    2         END_OF_FILE = FALSE;    /*#27500*/  /* deleted 3 lines */

  22452 23 000054   000000 450000 15                 STZ     END_OF_FILE

      135    22453    2      END;

      136    22454
      137    22455    1      RETURN;

  22455 23 000055   000000 702200 xent               TSX2  ! X66_ARET

      138    22456        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:28   
      139    22457    1   SOURCE_FILE_OPEN_ERR:
      140    22458
      141    22459    1   IF OPEN_PARAM.SI_ERRCODE.ERR# ~= 0 THEN

  22459 23 000056   000002 236000 16    SOURCE_FILE* LDQ     OPEN_PARAM+1
        23 000057   377770 316007                    CANQ    131064,DL
        23 000060   000066 600000 23                 TZE     s:22462

      142    22460    1     CALL Z9AE$ISSUE_SYSTEM_ERROR(OPEN_PARAM.SI_ERRCODE, Z9A8$M$SI#);

  22460 23 000061   000004 630400 24                 EPPR0   4
        23 000062   000003 631400 24                 EPPR1   3
        23 000063   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000064   000000 011000                    NOP     0
        23 000065   000075 710000 23                 TRA     s:22466

      143    22461    1   ELSE
      144    22462    1     IF OPEN_PARAM.UI_ERRCODE.ERR# ~= 0 THEN

  22462 23 000066   000003 236000 16                 LDQ     OPEN_PARAM+2
        23 000067   377770 316007                    CANQ    131064,DL
        23 000070   000075 600000 23                 TZE     s:22466

      145    22463    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(OPEN_PARAM.UI_ERRCODE, Z9A8$M$UI#);

  22463 23 000071   000006 630400 24                 EPPR0   6
        23 000072   000003 631400 24                 EPPR1   3
        23 000073   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000074   000000 011000                    NOP     0

      146    22464
      147    22465
      148    22466    1   CALL Z8AE$ERROR(%E$INPUT_FILE_OPEN_ERROR) ;

  22466 23 000075   000011 630400 24                 EPPR0   9
        23 000076   000000 631400 24                 EPPR1   0
        23 000077   000000 701000 xent               TSX1    Z8AE$ERROR
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:29   
        23 000100   000000 011000                    NOP     0

      149    22467
      150    22468    1   COMCOM.LINES.SOURCE = 0 ;

  22468 23 000101   000131 450000 xsym               STZ     COMCOM+89

      151    22469    1   END_OF_FILE         = TRUE ;

  22469 23 000102   400000 236003                    LDQ     -131072,DU
        23 000103   000000 756000 15                 STQ     END_OF_FILE

      152    22470    1   NO_FILE_FOUND       = TRUE ;

  22470 23 000104   000000 756000 16                 STQ     NO_FILE_FOUND

      153    22471    1   CALL Z9AT$TERMINATOR ;

  22471 23 000105   000012 631400 24                 EPPR1   10
        23 000106   000000 701000 xent               TSX1    Z9AT$TERMINATOR
        23 000107   000000 011000                    NOP     0

      154    22472
      155    22473    1   RETURN ;

  22473 23 000110   000000 702200 xent               TSX2  ! X66_ARET

      156    22474
      157    22475        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:30   
      158    22476        /*------------*/
      159    22477    1   Z9AA$FILE_READ:        ENTRY;

  22477 23 000111   000000 700200 xent  Z9AA$FILE_R* TSX0  ! X66_AUTO_1
        23 000112   000112 000001                    ZERO    74,1

      160    22478        /*------------*/
      161    22479
      162    22480    1      IF END_OF_FILE THEN

  22480 23 000113   000000 234000 15                 SZN     END_OF_FILE
        23 000114   000264 604000 23                 TMI     NORMAL_EOF

      163    22481    1        GOTO NORMAL_EOF;
      164    22482
      165    22483    1      FILL_BUFFER.LINE_LENGTH = %MAX_INPUT_LINE_LENGTH;

  22483 23 000115   000400 235007                    LDA     256,DL
        23 000116   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000117   000012 755100                    STA     10,,PR0

      166    22484
      167    22485    2      DO CASE (INPUT_FILE_TYPE);

  22485 23 000120   000000 236000 19                 LDQ     INPUT_FILE_TYPE
        23 000121   000002 116007                    CMPQ    2,DL
        23 000122   000124 602006 23                 TNC     s:22485+4,QL
        23 000123   000240 710000 23                 TRA     s:22539
        23 000124   000126 710000 23                 TRA     s:22489
        23 000125   000221 710000 23                 TRA     s:22532

      168    22486
      169    22487    2        CASE(%SOURCE_FILE);

      170    22488
      171    22489    2          READ_PARAM.FLAGS.SOURCE_OUT# = COMCOM.OB.COMDK;

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:31   
  22489 23 000126   000016 236000 xsym               LDQ     COMCOM+14
        23 000127   000004 772000                    QRL     4
        23 000130   000017 676000 16                 ERQ     READ_PARAM
        23 000131   020000 376003                    ANQ     8192,DU
        23 000132   000017 656000 16                 ERSQ    READ_PARAM

      172    22490    2          CALL XUU$READ (READ_PARAM, VECTOR (SOURCE_LINE_BUFFER))

  22490 23 000133   000013 235000 24                 LDA     11
        23 000134   200104 452500                    STP2    SOURCE_LINE_BUFFER+64,,AUTO
        23 000135   200104 236100                    LDQ     SOURCE_LINE_BUFFER+64,,AUTO
        23 000136   000004 036003                    ADLQ    4,DU
        23 000137   200106 757100                    STAQ    SOURCE_LINE_BUFFER+66,,AUTO
        23 000140   200106 631500                    EPPR1   SOURCE_LINE_BUFFER+66,,AUTO
        23 000141   200111 451500                    STP1    SOURCE_LINE_BUFFER+69,,AUTO
        23 000142   000014 236000 24                 LDQ     12
        23 000143   200110 756100                    STQ     SOURCE_LINE_BUFFER+68,,AUTO
        23 000144   200110 630500                    EPPR0   SOURCE_LINE_BUFFER+68,,AUTO
        23 000145   000003 631400 24                 EPPR1   3
        23 000146   000000 701000 xent               TSX1    XUU$READ
        23 000147   000241 702000 23                 TSX2    SOURCE_FILE_EOF

      173    22491    2                  ALTRET (SOURCE_FILE_EOF);
      174    22492    2          FILL_BUFFER.SOURCE_LINE = SOURCE_LINE_BUFFER;

  22492 23 000150   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000151   000012 720100                    LXL0    10,,PR0
        23 000152   040140 100500                    MLR     fill='040'O
        23 000153   200004 000400                    ADSC9   SOURCE_LINE_BUFFER,,AUTO cn=0,n=256
        23 000154   000013 000010                    ADSC9   11,,PR0                  cn=0,n=*X0

      175    22493
      176    22494               %INIT_BUFFER (@POINTER = LOOKAHEAD_BUFFER$,
      177    22495                             @LINE_LENGTH = READ_PARAM.ARS,
      178    22496                             @ESN     = READ_PARAM.ASCII_KEY,
      179    22497                             @COPY_LINE = READ_PARAM.FLAGS.INCLUDE#,
      180    22498                             @UPDATE_LINE = READ_PARAM.FLAGS.UP_DATE#,
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:32   
      181    22499                             @LEVEL   = READ_PARAM.LEVEL,
      182    22500                             @ISN = "ORIGINAL_ISN + 1");

  22502 23 000155   040100 100400                    MLR     fill='040'O
        23 000156   000022 000012 16                 ADSC9   READ_PARAM+3             cn=0,n=10
        23 000157   000005 000012                    ADSC9   5,,PR0                   cn=0,n=10

  22503 23 000160   000000 450100                    STZ     0,,PR0

  22504 23 000161   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000162   000010 450100                    STZ     8,,PR0

  22505 23 000163   000000 235000 8                  LDA     ORIGINAL_ISN
        23 000164   000001 035007                    ADLA    1,DL
        23 000165   000004 755100                    STA     4,,PR0

  22506 23 000166   000017 236000 16                 LDQ     READ_PARAM
        23 000167   000011 772000                    QRL     9
        23 000170   000777 376007                    ANQ     511,DL
        23 000171   000001 756100                    STQ     1,,PR0

  22507 23 000172   000015 236000 24                 LDQ     13
        23 000173   000002 756100                    STQ     2,,PR0

  22508 23 000174   000011 450100                    STZ     9,,PR0

  22509 23 000175   000003 450100                    STZ     3,,PR0

  22510 23 000176   000017 236000 16                 LDQ     READ_PARAM
        23 000177   000777 376007                    ANQ     511,DL
        23 000200   000012 756100                    STQ     10,,PR0

  22518 23 000201   000017 236000 16                 LDQ     READ_PARAM
        23 000202   000001 736000                    QLS     1
        23 000203   000011 676100                    ERQ     9,,PR0
        23 000204   200000 376003                    ANQ     65536,DU
        23 000205   000011 656100                    ERSQ    9,,PR0
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:33   

  22521 23 000206   000017 236000 16                 LDQ     READ_PARAM
        23 000207   000001 772000                    QRL     1
        23 000210   000011 676100                    ERQ     9,,PR0
        23 000211   100000 376003                    ANQ     32768,DU
        23 000212   000011 656100                    ERSQ    9,,PR0

      183    22528    2          LAST_READ_PARAM_LEVEL = READ_PARAM.LEVEL;

  22528 23 000213   000017 236000 16                 LDQ     READ_PARAM
        23 000214   000011 772000                    QRL     9
        23 000215   000777 376007                    ANQ     511,DL
        23 000216   000000 756000 17                 STQ     LAST_READ_PARAM_LEVEL

      184    22529    2          ORIGINAL_ISN                         = ORIGINAL_ISN + 1;

  22529 23 000217   000000 054000 8                  AOS     ORIGINAL_ISN
        23 000220   000240 710000 23                 TRA     s:22539

      185    22530
      186    22531    2        CASE(%EXPSRC_FILE);

      187    22532    2          ES_READ.BUF_ = VECTOR(FILL_BUFFER);

  22532 23 000221   000012 720100                    LXL0    10,,PR0
        23 000222   000054 621010                    EAX1    44,X0
        23 000223   000000 635011                    EAA     0,X1
        23 000224   000002 731000                    ARS     2
        23 000225   000140 135007                    SBLA    96,DL
        23 000226   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        23 000227   000320 757000 16                 STAQ    ES_READ+4

      188    22533    2          CALL XSA$READ(ES_READ, ES_PARAM) ALTRET(EXPSRC_FILE_EOF);

  22533 23 000230   000016 630400 24                 EPPR0   14
        23 000231   000003 631400 24                 EPPR1   3
        23 000232   000000 701000 xent               TSX1    XSA$READ
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:34   
        23 000233   000254 702000 23                 TSX2    EXPSRC_FILE_EOF

      189    22534    2          ORIGINAL_ISN = FILL_BUFFER.ISN;

  22534 23 000234   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000235   000004 235100                    LDA     4,,PR0
        23 000236   000000 755000 8                  STA     ORIGINAL_ISN

      190    22535    2          EXPANDED_ISN = FILL_BUFFER.ISN;

  22535 23 000237   000000 755000 9                  STA     EXPANDED_ISN

      191    22536
      192    22537    2      END;

      193    22538
      194    22539    1      RETURN;

  22539 23 000240   000000 702200 xent               TSX2  ! X66_ARET

      195    22540
      196    22541    1   SOURCE_FILE_EOF:
      197    22542
      198    22543    1      IF READ_PARAM.ERRCODE.ERR# ~= %E$EOF

  22543 23 000241   000021 236000 16    SOURCE_FILE* LDQ     READ_PARAM+2
        23 000242   377770 376007                    ANQ     131064,DL
        23 000243   000060 116007                    CMPQ    48,DL
        23 000244   000253 600000 23                 TZE     s:22548
        23 000245   001540 116007                    CMPQ    864,DL
        23 000246   000253 600000 23                 TZE     s:22548

      199    22544    1             AND READ_PARAM.ERRCODE.ERR# ~= %E$FDEOF
      200    22545    1             THEN
      201    22546    1        CALL Z9AE$ISSUE_SYSTEM_ERROR (READ_PARAM.ERRCODE, READ_PARAM.DCB#);

  22546 23 000247   000020 630400 24                 EPPR0   16
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:35   
        23 000250   000003 631400 24                 EPPR1   3
        23 000251   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000252   000000 011000                    NOP     0

      202    22547
      203    22548    1      GOTO NORMAL_EOF;

  22548 23 000253   000264 710000 23                 TRA     NORMAL_EOF

      204    22549
      205    22550    1   EXPSRC_FILE_EOF:
      206    22551
      207    22552    1      IF ES_PARAM.ERR.CODE ~= %E$EOF THEN

  22552 23 000254   000055 236000 16    EXPSRC_FILE* LDQ     ES_PARAM+1
        23 000255   377770 376007                    ANQ     131064,DL
        23 000256   000060 116007                    CMPQ    48,DL
        23 000257   000264 600000 23                 TZE     NORMAL_EOF

      208    22553    1       CALL Z9AE$ISSUE_SYSTEM_ERROR (ES_PARAM.ERR, Z9A8$M$ES#);

  22553 23 000260   000022 630400 24                 EPPR0   18
        23 000261   000003 631400 24                 EPPR1   3
        23 000262   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000263   000000 011000                    NOP     0

      209    22554
      210    22555    1   NORMAL_EOF:
      211    22556    1      END_OF_FILE = TRUE;

  22556 23 000264   400000 236003       NORMAL_EOF   LDQ     -131072,DU
        23 000265   000000 756000 15                 STQ     END_OF_FILE

      212    22557
      213    22558           %INIT_BUFFER (@POINTER = LOOKAHEAD_BUFFER$,
      214    22559                         @CLASS   = %END_OF_FILE,
      215    22560                         @ISN     = "ORIGINAL_ISN + 1");
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:36   

  22562 23 000266   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000267   040100 100400                    MLR     fill='040'O
        23 000270   000002 000001 24                 ADSC9   2                        cn=0,n=1
        23 000271   000005 000012                    ADSC9   5,,PR0                   cn=0,n=10

  22563 23 000272   000000 450100                    STZ     0,,PR0

  22564 23 000273   000001 235007                    LDA     1,DL
        23 000274   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        23 000275   000010 755100                    STA     8,,PR0

  22565 23 000276   000000 235000 8                  LDA     ORIGINAL_ISN
        23 000277   000001 035007                    ADLA    1,DL
        23 000300   000004 755100                    STA     4,,PR0

  22566 23 000301   000001 450100                    STZ     1,,PR0

  22567 23 000302   000015 236000 24                 LDQ     13
        23 000303   000002 756100                    STQ     2,,PR0

  22568 23 000304   000011 450100                    STZ     9,,PR0

  22569 23 000305   000003 450100                    STZ     3,,PR0

  22570 23 000306   000012 450100                    STZ     10,,PR0

      216    22588    1      LAST_READ_PARAM_LEVEL = 0;

  22588 23 000307   000000 450000 17                 STZ     LAST_READ_PARAM_LEVEL

      217    22589
      218    22590    1      RETURN;

  22590 23 000310   000000 702200 xent               TSX2  ! X66_ARET

      219    22591
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:37   
      220    22592        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:38   
      221    22593        /*-------------*/
      222    22594    1   Z9AA$FILE_CLOSE:       ENTRY;

  22594 23 000311   000000 700200 xent  Z9AA$FILE_C* TSX0  ! X66_AUTO_1
        23 000312   000112 000001                    ZERO    74,1

      223    22595        /*-------------*/
      224    22596
      225    22597    2      DO CASE (INPUT_FILE_TYPE);

  22597 23 000313   000000 235000 19                 LDA     INPUT_FILE_TYPE
        23 000314   000002 115007                    CMPA    2,DL
        23 000315   000317 602005 23                 TNC     s:22597+4,AL
        23 000316   000340 710000 23                 TRA     s:22607
        23 000317   000321 710000 23                 TRA     s:22599
        23 000320   000330 710000 23                 TRA     s:22603

      226    22598    2        CASE (%SOURCE_FILE);

      227    22599    2          END_OF_FILE = TRUE ;

  22599 23 000321   400000 236003                    LDQ     -131072,DU
        23 000322   000000 756000 15                 STQ     END_OF_FILE

      228    22600    2          CALL XUU$CLOSE (CLOSE_PARAM) ALTRET(CLOSE_SOURCE_FILE_ERROR);

  22600 23 000323   000024 630400 24                 EPPR0   20
        23 000324   000000 631400 24                 EPPR1   0
        23 000325   000000 701000 xent               TSX1    XUU$CLOSE
        23 000326   000341 702000 23                 TSX2    CLOSE_SOURCE_FILE_ERROR
        23 000327   000340 710000 23                 TRA     s:22607

      229    22601
      230    22602    2       CASE(%EXPSRC_FILE);

      231    22603    2         CALL XSA$CLOSE(ES_CLOSE, ES_PARAM) ALTRET(CLOSE_EXPSRC_FILE_ERROR);

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:39   
  22603 23 000330   000025 630400 24                 EPPR0   21
        23 000331   000003 631400 24                 EPPR1   3
        23 000332   000000 701000 xent               TSX1    XSA$CLOSE
        23 000333   000376 702000 23                 TSX2    CLOSE_EXPSRC_FILE_ERROR

      232    22604    2         CALL Z9AR$RELEASE(ES_PARAM.BBUF_);

  22604 23 000334   000027 630400 24                 EPPR0   23
        23 000335   000000 631400 24                 EPPR1   0
        23 000336   000000 701000 xent               TSX1    Z9AR$RELEASE
        23 000337   000000 011000                    NOP     0

      233    22605    2      END;

      234    22606
      235    22607    1      RETURN;

  22607 23 000340   000000 702200 xent               TSX2  ! X66_ARET

      236    22608
      237    22609    1   CLOSE_SOURCE_FILE_ERROR:
      238    22610
      239    22611    1     IF CLOSE_PARAM.SI_ERRCODE.ERR# ~= 0 THEN

  22611 23 000341   000036 236000 16    CLOSE_SOURC* LDQ     CLOSE_PARAM+1
        23 000342   377770 316007                    CANQ    131064,DL
        23 000343   000350 600000 23                 TZE     s:22614

      240    22612    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.SI_ERRCODE, Z9A8$M$SI#);

  22612 23 000344   000030 630400 24                 EPPR0   24
        23 000345   000003 631400 24                 EPPR1   3
        23 000346   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000347   000000 011000                    NOP     0

      241    22613
      242    22614    1     IF CLOSE_PARAM.UI_ERRCODE.ERR# ~= 0 THEN
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:40   

  22614 23 000350   000037 236000 16                 LDQ     CLOSE_PARAM+2
        23 000351   377770 316007                    CANQ    131064,DL
        23 000352   000357 600000 23                 TZE     s:22617

      243    22615    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.UI_ERRCODE, Z9A8$M$UI#);

  22615 23 000353   000032 630400 24                 EPPR0   26
        23 000354   000003 631400 24                 EPPR1   3
        23 000355   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000356   000000 011000                    NOP     0

      244    22616
      245    22617    1     IF CLOSE_PARAM.C.INCL_ERRCODE.ERR# ~= 0 THEN

  22617 23 000357   000040 236000 16                 LDQ     CLOSE_PARAM+3
        23 000360   377770 316007                    CANQ    131064,DL
        23 000361   000366 600000 23                 TZE     s:22620

      246    22618    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.C.INCL_ERRCODE, CLOSE_PARAM.DCB#);

  22618 23 000362   000034 630400 24                 EPPR0   28
        23 000363   000003 631400 24                 EPPR1   3
        23 000364   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000365   000000 011000                    NOP     0

      247    22619
      248    22620    1     IF CLOSE_PARAM.C.SO_ERRCODE.ERR# ~= 0 THEN

  22620 23 000366   000041 236000 16                 LDQ     CLOSE_PARAM+4
        23 000367   377770 316007                    CANQ    131064,DL
        23 000370   000375 600000 23                 TZE     s:22623

      249    22621    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(CLOSE_PARAM.C.SO_ERRCODE, Z9A8$M$SO#);

  22621 23 000371   000036 630400 24                 EPPR0   30
        23 000372   000003 631400 24                 EPPR1   3
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:41   
        23 000373   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000374   000000 011000                    NOP     0

      250    22622
      251    22623    1     RETURN;

  22623 23 000375   000000 702200 xent               TSX2  ! X66_ARET

      252    22624
      253    22625    1   CLOSE_EXPSRC_FILE_ERROR:
      254    22626
      255    22627    1     IF ES_PARAM.ERR.CODE ~= 0 THEN

  22627 23 000376   000055 236000 16    CLOSE_EXPSR* LDQ     ES_PARAM+1
        23 000377   377770 316007                    CANQ    131064,DL
        23 000400   000405 600000 23                 TZE     s:22630

      256    22628    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);

  22628 23 000401   000022 630400 24                 EPPR0   18
        23 000402   000003 631400 24                 EPPR1   3
        23 000403   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000404   000000 011000                    NOP     0

      257    22629
      258    22630    1     RETURN;

  22630 23 000405   000000 702200 xent               TSX2  ! X66_ARET

      259    22631
      260    22632        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:42   
      261    22633        /*-----------------*/
      262    22634    1   Z9AA$OPEN_OUTPUT_ES:   ENTRY;

  22634 23 000406   000000 700200 xent  Z9AA$OPEN_O* TSX0  ! X66_AUTO_1
        23 000407   000112 000001                    ZERO    74,1

      263    22635        /*-----------------*/
      264    22636
      265    22637    1     CALL Z9AR$ALLOCATE(ES_PARAM.BBUF_);

  22637 23 000410   000027 630400 24                 EPPR0   23
        23 000411   000000 631400 24                 EPPR1   0
        23 000412   000000 701000 xent               TSX1    Z9AR$ALLOCATE
        23 000413   000000 011000                    NOP     0

      266    22638    1     ES_PARAM.BBUF_.BOUND = 4095;

  22638 23 000414   000060 236000 16                 LDQ     ES_PARAM+4
        23 000415   177777 376007                    ANQ     65535,DL
        23 000416   000040 276000 24                 ORQ     32
        23 000417   000060 756000 16                 STQ     ES_PARAM+4

      267    22639    1     CALL XSA$OPEN(ES_OPEN_OUTPUT, ES_PARAM) ALTRET(OUTPUT_ES_OPEN_ERROR);

  22639 23 000420   000041 630400 24                 EPPR0   33
        23 000421   000003 631400 24                 EPPR1   3
        23 000422   000000 701000 xent               TSX1    XSA$OPEN
        23 000423   000425 702000 23                 TSX2    OUTPUT_ES_OPEN_ERROR

      268    22640    1     RETURN;

  22640 23 000424   000000 702200 xent               TSX2  ! X66_ARET

      269    22641
      270    22642    1   OUTPUT_ES_OPEN_ERROR:
      271    22643
      272    22644    1     IF ES_PARAM.ERR.CODE ~= 0 THEN
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:43   

  22644 23 000425   000055 236000 16    OUTPUT_ES_O* LDQ     ES_PARAM+1
        23 000426   377770 316007                    CANQ    131064,DL
        23 000427   000434 600000 23                 TZE     s:22645+4

      273    22645    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);

  22645 23 000430   000022 630400 24                 EPPR0   18
        23 000431   000003 631400 24                 EPPR1   3
        23 000432   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000433   000000 011000                    NOP     0
        23 000434   000437 710000 23                 TRA     s:22651

      274    22646        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:44   
      275    22647        /*-----------------*/
      276    22648    1   Z9AA$IS_ES_REQUIRED:   ENTRY;

  22648 23 000435   000000 700200 xent  Z9AA$IS_ES_* TSX0  ! X66_AUTO_1
        23 000436   000112 000001                    ZERO    74,1

      277    22649        /*-----------------*/
      278    22650
      279    22651    1     IF Z9A8$M$SI$ -> F$DCB.ASN# ~= %FILE# THEN

  22651 23 000437   000000 470400 xsym               LDP0    Z9A8$M$SI$
        23 000440   000032 236100                    LDQ     26,,PR0
        23 000441   777000 376007                    ANQ     -512,DL
        23 000442   001000 116007                    CMPQ    512,DL
        23 000443   000450 600000 23                 TZE     s:22655

      280    22652    2       DO;

      281    22653    2         CALL Z8EL$START_WRITING_ES_FILE(0);

  22653 23 000444   000043 630400 24                 EPPR0   35
        23 000445   000000 631400 24                 EPPR1   0
        23 000446   000000 701000 xent               TSX1    Z8EL$START_WRITING_ES_FILE
        23 000447   000000 011000                    NOP     0

      282    22654    2       END;

      283    22655    1     RETURN;

  22655 23 000450   000000 702200 xent               TSX2  ! X66_ARET

      284    22656        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:45   
      285    22657        /*------------------*/
      286    22658        /*------------------*/
      287    22659    1   Z9AA$POSITION_ES_OUT:  ENTRY;

  22659 23 000451   000000 700200 xent  Z9AA$POSITI* TSX0  ! X66_AUTO_1
        23 000452   000112 000001                    ZERO    74,1

      288    22660        /*------------------*/
      289    22661
      290    22662    1       CALL XSA$PFIL(ES_POSITION, ES_PARAM) ALTRET(ES_POSITION_ERROR);

  22662 23 000453   000044 630400 24                 EPPR0   36
        23 000454   000003 631400 24                 EPPR1   3
        23 000455   000000 701000 xent               TSX1    XSA$PFIL
        23 000456   000460 702000 23                 TSX2    ES_POSITION_ERROR

      291    22663
      292    22664    1       RETURN;

  22664 23 000457   000000 702200 xent               TSX2  ! X66_ARET

      293    22665
      294    22666    1   ES_POSITION_ERROR:
      295    22667
      296    22668    1     IF ES_PARAM.ERR.CODE ~= 0 THEN

  22668 23 000460   000055 236000 16    ES_POSITION* LDQ     ES_PARAM+1
        23 000461   377770 316007                    CANQ    131064,DL
        23 000462   000467 600000 23                 TZE     s:22671

      297    22669    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);

  22669 23 000463   000022 630400 24                 EPPR0   18
        23 000464   000003 631400 24                 EPPR1   3
        23 000465   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000466   000000 011000                    NOP     0

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:46   
      298    22670
      299    22671    1     RETURN;

  22671 23 000467   000000 702200 xent               TSX2  ! X66_ARET

      300    22672        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:47   
      301    22673        /*-----------------*/
      302    22674    1   Z9AA$FILE_REWIND_ES:   ENTRY;

  22674 23 000470   000000 700200 xent  Z9AA$FILE_R* TSX0  ! X66_AUTO_1
        23 000471   000112 000001                    ZERO    74,1

      303    22675        /*-----------------*/
      304    22676
      305    22677    1       END_OF_FILE = FALSE;

  22677 23 000472   000000 450000 15                 STZ     END_OF_FILE

      306    22678
      307    22679    1       RETURN;

  22679 23 000473   000000 702200 xent               TSX2  ! X66_ARET

      308    22680
      309    22681        %EJECT;
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:48   
      310    22682        /*----------------*/
      311    22683    1   Z9AA$WRITE_LINE_ES:    ENTRY;

  22683 23 000474   000000 700200 xent  Z9AA$WRITE_* TSX0  ! X66_AUTO_1
        23 000475   000112 000001                    ZERO    74,1

      312    22684        /*----------------*/
      313    22685
      314    22686    1     IF ISN_FOR_EXP_SRC >= 0 AND

  22686 23 000476   000000 235000 10                 LDA     ISN_FOR_EXP_SRC
        23 000477   000523 604000 23                 TMI     s:22692
        23 000500   000000 470400 6                  LDP0    LINE_LIST$
        23 000501   000004 236100                    LDQ     4,,PR0
        23 000502   000000 116000 10                 CMPQ    ISN_FOR_EXP_SRC
        23 000503   000523 604000 23                 TMI     s:22692
        23 000504   000000 471400 xsym               LDP1    Z9A8$M$ES$
        23 000505   100031 236100                    LDQ     25,,PR1
        23 000506   020000 316007                    CANQ    8192,DL
        23 000507   000523 600000 23                 TZE     s:22692

      315    22687    1         LINE_LIST$ -> FILL_BUFFER.ISN >= ISN_FOR_EXP_SRC AND
      316    22688    2         Z9A8$M$ES$ -> F$DCB.FCD# THEN DO;

      317    22689    2       ES_WRITE.BUF_ = VECTOR(LINE_LIST$ -> FILL_BUFFER);

  22689 23 000510   000012 720100                    LXL0    10,,PR0
        23 000511   000054 621010                    EAX1    44,X0
        23 000512   000000 635011                    EAA     0,X1
        23 000513   000002 731000                    ARS     2
        23 000514   000140 135007                    SBLA    96,DL
        23 000515   000000 236000 6                  LDQ     LINE_LIST$
        23 000516   000336 757000 16                 STAQ    ES_WRITE+4

      318    22690    2       CALL XSA$WRITE(ES_WRITE, ES_PARAM) ALTRET(WRITE_ES_ERR);

  22690 23 000517   000046 630400 24                 EPPR0   38
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:49   
        23 000520   000003 631400 24                 EPPR1   3
        23 000521   000000 701000 xent               TSX1    XSA$WRITE
        23 000522   000524 702000 23                 TSX2    WRITE_ES_ERR

      319    22691    2     END;

      320    22692    1     RETURN;

  22692 23 000523   000000 702200 xent               TSX2  ! X66_ARET

      321    22693
      322    22694    1   WRITE_ES_ERR:
      323    22695
      324    22696    1     IF ES_PARAM.ERR.CODE ~= 0 THEN

  22696 23 000524   000055 236000 16    WRITE_ES_ERR LDQ     ES_PARAM+1
        23 000525   377770 316007                    CANQ    131064,DL
        23 000526   000533 600000 23                 TZE     s:22699

      325    22697    1       CALL Z9AE$ISSUE_SYSTEM_ERROR(ES_PARAM.ERR, Z9A8$M$ES#);

  22697 23 000527   000022 630400 24                 EPPR0   18
        23 000530   000003 631400 24                 EPPR1   3
        23 000531   000000 701000 xent               TSX1    Z9AE$ISSUE_SYSTEM_ERROR
        23 000532   000000 011000                    NOP     0

      326    22698
      327    22699    1     RETURN;

  22699 23 000533   000000 702200 xent               TSX2  ! X66_ARET
      328    22700
      329    22701    1   END Z9AA$I_O;
      330    22702        %EOD;

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:50   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   XS_MACRO_C.:LIB_E04  is referenced.
   XU_MACRO_C.:LIB_E04  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9AA$I_O.
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:51   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:52   
  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ISN_FOR_EXP_SRC

  ****  Section 011 LblCom LEX_SYMBOL

PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:53   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 012 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 013 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 014 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 015 LblCom END_OF_FILE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 END_OF_FILE

  ****  Section 016  Data  Z9AA$I_O

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:54   

    35-0-0/w STRC(504)   r     1 CLOSE_PARAM              346-0-0/d STRC(1080)  r     1 ES_CLOSE
   164-0-0/d STRC(2088)  r     1 ES_OPEN_INPUT             72-0-0/d STRC(2088)  r     1 ES_OPEN_OUTPUT
    54-0-0/d STRC(504)   r     1 ES_PARAM                 304-0-0/d STRC(144)   r     1 ES_POSITION
   314-0-0/d STRC(504)   r     1 ES_READ                  332-0-0/d STRC(432)   r     1 ES_WRITE
   256-0-0/d STRC(792)   r     1 FPT_UNFID                  0-0-0/b BIT         r     1 NO_FILE_FOUND
     1-0-0/w STRC(504)   r     1 OPEN_PARAM                17-0-0/w STRC(504)   r     1 READ_PARAM
   312-0-0/w SBIN        r     1 SOURCE_FILE_NAME_LENGTH
   310-0-0/c STRC(72)    r     1 VLP_ACCT

  ****  Section 017 LblCom LAST_READ_PARAM_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LAST_READ_PARAM_LEVEL

  ****  Section 018 LblCom INPUT_FILES_OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INPUT_FILES_OPEN

  ****  Section 019 LblCom INPUT_FILE_TYPE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INPUT_FILE_TYPE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FILE_CODE                *0-0-0/w SBIN        r     1 FILE_CODE
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:55   
     4-0-0/c CHAR(256)   r     1 SOURCE_LINE_BUFFER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)        1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)        1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/d STRC(11580)       1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 USERWORD_SCAN_TABLE        0-0-0/w UBIN              1 Z9A8$M$DO#
     0-0-0/w PTR               1 Z9A8$M$DO$                 0-0-0/w UBIN        r     1 Z9A8$M$ES#
     0-0-0/w PTR         r     1 Z9A8$M$ES$                 0-0-0/w UBIN              1 Z9A8$M$LO#
     0-0-0/w PTR               1 Z9A8$M$LO$                 0-0-0/w UBIN              1 Z9A8$M$ME#
     0-0-0/w PTR               1 Z9A8$M$ME$                 0-0-0/w UBIN              1 Z9A8$M$OBJFILE#
     0-0-0/w PTR               1 Z9A8$M$OBJFILE$            0-0-0/w UBIN              1 Z9A8$M$OU#
     0-0-0/w PTR               1 Z9A8$M$OU$                 0-0-0/w UBIN        r     1 Z9A8$M$SI#
     0-0-0/w PTR         r     1 Z9A8$M$SI$                 0-0-0/w UBIN        r     1 Z9A8$M$SO#
     0-0-0/w PTR               1 Z9A8$M$SO$                 0-0-0/w UBIN        r     1 Z9A8$M$UI#
     0-0-0/w PTR               1 Z9A8$M$UI$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z9AA$I_O File=Z9AA.:Z8A6TSI                                   SAT 08/09/97 13:37 Page:56   

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0N  NULL        r     1 M$ES                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$UI
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z9AA$I_O requires 348 words for executable code.
   Procedure Z9AA$I_O requires 74 words of local(AUTO) storage.

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:57   
      331        1        /*T***********************************************************/
      332        2        /*T*                                                         */
      333        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      334        4        /*T*                                                         */
      335        5        /*T***********************************************************/
      336        6        /*-----------------*/
      337        7        Z9AA$OPEN_COPY_FILE:   PROC (COPY_FILE_NAME,
      338        8        /*-----------------*/        COPY_FILE_NAME_LEN,
      339        9                                    COPY_LEVEL,
      340       10                                     LIBRARY_ACCT_NAME,
      341       11                                     LIBRARY_ACCT_NAME_LEN);
      342       12
      343       13    1   DCL COPY_FILE_NAME_LEN SBIN;
      344       14    1   DCL COPY_FILE_NAME CHAR(COPY_FILE_NAME_LEN) ALIGNED;
      345       15    1   DCL COPY_LEVEL SBIN;
      346       16    1   DCL LIBRARY_ACCT_NAME_LEN SBIN;
      347       17    1   DCL LIBRARY_ACCT_NAME CHAR(LIBRARY_ACCT_NAME_LEN) ALIGNED;
      348       18    1   DCL COPY_NAME_DNT$ PTR;
      349       19
      350       20          %EQU DONT_USE_SRCH='0'B;       /* If a COPY account was specified,
      351       21                                            but the file was not present then,
      352       22                                            if DONT_USE_SRCH = TRUE the SRCH
      353       23                                            account(s) must be searched,
      354       24                                            else don't search them          */
      355       25          %EQU BLANKS = ' ';
      356       26          %EQU FILE = 1;
      357       27        %IF DONT_USE_SRCH;
      360       30        %ENDIF;
      361       31
      362       32          %EQU PHASE=1;
      363       33          %INCLUDE Z8A_DEFC;
      364      101          %INCLUDE Z8A_SUPP_MAC;
      365     2501          %INCLUDE Z8A_SYS_FILE;
      366     8776          %INCLUDE Z8A_ERR_NUMS;
      367     9540          %INCLUDE Z8E_BUFFERS;
      368     9730          %INCLUDE B_ERRORS_C;
      369    10856          %INCLUDE XU_MACRO_C;
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:58   
      370    13950          %INCLUDE XUX$INTERFACE_M;
      371    14727
      372    14728    1   DCL I SBIN WORD;
      373    14729
      374    14730    1     DCL Z9AR$ALLOCATE ENTRY(1);
      375    14731    1     DCL Z9AR$RELEASE ENTRY(1);
      376    14732    1   DCL Z8AH$NEW_DNT ENTRY(3);
      377    14733    1   DCL Z8AE$ERROR ENTRY(12);
      378    14734    1   DCL Z9AT$TERMINATOR ENTRY;
      379    14735    1   DCL XUU$OPEN ENTRY(1) ALTRET;
      380    14736
      381    14737        %XUU_PARAM (FPTN=COPY_PARAM,
      382    14738                    BASE=NO,
      383    14739                    INCLUDE=YES,
      384    14740                    ALLOCATE=Z9AR$ALLOCATE,
      385    14741                    RELEASE=Z9AR$RELEASE);
      386    15176
      387    15177        %FPT_OPEN(FPTN=COPY_FILE_OPEN,  FUN=IN,
      388    15178                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE,
      389    15179                  NAME=COPY_FILE_NAME_VLP,
      390    15180                  ACCT=COPY_ACCT_NAME_VLP,
      391    15181                  PASS=COPY_PASS_NAME_VLP,
      392    15182                  WSN=COPY_WSN_NAME_VLP );
      393    15291
      394    15292        %XUX$SRCH_LIST(STCLASS=EXT);
      395    15387
      396    15388        %VLP_TEXTC(FPTN=COPY_FILE_NAME_VLP,STCLASS=STATIC);
      397    15403
      398    15404        %VLP_ACCT(FPTN=COPY_ACCT_NAME_VLP);
      399    15417
      400    15418        %VLP_PASS(FPTN=COPY_PASS_NAME_VLP);
      401    15431
      402    15432        %VLP_WSN(FPTN=COPY_WSN_NAME_VLP);
      403    15445
      404    15446
      405    15447    1   DCL END_OF_FILE BOOLEAN EXT;
      406    15448    1   DCL LAST_READ_PARAM_LEVEL SBIN EXT;
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:59   
      407    15449
      408    15450
      409    15451
      410    15452    1   END_OF_FILE = FALSE;
      411    15453    1   COPY_FILE_NAME_VLP.L# = MINIMUM(30, COPY_FILE_NAME_LEN);
      412    15454    1   COPY_FILE_NAME_VLP.TEXT# = COPY_FILE_NAME;
      413    15455    1   COPY_PARAM.O.FPT_PTR$ = ADDR(COPY_FILE_OPEN);
      414    15456
      415    15457    1   IF ADDR(LIBRARY_ACCT_NAME) ~= ADDR(NIL) THEN
      416    15458    2     DO;
      417    15459    2       COPY_ACCT_NAME_VLP.ACCT# = LIBRARY_ACCT_NAME;
      418    15460    2       COPY_PASS_NAME_VLP.PASS# = %BLANKS;
      419    15461    2       COPY_WSN_NAME_VLP.WSN# = %BLANKS;
      420    15462    2       COPY_FILE_OPEN.V.RES# = %BLANKS;
      421    15463    2       COPY_FILE_OPEN.V.ASN# = %FILE;
      422    15464
      423    15465    2       CALL XUU$OPEN(COPY_PARAM)
      424    15466    3         WHENRETURN DO;
      425    15467    3           RETURN;
      426    15468    3         END;
      427    15469              /* WHENALTRETURN DO ; try using SRCH list ; END ; */
      428    15470
      429    15471        %IF DONT_USE_SRCH;
      430    15472 C            WHENALTRETURN DO;
      431    15473 C              CALL CHECK_OPEN_ERROR(%MISSING_FILE_IS_NOT_OK);
      432    15474 C            END;
      433    15475        %ENDIF;
      434    15476    2     END;
      435    15477        %IF DONT_USE_SRCH;
      436    15478 C      ELSE
      437    15479 C        DO;
      438    15480        %ENDIF;
      439    15481    1   I = 0;
      440    15482
      441    15483    2   DO WHILE I < XUX$SRCH_LIST.NUM;
      442    15484    2     COPY_ACCT_NAME_VLP.ACCT# = XUX$SRCH_LIST.ACCT_LIST.ACCT(I);
      443    15485    2     COPY_PASS_NAME_VLP.PASS# = XUX$SRCH_LIST.ACCT_LIST.PASS(I);
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:60   
      444    15486    2     COPY_WSN_NAME_VLP.WSN# = XUX$SRCH_LIST.ACCT_LIST.WSN(I);
      445    15487    2     COPY_FILE_OPEN.V.RES# = XUX$SRCH_LIST.ACCT_LIST.RES(I);
      446    15488    2     COPY_FILE_OPEN.V.ASN# = XUX$SRCH_LIST.ACCT_LIST.ASN(I);
      447    15489
      448    15490    2     CALL XUU$OPEN(COPY_PARAM)
      449    15491    3       WHENRETURN DO;
      450    15492    3         RETURN;
      451    15493    3       END;
      452    15494
      453    15495    3       WHENALTRETURN DO;
      454    15496              %IF DONT_USE_SRCH;
      455    15497 C            CALL CHECK_OPEN_ERROR(%E$MISSING_FILE_OK);
      456    15498              %ELSE;
      457    15499    3         IF COPY_PARAM.FLAGS.XUU_ERR# = TRUE THEN
      458    15500                /* Need a separate message here: COMPILER ERROR
      459    15501                   Problem in arg format for call               */
      460    15502    3           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      461    15503              %ENDIF;
      462    15504    3         I = I + 1;
      463    15505    3       END;
      464    15506    2   END; /* DO WHILE */
      465    15507
      466    15508        /* Search list is exhausted and no file was found */
      467    15509    1   CALL Z8AH$NEW_DNT (COPY_FILE_NAME, COPY_FILE_NAME_LEN, COPY_NAME_DNT$);
      468    15510    1   CALL Z8AE$ERROR (%E$MISSING_COPY_FILE1, , , COPY_NAME_DNT$);
      469    15511          %IF DONT_USE_SRCH;
      470    15512 C        END;
      471    15513 C
      472    15514 C      CHECK_OPEN_ERROR: PROC (MISSING_FILE_OK);
      473    15515 C
      474    15516 C          DCL MISSING_FILE_OK BIT(1) ALIGNED;
      475    15517 C
      476    15518 C          IF COPY_PARAM.FLAGS.XUU_ERR# = TRUE THEN
      477    15519 C            /* Need a separate message here: COMPILER ERROR
      478    15520 C               Problem in arg format for call               */
      479    15521 C            CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      480    15522 C          ELSE
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:61   
      481    15523 C            DO;
      482    15524 C              IF COPY_PARAM.O.INCL_ERRCODE.ERR# = %E$NOFILE AND
      483    15525 C                 NOT MISSING_FILE_OK THEN
      484    15526 C                DO;
      485    15527 C                  CALL Z8AE$ERROR(%E$MISSING_COPY_FILE2);
      486    15528 C                END;
      487    15529 C            END;
      488    15530 C      END CHECK_OPEN_ERROR;
      489    15531        %ENDIF;
      490    15532    1   END Z9AA$OPEN_COPY_FILE;

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:62   
--  Include file information  --

   XUX$INTERFACE_M.:LIB_E04  is referenced.
   XU_MACRO_C.:LIB_E04  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9AA$OPEN_COPY_FILE.

   Procedure Z9AA$OPEN_COPY_FILE requires 102 words for executable code.
   Procedure Z9AA$OPEN_COPY_FILE requires 14 words of local(AUTO) storage.

    No errors detected in file Z9AA.:Z8A6TSI    .

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:63   

 Object Unit name= Z9AA$OPEN_COPY_FILE                        File name= Z9AA.:Z8A6TOU
 UTS= AUG 09 '97 13:40:01.12 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1   DCB   even  none     0      0  M$UC
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11   Data  even  none    86    126  Z9AA$OPEN_COPY_FILE
   12  LblCom even  none   192    300  XUX$SRCH_LIST
   13  LblCom even  none     1      1  END_OF_FILE
   14  LblCom even  none     1      1  LAST_READ_PARAM_LEVEL
   15   Proc  even  none   102    146  Z9AA$OPEN_COPY_FILE
   16  RoData even  none    11     13  Z9AA$OPEN_COPY_FILE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    15      0   yes            yes      Std        5  Z9AA$OPEN_COPY_FILE
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:64   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z9AR$ALLOCATE
         yes           Std       1 Z9AR$RELEASE
 yes     yes           Std       1 XUU$OPEN
         yes           Std      12 Z8AE$ERROR
         yes           Std       3 Z8AH$NEW_DNT
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:65   


      331        1        /*T***********************************************************/
      332        2        /*T*                                                         */
      333        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      334        4        /*T*                                                         */
      335        5        /*T***********************************************************/
      336        6        /*-----------------*/
      337        7        Z9AA$OPEN_COPY_FILE:   PROC (COPY_FILE_NAME,

      7 15 000000   000000 700200 xent  Z9AA$OPEN_C* TSX0  ! X66_AUTO_5
        15 000001   000016 000005                    ZERO    14,5

      338        8        /*-----------------*/        COPY_FILE_NAME_LEN,
      339        9                                    COPY_LEVEL,
      340       10                                     LIBRARY_ACCT_NAME,
      341       11                                     LIBRARY_ACCT_NAME_LEN);
      342       12
      343       13    1   DCL COPY_FILE_NAME_LEN SBIN;
      344       14    1   DCL COPY_FILE_NAME CHAR(COPY_FILE_NAME_LEN) ALIGNED;
      345       15    1   DCL COPY_LEVEL SBIN;
      346       16    1   DCL LIBRARY_ACCT_NAME_LEN SBIN;
      347       17    1   DCL LIBRARY_ACCT_NAME CHAR(LIBRARY_ACCT_NAME_LEN) ALIGNED;
      348       18    1   DCL COPY_NAME_DNT$ PTR;
      349       19
      350       20          %EQU DONT_USE_SRCH='0'B;       /* If a COPY account was specified,
      351       21                                            but the file was not present then,
      352       22                                            if DONT_USE_SRCH = TRUE the SRCH
      353       23                                            account(s) must be searched,
      354       24                                            else don't search them          */
      355       25          %EQU BLANKS = ' ';
      356       26          %EQU FILE = 1;
      357       27        %IF DONT_USE_SRCH;
      360       30        %ENDIF;
      361       31
      362       32          %EQU PHASE=1;
      363       33          %INCLUDE Z8A_DEFC;
      364      101          %INCLUDE Z8A_SUPP_MAC;
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:66   
      365     2501          %INCLUDE Z8A_SYS_FILE;
      366     8776          %INCLUDE Z8A_ERR_NUMS;
      367     9540          %INCLUDE Z8E_BUFFERS;
      368     9730          %INCLUDE B_ERRORS_C;
      369    10856          %INCLUDE XU_MACRO_C;
      370    13950          %INCLUDE XUX$INTERFACE_M;
      371    14727
      372    14728    1   DCL I SBIN WORD;
      373    14729
      374    14730    1     DCL Z9AR$ALLOCATE ENTRY(1);
      375    14731    1     DCL Z9AR$RELEASE ENTRY(1);
      376    14732    1   DCL Z8AH$NEW_DNT ENTRY(3);
      377    14733    1   DCL Z8AE$ERROR ENTRY(12);
      378    14734    1   DCL Z9AT$TERMINATOR ENTRY;
      379    14735    1   DCL XUU$OPEN ENTRY(1) ALTRET;
      380    14736
      381    14737        %XUU_PARAM (FPTN=COPY_PARAM,
      382    14738                    BASE=NO,
      383    14739                    INCLUDE=YES,
      384    14740                    ALLOCATE=Z9AR$ALLOCATE,
      385    14741                    RELEASE=Z9AR$RELEASE);
      386    15176
      387    15177        %FPT_OPEN(FPTN=COPY_FILE_OPEN,  FUN=IN,
      388    15178                  ACS=SEQUEN, CTG=NO, ORG=CONSEC, ASN=FILE,
      389    15179                  NAME=COPY_FILE_NAME_VLP,
      390    15180                  ACCT=COPY_ACCT_NAME_VLP,
      391    15181                  PASS=COPY_PASS_NAME_VLP,
      392    15182                  WSN=COPY_WSN_NAME_VLP );
      393    15291
      394    15292        %XUX$SRCH_LIST(STCLASS=EXT);
      395    15387
      396    15388        %VLP_TEXTC(FPTN=COPY_FILE_NAME_VLP,STCLASS=STATIC);
      397    15403
      398    15404        %VLP_ACCT(FPTN=COPY_ACCT_NAME_VLP);
      399    15417
      400    15418        %VLP_PASS(FPTN=COPY_PASS_NAME_VLP);
      401    15431
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:67   
      402    15432        %VLP_WSN(FPTN=COPY_WSN_NAME_VLP);
      403    15445
      404    15446
      405    15447    1   DCL END_OF_FILE BOOLEAN EXT;
      406    15448    1   DCL LAST_READ_PARAM_LEVEL SBIN EXT;
      407    15449
      408    15450
      409    15451
      410    15452    1   END_OF_FILE = FALSE;

  15452 15 000002   000000 450000 13                 STZ     END_OF_FILE

      411    15453    1   COPY_FILE_NAME_VLP.L# = MINIMUM(30, COPY_FILE_NAME_LEN);

  15453 15 000003   200004 470500                    LDP0    @COPY_FILE_NAME_LEN,,AUTO
        15 000004   000000 236100                    LDQ     0,,PR0
        15 000005   000036 116007                    CMPQ    30,DL
        15 000006   000010 604400 15                 TMOZ    s:15453+5
        15 000007   000036 236007                    LDQ     30,DL
        15 000010   000033 736000                    QLS     27
        15 000011   000110 552040 11                 STBQ    COPY_FILE_NAME_VLP,'40'O

      412    15454    1   COPY_FILE_NAME_VLP.TEXT# = COPY_FILE_NAME;

  15454 15 000012   000000 720100                    LXL0    0,,PR0
        15 000013   200003 471500                    LDP1    @COPY_FILE_NAME,,AUTO
        15 000014   040000 100540                    MLR     fill='040'O
        15 000015   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        15 000016   000110 200037 11                 ADSC9   COPY_FILE_NAME_VLP       cn=1,n=31

      413    15455    1   COPY_PARAM.O.FPT_PTR$ = ADDR(COPY_FILE_OPEN);

  15455 15 000017   000000 236000 16                 LDQ     0
        15 000020   000004 756000 11                 STQ     COPY_PARAM+4

      414    15456
      415    15457    1   IF ADDR(LIBRARY_ACCT_NAME) ~= ADDR(NIL) THEN
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:68   

  15457 15 000021   200006 236100                    LDQ     @LIBRARY_ACCT_NAME,,AUTO
        15 000022   000001 116000 16                 CMPQ    1
        15 000023   000051 600000 15                 TZE     s:15481

      416    15458    2     DO;

      417    15459    2       COPY_ACCT_NAME_VLP.ACCT# = LIBRARY_ACCT_NAME;

  15459 15 000024   200007 473500                    LDP3    @LIBRARY_ACCT_NAME_LEN,,AUTO
        15 000025   300000 720100                    LXL0    0,,PR3
        15 000026   200006 474500                    LDP4    @LIBRARY_ACCT_NAME,,AUTO
        15 000027   040000 100540                    MLR     fill='040'O
        15 000030   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
        15 000031   000120 000010 11                 ADSC9   COPY_ACCT_NAME_VLP       cn=0,n=8

      418    15460    2       COPY_PASS_NAME_VLP.PASS# = %BLANKS;

  15460 15 000032   000002 235000 16                 LDA     2
        15 000033   000002 236000 16                 LDQ     2
        15 000034   000122 757000 11                 STAQ    COPY_PASS_NAME_VLP

      419    15461    2       COPY_WSN_NAME_VLP.WSN# = %BLANKS;

  15461 15 000035   000002 235000 16                 LDA     2
        15 000036   000002 236000 16                 LDQ     2
        15 000037   000124 757000 11                 STAQ    COPY_WSN_NAME_VLP

      420    15462    2       COPY_FILE_OPEN.V.RES# = %BLANKS;

  15462 15 000040   000002 236000 16                 LDQ     2
        15 000041   000066 756000 11                 STQ     COPY_FILE_OPEN+40

      421    15463    2       COPY_FILE_OPEN.V.ASN# = %FILE;

  15463 15 000042   000001 236007                    LDQ     1,DL
        15 000043   000063 552004 11                 STBQ    COPY_FILE_OPEN+37,'04'O
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:69   

      422    15464
      423    15465    2       CALL XUU$OPEN(COPY_PARAM)

  15465 15 000044   000004 630400 16                 EPPR0   4
        15 000045   000003 631400 16                 EPPR1   3
        15 000046   000000 701000 xent               TSX1    XUU$OPEN
        15 000047   000051 702000 15                 TSX2    s:15481

      424    15466    3         WHENRETURN DO;

      425    15467    3           RETURN;

  15467 15 000050   000000 702200 xent               TSX2  ! X66_ARET

      426    15468    3         END;
      427    15469              /* WHENALTRETURN DO ; try using SRCH list ; END ; */
      428    15470
      429    15471        %IF DONT_USE_SRCH;
      430    15472 C            WHENALTRETURN DO;
      431    15473 C              CALL CHECK_OPEN_ERROR(%MISSING_FILE_IS_NOT_OK);
      432    15474 C            END;
      433    15475        %ENDIF;
      434    15476    2     END;

      435    15477        %IF DONT_USE_SRCH;
      436    15478 C      ELSE
      437    15479 C        DO;
      438    15480        %ENDIF;
      439    15481    1   I = 0;

  15481 15 000051   200011 450100                    STZ     I,,AUTO

      440    15482
      441    15483    2   DO WHILE I < XUX$SRCH_LIST.NUM;

  15483 15 000052   200011 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:70   
        15 000053   000056 604000 15                 TMI     s:15484
        15 000054   000000 116000 12                 CMPQ    XUX$SRCH_LIST
        15 000055   000122 603000 15                 TRC     s:15509

      442    15484    2     COPY_ACCT_NAME_VLP.ACCT# = XUX$SRCH_LIST.ACCT_LIST.ACCT(I);

  15484 15 000056   200011 236100                    LDQ     I,,AUTO
        15 000057   000114 402007                    MPY     76,DL
        15 000060   040000 100406                    MLR     fill='040'O
        15 000061   000002 000010 12                 ADSC9   XUX$SRCH_LIST+2,Q        cn=0,n=8
        15 000062   000120 000010 11                 ADSC9   COPY_ACCT_NAME_VLP       cn=0,n=8

      443    15485    2     COPY_PASS_NAME_VLP.PASS# = XUX$SRCH_LIST.ACCT_LIST.PASS(I);

  15485 15 000063   040000 100406                    MLR     fill='040'O
        15 000064   000004 000010 12                 ADSC9   XUX$SRCH_LIST+4,Q        cn=0,n=8
        15 000065   000122 000010 11                 ADSC9   COPY_PASS_NAME_VLP       cn=0,n=8

      444    15486    2     COPY_WSN_NAME_VLP.WSN# = XUX$SRCH_LIST.ACCT_LIST.WSN(I);

  15486 15 000066   040000 100406                    MLR     fill='040'O
        15 000067   000010 400010 12                 ADSC9   XUX$SRCH_LIST+8,Q        cn=2,n=8
        15 000070   000124 000010 11                 ADSC9   COPY_WSN_NAME_VLP        cn=0,n=8

      445    15487    2     COPY_FILE_OPEN.V.RES# = XUX$SRCH_LIST.ACCT_LIST.RES(I);

  15487 15 000071   200011 236100                    LDQ     I,,AUTO
        15 000072   000023 402007                    MPY     19,DL
        15 000073   000014 236006 12                 LDQ     XUX$SRCH_LIST+12,QL
        15 000074   000066 756000 11                 STQ     COPY_FILE_OPEN+40

      446    15488    2     COPY_FILE_OPEN.V.ASN# = XUX$SRCH_LIST.ACCT_LIST.ASN(I);

  15488 15 000075   200011 236100                    LDQ     I,,AUTO
        15 000076   000023 402007                    MPY     19,DL
        15 000077   000013 236006 12                 LDQ     XUX$SRCH_LIST+11,QL
        15 000100   000033 772000                    QRL     27
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:71   
        15 000101   000063 552004 11                 STBQ    COPY_FILE_OPEN+37,'04'O

      447    15489
      448    15490    2     CALL XUU$OPEN(COPY_PARAM)

  15490 15 000102   000004 630400 16                 EPPR0   4
        15 000103   000003 631400 16                 EPPR1   3
        15 000104   000000 701000 xent               TSX1    XUU$OPEN
        15 000105   000107 702000 15                 TSX2    s:15499

      449    15491    3       WHENRETURN DO;

      450    15492    3         RETURN;

  15492 15 000106   000000 702200 xent               TSX2  ! X66_ARET

      451    15493    3       END;
      452    15494
      453    15495    3       WHENALTRETURN DO;

      454    15496              %IF DONT_USE_SRCH;
      455    15497 C            CALL CHECK_OPEN_ERROR(%E$MISSING_FILE_OK);
      456    15498              %ELSE;
      457    15499    3         IF COPY_PARAM.FLAGS.XUU_ERR# = TRUE THEN

  15499 15 000107   000000 430000 11                 FSZN    COPY_PARAM
        15 000110   000115 605000 15                 TPL     s:15504

      458    15500                /* Need a separate message here: COMPILER ERROR
      459    15501                   Problem in arg format for call               */
      460    15502    3           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  15502 15 000111   000006 630400 16                 EPPR0   6
        15 000112   000003 631400 16                 EPPR1   3
        15 000113   000000 701000 xent               TSX1    Z8AE$ERROR
        15 000114   000000 011000                    NOP     0

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:72   
      461    15503              %ENDIF;
      462    15504    3         I = I + 1;

  15504 15 000115   200011 054100                    AOS     I,,AUTO

      463    15505    3       END;

      464    15506    2   END; /* DO WHILE */

  15506 15 000116   200011 236100                    LDQ     I,,AUTO
        15 000117   000056 604000 15                 TMI     s:15484
        15 000120   000000 116000 12                 CMPQ    XUX$SRCH_LIST
        15 000121   000056 602000 15                 TNC     s:15484

      465    15507
      466    15508        /* Search list is exhausted and no file was found */
      467    15509    1   CALL Z8AH$NEW_DNT (COPY_FILE_NAME, COPY_FILE_NAME_LEN, COPY_NAME_DNT$);

  15509 15 000122   200010 630500                    EPPR0   COPY_NAME_DNT$,,AUTO
        15 000123   200014 450500                    STP0    I+3,,AUTO
        15 000124   200004 236100                    LDQ     @COPY_FILE_NAME_LEN,,AUTO
        15 000125   200003 235100                    LDA     @COPY_FILE_NAME,,AUTO
        15 000126   200012 757100                    STAQ    I+1,,AUTO
        15 000127   200012 630500                    EPPR0   I+1,,AUTO
        15 000130   000007 631400 16                 EPPR1   7
        15 000131   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        15 000132   000000 011000                    NOP     0

      468    15510    1   CALL Z8AE$ERROR (%E$MISSING_COPY_FILE1, , , COPY_NAME_DNT$);

  15510 15 000133   200010 630500                    EPPR0   COPY_NAME_DNT$,,AUTO
        15 000134   200015 450500                    STP0    I+4,,AUTO
        15 000135   000001 236000 16                 LDQ     1
        15 000136   200014 756100                    STQ     I+3,,AUTO
        15 000137   000012 235000 16                 LDA     10
        15 000140   200012 757100                    STAQ    I+1,,AUTO
        15 000141   200012 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:73   
        15 000142   000010 631400 16                 EPPR1   8
        15 000143   000000 701000 xent               TSX1    Z8AE$ERROR
        15 000144   000000 011000                    NOP     0

      469    15511          %IF DONT_USE_SRCH;
      470    15512 C        END;
      471    15513 C
      472    15514 C      CHECK_OPEN_ERROR: PROC (MISSING_FILE_OK);
      473    15515 C
      474    15516 C          DCL MISSING_FILE_OK BIT(1) ALIGNED;
      475    15517 C
      476    15518 C          IF COPY_PARAM.FLAGS.XUU_ERR# = TRUE THEN
      477    15519 C            /* Need a separate message here: COMPILER ERROR
      478    15520 C               Problem in arg format for call               */
      479    15521 C            CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      480    15522 C          ELSE
      481    15523 C            DO;
      482    15524 C              IF COPY_PARAM.O.INCL_ERRCODE.ERR# = %E$NOFILE AND
      483    15525 C                 NOT MISSING_FILE_OK THEN
      484    15526 C                DO;
      485    15527 C                  CALL Z8AE$ERROR(%E$MISSING_COPY_FILE2);
      486    15528 C                END;
      487    15529 C            END;
      488    15530 C      END CHECK_OPEN_ERROR;
      489    15531        %ENDIF;
      490    15532    1   END Z9AA$OPEN_COPY_FILE;

  15532 15 000145   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:74   
--  Include file information  --

   XUX$INTERFACE_M.:LIB_E04  is referenced.
   XU_MACRO_C.:LIB_E04  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z9AA$OPEN_COPY_FILE.
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:75   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:76   
  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 011  Data  Z9AA$OPEN_COPY_FILE

PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:77   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   120-0-0/c STRC(72)    r     1 COPY_ACCT_NAME_VLP       110-0-0/c STRC(288)   r     1 COPY_FILE_NAME_VLP
    16-0-0/d STRC(2088)  r     1 COPY_FILE_OPEN             0-0-0/w STRC(504)   r     1 COPY_PARAM
   122-0-0/c STRC(72)    r     1 COPY_PASS_NAME_VLP       124-0-0/c STRC(72)    r     1 COPY_WSN_NAME_VLP

  ****  Section 012 LblCom XUX$SRCH_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(6912)  r     1 XUX$SRCH_LIST

  ****  Section 013 LblCom END_OF_FILE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 END_OF_FILE

  ****  Section 014 LblCom LAST_READ_PARAM_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LAST_READ_PARAM_LEVEL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @COPY_FILE_NAME            4-0-0/w PTR         r     1 @COPY_FILE_NAME_LEN
     5-0-0/w PTR         r     1 @COPY_LEVEL                6-0-0/w PTR         r     1 @LIBRARY_ACCT_NAME
     7-0-0/w PTR         r     1 @LIBRARY_ACCT_NAME_LEN
    *0-0-0/w ACHR        r     1 COPY_FILE_NAME            *0-0-0/w SBIN        r     1 COPY_FILE_NAME_LEN
PL6.E3A0      #002=Z9AA$OPEN_COPY_FILE File=Z9AA.:Z8A6TSI                        SAT 08/09/97 13:40 Page:78   
    *0-0-0/w SBIN        r     1 COPY_LEVEL                10-0-0/w PTR         r     1 COPY_NAME_DNT$
    11-0-0/w SBIN        r     1 I                         *0-0-0/w ACHR        r     1 LIBRARY_ACCT_NAME
    *0-0-0/w SBIN        r     1 LIBRARY_ACCT_NAME_LEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR              1 BUFFER_LINE                0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(36864)       1 PAGE


   Procedure Z9AA$OPEN_COPY_FILE requires 102 words for executable code.
   Procedure Z9AA$OPEN_COPY_FILE requires 14 words of local(AUTO) storage.

    No errors detected in file Z9AA.:Z8A6TSI    .
