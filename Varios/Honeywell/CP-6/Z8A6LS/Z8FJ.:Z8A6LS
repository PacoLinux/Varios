VERSION A06

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:1    
        1        1        /*M*  Z8FJ$SEGMENT_SUBS---To reset the switches */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*
       10       10               NAME:  Z8FJ$SEGMENT_SUBS
       11       11             AUTHOR:  Min Lee
       12       12            PURPOSE:  This procedure will generate the subroutines and the
       13       13                      subroutine calls to refresh the alter switches in the
       14       14                      independent segments.
       15       15        */
       16       16
       17       17        /*D*
       18       18               NAME:  Z8FJ$SEGMENT_SUBS.
       19       19               CALL:  CALL Z8FJ$SEGMENT_SUBS.
       20       20          INTERFACE:  Z8AT$CREATE_TEMPORARY--Call to get a new label item.
       21       21                      Z8AF$NEW_BASE---called to set up BASE ITEM.
       22       22
       23       23        DESCRIPTION:  This procedure creates the subroutines that will refresh
       24       24                      the alter switches in the independent segments, put them
       25       25                      on the top of the procedure division and then generates the
       26       26                      subroutine calls for the GO TO statements or the SECTION
       27       27                      HEADERs for which the program flow might transfer
       28       28                      into a different independent segment.
       29       29        */
       30       30         /*=================*/
       31       31           Z8FJ$SEGMENT_SUBS: PROC;
       32       32         /*=================*/
       33       33
       34       34
       35       35        %EQU PHASE = 2 ;
       36       36
       37       37        %INCLUDE Z8A_DEFC ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:2    
       38      105        %INCLUDE Z8A_SUPP_MAC ;
       39     2505        %INCLUDE Z9A_SUPP_MAC;
       40     2794        %INCLUDE Z8A_COMCOM ;
       41     3444        %INCLUDE Z8A_DNT ;
       42     3665        %INCLUDE Z8A_ERR_NUMS ;
       43     4429        %INCLUDE Z8A_ETT ;
       44     4730        %INCLUDE Z8A_LTS ;
       45     6807        %INCLUDE Z8F_O2COM ;
       46     6917        %INCLUDE Z8A_ST ;
       47    10576        %INCLUDE Z8A_TYPES ;
       48    10750        %INCLUDE Z8A_ILL ;
       49    11443        %INCLUDE Z8A_ILS ;
       50    11552        %INCLUDE Z8A_LIBRARY ;
       51    11766        %INCLUDE Z8A_MKCN;
       52    11783
       53    11784        %EJECT ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:3    
       54    11785    1   DCL Z8AC$MAKE_CONST     ENTRY (1);
       55    11786    1   DCL Z8AT$CREATE_TEMPORARY  ENTRY (2);
       56    11787    1   DCL Z8AF$NEW_BASE          ENTRY (3);
       57    11788
       58    11789    1   DCL CURRENT_PROC$  PTR;
       59    11790    1   DCL TRA_END_LABEL$  PTR;
       60    11791    1   DCL RESET_SUB$     PTR;
       61    11792    1   DCL RESET_SUB_TAIL$    PTR;
       62    11793    1   DCL CURRENT_ENTRY$     PTR;
       63    11794    1   DCL TEMP$              PTR;
       64    11795    1   DCL SUB_TAIL$          PTR;
       65    11796    1   DCL LAST_LABEL$        PTR;
       66    11797    1   DCL CALL_LABEL$        PTR;
       67    11798    1   DCL SEG_NO#            SBIN WORD;
       68    11799    1   DCL CURRENT_ARRAY$     PTR;
       69    11800    1   DCL PREV_ILS$          PTR;
       70    11801    1   DCL ENTRY_LINOI$       PTR;
       71    11802    1   DCL ENTRY_LABEL$       PTR;
       72    11803    1   DCL SEG_LTS$           PTR;
       73    11804
       74    11805        %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:4    
       75    11806
       76    11807         %MACRO GET_ENTRY (@START = ILS$,
       77    11808                           @RTN   = CURRENT_ENTRY$);
       78    11809           DO;
       79    11810             @RTN = ADDR(NIL);
       80    11811             TEMP$ = @START -> ILS.NEXT;
       81    11812             ENTRY_LINOI$ = TEMP$;
       82    11813
       83    11814             DO WHILE (TEMP$ ~= ADDR(NIL));
       84    11815
       85    11816               IF TEMP$ -> ILS.ILL$ -> ILL.ID = %ENTRY AND
       86    11817                   (TEMP$ -> ILS.ILL$ -> ENTRY_ILL.CODE = %MAIN_PROGRAM OR
       87    11818                    TEMP$ -> ILS.ILL$ -> ENTRY_ILL.CODE = %SUBROUTINE)  THEN
       88    11819                 DO;
       89    11820                   @RTN = TEMP$;
       90    11821                   TEMP$ = ADDR(NIL);
       91    11822                 END;
       92    11823               ELSE
       93    11824                        /*  END OF THE PROGRAM -- NEXT PROGRAM BEGIN */
       94    11825                 IF TEMP$ -> ILS.ILL$ -> ILL.ID = %SCOPE AND
       95    11826                    TEMP$ -> ILS.ILL$ -> SCOPE.CODE = %PROGRAM_SCOPE THEN
       96    11827                   TEMP$ = ADDR(NIL);
       97    11828
       98    11829                 ELSE
       99    11830                   DO;
      100    11831                     ENTRY_LINOI$ = TEMP$;
      101    11832                     TEMP$ = TEMP$ -> ILS.NEXT;
      102    11833                   END;
      103    11834
      104    11835             END; /* WHILE */
      105    11836           END;
      106    11837         %MEND;
      107    11838         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:5    
      108    11839
      109    11840         %MACRO RSV_ILS_ILL (@ILS_ITEM = %OPN,
      110    11841                             @ILL_ITEM = %LINOI);
      111    11842           DO;
      112    11843             %RESERVE_ILS (ITEM = @ILS_ITEM,
      113    11844                           POINTER = SUB_TAIL$ -> ILS.NEXT);
      114    11845
      115    11846             %RESERVE_ILL (ITEM = @ILL_ITEM,
      116    11847                           POINTER = SUB_TAIL$ -> ILS.NEXT -> ILS.ILL$);
      117    11848
      118    11849             SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;
      119    11850           END;
      120    11851         %MEND;
      121    11852
      122    11853
      123    11854         %MACRO USE_PROC_TAILER;
      124    11855           DO;
      125    11856              %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      126    11857
      127    11858               SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      128    11859
      129    11860              %RSV_ILS_ILL (@ILL_ITEM = %USE_END);
      130    11861
      131    11862               SUB_TAIL$ -> ILS.ILL$ -> ILL.CODE = %USE_LOCAL;
      132    11863               SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);
      133    11864           END;
      134    11865         %MEND;
      135    11866         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:6    
      136    11867
      137    11868         %MACRO USE_HEADER;
      138    11869           DO;
      139    11870             CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL_USE$);
      140    11871
      141    11872             LABEL_USE$ -> LABEL.B.REFERENCED = TRUE;
      142    11873             LABEL_USE$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      143    11874             LABEL_USE$ -> LABEL.PROC$ = CURRENT_PROC$;
      144    11875
      145    11876             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      146    11877
      147    11878             SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      148    11879
      149    11880             %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      150    11881
      151    11882             SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = LABEL_USE$;
      152    11883
      153    11884             %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);
      154    11885
      155    11886           END;
      156    11887         %MEND;
      157    11888         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:7    
      158    11889
      159    11890         %MACRO USE_PROC_HEADER;
      160    11891           DO;
      161    11892             %USE_HEADER;
      162    11893
      163    11894             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      164    11895
      165    11896             SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      166    11897
      167    11898             %RSV_ILS_ILL (@ILL_ITEM = %USE_ENTRY);
      168    11899
      169    11900             SUB_TAIL$ -> ILS.ILL$ -> ILL.CODE = %USE_LOCAL;
      170    11901             SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);
      171    11902           END;
      172    11903         %MEND;
      173    11904         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:8    
      174    11905
      175    11906         %MACRO UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$,
      176    11907                            @UPDATE$  = LAST_LABEL$);
      177    11908           DO;
      178    11909             IF @UPDATE$ = ADDR(NIL) THEN
      179    11910               DO;
      180    11911                 @LBL_ILS$ -> ILS.ILL$ -> DEFLB.LBL = COMCOM.H_LBL;
      181    11912                 COMCOM.H_LBL = @LBL_ILS$;
      182    11913               END;
      183    11914             ELSE
      184    11915               DO;
      185    11916                 @LBL_ILS$ -> ILS.ILL$ -> DEFLB.LBL = @UPDATE$ -> ILS.ILL$ -> DEFLB.LBL;
      186    11917                 @UPDATE$ -> ILS.ILL$ -> DEFLB.LBL = @LBL_ILS$;
      187    11918               END;
      188    11919
      189    11920               @UPDATE$ = @LBL_ILS$;
      190    11921
      191    11922           END;
      192    11923         %MEND;
      193    11924         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:9    
      194    11925
      195    11926         /*================*/
      196    11927    1      GEN_ALTER_RESETS: PROC (PROC$, SUB$, SUB_TAIL$, ARRAY$);
      197    11928         /*================*/
      198    11929
      199    11930         /*I*
      200    11931               NAME: GEN_ALTER_RESETS
      201    11932
      202    11933          DESCRIPTION: This routine steps through a pointer array that point
      203    11934                       to the ILS items needed to refresh the independent
      204    11935                       segments and use these ILS items to build up the
      205    11936                       subroutines that will be called on run time to refresh
      206    11937                       the alter switches.
      207    11938                       These ILS item created in Z8FL$LABEL_REFERENCE and
      208    11939                       saved on the pointer array.
      209    11940         */
      210    11941
      211    11942    2   DCL PROC$              PTR;
      212    11943    2   DCL SUB$               PTR;
      213    11944    2   DCL SUB_TAIL$          PTR;
      214    11945    2   DCL ARRAY$             PTR;
      215    11946    2   DCL LABEL_END$         PTR;
      216    11947    2   DCL LABEL_USE$         PTR;
      217    11948    2   DCL I                  SBIN WORD;
      218    11949    2   DCL SEG_LTS$           PTR;
      219    11950    2   DCL INIT_SUB$          PTR;
      220    11951    2   DCL LAST_SUB$          PTR;
      221    11952
      222    11953
      223    11954    2      ARRAY$ = PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$;
      224    11955
      225    11956    2      CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL_END$);
      226    11957
      227    11958    2      LABEL_END$ -> LABEL.B.REFERENCED = TRUE;
      228    11959    2      LABEL_END$ -> LABEL.B.GOTO_LABEL    = TRUE;
      229    11960    2      LABEL_END$ -> LABEL.B.ONE_REF = TRUE;
      230    11961    2      LABEL_END$ -> LABEL.PROC$        = PROC$;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:10   
      231    11962
      232    11963           %RESERVE_ILS (ITEM = %OPN, POINTER = SUB$);
      233    11992
      234    11993           %RESERVE_ILL (ITEM = %LINOI, POINTER = SUB$ -> ILS.ILL$);
      235    12003
      236    12004    2      SUB$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      237    12005    2      SUB_TAIL$ = SUB$;
      238    12006
      239    12007           %RSV_ILS_ILL (@ILL_ITEM = %GO);
      240    12053
      241    12054    2      SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_UNCONDITIONAL;
      242    12055    2      SUB_TAIL$ -> ILS.ILL$ -> GO.LABEL$ = LABEL_END$;
      243    12056    2      SUB_TAIL$ -> ILS.ILL$ -> GO.EXPR$ = ADDR(NIL);
      244    12057
      245    12058    3      DO I = %MAX_FIXED_SEG# + 1 TO %MAX_SEG#;
      246    12059    3        IF ARRAY$ -> LTS_PTR_ARRAY.P$(I) ~= ADDR(NIL) THEN
      247    12060    4          DO;
      248    12061    4            SEG_LTS$ = ARRAY$ -> LTS_PTR_ARRAY.P$(I);
      249    12062    4            INIT_SUB$ = SUB_TAIL$;   /* for optimize the subroutine */
      250    12063
      251    12064                 %USE_PROC_HEADER;
      252    12280
      253    12281    4            LAST_SUB$ = SUB_TAIL$;
      254    12282
      255    12283    5            DO WHILE (SEG_LTS$ ~= ADDR(NIL));
      256    12284    5              IF SEG_LTS$ -> SEGMENT_LTS.SECTION_ST$ -> SECTION.PROC$ = PROC$ AND
      257    12285    5                SEG_LTS$ -> SEGMENT_LTS.ALTER_RESET$ ~= ADDR(NIL) THEN
      258    12286    6                DO;
      259    12287    6                  SUB_TAIL$ -> ILS.NEXT = SEG_LTS$ -> SEGMENT_LTS.ALTER_RESET$;
      260    12288
      261    12289    7                  DO WHILE (SUB_TAIL$ -> ILS.NEXT ~= ADDR(NIL));
      262    12290
      263    12291    7                    IF SUB_TAIL$ -> ILS.ILL$ -> ILL.ID = %LINOI THEN
      264    12292    7                       SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      265    12293
      266    12294    7                    SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;
      267    12295
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:11   
      268    12296    7                  END;
      269    12297    6                END; /* IF */
      270    12298
      271    12299    5              SEG_LTS$ = SEG_LTS$ -> SEGMENT_LTS.NEXT;
      272    12300    5            END; /* WHILE */
      273    12301
      274    12302    4            IF SUB_TAIL$ = LAST_SUB$ THEN  /* no reset altered GO */
      275    12303    5              DO;
      276    12304                     /* drop the use proc header */
      277    12305    5                SUB_TAIL$ = INIT_SUB$;
      278    12306    5                SUB_TAIL$ -> ILS.NEXT = ADDR(NIL);
      279    12307    5              END;
      280    12308    4            ELSE
      281    12309    5              DO;
      282    12310                       /* save the use proc header's label */
      283    12311    5                ARRAY$ -> LTS_PTR_ARRAY.P$(I) -> SEGMENT_LTS.SUB_LABEL$ =
      284    12312    5                  LABEL_USE$;
      285    12313
      286    12314                     %USE_PROC_TAILER;
      287    12413    5              END;
      288    12414
      289    12415    4          END;  /* IF DO */
      290    12416    3        END; /* DO I=...*/
      291    12417
      292    12418
      293    12419    2        LABEL_END$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      294    12420
      295    12421             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      296    12467
      297    12468    2        SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      298    12469
      299    12470             %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      300    12516
      301    12517    2        SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = LABEL_END$;
      302    12518
      303    12519             %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);
      304    12534
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:12   
      305    12535    2        IF SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL ~= ADDR(NIL) AND
      306    12536    2          SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL -> ILS.ILL$ -> ILL.LOP ->
      307    12537    2          LABEL.PREV_ILS$ = CURRENT_ENTRY$ THEN
      308    12538    2          SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL -> ILS.ILL$ -> ILL.LOP ->
      309    12539    2          LABEL.PREV_ILS$ = SUB_TAIL$;
      310    12540
      311    12541
      312    12542    2    END GEN_ALTER_RESETS;
      313    12543         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:13   
      314    12544
      315    12545         /*==========*/
      316    12546    1      GO_SEG_SUB: PROC (SEG_NUM);
      317    12547         /*==========*/
      318    12548
      319    12549         /*I*
      320    12550               NAME: GO_SEG_SUB
      321    12551
      322    12552          DESCRIPTION: For a GO TO statement that transfer control into a
      323    12553                       independent segment will be modified to like....
      324    12554
      325    12555                         OLD         |              NEW
      326    12556                                     |
      327    12557                     goto old_label# |           goto new_#1
      328    12558                                     |
      329    12559                       and at the top of the program..
      330    12560                                     |   new_#1: call refresh_&_overlay
      331    12561                                     |           goto old_label#
      332    12562         */
      333    12563
      334    12564
      335    12565    2   DCL SEG_NUM            SBIN WORD;
      336    12566    2   DCL OLD_LABEL$         PTR;
      337    12567    2   DCL NEW_LABEL$         PTR;
      338    12568    2   DCL SUB$               PTR;
      339    12569    2   DCL SUB_TAIL$          PTR;
      340    12570    2   DCL CALL_LABEL$        PTR;
      341    12571    2   DCL TEMP$              PTR;
      342    12572    2   DCL LABEL_END$         PTR;
      343    12573    2   DCL PREV_ILS_NEXT$     PTR;
      344    12574
      345    12575
      346    12576    2          SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;
      347    12577    2          PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;
      348    12578
      349    12579    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, NEW_LABEL$);
      350    12580
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:14   
      351    12581    2          NEW_LABEL$ -> LABEL.B.REFERENCED = TRUE;
      352    12582    2          NEW_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;
      353    12583    2          NEW_LABEL$ -> LABEL.B.ONE_REF = TRUE;
      354    12584    2          NEW_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$;
      355    12585    2          NEW_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      356    12586
      357    12587               %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      358    12633
      359    12634    2          SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      360    12635
      361    12636               %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      362    12682
      363    12683    2          SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = NEW_LABEL$;
      364    12684
      365    12685    2          TEMP$ = ENTRY_LABEL$;
      366    12686
      367    12687               %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$,
      368    12688                            @UPDATE$  = TEMP$);
      369    12703
      370    12704    2          IF SEG_NUM > %MAX_FIXED_SEG# THEN
      371    12705    3            DO;
      372    12706    3              CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NUM) ->
      373    12707    3                            SEGMENT_LTS.SUB_LABEL$;
      374    12708
      375    12709    3              IF CALL_LABEL$ ~= ADDR(NIL) THEN
      376    12710    4                DO;
      377    12711                       %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      378    12757
      379    12758    4                  SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      380    12759
      381    12760                       %RSV_ILS_ILL (@ILL_ITEM = %GO);
      382    12806
      383    12807    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;
      384    12808    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;
      385    12809    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ADDR(NIL);
      386    12810    4                END;
      387    12811    3            END;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:15   
      388    12812
      389    12813               %OVERLAY_REGULAR_GO;
      390    12914
      391    12915               %GO_TO_NEW_LABEL (@GO_LABEL$ = NEW_LABEL$,
      392    12916                                 @GO_ILL$   = ILL$);
      393    12921
      394    12922    2          TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      395    12923
      396    12924    2          SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;
      397    12925
      398    12926    2    END GO_SEG_SUB;
      399    12927         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:16   
      400    12928
      401    12929         /*=============*/
      402    12930    1      OVERLAY_RESET:  PROC;
      403    12931         /*=============*/
      404    12932
      405    12933         /*I*
      406    12934               NAME: OVERLAY_RESET
      407    12935
      408    12936          DESCRIPTION: For an altered GO TO statement the program flow
      409    12937                       might be transfered to several different addresses
      410    12938                       and the address can be learned on run time only,
      411    12939                       if one of these addresses is in an independent
      412    12940                       segment then a special treatment is needed, and
      413    12941                       GEN_RESET_CODE is called to generate the codes
      414    12942                       to reset the alter switches, and the old GO TO
      415    12943                       will be directed to new lebel.
      416    12944         */
      417    12945
      418    12946
      419    12947    2   DCL SUB$           PTR;
      420    12948    2   DCL SUB_TAIL$      PTR;
      421    12949    2   DCL TEMP_LABEL$    PTR;
      422    12950    2   DCL LABEL_END$     PTR;
      423    12951    2   DCL LTS$$          PTR;
      424    12952    2   DCL LABEL_USE$     PTR;
      425    12953    2   DCL GENERATE_CODE  BOOLEAN;
      426    12954    2   DCL ALTER_LTS$     PTR;
      427    12955    2   DCL HEAD_LTS$      PTR;
      428    12956    2   DCL PREV_ILS_NEXT$  PTR;
      429    12957
      430    12958
      431    12959
      432    12960          /*
      433    12961               This routine will create the subroutine call for the altered
      434    12962               GO TO statement. The altered GO TO statement needs special
      435    12963               treatment because the actual address that the control will be
      436    12964               transfered to can be known on run time only.
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:17   
      437    12965          */
      438    12966
      439    12967         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:18   
      440    12968
      441    12969         /*--------------*/
      442    12970    2      GEN_RESET_CODE: PROC;
      443    12971         /*--------------*/
      444    12972
      445    12973         /*I*
      446    12974               NAME: GEN_RESET_CODE
      447    12975
      448    12976          DESCRIPTION: This routine will generate the codes that compare
      449    12977                       the pointer item with the addresses of label items
      450    12978                       and invoke the subroutines that will refresh the
      451    12979                       alter switches.
      452    12980         */
      453    12981
      454    12982    3   DCL GO_LABEL$          PTR;
      455    12983    3   DCL ETT$$              PTR;
      456    12984    3   DCL CALL_LABEL$        PTR;
      457    12985    3   DCL POINTER$$          PTR;
      458    12986
      459    12987
      460    12988    3          CALL Z8AT$CREATE_TEMPORARY (%PARA, GO_LABEL$);
      461    12989
      462    12990    3          GO_LABEL$ -> LABEL.B.REFERENCED = TRUE;
      463    12991    3          GO_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;
      464    12992    3          GO_LABEL$ -> LABEL.B.ONE_REF = TRUE;
      465    12993    3          GO_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$;
      466    12994
      467    12995               %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      468    13041
      469    13042    3          SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      470    13043
      471    13044               %RSV_ILS_ILL (@ILL_ITEM = %GO);
      472    13090
      473    13091    3          SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_NOT_EQUAL;
      474    13092    3          SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = GO_LABEL$;
      475    13093
      476    13094               %RESERVE_ETT (POINTER = ETT$);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:19   
      477    13121
      478    13122          /*   Check the content of the pointer item to see if this subroutine
      479    13123               is to be called or not */
      480    13124
      481    13125    3          ETT$ -> ETT.ID = %CMGP;
      482    13126    3          ETT$ -> ETT.REF$ = ADDR(NIL);
      483    13127
      484    13128    3          CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,
      485    13129    3                              ADDR(NIL),
      486    13130    3                              POINTER$$);
      487    13131    3          ETT$ -> ETT.ROP = POINTER$$;
      488    13132
      489    13133           /*
      490    13134               CALL Z8AF$NEW_BASE (ALTER_LTS$ -> ALTER_LTS.LABEL$,
      491    13135                                   ADDR(NIL),
      492    13136                                   ETT$ -> ETT.LOP);
      493    13137           */
      494    13138    3          ETT$ -> ETT.LOP = ALTER_LTS$ -> ALTER_LTS.LABEL$;
      495    13139
      496    13140    3          SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ETT$;
      497    13141
      498    13142               %RESERVE_ETT (POINTER = ETT$);
      499    13169
      500    13170    3          ETT$ -> ETT.ID = %CMPAO;
      501    13171    3          ETT$ -> ETT.EVALP$ = ADDR(NIL);
      502    13172
      503    13173               %RESERVE_ETT (POINTER = ETT$ -> ETT.ROP);
      504    13200
      505    13201    3          ETT$ -> ETT.ROP -> ETT.ID = %CMPAS;
      506    13202    3          ETT$ -> ETT.ROP -> ETT.EVALP$ = ADDR(NIL);
      507    13203    3          ETT$ -> ETT.ROP -> ETT.ROPCON = %MVANO_UPPER_TO_LOWER;
      508    13204    3          MKCN.CON = ALTER_LTS$ -> ALTER_LTS.SEG_NO#;
      509    13205
      510    13206    3          CALL Z8AC$MAKE_CONST (ETT$ -> ETT.ROP -> ETT.LOP);
      511    13207
      512    13208    3          ETT$ -> ETT.LOP = POINTER$$;
      513    13209
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:20   
      514    13210               %RSV_ILS_ILL (@ILL_ITEM = %GO);
      515    13256
      516    13257    3          SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_NOT_EQUAL;
      517    13258    3          SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = GO_LABEL$;
      518    13259    3          SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ETT$;
      519    13260
      520    13261    3          IF ALTER_LTS$ -> ALTER_LTS.SEG_NO# > %MAX_FIXED_SEG# AND
      521    13262    3            ALTER_LTS$ -> ALTER_LTS.SEG_NO# ~= ILL$ -> ILL.LOP ->
      522    13263    3            LABEL.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      523    13264    4            DO;
      524    13265
      525    13266    4              CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(ALTER_LTS$ -> ALTER_LTS.
             13266                       SEG_NO#) ->
      526    13267    4                           SEGMENT_LTS.SUB_LABEL$;
      527    13268
      528    13269
      529    13270    4              IF CALL_LABEL$ ~= ADDR(NIL) THEN
      530    13271    5                DO;
      531    13272                       %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      532    13318
      533    13319    5                  SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      534    13320
      535    13321                       %RSV_ILS_ILL (@ILL_ITEM = %GO);
      536    13367
      537    13368    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;
      538    13369    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;
      539    13370    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ADDR(NIL);
      540    13371    5                END;
      541    13372    4            END;
      542    13373
      543    13374                 %OVERLAY_ALTERED_GO;
      544    13383
      545    13384
      546    13385          /*   %USE_PROC_TAILER;  */
      547    13386
      548    13387    3          GO_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      549    13388
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:21   
      550    13389                 %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      551    13435
      552    13436    3            SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      553    13437
      554    13438                 %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      555    13484
      556    13485    3            SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = GO_LABEL$;
      557    13486
      558    13487                 %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);
      559    13502
      560    13503    3    END GEN_RESET_CODE;
      561    13504         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:22   
      562    13505
      563    13506
      564    13507               /*  main program */
      565    13508
      566    13509
      567    13510    2          IF ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = ADDR(NIL) THEN
      568    13511    2            RETURN;
      569    13512
      570    13513    2      SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;
      571    13514    2      PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;
      572    13515
      573    13516    2      TEMP_LABEL$ = LAST_LABEL$;
      574    13517    2      LAST_LABEL$ = ENTRY_LABEL$;
      575    13518
      576    13519           %USE_HEADER;
      577    13636
      578    13637    2      ALTER_LTS$ = ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$;
      579    13638    2      HEAD_LTS$ = ALTER_LTS$;
      580    13639    2      ILL$ -> ILL.LOP -> LABEL.B.GO_ALTERED = TRUE;
      581    13640
      582    13641    3      DO WHILE (ALTER_LTS$ ~= ADDR(NIL));
      583    13642
      584    13643    3        GENERATE_CODE = TRUE;
      585    13644    3        LTS$$ = HEAD_LTS$;
      586    13645
      587    13646    3      CHECK_DUP_LBL:
      588    13647    4        DO WHILE (LTS$ ~= ADDR(NIL) AND LTS$$ ~= ALTER_LTS$);
      589    13648
      590    13649    4          IF LTS$$ -> ALTER_LTS.LABEL$ = ALTER_LTS$ -> ALTER_LTS.LABEL$ THEN
      591    13650    5            DO;
      592    13651    5              GENERATE_CODE = FALSE;
      593    13652    5              EXIT CHECK_DUP_LBL;
      594    13653    5            END;
      595    13654
      596    13655    4          LTS$$ = LTS$$ -> ALTER_LTS.NEXT;
      597    13656    4        END;
      598    13657
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:23   
      599    13658             %SEGNUM_CHECK;
      600    13668
      601    13669    3        IF GENERATE_CODE THEN
      602    13670    3          CALL GEN_RESET_CODE;
      603    13671
      604    13672    3        ALTER_LTS$ = ALTER_LTS$ -> ALTER_LTS.NEXT;
      605    13673    3      END;
      606    13674
      607    13675           %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      608    13721
      609    13722    2      SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      610    13723
      611    13724           %RSV_ILS_ILL (@ILL_ITEM = %GO);
      612    13770
      613    13771    2      SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_ALTERED;
      614    13772
      615    13773    2      CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,
      616    13774    2                          ADDR(NIL),
      617    13775    2                          SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP);
      618    13776
      619    13777    2      SUB_TAIL$ -> ILS.ILL$ -> GO.EXPR$ = ADDR(NIL);
      620    13778
      621    13779    3      DO WHILE (ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO);
      622    13780
      623    13781    3        ILS$ = ILS$ -> ILS.ILL$ -> ILL.BRANCH$;
      624    13782
      625    13783    3      END;
      626    13784
      627    13785           %REPLACE_OLD_GO (@GO_ILL$ = ILS$ -> ILS.ILL$,
      628    13786                            @LABEL$  = LABEL_USE$);
      629    13793
      630    13794    2      TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      631    13795
      632    13796    2      SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;
      633    13797    2    END OVERLAY_RESET;
      634    13798         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:24   
      635    13799
      636    13800
      637    13801            /* Main Program */
      638    13802
      639    13803            /* If there is no overlayable segment then RETURN */
      640    13804
      641    13805    1       IF COMCOM.SEGMENTC <= 1 THEN
      642    13806    1         RETURN;
      643    13807
      644    13808    1    LAST_LABEL$ = ADDR(NIL);
      645    13809    1    ENTRY_LABEL$ = ADDR(NIL);
      646    13810    1    ILS$ = COMCOM.H_BRANCH;
      647    13811    1    CURRENT_PROC$ = ADDR(NIL);
      648    13812    1    CURRENT_ARRAY$ = ADDR(NIL);
      649    13813
      650    13814    2    DO WHILE (ILS$ ~= ADDR(NIL));
      651    13815
      652    13816    2      ILL$ = ILS$ -> ILS.ILL$;
      653    13817
      654    13818    2      IF ILL$ = ADDR(NIL) THEN
      655    13819    2        RETURN;           /*#25871*/
      656    13820
      657    13821    2    CASE_STATEMENT:
      658    13822    3      DO CASE (ILL$ -> ILL.ID);
      659    13823
      660    13824    3        CASE (%SCOPE);
      661    13825
      662    13826    3          IF ILL$ -> SCOPE.CODE = %PROGRAM_SCOPE THEN
      663    13827    4            DO;
      664    13828    4              CURRENT_PROC$ = ILL$ -> SCOPE.PROC$;
      665    13829    4              O2COM.SECTION$ = ADDR(NIL);
      666    13830
      667    13831                   %GET_ENTRY (@START = ILS$, @RTN = CURRENT_ENTRY$);
      668    13857
      669    13858    4              IF CURRENT_ENTRY$ ~= ADDR(NIL) THEN
      670    13859    5                DO;
      671    13860    5                  TEMP$ = CURRENT_ENTRY$;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:25   
      672    13861    6                  DO WHILE (TEMP$ ~= ADDR(NIL) AND
      673    13862    6                            TEMP$ -> ILS.ILL$ ~= ADDR(NIL) AND
      674    13863    6                            TEMP$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB);
      675    13864    6                    TEMP$ = TEMP$ -> ILS.NEXT;
      676    13865    6                  END;
      677    13866
      678    13867    5                  ENTRY_LABEL$ = TEMP$;
      679    13868
      680    13869    5                  IF ENTRY_LINOI$ -> ILS.ILL$ -> ILL.ID ~= %LINOI THEN
      681    13870    6                    DO;
      682    13871                           %FIND_LINE_NO (@START_ITEM$ = CURRENT_ENTRY$);
      683    13887
      684    13888    6                      ENTRY_LINOI$ = O2COM.LINE_NO$ -> ILS.ILL$;
      685    13889    6                    END;
      686    13890    5                  ELSE
      687    13891    5                    ENTRY_LINOI$ = ENTRY_LINOI$ -> ILS.ILL$;
      688    13892
      689    13893    5                  CALL GEN_ALTER_RESETS (CURRENT_PROC$,
      690    13894    5                                         RESET_SUB$,
      691    13895    5                                         RESET_SUB_TAIL$,
      692    13896    5                                         CURRENT_ARRAY$);
      693    13897
      694    13898    5                  CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(0) = CURRENT_ENTRY$;
      695    13899    5                  CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(1) = RESET_SUB_TAIL$;
      696    13900    5                  RESET_SUB_TAIL$ -> ILS.NEXT = CURRENT_ENTRY$ -> ILS.NEXT;
      697    13901
      698    13902    5                  CURRENT_ENTRY$ -> ILS.NEXT = RESET_SUB$;
      699    13903    5                  TRA_END_LABEL$ = RESET_SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP;
      700    13904    5                END;
      701    13905    4            END;
      702    13906
      703    13907    3        CASE (%DEFLB);
      704    13908
      705    13909    3            LAST_LABEL$ = ILS$;
      706    13910
      707    13911             /* If next fall thru section is in a different independent
      708    13912                segment then refresh the alter switches then bring in the
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:26   
      709    13913                overlayable segment, if it is a different fixed overlay
      710    13914                then bring in the overlay.
      711    13915             */
      712    13916
      713    13917    3            IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND
      714    13918    3               ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      715    13919    4              DO;
      716    13920    4                SEG_NO# = ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ->
      717    13921    4                            SEGMENT_LTS.SEGMENT_NO#;
      718    13922    4                IF SEG_NO# >= COMCOM.SEG_LIMIT AND
      719    13923    4                  O2COM.SECTION$ ~= ADDR(NIL) AND
      720    13924    4                  (ILL$ -> ILL.LOP -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      721    13925    4                  O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#) AND
      722    13926    4                  ILL$ -> DEFLB.LOP -> LABEL.B.FALL_THRU THEN
      723    13927    5                DO;
      724    13928
      725    13929    5                  IF SEG_NO# > %MAX_FIXED_SEG# THEN
      726    13930    6                    DO;
      727    13931    6                      CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NO#)
      728    13932    6                               -> SEGMENT_LTS.SUB_LABEL$;
      729    13933    6                      IF CALL_LABEL$ ~= ADDR(NIL) THEN
      730    13934    7                        DO;
      731    13935
      732    13936                               %SET LISTMAC = '1'B;
      733    13937
      734    13938                               %CALL_REFRESH_SUB;
             13939    8      DO;
             13940    8        PREV_ILS$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$;
             13941             %FIND_LINE_NO (@START_ITEM$ = PREV_ILS$);
             13942    9          DO ;
             13943    9            O2COM.LINE_NO$ = @START_ITEM$ ;
             13944   10            DO WHILE O2COM.LINE_NO$->ILS.ILL$->ILL.ID ~= %LINOI ;
             13945   11              DO UNTIL O2COM.LINE_NO$->ILS.ILL$ ~= ADDR(NIL) ;
             13946                     %NEXT_ILS (POINTER=O2COM.LINE_NO$) ;
             13947   12          DO ; /* Next ILS entry in the ILS chain */
             13948   12            POINTER = POINTER->ILS.NEXT ;
             13949   12          END ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:27   
             13951   11              END ;
             13952   10            END ;
             13953    9            COMCOM.CURRENT.LINE = O2COM.LINE_NO$->ILS.ILL$->LINOI.PREV_LINE ;
             13954    9            COMCOM.CURRENT.COLUMN = O2COM.LINE_NO$->ILS.ILL$->LINOI.PREV_COL ;
             13955    9          END ;
             13957             %RESERVE_ILS (ITEM = %OPN,
             13958                           POINTER = TEMP$);
             13959    9          DO ;
             13960                 %IF VARIABLE ;
             13968                 %ELSE ;
             13969                   %IF ITEM % = %OPN;
             13970                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             13971                   %ELSEIF ITEM = %OPV
             13977                   %ENDIF;
             13978    9              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR
             13979    9              THEN CALL Z8AR$RESERVER(ADDR(ILS_));
             13980    9              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;
             13981    9              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;
             13982    9              POINTER->ILS.ID = ITEM % ;
             13983    9              POINTER->ILS.NEXT = ADDR(NIL);
             13984                 %ENDIF ;
             13985    9          END ;
             13987             %RESERVE_ILL (ITEM = %LINOI,
             13988                          POINTER = TEMP$ -> ILS.ILL$);
             13989    9        DO;
             13990    9          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);
             13991    9          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN
             13992    9            CALL Z8AR$RESERVER(ADDR(ILL_));
             13993    9          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);
             13994    9          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;
             13995    9          POINTER -> ILL.ID = ITEM %;
             13996    9        END;
             13998    8        TEMP$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;
             13999             %RESERVE_ILS (ITEM = %OPN,
             14000                           POINTER = TEMP$ -> ILS.NEXT);
             14001    9          DO ;
             14002                 %IF VARIABLE ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:28   
             14010                 %ELSE ;
             14011                   %IF ITEM % = %OPN;
             14012                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             14013                   %ELSEIF ITEM = %OPV
             14019                   %ENDIF;
             14020    9              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR
             14021    9              THEN CALL Z8AR$RESERVER(ADDR(ILS_));
             14022    9              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;
             14023    9              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;
             14024    9              POINTER->ILS.ID = ITEM % ;
             14025    9              POINTER->ILS.NEXT = ADDR(NIL);
             14026                 %ENDIF ;
             14027    9          END ;
             14029             %RESERVE_ILL (ITEM = %GO,
             14030                           POINTER = TEMP$ -> ILS.NEXT -> ILS.ILL$);
             14031    9        DO;
             14032    9          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);
             14033    9          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN
             14034    9            CALL Z8AR$RESERVER(ADDR(ILL_));
             14035    9          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);
             14036    9          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;
             14037    9          POINTER -> ILL.ID = ITEM %;
             14038    9        END;
             14040    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;
             14041    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;
             14042    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.ROP = ADDR(NIL);
             14043    8        ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = TEMP$ -> ILS.NEXT;
             14044    8        TEMP$ -> ILS.NEXT -> ILS.NEXT = PREV_ILS$ -> ILS.NEXT;
             14045    8        PREV_ILS$ -> ILS.NEXT = TEMP$;
             14046    8      END;
      735    14048
      736    14049                               %SET LISTMAC = '0'B;
      737    14050
      738    14051    7                        END;
      739    14052    6                    END;
      740    14053
      741    14054                       %OVERLAY_FALL_THRU;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:29   
      742    14059
      743    14060    5                END;
      744    14061    4              ELSE
      745    14062    4                IF O2COM.SECTION$ = ADDR(NIL) AND
      746    14063    4                  SEG_NO# >= COMCOM.SEG_LIMIT THEN
      747    14064                       %OVERLAY_FALL_THRU;
      748    14069    4                ELSE
      749    14070    4                  IF O2COM.SECTION$ ~= ADDR(NIL) AND
      750    14071    4                    O2COM.SECTION$ -> SECTION.SEGMENT$ ->
      751    14072    4                      SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      752    14073    5                    DO;
      753    14074    5                      IF SEG_NO# < COMCOM.SEG_LIMIT THEN
      754    14075                             %GOTO_FIXED_SEGMENT;
      755    14080    5                    END;
      756    14081    4                  ELSE
      757    14082                         %GOTO_DIFFERENT_SEGMENT;
      758    14087
      759    14088
      760    14089    4                O2COM.SECTION$ = ILL$ -> ILL.LOP;
      761    14090    4              END;
      762    14091    3            ELSE
      763    14092    3              IF  ILL$ -> ILL.LOP -> LABEL.POINTER$ ~= ADDR(NIL) THEN
      764    14093    4                DO;
      765    14094                         /* this is the altered GO TO statement */
      766    14095
      767    14096    4                  CALL OVERLAY_RESET;
      768    14097
      769    14098    4                END;
      770    14099
      771    14100
      772    14101    3        CASE (%ENTRY);
      773    14102
      774    14103                /*  Do nothing here  */
      775    14104
      776    14105    3        CASE (%GO);
      777    14106
      778    14107    3          IF ILL$ -> GO.CODE = %GO_ALTERED OR
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:30   
      779    14108    3            ILL$ -> GO.LOP = ADDR(NIL) OR
      780    14109    3            ILL$ -> GO.LOP -> LABEL.B.COMPILER_CREATED THEN
      781    14110    3              EXIT CASE_STATEMENT;
      782    14111
      783    14112    3          SEG_LTS$ = ADDR(NIL);
      784    14113    3          IF ILL$ -> GO.LOP -> LABEL.ID = %SECTION THEN
      785    14114    3            SEG_LTS$ = ILL$ -> GO.LOP -> SECTION.SEGMENT$;
      786    14115    3          ELSE
      787    14116    3            IF ILL$ -> GO.LOP -> LABEL.ID = %PARA AND
      788    14117    3              ILL$ -> GO.LOP -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      789    14118    3              SEG_LTS$ = ILL$ -> GO.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$;
      790    14119
      791    14120    3            IF SEG_LTS$ ~= ADDR(NIL) AND
      792    14121    3              SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      793    14122    4              DO;
      794    14123    4                IF O2COM.SECTION$ -> SECTION.SEGMENT$ = ADDR(NIL) OR
      795    14124    4                  O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      796    14125    4                  SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      797    14126    5                  DO;
      798    14127    5                    CALL GO_SEG_SUB (SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#);
      799    14128    5                  END;
      800    14129    4              END;
      801    14130    3            ELSE
      802    14131                   %CHECK_VIRTUAL_SIMPLE_GO;
      803    14136
      804    14137    3      END; /* DO CASE */
      805    14138
      806    14139    2    NEXT_LBL:
      807    14140    2      ILS$ = ILS$ -> ILS.ILL$ -> ILL.BRANCH$;
      808    14141
      809    14142    2    END; /* DO WHILE */
      810    14143
      811    14144    1    END Z8FJ$SEGMENT_SUBS;
      812    14145         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:31   

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:32   
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FJ$SEGMENT_SUBS.

   Procedure Z8FJ$SEGMENT_SUBS requires 2833 words for executable code.
   Procedure Z8FJ$SEGMENT_SUBS requires 50 words of local(AUTO) storage.

    No errors detected in file Z8FJ.:Z8A6TSI    .

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:33   

 Object Unit name= Z8FJ$SEGMENT_SUBS                          File name= Z8FJ.:Z8A6TOU
 UTS= AUG 09 '97 13:06:31.88 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  ETT$
    6  LblCom even  none     1      1  HEAD_ETT$
    7  LblCom even  none   512   1000  ETT_BUCKETS
    8  LblCom even  none     5      5  ETT_
    9  LblCom even  none     1      1  LTS$
   10  LblCom even  none     5      5  LTS_
   11  LblCom even  none    12     14  O2COM
   12  LblCom even  none     1      1  ST$
   13  LblCom even  none     5      5  ST_
   14  LblCom even  none     1      1  ILL$
   15  LblCom even  none     5      5  ILL_
   16  LblCom even  none     1      1  ILS$
   17  LblCom even  none     5      5  ILS_
   18  LblCom even  none     2      2  MKCN
   19   Proc  even  none  2833   5421  Z8FJ$SEGMENT_SUBS
   20  RoData even  none     9     11  Z8FJ$SEGMENT_SUBS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    19      0   yes            yes      Std        0  Z8FJ$SEGMENT_SUBS
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:34   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       1 Z8AC$MAKE_CONST
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                         r    ILL_STEP
r    ILS_STEP_TABLE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:35   


        1        1        /*M*  Z8FJ$SEGMENT_SUBS---To reset the switches */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*
       10       10               NAME:  Z8FJ$SEGMENT_SUBS
       11       11             AUTHOR:  Min Lee
       12       12            PURPOSE:  This procedure will generate the subroutines and the
       13       13                      subroutine calls to refresh the alter switches in the
       14       14                      independent segments.
       15       15        */
       16       16
       17       17        /*D*
       18       18               NAME:  Z8FJ$SEGMENT_SUBS.
       19       19               CALL:  CALL Z8FJ$SEGMENT_SUBS.
       20       20          INTERFACE:  Z8AT$CREATE_TEMPORARY--Call to get a new label item.
       21       21                      Z8AF$NEW_BASE---called to set up BASE ITEM.
       22       22
       23       23        DESCRIPTION:  This procedure creates the subroutines that will refresh
       24       24                      the alter switches in the independent segments, put them
       25       25                      on the top of the procedure division and then generates the
       26       26                      subroutine calls for the GO TO statements or the SECTION
       27       27                      HEADERs for which the program flow might transfer
       28       28                      into a different independent segment.
       29       29        */
       30       30         /*=================*/
       31       31           Z8FJ$SEGMENT_SUBS: PROC;

     31 19 000000   000000 700200 xent  Z8FJ$SEGMEN* TSX0  ! X66_AUTO_0
        19 000001   000062 000000                    ZERO    50,0
        19 000002   004450 710000 19                 TRA     s:13805

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:36   
       32       32         /*=================*/
       33       33
       34       34
       35       35        %EQU PHASE = 2 ;
       36       36
       37       37        %INCLUDE Z8A_DEFC ;
       38      105        %INCLUDE Z8A_SUPP_MAC ;
       39     2505        %INCLUDE Z9A_SUPP_MAC;
       40     2794        %INCLUDE Z8A_COMCOM ;
       41     3444        %INCLUDE Z8A_DNT ;
       42     3665        %INCLUDE Z8A_ERR_NUMS ;
       43     4429        %INCLUDE Z8A_ETT ;
       44     4730        %INCLUDE Z8A_LTS ;
       45     6807        %INCLUDE Z8F_O2COM ;
       46     6917        %INCLUDE Z8A_ST ;
       47    10576        %INCLUDE Z8A_TYPES ;
       48    10750        %INCLUDE Z8A_ILL ;
       49    11443        %INCLUDE Z8A_ILS ;
       50    11552        %INCLUDE Z8A_LIBRARY ;
       51    11766        %INCLUDE Z8A_MKCN;
       52    11783
       53    11784        %EJECT ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:37   
       54    11785    1   DCL Z8AC$MAKE_CONST     ENTRY (1);
       55    11786    1   DCL Z8AT$CREATE_TEMPORARY  ENTRY (2);
       56    11787    1   DCL Z8AF$NEW_BASE          ENTRY (3);
       57    11788
       58    11789    1   DCL CURRENT_PROC$  PTR;
       59    11790    1   DCL TRA_END_LABEL$  PTR;
       60    11791    1   DCL RESET_SUB$     PTR;
       61    11792    1   DCL RESET_SUB_TAIL$    PTR;
       62    11793    1   DCL CURRENT_ENTRY$     PTR;
       63    11794    1   DCL TEMP$              PTR;
       64    11795    1   DCL SUB_TAIL$          PTR;
       65    11796    1   DCL LAST_LABEL$        PTR;
       66    11797    1   DCL CALL_LABEL$        PTR;
       67    11798    1   DCL SEG_NO#            SBIN WORD;
       68    11799    1   DCL CURRENT_ARRAY$     PTR;
       69    11800    1   DCL PREV_ILS$          PTR;
       70    11801    1   DCL ENTRY_LINOI$       PTR;
       71    11802    1   DCL ENTRY_LABEL$       PTR;
       72    11803    1   DCL SEG_LTS$           PTR;
       73    11804
       74    11805        %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:38   
       75    11806
       76    11807         %MACRO GET_ENTRY (@START = ILS$,
       77    11808                           @RTN   = CURRENT_ENTRY$);
       78    11809           DO;
       79    11810             @RTN = ADDR(NIL);
       80    11811             TEMP$ = @START -> ILS.NEXT;
       81    11812             ENTRY_LINOI$ = TEMP$;
       82    11813
       83    11814             DO WHILE (TEMP$ ~= ADDR(NIL));
       84    11815
       85    11816               IF TEMP$ -> ILS.ILL$ -> ILL.ID = %ENTRY AND
       86    11817                   (TEMP$ -> ILS.ILL$ -> ENTRY_ILL.CODE = %MAIN_PROGRAM OR
       87    11818                    TEMP$ -> ILS.ILL$ -> ENTRY_ILL.CODE = %SUBROUTINE)  THEN
       88    11819                 DO;
       89    11820                   @RTN = TEMP$;
       90    11821                   TEMP$ = ADDR(NIL);
       91    11822                 END;
       92    11823               ELSE
       93    11824                        /*  END OF THE PROGRAM -- NEXT PROGRAM BEGIN */
       94    11825                 IF TEMP$ -> ILS.ILL$ -> ILL.ID = %SCOPE AND
       95    11826                    TEMP$ -> ILS.ILL$ -> SCOPE.CODE = %PROGRAM_SCOPE THEN
       96    11827                   TEMP$ = ADDR(NIL);
       97    11828
       98    11829                 ELSE
       99    11830                   DO;
      100    11831                     ENTRY_LINOI$ = TEMP$;
      101    11832                     TEMP$ = TEMP$ -> ILS.NEXT;
      102    11833                   END;
      103    11834
      104    11835             END; /* WHILE */
      105    11836           END;
      106    11837         %MEND;
      107    11838         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:39   
      108    11839
      109    11840         %MACRO RSV_ILS_ILL (@ILS_ITEM = %OPN,
      110    11841                             @ILL_ITEM = %LINOI);
      111    11842           DO;
      112    11843             %RESERVE_ILS (ITEM = @ILS_ITEM,
      113    11844                           POINTER = SUB_TAIL$ -> ILS.NEXT);
      114    11845
      115    11846             %RESERVE_ILL (ITEM = @ILL_ITEM,
      116    11847                           POINTER = SUB_TAIL$ -> ILS.NEXT -> ILS.ILL$);
      117    11848
      118    11849             SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;
      119    11850           END;
      120    11851         %MEND;
      121    11852
      122    11853
      123    11854         %MACRO USE_PROC_TAILER;
      124    11855           DO;
      125    11856              %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      126    11857
      127    11858               SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      128    11859
      129    11860              %RSV_ILS_ILL (@ILL_ITEM = %USE_END);
      130    11861
      131    11862               SUB_TAIL$ -> ILS.ILL$ -> ILL.CODE = %USE_LOCAL;
      132    11863               SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);
      133    11864           END;
      134    11865         %MEND;
      135    11866         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:40   
      136    11867
      137    11868         %MACRO USE_HEADER;
      138    11869           DO;
      139    11870             CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL_USE$);
      140    11871
      141    11872             LABEL_USE$ -> LABEL.B.REFERENCED = TRUE;
      142    11873             LABEL_USE$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      143    11874             LABEL_USE$ -> LABEL.PROC$ = CURRENT_PROC$;
      144    11875
      145    11876             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      146    11877
      147    11878             SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      148    11879
      149    11880             %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      150    11881
      151    11882             SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = LABEL_USE$;
      152    11883
      153    11884             %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);
      154    11885
      155    11886           END;
      156    11887         %MEND;
      157    11888         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:41   
      158    11889
      159    11890         %MACRO USE_PROC_HEADER;
      160    11891           DO;
      161    11892             %USE_HEADER;
      162    11893
      163    11894             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      164    11895
      165    11896             SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;
      166    11897
      167    11898             %RSV_ILS_ILL (@ILL_ITEM = %USE_ENTRY);
      168    11899
      169    11900             SUB_TAIL$ -> ILS.ILL$ -> ILL.CODE = %USE_LOCAL;
      170    11901             SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);
      171    11902           END;
      172    11903         %MEND;
      173    11904         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:42   
      174    11905
      175    11906         %MACRO UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$,
      176    11907                            @UPDATE$  = LAST_LABEL$);
      177    11908           DO;
      178    11909             IF @UPDATE$ = ADDR(NIL) THEN
      179    11910               DO;
      180    11911                 @LBL_ILS$ -> ILS.ILL$ -> DEFLB.LBL = COMCOM.H_LBL;
      181    11912                 COMCOM.H_LBL = @LBL_ILS$;
      182    11913               END;
      183    11914             ELSE
      184    11915               DO;
      185    11916                 @LBL_ILS$ -> ILS.ILL$ -> DEFLB.LBL = @UPDATE$ -> ILS.ILL$ -> DEFLB.LBL;
      186    11917                 @UPDATE$ -> ILS.ILL$ -> DEFLB.LBL = @LBL_ILS$;
      187    11918               END;
      188    11919
      189    11920               @UPDATE$ = @LBL_ILS$;
      190    11921
      191    11922           END;
      192    11923         %MEND;
      193    11924         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:43   
      194    11925
      195    11926         /*================*/
      196    11927    1      GEN_ALTER_RESETS: PROC (PROC$, SUB$, SUB_TAIL$, ARRAY$);

  11927 19 000003   200034 741300       GEN_ALTER_R* STX1  ! SEG_LTS$+2,,AUTO

      197    11928         /*================*/
      198    11929
      199    11930         /*I*
      200    11931               NAME: GEN_ALTER_RESETS
      201    11932
      202    11933          DESCRIPTION: This routine steps through a pointer array that point
      203    11934                       to the ILS items needed to refresh the independent
      204    11935                       segments and use these ILS items to build up the
      205    11936                       subroutines that will be called on run time to refresh
      206    11937                       the alter switches.
      207    11938                       These ILS item created in Z8FL$LABEL_REFERENCE and
      208    11939                       saved on the pointer array.
      209    11940         */
      210    11941
      211    11942    2   DCL PROC$              PTR;
      212    11943    2   DCL SUB$               PTR;
      213    11944    2   DCL SUB_TAIL$          PTR;
      214    11945    2   DCL ARRAY$             PTR;
      215    11946    2   DCL LABEL_END$         PTR;
      216    11947    2   DCL LABEL_USE$         PTR;
      217    11948    2   DCL I                  SBIN WORD;
      218    11949    2   DCL SEG_LTS$           PTR;
      219    11950    2   DCL INIT_SUB$          PTR;
      220    11951    2   DCL LAST_SUB$          PTR;
      221    11952
      222    11953
      223    11954    2      ARRAY$ = PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$;

  11954 19 000004   200035 470500                    LDP0    @PROC$,,AUTO
        19 000005   000000 471500                    LDP1    0,,PR0
        19 000006   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:44   
        19 000007   300014 236100                    LDQ     12,,PR3
        19 000010   200040 474500                    LDP4    @ARRAY$,,AUTO
        19 000011   400000 756100                    STQ     0,,PR4

      224    11955
      225    11956    2      CALL Z8AT$CREATE_TEMPORARY (%PARA, LABEL_END$);

  11956 19 000012   200041 631500                    EPPR1   LABEL_END$,,AUTO
        19 000013   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000014   000002 236000 20                 LDQ     2
        19 000015   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000016   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 000017   000000 631400 20                 EPPR1   0
        19 000020   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        19 000021   000000 011000                    NOP     0

      226    11957
      227    11958    2      LABEL_END$ -> LABEL.B.REFERENCED = TRUE;

  11958 19 000022   200041 470500                    LDP0    LABEL_END$,,AUTO
        19 000023   400000 236003                    LDQ     -131072,DU
        19 000024   000003 256100                    ORSQ    3,,PR0

      228    11959    2      LABEL_END$ -> LABEL.B.GOTO_LABEL    = TRUE;

  11959 19 000025   200041 470500                    LDP0    LABEL_END$,,AUTO
        19 000026   040000 236003                    LDQ     16384,DU
        19 000027   000003 256100                    ORSQ    3,,PR0

      229    11960    2      LABEL_END$ -> LABEL.B.ONE_REF = TRUE;

  11960 19 000030   200041 470500                    LDP0    LABEL_END$,,AUTO
        19 000031   010000 236003                    LDQ     4096,DU
        19 000032   000003 256100                    ORSQ    3,,PR0

      230    11961    2      LABEL_END$ -> LABEL.PROC$        = PROC$;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:45   
  11961 19 000033   200035 470500                    LDP0    @PROC$,,AUTO
        19 000034   000000 236100                    LDQ     0,,PR0
        19 000035   200041 471500                    LDP1    LABEL_END$,,AUTO
        19 000036   100011 756100                    STQ     9,,PR1

      231    11962
      232    11963           %RESERVE_ILS (ITEM = %OPN, POINTER = SUB$);

  11983 19 000037   000002 236000 17                 LDQ     ILS_+2
        19 000040   000004 036007                    ADLQ    4,DL
        19 000041   000003 116000 17                 CMPQ    ILS_+3
        19 000042   000053 602000 19                 TNC     s:11985

  11984 19 000043   000005 236000 20                 LDQ     5
        19 000044   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000045   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000046   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000047   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000050   000004 631400 20                 EPPR1   4
        19 000051   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000052   000000 011000                    NOP     0

  11985 19 000053   000002 236000 17                 LDQ     ILS_+2
        19 000054   000022 736000                    QLS     18
        19 000055   000001 036000 17                 ADLQ    ILS_+1
        19 000056   200036 470500                    LDP0    @SUB$,,AUTO
        19 000057   000000 756100                    STQ     0,,PR0

  11986 19 000060   000002 235000 17                 LDA     ILS_+2
        19 000061   000004 035007                    ADLA    4,DL
        19 000062   000002 755000 17                 STA     ILS_+2

  11987 19 000063   000000 471500                    LDP1    0,,PR0
        19 000064   000740 220003                    LDX0    480,DU
        19 000065   100000 740100                    STX0    0,,PR1

  11988 19 000066   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:46   
        19 000067   000003 236000 20                 LDQ     3
        19 000070   100002 756100                    STQ     2,,PR1

      233    11992
      234    11993           %RESERVE_ILL (ITEM = %LINOI, POINTER = SUB$ -> ILS.ILL$);

  11995 19 000071   000145 235000 xsym               LDA     ILL_STEP+101
        19 000072   000000 755000 0                  STA     ITERATION

  11996 19 000073   000002 236000 15                 LDQ     ILL_+2
        19 000074   000000 036000 0                  ADLQ    ITERATION
        19 000075   000003 116000 15                 CMPQ    ILL_+3
        19 000076   000107 604000 19                 TMI     s:11998

  11997 19 000077   000006 236000 20                 LDQ     6
        19 000100   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000101   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000102   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000103   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000104   000004 631400 20                 EPPR1   4
        19 000105   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000106   000000 011000                    NOP     0

  11998 19 000107   200036 470500                    LDP0    @SUB$,,AUTO
        19 000110   000000 471500                    LDP1    0,,PR0
        19 000111   000002 236000 15                 LDQ     ILL_+2
        19 000112   000022 736000                    QLS     18
        19 000113   000001 036000 15                 ADLQ    ILL_+1
        19 000114   100003 756100                    STQ     3,,PR1

  11999 19 000115   000002 236000 15                 LDQ     ILL_+2
        19 000116   000000 036000 0                  ADLQ    ITERATION
        19 000117   000002 756000 15                 STQ     ILL_+2

  12000 19 000120   000000 471500                    LDP1    0,,PR0
        19 000121   100003 473500                    LDP3    3,,PR1
        19 000122   000373 220003                    LDX0    251,DU
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:47   
        19 000123   300000 740100                    STX0    0,,PR3

      235    12003
      236    12004    2      SUB$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  12004 19 000124   000000 471500                    LDP1    0,,PR0
        19 000125   100003 473500                    LDP3    3,,PR1
        19 000126   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 000127   000100 100500                    MLR     fill='000'O
        19 000130   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 000131   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      237    12005    2      SUB_TAIL$ = SUB$;

  12005 19 000132   000000 236100                    LDQ     0,,PR0
        19 000133   200037 471500                    LDP1    @SUB_TAIL$,,AUTO
        19 000134   100000 756100                    STQ     0,,PR1

      238    12006
      239    12007           %RSV_ILS_ILL (@ILL_ITEM = %GO);

  12030 19 000135   000002 236000 17                 LDQ     ILS_+2
        19 000136   000004 036007                    ADLQ    4,DL
        19 000137   000003 116000 17                 CMPQ    ILS_+3
        19 000140   000151 602000 19                 TNC     s:12032

  12031 19 000141   000005 236000 20                 LDQ     5
        19 000142   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000143   200056 633500                    EPPR3   POINTER$$+2,,AUTO
        19 000144   200057 453500                    STP3    POINTER$$+3,,AUTO
        19 000145   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000146   000004 631400 20                 EPPR1   4
        19 000147   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000150   000000 011000                    NOP     0

  12032 19 000151   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000152   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:48   
        19 000153   000002 236000 17                 LDQ     ILS_+2
        19 000154   000022 736000                    QLS     18
        19 000155   000001 036000 17                 ADLQ    ILS_+1
        19 000156   100002 756100                    STQ     2,,PR1

  12033 19 000157   000002 235000 17                 LDA     ILS_+2
        19 000160   000004 035007                    ADLA    4,DL
        19 000161   000002 755000 17                 STA     ILS_+2

  12034 19 000162   000000 471500                    LDP1    0,,PR0
        19 000163   100002 473500                    LDP3    2,,PR1
        19 000164   000740 220003                    LDX0    480,DU
        19 000165   300000 740100                    STX0    0,,PR3

  12035 19 000166   000000 471500                    LDP1    0,,PR0
        19 000167   100002 473500                    LDP3    2,,PR1
        19 000170   000003 236000 20                 LDQ     3
        19 000171   300002 756100                    STQ     2,,PR3

  12042 19 000172   000116 235000 xsym               LDA     ILL_STEP+78
        19 000173   000000 755000 0                  STA     ITERATION

  12043 19 000174   000002 236000 15                 LDQ     ILL_+2
        19 000175   000000 036000 0                  ADLQ    ITERATION
        19 000176   000003 116000 15                 CMPQ    ILL_+3
        19 000177   000210 604000 19                 TMI     s:12045

  12044 19 000200   000006 236000 20                 LDQ     6
        19 000201   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000202   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000203   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000204   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000205   000004 631400 20                 EPPR1   4
        19 000206   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000207   000000 011000                    NOP     0

  12045 19 000210   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:49   
        19 000211   000000 471500                    LDP1    0,,PR0
        19 000212   100002 473500                    LDP3    2,,PR1
        19 000213   000002 236000 15                 LDQ     ILL_+2
        19 000214   000022 736000                    QLS     18
        19 000215   000001 036000 15                 ADLQ    ILL_+1
        19 000216   300003 756100                    STQ     3,,PR3

  12046 19 000217   000002 236000 15                 LDQ     ILL_+2
        19 000220   000000 036000 0                  ADLQ    ITERATION
        19 000221   000002 756000 15                 STQ     ILL_+2

  12047 19 000222   000000 471500                    LDP1    0,,PR0
        19 000223   100002 473500                    LDP3    2,,PR1
        19 000224   300003 474500                    LDP4    3,,PR3
        19 000225   000344 220003                    LDX0    228,DU
        19 000226   400000 740100                    STX0    0,,PR4

  12050 19 000227   000000 471500                    LDP1    0,,PR0
        19 000230   100002 236100                    LDQ     2,,PR1
        19 000231   000000 756100                    STQ     0,,PR0

      240    12053
      241    12054    2      SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_UNCONDITIONAL;

  12054 19 000232   000000 471500                    LDP1    0,,PR0
        19 000233   100003 473500                    LDP3    3,,PR1
        19 000234   000000 221003                    LDX1    0,DU
        19 000235   300000 441100                    SXL1    0,,PR3

      242    12055    2      SUB_TAIL$ -> ILS.ILL$ -> GO.LABEL$ = LABEL_END$;

  12055 19 000236   000000 471500                    LDP1    0,,PR0
        19 000237   100003 473500                    LDP3    3,,PR1
        19 000240   200041 236100                    LDQ     LABEL_END$,,AUTO
        19 000241   300001 756100                    STQ     1,,PR3

      243    12056    2      SUB_TAIL$ -> ILS.ILL$ -> GO.EXPR$ = ADDR(NIL);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:50   

  12056 19 000242   000000 471500                    LDP1    0,,PR0
        19 000243   100003 473500                    LDP3    3,,PR1
        19 000244   000003 236000 20                 LDQ     3
        19 000245   300002 756100                    STQ     2,,PR3

      244    12057
      245    12058    3      DO I = %MAX_FIXED_SEG# + 1 TO %MAX_SEG#;

  12058 19 000246   000062 235007                    LDA     50,DL
        19 000247   200043 755100                    STA     I,,AUTO
        19 000250   001247 710000 19                 TRA     s:12416+1

      246    12059    3        IF ARRAY$ -> LTS_PTR_ARRAY.P$(I) ~= ADDR(NIL) THEN

  12059 19 000251   200040 470500                    LDP0    @ARRAY$,,AUTO
        19 000252   000000 471500                    LDP1    0,,PR0
        19 000253   200043 720100                    LXL0    I,,AUTO
        19 000254   100002 236110                    LDQ     2,X0,PR1
        19 000255   000003 116000 20                 CMPQ    3
        19 000256   001246 600000 19                 TZE     s:12416

      247    12060    4          DO;

      248    12061    4            SEG_LTS$ = ARRAY$ -> LTS_PTR_ARRAY.P$(I);

  12061 19 000257   200044 756100                    STQ     SEG_LTS$,,AUTO

      249    12062    4            INIT_SUB$ = SUB_TAIL$;   /* for optimize the subroutine */

  12062 19 000260   200037 473500                    LDP3    @SUB_TAIL$,,AUTO
        19 000261   300000 236100                    LDQ     0,,PR3
        19 000262   200045 756100                    STQ     INIT_SUB$,,AUTO

      250    12063
      251    12064                 %USE_PROC_HEADER;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:51   
  12068 19 000263   200042 634500                    EPPR4   LABEL_USE$,,AUTO
        19 000264   200057 454500                    STP4    POINTER$$+3,,AUTO
        19 000265   000002 236000 20                 LDQ     2
        19 000266   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000267   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 000270   000000 631400 20                 EPPR1   0
        19 000271   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        19 000272   000000 011000                    NOP     0

  12069 19 000273   200042 470500                    LDP0    LABEL_USE$,,AUTO
        19 000274   400000 236003                    LDQ     -131072,DU
        19 000275   000003 256100                    ORSQ    3,,PR0

  12070 19 000276   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000277   000000 236100                    LDQ     0,,PR0
        19 000300   200042 471500                    LDP1    LABEL_USE$,,AUTO
        19 000301   100010 756100                    STQ     8,,PR1

  12071 19 000302   200014 236100                    LDQ     CURRENT_PROC$,,AUTO
        19 000303   200042 471500                    LDP1    LABEL_USE$,,AUTO
        19 000304   100011 756100                    STQ     9,,PR1

  12095 19 000305   000002 236000 17                 LDQ     ILS_+2
        19 000306   000004 036007                    ADLQ    4,DL
        19 000307   000003 116000 17                 CMPQ    ILS_+3
        19 000310   000321 602000 19                 TNC     s:12097

  12096 19 000311   000005 236000 20                 LDQ     5
        19 000312   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000313   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000314   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000315   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000316   000004 631400 20                 EPPR1   4
        19 000317   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000320   000000 011000                    NOP     0

  12097 19 000321   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:52   
        19 000322   000000 471500                    LDP1    0,,PR0
        19 000323   000002 236000 17                 LDQ     ILS_+2
        19 000324   000022 736000                    QLS     18
        19 000325   000001 036000 17                 ADLQ    ILS_+1
        19 000326   100002 756100                    STQ     2,,PR1

  12098 19 000327   000002 235000 17                 LDA     ILS_+2
        19 000330   000004 035007                    ADLA    4,DL
        19 000331   000002 755000 17                 STA     ILS_+2

  12099 19 000332   000000 471500                    LDP1    0,,PR0
        19 000333   100002 473500                    LDP3    2,,PR1
        19 000334   000740 220003                    LDX0    480,DU
        19 000335   300000 740100                    STX0    0,,PR3

  12100 19 000336   000000 471500                    LDP1    0,,PR0
        19 000337   100002 473500                    LDP3    2,,PR1
        19 000340   000003 236000 20                 LDQ     3
        19 000341   300002 756100                    STQ     2,,PR3

  12107 19 000342   000145 235000 xsym               LDA     ILL_STEP+101
        19 000343   000000 755000 0                  STA     ITERATION

  12108 19 000344   000002 236000 15                 LDQ     ILL_+2
        19 000345   000000 036000 0                  ADLQ    ITERATION
        19 000346   000003 116000 15                 CMPQ    ILL_+3
        19 000347   000360 604000 19                 TMI     s:12110

  12109 19 000350   000006 236000 20                 LDQ     6
        19 000351   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000352   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000353   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000354   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000355   000004 631400 20                 EPPR1   4
        19 000356   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000357   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:53   
  12110 19 000360   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000361   000000 471500                    LDP1    0,,PR0
        19 000362   100002 473500                    LDP3    2,,PR1
        19 000363   000002 236000 15                 LDQ     ILL_+2
        19 000364   000022 736000                    QLS     18
        19 000365   000001 036000 15                 ADLQ    ILL_+1
        19 000366   300003 756100                    STQ     3,,PR3

  12111 19 000367   000002 236000 15                 LDQ     ILL_+2
        19 000370   000000 036000 0                  ADLQ    ITERATION
        19 000371   000002 756000 15                 STQ     ILL_+2

  12112 19 000372   000000 471500                    LDP1    0,,PR0
        19 000373   100002 473500                    LDP3    2,,PR1
        19 000374   300003 474500                    LDP4    3,,PR3
        19 000375   000373 220003                    LDX0    251,DU
        19 000376   400000 740100                    STX0    0,,PR4

  12115 19 000377   000000 471500                    LDP1    0,,PR0
        19 000400   100002 236100                    LDQ     2,,PR1
        19 000401   000000 756100                    STQ     0,,PR0

  12118 19 000402   000000 471500                    LDP1    0,,PR0
        19 000403   100003 473500                    LDP3    3,,PR1
        19 000404   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 000405   000100 100500                    MLR     fill='000'O
        19 000406   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 000407   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

  12142 19 000410   000002 236000 17                 LDQ     ILS_+2
        19 000411   000004 036007                    ADLQ    4,DL
        19 000412   000003 116000 17                 CMPQ    ILS_+3
        19 000413   000424 602000 19                 TNC     s:12144

  12143 19 000414   000005 236000 20                 LDQ     5
        19 000415   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000416   200056 631500                    EPPR1   POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:54   
        19 000417   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000420   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000421   000004 631400 20                 EPPR1   4
        19 000422   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000423   000000 011000                    NOP     0

  12144 19 000424   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000425   000000 471500                    LDP1    0,,PR0
        19 000426   000002 236000 17                 LDQ     ILS_+2
        19 000427   000022 736000                    QLS     18
        19 000430   000001 036000 17                 ADLQ    ILS_+1
        19 000431   100002 756100                    STQ     2,,PR1

  12145 19 000432   000002 235000 17                 LDA     ILS_+2
        19 000433   000004 035007                    ADLA    4,DL
        19 000434   000002 755000 17                 STA     ILS_+2

  12146 19 000435   000000 471500                    LDP1    0,,PR0
        19 000436   100002 473500                    LDP3    2,,PR1
        19 000437   000740 220003                    LDX0    480,DU
        19 000440   300000 740100                    STX0    0,,PR3

  12147 19 000441   000000 471500                    LDP1    0,,PR0
        19 000442   100002 473500                    LDP3    2,,PR1
        19 000443   000003 236000 20                 LDQ     3
        19 000444   300002 756100                    STQ     2,,PR3

  12154 19 000445   000120 235000 xsym               LDA     ILL_STEP+80
        19 000446   000000 755000 0                  STA     ITERATION

  12155 19 000447   000002 236000 15                 LDQ     ILL_+2
        19 000450   000000 036000 0                  ADLQ    ITERATION
        19 000451   000003 116000 15                 CMPQ    ILL_+3
        19 000452   000463 604000 19                 TMI     s:12157

  12156 19 000453   000006 236000 20                 LDQ     6
        19 000454   200056 756100                    STQ     POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:55   
        19 000455   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000456   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000457   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000460   000004 631400 20                 EPPR1   4
        19 000461   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000462   000000 011000                    NOP     0

  12157 19 000463   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000464   000000 471500                    LDP1    0,,PR0
        19 000465   100002 473500                    LDP3    2,,PR1
        19 000466   000002 236000 15                 LDQ     ILL_+2
        19 000467   000022 736000                    QLS     18
        19 000470   000001 036000 15                 ADLQ    ILL_+1
        19 000471   300003 756100                    STQ     3,,PR3

  12158 19 000472   000002 236000 15                 LDQ     ILL_+2
        19 000473   000000 036000 0                  ADLQ    ITERATION
        19 000474   000002 756000 15                 STQ     ILL_+2

  12159 19 000475   000000 471500                    LDP1    0,,PR0
        19 000476   100002 473500                    LDP3    2,,PR1
        19 000477   300003 474500                    LDP4    3,,PR3
        19 000500   000346 220003                    LDX0    230,DU
        19 000501   400000 740100                    STX0    0,,PR4

  12162 19 000502   000000 471500                    LDP1    0,,PR0
        19 000503   100002 236100                    LDQ     2,,PR1
        19 000504   000000 756100                    STQ     0,,PR0

  12165 19 000505   000000 471500                    LDP1    0,,PR0
        19 000506   100003 473500                    LDP3    3,,PR1
        19 000507   200042 236100                    LDQ     LABEL_USE$,,AUTO
        19 000510   300001 756100                    STQ     1,,PR3

  12168 19 000511   200023 236100                    LDQ     LAST_LABEL$,,AUTO
        19 000512   000003 116000 20                 CMPQ    3
        19 000513   000523 601000 19                 TNZ     s:12175
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:56   

  12170 19 000514   000000 471500                    LDP1    0,,PR0
        19 000515   100003 473500                    LDP3    3,,PR1
        19 000516   000321 236000 xsym               LDQ     COMCOM+209
        19 000517   300002 756100                    STQ     2,,PR3

  12171 19 000520   000000 236100                    LDQ     0,,PR0
        19 000521   000321 756000 xsym               STQ     COMCOM+209

  12172 19 000522   000534 710000 19                 TRA     s:12178

  12175 19 000523   000000 471500                    LDP1    0,,PR0
        19 000524   100003 473500                    LDP3    3,,PR1
        19 000525   200023 474500                    LDP4    LAST_LABEL$,,AUTO
        19 000526   400003 475500                    LDP5    3,,PR4
        19 000527   500002 236100                    LDQ     2,,PR5
        19 000530   300002 756100                    STQ     2,,PR3

  12176 19 000531   400003 471500                    LDP1    3,,PR4
        19 000532   000000 236100                    LDQ     0,,PR0
        19 000533   100002 756100                    STQ     2,,PR1

  12178 19 000534   000000 236100                    LDQ     0,,PR0
        19 000535   200023 756100                    STQ     LAST_LABEL$,,AUTO

  12206 19 000536   000002 236000 17                 LDQ     ILS_+2
        19 000537   000004 036007                    ADLQ    4,DL
        19 000540   000003 116000 17                 CMPQ    ILS_+3
        19 000541   000552 602000 19                 TNC     s:12208

  12207 19 000542   000005 236000 20                 LDQ     5
        19 000543   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000544   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000545   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000546   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000547   000004 631400 20                 EPPR1   4
        19 000550   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:57   
        19 000551   000000 011000                    NOP     0

  12208 19 000552   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000553   000000 471500                    LDP1    0,,PR0
        19 000554   000002 236000 17                 LDQ     ILS_+2
        19 000555   000022 736000                    QLS     18
        19 000556   000001 036000 17                 ADLQ    ILS_+1
        19 000557   100002 756100                    STQ     2,,PR1

  12209 19 000560   000002 235000 17                 LDA     ILS_+2
        19 000561   000004 035007                    ADLA    4,DL
        19 000562   000002 755000 17                 STA     ILS_+2

  12210 19 000563   000000 471500                    LDP1    0,,PR0
        19 000564   100002 473500                    LDP3    2,,PR1
        19 000565   000740 220003                    LDX0    480,DU
        19 000566   300000 740100                    STX0    0,,PR3

  12211 19 000567   000000 471500                    LDP1    0,,PR0
        19 000570   100002 473500                    LDP3    2,,PR1
        19 000571   000003 236000 20                 LDQ     3
        19 000572   300002 756100                    STQ     2,,PR3

  12218 19 000573   000145 235000 xsym               LDA     ILL_STEP+101
        19 000574   000000 755000 0                  STA     ITERATION

  12219 19 000575   000002 236000 15                 LDQ     ILL_+2
        19 000576   000000 036000 0                  ADLQ    ITERATION
        19 000577   000003 116000 15                 CMPQ    ILL_+3
        19 000600   000611 604000 19                 TMI     s:12221

  12220 19 000601   000006 236000 20                 LDQ     6
        19 000602   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000603   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000604   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000605   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000606   000004 631400 20                 EPPR1   4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:58   
        19 000607   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000610   000000 011000                    NOP     0

  12221 19 000611   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000612   000000 471500                    LDP1    0,,PR0
        19 000613   100002 473500                    LDP3    2,,PR1
        19 000614   000002 236000 15                 LDQ     ILL_+2
        19 000615   000022 736000                    QLS     18
        19 000616   000001 036000 15                 ADLQ    ILL_+1
        19 000617   300003 756100                    STQ     3,,PR3

  12222 19 000620   000002 236000 15                 LDQ     ILL_+2
        19 000621   000000 036000 0                  ADLQ    ITERATION
        19 000622   000002 756000 15                 STQ     ILL_+2

  12223 19 000623   000000 471500                    LDP1    0,,PR0
        19 000624   100002 473500                    LDP3    2,,PR1
        19 000625   300003 474500                    LDP4    3,,PR3
        19 000626   000373 220003                    LDX0    251,DU
        19 000627   400000 740100                    STX0    0,,PR4

  12226 19 000630   000000 471500                    LDP1    0,,PR0
        19 000631   100002 236100                    LDQ     2,,PR1
        19 000632   000000 756100                    STQ     0,,PR0

  12229 19 000633   000000 471500                    LDP1    0,,PR0
        19 000634   100003 473500                    LDP3    3,,PR1
        19 000635   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 000636   000100 100500                    MLR     fill='000'O
        19 000637   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 000640   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

  12253 19 000641   000002 236000 17                 LDQ     ILS_+2
        19 000642   000004 036007                    ADLQ    4,DL
        19 000643   000003 116000 17                 CMPQ    ILS_+3
        19 000644   000655 602000 19                 TNC     s:12255

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:59   
  12254 19 000645   000005 236000 20                 LDQ     5
        19 000646   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000647   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000650   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000651   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000652   000004 631400 20                 EPPR1   4
        19 000653   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000654   000000 011000                    NOP     0

  12255 19 000655   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000656   000000 471500                    LDP1    0,,PR0
        19 000657   000002 236000 17                 LDQ     ILS_+2
        19 000660   000022 736000                    QLS     18
        19 000661   000001 036000 17                 ADLQ    ILS_+1
        19 000662   100002 756100                    STQ     2,,PR1

  12256 19 000663   000002 235000 17                 LDA     ILS_+2
        19 000664   000004 035007                    ADLA    4,DL
        19 000665   000002 755000 17                 STA     ILS_+2

  12257 19 000666   000000 471500                    LDP1    0,,PR0
        19 000667   100002 473500                    LDP3    2,,PR1
        19 000670   000740 220003                    LDX0    480,DU
        19 000671   300000 740100                    STX0    0,,PR3

  12258 19 000672   000000 471500                    LDP1    0,,PR0
        19 000673   100002 473500                    LDP3    2,,PR1
        19 000674   000003 236000 20                 LDQ     3
        19 000675   300002 756100                    STQ     2,,PR3

  12265 19 000676   000136 235000 xsym               LDA     ILL_STEP+94
        19 000677   000000 755000 0                  STA     ITERATION

  12266 19 000700   000002 236000 15                 LDQ     ILL_+2
        19 000701   000000 036000 0                  ADLQ    ITERATION
        19 000702   000003 116000 15                 CMPQ    ILL_+3
        19 000703   000714 604000 19                 TMI     s:12268
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:60   

  12267 19 000704   000006 236000 20                 LDQ     6
        19 000705   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 000706   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 000707   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 000710   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 000711   000004 631400 20                 EPPR1   4
        19 000712   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 000713   000000 011000                    NOP     0

  12268 19 000714   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000715   000000 471500                    LDP1    0,,PR0
        19 000716   100002 473500                    LDP3    2,,PR1
        19 000717   000002 236000 15                 LDQ     ILL_+2
        19 000720   000022 736000                    QLS     18
        19 000721   000001 036000 15                 ADLQ    ILL_+1
        19 000722   300003 756100                    STQ     3,,PR3

  12269 19 000723   000002 236000 15                 LDQ     ILL_+2
        19 000724   000000 036000 0                  ADLQ    ITERATION
        19 000725   000002 756000 15                 STQ     ILL_+2

  12270 19 000726   000000 471500                    LDP1    0,,PR0
        19 000727   100002 473500                    LDP3    2,,PR1
        19 000730   300003 474500                    LDP4    3,,PR3
        19 000731   000364 220003                    LDX0    244,DU
        19 000732   400000 740100                    STX0    0,,PR4

  12273 19 000733   000000 471500                    LDP1    0,,PR0
        19 000734   100002 236100                    LDQ     2,,PR1
        19 000735   000000 756100                    STQ     0,,PR0

  12276 19 000736   000000 471500                    LDP1    0,,PR0
        19 000737   100003 473500                    LDP3    3,,PR1
        19 000740   000003 221003                    LDX1    3,DU
        19 000741   300000 441100                    SXL1    0,,PR3

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:61   
  12277 19 000742   000000 471500                    LDP1    0,,PR0
        19 000743   100003 473500                    LDP3    3,,PR1
        19 000744   000003 236000 20                 LDQ     3
        19 000745   300001 756100                    STQ     1,,PR3

      252    12280
      253    12281    4            LAST_SUB$ = SUB_TAIL$;

  12281 19 000746   000000 236100                    LDQ     0,,PR0
        19 000747   200046 756100                    STQ     LAST_SUB$,,AUTO

      254    12282
      255    12283    5            DO WHILE (SEG_LTS$ ~= ADDR(NIL));

  12283 19 000750   001013 710000 19                 TRA     s:12300

      256    12284    5              IF SEG_LTS$ -> SEGMENT_LTS.SECTION_ST$ -> SECTION.PROC$ = PROC$ AND

  12284 19 000751   200044 470500                    LDP0    SEG_LTS$,,AUTO
        19 000752   000001 471500                    LDP1    1,,PR0
        19 000753   200035 473500                    LDP3    @PROC$,,AUTO
        19 000754   100011 236100                    LDQ     9,,PR1
        19 000755   300000 116100                    CMPQ    0,,PR3
        19 000756   001010 601000 19                 TNZ     s:12299
        19 000757   000004 236100                    LDQ     4,,PR0
        19 000760   000003 116000 20                 CMPQ    3
        19 000761   001010 600000 19                 TZE     s:12299

      257    12285    5                SEG_LTS$ -> SEGMENT_LTS.ALTER_RESET$ ~= ADDR(NIL) THEN
      258    12286    6                DO;

      259    12287    6                  SUB_TAIL$ -> ILS.NEXT = SEG_LTS$ -> SEGMENT_LTS.ALTER_RESET$;

  12287 19 000762   200037 474500                    LDP4    @SUB_TAIL$,,AUTO
        19 000763   400000 475500                    LDP5    0,,PR4
        19 000764   500002 756100                    STQ     2,,PR5

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:62   
      260    12288
      261    12289    7                  DO WHILE (SUB_TAIL$ -> ILS.NEXT ~= ADDR(NIL));

  12289 19 000765   001003 710000 19                 TRA     s:12296

      262    12290
      263    12291    7                    IF SUB_TAIL$ -> ILS.ILL$ -> ILL.ID = %LINOI THEN

  12291 19 000766   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 000767   000000 471500                    LDP1    0,,PR0
        19 000770   100003 473500                    LDP3    3,,PR1
        19 000771   300000 220100                    LDX0    0,,PR3
        19 000772   000373 100003                    CMPX0   251,DU
        19 000773   001000 601000 19                 TNZ     s:12294

      264    12292    7                       SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  12292 19 000774   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 000775   000100 100500                    MLR     fill='000'O
        19 000776   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 000777   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      265    12293
      266    12294    7                    SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;

  12294 19 001000   000000 471500                    LDP1    0,,PR0
        19 001001   100002 236100                    LDQ     2,,PR1
        19 001002   000000 756100                    STQ     0,,PR0

      267    12295
      268    12296    7                  END;

  12296 19 001003   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001004   000000 471500                    LDP1    0,,PR0
        19 001005   100002 236100                    LDQ     2,,PR1
        19 001006   000003 116000 20                 CMPQ    3
        19 001007   000766 601000 19                 TNZ     s:12291
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:63   

      269    12297    6                END; /* IF */

      270    12298
      271    12299    5              SEG_LTS$ = SEG_LTS$ -> SEGMENT_LTS.NEXT;

  12299 19 001010   200044 470500                    LDP0    SEG_LTS$,,AUTO
        19 001011   000005 236100                    LDQ     5,,PR0
        19 001012   200044 756100                    STQ     SEG_LTS$,,AUTO

      272    12300    5            END; /* WHILE */

  12300 19 001013   200044 236100                    LDQ     SEG_LTS$,,AUTO
        19 001014   000003 116000 20                 CMPQ    3
        19 001015   000751 601000 19                 TNZ     s:12284

      273    12301
      274    12302    4            IF SUB_TAIL$ = LAST_SUB$ THEN  /* no reset altered GO */

  12302 19 001016   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001017   000000 236100                    LDQ     0,,PR0
        19 001020   200046 116100                    CMPQ    LAST_SUB$,,AUTO
        19 001021   001030 601000 19                 TNZ     s:12311

      275    12303    5              DO;

      276    12304                     /* drop the use proc header */
      277    12305    5                SUB_TAIL$ = INIT_SUB$;

  12305 19 001022   200045 236100                    LDQ     INIT_SUB$,,AUTO
        19 001023   000000 756100                    STQ     0,,PR0

      278    12306    5                SUB_TAIL$ -> ILS.NEXT = ADDR(NIL);

  12306 19 001024   000000 471500                    LDP1    0,,PR0
        19 001025   000003 236000 20                 LDQ     3
        19 001026   100002 756100                    STQ     2,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:64   

      279    12307    5              END;

  12307 19 001027   001246 710000 19                 TRA     s:12416

      280    12308    4            ELSE
      281    12309    5              DO;

      282    12310                       /* save the use proc header's label */
      283    12311    5                ARRAY$ -> LTS_PTR_ARRAY.P$(I) -> SEGMENT_LTS.SUB_LABEL$ =

  12311 19 001030   200040 471500                    LDP1    @ARRAY$,,AUTO
        19 001031   100000 473500                    LDP3    0,,PR1
        19 001032   200043 720100                    LXL0    I,,AUTO
        19 001033   300002 474510                    LDP4    2,X0,PR3
        19 001034   200042 236100                    LDQ     LABEL_USE$,,AUTO
        19 001035   400007 756100                    STQ     7,,PR4

      284    12312    5                  LABEL_USE$;
      285    12313
      286    12314                     %USE_PROC_TAILER;

  12339 19 001036   000002 236000 17                 LDQ     ILS_+2
        19 001037   000004 036007                    ADLQ    4,DL
        19 001040   000003 116000 17                 CMPQ    ILS_+3
        19 001041   001052 602000 19                 TNC     s:12341

  12340 19 001042   000005 236000 20                 LDQ     5
        19 001043   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001044   200056 633500                    EPPR3   POINTER$$+2,,AUTO
        19 001045   200057 453500                    STP3    POINTER$$+3,,AUTO
        19 001046   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001047   000004 631400 20                 EPPR1   4
        19 001050   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001051   000000 011000                    NOP     0

  12341 19 001052   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:65   
        19 001053   000000 471500                    LDP1    0,,PR0
        19 001054   000002 236000 17                 LDQ     ILS_+2
        19 001055   000022 736000                    QLS     18
        19 001056   000001 036000 17                 ADLQ    ILS_+1
        19 001057   100002 756100                    STQ     2,,PR1

  12342 19 001060   000002 235000 17                 LDA     ILS_+2
        19 001061   000004 035007                    ADLA    4,DL
        19 001062   000002 755000 17                 STA     ILS_+2

  12343 19 001063   000000 471500                    LDP1    0,,PR0
        19 001064   100002 473500                    LDP3    2,,PR1
        19 001065   000740 220003                    LDX0    480,DU
        19 001066   300000 740100                    STX0    0,,PR3

  12344 19 001067   000000 471500                    LDP1    0,,PR0
        19 001070   100002 473500                    LDP3    2,,PR1
        19 001071   000003 236000 20                 LDQ     3
        19 001072   300002 756100                    STQ     2,,PR3

  12351 19 001073   000145 235000 xsym               LDA     ILL_STEP+101
        19 001074   000000 755000 0                  STA     ITERATION

  12352 19 001075   000002 236000 15                 LDQ     ILL_+2
        19 001076   000000 036000 0                  ADLQ    ITERATION
        19 001077   000003 116000 15                 CMPQ    ILL_+3
        19 001100   001111 604000 19                 TMI     s:12354

  12353 19 001101   000006 236000 20                 LDQ     6
        19 001102   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001103   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001104   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001105   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001106   000004 631400 20                 EPPR1   4
        19 001107   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001110   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:66   
  12354 19 001111   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001112   000000 471500                    LDP1    0,,PR0
        19 001113   100002 473500                    LDP3    2,,PR1
        19 001114   000002 236000 15                 LDQ     ILL_+2
        19 001115   000022 736000                    QLS     18
        19 001116   000001 036000 15                 ADLQ    ILL_+1
        19 001117   300003 756100                    STQ     3,,PR3

  12355 19 001120   000002 236000 15                 LDQ     ILL_+2
        19 001121   000000 036000 0                  ADLQ    ITERATION
        19 001122   000002 756000 15                 STQ     ILL_+2

  12356 19 001123   000000 471500                    LDP1    0,,PR0
        19 001124   100002 473500                    LDP3    2,,PR1
        19 001125   300003 474500                    LDP4    3,,PR3
        19 001126   000373 220003                    LDX0    251,DU
        19 001127   400000 740100                    STX0    0,,PR4

  12359 19 001130   000000 471500                    LDP1    0,,PR0
        19 001131   100002 236100                    LDQ     2,,PR1
        19 001132   000000 756100                    STQ     0,,PR0

  12362 19 001133   000000 471500                    LDP1    0,,PR0
        19 001134   100003 473500                    LDP3    3,,PR1
        19 001135   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 001136   000100 100500                    MLR     fill='000'O
        19 001137   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 001140   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

  12386 19 001141   000002 236000 17                 LDQ     ILS_+2
        19 001142   000004 036007                    ADLQ    4,DL
        19 001143   000003 116000 17                 CMPQ    ILS_+3
        19 001144   001155 602000 19                 TNC     s:12388

  12387 19 001145   000005 236000 20                 LDQ     5
        19 001146   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001147   200056 631500                    EPPR1   POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:67   
        19 001150   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001151   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001152   000004 631400 20                 EPPR1   4
        19 001153   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001154   000000 011000                    NOP     0

  12388 19 001155   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001156   000000 471500                    LDP1    0,,PR0
        19 001157   000002 236000 17                 LDQ     ILS_+2
        19 001160   000022 736000                    QLS     18
        19 001161   000001 036000 17                 ADLQ    ILS_+1
        19 001162   100002 756100                    STQ     2,,PR1

  12389 19 001163   000002 235000 17                 LDA     ILS_+2
        19 001164   000004 035007                    ADLA    4,DL
        19 001165   000002 755000 17                 STA     ILS_+2

  12390 19 001166   000000 471500                    LDP1    0,,PR0
        19 001167   100002 473500                    LDP3    2,,PR1
        19 001170   000740 220003                    LDX0    480,DU
        19 001171   300000 740100                    STX0    0,,PR3

  12391 19 001172   000000 471500                    LDP1    0,,PR0
        19 001173   100002 473500                    LDP3    2,,PR1
        19 001174   000003 236000 20                 LDQ     3
        19 001175   300002 756100                    STQ     2,,PR3

  12398 19 001176   000137 235000 xsym               LDA     ILL_STEP+95
        19 001177   000000 755000 0                  STA     ITERATION

  12399 19 001200   000002 236000 15                 LDQ     ILL_+2
        19 001201   000000 036000 0                  ADLQ    ITERATION
        19 001202   000003 116000 15                 CMPQ    ILL_+3
        19 001203   001214 604000 19                 TMI     s:12401

  12400 19 001204   000006 236000 20                 LDQ     6
        19 001205   200056 756100                    STQ     POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:68   
        19 001206   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001207   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001210   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001211   000004 631400 20                 EPPR1   4
        19 001212   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001213   000000 011000                    NOP     0

  12401 19 001214   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001215   000000 471500                    LDP1    0,,PR0
        19 001216   100002 473500                    LDP3    2,,PR1
        19 001217   000002 236000 15                 LDQ     ILL_+2
        19 001220   000022 736000                    QLS     18
        19 001221   000001 036000 15                 ADLQ    ILL_+1
        19 001222   300003 756100                    STQ     3,,PR3

  12402 19 001223   000002 236000 15                 LDQ     ILL_+2
        19 001224   000000 036000 0                  ADLQ    ITERATION
        19 001225   000002 756000 15                 STQ     ILL_+2

  12403 19 001226   000000 471500                    LDP1    0,,PR0
        19 001227   100002 473500                    LDP3    2,,PR1
        19 001230   300003 474500                    LDP4    3,,PR3
        19 001231   000365 220003                    LDX0    245,DU
        19 001232   400000 740100                    STX0    0,,PR4

  12406 19 001233   000000 471500                    LDP1    0,,PR0
        19 001234   100002 236100                    LDQ     2,,PR1
        19 001235   000000 756100                    STQ     0,,PR0

  12409 19 001236   000000 471500                    LDP1    0,,PR0
        19 001237   100003 473500                    LDP3    3,,PR1
        19 001240   000003 221003                    LDX1    3,DU
        19 001241   300000 441100                    SXL1    0,,PR3

  12410 19 001242   000000 471500                    LDP1    0,,PR0
        19 001243   100003 473500                    LDP3    3,,PR1
        19 001244   000003 236000 20                 LDQ     3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:69   
        19 001245   300001 756100                    STQ     1,,PR3

      287    12413    5              END;

      288    12414
      289    12415    4          END;  /* IF DO */

      290    12416    3        END; /* DO I=...*/

  12416 19 001246   200043 054100                    AOS     I,,AUTO
        19 001247   200043 235100                    LDA     I,,AUTO
        19 001250   000143 115007                    CMPA    99,DL
        19 001251   000251 604400 19                 TMOZ    s:12059

      291    12417
      292    12418
      293    12419    2        LABEL_END$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  12419 19 001252   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001253   000000 236100                    LDQ     0,,PR0
        19 001254   200041 471500                    LDP1    LABEL_END$,,AUTO
        19 001255   100010 756100                    STQ     8,,PR1

      294    12420
      295    12421             %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  12444 19 001256   000002 236000 17                 LDQ     ILS_+2
        19 001257   000004 036007                    ADLQ    4,DL
        19 001260   000003 116000 17                 CMPQ    ILS_+3
        19 001261   001272 602000 19                 TNC     s:12446

  12445 19 001262   000005 236000 20                 LDQ     5
        19 001263   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001264   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001265   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001266   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001267   000004 631400 20                 EPPR1   4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:70   
        19 001270   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001271   000000 011000                    NOP     0

  12446 19 001272   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001273   000000 471500                    LDP1    0,,PR0
        19 001274   000002 236000 17                 LDQ     ILS_+2
        19 001275   000022 736000                    QLS     18
        19 001276   000001 036000 17                 ADLQ    ILS_+1
        19 001277   100002 756100                    STQ     2,,PR1

  12447 19 001300   000002 235000 17                 LDA     ILS_+2
        19 001301   000004 035007                    ADLA    4,DL
        19 001302   000002 755000 17                 STA     ILS_+2

  12448 19 001303   000000 471500                    LDP1    0,,PR0
        19 001304   100002 473500                    LDP3    2,,PR1
        19 001305   000740 220003                    LDX0    480,DU
        19 001306   300000 740100                    STX0    0,,PR3

  12449 19 001307   000000 471500                    LDP1    0,,PR0
        19 001310   100002 473500                    LDP3    2,,PR1
        19 001311   000003 236000 20                 LDQ     3
        19 001312   300002 756100                    STQ     2,,PR3

  12456 19 001313   000145 235000 xsym               LDA     ILL_STEP+101
        19 001314   000000 755000 0                  STA     ITERATION

  12457 19 001315   000002 236000 15                 LDQ     ILL_+2
        19 001316   000000 036000 0                  ADLQ    ITERATION
        19 001317   000003 116000 15                 CMPQ    ILL_+3
        19 001320   001331 604000 19                 TMI     s:12459

  12458 19 001321   000006 236000 20                 LDQ     6
        19 001322   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001323   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001324   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001325   200057 630500                    EPPR0   POINTER$$+3,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:71   
        19 001326   000004 631400 20                 EPPR1   4
        19 001327   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001330   000000 011000                    NOP     0

  12459 19 001331   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001332   000000 471500                    LDP1    0,,PR0
        19 001333   100002 473500                    LDP3    2,,PR1
        19 001334   000002 236000 15                 LDQ     ILL_+2
        19 001335   000022 736000                    QLS     18
        19 001336   000001 036000 15                 ADLQ    ILL_+1
        19 001337   300003 756100                    STQ     3,,PR3

  12460 19 001340   000002 236000 15                 LDQ     ILL_+2
        19 001341   000000 036000 0                  ADLQ    ITERATION
        19 001342   000002 756000 15                 STQ     ILL_+2

  12461 19 001343   000000 471500                    LDP1    0,,PR0
        19 001344   100002 473500                    LDP3    2,,PR1
        19 001345   300003 474500                    LDP4    3,,PR3
        19 001346   000373 220003                    LDX0    251,DU
        19 001347   400000 740100                    STX0    0,,PR4

  12464 19 001350   000000 471500                    LDP1    0,,PR0
        19 001351   100002 236100                    LDQ     2,,PR1
        19 001352   000000 756100                    STQ     0,,PR0

      296    12467
      297    12468    2        SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  12468 19 001353   000000 471500                    LDP1    0,,PR0
        19 001354   100003 473500                    LDP3    3,,PR1
        19 001355   200030 474500                    LDP4    ENTRY_LINOI$,,AUTO
        19 001356   000100 100500                    MLR     fill='000'O
        19 001357   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 001360   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      298    12469
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:72   
      299    12470             %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);

  12493 19 001361   000002 236000 17                 LDQ     ILS_+2
        19 001362   000004 036007                    ADLQ    4,DL
        19 001363   000003 116000 17                 CMPQ    ILS_+3
        19 001364   001375 602000 19                 TNC     s:12495

  12494 19 001365   000005 236000 20                 LDQ     5
        19 001366   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001367   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001370   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001371   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001372   000004 631400 20                 EPPR1   4
        19 001373   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001374   000000 011000                    NOP     0

  12495 19 001375   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001376   000000 471500                    LDP1    0,,PR0
        19 001377   000002 236000 17                 LDQ     ILS_+2
        19 001400   000022 736000                    QLS     18
        19 001401   000001 036000 17                 ADLQ    ILS_+1
        19 001402   100002 756100                    STQ     2,,PR1

  12496 19 001403   000002 235000 17                 LDA     ILS_+2
        19 001404   000004 035007                    ADLA    4,DL
        19 001405   000002 755000 17                 STA     ILS_+2

  12497 19 001406   000000 471500                    LDP1    0,,PR0
        19 001407   100002 473500                    LDP3    2,,PR1
        19 001410   000740 220003                    LDX0    480,DU
        19 001411   300000 740100                    STX0    0,,PR3

  12498 19 001412   000000 471500                    LDP1    0,,PR0
        19 001413   100002 473500                    LDP3    2,,PR1
        19 001414   000003 236000 20                 LDQ     3
        19 001415   300002 756100                    STQ     2,,PR3

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:73   
  12505 19 001416   000120 235000 xsym               LDA     ILL_STEP+80
        19 001417   000000 755000 0                  STA     ITERATION

  12506 19 001420   000002 236000 15                 LDQ     ILL_+2
        19 001421   000000 036000 0                  ADLQ    ITERATION
        19 001422   000003 116000 15                 CMPQ    ILL_+3
        19 001423   001434 604000 19                 TMI     s:12508

  12507 19 001424   000006 236000 20                 LDQ     6
        19 001425   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001426   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001427   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001430   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001431   000004 631400 20                 EPPR1   4
        19 001432   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001433   000000 011000                    NOP     0

  12508 19 001434   200037 470500                    LDP0    @SUB_TAIL$,,AUTO
        19 001435   000000 471500                    LDP1    0,,PR0
        19 001436   100002 473500                    LDP3    2,,PR1
        19 001437   000002 236000 15                 LDQ     ILL_+2
        19 001440   000022 736000                    QLS     18
        19 001441   000001 036000 15                 ADLQ    ILL_+1
        19 001442   300003 756100                    STQ     3,,PR3

  12509 19 001443   000002 236000 15                 LDQ     ILL_+2
        19 001444   000000 036000 0                  ADLQ    ITERATION
        19 001445   000002 756000 15                 STQ     ILL_+2

  12510 19 001446   000000 471500                    LDP1    0,,PR0
        19 001447   100002 473500                    LDP3    2,,PR1
        19 001450   300003 474500                    LDP4    3,,PR3
        19 001451   000346 220003                    LDX0    230,DU
        19 001452   400000 740100                    STX0    0,,PR4

  12513 19 001453   000000 471500                    LDP1    0,,PR0
        19 001454   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:74   
        19 001455   000000 756100                    STQ     0,,PR0

      300    12516
      301    12517    2        SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = LABEL_END$;

  12517 19 001456   000000 471500                    LDP1    0,,PR0
        19 001457   100003 473500                    LDP3    3,,PR1
        19 001460   200041 236100                    LDQ     LABEL_END$,,AUTO
        19 001461   300001 756100                    STQ     1,,PR3

      302    12518
      303    12519             %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);

  12521 19 001462   200023 236100                    LDQ     LAST_LABEL$,,AUTO
        19 001463   000003 116000 20                 CMPQ    3
        19 001464   001474 601000 19                 TNZ     s:12528

  12523 19 001465   000000 471500                    LDP1    0,,PR0
        19 001466   100003 473500                    LDP3    3,,PR1
        19 001467   000321 236000 xsym               LDQ     COMCOM+209
        19 001470   300002 756100                    STQ     2,,PR3

  12524 19 001471   000000 236100                    LDQ     0,,PR0
        19 001472   000321 756000 xsym               STQ     COMCOM+209

  12525 19 001473   001505 710000 19                 TRA     s:12531

  12528 19 001474   000000 471500                    LDP1    0,,PR0
        19 001475   100003 473500                    LDP3    3,,PR1
        19 001476   200023 474500                    LDP4    LAST_LABEL$,,AUTO
        19 001477   400003 475500                    LDP5    3,,PR4
        19 001500   500002 236100                    LDQ     2,,PR5
        19 001501   300002 756100                    STQ     2,,PR3

  12529 19 001502   400003 471500                    LDP1    3,,PR4
        19 001503   000000 236100                    LDQ     0,,PR0
        19 001504   100002 756100                    STQ     2,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:75   

  12531 19 001505   000000 236100                    LDQ     0,,PR0
        19 001506   200023 756100                    STQ     LAST_LABEL$,,AUTO

      304    12534
      305    12535    2        IF SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL ~= ADDR(NIL) AND

  12535 19 001507   000000 471500                    LDP1    0,,PR0
        19 001510   100003 473500                    LDP3    3,,PR1
        19 001511   300002 236100                    LDQ     2,,PR3
        19 001512   000003 116000 20                 CMPQ    3
        19 001513   001524 600000 19                 TZE     s:12542
        19 001514   300002 474500                    LDP4    2,,PR3
        19 001515   400003 475500                    LDP5    3,,PR4
        19 001516   500001 476500                    LDP6    1,,PR5
        19 001517   600010 236100                    LDQ     8,,PR6
        19 001520   200020 116100                    CMPQ    CURRENT_ENTRY$,,AUTO
        19 001521   001524 601000 19                 TNZ     s:12542

      306    12536    2          SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL -> ILS.ILL$ -> ILL.LOP ->
      307    12537    2          LABEL.PREV_ILS$ = CURRENT_ENTRY$ THEN
      308    12538    2          SUB_TAIL$ -> ILS.ILL$ -> DEFLB.LBL -> ILS.ILL$ -> ILL.LOP ->

  12538 19 001522   000000 236100                    LDQ     0,,PR0
        19 001523   600010 756100                    STQ     8,,PR6

      309    12539    2          LABEL.PREV_ILS$ = SUB_TAIL$;
      310    12540
      311    12541
      312    12542    2    END GEN_ALTER_RESETS;

  12542 19 001524   200034 221300                    LDX1  ! SEG_LTS$+2,,AUTO
        19 001525   000001 702211                    TSX2  ! 1,X1

      313    12543         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:76   
      314    12544
      315    12545         /*==========*/
      316    12546    1      GO_SEG_SUB: PROC (SEG_NUM);

  12546 19 001526   200034 741300       GO_SEG_SUB   STX1  ! SEG_LTS$+2,,AUTO

      317    12547         /*==========*/
      318    12548
      319    12549         /*I*
      320    12550               NAME: GO_SEG_SUB
      321    12551
      322    12552          DESCRIPTION: For a GO TO statement that transfer control into a
      323    12553                       independent segment will be modified to like....
      324    12554
      325    12555                         OLD         |              NEW
      326    12556                                     |
      327    12557                     goto old_label# |           goto new_#1
      328    12558                                     |
      329    12559                       and at the top of the program..
      330    12560                                     |   new_#1: call refresh_&_overlay
      331    12561                                     |           goto old_label#
      332    12562         */
      333    12563
      334    12564
      335    12565    2   DCL SEG_NUM            SBIN WORD;
      336    12566    2   DCL OLD_LABEL$         PTR;
      337    12567    2   DCL NEW_LABEL$         PTR;
      338    12568    2   DCL SUB$               PTR;
      339    12569    2   DCL SUB_TAIL$          PTR;
      340    12570    2   DCL CALL_LABEL$        PTR;
      341    12571    2   DCL TEMP$              PTR;
      342    12572    2   DCL LABEL_END$         PTR;
      343    12573    2   DCL PREV_ILS_NEXT$     PTR;
      344    12574
      345    12575
      346    12576    2          SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:77   
  12576 19 001527   200015 470500                    LDP0    TRA_END_LABEL$,,AUTO
        19 001530   000010 236100                    LDQ     8,,PR0
        19 001531   200041 756100                    STQ     SUB_TAIL$,,AUTO

      347    12577    2          PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;

  12577 19 001532   200041 471500                    LDP1    SUB_TAIL$,,AUTO
        19 001533   100002 236100                    LDQ     2,,PR1
        19 001534   200045 756100                    STQ     PREV_ILS_NEXT$,,AUTO

      348    12578
      349    12579    2          CALL Z8AT$CREATE_TEMPORARY (%PARA, NEW_LABEL$);

  12579 19 001535   200037 633500                    EPPR3   NEW_LABEL$,,AUTO
        19 001536   200057 453500                    STP3    POINTER$$+3,,AUTO
        19 001537   000002 236000 20                 LDQ     2
        19 001540   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001541   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 001542   000000 631400 20                 EPPR1   0
        19 001543   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        19 001544   000000 011000                    NOP     0

      350    12580
      351    12581    2          NEW_LABEL$ -> LABEL.B.REFERENCED = TRUE;

  12581 19 001545   200037 470500                    LDP0    NEW_LABEL$,,AUTO
        19 001546   400000 236003                    LDQ     -131072,DU
        19 001547   000003 256100                    ORSQ    3,,PR0

      352    12582    2          NEW_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;

  12582 19 001550   200037 470500                    LDP0    NEW_LABEL$,,AUTO
        19 001551   040000 236003                    LDQ     16384,DU
        19 001552   000003 256100                    ORSQ    3,,PR0

      353    12583    2          NEW_LABEL$ -> LABEL.B.ONE_REF = TRUE;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:78   
  12583 19 001553   200037 470500                    LDP0    NEW_LABEL$,,AUTO
        19 001554   010000 236003                    LDQ     4096,DU
        19 001555   000003 256100                    ORSQ    3,,PR0

      354    12584    2          NEW_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$;

  12584 19 001556   200014 236100                    LDQ     CURRENT_PROC$,,AUTO
        19 001557   200037 470500                    LDP0    NEW_LABEL$,,AUTO
        19 001560   000011 756100                    STQ     9,,PR0

      355    12585    2          NEW_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  12585 19 001561   200041 236100                    LDQ     SUB_TAIL$,,AUTO
        19 001562   200037 470500                    LDP0    NEW_LABEL$,,AUTO
        19 001563   000010 756100                    STQ     8,,PR0

      356    12586
      357    12587               %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  12610 19 001564   000002 236000 17                 LDQ     ILS_+2
        19 001565   000004 036007                    ADLQ    4,DL
        19 001566   000003 116000 17                 CMPQ    ILS_+3
        19 001567   001600 602000 19                 TNC     s:12612

  12611 19 001570   000005 236000 20                 LDQ     5
        19 001571   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001572   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 001573   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 001574   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001575   000004 631400 20                 EPPR1   4
        19 001576   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001577   000000 011000                    NOP     0

  12612 19 001600   000002 236000 17                 LDQ     ILS_+2
        19 001601   000022 736000                    QLS     18
        19 001602   000001 036000 17                 ADLQ    ILS_+1
        19 001603   200041 470500                    LDP0    SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:79   
        19 001604   000002 756100                    STQ     2,,PR0

  12613 19 001605   000002 235000 17                 LDA     ILS_+2
        19 001606   000004 035007                    ADLA    4,DL
        19 001607   000002 755000 17                 STA     ILS_+2

  12614 19 001610   000002 471500                    LDP1    2,,PR0
        19 001611   000740 220003                    LDX0    480,DU
        19 001612   100000 740100                    STX0    0,,PR1

  12615 19 001613   000002 471500                    LDP1    2,,PR0
        19 001614   000003 236000 20                 LDQ     3
        19 001615   100002 756100                    STQ     2,,PR1

  12622 19 001616   000145 235000 xsym               LDA     ILL_STEP+101
        19 001617   000000 755000 0                  STA     ITERATION

  12623 19 001620   000002 236000 15                 LDQ     ILL_+2
        19 001621   000000 036000 0                  ADLQ    ITERATION
        19 001622   000003 116000 15                 CMPQ    ILL_+3
        19 001623   001634 604000 19                 TMI     s:12625

  12624 19 001624   000006 236000 20                 LDQ     6
        19 001625   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001626   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001627   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001630   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001631   000004 631400 20                 EPPR1   4
        19 001632   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001633   000000 011000                    NOP     0

  12625 19 001634   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 001635   000002 471500                    LDP1    2,,PR0
        19 001636   000002 236000 15                 LDQ     ILL_+2
        19 001637   000022 736000                    QLS     18
        19 001640   000001 036000 15                 ADLQ    ILL_+1
        19 001641   100003 756100                    STQ     3,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:80   

  12626 19 001642   000002 236000 15                 LDQ     ILL_+2
        19 001643   000000 036000 0                  ADLQ    ITERATION
        19 001644   000002 756000 15                 STQ     ILL_+2

  12627 19 001645   000002 471500                    LDP1    2,,PR0
        19 001646   100003 473500                    LDP3    3,,PR1
        19 001647   000373 220003                    LDX0    251,DU
        19 001650   300000 740100                    STX0    0,,PR3

  12630 19 001651   000002 236100                    LDQ     2,,PR0
        19 001652   200041 756100                    STQ     SUB_TAIL$,,AUTO

      358    12633
      359    12634    2          SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  12634 19 001653   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 001654   000003 471500                    LDP1    3,,PR0
        19 001655   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 001656   000100 100500                    MLR     fill='000'O
        19 001657   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 001660   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      360    12635
      361    12636               %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);

  12659 19 001661   000002 236000 17                 LDQ     ILS_+2
        19 001662   000004 036007                    ADLQ    4,DL
        19 001663   000003 116000 17                 CMPQ    ILS_+3
        19 001664   001675 602000 19                 TNC     s:12661

  12660 19 001665   000005 236000 20                 LDQ     5
        19 001666   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001667   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001670   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001671   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001672   000004 631400 20                 EPPR1   4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:81   
        19 001673   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001674   000000 011000                    NOP     0

  12661 19 001675   000002 236000 17                 LDQ     ILS_+2
        19 001676   000022 736000                    QLS     18
        19 001677   000001 036000 17                 ADLQ    ILS_+1
        19 001700   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 001701   000002 756100                    STQ     2,,PR0

  12662 19 001702   000002 235000 17                 LDA     ILS_+2
        19 001703   000004 035007                    ADLA    4,DL
        19 001704   000002 755000 17                 STA     ILS_+2

  12663 19 001705   000002 471500                    LDP1    2,,PR0
        19 001706   000740 220003                    LDX0    480,DU
        19 001707   100000 740100                    STX0    0,,PR1

  12664 19 001710   000002 471500                    LDP1    2,,PR0
        19 001711   000003 236000 20                 LDQ     3
        19 001712   100002 756100                    STQ     2,,PR1

  12671 19 001713   000120 235000 xsym               LDA     ILL_STEP+80
        19 001714   000000 755000 0                  STA     ITERATION

  12672 19 001715   000002 236000 15                 LDQ     ILL_+2
        19 001716   000000 036000 0                  ADLQ    ITERATION
        19 001717   000003 116000 15                 CMPQ    ILL_+3
        19 001720   001731 604000 19                 TMI     s:12674

  12673 19 001721   000006 236000 20                 LDQ     6
        19 001722   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 001723   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 001724   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 001725   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 001726   000004 631400 20                 EPPR1   4
        19 001727   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 001730   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:82   

  12674 19 001731   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 001732   000002 471500                    LDP1    2,,PR0
        19 001733   000002 236000 15                 LDQ     ILL_+2
        19 001734   000022 736000                    QLS     18
        19 001735   000001 036000 15                 ADLQ    ILL_+1
        19 001736   100003 756100                    STQ     3,,PR1

  12675 19 001737   000002 236000 15                 LDQ     ILL_+2
        19 001740   000000 036000 0                  ADLQ    ITERATION
        19 001741   000002 756000 15                 STQ     ILL_+2

  12676 19 001742   000002 471500                    LDP1    2,,PR0
        19 001743   100003 473500                    LDP3    3,,PR1
        19 001744   000346 220003                    LDX0    230,DU
        19 001745   300000 740100                    STX0    0,,PR3

  12679 19 001746   000002 236100                    LDQ     2,,PR0
        19 001747   200041 756100                    STQ     SUB_TAIL$,,AUTO

      362    12682
      363    12683    2          SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = NEW_LABEL$;

  12683 19 001750   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 001751   000003 471500                    LDP1    3,,PR0
        19 001752   200037 236100                    LDQ     NEW_LABEL$,,AUTO
        19 001753   100001 756100                    STQ     1,,PR1

      364    12684
      365    12685    2          TEMP$ = ENTRY_LABEL$;

  12685 19 001754   200031 236100                    LDQ     ENTRY_LABEL$,,AUTO
        19 001755   200043 756100                    STQ     TEMP$,,AUTO

      366    12686
      367    12687               %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$,
      368    12688                            @UPDATE$  = TEMP$);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:83   

  12690 19 001756   000003 116000 20                 CMPQ    3
        19 001757   001766 601000 19                 TNZ     s:12697

  12692 19 001760   000003 471500                    LDP1    3,,PR0
        19 001761   000321 236000 xsym               LDQ     COMCOM+209
        19 001762   100002 756100                    STQ     2,,PR1

  12693 19 001763   200041 236100                    LDQ     SUB_TAIL$,,AUTO
        19 001764   000321 756000 xsym               STQ     COMCOM+209

  12694 19 001765   001776 710000 19                 TRA     s:12700

  12697 19 001766   000003 471500                    LDP1    3,,PR0
        19 001767   200043 473500                    LDP3    TEMP$,,AUTO
        19 001770   300003 474500                    LDP4    3,,PR3
        19 001771   400002 236100                    LDQ     2,,PR4
        19 001772   100002 756100                    STQ     2,,PR1

  12698 19 001773   300003 471500                    LDP1    3,,PR3
        19 001774   200041 236100                    LDQ     SUB_TAIL$,,AUTO
        19 001775   100002 756100                    STQ     2,,PR1

  12700 19 001776   200043 756100                    STQ     TEMP$,,AUTO

      369    12703
      370    12704    2          IF SEG_NUM > %MAX_FIXED_SEG# THEN

  12704 19 001777   200035 471500                    LDP1    @SEG_NUM,,AUTO
        19 002000   100000 235100                    LDA     0,,PR1
        19 002001   000061 115007                    CMPA    49,DL
        19 002002   002207 604400 19                 TMOZ    s:12839

      371    12705    3            DO;

      372    12706    3              CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NUM) ->

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:84   
  12706 19 002003   200026 473500                    LDP3    CURRENT_ARRAY$,,AUTO
        19 002004   300002 474505                    LDP4    2,AL,PR3
        19 002005   400007 236100                    LDQ     7,,PR4
        19 002006   200042 756100                    STQ     CALL_LABEL$,,AUTO

      373    12707    3                            SEGMENT_LTS.SUB_LABEL$;
      374    12708
      375    12709    3              IF CALL_LABEL$ ~= ADDR(NIL) THEN

  12709 19 002007   000003 116000 20                 CMPQ    3
        19 002010   002207 600000 19                 TZE     s:12839

      376    12710    4                DO;

      377    12711                       %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  12734 19 002011   000002 236000 17                 LDQ     ILS_+2
        19 002012   000004 036007                    ADLQ    4,DL
        19 002013   000003 116000 17                 CMPQ    ILS_+3
        19 002014   002025 602000 19                 TNC     s:12736

  12735 19 002015   000005 236000 20                 LDQ     5
        19 002016   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002017   200056 634500                    EPPR4   POINTER$$+2,,AUTO
        19 002020   200057 454500                    STP4    POINTER$$+3,,AUTO
        19 002021   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002022   000004 631400 20                 EPPR1   4
        19 002023   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002024   000000 011000                    NOP     0

  12736 19 002025   000002 236000 17                 LDQ     ILS_+2
        19 002026   000022 736000                    QLS     18
        19 002027   000001 036000 17                 ADLQ    ILS_+1
        19 002030   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002031   000002 756100                    STQ     2,,PR0

  12737 19 002032   000002 235000 17                 LDA     ILS_+2
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:85   
        19 002033   000004 035007                    ADLA    4,DL
        19 002034   000002 755000 17                 STA     ILS_+2

  12738 19 002035   000002 471500                    LDP1    2,,PR0
        19 002036   000740 220003                    LDX0    480,DU
        19 002037   100000 740100                    STX0    0,,PR1

  12739 19 002040   000002 471500                    LDP1    2,,PR0
        19 002041   000003 236000 20                 LDQ     3
        19 002042   100002 756100                    STQ     2,,PR1

  12746 19 002043   000145 235000 xsym               LDA     ILL_STEP+101
        19 002044   000000 755000 0                  STA     ITERATION

  12747 19 002045   000002 236000 15                 LDQ     ILL_+2
        19 002046   000000 036000 0                  ADLQ    ITERATION
        19 002047   000003 116000 15                 CMPQ    ILL_+3
        19 002050   002061 604000 19                 TMI     s:12749

  12748 19 002051   000006 236000 20                 LDQ     6
        19 002052   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002053   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002054   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002055   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002056   000004 631400 20                 EPPR1   4
        19 002057   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002060   000000 011000                    NOP     0

  12749 19 002061   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002062   000002 471500                    LDP1    2,,PR0
        19 002063   000002 236000 15                 LDQ     ILL_+2
        19 002064   000022 736000                    QLS     18
        19 002065   000001 036000 15                 ADLQ    ILL_+1
        19 002066   100003 756100                    STQ     3,,PR1

  12750 19 002067   000002 236000 15                 LDQ     ILL_+2
        19 002070   000000 036000 0                  ADLQ    ITERATION
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:86   
        19 002071   000002 756000 15                 STQ     ILL_+2

  12751 19 002072   000002 471500                    LDP1    2,,PR0
        19 002073   100003 473500                    LDP3    3,,PR1
        19 002074   000373 220003                    LDX0    251,DU
        19 002075   300000 740100                    STX0    0,,PR3

  12754 19 002076   000002 236100                    LDQ     2,,PR0
        19 002077   200041 756100                    STQ     SUB_TAIL$,,AUTO

      378    12757
      379    12758    4                  SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  12758 19 002100   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002101   000003 471500                    LDP1    3,,PR0
        19 002102   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 002103   000100 100500                    MLR     fill='000'O
        19 002104   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 002105   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      380    12759
      381    12760                       %RSV_ILS_ILL (@ILL_ITEM = %GO);

  12783 19 002106   000002 236000 17                 LDQ     ILS_+2
        19 002107   000004 036007                    ADLQ    4,DL
        19 002110   000003 116000 17                 CMPQ    ILS_+3
        19 002111   002122 602000 19                 TNC     s:12785

  12784 19 002112   000005 236000 20                 LDQ     5
        19 002113   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002114   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002115   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002116   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002117   000004 631400 20                 EPPR1   4
        19 002120   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002121   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:87   
  12785 19 002122   000002 236000 17                 LDQ     ILS_+2
        19 002123   000022 736000                    QLS     18
        19 002124   000001 036000 17                 ADLQ    ILS_+1
        19 002125   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002126   000002 756100                    STQ     2,,PR0

  12786 19 002127   000002 235000 17                 LDA     ILS_+2
        19 002130   000004 035007                    ADLA    4,DL
        19 002131   000002 755000 17                 STA     ILS_+2

  12787 19 002132   000002 471500                    LDP1    2,,PR0
        19 002133   000740 220003                    LDX0    480,DU
        19 002134   100000 740100                    STX0    0,,PR1

  12788 19 002135   000002 471500                    LDP1    2,,PR0
        19 002136   000003 236000 20                 LDQ     3
        19 002137   100002 756100                    STQ     2,,PR1

  12795 19 002140   000116 235000 xsym               LDA     ILL_STEP+78
        19 002141   000000 755000 0                  STA     ITERATION

  12796 19 002142   000002 236000 15                 LDQ     ILL_+2
        19 002143   000000 036000 0                  ADLQ    ITERATION
        19 002144   000003 116000 15                 CMPQ    ILL_+3
        19 002145   002156 604000 19                 TMI     s:12798

  12797 19 002146   000006 236000 20                 LDQ     6
        19 002147   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002150   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002151   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002152   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002153   000004 631400 20                 EPPR1   4
        19 002154   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002155   000000 011000                    NOP     0

  12798 19 002156   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002157   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:88   
        19 002160   000002 236000 15                 LDQ     ILL_+2
        19 002161   000022 736000                    QLS     18
        19 002162   000001 036000 15                 ADLQ    ILL_+1
        19 002163   100003 756100                    STQ     3,,PR1

  12799 19 002164   000002 236000 15                 LDQ     ILL_+2
        19 002165   000000 036000 0                  ADLQ    ITERATION
        19 002166   000002 756000 15                 STQ     ILL_+2

  12800 19 002167   000002 471500                    LDP1    2,,PR0
        19 002170   100003 473500                    LDP3    3,,PR1
        19 002171   000344 220003                    LDX0    228,DU
        19 002172   300000 740100                    STX0    0,,PR3

  12803 19 002173   000002 236100                    LDQ     2,,PR0
        19 002174   200041 756100                    STQ     SUB_TAIL$,,AUTO

      382    12806
      383    12807    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;

  12807 19 002175   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002176   000003 471500                    LDP1    3,,PR0
        19 002177   000030 221003                    LDX1    24,DU
        19 002200   100000 441100                    SXL1    0,,PR1

      384    12808    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;

  12808 19 002201   000003 471500                    LDP1    3,,PR0
        19 002202   200042 236100                    LDQ     CALL_LABEL$,,AUTO
        19 002203   100001 756100                    STQ     1,,PR1

      385    12809    4                  SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ADDR(NIL);

  12809 19 002204   000003 471500                    LDP1    3,,PR0
        19 002205   000003 236000 20                 LDQ     3
        19 002206   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:89   
      386    12810    4                END;

      387    12811    3            END;

      388    12812
      389    12813               %OVERLAY_REGULAR_GO;

  12839 19 002207   000002 236000 17                 LDQ     ILS_+2
        19 002210   000004 036007                    ADLQ    4,DL
        19 002211   000003 116000 17                 CMPQ    ILS_+3
        19 002212   002223 602000 19                 TNC     s:12841

  12840 19 002213   000005 236000 20                 LDQ     5
        19 002214   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002215   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002216   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002217   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002220   000004 631400 20                 EPPR1   4
        19 002221   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002222   000000 011000                    NOP     0

  12841 19 002223   000002 236000 17                 LDQ     ILS_+2
        19 002224   000022 736000                    QLS     18
        19 002225   000001 036000 17                 ADLQ    ILS_+1
        19 002226   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002227   000002 756100                    STQ     2,,PR0

  12842 19 002230   000002 235000 17                 LDA     ILS_+2
        19 002231   000004 035007                    ADLA    4,DL
        19 002232   000002 755000 17                 STA     ILS_+2

  12843 19 002233   000002 471500                    LDP1    2,,PR0
        19 002234   000740 220003                    LDX0    480,DU
        19 002235   100000 740100                    STX0    0,,PR1

  12844 19 002236   000002 471500                    LDP1    2,,PR0
        19 002237   000003 236000 20                 LDQ     3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:90   
        19 002240   100002 756100                    STQ     2,,PR1

  12851 19 002241   000145 235000 xsym               LDA     ILL_STEP+101
        19 002242   000000 755000 0                  STA     ITERATION

  12852 19 002243   000002 236000 15                 LDQ     ILL_+2
        19 002244   000000 036000 0                  ADLQ    ITERATION
        19 002245   000003 116000 15                 CMPQ    ILL_+3
        19 002246   002257 604000 19                 TMI     s:12854

  12853 19 002247   000006 236000 20                 LDQ     6
        19 002250   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002251   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002252   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002253   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002254   000004 631400 20                 EPPR1   4
        19 002255   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002256   000000 011000                    NOP     0

  12854 19 002257   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002260   000002 471500                    LDP1    2,,PR0
        19 002261   000002 236000 15                 LDQ     ILL_+2
        19 002262   000022 736000                    QLS     18
        19 002263   000001 036000 15                 ADLQ    ILL_+1
        19 002264   100003 756100                    STQ     3,,PR1

  12855 19 002265   000002 236000 15                 LDQ     ILL_+2
        19 002266   000000 036000 0                  ADLQ    ITERATION
        19 002267   000002 756000 15                 STQ     ILL_+2

  12856 19 002270   000002 471500                    LDP1    2,,PR0
        19 002271   100003 473500                    LDP3    3,,PR1
        19 002272   000373 220003                    LDX0    251,DU
        19 002273   300000 740100                    STX0    0,,PR3

  12859 19 002274   000002 236100                    LDQ     2,,PR0
        19 002275   200041 756100                    STQ     SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:91   

  12862 19 002276   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002277   000003 471500                    LDP1    3,,PR0
        19 002300   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 002301   000100 100500                    MLR     fill='000'O
        19 002302   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 002303   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

  12886 19 002304   000002 236000 17                 LDQ     ILS_+2
        19 002305   000004 036007                    ADLQ    4,DL
        19 002306   000003 116000 17                 CMPQ    ILS_+3
        19 002307   002320 602000 19                 TNC     s:12888

  12887 19 002310   000005 236000 20                 LDQ     5
        19 002311   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002312   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002313   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002314   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002315   000004 631400 20                 EPPR1   4
        19 002316   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002317   000000 011000                    NOP     0

  12888 19 002320   000002 236000 17                 LDQ     ILS_+2
        19 002321   000022 736000                    QLS     18
        19 002322   000001 036000 17                 ADLQ    ILS_+1
        19 002323   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002324   000002 756100                    STQ     2,,PR0

  12889 19 002325   000002 235000 17                 LDA     ILS_+2
        19 002326   000004 035007                    ADLA    4,DL
        19 002327   000002 755000 17                 STA     ILS_+2

  12890 19 002330   000002 471500                    LDP1    2,,PR0
        19 002331   000740 220003                    LDX0    480,DU
        19 002332   100000 740100                    STX0    0,,PR1

  12891 19 002333   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:92   
        19 002334   000003 236000 20                 LDQ     3
        19 002335   100002 756100                    STQ     2,,PR1

  12898 19 002336   000116 235000 xsym               LDA     ILL_STEP+78
        19 002337   000000 755000 0                  STA     ITERATION

  12899 19 002340   000002 236000 15                 LDQ     ILL_+2
        19 002341   000000 036000 0                  ADLQ    ITERATION
        19 002342   000003 116000 15                 CMPQ    ILL_+3
        19 002343   002354 604000 19                 TMI     s:12901

  12900 19 002344   000006 236000 20                 LDQ     6
        19 002345   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002346   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002347   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002350   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002351   000004 631400 20                 EPPR1   4
        19 002352   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002353   000000 011000                    NOP     0

  12901 19 002354   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002355   000002 471500                    LDP1    2,,PR0
        19 002356   000002 236000 15                 LDQ     ILL_+2
        19 002357   000022 736000                    QLS     18
        19 002360   000001 036000 15                 ADLQ    ILL_+1
        19 002361   100003 756100                    STQ     3,,PR1

  12902 19 002362   000002 236000 15                 LDQ     ILL_+2
        19 002363   000000 036000 0                  ADLQ    ITERATION
        19 002364   000002 756000 15                 STQ     ILL_+2

  12903 19 002365   000002 471500                    LDP1    2,,PR0
        19 002366   100003 473500                    LDP3    3,,PR1
        19 002367   000344 220003                    LDX0    228,DU
        19 002370   300000 740100                    STX0    0,,PR3

  12906 19 002371   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:93   
        19 002372   200041 756100                    STQ     SUB_TAIL$,,AUTO

  12909 19 002373   200041 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002374   000003 471500                    LDP1    3,,PR0
        19 002375   000000 221003                    LDX1    0,DU
        19 002376   100000 441100                    SXL1    0,,PR1

  12910 19 002377   000003 471500                    LDP1    3,,PR0
        19 002400   000000 473400 14                 LDP3    ILL$
        19 002401   300001 236100                    LDQ     1,,PR3
        19 002402   100001 756100                    STQ     1,,PR1

  12911 19 002403   000003 471500                    LDP1    3,,PR0
        19 002404   000003 236000 20                 LDQ     3
        19 002405   100002 756100                    STQ     2,,PR1

      390    12914
      391    12915               %GO_TO_NEW_LABEL (@GO_LABEL$ = NEW_LABEL$,
      392    12916                                 @GO_ILL$   = ILL$);

  12918 19 002406   200037 236100                    LDQ     NEW_LABEL$,,AUTO
        19 002407   300001 756100                    STQ     1,,PR3

      393    12921
      394    12922    2          TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  12922 19 002410   200041 236100                    LDQ     SUB_TAIL$,,AUTO
        19 002411   200015 471500                    LDP1    TRA_END_LABEL$,,AUTO
        19 002412   100010 756100                    STQ     8,,PR1

      395    12923
      396    12924    2          SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;

  12924 19 002413   200045 236100                    LDQ     PREV_ILS_NEXT$,,AUTO
        19 002414   000002 756100                    STQ     2,,PR0

      397    12925
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:94   
      398    12926    2    END GO_SEG_SUB;

  12926 19 002415   200034 221300                    LDX1  ! SEG_LTS$+2,,AUTO
        19 002416   000001 702211                    TSX2  ! 1,X1

      399    12927         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:95   
      400    12928
      401    12929         /*=============*/
      402    12930    1      OVERLAY_RESET:  PROC;

  12930 19 002417   200034 741300       OVERLAY_RES* STX1  ! SEG_LTS$+2,,AUTO
        19 002420   003627 710000 19                 TRA     s:13510

      403    12931         /*=============*/
      404    12932
      405    12933         /*I*
      406    12934               NAME: OVERLAY_RESET
      407    12935
      408    12936          DESCRIPTION: For an altered GO TO statement the program flow
      409    12937                       might be transfered to several different addresses
      410    12938                       and the address can be learned on run time only,
      411    12939                       if one of these addresses is in an independent
      412    12940                       segment then a special treatment is needed, and
      413    12941                       GEN_RESET_CODE is called to generate the codes
      414    12942                       to reset the alter switches, and the old GO TO
      415    12943                       will be directed to new lebel.
      416    12944         */
      417    12945
      418    12946
      419    12947    2   DCL SUB$           PTR;
      420    12948    2   DCL SUB_TAIL$      PTR;
      421    12949    2   DCL TEMP_LABEL$    PTR;
      422    12950    2   DCL LABEL_END$     PTR;
      423    12951    2   DCL LTS$$          PTR;
      424    12952    2   DCL LABEL_USE$     PTR;
      425    12953    2   DCL GENERATE_CODE  BOOLEAN;
      426    12954    2   DCL ALTER_LTS$     PTR;
      427    12955    2   DCL HEAD_LTS$      PTR;
      428    12956    2   DCL PREV_ILS_NEXT$  PTR;
      429    12957
      430    12958
      431    12959
      432    12960          /*
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:96   
      433    12961               This routine will create the subroutine call for the altered
      434    12962               GO TO statement. The altered GO TO statement needs special
      435    12963               treatment because the actual address that the control will be
      436    12964               transfered to can be known on run time only.
      437    12965          */
      438    12966
      439    12967         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:97   
      440    12968
      441    12969         /*--------------*/
      442    12970    2      GEN_RESET_CODE: PROC;

  12970 19 002421   200050 741300       GEN_RESET_C* STX1  ! PREV_ILS_NEXT$+2,,AUTO

      443    12971         /*--------------*/
      444    12972
      445    12973         /*I*
      446    12974               NAME: GEN_RESET_CODE
      447    12975
      448    12976          DESCRIPTION: This routine will generate the codes that compare
      449    12977                       the pointer item with the addresses of label items
      450    12978                       and invoke the subroutines that will refresh the
      451    12979                       alter switches.
      452    12980         */
      453    12981
      454    12982    3   DCL GO_LABEL$          PTR;
      455    12983    3   DCL ETT$$              PTR;
      456    12984    3   DCL CALL_LABEL$        PTR;
      457    12985    3   DCL POINTER$$          PTR;
      458    12986
      459    12987
      460    12988    3          CALL Z8AT$CREATE_TEMPORARY (%PARA, GO_LABEL$);

  12988 19 002422   200051 630500                    EPPR0   GO_LABEL$,,AUTO
        19 002423   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 002424   000002 236000 20                 LDQ     2
        19 002425   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002426   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 002427   000000 631400 20                 EPPR1   0
        19 002430   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        19 002431   000000 011000                    NOP     0

      461    12989
      462    12990    3          GO_LABEL$ -> LABEL.B.REFERENCED = TRUE;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:98   
  12990 19 002432   200051 470500                    LDP0    GO_LABEL$,,AUTO
        19 002433   400000 236003                    LDQ     -131072,DU
        19 002434   000003 256100                    ORSQ    3,,PR0

      463    12991    3          GO_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;

  12991 19 002435   200051 470500                    LDP0    GO_LABEL$,,AUTO
        19 002436   040000 236003                    LDQ     16384,DU
        19 002437   000003 256100                    ORSQ    3,,PR0

      464    12992    3          GO_LABEL$ -> LABEL.B.ONE_REF = TRUE;

  12992 19 002440   200051 470500                    LDP0    GO_LABEL$,,AUTO
        19 002441   010000 236003                    LDQ     4096,DU
        19 002442   000003 256100                    ORSQ    3,,PR0

      465    12993    3          GO_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$;

  12993 19 002443   200014 236100                    LDQ     CURRENT_PROC$,,AUTO
        19 002444   200051 470500                    LDP0    GO_LABEL$,,AUTO
        19 002445   000011 756100                    STQ     9,,PR0

      466    12994
      467    12995               %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  13018 19 002446   000002 236000 17                 LDQ     ILS_+2
        19 002447   000004 036007                    ADLQ    4,DL
        19 002450   000003 116000 17                 CMPQ    ILS_+3
        19 002451   002462 602000 19                 TNC     s:13020

  13019 19 002452   000005 236000 20                 LDQ     5
        19 002453   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002454   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 002455   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 002456   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002457   000004 631400 20                 EPPR1   4
        19 002460   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:99   
        19 002461   000000 011000                    NOP     0

  13020 19 002462   000002 236000 17                 LDQ     ILS_+2
        19 002463   000022 736000                    QLS     18
        19 002464   000001 036000 17                 ADLQ    ILS_+1
        19 002465   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002466   000002 756100                    STQ     2,,PR0

  13021 19 002467   000002 235000 17                 LDA     ILS_+2
        19 002470   000004 035007                    ADLA    4,DL
        19 002471   000002 755000 17                 STA     ILS_+2

  13022 19 002472   000002 471500                    LDP1    2,,PR0
        19 002473   000740 220003                    LDX0    480,DU
        19 002474   100000 740100                    STX0    0,,PR1

  13023 19 002475   000002 471500                    LDP1    2,,PR0
        19 002476   000003 236000 20                 LDQ     3
        19 002477   100002 756100                    STQ     2,,PR1

  13030 19 002500   000145 235000 xsym               LDA     ILL_STEP+101
        19 002501   000000 755000 0                  STA     ITERATION

  13031 19 002502   000002 236000 15                 LDQ     ILL_+2
        19 002503   000000 036000 0                  ADLQ    ITERATION
        19 002504   000003 116000 15                 CMPQ    ILL_+3
        19 002505   002516 604000 19                 TMI     s:13033

  13032 19 002506   000006 236000 20                 LDQ     6
        19 002507   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002510   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002511   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002512   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002513   000004 631400 20                 EPPR1   4
        19 002514   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002515   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:100  
  13033 19 002516   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002517   000002 471500                    LDP1    2,,PR0
        19 002520   000002 236000 15                 LDQ     ILL_+2
        19 002521   000022 736000                    QLS     18
        19 002522   000001 036000 15                 ADLQ    ILL_+1
        19 002523   100003 756100                    STQ     3,,PR1

  13034 19 002524   000002 236000 15                 LDQ     ILL_+2
        19 002525   000000 036000 0                  ADLQ    ITERATION
        19 002526   000002 756000 15                 STQ     ILL_+2

  13035 19 002527   000002 471500                    LDP1    2,,PR0
        19 002530   100003 473500                    LDP3    3,,PR1
        19 002531   000373 220003                    LDX0    251,DU
        19 002532   300000 740100                    STX0    0,,PR3

  13038 19 002533   000002 236100                    LDQ     2,,PR0
        19 002534   200036 756100                    STQ     SUB_TAIL$,,AUTO

      468    13041
      469    13042    3          SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  13042 19 002535   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002536   000003 471500                    LDP1    3,,PR0
        19 002537   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 002540   000100 100500                    MLR     fill='000'O
        19 002541   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 002542   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      470    13043
      471    13044               %RSV_ILS_ILL (@ILL_ITEM = %GO);

  13067 19 002543   000002 236000 17                 LDQ     ILS_+2
        19 002544   000004 036007                    ADLQ    4,DL
        19 002545   000003 116000 17                 CMPQ    ILS_+3
        19 002546   002557 602000 19                 TNC     s:13069

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:101  
  13068 19 002547   000005 236000 20                 LDQ     5
        19 002550   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002551   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002552   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002553   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002554   000004 631400 20                 EPPR1   4
        19 002555   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002556   000000 011000                    NOP     0

  13069 19 002557   000002 236000 17                 LDQ     ILS_+2
        19 002560   000022 736000                    QLS     18
        19 002561   000001 036000 17                 ADLQ    ILS_+1
        19 002562   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002563   000002 756100                    STQ     2,,PR0

  13070 19 002564   000002 235000 17                 LDA     ILS_+2
        19 002565   000004 035007                    ADLA    4,DL
        19 002566   000002 755000 17                 STA     ILS_+2

  13071 19 002567   000002 471500                    LDP1    2,,PR0
        19 002570   000740 220003                    LDX0    480,DU
        19 002571   100000 740100                    STX0    0,,PR1

  13072 19 002572   000002 471500                    LDP1    2,,PR0
        19 002573   000003 236000 20                 LDQ     3
        19 002574   100002 756100                    STQ     2,,PR1

  13079 19 002575   000116 235000 xsym               LDA     ILL_STEP+78
        19 002576   000000 755000 0                  STA     ITERATION

  13080 19 002577   000002 236000 15                 LDQ     ILL_+2
        19 002600   000000 036000 0                  ADLQ    ITERATION
        19 002601   000003 116000 15                 CMPQ    ILL_+3
        19 002602   002613 604000 19                 TMI     s:13082

  13081 19 002603   000006 236000 20                 LDQ     6
        19 002604   200056 756100                    STQ     POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:102  
        19 002605   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002606   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002607   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002610   000004 631400 20                 EPPR1   4
        19 002611   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002612   000000 011000                    NOP     0

  13082 19 002613   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002614   000002 471500                    LDP1    2,,PR0
        19 002615   000002 236000 15                 LDQ     ILL_+2
        19 002616   000022 736000                    QLS     18
        19 002617   000001 036000 15                 ADLQ    ILL_+1
        19 002620   100003 756100                    STQ     3,,PR1

  13083 19 002621   000002 236000 15                 LDQ     ILL_+2
        19 002622   000000 036000 0                  ADLQ    ITERATION
        19 002623   000002 756000 15                 STQ     ILL_+2

  13084 19 002624   000002 471500                    LDP1    2,,PR0
        19 002625   100003 473500                    LDP3    3,,PR1
        19 002626   000344 220003                    LDX0    228,DU
        19 002627   300000 740100                    STX0    0,,PR3

  13087 19 002630   000002 236100                    LDQ     2,,PR0
        19 002631   200036 756100                    STQ     SUB_TAIL$,,AUTO

      472    13090
      473    13091    3          SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_NOT_EQUAL;

  13091 19 002632   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 002633   000003 471500                    LDP1    3,,PR0
        19 002634   000012 221003                    LDX1    10,DU
        19 002635   100000 441100                    SXL1    0,,PR1

      474    13092    3          SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = GO_LABEL$;

  13092 19 002636   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:103  
        19 002637   200051 236100                    LDQ     GO_LABEL$,,AUTO
        19 002640   100001 756100                    STQ     1,,PR1

      475    13093
      476    13094               %RESERVE_ETT (POINTER = ETT$);

  13096 19 002641   000000 236000 6                  LDQ     HEAD_ETT$
        19 002642   000003 116000 20                 CMPQ    3
        19 002643   002667 601000 19                 TNZ     s:13108

  13098 19 002644   000002 236000 8                  LDQ     ETT_+2
        19 002645   000005 036007                    ADLQ    5,DL
        19 002646   000003 116000 8                  CMPQ    ETT_+3
        19 002647   002660 604000 19                 TMI     s:13100

  13099 19 002650   000007 236000 20                 LDQ     7
        19 002651   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002652   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 002653   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 002654   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002655   000004 631400 20                 EPPR1   4
        19 002656   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002657   000000 011000                    NOP     0

  13100 19 002660   000002 236000 8                  LDQ     ETT_+2
        19 002661   000022 736000                    QLS     18
        19 002662   000001 036000 8                  ADLQ    ETT_+1
        19 002663   000000 756000 5                  STQ     ETT$

  13101 19 002664   000005 236007                    LDQ     5,DL
        19 002665   000002 056000 8                  ASQ     ETT_+2

  13102 19 002666   002673 710000 19                 TRA     s:13118

  13108 19 002667   000000 756000 5                  STQ     ETT$

  13109 19 002670   000000 471400 6                  LDP1    HEAD_ETT$
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:104  
        19 002671   100003 236100                    LDQ     3,,PR1
        19 002672   000000 756000 6                  STQ     HEAD_ETT$

  13118 19 002673   000015 220003                    LDX0    13,DU
        19 002674   000000 470400 5                  LDP0    ETT$
        19 002675   000000 740100                    STX0    0,,PR0

      477    13121
      478    13122          /*   Check the content of the pointer item to see if this subroutine
      479    13123               is to be called or not */
      480    13124
      481    13125    3          ETT$ -> ETT.ID = %CMGP;

  13125 19 002676   000113 221003                    LDX1    75,DU
        19 002677   000000 470400 5                  LDP0    ETT$
        19 002700   000000 741100                    STX1    0,,PR0

      482    13126    3          ETT$ -> ETT.REF$ = ADDR(NIL);

  13126 19 002701   000003 236000 20                 LDQ     3
        19 002702   000000 470400 5                  LDP0    ETT$
        19 002703   000003 756100                    STQ     3,,PR0

      483    13127
      484    13128    3          CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,

  13128 19 002704   000000 471400 14                 LDP1    ILL$
        19 002705   100001 473500                    LDP3    1,,PR1
        19 002706   000003 236000 20                 LDQ     3
        19 002707   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002710   200054 634500                    EPPR4   POINTER$$,,AUTO
        19 002711   200061 454500                    STP4    POINTER$$+5,,AUTO
        19 002712   200056 635500                    EPPR5   POINTER$$+2,,AUTO
        19 002713   200060 455500                    STP5    POINTER$$+4,,AUTO
        19 002714   300005 636500                    EPPR6   5,,PR3
        19 002715   200057 456500                    STP6    POINTER$$+3,,AUTO
        19 002716   200057 630500                    EPPR0   POINTER$$+3,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:105  
        19 002717   000010 631400 20                 EPPR1   8
        19 002720   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        19 002721   000000 011000                    NOP     0

      485    13129    3                              ADDR(NIL),
      486    13130    3                              POINTER$$);
      487    13131    3          ETT$ -> ETT.ROP = POINTER$$;

  13131 19 002722   200054 236100                    LDQ     POINTER$$,,AUTO
        19 002723   000000 470400 5                  LDP0    ETT$
        19 002724   000002 756100                    STQ     2,,PR0

      488    13132
      489    13133           /*
      490    13134               CALL Z8AF$NEW_BASE (ALTER_LTS$ -> ALTER_LTS.LABEL$,
      491    13135                                   ADDR(NIL),
      492    13136                                   ETT$ -> ETT.LOP);
      493    13137           */
      494    13138    3          ETT$ -> ETT.LOP = ALTER_LTS$ -> ALTER_LTS.LABEL$;

  13138 19 002725   200044 471500                    LDP1    ALTER_LTS$,,AUTO
        19 002726   100001 236100                    LDQ     1,,PR1
        19 002727   000001 756100                    STQ     1,,PR0

      495    13139
      496    13140    3          SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ETT$;

  13140 19 002730   200036 473500                    LDP3    SUB_TAIL$,,AUTO
        19 002731   300003 474500                    LDP4    3,,PR3
        19 002732   000000 236000 5                  LDQ     ETT$
        19 002733   400002 756100                    STQ     2,,PR4

      497    13141
      498    13142               %RESERVE_ETT (POINTER = ETT$);

  13144 19 002734   000000 236000 6                  LDQ     HEAD_ETT$
        19 002735   000003 116000 20                 CMPQ    3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:106  
        19 002736   002762 601000 19                 TNZ     s:13156

  13146 19 002737   000002 236000 8                  LDQ     ETT_+2
        19 002740   000005 036007                    ADLQ    5,DL
        19 002741   000003 116000 8                  CMPQ    ETT_+3
        19 002742   002753 604000 19                 TMI     s:13148

  13147 19 002743   000007 236000 20                 LDQ     7
        19 002744   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 002745   200056 634500                    EPPR4   POINTER$$+2,,AUTO
        19 002746   200057 454500                    STP4    POINTER$$+3,,AUTO
        19 002747   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 002750   000004 631400 20                 EPPR1   4
        19 002751   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 002752   000000 011000                    NOP     0

  13148 19 002753   000002 236000 8                  LDQ     ETT_+2
        19 002754   000022 736000                    QLS     18
        19 002755   000001 036000 8                  ADLQ    ETT_+1
        19 002756   000000 756000 5                  STQ     ETT$

  13149 19 002757   000005 236007                    LDQ     5,DL
        19 002760   000002 056000 8                  ASQ     ETT_+2

  13150 19 002761   002766 710000 19                 TRA     s:13166

  13156 19 002762   000000 756000 5                  STQ     ETT$

  13157 19 002763   000000 470400 6                  LDP0    HEAD_ETT$
        19 002764   000003 236100                    LDQ     3,,PR0
        19 002765   000000 756000 6                  STQ     HEAD_ETT$

  13166 19 002766   000015 220003                    LDX0    13,DU
        19 002767   000000 470400 5                  LDP0    ETT$
        19 002770   000000 740100                    STX0    0,,PR0

      499    13169
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:107  
      500    13170    3          ETT$ -> ETT.ID = %CMPAO;

  13170 19 002771   000121 221003                    LDX1    81,DU
        19 002772   000000 470400 5                  LDP0    ETT$
        19 002773   000000 741100                    STX1    0,,PR0

      501    13171    3          ETT$ -> ETT.EVALP$ = ADDR(NIL);

  13171 19 002774   000003 236000 20                 LDQ     3
        19 002775   000000 470400 5                  LDP0    ETT$
        19 002776   000003 756100                    STQ     3,,PR0

      502    13172
      503    13173               %RESERVE_ETT (POINTER = ETT$ -> ETT.ROP);

  13175 19 002777   000000 236000 6                  LDQ     HEAD_ETT$
        19 003000   000003 116000 20                 CMPQ    3
        19 003001   003026 601000 19                 TNZ     s:13187

  13177 19 003002   000002 236000 8                  LDQ     ETT_+2
        19 003003   000005 036007                    ADLQ    5,DL
        19 003004   000003 116000 8                  CMPQ    ETT_+3
        19 003005   003016 604000 19                 TMI     s:13179

  13178 19 003006   000007 236000 20                 LDQ     7
        19 003007   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003010   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003011   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003012   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003013   000004 631400 20                 EPPR1   4
        19 003014   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003015   000000 011000                    NOP     0

  13179 19 003016   000002 236000 8                  LDQ     ETT_+2
        19 003017   000022 736000                    QLS     18
        19 003020   000001 036000 8                  ADLQ    ETT_+1
        19 003021   000000 470400 5                  LDP0    ETT$
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:108  
        19 003022   000002 756100                    STQ     2,,PR0

  13180 19 003023   000005 236007                    LDQ     5,DL
        19 003024   000002 056000 8                  ASQ     ETT_+2

  13181 19 003025   003032 710000 19                 TRA     s:13197

  13187 19 003026   000002 756100                    STQ     2,,PR0

  13188 19 003027   000000 471400 6                  LDP1    HEAD_ETT$
        19 003030   100003 236100                    LDQ     3,,PR1
        19 003031   000000 756000 6                  STQ     HEAD_ETT$

  13197 19 003032   000002 471500                    LDP1    2,,PR0
        19 003033   000015 220003                    LDX0    13,DU
        19 003034   100000 740100                    STX0    0,,PR1

      504    13200
      505    13201    3          ETT$ -> ETT.ROP -> ETT.ID = %CMPAS;

  13201 19 003035   000000 470400 5                  LDP0    ETT$
        19 003036   000002 471500                    LDP1    2,,PR0
        19 003037   000122 221003                    LDX1    82,DU
        19 003040   100000 741100                    STX1    0,,PR1

      506    13202    3          ETT$ -> ETT.ROP -> ETT.EVALP$ = ADDR(NIL);

  13202 19 003041   000000 470400 5                  LDP0    ETT$
        19 003042   000002 471500                    LDP1    2,,PR0
        19 003043   000003 236000 20                 LDQ     3
        19 003044   100003 756100                    STQ     3,,PR1

      507    13203    3          ETT$ -> ETT.ROP -> ETT.ROPCON = %MVANO_UPPER_TO_LOWER;

  13203 19 003045   000002 471500                    LDP1    2,,PR0
        19 003046   000001 235007                    LDA     1,DL
        19 003047   100002 755100                    STA     2,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:109  

      508    13204    3          MKCN.CON = ALTER_LTS$ -> ALTER_LTS.SEG_NO#;

  13204 19 003050   200044 471500                    LDP1    ALTER_LTS$,,AUTO
        19 003051   100002 235100                    LDA     2,,PR1
        19 003052   000000 755000 18                 STA     MKCN

      509    13205
      510    13206    3          CALL Z8AC$MAKE_CONST (ETT$ -> ETT.ROP -> ETT.LOP);

  13206 19 003053   000002 473500                    LDP3    2,,PR0
        19 003054   300001 634500                    EPPR4   1,,PR3
        19 003055   200056 454500                    STP4    POINTER$$+2,,AUTO
        19 003056   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 003057   000004 631400 20                 EPPR1   4
        19 003060   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        19 003061   000000 011000                    NOP     0

      511    13207
      512    13208    3          ETT$ -> ETT.LOP = POINTER$$;

  13208 19 003062   200054 236100                    LDQ     POINTER$$,,AUTO
        19 003063   000000 470400 5                  LDP0    ETT$
        19 003064   000001 756100                    STQ     1,,PR0

      513    13209
      514    13210               %RSV_ILS_ILL (@ILL_ITEM = %GO);

  13233 19 003065   000002 236000 17                 LDQ     ILS_+2
        19 003066   000004 036007                    ADLQ    4,DL
        19 003067   000003 116000 17                 CMPQ    ILS_+3
        19 003070   003101 602000 19                 TNC     s:13235

  13234 19 003071   000005 236000 20                 LDQ     5
        19 003072   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003073   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003074   200057 451500                    STP1    POINTER$$+3,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:110  
        19 003075   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003076   000004 631400 20                 EPPR1   4
        19 003077   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003100   000000 011000                    NOP     0

  13235 19 003101   000002 236000 17                 LDQ     ILS_+2
        19 003102   000022 736000                    QLS     18
        19 003103   000001 036000 17                 ADLQ    ILS_+1
        19 003104   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003105   000002 756100                    STQ     2,,PR0

  13236 19 003106   000002 235000 17                 LDA     ILS_+2
        19 003107   000004 035007                    ADLA    4,DL
        19 003110   000002 755000 17                 STA     ILS_+2

  13237 19 003111   000002 471500                    LDP1    2,,PR0
        19 003112   000740 220003                    LDX0    480,DU
        19 003113   100000 740100                    STX0    0,,PR1

  13238 19 003114   000002 471500                    LDP1    2,,PR0
        19 003115   000003 236000 20                 LDQ     3
        19 003116   100002 756100                    STQ     2,,PR1

  13245 19 003117   000116 235000 xsym               LDA     ILL_STEP+78
        19 003120   000000 755000 0                  STA     ITERATION

  13246 19 003121   000002 236000 15                 LDQ     ILL_+2
        19 003122   000000 036000 0                  ADLQ    ITERATION
        19 003123   000003 116000 15                 CMPQ    ILL_+3
        19 003124   003135 604000 19                 TMI     s:13248

  13247 19 003125   000006 236000 20                 LDQ     6
        19 003126   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003127   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003130   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003131   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003132   000004 631400 20                 EPPR1   4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:111  
        19 003133   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003134   000000 011000                    NOP     0

  13248 19 003135   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003136   000002 471500                    LDP1    2,,PR0
        19 003137   000002 236000 15                 LDQ     ILL_+2
        19 003140   000022 736000                    QLS     18
        19 003141   000001 036000 15                 ADLQ    ILL_+1
        19 003142   100003 756100                    STQ     3,,PR1

  13249 19 003143   000002 236000 15                 LDQ     ILL_+2
        19 003144   000000 036000 0                  ADLQ    ITERATION
        19 003145   000002 756000 15                 STQ     ILL_+2

  13250 19 003146   000002 471500                    LDP1    2,,PR0
        19 003147   100003 473500                    LDP3    3,,PR1
        19 003150   000344 220003                    LDX0    228,DU
        19 003151   300000 740100                    STX0    0,,PR3

  13253 19 003152   000002 236100                    LDQ     2,,PR0
        19 003153   200036 756100                    STQ     SUB_TAIL$,,AUTO

      515    13256
      516    13257    3          SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_NOT_EQUAL;

  13257 19 003154   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003155   000003 471500                    LDP1    3,,PR0
        19 003156   000012 221003                    LDX1    10,DU
        19 003157   100000 441100                    SXL1    0,,PR1

      517    13258    3          SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = GO_LABEL$;

  13258 19 003160   000003 471500                    LDP1    3,,PR0
        19 003161   200051 236100                    LDQ     GO_LABEL$,,AUTO
        19 003162   100001 756100                    STQ     1,,PR1

      518    13259    3          SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ETT$;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:112  

  13259 19 003163   000003 471500                    LDP1    3,,PR0
        19 003164   000000 236000 5                  LDQ     ETT$
        19 003165   100002 756100                    STQ     2,,PR1

      519    13260
      520    13261    3          IF ALTER_LTS$ -> ALTER_LTS.SEG_NO# > %MAX_FIXED_SEG# AND

  13261 19 003166   200044 471500                    LDP1    ALTER_LTS$,,AUTO
        19 003167   100002 235100                    LDA     2,,PR1
        19 003170   000061 115007                    CMPA    49,DL
        19 003171   003405 604400 19                 TMOZ    s:13376
        19 003172   000000 473400 14                 LDP3    ILL$
        19 003173   300001 474500                    LDP4    1,,PR3
        19 003174   400007 475500                    LDP5    7,,PR4
        19 003175   500007 476500                    LDP6    7,,PR5
        19 003176   100002 236100                    LDQ     2,,PR1
        19 003177   600002 116100                    CMPQ    2,,PR6
        19 003200   003405 600000 19                 TZE     s:13376

      521    13262    3            ALTER_LTS$ -> ALTER_LTS.SEG_NO# ~= ILL$ -> ILL.LOP ->
      522    13263    3            LABEL.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      523    13264    4            DO;

      524    13265
      525    13266    4             CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(ALTER_LTS$ -> ALTER_LTS.
             13266                       SEG_NO#) ->

  13266 19 003201   200026 477500                    LDP7    CURRENT_ARRAY$,,AUTO
        19 003202   700002 470506                    LDP0    2,QL,PR7
        19 003203   000007 236100                    LDQ     7,,PR0
        19 003204   200053 756100                    STQ     CALL_LABEL$,,AUTO

      526    13267    4                           SEGMENT_LTS.SUB_LABEL$;
      527    13268
      528    13269
      529    13270    4              IF CALL_LABEL$ ~= ADDR(NIL) THEN
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:113  

  13270 19 003205   000003 116000 20                 CMPQ    3
        19 003206   003405 600000 19                 TZE     s:13376

      530    13271    5                DO;

      531    13272                       %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  13295 19 003207   000002 236000 17                 LDQ     ILS_+2
        19 003210   000004 036007                    ADLQ    4,DL
        19 003211   000003 116000 17                 CMPQ    ILS_+3
        19 003212   003223 602000 19                 TNC     s:13297

  13296 19 003213   000005 236000 20                 LDQ     5
        19 003214   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003215   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 003216   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 003217   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003220   000004 631400 20                 EPPR1   4
        19 003221   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003222   000000 011000                    NOP     0

  13297 19 003223   000002 236000 17                 LDQ     ILS_+2
        19 003224   000022 736000                    QLS     18
        19 003225   000001 036000 17                 ADLQ    ILS_+1
        19 003226   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003227   000002 756100                    STQ     2,,PR0

  13298 19 003230   000002 235000 17                 LDA     ILS_+2
        19 003231   000004 035007                    ADLA    4,DL
        19 003232   000002 755000 17                 STA     ILS_+2

  13299 19 003233   000002 471500                    LDP1    2,,PR0
        19 003234   000740 220003                    LDX0    480,DU
        19 003235   100000 740100                    STX0    0,,PR1

  13300 19 003236   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:114  
        19 003237   000003 236000 20                 LDQ     3
        19 003240   100002 756100                    STQ     2,,PR1

  13307 19 003241   000145 235000 xsym               LDA     ILL_STEP+101
        19 003242   000000 755000 0                  STA     ITERATION

  13308 19 003243   000002 236000 15                 LDQ     ILL_+2
        19 003244   000000 036000 0                  ADLQ    ITERATION
        19 003245   000003 116000 15                 CMPQ    ILL_+3
        19 003246   003257 604000 19                 TMI     s:13310

  13309 19 003247   000006 236000 20                 LDQ     6
        19 003250   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003251   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003252   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003253   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003254   000004 631400 20                 EPPR1   4
        19 003255   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003256   000000 011000                    NOP     0

  13310 19 003257   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003260   000002 471500                    LDP1    2,,PR0
        19 003261   000002 236000 15                 LDQ     ILL_+2
        19 003262   000022 736000                    QLS     18
        19 003263   000001 036000 15                 ADLQ    ILL_+1
        19 003264   100003 756100                    STQ     3,,PR1

  13311 19 003265   000002 236000 15                 LDQ     ILL_+2
        19 003266   000000 036000 0                  ADLQ    ITERATION
        19 003267   000002 756000 15                 STQ     ILL_+2

  13312 19 003270   000002 471500                    LDP1    2,,PR0
        19 003271   100003 473500                    LDP3    3,,PR1
        19 003272   000373 220003                    LDX0    251,DU
        19 003273   300000 740100                    STX0    0,,PR3

  13315 19 003274   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:115  
        19 003275   200036 756100                    STQ     SUB_TAIL$,,AUTO

      532    13318
      533    13319    5                  SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  13319 19 003276   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003277   000003 471500                    LDP1    3,,PR0
        19 003300   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 003301   000100 100500                    MLR     fill='000'O
        19 003302   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 003303   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      534    13320
      535    13321                       %RSV_ILS_ILL (@ILL_ITEM = %GO);

  13344 19 003304   000002 236000 17                 LDQ     ILS_+2
        19 003305   000004 036007                    ADLQ    4,DL
        19 003306   000003 116000 17                 CMPQ    ILS_+3
        19 003307   003320 602000 19                 TNC     s:13346

  13345 19 003310   000005 236000 20                 LDQ     5
        19 003311   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003312   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003313   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003314   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003315   000004 631400 20                 EPPR1   4
        19 003316   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003317   000000 011000                    NOP     0

  13346 19 003320   000002 236000 17                 LDQ     ILS_+2
        19 003321   000022 736000                    QLS     18
        19 003322   000001 036000 17                 ADLQ    ILS_+1
        19 003323   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003324   000002 756100                    STQ     2,,PR0

  13347 19 003325   000002 235000 17                 LDA     ILS_+2
        19 003326   000004 035007                    ADLA    4,DL
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:116  
        19 003327   000002 755000 17                 STA     ILS_+2

  13348 19 003330   000002 471500                    LDP1    2,,PR0
        19 003331   000740 220003                    LDX0    480,DU
        19 003332   100000 740100                    STX0    0,,PR1

  13349 19 003333   000002 471500                    LDP1    2,,PR0
        19 003334   000003 236000 20                 LDQ     3
        19 003335   100002 756100                    STQ     2,,PR1

  13356 19 003336   000116 235000 xsym               LDA     ILL_STEP+78
        19 003337   000000 755000 0                  STA     ITERATION

  13357 19 003340   000002 236000 15                 LDQ     ILL_+2
        19 003341   000000 036000 0                  ADLQ    ITERATION
        19 003342   000003 116000 15                 CMPQ    ILL_+3
        19 003343   003354 604000 19                 TMI     s:13359

  13358 19 003344   000006 236000 20                 LDQ     6
        19 003345   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003346   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003347   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003350   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003351   000004 631400 20                 EPPR1   4
        19 003352   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003353   000000 011000                    NOP     0

  13359 19 003354   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003355   000002 471500                    LDP1    2,,PR0
        19 003356   000002 236000 15                 LDQ     ILL_+2
        19 003357   000022 736000                    QLS     18
        19 003360   000001 036000 15                 ADLQ    ILL_+1
        19 003361   100003 756100                    STQ     3,,PR1

  13360 19 003362   000002 236000 15                 LDQ     ILL_+2
        19 003363   000000 036000 0                  ADLQ    ITERATION
        19 003364   000002 756000 15                 STQ     ILL_+2
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:117  

  13361 19 003365   000002 471500                    LDP1    2,,PR0
        19 003366   100003 473500                    LDP3    3,,PR1
        19 003367   000344 220003                    LDX0    228,DU
        19 003370   300000 740100                    STX0    0,,PR3

  13364 19 003371   000002 236100                    LDQ     2,,PR0
        19 003372   200036 756100                    STQ     SUB_TAIL$,,AUTO

      536    13367
      537    13368    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;

  13368 19 003373   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003374   000003 471500                    LDP1    3,,PR0
        19 003375   000030 221003                    LDX1    24,DU
        19 003376   100000 441100                    SXL1    0,,PR1

      538    13369    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;

  13369 19 003377   000003 471500                    LDP1    3,,PR0
        19 003400   200053 236100                    LDQ     CALL_LABEL$,,AUTO
        19 003401   100001 756100                    STQ     1,,PR1

      539    13370    5                  SUB_TAIL$ -> ILS.ILL$ -> GO.ROP = ADDR(NIL);

  13370 19 003402   000003 471500                    LDP1    3,,PR0
        19 003403   000003 236000 20                 LDQ     3
        19 003404   100002 756100                    STQ     2,,PR1

      540    13371    5                END;

      541    13372    4            END;

      542    13373
      543    13374                 %OVERLAY_ALTERED_GO;

  13376 19 003405   000003 236000 20                 LDQ     3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:118  
        19 003406   000003 116000 20                 CMPQ    3
        19 003407   003410 600000 19                 TZE     s:13387

      544    13383
      545    13384
      546    13385          /*   %USE_PROC_TAILER;  */
      547    13386
      548    13387    3          GO_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  13387 19 003410   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 003411   200051 470500                    LDP0    GO_LABEL$,,AUTO
        19 003412   000010 756100                    STQ     8,,PR0

      549    13388
      550    13389                 %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  13412 19 003413   000002 236000 17                 LDQ     ILS_+2
        19 003414   000004 036007                    ADLQ    4,DL
        19 003415   000003 116000 17                 CMPQ    ILS_+3
        19 003416   003427 602000 19                 TNC     s:13414

  13413 19 003417   000005 236000 20                 LDQ     5
        19 003420   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003421   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 003422   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 003423   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003424   000004 631400 20                 EPPR1   4
        19 003425   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003426   000000 011000                    NOP     0

  13414 19 003427   000002 236000 17                 LDQ     ILS_+2
        19 003430   000022 736000                    QLS     18
        19 003431   000001 036000 17                 ADLQ    ILS_+1
        19 003432   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003433   000002 756100                    STQ     2,,PR0

  13415 19 003434   000002 235000 17                 LDA     ILS_+2
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:119  
        19 003435   000004 035007                    ADLA    4,DL
        19 003436   000002 755000 17                 STA     ILS_+2

  13416 19 003437   000002 471500                    LDP1    2,,PR0
        19 003440   000740 220003                    LDX0    480,DU
        19 003441   100000 740100                    STX0    0,,PR1

  13417 19 003442   000002 471500                    LDP1    2,,PR0
        19 003443   000003 236000 20                 LDQ     3
        19 003444   100002 756100                    STQ     2,,PR1

  13424 19 003445   000145 235000 xsym               LDA     ILL_STEP+101
        19 003446   000000 755000 0                  STA     ITERATION

  13425 19 003447   000002 236000 15                 LDQ     ILL_+2
        19 003450   000000 036000 0                  ADLQ    ITERATION
        19 003451   000003 116000 15                 CMPQ    ILL_+3
        19 003452   003463 604000 19                 TMI     s:13427

  13426 19 003453   000006 236000 20                 LDQ     6
        19 003454   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003455   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003456   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003457   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003460   000004 631400 20                 EPPR1   4
        19 003461   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003462   000000 011000                    NOP     0

  13427 19 003463   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003464   000002 471500                    LDP1    2,,PR0
        19 003465   000002 236000 15                 LDQ     ILL_+2
        19 003466   000022 736000                    QLS     18
        19 003467   000001 036000 15                 ADLQ    ILL_+1
        19 003470   100003 756100                    STQ     3,,PR1

  13428 19 003471   000002 236000 15                 LDQ     ILL_+2
        19 003472   000000 036000 0                  ADLQ    ITERATION
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:120  
        19 003473   000002 756000 15                 STQ     ILL_+2

  13429 19 003474   000002 471500                    LDP1    2,,PR0
        19 003475   100003 473500                    LDP3    3,,PR1
        19 003476   000373 220003                    LDX0    251,DU
        19 003477   300000 740100                    STX0    0,,PR3

  13432 19 003500   000002 236100                    LDQ     2,,PR0
        19 003501   200036 756100                    STQ     SUB_TAIL$,,AUTO

      551    13435
      552    13436    3            SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  13436 19 003502   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003503   000003 471500                    LDP1    3,,PR0
        19 003504   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 003505   000100 100500                    MLR     fill='000'O
        19 003506   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 003507   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      553    13437
      554    13438                 %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);

  13461 19 003510   000002 236000 17                 LDQ     ILS_+2
        19 003511   000004 036007                    ADLQ    4,DL
        19 003512   000003 116000 17                 CMPQ    ILS_+3
        19 003513   003524 602000 19                 TNC     s:13463

  13462 19 003514   000005 236000 20                 LDQ     5
        19 003515   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003516   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003517   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003520   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003521   000004 631400 20                 EPPR1   4
        19 003522   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003523   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:121  
  13463 19 003524   000002 236000 17                 LDQ     ILS_+2
        19 003525   000022 736000                    QLS     18
        19 003526   000001 036000 17                 ADLQ    ILS_+1
        19 003527   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003530   000002 756100                    STQ     2,,PR0

  13464 19 003531   000002 235000 17                 LDA     ILS_+2
        19 003532   000004 035007                    ADLA    4,DL
        19 003533   000002 755000 17                 STA     ILS_+2

  13465 19 003534   000002 471500                    LDP1    2,,PR0
        19 003535   000740 220003                    LDX0    480,DU
        19 003536   100000 740100                    STX0    0,,PR1

  13466 19 003537   000002 471500                    LDP1    2,,PR0
        19 003540   000003 236000 20                 LDQ     3
        19 003541   100002 756100                    STQ     2,,PR1

  13473 19 003542   000120 235000 xsym               LDA     ILL_STEP+80
        19 003543   000000 755000 0                  STA     ITERATION

  13474 19 003544   000002 236000 15                 LDQ     ILL_+2
        19 003545   000000 036000 0                  ADLQ    ITERATION
        19 003546   000003 116000 15                 CMPQ    ILL_+3
        19 003547   003560 604000 19                 TMI     s:13476

  13475 19 003550   000006 236000 20                 LDQ     6
        19 003551   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003552   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003553   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003554   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003555   000004 631400 20                 EPPR1   4
        19 003556   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003557   000000 011000                    NOP     0

  13476 19 003560   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003561   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:122  
        19 003562   000002 236000 15                 LDQ     ILL_+2
        19 003563   000022 736000                    QLS     18
        19 003564   000001 036000 15                 ADLQ    ILL_+1
        19 003565   100003 756100                    STQ     3,,PR1

  13477 19 003566   000002 236000 15                 LDQ     ILL_+2
        19 003567   000000 036000 0                  ADLQ    ITERATION
        19 003570   000002 756000 15                 STQ     ILL_+2

  13478 19 003571   000002 471500                    LDP1    2,,PR0
        19 003572   100003 473500                    LDP3    3,,PR1
        19 003573   000346 220003                    LDX0    230,DU
        19 003574   300000 740100                    STX0    0,,PR3

  13481 19 003575   000002 236100                    LDQ     2,,PR0
        19 003576   200036 756100                    STQ     SUB_TAIL$,,AUTO

      555    13484
      556    13485    3            SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = GO_LABEL$;

  13485 19 003577   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003600   000003 471500                    LDP1    3,,PR0
        19 003601   200051 236100                    LDQ     GO_LABEL$,,AUTO
        19 003602   100001 756100                    STQ     1,,PR1

      557    13486
      558    13487                 %UPDATE_LBL (@LBL_ILS$ = SUB_TAIL$);

  13489 19 003603   200023 236100                    LDQ     LAST_LABEL$,,AUTO
        19 003604   000003 116000 20                 CMPQ    3
        19 003605   003614 601000 19                 TNZ     s:13496

  13491 19 003606   000003 471500                    LDP1    3,,PR0
        19 003607   000321 236000 xsym               LDQ     COMCOM+209
        19 003610   100002 756100                    STQ     2,,PR1

  13492 19 003611   200036 236100                    LDQ     SUB_TAIL$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:123  
        19 003612   000321 756000 xsym               STQ     COMCOM+209

  13493 19 003613   003624 710000 19                 TRA     s:13499

  13496 19 003614   000003 471500                    LDP1    3,,PR0
        19 003615   200023 473500                    LDP3    LAST_LABEL$,,AUTO
        19 003616   300003 474500                    LDP4    3,,PR3
        19 003617   400002 236100                    LDQ     2,,PR4
        19 003620   100002 756100                    STQ     2,,PR1

  13497 19 003621   300003 471500                    LDP1    3,,PR3
        19 003622   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 003623   100002 756100                    STQ     2,,PR1

  13499 19 003624   200023 756100                    STQ     LAST_LABEL$,,AUTO

      559    13502
      560    13503    3    END GEN_RESET_CODE;

  13503 19 003625   200050 221300                    LDX1  ! PREV_ILS_NEXT$+2,,AUTO
        19 003626   000001 702211                    TSX2  ! 1,X1

      561    13504         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:124  
      562    13505
      563    13506
      564    13507               /*  main program */
      565    13508
      566    13509
      567    13510    2          IF ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = ADDR(NIL) THEN

  13510 19 003627   000000 470400 14                 LDP0    ILL$
        19 003630   000001 471500                    LDP1    1,,PR0
        19 003631   100005 473500                    LDP3    5,,PR1
        19 003632   300005 236100                    LDQ     5,,PR3
        19 003633   000003 116000 20                 CMPQ    3
        19 003634   003636 601000 19                 TNZ     s:13513

      568    13511    2            RETURN;

  13511 19 003635   000001 702211                    TSX2  ! 1,X1

      569    13512
      570    13513    2      SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;

  13513 19 003636   200015 474500                    LDP4    TRA_END_LABEL$,,AUTO
        19 003637   400010 236100                    LDQ     8,,PR4
        19 003640   200036 756100                    STQ     SUB_TAIL$,,AUTO

      571    13514    2      PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;

  13514 19 003641   200036 475500                    LDP5    SUB_TAIL$,,AUTO
        19 003642   500002 236100                    LDQ     2,,PR5
        19 003643   200046 756100                    STQ     PREV_ILS_NEXT$,,AUTO

      572    13515
      573    13516    2      TEMP_LABEL$ = LAST_LABEL$;

  13516 19 003644   200023 236100                    LDQ     LAST_LABEL$,,AUTO
        19 003645   200037 756100                    STQ     TEMP_LABEL$,,AUTO

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:125  
      574    13517    2      LAST_LABEL$ = ENTRY_LABEL$;

  13517 19 003646   200031 236100                    LDQ     ENTRY_LABEL$,,AUTO
        19 003647   200023 756100                    STQ     LAST_LABEL$,,AUTO

      575    13518
      576    13519           %USE_HEADER;

  13521 19 003650   200042 636500                    EPPR6   LABEL_USE$,,AUTO
        19 003651   200057 456500                    STP6    POINTER$$+3,,AUTO
        19 003652   000002 236000 20                 LDQ     2
        19 003653   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003654   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 003655   000000 631400 20                 EPPR1   0
        19 003656   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        19 003657   000000 011000                    NOP     0

  13522 19 003660   200042 470500                    LDP0    LABEL_USE$,,AUTO
        19 003661   400000 236003                    LDQ     -131072,DU
        19 003662   000003 256100                    ORSQ    3,,PR0

  13523 19 003663   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 003664   200042 470500                    LDP0    LABEL_USE$,,AUTO
        19 003665   000010 756100                    STQ     8,,PR0

  13524 19 003666   200014 236100                    LDQ     CURRENT_PROC$,,AUTO
        19 003667   200042 470500                    LDP0    LABEL_USE$,,AUTO
        19 003670   000011 756100                    STQ     9,,PR0

  13548 19 003671   000002 236000 17                 LDQ     ILS_+2
        19 003672   000004 036007                    ADLQ    4,DL
        19 003673   000003 116000 17                 CMPQ    ILS_+3
        19 003674   003705 602000 19                 TNC     s:13550

  13549 19 003675   000005 236000 20                 LDQ     5
        19 003676   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003677   200056 630500                    EPPR0   POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:126  
        19 003700   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 003701   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003702   000004 631400 20                 EPPR1   4
        19 003703   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003704   000000 011000                    NOP     0

  13550 19 003705   000002 236000 17                 LDQ     ILS_+2
        19 003706   000022 736000                    QLS     18
        19 003707   000001 036000 17                 ADLQ    ILS_+1
        19 003710   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003711   000002 756100                    STQ     2,,PR0

  13551 19 003712   000002 235000 17                 LDA     ILS_+2
        19 003713   000004 035007                    ADLA    4,DL
        19 003714   000002 755000 17                 STA     ILS_+2

  13552 19 003715   000002 471500                    LDP1    2,,PR0
        19 003716   000740 220003                    LDX0    480,DU
        19 003717   100000 740100                    STX0    0,,PR1

  13553 19 003720   000002 471500                    LDP1    2,,PR0
        19 003721   000003 236000 20                 LDQ     3
        19 003722   100002 756100                    STQ     2,,PR1

  13560 19 003723   000145 235000 xsym               LDA     ILL_STEP+101
        19 003724   000000 755000 0                  STA     ITERATION

  13561 19 003725   000002 236000 15                 LDQ     ILL_+2
        19 003726   000000 036000 0                  ADLQ    ITERATION
        19 003727   000003 116000 15                 CMPQ    ILL_+3
        19 003730   003741 604000 19                 TMI     s:13563

  13562 19 003731   000006 236000 20                 LDQ     6
        19 003732   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 003733   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003734   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003735   200057 630500                    EPPR0   POINTER$$+3,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:127  
        19 003736   000004 631400 20                 EPPR1   4
        19 003737   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 003740   000000 011000                    NOP     0

  13563 19 003741   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003742   000002 471500                    LDP1    2,,PR0
        19 003743   000002 236000 15                 LDQ     ILL_+2
        19 003744   000022 736000                    QLS     18
        19 003745   000001 036000 15                 ADLQ    ILL_+1
        19 003746   100003 756100                    STQ     3,,PR1

  13564 19 003747   000002 236000 15                 LDQ     ILL_+2
        19 003750   000000 036000 0                  ADLQ    ITERATION
        19 003751   000002 756000 15                 STQ     ILL_+2

  13565 19 003752   000002 471500                    LDP1    2,,PR0
        19 003753   100003 473500                    LDP3    3,,PR1
        19 003754   000373 220003                    LDX0    251,DU
        19 003755   300000 740100                    STX0    0,,PR3

  13568 19 003756   000002 236100                    LDQ     2,,PR0
        19 003757   200036 756100                    STQ     SUB_TAIL$,,AUTO

  13571 19 003760   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 003761   000003 471500                    LDP1    3,,PR0
        19 003762   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 003763   000100 100500                    MLR     fill='000'O
        19 003764   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 003765   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

  13595 19 003766   000002 236000 17                 LDQ     ILS_+2
        19 003767   000004 036007                    ADLQ    4,DL
        19 003770   000003 116000 17                 CMPQ    ILS_+3
        19 003771   004002 602000 19                 TNC     s:13597

  13596 19 003772   000005 236000 20                 LDQ     5
        19 003773   200056 756100                    STQ     POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:128  
        19 003774   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 003775   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 003776   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 003777   000004 631400 20                 EPPR1   4
        19 004000   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004001   000000 011000                    NOP     0

  13597 19 004002   000002 236000 17                 LDQ     ILS_+2
        19 004003   000022 736000                    QLS     18
        19 004004   000001 036000 17                 ADLQ    ILS_+1
        19 004005   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004006   000002 756100                    STQ     2,,PR0

  13598 19 004007   000002 235000 17                 LDA     ILS_+2
        19 004010   000004 035007                    ADLA    4,DL
        19 004011   000002 755000 17                 STA     ILS_+2

  13599 19 004012   000002 471500                    LDP1    2,,PR0
        19 004013   000740 220003                    LDX0    480,DU
        19 004014   100000 740100                    STX0    0,,PR1

  13600 19 004015   000002 471500                    LDP1    2,,PR0
        19 004016   000003 236000 20                 LDQ     3
        19 004017   100002 756100                    STQ     2,,PR1

  13607 19 004020   000120 235000 xsym               LDA     ILL_STEP+80
        19 004021   000000 755000 0                  STA     ITERATION

  13608 19 004022   000002 236000 15                 LDQ     ILL_+2
        19 004023   000000 036000 0                  ADLQ    ITERATION
        19 004024   000003 116000 15                 CMPQ    ILL_+3
        19 004025   004036 604000 19                 TMI     s:13610

  13609 19 004026   000006 236000 20                 LDQ     6
        19 004027   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004030   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 004031   200057 451500                    STP1    POINTER$$+3,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:129  
        19 004032   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004033   000004 631400 20                 EPPR1   4
        19 004034   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004035   000000 011000                    NOP     0

  13610 19 004036   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004037   000002 471500                    LDP1    2,,PR0
        19 004040   000002 236000 15                 LDQ     ILL_+2
        19 004041   000022 736000                    QLS     18
        19 004042   000001 036000 15                 ADLQ    ILL_+1
        19 004043   100003 756100                    STQ     3,,PR1

  13611 19 004044   000002 236000 15                 LDQ     ILL_+2
        19 004045   000000 036000 0                  ADLQ    ITERATION
        19 004046   000002 756000 15                 STQ     ILL_+2

  13612 19 004047   000002 471500                    LDP1    2,,PR0
        19 004050   100003 473500                    LDP3    3,,PR1
        19 004051   000346 220003                    LDX0    230,DU
        19 004052   300000 740100                    STX0    0,,PR3

  13615 19 004053   000002 236100                    LDQ     2,,PR0
        19 004054   200036 756100                    STQ     SUB_TAIL$,,AUTO

  13618 19 004055   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004056   000003 471500                    LDP1    3,,PR0
        19 004057   200042 236100                    LDQ     LABEL_USE$,,AUTO
        19 004060   100001 756100                    STQ     1,,PR1

  13621 19 004061   200023 236100                    LDQ     LAST_LABEL$,,AUTO
        19 004062   000003 116000 20                 CMPQ    3
        19 004063   004072 601000 19                 TNZ     s:13628

  13623 19 004064   000003 471500                    LDP1    3,,PR0
        19 004065   000321 236000 xsym               LDQ     COMCOM+209
        19 004066   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:130  
  13624 19 004067   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 004070   000321 756000 xsym               STQ     COMCOM+209

  13625 19 004071   004102 710000 19                 TRA     s:13631

  13628 19 004072   000003 471500                    LDP1    3,,PR0
        19 004073   200023 473500                    LDP3    LAST_LABEL$,,AUTO
        19 004074   300003 474500                    LDP4    3,,PR3
        19 004075   400002 236100                    LDQ     2,,PR4
        19 004076   100002 756100                    STQ     2,,PR1

  13629 19 004077   300003 471500                    LDP1    3,,PR3
        19 004100   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 004101   100002 756100                    STQ     2,,PR1

  13631 19 004102   200023 756100                    STQ     LAST_LABEL$,,AUTO

      577    13636
      578    13637    2      ALTER_LTS$ = ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$;

  13637 19 004103   000000 471400 14                 LDP1    ILL$
        19 004104   100001 473500                    LDP3    1,,PR1
        19 004105   300005 474500                    LDP4    5,,PR3
        19 004106   400005 236100                    LDQ     5,,PR4
        19 004107   200044 756100                    STQ     ALTER_LTS$,,AUTO

      579    13638    2      HEAD_LTS$ = ALTER_LTS$;

  13638 19 004110   200045 756100                    STQ     HEAD_LTS$,,AUTO

      580    13639    2      ILL$ -> ILL.LOP -> LABEL.B.GO_ALTERED = TRUE;

  13639 19 004111   020000 236007                    LDQ     8192,DL
        19 004112   300003 256100                    ORSQ    3,,PR3

      581    13640
      582    13641    3      DO WHILE (ALTER_LTS$ ~= ADDR(NIL));
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:131  

  13641 19 004113   004171 710000 19                 TRA     s:13673

      583    13642
      584    13643    3        GENERATE_CODE = TRUE;

  13643 19 004114   400000 236003                    LDQ     -131072,DU
        19 004115   200043 756100                    STQ     GENERATE_CODE,,AUTO

      585    13644    3        LTS$$ = HEAD_LTS$;

  13644 19 004116   200045 236100                    LDQ     HEAD_LTS$,,AUTO
        19 004117   200041 756100                    STQ     LTS$$,,AUTO

      586    13645
      587    13646    3      CHECK_DUP_LBL:
      588    13647    4        DO WHILE (LTS$ ~= ADDR(NIL) AND LTS$$ ~= ALTER_LTS$);

  13647 19 004120   004132 710000 19    CHECK_DUP_L* TRA     s:13656

      589    13648
      590    13649    4          IF LTS$$ -> ALTER_LTS.LABEL$ = ALTER_LTS$ -> ALTER_LTS.LABEL$ THEN

  13649 19 004121   200041 470500                    LDP0    LTS$$,,AUTO
        19 004122   200044 471500                    LDP1    ALTER_LTS$,,AUTO
        19 004123   000001 236100                    LDQ     1,,PR0
        19 004124   100001 116100                    CMPQ    1,,PR1
        19 004125   004130 601000 19                 TNZ     s:13655

      591    13650    5            DO;

      592    13651    5              GENERATE_CODE = FALSE;

  13651 19 004126   200043 450100                    STZ     GENERATE_CODE,,AUTO

      593    13652    5              EXIT CHECK_DUP_LBL;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:132  
  13652 19 004127   004140 710000 19                 TRA     s:13660

      594    13653    5            END;
      595    13654
      596    13655    4          LTS$$ = LTS$$ -> ALTER_LTS.NEXT;

  13655 19 004130   000003 236100                    LDQ     3,,PR0
        19 004131   200041 756100                    STQ     LTS$$,,AUTO

      597    13656    4        END;

  13656 19 004132   000000 236000 9                  LDQ     LTS$
        19 004133   000003 116000 20                 CMPQ    3
        19 004134   004140 600000 19                 TZE     s:13660
        19 004135   200041 236100                    LDQ     LTS$$,,AUTO
        19 004136   200044 116100                    CMPQ    ALTER_LTS$,,AUTO
        19 004137   004121 601000 19                 TNZ     s:13649

      598    13657
      599    13658             %SEGNUM_CHECK;

  13660 19 004140   000000 470400 14                 LDP0    ILL$
        19 004141   000001 471500                    LDP1    1,,PR0
        19 004142   100007 236100                    LDQ     7,,PR1
        19 004143   000003 116000 20                 CMPQ    3
        19 004144   004162 600000 19                 TZE     s:13669
        19 004145   100007 473500                    LDP3    7,,PR1
        19 004146   300007 236100                    LDQ     7,,PR3
        19 004147   000003 116000 20                 CMPQ    3
        19 004150   004162 600000 19                 TZE     s:13669
        19 004151   300007 474500                    LDP4    7,,PR3
        19 004152   200044 475500                    LDP5    ALTER_LTS$,,AUTO
        19 004153   400002 236100                    LDQ     2,,PR4
        19 004154   500002 116100                    CMPQ    2,,PR5
        19 004155   004161 600000 19                 TZE     s:13665
        19 004156   500002 236100                    LDQ     2,,PR5
        19 004157   000502 116000 xsym               CMPQ    COMCOM+322
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:133  
        19 004160   004162 605000 19                 TPL     s:13669

  13665 19 004161   200043 450100                    STZ     GENERATE_CODE,,AUTO

      600    13668
      601    13669    3        IF GENERATE_CODE THEN

  13669 19 004162   200043 234100                    SZN     GENERATE_CODE,,AUTO
        19 004163   004166 605000 19                 TPL     s:13672

      602    13670    3          CALL GEN_RESET_CODE;

  13670 19 004164   002421 701000 19                 TSX1    GEN_RESET_CODE
        19 004165   000000 011000                    NOP     0

      603    13671
      604    13672    3        ALTER_LTS$ = ALTER_LTS$ -> ALTER_LTS.NEXT;

  13672 19 004166   200044 470500                    LDP0    ALTER_LTS$,,AUTO
        19 004167   000003 236100                    LDQ     3,,PR0
        19 004170   200044 756100                    STQ     ALTER_LTS$,,AUTO

      605    13673    3      END;

  13673 19 004171   200044 236100                    LDQ     ALTER_LTS$,,AUTO
        19 004172   000003 116000 20                 CMPQ    3
        19 004173   004114 601000 19                 TNZ     s:13643

      606    13674
      607    13675           %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  13698 19 004174   000002 236000 17                 LDQ     ILS_+2
        19 004175   000004 036007                    ADLQ    4,DL
        19 004176   000003 116000 17                 CMPQ    ILS_+3
        19 004177   004210 602000 19                 TNC     s:13700

  13699 19 004200   000005 236000 20                 LDQ     5
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:134  
        19 004201   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004202   200056 630500                    EPPR0   POINTER$$+2,,AUTO
        19 004203   200057 450500                    STP0    POINTER$$+3,,AUTO
        19 004204   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004205   000004 631400 20                 EPPR1   4
        19 004206   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004207   000000 011000                    NOP     0

  13700 19 004210   000002 236000 17                 LDQ     ILS_+2
        19 004211   000022 736000                    QLS     18
        19 004212   000001 036000 17                 ADLQ    ILS_+1
        19 004213   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004214   000002 756100                    STQ     2,,PR0

  13701 19 004215   000002 235000 17                 LDA     ILS_+2
        19 004216   000004 035007                    ADLA    4,DL
        19 004217   000002 755000 17                 STA     ILS_+2

  13702 19 004220   000002 471500                    LDP1    2,,PR0
        19 004221   000740 220003                    LDX0    480,DU
        19 004222   100000 740100                    STX0    0,,PR1

  13703 19 004223   000002 471500                    LDP1    2,,PR0
        19 004224   000003 236000 20                 LDQ     3
        19 004225   100002 756100                    STQ     2,,PR1

  13710 19 004226   000145 235000 xsym               LDA     ILL_STEP+101
        19 004227   000000 755000 0                  STA     ITERATION

  13711 19 004230   000002 236000 15                 LDQ     ILL_+2
        19 004231   000000 036000 0                  ADLQ    ITERATION
        19 004232   000003 116000 15                 CMPQ    ILL_+3
        19 004233   004244 604000 19                 TMI     s:13713

  13712 19 004234   000006 236000 20                 LDQ     6
        19 004235   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004236   200056 631500                    EPPR1   POINTER$$+2,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:135  
        19 004237   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 004240   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004241   000004 631400 20                 EPPR1   4
        19 004242   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004243   000000 011000                    NOP     0

  13713 19 004244   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004245   000002 471500                    LDP1    2,,PR0
        19 004246   000002 236000 15                 LDQ     ILL_+2
        19 004247   000022 736000                    QLS     18
        19 004250   000001 036000 15                 ADLQ    ILL_+1
        19 004251   100003 756100                    STQ     3,,PR1

  13714 19 004252   000002 236000 15                 LDQ     ILL_+2
        19 004253   000000 036000 0                  ADLQ    ITERATION
        19 004254   000002 756000 15                 STQ     ILL_+2

  13715 19 004255   000002 471500                    LDP1    2,,PR0
        19 004256   100003 473500                    LDP3    3,,PR1
        19 004257   000373 220003                    LDX0    251,DU
        19 004260   300000 740100                    STX0    0,,PR3

  13718 19 004261   000002 236100                    LDQ     2,,PR0
        19 004262   200036 756100                    STQ     SUB_TAIL$,,AUTO

      608    13721
      609    13722    2      SUB_TAIL$ -> ILS.ILL$ -> LINOI = ENTRY_LINOI$ -> LINOI;

  13722 19 004263   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004264   000003 471500                    LDP1    3,,PR0
        19 004265   200030 473500                    LDP3    ENTRY_LINOI$,,AUTO
        19 004266   000100 100500                    MLR     fill='000'O
        19 004267   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12
        19 004270   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      610    13723
      611    13724           %RSV_ILS_ILL (@ILL_ITEM = %GO);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:136  

  13747 19 004271   000002 236000 17                 LDQ     ILS_+2
        19 004272   000004 036007                    ADLQ    4,DL
        19 004273   000003 116000 17                 CMPQ    ILS_+3
        19 004274   004305 602000 19                 TNC     s:13749

  13748 19 004275   000005 236000 20                 LDQ     5
        19 004276   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004277   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 004300   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 004301   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004302   000004 631400 20                 EPPR1   4
        19 004303   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004304   000000 011000                    NOP     0

  13749 19 004305   000002 236000 17                 LDQ     ILS_+2
        19 004306   000022 736000                    QLS     18
        19 004307   000001 036000 17                 ADLQ    ILS_+1
        19 004310   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004311   000002 756100                    STQ     2,,PR0

  13750 19 004312   000002 235000 17                 LDA     ILS_+2
        19 004313   000004 035007                    ADLA    4,DL
        19 004314   000002 755000 17                 STA     ILS_+2

  13751 19 004315   000002 471500                    LDP1    2,,PR0
        19 004316   000740 220003                    LDX0    480,DU
        19 004317   100000 740100                    STX0    0,,PR1

  13752 19 004320   000002 471500                    LDP1    2,,PR0
        19 004321   000003 236000 20                 LDQ     3
        19 004322   100002 756100                    STQ     2,,PR1

  13759 19 004323   000116 235000 xsym               LDA     ILL_STEP+78
        19 004324   000000 755000 0                  STA     ITERATION

  13760 19 004325   000002 236000 15                 LDQ     ILL_+2
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:137  
        19 004326   000000 036000 0                  ADLQ    ITERATION
        19 004327   000003 116000 15                 CMPQ    ILL_+3
        19 004330   004341 604000 19                 TMI     s:13762

  13761 19 004331   000006 236000 20                 LDQ     6
        19 004332   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004333   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 004334   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 004335   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004336   000004 631400 20                 EPPR1   4
        19 004337   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 004340   000000 011000                    NOP     0

  13762 19 004341   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004342   000002 471500                    LDP1    2,,PR0
        19 004343   000002 236000 15                 LDQ     ILL_+2
        19 004344   000022 736000                    QLS     18
        19 004345   000001 036000 15                 ADLQ    ILL_+1
        19 004346   100003 756100                    STQ     3,,PR1

  13763 19 004347   000002 236000 15                 LDQ     ILL_+2
        19 004350   000000 036000 0                  ADLQ    ITERATION
        19 004351   000002 756000 15                 STQ     ILL_+2

  13764 19 004352   000002 471500                    LDP1    2,,PR0
        19 004353   100003 473500                    LDP3    3,,PR1
        19 004354   000344 220003                    LDX0    228,DU
        19 004355   300000 740100                    STX0    0,,PR3

  13767 19 004356   000002 236100                    LDQ     2,,PR0
        19 004357   200036 756100                    STQ     SUB_TAIL$,,AUTO

      612    13770
      613    13771    2      SUB_TAIL$ -> ILS.ILL$ -> GO.CODE = %GO_ALTERED;

  13771 19 004360   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004361   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:138  
        19 004362   000020 221003                    LDX1    16,DU
        19 004363   100000 441100                    SXL1    0,,PR1

      614    13772
      615    13773    2      CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,

  13773 19 004364   000000 471400 14                 LDP1    ILL$
        19 004365   100001 473500                    LDP3    1,,PR1
        19 004366   000003 474500                    LDP4    3,,PR0
        19 004367   000003 236000 20                 LDQ     3
        19 004370   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 004371   400001 635500                    EPPR5   1,,PR4
        19 004372   200061 455500                    STP5    POINTER$$+5,,AUTO
        19 004373   200056 634500                    EPPR4   POINTER$$+2,,AUTO
        19 004374   200060 454500                    STP4    POINTER$$+4,,AUTO
        19 004375   300005 636500                    EPPR6   5,,PR3
        19 004376   200057 456500                    STP6    POINTER$$+3,,AUTO
        19 004377   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 004400   000010 631400 20                 EPPR1   8
        19 004401   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        19 004402   000000 011000                    NOP     0

      616    13774    2                          ADDR(NIL),
      617    13775    2                          SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP);
      618    13776
      619    13777    2      SUB_TAIL$ -> ILS.ILL$ -> GO.EXPR$ = ADDR(NIL);

  13777 19 004403   200036 470500                    LDP0    SUB_TAIL$,,AUTO
        19 004404   000003 471500                    LDP1    3,,PR0
        19 004405   000003 236000 20                 LDQ     3
        19 004406   100002 756100                    STQ     2,,PR1

      620    13778
      621    13779    3      DO WHILE (ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO);

  13779 19 004407   000000 471400 16                 LDP1    ILS$
        19 004410   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:139  
        19 004411   300000 220100                    LDX0    0,,PR3
        19 004412   000344 100003                    CMPX0   228,DU
        19 004413   004425 600000 19                 TZE     s:13788

      622    13780
      623    13781    3        ILS$ = ILS$ -> ILS.ILL$ -> ILL.BRANCH$;

  13781 19 004414   000000 470400 16                 LDP0    ILS$
        19 004415   000003 471500                    LDP1    3,,PR0
        19 004416   100003 236100                    LDQ     3,,PR1
        19 004417   000000 756000 16                 STQ     ILS$

      624    13782
      625    13783    3      END;

  13783 19 004420   000000 470400 16                 LDP0    ILS$
        19 004421   000003 471500                    LDP1    3,,PR0
        19 004422   100000 220100                    LDX0    0,,PR1
        19 004423   000344 100003                    CMPX0   228,DU
        19 004424   004414 601000 19                 TNZ     s:13781

      626    13784
      627    13785           %REPLACE_OLD_GO (@GO_ILL$ = ILS$ -> ILS.ILL$,
      628    13786                            @LABEL$  = LABEL_USE$);

  13788 19 004425   000000 470400 16                 LDP0    ILS$
        19 004426   000003 471500                    LDP1    3,,PR0
        19 004427   000000 220003                    LDX0    0,DU
        19 004430   100000 440100                    SXL0    0,,PR1

  13789 19 004431   000000 470400 16                 LDP0    ILS$
        19 004432   000003 471500                    LDP1    3,,PR0
        19 004433   200042 236100                    LDQ     LABEL_USE$,,AUTO
        19 004434   100001 756100                    STQ     1,,PR1

  13790 19 004435   000003 471500                    LDP1    3,,PR0
        19 004436   000003 236000 20                 LDQ     3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:140  
        19 004437   100002 756100                    STQ     2,,PR1

      629    13793
      630    13794    2      TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  13794 19 004440   200036 236100                    LDQ     SUB_TAIL$,,AUTO
        19 004441   200015 471500                    LDP1    TRA_END_LABEL$,,AUTO
        19 004442   100010 756100                    STQ     8,,PR1

      631    13795
      632    13796    2      SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;

  13796 19 004443   200046 236100                    LDQ     PREV_ILS_NEXT$,,AUTO
        19 004444   200036 473500                    LDP3    SUB_TAIL$,,AUTO
        19 004445   300002 756100                    STQ     2,,PR3

      633    13797    2    END OVERLAY_RESET;

  13797 19 004446   200034 221300                    LDX1  ! SEG_LTS$+2,,AUTO
        19 004447   000001 702211                    TSX2  ! 1,X1

      634    13798         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:141  
      635    13799
      636    13800
      637    13801            /* Main Program */
      638    13802
      639    13803            /* If there is no overlayable segment then RETURN */
      640    13804
      641    13805    1       IF COMCOM.SEGMENTC <= 1 THEN

  13805 19 004450   000314 235000 xsym               LDA     COMCOM+204
        19 004451   000001 115007                    CMPA    1,DL
        19 004452   004454 605400 19                 TPNZ    s:13808

      642    13806    1         RETURN;

  13806 19 004453   000000 702200 xent               TSX2  ! X66_ARET

      643    13807
      644    13808    1    LAST_LABEL$ = ADDR(NIL);

  13808 19 004454   000003 236000 20                 LDQ     3
        19 004455   200023 756100                    STQ     LAST_LABEL$,,AUTO

      645    13809    1    ENTRY_LABEL$ = ADDR(NIL);

  13809 19 004456   200031 756100                    STQ     ENTRY_LABEL$,,AUTO

      646    13810    1    ILS$ = COMCOM.H_BRANCH;

  13810 19 004457   000333 236000 xsym               LDQ     COMCOM+219
        19 004460   000000 756000 16                 STQ     ILS$

      647    13811    1    CURRENT_PROC$ = ADDR(NIL);

  13811 19 004461   000003 236000 20                 LDQ     3
        19 004462   200014 756100                    STQ     CURRENT_PROC$,,AUTO

      648    13812    1    CURRENT_ARRAY$ = ADDR(NIL);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:142  

  13812 19 004463   200026 756100                    STQ     CURRENT_ARRAY$,,AUTO

      649    13813
      650    13814    2    DO WHILE (ILS$ ~= ADDR(NIL));

  13814 19 004464   005415 710000 19                 TRA     s:14142

      651    13815
      652    13816    2      ILL$ = ILS$ -> ILS.ILL$;

  13816 19 004465   000000 470400 16                 LDP0    ILS$
        19 004466   000003 236100                    LDQ     3,,PR0
        19 004467   000000 756000 14                 STQ     ILL$

      653    13817
      654    13818    2      IF ILL$ = ADDR(NIL) THEN

  13818 19 004470   000003 116000 20                 CMPQ    3
        19 004471   004473 601000 19                 TNZ     CASE_STATEMENT

      655    13819    2        RETURN;           /*#25871*/

  13819 19 004472   000000 702200 xent               TSX2  ! X66_ARET

      656    13820
      657    13821    2    CASE_STATEMENT:
      658    13822    3      DO CASE (ILL$ -> ILL.ID);

  13822 19 004473   000000 471400 14    CASE_STATEM* LDP1    ILL$
        19 004474   100000 236100                    LDQ     0,,PR1
        19 004475   000022 772000                    QRL     18
        19 004476   000344 136007                    SBLQ    228,DL
        19 004477   000102 116007                    CMPQ    66,DL
        19 004500   004502 602006 19                 TNC     CASE_STATEMENT+7,QL
        19 004501   005411 710000 19                 TRA     NEXT_LBL
        19 004502   005332 710000 19                 TRA     s:14107
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:143  
        19 004503   005411 710000 19                 TRA     NEXT_LBL
        19 004504   004776 710000 19                 TRA     s:13909
        19 004505   005411 710000 19                 TRA     NEXT_LBL
        19 004506   005411 710000 19                 TRA     NEXT_LBL
        19 004507   005411 710000 19                 TRA     NEXT_LBL
        19 004510   005411 710000 19                 TRA     NEXT_LBL
        19 004511   005411 710000 19                 TRA     NEXT_LBL
        19 004512   005411 710000 19                 TRA     NEXT_LBL
        19 004513   005411 710000 19                 TRA     NEXT_LBL
        19 004514   005411 710000 19                 TRA     NEXT_LBL
        19 004515   005411 710000 19                 TRA     NEXT_LBL
        19 004516   005411 710000 19                 TRA     NEXT_LBL
        19 004517   005411 710000 19                 TRA     NEXT_LBL
        19 004520   005411 710000 19                 TRA     NEXT_LBL
        19 004521   005411 710000 19                 TRA     NEXT_LBL
        19 004522   005411 710000 19                 TRA     NEXT_LBL
        19 004523   005411 710000 19                 TRA     NEXT_LBL
        19 004524   005411 710000 19                 TRA     NEXT_LBL
        19 004525   005411 710000 19                 TRA     NEXT_LBL
        19 004526   005411 710000 19                 TRA     NEXT_LBL
        19 004527   005411 710000 19                 TRA     NEXT_LBL
        19 004530   005411 710000 19                 TRA     NEXT_LBL
        19 004531   005411 710000 19                 TRA     NEXT_LBL
        19 004532   005411 710000 19                 TRA     NEXT_LBL
        19 004533   005411 710000 19                 TRA     NEXT_LBL
        19 004534   005411 710000 19                 TRA     NEXT_LBL
        19 004535   005411 710000 19                 TRA     NEXT_LBL
        19 004536   005411 710000 19                 TRA     NEXT_LBL
        19 004537   005411 710000 19                 TRA     NEXT_LBL
        19 004540   005411 710000 19                 TRA     NEXT_LBL
        19 004541   005411 710000 19                 TRA     NEXT_LBL
        19 004542   005411 710000 19                 TRA     NEXT_LBL
        19 004543   005411 710000 19                 TRA     NEXT_LBL
        19 004544   005411 710000 19                 TRA     NEXT_LBL
        19 004545   005411 710000 19                 TRA     NEXT_LBL
        19 004546   005411 710000 19                 TRA     NEXT_LBL
        19 004547   005411 710000 19                 TRA     NEXT_LBL
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:144  
        19 004550   005411 710000 19                 TRA     NEXT_LBL
        19 004551   005411 710000 19                 TRA     NEXT_LBL
        19 004552   005411 710000 19                 TRA     NEXT_LBL
        19 004553   005411 710000 19                 TRA     NEXT_LBL
        19 004554   005411 710000 19                 TRA     NEXT_LBL
        19 004555   005411 710000 19                 TRA     NEXT_LBL
        19 004556   005411 710000 19                 TRA     NEXT_LBL
        19 004557   005411 710000 19                 TRA     NEXT_LBL
        19 004560   005411 710000 19                 TRA     NEXT_LBL
        19 004561   005411 710000 19                 TRA     NEXT_LBL
        19 004562   005411 710000 19                 TRA     NEXT_LBL
        19 004563   005411 710000 19                 TRA     NEXT_LBL
        19 004564   005411 710000 19                 TRA     NEXT_LBL
        19 004565   005411 710000 19                 TRA     NEXT_LBL
        19 004566   005411 710000 19                 TRA     NEXT_LBL
        19 004567   005411 710000 19                 TRA     NEXT_LBL
        19 004570   005411 710000 19                 TRA     NEXT_LBL
        19 004571   005411 710000 19                 TRA     NEXT_LBL
        19 004572   005411 710000 19                 TRA     NEXT_LBL
        19 004573   005411 710000 19                 TRA     NEXT_LBL
        19 004574   005411 710000 19                 TRA     NEXT_LBL
        19 004575   005411 710000 19                 TRA     NEXT_LBL
        19 004576   005411 710000 19                 TRA     NEXT_LBL
        19 004577   005411 710000 19                 TRA     NEXT_LBL
        19 004600   005411 710000 19                 TRA     NEXT_LBL
        19 004601   005411 710000 19                 TRA     NEXT_LBL
        19 004602   005411 710000 19                 TRA     NEXT_LBL
        19 004603   004604 710000 19                 TRA     s:13826

      659    13823
      660    13824    3        CASE (%SCOPE);

      661    13825
      662    13826    3          IF ILL$ -> SCOPE.CODE = %PROGRAM_SCOPE THEN

  13826 19 004604   100000 720100                    LXL0    0,,PR1
        19 004605   005411 601000 19                 TNZ     NEXT_LBL
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:145  

      663    13827    4            DO;

      664    13828    4              CURRENT_PROC$ = ILL$ -> SCOPE.PROC$;

  13828 19 004606   100001 236100                    LDQ     1,,PR1
        19 004607   200014 756100                    STQ     CURRENT_PROC$,,AUTO

      665    13829    4              O2COM.SECTION$ = ADDR(NIL);

  13829 19 004610   000003 236000 20                 LDQ     3
        19 004611   000003 756000 11                 STQ     O2COM+3

      666    13830
      667    13831                   %GET_ENTRY (@START = ILS$, @RTN = CURRENT_ENTRY$);

  13833 19 004612   200020 756100                    STQ     CURRENT_ENTRY$,,AUTO

  13834 19 004613   000002 236100                    LDQ     2,,PR0
        19 004614   200021 756100                    STQ     TEMP$,,AUTO

  13835 19 004615   200030 756100                    STQ     ENTRY_LINOI$,,AUTO

  13836 19 004616   004650 710000 19                 TRA     s:13854

  13837 19 004617   200021 470500                    LDP0    TEMP$,,AUTO
        19 004620   000003 471500                    LDP1    3,,PR0
        19 004621   100000 220100                    LDX0    0,,PR1
        19 004622   000353 100003                    CMPX0   235,DU
        19 004623   004635 601000 19                 TNZ     s:13846
        19 004624   100000 721100                    LXL1    0,,PR1
        19 004625   004630 600000 19                 TZE     s:13841
        19 004626   000001 101003                    CMPX1   1,DU
        19 004627   004635 601000 19                 TNZ     s:13846

  13841 19 004630   200021 236100                    LDQ     TEMP$,,AUTO
        19 004631   200020 756100                    STQ     CURRENT_ENTRY$,,AUTO
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:146  

  13842 19 004632   000003 236000 20                 LDQ     3
        19 004633   200021 756100                    STQ     TEMP$,,AUTO

  13843 19 004634   004650 710000 19                 TRA     s:13854

  13846 19 004635   000445 100003                    CMPX0   293,DU
        19 004636   004644 601000 19                 TNZ     s:13851
        19 004637   100000 721100                    LXL1    0,,PR1
        19 004640   004644 601000 19                 TNZ     s:13851

  13848 19 004641   000003 236000 20                 LDQ     3
        19 004642   200021 756100                    STQ     TEMP$,,AUTO
        19 004643   004650 710000 19                 TRA     s:13854

  13851 19 004644   200021 236100                    LDQ     TEMP$,,AUTO
        19 004645   200030 756100                    STQ     ENTRY_LINOI$,,AUTO

  13852 19 004646   000002 236100                    LDQ     2,,PR0
        19 004647   200021 756100                    STQ     TEMP$,,AUTO

  13854 19 004650   000003 116000 20                 CMPQ    3
        19 004651   004617 601000 19                 TNZ     s:13837

      668    13857
      669    13858    4              IF CURRENT_ENTRY$ ~= ADDR(NIL) THEN

  13858 19 004652   200020 236100                    LDQ     CURRENT_ENTRY$,,AUTO
        19 004653   000003 116000 20                 CMPQ    3
        19 004654   005411 600000 19                 TZE     NEXT_LBL

      670    13859    5                DO;

      671    13860    5                  TEMP$ = CURRENT_ENTRY$;

  13860 19 004655   200021 756100                    STQ     TEMP$,,AUTO

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:147  
      672    13861    6                  DO WHILE (TEMP$ ~= ADDR(NIL) AND

  13861 19 004656   004662 710000 19                 TRA     s:13865

      673    13862    6                            TEMP$ -> ILS.ILL$ ~= ADDR(NIL) AND
      674    13863    6                            TEMP$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB);
      675    13864    6                    TEMP$ = TEMP$ -> ILS.NEXT;

  13864 19 004657   200021 470500                    LDP0    TEMP$,,AUTO
        19 004660   000002 236100                    LDQ     2,,PR0
        19 004661   200021 756100                    STQ     TEMP$,,AUTO

      676    13865    6                  END;

  13865 19 004662   000003 116000 20                 CMPQ    3
        19 004663   004674 600000 19                 TZE     s:13867
        19 004664   200021 470500                    LDP0    TEMP$,,AUTO
        19 004665   000003 236100                    LDQ     3,,PR0
        19 004666   000003 116000 20                 CMPQ    3
        19 004667   004674 600000 19                 TZE     s:13867
        19 004670   000003 471500                    LDP1    3,,PR0
        19 004671   100000 220100                    LDX0    0,,PR1
        19 004672   000346 100003                    CMPX0   230,DU
        19 004673   004657 601000 19                 TNZ     s:13864

      677    13866
      678    13867    5                  ENTRY_LABEL$ = TEMP$;

  13867 19 004674   200021 236100                    LDQ     TEMP$,,AUTO
        19 004675   200031 756100                    STQ     ENTRY_LABEL$,,AUTO

      679    13868
      680    13869    5                  IF ENTRY_LINOI$ -> ILS.ILL$ -> ILL.ID ~= %LINOI THEN

  13869 19 004676   200030 470500                    LDP0    ENTRY_LINOI$,,AUTO
        19 004677   000003 471500                    LDP1    3,,PR0
        19 004700   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:148  
        19 004701   000373 100003                    CMPX0   251,DU
        19 004702   004741 600000 19                 TZE     s:13891

      681    13870    6                    DO;

      682    13871                           %FIND_LINE_NO (@START_ITEM$ = CURRENT_ENTRY$);

  13873 19 004703   200020 236100                    LDQ     CURRENT_ENTRY$,,AUTO
        19 004704   000004 756000 11                 STQ     O2COM+4

  13874 19 004705   000004 471400 11                 LDP1    O2COM+4
        19 004706   100003 473500                    LDP3    3,,PR1
        19 004707   300000 220100                    LDX0    0,,PR3
        19 004710   000373 100003                    CMPX0   251,DU
        19 004711   004725 600000 19                 TZE     s:13883

  13878 19 004712   000004 470400 11                 LDP0    O2COM+4
        19 004713   000002 236100                    LDQ     2,,PR0
        19 004714   000004 756000 11                 STQ     O2COM+4

  13881 19 004715   000004 470400 11                 LDP0    O2COM+4
        19 004716   000003 236100                    LDQ     3,,PR0
        19 004717   000003 116000 20                 CMPQ    3
        19 004720   004712 600000 19                 TZE     s:13878

  13882 19 004721   000003 471500                    LDP1    3,,PR0
        19 004722   100000 220100                    LDX0    0,,PR1
        19 004723   000373 100003                    CMPX0   251,DU
        19 004724   004712 601000 19                 TNZ     s:13878

  13883 19 004725   000004 470400 11                 LDP0    O2COM+4
        19 004726   000003 471500                    LDP1    3,,PR0
        19 004727   100000 236100                    LDQ     0,,PR1
        19 004730   777777 376007                    ANQ     -1,DL
        19 004731   000133 756000 xsym               STQ     COMCOM+91

  13884 19 004732   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:149  
        19 004733   100002 236100                    LDQ     2,,PR1
        19 004734   777777 376007                    ANQ     -1,DL
        19 004735   000134 756000 xsym               STQ     COMCOM+92

      683    13887
      684    13888    6                      ENTRY_LINOI$ = O2COM.LINE_NO$ -> ILS.ILL$;

  13888 19 004736   000003 236100                    LDQ     3,,PR0
        19 004737   200030 756100                    STQ     ENTRY_LINOI$,,AUTO

      685    13889    6                    END;

  13889 19 004740   004743 710000 19                 TRA     s:13893

      686    13890    5                  ELSE
      687    13891    5                    ENTRY_LINOI$ = ENTRY_LINOI$ -> ILS.ILL$;

  13891 19 004741   000003 236100                    LDQ     3,,PR0
        19 004742   200030 756100                    STQ     ENTRY_LINOI$,,AUTO

      688    13892
      689    13893    5                  CALL GEN_ALTER_RESETS (CURRENT_PROC$,

  13893 19 004743   200026 630500                    EPPR0   CURRENT_ARRAY$,,AUTO
        19 004744   200040 450500                    STP0    TEMP_LABEL$+1,,AUTO
        19 004745   200017 631500                    EPPR1   RESET_SUB_TAIL$,,AUTO
        19 004746   200037 451500                    STP1    SUB_TAIL$+1,,AUTO
        19 004747   200016 633500                    EPPR3   RESET_SUB$,,AUTO
        19 004750   200036 453500                    STP3    SUB$+1,,AUTO
        19 004751   200014 634500                    EPPR4   CURRENT_PROC$,,AUTO
        19 004752   200035 454500                    STP4    SEG_LTS$+3,,AUTO
        19 004753   000003 701000 19                 TSX1    GEN_ALTER_RESETS
        19 004754   000000 011000                    NOP     0

      690    13894    5                                         RESET_SUB$,
      691    13895    5                                         RESET_SUB_TAIL$,
      692    13896    5                                         CURRENT_ARRAY$);
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:150  
      693    13897
      694    13898    5                  CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(0) = CURRENT_ENTRY$;

  13898 19 004755   200020 236100                    LDQ     CURRENT_ENTRY$,,AUTO
        19 004756   200026 470500                    LDP0    CURRENT_ARRAY$,,AUTO
        19 004757   000002 756100                    STQ     2,,PR0

      695    13899    5                  CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(1) = RESET_SUB_TAIL$;

  13899 19 004760   200017 236100                    LDQ     RESET_SUB_TAIL$,,AUTO
        19 004761   200026 470500                    LDP0    CURRENT_ARRAY$,,AUTO
        19 004762   000003 756100                    STQ     3,,PR0

      696    13900    5                  RESET_SUB_TAIL$ -> ILS.NEXT = CURRENT_ENTRY$ -> ILS.NEXT;

  13900 19 004763   200020 470500                    LDP0    CURRENT_ENTRY$,,AUTO
        19 004764   000002 236100                    LDQ     2,,PR0
        19 004765   200017 471500                    LDP1    RESET_SUB_TAIL$,,AUTO
        19 004766   100002 756100                    STQ     2,,PR1

      697    13901
      698    13902    5                  CURRENT_ENTRY$ -> ILS.NEXT = RESET_SUB$;

  13902 19 004767   200016 236100                    LDQ     RESET_SUB$,,AUTO
        19 004770   000002 756100                    STQ     2,,PR0

      699    13903    5                  TRA_END_LABEL$ = RESET_SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP;

  13903 19 004771   200017 471500                    LDP1    RESET_SUB_TAIL$,,AUTO
        19 004772   100003 473500                    LDP3    3,,PR1
        19 004773   300001 236100                    LDQ     1,,PR3
        19 004774   200015 756100                    STQ     TRA_END_LABEL$,,AUTO

      700    13904    5                END;

      701    13905    4            END;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:151  
  13905 19 004775   005411 710000 19                 TRA     NEXT_LBL

      702    13906
      703    13907    3        CASE (%DEFLB);

      704    13908
      705    13909    3            LAST_LABEL$ = ILS$;

  13909 19 004776   000000 236000 16                 LDQ     ILS$
        19 004777   200023 756100                    STQ     LAST_LABEL$,,AUTO

      706    13910
      707    13911             /* If next fall thru section is in a different independent
      708    13912                segment then refresh the alter switches then bring in the
      709    13913                overlayable segment, if it is a different fixed overlay
      710    13914                then bring in the overlay.
      711    13915             */
      712    13916
      713    13917    3            IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND

  13917 19 005000   100001 473500                    LDP3    1,,PR1
        19 005001   300000 220100                    LDX0    0,,PR3
        19 005002   000770 100003                    CMPX0   504,DU
        19 005003   005324 601000 19                 TNZ     s:14092
        19 005004   300007 236100                    LDQ     7,,PR3
        19 005005   000003 116000 20                 CMPQ    3
        19 005006   005324 600000 19                 TZE     s:14092

      714    13918    3               ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      715    13919    4              DO;

      716    13920    4                SEG_NO# = ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ->

  13920 19 005007   300007 474500                    LDP4    7,,PR3
        19 005010   400002 235100                    LDA     2,,PR4
        19 005011   200025 755100                    STA     SEG_NO#,,AUTO

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:152  
      717    13921    4                            SEGMENT_LTS.SEGMENT_NO#;
      718    13922    4                IF SEG_NO# >= COMCOM.SEG_LIMIT AND

  13922 19 005012   200025 236100                    LDQ     SEG_NO#,,AUTO
        19 005013   000502 116000 xsym               CMPQ    COMCOM+322
        19 005014   005276 604000 19                 TMI     s:14062
        19 005015   000003 236000 11                 LDQ     O2COM+3
        19 005016   000003 116000 20                 CMPQ    3
        19 005017   005276 600000 19                 TZE     s:14062
        19 005020   000003 475400 11                 LDP5    O2COM+3
        19 005021   500007 476500                    LDP6    7,,PR5
        19 005022   400002 236100                    LDQ     2,,PR4
        19 005023   600002 116100                    CMPQ    2,,PR6
        19 005024   005276 600000 19                 TZE     s:14062
        19 005025   300003 236100                    LDQ     3,,PR3
        19 005026   002000 316003                    CANQ    1024,DU
        19 005027   005276 600000 19                 TZE     s:14062

      719    13923    4                  O2COM.SECTION$ ~= ADDR(NIL) AND
      720    13924    4                  (ILL$ -> ILL.LOP -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      721    13925    4                  O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#) AND
      722    13926    4                  ILL$ -> DEFLB.LOP -> LABEL.B.FALL_THRU THEN
      723    13927    5                DO;

      724    13928
      725    13929    5                  IF SEG_NO# > %MAX_FIXED_SEG# THEN

  13929 19 005030   000061 115007                    CMPA    49,DL
        19 005031   005275 604400 19                 TMOZ    s:14060

      726    13930    6                    DO;

      727    13931    6                      CALL_LABEL$ = CURRENT_ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NO#)

  13931 19 005032   200026 477500                    LDP7    CURRENT_ARRAY$,,AUTO
        19 005033   700002 470505                    LDP0    2,AL,PR7
        19 005034   000007 236100                    LDQ     7,,PR0
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:153  
        19 005035   200024 756100                    STQ     CALL_LABEL$,,AUTO

      728    13932    6                               -> SEGMENT_LTS.SUB_LABEL$;
      729    13933    6                      IF CALL_LABEL$ ~= ADDR(NIL) THEN

  13933 19 005036   000003 116000 20                 CMPQ    3
        19 005037   005275 600000 19                 TZE     s:14060

      730    13934    7                        DO;

      731    13935
      732    13936                               %SET LISTMAC = '1'B;
      733    13937
      734    13938                               %CALL_REFRESH_SUB;
             13939    8      DO;

             13940    8        PREV_ILS$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$;

  13940 19 005040   300010 236100                    LDQ     8,,PR3
        19 005041   200027 756100                    STQ     PREV_ILS$,,AUTO

             13941             %FIND_LINE_NO (@START_ITEM$ = PREV_ILS$);
             13942    9          DO ;

             13943    9            O2COM.LINE_NO$ = @START_ITEM$ ;

  13943 19 005042   000004 756000 11                 STQ     O2COM+4

             13944   10            DO WHILE O2COM.LINE_NO$->ILS.ILL$->ILL.ID ~= %LINOI ;

  13944 19 005043   000004 470400 11                 LDP0    O2COM+4
        19 005044   000003 473500                    LDP3    3,,PR0
        19 005045   300000 220100                    LDX0    0,,PR3
        19 005046   000373 100003                    CMPX0   251,DU
        19 005047   005063 600000 19                 TZE     s:13953

             13945   11              DO UNTIL O2COM.LINE_NO$->ILS.ILL$ ~= ADDR(NIL) ;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:154  

             13946                     %NEXT_ILS (POINTER=O2COM.LINE_NO$) ;
             13947   12          DO ; /* Next ILS entry in the ILS chain */

             13948   12            POINTER = POINTER->ILS.NEXT ;

  13948 19 005050   000004 470400 11                 LDP0    O2COM+4
        19 005051   000002 236100                    LDQ     2,,PR0
        19 005052   000004 756000 11                 STQ     O2COM+4

             13949   12          END ;

             13951   11              END ;

  13951 19 005053   000004 470400 11                 LDP0    O2COM+4
        19 005054   000003 236100                    LDQ     3,,PR0
        19 005055   000003 116000 20                 CMPQ    3
        19 005056   005050 600000 19                 TZE     s:13948

             13952   10            END ;

  13952 19 005057   000003 471500                    LDP1    3,,PR0
        19 005060   100000 220100                    LDX0    0,,PR1
        19 005061   000373 100003                    CMPX0   251,DU
        19 005062   005050 601000 19                 TNZ     s:13948

             13953    9            COMCOM.CURRENT.LINE = O2COM.LINE_NO$->ILS.ILL$->LINOI.PREV_LINE ;

  13953 19 005063   000003 471500                    LDP1    3,,PR0
        19 005064   100000 236100                    LDQ     0,,PR1
        19 005065   777777 376007                    ANQ     -1,DL
        19 005066   000133 756000 xsym               STQ     COMCOM+91

             13954    9            COMCOM.CURRENT.COLUMN = O2COM.LINE_NO$->ILS.ILL$->LINOI.PREV_COL ;

  13954 19 005067   000003 471500                    LDP1    3,,PR0
        19 005070   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:155  
        19 005071   777777 376007                    ANQ     -1,DL
        19 005072   000134 756000 xsym               STQ     COMCOM+92

             13955    9          END ;

             13957             %RESERVE_ILS (ITEM = %OPN,
             13958                           POINTER = TEMP$);
             13959    9          DO ;

             13960                 %IF VARIABLE ;
             13968                 %ELSE ;
             13969                   %IF ITEM % = %OPN;
             13970                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             13971                   %ELSEIF ITEM = %OPV
             13977                   %ENDIF;
             13978    9              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR

  13978 19 005073   000002 236000 17                 LDQ     ILS_+2
        19 005074   000004 036007                    ADLQ    4,DL
        19 005075   000003 116000 17                 CMPQ    ILS_+3
        19 005076   005107 602000 19                 TNC     s:13980

             13979    9              THEN CALL Z8AR$RESERVER(ADDR(ILS_));

  13979 19 005077   000005 236000 20                 LDQ     5
        19 005100   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 005101   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 005102   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 005103   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 005104   000004 631400 20                 EPPR1   4
        19 005105   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 005106   000000 011000                    NOP     0

             13980    9              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;

  13980 19 005107   000002 236000 17                 LDQ     ILS_+2
        19 005110   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:156  
        19 005111   000001 036000 17                 ADLQ    ILS_+1
        19 005112   200021 756100                    STQ     TEMP$,,AUTO

             13981    9              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;

  13981 19 005113   000002 235000 17                 LDA     ILS_+2
        19 005114   000004 035007                    ADLA    4,DL
        19 005115   000002 755000 17                 STA     ILS_+2

             13982    9              POINTER->ILS.ID = ITEM % ;

  13982 19 005116   000740 220003                    LDX0    480,DU
        19 005117   200021 470500                    LDP0    TEMP$,,AUTO
        19 005120   000000 740100                    STX0    0,,PR0

             13983    9              POINTER->ILS.NEXT = ADDR(NIL);

  13983 19 005121   000003 236000 20                 LDQ     3
        19 005122   000002 756100                    STQ     2,,PR0

             13984                 %ENDIF ;
             13985    9          END ;

             13987             %RESERVE_ILL (ITEM = %LINOI,
             13988                          POINTER = TEMP$ -> ILS.ILL$);
             13989    9        DO;

             13990    9          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);

  13990 19 005123   000145 235000 xsym               LDA     ILL_STEP+101
        19 005124   000000 755000 0                  STA     ITERATION

             13991    9          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN

  13991 19 005125   000002 236000 15                 LDQ     ILL_+2
        19 005126   000000 036000 0                  ADLQ    ITERATION
        19 005127   000003 116000 15                 CMPQ    ILL_+3
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:157  
        19 005130   005141 604000 19                 TMI     s:13993

             13992    9            CALL Z8AR$RESERVER(ADDR(ILL_));

  13992 19 005131   000006 236000 20                 LDQ     6
        19 005132   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 005133   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 005134   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 005135   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 005136   000004 631400 20                 EPPR1   4
        19 005137   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 005140   000000 011000                    NOP     0

             13993    9          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);

  13993 19 005141   000002 236000 15                 LDQ     ILL_+2
        19 005142   000022 736000                    QLS     18
        19 005143   000001 036000 15                 ADLQ    ILL_+1
        19 005144   200021 470500                    LDP0    TEMP$,,AUTO
        19 005145   000003 756100                    STQ     3,,PR0

             13994    9          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;

  13994 19 005146   000002 236000 15                 LDQ     ILL_+2
        19 005147   000000 036000 0                  ADLQ    ITERATION
        19 005150   000002 756000 15                 STQ     ILL_+2

             13995    9          POINTER -> ILL.ID = ITEM %;

  13995 19 005151   000003 471500                    LDP1    3,,PR0
        19 005152   000373 220003                    LDX0    251,DU
        19 005153   100000 740100                    STX0    0,,PR1

             13996    9        END;

             13998    8        TEMP$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:158  
  13998 19 005154   000003 471500                    LDP1    3,,PR0
        19 005155   000004 473400 11                 LDP3    O2COM+4
        19 005156   300003 474500                    LDP4    3,,PR3
        19 005157   000100 100500                    MLR     fill='000'O
        19 005160   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        19 005161   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

             13999             %RESERVE_ILS (ITEM = %OPN,
             14000                           POINTER = TEMP$ -> ILS.NEXT);
             14001    9          DO ;

             14002                 %IF VARIABLE ;
             14010                 %ELSE ;
             14011                   %IF ITEM % = %OPN;
             14012                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             14013                   %ELSEIF ITEM = %OPV
             14019                   %ENDIF;
             14020    9              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR

  14020 19 005162   000002 236000 17                 LDQ     ILS_+2
        19 005163   000004 036007                    ADLQ    4,DL
        19 005164   000003 116000 17                 CMPQ    ILS_+3
        19 005165   005176 602000 19                 TNC     s:14022

             14021    9              THEN CALL Z8AR$RESERVER(ADDR(ILS_));

  14021 19 005166   000005 236000 20                 LDQ     5
        19 005167   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 005170   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 005171   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 005172   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 005173   000004 631400 20                 EPPR1   4
        19 005174   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 005175   000000 011000                    NOP     0

             14022    9              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:159  
  14022 19 005176   000002 236000 17                 LDQ     ILS_+2
        19 005177   000022 736000                    QLS     18
        19 005200   000001 036000 17                 ADLQ    ILS_+1
        19 005201   200021 470500                    LDP0    TEMP$,,AUTO
        19 005202   000002 756100                    STQ     2,,PR0

             14023    9              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;

  14023 19 005203   000002 235000 17                 LDA     ILS_+2
        19 005204   000004 035007                    ADLA    4,DL
        19 005205   000002 755000 17                 STA     ILS_+2

             14024    9              POINTER->ILS.ID = ITEM % ;

  14024 19 005206   000002 471500                    LDP1    2,,PR0
        19 005207   000740 220003                    LDX0    480,DU
        19 005210   100000 740100                    STX0    0,,PR1

             14025    9              POINTER->ILS.NEXT = ADDR(NIL);

  14025 19 005211   000002 471500                    LDP1    2,,PR0
        19 005212   000003 236000 20                 LDQ     3
        19 005213   100002 756100                    STQ     2,,PR1

             14026                 %ENDIF ;
             14027    9          END ;

             14029             %RESERVE_ILL (ITEM = %GO,
             14030                           POINTER = TEMP$ -> ILS.NEXT -> ILS.ILL$);
             14031    9        DO;

             14032    9          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);

  14032 19 005214   000116 235000 xsym               LDA     ILL_STEP+78
        19 005215   000000 755000 0                  STA     ITERATION

             14033    9          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:160  

  14033 19 005216   000002 236000 15                 LDQ     ILL_+2
        19 005217   000000 036000 0                  ADLQ    ITERATION
        19 005220   000003 116000 15                 CMPQ    ILL_+3
        19 005221   005232 604000 19                 TMI     s:14035

             14034    9            CALL Z8AR$RESERVER(ADDR(ILL_));

  14034 19 005222   000006 236000 20                 LDQ     6
        19 005223   200056 756100                    STQ     POINTER$$+2,,AUTO
        19 005224   200056 631500                    EPPR1   POINTER$$+2,,AUTO
        19 005225   200057 451500                    STP1    POINTER$$+3,,AUTO
        19 005226   200057 630500                    EPPR0   POINTER$$+3,,AUTO
        19 005227   000004 631400 20                 EPPR1   4
        19 005230   000000 701000 xent               TSX1    Z8AR$RESERVER
        19 005231   000000 011000                    NOP     0

             14035    9          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);

  14035 19 005232   200021 470500                    LDP0    TEMP$,,AUTO
        19 005233   000002 471500                    LDP1    2,,PR0
        19 005234   000002 236000 15                 LDQ     ILL_+2
        19 005235   000022 736000                    QLS     18
        19 005236   000001 036000 15                 ADLQ    ILL_+1
        19 005237   100003 756100                    STQ     3,,PR1

             14036    9          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;

  14036 19 005240   000002 236000 15                 LDQ     ILL_+2
        19 005241   000000 036000 0                  ADLQ    ITERATION
        19 005242   000002 756000 15                 STQ     ILL_+2

             14037    9          POINTER -> ILL.ID = ITEM %;

  14037 19 005243   000002 471500                    LDP1    2,,PR0
        19 005244   100003 473500                    LDP3    3,,PR1
        19 005245   000344 220003                    LDX0    228,DU
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:161  
        19 005246   300000 740100                    STX0    0,,PR3

             14038    9        END;

             14040    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.CODE = %GO_AND_SAVE_IC_IN_X1;

  14040 19 005247   000002 471500                    LDP1    2,,PR0
        19 005250   100003 473500                    LDP3    3,,PR1
        19 005251   000030 221003                    LDX1    24,DU
        19 005252   300000 441100                    SXL1    0,,PR3

             14041    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.LOP = CALL_LABEL$;

  14041 19 005253   000002 471500                    LDP1    2,,PR0
        19 005254   100003 473500                    LDP3    3,,PR1
        19 005255   200024 236100                    LDQ     CALL_LABEL$,,AUTO
        19 005256   300001 756100                    STQ     1,,PR3

             14042    8        TEMP$ -> ILS.NEXT -> ILS.ILL$ -> GO.ROP = ADDR(NIL);

  14042 19 005257   000002 471500                    LDP1    2,,PR0
        19 005260   100003 473500                    LDP3    3,,PR1
        19 005261   000003 236000 20                 LDQ     3
        19 005262   300002 756100                    STQ     2,,PR3

             14043    8        ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = TEMP$ -> ILS.NEXT;

  14043 19 005263   000000 471400 14                 LDP1    ILL$
        19 005264   100001 473500                    LDP3    1,,PR1
        19 005265   000002 236100                    LDQ     2,,PR0
        19 005266   300010 756100                    STQ     8,,PR3

             14044    8        TEMP$ -> ILS.NEXT -> ILS.NEXT = PREV_ILS$ -> ILS.NEXT;

  14044 19 005267   000002 473500                    LDP3    2,,PR0
        19 005270   200027 474500                    LDP4    PREV_ILS$,,AUTO
        19 005271   400002 236100                    LDQ     2,,PR4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:162  
        19 005272   300002 756100                    STQ     2,,PR3

             14045    8        PREV_ILS$ -> ILS.NEXT = TEMP$;

  14045 19 005273   200021 236100                    LDQ     TEMP$,,AUTO
        19 005274   400002 756100                    STQ     2,,PR4

             14046    8      END;

      735    14048
      736    14049                               %SET LISTMAC = '0'B;
      737    14050
      738    14051    7                        END;

      739    14052    6                    END;

      740    14053
      741    14054                       %OVERLAY_FALL_THRU;

      742    14059
      743    14060    5                END;

  14060 19 005275   005321 710000 19                 TRA     s:14089

      744    14061    4              ELSE
      745    14062    4                IF O2COM.SECTION$ = ADDR(NIL) AND

  14062 19 005276   000003 236000 11                 LDQ     O2COM+3
        19 005277   000003 116000 20                 CMPQ    3
        19 005300   005305 601000 19                 TNZ     s:14070
        19 005301   200025 236100                    LDQ     SEG_NO#,,AUTO
        19 005302   000502 116000 xsym               CMPQ    COMCOM+322
        19 005303   005305 604000 19                 TMI     s:14070

      746    14063    4                  SEG_NO# >= COMCOM.SEG_LIMIT THEN
      747    14064                       %OVERLAY_FALL_THRU;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:163  
  14067 19 005304   005321 710000 19                 TRA     s:14089

      748    14069    4                ELSE
      749    14070    4                  IF O2COM.SECTION$ ~= ADDR(NIL) AND

  14070 19 005305   000003 236000 11                 LDQ     O2COM+3
        19 005306   000003 116000 20                 CMPQ    3
        19 005307   005321 600000 19                 TZE     s:14089
        19 005310   000003 475400 11                 LDP5    O2COM+3
        19 005311   500007 476500                    LDP6    7,,PR5
        19 005312   600002 236100                    LDQ     2,,PR6
        19 005313   000502 116000 xsym               CMPQ    COMCOM+322
        19 005314   005321 604000 19                 TMI     s:14089

      750    14071    4                    O2COM.SECTION$ -> SECTION.SEGMENT$ ->
      751    14072    4                      SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      752    14073    5                    DO;

      753    14074    5                      IF SEG_NO# < COMCOM.SEG_LIMIT THEN

  14074 19 005315   200025 236100                    LDQ     SEG_NO#,,AUTO
        19 005316   000502 116000 xsym               CMPQ    COMCOM+322
        19 005317   005321 605000 19                 TPL     s:14089

      754    14075                             %GOTO_FIXED_SEGMENT;

      755    14080    5                    END;

  14080 19 005320   005321 710000 19                 TRA     s:14089

      756    14081    4                  ELSE
      757    14082                         %GOTO_DIFFERENT_SEGMENT;

      758    14087
      759    14088
      760    14089    4                O2COM.SECTION$ = ILL$ -> ILL.LOP;

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:164  
  14089 19 005321   100001 236100                    LDQ     1,,PR1
        19 005322   000003 756000 11                 STQ     O2COM+3

      761    14090    4              END;

  14090 19 005323   005411 710000 19                 TRA     NEXT_LBL

      762    14091    3            ELSE
      763    14092    3              IF  ILL$ -> ILL.LOP -> LABEL.POINTER$ ~= ADDR(NIL) THEN

  14092 19 005324   300005 236100                    LDQ     5,,PR3
        19 005325   000003 116000 20                 CMPQ    3
        19 005326   005411 600000 19                 TZE     NEXT_LBL

      764    14093    4                DO;

      765    14094                         /* this is the altered GO TO statement */
      766    14095
      767    14096    4                  CALL OVERLAY_RESET;

  14096 19 005327   002417 701000 19                 TSX1    OVERLAY_RESET
        19 005330   000000 011000                    NOP     0

      768    14097
      769    14098    4                END;

  14098 19 005331   005411 710000 19                 TRA     NEXT_LBL

      770    14099
      771    14100
      772    14101    3        CASE (%ENTRY);

      773    14102
      774    14103                /*  Do nothing here  */
      775    14104
      776    14105    3        CASE (%GO);

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:165  
      777    14106
      778    14107    3          IF ILL$ -> GO.CODE = %GO_ALTERED OR

  14107 19 005332   100000 720100                    LXL0    0,,PR1
        19 005333   000020 100003                    CMPX0   16,DU
        19 005334   005411 600000 19                 TZE     NEXT_LBL
        19 005335   100001 236100                    LDQ     1,,PR1
        19 005336   000003 116000 20                 CMPQ    3
        19 005337   005411 600000 19                 TZE     NEXT_LBL
        19 005340   100001 473500                    LDP3    1,,PR1
        19 005341   300003 236100                    LDQ     3,,PR3
        19 005342   100000 316003                    CANQ    32768,DU
        19 005343   005411 601000 19                 TNZ     NEXT_LBL

      779    14108    3            ILL$ -> GO.LOP = ADDR(NIL) OR
      780    14109    3            ILL$ -> GO.LOP -> LABEL.B.COMPILER_CREATED THEN
      781    14110    3              EXIT CASE_STATEMENT;
      782    14111
      783    14112    3          SEG_LTS$ = ADDR(NIL);

  14112 19 005344   000003 236000 20                 LDQ     3
        19 005345   200032 756100                    STQ     SEG_LTS$,,AUTO

      784    14113    3          IF ILL$ -> GO.LOP -> LABEL.ID = %SECTION THEN

  14113 19 005346   300000 221100                    LDX1    0,,PR3
        19 005347   000770 101003                    CMPX1   504,DU
        19 005350   005354 601000 19                 TNZ     s:14116

      785    14114    3            SEG_LTS$ = ILL$ -> GO.LOP -> SECTION.SEGMENT$;

  14114 19 005351   300007 236100                    LDQ     7,,PR3
        19 005352   200032 756100                    STQ     SEG_LTS$,,AUTO
        19 005353   005364 710000 19                 TRA     s:14120

      786    14115    3          ELSE
      787    14116    3            IF ILL$ -> GO.LOP -> LABEL.ID = %PARA AND
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:166  

  14116 19 005354   000771 101003                    CMPX1   505,DU
        19 005355   005364 601000 19                 TNZ     s:14120
        19 005356   300007 236100                    LDQ     7,,PR3
        19 005357   000003 116000 20                 CMPQ    3
        19 005360   005364 600000 19                 TZE     s:14120

      788    14117    3              ILL$ -> GO.LOP -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      789    14118    3              SEG_LTS$ = ILL$ -> GO.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$;

  14118 19 005361   300007 474500                    LDP4    7,,PR3
        19 005362   400007 236100                    LDQ     7,,PR4
        19 005363   200032 756100                    STQ     SEG_LTS$,,AUTO

      790    14119
      791    14120    3            IF SEG_LTS$ ~= ADDR(NIL) AND

  14120 19 005364   200032 236100                    LDQ     SEG_LTS$,,AUTO
        19 005365   000003 116000 20                 CMPQ    3
        19 005366   005411 600000 19                 TZE     NEXT_LBL
        19 005367   200032 474500                    LDP4    SEG_LTS$,,AUTO
        19 005370   400002 236100                    LDQ     2,,PR4
        19 005371   000502 116000 xsym               CMPQ    COMCOM+322
        19 005372   005411 604000 19                 TMI     NEXT_LBL

      792    14121    3              SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      793    14122    4              DO;

      794    14123    4                IF O2COM.SECTION$ -> SECTION.SEGMENT$ = ADDR(NIL) OR

  14123 19 005373   000003 475400 11                 LDP5    O2COM+3
        19 005374   500007 236100                    LDQ     7,,PR5
        19 005375   000003 116000 20                 CMPQ    3
        19 005376   005403 600000 19                 TZE     s:14127
        19 005377   500007 476500                    LDP6    7,,PR5
        19 005400   600002 236100                    LDQ     2,,PR6
        19 005401   400002 116100                    CMPQ    2,,PR4
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:167  
        19 005402   005411 600000 19                 TZE     NEXT_LBL

      795    14124    4                  O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      796    14125    4                  SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      797    14126    5                  DO;

      798    14127    5                    CALL GO_SEG_SUB (SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#);

  14127 19 005403   200032 236100                    LDQ     SEG_LTS$,,AUTO
        19 005404   000002 036003                    ADLQ    2,DU
        19 005405   200035 756100                    STQ     SEG_LTS$+3,,AUTO
        19 005406   001526 701000 19                 TSX1    GO_SEG_SUB
        19 005407   000000 011000                    NOP     0

      799    14128    5                  END;

      800    14129    4              END;

  14129 19 005410   005411 710000 19                 TRA     NEXT_LBL

      801    14130    3            ELSE
      802    14131                   %CHECK_VIRTUAL_SIMPLE_GO;

      803    14136
      804    14137    3      END; /* DO CASE */

      805    14138
      806    14139    2    NEXT_LBL:
      807    14140    2      ILS$ = ILS$ -> ILS.ILL$ -> ILL.BRANCH$;

  14140 19 005411   000000 470400 16    NEXT_LBL     LDP0    ILS$
        19 005412   000003 471500                    LDP1    3,,PR0
        19 005413   100003 236100                    LDQ     3,,PR1
        19 005414   000000 756000 16                 STQ     ILS$

      808    14141
      809    14142    2    END; /* DO WHILE */
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:168  

  14142 19 005415   000000 236000 16                 LDQ     ILS$
        19 005416   000003 116000 20                 CMPQ    3
        19 005417   004465 601000 19                 TNZ     s:13816

      810    14143
      811    14144    1    END Z8FJ$SEGMENT_SUBS;

  14144 19 005420   000000 702200 xent               TSX2  ! X66_ARET
      812    14145         %EJECT;
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:169  

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:170  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FJ$SEGMENT_SUBS.
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:171  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:172  
  ****  Section 005 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 006 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAD_ETT$

  ****  Section 007 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 008 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ETT_

  ****  Section 009 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 010 LblCom LTS_

PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:173  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 011 LblCom O2COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 O2COM

  ****  Section 012 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 013 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 014 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 015 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:174  

     0-0-0/w STRC(180)   r     1 ILL_

  ****  Section 016 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 017 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILS_

  ****  Section 018 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    40-0-0/w PTR         r     1 @ARRAY$                   35-0-0/w PTR         r     1 @PROC$
    35-0-0/w PTR         r     1 @SEG_NUM                  36-0-0/w PTR         r     1 @SUB$
    37-0-0/w PTR         r     1 @SUB_TAIL$                44-0-0/w PTR         r     1 ALTER_LTS$
    *0-0-0/w PTR         r     1 ARRAY$                    24-0-0/w PTR         r     1 CALL_LABEL$
    42-0-0/w PTR         r     1 CALL_LABEL$               53-0-0/w PTR         r     1 CALL_LABEL$
    26-0-0/w PTR         r     1 CURRENT_ARRAY$            20-0-0/w PTR         r     1 CURRENT_ENTRY$
    14-0-0/w PTR         r     1 CURRENT_PROC$             31-0-0/w PTR         r     1 ENTRY_LABEL$
    30-0-0/w PTR         r     1 ENTRY_LINOI$              52-0-0/w PTR               1 ETT$$
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:175  
    43-0-0/b BIT         r     1 GENERATE_CODE             51-0-0/w PTR         r     1 GO_LABEL$
    45-0-0/w PTR         r     1 HEAD_LTS$                 43-0-0/w SBIN        r     1 I
    45-0-0/w PTR         r     1 INIT_SUB$                 41-0-0/w PTR         r     1 LABEL_END$
    44-0-0/w PTR               1 LABEL_END$                40-0-0/w PTR               1 LABEL_END$
    42-0-0/w PTR         r     1 LABEL_USE$                42-0-0/w PTR         r     1 LABEL_USE$
    23-0-0/w PTR         r     1 LAST_LABEL$               46-0-0/w PTR         r     1 LAST_SUB$
    41-0-0/w PTR         r     1 LTS$$                      3-0-0/w STRC(324)         1 NAME
    37-0-0/w PTR         r     1 NEW_LABEL$                36-0-0/w PTR               1 OLD_LABEL$
    54-0-0/w PTR         r     1 POINTER$$                 27-0-0/w PTR         r     1 PREV_ILS$
    45-0-0/w PTR         r     1 PREV_ILS_NEXT$            46-0-0/w PTR         r     1 PREV_ILS_NEXT$
    *0-0-0/w PTR         r     1 PROC$                     16-0-0/w PTR         r     1 RESET_SUB$
    17-0-0/w PTR         r     1 RESET_SUB_TAIL$           32-0-0/w PTR         r     1 SEG_LTS$
    44-0-0/w PTR         r     1 SEG_LTS$                  25-0-0/w SBIN        r     1 SEG_NO#
    *0-0-0/w SBIN        r     1 SEG_NUM                   *0-0-0/w PTR         r     1 SUB$
    40-0-0/w PTR               1 SUB$                      35-0-0/w PTR               1 SUB$
    22-0-0/w PTR               1 SUB_TAIL$                 *0-0-0/w PTR         r     1 SUB_TAIL$
    41-0-0/w PTR         r     1 SUB_TAIL$                 36-0-0/w PTR         r     1 SUB_TAIL$
    21-0-0/w PTR         r     1 TEMP$                     43-0-0/w PTR         r     1 TEMP$
    37-0-0/w PTR         r     1 TEMP_LABEL$               15-0-0/w PTR         r     1 TRA_END_LABEL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)   r     1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:176  
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w STRC(288)         1 BASE_LTS
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(216)         1 CCOSU                      0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(144)   r     1 DEFLB
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)   r     1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(144)   r     1 GO                         0-0-0/w STRC(180)   r     1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)   r     1 ILS
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)   r     1 LABEL
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(108)   r     1 LINOI
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC              1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(144)   r     1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)         1 PREOFF                     0-0-0/w STRC(108)         1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)   r     1 PROC_SUPP
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(216)         1 REF
PL6.E3A0      #001=Z8FJ$SEGMENT_SUBS File=Z8FJ.:Z8A6TSI                          SAT 08/09/97 13:06 Page:177  
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)   r     1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)   r     1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)   r     1 SEGMENT_LTS
     0-0-0/w STRC(396)         1 ST                         0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN


   Procedure Z8FJ$SEGMENT_SUBS requires 2833 words for executable code.
   Procedure Z8FJ$SEGMENT_SUBS requires 50 words of local(AUTO) storage.

    No errors detected in file Z8FJ.:Z8A6TSI    .
