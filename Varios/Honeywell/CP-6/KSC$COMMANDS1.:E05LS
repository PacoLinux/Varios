VERSION E05

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:1    
        1        1        /*M* KSC$COMMANDS - COMMAND DRIVER FOR NETCON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        KSC$COMMANDS: PROC(TOP$);
        9        9        /* INCLUDE FILES */
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE XU_MACRO_C;
       12     3197        %INCLUDE B_ERRORS_C;
       13     4324        %INCLUDE F$DCB;
       14     4373        %INCLUDE B$JIT;
       15     4663        %INCLUDE KL_CONFIG_M;
       16     5425        %INCLUDE KL_MACRO_C;
       17     8777        %INCLUDE KS_MACRO_M;
       18     8974        %INCLUDE KS_SUBS_C;
       19     9217        %INCLUDE KS_DATA_R;
       20     9232        %INCLUDE KS_PERR_C;
       21     9299        %KS$BOX(TITLE="parameters",SPACEVALUE=2,PAGE=NO);

              9317    1   /***************************************************************************
              9318    1    *                                                                         *
              9319    1    *                                 parameters                              *
              9320    1    *                                                                         *
              9321    1    ***************************************************************************/

       22     9326    1   DCL TOP$ PTR;
       23     9327        %KS$BOX(TITLE="entry defs");

              9345    1   /***************************************************************************
              9346    1    *                                                                         *
              9347    1    *                                 entry defs                              *
              9348    1    *                                                                         *
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:2    
              9349    1    ***************************************************************************/

       24     9354    1   DCL KSC$SET ENTRY(1) ALTRET;
       25     9355    1   DCL KSC$DISPLAY ENTRY(1) ALTRET;
       26     9356    1   DCL KSC$DELETE ENTRY(1) ALTRET;
       27     9357    1   DCL KSC$DEFINE ENTRY(1) ALTRET;
       28     9358    1   DCL KSE$ERRMSG ENTRY(4);
       29     9359    1   DCL KSC$LINCNFG ENTRY(1);
       30     9360    1   DCL KSC$PART ENTRY(1);
       31     9361    1   DCL KFF$FEBOOT ENTRY(4) ALTRET;
       32     9362    1   DCL KSC$UPDATE ENTRY(1) ALTRET;
       33     9363    1   DCL KFF$STARTHANDLERS ENTRY(1) ALTRET;
       34     9364        %KS$BOX(TITLE="symref");

              9382    1   /***************************************************************************
              9383    1    *                                                                         *
              9384    1    *                                   symref                                *
              9385    1    *                                                                         *
              9386    1    ***************************************************************************/

       35     9391        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=SYMREF);
       36     9418        %FPT_FECTL (FPTN=FPT_FEBOOT,STCLASS=SYMREF);
       37     9433        %KS$BOX(TITLE="static");

              9451    1   /***************************************************************************
              9452    1    *                                                                         *
              9453    1    *                                   static                                *
              9454    1    *                                                                         *
              9455    1    ***************************************************************************/

       38     9460    1   DCL 1 PROMPT  SYMREF,
       39     9461    1       2 NODENAME CHAR(8),
       40     9462    1       2 STAR CHAR(2);
       41     9463        %FPT_READ (FPTN=READ_NETWORK,KEYS=YES,DCB=M$NETCON,KEY=KS_NETWORK_KEY,BUF=KS_NETWORK
              9463            );
       42     9502        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
       43     9519        %KS$BOX(TITLE="based");
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:3    

              9537    1   /***************************************************************************
              9538    1    *                                                                         *
              9539    1    *                                   based                                 *
              9540    1    *                                                                         *
              9541    1    ***************************************************************************/

       44     9546        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       45     9591        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       46     9629        %KS$BOX(TITLE="auto variables");

              9647    1   /***************************************************************************
              9648    1    *                                                                         *
              9649    1    *                               auto variables                            *
              9650    1    *                                                                         *
              9651    1    ***************************************************************************/

       47     9656    1   DCL B$JIT$ PTR SYMREF;
       48     9657    1   DCL CODE UBIN;
       49     9658    1   DCL I UBIN;
       50     9659    1   DCL FEX UBIN;
       51     9660    1   DCL FEPNAME CHAR(8);
       52     9661    1   DCL FEPNODE SBIN;
       53     9662    1   DCL M$NETCON DCB;
       54     9663    1   DCL TEMP UBIN WORD;
       55     9664    1   DCL TEMPNAME CHAR(8);
       56     9665    2        DO CASE(OUT$BLK.CODE);
       57     9666    2           CASE(0);  /* MULTIPLE COMMANDS */
       58     9667    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;
       59     9668    3                 CALL KSC$COMMANDS(OUT$BLK.SUBLK$(I));
       60     9669    3                 END;  /* DO I */
       61     9670    2           CASE(%KS_SELECT);
       62     9671    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;
       63     9672    4              DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
       64     9673    4                 CASE(%KS_NODE);
       65     9674    4                 CALL GET_NODE(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0));
       66     9675    4                 KS_NODENAME = FEPNAME;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:4    
       67     9676    4                 KS_NODE = FEPNODE;
       68     9677    4                 PROMPT.NODENAME = KS_NODENAME;
       69     9678    4                 CASE(%KS_HANDLER);
       70     9679    4                    KS_HNDLRINDX = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
       71     9680    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
       72     9681    5                    DO CASE (CODE);
       73     9682    5                       CASE ( %KS_HAND_NODEADMIN );
       74     9683    5                          KS_HNDLRNAME = 'NODEADMN';
       75     9684    5                       CASE ( %KS_HAND_COUPLER ) ;
       76     9685    5                          KS_HNDLRNAME = 'COUPLER';
       77     9686    5                       CASE ( %KS_HAND_ASYNC );
       78     9687    5                          KS_HNDLRNAME = 'ASYNC';
       79     9688    5                       CASE ( %KS_HAND_BISYNC );
       80     9689    5                          KS_HNDLRNAME = 'BISYNC';
       81     9690    5                       CASE ( %KS_HAND_UNITREC );
       82     9691    5                          KS_HNDLRNAME = 'UNITREC';
       83     9692    5                       CASE ( %KS_HAND_HDLCX25 );
       84     9693    5                          KS_HNDLRNAME = 'HDLCX25';
       85     9694    5                       CASE ( ELSE );
       86     9695    5                          KS_HNDLRNAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.
              9695                                   TEXT;
       87     9696    5                    END;   /* case on handler name  */
       88     9697    4                 CASE(%KS_PARAMOPTS);
       89     9698    4                    KS_SELPRMOPT = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE;
       90     9699    4                 END;  /* DO CASE */
       91     9700    3              END;
       92     9701    2           CASE(%KS_SET);
       93     9702    2              CALL KSC$SET(TOP$);
       94     9703    2              UNWIND TO KS_ERR_RETURN;   /* multiple commands not allowed
       95     9704                                                 on set command */
       96     9705    2           CASE(%KS_DISPLAY);
       97     9706    2              CALL KSC$DISPLAY(TOP$);
       98     9707    2           CASE(%KS_DEFINE);
       99     9708    2              CALL KSC$DEFINE(OUT$BLK.SUBLK$(0));
      100     9709    2           CASE(%KS_BOOT);
      101     9710    2              CALL GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)) ALTRET(ERR);
      102     9711    2              FPT_FEBOOT.V.NOTIME# = '0'B;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:5    
      103     9712    2              CALL KFF$FEBOOT(FEPNODE);
      104     9713
      105     9714    2           CASE(%KS_STARTHANDLERS);
      106     9715    2              FEPNODE = KS_NODE;
      107     9716    2              CALL KFF$STARTHANDLERS(FEPNODE);
      108     9717    2            CASE(%KS_BOOT_NOTIME);
      109     9718    2              CALL GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)) ALTRET(ERR);
      110     9719    2              FPT_FEBOOT.V.NOTIME# = '1'B;
      111     9720    2              CALL KFF$FEBOOT(FEPNODE);
      112     9721    2           CASE(%KS_LINCNFG);
      113     9722    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
      114     9723    3                 DO;
      115     9724    3                 CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)
              9724                          );
      116     9725    3                 KS_NODE_SV = KS_NODE;
      117     9726    3                 KS_NODENAME_SV = KS_NODENAME;
      118     9727    3                 KS_NODE = FEPNODE;
      119     9728    3                 KS_NODENAME = FEPNAME;
      120     9729    3                 END;
      121     9730    2              CALL KSC$LINCNFG(OUT$BLK.SUBLK$(0));
      122     9731    2           CASE(%KS_PART);
      123     9732    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
      124     9733    3                 DO;
      125     9734    3                 CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));
      126     9735    3                 KS_NODE_SV = KS_NODE;
      127     9736    3                 KS_NODENAME_SV = KS_NODENAME;
      128     9737    3                 KS_NODE = FEPNODE;
      129     9738    3                 KS_NODENAME = FEPNAME;
      130     9739    3                 CALL KSC$PART(TOP$);
      131     9740    3                 END;
      132     9741    2              ELSE
      133     9742    2                 CALL KSC$PART(TOP$);
      134     9743    2           CASE(%KS_RET);
      135     9744    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
      136     9745    3                 DO;
      137     9746    3                 CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));
      138     9747    3                 KS_NODE_SV = KS_NODE;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:6    
      139     9748    3                 KS_NODENAME_SV = KS_NODENAME;
      140     9749    3                 KS_NODE = FEPNODE;
      141     9750    3                 KS_NODENAME = FEPNAME;
      142     9751    3                 CALL KSC$PART(TOP$);
      143     9752    3                 END;
      144     9753    2              ELSE
      145     9754    2                 CALL KSC$PART(TOP$);
      146     9755    2           CASE(%KS_DELETE);
      147     9756    2              CALL KSC$DELETE(OUT$BLK.SUBLK$(0));
      148     9757    2           CASE(%KS_UPDATE);
      149     9758    2              CALL KSC$UPDATE(TOP$);
      150     9759    2           CASE(%KS_END);
      151     9760    2              KS_END_FLG = '1'B;
      152     9761    2           CASE(%KS_NULL);
      153     9762    2           END;  /* DO CASE */
      154     9763    1        IF KS_NODENAME_SV ~= ' '
      155     9764    2           THEN DO;
      156     9765    2              KS_NODENAME = KS_NODENAME_SV;
      157     9766    2              KS_NODE = KS_NODE_SV;
      158     9767    2              KS_NODENAME_SV = ' ';
      159     9768    2              END;
      160     9769    1   ERR:;
      161     9770    1        RETURN;
      162     9771        %EJECT;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:7    
      163     9772    1   GET_NODE: PROC(PTR$) ALTRET;
      164     9773    2           DCL PTR$ PTR;
      165     9774
      166     9775    2           CALL M$READ(READ_NETWORK);
      167     9776
      168     9777    3           DO CASE(PTR$->OUT$BLK.CODE);
      169     9778
      170     9779    3            CASE (%KS_TEXTVAL);
      171     9780    3              FEPNAME = PTR$->OUT$SYM.TEXT;
      172     9781    3              FEPNODE = -1;
      173     9782    4              DO I = 0 TO KS_NETWORK.NODE#;
      174     9783    4                 IF FEPNAME = KS_NETWORK.NODE.NODE(I)
      175     9784    4                 THEN
      176     9785    4                    FEPNODE = I;
      177     9786    4                 END;
      178     9787
      179     9788    3            CASE (%KS_DECVAL);
      180     9789    3              CALL CHARBIN(FEPNODE,PTR$->OUT$SYM.TEXT);
      181     9790    3              IF FEPNODE <= KS_NETWORK.NODE#
      182     9791    3              THEN
      183     9792    3                 FEPNAME = KS_NETWORK.NODE.NODE(FEPNODE);
      184     9793
      185     9794    3            END;
      186     9795    2           IF FEPNODE = -1 OR FEPNODE > KS_NETWORK.NODE# OR
      187     9796    2              FEPNAME = ' ' THEN
      188     9797    3              DO;
      189     9798    3              FEPNAME = KS_NODENAME;
      190     9799    3              FEPNODE = KS_NODE;
      191     9800    3              CALL KSE$ERRMSG(%E$KS_BAD_SELECT);
      192     9801                      /*E* ERROR: KSN-E$KS_BAD_SELECT-0
      193     9802                           MESSAGE: Illegal node selected.
      194     9803                           MESSAGE1: The node selected is not valid, use
      195     9804                                     the DI NETWORK commands to see currently
      196     9805                                     defined network, or use the DEFINE command
      197     9806                                     to define a new node
      198     9807                          DESCRIPTION: SEE MESSAGE*/
      199     9808    3              ALTRETURN;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:8    
      200     9809    3              END;
      201     9810
      202     9811    2           RETURN;
      203     9812
      204     9813    2   END GET_NODE;
      205     9814    1   END KSC$COMMANDS;
      206     9815        %EOD;

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:9    
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$COMMANDS.

   Procedure KSC$COMMANDS requires 387 words for executable code.
   Procedure KSC$COMMANDS requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:10   

 Object Unit name= KSC$COMMANDS                               File name= KSC$COMMANDS1.:E05TOU
 UTS= JUL 30 '97 01:41:43.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    15     17  KSC$COMMANDS
    2   DCB   even  none     0      0  M$NETCON
    3  RoData even  UTS     12     14  KSC$COMMANDS
    4   Proc  even  none   387    603  KSC$COMMANDS
    5  RoData even  none     3      3  KSC$COMMANDS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  KSC$COMMANDS
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:11   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KSC$SET
 yes     yes           Std       1 KFF$STARTHANDLERS
 yes     yes           Std       1 KSC$DISPLAY
 yes     yes           Std       1 KSC$DEFINE
         yes           Std       1 KSC$PART
 yes     yes           Std       1 KSC$UPDATE
 yes     yes           Std       4 KFF$FEBOOT
         yes           Std       1 KSC$LINCNFG
 yes     yes           Std       1 KSC$DELETE
         yes           Std       4 KSE$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_SELPRMOPT                          KS_NODE                               KS_NODENAME_SV
     KS_NODE_SV                            KS_HNDLRNAME                          KS_HNDLRINDX
     KS_END_FLG                            KS_ERR_RETURN                         KS_MSGBUF$
     KS_NETWORK                            FPT_FEBOOT                            PROMPT
     B$JIT$                                M$NETCON                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:12   


        1        1        /*M* KSC$COMMANDS - COMMAND DRIVER FOR NETCON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        KSC$COMMANDS: PROC(TOP$);

      8  4 000000   000000 700200 xent  KSC$COMMANDS TSX0  ! X66_AUTO_1
         4 000001   000022 000001                    ZERO    18,1

        9        9        /* INCLUDE FILES */
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE XU_MACRO_C;
       12     3197        %INCLUDE B_ERRORS_C;
       13     4324        %INCLUDE F$DCB;
       14     4373        %INCLUDE B$JIT;
       15     4663        %INCLUDE KL_CONFIG_M;
       16     5425        %INCLUDE KL_MACRO_C;
       17     8777        %INCLUDE KS_MACRO_M;
       18     8974        %INCLUDE KS_SUBS_C;
       19     9217        %INCLUDE KS_DATA_R;
       20     9232        %INCLUDE KS_PERR_C;
       21     9299        %KS$BOX(TITLE="parameters",SPACEVALUE=2,PAGE=NO);

              9317    1   /***************************************************************************
              9318    1    *                                                                         *
              9319    1    *                                 parameters                              *
              9320    1    *                                                                         *
              9321    1    ***************************************************************************/

       22     9326    1   DCL TOP$ PTR;
       23     9327        %KS$BOX(TITLE="entry defs");
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:13   

              9345    1   /***************************************************************************
              9346    1    *                                                                         *
              9347    1    *                                 entry defs                              *
              9348    1    *                                                                         *
              9349    1    ***************************************************************************/

       24     9354    1   DCL KSC$SET ENTRY(1) ALTRET;
       25     9355    1   DCL KSC$DISPLAY ENTRY(1) ALTRET;
       26     9356    1   DCL KSC$DELETE ENTRY(1) ALTRET;
       27     9357    1   DCL KSC$DEFINE ENTRY(1) ALTRET;
       28     9358    1   DCL KSE$ERRMSG ENTRY(4);
       29     9359    1   DCL KSC$LINCNFG ENTRY(1);
       30     9360    1   DCL KSC$PART ENTRY(1);
       31     9361    1   DCL KFF$FEBOOT ENTRY(4) ALTRET;
       32     9362    1   DCL KSC$UPDATE ENTRY(1) ALTRET;
       33     9363    1   DCL KFF$STARTHANDLERS ENTRY(1) ALTRET;
       34     9364        %KS$BOX(TITLE="symref");

              9382    1   /***************************************************************************
              9383    1    *                                                                         *
              9384    1    *                                   symref                                *
              9385    1    *                                                                         *
              9386    1    ***************************************************************************/

       35     9391        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=SYMREF);
       36     9418        %FPT_FECTL (FPTN=FPT_FEBOOT,STCLASS=SYMREF);
       37     9433        %KS$BOX(TITLE="static");

              9451    1   /***************************************************************************
              9452    1    *                                                                         *
              9453    1    *                                   static                                *
              9454    1    *                                                                         *
              9455    1    ***************************************************************************/

       38     9460    1   DCL 1 PROMPT  SYMREF,
       39     9461    1       2 NODENAME CHAR(8),
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:14   
       40     9462    1       2 STAR CHAR(2);
       41     9463       %FPT_READ (FPTN=READ_NETWORK,KEYS=YES,DCB=M$NETCON,KEY=KS_NETWORK_KEY,BUF=KS_NETWORK
              9463            );
       42     9502        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
       43     9519        %KS$BOX(TITLE="based");

              9537    1   /***************************************************************************
              9538    1    *                                                                         *
              9539    1    *                                   based                                 *
              9540    1    *                                                                         *
              9541    1    ***************************************************************************/

       44     9546        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       45     9591        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       46     9629        %KS$BOX(TITLE="auto variables");

              9647    1   /***************************************************************************
              9648    1    *                                                                         *
              9649    1    *                               auto variables                            *
              9650    1    *                                                                         *
              9651    1    ***************************************************************************/

       47     9656    1   DCL B$JIT$ PTR SYMREF;
       48     9657    1   DCL CODE UBIN;
       49     9658    1   DCL I UBIN;
       50     9659    1   DCL FEX UBIN;
       51     9660    1   DCL FEPNAME CHAR(8);
       52     9661    1   DCL FEPNODE SBIN;
       53     9662    1   DCL M$NETCON DCB;
       54     9663    1   DCL TEMP UBIN WORD;
       55     9664    1   DCL TEMPNAME CHAR(8);
       56     9665    2        DO CASE(OUT$BLK.CODE);

   9665  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000021 100003                    CMPX0   17,DU
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:15   
         4 000006   000010 602010 4                  TNC     s:9665+6,X0
         4 000007   000451 710000 4                  TRA     s:9763
         4 000010   000031 710000 4                  TRA     s:9667
         4 000011   000057 710000 4                  TRA     s:9671
         4 000012   000216 710000 4                  TRA     s:9702
         4 000013   000225 710000 4                  TRA     s:9706
         4 000014   000232 710000 4                  TRA     s:9708
         4 000015   000241 710000 4                  TRA     s:9710
         4 000016   000451 710000 4                  TRA     s:9763
         4 000017   000306 710000 4                  TRA     s:9722
         4 000020   000342 710000 4                  TRA     s:9732
         4 000021   000376 710000 4                  TRA     s:9744
         4 000022   000432 710000 4                  TRA     s:9756
         4 000023   000451 710000 4                  TRA     s:9763
         4 000024   000446 710000 4                  TRA     s:9760
         4 000025   000451 710000 4                  TRA     s:9763
         4 000026   000270 710000 4                  TRA     s:9718
         4 000027   000441 710000 4                  TRA     s:9758
         4 000030   000257 710000 4                  TRA     s:9715

       57     9666    2           CASE(0);  /* MULTIPLE COMMANDS */

       58     9667    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   9667  4 000031   200005 450100                    STZ     I,,AUTO
         4 000032   000047 710000 4                  TRA     s:9669+3

       59     9668    3                 CALL KSC$COMMANDS(OUT$BLK.SUBLK$(I));

   9668  4 000033   200003 470500                    LDP0    @TOP$,,AUTO
         4 000034   000000 471500                    LDP1    0,,PR0
         4 000035   200005 720100                    LXL0    I,,AUTO
         4 000036   100003 633510                    EPPR3   3,X0,PR1
         4 000037   200020 453500                    STP3    @PTR$+1,,AUTO
         4 000040   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000042   000000 701000 4                  TSX1    s:8
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:16   
         4 000043   000000 011000                    NOP     0

       60     9669    3                 END;  /* DO I */

   9669  4 000044   200005 235100                    LDA     I,,AUTO
         4 000045   000001 035007                    ADLA    1,DL
         4 000046   200005 755100                    STA     I,,AUTO
         4 000047   200003 470500                    LDP0    @TOP$,,AUTO
         4 000050   000000 471500                    LDP1    0,,PR0
         4 000051   100001 236100                    LDQ     1,,PR1
         4 000052   000022 772000                    QRL     18
         4 000053   200005 116100                    CMPQ    I,,AUTO
         4 000054   000056 600000 4                  TZE     s:9669+10
         4 000055   000033 603000 4                  TRC     s:9668
         4 000056   000451 710000 4                  TRA     s:9763

       61     9670    2           CASE(%KS_SELECT);

       62     9671    3              DO I = 0 TO OUT$BLK.NSUBLKS - 1;

   9671  4 000057   200005 450100                    STZ     I,,AUTO
         4 000060   000206 710000 4                  TRA     s:9700+3

       63     9672    4              DO CASE(OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

   9672  4 000061   200003 470500                    LDP0    @TOP$,,AUTO
         4 000062   000000 471500                    LDP1    0,,PR0
         4 000063   200005 720100                    LXL0    I,,AUTO
         4 000064   100003 473510                    LDP3    3,X0,PR1
         4 000065   300000 721100                    LXL1    0,,PR3
         4 000066   000004 101003                    CMPX1   4,DU
         4 000067   000071 602011 4                  TNC     s:9672+8,X1
         4 000070   000203 710000 4                  TRA     s:9700
         4 000071   000203 710000 4                  TRA     s:9700
         4 000072   000075 710000 4                  TRA     s:9674
         4 000073   000112 710000 4                  TRA     s:9679
         4 000074   000176 710000 4                  TRA     s:9698
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:17   

       64     9673    4                 CASE(%KS_NODE);

       65     9674    4                 CALL GET_NODE(OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0));

   9674  4 000075   300003 634500                    EPPR4   3,,PR3
         4 000076   200017 454500                    STP4    FEPNODE+6,,AUTO
         4 000077   000467 701000 4                  TSX1    GET_NODE
         4 000100   000000 011000                    NOP     0

       66     9675    4                 KS_NODENAME = FEPNAME;

   9675  4 000101   040000 100500                    MLR     fill='040'O
         4 000102   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000103   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

       67     9676    4                 KS_NODE = FEPNODE;

   9676  4 000104   200011 235100                    LDA     FEPNODE,,AUTO
         4 000105   000000 755000 xsym               STA     KS_NODE

       68     9677    4                 PROMPT.NODENAME = KS_NODENAME;

   9677  4 000106   040000 100400                    MLR     fill='040'O
         4 000107   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000110   000000 000010 xsym               ADSC9   PROMPT                   cn=0,n=8
         4 000111   000203 710000 4                  TRA     s:9700

       69     9678    4                 CASE(%KS_HANDLER);

       70     9679    4                    KS_HNDLRINDX = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   9679  4 000112   300003 474500                    LDP4    3,,PR3
         4 000113   400000 236100                    LDQ     0,,PR4
         4 000114   777777 376007                    ANQ     -1,DL
         4 000115   000033 736000                    QLS     27
         4 000116   000000 756000 xsym               STQ     KS_HNDLRINDX
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:18   

       71     9680    4                    CODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   9680  4 000117   000000 471500                    LDP1    0,,PR0
         4 000120   100003 473510                    LDP3    3,X0,PR1
         4 000121   300003 474500                    LDP4    3,,PR3
         4 000122   400000 236100                    LDQ     0,,PR4
         4 000123   777777 376007                    ANQ     -1,DL
         4 000124   200004 756100                    STQ     CODE,,AUTO

       72     9681    5                    DO CASE (CODE);

   9681  4 000125   000007 116007                    CMPQ    7,DL
         4 000126   000130 602006 4                  TNC     s:9681+3,QL
         4 000127   000167 710000 4                  TRA     s:9695
         4 000130   000167 710000 4                  TRA     s:9695
         4 000131   000147 710000 4                  TRA     s:9687
         4 000132   000153 710000 4                  TRA     s:9689
         4 000133   000143 710000 4                  TRA     s:9685
         4 000134   000163 710000 4                  TRA     s:9693
         4 000135   000137 710000 4                  TRA     s:9683
         4 000136   000157 710000 4                  TRA     s:9691

       73     9682    5                       CASE ( %KS_HAND_NODEADMIN );

       74     9683    5                          KS_HNDLRNAME = 'NODEADMN';

   9683  4 000137   000000 237000 3                  LDAQ    0
         4 000140   000000 755000 xsym               STA     KS_HNDLRNAME
         4 000141   000001 756000 xsym               STQ     KS_HNDLRNAME+1
         4 000142   000203 710000 4                  TRA     s:9700

       75     9684    5                       CASE ( %KS_HAND_COUPLER ) ;

       76     9685    5                          KS_HNDLRNAME = 'COUPLER';

   9685  4 000143   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:19   
         4 000144   000002 000007 3                  ADSC9   2                        cn=0,n=7
         4 000145   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000146   000203 710000 4                  TRA     s:9700

       77     9686    5                       CASE ( %KS_HAND_ASYNC );

       78     9687    5                          KS_HNDLRNAME = 'ASYNC';

   9687  4 000147   040000 100400                    MLR     fill='040'O
         4 000150   000004 000005 3                  ADSC9   4                        cn=0,n=5
         4 000151   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000152   000203 710000 4                  TRA     s:9700

       79     9688    5                       CASE ( %KS_HAND_BISYNC );

       80     9689    5                          KS_HNDLRNAME = 'BISYNC';

   9689  4 000153   040000 100400                    MLR     fill='040'O
         4 000154   000006 000006 3                  ADSC9   6                        cn=0,n=6
         4 000155   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000156   000203 710000 4                  TRA     s:9700

       81     9690    5                       CASE ( %KS_HAND_UNITREC );

       82     9691    5                          KS_HNDLRNAME = 'UNITREC';

   9691  4 000157   040000 100400                    MLR     fill='040'O
         4 000160   000010 000007 3                  ADSC9   8                        cn=0,n=7
         4 000161   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000162   000203 710000 4                  TRA     s:9700

       83     9692    5                       CASE ( %KS_HAND_HDLCX25 );

       84     9693    5                          KS_HNDLRNAME = 'HDLCX25';

   9693  4 000163   040000 100400                    MLR     fill='040'O
         4 000164   000012 000007 3                  ADSC9   10                       cn=0,n=7
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:20   
         4 000165   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000166   000203 710000 4                  TRA     s:9700

       85     9694    5                       CASE ( ELSE );

       86     9695    5                         KS_HNDLRNAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.
              9695                                   TEXT;

   9695  4 000167   400004 236100                    LDQ     4,,PR4
         4 000170   000033 772000                    QRL     27
         4 000171   000000 621006                    EAX1    0,QL
         4 000172   040000 100540                    MLR     fill='040'O
         4 000173   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         4 000174   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8

       87     9696    5                    END;   /* case on handler name  */

   9696  4 000175   000203 710000 4                  TRA     s:9700

       88     9697    4                 CASE(%KS_PARAMOPTS);

       89     9698    4                    KS_SELPRMOPT = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE;

   9698  4 000176   300003 474500                    LDP4    3,,PR3
         4 000177   400000 236100                    LDQ     0,,PR4
         4 000200   777777 376007                    ANQ     -1,DL
         4 000201   000033 736000                    QLS     27
         4 000202   000000 756000 xsym               STQ     KS_SELPRMOPT

       90     9699    4                 END;  /* DO CASE */

       91     9700    3              END;

   9700  4 000203   200005 235100                    LDA     I,,AUTO
         4 000204   000001 035007                    ADLA    1,DL
         4 000205   200005 755100                    STA     I,,AUTO
         4 000206   200003 470500                    LDP0    @TOP$,,AUTO
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:21   
         4 000207   000000 471500                    LDP1    0,,PR0
         4 000210   100001 236100                    LDQ     1,,PR1
         4 000211   000022 772000                    QRL     18
         4 000212   200005 116100                    CMPQ    I,,AUTO
         4 000213   000215 600000 4                  TZE     s:9700+10
         4 000214   000061 603000 4                  TRC     s:9672
         4 000215   000451 710000 4                  TRA     s:9763

       92     9701    2           CASE(%KS_SET);

       93     9702    2              CALL KSC$SET(TOP$);

   9702  4 000216   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000217   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000220   000000 701000 xent               TSX1    KSC$SET
         4 000221   000000 011000                    NOP     0

       94     9703    2              UNWIND TO KS_ERR_RETURN;   /* multiple commands not allowed

   9703  4 000222   000000 237200 xsym               LDAQ  ! KS_ERR_RETURN
         4 000223   000000 700200 xent               TSX0  ! X66_AUNWIND
         4 000224   000000 000200                    ZERO    0,128

       95     9704                                                 on set command */
       96     9705    2           CASE(%KS_DISPLAY);

       97     9706    2              CALL KSC$DISPLAY(TOP$);

   9706  4 000225   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000227   000000 701000 xent               TSX1    KSC$DISPLAY
         4 000230   000000 011000                    NOP     0
         4 000231   000451 710000 4                  TRA     s:9763

       98     9707    2           CASE(%KS_DEFINE);

       99     9708    2              CALL KSC$DEFINE(OUT$BLK.SUBLK$(0));
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:22   

   9708  4 000232   100003 633500                    EPPR3   3,,PR1
         4 000233   200020 453500                    STP3    @PTR$+1,,AUTO
         4 000234   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000235   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000236   000000 701000 xent               TSX1    KSC$DEFINE
         4 000237   000000 011000                    NOP     0
         4 000240   000451 710000 4                  TRA     s:9763

      100     9709    2           CASE(%KS_BOOT);

      101     9710    2              CALL GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)) ALTRET(ERR);

   9710  4 000241   100003 473500                    LDP3    3,,PR1
         4 000242   300003 634500                    EPPR4   3,,PR3
         4 000243   200017 454500                    STP4    FEPNODE+6,,AUTO
         4 000244   000467 701000 4                  TSX1    GET_NODE
         4 000245   000466 702000 4                  TSX2    ERR

      102     9711    2              FPT_FEBOOT.V.NOTIME# = '0'B;

   9711  4 000246   000000 236000 5                  LDQ     0
         4 000247   000010 356000 xsym               ANSQ    FPT_FEBOOT+8

      103     9712    2              CALL KFF$FEBOOT(FEPNODE);

   9712  4 000250   200011 630500                    EPPR0   FEPNODE,,AUTO
         4 000251   200020 450500                    STP0    @PTR$+1,,AUTO
         4 000252   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000253   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000254   000000 701000 xent               TSX1    KFF$FEBOOT
         4 000255   000000 011000                    NOP     0
         4 000256   000451 710000 4                  TRA     s:9763

      104     9713
      105     9714    2           CASE(%KS_STARTHANDLERS);

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:23   
      106     9715    2              FEPNODE = KS_NODE;

   9715  4 000257   000000 235000 xsym               LDA     KS_NODE
         4 000260   200011 755100                    STA     FEPNODE,,AUTO

      107     9716    2              CALL KFF$STARTHANDLERS(FEPNODE);

   9716  4 000261   200011 631500                    EPPR1   FEPNODE,,AUTO
         4 000262   200020 451500                    STP1    @PTR$+1,,AUTO
         4 000263   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000265   000000 701000 xent               TSX1    KFF$STARTHANDLERS
         4 000266   000000 011000                    NOP     0
         4 000267   000451 710000 4                  TRA     s:9763

      108     9717    2            CASE(%KS_BOOT_NOTIME);

      109     9718    2              CALL GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)) ALTRET(ERR);

   9718  4 000270   100003 473500                    LDP3    3,,PR1
         4 000271   300003 634500                    EPPR4   3,,PR3
         4 000272   200017 454500                    STP4    FEPNODE+6,,AUTO
         4 000273   000467 701000 4                  TSX1    GET_NODE
         4 000274   000466 702000 4                  TSX2    ERR

      110     9719    2              FPT_FEBOOT.V.NOTIME# = '1'B;

   9719  4 000275   020000 236003                    LDQ     8192,DU
         4 000276   000010 256000 xsym               ORSQ    FPT_FEBOOT+8

      111     9720    2              CALL KFF$FEBOOT(FEPNODE);

   9720  4 000277   200011 630500                    EPPR0   FEPNODE,,AUTO
         4 000300   200020 450500                    STP0    @PTR$+1,,AUTO
         4 000301   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000303   000000 701000 xent               TSX1    KFF$FEBOOT
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:24   
         4 000304   000000 011000                    NOP     0
         4 000305   000451 710000 4                  TRA     s:9763

      112     9721    2           CASE(%KS_LINCNFG);

      113     9722    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

   9722  4 000306   100003 473500                    LDP3    3,,PR1
         4 000307   300003 474500                    LDP4    3,,PR3
         4 000310   400000 721100                    LXL1    0,,PR4
         4 000311   000001 101003                    CMPX1   1,DU
         4 000312   000331 601000 4                  TNZ     s:9730

      114     9723    3                 DO;

      115     9724    3                CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)
              9724                          );

   9724  4 000313   400003 635500                    EPPR5   3,,PR4
         4 000314   200017 455500                    STP5    FEPNODE+6,,AUTO
         4 000315   000467 701000 4                  TSX1    GET_NODE
         4 000316   000000 011000                    NOP     0

      116     9725    3                 KS_NODE_SV = KS_NODE;

   9725  4 000317   000000 235000 xsym               LDA     KS_NODE
         4 000320   000000 755000 xsym               STA     KS_NODE_SV

      117     9726    3                 KS_NODENAME_SV = KS_NODENAME;

   9726  4 000321   040000 100400                    MLR     fill='040'O
         4 000322   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000323   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

      118     9727    3                 KS_NODE = FEPNODE;

   9727  4 000324   200011 236100                    LDQ     FEPNODE,,AUTO
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:25   
         4 000325   000000 756000 xsym               STQ     KS_NODE

      119     9728    3                 KS_NODENAME = FEPNAME;

   9728  4 000326   040000 100500                    MLR     fill='040'O
         4 000327   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000330   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      120     9729    3                 END;

      121     9730    2              CALL KSC$LINCNFG(OUT$BLK.SUBLK$(0));

   9730  4 000331   200003 470500                    LDP0    @TOP$,,AUTO
         4 000332   000000 471500                    LDP1    0,,PR0
         4 000333   100003 633500                    EPPR3   3,,PR1
         4 000334   200020 453500                    STP3    @PTR$+1,,AUTO
         4 000335   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000337   000000 701000 xent               TSX1    KSC$LINCNFG
         4 000340   000000 011000                    NOP     0
         4 000341   000451 710000 4                  TRA     s:9763

      122     9731    2           CASE(%KS_PART);

      123     9732    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

   9732  4 000342   100003 473500                    LDP3    3,,PR1
         4 000343   300000 721100                    LXL1    0,,PR3
         4 000344   000001 101003                    CMPX1   1,DU
         4 000345   000371 601000 4                  TNZ     s:9742

      124     9733    3                 DO;

      125     9734    3                 CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));

   9734  4 000346   300003 634500                    EPPR4   3,,PR3
         4 000347   200017 454500                    STP4    FEPNODE+6,,AUTO
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:26   
         4 000350   000467 701000 4                  TSX1    GET_NODE
         4 000351   000000 011000                    NOP     0

      126     9735    3                 KS_NODE_SV = KS_NODE;

   9735  4 000352   000000 235000 xsym               LDA     KS_NODE
         4 000353   000000 755000 xsym               STA     KS_NODE_SV

      127     9736    3                 KS_NODENAME_SV = KS_NODENAME;

   9736  4 000354   040000 100400                    MLR     fill='040'O
         4 000355   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000356   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

      128     9737    3                 KS_NODE = FEPNODE;

   9737  4 000357   200011 236100                    LDQ     FEPNODE,,AUTO
         4 000360   000000 756000 xsym               STQ     KS_NODE

      129     9738    3                 KS_NODENAME = FEPNAME;

   9738  4 000361   040000 100500                    MLR     fill='040'O
         4 000362   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000363   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      130     9739    3                 CALL KSC$PART(TOP$);

   9739  4 000364   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000366   000000 701000 xent               TSX1    KSC$PART
         4 000367   000000 011000                    NOP     0

      131     9740    3                 END;

   9740  4 000370   000451 710000 4                  TRA     s:9763

      132     9741    2              ELSE
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:27   
      133     9742    2                 CALL KSC$PART(TOP$);

   9742  4 000371   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000372   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000373   000000 701000 xent               TSX1    KSC$PART
         4 000374   000000 011000                    NOP     0
         4 000375   000451 710000 4                  TRA     s:9763

      134     9743    2           CASE(%KS_RET);

      135     9744    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

   9744  4 000376   100003 473500                    LDP3    3,,PR1
         4 000377   300000 721100                    LXL1    0,,PR3
         4 000400   000001 101003                    CMPX1   1,DU
         4 000401   000425 601000 4                  TNZ     s:9754

      136     9745    3                 DO;

      137     9746    3                 CALL GET_NODE (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));

   9746  4 000402   300003 634500                    EPPR4   3,,PR3
         4 000403   200017 454500                    STP4    FEPNODE+6,,AUTO
         4 000404   000467 701000 4                  TSX1    GET_NODE
         4 000405   000000 011000                    NOP     0

      138     9747    3                 KS_NODE_SV = KS_NODE;

   9747  4 000406   000000 235000 xsym               LDA     KS_NODE
         4 000407   000000 755000 xsym               STA     KS_NODE_SV

      139     9748    3                 KS_NODENAME_SV = KS_NODENAME;

   9748  4 000410   040000 100400                    MLR     fill='040'O
         4 000411   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000412   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:28   
      140     9749    3                 KS_NODE = FEPNODE;

   9749  4 000413   200011 236100                    LDQ     FEPNODE,,AUTO
         4 000414   000000 756000 xsym               STQ     KS_NODE

      141     9750    3                 KS_NODENAME = FEPNAME;

   9750  4 000415   040000 100500                    MLR     fill='040'O
         4 000416   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000417   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      142     9751    3                 CALL KSC$PART(TOP$);

   9751  4 000420   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000422   000000 701000 xent               TSX1    KSC$PART
         4 000423   000000 011000                    NOP     0

      143     9752    3                 END;

   9752  4 000424   000451 710000 4                  TRA     s:9763

      144     9753    2              ELSE
      145     9754    2                 CALL KSC$PART(TOP$);

   9754  4 000425   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000427   000000 701000 xent               TSX1    KSC$PART
         4 000430   000000 011000                    NOP     0
         4 000431   000451 710000 4                  TRA     s:9763

      146     9755    2           CASE(%KS_DELETE);

      147     9756    2              CALL KSC$DELETE(OUT$BLK.SUBLK$(0));

   9756  4 000432   100003 633500                    EPPR3   3,,PR1
         4 000433   200020 453500                    STP3    @PTR$+1,,AUTO
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:29   
         4 000434   200020 630500                    EPPR0   @PTR$+1,,AUTO
         4 000435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000436   000000 701000 xent               TSX1    KSC$DELETE
         4 000437   000000 011000                    NOP     0
         4 000440   000451 710000 4                  TRA     s:9763

      148     9757    2           CASE(%KS_UPDATE);

      149     9758    2              CALL KSC$UPDATE(TOP$);

   9758  4 000441   200003 630500                    EPPR0   @TOP$,,AUTO
         4 000442   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000443   000000 701000 xent               TSX1    KSC$UPDATE
         4 000444   000000 011000                    NOP     0
         4 000445   000451 710000 4                  TRA     s:9763

      150     9759    2           CASE(%KS_END);

      151     9760    2              KS_END_FLG = '1'B;

   9760  4 000446   400000 236003                    LDQ     -131072,DU
         4 000447   000000 756000 xsym               STQ     KS_END_FLG
         4 000450   000451 710000 4                  TRA     s:9763

      152     9761    2           CASE(%KS_NULL);

      153     9762    2           END;  /* DO CASE */

      154     9763    1        IF KS_NODENAME_SV ~= ' '

   9763  4 000451   040000 106400                    CMPC    fill='040'O
         4 000452   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8
         4 000453   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000454   000466 600000 4                  TZE     ERR

      155     9764    2           THEN DO;

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:30   
      156     9765    2              KS_NODENAME = KS_NODENAME_SV;

   9765  4 000455   040000 100400                    MLR     fill='040'O
         4 000456   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8
         4 000457   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      157     9766    2              KS_NODE = KS_NODE_SV;

   9766  4 000460   000000 235000 xsym               LDA     KS_NODE_SV
         4 000461   000000 755000 xsym               STA     KS_NODE

      158     9767    2              KS_NODENAME_SV = ' ';

   9767  4 000462   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000463   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000464   000000 755000 xsym               STA     KS_NODENAME_SV
         4 000465   000001 756000 xsym               STQ     KS_NODENAME_SV+1

      159     9768    2              END;

   9763  4 000466                       ERR          null
      160     9769    1   ERR:;
      161     9770    1        RETURN;

   9770  4 000466   000000 702200 xent               TSX2  ! X66_ARET

      162     9771        %EJECT;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:31   
      163     9772    1   GET_NODE: PROC(PTR$) ALTRET;

   9772  4 000467   200016 741300       GET_NODE     STX1  ! FEPNODE+5,,AUTO

      164     9773    2           DCL PTR$ PTR;
      165     9774
      166     9775    2           CALL M$READ(READ_NETWORK);

   9775  4 000470   000000 630400 1                  EPPR0   READ_NETWORK
         4 000471   040000 713400                    CLIMB   read
         4 000472   401400 401760                    pmme    nvectors=4

      167     9776
      168     9777    3           DO CASE(PTR$->OUT$BLK.CODE);

   9777  4 000473   200017 470500                    LDP0    @PTR$,,AUTO
         4 000474   000000 471500                    LDP1    0,,PR0
         4 000475   100000 720100                    LXL0    0,,PR1
         4 000476   000002 100003                    CMPX0   2,DU
         4 000477   000501 602010 4                  TNC     s:9777+6,X0
         4 000500   000553 710000 4                  TRA     s:9795
         4 000501   000503 710000 4                  TRA     s:9780
         4 000502   000534 710000 4                  TRA     s:9789

      169     9778
      170     9779    3            CASE (%KS_TEXTVAL);

      171     9780    3              FEPNAME = PTR$->OUT$SYM.TEXT;

   9780  4 000503   100004 236100                    LDQ     4,,PR1
         4 000504   000033 772000                    QRL     27
         4 000505   000000 621006                    EAX1    0,QL
         4 000506   040100 100540                    MLR     fill='040'O
         4 000507   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000510   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      172     9781    3              FEPNODE = -1;
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:32   

   9781  4 000511   000001 335007                    LCA     1,DL
         4 000512   200011 755100                    STA     FEPNODE,,AUTO

      173     9782    4              DO I = 0 TO KS_NETWORK.NODE#;

   9782  4 000513   200005 450100                    STZ     I,,AUTO
         4 000514   000530 710000 4                  TRA     s:9786+3

      174     9783    4                 IF FEPNAME = KS_NETWORK.NODE.NODE(I)

   9783  4 000515   200005 236100                    LDQ     I,,AUTO
         4 000516   000024 402007                    MPY     20,DL
         4 000517   040006 106500                    CMPC    fill='040'O
         4 000520   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000521   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000522   000525 601000 4                  TNZ     s:9786

      175     9784    4                 THEN
      176     9785    4                    FEPNODE = I;

   9785  4 000523   200005 235100                    LDA     I,,AUTO
         4 000524   200011 755100                    STA     FEPNODE,,AUTO

      177     9786    4                 END;

   9786  4 000525   200005 235100                    LDA     I,,AUTO
         4 000526   000001 035007                    ADLA    1,DL
         4 000527   200005 755100                    STA     I,,AUTO
         4 000530   000000 236000 xsym               LDQ     KS_NETWORK
         4 000531   200005 116100                    CMPQ    I,,AUTO
         4 000532   000515 603000 4                  TRC     s:9783
         4 000533   000553 710000 4                  TRA     s:9795

      178     9787
      179     9788    3            CASE (%KS_DECVAL);

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:33   
      180     9789    3              CALL CHARBIN(FEPNODE,PTR$->OUT$SYM.TEXT);

   9789  4 000534   100004 236100                    LDQ     4,,PR1
         4 000535   000033 772000                    QRL     27
         4 000536   000000 621006                    EAX1    0,QL
         4 000537   000100 305540                    DTB
         4 000540   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 000541   200011 000004                    NDSC9   FEPNODE,,AUTO            cn=0,s=lsgnf,sf=0,n=4

      181     9790    3              IF FEPNODE <= KS_NETWORK.NODE#

   9790  4 000542   000000 236000 xsym               LDQ     KS_NETWORK
         4 000543   000546 604000 4                  TMI     s:9792
         4 000544   200011 116100                    CMPQ    FEPNODE,,AUTO
         4 000545   000553 604000 4                  TMI     s:9795

      182     9791    3              THEN
      183     9792    3                 FEPNAME = KS_NETWORK.NODE.NODE(FEPNODE);

   9792  4 000546   200011 236100                    LDQ     FEPNODE,,AUTO
         4 000547   000024 402007                    MPY     20,DL
         4 000550   040100 100406                    MLR     fill='040'O
         4 000551   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000552   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      184     9793
      185     9794    3            END;

      186     9795    2           IF FEPNODE = -1 OR FEPNODE > KS_NETWORK.NODE# OR

   9795  4 000553   200011 235100                    LDA     FEPNODE,,AUTO
         4 000554   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000555   000566 600000 4                  TZE     s:9798
         4 000556   000000 236000 xsym               LDQ     KS_NETWORK
         4 000557   000562 604000 4                  TMI     s:9795+7
         4 000560   200011 116100                    CMPQ    FEPNODE,,AUTO
         4 000561   000566 604000 4                  TMI     s:9798
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:34   
         4 000562   040000 106500                    CMPC    fill='040'O
         4 000563   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000564   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000565   000601 601000 4                  TNZ     s:9811

      187     9796    2              FEPNAME = ' ' THEN
      188     9797    3              DO;

      189     9798    3              FEPNAME = KS_NODENAME;

   9798  4 000566   040100 100400                    MLR     fill='040'O
         4 000567   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000570   200007 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      190     9799    3              FEPNODE = KS_NODE;

   9799  4 000571   000000 236000 xsym               LDQ     KS_NODE
         4 000572   200011 756100                    STQ     FEPNODE,,AUTO

      191     9800    3              CALL KSE$ERRMSG(%E$KS_BAD_SELECT);

   9800  4 000573   000002 630400 5                  EPPR0   2
         4 000574   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000575   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000576   000000 011000                    NOP     0

      192     9801                      /*E* ERROR: KSN-E$KS_BAD_SELECT-0
      193     9802                           MESSAGE: Illegal node selected.
      194     9803                           MESSAGE1: The node selected is not valid, use
      195     9804                                     the DI NETWORK commands to see currently
      196     9805                                     defined network, or use the DEFINE command
      197     9806                                     to define a new node
      198     9807                          DESCRIPTION: SEE MESSAGE*/
      199     9808    3              ALTRETURN;

   9808  4 000577   200016 221300                    LDX1  ! FEPNODE+5,,AUTO
         4 000600   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:35   

      200     9809    3              END;
      201     9810
      202     9811    2           RETURN;

   9811  4 000601   200016 221300                    LDX1  ! FEPNODE+5,,AUTO
         4 000602   000001 702211                    TSX2  ! 1,X1
      203     9812
      204     9813    2   END GET_NODE;
      205     9814    1   END KSC$COMMANDS;
      206     9815        %EOD;

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:36   
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$COMMANDS.
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:37   

 **** Variables and constants ****

  ****  Section 001  Data  KSC$COMMANDS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w STRC(18)    r     1 KS_NETWORK_KEY             0-0-0/d STRC(504)   r     1 READ_NETWORK

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w PTR         r     1 @PTR$                      3-0-0/w PTR         r     1 @TOP$
     4-0-0/w UBIN        r     1 CODE                       7-0-0/c CHAR(8)     r     1 FEPNAME
    11-0-0/w SBIN        r     1 FEPNODE                    5-0-0/w UBIN        r     1 I
    *0-0-0/w PTR         r     1 PTR$                      *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/d STRC(360)   r     1 FPT_FEBOOT
     0-0-0/b BIT         r     1 KS_END_FLG                 0-0-0/d REMB        r     1 KS_ERR_RETURN
     0-0-0/w UBIN(9)     r     1 KS_HNDLRINDX               0-0-0/c CHAR(8)     r     1 KS_HNDLRNAME
     0-0-0/w PTR         r     1 KS_MSGBUF$                 0-0-0/w STRC(46116) r     1 KS_NETWORK
     0-0-0/w SBIN        r     1 KS_NODE                    0-0-0/c CHAR(8)     r     1 KS_NODENAME
     0-0-0/c CHAR(8)     r     1 KS_NODENAME_SV             0-0-0/w UBIN        r     1 KS_NODE_SV
     0-0-0/w UBIN(9)     r     1 KS_SELPRMOPT               0-0-0/c STRC(90)    r     1 PROMPT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:38   
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$NETCON
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure KSC$COMMANDS requires 387 words for executable code.
   Procedure KSC$COMMANDS requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:40   
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
      4481**DCL      4481--REDEF
B$JIT.ERR.MID
      4388**DCL      4388--REDEF
B$JIT.JRESPEAK
      4549**DCL      4550--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4658**DCL      4658--REDEF    4659--REDEF
B$JIT.PNR
      4562**DCL      4562--REDEF
B$JIT.TSLINE
      4656**DCL      4657--REDEF
B$JIT$
      9656**DCL      4382--IMP-PTR
CODE
      9657**DCL      9680<<ASSIGN   9681>>DOCASE
ERR
      9763**LABEL    9710--CALLALT  9718--CALLALT
F$DCB.ACTPOS
      4350**DCL      4350--REDEF
F$DCB.ARS
      4325**DCL      4325--REDEF
F$DCB.ATTR
      4343**DCL      4344--REDEF
F$DCB.BORROW
      4358**DCL      4358--REDEF    4358--REDEF    4358--REDEF
F$DCB.DCBNAME.L
      4372**DCL      4372--IMP-SIZ
F$DCB.EOMCHAR
      4329**DCL      4329--REDEF
F$DCB.FLDID
      4353**DCL      4353--REDEF
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:41   
F$DCB.FORM$
      4347**DCL      4347--REDEF
F$DCB.FSECT
      4363**DCL      4363--REDEF
F$DCB.FSN
      4340**DCL      4340--REDEF    4340--REDEF    4341--REDEF
F$DCB.HEADER$
      4346**DCL      4346--REDEF
F$DCB.IXTNSIZE
      4344**DCL      4344--REDEF
F$DCB.LASTSTA$
      4334**DCL      4334--REDEF
F$DCB.LVL
      4359**DCL      4359--REDEF
F$DCB.NAME.C
      4334**DCL      4334--REDEF
F$DCB.NOEOF
      4355**DCL      4355--REDEF
F$DCB.NRECS
      4345**DCL      4345--REDEF
F$DCB.NRECX
      4364**DCL      4364--REDEF
F$DCB.OHDR
      4356**DCL      4356--REDEF
F$DCB.ORG
      4339**DCL      4339--REDEF
F$DCB.PRECNO
      4362**DCL      4362--REDEF
F$DCB.RCSZ
      4367**DCL      4367--REDEF
F$DCB.RES
      4335**DCL      4335--REDEF
F$DCB.SETX
      4347**DCL      4347--REDEF
F$DCB.TAB$
      4346**DCL      4347--REDEF
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:42   
F$DCB.TDA
      4361**DCL      4361--REDEF
F$DCB.WSN
      4336**DCL      4336--REDEF
FEPNAME
      9660**DCL      9675>>ASSIGN   9728>>ASSIGN   9738>>ASSIGN   9750>>ASSIGN   9780<<ASSIGN   9783>>IF
      9792<<ASSIGN   9795>>IF       9798<<ASSIGN
FEPNODE
      9661**DCL      9676>>ASSIGN   9712<>CALL     9715<<ASSIGN   9716<>CALL     9720<>CALL     9727>>ASSIGN
      9737>>ASSIGN   9749>>ASSIGN   9781<<ASSIGN   9785<<ASSIGN   9789<<CALLBLT  9790>>IF       9792>>ASSIGN
      9795>>IF       9795>>IF       9799<<ASSIGN
FPT_FEBOOT.V.DMPSTART#
      9428**DCL      9429--REDEF
FPT_FEBOOT.V.NOTIME#
      9431**DCL      9711<<ASSIGN   9719<<ASSIGN
GET_NODE
      9772**PROC     9674--CALL     9710--CALL     9718--CALL     9724--CALL     9734--CALL     9746--CALL
I
      9658**DCL      9667<<DOINDEX  9668>>CALL     9671<<DOINDEX  9672>>DOCASE   9674>>CALL     9679>>ASSIGN
      9680>>ASSIGN   9695>>ASSIGN   9695>>ASSIGN   9698>>ASSIGN   9782<<DOINDEX  9783>>IF       9785>>ASSIGN
KFF$FEBOOT
      9361**DCL-ENT  9712--CALL     9720--CALL
KFF$STARTHANDLERS
      9363**DCL-ENT  9716--CALL
KSC$COMMANDS
         8**PROC     9668--CALL
KSC$DEFINE
      9357**DCL-ENT  9708--CALL
KSC$DELETE
      9356**DCL-ENT  9756--CALL
KSC$DISPLAY
      9355**DCL-ENT  9706--CALL
KSC$LINCNFG
      9359**DCL-ENT  9730--CALL
KSC$PART
      9360**DCL-ENT  9739--CALL     9742--CALL     9751--CALL     9754--CALL
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:43   
KSC$SET
      9354**DCL-ENT  9702--CALL
KSC$UPDATE
      9362**DCL-ENT  9758--CALL
KSE$ERRMSG
      9358**DCL-ENT  9800--CALL
KS_END_FLG
      9227**DCL      9760<<ASSIGN
KS_ERR_RETURN
      9228**DCL      9703>>UNWIND
KS_HNDLRINDX
      9227**DCL      9679<<ASSIGN
KS_HNDLRNAME
      9227**DCL      9683<<ASSIGN   9685<<ASSIGN   9687<<ASSIGN   9689<<ASSIGN   9691<<ASSIGN   9693<<ASSIGN
      9695<<ASSIGN
KS_MSGBUF$
      9229**DCL      9229--IMP-PTR
KS_MYSTATION
      9225**DCL      9225--REDEF
KS_NETWORK
      9404**DCL      9482--DCLINIT  9483--DCLINIT
KS_NETWORK.NODE.NODE
      9413**DCL      9783>>IF       9792>>ASSIGN
KS_NETWORK.NODE#
      9405**DCL      9782>>DOINDEX  9790>>IF       9795>>IF
KS_NETWORK_KEY
      9515**DCL      9480--DCLINIT  9481--DCLINIT
KS_NODE
      9226**DCL      9676<<ASSIGN   9715>>ASSIGN   9725>>ASSIGN   9727<<ASSIGN   9735>>ASSIGN   9737<<ASSIGN
      9747>>ASSIGN   9749<<ASSIGN   9766<<ASSIGN   9799>>ASSIGN
KS_NODENAME
      9225**DCL      9675<<ASSIGN   9677>>ASSIGN   9726>>ASSIGN   9728<<ASSIGN   9736>>ASSIGN   9738<<ASSIGN
      9748>>ASSIGN   9750<<ASSIGN   9765<<ASSIGN   9798>>ASSIGN
KS_NODENAME_SV
      9226**DCL      9726<<ASSIGN   9736<<ASSIGN   9748<<ASSIGN   9763>>IF       9765>>ASSIGN   9767<<ASSIGN
KS_NODE_SV
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:44   
      9226**DCL      9725<<ASSIGN   9735<<ASSIGN   9747<<ASSIGN   9766>>ASSIGN
KS_SELPRMOPT
      9226**DCL      9698<<ASSIGN
M$READ
        20**DCL-ENT  9775--CALL
OUT$BLK.CODE
      9560**DCL      9665>>DOCASE   9672>>DOCASE   9679>>ASSIGN   9680>>ASSIGN   9722>>IF       9732>>IF
      9744>>IF       9777>>DOCASE
OUT$BLK.NSUBLKS
      9564**DCL      9667>>DOINDEX  9671>>DOINDEX
OUT$BLK.SUBLK$
      9585**DCL      9668<>CALL     9672>>DOCASE   9674>>CALL     9674<>CALL     9679>>ASSIGN   9679>>ASSIGN
      9680>>ASSIGN   9680>>ASSIGN   9695>>ASSIGN   9695>>ASSIGN   9695>>ASSIGN   9695>>ASSIGN   9698>>ASSIGN
      9698>>ASSIGN   9708<>CALL     9710>>CALL     9710<>CALL     9718>>CALL     9718<>CALL     9722>>IF
      9722>>IF       9724>>CALL     9724>>CALL     9724<>CALL     9730<>CALL     9732>>IF       9734>>CALL
      9734<>CALL     9744>>IF       9746>>CALL     9746<>CALL     9756<>CALL
OUT$SYM.CODE
      9604**DCL      9698>>ASSIGN
OUT$SYM.COUNT
      9621**DCL      9624--IMP-SIZ  9695>>ASSIGN   9780>>ASSIGN   9789>>CALLBLT
OUT$SYM.TEXT
      9624**DCL      9695>>ASSIGN   9780>>ASSIGN   9789>>CALLBLT
PROMPT.NODENAME
      9461**DCL      9677<<ASSIGN
PTR$ IN PROCEDURE GET_NODE
      9773**DCL      9772--PROC     9777>>DOCASE   9780>>ASSIGN   9780>>ASSIGN   9789>>CALLBLT  9789>>CALLBLT
READ_NETWORK
      9480**DCL      9775<>CALL
READ_NETWORK.STATION_
      9483**DCL      9484--REDEF
READ_NETWORK.V
      9484**DCL      9480--DCLINIT
READ_NETWORK.V.DVBYTE.REREAD#
      9495**DCL      9495--REDEF
READ_NETWORK.V.INDX#
      9493**DCL      9493--REDEF
PL6.E3A0      #001=KSC$COMMANDS File=KSC$COMMANDS1.:E05TSI                       WED 07/30/97 01:41 Page:45   
TOP$
      9326**DCL         8--PROC     9552--IMP-PTR  9598--IMP-PTR  9665>>DOCASE   9667>>DOINDEX  9668>>CALL
      9671>>DOINDEX  9672>>DOCASE   9674>>CALL     9679>>ASSIGN   9680>>ASSIGN   9695>>ASSIGN   9695>>ASSIGN
      9698>>ASSIGN   9702<>CALL     9706<>CALL     9708>>CALL     9710>>CALL     9718>>CALL     9722>>IF
      9724>>CALL     9730>>CALL     9732>>IF       9734>>CALL     9739<>CALL     9742<>CALL     9744>>IF
      9746>>CALL     9751<>CALL     9754<>CALL     9756>>CALL     9758<>CALL

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:46   
      207        1        /*T***********************************************************/
      208        2        /*T*                                                         */
      209        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      210        4        /*T*                                                         */
      211        5        /*T***********************************************************/
      212        6        KSC$LINCNFG: PROC(TOP$);
      213        7        /**/
      214        8    1   DCL TOP$ PTR;
      215        9        /**/
      216       10        %INCLUDE CP_6;
      217       91        %INCLUDE CP_6_SUBS;
      218      631        %INCLUDE XU_MACRO_C;
      219     3737        %INCLUDE B_ERRORS_C;
      220     4864        %INCLUDE F$DCB;
      221     4913        %INCLUDE KHA_FNC_E;
      222     5013        %INCLUDE KL_AFCN_C;
      223     5114        %INCLUDE KL_MACRO_C;
      224     8466        %INCLUDE KL_CONFIG_M;
      225     9228        %INCLUDE KS_SUBS_C;
      226     9471        %INCLUDE KS_MACRO_M;
      227     9668        %INCLUDE KS_DATA_R;
      228     9683        %INCLUDE KS_PERR_C;
      229     9750        %KS$BOX(TITLE="entry defs");

              9768    1   /***************************************************************************
              9769    1    *                                                                         *
              9770    1    *                                 entry defs                              *
              9771    1    *                                                                         *
              9772    1    ***************************************************************************/

      230     9777    1   DCL KSE$ERRMSG ENTRY(4);
      231     9778    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
      232     9779    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      233     9780    1   DCL KSU$BLD_LINCNFG ENTRY(2) ALTRET;
      234     9781    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
      235     9782    1   DCL KSU$BLD_LINCNFG_DEF ENTRY(2) ALTRET;
      236     9783    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:47   
      237     9784    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
      238     9785    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      239     9786    1   DCL XUR$ERRCNVRT ENTRY(2);
      240     9787    1   DCL KSW$WRITE ENTRY(11);
      241     9788    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
      242     9789    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
      243     9790    1   DCL KSC$PART ENTRY(1);
      244     9791    1   DCL KSU$UNPACK ENTRY(2);
      245     9792    1   DCL KSU$PACK2 ENTRY(2);
      246     9793    1   DCL KSU$BINHEX ENTRY(2);
      247     9794    1   DCL KSU$BLD_TERMRANGE ENTRY(4) ALTRET;
      248     9795    1   DCL KSU$CHECK_FOR_FEP ENTRY(1) ALTRET;
      249     9796        /**/
      250     9797        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:48   
              9815    1   /***************************************************************************
              9816    1    *                                                                         *
              9817    1    *                               auto variables                            *
              9818    1    *                                                                         *
              9819    1    ***************************************************************************/

      251     9824    1   DCL ACTION_CMPLTED CHAR(21);
      252     9825    1   DCL CNFG_EXISTS BIT(1);
      253     9826    1   DCL CHAN UBIN;
      254     9827    1   DCL CHANHI UBIN;
      255     9828    1   DCL CODE UBIN;
      256     9829    1   DCL CHNL_NO_LO UBIN;
      257     9830    1   DCL ERR BIT(36);
      258     9831    1   DCL CHANLO UBIN;
      259     9832    1   DCL FOUND BIT(1);
      260     9833    1   DCL HNDLRNAME CHAR(8);
      261     9834    1   DCL I UBIN;
      262     9835    1   DCL J UBIN;
      263     9836    1   DCL SUB UBIN;
      264     9837    1   DCL SUBLO UBIN;
      265     9838    1   DCL SUBHI UBIN;
      266     9839    1   DCL SUBSUB UBIN;
      267     9840    1   DCL SUBSUBLO UBIN;
      268     9841    1   DCL SUBSUBHI UBIN;
      269     9842    1        DCL SUBDEV_LO  UBIN;
      270     9843    1        DCL SUBSUBDEV_LO UBIN;
      271     9844    1        DCL CHNL_NO_HI UBIN;
      272     9845    1        DCL SUBDEV_HI UBIN;
      273     9846        %B$TERMINAL_ID (FPTN=TERMLO,STCLASS=AUTO);
      274     9875        %B$TERMINAL_ID (FPTN=TERMHI,STCLASS=AUTO);
      275     9904    1        DCL SUBSUBDEV_HI UBIN;
      276     9905    1        DCL NO_CHAN BIT(1) ALIGNED;
      277     9906    1        DCL CHAN_STR CHAR(4);
      278     9907    1        DCL TERM_NAME CHAR(8);
      279     9908    1        DCL LOGON_STRING CHAR(31);
      280     9909        %B$TERMINAL_ID (FPTN = FEPLO, STCLASS = AUTO);
      281     9938        %B$TERMINAL_ID (FPTN = FEPHI, STCLASS = AUTO);
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:49   
      282     9967    1   DCL KS_HLPCGERR BIT(1);
      283     9968        %KS$BOX(TITLE="constant variables");

              9986    1   /***************************************************************************
              9987    1    *                                                                         *
              9988    1    *                             constant variables                          *
              9989    1    *                                                                         *
              9990    1    ***************************************************************************/

      284     9995    1   DCL 1 CMPLTED_OK_FMT CONSTANT,
      285     9996    1        2 * CHAR(0)
      286     9997    1   INIT('%.1C%122#:1+.31=%1S%9N.20=%18N.30=%31#.0.2P%30#.0[%4P%8>A%31#.1.0P%?%.18LY%]%2
              9997        0#:1-(-%.16@LD%)%C'),
      287     9998    1        2 * CHAR(0) INIT('%1.0.1P%9N.0=%1.9=%1.7='),
      288     9999    1        2 * CHAR(0) INIT('%3(%1P%2:9#*S%18N.1='),
      289    10000    1        2 * CHAR(0) INIT(   '%2P%2:9#*S%18N.2='),
      290    10001    1        2 * CHAR(0) INIT(   '%1#:2#-.0[%?%0.7=%]'),
      291    10002    1        2 * CHAR(0) INIT(   '%1:9#+.9=%0#:1-.0=%7#:0#*)'),
      292    10003    1        2 * CHAR(0) INIT('Line%7#.1[ %1P%1C%?s %1P%1C to %2P%1C%]'),
      293    10004    1        2 * CHAR(0) INIT(' %3P%>LA.'),
      294    10005    1        2 * CHAR(0) INIT('%2Q');
      295    10006    1        DCL CMPLTED_OK_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(CMPLTED_OK_FMT));
      296    10007    1   DCL ENBL_FMT CHAR(0) CONSTANT INIT('%5- terminal id %LA through %LA%10P enabled');
      297    10008    1   DCL ENBL_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(ENBL_FMT));
      298    10009        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:50   
             10027    1   /***************************************************************************
             10028    1    *                                                                         *
             10029    1    *                              static variables                           *
             10030    1    *                                                                         *
             10031    1    ***************************************************************************/

      299    10036    1   DCL CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      300    10037    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUF));
      301    10038    1   DCL TMP_CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      302    10039    1   DCL TMP_CNFG$ PTR STATIC INIT(ADDR(TMP_CNFG_BUF));
      303    10040        %KL$FEPHNDLR (NAME = KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      304    10070        %KL$FEPHNDLR_KEY (NAME = KS_FEPHNDLR_KEY,STCLASS=STATIC);
      305    10088    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      306    10089        %KL_ADMIN (FPTN=KS_ADMIN,STCLASS=STATIC);
      307    10249        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      308    10268        %KL$TERM (NAME=TERM_REC,STCLASS=STATIC);
      309    10317        %KL$TERM (NAME=TERM_REC_TMP,STCLASS=STATIC);
      310    10366        %KL$TERM_KEY (NAME=TERM_KEY,STCLASS=STATIC);
      311    10412        %KL_CNFG_MSG (FPTN=CNFG_MSG,STCLASS=STATIC);
      312    10695        %KL_CNFG_MSG (FPTN=RESET_MSG,CODE=%IGA_RESET);
      313    10978        %KL$CONFIG_KEY (NAME=KS_CONFIG_KEY,STCLASS=STATIC);
      314    11025        %KS$BOX(TITLE="based variables");

             11043    1   /***************************************************************************
             11044    1    *                                                                         *
             11045    1    *                              based variables                            *
             11046    1    *                                                                         *
             11047    1    ***************************************************************************/

      315    11052        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(CNFG$)");
      316    11210        %KL$LINCNFG (NAME=LINCNFG_TMP,STCLASS="BASED(TMP_CNFG$)");
      317    11368        %KL_ADMIN (FPTN=KL_ADMIN_RETURN,STCLASS="BASED(KS_MSGBUF$)");
      318    11528        %B$TCB;
      319    11531        %B$ALT;
      320    11539        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      321    11584        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      322    11622        %KL_HDR (FPTN=KS$HDR,STCLASS="BASED(HDR$)");
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:51   
      323    11702        %KS$BOX(TITLE="symref variables");

             11720    1   /***************************************************************************
             11721    1    *                                                                         *
             11722    1    *                              symref variables                           *
             11723    1    *                                                                         *
             11724    1    ***************************************************************************/

      324    11729    1   DCL B$TCB$ PTR SYMREF;
      325    11730        %KS$BOX(TITLE="FPTs and VLPs");

             11748    1   /***************************************************************************
             11749    1    *                                                                         *
             11750    1    *                               FPTs and VLPs                             *
             11751    1    *                                                                         *
             11752    1    ***************************************************************************/

      326    11757        %FPT_READ (FPTN=READ_NETCON,
      327    11758                   DCB=M$NETCON,
      328    11759                   KEYS=YES);
      329    11798        %FPT_WRITE (FPTN=WRITE_NETCON,
      330    11799                    DCB=M$NETCON);
      331    11830        %FPT_DELREC (FPTN=DELETE_NETCON,
      332    11831                     DCB=M$NETCON);
      333    11850        %KS$BOX(TITLE="DCBs");

             11868    1   /***************************************************************************
             11869    1    *                                                                         *
             11870    1    *                                    DCBs                                 *
             11871    1    *                                                                         *
             11872    1    ***************************************************************************/

      334    11877    1   DCL M$NETCON DCB;
      335    11878        /**/
      336    11879        /*
      337    11880             variables necessary for the conversion of data from fep to
      338    11881             host byte size.
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:52   
      339    11882        */
      340    11883    1     DCL S_R(0:17) BIT(1) BASED(S$) UNAL;
      341    11884    1     DCL S$ PTR;
      342    11885    1     DCL BINDX UBIN;
      343    11886    1     DCL D$ PTR;
      344    11887    1     DCL D_R(0:17) BIT(1) BASED(D$) UNAL;
      345    11888        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      346    11889             D$ = ADDR(D);
      347    11890             S$ = ADDR(S);
      348    11891             D = 0;
      349    11892             DO BINDX = 1 TO 8;
      350    11893                D_R(BINDX+1) = S_R(BINDX);
      351    11894             END;
      352    11895             DO BINDX = 10 TO 17;
      353    11896                D_R(BINDX) = S_R(BINDX);
      354    11897             END;
      355    11898             D = BITBIN(D_R);
      356    11899        %MEND;
      357    11900        %MACRO WORD_TO_ARRAY (S=JUNK,D=JUNK);
      358    11901             D.BYT(0) = S/256;
      359    11902             D.BYT(1) = MOD(S,256);
      360    11903        %MEND;
      361    11904        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:53   
      362    11905    2        DO CASE(OUT$BLK.CODE);
      363    11906    2           CASE(%KS_ENABLE,%KS_DISABLE,%KS_DISCONNECT,%KS_KILL);
      364    11907    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
      365    11908    2                 CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(1),TERMLO,TERMHI) ALTRET(ERR1);
      366    11909    2              ELSE
      367    11910    2                 CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI) ALTRET(ERR1);
      368    11911    2              IF TERMLO.TERM.TERM_NAME = ' ' THEN
      369    11912    2                 CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);
      370    11913    2              TERMLO.TERM.TERM_NAME = ' ';
      371    11914    2              TERMHI.TERM.TERM_NAME = ' ';
      372    11915    3              DO CASE(OUT$BLK.CODE);
      373    11916    3                 CASE(%KS_ENABLE);
      374    11917    3                    ACTION_CMPLTED = 'Enabled';
      375    11918    3                    KS_ADMIN.FNC = %KHA_FNC_ENABLE;
      376    11919    3                 CASE(%KS_DISABLE);
      377    11920    3                    ACTION_CMPLTED = 'Disabled';
      378    11921    3                    KS_ADMIN.FNC = %KHA_FNC_DISABLE;
      379    11922    3                 CASE(%KS_DISCONNECT);
      380    11923    3                    ACTION_CMPLTED = 'Disconnected';
      381    11924    3                    KS_ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;
      382    11925    3                 CASE(%KS_KILL);
      383    11926    3                    ACTION_CMPLTED = 'Killed';
      384    11927    3                    KS_ADMIN.FNC = %KHA_FNC_KILL;
      385    11928    3                 CASE(%KS_PART);
      386    11929    3                    KS_ADMIN.FNC = %KHA_FNC_PARTITION;
      387    11930    3                 CASE(%KS_RET);
      388    11931    3                    KS_ADMIN.FNC = %KHA_FNC_RETURN;
      389    11932    3                 END;  /* DO CASE */
      390    11933    2              KS_ADMIN.HANDLER = KS_HNDLRNAME;
      391    11934    2              KS_ADMIN.TERMID_LO = TERMLO;
      392    11935    2              KS_ADMIN.TERMID_HI = TERMHI;
      393    11936    2              CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR);
      394    11937    2              CALL KSR$RD_HLPCG
      395    11938    3                 WHENRETURN DO;
      396    11939    3                    CALL KSW$WRITE(CMPLTED_OK_VEC,
      397    11940    3                          VECTOR(TERMLO),
      398    11941    3                          VECTOR(TERMHI),
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:54   
      399    11942    3                          VECTOR(ACTION_CMPLTED));
      400    11943    3                 END;  /* WHENRETURN */
      401    11944    3                 WHENALTRETURN DO;
      402    11945    3                 END;  /* WHENALTRETURN */
      403    11946    2           CASE(%KS_DEFAULT);
      404    11947    2              HNDLRNAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      405    11948    2              CNFG_BUF = '0'B;
      406    11949    2              FOUND = '0'B;
      407    11950    2              KS_FEPHNDLR_KEY.NODE = KS_NODE;
      408    11951    2              READ_NETCON.BUF_ = VECTOR (KS_FEPHNDLR);
      409    11952    2              READ_NETCON.KEY_ = VECTOR (KS_FEPHNDLR_KEY);
      410    11953    2              CALL M$READ (READ_NETCON) ALTRET(IFNDIT);
      411    11954    3      SRCH:   DO J = 0 TO KS_FEPHNDLR.NHANDLERS-1;
      412    11955    3                 IF KS_FEPHNDLR.HANDLER(J) = HNDLRNAME THEN
      413    11956    4                    DO;
      414    11957    4                    FOUND = '1'B;
      415    11958    4                    EXIT SRCH;
      416    11959    4                    END;
      417    11960    3              END;  /* do 0 to # of handlers */
      418    11961           /**/
      419    11962    2    IFNDIT:   IF NOT FOUND THEN
      420    11963    3                 DO;
      421    11964    3                 KS_SUB_BUF_1.TEXT = HNDLRNAME;
      422    11965    3                 KS_SUB_BUF_1.COUNT = SIZEC(HNDLRNAME);
      423    11966    3                 KS_SUB_BUF_2.TEXT = KS_NODENAME;
      424    11967    3                 KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);
      425    11968    3                 CALL KSE$ERRMSG(%E$KS_OKAYBUT,VECTOR(KS_SUB_BUF_1),VECTOR(KS_SUB_BUF_2
             11968                          ));
      426    11969                         /*E* ERROR: KSN-E$KS_OKAYBUT-0
      427    11970                          MESSAGE: WARNING...Handler %U1 has not been defined for %U2.
      428    11971                                             Processing will continue normally.
      429    11972                          MESSAGE1: Use the SET command to define a handler.
      430    11973                          DESCRIPTION: SEE MESSAGE   */
      431    11974    3                 END;  /* if not found */
      432    11975        /**/
      433    11976    2              KS_DEFAULT_KEY.NODE = KS_NODE;
      434    11977    2              KS_DEFAULT_KEY.HNDLR = HNDLRNAME;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:55   
      435    11978    2              READ_NETCON.BUF_ = VECTOR(CNFG_BUF);
      436    11979    2              READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
      437    11980    2              CALL M$READ(READ_NETCON) WHENRETURN
      438    11981    3                 DO;  /* save,set and restore cnfg_exists */
      439    11982    3                 CNFG_EXISTS = LINCNFG.NA.CNFG_EXISTS;
      440    11983    3                 LINCNFG.NA.CNFG_EXISTS = '1'B;
      441    11984    3                 CALL KSU$BLD_LINCNFG(TOP$,LINCNFG) ALTRET(ERR1);
      442    11985    3                 LINCNFG.NA.CNFG_EXISTS = CNFG_EXISTS;
      443    11986    3                 END;  /*  return  */
      444    11987    2              WHENALTRETURN
      445    11988    3                 DO;
      446    11989    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN
      447    11990    4                    DO;
      448    11991    4                    CALL KSU$BLD_LINCNFG_DEF(TOP$,LINCNFG) ALTRET(ERR1);
      449    11992    4                    END;   /* err = nokey  */
      450    11993    3                 ELSE
      451    11994    3                    GOTO ERR;
      452    11995    3                 END;  /* altreturn  */
      453    11996    2              WRITE_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
      454    11997    2              WRITE_NETCON.BUF_ = VECTOR(CNFG_BUF);
      455    11998    2              CALL M$WRITE(WRITE_NETCON) ALTRET(ERR);
      456    11999        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:56   
      457    12000    2   CASE(%KS_RESET);
      458    12001
      459    12002    2        NO_CHAN = '0'B;
      460    12003    2        CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI,'1')
      461    12004    3           WHENALTRETURN DO;
      462    12005    3              IF TERMLO.TERM.TERM_NAME ~= ' ' AND TERMLO.TERM.CHANNEL = '0'B THEN
      463    12006    3                 NO_CHAN = '1'B;
      464    12007    3              ELSE
      465    12008    3                 GOTO ERR1;
      466    12009    3           END;
      467    12010
      468    12011    2        IF NOT NO_CHAN THEN
      469    12012    2           CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);
      470    12013
      471    12014
      472    12015    2        FEPLO = TERMLO;
      473    12016    2        FEPHI = TERMHI;
      474    12017    2        IF FEPLO.TERM.TERM_NAME ~= ' ' OR FEPHI.TERM.TERM_NAME ~= ' '
      475    12018    3           THEN DO;
      476    12019    3              FEPLO.TERM.CHANNEL = '0'B;
      477    12020    3              FEPHI.TERM.CHANNEL = '0'B;
      478    12021    3           END;
      479    12022
      480    12023    2        TERMLO.TERM.TERM_NAME = ' ';
      481    12024
      482    12025    2        IF TOP$->OUT$BLK.NSUBLKS = 1 THEN
      483    12026    2           CALL KSU$INIT_DEFCNFG(LINCNFG_TMP);
      484    12027    2        ELSE
      485    12028    3           DO;
      486    12029    3              KS_DEFAULT_KEY.NODE = KS_NODE;
      487    12030    3              KS_DEFAULT_KEY.HNDLR = TOP$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
      488    12031    3              CALL KSU$READ_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(TMP_CNFG_BUF))
      489    12032    4                 WHENALTRETURN DO;
      490    12033    4                    CALL KSE$ERRMSG(%E$KS_NO_DEFAULT_REC,VECTOR(KS_DEFAULT_KEY.HNDLR));
      491    12034                      /*E*  ERROR:  KSN-E$KS_NO_DEFAULT_REC-0
      492    12035                            MESSAGE:There is no DEFAULT record for the %U1 handler. */
      493    12036    4                    GOTO ERR1;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:57   
      494    12037    4                 END;
      495    12038
      496    12039    3           END;
      497    12040
      498    12041    2        RESET_MSG.KHA = LINCNFG_TMP.KHA;
      499    12042    2        RESET_MSG.NA = LINCNFG_TMP.NA;
      500    12043           /* Don't set profile or autologon, since SLUG doesn't know which handler
      501    12044              default record to read when NODEADMN asks for the profile */
      502    12045    2        RESET_MSG.NA.AUTLGN = '0'B;
      503    12046    2        RESET_MSG.NA.PROFILE = '0'B;
      504    12047
      505    12048    2        CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);
      506    12049    2        CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);
      507    12050    2        CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);
      508    12051    2        CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);
      509    12052    2        CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);
      510    12053    2        CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);
      511    12054
      512    12055    2   C_LOOP:
      513    12056    3        DO CHAN = CHANLO TO CHANHI BY 128;
      514    12057    3           CALL KSU$UNPACK (CHAN,TERMLO.TERM.CHANNEL);
      515    12058    4   S_LOOP: DO SUB = SUBLO TO SUBHI;
      516    12059    4              CALL KSU$UNPACK (SUB,TERMLO.TERM.SUBDEVICE);
      517    12060    5   SS_LOOP:   DO SUBSUB = SUBSUBLO TO SUBSUBHI;
      518    12061    5                 CALL KSU$UNPACK (SUBSUB,TERMLO.TERM.SUBSUBDEVICE);
      519    12062
      520    12063    5                 IF NOT NO_CHAN THEN
      521    12064    6                    DO;
      522    12065    6                       KS_ADMIN.TERMID_LO = TERMLO;
      523    12066    6                       KS_ADMIN.TERMID_HI = TERMLO;
      524    12067    6                       RESET_MSG.TERMID_LO = TERMLO;
      525    12068    6                       RESET_MSG.TERMID_HI = TERMLO;
      526    12069
      527    12070    6                       KS_ADMIN.FNC = %KHA_FNC_PARTITION;
      528    12071    6                       CALL KSR$WR_HLPCG (VECTOR(KS_ADMIN)) ALTRET(RESET_CHAN);
      529    12072    6                       CALL KSR$RD_HLPCG ('0'B);
      530    12073    6                       IF KS_DEFAULT_KEY.HNDLR ~= KL_ADMIN_RETURN.HANDLER AND
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:58   
      531    12074    6                          KL_ADMIN_RETURN.RESULTS = '0'B AND
      532    12075    6                          TOP$->OUT$BLK.NSUBLKS ~= 1 THEN
      533    12076    7                          DO;
      534    12077    7                             CALL KSU$BINHEX (CHAN_STR,CHAN);
      535    12078    7                             CALL KSE$ERRMSG(%E$KS_WRONG_HANDLER,VECTOR(CHAN_STR),
             12078                                      VECTOR(KS_DEFAULT_KEY.HNDLR));
      536    12079                               /*E* ERROR: KSN-E$KS_WRONG_HANDLER-0
      537    12080                                   MESSAGE: Channel .%U1 is not owned by the %U2 handler. */
      538    12081    7                             EXIT S_LOOP;
      539    12082    7                          END;
      540    12083
      541    12084
      542    12085    6      RESET_CHAN:      CALL KSR$WR_HLPCG (VECTOR(RESET_MSG)) ALTRET (CHANGE_REC);
      543    12086    6                       CALL KSR$RD_HLPCG ALTRET (ERR);
      544    12087
      545    12088    6                       KS_ADMIN.FNC = %KHA_FNC_RETURN;
      546    12089    6                       CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET (CHANGE_REC);
      547    12090    6                       CALL KSR$RD_HLPCG ('0') ALTRET (CHANGE_REC);
      548    12091    6                    END;
      549    12092
      550    12093    5   CHANGE_REC:   KS_CONFIG_KEY.NODE = KS_NODE;
      551    12094    5                 KS_CONFIG_KEY.TERMID = TERMLO;
      552    12095    5                 IF TERMHI.TERM.TERM_NAME ~= ' ' THEN
      553    12096    6                    DO;
      554    12097    6                       KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;
      555    12098    6                       KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = TERMHI.TERM.TERM_NAME;
      556    12099    6                    END;
      557    12100    5                 DELETE_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
      558    12101    5                 DELETE_NETCON.LKEY_ = VECTOR(KS_CONFIG_KEY);
      559    12102    5                 CALL M$DELREC (DELETE_NETCON);
      560    12103
      561    12104    5              END SS_LOOP;
      562    12105    4           END S_LOOP;
      563    12106    3        END C_LOOP;
      564    12107    2        IF KS_SELPRMOPT ~= %KS_FILE THEN
      565    12108    3           DO;
      566    12109    3              ACTION_CMPLTED = 'Reset';
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:59   
      567    12110    3              CALL KSW$WRITE (CMPLTED_OK_VEC,
      568    12111    3                 VECTOR(FEPLO),
      569    12112    3                 VECTOR(FEPHI),
      570    12113    3                 VECTOR(ACTION_CMPLTED),
      571    12114    3                 VECTOR(KS_CONFIG_KEY.TERMID.TERM.TERM_NAME));
      572    12115    3           END;
      573    12116
      574    12117        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:60   
      575    12118    2           CASE(%KS_CONFIG);
      576    12119    2              NO_CHAN = '0'B;
      577    12120    2             KS_HLPCGERR = '0'B;
      578    12121    2              CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI,'1')
      579    12122    3                 WHENALTRETURN DO;
      580    12123    3                    IF TERMLO.TERM.TERM_NAME ~= ' ' AND
      581    12124    3                       TERMLO.TERM.CHANNEL = '0'B THEN
      582    12125    3                       NO_CHAN = '1'B;
      583    12126    3                    ELSE
      584    12127    3                       GOTO ERR1;
      585    12128    3                 END;
      586    12129
      587    12130    2              IF TERMLO.TERM.TERM_NAME ~= ' ' THEN
      588    12131    3                 DO;
      589    12132    3                    CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),FEPLO)
      590    12133    4                         WHENALTRETURN DO;
      591    12134    4                            IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM
      592    12135    4                            THEN GOTO ERR;
      593    12136    4                         END;  /* altret on feplo */
      594    12137
      595    12138    3                    IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN
      596    12139    4                       DO;
      597    12140    4                         CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1),FEPHI
             12140                                  )
      598    12141    5                              WHENALTRETURN DO;
      599    12142    5                                 IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM
      600    12143    5                                 THEN GOTO ERR1;
      601    12144    5                              END;  /* altret on fephi */
      602    12145
      603    12146    4                         CALL KSU$CHK_TRM_RNG(FEPLO,FEPHI)
      604    12147
      605    12148    5                              WHENALTRETURN DO;
      606    12149    5                                 CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);
      607    12150    5                                 GOTO ERR1;
      608    12151    5                              END;
      609    12152    4                       END;
      610    12153    3                 END;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:61   
      611    12154
      612    12155    2              IF NOT NO_CHAN THEN
      613    12156    2                 CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);
      614    12157
      615    12158    2              TERM_NAME = TERMLO.TERM.TERM_NAME;
      616    12159    2                    IF TERM_NAME ~= ' ' THEN
      617    12160    3                       DO;
      618    12161    3                          TERMLO.TERM.TERM_NAME = TERM_NAME;
      619    12162    3                          TERMHI.TERM.TERM_NAME = TERM_NAME;
      620    12163    3                          TERMLO.TERM.CHANNEL = '0'B;
      621    12164    3                          TERMHI.TERM.CHANNEL = '0'B;
      622    12165    3                          KS_CONFIG_KEY.NODE = 0;
      623    12166    3                       END;
      624    12167    2                    ELSE
      625    12168    2                       KS_CONFIG_KEY.NODE = KS_NODE;
      626    12169
      627    12170    2                    KS_CONFIG_KEY.TERMID.LEV = TERMLO.LEV;
      628    12171    2                    KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = TERM_NAME;
      629    12172    2                    CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);
      630    12173    2                    CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);
      631    12174    2                    CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);
      632    12175    2                    CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);
      633    12176    2                    CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);
      634    12177    2                    CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);
      635    12178
      636    12179    3   CON_C_LOOP:      DO CHAN = CHANLO TO CHANHI BY 128;
      637    12180    3                    CALL KSU$UNPACK (CHAN,KS_CONFIG_KEY.TERMID.TERM.CHANNEL);
      638    12181    4   CON_S_LOOP:         DO SUB = SUBLO TO SUBHI;
      639    12182    4                          CALL KSU$UNPACK (SUB,KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE);
      640    12183    5   CON_SS_LOOP:           DO SUBSUB = SUBSUBLO TO SUBSUBHI;
      641    12184    5                             CALL KSU$UNPACK (SUBSUB,KS_CONFIG_KEY.TERMID.TERM.
             12184                                      SUBSUBDEVICE);
      642    12185
      643    12186    5                             CALL KSU$READ_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(
             12186                                      CNFG_BUF))
      644    12187    6                                WHENRETURN DO;
      645    12188    6                                   LINCNFG.NA.CNFG_EXISTS = '1'B;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:62   
      646    12189    6                                END;
      647    12190    6                                WHENALTRETURN DO;
      648    12191    6                                   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
             12191                                            THEN
      649    12192    6                                      LINCNFG.NA.CNFG_EXISTS = '0'B;
      650    12193    6                                   ELSE
      651    12194    6                                      GOTO ERR;
      652    12195    6                                END;
      653    12196
      654    12197    5                             LOGON_STRING = LINCNFG.LGN.LGNSTRING;
      655    12198    5                             CALL KSU$BLD_LINCNFG (TOP$,LINCNFG) ALTRET(ERR1);
      656    12199
      657    12200    5              IF KS_SELPRMOPT ~= %KS_FILE THEN
      658    12201    6   CONFIG_FEP:   DO;
      659    12202    6                    IF NO_CHAN THEN
      660    12203    7                       DO;
      661    12204    7                          CALL KSE$ERRMSG (%E$KS_NO_CHAN_FOR_TRM,
      662    12205    7                             VECTOR(TERMLO.TERM.TERM_NAME));
      663    12206    7                          GOTO CONFIG_NETCON;
      664    12207    7                       END;
      665    12208    6                    ELSE
      666    12209    7                       DO;
      667    12210    7                          TERMLO.TERM.TERM_NAME = ' ';
      668    12211    7                          TERMHI.TERM.TERM_NAME = ' ';
      669    12212    7                          CNFG_MSG.TERMID_LO = KS_CONFIG_KEY.TERMID;
      670    12213    7                          CNFG_MSG.TERMID_HI = KS_CONFIG_KEY.TERMID;
      671    12214    7                          CNFG_MSG.KHA = LINCNFG.KHA;
      672    12215    7                          CNFG_MSG.NA = LINCNFG.NA;
      673    12216    7                          CNFG_MSG.NA.CNFG_EXISTS = '1'B;
      674    12217    8                          IF TERM_NAME ~= ' ' THEN DO;
      675    12218    8                             CNFG_MSG.TERMID_LO.TERM.CHANNEL = FEPLO.TERM.CHANNEL;
      676    12219    8                             CNFG_MSG.TERMID_HI.TERM.CHANNEL = FEPHI.TERM.CHANNEL;
      677    12220    8                          END;
      678    12221
      679    12222    7                          CALL KSR$WR_HLPCG (VECTOR(CNFG_MSG))
      680    12223    8                             WHENALTRETURN DO;
      681    12224    8                                CALL KSE$ERRMSG(0);
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:63   
      682    12225    8                           KS_HLPCGERR = '1'B;
      683    12226    8                                GOTO CONFIG_NETCON;
      684    12227    8                             END;
      685    12228    7                          CALL KSR$RD_HLPCG
      686    12229    8                             WHENALTRETURN DO;
      687    12230    8                           KS_HLPCGERR = '1'B;
      688    12231    8                                IF KS$HDR.RESULTS.ERR# = %E$CHAN_NOT_THERE AND
      689    12232    8                                   TERMLO.LEV > %TERMINAL_ID_LEV_CHAN# AND
      690    12233    8                                   KS_SELPRMOPT ~= %KS_TEMP THEN
      691    12234    9                                   DO;
      692    12235    9                                      CALL KSE$ERRMSG (%E$KS_CHAN_NOT_THERE);
      693    12236                         /*E* ERROR:  KSN-E$KS_CHAN_NOT_THERE-0
      694    12237              MESSAGE: This configuration will not take effect until the FEP is rebooted. */
      695    12238    9                                   END;
      696    12239    8                                GOTO CONFIG_NETCON;
      697    12240    8                             END;
      698    12241    7                       END;
      699    12242    6                 END CONFIG_FEP;
      700    12243
      701    12244    5                 IF KS_SELPRMOPT ~= %KS_TEMP THEN
      702    12245    6   CONFIG_NETCON:   DO;
      703    12246    6                             CALL KSU$WRITE_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(
             12246                                      CNFG_BUF)) ALTRET(ERR);
      704    12247    6                             IF LINCNFG.NA.AUTLGN ~= %KS_IGNORE THEN
      705    12248    6                                IF LINCNFG.NA.AUTLGN = %KS_NO_BIT THEN
      706    12249    7                                   DO;
      707    12250    7                                   IF LOGON_STRING ~= ' ' THEN
      708    12251    8                                      DO;
      709    12252    8                                         TERM_KEY.TERMID = '0'B;
      710    12253    8                                         TERM_KEY.TERMID.TERM.TERM_NAME = LOGON_STRING;
      711    12254    8                                         TERM_REC = '0'B;
      712    12255    8                                         TERM_REC.TERMID.TERM.TERM_NAME = ' ';
      713    12256    8                                         CALL KSU$WRITE_NETCON (VECTOR(TERM_KEY),VECTOR
             12256                                                  (TERM_REC)) ALTRET(ERR);
      714    12257    8                                      END;
      715    12258    7                                   END;
      716    12259    6                                ELSE
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:64   
      717    12260    7                                   DO;
      718    12261    7                                      TERM_KEY.TERMID = '0'B;
      719    12262    7                                      TERM_KEY.TERMID.TERM.TERM_NAME = LINCNFG.LGN.
             12262                                               LGNSTRING;
      720    12263    7                                      TERM_REC = KS_CONFIG_KEY;
      721    12264    7                                      TERM_REC.NODE = KS_NODE;
      722    12265    7                                      CALL KSU$WRITE_NETCON(VECTOR(TERM_KEY),VECTOR(
             12265                                               TERM_REC)) ALTRET(ERR);
      723    12266    7                                   END;
      724    12267    6                    END CONFIG_NETCON;
      725    12268    5                          END CON_SS_LOOP;
      726    12269    4                       END CON_S_LOOP;
      727    12270    3                    END CON_C_LOOP;
      728    12271
      729    12272    2                IF (KS_SELPRMOPT ~= %KS_FILE) AND (KS_HLPCGERR = '0'B) THEN
      730    12273    3                 DO;
      731    12274    3                    ACTION_CMPLTED = 'Configured in FEP';
      732    12275    3                    CALL KSW$WRITE (CMPLTED_OK_VEC,
      733    12276    3                       VECTOR(TERMLO),
      734    12277    3                       VECTOR(TERMHI),
      735    12278    3                       VECTOR(ACTION_CMPLTED),
      736    12279    3                       VECTOR(TERM_NAME));
      737    12280    3                 END;
      738    12281
      739    12282    2              IF KS_SELPRMOPT ~= %KS_TEMP THEN
      740    12283    3                 DO;
      741    12284    3                    ACTION_CMPLTED = 'Configured in :NETCON';
      742    12285    3                    CALL KSW$WRITE (CMPLTED_OK_VEC,
      743    12286    3                       VECTOR(TERMLO),
      744    12287    3                       VECTOR(TERMHI),
      745    12288    3                       VECTOR(ACTION_CMPLTED),
      746    12289    3                       VECTOR(TERM_NAME));
      747    12290    3                 END;
      748    12291    2           END;  /* DO CASE */
      749    12292    2        DO WHILE('0'B);
      750    12293    2   ERR:    CALL KSE$ERRMSG(0);
      751    12294    2   ERR1:   CALL KSE$ERRMSG(%E$KS_CANTDOIT);
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:65   
      752    12295                /*E* ERROR: KSN-E$KS_CANTDOIT-0
      753    12296                     MESSAGE: Unable to perform the requested function.
      754    12297                     DESCRIPTION: SEE MESSAGE */
      755    12298    2           END;  /* DO NEVER */
      756    12299    1        RETURN;
      757    12300    1   END KSC$LINCNFG;
      758    12301        %EOD;

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:66   
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$LINCNFG.

   Procedure KSC$LINCNFG requires 1104 words for executable code.
   Procedure KSC$LINCNFG requires 96 words of local(AUTO) storage.

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:67   

 Object Unit name= KSC$LINCNFG                                File name= KSC$COMMANDS1.:E05TOU
 UTS= JUL 30 '97 01:42:47.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    102    146  KSC$LINCNFG
    2   Data  even  none   272    420  KSC$LINCNFG
    3   DCB   even  none     0      0  M$NETCON
    4   Proc  even  none  1104   2120  KSC$LINCNFG
    5  RoData even  none    82    122  KSC$LINCNFG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  KSC$LINCNFG
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:68   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 KSU$BLD_TERMRANGE
 yes     yes           Std       1 KSU$CHECK_FOR_FEP
 yes     yes           Std       1 KSR$WR_HLPCG
 yes     yes           Std       1 KSR$RD_HLPCG
         yes           Std      11 KSW$WRITE
 yes     yes           Std       2 KSU$BLD_LINCNFG
         yes           Std       1 KSU$INIT_DEFCNFG
 yes     yes           Std       2 KSU$BLD_LINCNFG_DEF
         yes           Std       2 KSU$PACK2
 yes     yes           Std       2 KSU$READ_NETCON
 yes     yes           Std       2 KSU$CHK_TRM_RNG
 yes     yes           Std       3 KSU$WRITE_NETCON
         yes           Std       2 KSU$BINHEX
         yes           Std       4 KSE$ERRMSG
         yes           Std       2 KSU$UNPACK
 yes     yes           Std       3 KSU$BLD_TERMID
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_SELPRMOPT                          KS_NODE                               KS_HNDLRNAME
     KS_ERRCODE                            KS_MSGBUF                             KS_MSGBUF$
     KS_SUB_BUF_1                          KS_SUB_BUF_2                          B$TCB$
     M$NETCON                              B_VECTNIL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:69   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:70   


      207        1        /*T***********************************************************/
      208        2        /*T*                                                         */
      209        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      210        4        /*T*                                                         */
      211        5        /*T***********************************************************/
      212        6        KSC$LINCNFG: PROC(TOP$);

      6  4 000000   000000 700200 xent  KSC$LINCNFG  TSX0  ! X66_AUTO_1
         4 000001   000140 000001                    ZERO    96,1

      213        7        /**/
      214        8    1   DCL TOP$ PTR;
      215        9        /**/
      216       10        %INCLUDE CP_6;
      217       91        %INCLUDE CP_6_SUBS;
      218      631        %INCLUDE XU_MACRO_C;
      219     3737        %INCLUDE B_ERRORS_C;
      220     4864        %INCLUDE F$DCB;
      221     4913        %INCLUDE KHA_FNC_E;
      222     5013        %INCLUDE KL_AFCN_C;
      223     5114        %INCLUDE KL_MACRO_C;
      224     8466        %INCLUDE KL_CONFIG_M;
      225     9228        %INCLUDE KS_SUBS_C;
      226     9471        %INCLUDE KS_MACRO_M;
      227     9668        %INCLUDE KS_DATA_R;
      228     9683        %INCLUDE KS_PERR_C;
      229     9750        %KS$BOX(TITLE="entry defs");

              9768    1   /***************************************************************************
              9769    1    *                                                                         *
              9770    1    *                                 entry defs                              *
              9771    1    *                                                                         *
              9772    1    ***************************************************************************/

      230     9777    1   DCL KSE$ERRMSG ENTRY(4);
      231     9778    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:71   
      232     9779    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      233     9780    1   DCL KSU$BLD_LINCNFG ENTRY(2) ALTRET;
      234     9781    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
      235     9782    1   DCL KSU$BLD_LINCNFG_DEF ENTRY(2) ALTRET;
      236     9783    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
      237     9784    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
      238     9785    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      239     9786    1   DCL XUR$ERRCNVRT ENTRY(2);
      240     9787    1   DCL KSW$WRITE ENTRY(11);
      241     9788    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
      242     9789    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
      243     9790    1   DCL KSC$PART ENTRY(1);
      244     9791    1   DCL KSU$UNPACK ENTRY(2);
      245     9792    1   DCL KSU$PACK2 ENTRY(2);
      246     9793    1   DCL KSU$BINHEX ENTRY(2);
      247     9794    1   DCL KSU$BLD_TERMRANGE ENTRY(4) ALTRET;
      248     9795    1   DCL KSU$CHECK_FOR_FEP ENTRY(1) ALTRET;
      249     9796        /**/
      250     9797        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:72   
              9815    1   /***************************************************************************
              9816    1    *                                                                         *
              9817    1    *                               auto variables                            *
              9818    1    *                                                                         *
              9819    1    ***************************************************************************/

      251     9824    1   DCL ACTION_CMPLTED CHAR(21);
      252     9825    1   DCL CNFG_EXISTS BIT(1);
      253     9826    1   DCL CHAN UBIN;
      254     9827    1   DCL CHANHI UBIN;
      255     9828    1   DCL CODE UBIN;
      256     9829    1   DCL CHNL_NO_LO UBIN;
      257     9830    1   DCL ERR BIT(36);
      258     9831    1   DCL CHANLO UBIN;
      259     9832    1   DCL FOUND BIT(1);
      260     9833    1   DCL HNDLRNAME CHAR(8);
      261     9834    1   DCL I UBIN;
      262     9835    1   DCL J UBIN;
      263     9836    1   DCL SUB UBIN;
      264     9837    1   DCL SUBLO UBIN;
      265     9838    1   DCL SUBHI UBIN;
      266     9839    1   DCL SUBSUB UBIN;
      267     9840    1   DCL SUBSUBLO UBIN;
      268     9841    1   DCL SUBSUBHI UBIN;
      269     9842    1        DCL SUBDEV_LO  UBIN;
      270     9843    1        DCL SUBSUBDEV_LO UBIN;
      271     9844    1        DCL CHNL_NO_HI UBIN;
      272     9845    1        DCL SUBDEV_HI UBIN;
      273     9846        %B$TERMINAL_ID (FPTN=TERMLO,STCLASS=AUTO);
      274     9875        %B$TERMINAL_ID (FPTN=TERMHI,STCLASS=AUTO);
      275     9904    1        DCL SUBSUBDEV_HI UBIN;
      276     9905    1        DCL NO_CHAN BIT(1) ALIGNED;
      277     9906    1        DCL CHAN_STR CHAR(4);
      278     9907    1        DCL TERM_NAME CHAR(8);
      279     9908    1        DCL LOGON_STRING CHAR(31);
      280     9909        %B$TERMINAL_ID (FPTN = FEPLO, STCLASS = AUTO);
      281     9938        %B$TERMINAL_ID (FPTN = FEPHI, STCLASS = AUTO);
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:73   
      282     9967    1   DCL KS_HLPCGERR BIT(1);
      283     9968        %KS$BOX(TITLE="constant variables");

              9986    1   /***************************************************************************
              9987    1    *                                                                         *
              9988    1    *                             constant variables                          *
              9989    1    *                                                                         *
              9990    1    ***************************************************************************/

      284     9995    1   DCL 1 CMPLTED_OK_FMT CONSTANT,
      285     9996    1        2 * CHAR(0)
      286     9997    1  INIT('%.1C%122#:1+.31=%1S%9N.20=%18N.30=%31#.0.2P%30#.0[%4P%8>A%31#.1.0P%?%.18LY%]%2
              9997        0#:1-(-%.16@LD%)%C'),
      287     9998    1        2 * CHAR(0) INIT('%1.0.1P%9N.0=%1.9=%1.7='),
      288     9999    1        2 * CHAR(0) INIT('%3(%1P%2:9#*S%18N.1='),
      289    10000    1        2 * CHAR(0) INIT(   '%2P%2:9#*S%18N.2='),
      290    10001    1        2 * CHAR(0) INIT(   '%1#:2#-.0[%?%0.7=%]'),
      291    10002    1        2 * CHAR(0) INIT(   '%1:9#+.9=%0#:1-.0=%7#:0#*)'),
      292    10003    1        2 * CHAR(0) INIT('Line%7#.1[ %1P%1C%?s %1P%1C to %2P%1C%]'),
      293    10004    1        2 * CHAR(0) INIT(' %3P%>LA.'),
      294    10005    1        2 * CHAR(0) INIT('%2Q');
      295    10006    1        DCL CMPLTED_OK_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(CMPLTED_OK_FMT));
      296    10007    1   DCL ENBL_FMT CHAR(0) CONSTANT INIT('%5- terminal id %LA through %LA%10P enabled');
      297    10008    1   DCL ENBL_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(ENBL_FMT));
      298    10009        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:74   
             10027    1   /***************************************************************************
             10028    1    *                                                                         *
             10029    1    *                              static variables                           *
             10030    1    *                                                                         *
             10031    1    ***************************************************************************/

      299    10036    1   DCL CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      300    10037    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUF));
      301    10038    1   DCL TMP_CNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
      302    10039    1   DCL TMP_CNFG$ PTR STATIC INIT(ADDR(TMP_CNFG_BUF));
      303    10040        %KL$FEPHNDLR (NAME = KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      304    10070        %KL$FEPHNDLR_KEY (NAME = KS_FEPHNDLR_KEY,STCLASS=STATIC);
      305    10088    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      306    10089        %KL_ADMIN (FPTN=KS_ADMIN,STCLASS=STATIC);
      307    10249        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      308    10268        %KL$TERM (NAME=TERM_REC,STCLASS=STATIC);
      309    10317        %KL$TERM (NAME=TERM_REC_TMP,STCLASS=STATIC);
      310    10366        %KL$TERM_KEY (NAME=TERM_KEY,STCLASS=STATIC);
      311    10412        %KL_CNFG_MSG (FPTN=CNFG_MSG,STCLASS=STATIC);
      312    10695        %KL_CNFG_MSG (FPTN=RESET_MSG,CODE=%IGA_RESET);
      313    10978        %KL$CONFIG_KEY (NAME=KS_CONFIG_KEY,STCLASS=STATIC);
      314    11025        %KS$BOX(TITLE="based variables");

             11043    1   /***************************************************************************
             11044    1    *                                                                         *
             11045    1    *                              based variables                            *
             11046    1    *                                                                         *
             11047    1    ***************************************************************************/

      315    11052        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(CNFG$)");
      316    11210        %KL$LINCNFG (NAME=LINCNFG_TMP,STCLASS="BASED(TMP_CNFG$)");
      317    11368        %KL_ADMIN (FPTN=KL_ADMIN_RETURN,STCLASS="BASED(KS_MSGBUF$)");
      318    11528        %B$TCB;
      319    11531        %B$ALT;
      320    11539        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      321    11584        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      322    11622        %KL_HDR (FPTN=KS$HDR,STCLASS="BASED(HDR$)");
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:75   
      323    11702        %KS$BOX(TITLE="symref variables");

             11720    1   /***************************************************************************
             11721    1    *                                                                         *
             11722    1    *                              symref variables                           *
             11723    1    *                                                                         *
             11724    1    ***************************************************************************/

      324    11729    1   DCL B$TCB$ PTR SYMREF;
      325    11730        %KS$BOX(TITLE="FPTs and VLPs");

             11748    1   /***************************************************************************
             11749    1    *                                                                         *
             11750    1    *                               FPTs and VLPs                             *
             11751    1    *                                                                         *
             11752    1    ***************************************************************************/

      326    11757        %FPT_READ (FPTN=READ_NETCON,
      327    11758                   DCB=M$NETCON,
      328    11759                   KEYS=YES);
      329    11798        %FPT_WRITE (FPTN=WRITE_NETCON,
      330    11799                    DCB=M$NETCON);
      331    11830        %FPT_DELREC (FPTN=DELETE_NETCON,
      332    11831                     DCB=M$NETCON);
      333    11850        %KS$BOX(TITLE="DCBs");

             11868    1   /***************************************************************************
             11869    1    *                                                                         *
             11870    1    *                                    DCBs                                 *
             11871    1    *                                                                         *
             11872    1    ***************************************************************************/

      334    11877    1   DCL M$NETCON DCB;
      335    11878        /**/
      336    11879        /*
      337    11880             variables necessary for the conversion of data from fep to
      338    11881             host byte size.
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:76   
      339    11882        */
      340    11883    1     DCL S_R(0:17) BIT(1) BASED(S$) UNAL;
      341    11884    1     DCL S$ PTR;
      342    11885    1     DCL BINDX UBIN;
      343    11886    1     DCL D$ PTR;
      344    11887    1     DCL D_R(0:17) BIT(1) BASED(D$) UNAL;
      345    11888        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      346    11889             D$ = ADDR(D);
      347    11890             S$ = ADDR(S);
      348    11891             D = 0;
      349    11892             DO BINDX = 1 TO 8;
      350    11893                D_R(BINDX+1) = S_R(BINDX);
      351    11894             END;
      352    11895             DO BINDX = 10 TO 17;
      353    11896                D_R(BINDX) = S_R(BINDX);
      354    11897             END;
      355    11898             D = BITBIN(D_R);
      356    11899        %MEND;
      357    11900        %MACRO WORD_TO_ARRAY (S=JUNK,D=JUNK);
      358    11901             D.BYT(0) = S/256;
      359    11902             D.BYT(1) = MOD(S,256);
      360    11903        %MEND;
      361    11904        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:77   
      362    11905    2        DO CASE(OUT$BLK.CODE);

  11905  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000010 100003                    CMPX0   8,DU
         4 000006   000010 602010 4                  TNC     s:11905+6,X0
         4 000007   002106 710000 4                  TRA     s:12292
         4 000010   002106 710000 4                  TRA     s:12292
         4 000011   000020 710000 4                  TRA     s:11907
         4 000012   000020 710000 4                  TRA     s:11907
         4 000013   000020 710000 4                  TRA     s:11907
         4 000014   000020 710000 4                  TRA     s:11907
         4 000015   001133 710000 4                  TRA     s:12119
         4 000016   000226 710000 4                  TRA     s:11947
         4 000017   000405 710000 4                  TRA     s:12002

      363    11906    2           CASE(%KS_ENABLE,%KS_DISABLE,%KS_DISCONNECT,%KS_KILL);

      364    11907    2              IF OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

  11907  4 000020   100003 473500                    LDP3    3,,PR1
         4 000021   300000 721100                    LXL1    0,,PR3
         4 000022   000001 101003                    CMPX1   1,DU
         4 000023   000037 601000 4                  TNZ     s:11910

      365    11908    2                CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(1),TERMLO,TERMHI) ALTRET(ERR1);

  11908  4 000024   200044 634500                    EPPR4   TERMHI,,AUTO
         4 000025   200104 454500                    STP4    D$+4,,AUTO
         4 000026   200040 633500                    EPPR3   TERMLO,,AUTO
         4 000027   200103 453500                    STP3    D$+3,,AUTO
         4 000030   100004 635500                    EPPR5   4,,PR1
         4 000031   200102 455500                    STP5    D$+2,,AUTO
         4 000032   200102 630500                    EPPR0   D$+2,,AUTO
         4 000033   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000034   000000 701000 xent               TSX1    KSU$BLD_TERMRANGE
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:78   
         4 000035   002113 702000 4                  TSX2    ERR1
         4 000036   000051 710000 4                  TRA     s:11911

      366    11909    2              ELSE
      367    11910    2                CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI) ALTRET(ERR1);

  11910  4 000037   200044 634500                    EPPR4   TERMHI,,AUTO
         4 000040   200104 454500                    STP4    D$+4,,AUTO
         4 000041   200040 633500                    EPPR3   TERMLO,,AUTO
         4 000042   200103 453500                    STP3    D$+3,,AUTO
         4 000043   100003 635500                    EPPR5   3,,PR1
         4 000044   200102 455500                    STP5    D$+2,,AUTO
         4 000045   200102 630500                    EPPR0   D$+2,,AUTO
         4 000046   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000047   000000 701000 xent               TSX1    KSU$BLD_TERMRANGE
         4 000050   002113 702000 4                  TSX2    ERR1

      368    11911    2              IF TERMLO.TERM.TERM_NAME = ' ' THEN

  11911  4 000051   200042 237100                    LDAQ    TERMLO+2,,AUTO
         4 000052   000000 117000 5                  CMPAQ   0
         4 000053   000060 601000 4                  TNZ     s:11913

      369    11912    2                 CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);

  11912  4 000054   000002 630400 5                  EPPR0   2
         4 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000056   000000 701000 xent               TSX1    KSU$CHECK_FOR_FEP
         4 000057   002113 702000 4                  TSX2    ERR1

      370    11913    2              TERMLO.TERM.TERM_NAME = ' ';

  11913  4 000060   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000061   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000062   200042 757100                    STAQ    TERMLO+2,,AUTO

      371    11914    2              TERMHI.TERM.TERM_NAME = ' ';
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:79   

  11914  4 000063   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000064   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000065   200046 757100                    STAQ    TERMHI+2,,AUTO

      372    11915    3              DO CASE(OUT$BLK.CODE);

  11915  4 000066   200003 470500                    LDP0    @TOP$,,AUTO
         4 000067   000000 471500                    LDP1    0,,PR0
         4 000070   100000 720100                    LXL0    0,,PR1
         4 000071   000012 100003                    CMPX0   10,DU
         4 000072   000074 602010 4                  TNC     s:11915+6,X0
         4 000073   000143 710000 4                  TRA     s:11933
         4 000074   000143 710000 4                  TRA     s:11933
         4 000075   000106 710000 4                  TRA     s:11917
         4 000076   000114 710000 4                  TRA     s:11920
         4 000077   000122 710000 4                  TRA     s:11923
         4 000100   000130 710000 4                  TRA     s:11926
         4 000101   000143 710000 4                  TRA     s:11933
         4 000102   000143 710000 4                  TRA     s:11933
         4 000103   000143 710000 4                  TRA     s:11933
         4 000104   000136 710000 4                  TRA     s:11929
         4 000105   000141 710000 4                  TRA     s:11931

      373    11916    3                 CASE(%KS_ENABLE);

      374    11917    3                    ACTION_CMPLTED = 'Enabled';

  11917  4 000106   040100 100400                    MLR     fill='040'O
         4 000107   000120 000007 1                  ADSC9   ENBL_FMT+14              cn=0,n=7
         4 000110   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      375    11918    3                    KS_ADMIN.FNC = %KHA_FNC_ENABLE;

  11918  4 000111   000001 220003                    LDX0    1,DU
         4 000112   000236 440000 2                  SXL0    KS_ADMIN+8
         4 000113   000143 710000 4                  TRA     s:11933
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:80   

      376    11919    3                 CASE(%KS_DISABLE);

      377    11920    3                    ACTION_CMPLTED = 'Disabled';

  11920  4 000114   040100 100400                    MLR     fill='040'O
         4 000115   000122 000010 1                  ADSC9   ENBL_FMT+16              cn=0,n=8
         4 000116   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      378    11921    3                    KS_ADMIN.FNC = %KHA_FNC_DISABLE;

  11921  4 000117   000002 220003                    LDX0    2,DU
         4 000120   000236 440000 2                  SXL0    KS_ADMIN+8
         4 000121   000143 710000 4                  TRA     s:11933

      379    11922    3                 CASE(%KS_DISCONNECT);

      380    11923    3                    ACTION_CMPLTED = 'Disconnected';

  11923  4 000122   040100 100400                    MLR     fill='040'O
         4 000123   000124 000014 1                  ADSC9   ENBL_FMT+18              cn=0,n=12
         4 000124   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      381    11924    3                    KS_ADMIN.FNC = %KHA_FNC_DISCONNECT_RQS;

  11924  4 000125   000015 220003                    LDX0    13,DU
         4 000126   000236 440000 2                  SXL0    KS_ADMIN+8
         4 000127   000143 710000 4                  TRA     s:11933

      382    11925    3                 CASE(%KS_KILL);

      383    11926    3                    ACTION_CMPLTED = 'Killed';

  11926  4 000130   040100 100400                    MLR     fill='040'O
         4 000131   000127 000006 1                  ADSC9   ENBL_FMT+21              cn=0,n=6
         4 000132   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:81   
      384    11927    3                    KS_ADMIN.FNC = %KHA_FNC_KILL;

  11927  4 000133   000003 220003                    LDX0    3,DU
         4 000134   000236 440000 2                  SXL0    KS_ADMIN+8
         4 000135   000143 710000 4                  TRA     s:11933

      385    11928    3                 CASE(%KS_PART);

      386    11929    3                    KS_ADMIN.FNC = %KHA_FNC_PARTITION;

  11929  4 000136   000007 221003                    LDX1    7,DU
         4 000137   000236 441000 2                  SXL1    KS_ADMIN+8
         4 000140   000143 710000 4                  TRA     s:11933

      387    11930    3                 CASE(%KS_RET);

      388    11931    3                    KS_ADMIN.FNC = %KHA_FNC_RETURN;

  11931  4 000141   000011 221003                    LDX1    9,DU
         4 000142   000236 441000 2                  SXL1    KS_ADMIN+8

      389    11932    3                 END;  /* DO CASE */

      390    11933    2              KS_ADMIN.HANDLER = KS_HNDLRNAME;

  11933  4 000143   040000 100400                    MLR     fill='040'O
         4 000144   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 000145   000227 000010 2                  ADSC9   KS_ADMIN+1               cn=0,n=8

      391    11934    2              KS_ADMIN.TERMID_LO = TERMLO;

  11934  4 000146   000000 100500                    MLR     fill='000'O
         4 000147   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000150   000237 000020 2                  ADSC9   KS_ADMIN+9               cn=0,n=16

      392    11935    2              KS_ADMIN.TERMID_HI = TERMHI;

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:82   
  11935  4 000151   000000 100500                    MLR     fill='000'O
         4 000152   200044 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         4 000153   000243 000020 2                  ADSC9   KS_ADMIN+13              cn=0,n=16

      393    11936    2              CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR);

  11936  4 000154   000006 630400 5                  EPPR0   6
         4 000155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000156   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 000157   002107 702000 4                  TSX2    ERR

      394    11937    2              CALL KSR$RD_HLPCG

  11937  4 000160   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000161   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 000162   000225 702000 4                  TSX2    s:11945

      395    11938    3                 WHENRETURN DO;

      396    11939    3                    CALL KSW$WRITE(CMPLTED_OK_VEC,

  11939  4 000163   000007 235000 5                  LDA     7
         4 000164   200102 452500                    STP2    D$+2,,AUTO
         4 000165   200102 236100                    LDQ     D$+2,,AUTO
         4 000166   000040 036003                    ADLQ    32,DU
         4 000167   200104 757100                    STAQ    D$+4,,AUTO
         4 000170   000007 235000 5                  LDA     7
         4 000171   200106 452500                    STP2    D$+6,,AUTO
         4 000172   200106 236100                    LDQ     D$+6,,AUTO
         4 000173   000044 036003                    ADLQ    36,DU
         4 000174   200110 757100                    STAQ    D$+8,,AUTO
         4 000175   000010 235000 5                  LDA     8
         4 000176   200112 452500                    STP2    D$+10,,AUTO
         4 000177   200112 236100                    LDQ     D$+10,,AUTO
         4 000200   000004 036003                    ADLQ    4,DU
         4 000201   200116 757100                    STAQ    D$+14,,AUTO
         4 000202   200104 237100                    LDAQ    D$+4,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:83   
         4 000203   200114 757100                    STAQ    D$+12,,AUTO
         4 000204   200110 237100                    LDAQ    D$+8,,AUTO
         4 000205   200120 757100                    STAQ    D$+16,,AUTO
         4 000206   200116 237100                    LDAQ    D$+14,,AUTO
         4 000207   200122 757100                    STAQ    D$+18,,AUTO
         4 000210   200122 630500                    EPPR0   D$+18,,AUTO
         4 000211   200127 450500                    STP0    D$+23,,AUTO
         4 000212   200120 631500                    EPPR1   D$+16,,AUTO
         4 000213   200126 451500                    STP1    D$+22,,AUTO
         4 000214   200114 633500                    EPPR3   D$+12,,AUTO
         4 000215   200125 453500                    STP3    D$+21,,AUTO
         4 000216   000011 236000 5                  LDQ     9
         4 000217   200124 756100                    STQ     D$+20,,AUTO
         4 000220   200124 630500                    EPPR0   D$+20,,AUTO
         4 000221   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000222   000000 701000 xent               TSX1    KSW$WRITE
         4 000223   000000 011000                    NOP     0

      397    11940    3                          VECTOR(TERMLO),
      398    11941    3                          VECTOR(TERMHI),
      399    11942    3                          VECTOR(ACTION_CMPLTED));
      400    11943    3                 END;  /* WHENRETURN */

  11943  4 000224   000225 710000 4                  TRA     s:11945

      401    11944    3                 WHENALTRETURN DO;

      402    11945    3                 END;  /* WHENALTRETURN */

  11945  4 000225   002106 710000 4                  TRA     s:12292

      403    11946    2           CASE(%KS_DEFAULT);

      404    11947    2              HNDLRNAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11947  4 000226   100003 473500                    LDP3    3,,PR1
         4 000227   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:84   
         4 000230   000033 772000                    QRL     27
         4 000231   000000 621006                    EAX1    0,QL
         4 000232   040100 100540                    MLR     fill='040'O
         4 000233   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000234   200022 000010                    ADSC9   HNDLRNAME,,AUTO          cn=0,n=8

      405    11948    2              CNFG_BUF = '0'B;

  11948  4 000235   000000 100400                    MLR     fill='000'O
         4 000236   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000237   000000 000310 2                  ADSC9   CNFG_BUF                 cn=0,n=200

      406    11949    2              FOUND = '0'B;

  11949  4 000240   200021 450100                    STZ     FOUND,,AUTO

      407    11950    2              KS_FEPHNDLR_KEY.NODE = KS_NODE;

  11950  4 000241   000000 236000 xsym               LDQ     KS_NODE
         4 000242   000011 736000                    QLS     9
         4 000243   000224 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

      408    11951    2              READ_NETCON.BUF_ = VECTOR (KS_FEPHNDLR);

  11951  4 000244   000012 237000 5                  LDAQ    10
         4 000245   000360 757000 2                  STAQ    READ_NETCON+4

      409    11952    2              READ_NETCON.KEY_ = VECTOR (KS_FEPHNDLR_KEY);

  11952  4 000246   000014 237000 5                  LDAQ    12
         4 000247   000356 757000 2                  STAQ    READ_NETCON+2

      410    11953    2              CALL M$READ (READ_NETCON) ALTRET(IFNDIT);

  11953  4 000250   000354 630400 2                  EPPR0   READ_NETCON
         4 000251   440000 713400                    CLIMB   alt,read
         4 000252   401400 401760                    pmme    nvectors=4
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:85   
         4 000253   000274 702000 4                  TSX2    IFNDIT

      411    11954    3      SRCH:   DO J = 0 TO KS_FEPHNDLR.NHANDLERS-1;

  11954  4 000254   200025 450100       SRCH         STZ     J,,AUTO
         4 000255   000271 710000 4                  TRA     s:11960+3

      412    11955    3                 IF KS_FEPHNDLR.HANDLER(J) = HNDLRNAME THEN

  11955  4 000256   200025 235100                    LDA     J,,AUTO
         4 000257   000001 735000                    ALS     1
         4 000260   000152 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         4 000261   200022 117100                    CMPAQ   HNDLRNAME,,AUTO
         4 000262   000266 601000 4                  TNZ     s:11960

      413    11956    4                    DO;

      414    11957    4                    FOUND = '1'B;

  11957  4 000263   400000 236003                    LDQ     -131072,DU
         4 000264   200021 756100                    STQ     FOUND,,AUTO

      415    11958    4                    EXIT SRCH;

  11958  4 000265   000274 710000 4                  TRA     IFNDIT

      416    11959    4                    END;
      417    11960    3              END;  /* do 0 to # of handlers */

  11960  4 000266   200025 235100                    LDA     J,,AUTO
         4 000267   000001 035007                    ADLA    1,DL
         4 000270   200025 755100                    STA     J,,AUTO
         4 000271   200025 236100                    LDQ     J,,AUTO
         4 000272   000146 116000 2                  CMPQ    KS_FEPHNDLR
         4 000273   000256 602000 4                  TNC     s:11955

      418    11961           /**/
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:86   
      419    11962    2    IFNDIT:   IF NOT FOUND THEN

  11962  4 000274   200021 234100       IFNDIT       SZN     FOUND,,AUTO
         4 000275   000313 604000 4                  TMI     s:11976

      420    11963    3                 DO;

      421    11964    3                 KS_SUB_BUF_1.TEXT = HNDLRNAME;

  11964  4 000276   040000 100500                    MLR     fill='040'O
         4 000277   200022 000010                    ADSC9   HNDLRNAME,,AUTO          cn=0,n=8
         4 000300   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      422    11965    3                 KS_SUB_BUF_1.COUNT = SIZEC(HNDLRNAME);

  11965  4 000301   010000 236003                    LDQ     4096,DU
         4 000302   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

      423    11966    3                 KS_SUB_BUF_2.TEXT = KS_NODENAME;

  11966  4 000303   040000 100400                    MLR     fill='040'O
         4 000304   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000305   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

      424    11967    3                 KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);

  11967  4 000306   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

      425    11968    3                CALL KSE$ERRMSG(%E$KS_OKAYBUT,VECTOR(KS_SUB_BUF_1),VECTOR(KS_SUB_BUF_2
             11968                          ));

  11968  4 000307   000023 630400 5                  EPPR0   19
         4 000310   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000311   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000312   000000 011000                    NOP     0

      426    11969                         /*E* ERROR: KSN-E$KS_OKAYBUT-0
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:87   
      427    11970                          MESSAGE: WARNING...Handler %U1 has not been defined for %U2.
      428    11971                                             Processing will continue normally.
      429    11972                          MESSAGE1: Use the SET command to define a handler.
      430    11973                          DESCRIPTION: SEE MESSAGE   */
      431    11974    3                 END;  /* if not found */

      432    11975        /**/
      433    11976    2              KS_DEFAULT_KEY.NODE = KS_NODE;

  11976  4 000313   000000 236000 xsym               LDQ     KS_NODE
         4 000314   000011 736000                    QLS     9
         4 000315   000247 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

      434    11977    2              KS_DEFAULT_KEY.HNDLR = HNDLRNAME;

  11977  4 000316   040000 100500                    MLR     fill='040'O
         4 000317   200022 000010                    ADSC9   HNDLRNAME,,AUTO          cn=0,n=8
         4 000320   000247 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

      435    11978    2              READ_NETCON.BUF_ = VECTOR(CNFG_BUF);

  11978  4 000321   000026 237000 5                  LDAQ    22
         4 000322   000360 757000 2                  STAQ    READ_NETCON+4

      436    11979    2              READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);

  11979  4 000323   000030 237000 5                  LDAQ    24
         4 000324   000356 757000 2                  STAQ    READ_NETCON+2

      437    11980    2              CALL M$READ(READ_NETCON) WHENRETURN

  11980  4 000325   000354 630400 2                  EPPR0   READ_NETCON
         4 000326   440000 713400                    CLIMB   alt,read
         4 000327   401400 401760                    pmme    nvectors=4
         4 000330   000356 702000 4                  TSX2    s:11989

      438    11981    3                 DO;  /* save,set and restore cnfg_exists */
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:88   

      439    11982    3                 CNFG_EXISTS = LINCNFG.NA.CNFG_EXISTS;

  11982  4 000331   000062 470400 2                  LDP0    CNFG$
         4 000332   000004 236100                    LDQ     4,,PR0
         4 000333   000042 736000                    QLS     34
         4 000334   400000 376003                    ANQ     -131072,DU
         4 000335   200012 756100                    STQ     CNFG_EXISTS,,AUTO

      440    11983    3                 LINCNFG.NA.CNFG_EXISTS = '1'B;

  11983  4 000336   000002 236007                    LDQ     2,DL
         4 000337   000004 256100                    ORSQ    4,,PR0

      441    11984    3                 CALL KSU$BLD_LINCNFG(TOP$,LINCNFG) ALTRET(ERR1);

  11984  4 000340   000062 236000 2                  LDQ     CNFG$
         4 000341   200003 235100                    LDA     @TOP$,,AUTO
         4 000342   200102 757100                    STAQ    D$+2,,AUTO
         4 000343   200102 630500                    EPPR0   D$+2,,AUTO
         4 000344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000345   000000 701000 xent               TSX1    KSU$BLD_LINCNFG
         4 000346   002113 702000 4                  TSX2    ERR1

      442    11985    3                 LINCNFG.NA.CNFG_EXISTS = CNFG_EXISTS;

  11985  4 000347   000062 470400 2                  LDP0    CNFG$
         4 000350   200012 236100                    LDQ     CNFG_EXISTS,,AUTO
         4 000351   000042 772000                    QRL     34
         4 000352   000004 676100                    ERQ     4,,PR0
         4 000353   000002 376007                    ANQ     2,DL
         4 000354   000004 656100                    ERSQ    4,,PR0

      443    11986    3                 END;  /*  return  */

  11986  4 000355   000374 710000 4                  TRA     s:11996

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:89   
      444    11987    2              WHENALTRETURN
      445    11988    3                 DO;

      446    11989    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN

  11989  4 000356   000000 470400 xsym               LDP0    B$TCB$
         4 000357   000000 471500                    LDP1    0,,PR0
         4 000360   100102 236100                    LDQ     66,,PR1
         4 000361   377770 376007                    ANQ     131064,DL
         4 000362   001020 116007                    CMPQ    528,DL
         4 000363   002107 601000 4                  TNZ     ERR

      447    11990    4                    DO;

      448    11991    4                    CALL KSU$BLD_LINCNFG_DEF(TOP$,LINCNFG) ALTRET(ERR1);

  11991  4 000364   000062 236000 2                  LDQ     CNFG$
         4 000365   200003 235100                    LDA     @TOP$,,AUTO
         4 000366   200102 757100                    STAQ    D$+2,,AUTO
         4 000367   200102 630500                    EPPR0   D$+2,,AUTO
         4 000370   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000371   000000 701000 xent               TSX1    KSU$BLD_LINCNFG_DEF
         4 000372   002113 702000 4                  TSX2    ERR1

      449    11992    4                    END;   /* err = nokey  */

  11992  4 000373   000374 710000 4                  TRA     s:11996

      450    11993    3                 ELSE
      451    11994    3                    GOTO ERR;
      452    11995    3                 END;  /* altreturn  */
      453    11996    2              WRITE_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);

  11996  4 000374   000030 237000 5                  LDAQ    24
         4 000375   000374 757000 2                  STAQ    WRITE_NETCON+2

      454    11997    2              WRITE_NETCON.BUF_ = VECTOR(CNFG_BUF);
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:90   

  11997  4 000376   000026 237000 5                  LDAQ    22
         4 000377   000376 757000 2                  STAQ    WRITE_NETCON+4

      455    11998    2              CALL M$WRITE(WRITE_NETCON) ALTRET(ERR);

  11998  4 000400   000372 630400 2                  EPPR0   WRITE_NETCON
         4 000401   440001 713400                    CLIMB   alt,write
         4 000402   401400 401760                    pmme    nvectors=4
         4 000403   002107 702000 4                  TSX2    ERR
         4 000404   002106 710000 4                  TRA     s:12292

      456    11999        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:91   
      457    12000    2   CASE(%KS_RESET);

      458    12001
      459    12002    2        NO_CHAN = '0'B;

  12002  4 000405   200051 450100                    STZ     NO_CHAN,,AUTO

      460    12003    2        CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI,'1')

  12003  4 000406   000033 236000 5                  LDQ     27
         4 000407   200105 756100                    STQ     D$+5,,AUTO
         4 000410   200044 633500                    EPPR3   TERMHI,,AUTO
         4 000411   200104 453500                    STP3    D$+4,,AUTO
         4 000412   200040 634500                    EPPR4   TERMLO,,AUTO
         4 000413   200103 454500                    STP4    D$+3,,AUTO
         4 000414   100003 635500                    EPPR5   3,,PR1
         4 000415   200102 455500                    STP5    D$+2,,AUTO
         4 000416   200102 630500                    EPPR0   D$+2,,AUTO
         4 000417   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000420   000000 701000 xent               TSX1    KSU$BLD_TERMRANGE
         4 000421   000423 702000 4                  TSX2    s:12005
         4 000422   000433 710000 4                  TRA     s:12011

      461    12004    3           WHENALTRETURN DO;

      462    12005    3              IF TERMLO.TERM.TERM_NAME ~= ' ' AND TERMLO.TERM.CHANNEL = '0'B THEN

  12005  4 000423   200042 237100                    LDAQ    TERMLO+2,,AUTO
         4 000424   000000 117000 5                  CMPAQ   0
         4 000425   002113 600000 4                  TZE     ERR1
         4 000426   200040 720100                    LXL0    TERMLO,,AUTO
         4 000427   002113 601000 4                  TNZ     ERR1

      463    12006    3                 NO_CHAN = '1'B;

  12006  4 000430   400000 236003                    LDQ     -131072,DU
         4 000431   200051 756100                    STQ     NO_CHAN,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:92   
         4 000432   000433 710000 4                  TRA     s:12011

      464    12007    3              ELSE
      465    12008    3                 GOTO ERR1;
      466    12009    3           END;
      467    12010
      468    12011    2        IF NOT NO_CHAN THEN

  12011  4 000433   200051 234100                    SZN     NO_CHAN,,AUTO
         4 000434   000441 604000 4                  TMI     s:12015

      469    12012    2           CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);

  12012  4 000435   000002 630400 5                  EPPR0   2
         4 000436   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000437   000000 701000 xent               TSX1    KSU$CHECK_FOR_FEP
         4 000440   002113 702000 4                  TSX2    ERR1

      470    12013
      471    12014
      472    12015    2        FEPLO = TERMLO;

  12015  4 000441   000100 100500                    MLR     fill='000'O
         4 000442   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000443   200065 000020                    ADSC9   FEPLO,,AUTO              cn=0,n=16

      473    12016    2        FEPHI = TERMHI;

  12016  4 000444   000100 100500                    MLR     fill='000'O
         4 000445   200044 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         4 000446   200071 000020                    ADSC9   FEPHI,,AUTO              cn=0,n=16

      474    12017    2        IF FEPLO.TERM.TERM_NAME ~= ' ' OR FEPHI.TERM.TERM_NAME ~= ' '

  12017  4 000447   040000 106500                    CMPC    fill='040'O
         4 000450   200067 000010                    ADSC9   FEPLO+2,,AUTO            cn=0,n=8
         4 000451   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:93   
         4 000452   000457 601000 4                  TNZ     s:12019
         4 000453   040000 106500                    CMPC    fill='040'O
         4 000454   200073 000010                    ADSC9   FEPHI+2,,AUTO            cn=0,n=8
         4 000455   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000456   000462 600000 4                  TZE     s:12023

      475    12018    3           THEN DO;

      476    12019    3              FEPLO.TERM.CHANNEL = '0'B;

  12019  4 000457   000000 220003                    LDX0    0,DU
         4 000460   200065 440100                    SXL0    FEPLO,,AUTO

      477    12020    3              FEPHI.TERM.CHANNEL = '0'B;

  12020  4 000461   200071 440100                    SXL0    FEPHI,,AUTO

      478    12021    3           END;

      479    12022
      480    12023    2        TERMLO.TERM.TERM_NAME = ' ';

  12023  4 000462   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000463   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000464   200042 757100                    STAQ    TERMLO+2,,AUTO

      481    12024
      482    12025    2        IF TOP$->OUT$BLK.NSUBLKS = 1 THEN

  12025  4 000465   200003 470500                    LDP0    @TOP$,,AUTO
         4 000466   000000 471500                    LDP1    0,,PR0
         4 000467   100001 220100                    LDX0    1,,PR1
         4 000470   000001 100003                    CMPX0   1,DU
         4 000471   000477 601000 4                  TNZ     s:12029

      483    12026    2           CALL KSU$INIT_DEFCNFG(LINCNFG_TMP);

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:94   
  12026  4 000472   000145 630400 2                  EPPR0   TMP_CNFG$
         4 000473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000474   000000 701000 xent               TSX1    KSU$INIT_DEFCNFG
         4 000475   000000 011000                    NOP     0
         4 000476   000524 710000 4                  TRA     s:12041

      484    12027    2        ELSE
      485    12028    3           DO;

      486    12029    3              KS_DEFAULT_KEY.NODE = KS_NODE;

  12029  4 000477   000000 236000 xsym               LDQ     KS_NODE
         4 000500   000011 736000                    QLS     9
         4 000501   000247 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

      487    12030    3              KS_DEFAULT_KEY.HNDLR = TOP$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  12030  4 000502   000000 471500                    LDP1    0,,PR0
         4 000503   100004 473500                    LDP3    4,,PR1
         4 000504   300004 236100                    LDQ     4,,PR3
         4 000505   000033 772000                    QRL     27
         4 000506   000000 620006                    EAX0    0,QL
         4 000507   040000 100540                    MLR     fill='040'O
         4 000510   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000511   000247 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

      488    12031    3              CALL KSU$READ_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(TMP_CNFG_BUF))

  12031  4 000512   000036 630400 5                  EPPR0   30
         4 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000514   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 000515   000517 702000 4                  TSX2    s:12033
         4 000516   000524 710000 4                  TRA     s:12041

      489    12032    4                 WHENALTRETURN DO;

      490    12033    4                   CALL KSE$ERRMSG(%E$KS_NO_DEFAULT_REC,VECTOR(KS_DEFAULT_KEY.HNDLR));
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:95   

  12033  4 000517   000043 630400 5                  EPPR0   35
         4 000520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000521   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000522   000000 011000                    NOP     0

      491    12034                      /*E*  ERROR:  KSN-E$KS_NO_DEFAULT_REC-0
      492    12035                            MESSAGE:There is no DEFAULT record for the %U1 handler. */
      493    12036    4                    GOTO ERR1;

  12036  4 000523   002113 710000 4                  TRA     ERR1

      494    12037    4                 END;
      495    12038
      496    12039    3           END;

      497    12040
      498    12041    2        RESET_MSG.KHA = LINCNFG_TMP.KHA;

  12041  4 000524   000145 470400 2                  LDP0    TMP_CNFG$
         4 000525   000000 100500                    MLR     fill='000'O
         4 000526   000000 000022                    ADSC9   0,,PR0                   cn=0,n=18
         4 000527   000340 400022 2                  ADSC9   RESET_MSG+16             cn=2,n=18

      499    12042    2        RESET_MSG.NA = LINCNFG_TMP.NA;

  12042  4 000530   000000 100500                    MLR     fill='000'O
         4 000531   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
         4 000532   000345 000010 2                  ADSC9   RESET_MSG+21             cn=0,n=8

      500    12043           /* Don't set profile or autologon, since SLUG doesn't know which handler
      501    12044              default record to read when NODEADMN asks for the profile */
      502    12045    2        RESET_MSG.NA.AUTLGN = '0'B;

  12045  4 000533   000045 236000 5                  LDQ     37
         4 000534   000345 356000 2                  ANSQ    RESET_MSG+21

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:96   
      503    12046    2        RESET_MSG.NA.PROFILE = '0'B;

  12046  4 000535   000046 236000 5                  LDQ     38
         4 000536   000345 356000 2                  ANSQ    RESET_MSG+21

      504    12047
      505    12048    2        CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);

  12048  4 000537   200020 631500                    EPPR1   CHANLO,,AUTO
         4 000540   200103 451500                    STP1    D$+3,,AUTO
         4 000541   200104 452500                    STP2    D$+4,,AUTO
         4 000542   200104 236100                    LDQ     D$+4,,AUTO
         4 000543   000047 036000 5                  ADLQ    39
         4 000544   200102 756100                    STQ     D$+2,,AUTO
         4 000545   200102 630500                    EPPR0   D$+2,,AUTO
         4 000546   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000547   000000 701000 xent               TSX1    KSU$PACK2
         4 000550   000000 011000                    NOP     0

      506    12049    2        CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);

  12049  4 000551   200014 630500                    EPPR0   CHANHI,,AUTO
         4 000552   200103 450500                    STP0    D$+3,,AUTO
         4 000553   200104 452500                    STP2    D$+4,,AUTO
         4 000554   200104 236100                    LDQ     D$+4,,AUTO
         4 000555   000050 036000 5                  ADLQ    40
         4 000556   200102 756100                    STQ     D$+2,,AUTO
         4 000557   200102 630500                    EPPR0   D$+2,,AUTO
         4 000560   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000561   000000 701000 xent               TSX1    KSU$PACK2
         4 000562   000000 011000                    NOP     0

      507    12050    2        CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);

  12050  4 000563   200027 630500                    EPPR0   SUBLO,,AUTO
         4 000564   200103 450500                    STP0    D$+3,,AUTO
         4 000565   200041 631500                    EPPR1   TERMLO+1,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:97   
         4 000566   200102 451500                    STP1    D$+2,,AUTO
         4 000567   200102 630500                    EPPR0   D$+2,,AUTO
         4 000570   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000571   000000 701000 xent               TSX1    KSU$PACK2
         4 000572   000000 011000                    NOP     0

      508    12051    2        CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);

  12051  4 000573   200030 630500                    EPPR0   SUBHI,,AUTO
         4 000574   200103 450500                    STP0    D$+3,,AUTO
         4 000575   200045 631500                    EPPR1   TERMHI+1,,AUTO
         4 000576   200102 451500                    STP1    D$+2,,AUTO
         4 000577   200102 630500                    EPPR0   D$+2,,AUTO
         4 000600   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000601   000000 701000 xent               TSX1    KSU$PACK2
         4 000602   000000 011000                    NOP     0

      509    12052    2        CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);

  12052  4 000603   200032 630500                    EPPR0   SUBSUBLO,,AUTO
         4 000604   200103 450500                    STP0    D$+3,,AUTO
         4 000605   200104 452500                    STP2    D$+4,,AUTO
         4 000606   200104 236100                    LDQ     D$+4,,AUTO
         4 000607   000051 036000 5                  ADLQ    41
         4 000610   200102 756100                    STQ     D$+2,,AUTO
         4 000611   200102 630500                    EPPR0   D$+2,,AUTO
         4 000612   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000613   000000 701000 xent               TSX1    KSU$PACK2
         4 000614   000000 011000                    NOP     0

      510    12053    2        CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);

  12053  4 000615   200033 630500                    EPPR0   SUBSUBHI,,AUTO
         4 000616   200103 450500                    STP0    D$+3,,AUTO
         4 000617   200104 452500                    STP2    D$+4,,AUTO
         4 000620   200104 236100                    LDQ     D$+4,,AUTO
         4 000621   000052 036000 5                  ADLQ    42
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:98   
         4 000622   200102 756100                    STQ     D$+2,,AUTO
         4 000623   200102 630500                    EPPR0   D$+2,,AUTO
         4 000624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000625   000000 701000 xent               TSX1    KSU$PACK2
         4 000626   000000 011000                    NOP     0

      511    12054
      512    12055    2   C_LOOP:
      513    12056    3        DO CHAN = CHANLO TO CHANHI BY 128;

  12056  4 000627   200020 235100       C_LOOP       LDA     CHANLO,,AUTO
         4 000630   200013 755100                    STA     CHAN,,AUTO
         4 000631   001055 710000 4                  TRA     s:12106+3

      514    12057    3           CALL KSU$UNPACK (CHAN,TERMLO.TERM.CHANNEL);

  12057  4 000632   200104 452500                    STP2    D$+4,,AUTO
         4 000633   200104 236100                    LDQ     D$+4,,AUTO
         4 000634   000047 036000 5                  ADLQ    39
         4 000635   200103 756100                    STQ     D$+3,,AUTO
         4 000636   200013 630500                    EPPR0   CHAN,,AUTO
         4 000637   200102 450500                    STP0    D$+2,,AUTO
         4 000640   200102 630500                    EPPR0   D$+2,,AUTO
         4 000641   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000642   000000 701000 xent               TSX1    KSU$UNPACK
         4 000643   000000 011000                    NOP     0

      515    12058    4   S_LOOP: DO SUB = SUBLO TO SUBHI;

  12058  4 000644   200027 235100       S_LOOP       LDA     SUBLO,,AUTO
         4 000645   200026 755100                    STA     SUB,,AUTO
         4 000646   001047 710000 4                  TRA     s:12105+3

      516    12059    4              CALL KSU$UNPACK (SUB,TERMLO.TERM.SUBDEVICE);

  12059  4 000647   200041 630500                    EPPR0   TERMLO+1,,AUTO
         4 000650   200103 450500                    STP0    D$+3,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:99   
         4 000651   200026 631500                    EPPR1   SUB,,AUTO
         4 000652   200102 451500                    STP1    D$+2,,AUTO
         4 000653   200102 630500                    EPPR0   D$+2,,AUTO
         4 000654   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000655   000000 701000 xent               TSX1    KSU$UNPACK
         4 000656   000000 011000                    NOP     0

      517    12060    5   SS_LOOP:   DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  12060  4 000657   200032 235100       SS_LOOP      LDA     SUBSUBLO,,AUTO
         4 000660   200031 755100                    STA     SUBSUB,,AUTO
         4 000661   001041 710000 4                  TRA     s:12104+3

      518    12061    5                 CALL KSU$UNPACK (SUBSUB,TERMLO.TERM.SUBSUBDEVICE);

  12061  4 000662   200104 452500                    STP2    D$+4,,AUTO
         4 000663   200104 236100                    LDQ     D$+4,,AUTO
         4 000664   000051 036000 5                  ADLQ    41
         4 000665   200103 756100                    STQ     D$+3,,AUTO
         4 000666   200031 630500                    EPPR0   SUBSUB,,AUTO
         4 000667   200102 450500                    STP0    D$+2,,AUTO
         4 000670   200102 630500                    EPPR0   D$+2,,AUTO
         4 000671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000672   000000 701000 xent               TSX1    KSU$UNPACK
         4 000673   000000 011000                    NOP     0

      519    12062
      520    12063    5                 IF NOT NO_CHAN THEN

  12063  4 000674   200051 234100                    SZN     NO_CHAN,,AUTO
         4 000675   001011 604000 4                  TMI     CHANGE_REC

      521    12064    6                    DO;

      522    12065    6                       KS_ADMIN.TERMID_LO = TERMLO;

  12065  4 000676   000000 100500                    MLR     fill='000'O
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:100  
         4 000677   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000700   000237 000020 2                  ADSC9   KS_ADMIN+9               cn=0,n=16

      523    12066    6                       KS_ADMIN.TERMID_HI = TERMLO;

  12066  4 000701   000000 100500                    MLR     fill='000'O
         4 000702   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000703   000243 000020 2                  ADSC9   KS_ADMIN+13              cn=0,n=16

      524    12067    6                       RESET_MSG.TERMID_LO = TERMLO;

  12067  4 000704   000000 100500                    MLR     fill='000'O
         4 000705   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000706   000330 400020 2                  ADSC9   RESET_MSG+8              cn=2,n=16

      525    12068    6                       RESET_MSG.TERMID_HI = TERMLO;

  12068  4 000707   000000 100500                    MLR     fill='000'O
         4 000710   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 000711   000334 400020 2                  ADSC9   RESET_MSG+12             cn=2,n=16

      526    12069
      527    12070    6                       KS_ADMIN.FNC = %KHA_FNC_PARTITION;

  12070  4 000712   000007 220003                    LDX0    7,DU
         4 000713   000236 440000 2                  SXL0    KS_ADMIN+8

      528    12071    6                       CALL KSR$WR_HLPCG (VECTOR(KS_ADMIN)) ALTRET(RESET_CHAN);

  12071  4 000714   000006 630400 5                  EPPR0   6
         4 000715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000716   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 000717   000770 702000 4                  TSX2    RESET_CHAN

      529    12072    6                       CALL KSR$RD_HLPCG ('0'B);

  12072  4 000720   000053 630400 5                  EPPR0   43
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:101  
         4 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000722   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 000723   000000 011000                    NOP     0

      530    12073    6                       IF KS_DEFAULT_KEY.HNDLR ~= KL_ADMIN_RETURN.HANDLER AND

  12073  4 000724   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000725   040100 106400                    CMPC    fill='040'O
         4 000726   000247 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8
         4 000727   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         4 000730   000770 600000 4                  TZE     RESET_CHAN
         4 000731   000007 235100                    LDA     7,,PR0
         4 000732   000770 601000 4                  TNZ     RESET_CHAN
         4 000733   200003 471500                    LDP1    @TOP$,,AUTO
         4 000734   100000 473500                    LDP3    0,,PR1
         4 000735   300001 220100                    LDX0    1,,PR3
         4 000736   000001 100003                    CMPX0   1,DU
         4 000737   000770 600000 4                  TZE     RESET_CHAN

      531    12074    6                          KL_ADMIN_RETURN.RESULTS = '0'B AND
      532    12075    6                          TOP$->OUT$BLK.NSUBLKS ~= 1 THEN
      533    12076    7                          DO;

      534    12077    7                             CALL KSU$BINHEX (CHAN_STR,CHAN);

  12077  4 000740   200013 634500                    EPPR4   CHAN,,AUTO
         4 000741   200103 454500                    STP4    D$+3,,AUTO
         4 000742   200052 633500                    EPPR3   CHAN_STR,,AUTO
         4 000743   200102 453500                    STP3    D$+2,,AUTO
         4 000744   200102 630500                    EPPR0   D$+2,,AUTO
         4 000745   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000746   000000 701000 xent               TSX1    KSU$BINHEX
         4 000747   000000 011000                    NOP     0

      535    12078    7                             CALL KSE$ERRMSG(%E$KS_WRONG_HANDLER,VECTOR(CHAN_STR),
             12078                                      VECTOR(KS_DEFAULT_KEY.HNDLR));

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:102  
  12078  4 000750   777640 235007                    LDA     -96,DL
         4 000751   200102 452500                    STP2    D$+2,,AUTO
         4 000752   200102 236100                    LDQ     D$+2,,AUTO
         4 000753   000052 036003                    ADLQ    42,DU
         4 000754   200104 757100                    STAQ    D$+4,,AUTO
         4 000755   000044 236000 5                  LDQ     36
         4 000756   200110 756100                    STQ     D$+8,,AUTO
         4 000757   200104 630500                    EPPR0   D$+4,,AUTO
         4 000760   200107 450500                    STP0    D$+7,,AUTO
         4 000761   000055 236000 5                  LDQ     45
         4 000762   200106 756100                    STQ     D$+6,,AUTO
         4 000763   200106 630500                    EPPR0   D$+6,,AUTO
         4 000764   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000765   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000766   000000 011000                    NOP     0

      536    12079                               /*E* ERROR: KSN-E$KS_WRONG_HANDLER-0
      537    12080                                  MESSAGE: Channel .%U1 is not owned by the %U2 handler. */
      538    12081    7                             EXIT S_LOOP;

  12081  4 000767   001052 710000 4                  TRA     s:12106

      539    12082    7                          END;
      540    12083
      541    12084
      542    12085    6      RESET_CHAN:      CALL KSR$WR_HLPCG (VECTOR(RESET_MSG)) ALTRET (CHANGE_REC);

  12085  4 000770   000060 630400 5     RESET_CHAN   EPPR0   48
         4 000771   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000772   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 000773   001011 702000 4                  TSX2    CHANGE_REC

      543    12086    6                       CALL KSR$RD_HLPCG ALTRET (ERR);

  12086  4 000774   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000775   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 000776   002107 702000 4                  TSX2    ERR
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:103  

      544    12087
      545    12088    6                       KS_ADMIN.FNC = %KHA_FNC_RETURN;

  12088  4 000777   000011 220003                    LDX0    9,DU
         4 001000   000236 440000 2                  SXL0    KS_ADMIN+8

      546    12089    6                       CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET (CHANGE_REC);

  12089  4 001001   000006 630400 5                  EPPR0   6
         4 001002   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001003   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 001004   001011 702000 4                  TSX2    CHANGE_REC

      547    12090    6                       CALL KSR$RD_HLPCG ('0') ALTRET (CHANGE_REC);

  12090  4 001005   000062 630400 5                  EPPR0   50
         4 001006   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001007   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 001010   001011 702000 4                  TSX2    CHANGE_REC

      548    12091    6                    END;

      549    12092
      550    12093    5   CHANGE_REC:   KS_CONFIG_KEY.NODE = KS_NODE;

  12093  4 001011   000000 236000 xsym  CHANGE_REC   LDQ     KS_NODE
         4 001012   000011 736000                    QLS     9
         4 001013   000347 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

      551    12094    5                 KS_CONFIG_KEY.TERMID = TERMLO;

  12094  4 001014   000000 100500                    MLR     fill='000'O
         4 001015   200040 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 001016   000347 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16

      552    12095    5                 IF TERMHI.TERM.TERM_NAME ~= ' ' THEN
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:104  

  12095  4 001017   200046 237100                    LDAQ    TERMHI+2,,AUTO
         4 001020   000000 117000 5                  CMPAQ   0
         4 001021   001027 600000 4                  TZE     s:12100

      553    12096    6                    DO;

      554    12097    6                       KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;

  12097  4 001022   000000 236003                    LDQ     0,DU
         4 001023   000350 552030 2                  STBQ    KS_CONFIG_KEY+1,'30'O

      555    12098    6                       KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = TERMHI.TERM.TERM_NAME;

  12098  4 001024   040000 100500                    MLR     fill='040'O
         4 001025   200046 000010                    ADSC9   TERMHI+2,,AUTO           cn=0,n=8
         4 001026   000351 600010 2                  ADSC9   KS_CONFIG_KEY+2          cn=3,n=8

      556    12099    6                    END;

      557    12100    5                 DELETE_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

  12100  4 001027   000064 237000 5                  LDAQ    52
         4 001030   000410 757000 2                  STAQ    DELETE_NETCON+2

      558    12101    5                 DELETE_NETCON.LKEY_ = VECTOR(KS_CONFIG_KEY);

  12101  4 001031   000064 237000 5                  LDAQ    52
         4 001032   000412 757000 2                  STAQ    DELETE_NETCON+4

      559    12102    5                 CALL M$DELREC (DELETE_NETCON);

  12102  4 001033   000406 630400 2                  EPPR0   DELETE_NETCON
         4 001034   040002 713400                    CLIMB   16386
         4 001035   401400 401760                    pmme    nvectors=4

      560    12103
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:105  
      561    12104    5              END SS_LOOP;

  12104  4 001036   200031 235100                    LDA     SUBSUB,,AUTO
         4 001037   000001 035007                    ADLA    1,DL
         4 001040   200031 755100                    STA     SUBSUB,,AUTO
         4 001041   200033 236100                    LDQ     SUBSUBHI,,AUTO
         4 001042   200031 116100                    CMPQ    SUBSUB,,AUTO
         4 001043   000662 603000 4                  TRC     s:12061

      562    12105    4           END S_LOOP;

  12105  4 001044   200026 235100                    LDA     SUB,,AUTO
         4 001045   000001 035007                    ADLA    1,DL
         4 001046   200026 755100                    STA     SUB,,AUTO
         4 001047   200030 236100                    LDQ     SUBHI,,AUTO
         4 001050   200026 116100                    CMPQ    SUB,,AUTO
         4 001051   000647 603000 4                  TRC     s:12059

      563    12106    3        END C_LOOP;

  12106  4 001052   200013 235100                    LDA     CHAN,,AUTO
         4 001053   000200 035007                    ADLA    128,DL
         4 001054   200013 755100                    STA     CHAN,,AUTO
         4 001055   200014 236100                    LDQ     CHANHI,,AUTO
         4 001056   200013 116100                    CMPQ    CHAN,,AUTO
         4 001057   000632 603000 4                  TRC     s:12057

      564    12107    2        IF KS_SELPRMOPT ~= %KS_FILE THEN

  12107  4 001060   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 001061   777000 376003                    ANQ     -512,DU
         4 001062   003000 116003                    CMPQ    1536,DU
         4 001063   002106 600000 4                  TZE     s:12292

      565    12108    3           DO;

      566    12109    3              ACTION_CMPLTED = 'Reset';
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:106  

  12109  4 001064   040100 100400                    MLR     fill='040'O
         4 001065   000131 000005 1                  ADSC9   ENBL_FMT+23              cn=0,n=5
         4 001066   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      567    12110    3              CALL KSW$WRITE (CMPLTED_OK_VEC,

  12110  4 001067   000007 235000 5                  LDA     7
         4 001070   200102 452500                    STP2    D$+2,,AUTO
         4 001071   200102 236100                    LDQ     D$+2,,AUTO
         4 001072   000065 036003                    ADLQ    53,DU
         4 001073   200104 757100                    STAQ    D$+4,,AUTO
         4 001074   000007 235000 5                  LDA     7
         4 001075   200106 452500                    STP2    D$+6,,AUTO
         4 001076   200106 236100                    LDQ     D$+6,,AUTO
         4 001077   000071 036003                    ADLQ    57,DU
         4 001100   200110 757100                    STAQ    D$+8,,AUTO
         4 001101   000010 235000 5                  LDA     8
         4 001102   200112 452500                    STP2    D$+10,,AUTO
         4 001103   200112 236100                    LDQ     D$+10,,AUTO
         4 001104   000004 036003                    ADLQ    4,DU
         4 001105   200116 757100                    STAQ    D$+14,,AUTO
         4 001106   200104 237100                    LDAQ    D$+4,,AUTO
         4 001107   200114 757100                    STAQ    D$+12,,AUTO
         4 001110   200110 237100                    LDAQ    D$+8,,AUTO
         4 001111   200120 757100                    STAQ    D$+16,,AUTO
         4 001112   200116 237100                    LDAQ    D$+14,,AUTO
         4 001113   200122 757100                    STAQ    D$+18,,AUTO
         4 001114   000070 236000 5                  LDQ     56
         4 001115   200130 756100                    STQ     D$+24,,AUTO
         4 001116   200122 630500                    EPPR0   D$+18,,AUTO
         4 001117   200127 450500                    STP0    D$+23,,AUTO
         4 001120   200120 631500                    EPPR1   D$+16,,AUTO
         4 001121   200126 451500                    STP1    D$+22,,AUTO
         4 001122   200114 633500                    EPPR3   D$+12,,AUTO
         4 001123   200125 453500                    STP3    D$+21,,AUTO
         4 001124   000011 236000 5                  LDQ     9
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:107  
         4 001125   200124 756100                    STQ     D$+20,,AUTO
         4 001126   200124 630500                    EPPR0   D$+20,,AUTO
         4 001127   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 001130   000000 701000 xent               TSX1    KSW$WRITE
         4 001131   000000 011000                    NOP     0

      568    12111    3                 VECTOR(FEPLO),
      569    12112    3                 VECTOR(FEPHI),
      570    12113    3                 VECTOR(ACTION_CMPLTED),
      571    12114    3                 VECTOR(KS_CONFIG_KEY.TERMID.TERM.TERM_NAME));
      572    12115    3           END;

  12115  4 001132   002106 710000 4                  TRA     s:12292

      573    12116
      574    12117        %EJECT;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:108  
      575    12118    2           CASE(%KS_CONFIG);

      576    12119    2              NO_CHAN = '0'B;

  12119  4 001133   200051 450100                    STZ     NO_CHAN,,AUTO

      577    12120    2             KS_HLPCGERR = '0'B;

  12120  4 001134   200075 450100                    STZ     KS_HLPCGERR,,AUTO

      578    12121    2              CALL KSU$BLD_TERMRANGE (OUT$BLK.SUBLK$(0),TERMLO,TERMHI,'1')

  12121  4 001135   000033 236000 5                  LDQ     27
         4 001136   200105 756100                    STQ     D$+5,,AUTO
         4 001137   200044 633500                    EPPR3   TERMHI,,AUTO
         4 001140   200104 453500                    STP3    D$+4,,AUTO
         4 001141   200040 634500                    EPPR4   TERMLO,,AUTO
         4 001142   200103 454500                    STP4    D$+3,,AUTO
         4 001143   100003 635500                    EPPR5   3,,PR1
         4 001144   200102 455500                    STP5    D$+2,,AUTO
         4 001145   200102 630500                    EPPR0   D$+2,,AUTO
         4 001146   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001147   000000 701000 xent               TSX1    KSU$BLD_TERMRANGE
         4 001150   001152 702000 4                  TSX2    s:12123
         4 001151   001162 710000 4                  TRA     s:12130

      579    12122    3                 WHENALTRETURN DO;

      580    12123    3                    IF TERMLO.TERM.TERM_NAME ~= ' ' AND

  12123  4 001152   200042 237100                    LDAQ    TERMLO+2,,AUTO
         4 001153   000000 117000 5                  CMPAQ   0
         4 001154   002113 600000 4                  TZE     ERR1
         4 001155   200040 720100                    LXL0    TERMLO,,AUTO
         4 001156   002113 601000 4                  TNZ     ERR1

      581    12124    3                       TERMLO.TERM.CHANNEL = '0'B THEN
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:109  
      582    12125    3                       NO_CHAN = '1'B;

  12125  4 001157   400000 236003                    LDQ     -131072,DU
         4 001160   200051 756100                    STQ     NO_CHAN,,AUTO
         4 001161   001162 710000 4                  TRA     s:12130

      583    12126    3                    ELSE
      584    12127    3                       GOTO ERR1;
      585    12128    3                 END;
      586    12129
      587    12130    2              IF TERMLO.TERM.TERM_NAME ~= ' ' THEN

  12130  4 001162   200042 237100                    LDAQ    TERMLO+2,,AUTO
         4 001163   000000 117000 5                  CMPAQ   0
         4 001164   001246 600000 4                  TZE     s:12155

      588    12131    3                 DO;

      589    12132    3                    CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),FEPLO)

  12132  4 001165   200003 470500                    LDP0    @TOP$,,AUTO
         4 001166   000000 471500                    LDP1    0,,PR0
         4 001167   100003 473500                    LDP3    3,,PR1
         4 001170   200065 634500                    EPPR4   FEPLO,,AUTO
         4 001171   200103 454500                    STP4    D$+3,,AUTO
         4 001172   300003 631500                    EPPR1   3,,PR3
         4 001173   200102 451500                    STP1    D$+2,,AUTO
         4 001174   200102 630500                    EPPR0   D$+2,,AUTO
         4 001175   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001176   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 001177   001201 702000 4                  TSX2    s:12134
         4 001200   001205 710000 4                  TRA     s:12138

      590    12133    4                         WHENALTRETURN DO;

      591    12134    4                            IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:110  
  12134  4 001201   000000 236000 xsym               LDQ     KS_ERRCODE
         4 001202   377770 376007                    ANQ     131064,DL
         4 001203   000270 116007                    CMPQ    184,DL
         4 001204   002107 601000 4                  TNZ     ERR

      592    12135    4                            THEN GOTO ERR;
      593    12136    4                         END;  /* altret on feplo */

      594    12137
      595    12138    3                    IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN

  12138  4 001205   200003 470500                    LDP0    @TOP$,,AUTO
         4 001206   000000 471500                    LDP1    0,,PR0
         4 001207   100003 473500                    LDP3    3,,PR1
         4 001210   300001 220100                    LDX0    1,,PR3
         4 001211   000002 100003                    CMPX0   2,DU
         4 001212   001246 601000 4                  TNZ     s:12155

      596    12139    4                       DO;

      597    12140    4                        CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1),FEPHI
             12140                                  )

  12140  4 001213   200071 634500                    EPPR4   FEPHI,,AUTO
         4 001214   200103 454500                    STP4    D$+3,,AUTO
         4 001215   300004 631500                    EPPR1   4,,PR3
         4 001216   200102 451500                    STP1    D$+2,,AUTO
         4 001217   200102 630500                    EPPR0   D$+2,,AUTO
         4 001220   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001221   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 001222   001224 702000 4                  TSX2    s:12142
         4 001223   001230 710000 4                  TRA     s:12146

      598    12141    5                              WHENALTRETURN DO;

      599    12142    5                                 IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:111  
  12142  4 001224   000000 236000 xsym               LDQ     KS_ERRCODE
         4 001225   377770 376007                    ANQ     131064,DL
         4 001226   000270 116007                    CMPQ    184,DL
         4 001227   002113 601000 4                  TNZ     ERR1

      600    12143    5                                 THEN GOTO ERR1;
      601    12144    5                              END;  /* altret on fephi */

      602    12145
      603    12146    4                         CALL KSU$CHK_TRM_RNG(FEPLO,FEPHI)

  12146  4 001230   200071 630500                    EPPR0   FEPHI,,AUTO
         4 001231   200103 450500                    STP0    D$+3,,AUTO
         4 001232   200065 631500                    EPPR1   FEPLO,,AUTO
         4 001233   200102 451500                    STP1    D$+2,,AUTO
         4 001234   200102 630500                    EPPR0   D$+2,,AUTO
         4 001235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001236   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 001237   001241 702000 4                  TSX2    s:12149
         4 001240   001246 710000 4                  TRA     s:12155

      604    12147
      605    12148    5                              WHENALTRETURN DO;

      606    12149    5                                 CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);

  12149  4 001241   000072 630400 5                  EPPR0   58
         4 001242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001243   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001244   000000 011000                    NOP     0

      607    12150    5                                 GOTO ERR1;

  12150  4 001245   002113 710000 4                  TRA     ERR1

      608    12151    5                              END;
      609    12152    4                       END;
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:112  

      610    12153    3                 END;

      611    12154
      612    12155    2              IF NOT NO_CHAN THEN

  12155  4 001246   200051 234100                    SZN     NO_CHAN,,AUTO
         4 001247   001254 604000 4                  TMI     s:12158

      613    12156    2                 CALL KSU$CHECK_FOR_FEP (KS_NODE) ALTRET(ERR1);

  12156  4 001250   000002 630400 5                  EPPR0   2
         4 001251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001252   000000 701000 xent               TSX1    KSU$CHECK_FOR_FEP
         4 001253   002113 702000 4                  TSX2    ERR1

      614    12157
      615    12158    2              TERM_NAME = TERMLO.TERM.TERM_NAME;

  12158  4 001254   200042 237100                    LDAQ    TERMLO+2,,AUTO
         4 001255   200053 755100                    STA     TERM_NAME,,AUTO
         4 001256   200054 756100                    STQ     TERM_NAME+1,,AUTO

      616    12159    2                    IF TERM_NAME ~= ' ' THEN

  12159  4 001257   040000 106500                    CMPC    fill='040'O
         4 001260   200053 000010                    ADSC9   TERM_NAME,,AUTO          cn=0,n=8
         4 001261   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001262   001277 600000 4                  TZE     s:12168

      617    12160    3                       DO;

      618    12161    3                          TERMLO.TERM.TERM_NAME = TERM_NAME;

  12161  4 001263   040100 100500                    MLR     fill='040'O
         4 001264   200053 000010                    ADSC9   TERM_NAME,,AUTO          cn=0,n=8
         4 001265   200042 000010                    ADSC9   TERMLO+2,,AUTO           cn=0,n=8
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:113  

      619    12162    3                          TERMHI.TERM.TERM_NAME = TERM_NAME;

  12162  4 001266   040100 100500                    MLR     fill='040'O
         4 001267   200053 000010                    ADSC9   TERM_NAME,,AUTO          cn=0,n=8
         4 001270   200046 000010                    ADSC9   TERMHI+2,,AUTO           cn=0,n=8

      620    12163    3                          TERMLO.TERM.CHANNEL = '0'B;

  12163  4 001271   000000 220003                    LDX0    0,DU
         4 001272   200040 440100                    SXL0    TERMLO,,AUTO

      621    12164    3                          TERMHI.TERM.CHANNEL = '0'B;

  12164  4 001273   200044 440100                    SXL0    TERMHI,,AUTO

      622    12165    3                          KS_CONFIG_KEY.NODE = 0;

  12165  4 001274   000000 236003                    LDQ     0,DU
         4 001275   000347 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

      623    12166    3                       END;

  12166  4 001276   001302 710000 4                  TRA     s:12170

      624    12167    2                    ELSE
      625    12168    2                       KS_CONFIG_KEY.NODE = KS_NODE;

  12168  4 001277   000000 236000 xsym               LDQ     KS_NODE
         4 001300   000011 736000                    QLS     9
         4 001301   000347 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

      626    12169
      627    12170    2                    KS_CONFIG_KEY.TERMID.LEV = TERMLO.LEV;

  12170  4 001302   200040 236100                    LDQ     TERMLO,,AUTO
         4 001303   000011 736000                    QLS     9
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:114  
         4 001304   000350 552040 2                  STBQ    KS_CONFIG_KEY+1,'40'O

      628    12171    2                    KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = TERM_NAME;

  12171  4 001305   040000 100500                    MLR     fill='040'O
         4 001306   200053 000010                    ADSC9   TERM_NAME,,AUTO          cn=0,n=8
         4 001307   000351 600010 2                  ADSC9   KS_CONFIG_KEY+2          cn=3,n=8

      629    12172    2                    CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);

  12172  4 001310   200020 630500                    EPPR0   CHANLO,,AUTO
         4 001311   200103 450500                    STP0    D$+3,,AUTO
         4 001312   200104 452500                    STP2    D$+4,,AUTO
         4 001313   200104 236100                    LDQ     D$+4,,AUTO
         4 001314   000047 036000 5                  ADLQ    39
         4 001315   200102 756100                    STQ     D$+2,,AUTO
         4 001316   200102 630500                    EPPR0   D$+2,,AUTO
         4 001317   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001320   000000 701000 xent               TSX1    KSU$PACK2
         4 001321   000000 011000                    NOP     0

      630    12173    2                    CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);

  12173  4 001322   200014 630500                    EPPR0   CHANHI,,AUTO
         4 001323   200103 450500                    STP0    D$+3,,AUTO
         4 001324   200104 452500                    STP2    D$+4,,AUTO
         4 001325   200104 236100                    LDQ     D$+4,,AUTO
         4 001326   000050 036000 5                  ADLQ    40
         4 001327   200102 756100                    STQ     D$+2,,AUTO
         4 001330   200102 630500                    EPPR0   D$+2,,AUTO
         4 001331   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001332   000000 701000 xent               TSX1    KSU$PACK2
         4 001333   000000 011000                    NOP     0

      631    12174    2                    CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);

  12174  4 001334   200027 630500                    EPPR0   SUBLO,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:115  
         4 001335   200103 450500                    STP0    D$+3,,AUTO
         4 001336   200041 631500                    EPPR1   TERMLO+1,,AUTO
         4 001337   200102 451500                    STP1    D$+2,,AUTO
         4 001340   200102 630500                    EPPR0   D$+2,,AUTO
         4 001341   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001342   000000 701000 xent               TSX1    KSU$PACK2
         4 001343   000000 011000                    NOP     0

      632    12175    2                    CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);

  12175  4 001344   200030 630500                    EPPR0   SUBHI,,AUTO
         4 001345   200103 450500                    STP0    D$+3,,AUTO
         4 001346   200045 631500                    EPPR1   TERMHI+1,,AUTO
         4 001347   200102 451500                    STP1    D$+2,,AUTO
         4 001350   200102 630500                    EPPR0   D$+2,,AUTO
         4 001351   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001352   000000 701000 xent               TSX1    KSU$PACK2
         4 001353   000000 011000                    NOP     0

      633    12176    2                    CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);

  12176  4 001354   200032 630500                    EPPR0   SUBSUBLO,,AUTO
         4 001355   200103 450500                    STP0    D$+3,,AUTO
         4 001356   200104 452500                    STP2    D$+4,,AUTO
         4 001357   200104 236100                    LDQ     D$+4,,AUTO
         4 001360   000051 036000 5                  ADLQ    41
         4 001361   200102 756100                    STQ     D$+2,,AUTO
         4 001362   200102 630500                    EPPR0   D$+2,,AUTO
         4 001363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001364   000000 701000 xent               TSX1    KSU$PACK2
         4 001365   000000 011000                    NOP     0

      634    12177    2                    CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);

  12177  4 001366   200033 630500                    EPPR0   SUBSUBHI,,AUTO
         4 001367   200103 450500                    STP0    D$+3,,AUTO
         4 001370   200104 452500                    STP2    D$+4,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:116  
         4 001371   200104 236100                    LDQ     D$+4,,AUTO
         4 001372   000052 036000 5                  ADLQ    42
         4 001373   200102 756100                    STQ     D$+2,,AUTO
         4 001374   200102 630500                    EPPR0   D$+2,,AUTO
         4 001375   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001376   000000 701000 xent               TSX1    KSU$PACK2
         4 001377   000000 011000                    NOP     0

      635    12178
      636    12179    3   CON_C_LOOP:      DO CHAN = CHANLO TO CHANHI BY 128;

  12179  4 001400   200020 235100       CON_C_LOOP   LDA     CHANLO,,AUTO
         4 001401   200013 755100                    STA     CHAN,,AUTO
         4 001402   001737 710000 4                  TRA     s:12270+3

      637    12180    3                    CALL KSU$UNPACK (CHAN,KS_CONFIG_KEY.TERMID.TERM.CHANNEL);

  12180  4 001403   000073 236000 5                  LDQ     59
         4 001404   200103 756100                    STQ     D$+3,,AUTO
         4 001405   200013 630500                    EPPR0   CHAN,,AUTO
         4 001406   200102 450500                    STP0    D$+2,,AUTO
         4 001407   200102 630500                    EPPR0   D$+2,,AUTO
         4 001410   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001411   000000 701000 xent               TSX1    KSU$UNPACK
         4 001412   000000 011000                    NOP     0

      638    12181    4   CON_S_LOOP:         DO SUB = SUBLO TO SUBHI;

  12181  4 001413   200027 235100       CON_S_LOOP   LDA     SUBLO,,AUTO
         4 001414   200026 755100                    STA     SUB,,AUTO
         4 001415   001731 710000 4                  TRA     s:12269+3

      639    12182    4                          CALL KSU$UNPACK (SUB,KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE);

  12182  4 001416   000074 236000 5                  LDQ     60
         4 001417   200103 756100                    STQ     D$+3,,AUTO
         4 001420   200026 630500                    EPPR0   SUB,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:117  
         4 001421   200102 450500                    STP0    D$+2,,AUTO
         4 001422   200102 630500                    EPPR0   D$+2,,AUTO
         4 001423   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001424   000000 701000 xent               TSX1    KSU$UNPACK
         4 001425   000000 011000                    NOP     0

      640    12183    5   CON_SS_LOOP:           DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  12183  4 001426   200032 235100       CON_SS_LOOP  LDA     SUBSUBLO,,AUTO
         4 001427   200031 755100                    STA     SUBSUB,,AUTO
         4 001430   001723 710000 4                  TRA     s:12268+3

      641    12184    5                             CALL KSU$UNPACK (SUBSUB,KS_CONFIG_KEY.TERMID.TERM.
             12184                                      SUBSUBDEVICE);

  12184  4 001431   000075 236000 5                  LDQ     61
         4 001432   200103 756100                    STQ     D$+3,,AUTO
         4 001433   200031 630500                    EPPR0   SUBSUB,,AUTO
         4 001434   200102 450500                    STP0    D$+2,,AUTO
         4 001435   200102 630500                    EPPR0   D$+2,,AUTO
         4 001436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001437   000000 701000 xent               TSX1    KSU$UNPACK
         4 001440   000000 011000                    NOP     0

      642    12185
      643    12186    5                             CALL KSU$READ_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(
             12186                                      CNFG_BUF))

  12186  4 001441   000076 630400 5                  EPPR0   62
         4 001442   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001443   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 001444   001451 702000 4                  TSX2    s:12191

      644    12187    6                                WHENRETURN DO;

      645    12188    6                                   LINCNFG.NA.CNFG_EXISTS = '1'B;

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:118  
  12188  4 001445   000062 470400 2                  LDP0    CNFG$
         4 001446   000002 236007                    LDQ     2,DL
         4 001447   000004 256100                    ORSQ    4,,PR0

      646    12189    6                                END;

  12189  4 001450   001463 710000 4                  TRA     s:12197

      647    12190    6                                WHENALTRETURN DO;

      648    12191    6                                   IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
             12191                                            THEN

  12191  4 001451   000000 470400 xsym               LDP0    B$TCB$
         4 001452   000000 471500                    LDP1    0,,PR0
         4 001453   100102 236100                    LDQ     66,,PR1
         4 001454   377770 376007                    ANQ     131064,DL
         4 001455   001020 116007                    CMPQ    528,DL
         4 001456   002107 601000 4                  TNZ     ERR

      649    12192    6                                      LINCNFG.NA.CNFG_EXISTS = '0'B;

  12192  4 001457   000062 473400 2                  LDP3    CNFG$
         4 001460   000100 236000 5                  LDQ     64
         4 001461   300004 356100                    ANSQ    4,,PR3
         4 001462   001463 710000 4                  TRA     s:12197

      650    12193    6                                   ELSE
      651    12194    6                                      GOTO ERR;
      652    12195    6                                END;
      653    12196
      654    12197    5                             LOGON_STRING = LINCNFG.LGN.LGNSTRING;

  12197  4 001463   000062 470400 2                  LDP0    CNFG$
         4 001464   000012 236100                    LDQ     10,,PR0
         4 001465   000011 772000                    QRL     9
         4 001466   000777 376007                    ANQ     511,DL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:119  
         4 001467   000000 620006                    EAX0    0,QL
         4 001470   040100 100540                    MLR     fill='040'O
         4 001471   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0
         4 001472   200055 000037                    ADSC9   LOGON_STRING,,AUTO       cn=0,n=31

      655    12198    5                             CALL KSU$BLD_LINCNFG (TOP$,LINCNFG) ALTRET(ERR1);

  12198  4 001473   000062 236000 2                  LDQ     CNFG$
         4 001474   200003 235100                    LDA     @TOP$,,AUTO
         4 001475   200102 757100                    STAQ    D$+2,,AUTO
         4 001476   200102 630500                    EPPR0   D$+2,,AUTO
         4 001477   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001500   000000 701000 xent               TSX1    KSU$BLD_LINCNFG
         4 001501   002113 702000 4                  TSX2    ERR1

      656    12199
      657    12200    5              IF KS_SELPRMOPT ~= %KS_FILE THEN

  12200  4 001502   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 001503   777000 376003                    ANQ     -512,DU
         4 001504   003000 116003                    CMPQ    1536,DU
         4 001505   001627 600000 4                  TZE     s:12244

      658    12201    6   CONFIG_FEP:   DO;

  12201  4 001506                       CONFIG_FEP   null
      659    12202    6                    IF NO_CHAN THEN

  12202  4 001506   200051 234100                    SZN     NO_CHAN,,AUTO
         4 001507   001526 605000 4                  TPL     s:12210

      660    12203    7                       DO;

      661    12204    7                          CALL KSE$ERRMSG (%E$KS_NO_CHAN_FOR_TRM,

  12204  4 001510   000040 235000 5                  LDA     32
         4 001511   200102 452500                    STP2    D$+2,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:120  
         4 001512   200102 236100                    LDQ     D$+2,,AUTO
         4 001513   000042 036003                    ADLQ    34,DU
         4 001514   200104 757100                    STAQ    D$+4,,AUTO
         4 001515   200104 630500                    EPPR0   D$+4,,AUTO
         4 001516   200107 450500                    STP0    D$+7,,AUTO
         4 001517   000102 236000 5                  LDQ     66
         4 001520   200106 756100                    STQ     D$+6,,AUTO
         4 001521   200106 630500                    EPPR0   D$+6,,AUTO
         4 001522   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001523   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001524   000000 011000                    NOP     0

      662    12205    7                             VECTOR(TERMLO.TERM.TERM_NAME));
      663    12206    7                          GOTO CONFIG_NETCON;

  12206  4 001525   001633 710000 4                  TRA     CONFIG_NETCON

      664    12207    7                       END;
      665    12208    6                    ELSE
      666    12209    7                       DO;

      667    12210    7                          TERMLO.TERM.TERM_NAME = ' ';

  12210  4 001526   000035 235000 xsym               LDA     B_VECTNIL+29
         4 001527   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 001530   200042 757100                    STAQ    TERMLO+2,,AUTO

      668    12211    7                          TERMHI.TERM.TERM_NAME = ' ';

  12211  4 001531   000035 235000 xsym               LDA     B_VECTNIL+29
         4 001532   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 001533   200046 757100                    STAQ    TERMHI+2,,AUTO

      669    12212    7                          CNFG_MSG.TERMID_LO = KS_CONFIG_KEY.TERMID;

  12212  4 001534   000000 100400                    MLR     fill='000'O
         4 001535   000347 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:121  
         4 001536   000301 400020 2                  ADSC9   CNFG_MSG+8               cn=2,n=16

      670    12213    7                          CNFG_MSG.TERMID_HI = KS_CONFIG_KEY.TERMID;

  12213  4 001537   000000 100400                    MLR     fill='000'O
         4 001540   000347 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16
         4 001541   000305 400020 2                  ADSC9   CNFG_MSG+12              cn=2,n=16

      671    12214    7                          CNFG_MSG.KHA = LINCNFG.KHA;

  12214  4 001542   000062 470400 2                  LDP0    CNFG$
         4 001543   000000 100500                    MLR     fill='000'O
         4 001544   000000 000022                    ADSC9   0,,PR0                   cn=0,n=18
         4 001545   000311 400022 2                  ADSC9   CNFG_MSG+16              cn=2,n=18

      672    12215    7                          CNFG_MSG.NA = LINCNFG.NA;

  12215  4 001546   000000 100500                    MLR     fill='000'O
         4 001547   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
         4 001550   000316 000010 2                  ADSC9   CNFG_MSG+21              cn=0,n=8

      673    12216    7                          CNFG_MSG.NA.CNFG_EXISTS = '1'B;

  12216  4 001551   000002 236003                    LDQ     2,DU
         4 001552   000316 256000 2                  ORSQ    CNFG_MSG+21

      674    12217    8                          IF TERM_NAME ~= ' ' THEN DO;

  12217  4 001553   040000 106500                    CMPC    fill='040'O
         4 001554   200053 000010                    ADSC9   TERM_NAME,,AUTO          cn=0,n=8
         4 001555   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001556   001563 600000 4                  TZE     s:12222

      675    12218    8                             CNFG_MSG.TERMID_LO.TERM.CHANNEL = FEPLO.TERM.CHANNEL;

  12218  4 001557   200065 720100                    LXL0    FEPLO,,AUTO
         4 001560   000302 740000 2                  STX0    CNFG_MSG+9
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:122  

      676    12219    8                             CNFG_MSG.TERMID_HI.TERM.CHANNEL = FEPHI.TERM.CHANNEL;

  12219  4 001561   200071 721100                    LXL1    FEPHI,,AUTO
         4 001562   000306 741000 2                  STX1    CNFG_MSG+13

      677    12220    8                          END;

      678    12221
      679    12222    7                          CALL KSR$WR_HLPCG (VECTOR(CNFG_MSG))

  12222  4 001563   000106 630400 5                  EPPR0   70
         4 001564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001565   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 001566   001570 702000 4                  TSX2    s:12224
         4 001567   001577 710000 4                  TRA     s:12228

      680    12223    8                             WHENALTRETURN DO;

      681    12224    8                                CALL KSE$ERRMSG(0);

  12224  4 001570   000053 630400 5                  EPPR0   43
         4 001571   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001572   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001573   000000 011000                    NOP     0

      682    12225    8                           KS_HLPCGERR = '1'B;

  12225  4 001574   400000 236003                    LDQ     -131072,DU
         4 001575   200075 756100                    STQ     KS_HLPCGERR,,AUTO

      683    12226    8                                GOTO CONFIG_NETCON;

  12226  4 001576   001633 710000 4                  TRA     CONFIG_NETCON

      684    12227    8                             END;
      685    12228    7                          CALL KSR$RD_HLPCG
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:123  

  12228  4 001577   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001600   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 001601   001603 702000 4                  TSX2    s:12230
         4 001602   001627 710000 4                  TRA     s:12244

      686    12229    8                             WHENALTRETURN DO;

      687    12230    8                           KS_HLPCGERR = '1'B;

  12230  4 001603   400000 236003                    LDQ     -131072,DU
         4 001604   200075 756100                    STQ     KS_HLPCGERR,,AUTO

      688    12231    8                                IF KS$HDR.RESULTS.ERR# = %E$CHAN_NOT_THERE AND

  12231  4 001605   000225 470400 2                  LDP0    HDR$
         4 001606   000007 236100                    LDQ     7,,PR0
         4 001607   377770 376007                    ANQ     131064,DL
         4 001610   020670 116007                    CMPQ    8632,DL
         4 001611   001626 601000 4                  TNZ     s:12239
         4 001612   200040 236100                    LDQ     TERMLO,,AUTO
         4 001613   000777 376003                    ANQ     511,DU
         4 001614   000002 116003                    CMPQ    2,DU
         4 001615   001626 602000 4                  TNC     s:12239
         4 001616   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 001617   777000 376003                    ANQ     -512,DU
         4 001620   001000 116003                    CMPQ    512,DU
         4 001621   001626 600000 4                  TZE     s:12239

      689    12232    8                                   TERMLO.LEV > %TERMINAL_ID_LEV_CHAN# AND
      690    12233    8                                   KS_SELPRMOPT ~= %KS_TEMP THEN
      691    12234    9                                   DO;

      692    12235    9                                      CALL KSE$ERRMSG (%E$KS_CHAN_NOT_THERE);

  12235  4 001622   000110 630400 5                  EPPR0   72
         4 001623   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:124  
         4 001624   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001625   000000 011000                    NOP     0

      693    12236                         /*E* ERROR:  KSN-E$KS_CHAN_NOT_THERE-0
      694    12237             MESSAGE: This configuration will not take effect until the FEP is rebooted. */
      695    12238    9                                   END;

      696    12239    8                                GOTO CONFIG_NETCON;

  12239  4 001626   001633 710000 4                  TRA     CONFIG_NETCON

      697    12240    8                             END;
      698    12241    7                       END;

      699    12242    6                 END CONFIG_FEP;

      700    12243
      701    12244    5                 IF KS_SELPRMOPT ~= %KS_TEMP THEN

  12244  4 001627   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 001630   777000 376003                    ANQ     -512,DU
         4 001631   001000 116003                    CMPQ    512,DU
         4 001632   001720 600000 4                  TZE     s:12268

      702    12245    6   CONFIG_NETCON:   DO;

  12245  4 001633                       CONFIG_NETC* null
      703    12246    6                             CALL KSU$WRITE_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(
             12246                                      CNFG_BUF)) ALTRET(ERR);

  12246  4 001633   000076 630400 5                  EPPR0   62
         4 001634   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001635   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         4 001636   002107 702000 4                  TSX2    ERR

      704    12247    6                             IF LINCNFG.NA.AUTLGN ~= %KS_IGNORE THEN

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:125  
  12247  4 001637   000062 470400 2                  LDP0    CNFG$
         4 001640   000004 236100                    LDQ     4,,PR0
         4 001641   014000 376007                    ANQ     6144,DL
         4 001642   004000 116007                    CMPQ    2048,DL
         4 001643   001720 600000 4                  TZE     s:12268

      705    12248    6                                IF LINCNFG.NA.AUTLGN = %KS_NO_BIT THEN

  12248  4 001644   000004 236100                    LDQ     4,,PR0
         4 001645   014000 316007                    CANQ    6144,DL
         4 001646   001674 601000 4                  TNZ     s:12261

      706    12249    7                                   DO;

      707    12250    7                                   IF LOGON_STRING ~= ' ' THEN

  12250  4 001647   040000 106500                    CMPC    fill='040'O
         4 001650   200055 000037                    ADSC9   LOGON_STRING,,AUTO       cn=0,n=31
         4 001651   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001652   001720 600000 4                  TZE     s:12268

      708    12251    8                                      DO;

      709    12252    8                                         TERM_KEY.TERMID = '0'B;

  12252  4 001653   000000 100400                    MLR     fill='000'O
         4 001654   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001655   000264 400020 2                  ADSC9   TERM_KEY                 cn=2,n=16

      710    12253    8                                        TERM_KEY.TERMID.TERM.TERM_NAME = LOGON_STRING;

  12253  4 001656   040000 100500                    MLR     fill='040'O
         4 001657   200055 000010                    ADSC9   LOGON_STRING,,AUTO       cn=0,n=8
         4 001660   000266 400010 2                  ADSC9   TERM_KEY+2               cn=2,n=8

      711    12254    8                                         TERM_REC = '0'B;

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:126  
  12254  4 001661   000000 100400                    MLR     fill='000'O
         4 001662   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001663   000252 000023 2                  ADSC9   TERM_REC                 cn=0,n=19

      712    12255    8                                         TERM_REC.TERMID.TERM.TERM_NAME = ' ';

  12255  4 001664   040000 100400                    MLR     fill='040'O
         4 001665   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001666   000254 600010 2                  ADSC9   TERM_REC+2               cn=3,n=8

      713    12256    8                                        CALL KSU$WRITE_NETCON (VECTOR(TERM_KEY),VECTOR
             12256                                                  (TERM_REC)) ALTRET(ERR);

  12256  4 001667   000116 630400 5                  EPPR0   78
         4 001670   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001671   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         4 001672   002107 702000 4                  TSX2    ERR

      714    12257    8                                      END;

      715    12258    7                                   END;

  12258  4 001673   001720 710000 4                  TRA     s:12268

      716    12259    6                                ELSE
      717    12260    7                                   DO;

      718    12261    7                                      TERM_KEY.TERMID = '0'B;

  12261  4 001674   000000 100400                    MLR     fill='000'O
         4 001675   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001676   000264 400020 2                  ADSC9   TERM_KEY                 cn=2,n=16

      719    12262    7                                      TERM_KEY.TERMID.TERM.TERM_NAME = LINCNFG.LGN.
             12262                                               LGNSTRING;

  12262  4 001677   000012 236100                    LDQ     10,,PR0
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:127  
         4 001700   000011 772000                    QRL     9
         4 001701   000777 376007                    ANQ     511,DL
         4 001702   000000 620006                    EAX0    0,QL
         4 001703   040000 100540                    MLR     fill='040'O
         4 001704   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0
         4 001705   000266 400010 2                  ADSC9   TERM_KEY+2               cn=2,n=8

      720    12263    7                                      TERM_REC = KS_CONFIG_KEY;

  12263  4 001706   000000 100400                    MLR     fill='000'O
         4 001707   000347 000023 2                  ADSC9   KS_CONFIG_KEY            cn=0,n=19
         4 001710   000252 000023 2                  ADSC9   TERM_REC                 cn=0,n=19

      721    12264    7                                      TERM_REC.NODE = KS_NODE;

  12264  4 001711   000000 236000 xsym               LDQ     KS_NODE
         4 001712   000011 736000                    QLS     9
         4 001713   000252 552010 2                  STBQ    TERM_REC,'10'O

      722    12265    7                                      CALL KSU$WRITE_NETCON(VECTOR(TERM_KEY),VECTOR(
             12265                                               TERM_REC)) ALTRET(ERR);

  12265  4 001714   000116 630400 5                  EPPR0   78
         4 001715   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001716   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         4 001717   002107 702000 4                  TSX2    ERR

      723    12266    7                                   END;

      724    12267    6                    END CONFIG_NETCON;

      725    12268    5                          END CON_SS_LOOP;

  12268  4 001720   200031 235100                    LDA     SUBSUB,,AUTO
         4 001721   000001 035007                    ADLA    1,DL
         4 001722   200031 755100                    STA     SUBSUB,,AUTO
         4 001723   200033 236100                    LDQ     SUBSUBHI,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:128  
         4 001724   200031 116100                    CMPQ    SUBSUB,,AUTO
         4 001725   001431 603000 4                  TRC     s:12184

      726    12269    4                       END CON_S_LOOP;

  12269  4 001726   200026 235100                    LDA     SUB,,AUTO
         4 001727   000001 035007                    ADLA    1,DL
         4 001730   200026 755100                    STA     SUB,,AUTO
         4 001731   200030 236100                    LDQ     SUBHI,,AUTO
         4 001732   200026 116100                    CMPQ    SUB,,AUTO
         4 001733   001416 603000 4                  TRC     s:12182

      727    12270    3                    END CON_C_LOOP;

  12270  4 001734   200013 235100                    LDA     CHAN,,AUTO
         4 001735   000200 035007                    ADLA    128,DL
         4 001736   200013 755100                    STA     CHAN,,AUTO
         4 001737   200014 236100                    LDQ     CHANHI,,AUTO
         4 001740   200013 116100                    CMPQ    CHAN,,AUTO
         4 001741   001403 603000 4                  TRC     s:12180

      728    12271
      729    12272    2                IF (KS_SELPRMOPT ~= %KS_FILE) AND (KS_HLPCGERR = '0'B) THEN

  12272  4 001742   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 001743   777000 376003                    ANQ     -512,DU
         4 001744   003000 116003                    CMPQ    1536,DU
         4 001745   002025 600000 4                  TZE     s:12282
         4 001746   200075 234100                    SZN     KS_HLPCGERR,,AUTO
         4 001747   002025 604000 4                  TMI     s:12282

      730    12273    3                 DO;

      731    12274    3                    ACTION_CMPLTED = 'Configured in FEP';

  12274  4 001750   040100 100400                    MLR     fill='040'O
         4 001751   000133 000021 1                  ADSC9   ENBL_FMT+25              cn=0,n=17
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:129  
         4 001752   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      732    12275    3                    CALL KSW$WRITE (CMPLTED_OK_VEC,

  12275  4 001753   000007 235000 5                  LDA     7
         4 001754   200102 452500                    STP2    D$+2,,AUTO
         4 001755   200102 236100                    LDQ     D$+2,,AUTO
         4 001756   000040 036003                    ADLQ    32,DU
         4 001757   200104 757100                    STAQ    D$+4,,AUTO
         4 001760   000007 235000 5                  LDA     7
         4 001761   200106 452500                    STP2    D$+6,,AUTO
         4 001762   200106 236100                    LDQ     D$+6,,AUTO
         4 001763   000044 036003                    ADLQ    36,DU
         4 001764   200110 757100                    STAQ    D$+8,,AUTO
         4 001765   000010 235000 5                  LDA     8
         4 001766   200112 452500                    STP2    D$+10,,AUTO
         4 001767   200112 236100                    LDQ     D$+10,,AUTO
         4 001770   000004 036003                    ADLQ    4,DU
         4 001771   200114 757100                    STAQ    D$+12,,AUTO
         4 001772   000040 235000 5                  LDA     32
         4 001773   200116 452500                    STP2    D$+14,,AUTO
         4 001774   200116 236100                    LDQ     D$+14,,AUTO
         4 001775   000053 036003                    ADLQ    43,DU
         4 001776   200122 757100                    STAQ    D$+18,,AUTO
         4 001777   200104 237100                    LDAQ    D$+4,,AUTO
         4 002000   200120 757100                    STAQ    D$+16,,AUTO
         4 002001   200110 237100                    LDAQ    D$+8,,AUTO
         4 002002   200124 757100                    STAQ    D$+20,,AUTO
         4 002003   200114 237100                    LDAQ    D$+12,,AUTO
         4 002004   200126 757100                    STAQ    D$+22,,AUTO
         4 002005   200122 237100                    LDAQ    D$+18,,AUTO
         4 002006   200130 757100                    STAQ    D$+24,,AUTO
         4 002007   200130 630500                    EPPR0   D$+24,,AUTO
         4 002010   200136 450500                    STP0    D$+30,,AUTO
         4 002011   200126 631500                    EPPR1   D$+22,,AUTO
         4 002012   200135 451500                    STP1    D$+29,,AUTO
         4 002013   200124 633500                    EPPR3   D$+20,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:130  
         4 002014   200134 453500                    STP3    D$+28,,AUTO
         4 002015   200120 634500                    EPPR4   D$+16,,AUTO
         4 002016   200133 454500                    STP4    D$+27,,AUTO
         4 002017   000011 236000 5                  LDQ     9
         4 002020   200132 756100                    STQ     D$+26,,AUTO
         4 002021   200132 630500                    EPPR0   D$+26,,AUTO
         4 002022   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 002023   000000 701000 xent               TSX1    KSW$WRITE
         4 002024   000000 011000                    NOP     0

      733    12276    3                       VECTOR(TERMLO),
      734    12277    3                       VECTOR(TERMHI),
      735    12278    3                       VECTOR(ACTION_CMPLTED),
      736    12279    3                       VECTOR(TERM_NAME));
      737    12280    3                 END;

      738    12281
      739    12282    2              IF KS_SELPRMOPT ~= %KS_TEMP THEN

  12282  4 002025   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 002026   777000 376003                    ANQ     -512,DU
         4 002027   001000 116003                    CMPQ    512,DU
         4 002030   002106 600000 4                  TZE     s:12292

      740    12283    3                 DO;

      741    12284    3                    ACTION_CMPLTED = 'Configured in :NETCON';

  12284  4 002031   040100 100400                    MLR     fill='040'O
         4 002032   000140 000025 1                  ADSC9   ENBL_FMT+30              cn=0,n=21
         4 002033   200004 000025                    ADSC9   ACTION_CMPLTED,,AUTO     cn=0,n=21

      742    12285    3                    CALL KSW$WRITE (CMPLTED_OK_VEC,

  12285  4 002034   000007 235000 5                  LDA     7
         4 002035   200102 452500                    STP2    D$+2,,AUTO
         4 002036   200102 236100                    LDQ     D$+2,,AUTO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:131  
         4 002037   000040 036003                    ADLQ    32,DU
         4 002040   200104 757100                    STAQ    D$+4,,AUTO
         4 002041   000007 235000 5                  LDA     7
         4 002042   200106 452500                    STP2    D$+6,,AUTO
         4 002043   200106 236100                    LDQ     D$+6,,AUTO
         4 002044   000044 036003                    ADLQ    36,DU
         4 002045   200110 757100                    STAQ    D$+8,,AUTO
         4 002046   000010 235000 5                  LDA     8
         4 002047   200112 452500                    STP2    D$+10,,AUTO
         4 002050   200112 236100                    LDQ     D$+10,,AUTO
         4 002051   000004 036003                    ADLQ    4,DU
         4 002052   200114 757100                    STAQ    D$+12,,AUTO
         4 002053   000040 235000 5                  LDA     32
         4 002054   200116 452500                    STP2    D$+14,,AUTO
         4 002055   200116 236100                    LDQ     D$+14,,AUTO
         4 002056   000053 036003                    ADLQ    43,DU
         4 002057   200122 757100                    STAQ    D$+18,,AUTO
         4 002060   200104 237100                    LDAQ    D$+4,,AUTO
         4 002061   200120 757100                    STAQ    D$+16,,AUTO
         4 002062   200110 237100                    LDAQ    D$+8,,AUTO
         4 002063   200124 757100                    STAQ    D$+20,,AUTO
         4 002064   200114 237100                    LDAQ    D$+12,,AUTO
         4 002065   200126 757100                    STAQ    D$+22,,AUTO
         4 002066   200122 237100                    LDAQ    D$+18,,AUTO
         4 002067   200130 757100                    STAQ    D$+24,,AUTO
         4 002070   200130 630500                    EPPR0   D$+24,,AUTO
         4 002071   200136 450500                    STP0    D$+30,,AUTO
         4 002072   200126 631500                    EPPR1   D$+22,,AUTO
         4 002073   200135 451500                    STP1    D$+29,,AUTO
         4 002074   200124 633500                    EPPR3   D$+20,,AUTO
         4 002075   200134 453500                    STP3    D$+28,,AUTO
         4 002076   200120 634500                    EPPR4   D$+16,,AUTO
         4 002077   200133 454500                    STP4    D$+27,,AUTO
         4 002100   000011 236000 5                  LDQ     9
         4 002101   200132 756100                    STQ     D$+26,,AUTO
         4 002102   200132 630500                    EPPR0   D$+26,,AUTO
         4 002103   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:132  
         4 002104   000000 701000 xent               TSX1    KSW$WRITE
         4 002105   000000 011000                    NOP     0

      743    12286    3                       VECTOR(TERMLO),
      744    12287    3                       VECTOR(TERMHI),
      745    12288    3                       VECTOR(ACTION_CMPLTED),
      746    12289    3                       VECTOR(TERM_NAME));
      747    12290    3                 END;

      748    12291    2           END;  /* DO CASE */

      749    12292    2        DO WHILE('0'B);

  12292  4 002106   002117 710000 4                  TRA     s:12299

      750    12293    2   ERR:    CALL KSE$ERRMSG(0);

  12293  4 002107   000053 630400 5     ERR          EPPR0   43
         4 002110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002111   000000 701000 xent               TSX1    KSE$ERRMSG
         4 002112   000000 011000                    NOP     0

      751    12294    2   ERR1:   CALL KSE$ERRMSG(%E$KS_CANTDOIT);

  12294  4 002113   000121 630400 5     ERR1         EPPR0   81
         4 002114   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002115   000000 701000 xent               TSX1    KSE$ERRMSG
         4 002116   000000 011000                    NOP     0

      752    12295                /*E* ERROR: KSN-E$KS_CANTDOIT-0
      753    12296                     MESSAGE: Unable to perform the requested function.
      754    12297                     DESCRIPTION: SEE MESSAGE */
      755    12298    2           END;  /* DO NEVER */

      756    12299    1        RETURN;

  12299  4 002117   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:133  
      757    12300    1   END KSC$LINCNFG;
      758    12301        %EOD;

PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:134  
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$LINCNFG.
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:135  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$LINCNFG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(2268)  r     1 CMPLTED_OK_FMT           100-0-0/d BIT (72)    r     1 CMPLTED_OK_VEC
   102-0-0/c CHAR(43)    r     1 ENBL_FMT

  ****  Section 002  Data  KSC$LINCNFG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    62-0-0/w PTR         r     1 CNFG$
     0-0-0/w UBIN        r     1 CNFG_BUF(0:49)
   271-0-0/w STRC(828)   r     1 CNFG_MSG                 406-0-0/d STRC(360)   r     1 DELETE_NETCON
   225-0-0/w PTR         r     1 HDR$                     226-0-0/w STRC(612)   r     1 KS_ADMIN
   347-0-0/c STRC(171)   r     1 KS_CONFIG_KEY            247-0-0/w STRC(99)    r     1 KS_DEFAULT_KEY
   146-0-0/w STRC(1656)  r     1 KS_FEPHNDLR              224-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY
   354-0-0/d STRC(504)   r     1 READ_NETCON              320-0-0/w STRC(828)   r     1 RESET_MSG
   264-0-0/w STRC(162)   r     1 TERM_KEY                 252-0-0/c STRC(171)   r     1 TERM_REC
   145-0-0/w PTR         r     1 TMP_CNFG$
    63-0-0/w UBIN        r     1 TMP_CNFG_BUF(0:49)
   372-0-0/d STRC(432)   r     1 WRITE_NETCON

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                      4-0-0/c CHAR(21)    r     1 ACTION_CMPLTED
    13-0-0/w UBIN        r     1 CHAN                      14-0-0/w UBIN        r     1 CHANHI
    20-0-0/w UBIN        r     1 CHANLO                    52-0-0/c CHAR(4)     r     1 CHAN_STR
    12-0-0/b BIT         r     1 CNFG_EXISTS              100-0-0/w PTR         r     1 D$
    71-0-0/c STRC(144)   r     1 FEPHI                     65-0-0/c STRC(144)   r     1 FEPLO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:136  
    21-0-0/b BIT         r     1 FOUND                     22-0-0/c CHAR(8)     r     1 HNDLRNAME
    25-0-0/w UBIN        r     1 J                         75-0-0/b BIT         r     1 KS_HLPCGERR
    55-0-0/c CHAR(31)    r     1 LOGON_STRING              51-0-0/w BIT         r     1 NO_CHAN
    76-0-0/w PTR         r     1 S$                        26-0-0/w UBIN        r     1 SUB
    30-0-0/w UBIN        r     1 SUBHI                     27-0-0/w UBIN        r     1 SUBLO
    31-0-0/w UBIN        r     1 SUBSUB                    33-0-0/w UBIN        r     1 SUBSUBHI
    32-0-0/w UBIN        r     1 SUBSUBLO                  44-0-0/c STRC(144)   r     1 TERMHI
    40-0-0/c STRC(144)   r     1 TERMLO                    53-0-0/c CHAR(8)     r     1 TERM_NAME
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC        r     1 KS_ERRCODE
     0-0-0/c CHAR(8)     r     1 KS_HNDLRNAME               0-0-0/c CHAR(400)   r     1 KS_MSGBUF
     0-0-0/w PTR         r     1 KS_MSGBUF$                 0-0-0/w SBIN        r     1 KS_NODE
     0-0-0/c CHAR(8)     r     1 KS_NODENAME                0-0-0/w UBIN(9)     r     1 KS_SELPRMOPT
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(612)   r     1 KL_ADMIN_RETURN
     0-0-0/w STRC(306)   r     1 KS$HDR                     0-0-0/w ASTR(387)   r     1 LINCNFG
     0-0-0/w ASTR(387)   r     1 LINCNFG_TMP                0-0-0N  NULL        r     1 M$NETCON
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure KSC$LINCNFG requires 1104 words for executable code.
   Procedure KSC$LINCNFG requires 96 words of local(AUTO) storage.
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:137  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:138  
          MINI XREF LISTING

ACTION_CMPLTED
      9824**DCL     11917<<ASSIGN  11920<<ASSIGN  11923<<ASSIGN  11926<<ASSIGN  11939--CALL    12109<<ASSIGN
     12110--CALL    12274<<ASSIGN  12275--CALL    12284<<ASSIGN  12285--CALL
B$ALT.CODE
     11533**DCL     11533--REDEF   11534--REDEF   11534--REDEF
B$ALT.ERR.CODE
     11535**DCL     11989>>IF      12191>>IF
B$ALT.ERR.ERR#
     11535**DCL     11535--REDEF
B$ALT.EVID
     11534**DCL     11534--REDEF   11534--REDEF
B$TCB.ALT$
     11529**DCL     11989>>IF      12191>>IF
B$TCB$
     11729**DCL     11989>>IF      12191>>IF
CHAN
      9826**DCL     12056<<DOINDEX 12057<>CALL    12077<>CALL    12179<<DOINDEX 12180<>CALL
CHANGE_REC
     12093**LABEL   12085--CALLALT 12089--CALLALT 12090--CALLALT
CHANHI
      9827**DCL     12049<>CALL    12056>>DOINDEX 12173<>CALL    12179>>DOINDEX
CHANLO
      9831**DCL     12048<>CALL    12056>>DOINDEX 12172<>CALL    12179>>DOINDEX
CHAN_STR
      9906**DCL     12077<>CALL    12078--CALL
CMPLTED_OK_FMT
      9995**DCL     10006--DCLINIT
CMPLTED_OK_VEC
     10006**DCL     11939<>CALL    12110<>CALL    12275<>CALL    12285<>CALL
CNFG$
     10037**DCL     11070--IMP-PTR 11982>>ASSIGN  11983>>ASSIGN  11984>>CALL    11984>>CALL    11985>>ASSIGN
     11991>>CALL    11991>>CALL    12188>>ASSIGN  12192>>ASSIGN  12197>>ASSIGN  12197>>ASSIGN  12198>>CALL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:139  
     12198>>CALL    12214>>ASSIGN  12215>>ASSIGN  12247>>IF      12248>>IF      12262>>ASSIGN  12262>>ASSIGN
CNFG_BUF
     10036**DCL     10037--DCLINIT 11948<<ASSIGN  11978--ASSIGN  11997--ASSIGN  12186--CALL    12246--CALL
CNFG_EXISTS
      9825**DCL     11982<<ASSIGN  11985>>ASSIGN
CNFG_MSG
     10443**DCL     12222--CALL
CNFG_MSG.KHA
     10583**DCL     12214<<ASSIGN
CNFG_MSG.NA
     10663**DCL     12215<<ASSIGN
CNFG_MSG.NA.CNFG_EXISTS
     10679**DCL     12216<<ASSIGN
CNFG_MSG.TERMID_HI
     10552**DCL     12213<<ASSIGN
CNFG_MSG.TERMID_HI.TERM
     10554**DCL     10563--REDEF
CNFG_MSG.TERMID_HI.TERM.CHANNEL
     10556**DCL     12219<<ASSIGN
CNFG_MSG.TERMID_LO
     10523**DCL     12212<<ASSIGN
CNFG_MSG.TERMID_LO.TERM
     10525**DCL     10534--REDEF
CNFG_MSG.TERMID_LO.TERM.CHANNEL
     10527**DCL     12218<<ASSIGN
CONFIG_NETCON
     12245**LABEL   12206--GOTO    12226--GOTO    12239--GOTO
D$
     11886**DCL     11887--IMP-PTR
DELETE_NETCON
     11842**DCL     12102<>CALL
DELETE_NETCON.KEY_
     11842**DCL     12100<<ASSIGN
DELETE_NETCON.LKEY_
     11844**DCL     12101<<ASSIGN
DELETE_NETCON.V
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:140  
     11845**DCL     11842--DCLINIT
ENBL_FMT
     10007**DCL     10008--DCLINIT
ERR
     12293**LABEL   11936--CALLALT 11994--GOTO    11998--CALLALT 12086--CALLALT 12135--GOTO    12194--GOTO
     12246--CALLALT 12256--CALLALT 12265--CALLALT
ERR1
     12294**LABEL   11908--CALLALT 11910--CALLALT 11912--CALLALT 11984--CALLALT 11991--CALLALT 12008--GOTO
     12012--CALLALT 12036--GOTO    12127--GOTO    12143--GOTO    12150--GOTO    12156--CALLALT 12198--CALLALT
F$DCB.ACTPOS
      4890**DCL      4890--REDEF
F$DCB.ARS
      4865**DCL      4865--REDEF
F$DCB.ATTR
      4883**DCL      4884--REDEF
F$DCB.BORROW
      4898**DCL      4898--REDEF    4898--REDEF    4898--REDEF
F$DCB.DCBNAME.L
      4912**DCL      4912--IMP-SIZ
F$DCB.EOMCHAR
      4869**DCL      4869--REDEF
F$DCB.FLDID
      4893**DCL      4893--REDEF
F$DCB.FORM$
      4887**DCL      4887--REDEF
F$DCB.FSECT
      4903**DCL      4903--REDEF
F$DCB.FSN
      4880**DCL      4880--REDEF    4880--REDEF    4881--REDEF
F$DCB.HEADER$
      4886**DCL      4886--REDEF
F$DCB.IXTNSIZE
      4884**DCL      4884--REDEF
F$DCB.LASTSTA$
      4874**DCL      4874--REDEF
F$DCB.LVL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:141  
      4899**DCL      4899--REDEF
F$DCB.NAME.C
      4874**DCL      4874--REDEF
F$DCB.NOEOF
      4895**DCL      4895--REDEF
F$DCB.NRECS
      4885**DCL      4885--REDEF
F$DCB.NRECX
      4904**DCL      4904--REDEF
F$DCB.OHDR
      4896**DCL      4896--REDEF
F$DCB.ORG
      4879**DCL      4879--REDEF
F$DCB.PRECNO
      4902**DCL      4902--REDEF
F$DCB.RCSZ
      4907**DCL      4907--REDEF
F$DCB.RES
      4875**DCL      4875--REDEF
F$DCB.SETX
      4887**DCL      4887--REDEF
F$DCB.TAB$
      4886**DCL      4887--REDEF
F$DCB.TDA
      4901**DCL      4901--REDEF
F$DCB.WSN
      4876**DCL      4876--REDEF
FEPHI
      9952**DCL     12016<<ASSIGN  12110--CALL    12140<>CALL    12146<>CALL
FEPHI.TERM
      9956**DCL      9965--REDEF
FEPHI.TERM.CHANNEL
      9958**DCL     12020<<ASSIGN  12219>>ASSIGN
FEPHI.TERM.TERM_NAME
      9965**DCL     12017>>IF
FEPLO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:142  
      9923**DCL     12015<<ASSIGN  12110--CALL    12132<>CALL    12146<>CALL
FEPLO.TERM
      9927**DCL      9936--REDEF
FEPLO.TERM.CHANNEL
      9929**DCL     12019<<ASSIGN  12218>>ASSIGN
FEPLO.TERM.TERM_NAME
      9936**DCL     12017>>IF
FOUND
      9832**DCL     11949<<ASSIGN  11957<<ASSIGN  11962>>IF
HDR$
     10088**DCL     11638--IMP-PTR 12231>>IF
HNDLRNAME
      9833**DCL     11947<<ASSIGN  11955>>IF      11964>>ASSIGN  11965--ASSIGN  11977>>ASSIGN
IFNDIT
     11962**LABEL   11953--CALLALT
J
      9835**DCL     11954<<DOINDEX 11955>>IF
KL_ADMIN_RETURN.HANDLER
     11409**DCL     12073>>IF
KL_ADMIN_RETURN.RESULTS
     11430**DCL     12073>>IF
KL_ADMIN_RETURN.TERMID_HI.TERM
     11516**DCL     11525--REDEF
KL_ADMIN_RETURN.TERMID_LO.TERM
     11487**DCL     11496--REDEF
KS$HDR.RESULTS.ERR#
     11696**DCL     12231>>IF
KSE$ERRMSG
      9777**DCL-ENT 11968--CALL    12033--CALL    12078--CALL    12149--CALL    12204--CALL    12224--CALL
     12235--CALL    12293--CALL    12294--CALL
KSR$RD_HLPCG
      9778**DCL-ENT 11937--CALL    12072--CALL    12086--CALL    12090--CALL    12228--CALL
KSR$WR_HLPCG
      9779**DCL-ENT 11936--CALL    12071--CALL    12085--CALL    12089--CALL    12222--CALL
KSU$BINHEX
      9793**DCL-ENT 12077--CALL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:143  
KSU$BLD_LINCNFG
      9780**DCL-ENT 11984--CALL    12198--CALL
KSU$BLD_LINCNFG_DEF
      9782**DCL-ENT 11991--CALL
KSU$BLD_TERMID
      9783**DCL-ENT 12132--CALL    12140--CALL
KSU$BLD_TERMRANGE
      9794**DCL-ENT 11908--CALL    11910--CALL    12003--CALL    12121--CALL
KSU$CHECK_FOR_FEP
      9795**DCL-ENT 11912--CALL    12012--CALL    12156--CALL
KSU$CHK_TRM_RNG
      9784**DCL-ENT 12146--CALL
KSU$INIT_DEFCNFG
      9781**DCL-ENT 12026--CALL
KSU$PACK2
      9792**DCL-ENT 12048--CALL    12049--CALL    12050--CALL    12051--CALL    12052--CALL    12053--CALL
     12172--CALL    12173--CALL    12174--CALL    12175--CALL    12176--CALL    12177--CALL
KSU$READ_NETCON
      9788**DCL-ENT 12031--CALL    12186--CALL
KSU$UNPACK
      9791**DCL-ENT 12057--CALL    12059--CALL    12061--CALL    12180--CALL    12182--CALL    12184--CALL
KSU$WRITE_NETCON
      9789**DCL-ENT 12246--CALL    12256--CALL    12265--CALL
KSW$WRITE
      9787**DCL-ENT 11939--CALL    12110--CALL    12275--CALL    12285--CALL
KS_ADMIN
     10121**DCL     11936--CALL    12071--CALL    12089--CALL
KS_ADMIN.FNC
     10188**DCL     11918<<ASSIGN  11921<<ASSIGN  11924<<ASSIGN  11927<<ASSIGN  11929<<ASSIGN  11931<<ASSIGN
     12070<<ASSIGN  12088<<ASSIGN
KS_ADMIN.HANDLER
     10130**DCL     11933<<ASSIGN
KS_ADMIN.TERMID_HI
     10235**DCL     11935<<ASSIGN  12066<<ASSIGN
KS_ADMIN.TERMID_HI.TERM
     10237**DCL     10246--REDEF
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:144  
KS_ADMIN.TERMID_LO
     10206**DCL     11934<<ASSIGN  12065<<ASSIGN
KS_ADMIN.TERMID_LO.TERM
     10208**DCL     10217--REDEF
KS_CONFIG_KEY
     10991**DCL     12100--ASSIGN  12101--ASSIGN  12186--CALL    12246--CALL    12263>>ASSIGN
KS_CONFIG_KEY.NODE
     10994**DCL     12093<<ASSIGN  12165<<ASSIGN  12168<<ASSIGN
KS_CONFIG_KEY.TERMID
     11011**DCL     12094<<ASSIGN  12212>>ASSIGN  12213>>ASSIGN
KS_CONFIG_KEY.TERMID.LEV
     11013**DCL     12170<<ASSIGN
KS_CONFIG_KEY.TERMID.TERM
     11013**DCL     11022--REDEF
KS_CONFIG_KEY.TERMID.TERM.CHANNEL
     11015**DCL     12097<<ASSIGN  12180<>CALL
KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE
     11015**DCL     12182<>CALL
KS_CONFIG_KEY.TERMID.TERM.SUBSUBDEVICE
     11016**DCL     12184<>CALL
KS_CONFIG_KEY.TERMID.TERM.TERM_NAME
     11022**DCL     12098<<ASSIGN  12110--CALL    12171<<ASSIGN
KS_DEFAULT_KEY
     10262**DCL     11979--ASSIGN  11996--ASSIGN  12031--CALL
KS_DEFAULT_KEY.HNDLR
     10266**DCL     11977<<ASSIGN  12030<<ASSIGN  12033--CALL    12073>>IF      12078--CALL
KS_DEFAULT_KEY.NODE
     10265**DCL     11976<<ASSIGN  12029<<ASSIGN
KS_ERRCODE.CODE
      9679**DCL     12134>>IF      12142>>IF
KS_FEPHNDLR
     10053**DCL     11951--ASSIGN
KS_FEPHNDLR.HANDLER
     10064**DCL     11955>>IF
KS_FEPHNDLR.NHANDLERS
     10054**DCL     11954>>DOINDEX
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:145  
KS_FEPHNDLR_KEY
     10083**DCL     11952--ASSIGN
KS_FEPHNDLR_KEY.NODE
     10086**DCL     11950<<ASSIGN
KS_HLPCGERR
      9967**DCL     12120<<ASSIGN  12225<<ASSIGN  12230<<ASSIGN  12272>>IF
KS_HNDLRNAME
      9678**DCL     11933>>ASSIGN
KS_MSGBUF
      9680**DCL     10088--DCLINIT
KS_MSGBUF$
      9680**DCL      9680--IMP-PTR 11400--IMP-PTR 12073>>IF      12073>>IF
KS_MYSTATION
      9676**DCL      9676--REDEF
KS_NODE
      9677**DCL     11912<>CALL    11950>>ASSIGN  11976>>ASSIGN  12012<>CALL    12029>>ASSIGN  12093>>ASSIGN
     12156<>CALL    12168>>ASSIGN  12264>>ASSIGN
KS_NODENAME
      9676**DCL     11966>>ASSIGN  11967--ASSIGN
KS_SELPRMOPT
      9677**DCL     12107>>IF      12200>>IF      12231>>IF      12244>>IF      12272>>IF      12282>>IF
KS_SUB_BUF_1
      9681**DCL     11968--CALL
KS_SUB_BUF_1.COUNT
      9681**DCL     11965<<ASSIGN
KS_SUB_BUF_1.TEXT
      9681**DCL     11964<<ASSIGN
KS_SUB_BUF_2
      9681**DCL     11968--CALL
KS_SUB_BUF_2.COUNT
      9682**DCL     11967<<ASSIGN
KS_SUB_BUF_2.TEXT
      9682**DCL     11966<<ASSIGN
LINCNFG
     11070**DCL     11984<>CALL    11991<>CALL    12198<>CALL
LINCNFG.KHA
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:146  
     11089**DCL     12214>>ASSIGN
LINCNFG.LGN.LGNSIZE
     11207**DCL     11208--IMP-SIZ 11984>>CALL    11991>>CALL    12197>>ASSIGN  12198>>CALL    12262>>ASSIGN
LINCNFG.LGN.LGNSTRING
     11208**DCL     12197>>ASSIGN  12262>>ASSIGN
LINCNFG.NA
     11169**DCL     12215>>ASSIGN
LINCNFG.NA.AUTLGN
     11176**DCL     12247>>IF      12248>>IF
LINCNFG.NA.CNFG_EXISTS
     11185**DCL     11982>>ASSIGN  11983<<ASSIGN  11985<<ASSIGN  12188<<ASSIGN  12192<<ASSIGN
LINCNFG_TMP
     11228**DCL     12026<>CALL
LINCNFG_TMP.KHA
     11247**DCL     12041>>ASSIGN
LINCNFG_TMP.LGN.LGNSIZE
     11365**DCL     11366--IMP-SIZ 12026>>CALL
LINCNFG_TMP.NA
     11327**DCL     12042>>ASSIGN
LOGON_STRING
      9908**DCL     12197<<ASSIGN  12250>>IF      12253>>ASSIGN
M$DELREC
        21**DCL-ENT 12102--CALL
M$READ
        20**DCL-ENT 11953--CALL    11980--CALL
M$WRITE
        20**DCL-ENT 11998--CALL
NO_CHAN
      9905**DCL     12002<<ASSIGN  12006<<ASSIGN  12011>>IF      12063>>IF      12119<<ASSIGN  12125<<ASSIGN
     12155>>IF      12202>>IF
OUT$BLK.CODE
     11553**DCL     11905>>DOCASE  11907>>IF      11915>>DOCASE
OUT$BLK.NSUBLKS
     11557**DCL     12025>>IF      12073>>IF      12138>>IF
OUT$BLK.SUBLK$
     11578**DCL     11907>>IF      11908<>CALL    11910<>CALL    11947>>ASSIGN  11947>>ASSIGN  12003<>CALL
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:147  
     12030>>ASSIGN  12030>>ASSIGN  12121<>CALL    12132>>CALL    12132<>CALL    12138>>IF      12140>>CALL
     12140<>CALL
OUT$SYM.COUNT
     11614**DCL     11617--IMP-SIZ 11947>>ASSIGN  12030>>ASSIGN
OUT$SYM.TEXT
     11617**DCL     11947>>ASSIGN  12030>>ASSIGN
READ_NETCON
     11776**DCL     11953<>CALL    11980<>CALL
READ_NETCON.BUF_
     11778**DCL     11951<<ASSIGN  11978<<ASSIGN
READ_NETCON.KEY_
     11776**DCL     11952<<ASSIGN  11979<<ASSIGN
READ_NETCON.STATION_
     11779**DCL     11780--REDEF
READ_NETCON.V
     11780**DCL     11776--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     11791**DCL     11791--REDEF
READ_NETCON.V.INDX#
     11789**DCL     11789--REDEF
RESET_CHAN
     12085**LABEL   12071--CALLALT
RESET_MSG
     10726**DCL     12085--CALL
RESET_MSG.KHA
     10866**DCL     12041<<ASSIGN
RESET_MSG.NA
     10946**DCL     12042<<ASSIGN
RESET_MSG.NA.AUTLGN
     10953**DCL     12045<<ASSIGN
RESET_MSG.NA.PROFILE
     10961**DCL     12046<<ASSIGN
RESET_MSG.TERMID_HI
     10835**DCL     12068<<ASSIGN
RESET_MSG.TERMID_HI.TERM
     10837**DCL     10846--REDEF
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:148  
RESET_MSG.TERMID_LO
     10806**DCL     12067<<ASSIGN
RESET_MSG.TERMID_LO.TERM
     10808**DCL     10817--REDEF
S$
     11884**DCL     11883--IMP-PTR
SRCH
     11954**LABEL   11958--EXIT
SUB
      9836**DCL     12058<<DOINDEX 12059<>CALL    12181<<DOINDEX 12182<>CALL
SUBHI
      9838**DCL     12051<>CALL    12058>>DOINDEX 12175<>CALL    12181>>DOINDEX
SUBLO
      9837**DCL     12050<>CALL    12058>>DOINDEX 12174<>CALL    12181>>DOINDEX
SUBSUB
      9839**DCL     12060<<DOINDEX 12061<>CALL    12183<<DOINDEX 12184<>CALL
SUBSUBHI
      9841**DCL     12053<>CALL    12060>>DOINDEX 12177<>CALL    12183>>DOINDEX
SUBSUBLO
      9840**DCL     12052<>CALL    12060>>DOINDEX 12176<>CALL    12183>>DOINDEX
S_LOOP
     12058**LABEL   12081--EXIT
TERMHI
      9889**DCL     11908<>CALL    11910<>CALL    11935>>ASSIGN  11939--CALL    12003<>CALL    12016>>ASSIGN
     12121<>CALL    12275--CALL    12285--CALL
TERMHI.TERM
      9893**DCL      9902--REDEF
TERMHI.TERM.CHANNEL
      9895**DCL     12049<>CALL    12164<<ASSIGN  12173<>CALL
TERMHI.TERM.SUBDEVICE
      9895**DCL     12051<>CALL    12175<>CALL
TERMHI.TERM.SUBSUBDEVICE
      9896**DCL     12053<>CALL    12177<>CALL
TERMHI.TERM.TERM_NAME
      9902**DCL     11914<<ASSIGN  12095>>IF      12098>>ASSIGN  12162<<ASSIGN  12211<<ASSIGN
TERMLO
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:149  
      9860**DCL     11908<>CALL    11910<>CALL    11934>>ASSIGN  11939--CALL    12003<>CALL    12015>>ASSIGN
     12065>>ASSIGN  12066>>ASSIGN  12067>>ASSIGN  12068>>ASSIGN  12094>>ASSIGN  12121<>CALL    12275--CALL
     12285--CALL
TERMLO.LEV
      9864**DCL     12170>>ASSIGN  12231>>IF
TERMLO.TERM
      9864**DCL      9873--REDEF
TERMLO.TERM.CHANNEL
      9866**DCL     12005>>IF      12048<>CALL    12057<>CALL    12123>>IF      12163<<ASSIGN  12172<>CALL
TERMLO.TERM.SUBDEVICE
      9866**DCL     12050<>CALL    12059<>CALL    12174<>CALL
TERMLO.TERM.SUBSUBDEVICE
      9867**DCL     12052<>CALL    12061<>CALL    12176<>CALL
TERMLO.TERM.TERM_NAME
      9873**DCL     11911>>IF      11913<<ASSIGN  12005>>IF      12023<<ASSIGN  12123>>IF      12130>>IF
     12158>>ASSIGN  12161<<ASSIGN  12204--CALL    12210<<ASSIGN
TERM_KEY
     10379**DCL     12256--CALL    12265--CALL
TERM_KEY.TERMID
     10398**DCL     12252<<ASSIGN  12261<<ASSIGN
TERM_KEY.TERMID.TERM
     10400**DCL     10409--REDEF
TERM_KEY.TERMID.TERM.TERM_NAME
     10409**DCL     12253<<ASSIGN  12262<<ASSIGN
TERM_NAME
      9907**DCL     12158<<ASSIGN  12159>>IF      12161>>ASSIGN  12162>>ASSIGN  12171>>ASSIGN  12217>>IF
     12275--CALL    12285--CALL
TERM_REC
     10282**DCL     12254<<ASSIGN  12256--CALL    12263<<ASSIGN  12265--CALL
TERM_REC.NODE
     10285**DCL     12264<<ASSIGN
TERM_REC.TERMID.TERM
     10304**DCL     10313--REDEF
TERM_REC.TERMID.TERM.TERM_NAME
     10313**DCL     12255<<ASSIGN
TERM_REC_TMP.TERMID.TERM
PL6.E3A0      #002=KSC$LINCNFG File=KSC$COMMANDS1.:E05TSI                        WED 07/30/97 01:42 Page:150  
     10353**DCL     10362--REDEF
TMP_CNFG$
     10039**DCL     11228--IMP-PTR 12026>>CALL    12026>>CALL    12041>>ASSIGN  12042>>ASSIGN
TMP_CNFG_BUF
     10038**DCL     10039--DCLINIT 12031--CALL
TOP$
         8**DCL         6--PROC    11545--IMP-PTR 11905>>DOCASE  11907>>IF      11908>>CALL    11910>>CALL
     11915>>DOCASE  11947>>ASSIGN  11947>>ASSIGN  11984<>CALL    11991<>CALL    12003>>CALL    12025>>IF
     12030>>ASSIGN  12030>>ASSIGN  12073>>IF      12121>>CALL    12132>>CALL    12138>>IF      12140>>CALL
     12198<>CALL
WRITE_NETCON
     11816**DCL     11998<>CALL
WRITE_NETCON.BUF_
     11816**DCL     11997<<ASSIGN
WRITE_NETCON.KEY_
     11816**DCL     11996<<ASSIGN
WRITE_NETCON.STATION_
     11818**DCL     11818--REDEF
WRITE_NETCON.V
     11819**DCL     11816--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
     11825**DCL     11825--REDEF

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:151  
      759        1        /*T***********************************************************/
      760        2        /*T*                                                         */
      761        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      762        4        /*T*                                                         */
      763        5        /*T***********************************************************/
      764        6
      765        7
      766        8
      767        9
      768       10
      769       11        KSC$PART:  PROC(TOP$);
      770       12
      771       13    1   DCL TOP$ PTR;
      772       14
      773       15        %INCLUDE KHA_FNC_E;
      774      115        %INCLUDE CP_6;
      775      196        %INCLUDE CP_6_SUBS;
      776      736        %INCLUDE XU_MACRO_C;
      777     3842        %INCLUDE KS_MACRO_M;
      778     4039        %INCLUDE B_ERRORS_C;
      779     5166        %INCLUDE KL_CONFIG_M;
      780     5928        %INCLUDE KL_MACRO_C;
      781     9280        %INCLUDE KS_SUBS_C;
      782     9523        %INCLUDE KS_DATA_R;
      783     9538        %INCLUDE KS_PERR_C;
      784     9605        %INCLUDE KL_AFCN_C;
      785     9706        /**/
      786     9707        %KS$BOX(TITLE="entry defs");

              9725    1   /***************************************************************************
              9726    1    *                                                                         *
              9727    1    *                                 entry defs                              *
              9728    1    *                                                                         *
              9729    1    ***************************************************************************/

      787     9734    1   DCL KSE$ERRMSG ENTRY(4);
      788     9735    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:152  
      789     9736    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      790     9737    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
      791     9738    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
      792     9739    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      793     9740    1   DCL XUR$ERRCNVRT ENTRY(2);
      794     9741    1   DCL KSW$WRITE ENTRY(11);
      795     9742        %KS$BOX(TITLE="symref variables");

              9760    1   /***************************************************************************
              9761    1    *                                                                         *
              9762    1    *                              symref variables                           *
              9763    1    *                                                                         *
              9764    1    ***************************************************************************/

      796     9769    1   DCL B$TCB$ PTR SYMREF;
      797     9770        %KS$BOX(TITLE="constant variables");

              9788    1   /***************************************************************************
              9789    1    *                                                                         *
              9790    1    *                             constant variables                          *
              9791    1    *                                                                         *
              9792    1    ***************************************************************************/

      798     9797    1   DCL FORM_FMT CHAR(0) CONSTANT INIT('terminals %LA to %LA %LA on channel %LH%10P');
      799     9798    1   DCL FORM_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(FORM_FMT));
      800     9799        %KS$BOX(TITLE="static variables");

              9817    1   /***************************************************************************
              9818    1    *                                                                         *
              9819    1    *                              static variables                           *
              9820    1    *                                                                         *
              9821    1    ***************************************************************************/

      801     9826    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      802     9827        %KS$BOX(TITLE="auto variables");

              9845    1   /***************************************************************************
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:153  
              9846    1    *                                                                         *
              9847    1    *                               auto variables                            *
              9848    1    *                                                                         *
              9849    1    ***************************************************************************/

      803     9854    1   DCL ATTRIBUTE UBIN;
      804     9855    1   DCL CHNL_NO_HI UBIN;
      805     9856    1   DCL CHNL_NO_LO UBIN;
      806     9857    1   DCL CODE UBIN;
      807     9858    1   DCL ERR BIT(36);
      808     9859    1   DCL J UBIN;
      809     9860    1   DCL PART_RET CHAR(11);
      810     9861    1   DCL SUBDEV_LO  UBIN;
      811     9862    1   DCL SUBSUBDEV_LO UBIN;
      812     9863    1   DCL SUBDEV_HI UBIN;
      813     9864    1   DCL SUBSUBDEV_HI UBIN;
      814     9865    1   DCL TERMID_LO CHAR(8);
      815     9866    1   DCL TERMID_HI CHAR(8);
      816     9867        %B$TERMINAL_ID(FPTN=TERMLO,STCLASS=AUTO);
      817     9896        %B$TERMINAL_ID(FPTN=TERMHI,STCLASS=AUTO);
      818     9925        %KS$BOX(TITLE="constant variables");

              9943    1   /***************************************************************************
              9944    1    *                                                                         *
              9945    1    *                             constant variables                          *
              9946    1    *                                                                         *
              9947    1    ***************************************************************************/

      819     9952    1   DCL CMPLTED_OK_FMT CHAR(0) CONSTANT INIT(
              9952            '%5X Line(s) %LH - %LD - %LD to %LH - %LD - %LD %LA%10P');
      820     9953    1   DCL CMPLTED_OK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CMPLTED_OK_FMT));
      821     9954        %KS$BOX(TITLE="static variables");

              9972    1   /***************************************************************************
              9973    1    *                                                                         *
              9974    1    *                              static variables                           *
              9975    1    *                                                                         *
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:154  
              9976    1    ***************************************************************************/

      822     9981        %KL_ADMIN (FPTN=KS_ADMIN,STCLASS=STATIC);
      823    10141        %KS$BOX(TITLE="based variables");

             10159    1   /***************************************************************************
             10160    1    *                                                                         *
             10161    1    *                              based variables                            *
             10162    1    *                                                                         *
             10163    1    ***************************************************************************/

      824    10168        %KL_HDR(FPTN=KS$HDR,STCLASS="BASED(HDR$)");
      825    10248        %B$TCB;
      826    10251        %B$ALT;
      827    10259        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      828    10304        %PARSE$SYM(NAME=OUT$SYM,STCLASS=BASED);
      829    10342        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      830    10343             D = S.BYT(0) * 256;
      831    10344             D = D + S.BYT(1);
      832    10345        %MEND;
      833    10346        %EJECT;
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:155  
      834    10347    1     IF KS_NODENAME = 'HOST' THEN
      835    10348    2        DO;
      836    10349    2        CALL KSE$ERRMSG(%E$KS_NONODE);
      837    10350    2        RETURN;
      838    10351    2        END;
      839    10352
      840    10353        /*
      841    10354           set code and determine if a range is specified or if a single
      842    10355           line is to be partition / returned
      843    10356        */
      844    10357    1     IF KS_NODENAME_SV ~= ' ' THEN
      845    10358    1        J=1;
      846    10359    1     ELSE
      847    10360    1        J=0;
      848    10361    1     CODE = OUT$BLK.CODE;
      849    10362    1     CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),TERMLO) ALTRET(ERR);
      850    10363    1     IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN
      851    10364    2        DO;
      852    10365    2        CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1),TERMHI) ALTRET(ERR);
      853    10366    2        CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN
      854    10367    3           DO;
      855    10368    3           CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);
      856    10369    3           GOTO ERR1;
      857    10370    3           END; /* end altreturn */
      858    10371    2        END; /* number of sub-blocks = 2 */
      859    10372    1     ELSE
      860    10373    2        DO;
      861    10374    2        TERMHI = TERMLO;
      862    10375    2        END;
      863    10376
      864    10377    2     DO CASE (CODE);
      865    10378    2        CASE(%KS_PART);
      866    10379    2           KS_ADMIN.FNC = %KHA_FNC_PARTITION;
      867    10380    2           PART_RET = 'partitioned';
      868    10381    2        CASE(%KS_RET);
      869    10382    2           KS_ADMIN.FNC = %KHA_FNC_RETURN;
      870    10383    2           PART_RET = 'Returned';
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:156  
      871    10384    2     END; /*end case code*/
      872    10385
      873    10386        /*
      874    10387          set handler name, terminal low and high name
      875    10388        */
      876    10389    1     KS_ADMIN.HANDLER = KS_HNDLRNAME;
      877    10390    1     KS_ADMIN.TERMID_LO = TERMLO;
      878    10391    1     KS_ADMIN.TERMID_HI = TERMHI;
      879    10392    1     CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR);
      880    10393    1     CALL KSR$RD_HLPCG WHENRETURN
      881    10394    2        DO;
      882    10395    2           IF KS$HDR.RESULTS = '0'B THEN
      883    10396    3              DO;
      884    10397                %ARRAY_TO_WORD(S=TERMLO.TERM.CHANNEL,D=CHNL_NO_LO);
      885    10401                %ARRAY_TO_WORD(S=TERMLO.TERM.SUBDEVICE,D=SUBDEV_LO);
      886    10405                %ARRAY_TO_WORD(S=TERMLO.TERM.SUBSUBDEVICE,D=SUBSUBDEV_LO);
      887    10409                %ARRAY_TO_WORD(S=TERMHI.TERM.CHANNEL,D=CHNL_NO_HI);
      888    10413                %ARRAY_TO_WORD(S=TERMHI.TERM.SUBDEVICE,D=SUBDEV_HI);
      889    10417                %ARRAY_TO_WORD(S=TERMHI.TERM.SUBSUBDEVICE,D=SUBSUBDEV_HI);
      890    10421    3           CALL KSW$WRITE(CMPLTED_OK_VEC,VECTOR(CHNL_NO_LO),VECTOR(SUBDEV_LO),
      891    10422    3                          VECTOR(SUBSUBDEV_LO),VECTOR(CHNL_NO_HI),
      892    10423    3                          VECTOR(SUBDEV_HI),VECTOR(SUBSUBDEV_HI),
      893    10424    3                          VECTOR(PART_RET));
      894    10425    3           END;  /* results = 0 */
      895    10426    2        END;   /* end when return */
      896    10427    1     WHENALTRETURN
      897    10428    2        DO;
      898    10429    2        END;   /*alt return*/
      899    10430
      900    10431    2        DO WHILE ('0'B);
      901    10432    2   ERR1:   CALL KSE$ERRMSG(0);
      902    10433    2   ERR:    CALL KSE$ERRMSG(%E$KS_CANTDOIT);
      903    10434    2        END;
      904    10435    1     RETURN;
      905    10436
      906    10437    1     END KSC$PART;
      907    10438        %EOD;
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:157  

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:158  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$PART.

   Procedure KSC$PART requires 235 words for executable code.
   Procedure KSC$PART requires 80 words of local(AUTO) storage.

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:159  

 Object Unit name= KSC$PART                                   File name= KSC$COMMANDS1.:E05TOU
 UTS= JUL 30 '97 01:44:25.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     36     44  KSC$PART
    2   Data  even  none    18     22  KSC$PART
    3   Proc  even  none   235    353  KSC$PART
    4  RoData even  none    12     14  KSC$PART

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  KSC$PART

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 KSE$ERRMSG
 yes     yes           Std       2 KSU$CHK_TRM_RNG
 yes     yes           Std       1 KSR$RD_HLPCG
 yes     yes           Std       1 KSR$WR_HLPCG
         yes           Std      11 KSW$WRITE
 yes     yes           Std       3 KSU$BLD_TERMID
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:160  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_NODENAME_SV                        KS_HNDLRNAME                          KS_MSGBUF
     KS_MSGBUF$                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:161  


      759        1        /*T***********************************************************/
      760        2        /*T*                                                         */
      761        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      762        4        /*T*                                                         */
      763        5        /*T***********************************************************/
      764        6
      765        7
      766        8
      767        9
      768       10
      769       11        KSC$PART:  PROC(TOP$);

     11  3 000000   000000 700200 xent  KSC$PART     TSX0  ! X66_AUTO_1
         3 000001   000120 000001                    ZERO    80,1

      770       12
      771       13    1   DCL TOP$ PTR;
      772       14
      773       15        %INCLUDE KHA_FNC_E;
      774      115        %INCLUDE CP_6;
      775      196        %INCLUDE CP_6_SUBS;
      776      736        %INCLUDE XU_MACRO_C;
      777     3842        %INCLUDE KS_MACRO_M;
      778     4039        %INCLUDE B_ERRORS_C;
      779     5166        %INCLUDE KL_CONFIG_M;
      780     5928        %INCLUDE KL_MACRO_C;
      781     9280        %INCLUDE KS_SUBS_C;
      782     9523        %INCLUDE KS_DATA_R;
      783     9538        %INCLUDE KS_PERR_C;
      784     9605        %INCLUDE KL_AFCN_C;
      785     9706        /**/
      786     9707        %KS$BOX(TITLE="entry defs");

              9725    1   /***************************************************************************
              9726    1    *                                                                         *
              9727    1    *                                 entry defs                              *
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:162  
              9728    1    *                                                                         *
              9729    1    ***************************************************************************/

      787     9734    1   DCL KSE$ERRMSG ENTRY(4);
      788     9735    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
      789     9736    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      790     9737    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
      791     9738    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
      792     9739    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      793     9740    1   DCL XUR$ERRCNVRT ENTRY(2);
      794     9741    1   DCL KSW$WRITE ENTRY(11);
      795     9742        %KS$BOX(TITLE="symref variables");

              9760    1   /***************************************************************************
              9761    1    *                                                                         *
              9762    1    *                              symref variables                           *
              9763    1    *                                                                         *
              9764    1    ***************************************************************************/

      796     9769    1   DCL B$TCB$ PTR SYMREF;
      797     9770        %KS$BOX(TITLE="constant variables");

              9788    1   /***************************************************************************
              9789    1    *                                                                         *
              9790    1    *                             constant variables                          *
              9791    1    *                                                                         *
              9792    1    ***************************************************************************/

      798     9797    1   DCL FORM_FMT CHAR(0) CONSTANT INIT('terminals %LA to %LA %LA on channel %LH%10P');
      799     9798    1   DCL FORM_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(FORM_FMT));
      800     9799        %KS$BOX(TITLE="static variables");

              9817    1   /***************************************************************************
              9818    1    *                                                                         *
              9819    1    *                              static variables                           *
              9820    1    *                                                                         *
              9821    1    ***************************************************************************/
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:163  

      801     9826    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      802     9827        %KS$BOX(TITLE="auto variables");

              9845    1   /***************************************************************************
              9846    1    *                                                                         *
              9847    1    *                               auto variables                            *
              9848    1    *                                                                         *
              9849    1    ***************************************************************************/

      803     9854    1   DCL ATTRIBUTE UBIN;
      804     9855    1   DCL CHNL_NO_HI UBIN;
      805     9856    1   DCL CHNL_NO_LO UBIN;
      806     9857    1   DCL CODE UBIN;
      807     9858    1   DCL ERR BIT(36);
      808     9859    1   DCL J UBIN;
      809     9860    1   DCL PART_RET CHAR(11);
      810     9861    1   DCL SUBDEV_LO  UBIN;
      811     9862    1   DCL SUBSUBDEV_LO UBIN;
      812     9863    1   DCL SUBDEV_HI UBIN;
      813     9864    1   DCL SUBSUBDEV_HI UBIN;
      814     9865    1   DCL TERMID_LO CHAR(8);
      815     9866    1   DCL TERMID_HI CHAR(8);
      816     9867        %B$TERMINAL_ID(FPTN=TERMLO,STCLASS=AUTO);
      817     9896        %B$TERMINAL_ID(FPTN=TERMHI,STCLASS=AUTO);
      818     9925        %KS$BOX(TITLE="constant variables");

              9943    1   /***************************************************************************
              9944    1    *                                                                         *
              9945    1    *                             constant variables                          *
              9946    1    *                                                                         *
              9947    1    ***************************************************************************/

      819     9952    1   DCL CMPLTED_OK_FMT CHAR(0) CONSTANT INIT(
              9952            '%5X Line(s) %LH - %LD - %LD to %LH - %LD - %LD %LA%10P');
      820     9953    1   DCL CMPLTED_OK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CMPLTED_OK_FMT));
      821     9954        %KS$BOX(TITLE="static variables");
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:164  

              9972    1   /***************************************************************************
              9973    1    *                                                                         *
              9974    1    *                              static variables                           *
              9975    1    *                                                                         *
              9976    1    ***************************************************************************/

      822     9981        %KL_ADMIN (FPTN=KS_ADMIN,STCLASS=STATIC);
      823    10141        %KS$BOX(TITLE="based variables");

             10159    1   /***************************************************************************
             10160    1    *                                                                         *
             10161    1    *                              based variables                            *
             10162    1    *                                                                         *
             10163    1    ***************************************************************************/

      824    10168        %KL_HDR(FPTN=KS$HDR,STCLASS="BASED(HDR$)");
      825    10248        %B$TCB;
      826    10251        %B$ALT;
      827    10259        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      828    10304        %PARSE$SYM(NAME=OUT$SYM,STCLASS=BASED);
      829    10342        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      830    10343             D = S.BYT(0) * 256;
      831    10344             D = D + S.BYT(1);
      832    10345        %MEND;
      833    10346        %EJECT;
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:165  
      834    10347    1     IF KS_NODENAME = 'HOST' THEN

  10347  3 000002   040000 106400                    CMPC    fill='040'O
         3 000003   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         3 000004   000036 000004 1                  ADSC9   CMPLTED_OK_VEC+2         cn=0,n=4
         3 000005   000013 601000 3                  TNZ     s:10357

      835    10348    2        DO;

      836    10349    2        CALL KSE$ERRMSG(%E$KS_NONODE);

  10349  3 000006   000000 630400 4                  EPPR0   0
         3 000007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000010   000000 701000 xent               TSX1    KSE$ERRMSG
         3 000011   000000 011000                    NOP     0

      837    10350    2        RETURN;

  10350  3 000012   000000 702200 xent               TSX2  ! X66_ARET

      838    10351    2        END;
      839    10352
      840    10353        /*
      841    10354           set code and determine if a range is specified or if a single
      842    10355           line is to be partition / returned
      843    10356        */
      844    10357    1     IF KS_NODENAME_SV ~= ' ' THEN

  10357  3 000013   040000 106400                    CMPC    fill='040'O
         3 000014   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8
         3 000015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000016   000022 600000 3                  TZE     s:10360

      845    10358    1        J=1;

  10358  3 000017   000001 235007                    LDA     1,DL
         3 000020   200011 755100                    STA     J,,AUTO
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:166  
         3 000021   000023 710000 3                  TRA     s:10361

      846    10359    1     ELSE
      847    10360    1        J=0;

  10360  3 000022   200011 450100                    STZ     J,,AUTO

      848    10361    1     CODE = OUT$BLK.CODE;

  10361  3 000023   200003 470500                    LDP0    @TOP$,,AUTO
         3 000024   000000 471500                    LDP1    0,,PR0
         3 000025   100000 236100                    LDQ     0,,PR1
         3 000026   777777 376007                    ANQ     -1,DL
         3 000027   200007 756100                    STQ     CODE,,AUTO

      849    10362    1     CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(0),TERMLO) ALTRET(ERR);

  10362  3 000030   200011 720100                    LXL0    J,,AUTO
         3 000031   100003 473510                    LDP3    3,X0,PR1
         3 000032   200025 634500                    EPPR4   TERMLO,,AUTO
         3 000033   200037 454500                    STP4    TERMHI+6,,AUTO
         3 000034   300003 631500                    EPPR1   3,,PR3
         3 000035   200036 451500                    STP1    TERMHI+5,,AUTO
         3 000036   200036 630500                    EPPR0   TERMHI+5,,AUTO
         3 000037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000040   000000 701000 xent               TSX1    KSU$BLD_TERMID
         3 000041   000346 702000 3                  TSX2    ERR

      850    10363    1     IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN

  10363  3 000042   200003 470500                    LDP0    @TOP$,,AUTO
         3 000043   000000 471500                    LDP1    0,,PR0
         3 000044   100003 473500                    LDP3    3,,PR1
         3 000045   300001 220100                    LDX0    1,,PR3
         3 000046   000002 100003                    CMPX0   2,DU
         3 000047   000101 601000 3                  TNZ     s:10374

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:167  
      851    10364    2        DO;

      852    10365    2        CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(J)->OUT$BLK.SUBLK$(1),TERMHI) ALTRET(ERR);

  10365  3 000050   200011 721100                    LXL1    J,,AUTO
         3 000051   100003 474511                    LDP4    3,X1,PR1
         3 000052   200031 635500                    EPPR5   TERMHI,,AUTO
         3 000053   200037 455500                    STP5    TERMHI+6,,AUTO
         3 000054   400004 631500                    EPPR1   4,,PR4
         3 000055   200036 451500                    STP1    TERMHI+5,,AUTO
         3 000056   200036 630500                    EPPR0   TERMHI+5,,AUTO
         3 000057   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000060   000000 701000 xent               TSX1    KSU$BLD_TERMID
         3 000061   000346 702000 3                  TSX2    ERR

      853    10366    2        CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN

  10366  3 000062   200031 630500                    EPPR0   TERMHI,,AUTO
         3 000063   200037 450500                    STP0    TERMHI+6,,AUTO
         3 000064   200025 631500                    EPPR1   TERMLO,,AUTO
         3 000065   200036 451500                    STP1    TERMHI+5,,AUTO
         3 000066   200036 630500                    EPPR0   TERMHI+5,,AUTO
         3 000067   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000070   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         3 000071   000073 702000 3                  TSX2    s:10368
         3 000072   000100 710000 3                  TRA     s:10371

      854    10367    3           DO;

      855    10368    3           CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);

  10368  3 000073   000002 630400 4                  EPPR0   2
         3 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000075   000000 701000 xent               TSX1    KSE$ERRMSG
         3 000076   000000 011000                    NOP     0

      856    10369    3           GOTO ERR1;
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:168  

  10369  3 000077   000342 710000 3                  TRA     ERR1

      857    10370    3           END; /* end altreturn */
      858    10371    2        END; /* number of sub-blocks = 2 */

  10371  3 000100   000104 710000 3                  TRA     s:10377

      859    10372    1     ELSE
      860    10373    2        DO;

      861    10374    2        TERMHI = TERMLO;

  10374  3 000101   000100 100500                    MLR     fill='000'O
         3 000102   200025 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         3 000103   200031 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16

      862    10375    2        END;

      863    10376
      864    10377    2     DO CASE (CODE);

  10377  3 000104   200007 235100                    LDA     CODE,,AUTO
         3 000105   000010 135007                    SBLA    8,DL
         3 000106   000002 115007                    CMPA    2,DL
         3 000107   000111 602005 3                  TNC     s:10377+5,AL
         3 000110   000126 710000 3                  TRA     s:10389
         3 000111   000113 710000 3                  TRA     s:10379
         3 000112   000121 710000 3                  TRA     s:10382

      865    10378    2        CASE(%KS_PART);

      866    10379    2           KS_ADMIN.FNC = %KHA_FNC_PARTITION;

  10379  3 000113   000007 220003                    LDX0    7,DU
         3 000114   000011 440000 2                  SXL0    KS_ADMIN+8

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:169  
      867    10380    2           PART_RET = 'partitioned';

  10380  3 000115   040100 100400                    MLR     fill='040'O
         3 000116   000037 000013 1                  ADSC9   CMPLTED_OK_VEC+3         cn=0,n=11
         3 000117   200012 000013                    ADSC9   PART_RET,,AUTO           cn=0,n=11
         3 000120   000126 710000 3                  TRA     s:10389

      868    10381    2        CASE(%KS_RET);

      869    10382    2           KS_ADMIN.FNC = %KHA_FNC_RETURN;

  10382  3 000121   000011 220003                    LDX0    9,DU
         3 000122   000011 440000 2                  SXL0    KS_ADMIN+8

      870    10383    2           PART_RET = 'Returned';

  10383  3 000123   040100 100400                    MLR     fill='040'O
         3 000124   000042 000010 1                  ADSC9   CMPLTED_OK_VEC+6         cn=0,n=8
         3 000125   200012 000013                    ADSC9   PART_RET,,AUTO           cn=0,n=11

      871    10384    2     END; /*end case code*/

      872    10385
      873    10386        /*
      874    10387          set handler name, terminal low and high name
      875    10388        */
      876    10389    1     KS_ADMIN.HANDLER = KS_HNDLRNAME;

  10389  3 000126   040000 100400                    MLR     fill='040'O
         3 000127   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         3 000130   000002 000010 2                  ADSC9   KS_ADMIN+1               cn=0,n=8

      877    10390    1     KS_ADMIN.TERMID_LO = TERMLO;

  10390  3 000131   000000 100500                    MLR     fill='000'O
         3 000132   200025 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         3 000133   000012 000020 2                  ADSC9   KS_ADMIN+9               cn=0,n=16
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:170  

      878    10391    1     KS_ADMIN.TERMID_HI = TERMHI;

  10391  3 000134   000000 100500                    MLR     fill='000'O
         3 000135   200031 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         3 000136   000016 000020 2                  ADSC9   KS_ADMIN+13              cn=0,n=16

      879    10392    1     CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR);

  10392  3 000137   000006 630400 4                  EPPR0   6
         3 000140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000141   000000 701000 xent               TSX1    KSR$WR_HLPCG
         3 000142   000346 702000 3                  TSX2    ERR

      880    10393    1     CALL KSR$RD_HLPCG WHENRETURN

  10393  3 000143   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000144   000000 701000 xent               TSX1    KSR$RD_HLPCG
         3 000145   000341 702000 3                  TSX2    s:10431

      881    10394    2        DO;

      882    10395    2           IF KS$HDR.RESULTS = '0'B THEN

  10395  3 000146   000000 470400 2                  LDP0    HDR$
         3 000147   000007 235100                    LDA     7,,PR0
         3 000150   000340 601000 3                  TNZ     s:10426

      883    10396    3              DO;

      884    10397                %ARRAY_TO_WORD(S=TERMLO.TERM.CHANNEL,D=CHNL_NO_LO);

  10398  3 000151   200025 236100                    LDQ     TERMLO,,AUTO
         3 000152   000001 772000                    QRL     1
         3 000153   177400 376007                    ANQ     65280,DL
         3 000154   200006 756100                    STQ     CHNL_NO_LO,,AUTO

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:171  
  10399  3 000155   200025 236100                    LDQ     TERMLO,,AUTO
         3 000156   000377 376007                    ANQ     255,DL
         3 000157   200006 036100                    ADLQ    CHNL_NO_LO,,AUTO
         3 000160   200006 756100                    STQ     CHNL_NO_LO,,AUTO

      885    10401                %ARRAY_TO_WORD(S=TERMLO.TERM.SUBDEVICE,D=SUBDEV_LO);

  10402  3 000161   200026 236100                    LDQ     TERMLO+1,,AUTO
         3 000162   000023 772000                    QRL     19
         3 000163   177400 376007                    ANQ     65280,DL
         3 000164   200015 756100                    STQ     SUBDEV_LO,,AUTO

  10403  3 000165   200026 236100                    LDQ     TERMLO+1,,AUTO
         3 000166   000022 772000                    QRL     18
         3 000167   000377 376007                    ANQ     255,DL
         3 000170   200015 036100                    ADLQ    SUBDEV_LO,,AUTO
         3 000171   200015 756100                    STQ     SUBDEV_LO,,AUTO

      886    10405                %ARRAY_TO_WORD(S=TERMLO.TERM.SUBSUBDEVICE,D=SUBSUBDEV_LO);

  10406  3 000172   200026 236100                    LDQ     TERMLO+1,,AUTO
         3 000173   000001 772000                    QRL     1
         3 000174   177400 376007                    ANQ     65280,DL
         3 000175   200016 756100                    STQ     SUBSUBDEV_LO,,AUTO

  10407  3 000176   200026 236100                    LDQ     TERMLO+1,,AUTO
         3 000177   000377 376007                    ANQ     255,DL
         3 000200   200016 036100                    ADLQ    SUBSUBDEV_LO,,AUTO
         3 000201   200016 756100                    STQ     SUBSUBDEV_LO,,AUTO

      887    10409                %ARRAY_TO_WORD(S=TERMHI.TERM.CHANNEL,D=CHNL_NO_HI);

  10410  3 000202   200031 236100                    LDQ     TERMHI,,AUTO
         3 000203   000001 772000                    QRL     1
         3 000204   177400 376007                    ANQ     65280,DL
         3 000205   200005 756100                    STQ     CHNL_NO_HI,,AUTO

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:172  
  10411  3 000206   200031 236100                    LDQ     TERMHI,,AUTO
         3 000207   000377 376007                    ANQ     255,DL
         3 000210   200005 036100                    ADLQ    CHNL_NO_HI,,AUTO
         3 000211   200005 756100                    STQ     CHNL_NO_HI,,AUTO

      888    10413                %ARRAY_TO_WORD(S=TERMHI.TERM.SUBDEVICE,D=SUBDEV_HI);

  10414  3 000212   200032 236100                    LDQ     TERMHI+1,,AUTO
         3 000213   000023 772000                    QRL     19
         3 000214   177400 376007                    ANQ     65280,DL
         3 000215   200017 756100                    STQ     SUBDEV_HI,,AUTO

  10415  3 000216   200032 236100                    LDQ     TERMHI+1,,AUTO
         3 000217   000022 772000                    QRL     18
         3 000220   000377 376007                    ANQ     255,DL
         3 000221   200017 036100                    ADLQ    SUBDEV_HI,,AUTO
         3 000222   200017 756100                    STQ     SUBDEV_HI,,AUTO

      889    10417                %ARRAY_TO_WORD(S=TERMHI.TERM.SUBSUBDEVICE,D=SUBSUBDEV_HI);

  10418  3 000223   200032 236100                    LDQ     TERMHI+1,,AUTO
         3 000224   000001 772000                    QRL     1
         3 000225   177400 376007                    ANQ     65280,DL
         3 000226   200020 756100                    STQ     SUBSUBDEV_HI,,AUTO

  10419  3 000227   200032 236100                    LDQ     TERMHI+1,,AUTO
         3 000230   000377 376007                    ANQ     255,DL
         3 000231   200020 036100                    ADLQ    SUBSUBDEV_HI,,AUTO
         3 000232   200020 756100                    STQ     SUBSUBDEV_HI,,AUTO

      890    10421    3           CALL KSW$WRITE(CMPLTED_OK_VEC,VECTOR(CHNL_NO_LO),VECTOR(SUBDEV_LO),

  10421  3 000233   777640 235007                    LDA     -96,DL
         3 000234   200036 452500                    STP2    TERMHI+5,,AUTO
         3 000235   200036 236100                    LDQ     TERMHI+5,,AUTO
         3 000236   000006 036003                    ADLQ    6,DU
         3 000237   200040 757100                    STAQ    TERMHI+7,,AUTO
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:173  
         3 000240   777640 235007                    LDA     -96,DL
         3 000241   200042 452500                    STP2    TERMHI+9,,AUTO
         3 000242   200042 236100                    LDQ     TERMHI+9,,AUTO
         3 000243   000015 036003                    ADLQ    13,DU
         3 000244   200044 757100                    STAQ    TERMHI+11,,AUTO
         3 000245   777640 235007                    LDA     -96,DL
         3 000246   200046 452500                    STP2    TERMHI+13,,AUTO
         3 000247   200046 236100                    LDQ     TERMHI+13,,AUTO
         3 000250   000016 036003                    ADLQ    14,DU
         3 000251   200050 757100                    STAQ    TERMHI+15,,AUTO
         3 000252   777640 235007                    LDA     -96,DL
         3 000253   200052 452500                    STP2    TERMHI+17,,AUTO
         3 000254   200052 236100                    LDQ     TERMHI+17,,AUTO
         3 000255   000005 036003                    ADLQ    5,DU
         3 000256   200054 757100                    STAQ    TERMHI+19,,AUTO
         3 000257   777640 235007                    LDA     -96,DL
         3 000260   200056 452500                    STP2    TERMHI+21,,AUTO
         3 000261   200056 236100                    LDQ     TERMHI+21,,AUTO
         3 000262   000017 036003                    ADLQ    15,DU
         3 000263   200060 757100                    STAQ    TERMHI+23,,AUTO
         3 000264   777640 235007                    LDA     -96,DL
         3 000265   200062 452500                    STP2    TERMHI+25,,AUTO
         3 000266   200062 236100                    LDQ     TERMHI+25,,AUTO
         3 000267   000020 036003                    ADLQ    16,DU
         3 000270   200064 757100                    STAQ    TERMHI+27,,AUTO
         3 000271   000007 235000 4                  LDA     7
         3 000272   200066 452500                    STP2    TERMHI+29,,AUTO
         3 000273   200066 236100                    LDQ     TERMHI+29,,AUTO
         3 000274   000012 036003                    ADLQ    10,DU
         3 000275   200072 757100                    STAQ    TERMHI+33,,AUTO
         3 000276   200040 237100                    LDAQ    TERMHI+7,,AUTO
         3 000277   200070 757100                    STAQ    TERMHI+31,,AUTO
         3 000300   200044 237100                    LDAQ    TERMHI+11,,AUTO
         3 000301   200074 757100                    STAQ    TERMHI+35,,AUTO
         3 000302   200050 237100                    LDAQ    TERMHI+15,,AUTO
         3 000303   200076 757100                    STAQ    TERMHI+37,,AUTO
         3 000304   200054 237100                    LDAQ    TERMHI+19,,AUTO
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:174  
         3 000305   200100 757100                    STAQ    TERMHI+39,,AUTO
         3 000306   200060 237100                    LDAQ    TERMHI+23,,AUTO
         3 000307   200102 757100                    STAQ    TERMHI+41,,AUTO
         3 000310   200064 237100                    LDAQ    TERMHI+27,,AUTO
         3 000311   200104 757100                    STAQ    TERMHI+43,,AUTO
         3 000312   200072 237100                    LDAQ    TERMHI+33,,AUTO
         3 000313   200106 757100                    STAQ    TERMHI+45,,AUTO
         3 000314   200106 631500                    EPPR1   TERMHI+45,,AUTO
         3 000315   200117 451500                    STP1    TERMHI+54,,AUTO
         3 000316   200104 633500                    EPPR3   TERMHI+43,,AUTO
         3 000317   200116 453500                    STP3    TERMHI+53,,AUTO
         3 000320   200102 634500                    EPPR4   TERMHI+41,,AUTO
         3 000321   200115 454500                    STP4    TERMHI+52,,AUTO
         3 000322   200100 635500                    EPPR5   TERMHI+39,,AUTO
         3 000323   200114 455500                    STP5    TERMHI+51,,AUTO
         3 000324   200076 636500                    EPPR6   TERMHI+37,,AUTO
         3 000325   200113 456500                    STP6    TERMHI+50,,AUTO
         3 000326   200074 637500                    EPPR7   TERMHI+35,,AUTO
         3 000327   200112 457500                    STP7    TERMHI+49,,AUTO
         3 000330   200070 630500                    EPPR0   TERMHI+31,,AUTO
         3 000331   200111 450500                    STP0    TERMHI+48,,AUTO
         3 000332   000010 236000 4                  LDQ     8
         3 000333   200110 756100                    STQ     TERMHI+47,,AUTO
         3 000334   200110 630500                    EPPR0   TERMHI+47,,AUTO
         3 000335   000026 631400 xsym               EPPR1   B_VECTNIL+22
         3 000336   000000 701000 xent               TSX1    KSW$WRITE
         3 000337   000000 011000                    NOP     0

      891    10422    3                          VECTOR(SUBSUBDEV_LO),VECTOR(CHNL_NO_HI),
      892    10423    3                          VECTOR(SUBDEV_HI),VECTOR(SUBSUBDEV_HI),
      893    10424    3                          VECTOR(PART_RET));
      894    10425    3           END;  /* results = 0 */

      895    10426    2        END;   /* end when return */

  10426  3 000340   000341 710000 3                  TRA     s:10431

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:175  
      896    10427    1     WHENALTRETURN
      897    10428    2        DO;

      898    10429    2        END;   /*alt return*/

      899    10430
      900    10431    2        DO WHILE ('0'B);

  10431  3 000341   000352 710000 3                  TRA     s:10435

      901    10432    2   ERR1:   CALL KSE$ERRMSG(0);

  10432  3 000342   000011 630400 4     ERR1         EPPR0   9
         3 000343   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000344   000000 701000 xent               TSX1    KSE$ERRMSG
         3 000345   000000 011000                    NOP     0

      902    10433    2   ERR:    CALL KSE$ERRMSG(%E$KS_CANTDOIT);

  10433  3 000346   000013 630400 4     ERR          EPPR0   11
         3 000347   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000350   000000 701000 xent               TSX1    KSE$ERRMSG
         3 000351   000000 011000                    NOP     0

      903    10434    2        END;

      904    10435    1     RETURN;

  10435  3 000352   000000 702200 xent               TSX2  ! X66_ARET
      905    10436
      906    10437    1     END KSC$PART;
      907    10438        %EOD;

PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:176  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$PART.
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:177  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$PART

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/c CHAR(54)    r     1 CMPLTED_OK_FMT            34-0-0/d BIT (72)    r     1 CMPLTED_OK_VEC
     0-0-0/c CHAR(43)    r     1 FORM_FMT

  ****  Section 002  Data  KSC$PART

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HDR$                       1-0-0/w STRC(612)   r     1 KS_ADMIN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                      5-0-0/w UBIN        r     1 CHNL_NO_HI
     6-0-0/w UBIN        r     1 CHNL_NO_LO                 7-0-0/w UBIN        r     1 CODE
    11-0-0/w UBIN        r     1 J                         12-0-0/c CHAR(11)    r     1 PART_RET
    17-0-0/w UBIN        r     1 SUBDEV_HI                 15-0-0/w UBIN        r     1 SUBDEV_LO
    20-0-0/w UBIN        r     1 SUBSUBDEV_HI              16-0-0/w UBIN        r     1 SUBSUBDEV_LO
    31-0-0/c STRC(144)   r     1 TERMHI                    25-0-0/c STRC(144)   r     1 TERMLO
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 KS_HNDLRNAME               0-0-0/c CHAR(400)   r     1 KS_MSGBUF
     0-0-0/w PTR         r     1 KS_MSGBUF$                 0-0-0/c CHAR(8)     r     1 KS_NODENAME
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:178  
     0-0-0/c CHAR(8)     r     1 KS_NODENAME_SV

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(306)   r     1 KS$HDR                     0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure KSC$PART requires 235 words for executable code.
   Procedure KSC$PART requires 80 words of local(AUTO) storage.
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:179  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:180  
          MINI XREF LISTING

B$ALT.CODE
     10253**DCL     10253--REDEF   10254--REDEF   10254--REDEF
B$ALT.ERR.ERR#
     10255**DCL     10255--REDEF
B$ALT.EVID
     10254**DCL     10254--REDEF   10254--REDEF
CHNL_NO_HI
      9855**DCL     10410<<ASSIGN  10411<<ASSIGN  10411>>ASSIGN  10421--CALL
CHNL_NO_LO
      9856**DCL     10398<<ASSIGN  10399<<ASSIGN  10399>>ASSIGN  10421--CALL
CMPLTED_OK_FMT
      9952**DCL      9953--DCLINIT
CMPLTED_OK_VEC
      9953**DCL     10421<>CALL
CODE
      9857**DCL     10361<<ASSIGN  10377>>DOCASE
ERR
     10433**LABEL   10362--CALLALT 10365--CALLALT 10392--CALLALT
ERR1
     10432**LABEL   10369--GOTO
FORM_FMT
      9797**DCL      9798--DCLINIT
HDR$
      9826**DCL     10184--IMP-PTR 10395>>IF
J
      9859**DCL     10358<<ASSIGN  10360<<ASSIGN  10362>>CALL    10365>>CALL
KS$HDR.RESULTS
     10214**DCL     10395>>IF
KSE$ERRMSG
      9734**DCL-ENT 10349--CALL    10368--CALL    10432--CALL    10433--CALL
KSR$RD_HLPCG
      9735**DCL-ENT 10393--CALL
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:181  
KSR$WR_HLPCG
      9736**DCL-ENT 10392--CALL
KSU$BLD_TERMID
      9737**DCL-ENT 10362--CALL    10365--CALL
KSU$CHK_TRM_RNG
      9738**DCL-ENT 10366--CALL
KSW$WRITE
      9741**DCL-ENT 10421--CALL
KS_ADMIN
     10013**DCL     10392--CALL
KS_ADMIN.FNC
     10080**DCL     10379<<ASSIGN  10382<<ASSIGN
KS_ADMIN.HANDLER
     10022**DCL     10389<<ASSIGN
KS_ADMIN.TERMID_HI
     10127**DCL     10391<<ASSIGN
KS_ADMIN.TERMID_HI.TERM
     10129**DCL     10138--REDEF
KS_ADMIN.TERMID_LO
     10098**DCL     10390<<ASSIGN
KS_ADMIN.TERMID_LO.TERM
     10100**DCL     10109--REDEF
KS_HNDLRNAME
      9533**DCL     10389>>ASSIGN
KS_MSGBUF
      9535**DCL      9826--DCLINIT
KS_MSGBUF$
      9535**DCL      9535--IMP-PTR
KS_MYSTATION
      9531**DCL      9531--REDEF
KS_NODENAME
      9531**DCL     10347>>IF
KS_NODENAME_SV
      9532**DCL     10357>>IF
OUT$BLK.CODE
     10273**DCL     10361>>ASSIGN
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:182  
OUT$BLK.NSUBLKS
     10277**DCL     10363>>IF
OUT$BLK.SUBLK$
     10298**DCL     10362>>CALL    10362<>CALL    10363>>IF      10365>>CALL    10365<>CALL
OUT$SYM.COUNT
     10334**DCL     10337--IMP-SIZ
PART_RET
      9860**DCL     10380<<ASSIGN  10383<<ASSIGN  10421--CALL
SUBDEV_HI
      9863**DCL     10414<<ASSIGN  10415<<ASSIGN  10415>>ASSIGN  10421--CALL
SUBDEV_LO
      9861**DCL     10402<<ASSIGN  10403<<ASSIGN  10403>>ASSIGN  10421--CALL
SUBSUBDEV_HI
      9864**DCL     10418<<ASSIGN  10419<<ASSIGN  10419>>ASSIGN  10421--CALL
SUBSUBDEV_LO
      9862**DCL     10406<<ASSIGN  10407<<ASSIGN  10407>>ASSIGN  10421--CALL
TERMHI
      9910**DCL     10365<>CALL    10366<>CALL    10374<<ASSIGN  10391>>ASSIGN
TERMHI.TERM
      9914**DCL      9923--REDEF
TERMHI.TERM.CHANNEL.BYT
      9916**DCL     10410>>ASSIGN  10411>>ASSIGN
TERMHI.TERM.SUBDEVICE.BYT
      9917**DCL     10414>>ASSIGN  10415>>ASSIGN
TERMHI.TERM.SUBSUBDEVICE.BYT
      9918**DCL     10418>>ASSIGN  10419>>ASSIGN
TERMLO
      9881**DCL     10362<>CALL    10366<>CALL    10374>>ASSIGN  10390>>ASSIGN
TERMLO.TERM
      9885**DCL      9894--REDEF
TERMLO.TERM.CHANNEL.BYT
      9887**DCL     10398>>ASSIGN  10399>>ASSIGN
TERMLO.TERM.SUBDEVICE.BYT
      9888**DCL     10402>>ASSIGN  10403>>ASSIGN
TERMLO.TERM.SUBSUBDEVICE.BYT
      9889**DCL     10406>>ASSIGN  10407>>ASSIGN
PL6.E3A0      #003=KSC$PART File=KSC$COMMANDS1.:E05TSI                           WED 07/30/97 01:44 Page:183  
TOP$
        13**DCL        11--PROC    10265--IMP-PTR 10361>>ASSIGN  10362>>CALL    10363>>IF      10365>>CALL

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:184  
      908        1        /*T***********************************************************/
      909        2        /*T*                                                         */
      910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      911        4        /*T*                                                         */
      912        5        /*T***********************************************************/
      913        6        KSC$SET: PROC(TOP$) ALTRET;
      914        7        /**/
      915        8    1   DCL TOP$ PTR;
      916        9        /**/
      917       10        %INCLUDE CP_6;
      918       91        %INCLUDE KL_MACRO_C;
      919     3443        %INCLUDE KS_MACRO_M;
      920     3640        %INCLUDE KS_SUBS_C;
      921     3883        %INCLUDE KS_DATA_R;
      922     3898        %INCLUDE KS_PERR_C;
      923     3965        %INCLUDE KL_CONTROL_C;
      924     4345        %INCLUDE KL_AFCN_C;
      925     4446        %INCLUDE KL_CONFIG_M;
      926     5208        %INCLUDE GI_BOOT_C;
      927     5319        %INCLUDE XU_MACRO_C;
      928     8425        %INCLUDE B_ERRORS_C;
      929     9552        %INCLUDE F$DCB;
      930     9601        /**/
      931     9602        %KS$BOX(TITLE="entry defs");

              9620    1   /***************************************************************************
              9621    1    *                                                                         *
              9622    1    *                                 entry defs                              *
              9623    1    *                                                                         *
              9624    1    ***************************************************************************/

      932     9629    1   DCL KSE$ERRMSG ENTRY(4);
      933     9630    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
      934     9631    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      935     9632    1   DCL KSU$CHARBIN ENTRY(4) ALTRET;
      936     9633    1   DCL KSW$WRITE ENTRY(11);
      937     9634    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:185  
      938     9635    1   DCL KSU$UNPACK ENTRY(2);
      939     9636    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
      940     9637    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
      941     9638    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
      942     9639    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      943     9640    1   DCL KSU$STRIP_ZEROS ENTRY(3);
      944     9641        %KS$BOX(TITLE="symref variables");

              9659    1   /***************************************************************************
              9660    1    *                                                                         *
              9661    1    *                              symref variables                           *
              9662    1    *                                                                         *
              9663    1    ***************************************************************************/

      945     9668    1   DCL B$TCB$ PTR SYMREF;
      946     9669    1   DCL KS_TBL(0:9) PTR SYMREF;
      947     9670    1   DCL KS_FID SBIN SYMREF;
      948     9671    1   DCL KS_LIB SBIN SYMREF;
      949     9672    1   DCL KS_HAND SBIN SYMREF;
      950     9673    1   DCL KS_NRHAND SBIN SYMREF;
      951     9674    1   DCL KS_CMD SBIN SYMREF;
      952     9675        %P_PCB(NAME = P_PCB,STCLASS=SYMREF);
      953     9874        %KS$HAND_INFO ( NAME = KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF", LAST=";");
      954     9913        %KS$BOX(TITLE="symdef variables");

              9931    1   /***************************************************************************
              9932    1    *                                                                         *
              9933    1    *                              symdef variables                           *
              9934    1    *                                                                         *
              9935    1    ***************************************************************************/

      955     9940        %KS$BOX(TITLE="constant variables");

              9958    1   /***************************************************************************
              9959    1    *                                                                         *
              9960    1    *                             constant variables                          *
              9961    1    *                                                                         *
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:186  
              9962    1    ***************************************************************************/

      956     9967        /**/
      957     9968    1   DCL EQUALS CHAR(0) CONSTANT INIT('=');
      958     9969    1   DCL STAR CHAR(0) CONSTANT INIT('*');
      959     9970    1   DCL MONFID CHAR(0) CONSTANT INIT('Monitor Fid (%T) %10P');
      960     9971    1   DCL NHNDLRS CHAR(0) CONSTANT INIT('Number of Handlers (%D) %10P');
      961     9972    1   DCL HNDLRNAME CHAR(0) CONSTANT INIT('Handler #%D Name (%T) %10P');
      962     9973    1   DCL HEX_DIGITS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      963     9974    1   DCL HNDLRFID CHAR(0) CONSTANT INIT('Handler #%D Fid (%T) %10P');
      964     9975    1   DCL LIBACCT CHAR(0) CONSTANT INIT('Library account (%T) %10P');
      965     9976    1   DCL WRITE_SUCCESSFULL_FMT CHAR(0) CONSTANT INIT (
      966     9977    1        '%T successfully written to %2P%A%10P');
      967     9978    1   DCL WRITE_SUCCESSFULL_VEC BIT(72) DALIGNED CONSTANT INIT
      968     9979    1        (VECTOR(WRITE_SUCCESSFULL_FMT));
      969     9980    1   DCL NETCON CHAR(0) CONSTANT INIT (':NETCON');
      970     9981    1   DCL FEP CHAR(0) CONSTANT INIT ('FEP');
      971     9982        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:187  
             10000    1   /***************************************************************************
             10001    1    *                                                                         *
             10002    1    *                              static variables                           *
             10003    1    *                                                                         *
             10004    1    ***************************************************************************/

      972    10009    1   DCL 1 TEXTC STATIC ALIGNED,
      973    10010    1         2 COUNT UBIN BYTE UNAL INIT(0),
      974    10011    1         2 TEXT CHAR(40) UNAL INIT(' ');
      975    10012    1   DCL HNDLR_BUF(0:400) CHAR(1) STATIC INIT(' '*0);
      976    10013    1   DCL HANDLER$ STATIC PTR INIT(ADDR(HNDLR_BUF));
      977    10014    1   DCL SI_BUF CHAR(100) STATIC ALIGNED;
      978    10015    1   DCL FIDNAME CHAR(28) STATIC ALIGNED;
      979    10016        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      980    10035    1   DCL DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
      981    10036    1   DCL DEFAULT$           PTR STATIC INIT(ADDR(DEFAULT_BUF));
      982    10037        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
      983    10056        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
      984    10081        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
      985    10099        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_BOOTHI,STCLASS=STATIC);
      986    10119        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
      987    10137        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      988    10167        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
      989    10185        %KL$PSEUDO(NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
      990    10229        %KL$PSEUDO_KEY(NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
      991    10247    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      992    10248    1   DCL 1 PROMPT  SYMREF,
      993    10249    1           2 NODENAME CHAR(8),
      994    10250    1           2 STAR CHAR(2);
      995    10251        %KL_CONTROL (FPTN=KS_CONTROL,STCLASS=STATIC);
      996    10387        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,NUMI=2,STCLASS=STATIC);
      997    10450        %KS$BOX(TITLE="based variables");

             10468    1   /***************************************************************************
             10469    1    *                                                                         *
             10470    1    *                              based variables                            *
             10471    1    *                                                                         *
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:188  
             10472    1    ***************************************************************************/

      998    10477        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      999    10522        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     1000    10560        %PARSE$OUT (NAME=OUT$BLK2,STCLASS="BASED(TOP2$)");
     1001    10605        %PARSE$SYM (NAME=OUT$SYM2,STCLASS=BASED);
     1002    10643        %KL$HNDLR (NAME = KS$HNDLR,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
     1003    10706        %KL_HDR(FPTN=KS$HDR,STCLASS="BASED(HDR$)");
     1004    10786        %KL$LINCNFG (NAME=KS_DEFAULT_REC,STCLASS="BASED(DEFAULT$)");
     1005    10944        %KL_HDR (FPTN=KS_HDR,STCLASS="BASED(KS_MSGBUF$)");
     1006    11024    1   DCL 1 HND BASED UNAL,
     1007    11025    1        2 DAT(0:18) BIT(1) UNAL;
     1008    11026        %KS$PARAM (NAME=KS$PARAM,LVL=1,STCLASS="(0:0) BASED",LAST=";");
     1009    11096        %KS$PARAM (NAME=KS$PRM,LVL=1,STCLASS="(0:0) BASED",LAST=";",SPECIAL=YES);
     1010    11166    1   DCL VALUE_B(0:0) UBIN HALF BASED HALIGNED;
     1011    11167        %VLP_NAME(FPTN = NAME,STCLASS = BASED);
     1012    11194        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:189  
             11212    1   /***************************************************************************
             11213    1    *                                                                         *
             11214    1    *                               auto variables                            *
             11215    1    *                                                                         *
             11216    1    ***************************************************************************/

     1013    11221    1   DCL BOOT_FLAG BIT(1);
     1014    11222    1   DCL FID_FLAG BIT(1);
     1015    11223    1   DCL BOOTIME  BIT(1) UNAL;
     1016    11224    1   DCL TEMP UBIN;
     1017    11225    1   DCL HNDLREXISTS BIT(1);
     1018    11226    1   DCL HEX_CHAR CHAR(1);
     1019    11227    1   DCL HEX_DIGIT UBIN;
     1020    11228    1   DCL HNDLRX UBIN;   /* index in fephndlr.handler array */
     1021    11229    1   DCL INDX1  UBIN;   /* general index */
     1022    11230    1   DCL INDX2  UBIN;
     1023    11231    1   DCL I UBIN;
     1024    11232    1   DCL INDX UBIN;
     1025    11233    1   DCL INDX_VEC(0:49) UBIN;
     1026    11234    1   DCL J UBIN;
     1027    11235    1   DCL K UBIN;
     1028    11236    1   DCL 1 KS_SUB_BUF_TEMP2  ALIGNED,
     1029    11237    1        2 COUNT UBIN BYTE UNAL,
     1030    11238    1        2 TEXT_C UNAL,
     1031    11239    1          3 TOPSIZ CHAR(6) UNAL,
     1032    11240    1          3 TEXT CHAR(25) UNAL,
     1033    11241    1        2 TEXT REDEF TEXT_C CHAR(31);
     1034    11242
     1035    11243    1   DCL 1 KS_SUB_BUF_4 ALIGNED,
     1036    11244    1        2 COUNT UBIN BYTE UNAL,
     1037    11245    1        2 TEXT CHAR(31) UNAL;
     1038    11246    1   DCL L UBIN;
     1039    11247    1   DCL LIB_FLAG BIT(1);    /* misc flags to indicate options on set boot cmd */
     1040    11248    1   DCL MON_FLAG BIT(1);
     1041    11249    1   DCL OPTBLK$ PTR;          /* pointer to options on set boot cmd */
     1042    11250    1   DCL PARMX UBIN;
     1043    11251    1   DCL PARMTYPE UBIN;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:190  
     1044    11252    1   DCL PERM_PARM UBIN BYTE;
     1045    11253    1   DCL NUM_INDX UBIN;
     1046    11254    1   DCL SCNOPTS UBIN;         /* pointer to options on handler in set boot */
     1047    11255    1   DCL SUBLK$ PTR;
     1048    11256    1   DCL SUBLOP UBIN;
     1049    11257    1   DCL TEMP1 UBIN;
     1050    11258    1   DCL TEMP2 UBIN;
     1051    11259    1   DCL T_PSEUDO# SBIN;
     1052    11260    1   DCL TMP$    PTR;          /* temporary pointer */
     1053    11261    1   DCL VALUE UBIN;
     1054    11262    1   DCL 1 VALUEC REDEF VALUE,
     1055    11263    1        2 * CHAR(2) UNAL,
     1056    11264    1        2 RES CHAR(2) UNAL;
     1057    11265        /* redef of ks_sub_buf_? for error message display */
     1058    11266        /**/
     1059    11267    1   DCL ERR# UBIN;
     1060    11268    1   DCL BLK$ PTR;
     1061    11269    1   DCL TOP2$ PTR;
     1062    11270    1   DCL PTR$ PTR;
     1063    11271    1   DCL DFLT_OPT$ PTR;
     1064    11272    1   DCL OUT$ PTR;
     1065    11273    1   DCL INDX_R UBIN BYTE;
     1066    11274    1   DCL SZ UBIN WORD;
     1067    11275    1   DCL BUF_SIZE UBIN WORD;
     1068    11276    1   DCL HANDLERNAME CHAR(8);
     1069    11277    1   DCL OLD_HANDLER (0:20) CHAR(8) ALIGNED;
     1070    11278    1   DCL OLD_BOOTIME (0:20) BIT(1) UNAL;
     1071    11279    1   DCL OLD_NRHAND   UBIN;
     1072    11280    1   DCL RECORD_SIZE  UBIN;
     1073    11281    1   DCL RECORD_CHANGED  BIT(1) ALIGNED;
     1074    11282    1   DCL HANDLER_FOUND   BIT(1) ALIGNED;
     1075    11283    1   DCL RCVCQ_SNDCQ     BIT(1) ALIGNED;
     1076    11284    1   DCL HANDNR       UBIN;
     1077    11285        %B$TCB;
     1078    11288        %B$ALT;
     1079    11296        /**/
     1080    11297        %KS$BOX(TITLE="FPTs and VLPs");
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:191  

             11315    1   /***************************************************************************
             11316    1    *                                                                         *
             11317    1    *                               FPTs and VLPs                             *
             11318    1    *                                                                         *
             11319    1    ***************************************************************************/

     1081    11324        %FPT_READ (FPTN=READ_NETCON,
     1082    11325                   DCB=M$NETCON,
     1083    11326                   KEYS=YES);
     1084    11365        %FPT_WRITE (FPTN=WRITE_NETCON,
     1085    11366                    DCB=M$NETCON);
     1086    11397        %FPT_DELREC (FPTN=DELREC_NETCON,
     1087    11398                     DCB=M$NETCON);
     1088    11417        /**/
     1089    11418        %FPT_OPEN;
     1090    11527        /**/
     1091    11528        %FPT_FID (FPTN = NETCON_FID,
     1092    11529                  NAME = VLP_NAME,PASS=VLP_PASS,
     1093    11530                  RESULTS = VLR_FID, ACCT = VLP_ACCT,
     1094    11531                  SN = VLP_SN, WSN = VLP_WSN,
     1095    11532                  ASN = "FPT_OPEN.V.ASN#", RES = "FPT_OPEN.V.RES#",
     1096    11533                  TEXTFID = FIDNAME);
     1097    11556        /**/
     1098    11557        %VLP_ACCT;
     1099    11570        %VLP_NAME;
     1100    11597        %VLP_PASS;
     1101    11610        %VLP_SN;
     1102    11623        %VLP_WSN;
     1103    11636        %VLR_FID;
     1104    11655        %KS$BOX(TITLE="DCBs");

             11673    1   /***************************************************************************
             11674    1    *                                                                         *
             11675    1    *                                    DCBs                                 *
             11676    1    *                                                                         *
             11677    1    ***************************************************************************/
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:192  

     1105    11682    1   DCL M$NETCON DCB;
     1106    11683    1   DCL M$SI DCB;
     1107    11684        %KS$BOX(TITLE="EQUs");

             11702    1   /***************************************************************************
             11703    1    *                                                                         *
             11704    1    *                                    EQUs                                 *
             11705    1    *                                                                         *
             11706    1    ***************************************************************************/

     1108    11711        %EQU KS_MAX_HALF = 6;
     1109    11712        %EQU KS_MAX_PSEUDO = 7;
     1110    11713        /**/
     1111    11714        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:193  
     1112    11715    2        IF KS_NODENAME = 'HOST' THEN DO;
     1113    11716    2           CALL KSE$ERRMSG(%E$KS_NONODE);
     1114    11717                /*E* ERROR: KSN-E$KS_NONODE-0
     1115    11718                     MESSAGE: Node has not been selected.
     1116    11719                     MESSAGE1: A node must be selected via the SELECT command.
     1117    11720                     DESCRIPTION: SEE MESSAGES */
     1118    11721    2           RETURN;
     1119    11722    2           END;  /* IF KS_NODENAME = 'HOST' */
     1120    11723    2   DOI: DO I = 0 TO OUT$BLK.NSUBLKS - 1;
     1121    11724    2           BLK$ = OUT$BLK.SUBLK$(I);
     1122    11725    3           DO CASE(BLK$->OUT$BLK.CODE);
     1123    11726    3              CASE(%KS_BOOTINFO);
     1124    11727    3                 IF BLK$->OUT$BLK.NSUBLKS > 0 THEN
     1125    11728    4                    DO;  /* 1 set boot commands with options  */
     1126    11729    4                    KS_FEPHNDLR = '0'B;   /* init buffer areas  */
     1127    11730
     1128    11731    4                    KS_FEPBOOT = '0'B;
     1129    11732        /**/
     1130    11733                         /* params will always be off of 1st sublk */
     1131    11734        /**/
     1132    11735        /*
     1133    11736                read the ks_fephndlr record.  use this same buffer
     1134    11737                throughout the entire processing period.
     1135    11738        */
     1136    11739    4                    KS_FEPHNDLR_KEY.NODE = KS_NODE;
     1137    11740    4                    READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
     1138    11741    4                    READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     1139    11742    4                    CALL M$READ(READ_NETCON) ALTRET(SET_ERR);
     1140    11743        /**/
     1141    11744    5                    DO SCNOPTS = 0 TO BLK$->OUT$BLK.NSUBLKS-1;  /*  2  */
     1142    11745    5                       HNDLR_BUF = '0'B;
     1143    11746    5                       TMP$ = BLK$->OUT$BLK.SUBLK$(SCNOPTS);
     1144    11747    6      SETCODE:         DO CASE (TMP$->OUT$BLK.CODE);   /*  3  */
     1145    11748        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:194  
     1146    11749    6                          CASE (%KS_MONFID);
     1147    11750    6                             KS_FEPBOOT_KEY.NODE = KS_NODE;
     1148    11751    6                             READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     1149    11752    6                             READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     1150    11753    6                             CALL M$READ(READ_NETCON) ALTRET(SETCODE);
     1151    11754        /*
     1152    11755             a fepboot record must exist for the set boot command to work.
     1153    11756        */
     1154    11757    6                             IF TMP$->OUT$BLK.NSUBLKS = 0 THEN
     1155    11758    6                                KS_FEPBOOT.BOOTFID = 'M:FEP.:SYS';
     1156    11759    6                             ELSE
     1157    11760    6                                CALL ALTER_FID (TMP$,KS_FEPBOOT.BOOTFID);
     1158    11761
     1159    11762    6                             WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     1160    11763    6                             WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     1161    11764    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);
     1162    11765        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:195  
     1163    11766    6                          CASE(%KS_LIBACCT);
     1164    11767
     1165    11768    6                             KS_FEPHNDLR.DEFLIBACCT = TMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.
             11768                                      TEXT;
     1166    11769
     1167    11770
     1168    11771        /**/
     1169    11772        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:196  
     1170    11773    6                          CASE(%KS_HANDNAME);
     1171    11774
     1172    11775                                  /* does handler exist  */
     1173    11776
     1174    11777    6                             HNDLREXISTS = '0'B;
     1175    11778    7           FEPHNDSRCH:       DO HNDLRX = 0 TO KS_FEPHNDLR.NHANDLERS-1;
     1176    11779    7                                IF KS_FEPHNDLR.HANDLER(HNDLRX) = BLK$->OUT$BLK.SUBLK$(
             11779                                         SCNOPTS)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT THEN
     1177    11780    8                                   DO;  /* 10 handler does exist */
     1178    11781    8                                   HNDLREXISTS = '1'B;
     1179    11782    8                                   KS$HNDLR.HNDLRNAME = KS_FEPHNDLR.HANDLER(HNDLRX);
     1180    11783    8                                   HANDLERNAME = KS$HNDLR.HNDLRNAME;
     1181    11784    8                                   EXIT FEPHNDSRCH;
     1182    11785    8                                   END;  /* 10 handler found  */
     1183    11786    7                             END;  /* fephndsrch loop */
     1184    11787        /**/
     1185    11788    6                             SUBLK$ = BLK$->OUT$BLK.SUBLK$(SCNOPTS);
     1186    11789    6                             IF ~HNDLREXISTS THEN
     1187    11790    7                                DO;
     1188    11791    7                                KS$HNDLR.HNDLRNAME = SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM
             11791                                         .TEXT;
     1189    11792    7                                HANDLERNAME = KS$HNDLR.HNDLRNAME;
     1190    11793    7                                KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS + 1;
     1191    11794    7                                HNDLRX = KS_FEPHNDLR.NHANDLERS - 1;
     1192    11795    7                                KS_FEPHNDLR.HANDLER(HNDLRX) = HANDLERNAME;
     1193    11796    7                                KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;
     1194    11797    7                                CALL RESET_PARAMS_TO_DEFAULTS;
     1195    11798    7                                KS_DEFAULT_KEY.NODE = KS_NODE;
     1196    11799    7                                KS_DEFAULT_KEY.HNDLR = HANDLERNAME;
     1197    11800    7                                CALL KSU$READ_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(
             11800                                         KS_DEFAULT_REC))
     1198    11801    8                                   WHENALTRETURN DO;
     1199    11802    8                                      CALL KSU$INIT_DEFCNFG(KS_DEFAULT_REC);
     1200    11803    8                                      CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),
             11803                                               VECTOR(KS_DEFAULT_REC));
     1201    11804    8                                   END;
     1202    11805    7                                END;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:197  
     1203    11806    6                             ELSE
     1204    11807    7                                DO;
     1205    11808    7                                KS_HANDLER_KEY.NODE = KS_NODE;
     1206    11809    7                                KS_HANDLER_KEY.HNDLR = HANDLERNAME;
     1207    11810    7                                READ_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     1208    11811    7                                READ_NETCON.BUF_ = VECTOR(HNDLR_BUF);
     1209    11812    7                                CALL M$READ(READ_NETCON) ALTRET(SET_ERR);
     1210    11813    7                                END;
     1211    11814        /**/
     1212    11815    6                             FID_FLAG = '0'B;
     1213    11816    6                             BOOT_FLAG = '0'B;
     1214    11817
     1215    11818    6                             IF TMP$->OUT$BLK.NSUBLKS > 1 THEN
     1216    11819    7                                DO;  /* fid,bootime or remove specified  12 */
     1217    11820    7                                IF ~HNDLREXISTS THEN
     1218    11821    8                                   DO;
     1219    11822    8                                   KS$HNDLR.HNDLRFID = KS$HNDLR.HNDLRNAME;
     1220    11823    8                                   CALL INDEX (INDX,' ',KS$HNDLR.HNDLRFID);
     1221    11824    8                                   SUBSTR(KS$HNDLR.HNDLRFID,INDX,5) = '.:SYS';
     1222    11825    8                                   KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;
     1223    11826    8                                   END;
     1224    11827    8                                DO SUBLOP = 1 TO SUBLK$->OUT$BLK.NSUBLKS-1;  /* 13 */
     1225    11828    9                                   DO CASE(SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.CODE
             11828                                            );
     1226    11829        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:198  
     1227    11830    9                                      CASE(%KS_HANDFID);
     1228    11831    9                                        CALL ALTER_FID (SUBLK$->OUT$BLK.SUBLK$(SUBLOP)
             11831                                                 ->OUT$BLK.SUBLK$(0),KS$HNDLR.HNDLRFID);
     1229    11832
     1230    11833        /**/
     1231    11834        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:199  
     1232    11835    9                                      CASE(%KS_HANDREM);
     1233    11836    9                                         IF HNDLRX ~= KS_FEPHNDLR.NHANDLERS-1 THEN
     1234    11837   10                                            DO; /* search to delete handler */
     1235    11838   11                                            DO K = HNDLRX TO KS_FEPHNDLR.NHANDLERS-1;
     1236    11839   11                                               KS_FEPHNDLR.HANDLER(K) = KS_FEPHNDLR.
             11839                                                        HANDLER(K+1);
     1237    11840   11                                               KS_FEPHNDLR.BOOTIME(K) = KS_FEPHNDLR.
             11840                                                        BOOTIME(K+1);
     1238    11841   11                                             END; /* if hndlrx ~= nhandlers */
     1239    11842   10                                             END;  /* not last handler */
     1240    11843
     1241    11844    9                                          KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1)
             11844                                                   = ' ';
     1242    11845    9                                          KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS
             11845                                                   -1;
     1243    11846
     1244    11847             /*
     1245    11848
     1246    11849             */
     1247    11850    9                                            KS_HANDLER_KEY.HNDLR = HANDLERNAME;
     1248    11851    9                                            KS_HANDLER_KEY.NODE = KS_NODE;
     1249    11852    9                                            DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY)
             11852                                                     ;
     1250    11853    9                                            CALL M$DELREC(DELREC_NETCON) WHENALTRETURN
     1251    11854   10                                               DO;
     1252    11855                                                    /*N* yeah, so do what  */
     1253    11856   10                                               END;
     1254    11857    9                    KS_DEFAULT_KEY.NODE = KS_NODE;
     1255    11858    9                    KS_DEFAULT_KEY.HNDLR = HANDLERNAME;
     1256    11859    9                    DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
     1257    11860    9                    CALL M$DELREC (DELREC_NETCON);
     1258    11861
     1259    11862   10                    IF ~HNDLREXISTS THEN DO;
     1260    11863   10                       KS_SUB_BUF_1.TEXT = HANDLERNAME;
     1261    11864   10                       KS_SUB_BUF_1.COUNT = SIZEC(HANDLERNAME);
     1262    11865   10                       KS_SUB_BUF_2.TEXT = KS_NODENAME;
     1263    11866   10                       KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:200  
     1264    11867   10                       CALL KSE$ERRMSG (%E$KS_HAND_NOT_DEF,VECTOR(KS_SUB_BUF_1),VECTOR(
             11867                                KS_SUB_BUF_2));
     1265    11868   10                    END;
     1266    11869
     1267    11870    9                                         EXIT SETCODE;  /* prevents rewritting the
     1268    11871                                                               ks$hndlr record to :netcon */
     1269    11872        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:201  
     1270    11873    9                                      CASE(%KS_HANDBT);
     1271    11874    9                                         IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11874                                                  SUBLK$(0)->OUT$BLK.CODE = %KS_YES THEN
     1272    11875    9                                            KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;
     1273    11876    9                                         ELSE
     1274    11877    9                                            KS_FEPHNDLR.BOOTIME(HNDLRX) = '0'B;
     1275    11878        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:202  
     1276    11879    9                                      CASE(%KS_HANDDEF);
     1277    11880    9                                         IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11880                                                  NSUBLKS = 0 THEN
     1278    11881    9                                            CALL RESET_PARAMS_TO_DEFAULTS;
     1279    11882    9                                         ELSE
     1280    11883    9                                            IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11883                                                     SUBLK$(0)->
     1281    11884    9                                               OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %
             11884                                                        KS_YES THEN
     1282    11885    9                                               CALL RESET_PARAMS_TO_DEFAULTS;
     1283    11886    9                                      END;  /* do case sublk$->out$blk...code */
     1284    11887        /**/
     1285    11888
     1286    11889
     1287    11890
     1288    11891        /*
     1289    11892
     1290    11893                   COMMENT
     1291    11894        */
     1292    11895
     1293    11896
     1294    11897    8                                   END; /* 13 sublop = 1 to nsublks */
     1295    11898    7                                   END;  /* 12 if nsublks >1 */
     1296    11899    6                                ELSE
     1297    11900    7                                   DO;  /* 15 # sublks = 1 */
     1298    11901    7                                   KS$HNDLR.HNDLRFID = HANDLERNAME;
     1299    11902    7                                   CALL INDEX (INDX,' ',KS$HNDLR.HNDLRFID);
     1300    11903    7                                   SUBSTR(KS$HNDLR.HNDLRFID,INDX,5) = '.:SYS';
     1301    11904    7                                   KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;
     1302    11905    7                                   END;
     1303    11906        /**/
     1304    11907    7                                IF KS$HNDLR.NPARAMI > 0 THEN DO;
     1305    11908    7                                    PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.
             11908                                             OFFSET(KS$HNDLR.NPARAMI-1));
     1306    11909    7                                   PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(
             11909                                            KS$HNDLR.NPARAMI - 1) + 2)/2);
     1307    11910    7                                   END;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:203  
     1308    11911    7                                ELSE DO;
     1309    11912    7                                   PTR$ = ADDR(HNDLR_BUF);
     1310    11913    7                                   PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);
     1311    11914    7                                   END;
     1312    11915    6                                WRITE_NETCON.BUF_ = VECTOR(HNDLR_BUF);
     1313    11916    6                                WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     1314    11917    6                                KS_HANDLER_KEY.NODE = KS_NODE;
     1315    11918    6                                KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(HNDLRX);
     1316    11919    6                                WRITE_NETCON.BUF_.BOUND = POFFC(PTR$,ADDR(HNDLR_BUF)) -
             11919                                         1;
     1317    11920    6                                CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);
     1318    11921        /**/
     1319    11922
     1320    11923    6                       END;  /* do case (tmp$->out$blk.code) */
     1321    11924    5                    END;    /* do SCNOPTS = 0 to nsublks at set boot level 2*/
     1322    11925    4                    I = 0;
     1323    11926    4                    L = KS_FEPHNDLR.NHANDLERS;
     1324    11927    5                    DO WHILE (I <= L-2);
     1325    11928    5                       IF KS_FEPHNDLR.HANDLER(I) = ' ' THEN
     1326    11929    6                          DO;
     1327    11930        /*
     1328    11931                if a blank exists in the handler list delete it, move the handlers
     1329    11932                up and decrement nhandlers.
     1330    11933        */
     1331    11934    7                          DO J = I TO KS_FEPHNDLR.NHANDLERS-2;
     1332    11935    7                             KS_FEPHNDLR.HANDLER(J) = KS_FEPHNDLR.HANDLER(J+1);
     1333    11936    7                             KS_FEPHNDLR.BOOTIME(J) = KS_FEPHNDLR.BOOTIME(J+1);
     1334    11937    7                          END;
     1335    11938    6                          KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1) = ' ';
     1336    11939    6                          KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS - 1;
     1337    11940    6                          END;
     1338    11941    5                    I = I + 1;
     1339    11942    5                    END;  /* do while  */
     1340    11943    4                    IF KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1) = ' ' THEN
     1341    11944    4                       KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS-1;
     1342    11945
     1343    11946    4                    IF KS_FEPHNDLR.HANDLER(0) ~= 'NODEADMN' THEN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:204  
     1344    11947    4                       CALL KSE$ERRMSG (%E$KS_NODEADMN_NOT_FIRST);
     1345    11948
     1346    11949
     1347    11950
     1348    11951
     1349    11952        /**/
     1350    11953    4                    KS_FEPHNDLR_KEY.NODE = KS_NODE;
     1351    11954    4                    WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
     1352    11955    4                    WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     1353    11956    4                    WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) +
     1354    11957    4                                              SIZEC(KS_FEPHNDLR.DEFLIBACCT) +
     1355    11958    4                                               4 + /* bootime bits */
     1356    11959    4                                              (SIZEC(KS_FEPHNDLR.HANDLER(0)) *
     1357    11960    4                                              KS_FEPHNDLR.NHANDLERS) - 1;
     1358    11961    4                    CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);
     1359    11962    4                    END;   /* sublks on set boot command 1 */
     1360    11963    3                  ELSE
     1361    11964        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:205  
     1362    11965
     1363    11966            /* no options on the SET BOOT command - the old style (prompted)*/
     1364    11967
     1365    11968    3   PROMPTED_SET_BOOT:
     1366    11969    4        DO;
     1367    11970    4           KS_FEPBOOT_KEY.NODE = KS_NODE;
     1368    11971    4           KS_FEPHNDLR_KEY.NODE = KS_NODE;
     1369    11972    4           KS_HANDLER_KEY.NODE = KS_NODE;
     1370    11973    4           KS_SUB_BUF_1.COUNT = SIZEC('BOOTINFO');
     1371    11974    4           KS_SUB_BUF_1.TEXT = 'BOOTINFO';
     1372    11975
     1373    11976             /* change monitor fid in KS_FEPBOOT record */
     1374    11977
     1375    11978    4   MONFID: CALL KSU$READ_NETCON (VECTOR(KS_FEPBOOT_KEY),
     1376    11979    4                                 VECTOR(KS_FEPBOOT)) ALTRET (SET_ERR);
     1377    11980
     1378    11981             /* strip blanks from end of monitor fid,print it, */
     1379    11982             /*if a new fid is entered, change it and write out new FEPBOOT*/
     1380    11983
     1381    11984    4           CALL INDEX (J,' ',KS_FEPBOOT.BOOTFID) WHENALTRETURN
     1382    11985    5              DO;
     1383    11986    5                 J = SIZEC(KS_FEPBOOT.BOOTFID);
     1384    11987    5              END;
     1385    11988    4           TEXTC.COUNT = J;
     1386    11989    4           TEXTC.TEXT = SUBSTR(KS_FEPBOOT.BOOTFID,0,J);
     1387    11990    4           CALL KSW$WRITE(VECTOR(MONFID),VECTOR(TEXTC));
     1388    11991    4           CALL XUR$GETCMD(KS_FID,TOP2$,VECTOR(EQUALS));
     1389    11992    4           IF TOP2$->OUT$BLK2.NSUBLKS ~= 0 THEN
     1390    11993    5              DO;
     1391    11994    5                 CALL ALTER_FID (TOP2$,KS_FEPBOOT.BOOTFID);
     1392    11995    5                 CALL KSU$WRITE_NETCON (VECTOR(KS_FEPBOOT_KEY),
     1393    11996    5                    VECTOR(KS_FEPBOOT)) ALTRET (SET_ERR);
     1394    11997    5              END;
     1395    11998                /* Change Handler information */
     1396    11999
     1397    12000         /* Get the number of handlers - read FEPHANDLER record and save the number and the
             12000        names */
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:206  
     1398    12001
     1399    12002    4   NHNDLRS:
     1400    12003    4           CALL KSU$READ_NETCON (VECTOR(KS_FEPHNDLR_KEY),
     1401    12004    4                                 VECTOR(KS_FEPHNDLR)) ALTRET (SET_ERR);
     1402    12005    4           OLD_NRHAND = KS_FEPHNDLR.NHANDLERS;
     1403    12006    4           OLD_HANDLER = KS_FEPHNDLR.HANDLER;
     1404    12007    4           OLD_BOOTIME = KS_FEPHNDLR.BOOTIME;
     1405    12008
     1406    12009             /* Prompt for a new number of handlers - if changed put in record*/
     1407    12010
     1408    12011    4           CALL KSW$WRITE(VECTOR(NHNDLRS),VECTOR(KS_FEPHNDLR.NHANDLERS));
     1409    12012    4           CALL XUR$GETCMD(KS_NRHAND,TOP2$,VECTOR(EQUALS));
     1410    12013    4           IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN
     1411    12014    4              CALL CHARBIN (KS_FEPHNDLR.NHANDLERS,TOP2$->OUT$SYM.TEXT);
     1412    12015
     1413    12016         /* Prompt for changes to the names and fids for the number of handlers just entered
             12016         */
     1414    12017
     1415    12018    4   CHANGE_HANDLERS:
     1416    12019    5           DO J = 0 TO KS_FEPHNDLR.NHANDLERS - 1;
     1417    12020    5              HANDNR = J + 1;
     1418    12021    5              RECORD_CHANGED = '0'B;
     1419    12022    5              CALL INDEX (K,' ',KS_FEPHNDLR.HANDLER(J));
     1420    12023    5              TEXTC.COUNT = K;
     1421    12024    5              TEXTC.TEXT = SUBSTR(KS_FEPHNDLR.HANDLER(J),0,K);
     1422    12025    5              CALL KSW$WRITE (VECTOR(HNDLRNAME),VECTOR(HANDNR),VECTOR(TEXTC));
     1423    12026    5              CALL XUR$GETCMD(KS_HAND,TOP2$,VECTOR(EQUALS));
     1424    12027    5              IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN
     1425    12028    5                 KS_FEPHNDLR.HANDLER(J) = TOP2$->OUT$SYM.TEXT;
     1426    12029    5              KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);
     1427    12030             /* Search for handler on old handler list,If found - read record*/
     1428    12031             /* If not found - create a handler record */
     1429    12032
     1430    12033    5              HANDLER_FOUND = '0'B;
     1431    12034    5   FIND_HANDLER:
     1432    12035    6              DO K = 0 TO OLD_NRHAND - 1;
     1433    12036    6                 IF KS_FEPHNDLR.HANDLER(J) = OLD_HANDLER(K) THEN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:207  
     1434    12037    7                    DO;
     1435    12038    7                       HANDLER_FOUND = '1'B;
     1436    12039    7                       EXIT FIND_HANDLER;
     1437    12040    7                    END;
     1438    12041    6              END;
     1439    12042
     1440    12043    5              IF HANDLER_FOUND THEN
     1441    12044    6                 DO;
     1442    12045    6                    CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(HNDLR_BUF));
     1443    12046    6                    KS_FEPHNDLR.BOOTIME(J) = OLD_BOOTIME(K);
     1444    12047    6                 END;
     1445    12048    5              ELSE
     1446    12049    6                 DO;
     1447    12050    6                    RECORD_CHANGED = '1'B;
     1448    12051    6                    KS_FEPHNDLR.BOOTIME(J) = '1'B;
     1449    12052    6                    KS$HNDLR.HNDLRFID = ' ';
     1450    12053    6                    KS$HNDLR.HNDLRNAME = KS_FEPHNDLR.HANDLER(J);
     1451    12054    6                    IF KS$HNDLR.HNDLRNAME ~= ' ' THEN
     1452    12055    7                       DO;
     1453    12056    7                          KS$HNDLR.HNDLRFID = KS$HNDLR.HNDLRNAME;
     1454    12057    7                          CALL INDEX (K,' ',KS$HNDLR.HNDLRFID);
     1455    12058    7                          SUBSTR(KS$HNDLR.HNDLRFID,K) = '.:SYS';
     1456    12059    7                       END;
     1457    12060    6                    CALL RESET_PARAMS_TO_DEFAULTS;
     1458    12061    6                 END;
     1459    12062
     1460    12063             /* Change fid of handler if requested */
     1461    12064
     1462    12065    5   CHANGE_FID:
     1463    12066    5              CALL INDEX (K,' ',KS$HNDLR.HNDLRFID);
     1464    12067    5              TEXTC.COUNT = K;
     1465    12068    5              TEXTC.TEXT = SUBSTR(KS$HNDLR.HNDLRFID,0,K);
     1466    12069    5              CALL KSW$WRITE (VECTOR(HNDLRFID),VECTOR(HANDNR),VECTOR(TEXTC));
     1467    12070    5              CALL XUR$GETCMD(KS_FID,TOP2$,VECTOR(EQUALS));
     1468    12071    5              IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN
     1469    12072    6                 DO;
     1470    12073    6                    CALL ALTER_FID (TOP2$, KS$HNDLR.HNDLRFID);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:208  
     1471    12074    6                    RECORD_CHANGED = '1'B;
     1472    12075    6                 END;
     1473    12076
     1474    12077    5              IF RECORD_CHANGED THEN
     1475    12078    6                 DO;   /* Figure out size of record */
     1476    12079    7                          IF KS$HNDLR.NPARAMI > 0 THEN DO;
     1477    12080    7                             PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.OFFSET(
             12080                                      KS$HNDLR.NPARAMI-1));
     1478    12081    7                             PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(KS$HNDLR.
             12081                                      NPARAMI - 1) + 2)/2);
     1479    12082    7                             END;
     1480    12083    7                        ELSE DO;
     1481    12084    7                          PTR$ = ADDR(HNDLR_BUF);
     1482    12085    7                          PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);
     1483    12086    7                        END;
     1484    12087    6                    CALL KSU$WRITE_NETCON (VECTOR(KS_HANDLER_KEY),
     1485    12088    6                                           VECTOR(HNDLR_BUF),
     1486    12089    6                                           POFFC(PTR$,ADDR(HNDLR_BUF))-1);
     1487    12090    6                 END;
     1488    12091    5           END;   /* Change handlers */
     1489    12092
     1490    12093
     1491    12094             /* Delete any handler records that were not reset */
     1492    12095    4   DELETE_UNUSED_HAND_REC:
     1493    12096    5           DO J = 0 TO OLD_NRHAND - 1;
     1494    12097    5              HANDLER_FOUND = '0'B;
     1495    12098    5   FIND_HANDLER2:
     1496    12099    6              DO K = 0 TO KS_FEPHNDLR.NHANDLERS - 1;
     1497    12100    6                 IF OLD_HANDLER(J) = KS_FEPHNDLR.HANDLER(K) THEN
     1498    12101    7                    DO;
     1499    12102    7                       HANDLER_FOUND = '1'B;
     1500    12103    7                       EXIT FIND_HANDLER2;
     1501    12104    7                    END;
     1502    12105    6              END;
     1503    12106
     1504    12107    5              IF NOT HANDLER_FOUND THEN
     1505    12108    6                 DO;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:209  
     1506    12109    6                    KS_HANDLER_KEY.HNDLR = OLD_HANDLER(J);
     1507    12110    6                    DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     1508    12111    6                    CALL M$DELREC (DELREC_NETCON);
     1509    12112    6                    KS_DEFAULT_KEY.NODE = KS_NODE;
     1510    12113    6                    KS_DEFAULT_KEY.HNDLR = OLD_HANDLER(J);
     1511    12114    6                    DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
     1512    12115    6                    CALL M$DELREC (DELREC_NETCON);
     1513    12116    6                 END;
     1514    12117    5              IF J > KS_FEPHNDLR.NHANDLERS - 1 THEN
     1515    12118    5                 KS_FEPHNDLR.HANDLER(J) = ' ';
     1516    12119    5           END;
     1517    12120
     1518    12121             /* Remove blank handler names from KS_FEPHNDLR */
     1519    12122
     1520    12123    4           K = 0;
     1521    12124    4           J = KS_FEPHNDLR.NHANDLERS;
     1522    12125    5           DO I = 0 TO J - 1;
     1523    12126    5              IF KS_FEPHNDLR.HANDLER(I) ~= ' ' THEN
     1524    12127    6                 DO;
     1525    12128    6                    IF K ~= I THEN
     1526    12129    7                       DO;
     1527    12130    7                          KS_FEPHNDLR.HANDLER(K) = KS_FEPHNDLR.HANDLER(I);
     1528    12131    7                          KS_FEPHNDLR.BOOTIME(K) = KS_FEPHNDLR.BOOTIME(I);
     1529    12132    7                       END;
     1530    12133    6                    K = K + 1;
     1531    12134    6                 END;
     1532    12135    5           END;
     1533    12136    4           KS_FEPHNDLR.NHANDLERS = K;
     1534    12137
     1535    12138    4           IF KS_FEPHNDLR.HANDLER(0) ~= 'NODEADMN' THEN
     1536    12139    4              CALL KSE$ERRMSG (%E$KS_NODEADMN_NOT_FIRST);
     1537    12140                   /*E* ERROR:   KSN-E$KS_NODEADMN_NOT_FIRST-0
     1538    12141                        MESSAGE: Warning -- NODEADMN is not user# 1 */
     1539    12142
     1540    12143
     1541    12144    4   BUILD_DEFAULTS:
     1542    12145    5           DO I = 0 TO KS_FEPHNDLR.NHANDLERS - 1;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:210  
     1543    12146    5              KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(I);
     1544    12147    5              KS_DEFAULT_KEY.NODE = KS_NODE;
     1545    12148    5              CALL KSU$READ_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT_REC))
     1546    12149    6                 WHENALTRETURN DO;
     1547    12150    6                    CALL KSU$INIT_DEFCNFG (KS_DEFAULT_REC);
     1548    12151    6                    CALL KSU$WRITE_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT_REC
             12151                             ));
     1549    12152    6                 END;
     1550    12153    5           END BUILD_DEFAULTS;
     1551    12154
     1552    12155             /* Get new library fid */
     1553    12156    4              CALL INDEX (K,' ',KS_FEPHNDLR.DEFLIBACCT);
     1554    12157    4              TEXTC.COUNT = K;
     1555    12158    4              TEXTC.TEXT = SUBSTR(KS_FEPHNDLR.DEFLIBACCT,0,K);
     1556    12159    4              CALL KSW$WRITE(VECTOR(LIBACCT),VECTOR(TEXTC));
     1557    12160    4                 CALL XUR$GETCMD(KS_LIB,TOP2$,VECTOR(EQUALS));
     1558    12161    4                 IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN
     1559    12162    4                    KS_FEPHNDLR.DEFLIBACCT = TOP2$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1560    12163
     1561    12164    4                 RECORD_SIZE = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(KS_FEPHNDLR.
             12164                          DEFLIBACCT)
     1562    12165    4                    + 4 + (SIZEC(KS_FEPHNDLR.HANDLER(0)) * KS_FEPHNDLR.NHANDLERS) - 1;
     1563    12166    4                 CALL KSU$WRITE_NETCON (VECTOR(KS_FEPHNDLR_KEY),
     1564    12167    4                                        VECTOR(KS_FEPHNDLR),
     1565    12168    4                                        RECORD_SIZE) ALTRET(SET_ERR);
     1566    12169    4                 PROMPT.NODENAME = KS_NODENAME;
     1567    12170    4                  P_PCB.OUT$ = ADDR(KS_CMD);
     1568    12171    4                  EXIT DOI;
     1569    12172    4              END;    /* no options on the set boot command */
     1570    12173        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:211  
     1571    12174    3              CASE(%KS_PARAM);
     1572    12175    3                 PARMTYPE = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1573    12176    3                 PARMX = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1574    12177    3                 KS_SUB_BUF_1.COUNT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX) ->
             12177                          NAME.L#;
     1575    12178    3                 KS_SUB_BUF_1.TEXT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX) -> NAME
             12178                          .NAME#;
     1576    12179
     1577    12180                      /*N* For D00 politely tell the user there is no NSHUF.
     1578    12181                           Delete this here and in KSC$DISPLAY for E00.  Also
     1579    12182                           take NSHUF out of the nodes and change NSHUF to
     1580    12183                           SPARE in the tables. */
     1581    12184    3                 IF PARMTYPE = %KS_BOOT_PARAM AND PARMX = %GI_BOOT_NSHUF THEN
     1582    12185    4                    DO;
     1583    12186    4                       CALL KSE$ERRMSG (%E$KS_NO_MORE_NSHUF);
     1584    12187                            /*E* ERROR: KSN-E$KS_NO_MORE_NSHUF-0
     1585    12188                                 MESSAGE: NSHUF is no longer a parameter. */
     1586    12189    4                       GOTO END_LOOP;
     1587    12190    4                    END;
     1588    12191    3                 IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) THEN
     1589    12192    4                    DO;
     1590    12193    4                       CALL KSE$ERRMSG(%E$KS_DISPONLY,VECTOR(KS_SUB_BUF_1));
     1591    12194                            /*E* ERROR: KSN-E$KS_DISPONLY-0
     1592    12195                                 MESSAGE: %U1 is for display only.
     1593    12196                                 DESCRIPTION: SEE MESSAGE  */
     1594    12197    4                       GOTO END_LOOP;
     1595    12198    4                    END;
     1596    12199
     1597    12200    3                 NUM_INDX = 1;
     1598    12201    3                 INDX_VEC(0) = 0;
     1599    12202
     1600    12203
     1601    12204    3                 IF PARMTYPE = %KS_HNDLR_PARAM THEN
     1602    12205    4                    DO;
     1603    12206    4                       IF KS_HNDLRNAME = ' ' THEN
     1604    12207    5                          DO;
     1605    12208    5                             CALL KSE$ERRMSG (%E$KS_NOHANDLER_SET);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:212  
     1606    12209                                  /*E* ERROR: KSN-E$KS_NOHANDLER_SET-0
     1607    12210                  MESSAGE: A handler must be selected in order to set a handler parameter.*/
     1608    12211    5                             GOTO SET_ERR;
     1609    12212    5                          END;
     1610    12213    4                       ELSE
     1611    12214    4                          PARMTYPE = PARMTYPE + KS_HNDLRINDX;
     1612    12215    4                 KS_SUB_BUF_1.COUNT = KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.TEXTNAME(PARMX)
             12215                          -> NAME.L#;
     1613    12216    4                 KS_SUB_BUF_1.TEXT = KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.TEXTNAME(PARMX)
             12216                          -> NAME.NAME#;
     1614    12217    4                 KS_SUB_BUF_2.COUNT = SIZEC(KS_HNDLRNAME);
     1615    12218    4                 KS_SUB_BUF_2.TEXT = KS_HNDLRNAME;
     1616    12219    4                 KS_SUB_BUF_3.COUNT = SIZEC(KS_NODENAME);
     1617    12220    4                 KS_SUB_BUF_3.TEXT = KS_NODENAME;
     1618    12221    4                 IF NOT(ADDR(KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.HND(PARMX)) -> HND.DAT(
             12221                          KS_HNDLRINDX)) THEN
     1619    12222    5                    DO;
     1620    12223    5                    CALL KSE$ERRMSG(%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),VECTOR(
             12223                             KS_SUB_BUF_2));
     1621    12224                         /*E* ERROR: KSN-E$KS_ILGSET
     1622    12225                         MESSAGE: %U1 is not legal for handler %U2
     1623    12226                              DESCRIPTION: SEE MESSAGE */
     1624    12227    5                    NUM_INDX = 0; /* keeps code from looping thru speed index */
     1625    12228    5                    GOTO SET_ERR;
     1626    12229    5                    END;  /* parameter not legal for this parameter */
     1627    12230    5                 IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN DO;
     1628    12231    5                    PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0
             12231                             );
     1629    12232    5                    IF PARMX = %KL_HNDLRPARM_USRPARM1 OR
     1630    12233    5                       PARMX = %KL_HNDLRPARM_USRPARM2 THEN
     1631    12234    6                          DO;
     1632    12235    6                          NUM_INDX = 1;
     1633    12236    6                          INDX_VEC(0) = PTR$->OUT$BLK.CODE;
     1634    12237    6                          END;
     1635    12238    5                    ELSE
     1636    12239    6                       DO;
     1637    12240    7                    DO CASE(PTR$->OUT$BLK.CODE);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:213  
     1638    12241    7                       CASE(%KS_SPEED_LIST);
     1639    12242    7                          NUM_INDX = PTR$->OUT$BLK.NSUBLKS;
     1640    12243    8                          DO J = 0 TO PTR$-> OUT$BLK.NSUBLKS - 1;
     1641    12244    8                             INDX_VEC(J) = PTR$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE;
     1642    12245    8                             END;  /* DO J */
     1643    12246    7                       CASE(%KS_SPEED_RANGE);
     1644    12247    7                          TEMP1 = PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1645    12248    7                          TEMP2 = PTR$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE;
     1646    12249    7                          NUM_INDX = 0;
     1647    12250    8                          DO J = TEMP1 TO TEMP2;
     1648    12251    8                             INDX_VEC(NUM_INDX) = J;
     1649    12252    8                             NUM_INDX = NUM_INDX + 1;
     1650    12253    8                             END;  /* DO J */
     1651    12254    7                       CASE(%KS_SPEED_ALL);
     1652    12255    7                          NUM_INDX = %KS_SPEED_19200 + 1;
     1653    12256    8                          DO J = %KS_SPEED_50 TO %KS_SPEED_19200;
     1654    12257    8                             INDX_VEC(J) = J;
     1655    12258    8                             END;  /* DO J */
     1656    12259    7                       END;  /* DO CASE */
     1657    12260    6                    END;  /* else parmx = usrparm1 or usrparm2 */
     1658    12261    5                    END;  /* IF FLAGS.INDX */
     1659    12262    4                    END;
     1660    12263    4                 DO K = 0 TO NUM_INDX - 1;
     1661    12264    4                    INDX = INDX_VEC(K);
     1662    12265    4                    RCVCQ_SNDCQ = '0'B;
     1663    12266    4                    PTR$ = BLK$->OUT$BLK.SUBLK$(1);
     1664    12267    5                    DO CASE(PTR$->OUT$BLK.CODE);
     1665    12268    5                       CASE(%KS_DECVAL);
     1666    12269    5                          CALL CHARBIN(VALUE,PTR$->OUT$SYM.TEXT);
     1667    12270    5                          IF PARMTYPE >= %KS_HNDLR_PARAM AND
     1668    12271    5                             (PARMX = %KL_HNDLRPARM_RCVCQBYTSIZ OR
     1669    12272    5                              PARMX = %KL_HNDLRPARM_SNDCQBYTSIZ) THEN
     1670    12273    6                             DO;
     1671    12274    6                                VALUE = VALUE / 2;
     1672    12275    6                                RCVCQ_SNDCQ = '1'B;
     1673    12276    6                             END;
     1674    12277    5                       CASE(%KS_HEXVAL);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:214  
     1675    12278    5                          VALUE = 0;
     1676    12279    6                          DO J = 0 TO PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
     1677    12280    6                             HEX_CHAR = SUBSTR(PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,J,
             12280                                      1);
     1678    12281    6                             CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
     1679    12282    6                             VALUE = VALUE * 16 + HEX_DIGIT;
     1680    12283    6                             END;  /* DO J */
     1681    12284    5                       CASE(%KS_RESVAL);
     1682    12285    5                          VALUE = 0;
     1683    12286    5                          VALUEC.RES = PTR$->OUT$SYM.TEXT;
     1684    12287    5                       END;  /* DO CASE */
     1685    12288    5                    DO CASE(PARMTYPE);
     1686    12289    5                       CASE(%KS_BOOT_PARAM);
     1687    12290    5                       KS_FEPBOOT_KEY.NODE = KS_NODE;
     1688    12291    5                          READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     1689    12292    5                          READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     1690    12293    5                          CALL M$READ(READ_NETCON) ALTRET(UPD_NETCON_ERR);
     1691    12294    5                          KS_FEPBOOT.BOOTPARAMS(PARMX+INDX) = VALUE;
     1692    12295    5                          WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     1693    12296    5                          WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     1694    12297    5                          CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);
     1695    12298    5                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12298                                   VECTOR(NETCON));
     1696    12299    5                          GOTO END_LOOP;
     1697    12300    5                       CASE(%KS_LCP6_PARAM);
     1698    12301    5                          KS_CONTROL.HANDLER = 'BABOON';
     1699    12302    5                       CASE(ELSE);
     1700    12303    5                          KS_CONTROL.HANDLER = KS_HNDLRNAME;
     1701    12304    5                       END;  /* DO CASE */
     1702    12305    4                       IF NOT (KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.SPECIAL(PARMX)) THEN
     1703    12306    5                          DO;
     1704    12307    5                          IF VALUE > KS_TBL(PARMTYPE) -> KS$PARAM.MAX(PARMX) OR
     1705    12308    6                             VALUE < KS_TBL(PARMTYPE) -> KS$PARAM.MIN(PARMX) THEN DO;
     1706    12309    6                                IF RCVCQ_SNDCQ THEN
     1707    12310    7                                   DO;
     1708    12311    7                                      CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12311                                               MAX(PARMX)*2,KS_SUB_BUF_2.TEXT,KS_SUB_BUF_2.
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:215  
             12311                                               COUNT);
     1709    12312    7                                      CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12312                                               MIN(PARMX)*2,KS_SUB_BUF_3.TEXT,KS_SUB_BUF_3.
             12312                                               COUNT);
     1710    12313    7                                   END;
     1711    12314    6                                ELSE
     1712    12315    7                                   DO;
     1713    12316    7                                      CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12316                                               MAX(PARMX),KS_SUB_BUF_2.TEXT,KS_SUB_BUF_2.
             12316                                               COUNT);
     1714    12317    7                                      CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12317                                               MIN(PARMX),KS_SUB_BUF_3.TEXT,KS_SUB_BUF_3.
             12317                                               COUNT);
     1715    12318    7                                   END;
     1716    12319    6                                KS_SUB_BUF_4.COUNT = SIZEC(KS_HNDLRNAME);
     1717    12320    6                                KS_SUB_BUF_4.TEXT  = KS_HNDLRNAME;
     1718    12321    6                                CALL KSE$ERRMSG(%E$KS_BADPRMVAL,VECTOR(KS_SUB_BUF_4),
             12321                                         VECTOR(KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));
     1719    12322                                     /*E* ERROR: KSN-E$KS_BADPRMVAL-0
     1720    12323                                          MESSAGE: Specified value is outside of bounds
     1721    12324                                          %U3 to %U2, set for this parameter on handler %U1.
     1722    12325                               DESCRIPTION: VALUE LARGER/SMALLER THEN SPECIFIED MAX/MIN.  */
     1723    12326    6                                GOTO SET_ERR;
     1724    12327    6                             END;
     1725    12328    5                          END;
     1726    12329    4                    IF (BLK$->OUT$BLK.NSUBLKS = 3) THEN
     1727    12330    4                       PERM_PARM = BLK$->OUT$BLK.SUBLK$(2)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             12330                                CODE;
     1728    12331    4                    ELSE
     1729    12332    4                       PERM_PARM = KS_SELPRMOPT;
     1730    12333
     1731    12334    4                    IF PERM_PARM = %KS_TEMP OR PERM_PARM = %KS_PERM THEN
     1732    12335    5                       DO;
     1733    12336    5                    KS_CONTROL.CMD = %KL_CONTROL_SET;
     1734    12337    5                    KS_CONTROL.PARMX = PARMX;
     1735    12338    5                    KS_CONTROL.INDX = INDX;
     1736    12339    5   IF PTR$->OUT$BLK.CODE = %KS_DECVAL OR PTR$->OUT$BLK.CODE = %KS_HEXVAL THEN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:216  
     1737    12340    5                       CALL KSU$UNPACK (VALUE,KS_CONTROL.VALUE);
     1738    12341    5                    ELSE
     1739    12342    5                       KS_CONTROL.VALUE = VALUE;
     1740    12343    5                    CALL KSR$WR_HLPCG(VECTOR(KS_CONTROL)) ALTRET(UPDATE_FILE);
     1741    12344    5                    CALL KSR$RD_HLPCG ('0'B)
     1742    12345    6                       WHENRETURN DO;
     1743    12346    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12346                                   VECTOR(FEP));
     1744    12347                                    /*E* ERROR: KSN-E$KS_PARMSET-0
     1745    12348                                         MESSAGE: %U1 set successfully.*/
     1746    12349    6                       END;
     1747    12350    6                       WHENALTRETURN DO;
     1748    12351    7                          DO SELECT (KS$HDR.RESULTS.ERR#);
     1749    12352    7                             SELECT (%E$NODENA);
     1750    12353    7                                CALL XUR$ERRMSG(KS_HDR.RESULTS);
     1751    12354    7                             SELECT (%E$NOHANDLER);
     1752    12355    7                                IF PARMTYPE = %KS_NODEADMN_PARAM THEN
     1753    12356    7                                   CALL KSE$ERRMSG(%E$KS_INIT_ONLY,
     1754    12357    7                                      VECTOR(KS_SUB_BUF_1));
     1755    12358                                        /*E* ERROR: KSN-E$KS_INIT_ONLY-0
     1756    12359                                            MESSAGE: %U1 is only settable at initialization.
     1757    12360           MESSAGE1: This parameter is not allowed to be set while the handler is running.*/
     1758    12361    7                                ELSE
     1759    12362    7                                   CALL XUR$ERRMSG(KS_HDR.RESULTS);
     1760    12363    7                             SELECT (%E$PARM_INITONLY);
     1761    12364    7                                CALL KSE$ERRMSG (%E$KS_INIT_ONLY,VECTOR(KS_SUB_BUF_1));
     1762    12365    7                             SELECT (%E$PARM_UNDEF);
     1763    12366    7                                CALL KSE$ERRMSG (%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),
             12366                                         VECTOR(KS_SUB_BUF_2));
     1764    12367    7                                GOTO SET_ERR;
     1765    12368    7                          END;
     1766    12369    6                       END;
     1767    12370    5                       END;  /* not disponly and ( perm or term ) */
     1768    12371    4   UPDATE_FILE:     IF PERM_PARM = %KS_FILE OR PERM_PARM = %KS_PERM THEN
     1769    12372    5                      DO; /* update :NETCON FILE */
     1770    12373    6                       DO CASE(PARMTYPE);
     1771    12374    6                          CASE(%KS_LCP6_PARAM);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:217  
     1772    12375    6                          KS_FEPCTL_KEY.NODE = KS_NODE;
     1773    12376    6                             READ_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);
     1774    12377    6                             READ_NETCON.BUF_ = VECTOR(KS_FEPCTL);
     1775    12378    6                             CALL M$READ(READ_NETCON) ALTRET(UPD_NETCON_ERR);
     1776    12379    6                             KS_FEPCTL.PARAMS(PARMX) = VALUE;
     1777    12380    6                             WRITE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);
     1778    12381    6                             WRITE_NETCON.BUF_ = VECTOR(KS_FEPCTL);
     1779    12382    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);
     1780    12383    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12383                                   VECTOR(NETCON));
     1781    12384    6                          CASE(ELSE);
     1782    12385    6                          KS_HANDLER_KEY.NODE = KS_NODE;
     1783    12386    6                             KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;
     1784    12387    6                             CALL KSU$READ_NETCON(VECTOR(KS_HANDLER_KEY),VECTOR(
             12387                                      HNDLR_BUF))
     1785    12388    7                                WHENALTRETURN DO;
     1786    12389    7                                   CALL KSE$ERRMSG(%E$KS_HAND_NOT_DEF,VECTOR(
             12389                                            KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));
     1787    12390    7                                   GOTO SET_ERR;
     1788    12391    7                                END;
     1789    12392    6                             IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN
     1790    12393    7                                DO;
     1791    12394    7                                INDX_R = PARMX - %KL_HNDLRPARM_BLOCK;
     1792    12395    7                                IF KS$HNDLR.NPARAMI <= INDX_R THEN
     1793    12396    8                                   DO;
     1794    12397    8                                   IF KS$HNDLR.IPARAM.ARRAY_SZ(INDX_R) > INDX THEN
     1795    12398    9                                      DO;
     1796    12399    9                                      KS$HNDLR.IPARAM.ARRAY_SZ(INDX_R) = INDX;
     1797    12400    9                                      END;
     1798    12401    8                                   END;
     1799    12402
     1800    12403    7                                PTR$ = ADDR(HNDLR_BUF);
     1801    12404    7                                PTR$ = PINCRW(PTR$,KS$HNDLR.IPARAM.OFFSET(INDX_R));
     1802    12405    7                                PTR$->VALUE_B(INDX) = VALUE;
     1803    12406    7                                END;
     1804    12407    7                             ELSE DO;
     1805    12408    7                                PTR$ = ADDR(HNDLR_BUF);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:218  
     1806    12409    7                                KS$HNDLR.PARAMS(PARMX) = VALUE;
     1807    12410    7                                END;
     1808    12411
     1809    12412        /*
     1810    12413                Now figure out the size of the structure and (if possible)
     1811    12414                write it back out to the :NETCON file
     1812    12415        */
     1813    12416
     1814    12417        /*
     1815    12418                   sz = number of elements in array * size of each element
     1816    12419                        + 4 bytes for the offset.
     1817    12420        */
     1818    12421
     1819    12422    6                             WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     1820    12423    6                             WRITE_NETCON.BUF_ = VECTOR(HNDLR_BUF);
     1821    12424    6                             IF KS$HNDLR.NPARAMI > 0 THEN
     1822    12425    7                                DO;
     1823    12426    7                                PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.OFFSET(
             12426                                         KS$HNDLR.NPARAMI - 1));
     1824    12427    7                                PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(KS$HNDLR.
             12427                                         NPARAMI - 1) + 2)/2);
     1825    12428    7                                END;
     1826    12429    7                             ELSE DO;
     1827    12430    7                                PTR$ = ADDR(HNDLR_BUF);
     1828    12431    7                                PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);
     1829    12432    7                             END;
     1830    12433    6                             WRITE_NETCON.BUF_.BOUND = POFFC(PTR$,ADDR(HNDLR_BUF)) - 1;
     1831    12434    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);
     1832    12435    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12435                                   VECTOR(NETCON));
     1833    12436                                  /*E* ERROR: KSN-E$KS_WRITEOK-0
     1834    12437                                       MESSAGE: %U1 successfully written to :NETCON
     1835    12438                                       DESCRIPTION: SEE MESSAGE */
     1836    12439    6                          END;  /* DO CASE(PARMTYPE) */
     1837    12440    6                       DO WHILE('0'B);
     1838    12441    6      UPD_NETCON_ERR:     CALL KSE$ERRMSG(0);
     1839    12442    6                          CALL KSE$ERRMSG(%E$KS_NETCON_ERR);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:219  
     1840    12443                               /*E* ERROR: KSN-E$KS_NETCON_ERR-0
     1841    12444                                    MESSAGE: Unable to access :NETCON.  The value set
     1842    12445                                             will not be restored when the node is rebooted.
     1843    12446                                    DESCRIPTION: COULDN'T GET TO :NETCON.  */
     1844    12447    6                          END;  /* DO NEVER */
     1845    12448    5                       END;  /* IF UPDATE :NETCON */
     1846    12449    5                    DO WHILE('0'B);
     1847    12450    5      SET_ERR:         CALL KSE$ERRMSG(%E$KS_CANTSETPARM,VECTOR(KS_SUB_BUF_1));
     1848    12451                            /*E* ERROR: KSN-E$KS_CANTSETPARM-0
     1849    12452                                 MESSAGE: Unable to set %U1.
     1850    12453                                 DESCRIPTION: SEE MESSAGE */
     1851    12454    5                       PROMPT.NODENAME = KS_NODENAME;
     1852    12455    5                       END;  /* DO NEVER */
     1853    12456    4                    END;  /* DO K */
     1854    12457        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:220  
     1855    12458    3              CASE(%KS_PSEUDO);
     1856    12459    3                 KS_PSEUDO_KEY.NODE = KS_NODE;
     1857    12460    3                 READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
     1858    12461    3                 READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);
     1859    12462    3                 CALL M$READ(READ_NETCON) WHENALTRETURN
     1860    12463    4                    DO;
     1861    12464    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY THEN
     1862    12465    4                       GOTO PSEUDO_SET_ERR;
     1863    12466    4                    KS_PSEUDO = '0'B;
     1864    12467    4                    END;  /* when altreturn on READ  */
     1865    12468
     1866    12469        /*
     1867    12470                   Quickly,  If no PSEUDOs exists with that name, then stuff
     1868    12471                   the record with the info off the parse tree.  If a PSEUDO
     1869    12472                   does exist with that name then just update and rewrite to
     1870    12473                   :NETCON.
     1871    12474        */
     1872    12475
     1873    12476    3              T_PSEUDO# = -1;
     1874    12477    4   PSEDO_SRCH: DO J = 0 TO KS_PSEUDO.PSEUDO#-1;
     1875    12478    4                 IF KS_PSEUDO.PSEUDO.NAME(J) = BLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT
             12478                          THEN
     1876    12479    5                    DO;
     1877    12480    5                    T_PSEUDO# = J;
     1878    12481    5                    EXIT PSEDO_SRCH;
     1879    12482    5                    END;
     1880    12483    4              END;  /*  do j  */
     1881    12484
     1882    12485        /*
     1883    12486                   if j is greater then maxpseudos then too many pseudos
     1884    12487        */
     1885    12488
     1886    12489    3              IF J > %KS_MAX_PSEUDO THEN
     1887    12490    3                 GOTO TOO_MANY_PSEUDO;
     1888    12491
     1889    12492        /*
     1890    12493                   if j=-1 then the pseudo does not exist in the record
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:221  
     1891    12494        */
     1892    12495
     1893    12496    3              IF T_PSEUDO# = -1 THEN
     1894    12497    4                 DO;
     1895    12498    4                 KS_PSEUDO.PSEUDO.NAME(KS_PSEUDO.PSEUDO#) = BLK$->OUT$BLK.SUBLK$(0)->
             12498                          OUT$SYM.TEXT;
     1896    12499    4                 T_PSEUDO# = KS_PSEUDO.PSEUDO#;
     1897    12500    4                 KS_PSEUDO.PSEUDO# = KS_PSEUDO.PSEUDO# + 1;
     1898    12501    4                 END;  /*  if no pseudo defined  */
     1899    12502
     1900    12503        /*
     1901    12504                at this point whether the pseudo existed or not does not
     1902    12505                matter.  The code continues in such a way as to treat both
     1903    12506                cases the same.  All of the sub-blocks are evaluated and
     1904    12507                and placed into the record as specified.
     1905    12508        */
     1906    12509
     1907    12510    4                 DO K= 1 TO BLK$->OUT$BLK.NSUBLKS - 1;
     1908    12511    4                    SUBLK$ = BLK$->OUT$BLK.SUBLK$(K);
     1909    12512    5                    DO CASE(SUBLK$->OUT$BLK.CODE);
     1910    12513
     1911    12514    5                       CASE(%KS_MAXC);
     1912    12515    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12515                                   THEN GOTO TOO_BIG;
     1913    12516    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1914    12517    5                          KS_PSEUDO.PSEUDO.MAX_CG(T_PSEUDO#) = TEMP1;
     1915    12518
     1916    12519    5                       CASE(%KS_MAXH);
     1917    12520    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12520                                   THEN GOTO TOO_BIG;
     1918    12521    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1919    12522    5                          KS_PSEUDO.PSEUDO.MAX_HAND(T_PSEUDO#) = TEMP1;
     1920    12523    5                       CASE(%KS_MAXG);
     1921    12524    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12524                                   THEN GOTO TOO_BIG;
     1922    12525    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1923    12526    5                          KS_PSEUDO.PSEUDO.MAX_GHST(T_PSEUDO#) = TEMP1;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:222  
     1924    12527
     1925    12528    5                       CASE(%KS_MAXS);
     1926    12529    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12529                                   THEN GOTO TOO_BIG;
     1927    12530    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1928    12531    5                          KS_PSEUDO.PSEUDO.MAX_SYS(T_PSEUDO#) = TEMP1;
     1929    12532
     1930    12533    5                       CASE(%KS_MAXU);
     1931    12534    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12534                                   THEN GOTO TOO_BIG;
     1932    12535    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1933    12536    5                          KS_PSEUDO.PSEUDO.MAX_USR(T_PSEUDO#) = TEMP1;
     1934    12537    5                       END;  /* case on subnodes  */
     1935    12538    4                 END;  /*  do k  */
     1936    12539
     1937    12540    3              WRITE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
     1938    12541    3              WRITE_NETCON.BUF_ = VECTOR(KS_PSEUDO);
     1939    12542    3              WRITE_NETCON.BUF_.BOUND = KS_PSEUDO.PSEUDO# * 28 + 4 - 1;
     1940    12543        /*            18 is # of bytes in PSEUDO array and 4 is bytes in
     1941    12544                      PSEUDO#
     1942    12545        */
     1943    12546
     1944    12547    3              CALL M$WRITE(WRITE_NETCON) ALTRET(PSEUDO_SET_ERR);
     1945    12548
     1946    12549    4              DO WHILE ('0'B);
     1947    12550    4    PSEUDO_SET_ERR: CALL KSE$ERRMSG(0);
     1948    12551    4                    KS_SUB_BUF_1.COUNT = SIZEC('PSEUDO');
     1949    12552    4                    KS_SUB_BUF_1.TEXT = 'PSEUDO';
     1950    12553    4                    CALL KSE$ERRMSG(%E$KS_CANTSETPARM);
     1951    12554    4                    GOTO END_LOOP;
     1952    12555    4    TOO_MANY_PSEUDO:
     1953    12556    4                    KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);
     1954    12557    4                    KS_SUB_BUF_1.TEXT = KS_NODENAME;
     1955    12558    4                    CALL KSE$ERRMSG(%E$KS_TOO_MANY_PSEUDOS,VECTOR(KS_SUB_BUF_1));
     1956    12559                         /*E* ERROR: KSN-E$KS_TOO_MANY_PSEUDOS-0
     1957    12560                              MESSAGE: Too many PSEUDOs set on node %U1
     1958    12561                              MESSAGE1: Use the DELETE command to remove PSEUDOs
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:223  
     1959    12562                              DESCRIPTION: SEE MESSAGE      */
     1960    12563    4                    GOTO END_LOOP;
     1961    12564    4    TOO_BIG:
     1962    12565    4                    CALL KSE$ERRMSG(%E$KS_BADNUM);
     1963    12566                               /*E* ERROR: KSN-E$KS_BADNUM-0
     1964    12567                                    MESSAGE: Bad number.
     1965    12568                                    DESCRIPTION: SEE MESSAGE */
     1966    12569    4                    GOTO END_LOOP;
     1967    12570    4              END;  /*   do never  */
     1968    12571
     1969    12572    3              END;  /* DO CASE(CODE) */
     1970    12573    2   END_LOOP:;
     1971    12574    2           END;  /* DO I */
     1972    12575    1   ALTER_FID:  PROC (PTR$,TARGET);
     1973    12576    2            DCL PTR$    PTR;
     1974    12577    2            DCL TARGET  CHAR(28) ALIGNED;
     1975    12578
     1976    12579    2            IF PTR$->OUT$BLK.NSUBLKS = 2 THEN
     1977    12580    2               CALL CONCAT (TARGET,
     1978    12581    2                           PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,    /* FILE NAME */
     1979    12582    2                           '.',
     1980    12583    2                           PTR$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);   /* ACCT NAME */
     1981    12584    2            ELSE
     1982    12585    2            IF PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = 1 THEN
     1983    12586    2               CALL CONCAT (TARGET,
     1984    12587    2                           PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,   /* NAME ONLY */
     1985    12588    2                           '.:SYS');
     1986    12589    2            ELSE
     1987    12590    2            IF PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = 2 THEN
     1988    12591    3               DO;  /* acct only */
     1989    12592    3                  CALL INDEX(INDX,'.',TARGET);
     1990    12593    4                  IF INDX >= LENGTHC(TARGET)-1 THEN DO;
     1991    12594    4                     CALL INDEX(INDX,' ',TARGET);
     1992    12595    4                     SUBSTR (TARGET,INDX,1) = '.';
     1993    12596    4                     SUBSTR (TARGET,INDX+1) = PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1994    12597    4                     END;
     1995    12598    3                  ELSE
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:224  
     1996    12599    3                     SUBSTR (TARGET,INDX+1) = PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     1997    12600    3               END;   /* acct only */
     1998    12601    2   END ALTER_FID;
     1999    12602    1   RESET_PARAMS_TO_DEFAULTS: PROC;
     2000    12603
     2001    12604                                        /*
     2002    12605                                           rewrite the handler
     2003    12606                                           record.  ks$hndlr with defaults from
     2004    12607                                           ks_tables_d.
     2005    12608                                        */
     2006    12609    2                                I = 1;
     2007    12610    3          SRCH_TBL1:             DO WHILE KS_HAND_INFO.TEXT(I) ~= ' ';
     2008    12611    3                                   IF KS_HAND_INFO.TEXT(I) = SUBSTR(KS$HNDLR.HNDLRNAME,
             12611                                            0,SIZEC(KS$HNDLR.HNDLRNAME)) THEN
     2009    12612    3                                      EXIT SRCH_TBL1;
     2010    12613    3                                   ELSE
     2011    12614    3                                      I = I + 1;
     2012    12615    3                                 END;
     2013    12616
     2014    12617    2                                PTR$ = KS_HAND_INFO.PARAMS$(I);
     2015    12618    2                                IF KS_HAND_INFO.SZ(I) <= %KL_FIXED_HI THEN
     2016    12619    2                                    KS$HNDLR.NPARAMS = KS_HAND_INFO.SZ(I);
     2017    12620    2                                ELSE
     2018    12621    2                                   KS$HNDLR.NPARAMS = %KL_FIXED_HI;
     2019    12622    3                                DO K = 0 TO KS$HNDLR.NPARAMS - 1;
     2020    12623    3                                   KS$HNDLR.PARAMS(K) = PTR$->KS$PRM.DEFAULT(K);
     2021    12624    3                                END;
     2022    12625    2                                IF KS_HAND_INFO.SZ(I) > %KL_FIXED_HI THEN
     2023    12626    3                                   DO;
     2024    12627    3                                   KS$HNDLR.NPARAMI = KS_HAND_INFO.SZ(I) - %KL_FIXED_HI
             12627                                            ;
     2025    12628    3                                   OUT$ = PINCRW(ADDR(HNDLR_BUF),SIZEW(KS_HANDLER));
     2026    12629    3                                   IF KS_HAND_INFO.SZ(I) - %KL_FIXED_HI >
     2027    12630    3                                      KS_HANDLER.NPARAMI THEN
     2028    12631    3   OUT$ = PINCRW(OUT$,((KS_HAND_INFO.SZ(I) - %KL_FIXED_HI - KS_HANDLER.NPARAMI) * SIZEW
             12631            (KS_HANDLER.IPARAM(0))));
     2029    12632    4                                   DO K = %KL_FIXED_HI  TO KS_HAND_INFO.SZ(I) - 1;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:225  
     2030    12633    4                                      DFLT_OPT$ = PTR$->KS$PRM.SPCL_TBL$(K);
     2031    12634    4                                      KS$HNDLR.IPARAM.OFFSET(K-%KL_HNDLRPARM_BLOCK) =
             12634                                               POFFW(OUT$,ADDR(HNDLR_BUF));
     2032    12635    4                                      KS$HNDLR.IPARAM.ARRAY_SZ(K-%KL_HNDLRPARM_BLOCK) =
             12635                                               KS_HAND_INFO.PARAMS$(I)->KS$PRM.ARRAY_SZ(K);
     2033    12636    5                                      DO L = 0 TO KS$HNDLR.IPARAM.ARRAY_SZ(K-%
             12636                                               KL_HNDLRPARM_BLOCK);
     2034    12637    5                                         OUT$->VALUE_B(L) = DFLT_OPT$->KS$PRM.DEFAULT(L
             12637                                                  );
     2035    12638    5                                      END;
     2036    12639    4                                      OUT$ = PINCRW(OUT$,(KS$HNDLR.IPARAM.ARRAY_SZ(K-%
             12639                                               KL_HNDLRPARM_BLOCK)+2)/2);
     2037    12640    4                                   END;  /* # of indx params */
     2038    12641    3                                   END;
     2039    12642    2                                ELSE
     2040    12643    2                                   KS$HNDLR.NPARAMI = 0;
             12643                                            /* reset if no indexed params */
     2041    12644    2   END RESET_PARAMS_TO_DEFAULTS;
     2042    12645    1   END KSC$SET;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:226  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$SET.

   Procedure KSC$SET requires 2275 words for executable code.
   Procedure KSC$SET requires 172 words of local(AUTO) storage.

    No errors detected in file KSC$COMMANDS1.:E05TSI    .

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:227  

 Object Unit name= KSC$SET                                    File name= KSC$COMMANDS1.:E05TOU
 UTS= JUL 30 '97 01:45:10.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     69    105  KSC$SET
    2   Data  even  none   846   1516  KSC$SET
    3   DCB   even  none     0      0  M$NETCON
    4   DCB   even  none     0      0  M$SI
    5   Proc  even  none  2275   4343  KSC$SET
    6  RoData even  none   131    203  KSC$SET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        1  KSC$SET
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:228  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 KSE$ERRMSG
         yes           Std       1 KSU$INIT_DEFCNFG
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       1 KSR$RD_HLPCG
 yes     yes           Std       2 KSU$READ_NETCON
 yes     yes           Std       3 KSU$WRITE_NETCON
         yes           Std      11 KSW$WRITE
         yes           Std       3 KSU$STRIP_ZEROS
 yes     yes           Std       1 KSR$WR_HLPCG
         yes           Std       2 KSU$UNPACK
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_SELPRMOPT                          KS_NODE                               KS_HNDLRNAME
     KS_HNDLRINDX                          KS_MSGBUF                             KS_MSGBUF$
     KS_SUB_BUF_1                          KS_SUB_BUF_2                          KS_SUB_BUF_3
     B$TCB$                                KS_TBL                                KS_FID
     KS_LIB                                KS_HAND                               KS_NRHAND
     KS_CMD                                P_PCB                                 KS_HAND_INFO
     PROMPT                                M$NETCON                              M$SI
     B_VECTNIL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:229  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:230  


      908        1        /*T***********************************************************/
      909        2        /*T*                                                         */
      910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      911        4        /*T*                                                         */
      912        5        /*T***********************************************************/
      913        6        KSC$SET: PROC(TOP$) ALTRET;

      6  5 000000   000000 700200 xent  KSC$SET      TSX0  ! X66_AUTO_1
         5 000001   000254 000001                    ZERO    172,1

      914        7        /**/
      915        8    1   DCL TOP$ PTR;
      916        9        /**/
      917       10        %INCLUDE CP_6;
      918       91        %INCLUDE KL_MACRO_C;
      919     3443        %INCLUDE KS_MACRO_M;
      920     3640        %INCLUDE KS_SUBS_C;
      921     3883        %INCLUDE KS_DATA_R;
      922     3898        %INCLUDE KS_PERR_C;
      923     3965        %INCLUDE KL_CONTROL_C;
      924     4345        %INCLUDE KL_AFCN_C;
      925     4446        %INCLUDE KL_CONFIG_M;
      926     5208        %INCLUDE GI_BOOT_C;
      927     5319        %INCLUDE XU_MACRO_C;
      928     8425        %INCLUDE B_ERRORS_C;
      929     9552        %INCLUDE F$DCB;
      930     9601        /**/
      931     9602        %KS$BOX(TITLE="entry defs");

              9620    1   /***************************************************************************
              9621    1    *                                                                         *
              9622    1    *                                 entry defs                              *
              9623    1    *                                                                         *
              9624    1    ***************************************************************************/

      932     9629    1   DCL KSE$ERRMSG ENTRY(4);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:231  
      933     9630    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
      934     9631    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
      935     9632    1   DCL KSU$CHARBIN ENTRY(4) ALTRET;
      936     9633    1   DCL KSW$WRITE ENTRY(11);
      937     9634    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
      938     9635    1   DCL KSU$UNPACK ENTRY(2);
      939     9636    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
      940     9637    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
      941     9638    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
      942     9639    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      943     9640    1   DCL KSU$STRIP_ZEROS ENTRY(3);
      944     9641        %KS$BOX(TITLE="symref variables");

              9659    1   /***************************************************************************
              9660    1    *                                                                         *
              9661    1    *                              symref variables                           *
              9662    1    *                                                                         *
              9663    1    ***************************************************************************/

      945     9668    1   DCL B$TCB$ PTR SYMREF;
      946     9669    1   DCL KS_TBL(0:9) PTR SYMREF;
      947     9670    1   DCL KS_FID SBIN SYMREF;
      948     9671    1   DCL KS_LIB SBIN SYMREF;
      949     9672    1   DCL KS_HAND SBIN SYMREF;
      950     9673    1   DCL KS_NRHAND SBIN SYMREF;
      951     9674    1   DCL KS_CMD SBIN SYMREF;
      952     9675        %P_PCB(NAME = P_PCB,STCLASS=SYMREF);
      953     9874        %KS$HAND_INFO ( NAME = KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF", LAST=";");
      954     9913        %KS$BOX(TITLE="symdef variables");

              9931    1   /***************************************************************************
              9932    1    *                                                                         *
              9933    1    *                              symdef variables                           *
              9934    1    *                                                                         *
              9935    1    ***************************************************************************/

      955     9940        %KS$BOX(TITLE="constant variables");
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:232  

              9958    1   /***************************************************************************
              9959    1    *                                                                         *
              9960    1    *                             constant variables                          *
              9961    1    *                                                                         *
              9962    1    ***************************************************************************/

      956     9967        /**/
      957     9968    1   DCL EQUALS CHAR(0) CONSTANT INIT('=');
      958     9969    1   DCL STAR CHAR(0) CONSTANT INIT('*');
      959     9970    1   DCL MONFID CHAR(0) CONSTANT INIT('Monitor Fid (%T) %10P');
      960     9971    1   DCL NHNDLRS CHAR(0) CONSTANT INIT('Number of Handlers (%D) %10P');
      961     9972    1   DCL HNDLRNAME CHAR(0) CONSTANT INIT('Handler #%D Name (%T) %10P');
      962     9973    1   DCL HEX_DIGITS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      963     9974    1   DCL HNDLRFID CHAR(0) CONSTANT INIT('Handler #%D Fid (%T) %10P');
      964     9975    1   DCL LIBACCT CHAR(0) CONSTANT INIT('Library account (%T) %10P');
      965     9976    1   DCL WRITE_SUCCESSFULL_FMT CHAR(0) CONSTANT INIT (
      966     9977    1        '%T successfully written to %2P%A%10P');
      967     9978    1   DCL WRITE_SUCCESSFULL_VEC BIT(72) DALIGNED CONSTANT INIT
      968     9979    1        (VECTOR(WRITE_SUCCESSFULL_FMT));
      969     9980    1   DCL NETCON CHAR(0) CONSTANT INIT (':NETCON');
      970     9981    1   DCL FEP CHAR(0) CONSTANT INIT ('FEP');
      971     9982        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:233  
             10000    1   /***************************************************************************
             10001    1    *                                                                         *
             10002    1    *                              static variables                           *
             10003    1    *                                                                         *
             10004    1    ***************************************************************************/

      972    10009    1   DCL 1 TEXTC STATIC ALIGNED,
      973    10010    1         2 COUNT UBIN BYTE UNAL INIT(0),
      974    10011    1         2 TEXT CHAR(40) UNAL INIT(' ');
      975    10012    1   DCL HNDLR_BUF(0:400) CHAR(1) STATIC INIT(' '*0);
      976    10013    1   DCL HANDLER$ STATIC PTR INIT(ADDR(HNDLR_BUF));
      977    10014    1   DCL SI_BUF CHAR(100) STATIC ALIGNED;
      978    10015    1   DCL FIDNAME CHAR(28) STATIC ALIGNED;
      979    10016        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      980    10035    1   DCL DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
      981    10036    1   DCL DEFAULT$           PTR STATIC INIT(ADDR(DEFAULT_BUF));
      982    10037        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
      983    10056        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
      984    10081        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
      985    10099        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_BOOTHI,STCLASS=STATIC);
      986    10119        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
      987    10137        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      988    10167        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
      989    10185        %KL$PSEUDO(NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
      990    10229        %KL$PSEUDO_KEY(NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
      991    10247    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
      992    10248    1   DCL 1 PROMPT  SYMREF,
      993    10249    1           2 NODENAME CHAR(8),
      994    10250    1           2 STAR CHAR(2);
      995    10251        %KL_CONTROL (FPTN=KS_CONTROL,STCLASS=STATIC);
      996    10387        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,NUMI=2,STCLASS=STATIC);
      997    10450        %KS$BOX(TITLE="based variables");

             10468    1   /***************************************************************************
             10469    1    *                                                                         *
             10470    1    *                              based variables                            *
             10471    1    *                                                                         *
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:234  
             10472    1    ***************************************************************************/

      998    10477        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      999    10522        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     1000    10560        %PARSE$OUT (NAME=OUT$BLK2,STCLASS="BASED(TOP2$)");
     1001    10605        %PARSE$SYM (NAME=OUT$SYM2,STCLASS=BASED);
     1002    10643        %KL$HNDLR (NAME = KS$HNDLR,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
     1003    10706        %KL_HDR(FPTN=KS$HDR,STCLASS="BASED(HDR$)");
     1004    10786        %KL$LINCNFG (NAME=KS_DEFAULT_REC,STCLASS="BASED(DEFAULT$)");
     1005    10944        %KL_HDR (FPTN=KS_HDR,STCLASS="BASED(KS_MSGBUF$)");
     1006    11024    1   DCL 1 HND BASED UNAL,
     1007    11025    1        2 DAT(0:18) BIT(1) UNAL;
     1008    11026        %KS$PARAM (NAME=KS$PARAM,LVL=1,STCLASS="(0:0) BASED",LAST=";");
     1009    11096        %KS$PARAM (NAME=KS$PRM,LVL=1,STCLASS="(0:0) BASED",LAST=";",SPECIAL=YES);
     1010    11166    1   DCL VALUE_B(0:0) UBIN HALF BASED HALIGNED;
     1011    11167        %VLP_NAME(FPTN = NAME,STCLASS = BASED);
     1012    11194        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:235  
             11212    1   /***************************************************************************
             11213    1    *                                                                         *
             11214    1    *                               auto variables                            *
             11215    1    *                                                                         *
             11216    1    ***************************************************************************/

     1013    11221    1   DCL BOOT_FLAG BIT(1);
     1014    11222    1   DCL FID_FLAG BIT(1);
     1015    11223    1   DCL BOOTIME  BIT(1) UNAL;
     1016    11224    1   DCL TEMP UBIN;
     1017    11225    1   DCL HNDLREXISTS BIT(1);
     1018    11226    1   DCL HEX_CHAR CHAR(1);
     1019    11227    1   DCL HEX_DIGIT UBIN;
     1020    11228    1   DCL HNDLRX UBIN;   /* index in fephndlr.handler array */
     1021    11229    1   DCL INDX1  UBIN;   /* general index */
     1022    11230    1   DCL INDX2  UBIN;
     1023    11231    1   DCL I UBIN;
     1024    11232    1   DCL INDX UBIN;
     1025    11233    1   DCL INDX_VEC(0:49) UBIN;
     1026    11234    1   DCL J UBIN;
     1027    11235    1   DCL K UBIN;
     1028    11236    1   DCL 1 KS_SUB_BUF_TEMP2  ALIGNED,
     1029    11237    1        2 COUNT UBIN BYTE UNAL,
     1030    11238    1        2 TEXT_C UNAL,
     1031    11239    1          3 TOPSIZ CHAR(6) UNAL,
     1032    11240    1          3 TEXT CHAR(25) UNAL,
     1033    11241    1        2 TEXT REDEF TEXT_C CHAR(31);
     1034    11242
     1035    11243    1   DCL 1 KS_SUB_BUF_4 ALIGNED,
     1036    11244    1        2 COUNT UBIN BYTE UNAL,
     1037    11245    1        2 TEXT CHAR(31) UNAL;
     1038    11246    1   DCL L UBIN;
     1039    11247    1   DCL LIB_FLAG BIT(1);    /* misc flags to indicate options on set boot cmd */
     1040    11248    1   DCL MON_FLAG BIT(1);
     1041    11249    1   DCL OPTBLK$ PTR;          /* pointer to options on set boot cmd */
     1042    11250    1   DCL PARMX UBIN;
     1043    11251    1   DCL PARMTYPE UBIN;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:236  
     1044    11252    1   DCL PERM_PARM UBIN BYTE;
     1045    11253    1   DCL NUM_INDX UBIN;
     1046    11254    1   DCL SCNOPTS UBIN;         /* pointer to options on handler in set boot */
     1047    11255    1   DCL SUBLK$ PTR;
     1048    11256    1   DCL SUBLOP UBIN;
     1049    11257    1   DCL TEMP1 UBIN;
     1050    11258    1   DCL TEMP2 UBIN;
     1051    11259    1   DCL T_PSEUDO# SBIN;
     1052    11260    1   DCL TMP$    PTR;          /* temporary pointer */
     1053    11261    1   DCL VALUE UBIN;
     1054    11262    1   DCL 1 VALUEC REDEF VALUE,
     1055    11263    1        2 * CHAR(2) UNAL,
     1056    11264    1        2 RES CHAR(2) UNAL;
     1057    11265        /* redef of ks_sub_buf_? for error message display */
     1058    11266        /**/
     1059    11267    1   DCL ERR# UBIN;
     1060    11268    1   DCL BLK$ PTR;
     1061    11269    1   DCL TOP2$ PTR;
     1062    11270    1   DCL PTR$ PTR;
     1063    11271    1   DCL DFLT_OPT$ PTR;
     1064    11272    1   DCL OUT$ PTR;
     1065    11273    1   DCL INDX_R UBIN BYTE;
     1066    11274    1   DCL SZ UBIN WORD;
     1067    11275    1   DCL BUF_SIZE UBIN WORD;
     1068    11276    1   DCL HANDLERNAME CHAR(8);
     1069    11277    1   DCL OLD_HANDLER (0:20) CHAR(8) ALIGNED;
     1070    11278    1   DCL OLD_BOOTIME (0:20) BIT(1) UNAL;
     1071    11279    1   DCL OLD_NRHAND   UBIN;
     1072    11280    1   DCL RECORD_SIZE  UBIN;
     1073    11281    1   DCL RECORD_CHANGED  BIT(1) ALIGNED;
     1074    11282    1   DCL HANDLER_FOUND   BIT(1) ALIGNED;
     1075    11283    1   DCL RCVCQ_SNDCQ     BIT(1) ALIGNED;
     1076    11284    1   DCL HANDNR       UBIN;
     1077    11285        %B$TCB;
     1078    11288        %B$ALT;
     1079    11296        /**/
     1080    11297        %KS$BOX(TITLE="FPTs and VLPs");
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:237  

             11315    1   /***************************************************************************
             11316    1    *                                                                         *
             11317    1    *                               FPTs and VLPs                             *
             11318    1    *                                                                         *
             11319    1    ***************************************************************************/

     1081    11324        %FPT_READ (FPTN=READ_NETCON,
     1082    11325                   DCB=M$NETCON,
     1083    11326                   KEYS=YES);
     1084    11365        %FPT_WRITE (FPTN=WRITE_NETCON,
     1085    11366                    DCB=M$NETCON);
     1086    11397        %FPT_DELREC (FPTN=DELREC_NETCON,
     1087    11398                     DCB=M$NETCON);
     1088    11417        /**/
     1089    11418        %FPT_OPEN;
     1090    11527        /**/
     1091    11528        %FPT_FID (FPTN = NETCON_FID,
     1092    11529                  NAME = VLP_NAME,PASS=VLP_PASS,
     1093    11530                  RESULTS = VLR_FID, ACCT = VLP_ACCT,
     1094    11531                  SN = VLP_SN, WSN = VLP_WSN,
     1095    11532                  ASN = "FPT_OPEN.V.ASN#", RES = "FPT_OPEN.V.RES#",
     1096    11533                  TEXTFID = FIDNAME);
     1097    11556        /**/
     1098    11557        %VLP_ACCT;
     1099    11570        %VLP_NAME;
     1100    11597        %VLP_PASS;
     1101    11610        %VLP_SN;
     1102    11623        %VLP_WSN;
     1103    11636        %VLR_FID;
     1104    11655        %KS$BOX(TITLE="DCBs");

             11673    1   /***************************************************************************
             11674    1    *                                                                         *
             11675    1    *                                    DCBs                                 *
             11676    1    *                                                                         *
             11677    1    ***************************************************************************/
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:238  

     1105    11682    1   DCL M$NETCON DCB;
     1106    11683    1   DCL M$SI DCB;
     1107    11684        %KS$BOX(TITLE="EQUs");

             11702    1   /***************************************************************************
             11703    1    *                                                                         *
             11704    1    *                                    EQUs                                 *
             11705    1    *                                                                         *
             11706    1    ***************************************************************************/

     1108    11711        %EQU KS_MAX_HALF = 6;
     1109    11712        %EQU KS_MAX_PSEUDO = 7;
     1110    11713        /**/
     1111    11714        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:239  
     1112    11715    2        IF KS_NODENAME = 'HOST' THEN DO;

  11715  5 000002   040000 106400                    CMPC    fill='040'O
         5 000003   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 000004   000067 000004 1                  ADSC9   FEP+1                    cn=0,n=4
         5 000005   000013 601000 5                  TNZ     DOI

     1113    11716    2           CALL KSE$ERRMSG(%E$KS_NONODE);

  11716  5 000006   000000 630400 6                  EPPR0   0
         5 000007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000010   000000 701000 xent               TSX1    KSE$ERRMSG
         5 000011   000000 011000                    NOP     0

     1114    11717                /*E* ERROR: KSN-E$KS_NONODE-0
     1115    11718                     MESSAGE: Node has not been selected.
     1116    11719                     MESSAGE1: A node must be selected via the SELECT command.
     1117    11720                     DESCRIPTION: SEE MESSAGES */
     1118    11721    2           RETURN;

  11721  5 000012   000000 702200 xent               TSX2  ! X66_ARET

     1119    11722    2           END;  /* IF KS_NODENAME = 'HOST' */
     1120    11723    2   DOI: DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  11723  5 000013   200016 450100       DOI          STZ     I,,AUTO
         5 000014   003731 710000 5                  TRA     END_LOOP+3

     1121    11724    2           BLK$ = OUT$BLK.SUBLK$(I);

  11724  5 000015   200003 470500                    LDP0    @TOP$,,AUTO
         5 000016   000000 471500                    LDP1    0,,PR0
         5 000017   200016 720100                    LXL0    I,,AUTO
         5 000020   100003 236110                    LDQ     3,X0,PR1
         5 000021   200145 756100                    STQ     BLK$,,AUTO

     1122    11725    3           DO CASE(BLK$->OUT$BLK.CODE);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:240  

  11725  5 000022   200145 473500                    LDP3    BLK$,,AUTO
         5 000023   300000 721100                    LXL1    0,,PR3
         5 000024   000004 101003                    CMPX1   4,DU
         5 000025   000027 602011 5                  TNC     s:11725+5,X1
         5 000026   003726 710000 5                  TRA     END_LOOP
         5 000027   003726 710000 5                  TRA     END_LOOP
         5 000030   000033 710000 5                  TRA     s:11727
         5 000031   003362 710000 5                  TRA     s:12459
         5 000032   002100 710000 5                  TRA     s:12175

     1123    11726    3              CASE(%KS_BOOTINFO);

     1124    11727    3                 IF BLK$->OUT$BLK.NSUBLKS > 0 THEN

  11727  5 000033   300001 222100                    LDX2    1,,PR3
         5 000034   001050 600000 5                  TZE     PROMPTED_SET_BOOT

     1125    11728    4                    DO;  /* 1 set boot commands with options  */

     1126    11729    4                    KS_FEPHNDLR = '0'B;   /* init buffer areas  */

  11729  5 000035   000000 100400                    MLR     fill='000'O
         5 000036   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000037   000374 000270 2                  ADSC9   KS_FEPHNDLR              cn=0,n=184

     1127    11730
     1128    11731    4                    KS_FEPBOOT = '0'B;

  11731  5 000040   000000 100400                    MLR     fill='000'O
         5 000041   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000042   000312 000150 2                  ADSC9   KS_FEPBOOT               cn=0,n=104

     1129    11732        /**/
     1130    11733                         /* params will always be off of 1st sublk */
     1131    11734        /**/
     1132    11735        /*
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:241  
     1133    11736                read the ks_fephndlr record.  use this same buffer
     1134    11737                throughout the entire processing period.
     1135    11738        */
     1136    11739    4                    KS_FEPHNDLR_KEY.NODE = KS_NODE;

  11739  5 000043   000000 236000 xsym               LDQ     KS_NODE
         5 000044   000011 736000                    QLS     9
         5 000045   000452 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

     1137    11740    4                    READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);

  11740  5 000046   000002 237000 6                  LDAQ    2
         5 000047   001300 757000 2                  STAQ    READ_NETCON+4

     1138    11741    4                    READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  11741  5 000050   000004 237000 6                  LDAQ    4
         5 000051   001276 757000 2                  STAQ    READ_NETCON+2

     1139    11742    4                    CALL M$READ(READ_NETCON) ALTRET(SET_ERR);

  11742  5 000052   001274 630400 2                  EPPR0   READ_NETCON
         5 000053   440000 713400                    CLIMB   alt,read
         5 000054   401400 401760                    pmme    nvectors=4
         5 000055   003344 702000 5                  TSX2    SET_ERR

     1140    11743        /**/
     1141    11744    5                    DO SCNOPTS = 0 TO BLK$->OUT$BLK.NSUBLKS-1;  /*  2  */

  11744  5 000056   200134 450100                    STZ     SCNOPTS,,AUTO
         5 000057   000722 710000 5                  TRA     s:11924+3

     1142    11745    5                       HNDLR_BUF = '0'B;

  11745  5 000060   000000 100400                    MLR     fill='000'O
         5 000061   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000062   000013 000621 2                  ADSC9   HNDLR_BUF                cn=0,n=401
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:242  

     1143    11746    5                       TMP$ = BLK$->OUT$BLK.SUBLK$(SCNOPTS);

  11746  5 000063   200145 470500                    LDP0    BLK$,,AUTO
         5 000064   200134 720100                    LXL0    SCNOPTS,,AUTO
         5 000065   000003 236110                    LDQ     3,X0,PR0
         5 000066   200142 756100                    STQ     TMP$,,AUTO

     1144    11747    6      SETCODE:         DO CASE (TMP$->OUT$BLK.CODE);   /*  3  */

  11747  5 000067   200142 470500       SETCODE      LDP0    TMP$,,AUTO
         5 000070   000000 720100                    LXL0    0,,PR0
         5 000071   000005 100003                    CMPX0   5,DU
         5 000072   000074 602010 5                  TNC     SETCODE+5,X0
         5 000073   000717 710000 5                  TRA     s:11924
         5 000074   000717 710000 5                  TRA     s:11924
         5 000075   000101 710000 5                  TRA     s:11750
         5 000076   000142 710000 5                  TRA     s:11768
         5 000077   000717 710000 5                  TRA     s:11924
         5 000100   000152 710000 5                  TRA     s:11777

     1145    11748        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:243  
     1146    11749    6                          CASE (%KS_MONFID);

     1147    11750    6                             KS_FEPBOOT_KEY.NODE = KS_NODE;

  11750  5 000101   000000 236000 xsym               LDQ     KS_NODE
         5 000102   000011 736000                    QLS     9
         5 000103   000344 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

     1148    11751    6                             READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  11751  5 000104   000006 237000 6                  LDAQ    6
         5 000105   001300 757000 2                  STAQ    READ_NETCON+4

     1149    11752    6                             READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  11752  5 000106   000010 237000 6                  LDAQ    8
         5 000107   001276 757000 2                  STAQ    READ_NETCON+2

     1150    11753    6                             CALL M$READ(READ_NETCON) ALTRET(SETCODE);

  11753  5 000110   001274 630400 2                  EPPR0   READ_NETCON
         5 000111   440000 713400                    CLIMB   alt,read
         5 000112   401400 401760                    pmme    nvectors=4
         5 000113   000067 702000 5                  TSX2    SETCODE

     1151    11754        /*
     1152    11755             a fepboot record must exist for the set boot command to work.
     1153    11756        */
     1154    11757    6                             IF TMP$->OUT$BLK.NSUBLKS = 0 THEN

  11757  5 000114   200142 470500                    LDP0    TMP$,,AUTO
         5 000115   000001 220100                    LDX0    1,,PR0
         5 000116   000123 601000 5                  TNZ     s:11760

     1155    11758    6                                KS_FEPBOOT.BOOTFID = 'M:FEP.:SYS';

  11758  5 000117   040000 100400                    MLR     fill='040'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:244  
         5 000120   000070 000012 1                  ADSC9   FEP+2                    cn=0,n=10
         5 000121   000312 000050 2                  ADSC9   KS_FEPBOOT               cn=0,n=40
         5 000122   000131 710000 5                  TRA     s:11762

     1156    11759    6                             ELSE
     1157    11760    6                                CALL ALTER_FID (TMP$,KS_FEPBOOT.BOOTFID);

  11760  5 000123   000007 236000 6                  LDQ     7
         5 000124   200242 756100                    STQ     @PTR$+1,,AUTO
         5 000125   200142 631500                    EPPR1   TMP$,,AUTO
         5 000126   200241 451500                    STP1    HANDNR+2,,AUTO
         5 000127   003741 701000 5                  TSX1    ALTER_FID
         5 000130   000000 011000                    NOP     0

     1158    11761
     1159    11762    6                             WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  11762  5 000131   000006 237000 6                  LDAQ    6
         5 000132   001316 757000 2                  STAQ    WRITE_NETCON+4

     1160    11763    6                             WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  11763  5 000133   000010 237000 6                  LDAQ    8
         5 000134   001314 757000 2                  STAQ    WRITE_NETCON+2

     1161    11764    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);

  11764  5 000135   001312 630400 2                  EPPR0   WRITE_NETCON
         5 000136   440001 713400                    CLIMB   alt,write
         5 000137   401400 401760                    pmme    nvectors=4
         5 000140   003344 702000 5                  TSX2    SET_ERR
         5 000141   000717 710000 5                  TRA     s:11924

     1162    11765        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:245  
     1163    11766    6                          CASE(%KS_LIBACCT);

     1164    11767
     1165    11768    6                            KS_FEPHNDLR.DEFLIBACCT = TMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.
             11768                                      TEXT;

  11768  5 000142   000003 471500                    LDP1    3,,PR0
         5 000143   100004 236100                    LDQ     4,,PR1
         5 000144   000033 772000                    QRL     27
         5 000145   000000 621006                    EAX1    0,QL
         5 000146   040000 100540                    MLR     fill='040'O
         5 000147   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         5 000150   000375 000010 2                  ADSC9   KS_FEPHNDLR+1            cn=0,n=8
         5 000151   000717 710000 5                  TRA     s:11924

     1166    11769
     1167    11770
     1168    11771        /**/
     1169    11772        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:246  
     1170    11773    6                          CASE(%KS_HANDNAME);

     1171    11774
     1172    11775                                  /* does handler exist  */
     1173    11776
     1174    11777    6                             HNDLREXISTS = '0'B;

  11777  5 000152   200010 450100                    STZ     HNDLREXISTS,,AUTO

     1175    11778    7           FEPHNDSRCH:       DO HNDLRX = 0 TO KS_FEPHNDLR.NHANDLERS-1;

  11778  5 000153   200013 450100       FEPHNDSRCH   STZ     HNDLRX,,AUTO
         5 000154   000211 710000 5                  TRA     s:11786+3

     1176    11779    7                                IF KS_FEPHNDLR.HANDLER(HNDLRX) = BLK$->OUT$BLK.SUBLK$(
             11779                                         SCNOPTS)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT THEN

  11779  5 000155   200145 470500                    LDP0    BLK$,,AUTO
         5 000156   200134 720100                    LXL0    SCNOPTS,,AUTO
         5 000157   000003 471510                    LDP1    3,X0,PR0
         5 000160   100003 473500                    LDP3    3,,PR1
         5 000161   300004 236100                    LDQ     4,,PR3
         5 000162   000033 772000                    QRL     27
         5 000163   200013 235100                    LDA     HNDLRX,,AUTO
         5 000164   000003 735000                    ALS     3
         5 000165   000000 621006                    EAX1    0,QL
         5 000166   040140 106405                    CMPC    fill='040'O
         5 000167   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         5 000170   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         5 000171   000206 601000 5                  TNZ     s:11786

     1177    11780    8                                   DO;  /* 10 handler does exist */

     1178    11781    8                                   HNDLREXISTS = '1'B;

  11781  5 000172   400000 236003                    LDQ     -131072,DU
         5 000173   200010 756100                    STQ     HNDLREXISTS,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:247  

     1179    11782    8                                   KS$HNDLR.HNDLRNAME = KS_FEPHNDLR.HANDLER(HNDLRX);

  11782  5 000174   000160 474400 2                  LDP4    HANDLER$
         5 000175   200013 235100                    LDA     HNDLRX,,AUTO
         5 000176   000001 735000                    ALS     1
         5 000177   000400 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         5 000200   400012 755100                    STA     10,,PR4
         5 000201   400013 756100                    STQ     11,,PR4

     1180    11783    8                                   HANDLERNAME = KS$HNDLR.HNDLRNAME;

  11783  5 000202   040100 100500                    MLR     fill='040'O
         5 000203   400012 000010                    ADSC9   10,,PR4                  cn=0,n=8
         5 000204   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8

     1181    11784    8                                   EXIT FEPHNDSRCH;

  11784  5 000205   000214 710000 5                  TRA     s:11788

     1182    11785    8                                   END;  /* 10 handler found  */
     1183    11786    7                             END;  /* fephndsrch loop */

  11786  5 000206   200013 235100                    LDA     HNDLRX,,AUTO
         5 000207   000001 035007                    ADLA    1,DL
         5 000210   200013 755100                    STA     HNDLRX,,AUTO
         5 000211   200013 236100                    LDQ     HNDLRX,,AUTO
         5 000212   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 000213   000155 602000 5                  TNC     s:11779

     1184    11787        /**/
     1185    11788    6                             SUBLK$ = BLK$->OUT$BLK.SUBLK$(SCNOPTS);

  11788  5 000214   200145 470500                    LDP0    BLK$,,AUTO
         5 000215   200134 720100                    LXL0    SCNOPTS,,AUTO
         5 000216   000003 236110                    LDQ     3,X0,PR0
         5 000217   200135 756100                    STQ     SUBLK$,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:248  

     1186    11789    6                             IF ~HNDLREXISTS THEN

  11789  5 000220   200010 236100                    LDQ     HNDLREXISTS,,AUTO
         5 000221   400000 376003                    ANQ     -131072,DU
         5 000222   400000 676003                    ERQ     -131072,DU
         5 000223   000340 600000 5                  TZE     s:11808

     1187    11790    7                                DO;

     1188    11791    7                               KS$HNDLR.HNDLRNAME = SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM
             11791                                         .TEXT;

  11791  5 000224   200135 471500                    LDP1    SUBLK$,,AUTO
         5 000225   100003 473500                    LDP3    3,,PR1
         5 000226   300004 236100                    LDQ     4,,PR3
         5 000227   000033 772000                    QRL     27
         5 000230   000000 621006                    EAX1    0,QL
         5 000231   000160 474400 2                  LDP4    HANDLER$
         5 000232   040100 100540                    MLR     fill='040'O
         5 000233   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         5 000234   400012 000010                    ADSC9   10,,PR4                  cn=0,n=8

     1189    11792    7                                HANDLERNAME = KS$HNDLR.HNDLRNAME;

  11792  5 000235   040100 100500                    MLR     fill='040'O
         5 000236   400012 000010                    ADSC9   10,,PR4                  cn=0,n=8
         5 000237   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8

     1190    11793    7                                KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS + 1;

  11793  5 000240   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000241   000001 035007                    ADLA    1,DL
         5 000242   000374 755000 2                  STA     KS_FEPHNDLR

     1191    11794    7                                HNDLRX = KS_FEPHNDLR.NHANDLERS - 1;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:249  
  11794  5 000243   000001 135007                    SBLA    1,DL
         5 000244   200013 755100                    STA     HNDLRX,,AUTO

     1192    11795    7                                KS_FEPHNDLR.HANDLER(HNDLRX) = HANDLERNAME;

  11795  5 000245   000001 735000                    ALS     1
         5 000246   000002 735000                    ALS     2
         5 000247   040005 100500                    MLR     fill='040'O
         5 000250   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000251   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8

     1193    11796    7                                KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;

  11796  5 000252   200013 235100                    LDA     HNDLRX,,AUTO
         5 000253   003005 060400                    CSL     bolr='003'O
         5 000254   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000255   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1

     1194    11797    7                                CALL RESET_PARAMS_TO_DEFAULTS;

  11797  5 000256   004103 701000 5                  TSX1    RESET_PARAMS_TO_DEFAULTS
         5 000257   000000 011000                    NOP     0

     1195    11798    7                                KS_DEFAULT_KEY.NODE = KS_NODE;

  11798  5 000260   000000 236000 xsym               LDQ     KS_NODE
         5 000261   000011 736000                    QLS     9
         5 000262   000221 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

     1196    11799    7                                KS_DEFAULT_KEY.HNDLR = HANDLERNAME;

  11799  5 000263   040000 100500                    MLR     fill='040'O
         5 000264   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000265   000221 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     1197    11800    7                                CALL KSU$READ_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(
             11800                                         KS_DEFAULT_REC))
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:250  

  11800  5 000266   000306 470400 2                  LDP0    DEFAULT$
         5 000267   000012 236100                    LDQ     10,,PR0
         5 000270   000011 772000                    QRL     9
         5 000271   000777 376007                    ANQ     511,DL
         5 000272   000053 620006                    EAX0    43,QL
         5 000273   000000 635010                    EAA     0,X0
         5 000274   000002 771000                    ARL     2
         5 000275   000140 135007                    SBLA    96,DL
         5 000276   000306 236000 2                  LDQ     DEFAULT$
         5 000277   200244 757100                    STAQ    @TARGET+2,,AUTO
         5 000300   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 000301   200247 451500                    STP1    @TARGET+5,,AUTO
         5 000302   000014 236000 6                  LDQ     12
         5 000303   200246 756100                    STQ     @TARGET+4,,AUTO
         5 000304   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 000305   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000306   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 000307   000311 702000 5                  TSX2    s:11802
         5 000310   000337 710000 5                  TRA     s:11805

     1198    11801    8                                   WHENALTRETURN DO;

     1199    11802    8                                      CALL KSU$INIT_DEFCNFG(KS_DEFAULT_REC);

  11802  5 000311   000306 630400 2                  EPPR0   DEFAULT$
         5 000312   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000313   000000 701000 xent               TSX1    KSU$INIT_DEFCNFG
         5 000314   000000 011000                    NOP     0

     1200    11803    8                                      CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),
             11803                                               VECTOR(KS_DEFAULT_REC));

  11803  5 000315   000306 470400 2                  LDP0    DEFAULT$
         5 000316   000012 236100                    LDQ     10,,PR0
         5 000317   000011 772000                    QRL     9
         5 000320   000777 376007                    ANQ     511,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:251  
         5 000321   000053 620006                    EAX0    43,QL
         5 000322   000000 635010                    EAA     0,X0
         5 000323   000002 771000                    ARL     2
         5 000324   000140 135007                    SBLA    96,DL
         5 000325   000306 236000 2                  LDQ     DEFAULT$
         5 000326   200244 757100                    STAQ    @TARGET+2,,AUTO
         5 000327   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 000330   200247 451500                    STP1    @TARGET+5,,AUTO
         5 000331   000014 236000 6                  LDQ     12
         5 000332   200246 756100                    STQ     @TARGET+4,,AUTO
         5 000333   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 000334   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000335   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         5 000336   000000 011000                    NOP     0

     1201    11804    8                                   END;

     1202    11805    7                                END;

  11805  5 000337   000356 710000 5                  TRA     s:11815

     1203    11806    6                             ELSE
     1204    11807    7                                DO;

     1205    11808    7                                KS_HANDLER_KEY.NODE = KS_NODE;

  11808  5 000340   000000 236000 xsym               LDQ     KS_NODE
         5 000341   000011 736000                    QLS     9
         5 000342   000307 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1206    11809    7                                KS_HANDLER_KEY.HNDLR = HANDLERNAME;

  11809  5 000343   040000 100500                    MLR     fill='040'O
         5 000344   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000345   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1207    11810    7                                READ_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:252  

  11810  5 000346   000016 237000 6                  LDAQ    14
         5 000347   001276 757000 2                  STAQ    READ_NETCON+2

     1208    11811    7                                READ_NETCON.BUF_ = VECTOR(HNDLR_BUF);

  11811  5 000350   000020 237000 6                  LDAQ    16
         5 000351   001300 757000 2                  STAQ    READ_NETCON+4

     1209    11812    7                                CALL M$READ(READ_NETCON) ALTRET(SET_ERR);

  11812  5 000352   001274 630400 2                  EPPR0   READ_NETCON
         5 000353   440000 713400                    CLIMB   alt,read
         5 000354   401400 401760                    pmme    nvectors=4
         5 000355   003344 702000 5                  TSX2    SET_ERR

     1210    11813    7                                END;

     1211    11814        /**/
     1212    11815    6                             FID_FLAG = '0'B;

  11815  5 000356   200005 450100                    STZ     FID_FLAG,,AUTO

     1213    11816    6                             BOOT_FLAG = '0'B;

  11816  5 000357   200004 450100                    STZ     BOOT_FLAG,,AUTO

     1214    11817
     1215    11818    6                             IF TMP$->OUT$BLK.NSUBLKS > 1 THEN

  11818  5 000360   200142 470500                    LDP0    TMP$,,AUTO
         5 000361   000001 220100                    LDX0    1,,PR0
         5 000362   000002 100003                    CMPX0   2,DU
         5 000363   000616 602000 5                  TNC     s:11901

     1216    11819    7                                DO;  /* fid,bootime or remove specified  12 */

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:253  
     1217    11820    7                                IF ~HNDLREXISTS THEN

  11820  5 000364   200010 236100                    LDQ     HNDLREXISTS,,AUTO
         5 000365   400000 376003                    ANQ     -131072,DU
         5 000366   400000 676003                    ERQ     -131072,DU
         5 000367   000410 600000 5                  TZE     s:11827

     1218    11821    8                                   DO;

     1219    11822    8                                   KS$HNDLR.HNDLRFID = KS$HNDLR.HNDLRNAME;

  11822  5 000370   000160 471400 2                  LDP1    HANDLER$
         5 000371   040100 100500                    MLR     fill='040'O
         5 000372   100012 000010                    ADSC9   10,,PR1                  cn=0,n=8
         5 000373   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

     1220    11823    8                                   CALL INDEX (INDX,' ',KS$HNDLR.HNDLRFID);

  11823  5 000374   000000 124500                    SCM     mask='000'O
         5 000375   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
         5 000376   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000377   200017 000100                    ARG     INDX,,AUTO

     1221    11824    8                                   SUBSTR(KS$HNDLR.HNDLRFID,INDX,5) = '.:SYS';

  11824  5 000400   200017 235100                    LDA     INDX,,AUTO
         5 000401   040105 100400                    MLR     fill='040'O
         5 000402   000073 000005 1                  ADSC9   FEP+5                    cn=0,n=5
         5 000403   100000 000005                    ADSC9   0,A,PR1                  cn=0,n=5

     1222    11825    8                                   KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;

  11825  5 000404   200013 236100                    LDQ     HNDLRX,,AUTO
         5 000405   003006 060400                    CSL     bolr='003'O
         5 000406   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000407   000377 000001 2                  BDSC    KS_FEPHNDLR+3,Q          by=0,bit=0,n=1

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:254  
     1223    11826    8                                   END;

     1224    11827    8                                DO SUBLOP = 1 TO SUBLK$->OUT$BLK.NSUBLKS-1;  /* 13 */

  11827  5 000410   000001 235007                    LDA     1,DL
         5 000411   200136 755100                    STA     SUBLOP,,AUTO
         5 000412   000607 710000 5                  TRA     s:11897+3

     1225    11828    9                                  DO CASE(SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.CODE
             11828                                            );

  11828  5 000413   200135 470500                    LDP0    SUBLK$,,AUTO
         5 000414   200136 720100                    LXL0    SUBLOP,,AUTO
         5 000415   000003 471510                    LDP1    3,X0,PR0
         5 000416   100000 721100                    LXL1    0,,PR1
         5 000417   000010 101003                    CMPX1   8,DU
         5 000420   000422 602011 5                  TNC     s:11828+7,X1
         5 000421   000604 710000 5                  TRA     s:11897
         5 000422   000604 710000 5                  TRA     s:11897
         5 000423   000604 710000 5                  TRA     s:11897
         5 000424   000604 710000 5                  TRA     s:11897
         5 000425   000432 710000 5                  TRA     s:11831
         5 000426   000604 710000 5                  TRA     s:11897
         5 000427   000441 710000 5                  TRA     s:11836
         5 000430   000552 710000 5                  TRA     s:11874
         5 000431   000570 710000 5                  TRA     s:11880

     1226    11829        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:255  
     1227    11830    9                                      CASE(%KS_HANDFID);

     1228    11831    9                                        CALL ALTER_FID (SUBLK$->OUT$BLK.SUBLK$(SUBLOP)
             11831                                                 ->OUT$BLK.SUBLK$(0),KS$HNDLR.HNDLRFID);

  11831  5 000432   000160 236000 2                  LDQ     HANDLER$
         5 000433   200242 756100                    STQ     @PTR$+1,,AUTO
         5 000434   100003 633500                    EPPR3   3,,PR1
         5 000435   200241 453500                    STP3    HANDNR+2,,AUTO
         5 000436   003741 701000 5                  TSX1    ALTER_FID
         5 000437   000000 011000                    NOP     0
         5 000440   000604 710000 5                  TRA     s:11897

     1229    11832
     1230    11833        /**/
     1231    11834        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:256  
     1232    11835    9                                      CASE(%KS_HANDREM);

     1233    11836    9                                         IF HNDLRX ~= KS_FEPHNDLR.NHANDLERS-1 THEN

  11836  5 000441   000374 236000 2                  LDQ     KS_FEPHNDLR
         5 000442   000001 136007                    SBLQ    1,DL
         5 000443   000446 604000 5                  TMI     s:11838
         5 000444   200013 116100                    CMPQ    HNDLRX,,AUTO
         5 000445   000467 600000 5                  TZE     s:11844

     1234    11837   10                                            DO; /* search to delete handler */

     1235    11838   11                                            DO K = HNDLRX TO KS_FEPHNDLR.NHANDLERS-1;

  11838  5 000446   200013 235100                    LDA     HNDLRX,,AUTO
         5 000447   200103 755100                    STA     K,,AUTO
         5 000450   000464 710000 5                  TRA     s:11841+2

     1236    11839   11                                               KS_FEPHNDLR.HANDLER(K) = KS_FEPHNDLR.
             11839                                                        HANDLER(K+1);

  11839  5 000451   200103 235100                    LDA     K,,AUTO
         5 000452   000001 735000                    ALS     1
         5 000453   000000 620005                    EAX0    0,AL
         5 000454   000402 237005 2                  LDAQ    KS_FEPHNDLR+6,AL
         5 000455   000400 757010 2                  STAQ    KS_FEPHNDLR+4,X0

     1237    11840   11                                               KS_FEPHNDLR.BOOTIME(K) = KS_FEPHNDLR.
             11840                                                        BOOTIME(K+1);

  11840  5 000456   200103 235100                    LDA     K,,AUTO
         5 000457   003005 060405                    CSL     bolr='003'O
         5 000460   000377 010001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=1,n=1
         5 000461   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1

     1238    11841   11                                             END; /* if hndlrx ~= nhandlers */

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:257  
  11841  5 000462   000001 035007                    ADLA    1,DL
         5 000463   200103 755100                    STA     K,,AUTO
         5 000464   200103 236100                    LDQ     K,,AUTO
         5 000465   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 000466   000451 602000 5                  TNC     s:11839

     1239    11842   10                                             END;  /* not last handler */

     1240    11843
     1241    11844    9                                          KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1)
             11844                                                   = ' ';

  11844  5 000467   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000470   000001 735000                    ALS     1
         5 000471   000000 620005                    EAX0    0,AL
         5 000472   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000473   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000474   000376 757010 2                  STAQ    KS_FEPHNDLR+2,X0

     1242    11845    9                                         KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS
             11845                                                   -1;

  11845  5 000475   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000476   000001 135007                    SBLA    1,DL
         5 000477   000374 755000 2                  STA     KS_FEPHNDLR

     1243    11846
     1244    11847             /*
     1245    11848
     1246    11849             */
     1247    11850    9                                            KS_HANDLER_KEY.HNDLR = HANDLERNAME;

  11850  5 000500   040000 100500                    MLR     fill='040'O
         5 000501   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000502   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1248    11851    9                                            KS_HANDLER_KEY.NODE = KS_NODE;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:258  

  11851  5 000503   000000 236000 xsym               LDQ     KS_NODE
         5 000504   000011 736000                    QLS     9
         5 000505   000307 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1249    11852    9                                           DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY)
             11852                                                     ;

  11852  5 000506   000016 237000 6                  LDAQ    14
         5 000507   001330 757000 2                  STAQ    DELREC_NETCON+2

     1250    11853    9                                            CALL M$DELREC(DELREC_NETCON) WHENALTRETURN

  11853  5 000510   001326 630400 2                  EPPR0   DELREC_NETCON
         5 000511   440002 713400                    CLIMB   alt,+16386
         5 000512   401400 401760                    pmme    nvectors=4
         5 000513   000515 702000 5                  TSX2    s:11857
         5 000514   000515 710000 5                  TRA     s:11857

     1251    11854   10                                               DO;

     1252    11855                                                    /*N* yeah, so do what  */
     1253    11856   10                                               END;

     1254    11857    9                    KS_DEFAULT_KEY.NODE = KS_NODE;

  11857  5 000515   000000 236000 xsym               LDQ     KS_NODE
         5 000516   000011 736000                    QLS     9
         5 000517   000221 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

     1255    11858    9                    KS_DEFAULT_KEY.HNDLR = HANDLERNAME;

  11858  5 000520   040000 100500                    MLR     fill='040'O
         5 000521   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000522   000221 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     1256    11859    9                    DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:259  

  11859  5 000523   000012 237000 6                  LDAQ    10
         5 000524   001330 757000 2                  STAQ    DELREC_NETCON+2

     1257    11860    9                    CALL M$DELREC (DELREC_NETCON);

  11860  5 000525   001326 630400 2                  EPPR0   DELREC_NETCON
         5 000526   040002 713400                    CLIMB   16386
         5 000527   401400 401760                    pmme    nvectors=4

     1258    11861
     1259    11862   10                    IF ~HNDLREXISTS THEN DO;

  11862  5 000530   200010 236100                    LDQ     HNDLREXISTS,,AUTO
         5 000531   400000 376003                    ANQ     -131072,DU
         5 000532   400000 676003                    ERQ     -131072,DU
         5 000533   000551 600000 5                  TZE     s:11870

     1260    11863   10                       KS_SUB_BUF_1.TEXT = HANDLERNAME;

  11863  5 000534   040000 100500                    MLR     fill='040'O
         5 000535   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000536   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1261    11864   10                       KS_SUB_BUF_1.COUNT = SIZEC(HANDLERNAME);

  11864  5 000537   010000 236003                    LDQ     4096,DU
         5 000540   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1262    11865   10                       KS_SUB_BUF_2.TEXT = KS_NODENAME;

  11865  5 000541   040000 100400                    MLR     fill='040'O
         5 000542   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 000543   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     1263    11866   10                       KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:260  
  11866  5 000544   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     1264    11867   10                      CALL KSE$ERRMSG (%E$KS_HAND_NOT_DEF,VECTOR(KS_SUB_BUF_1),VECTOR(
             11867                                KS_SUB_BUF_2));

  11867  5 000545   000027 630400 6                  EPPR0   23
         5 000546   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000547   000000 701000 xent               TSX1    KSE$ERRMSG
         5 000550   000000 011000                    NOP     0

     1265    11868   10                    END;

     1266    11869
     1267    11870    9                                         EXIT SETCODE;  /* prevents rewritting the

  11870  5 000551   000717 710000 5                  TRA     s:11924

     1268    11871                                                              ks$hndlr record to :netcon */
     1269    11872        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:261  
     1270    11873    9                                      CASE(%KS_HANDBT);

     1271    11874    9                                         IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11874                                                  SUBLK$(0)->OUT$BLK.CODE = %KS_YES THEN

  11874  5 000552   100003 473500                    LDP3    3,,PR1
         5 000553   300000 722100                    LXL2    0,,PR3
         5 000554   000002 102003                    CMPX2   2,DU
         5 000555   000563 601000 5                  TNZ     s:11877

     1272    11875    9                                            KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;

  11875  5 000556   200013 235100                    LDA     HNDLRX,,AUTO
         5 000557   003005 060400                    CSL     bolr='003'O
         5 000560   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000561   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1
         5 000562   000604 710000 5                  TRA     s:11897

     1273    11876    9                                         ELSE
     1274    11877    9                                            KS_FEPHNDLR.BOOTIME(HNDLRX) = '0'B;

  11877  5 000563   200013 235100                    LDA     HNDLRX,,AUTO
         5 000564   003005 060400                    CSL     bolr='003'O
         5 000565   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 000566   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1
         5 000567   000604 710000 5                  TRA     s:11897

     1275    11878        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:262  
     1276    11879    9                                      CASE(%KS_HANDDEF);

     1277    11880    9                                         IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11880                                                  NSUBLKS = 0 THEN

  11880  5 000570   100001 222100                    LDX2    1,,PR1
         5 000571   000575 601000 5                  TNZ     s:11883

     1278    11881    9                                            CALL RESET_PARAMS_TO_DEFAULTS;

  11881  5 000572   004103 701000 5                  TSX1    RESET_PARAMS_TO_DEFAULTS
         5 000573   000000 011000                    NOP     0
         5 000574   000604 710000 5                  TRA     s:11897

     1279    11882    9                                         ELSE
     1280    11883    9                                           IF SUBLK$->OUT$BLK.SUBLK$(SUBLOP)->OUT$BLK.
             11883                                                     SUBLK$(0)->

  11883  5 000575   100003 473500                    LDP3    3,,PR1
         5 000576   300003 474500                    LDP4    3,,PR3
         5 000577   400000 723100                    LXL3    0,,PR4
         5 000600   000002 103003                    CMPX3   2,DU
         5 000601   000604 601000 5                  TNZ     s:11897

     1281    11884    9                                               OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %
             11884                                                        KS_YES THEN
     1282    11885    9                                               CALL RESET_PARAMS_TO_DEFAULTS;

  11885  5 000602   004103 701000 5                  TSX1    RESET_PARAMS_TO_DEFAULTS
         5 000603   000000 011000                    NOP     0

     1283    11886    9                                      END;  /* do case sublk$->out$blk...code */

     1284    11887        /**/
     1285    11888
     1286    11889
     1287    11890
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:263  
     1288    11891        /*
     1289    11892
     1290    11893                   COMMENT
     1291    11894        */
     1292    11895
     1293    11896
     1294    11897    8                                   END; /* 13 sublop = 1 to nsublks */

  11897  5 000604   200136 235100                    LDA     SUBLOP,,AUTO
         5 000605   000001 035007                    ADLA    1,DL
         5 000606   200136 755100                    STA     SUBLOP,,AUTO
         5 000607   200135 470500                    LDP0    SUBLK$,,AUTO
         5 000610   000001 236100                    LDQ     1,,PR0
         5 000611   000022 772000                    QRL     18
         5 000612   200136 116100                    CMPQ    SUBLOP,,AUTO
         5 000613   000615 600000 5                  TZE     s:11898
         5 000614   000413 603000 5                  TRC     s:11828

     1295    11898    7                                   END;  /* 12 if nsublks >1 */

  11898  5 000615   000636 710000 5                  TRA     s:11907

     1296    11899    6                                ELSE
     1297    11900    7                                   DO;  /* 15 # sublks = 1 */

     1298    11901    7                                   KS$HNDLR.HNDLRFID = HANDLERNAME;

  11901  5 000616   000160 471400 2                  LDP1    HANDLER$
         5 000617   040100 100500                    MLR     fill='040'O
         5 000620   200155 000010                    ADSC9   HANDLERNAME,,AUTO        cn=0,n=8
         5 000621   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

     1299    11902    7                                   CALL INDEX (INDX,' ',KS$HNDLR.HNDLRFID);

  11902  5 000622   000000 124500                    SCM     mask='000'O
         5 000623   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
         5 000624   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:264  
         5 000625   200017 000100                    ARG     INDX,,AUTO

     1300    11903    7                                   SUBSTR(KS$HNDLR.HNDLRFID,INDX,5) = '.:SYS';

  11903  5 000626   200017 235100                    LDA     INDX,,AUTO
         5 000627   040105 100400                    MLR     fill='040'O
         5 000630   000073 000005 1                  ADSC9   FEP+5                    cn=0,n=5
         5 000631   100000 000005                    ADSC9   0,A,PR1                  cn=0,n=5

     1301    11904    7                                   KS_FEPHNDLR.BOOTIME(HNDLRX) = '1'B;

  11904  5 000632   200013 236100                    LDQ     HNDLRX,,AUTO
         5 000633   003006 060400                    CSL     bolr='003'O
         5 000634   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000635   000377 000001 2                  BDSC    KS_FEPHNDLR+3,Q          by=0,bit=0,n=1

     1302    11905    7                                   END;

     1303    11906        /**/
     1304    11907    7                                IF KS$HNDLR.NPARAMI > 0 THEN DO;

  11907  5 000636   000160 470400 2                  LDP0    HANDLER$
         5 000637   000014 236100                    LDQ     12,,PR0
         5 000640   000777 316007                    CANQ    511,DL
         5 000641   000660 600000 5                  TZE     s:11912

     1305    11908    7                                    PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.
             11908                                             OFFSET(KS$HNDLR.NPARAMI-1));

  11908  5 000642   000014 720100                    LXL0    12,,PR0
         5 000643   000777 360003                    ANX0    511,DU
         5 000644   000033 221110                    LDX1    27,X0,PR0
         5 000645   000013 631411 2                  EPPR1   HNDLR_BUF,X1
         5 000646   200147 451500                    STP1    PTR$,,AUTO

     1306    11909    7                                   PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(
             11909                                            KS$HNDLR.NPARAMI - 1) + 2)/2);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:265  

  11909  5 000647   000032 236110                    LDQ     26,X0,PR0
         5 000650   000011 772000                    QRL     9
         5 000651   000777 376007                    ANQ     511,DL
         5 000652   000002 036007                    ADLQ    2,DL
         5 000653   000001 772000                    QRL     1
         5 000654   000022 736000                    QLS     18
         5 000655   200147 036100                    ADLQ    PTR$,,AUTO
         5 000656   200147 756100                    STQ     PTR$,,AUTO

     1307    11910    7                                   END;

  11910  5 000657   000664 710000 5                  TRA     s:11915

     1308    11911    7                                ELSE DO;

     1309    11912    7                                   PTR$ = ADDR(HNDLR_BUF);

  11912  5 000660   000021 236000 6                  LDQ     17
         5 000661   200147 756100                    STQ     PTR$,,AUTO

     1310    11913    7                                   PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);

  11913  5 000662   000037 036003                    ADLQ    31,DU
         5 000663   200147 756100                    STQ     PTR$,,AUTO

     1311    11914    7                                   END;

     1312    11915    6                                WRITE_NETCON.BUF_ = VECTOR(HNDLR_BUF);

  11915  5 000664   000020 237000 6                  LDAQ    16
         5 000665   001316 757000 2                  STAQ    WRITE_NETCON+4

     1313    11916    6                                WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  11916  5 000666   000016 237000 6                  LDAQ    14
         5 000667   001314 757000 2                  STAQ    WRITE_NETCON+2
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:266  

     1314    11917    6                                KS_HANDLER_KEY.NODE = KS_NODE;

  11917  5 000670   000000 236000 xsym               LDQ     KS_NODE
         5 000671   000011 736000                    QLS     9
         5 000672   000307 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1315    11918    6                                KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(HNDLRX);

  11918  5 000673   200013 236100                    LDQ     HNDLRX,,AUTO
         5 000674   000003 736000                    QLS     3
         5 000675   040000 100406                    MLR     fill='040'O
         5 000676   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,Q          cn=0,n=8
         5 000677   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1316    11919    6                               WRITE_NETCON.BUF_.BOUND = POFFC(PTR$,ADDR(HNDLR_BUF)) -
             11919                                         1;

  11919  5 000700   000021 236000 6                  LDQ     17
         5 000701   000020 772000                    QRL     16
         5 000702   200244 756100                    STQ     @TARGET+2,,AUTO
         5 000703   200147 236100                    LDQ     PTR$,,AUTO
         5 000704   000020 772000                    QRL     16
         5 000705   200244 136100                    SBLQ    @TARGET+2,,AUTO
         5 000706   000001 136007                    SBLQ    1,DL
         5 000707   000020 736000                    QLS     16
         5 000710   001316 676000 2                  ERQ     WRITE_NETCON+4
         5 000711   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000712   001316 656000 2                  ERSQ    WRITE_NETCON+4

     1317    11920    6                                CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);

  11920  5 000713   001312 630400 2                  EPPR0   WRITE_NETCON
         5 000714   440001 713400                    CLIMB   alt,write
         5 000715   401400 401760                    pmme    nvectors=4
         5 000716   003344 702000 5                  TSX2    SET_ERR

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:267  
     1318    11921        /**/
     1319    11922
     1320    11923    6                       END;  /* do case (tmp$->out$blk.code) */

     1321    11924    5                    END;    /* do SCNOPTS = 0 to nsublks at set boot level 2*/

  11924  5 000717   200134 235100                    LDA     SCNOPTS,,AUTO
         5 000720   000001 035007                    ADLA    1,DL
         5 000721   200134 755100                    STA     SCNOPTS,,AUTO
         5 000722   200145 470500                    LDP0    BLK$,,AUTO
         5 000723   000001 236100                    LDQ     1,,PR0
         5 000724   000022 772000                    QRL     18
         5 000725   200134 116100                    CMPQ    SCNOPTS,,AUTO
         5 000726   000730 600000 5                  TZE     s:11925
         5 000727   000060 603000 5                  TRC     s:11745

     1322    11925    4                    I = 0;

  11925  5 000730   200016 450100                    STZ     I,,AUTO

     1323    11926    4                    L = KS_FEPHNDLR.NHANDLERS;

  11926  5 000731   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000732   200124 755100                    STA     L,,AUTO

     1324    11927    5                    DO WHILE (I <= L-2);

  11927  5 000733   001000 710000 5                  TRA     s:11942

     1325    11928    5                       IF KS_FEPHNDLR.HANDLER(I) = ' ' THEN

  11928  5 000734   200016 235100                    LDA     I,,AUTO
         5 000735   000001 735000                    ALS     1
         5 000736   000400 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         5 000737   000032 117000 6                  CMPAQ   26
         5 000740   000775 601000 5                  TNZ     s:11941

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:268  
     1326    11929    6                          DO;

     1327    11930        /*
     1328    11931                if a blank exists in the handler list delete it, move the handlers
     1329    11932                up and decrement nhandlers.
     1330    11933        */
     1331    11934    7                          DO J = I TO KS_FEPHNDLR.NHANDLERS-2;

  11934  5 000741   200016 235100                    LDA     I,,AUTO
         5 000742   200102 755100                    STA     J,,AUTO
         5 000743   000757 710000 5                  TRA     s:11937+2

     1332    11935    7                             KS_FEPHNDLR.HANDLER(J) = KS_FEPHNDLR.HANDLER(J+1);

  11935  5 000744   200102 235100                    LDA     J,,AUTO
         5 000745   000001 735000                    ALS     1
         5 000746   000000 620005                    EAX0    0,AL
         5 000747   000402 237005 2                  LDAQ    KS_FEPHNDLR+6,AL
         5 000750   000400 757010 2                  STAQ    KS_FEPHNDLR+4,X0

     1333    11936    7                             KS_FEPHNDLR.BOOTIME(J) = KS_FEPHNDLR.BOOTIME(J+1);

  11936  5 000751   200102 235100                    LDA     J,,AUTO
         5 000752   003005 060405                    CSL     bolr='003'O
         5 000753   000377 010001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=1,n=1
         5 000754   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1

     1334    11937    7                          END;

  11937  5 000755   000001 035007                    ADLA    1,DL
         5 000756   200102 755100                    STA     J,,AUTO
         5 000757   000374 236000 2                  LDQ     KS_FEPHNDLR
         5 000760   000002 136007                    SBLQ    2,DL
         5 000761   000764 604000 5                  TMI     s:11938
         5 000762   200102 116100                    CMPQ    J,,AUTO
         5 000763   000744 603000 5                  TRC     s:11935

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:269  
     1335    11938    6                          KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1) = ' ';

  11938  5 000764   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000765   000001 735000                    ALS     1
         5 000766   000000 620005                    EAX0    0,AL
         5 000767   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000770   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000771   000376 757010 2                  STAQ    KS_FEPHNDLR+2,X0

     1336    11939    6                          KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS - 1;

  11939  5 000772   000374 235000 2                  LDA     KS_FEPHNDLR
         5 000773   000001 135007                    SBLA    1,DL
         5 000774   000374 755000 2                  STA     KS_FEPHNDLR

     1337    11940    6                          END;

     1338    11941    5                    I = I + 1;

  11941  5 000775   200016 235100                    LDA     I,,AUTO
         5 000776   000001 035007                    ADLA    1,DL
         5 000777   200016 755100                    STA     I,,AUTO

     1339    11942    5                    END;  /* do while  */

  11942  5 001000   200124 236100                    LDQ     L,,AUTO
         5 001001   000002 136007                    SBLQ    2,DL
         5 001002   001005 604000 5                  TMI     s:11943
         5 001003   200016 116100                    CMPQ    I,,AUTO
         5 001004   000734 603000 5                  TRC     s:11928

     1340    11943    4                    IF KS_FEPHNDLR.HANDLER(KS_FEPHNDLR.NHANDLERS-1) = ' ' THEN

  11943  5 001005   000374 235000 2                  LDA     KS_FEPHNDLR
         5 001006   000001 735000                    ALS     1
         5 001007   000376 237005 2                  LDAQ    KS_FEPHNDLR+2,AL
         5 001010   000032 117000 6                  CMPAQ   26
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:270  
         5 001011   001015 601000 5                  TNZ     s:11946

     1341    11944    4                       KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS-1;

  11944  5 001012   000374 235000 2                  LDA     KS_FEPHNDLR
         5 001013   000001 135007                    SBLA    1,DL
         5 001014   000374 755000 2                  STA     KS_FEPHNDLR

     1342    11945
     1343    11946    4                    IF KS_FEPHNDLR.HANDLER(0) ~= 'NODEADMN' THEN

  11946  5 001015   040000 106400                    CMPC    fill='040'O
         5 001016   000400 000010 2                  ADSC9   KS_FEPHNDLR+4            cn=0,n=8
         5 001017   000075 000010 1                  ADSC9   FEP+7                    cn=0,n=8
         5 001020   001025 600000 5                  TZE     s:11953

     1344    11947    4                       CALL KSE$ERRMSG (%E$KS_NODEADMN_NOT_FIRST);

  11947  5 001021   000035 630400 6                  EPPR0   29
         5 001022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001023   000000 701000 xent               TSX1    KSE$ERRMSG
         5 001024   000000 011000                    NOP     0

     1345    11948
     1346    11949
     1347    11950
     1348    11951
     1349    11952        /**/
     1350    11953    4                    KS_FEPHNDLR_KEY.NODE = KS_NODE;

  11953  5 001025   000000 236000 xsym               LDQ     KS_NODE
         5 001026   000011 736000                    QLS     9
         5 001027   000452 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

     1351    11954    4                    WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);

  11954  5 001030   000002 237000 6                  LDAQ    2
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:271  
         5 001031   001316 757000 2                  STAQ    WRITE_NETCON+4

     1352    11955    4                    WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  11955  5 001032   000004 237000 6                  LDAQ    4
         5 001033   001314 757000 2                  STAQ    WRITE_NETCON+2

     1353    11956    4                    WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) +

  11956  5 001034   000374 236000 2                  LDQ     KS_FEPHNDLR
         5 001035   000003 736000                    QLS     3
         5 001036   000017 036007                    ADLQ    15,DL
         5 001037   000020 736000                    QLS     16
         5 001040   001316 676000 2                  ERQ     WRITE_NETCON+4
         5 001041   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001042   001316 656000 2                  ERSQ    WRITE_NETCON+4

     1354    11957    4                                              SIZEC(KS_FEPHNDLR.DEFLIBACCT) +
     1355    11958    4                                               4 + /* bootime bits */
     1356    11959    4                                              (SIZEC(KS_FEPHNDLR.HANDLER(0)) *
     1357    11960    4                                              KS_FEPHNDLR.NHANDLERS) - 1;
     1358    11961    4                    CALL M$WRITE(WRITE_NETCON) ALTRET(SET_ERR);

  11961  5 001043   001312 630400 2                  EPPR0   WRITE_NETCON
         5 001044   440001 713400                    CLIMB   alt,write
         5 001045   401400 401760                    pmme    nvectors=4
         5 001046   003344 702000 5                  TSX2    SET_ERR

     1359    11962    4                    END;   /* sublks on set boot command 1 */

  11962  5 001047   003726 710000 5                  TRA     END_LOOP

     1360    11963    3                  ELSE
     1361    11964        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:272  
     1362    11965
     1363    11966            /* no options on the SET BOOT command - the old style (prompted)*/
     1364    11967
     1365    11968    3   PROMPTED_SET_BOOT:
     1366    11969    4        DO;

  11969  5 001050                       PROMPTED_SE* null
     1367    11970    4           KS_FEPBOOT_KEY.NODE = KS_NODE;

  11970  5 001050   000000 236000 xsym               LDQ     KS_NODE
         5 001051   000011 736000                    QLS     9
         5 001052   000344 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

     1368    11971    4           KS_FEPHNDLR_KEY.NODE = KS_NODE;

  11971  5 001053   000000 236000 xsym               LDQ     KS_NODE
         5 001054   000011 736000                    QLS     9
         5 001055   000452 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

     1369    11972    4           KS_HANDLER_KEY.NODE = KS_NODE;

  11972  5 001056   000000 236000 xsym               LDQ     KS_NODE
         5 001057   000011 736000                    QLS     9
         5 001060   000307 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1370    11973    4           KS_SUB_BUF_1.COUNT = SIZEC('BOOTINFO');

  11973  5 001061   010000 236003                    LDQ     4096,DU
         5 001062   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1371    11974    4           KS_SUB_BUF_1.TEXT = 'BOOTINFO';

  11974  5 001063   040000 100400                    MLR     fill='040'O
         5 001064   000077 000010 1                  ADSC9   FEP+9                    cn=0,n=8
         5 001065   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1372    11975
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:273  
     1373    11976             /* change monitor fid in KS_FEPBOOT record */
     1374    11977
     1375    11978    4   MONFID: CALL KSU$READ_NETCON (VECTOR(KS_FEPBOOT_KEY),

  11978  5 001066   000036 630400 6     MONFID       EPPR0   30
         5 001067   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001070   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 001071   003344 702000 5                  TSX2    SET_ERR

     1376    11979    4                                 VECTOR(KS_FEPBOOT)) ALTRET (SET_ERR);
     1377    11980
     1378    11981             /* strip blanks from end of monitor fid,print it, */
     1379    11982             /*if a new fid is entered, change it and write out new FEPBOOT*/
     1380    11983
     1381    11984    4           CALL INDEX (J,' ',KS_FEPBOOT.BOOTFID) WHENALTRETURN

  11984  5 001072   000000 124400                    SCM     mask='000'O
         5 001073   000312 000050 2                  ADSC9   KS_FEPBOOT               cn=0,n=40
         5 001074   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001075   200102 000100                    ARG     J,,AUTO
         5 001076   001100 606400 5                  TTN     s:11986
         5 001077   001102 710000 5                  TRA     s:11988

     1382    11985    5              DO;

     1383    11986    5                 J = SIZEC(KS_FEPBOOT.BOOTFID);

  11986  5 001100   000050 235007                    LDA     40,DL
         5 001101   200102 755100                    STA     J,,AUTO

     1384    11987    5              END;

     1385    11988    4           TEXTC.COUNT = J;

  11988  5 001102   200102 236100                    LDQ     J,,AUTO
         5 001103   000033 736000                    QLS     27
         5 001104   000000 552040 2                  STBQ    TEXTC,'40'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:274  

     1386    11989    4           TEXTC.TEXT = SUBSTR(KS_FEPBOOT.BOOTFID,0,J);

  11989  5 001105   200102 720100                    LXL0    J,,AUTO
         5 001106   040000 100440                    MLR     fill='040'O
         5 001107   000312 000010 2                  ADSC9   KS_FEPBOOT               cn=0,n=*X0
         5 001110   000000 200050 2                  ADSC9   TEXTC                    cn=1,n=40

     1387    11990    4           CALL KSW$WRITE(VECTOR(MONFID),VECTOR(TEXTC));

  11990  5 001111   000044 630400 6                  EPPR0   36
         5 001112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001113   000000 701000 xent               TSX1    KSW$WRITE
         5 001114   000000 011000                    NOP     0

     1388    11991    4           CALL XUR$GETCMD(KS_FID,TOP2$,VECTOR(EQUALS));

  11991  5 001115   000050 236000 6                  LDQ     40
         5 001116   200246 756100                    STQ     @TARGET+4,,AUTO
         5 001117   200146 630500                    EPPR0   TOP2$,,AUTO
         5 001120   200245 450500                    STP0    @TARGET+3,,AUTO
         5 001121   000051 236000 6                  LDQ     41
         5 001122   200244 756100                    STQ     @TARGET+2,,AUTO
         5 001123   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 001124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001125   000000 701000 xent               TSX1    XUR$GETCMD
         5 001126   000000 011000                    NOP     0

     1389    11992    4           IF TOP2$->OUT$BLK2.NSUBLKS ~= 0 THEN

  11992  5 001127   200146 470500                    LDP0    TOP2$,,AUTO
         5 001130   000001 220100                    LDX0    1,,PR0
         5 001131   001144 600000 5                  TZE     NHNDLRS

     1390    11993    5              DO;

     1391    11994    5                 CALL ALTER_FID (TOP2$,KS_FEPBOOT.BOOTFID);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:275  

  11994  5 001132   000007 236000 6                  LDQ     7
         5 001133   200242 756100                    STQ     @PTR$+1,,AUTO
         5 001134   200146 631500                    EPPR1   TOP2$,,AUTO
         5 001135   200241 451500                    STP1    HANDNR+2,,AUTO
         5 001136   003741 701000 5                  TSX1    ALTER_FID
         5 001137   000000 011000                    NOP     0

     1392    11995    5                 CALL KSU$WRITE_NETCON (VECTOR(KS_FEPBOOT_KEY),

  11995  5 001140   000036 630400 6                  EPPR0   30
         5 001141   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001142   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         5 001143   003344 702000 5                  TSX2    SET_ERR

     1393    11996    5                    VECTOR(KS_FEPBOOT)) ALTRET (SET_ERR);
     1394    11997    5              END;

     1395    11998                /* Change Handler information */
     1396    11999
     1397    12000         /* Get the number of handlers - read FEPHANDLER record and save the number and the
             12000        names */
     1398    12001
     1399    12002    4   NHNDLRS:
     1400    12003    4           CALL KSU$READ_NETCON (VECTOR(KS_FEPHNDLR_KEY),

  12003  5 001144   000052 630400 6     NHNDLRS      EPPR0   42
         5 001145   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001146   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 001147   003344 702000 5                  TSX2    SET_ERR

     1401    12004    4                                 VECTOR(KS_FEPHNDLR)) ALTRET (SET_ERR);
     1402    12005    4           OLD_NRHAND = KS_FEPHNDLR.NHANDLERS;

  12005  5 001150   000374 235000 2                  LDA     KS_FEPHNDLR
         5 001151   200232 755100                    STA     OLD_NRHAND,,AUTO

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:276  
     1403    12006    4           OLD_HANDLER = KS_FEPHNDLR.HANDLER;

  12006  5 001152   000100 100400                    MLR     fill='000'O
         5 001153   000400 000250 2                  ADSC9   KS_FEPHNDLR+4            cn=0,n=168
         5 001154   200157 000250                    ADSC9   OLD_HANDLER,,AUTO        cn=0,n=168

     1404    12007    4           OLD_BOOTIME = KS_FEPHNDLR.BOOTIME;

  12007  5 001155   000377 236000 2                  LDQ     KS_FEPHNDLR+3
         5 001156   200231 676100                    ERQ     OLD_BOOTIME,,AUTO
         5 001157   000054 376000 6                  ANQ     44
         5 001160   200231 656100                    ERSQ    OLD_BOOTIME,,AUTO

     1405    12008
     1406    12009             /* Prompt for a new number of handlers - if changed put in record*/
     1407    12010
     1408    12011    4           CALL KSW$WRITE(VECTOR(NHNDLRS),VECTOR(KS_FEPHNDLR.NHANDLERS));

  12011  5 001161   000062 630400 6                  EPPR0   50
         5 001162   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001163   000000 701000 xent               TSX1    KSW$WRITE
         5 001164   000000 011000                    NOP     0

     1409    12012    4           CALL XUR$GETCMD(KS_NRHAND,TOP2$,VECTOR(EQUALS));

  12012  5 001165   000050 236000 6                  LDQ     40
         5 001166   200246 756100                    STQ     @TARGET+4,,AUTO
         5 001167   200146 630500                    EPPR0   TOP2$,,AUTO
         5 001170   200245 450500                    STP0    @TARGET+3,,AUTO
         5 001171   000055 236000 6                  LDQ     45
         5 001172   200244 756100                    STQ     @TARGET+2,,AUTO
         5 001173   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 001174   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001175   000000 701000 xent               TSX1    XUR$GETCMD
         5 001176   000000 011000                    NOP     0

     1410    12013    4           IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:277  

  12013  5 001177   200146 470500                    LDP0    TOP2$,,AUTO
         5 001200   000001 220100                    LDX0    1,,PR0
         5 001201   001212 600000 5                  TZE     CHANGE_HANDLERS

     1411    12014    4              CALL CHARBIN (KS_FEPHNDLR.NHANDLERS,TOP2$->OUT$SYM.TEXT);

  12014  5 001202   000004 236100                    LDQ     4,,PR0
         5 001203   000033 772000                    QRL     27
         5 001204   000000 621006                    EAX1    0,QL
         5 001205   000100 305540                    DTB
         5 001206   000004 230011                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X1
         5 001207   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 001210   200245 235100                    LDA     @TARGET+3,,AUTO
         5 001211   000374 755000 2                  STA     KS_FEPHNDLR

     1412    12015
     1413    12016        /* Prompt for changes to the names and fids for the number of handlers just entered
             12016         */
     1414    12017
     1415    12018    4   CHANGE_HANDLERS:
     1416    12019    5           DO J = 0 TO KS_FEPHNDLR.NHANDLERS - 1;

  12019  5 001212   200102 450100       CHANGE_HAND* STZ     J,,AUTO
         5 001213   001546 710000 5                  TRA     s:12091+3

     1417    12020    5              HANDNR = J + 1;

  12020  5 001214   200102 235100                    LDA     J,,AUTO
         5 001215   000001 035007                    ADLA    1,DL
         5 001216   200237 755100                    STA     HANDNR,,AUTO

     1418    12021    5              RECORD_CHANGED = '0'B;

  12021  5 001217   200234 450100                    STZ     RECORD_CHANGED,,AUTO

     1419    12022    5              CALL INDEX (K,' ',KS_FEPHNDLR.HANDLER(J));
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:278  

  12022  5 001220   200102 236100                    LDQ     J,,AUTO
         5 001221   000003 736000                    QLS     3
         5 001222   000000 124406                    SCM     mask='000'O
         5 001223   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,Q          cn=0,n=8
         5 001224   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001225   200103 000100                    ARG     K,,AUTO

     1420    12023    5              TEXTC.COUNT = K;

  12023  5 001226   200103 236100                    LDQ     K,,AUTO
         5 001227   000033 736000                    QLS     27
         5 001230   000000 552040 2                  STBQ    TEXTC,'40'O

     1421    12024    5              TEXTC.TEXT = SUBSTR(KS_FEPHNDLR.HANDLER(J),0,K);

  12024  5 001231   200102 236100                    LDQ     J,,AUTO
         5 001232   000003 736000                    QLS     3
         5 001233   200103 720100                    LXL0    K,,AUTO
         5 001234   040000 100446                    MLR     fill='040'O
         5 001235   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,Q          cn=0,n=*X0
         5 001236   000000 200050 2                  ADSC9   TEXTC                    cn=1,n=40

     1422    12025    5              CALL KSW$WRITE (VECTOR(HNDLRNAME),VECTOR(HANDNR),VECTOR(TEXTC));

  12025  5 001237   777640 235007                    LDA     -96,DL
         5 001240   200244 452500                    STP2    @TARGET+2,,AUTO
         5 001241   200244 236100                    LDQ     @TARGET+2,,AUTO
         5 001242   000237 036003                    ADLQ    159,DU
         5 001243   200246 757100                    STAQ    @TARGET+4,,AUTO
         5 001244   000045 236000 6                  LDQ     37
         5 001245   200252 756100                    STQ     @TARGET+8,,AUTO
         5 001246   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 001247   200251 450500                    STP0    @TARGET+7,,AUTO
         5 001250   000066 236000 6                  LDQ     54
         5 001251   200250 756100                    STQ     @TARGET+6,,AUTO
         5 001252   200250 630500                    EPPR0   @TARGET+6,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:279  
         5 001253   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001254   000000 701000 xent               TSX1    KSW$WRITE
         5 001255   000000 011000                    NOP     0

     1423    12026    5              CALL XUR$GETCMD(KS_HAND,TOP2$,VECTOR(EQUALS));

  12026  5 001256   000050 236000 6                  LDQ     40
         5 001257   200246 756100                    STQ     @TARGET+4,,AUTO
         5 001260   200146 630500                    EPPR0   TOP2$,,AUTO
         5 001261   200245 450500                    STP0    @TARGET+3,,AUTO
         5 001262   000067 236000 6                  LDQ     55
         5 001263   200244 756100                    STQ     @TARGET+2,,AUTO
         5 001264   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 001265   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001266   000000 701000 xent               TSX1    XUR$GETCMD
         5 001267   000000 011000                    NOP     0

     1424    12027    5              IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN

  12027  5 001270   200146 470500                    LDP0    TOP2$,,AUTO
         5 001271   000001 220100                    LDX0    1,,PR0
         5 001272   001304 600000 5                  TZE     s:12029

     1425    12028    5                 KS_FEPHNDLR.HANDLER(J) = TOP2$->OUT$SYM.TEXT;

  12028  5 001273   200102 235100                    LDA     J,,AUTO
         5 001274   000001 735000                    ALS     1
         5 001275   000004 236100                    LDQ     4,,PR0
         5 001276   000033 772000                    QRL     27
         5 001277   000002 735000                    ALS     2
         5 001300   000000 621006                    EAX1    0,QL
         5 001301   040005 100540                    MLR     fill='040'O
         5 001302   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         5 001303   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8

     1426    12029    5              KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:280  
  12029  5 001304   200102 235100                    LDA     J,,AUTO
         5 001305   000003 735000                    ALS     3
         5 001306   040000 100405                    MLR     fill='040'O
         5 001307   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         5 001310   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1427    12030             /* Search for handler on old handler list,If found - read record*/
     1428    12031             /* If not found - create a handler record */
     1429    12032
     1430    12033    5              HANDLER_FOUND = '0'B;

  12033  5 001311   200235 450100                    STZ     HANDLER_FOUND,,AUTO

     1431    12034    5   FIND_HANDLER:
     1432    12035    6              DO K = 0 TO OLD_NRHAND - 1;

  12035  5 001312   200103 450100       FIND_HANDLER STZ     K,,AUTO
         5 001313   001332 710000 5                  TRA     s:12041+3

     1433    12036    6                 IF KS_FEPHNDLR.HANDLER(J) = OLD_HANDLER(K) THEN

  12036  5 001314   200102 235100                    LDA     J,,AUTO
         5 001315   000003 735000                    ALS     3
         5 001316   200103 236100                    LDQ     K,,AUTO
         5 001317   000003 736000                    QLS     3
         5 001320   040106 106405                    CMPC    fill='040'O
         5 001321   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         5 001322   200157 000010                    ADSC9   OLD_HANDLER,Q,AUTO       cn=0,n=8
         5 001323   001327 601000 5                  TNZ     s:12041

     1434    12037    7                    DO;

     1435    12038    7                       HANDLER_FOUND = '1'B;

  12038  5 001324   400000 236003                    LDQ     -131072,DU
         5 001325   200235 756100                    STQ     HANDLER_FOUND,,AUTO

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:281  
     1436    12039    7                       EXIT FIND_HANDLER;

  12039  5 001326   001335 710000 5                  TRA     s:12043

     1437    12040    7                    END;
     1438    12041    6              END;

  12041  5 001327   200103 235100                    LDA     K,,AUTO
         5 001330   000001 035007                    ADLA    1,DL
         5 001331   200103 755100                    STA     K,,AUTO
         5 001332   200103 236100                    LDQ     K,,AUTO
         5 001333   200232 116100                    CMPQ    OLD_NRHAND,,AUTO
         5 001334   001314 602000 5                  TNC     s:12036

     1439    12042
     1440    12043    5              IF HANDLER_FOUND THEN

  12043  5 001335   200235 234100                    SZN     HANDLER_FOUND,,AUTO
         5 001336   001351 605000 5                  TPL     s:12050

     1441    12044    6                 DO;

     1442    12045    6                    CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(HNDLR_BUF));

  12045  5 001337   000070 630400 6                  EPPR0   56
         5 001340   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001341   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 001342   000000 011000                    NOP     0

     1443    12046    6                    KS_FEPHNDLR.BOOTIME(J) = OLD_BOOTIME(K);

  12046  5 001343   200103 235100                    LDA     K,,AUTO
         5 001344   200102 236100                    LDQ     J,,AUTO
         5 001345   003006 060505                    CSL     bolr='003'O
         5 001346   200231 000001                    BDSC    OLD_BOOTIME,A,AUTO       by=0,bit=0,n=1
         5 001347   000377 000001 2                  BDSC    KS_FEPHNDLR+3,Q          by=0,bit=0,n=1

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:282  
     1444    12047    6                 END;

  12047  5 001350   001413 710000 5                  TRA     CHANGE_FID

     1445    12048    5              ELSE
     1446    12049    6                 DO;

     1447    12050    6                    RECORD_CHANGED = '1'B;

  12050  5 001351   400000 236003                    LDQ     -131072,DU
         5 001352   200234 756100                    STQ     RECORD_CHANGED,,AUTO

     1448    12051    6                    KS_FEPHNDLR.BOOTIME(J) = '1'B;

  12051  5 001353   200102 235100                    LDA     J,,AUTO
         5 001354   003005 060400                    CSL     bolr='003'O
         5 001355   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 001356   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1

     1449    12052    6                    KS$HNDLR.HNDLRFID = ' ';

  12052  5 001357   000160 470400 2                  LDP0    HANDLER$
         5 001360   040100 100400                    MLR     fill='040'O
         5 001361   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001362   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

     1450    12053    6                    KS$HNDLR.HNDLRNAME = KS_FEPHNDLR.HANDLER(J);

  12053  5 001363   000001 735000                    ALS     1
         5 001364   000400 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         5 001365   000012 755100                    STA     10,,PR0
         5 001366   000013 756100                    STQ     11,,PR0

     1451    12054    6                    IF KS$HNDLR.HNDLRNAME ~= ' ' THEN

  12054  5 001367   040000 106500                    CMPC    fill='040'O
         5 001370   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:283  
         5 001371   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001372   001411 600000 5                  TZE     s:12060

     1452    12055    7                       DO;

     1453    12056    7                          KS$HNDLR.HNDLRFID = KS$HNDLR.HNDLRNAME;

  12056  5 001373   040100 100500                    MLR     fill='040'O
         5 001374   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         5 001375   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

     1454    12057    7                          CALL INDEX (K,' ',KS$HNDLR.HNDLRFID);

  12057  5 001376   000000 124500                    SCM     mask='000'O
         5 001377   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
         5 001400   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001401   200103 000100                    ARG     K,,AUTO

     1455    12058    7                          SUBSTR(KS$HNDLR.HNDLRFID,K) = '.:SYS';

  12058  5 001402   200103 720100                    LXL0    K,,AUTO
         5 001403   777727 620010                    EAX0    -41,X0
         5 001404   777777 660003                    ERX0    -1,DU
         5 001405   200103 235100                    LDA     K,,AUTO
         5 001406   040145 100400                    MLR     fill='040'O
         5 001407   000073 000005 1                  ADSC9   FEP+5                    cn=0,n=5
         5 001410   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0

     1456    12059    7                       END;

     1457    12060    6                    CALL RESET_PARAMS_TO_DEFAULTS;

  12060  5 001411   004103 701000 5                  TSX1    RESET_PARAMS_TO_DEFAULTS
         5 001412   000000 011000                    NOP     0

     1458    12061    6                 END;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:284  
     1459    12062
     1460    12063             /* Change fid of handler if requested */
     1461    12064
     1462    12065    5   CHANGE_FID:
     1463    12066    5              CALL INDEX (K,' ',KS$HNDLR.HNDLRFID);

  12066  5 001413   000160 470400 2     CHANGE_FID   LDP0    HANDLER$
         5 001414   000000 124500                    SCM     mask='000'O
         5 001415   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
         5 001416   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001417   200103 000100                    ARG     K,,AUTO

     1464    12067    5              TEXTC.COUNT = K;

  12067  5 001420   200103 236100                    LDQ     K,,AUTO
         5 001421   000033 736000                    QLS     27
         5 001422   000000 552040 2                  STBQ    TEXTC,'40'O

     1465    12068    5              TEXTC.TEXT = SUBSTR(KS$HNDLR.HNDLRFID,0,K);

  12068  5 001423   200103 720100                    LXL0    K,,AUTO
         5 001424   040000 100540                    MLR     fill='040'O
         5 001425   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 001426   000000 200050 2                  ADSC9   TEXTC                    cn=1,n=40

     1466    12069    5              CALL KSW$WRITE (VECTOR(HNDLRFID),VECTOR(HANDNR),VECTOR(TEXTC));

  12069  5 001427   777640 235007                    LDA     -96,DL
         5 001430   200244 452500                    STP2    @TARGET+2,,AUTO
         5 001431   200244 236100                    LDQ     @TARGET+2,,AUTO
         5 001432   000237 036003                    ADLQ    159,DU
         5 001433   200246 757100                    STAQ    @TARGET+4,,AUTO
         5 001434   000045 236000 6                  LDQ     37
         5 001435   200252 756100                    STQ     @TARGET+8,,AUTO
         5 001436   200246 631500                    EPPR1   @TARGET+4,,AUTO
         5 001437   200251 451500                    STP1    @TARGET+7,,AUTO
         5 001440   000074 236000 6                  LDQ     60
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:285  
         5 001441   200250 756100                    STQ     @TARGET+6,,AUTO
         5 001442   200250 630500                    EPPR0   @TARGET+6,,AUTO
         5 001443   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001444   000000 701000 xent               TSX1    KSW$WRITE
         5 001445   000000 011000                    NOP     0

     1467    12070    5              CALL XUR$GETCMD(KS_FID,TOP2$,VECTOR(EQUALS));

  12070  5 001446   000050 236000 6                  LDQ     40
         5 001447   200246 756100                    STQ     @TARGET+4,,AUTO
         5 001450   200146 630500                    EPPR0   TOP2$,,AUTO
         5 001451   200245 450500                    STP0    @TARGET+3,,AUTO
         5 001452   000051 236000 6                  LDQ     41
         5 001453   200244 756100                    STQ     @TARGET+2,,AUTO
         5 001454   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 001455   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001456   000000 701000 xent               TSX1    XUR$GETCMD
         5 001457   000000 011000                    NOP     0

     1468    12071    5              IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN

  12071  5 001460   200146 470500                    LDP0    TOP2$,,AUTO
         5 001461   000001 220100                    LDX0    1,,PR0
         5 001462   001473 600000 5                  TZE     s:12077

     1469    12072    6                 DO;

     1470    12073    6                    CALL ALTER_FID (TOP2$, KS$HNDLR.HNDLRFID);

  12073  5 001463   000160 236000 2                  LDQ     HANDLER$
         5 001464   200242 756100                    STQ     @PTR$+1,,AUTO
         5 001465   200146 631500                    EPPR1   TOP2$,,AUTO
         5 001466   200241 451500                    STP1    HANDNR+2,,AUTO
         5 001467   003741 701000 5                  TSX1    ALTER_FID
         5 001470   000000 011000                    NOP     0

     1471    12074    6                    RECORD_CHANGED = '1'B;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:286  

  12074  5 001471   400000 236003                    LDQ     -131072,DU
         5 001472   200234 756100                    STQ     RECORD_CHANGED,,AUTO

     1472    12075    6                 END;

     1473    12076
     1474    12077    5              IF RECORD_CHANGED THEN

  12077  5 001473   200234 234100                    SZN     RECORD_CHANGED,,AUTO
         5 001474   001543 605000 5                  TPL     s:12091

     1475    12078    6                 DO;   /* Figure out size of record */

     1476    12079    7                          IF KS$HNDLR.NPARAMI > 0 THEN DO;

  12079  5 001475   000160 470400 2                  LDP0    HANDLER$
         5 001476   000014 236100                    LDQ     12,,PR0
         5 001477   000777 316007                    CANQ    511,DL
         5 001500   001517 600000 5                  TZE     s:12084

     1477    12080    7                             PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.OFFSET(
             12080                                      KS$HNDLR.NPARAMI-1));

  12080  5 001501   000014 720100                    LXL0    12,,PR0
         5 001502   000777 360003                    ANX0    511,DU
         5 001503   000033 221110                    LDX1    27,X0,PR0
         5 001504   000013 631411 2                  EPPR1   HNDLR_BUF,X1
         5 001505   200147 451500                    STP1    PTR$,,AUTO

     1478    12081    7                             PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(KS$HNDLR.
             12081                                      NPARAMI - 1) + 2)/2);

  12081  5 001506   000032 236110                    LDQ     26,X0,PR0
         5 001507   000011 772000                    QRL     9
         5 001510   000777 376007                    ANQ     511,DL
         5 001511   000002 036007                    ADLQ    2,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:287  
         5 001512   000001 772000                    QRL     1
         5 001513   000022 736000                    QLS     18
         5 001514   200147 036100                    ADLQ    PTR$,,AUTO
         5 001515   200147 756100                    STQ     PTR$,,AUTO

     1479    12082    7                             END;

  12082  5 001516   001523 710000 5                  TRA     s:12087

     1480    12083    7                        ELSE DO;

     1481    12084    7                          PTR$ = ADDR(HNDLR_BUF);

  12084  5 001517   000021 236000 6                  LDQ     17
         5 001520   200147 756100                    STQ     PTR$,,AUTO

     1482    12085    7                          PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);

  12085  5 001521   000037 036003                    ADLQ    31,DU
         5 001522   200147 756100                    STQ     PTR$,,AUTO

     1483    12086    7                        END;

     1484    12087    6                    CALL KSU$WRITE_NETCON (VECTOR(KS_HANDLER_KEY),

  12087  5 001523   000021 236000 6                  LDQ     17
         5 001524   000020 772000                    QRL     16
         5 001525   200244 756100                    STQ     @TARGET+2,,AUTO
         5 001526   200147 236100                    LDQ     PTR$,,AUTO
         5 001527   000020 772000                    QRL     16
         5 001530   200244 136100                    SBLQ    @TARGET+2,,AUTO
         5 001531   000001 136007                    SBLQ    1,DL
         5 001532   200245 756100                    STQ     @TARGET+3,,AUTO
         5 001533   200245 631500                    EPPR1   @TARGET+3,,AUTO
         5 001534   200250 451500                    STP1    @TARGET+6,,AUTO
         5 001535   000070 237000 6                  LDAQ    56
         5 001536   200246 757100                    STAQ    @TARGET+4,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:288  
         5 001537   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 001540   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001541   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         5 001542   000000 011000                    NOP     0

     1485    12088    6                                           VECTOR(HNDLR_BUF),
     1486    12089    6                                           POFFC(PTR$,ADDR(HNDLR_BUF))-1);
     1487    12090    6                 END;

     1488    12091    5           END;   /* Change handlers */

  12091  5 001543   200102 235100                    LDA     J,,AUTO
         5 001544   000001 035007                    ADLA    1,DL
         5 001545   200102 755100                    STA     J,,AUTO
         5 001546   200102 236100                    LDQ     J,,AUTO
         5 001547   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 001550   001214 602000 5                  TNC     s:12020

     1489    12092
     1490    12093
     1491    12094             /* Delete any handler records that were not reset */
     1492    12095    4   DELETE_UNUSED_HAND_REC:
     1493    12096    5           DO J = 0 TO OLD_NRHAND - 1;

  12096  5 001551   200102 450100       DELETE_UNUS* STZ     J,,AUTO
         5 001552   001644 710000 5                  TRA     s:12119+3

     1494    12097    5              HANDLER_FOUND = '0'B;

  12097  5 001553   200235 450100                    STZ     HANDLER_FOUND,,AUTO

     1495    12098    5   FIND_HANDLER2:
     1496    12099    6              DO K = 0 TO KS_FEPHNDLR.NHANDLERS - 1;

  12099  5 001554   200103 450100       FIND_HANDLE* STZ     K,,AUTO
         5 001555   001574 710000 5                  TRA     s:12105+3

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:289  
     1497    12100    6                 IF OLD_HANDLER(J) = KS_FEPHNDLR.HANDLER(K) THEN

  12100  5 001556   200102 235100                    LDA     J,,AUTO
         5 001557   000003 735000                    ALS     3
         5 001560   200103 236100                    LDQ     K,,AUTO
         5 001561   000003 736000                    QLS     3
         5 001562   040006 106505                    CMPC    fill='040'O
         5 001563   200157 000010                    ADSC9   OLD_HANDLER,A,AUTO       cn=0,n=8
         5 001564   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,Q          cn=0,n=8
         5 001565   001571 601000 5                  TNZ     s:12105

     1498    12101    7                    DO;

     1499    12102    7                       HANDLER_FOUND = '1'B;

  12102  5 001566   400000 236003                    LDQ     -131072,DU
         5 001567   200235 756100                    STQ     HANDLER_FOUND,,AUTO

     1500    12103    7                       EXIT FIND_HANDLER2;

  12103  5 001570   001577 710000 5                  TRA     s:12107

     1501    12104    7                    END;
     1502    12105    6              END;

  12105  5 001571   200103 235100                    LDA     K,,AUTO
         5 001572   000001 035007                    ADLA    1,DL
         5 001573   200103 755100                    STA     K,,AUTO
         5 001574   200103 236100                    LDQ     K,,AUTO
         5 001575   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 001576   001556 602000 5                  TNC     s:12100

     1503    12106
     1504    12107    5              IF NOT HANDLER_FOUND THEN

  12107  5 001577   200235 234100                    SZN     HANDLER_FOUND,,AUTO
         5 001600   001630 604000 5                  TMI     s:12117
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:290  

     1505    12108    6                 DO;

     1506    12109    6                    KS_HANDLER_KEY.HNDLR = OLD_HANDLER(J);

  12109  5 001601   200102 235100                    LDA     J,,AUTO
         5 001602   000003 735000                    ALS     3
         5 001603   040000 100505                    MLR     fill='040'O
         5 001604   200157 000010                    ADSC9   OLD_HANDLER,A,AUTO       cn=0,n=8
         5 001605   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1507    12110    6                    DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  12110  5 001606   000016 237000 6                  LDAQ    14
         5 001607   001330 757000 2                  STAQ    DELREC_NETCON+2

     1508    12111    6                    CALL M$DELREC (DELREC_NETCON);

  12111  5 001610   001326 630400 2                  EPPR0   DELREC_NETCON
         5 001611   040002 713400                    CLIMB   16386
         5 001612   401400 401760                    pmme    nvectors=4

     1509    12112    6                    KS_DEFAULT_KEY.NODE = KS_NODE;

  12112  5 001613   000000 236000 xsym               LDQ     KS_NODE
         5 001614   000011 736000                    QLS     9
         5 001615   000221 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

     1510    12113    6                    KS_DEFAULT_KEY.HNDLR = OLD_HANDLER(J);

  12113  5 001616   200102 235100                    LDA     J,,AUTO
         5 001617   000003 735000                    ALS     3
         5 001620   040000 100505                    MLR     fill='040'O
         5 001621   200157 000010                    ADSC9   OLD_HANDLER,A,AUTO       cn=0,n=8
         5 001622   000221 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     1511    12114    6                    DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:291  

  12114  5 001623   000012 237000 6                  LDAQ    10
         5 001624   001330 757000 2                  STAQ    DELREC_NETCON+2

     1512    12115    6                    CALL M$DELREC (DELREC_NETCON);

  12115  5 001625   001326 630400 2                  EPPR0   DELREC_NETCON
         5 001626   040002 713400                    CLIMB   16386
         5 001627   401400 401760                    pmme    nvectors=4

     1513    12116    6                 END;

     1514    12117    5              IF J > KS_FEPHNDLR.NHANDLERS - 1 THEN

  12117  5 001630   200102 236100                    LDQ     J,,AUTO
         5 001631   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 001632   001641 602000 5                  TNC     s:12119

     1515    12118    5                 KS_FEPHNDLR.HANDLER(J) = ' ';

  12118  5 001633   200102 235100                    LDA     J,,AUTO
         5 001634   000001 735000                    ALS     1
         5 001635   000000 620005                    EAX0    0,AL
         5 001636   000035 235000 xsym               LDA     B_VECTNIL+29
         5 001637   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 001640   000400 757010 2                  STAQ    KS_FEPHNDLR+4,X0

     1516    12119    5           END;

  12119  5 001641   200102 235100                    LDA     J,,AUTO
         5 001642   000001 035007                    ADLA    1,DL
         5 001643   200102 755100                    STA     J,,AUTO
         5 001644   200102 236100                    LDQ     J,,AUTO
         5 001645   200232 116100                    CMPQ    OLD_NRHAND,,AUTO
         5 001646   001553 602000 5                  TNC     s:12097

     1517    12120
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:292  
     1518    12121             /* Remove blank handler names from KS_FEPHNDLR */
     1519    12122
     1520    12123    4           K = 0;

  12123  5 001647   200103 450100                    STZ     K,,AUTO

     1521    12124    4           J = KS_FEPHNDLR.NHANDLERS;

  12124  5 001650   000374 235000 2                  LDA     KS_FEPHNDLR
         5 001651   200102 755100                    STA     J,,AUTO

     1522    12125    5           DO I = 0 TO J - 1;

  12125  5 001652   200016 450100                    STZ     I,,AUTO
         5 001653   001705 710000 5                  TRA     s:12135+3

     1523    12126    5              IF KS_FEPHNDLR.HANDLER(I) ~= ' ' THEN

  12126  5 001654   200016 235100                    LDA     I,,AUTO
         5 001655   000001 735000                    ALS     1
         5 001656   000400 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         5 001657   000032 117000 6                  CMPAQ   26
         5 001660   001702 600000 5                  TZE     s:12135

     1524    12127    6                 DO;

     1525    12128    6                    IF K ~= I THEN

  12128  5 001661   200103 236100                    LDQ     K,,AUTO
         5 001662   200016 116100                    CMPQ    I,,AUTO
         5 001663   001700 600000 5                  TZE     s:12133

     1526    12129    7                       DO;

     1527    12130    7                          KS_FEPHNDLR.HANDLER(K) = KS_FEPHNDLR.HANDLER(I);

  12130  5 001664   200103 235100                    LDA     K,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:293  
         5 001665   000001 735000                    ALS     1
         5 001666   200016 236100                    LDQ     I,,AUTO
         5 001667   000001 736000                    QLS     1
         5 001670   000000 620005                    EAX0    0,AL
         5 001671   000400 237006 2                  LDAQ    KS_FEPHNDLR+4,QL
         5 001672   000400 757010 2                  STAQ    KS_FEPHNDLR+4,X0

     1528    12131    7                          KS_FEPHNDLR.BOOTIME(K) = KS_FEPHNDLR.BOOTIME(I);

  12131  5 001673   200016 235100                    LDA     I,,AUTO
         5 001674   200103 236100                    LDQ     K,,AUTO
         5 001675   003006 060405                    CSL     bolr='003'O
         5 001676   000377 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1
         5 001677   000377 000001 2                  BDSC    KS_FEPHNDLR+3,Q          by=0,bit=0,n=1

     1529    12132    7                       END;

     1530    12133    6                    K = K + 1;

  12133  5 001700   000001 036007                    ADLQ    1,DL
         5 001701   200103 756100                    STQ     K,,AUTO

     1531    12134    6                 END;

     1532    12135    5           END;

  12135  5 001702   200016 235100                    LDA     I,,AUTO
         5 001703   000001 035007                    ADLA    1,DL
         5 001704   200016 755100                    STA     I,,AUTO
         5 001705   200016 236100                    LDQ     I,,AUTO
         5 001706   200102 116100                    CMPQ    J,,AUTO
         5 001707   001654 602000 5                  TNC     s:12126

     1533    12136    4           KS_FEPHNDLR.NHANDLERS = K;

  12136  5 001710   200103 235100                    LDA     K,,AUTO
         5 001711   000374 755000 2                  STA     KS_FEPHNDLR
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:294  

     1534    12137
     1535    12138    4           IF KS_FEPHNDLR.HANDLER(0) ~= 'NODEADMN' THEN

  12138  5 001712   040000 106400                    CMPC    fill='040'O
         5 001713   000400 000010 2                  ADSC9   KS_FEPHNDLR+4            cn=0,n=8
         5 001714   000075 000010 1                  ADSC9   FEP+7                    cn=0,n=8
         5 001715   001722 600000 5                  TZE     BUILD_DEFAULTS

     1536    12139    4              CALL KSE$ERRMSG (%E$KS_NODEADMN_NOT_FIRST);

  12139  5 001716   000035 630400 6                  EPPR0   29
         5 001717   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001720   000000 701000 xent               TSX1    KSE$ERRMSG
         5 001721   000000 011000                    NOP     0

     1537    12140                   /*E* ERROR:   KSN-E$KS_NODEADMN_NOT_FIRST-0
     1538    12141                        MESSAGE: Warning -- NODEADMN is not user# 1 */
     1539    12142
     1540    12143
     1541    12144    4   BUILD_DEFAULTS:
     1542    12145    5           DO I = 0 TO KS_FEPHNDLR.NHANDLERS - 1;

  12145  5 001722   200016 450100       BUILD_DEFAU* STZ     I,,AUTO
         5 001723   002010 710000 5                  TRA     s:12153+3

     1543    12146    5              KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(I);

  12146  5 001724   200016 235100                    LDA     I,,AUTO
         5 001725   000003 735000                    ALS     3
         5 001726   040000 100405                    MLR     fill='040'O
         5 001727   000400 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         5 001730   000221 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     1544    12147    5              KS_DEFAULT_KEY.NODE = KS_NODE;

  12147  5 001731   000000 236000 xsym               LDQ     KS_NODE
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:295  
         5 001732   000011 736000                    QLS     9
         5 001733   000221 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

     1545    12148    5              CALL KSU$READ_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT_REC))

  12148  5 001734   000306 470400 2                  LDP0    DEFAULT$
         5 001735   000012 236100                    LDQ     10,,PR0
         5 001736   000011 772000                    QRL     9
         5 001737   000777 376007                    ANQ     511,DL
         5 001740   000053 620006                    EAX0    43,QL
         5 001741   000000 635010                    EAA     0,X0
         5 001742   000002 771000                    ARL     2
         5 001743   000140 135007                    SBLA    96,DL
         5 001744   000306 236000 2                  LDQ     DEFAULT$
         5 001745   200244 757100                    STAQ    @TARGET+2,,AUTO
         5 001746   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 001747   200247 451500                    STP1    @TARGET+5,,AUTO
         5 001750   000014 236000 6                  LDQ     12
         5 001751   200246 756100                    STQ     @TARGET+4,,AUTO
         5 001752   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 001753   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001754   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 001755   001757 702000 5                  TSX2    s:12150
         5 001756   002005 710000 5                  TRA     s:12153

     1546    12149    6                 WHENALTRETURN DO;

     1547    12150    6                    CALL KSU$INIT_DEFCNFG (KS_DEFAULT_REC);

  12150  5 001757   000306 630400 2                  EPPR0   DEFAULT$
         5 001760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001761   000000 701000 xent               TSX1    KSU$INIT_DEFCNFG
         5 001762   000000 011000                    NOP     0

     1548    12151    6                   CALL KSU$WRITE_NETCON (VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT_REC
             12151                             ));

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:296  
  12151  5 001763   000306 470400 2                  LDP0    DEFAULT$
         5 001764   000012 236100                    LDQ     10,,PR0
         5 001765   000011 772000                    QRL     9
         5 001766   000777 376007                    ANQ     511,DL
         5 001767   000053 620006                    EAX0    43,QL
         5 001770   000000 635010                    EAA     0,X0
         5 001771   000002 771000                    ARL     2
         5 001772   000140 135007                    SBLA    96,DL
         5 001773   000306 236000 2                  LDQ     DEFAULT$
         5 001774   200244 757100                    STAQ    @TARGET+2,,AUTO
         5 001775   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 001776   200247 451500                    STP1    @TARGET+5,,AUTO
         5 001777   000014 236000 6                  LDQ     12
         5 002000   200246 756100                    STQ     @TARGET+4,,AUTO
         5 002001   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 002002   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 002003   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         5 002004   000000 011000                    NOP     0

     1549    12152    6                 END;

     1550    12153    5           END BUILD_DEFAULTS;

  12153  5 002005   200016 235100                    LDA     I,,AUTO
         5 002006   000001 035007                    ADLA    1,DL
         5 002007   200016 755100                    STA     I,,AUTO
         5 002010   200016 236100                    LDQ     I,,AUTO
         5 002011   000374 116000 2                  CMPQ    KS_FEPHNDLR
         5 002012   001724 602000 5                  TNC     s:12146

     1551    12154
     1552    12155             /* Get new library fid */
     1553    12156    4              CALL INDEX (K,' ',KS_FEPHNDLR.DEFLIBACCT);

  12156  5 002013   000000 124400                    SCM     mask='000'O
         5 002014   000375 000010 2                  ADSC9   KS_FEPHNDLR+1            cn=0,n=8
         5 002015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:297  
         5 002016   200103 000100                    ARG     K,,AUTO

     1554    12157    4              TEXTC.COUNT = K;

  12157  5 002017   200103 236100                    LDQ     K,,AUTO
         5 002020   000033 736000                    QLS     27
         5 002021   000000 552040 2                  STBQ    TEXTC,'40'O

     1555    12158    4              TEXTC.TEXT = SUBSTR(KS_FEPHNDLR.DEFLIBACCT,0,K);

  12158  5 002022   200103 720100                    LXL0    K,,AUTO
         5 002023   040000 100440                    MLR     fill='040'O
         5 002024   000375 000010 2                  ADSC9   KS_FEPHNDLR+1            cn=0,n=*X0
         5 002025   000000 200050 2                  ADSC9   TEXTC                    cn=1,n=40

     1556    12159    4              CALL KSW$WRITE(VECTOR(LIBACCT),VECTOR(TEXTC));

  12159  5 002026   000100 630400 6                  EPPR0   64
         5 002027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 002030   000000 701000 xent               TSX1    KSW$WRITE
         5 002031   000000 011000                    NOP     0

     1557    12160    4                 CALL XUR$GETCMD(KS_LIB,TOP2$,VECTOR(EQUALS));

  12160  5 002032   000050 236000 6                  LDQ     40
         5 002033   200246 756100                    STQ     @TARGET+4,,AUTO
         5 002034   200146 630500                    EPPR0   TOP2$,,AUTO
         5 002035   200245 450500                    STP0    @TARGET+3,,AUTO
         5 002036   000102 236000 6                  LDQ     66
         5 002037   200244 756100                    STQ     @TARGET+2,,AUTO
         5 002040   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 002041   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002042   000000 701000 xent               TSX1    XUR$GETCMD
         5 002043   000000 011000                    NOP     0

     1558    12161    4                 IF TOP2$->OUT$BLK.NSUBLKS ~= 0 THEN

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:298  
  12161  5 002044   200146 470500                    LDP0    TOP2$,,AUTO
         5 002045   000001 220100                    LDX0    1,,PR0
         5 002046   002056 600000 5                  TZE     s:12164

     1559    12162    4                    KS_FEPHNDLR.DEFLIBACCT = TOP2$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  12162  5 002047   000003 471500                    LDP1    3,,PR0
         5 002050   100004 236100                    LDQ     4,,PR1
         5 002051   000033 772000                    QRL     27
         5 002052   000000 621006                    EAX1    0,QL
         5 002053   040000 100540                    MLR     fill='040'O
         5 002054   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         5 002055   000375 000010 2                  ADSC9   KS_FEPHNDLR+1            cn=0,n=8

     1560    12163
     1561    12164    4                 RECORD_SIZE = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(KS_FEPHNDLR.
             12164                          DEFLIBACCT)

  12164  5 002056   000374 235000 2                  LDA     KS_FEPHNDLR
         5 002057   000003 735000                    ALS     3
         5 002060   000017 035007                    ADLA    15,DL
         5 002061   200233 755100                    STA     RECORD_SIZE,,AUTO

     1562    12165    4                    + 4 + (SIZEC(KS_FEPHNDLR.HANDLER(0)) * KS_FEPHNDLR.NHANDLERS) - 1;
     1563    12166    4                 CALL KSU$WRITE_NETCON (VECTOR(KS_FEPHNDLR_KEY),

  12166  5 002062   200233 631500                    EPPR1   RECORD_SIZE,,AUTO
         5 002063   200246 451500                    STP1    @TARGET+4,,AUTO
         5 002064   000052 237000 6                  LDAQ    42
         5 002065   200244 757100                    STAQ    @TARGET+2,,AUTO
         5 002066   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 002067   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002070   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         5 002071   003344 702000 5                  TSX2    SET_ERR

     1564    12167    4                                        VECTOR(KS_FEPHNDLR),
     1565    12168    4                                        RECORD_SIZE) ALTRET(SET_ERR);
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:299  
     1566    12169    4                 PROMPT.NODENAME = KS_NODENAME;

  12169  5 002072   040000 100400                    MLR     fill='040'O
         5 002073   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 002074   000000 000010 xsym               ADSC9   PROMPT                   cn=0,n=8

     1567    12170    4                  P_PCB.OUT$ = ADDR(KS_CMD);

  12170  5 002075   000103 236000 6                  LDQ     67
         5 002076   000003 756000 xsym               STQ     P_PCB+3

     1568    12171    4                  EXIT DOI;

  12171  5 002077   003740 710000 5                  TRA     END_LOOP+10

     1569    12172    4              END;    /* no options on the set boot command */
     1570    12173        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:300  
     1571    12174    3              CASE(%KS_PARAM);

     1572    12175    3                 PARMTYPE = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  12175  5 002100   300003 474500                    LDP4    3,,PR3
         5 002101   400000 236100                    LDQ     0,,PR4
         5 002102   777777 376007                    ANQ     -1,DL
         5 002103   200131 756100                    STQ     PARMTYPE,,AUTO

     1573    12176    3                 PARMX = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  12176  5 002104   400003 475500                    LDP5    3,,PR4
         5 002105   500000 236100                    LDQ     0,,PR5
         5 002106   777777 376007                    ANQ     -1,DL
         5 002107   200130 756100                    STQ     PARMX,,AUTO

     1574    12177    3                 KS_SUB_BUF_1.COUNT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX) ->
             12177                          NAME.L#;

  12177  5 002110   200131 722100                    LXL2    PARMTYPE,,AUTO
         5 002111   000000 476412 xsym               LDP6    KS_TBL,X2
         5 002112   200130 235100                    LDA     PARMX,,AUTO
         5 002113   000002 735000                    ALS     2
         5 002114   600000 477505                    LDP7    0,AL,PR6
         5 002115   000000 100500                    MLR     fill='000'O
         5 002116   700000 000001                    ADSC9   0,,PR7                   cn=0,n=1
         5 002117   000000 000001 xsym               ADSC9   KS_SUB_BUF_1             cn=0,n=1

     1575    12178    3                KS_SUB_BUF_1.TEXT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX) -> NAME
             12178                          .NAME#;

  12178  5 002120   600000 471505                    LDP1    0,AL,PR6
         5 002121   000100 101500                    MRL     fill='000'O
         5 002122   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 002123   200244 000002                    ADSC9   @TARGET+2,,AUTO          cn=0,n=2
         5 002124   200244 221100                    LDX1    @TARGET+2,,AUTO
         5 002125   040000 100540                    MLR     fill='040'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:301  
         5 002126   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         5 002127   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1576    12179
     1577    12180                      /*N* For D00 politely tell the user there is no NSHUF.
     1578    12181                           Delete this here and in KSC$DISPLAY for E00.  Also
     1579    12182                           take NSHUF out of the nodes and change NSHUF to
     1580    12183                           SPARE in the tables. */
     1581    12184    3                 IF PARMTYPE = %KS_BOOT_PARAM AND PARMX = %GI_BOOT_NSHUF THEN

  12184  5 002130   200131 235100                    LDA     PARMTYPE,,AUTO
         5 002131   000001 115007                    CMPA    1,DL
         5 002132   002142 601000 5                  TNZ     s:12191
         5 002133   000010 116007                    CMPQ    8,DL
         5 002134   002142 601000 5                  TNZ     s:12191

     1582    12185    4                    DO;

     1583    12186    4                       CALL KSE$ERRMSG (%E$KS_NO_MORE_NSHUF);

  12186  5 002135   000105 630400 6                  EPPR0   69
         5 002136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 002137   000000 701000 xent               TSX1    KSE$ERRMSG
         5 002140   000000 011000                    NOP     0

     1584    12187                            /*E* ERROR: KSN-E$KS_NO_MORE_NSHUF-0
     1585    12188                                 MESSAGE: NSHUF is no longer a parameter. */
     1586    12189    4                       GOTO END_LOOP;

  12189  5 002141   003726 710000 5                  TRA     END_LOOP

     1587    12190    4                    END;
     1588    12191    3                 IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) THEN

  12191  5 002142   200130 235100                    LDA     PARMX,,AUTO
         5 002143   000002 735000                    ALS     2
         5 002144   600001 236105                    LDQ     1,AL,PR6
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:302  
         5 002145   010000 316003                    CANQ    4096,DU
         5 002146   002154 600000 5                  TZE     s:12200

     1589    12192    4                    DO;

     1590    12193    4                       CALL KSE$ERRMSG(%E$KS_DISPONLY,VECTOR(KS_SUB_BUF_1));

  12193  5 002147   000106 630400 6                  EPPR0   70
         5 002150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 002151   000000 701000 xent               TSX1    KSE$ERRMSG
         5 002152   000000 011000                    NOP     0

     1591    12194                            /*E* ERROR: KSN-E$KS_DISPONLY-0
     1592    12195                                 MESSAGE: %U1 is for display only.
     1593    12196                                 DESCRIPTION: SEE MESSAGE  */
     1594    12197    4                       GOTO END_LOOP;

  12197  5 002153   003726 710000 5                  TRA     END_LOOP

     1595    12198    4                    END;
     1596    12199
     1597    12200    3                 NUM_INDX = 1;

  12200  5 002154   000001 235007                    LDA     1,DL
         5 002155   200133 755100                    STA     NUM_INDX,,AUTO

     1598    12201    3                 INDX_VEC(0) = 0;

  12201  5 002156   200020 450100                    STZ     INDX_VEC,,AUTO

     1599    12202
     1600    12203
     1601    12204    3                 IF PARMTYPE = %KS_HNDLR_PARAM THEN

  12204  5 002157   200131 236100                    LDQ     PARMTYPE,,AUTO
         5 002160   000003 116007                    CMPQ    3,DL
         5 002161   002375 601000 5                  TNZ     s:12263
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:303  

     1602    12205    4                    DO;

     1603    12206    4                       IF KS_HNDLRNAME = ' ' THEN

  12206  5 002162   040000 106400                    CMPC    fill='040'O
         5 002163   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         5 002164   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 002165   002173 601000 5                  TNZ     s:12214

     1604    12207    5                          DO;

     1605    12208    5                             CALL KSE$ERRMSG (%E$KS_NOHANDLER_SET);

  12208  5 002166   000111 630400 6                  EPPR0   73
         5 002167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 002170   000000 701000 xent               TSX1    KSE$ERRMSG
         5 002171   000000 011000                    NOP     0

     1606    12209                                  /*E* ERROR: KSN-E$KS_NOHANDLER_SET-0
     1607    12210                 MESSAGE: A handler must be selected in order to set a handler parameter.*/
     1608    12211    5                             GOTO SET_ERR;

  12211  5 002172   003344 710000 5                  TRA     SET_ERR

     1609    12212    5                          END;
     1610    12213    4                       ELSE
     1611    12214    4                          PARMTYPE = PARMTYPE + KS_HNDLRINDX;

  12214  5 002173   000000 236000 xsym               LDQ     KS_HNDLRINDX
         5 002174   000033 772000                    QRL     27
         5 002175   200131 036100                    ADLQ    PARMTYPE,,AUTO
         5 002176   200131 756100                    STQ     PARMTYPE,,AUTO

     1612    12215    4                KS_SUB_BUF_1.COUNT = KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.TEXTNAME(PARMX)
             12215                          -> NAME.L#;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:304  
  12215  5 002177   200130 235100                    LDA     PARMX,,AUTO
         5 002200   000002 735000                    ALS     2
         5 002201   000003 471400 xsym               LDP1    KS_TBL+3
         5 002202   100000 474505                    LDP4    0,AL,PR1
         5 002203   000000 100500                    MLR     fill='000'O
         5 002204   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 002205   000000 000001 xsym               ADSC9   KS_SUB_BUF_1             cn=0,n=1

     1613    12216    4                 KS_SUB_BUF_1.TEXT = KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.TEXTNAME(PARMX)
             12216                          -> NAME.NAME#;

  12216  5 002206   100000 474505                    LDP4    0,AL,PR1
         5 002207   000100 101500                    MRL     fill='000'O
         5 002210   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 002211   200244 000002                    ADSC9   @TARGET+2,,AUTO          cn=0,n=2
         5 002212   200244 221100                    LDX1    @TARGET+2,,AUTO
         5 002213   040000 100540                    MLR     fill='040'O
         5 002214   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         5 002215   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1614    12217    4                 KS_SUB_BUF_2.COUNT = SIZEC(KS_HNDLRNAME);

  12217  5 002216   010000 236003                    LDQ     4096,DU
         5 002217   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     1615    12218    4                 KS_SUB_BUF_2.TEXT = KS_HNDLRNAME;

  12218  5 002220   040000 100400                    MLR     fill='040'O
         5 002221   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         5 002222   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     1616    12219    4                 KS_SUB_BUF_3.COUNT = SIZEC(KS_NODENAME);

  12219  5 002223   000000 552040 xsym               STBQ    KS_SUB_BUF_3,'40'O

     1617    12220    4                 KS_SUB_BUF_3.TEXT = KS_NODENAME;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:305  
  12220  5 002224   040000 100400                    MLR     fill='040'O
         5 002225   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 002226   000000 200037 xsym               ADSC9   KS_SUB_BUF_3             cn=1,n=31

     1618    12221    4                 IF NOT(ADDR(KS_TBL(%KS_HNDLR_PARAM)->KS$PARAM.HND(PARMX)) -> HND.DAT(
             12221                          KS_HNDLRINDX)) THEN

  12221  5 002227   000000 236000 xsym               LDQ     KS_HNDLRINDX
         5 002230   000033 772000                    QRL     27
         5 002231   200244 756100                    STQ     @TARGET+2,,AUTO
         5 002232   200130 236100                    LDQ     PARMX,,AUTO
         5 002233   000220 402007                    MPY     144,DL
         5 002234   200244 036100                    ADLQ    @TARGET+2,,AUTO
         5 002235   000000 066506                    CMPB    filb='0'B
         5 002236   100001 400001                    BDSC    1,Q,PR1                  by=2,bit=0,n=1
         5 002237   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 002240   002247 601000 5                  TNZ     s:12230

     1619    12222    5                    DO;

     1620    12223    5                    CALL KSE$ERRMSG(%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),VECTOR(
             12223                             KS_SUB_BUF_2));

  12223  5 002241   000113 630400 6                  EPPR0   75
         5 002242   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002243   000000 701000 xent               TSX1    KSE$ERRMSG
         5 002244   000000 011000                    NOP     0

     1621    12224                         /*E* ERROR: KSN-E$KS_ILGSET
     1622    12225                         MESSAGE: %U1 is not legal for handler %U2
     1623    12226                              DESCRIPTION: SEE MESSAGE */
     1624    12227    5                    NUM_INDX = 0; /* keeps code from looping thru speed index */

  12227  5 002245   200133 450100                    STZ     NUM_INDX,,AUTO

     1625    12228    5                    GOTO SET_ERR;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:306  
  12228  5 002246   003344 710000 5                  TRA     SET_ERR

     1626    12229    5                    END;  /* parameter not legal for this parameter */
     1627    12230    5                 IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN DO;

  12230  5 002247   200131 721100                    LXL1    PARMTYPE,,AUTO
         5 002250   000000 474411 xsym               LDP4    KS_TBL,X1
         5 002251   200130 235100                    LDA     PARMX,,AUTO
         5 002252   000002 735000                    ALS     2
         5 002253   400001 234105                    SZN     1,AL,PR4
         5 002254   002375 605000 5                  TPL     s:12263

     1628    12231    5                   PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0
             12231                             );

  12231  5 002255   300003 475500                    LDP5    3,,PR3
         5 002256   500003 476500                    LDP6    3,,PR5
         5 002257   600003 236100                    LDQ     3,,PR6
         5 002260   200147 756100                    STQ     PTR$,,AUTO

     1629    12232    5                    IF PARMX = %KL_HNDLRPARM_USRPARM1 OR

  12232  5 002261   200130 235100                    LDA     PARMX,,AUTO
         5 002262   000037 115007                    CMPA    31,DL
         5 002263   002266 600000 5                  TZE     s:12235
         5 002264   000040 115007                    CMPA    32,DL
         5 002265   002275 601000 5                  TNZ     s:12240

     1630    12233    5                       PARMX = %KL_HNDLRPARM_USRPARM2 THEN
     1631    12234    6                          DO;

     1632    12235    6                          NUM_INDX = 1;

  12235  5 002266   000001 235007                    LDA     1,DL
         5 002267   200133 755100                    STA     NUM_INDX,,AUTO

     1633    12236    6                          INDX_VEC(0) = PTR$->OUT$BLK.CODE;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:307  

  12236  5 002270   200147 477500                    LDP7    PTR$,,AUTO
         5 002271   700000 236100                    LDQ     0,,PR7
         5 002272   777777 376007                    ANQ     -1,DL
         5 002273   200020 756100                    STQ     INDX_VEC,,AUTO

     1634    12237    6                          END;

  12237  5 002274   002375 710000 5                  TRA     s:12263

     1635    12238    5                    ELSE
     1636    12239    6                       DO;

     1637    12240    7                    DO CASE(PTR$->OUT$BLK.CODE);

  12240  5 002275   200147 477500                    LDP7    PTR$,,AUTO
         5 002276   700000 722100                    LXL2    0,,PR7
         5 002277   000004 102003                    CMPX2   4,DU
         5 002300   002302 602012 5                  TNC     s:12240+5,X2
         5 002301   002375 710000 5                  TRA     s:12263
         5 002302   002375 710000 5                  TRA     s:12263
         5 002303   002306 710000 5                  TRA     s:12242
         5 002304   002333 710000 5                  TRA     s:12247
         5 002305   002363 710000 5                  TRA     s:12255

     1638    12241    7                       CASE(%KS_SPEED_LIST);

     1639    12242    7                          NUM_INDX = PTR$->OUT$BLK.NSUBLKS;

  12242  5 002306   700001 236100                    LDQ     1,,PR7
         5 002307   000022 772000                    QRL     18
         5 002310   200133 756100                    STQ     NUM_INDX,,AUTO

     1640    12243    8                          DO J = 0 TO PTR$-> OUT$BLK.NSUBLKS - 1;

  12243  5 002311   200102 450100                    STZ     J,,AUTO
         5 002312   002324 710000 5                  TRA     s:12245+3
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:308  

     1641    12244    8                             INDX_VEC(J) = PTR$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE;

  12244  5 002313   200147 470500                    LDP0    PTR$,,AUTO
         5 002314   200102 720100                    LXL0    J,,AUTO
         5 002315   000003 471510                    LDP1    3,X0,PR0
         5 002316   100000 236100                    LDQ     0,,PR1
         5 002317   777777 376007                    ANQ     -1,DL
         5 002320   200020 756110                    STQ     INDX_VEC,X0,AUTO

     1642    12245    8                             END;  /* DO J */

  12245  5 002321   200102 235100                    LDA     J,,AUTO
         5 002322   000001 035007                    ADLA    1,DL
         5 002323   200102 755100                    STA     J,,AUTO
         5 002324   200147 470500                    LDP0    PTR$,,AUTO
         5 002325   000001 236100                    LDQ     1,,PR0
         5 002326   000022 772000                    QRL     18
         5 002327   200102 116100                    CMPQ    J,,AUTO
         5 002330   002332 600000 5                  TZE     s:12245+9
         5 002331   002313 603000 5                  TRC     s:12244
         5 002332   002375 710000 5                  TRA     s:12263

     1643    12246    7                       CASE(%KS_SPEED_RANGE);

     1644    12247    7                          TEMP1 = PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  12247  5 002333   700003 470500                    LDP0    3,,PR7
         5 002334   000000 236100                    LDQ     0,,PR0
         5 002335   777777 376007                    ANQ     -1,DL
         5 002336   200137 756100                    STQ     TEMP1,,AUTO

     1645    12248    7                          TEMP2 = PTR$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE;

  12248  5 002337   700004 470500                    LDP0    4,,PR7
         5 002340   000000 236100                    LDQ     0,,PR0
         5 002341   777777 376007                    ANQ     -1,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:309  
         5 002342   200140 756100                    STQ     TEMP2,,AUTO

     1646    12249    7                          NUM_INDX = 0;

  12249  5 002343   200133 450100                    STZ     NUM_INDX,,AUTO

     1647    12250    8                          DO J = TEMP1 TO TEMP2;

  12250  5 002344   200137 235100                    LDA     TEMP1,,AUTO
         5 002345   200102 755100                    STA     J,,AUTO
         5 002346   002357 710000 5                  TRA     s:12253+2

     1648    12251    8                             INDX_VEC(NUM_INDX) = J;

  12251  5 002347   200133 720100                    LXL0    NUM_INDX,,AUTO
         5 002350   200102 235100                    LDA     J,,AUTO
         5 002351   200020 755110                    STA     INDX_VEC,X0,AUTO

     1649    12252    8                             NUM_INDX = NUM_INDX + 1;

  12252  5 002352   200133 236100                    LDQ     NUM_INDX,,AUTO
         5 002353   000001 036007                    ADLQ    1,DL
         5 002354   200133 756100                    STQ     NUM_INDX,,AUTO

     1650    12253    8                             END;  /* DO J */

  12253  5 002355   000001 035007                    ADLA    1,DL
         5 002356   200102 755100                    STA     J,,AUTO
         5 002357   200140 236100                    LDQ     TEMP2,,AUTO
         5 002360   200102 116100                    CMPQ    J,,AUTO
         5 002361   002347 603000 5                  TRC     s:12251
         5 002362   002375 710000 5                  TRA     s:12263

     1651    12254    7                       CASE(%KS_SPEED_ALL);

     1652    12255    7                          NUM_INDX = %KS_SPEED_19200 + 1;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:310  
  12255  5 002363   000020 235007                    LDA     16,DL
         5 002364   200133 755100                    STA     NUM_INDX,,AUTO

     1653    12256    8                          DO J = %KS_SPEED_50 TO %KS_SPEED_19200;

  12256  5 002365   200102 450100                    STZ     J,,AUTO

     1654    12257    8                             INDX_VEC(J) = J;

  12257  5 002366   200102 720100                    LXL0    J,,AUTO
         5 002367   200102 235100                    LDA     J,,AUTO
         5 002370   200020 755110                    STA     INDX_VEC,X0,AUTO

     1655    12258    8                             END;  /* DO J */

  12258  5 002371   000001 035007                    ADLA    1,DL
         5 002372   200102 755100                    STA     J,,AUTO
         5 002373   000020 115007                    CMPA    16,DL
         5 002374   002366 602000 5                  TNC     s:12257

     1656    12259    7                       END;  /* DO CASE */

     1657    12260    6                    END;  /* else parmx = usrparm1 or usrparm2 */

     1658    12261    5                    END;  /* IF FLAGS.INDX */

     1659    12262    4                    END;

     1660    12263    4                 DO K = 0 TO NUM_INDX - 1;

  12263  5 002375   200103 450100                    STZ     K,,AUTO
         5 002376   003356 710000 5                  TRA     s:12456+3

     1661    12264    4                    INDX = INDX_VEC(K);

  12264  5 002377   200103 720100                    LXL0    K,,AUTO
         5 002400   200020 235110                    LDA     INDX_VEC,X0,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:311  
         5 002401   200017 755100                    STA     INDX,,AUTO

     1662    12265    4                    RCVCQ_SNDCQ = '0'B;

  12265  5 002402   200236 450100                    STZ     RCVCQ_SNDCQ,,AUTO

     1663    12266    4                    PTR$ = BLK$->OUT$BLK.SUBLK$(1);

  12266  5 002403   200145 470500                    LDP0    BLK$,,AUTO
         5 002404   000004 236100                    LDQ     4,,PR0
         5 002405   200147 756100                    STQ     PTR$,,AUTO

     1664    12267    5                    DO CASE(PTR$->OUT$BLK.CODE);

  12267  5 002406   200147 471500                    LDP1    PTR$,,AUTO
         5 002407   100000 721100                    LXL1    0,,PR1
         5 002410   000005 101003                    CMPX1   5,DU
         5 002411   002413 602011 5                  TNC     s:12267+5,X1
         5 002412   002511 710000 5                  TRA     s:12288
         5 002413   002511 710000 5                  TRA     s:12288
         5 002414   002420 710000 5                  TRA     s:12269
         5 002415   002511 710000 5                  TRA     s:12288
         5 002416   002502 710000 5                  TRA     s:12285
         5 002417   002445 710000 5                  TRA     s:12278

     1665    12268    5                       CASE(%KS_DECVAL);

     1666    12269    5                          CALL CHARBIN(VALUE,PTR$->OUT$SYM.TEXT);

  12269  5 002420   100004 236100                    LDQ     4,,PR1
         5 002421   000033 772000                    QRL     27
         5 002422   000000 622006                    EAX2    0,QL
         5 002423   000100 305540                    DTB
         5 002424   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         5 002425   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 002426   200245 236100                    LDQ     @TARGET+3,,AUTO
         5 002427   200143 756100                    STQ     VALUE,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:312  

     1667    12270    5                          IF PARMTYPE >= %KS_HNDLR_PARAM AND

  12270  5 002430   200131 235100                    LDA     PARMTYPE,,AUTO
         5 002431   000003 115007                    CMPA    3,DL
         5 002432   002511 602000 5                  TNC     s:12288
         5 002433   200130 235100                    LDA     PARMX,,AUTO
         5 002434   000014 115007                    CMPA    12,DL
         5 002435   002440 600000 5                  TZE     s:12274
         5 002436   000015 115007                    CMPA    13,DL
         5 002437   002511 601000 5                  TNZ     s:12288

     1668    12271    5                             (PARMX = %KL_HNDLRPARM_RCVCQBYTSIZ OR
     1669    12272    5                              PARMX = %KL_HNDLRPARM_SNDCQBYTSIZ) THEN
     1670    12273    6                             DO;

     1671    12274    6                                VALUE = VALUE / 2;

  12274  5 002440   000001 772000                    QRL     1
         5 002441   200143 756100                    STQ     VALUE,,AUTO

     1672    12275    6                                RCVCQ_SNDCQ = '1'B;

  12275  5 002442   400000 236003                    LDQ     -131072,DU
         5 002443   200236 756100                    STQ     RCVCQ_SNDCQ,,AUTO

     1673    12276    6                             END;

  12276  5 002444   002511 710000 5                  TRA     s:12288

     1674    12277    5                       CASE(%KS_HEXVAL);

     1675    12278    5                          VALUE = 0;

  12278  5 002445   200143 450100                    STZ     VALUE,,AUTO

     1676    12279    6                          DO J = 0 TO PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT - 1;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:313  

  12279  5 002446   200102 450100                    STZ     J,,AUTO
         5 002447   002472 710000 5                  TRA     s:12283+2

     1677    12280    6                            HEX_CHAR = SUBSTR(PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,J,
             12280                                      1);

  12280  5 002450   200147 470500                    LDP0    PTR$,,AUTO
         5 002451   000003 471500                    LDP1    3,,PR0
         5 002452   100004 236100                    LDQ     4,,PR1
         5 002453   000033 772000                    QRL     27
         5 002454   200102 235100                    LDA     J,,AUTO
         5 002455   040100 100505                    MLR     fill='040'O
         5 002456   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         5 002457   200011 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

     1678    12281    6                             CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  12281  5 002460   000100 124400                    SCM     mask='000'O
         5 002461   000026 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         5 002462   200011 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         5 002463   200012 000100                    ARG     HEX_DIGIT,,AUTO

     1679    12282    6                             VALUE = VALUE * 16 + HEX_DIGIT;

  12282  5 002464   200143 236100                    LDQ     VALUE,,AUTO
         5 002465   000004 736000                    QLS     4
         5 002466   200012 036100                    ADLQ    HEX_DIGIT,,AUTO
         5 002467   200143 756100                    STQ     VALUE,,AUTO

     1680    12283    6                             END;  /* DO J */

  12283  5 002470   000001 035007                    ADLA    1,DL
         5 002471   200102 755100                    STA     J,,AUTO
         5 002472   200147 470500                    LDP0    PTR$,,AUTO
         5 002473   000003 471500                    LDP1    3,,PR0
         5 002474   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:314  
         5 002475   000033 772000                    QRL     27
         5 002476   200102 116100                    CMPQ    J,,AUTO
         5 002477   002501 600000 5                  TZE     s:12283+9
         5 002500   002450 603000 5                  TRC     s:12280
         5 002501   002511 710000 5                  TRA     s:12288

     1681    12284    5                       CASE(%KS_RESVAL);

     1682    12285    5                          VALUE = 0;

  12285  5 002502   200143 450100                    STZ     VALUE,,AUTO

     1683    12286    5                          VALUEC.RES = PTR$->OUT$SYM.TEXT;

  12286  5 002503   100004 236100                    LDQ     4,,PR1
         5 002504   000033 772000                    QRL     27
         5 002505   000000 621006                    EAX1    0,QL
         5 002506   040100 100540                    MLR     fill='040'O
         5 002507   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         5 002510   200143 400002                    ADSC9   VALUE,,AUTO              cn=2,n=2

     1684    12287    5                       END;  /* DO CASE */

     1685    12288    5                    DO CASE(PARMTYPE);

  12288  5 002511   200131 235100                    LDA     PARMTYPE,,AUTO
         5 002512   000003 115007                    CMPA    3,DL
         5 002513   002515 602005 5                  TNC     s:12288+4,AL
         5 002514   002560 710000 5                  TRA     s:12303
         5 002515   002560 710000 5                  TRA     s:12303
         5 002516   002520 710000 5                  TRA     s:12290
         5 002517   002554 710000 5                  TRA     s:12301

     1686    12289    5                       CASE(%KS_BOOT_PARAM);

     1687    12290    5                       KS_FEPBOOT_KEY.NODE = KS_NODE;

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:315  
  12290  5 002520   000000 236000 xsym               LDQ     KS_NODE
         5 002521   000011 736000                    QLS     9
         5 002522   000344 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

     1688    12291    5                          READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  12291  5 002523   000010 237000 6                  LDAQ    8
         5 002524   001276 757000 2                  STAQ    READ_NETCON+2

     1689    12292    5                          READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  12292  5 002525   000006 237000 6                  LDAQ    6
         5 002526   001300 757000 2                  STAQ    READ_NETCON+4

     1690    12293    5                          CALL M$READ(READ_NETCON) ALTRET(UPD_NETCON_ERR);

  12293  5 002527   001274 630400 2                  EPPR0   READ_NETCON
         5 002530   440000 713400                    CLIMB   alt,read
         5 002531   401400 401760                    pmme    nvectors=4
         5 002532   003333 702000 5                  TSX2    UPD_NETCON_ERR

     1691    12294    5                          KS_FEPBOOT.BOOTPARAMS(PARMX+INDX) = VALUE;

  12294  5 002533   200130 236100                    LDQ     PARMX,,AUTO
         5 002534   200017 036100                    ADLQ    INDX,,AUTO
         5 002535   200143 235100                    LDA     VALUE,,AUTO
         5 002536   000324 755006 2                  STA     KS_FEPBOOT+10,QL

     1692    12295    5                          WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  12295  5 002537   000010 237000 6                  LDAQ    8
         5 002540   001314 757000 2                  STAQ    WRITE_NETCON+2

     1693    12296    5                          WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  12296  5 002541   000006 237000 6                  LDAQ    6
         5 002542   001316 757000 2                  STAQ    WRITE_NETCON+4
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:316  

     1694    12297    5                          CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);

  12297  5 002543   001312 630400 2                  EPPR0   WRITE_NETCON
         5 002544   440001 713400                    CLIMB   alt,write
         5 002545   401400 401760                    pmme    nvectors=4
         5 002546   003333 702000 5                  TSX2    UPD_NETCON_ERR

     1695    12298    5                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12298                                   VECTOR(NETCON));

  12298  5 002547   000120 630400 6                  EPPR0   80
         5 002550   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002551   000000 701000 xent               TSX1    KSW$WRITE
         5 002552   000000 011000                    NOP     0

     1696    12299    5                          GOTO END_LOOP;

  12299  5 002553   003726 710000 5                  TRA     END_LOOP

     1697    12300    5                       CASE(%KS_LCP6_PARAM);

     1698    12301    5                          KS_CONTROL.HANDLER = 'BABOON';

  12301  5 002554   040000 100400                    MLR     fill='040'O
         5 002555   000101 000006 1                  ADSC9   FEP+11                   cn=0,n=6
         5 002556   001224 000010 2                  ADSC9   KS_CONTROL+1             cn=0,n=8
         5 002557   002563 710000 5                  TRA     s:12305

     1699    12302    5                       CASE(ELSE);

     1700    12303    5                          KS_CONTROL.HANDLER = KS_HNDLRNAME;

  12303  5 002560   040000 100400                    MLR     fill='040'O
         5 002561   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         5 002562   001224 000010 2                  ADSC9   KS_CONTROL+1             cn=0,n=8

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:317  
     1701    12304    5                       END;  /* DO CASE */

     1702    12305    4                       IF NOT (KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.SPECIAL(PARMX)) THEN

  12305  5 002563   000000 470405 xsym               LDP0    KS_TBL,AL
         5 002564   200130 235100                    LDA     PARMX,,AUTO
         5 002565   000002 735000                    ALS     2
         5 002566   000001 236105                    LDQ     1,AL,PR0
         5 002567   200000 316003                    CANQ    65536,DU
         5 002570   002721 601000 5                  TNZ     s:12329

     1703    12306    5                          DO;

     1704    12307    5                          IF VALUE > KS_TBL(PARMTYPE) -> KS$PARAM.MAX(PARMX) OR

  12307  5 002571   200131 720100                    LXL0    PARMTYPE,,AUTO
         5 002572   000000 470410 xsym               LDP0    KS_TBL,X0
         5 002573   000002 236105                    LDQ     2,AL,PR0
         5 002574   000022 772000                    QRL     18
         5 002575   200143 116100                    CMPQ    VALUE,,AUTO
         5 002576   002604 602000 5                  TNC     s:12309
         5 002577   000002 236105                    LDQ     2,AL,PR0
         5 002600   777777 376007                    ANQ     -1,DL
         5 002601   200143 116100                    CMPQ    VALUE,,AUTO
         5 002602   002721 602000 5                  TNC     s:12329
         5 002603   002721 600000 5                  TZE     s:12329

     1705    12308    6                             VALUE < KS_TBL(PARMTYPE) -> KS$PARAM.MIN(PARMX) THEN DO;

     1706    12309    6                                IF RCVCQ_SNDCQ THEN

  12309  5 002604   200236 234100                    SZN     RCVCQ_SNDCQ,,AUTO
         5 002605   002643 605000 5                  TPL     s:12316

     1707    12310    7                                   DO;

     1708    12311    7                                     CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:318  
             12311                                               MAX(PARMX)*2,KS_SUB_BUF_2.TEXT,KS_SUB_BUF_2.
             12311                                               COUNT);

  12311  5 002606   000002 236105                    LDQ     2,AL,PR0
         5 002607   000021 772000                    QRL     17
         5 002610   000123 376000 6                  ANQ     83
         5 002611   200244 756100                    STQ     @TARGET+2,,AUTO
         5 002612   000124 237000 6                  LDAQ    84
         5 002613   200246 757100                    STAQ    @TARGET+4,,AUTO
         5 002614   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 002615   200245 451500                    STP1    @TARGET+3,,AUTO
         5 002616   200245 630500                    EPPR0   @TARGET+3,,AUTO
         5 002617   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002620   000000 701000 xent               TSX1    KSU$STRIP_ZEROS
         5 002621   000000 011000                    NOP     0

     1709    12312    7                                     CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12312                                               MIN(PARMX)*2,KS_SUB_BUF_3.TEXT,KS_SUB_BUF_3.
             12312                                               COUNT);

  12312  5 002622   200131 720100                    LXL0    PARMTYPE,,AUTO
         5 002623   000000 470410 xsym               LDP0    KS_TBL,X0
         5 002624   200130 235100                    LDA     PARMX,,AUTO
         5 002625   000002 735000                    ALS     2
         5 002626   000002 236105                    LDQ     2,AL,PR0
         5 002627   000001 736000                    QLS     1
         5 002630   000123 376000 6                  ANQ     83
         5 002631   200244 756100                    STQ     @TARGET+2,,AUTO
         5 002632   000126 237000 6                  LDAQ    86
         5 002633   200246 757100                    STAQ    @TARGET+4,,AUTO
         5 002634   200244 631500                    EPPR1   @TARGET+2,,AUTO
         5 002635   200245 451500                    STP1    @TARGET+3,,AUTO
         5 002636   200245 630500                    EPPR0   @TARGET+3,,AUTO
         5 002637   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002640   000000 701000 xent               TSX1    KSU$STRIP_ZEROS
         5 002641   000000 011000                    NOP     0

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:319  
     1710    12313    7                                   END;

  12313  5 002642   002674 710000 5                  TRA     s:12319

     1711    12314    6                                ELSE
     1712    12315    7                                   DO;

     1713    12316    7                                     CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12316                                               MAX(PARMX),KS_SUB_BUF_2.TEXT,KS_SUB_BUF_2.
             12316                                               COUNT);

  12316  5 002643   000025 236000 6                  LDQ     21
         5 002644   200246 756100                    STQ     @TARGET+4,,AUTO
         5 002645   000124 236000 6                  LDQ     84
         5 002646   200245 756100                    STQ     @TARGET+3,,AUTO
         5 002647   000002 631505                    EPPR1   2,AL,PR0
         5 002650   200244 451500                    STP1    @TARGET+2,,AUTO
         5 002651   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 002652   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002653   000000 701000 xent               TSX1    KSU$STRIP_ZEROS
         5 002654   000000 011000                    NOP     0

     1714    12317    7                                     CALL KSU$STRIP_ZEROS (KS_TBL(PARMTYPE)->KS$PARAM.
             12317                                               MIN(PARMX),KS_SUB_BUF_3.TEXT,KS_SUB_BUF_3.
             12317                                               COUNT);

  12317  5 002655   200131 720100                    LXL0    PARMTYPE,,AUTO
         5 002656   000000 470410 xsym               LDP0    KS_TBL,X0
         5 002657   000127 236000 6                  LDQ     87
         5 002660   200246 756100                    STQ     @TARGET+4,,AUTO
         5 002661   000126 236000 6                  LDQ     86
         5 002662   200245 756100                    STQ     @TARGET+3,,AUTO
         5 002663   200130 235100                    LDA     PARMX,,AUTO
         5 002664   000004 735000                    ALS     4
         5 002665   000012 035007                    ADLA    10,DL
         5 002666   000000 500505                    A9BD    0,AL,PR0
         5 002667   200244 450500                    STP0    @TARGET+2,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:320  
         5 002670   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 002671   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 002672   000000 701000 xent               TSX1    KSU$STRIP_ZEROS
         5 002673   000000 011000                    NOP     0

     1715    12318    7                                   END;

     1716    12319    6                                KS_SUB_BUF_4.COUNT = SIZEC(KS_HNDLRNAME);

  12319  5 002674   010000 236003                    LDQ     4096,DU
         5 002675   200114 552140                    STBQ    KS_SUB_BUF_4,'40'O,AUTO

     1717    12320    6                                KS_SUB_BUF_4.TEXT  = KS_HNDLRNAME;

  12320  5 002676   040100 100400                    MLR     fill='040'O
         5 002677   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         5 002700   200114 200037                    ADSC9   KS_SUB_BUF_4,,AUTO       cn=1,n=31

     1718    12321    6                                CALL KSE$ERRMSG(%E$KS_BADPRMVAL,VECTOR(KS_SUB_BUF_4),
             12321                                         VECTOR(KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));

  12321  5 002701   000022 235000 6                  LDA     18
         5 002702   200244 452500                    STP2    @TARGET+2,,AUTO
         5 002703   200244 236100                    LDQ     @TARGET+2,,AUTO
         5 002704   000114 036003                    ADLQ    76,DU
         5 002705   200246 757100                    STAQ    @TARGET+4,,AUTO
         5 002706   000134 237000 6                  LDAQ    92
         5 002707   200252 757100                    STAQ    @TARGET+8,,AUTO
         5 002710   200246 630500                    EPPR0   @TARGET+4,,AUTO
         5 002711   200251 450500                    STP0    @TARGET+7,,AUTO
         5 002712   000133 236000 6                  LDQ     91
         5 002713   200250 756100                    STQ     @TARGET+6,,AUTO
         5 002714   200250 630500                    EPPR0   @TARGET+6,,AUTO
         5 002715   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 002716   000000 701000 xent               TSX1    KSE$ERRMSG
         5 002717   000000 011000                    NOP     0

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:321  
     1719    12322                                     /*E* ERROR: KSN-E$KS_BADPRMVAL-0
     1720    12323                                          MESSAGE: Specified value is outside of bounds
     1721    12324                                         %U3 to %U2, set for this parameter on handler %U1.
     1722    12325                               DESCRIPTION: VALUE LARGER/SMALLER THEN SPECIFIED MAX/MIN. */
     1723    12326    6                                GOTO SET_ERR;

  12326  5 002720   003344 710000 5                  TRA     SET_ERR

     1724    12327    6                             END;
     1725    12328    5                          END;
     1726    12329    4                    IF (BLK$->OUT$BLK.NSUBLKS = 3) THEN

  12329  5 002721   200145 470500                    LDP0    BLK$,,AUTO
         5 002722   000001 220100                    LDX0    1,,PR0
         5 002723   000003 100003                    CMPX0   3,DU
         5 002724   002734 601000 5                  TNZ     s:12332

     1727    12330    4                      PERM_PARM = BLK$->OUT$BLK.SUBLK$(2)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             12330                                CODE;

  12330  5 002725   000005 471500                    LDP1    5,,PR0
         5 002726   100003 473500                    LDP3    3,,PR1
         5 002727   300000 236100                    LDQ     0,,PR3
         5 002730   777777 376007                    ANQ     -1,DL
         5 002731   000033 736000                    QLS     27
         5 002732   200132 756100                    STQ     PERM_PARM,,AUTO
         5 002733   002740 710000 5                  TRA     s:12334

     1728    12331    4                    ELSE
     1729    12332    4                       PERM_PARM = KS_SELPRMOPT;

  12332  5 002734   000000 236000 xsym               LDQ     KS_SELPRMOPT
         5 002735   000033 772000                    QRL     27
         5 002736   000033 736000                    QLS     27
         5 002737   200132 756100                    STQ     PERM_PARM,,AUTO

     1730    12333
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:322  
     1731    12334    4                    IF PERM_PARM = %KS_TEMP OR PERM_PARM = %KS_PERM THEN

  12334  5 002740   200132 236100                    LDQ     PERM_PARM,,AUTO
         5 002741   777000 376003                    ANQ     -512,DU
         5 002742   001000 116003                    CMPQ    512,DU
         5 002743   002746 600000 5                  TZE     s:12336
         5 002744   002000 116003                    CMPQ    1024,DU
         5 002745   003077 601000 5                  TNZ     UPDATE_FILE

     1732    12335    5                       DO;

     1733    12336    5                    KS_CONTROL.CMD = %KL_CONTROL_SET;

  12336  5 002746   000001 221003                    LDX1    1,DU
         5 002747   001233 441000 2                  SXL1    KS_CONTROL+8

     1734    12337    5                    KS_CONTROL.PARMX = PARMX;

  12337  5 002750   200130 720100                    LXL0    PARMX,,AUTO
         5 002751   001234 740000 2                  STX0    KS_CONTROL+9

     1735    12338    5                    KS_CONTROL.INDX = INDX;

  12338  5 002752   200017 722100                    LXL2    INDX,,AUTO
         5 002753   001234 442000 2                  SXL2    KS_CONTROL+9

     1736    12339    5   IF PTR$->OUT$BLK.CODE = %KS_DECVAL OR PTR$->OUT$BLK.CODE = %KS_HEXVAL THEN

  12339  5 002754   200147 471500                    LDP1    PTR$,,AUTO
         5 002755   100000 723100                    LXL3    0,,PR1
         5 002756   000001 103003                    CMPX3   1,DU
         5 002757   002762 600000 5                  TZE     s:12340
         5 002760   000004 103003                    CMPX3   4,DU
         5 002761   002773 601000 5                  TNZ     s:12342

     1737    12340    5                       CALL KSU$UNPACK (VALUE,KS_CONTROL.VALUE);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:323  
  12340  5 002762   000136 236000 6                  LDQ     94
         5 002763   200245 756100                    STQ     @TARGET+3,,AUTO
         5 002764   200143 633500                    EPPR3   VALUE,,AUTO
         5 002765   200244 453500                    STP3    @TARGET+2,,AUTO
         5 002766   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 002767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 002770   000000 701000 xent               TSX1    KSU$UNPACK
         5 002771   000000 011000                    NOP     0
         5 002772   002775 710000 5                  TRA     s:12343

     1738    12341    5                    ELSE
     1739    12342    5                       KS_CONTROL.VALUE = VALUE;

  12342  5 002773   200143 724100                    LXL4    VALUE,,AUTO
         5 002774   001235 744000 2                  STX4    KS_CONTROL+10

     1740    12343    5                    CALL KSR$WR_HLPCG(VECTOR(KS_CONTROL)) ALTRET(UPDATE_FILE);

  12343  5 002775   000142 630400 6                  EPPR0   98
         5 002776   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 002777   000000 701000 xent               TSX1    KSR$WR_HLPCG
         5 003000   003077 702000 5                  TSX2    UPDATE_FILE

     1741    12344    5                    CALL KSR$RD_HLPCG ('0'B)

  12344  5 003001   000143 630400 6                  EPPR0   99
         5 003002   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003003   000000 701000 xent               TSX1    KSR$RD_HLPCG
         5 003004   003012 702000 5                  TSX2    s:12351

     1742    12345    6                       WHENRETURN DO;

     1743    12346    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12346                                   VECTOR(FEP));

  12346  5 003005   000146 630400 6                  EPPR0   102
         5 003006   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:324  
         5 003007   000000 701000 xent               TSX1    KSW$WRITE
         5 003010   000000 011000                    NOP     0

     1744    12347                                    /*E* ERROR: KSN-E$KS_PARMSET-0
     1745    12348                                         MESSAGE: %U1 set successfully.*/
     1746    12349    6                       END;

  12349  5 003011   003077 710000 5                  TRA     UPDATE_FILE

     1747    12350    6                       WHENALTRETURN DO;

     1748    12351    7                          DO SELECT (KS$HDR.RESULTS.ERR#);

  12351  5 003012   001222 470400 2                  LDP0    HDR$
         5 003013   000007 236100                    LDQ     7,,PR0
         5 003014   000003 772000                    QRL     3
         5 003015   037777 376007                    ANQ     16383,DL
         5 003016   002354 116007                    CMPQ    1260,DL
         5 003017   003030 602000 5                  TNC     s:12351+14
         5 003020   003045 600000 5                  TZE     s:12355
         5 003021   003030 116007                    CMPQ    1560,DL
         5 003022   003077 602000 5                  TNC     UPDATE_FILE
         5 003023   003065 600000 5                  TZE     s:12364
         5 003024   000003 736000                    QLS     3
         5 003025   030310 116007                    CMPQ    12488,DL
         5 003026   003077 601000 5                  TNZ     UPDATE_FILE
         5 003027   003072 710000 5                  TRA     s:12366
         5 003030   000007 236100                    LDQ     7,,PR0
         5 003031   377770 376007                    ANQ     131064,DL
         5 003032   023070 116007                    CMPQ    9784,DL
         5 003033   003077 601000 5                  TNZ     UPDATE_FILE
         5 003034   003035 710000 5                  TRA     s:12353

     1749    12352    7                             SELECT (%E$NODENA);

     1750    12353    7                                CALL XUR$ERRMSG(KS_HDR.RESULTS);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:325  
  12353  5 003035   000000 236000 xsym               LDQ     KS_MSGBUF$
         5 003036   000007 036003                    ADLQ    7,DU
         5 003037   200244 756100                    STQ     @TARGET+2,,AUTO
         5 003040   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 003041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003042   000000 701000 xent               TSX1    XUR$ERRMSG
         5 003043   000000 011000                    NOP     0
         5 003044   003077 710000 5                  TRA     UPDATE_FILE

     1751    12354    7                             SELECT (%E$NOHANDLER);

     1752    12355    7                                IF PARMTYPE = %KS_NODEADMN_PARAM THEN

  12355  5 003045   200131 235100                    LDA     PARMTYPE,,AUTO
         5 003046   000010 115007                    CMPA    8,DL
         5 003047   003055 601000 5                  TNZ     s:12362

     1753    12356    7                                   CALL KSE$ERRMSG(%E$KS_INIT_ONLY,

  12356  5 003050   000151 630400 6                  EPPR0   105
         5 003051   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 003052   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003053   000000 011000                    NOP     0
         5 003054   003077 710000 5                  TRA     UPDATE_FILE

     1754    12357    7                                      VECTOR(KS_SUB_BUF_1));
     1755    12358                                        /*E* ERROR: KSN-E$KS_INIT_ONLY-0
     1756    12359                                           MESSAGE: %U1 is only settable at initialization.
     1757    12360          MESSAGE1: This parameter is not allowed to be set while the handler is running.*/
     1758    12361    7                                ELSE
     1759    12362    7                                   CALL XUR$ERRMSG(KS_HDR.RESULTS);

  12362  5 003055   000000 236000 xsym               LDQ     KS_MSGBUF$
         5 003056   000007 036003                    ADLQ    7,DU
         5 003057   200244 756100                    STQ     @TARGET+2,,AUTO
         5 003060   200244 630500                    EPPR0   @TARGET+2,,AUTO
         5 003061   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:326  
         5 003062   000000 701000 xent               TSX1    XUR$ERRMSG
         5 003063   000000 011000                    NOP     0
         5 003064   003077 710000 5                  TRA     UPDATE_FILE

     1760    12363    7                             SELECT (%E$PARM_INITONLY);

     1761    12364    7                               CALL KSE$ERRMSG (%E$KS_INIT_ONLY,VECTOR(KS_SUB_BUF_1));

  12364  5 003065   000151 630400 6                  EPPR0   105
         5 003066   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 003067   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003070   000000 011000                    NOP     0
         5 003071   003077 710000 5                  TRA     UPDATE_FILE

     1762    12365    7                             SELECT (%E$PARM_UNDEF);

     1763    12366    7                                CALL KSE$ERRMSG (%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),
             12366                                         VECTOR(KS_SUB_BUF_2));

  12366  5 003072   000113 630400 6                  EPPR0   75
         5 003073   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 003074   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003075   000000 011000                    NOP     0

     1764    12367    7                                GOTO SET_ERR;

  12367  5 003076   003344 710000 5                  TRA     SET_ERR

     1765    12368    7                          END;

     1766    12369    6                       END;
     1767    12370    5                       END;  /* not disponly and ( perm or term ) */

     1768    12371    4   UPDATE_FILE:     IF PERM_PARM = %KS_FILE OR PERM_PARM = %KS_PERM THEN

  12371  5 003077   200132 236100       UPDATE_FILE  LDQ     PERM_PARM,,AUTO
         5 003100   777000 376003                    ANQ     -512,DU
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:327  
         5 003101   003000 116003                    CMPQ    1536,DU
         5 003102   003105 600000 5                  TZE     s:12373
         5 003103   002000 116003                    CMPQ    1024,DU
         5 003104   003343 601000 5                  TNZ     s:12449

     1769    12372    5                      DO; /* update :NETCON FILE */

     1770    12373    6                       DO CASE(PARMTYPE);

  12373  5 003105   200131 235100                    LDA     PARMTYPE,,AUTO
         5 003106   000003 115007                    CMPA    3,DL
         5 003107   003111 602005 5                  TNC     s:12373+4,AL
         5 003110   003147 710000 5                  TRA     s:12385
         5 003111   003147 710000 5                  TRA     s:12385
         5 003112   003147 710000 5                  TRA     s:12385
         5 003113   003114 710000 5                  TRA     s:12375

     1771    12374    6                          CASE(%KS_LCP6_PARAM);

     1772    12375    6                          KS_FEPCTL_KEY.NODE = KS_NODE;

  12375  5 003114   000000 236000 xsym               LDQ     KS_NODE
         5 003115   000011 736000                    QLS     9
         5 003116   000373 552010 2                  STBQ    KS_FEPCTL_KEY,'10'O

     1773    12376    6                             READ_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);

  12376  5 003117   000154 237000 6                  LDAQ    108
         5 003120   001276 757000 2                  STAQ    READ_NETCON+2

     1774    12377    6                             READ_NETCON.BUF_ = VECTOR(KS_FEPCTL);

  12377  5 003121   000156 237000 6                  LDAQ    110
         5 003122   001300 757000 2                  STAQ    READ_NETCON+4

     1775    12378    6                             CALL M$READ(READ_NETCON) ALTRET(UPD_NETCON_ERR);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:328  
  12378  5 003123   001274 630400 2                  EPPR0   READ_NETCON
         5 003124   440000 713400                    CLIMB   alt,read
         5 003125   401400 401760                    pmme    nvectors=4
         5 003126   003333 702000 5                  TSX2    UPD_NETCON_ERR

     1776    12379    6                             KS_FEPCTL.PARAMS(PARMX) = VALUE;

  12379  5 003127   200130 720100                    LXL0    PARMX,,AUTO
         5 003130   200143 235100                    LDA     VALUE,,AUTO
         5 003131   000346 755010 2                  STA     KS_FEPCTL+1,X0

     1777    12380    6                             WRITE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);

  12380  5 003132   000154 237000 6                  LDAQ    108
         5 003133   001314 757000 2                  STAQ    WRITE_NETCON+2

     1778    12381    6                             WRITE_NETCON.BUF_ = VECTOR(KS_FEPCTL);

  12381  5 003134   000156 237000 6                  LDAQ    110
         5 003135   001316 757000 2                  STAQ    WRITE_NETCON+4

     1779    12382    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);

  12382  5 003136   001312 630400 2                  EPPR0   WRITE_NETCON
         5 003137   440001 713400                    CLIMB   alt,write
         5 003140   401400 401760                    pmme    nvectors=4
         5 003141   003333 702000 5                  TSX2    UPD_NETCON_ERR

     1780    12383    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12383                                   VECTOR(NETCON));

  12383  5 003142   000120 630400 6                  EPPR0   80
         5 003143   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 003144   000000 701000 xent               TSX1    KSW$WRITE
         5 003145   000000 011000                    NOP     0
         5 003146   003332 710000 5                  TRA     s:12440

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:329  
     1781    12384    6                          CASE(ELSE);

     1782    12385    6                          KS_HANDLER_KEY.NODE = KS_NODE;

  12385  5 003147   000000 236000 xsym               LDQ     KS_NODE
         5 003150   000011 736000                    QLS     9
         5 003151   000307 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1783    12386    6                             KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;

  12386  5 003152   040000 100400                    MLR     fill='040'O
         5 003153   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         5 003154   000307 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1784    12387    6                             CALL KSU$READ_NETCON(VECTOR(KS_HANDLER_KEY),VECTOR(
             12387                                      HNDLR_BUF))

  12387  5 003155   000070 630400 6                  EPPR0   56
         5 003156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 003157   000000 701000 xent               TSX1    KSU$READ_NETCON
         5 003160   003162 702000 5                  TSX2    s:12389
         5 003161   003167 710000 5                  TRA     s:12392

     1785    12388    7                                WHENALTRETURN DO;

     1786    12389    7                                   CALL KSE$ERRMSG(%E$KS_HAND_NOT_DEF,VECTOR(
             12389                                            KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));

  12389  5 003162   000160 630400 6                  EPPR0   112
         5 003163   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 003164   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003165   000000 011000                    NOP     0

     1787    12390    7                                   GOTO SET_ERR;

  12390  5 003166   003344 710000 5                  TRA     SET_ERR

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:330  
     1788    12391    7                                END;
     1789    12392    6                             IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN

  12392  5 003167   200131 720100                    LXL0    PARMTYPE,,AUTO
         5 003170   000000 470410 xsym               LDP0    KS_TBL,X0
         5 003171   200130 235100                    LDA     PARMX,,AUTO
         5 003172   000002 735000                    ALS     2
         5 003173   000001 234105                    SZN     1,AL,PR0
         5 003174   003246 605000 5                  TPL     s:12408

     1790    12393    7                                DO;

     1791    12394    7                                INDX_R = PARMX - %KL_HNDLRPARM_BLOCK;

  12394  5 003175   200130 236100                    LDQ     PARMX,,AUTO
         5 003176   000035 136007                    SBLQ    29,DL
         5 003177   000033 736000                    QLS     27
         5 003200   200152 756100                    STQ     INDX_R,,AUTO

     1792    12395    7                                IF KS$HNDLR.NPARAMI <= INDX_R THEN

  12395  5 003201   000160 471400 2                  LDP1    HANDLER$
         5 003202   100014 236100                    LDQ     12,,PR1
         5 003203   000777 376007                    ANQ     511,DL
         5 003204   200244 756100                    STQ     @TARGET+2,,AUTO
         5 003205   200152 236100                    LDQ     INDX_R,,AUTO
         5 003206   000033 772000                    QRL     27
         5 003207   200244 116100                    CMPQ    @TARGET+2,,AUTO
         5 003210   003227 604000 5                  TMI     s:12403

     1793    12396    8                                   DO;

     1794    12397    8                                   IF KS$HNDLR.IPARAM.ARRAY_SZ(INDX_R) > INDX THEN

  12397  5 003211   100033 236106                    LDQ     27,QL,PR1
         5 003212   000011 772000                    QRL     9
         5 003213   000777 376007                    ANQ     511,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:331  
         5 003214   200017 116100                    CMPQ    INDX,,AUTO
         5 003215   003227 602000 5                  TNC     s:12403
         5 003216   003227 600000 5                  TZE     s:12403

     1795    12398    9                                      DO;

     1796    12399    9                                      KS$HNDLR.IPARAM.ARRAY_SZ(INDX_R) = INDX;

  12399  5 003217   200152 236100                    LDQ     INDX_R,,AUTO
         5 003220   000033 772000                    QRL     27
         5 003221   000000 621006                    EAX1    0,QL
         5 003222   200017 236100                    LDQ     INDX,,AUTO
         5 003223   000011 736000                    QLS     9
         5 003224   100033 676111                    ERQ     27,X1,PR1
         5 003225   777000 376007                    ANQ     -512,DL
         5 003226   100033 656111                    ERSQ    27,X1,PR1

     1797    12400    9                                      END;

     1798    12401    8                                   END;

     1799    12402
     1800    12403    7                                PTR$ = ADDR(HNDLR_BUF);

  12403  5 003227   000021 236000 6                  LDQ     17
         5 003230   200147 756100                    STQ     PTR$,,AUTO

     1801    12404    7                                PTR$ = PINCRW(PTR$,KS$HNDLR.IPARAM.OFFSET(INDX_R));

  12404  5 003231   200152 236100                    LDQ     INDX_R,,AUTO
         5 003232   000033 772000                    QRL     27
         5 003233   100034 221106                    LDX1    28,QL,PR1
         5 003234   000000 636011                    EAQ     0,X1
         5 003235   200147 036100                    ADLQ    PTR$,,AUTO
         5 003236   200147 756100                    STQ     PTR$,,AUTO

     1802    12405    7                                PTR$->VALUE_B(INDX) = VALUE;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:332  

  12405  5 003237   200017 235100                    LDA     INDX,,AUTO
         5 003240   000001 735000                    ALS     1
         5 003241   200147 470500                    LDP0    PTR$,,AUTO
         5 003242   000105 101500                    MRL     fill='000'O
         5 003243   200143 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         5 003244   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2

     1803    12406    7                                END;

  12406  5 003245   003256 710000 5                  TRA     s:12422

     1804    12407    7                             ELSE DO;

     1805    12408    7                                PTR$ = ADDR(HNDLR_BUF);

  12408  5 003246   000021 236000 6                  LDQ     17
         5 003247   200147 756100                    STQ     PTR$,,AUTO

     1806    12409    7                                KS$HNDLR.PARAMS(PARMX) = VALUE;

  12409  5 003250   200130 235100                    LDA     PARMX,,AUTO
         5 003251   000001 735000                    ALS     1
         5 003252   000160 471400 2                  LDP1    HANDLER$
         5 003253   000105 101500                    MRL     fill='000'O
         5 003254   200143 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         5 003255   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2

     1807    12410    7                                END;

     1808    12411
     1809    12412        /*
     1810    12413                Now figure out the size of the structure and (if possible)
     1811    12414                write it back out to the :NETCON file
     1812    12415        */
     1813    12416
     1814    12417        /*
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:333  
     1815    12418                   sz = number of elements in array * size of each element
     1816    12419                        + 4 bytes for the offset.
     1817    12420        */
     1818    12421
     1819    12422    6                             WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  12422  5 003256   000016 237000 6                  LDAQ    14
         5 003257   001314 757000 2                  STAQ    WRITE_NETCON+2

     1820    12423    6                             WRITE_NETCON.BUF_ = VECTOR(HNDLR_BUF);

  12423  5 003260   000020 237000 6                  LDAQ    16
         5 003261   001316 757000 2                  STAQ    WRITE_NETCON+4

     1821    12424    6                             IF KS$HNDLR.NPARAMI > 0 THEN

  12424  5 003262   100014 236100                    LDQ     12,,PR1
         5 003263   000777 316007                    CANQ    511,DL
         5 003264   003303 600000 5                  TZE     s:12430

     1822    12425    7                                DO;

     1823    12426    7                                PTR$ = PINCRW(ADDR(HNDLR_BUF),KS$HNDLR.IPARAM.OFFSET(
             12426                                         KS$HNDLR.NPARAMI - 1));

  12426  5 003265   100014 721100                    LXL1    12,,PR1
         5 003266   000777 361003                    ANX1    511,DU
         5 003267   100033 222111                    LDX2    27,X1,PR1
         5 003270   000013 630412 2                  EPPR0   HNDLR_BUF,X2
         5 003271   200147 450500                    STP0    PTR$,,AUTO

     1824    12427    7                                PTR$ = PINCRW(PTR$,(KS$HNDLR.IPARAM.ARRAY_SZ(KS$HNDLR.
             12427                                         NPARAMI - 1) + 2)/2);

  12427  5 003272   100032 236111                    LDQ     26,X1,PR1
         5 003273   000011 772000                    QRL     9
         5 003274   000777 376007                    ANQ     511,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:334  
         5 003275   000002 036007                    ADLQ    2,DL
         5 003276   000001 772000                    QRL     1
         5 003277   000022 736000                    QLS     18
         5 003300   200147 036100                    ADLQ    PTR$,,AUTO
         5 003301   200147 756100                    STQ     PTR$,,AUTO

     1825    12428    7                                END;

  12428  5 003302   003307 710000 5                  TRA     s:12433

     1826    12429    7                             ELSE DO;

     1827    12430    7                                PTR$ = ADDR(HNDLR_BUF);

  12430  5 003303   000021 236000 6                  LDQ     17
         5 003304   200147 756100                    STQ     PTR$,,AUTO

     1828    12431    7                                PTR$ = PINCRW(PTR$,SIZEW(KS_HANDLER)+1);

  12431  5 003305   000037 036003                    ADLQ    31,DU
         5 003306   200147 756100                    STQ     PTR$,,AUTO

     1829    12432    7                             END;

     1830    12433    6                            WRITE_NETCON.BUF_.BOUND = POFFC(PTR$,ADDR(HNDLR_BUF)) - 1;

  12433  5 003307   000021 236000 6                  LDQ     17
         5 003310   000020 772000                    QRL     16
         5 003311   200244 756100                    STQ     @TARGET+2,,AUTO
         5 003312   200147 236100                    LDQ     PTR$,,AUTO
         5 003313   000020 772000                    QRL     16
         5 003314   200244 136100                    SBLQ    @TARGET+2,,AUTO
         5 003315   000001 136007                    SBLQ    1,DL
         5 003316   000020 736000                    QLS     16
         5 003317   001316 676000 2                  ERQ     WRITE_NETCON+4
         5 003320   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 003321   001316 656000 2                  ERSQ    WRITE_NETCON+4
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:335  

     1831    12434    6                             CALL M$WRITE(WRITE_NETCON) ALTRET(UPD_NETCON_ERR);

  12434  5 003322   001312 630400 2                  EPPR0   WRITE_NETCON
         5 003323   440001 713400                    CLIMB   alt,write
         5 003324   401400 401760                    pmme    nvectors=4
         5 003325   003333 702000 5                  TSX2    UPD_NETCON_ERR

     1832    12435    6                          CALL KSW$WRITE(WRITE_SUCCESSFULL_VEC,VECTOR(KS_SUB_BUF_1),
             12435                                   VECTOR(NETCON));

  12435  5 003326   000120 630400 6                  EPPR0   80
         5 003327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 003330   000000 701000 xent               TSX1    KSW$WRITE
         5 003331   000000 011000                    NOP     0

     1833    12436                                  /*E* ERROR: KSN-E$KS_WRITEOK-0
     1834    12437                                       MESSAGE: %U1 successfully written to :NETCON
     1835    12438                                       DESCRIPTION: SEE MESSAGE */
     1836    12439    6                          END;  /* DO CASE(PARMTYPE) */

     1837    12440    6                       DO WHILE('0'B);

  12440  5 003332   003343 710000 5                  TRA     s:12449

     1838    12441    6      UPD_NETCON_ERR:     CALL KSE$ERRMSG(0);

  12441  5 003333   000143 630400 6     UPD_NETCON_* EPPR0   99
         5 003334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003335   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003336   000000 011000                    NOP     0

     1839    12442    6                          CALL KSE$ERRMSG(%E$KS_NETCON_ERR);

  12442  5 003337   000163 630400 6                  EPPR0   115
         5 003340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003341   000000 701000 xent               TSX1    KSE$ERRMSG
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:336  
         5 003342   000000 011000                    NOP     0

     1840    12443                               /*E* ERROR: KSN-E$KS_NETCON_ERR-0
     1841    12444                                    MESSAGE: Unable to access :NETCON.  The value set
     1842    12445                                            will not be restored when the node is rebooted.
     1843    12446                                    DESCRIPTION: COULDN'T GET TO :NETCON.  */
     1844    12447    6                          END;  /* DO NEVER */

     1845    12448    5                       END;  /* IF UPDATE :NETCON */

     1846    12449    5                    DO WHILE('0'B);

  12449  5 003343   003353 710000 5                  TRA     s:12456

     1847    12450    5      SET_ERR:         CALL KSE$ERRMSG(%E$KS_CANTSETPARM,VECTOR(KS_SUB_BUF_1));

  12450  5 003344   000165 630400 6     SET_ERR      EPPR0   117
         5 003345   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 003346   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003347   000000 011000                    NOP     0

     1848    12451                            /*E* ERROR: KSN-E$KS_CANTSETPARM-0
     1849    12452                                 MESSAGE: Unable to set %U1.
     1850    12453                                 DESCRIPTION: SEE MESSAGE */
     1851    12454    5                       PROMPT.NODENAME = KS_NODENAME;

  12454  5 003350   040000 100400                    MLR     fill='040'O
         5 003351   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 003352   000000 000010 xsym               ADSC9   PROMPT                   cn=0,n=8

     1852    12455    5                       END;  /* DO NEVER */

     1853    12456    4                    END;  /* DO K */

  12456  5 003353   200103 235100                    LDA     K,,AUTO
         5 003354   000001 035007                    ADLA    1,DL
         5 003355   200103 755100                    STA     K,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:337  
         5 003356   200103 236100                    LDQ     K,,AUTO
         5 003357   200133 116100                    CMPQ    NUM_INDX,,AUTO
         5 003360   002377 602000 5                  TNC     s:12264
         5 003361   003726 710000 5                  TRA     END_LOOP

     1854    12457        %EJECT;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:338  
     1855    12458    3              CASE(%KS_PSEUDO);

     1856    12459    3                 KS_PSEUDO_KEY.NODE = KS_NODE;

  12459  5 003362   000000 236000 xsym               LDQ     KS_NODE
         5 003363   000011 736000                    QLS     9
         5 003364   001221 552010 2                  STBQ    KS_PSEUDO_KEY,'10'O

     1857    12460    3                 READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  12460  5 003365   000170 237000 6                  LDAQ    120
         5 003366   001276 757000 2                  STAQ    READ_NETCON+2

     1858    12461    3                 READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);

  12461  5 003367   000172 237000 6                  LDAQ    122
         5 003370   001300 757000 2                  STAQ    READ_NETCON+4

     1859    12462    3                 CALL M$READ(READ_NETCON) WHENALTRETURN

  12462  5 003371   001274 630400 2                  EPPR0   READ_NETCON
         5 003372   440000 713400                    CLIMB   alt,read
         5 003373   401400 401760                    pmme    nvectors=4
         5 003374   003376 702000 5                  TSX2    s:12464
         5 003375   003407 710000 5                  TRA     s:12476

     1860    12463    4                    DO;

     1861    12464    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY THEN

  12464  5 003376   000000 470400 xsym               LDP0    B$TCB$
         5 003377   000000 471500                    LDP1    0,,PR0
         5 003400   100102 236100                    LDQ     66,,PR1
         5 003401   377770 376007                    ANQ     131064,DL
         5 003402   001020 116007                    CMPQ    528,DL
         5 003403   003671 601000 5                  TNZ     PSEUDO_SET_ERR

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:339  
     1862    12465    4                       GOTO PSEUDO_SET_ERR;
     1863    12466    4                    KS_PSEUDO = '0'B;

  12466  5 003404   000000 100400                    MLR     fill='000'O
         5 003405   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 003406   000453 002630 2                  ADSC9   KS_PSEUDO                cn=0,n=1432

     1864    12467    4                    END;  /* when altreturn on READ  */

     1865    12468
     1866    12469        /*
     1867    12470                   Quickly,  If no PSEUDOs exists with that name, then stuff
     1868    12471                   the record with the info off the parse tree.  If a PSEUDO
     1869    12472                   does exist with that name then just update and rewrite to
     1870    12473                   :NETCON.
     1871    12474        */
     1872    12475
     1873    12476    3              T_PSEUDO# = -1;

  12476  5 003407   000001 335007                    LCA     1,DL
         5 003410   200141 755100                    STA     T_PSEUDO#,,AUTO

     1874    12477    4   PSEDO_SRCH: DO J = 0 TO KS_PSEUDO.PSEUDO#-1;

  12477  5 003411   200102 450100       PSEDO_SRCH   STZ     J,,AUTO
         5 003412   003434 710000 5                  TRA     s:12483+3

     1875    12478    4                 IF KS_PSEUDO.PSEUDO.NAME(J) = BLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT
             12478                          THEN

  12478  5 003413   200145 470500                    LDP0    BLK$,,AUTO
         5 003414   000003 471500                    LDP1    3,,PR0
         5 003415   100004 236100                    LDQ     4,,PR1
         5 003416   000033 772000                    QRL     27
         5 003417   000000 620006                    EAX0    0,QL
         5 003420   200102 236100                    LDQ     J,,AUTO
         5 003421   000034 402007                    MPY     28,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:340  
         5 003422   040140 106406                    CMPC    fill='040'O
         5 003423   000454 000010 2                  ADSC9   KS_PSEUDO+1,Q            cn=0,n=8
         5 003424   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         5 003425   003431 601000 5                  TNZ     s:12483

     1876    12479    5                    DO;

     1877    12480    5                    T_PSEUDO# = J;

  12480  5 003426   200102 235100                    LDA     J,,AUTO
         5 003427   200141 755100                    STA     T_PSEUDO#,,AUTO

     1878    12481    5                    EXIT PSEDO_SRCH;

  12481  5 003430   003437 710000 5                  TRA     s:12489

     1879    12482    5                    END;
     1880    12483    4              END;  /*  do j  */

  12483  5 003431   200102 235100                    LDA     J,,AUTO
         5 003432   000001 035007                    ADLA    1,DL
         5 003433   200102 755100                    STA     J,,AUTO
         5 003434   200102 236100                    LDQ     J,,AUTO
         5 003435   000453 116000 2                  CMPQ    KS_PSEUDO
         5 003436   003413 602000 5                  TNC     s:12478

     1881    12484
     1882    12485        /*
     1883    12486                   if j is greater then maxpseudos then too many pseudos
     1884    12487        */
     1885    12488
     1886    12489    3              IF J > %KS_MAX_PSEUDO THEN

  12489  5 003437   200102 235100                    LDA     J,,AUTO
         5 003440   000010 115007                    CMPA    8,DL
         5 003441   003707 603000 5                  TRC     TOO_MANY_PSEUDO

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:341  
     1887    12490    3                 GOTO TOO_MANY_PSEUDO;
     1888    12491
     1889    12492        /*
     1890    12493                   if j=-1 then the pseudo does not exist in the record
     1891    12494        */
     1892    12495
     1893    12496    3              IF T_PSEUDO# = -1 THEN

  12496  5 003442   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003443   000027 116000 xsym               CMPQ    B_VECTNIL+23
         5 003444   003466 601000 5                  TNZ     s:12510

     1894    12497    4                 DO;

     1895    12498    4                 KS_PSEUDO.PSEUDO.NAME(KS_PSEUDO.PSEUDO#) = BLK$->OUT$BLK.SUBLK$(0)->
             12498                          OUT$SYM.TEXT;

  12498  5 003445   000453 236000 2                  LDQ     KS_PSEUDO
         5 003446   000007 402007                    MPY     7,DL
         5 003447   200145 470500                    LDP0    BLK$,,AUTO
         5 003450   000003 471500                    LDP1    3,,PR0
         5 003451   000000 620006                    EAX0    0,QL
         5 003452   100004 236100                    LDQ     4,,PR1
         5 003453   000033 772000                    QRL     27
         5 003454   000000 635010                    EAA     0,X0
         5 003455   000020 771000                    ARL     16
         5 003456   000000 621006                    EAX1    0,QL
         5 003457   040005 100540                    MLR     fill='040'O
         5 003460   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         5 003461   000454 000010 2                  ADSC9   KS_PSEUDO+1,A            cn=0,n=8

     1896    12499    4                 T_PSEUDO# = KS_PSEUDO.PSEUDO#;

  12499  5 003462   000453 235000 2                  LDA     KS_PSEUDO
         5 003463   200141 755100                    STA     T_PSEUDO#,,AUTO

     1897    12500    4                 KS_PSEUDO.PSEUDO# = KS_PSEUDO.PSEUDO# + 1;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:342  

  12500  5 003464   000001 035007                    ADLA    1,DL
         5 003465   000453 755000 2                  STA     KS_PSEUDO

     1898    12501    4                 END;  /*  if no pseudo defined  */

     1899    12502
     1900    12503        /*
     1901    12504                at this point whether the pseudo existed or not does not
     1902    12505                matter.  The code continues in such a way as to treat both
     1903    12506                cases the same.  All of the sub-blocks are evaluated and
     1904    12507                and placed into the record as specified.
     1905    12508        */
     1906    12509
     1907    12510    4                 DO K= 1 TO BLK$->OUT$BLK.NSUBLKS - 1;

  12510  5 003466   000001 235007                    LDA     1,DL
         5 003467   200103 755100                    STA     K,,AUTO
         5 003470   003643 710000 5                  TRA     s:12538+3

     1908    12511    4                    SUBLK$ = BLK$->OUT$BLK.SUBLK$(K);

  12511  5 003471   200145 470500                    LDP0    BLK$,,AUTO
         5 003472   200103 720100                    LXL0    K,,AUTO
         5 003473   000003 236110                    LDQ     3,X0,PR0
         5 003474   200135 756100                    STQ     SUBLK$,,AUTO

     1909    12512    5                    DO CASE(SUBLK$->OUT$BLK.CODE);

  12512  5 003475   200135 471500                    LDP1    SUBLK$,,AUTO
         5 003476   100000 721100                    LXL1    0,,PR1
         5 003477   000005 101003                    CMPX1   5,DU
         5 003500   003502 602011 5                  TNC     s:12512+5,X1
         5 003501   003640 710000 5                  TRA     s:12538
         5 003502   003507 710000 5                  TRA     s:12515
         5 003503   003553 710000 5                  TRA     s:12524
         5 003504   003531 710000 5                  TRA     s:12520
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:343  
         5 003505   003575 710000 5                  TRA     s:12529
         5 003506   003617 710000 5                  TRA     s:12534

     1910    12513
     1911    12514    5                       CASE(%KS_MAXC);

     1912    12515    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12515                                   THEN GOTO TOO_BIG;

  12515  5 003507   100003 473500                    LDP3    3,,PR1
         5 003510   300004 236100                    LDQ     4,,PR3
         5 003511   777000 376003                    ANQ     -512,DU
         5 003512   007000 116003                    CMPQ    3584,DU
         5 003513   003721 603000 5                  TRC     TOO_BIG

     1913    12516    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  12516  5 003514   300004 236100                    LDQ     4,,PR3
         5 003515   000033 772000                    QRL     27
         5 003516   000000 622006                    EAX2    0,QL
         5 003517   000100 305540                    DTB
         5 003520   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         5 003521   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 003522   200245 235100                    LDA     @TARGET+3,,AUTO
         5 003523   200137 755100                    STA     TEMP1,,AUTO

     1914    12517    5                          KS_PSEUDO.PSEUDO.MAX_CG(T_PSEUDO#) = TEMP1;

  12517  5 003524   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003525   000007 402007                    MPY     7,DL
         5 003526   200137 235100                    LDA     TEMP1,,AUTO
         5 003527   000460 755006 2                  STA     KS_PSEUDO+5,QL
         5 003530   003640 710000 5                  TRA     s:12538

     1915    12518
     1916    12519    5                       CASE(%KS_MAXH);

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:344  
     1917    12520    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12520                                   THEN GOTO TOO_BIG;

  12520  5 003531   100003 473500                    LDP3    3,,PR1
         5 003532   300004 236100                    LDQ     4,,PR3
         5 003533   777000 376003                    ANQ     -512,DU
         5 003534   007000 116003                    CMPQ    3584,DU
         5 003535   003721 603000 5                  TRC     TOO_BIG

     1918    12521    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  12521  5 003536   300004 236100                    LDQ     4,,PR3
         5 003537   000033 772000                    QRL     27
         5 003540   000000 622006                    EAX2    0,QL
         5 003541   000100 305540                    DTB
         5 003542   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         5 003543   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 003544   200245 235100                    LDA     @TARGET+3,,AUTO
         5 003545   200137 755100                    STA     TEMP1,,AUTO

     1919    12522    5                          KS_PSEUDO.PSEUDO.MAX_HAND(T_PSEUDO#) = TEMP1;

  12522  5 003546   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003547   000007 402007                    MPY     7,DL
         5 003550   200137 235100                    LDA     TEMP1,,AUTO
         5 003551   000461 755006 2                  STA     KS_PSEUDO+6,QL
         5 003552   003640 710000 5                  TRA     s:12538

     1920    12523    5                       CASE(%KS_MAXG);

     1921    12524    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12524                                   THEN GOTO TOO_BIG;

  12524  5 003553   100003 473500                    LDP3    3,,PR1
         5 003554   300004 236100                    LDQ     4,,PR3
         5 003555   777000 376003                    ANQ     -512,DU
         5 003556   007000 116003                    CMPQ    3584,DU
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:345  
         5 003557   003721 603000 5                  TRC     TOO_BIG

     1922    12525    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  12525  5 003560   300004 236100                    LDQ     4,,PR3
         5 003561   000033 772000                    QRL     27
         5 003562   000000 622006                    EAX2    0,QL
         5 003563   000100 305540                    DTB
         5 003564   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         5 003565   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 003566   200245 235100                    LDA     @TARGET+3,,AUTO
         5 003567   200137 755100                    STA     TEMP1,,AUTO

     1923    12526    5                          KS_PSEUDO.PSEUDO.MAX_GHST(T_PSEUDO#) = TEMP1;

  12526  5 003570   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003571   000007 402007                    MPY     7,DL
         5 003572   200137 235100                    LDA     TEMP1,,AUTO
         5 003573   000462 755006 2                  STA     KS_PSEUDO+7,QL
         5 003574   003640 710000 5                  TRA     s:12538

     1924    12527
     1925    12528    5                       CASE(%KS_MAXS);

     1926    12529    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12529                                   THEN GOTO TOO_BIG;

  12529  5 003575   100003 473500                    LDP3    3,,PR1
         5 003576   300004 236100                    LDQ     4,,PR3
         5 003577   777000 376003                    ANQ     -512,DU
         5 003600   007000 116003                    CMPQ    3584,DU
         5 003601   003721 603000 5                  TRC     TOO_BIG

     1927    12530    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  12530  5 003602   300004 236100                    LDQ     4,,PR3
         5 003603   000033 772000                    QRL     27
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:346  
         5 003604   000000 622006                    EAX2    0,QL
         5 003605   000100 305540                    DTB
         5 003606   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         5 003607   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 003610   200245 235100                    LDA     @TARGET+3,,AUTO
         5 003611   200137 755100                    STA     TEMP1,,AUTO

     1928    12531    5                          KS_PSEUDO.PSEUDO.MAX_SYS(T_PSEUDO#) = TEMP1;

  12531  5 003612   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003613   000007 402007                    MPY     7,DL
         5 003614   200137 235100                    LDA     TEMP1,,AUTO
         5 003615   000456 755006 2                  STA     KS_PSEUDO+3,QL
         5 003616   003640 710000 5                  TRA     s:12538

     1929    12532
     1930    12533    5                       CASE(%KS_MAXU);

     1931    12534    5                          IF  SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT > %KS_MAX_HALF
             12534                                   THEN GOTO TOO_BIG;

  12534  5 003617   100003 473500                    LDP3    3,,PR1
         5 003620   300004 236100                    LDQ     4,,PR3
         5 003621   777000 376003                    ANQ     -512,DU
         5 003622   007000 116003                    CMPQ    3584,DU
         5 003623   003721 603000 5                  TRC     TOO_BIG

     1932    12535    5                          CALL CHARBIN(TEMP1,SUBLK$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  12535  5 003624   300004 236100                    LDQ     4,,PR3
         5 003625   000033 772000                    QRL     27
         5 003626   000000 622006                    EAX2    0,QL
         5 003627   000100 305540                    DTB
         5 003630   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         5 003631   200244 000010                    NDSC9   @TARGET+2,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         5 003632   200245 235100                    LDA     @TARGET+3,,AUTO
         5 003633   200137 755100                    STA     TEMP1,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:347  

     1933    12536    5                          KS_PSEUDO.PSEUDO.MAX_USR(T_PSEUDO#) = TEMP1;

  12536  5 003634   200141 236100                    LDQ     T_PSEUDO#,,AUTO
         5 003635   000007 402007                    MPY     7,DL
         5 003636   200137 235100                    LDA     TEMP1,,AUTO
         5 003637   000457 755006 2                  STA     KS_PSEUDO+4,QL

     1934    12537    5                       END;  /* case on subnodes  */

     1935    12538    4                 END;  /*  do k  */

  12538  5 003640   200103 235100                    LDA     K,,AUTO
         5 003641   000001 035007                    ADLA    1,DL
         5 003642   200103 755100                    STA     K,,AUTO
         5 003643   200145 470500                    LDP0    BLK$,,AUTO
         5 003644   000001 236100                    LDQ     1,,PR0
         5 003645   000022 772000                    QRL     18
         5 003646   200103 116100                    CMPQ    K,,AUTO
         5 003647   003651 600000 5                  TZE     s:12540
         5 003650   003471 603000 5                  TRC     s:12511

     1936    12539
     1937    12540    3              WRITE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  12540  5 003651   000170 237000 6                  LDAQ    120
         5 003652   001314 757000 2                  STAQ    WRITE_NETCON+2

     1938    12541    3              WRITE_NETCON.BUF_ = VECTOR(KS_PSEUDO);

  12541  5 003653   000172 237000 6                  LDAQ    122
         5 003654   001316 757000 2                  STAQ    WRITE_NETCON+4

     1939    12542    3              WRITE_NETCON.BUF_.BOUND = KS_PSEUDO.PSEUDO# * 28 + 4 - 1;

  12542  5 003655   000453 236000 2                  LDQ     KS_PSEUDO
         5 003656   000034 402007                    MPY     28,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:348  
         5 003657   000003 036007                    ADLQ    3,DL
         5 003660   000020 736000                    QLS     16
         5 003661   001316 676000 2                  ERQ     WRITE_NETCON+4
         5 003662   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 003663   001316 656000 2                  ERSQ    WRITE_NETCON+4

     1940    12543        /*            18 is # of bytes in PSEUDO array and 4 is bytes in
     1941    12544                      PSEUDO#
     1942    12545        */
     1943    12546
     1944    12547    3              CALL M$WRITE(WRITE_NETCON) ALTRET(PSEUDO_SET_ERR);

  12547  5 003664   001312 630400 2                  EPPR0   WRITE_NETCON
         5 003665   440001 713400                    CLIMB   alt,write
         5 003666   401400 401760                    pmme    nvectors=4
         5 003667   003671 702000 5                  TSX2    PSEUDO_SET_ERR

     1945    12548
     1946    12549    4              DO WHILE ('0'B);

  12549  5 003670   003726 710000 5                  TRA     END_LOOP

     1947    12550    4    PSEUDO_SET_ERR: CALL KSE$ERRMSG(0);

  12550  5 003671   000143 630400 6     PSEUDO_SET_* EPPR0   99
         5 003672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003673   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003674   000000 011000                    NOP     0

     1948    12551    4                    KS_SUB_BUF_1.COUNT = SIZEC('PSEUDO');

  12551  5 003675   006000 236003                    LDQ     3072,DU
         5 003676   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1949    12552    4                    KS_SUB_BUF_1.TEXT = 'PSEUDO';

  12552  5 003677   040000 100400                    MLR     fill='040'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:349  
         5 003700   000103 000006 1                  ADSC9   FEP+13                   cn=0,n=6
         5 003701   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1950    12553    4                    CALL KSE$ERRMSG(%E$KS_CANTSETPARM);

  12553  5 003702   000165 630400 6                  EPPR0   117
         5 003703   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003704   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003705   000000 011000                    NOP     0

     1951    12554    4                    GOTO END_LOOP;

  12554  5 003706   003726 710000 5                  TRA     END_LOOP

     1952    12555    4    TOO_MANY_PSEUDO:
     1953    12556    4                    KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);

  12556  5 003707   010000 236003       TOO_MANY_PS* LDQ     4096,DU
         5 003710   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1954    12557    4                    KS_SUB_BUF_1.TEXT = KS_NODENAME;

  12557  5 003711   040000 100400                    MLR     fill='040'O
         5 003712   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         5 003713   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1955    12558    4                    CALL KSE$ERRMSG(%E$KS_TOO_MANY_PSEUDOS,VECTOR(KS_SUB_BUF_1));

  12558  5 003714   000175 630400 6                  EPPR0   125
         5 003715   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 003716   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003717   000000 011000                    NOP     0

     1956    12559                         /*E* ERROR: KSN-E$KS_TOO_MANY_PSEUDOS-0
     1957    12560                              MESSAGE: Too many PSEUDOs set on node %U1
     1958    12561                              MESSAGE1: Use the DELETE command to remove PSEUDOs
     1959    12562                              DESCRIPTION: SEE MESSAGE      */
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:350  
     1960    12563    4                    GOTO END_LOOP;

  12563  5 003720   003726 710000 5                  TRA     END_LOOP

     1961    12564    4    TOO_BIG:
     1962    12565    4                    CALL KSE$ERRMSG(%E$KS_BADNUM);

  12565  5 003721   000200 630400 6     TOO_BIG      EPPR0   128
         5 003722   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 003723   000000 701000 xent               TSX1    KSE$ERRMSG
         5 003724   000000 011000                    NOP     0

     1963    12566                               /*E* ERROR: KSN-E$KS_BADNUM-0
     1964    12567                                    MESSAGE: Bad number.
     1965    12568                                    DESCRIPTION: SEE MESSAGE */
     1966    12569    4                    GOTO END_LOOP;

  12569  5 003725   003726 710000 5                  TRA     END_LOOP

     1967    12570    4              END;  /*   do never  */

     1968    12571
     1969    12572    3              END;  /* DO CASE(CODE) */

  12554  5 003726                       END_LOOP     null
     1970    12573    2   END_LOOP:;
     1971    12574    2           END;  /* DO I */

  12574  5 003726   200016 235100                    LDA     I,,AUTO
         5 003727   000001 035007                    ADLA    1,DL
         5 003730   200016 755100                    STA     I,,AUTO
         5 003731   200003 470500                    LDP0    @TOP$,,AUTO
         5 003732   000000 471500                    LDP1    0,,PR0
         5 003733   100001 236100                    LDQ     1,,PR1
         5 003734   000022 772000                    QRL     18
         5 003735   200016 116100                    CMPQ    I,,AUTO
         5 003736   003740 600000 5                  TZE     END_LOOP+10
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:351  
         5 003737   000015 603000 5                  TRC     s:11724
         5 003740   004342 710000 5                  TRA     s:12645

     1972    12575    1   ALTER_FID:  PROC (PTR$,TARGET);

  12575  5 003741   200240 741300       ALTER_FID    STX1  ! HANDNR+1,,AUTO

     1973    12576    2            DCL PTR$    PTR;
     1974    12577    2            DCL TARGET  CHAR(28) ALIGNED;
     1975    12578
     1976    12579    2            IF PTR$->OUT$BLK.NSUBLKS = 2 THEN

  12579  5 003742   200241 470500                    LDP0    @PTR$,,AUTO
         5 003743   000000 471500                    LDP1    0,,PR0
         5 003744   100001 220100                    LDX0    1,,PR1
         5 003745   000002 100003                    CMPX0   2,DU
         5 003746   004011 601000 5                  TNZ     s:12585

     1977    12580    2               CALL CONCAT (TARGET,

  12580  5 003747   100003 473500                    LDP3    3,,PR1
         5 003750   300004 236100                    LDQ     4,,PR3
         5 003751   000033 772000                    QRL     27
         5 003752   100004 474500                    LDP4    4,,PR1
         5 003753   000000 622006                    EAX2    0,QL
         5 003754   400004 236100                    LDQ     4,,PR4
         5 003755   000033 772000                    QRL     27
         5 003756   200242 475500                    LDP5    @TARGET,,AUTO
         5 003757   040100 100540                    MLR     fill='040'O
         5 003760   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         5 003761   500000 000034                    ADSC9   0,,PR5                   cn=0,n=28
         5 003762   000000 620006                    EAX0    0,QL
         5 003763   000000 636012                    EAQ     0,X2
         5 003764   000022 772000                    QRL     18
         5 003765   000034 116007                    CMPQ    28,DL
         5 003766   004010 603000 5                  TRC     s:12580+33
         5 003767   200244 742100                    STX2    @TARGET+2,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:352  
         5 003770   777743 622012                    EAX2    -29,X2
         5 003771   777777 662003                    ERX2    -1,DU
         5 003772   200244 235100                    LDA     @TARGET+2,,AUTO
         5 003773   000022 771000                    ARL     18
         5 003774   040145 100400                    MLR     fill='040'O
         5 003775   000201 000001 6                  ADSC9   129                      cn=0,n=1
         5 003776   500000 000012                    ADSC9   0,A,PR5                  cn=0,n=*X2
         5 003777   200244 236100                    LDQ     @TARGET+2,,AUTO
         5 004000   000022 772000                    QRL     18
         5 004001   000033 116007                    CMPQ    27,DL
         5 004002   004010 603000 5                  TRC     s:12580+33
         5 004003   777744 621006                    EAX1    -28,QL
         5 004004   777777 661003                    ERX1    -1,DU
         5 004005   040146 100540                    MLR     fill='040'O
         5 004006   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         5 004007   500000 200011                    ADSC9   0,Q,PR5                  cn=1,n=*X1
         5 004010   004101 710000 5                  TRA     s:12601

     1978    12581    2                           PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,    /* FILE NAME */
     1979    12582    2                           '.',
     1980    12583    2                           PTR$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);   /* ACCT NAME */
     1981    12584    2            ELSE
     1982    12585    2            IF PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = 1 THEN

  12585  5 004011   100003 473500                    LDP3    3,,PR1
         5 004012   300000 722100                    LXL2    0,,PR3
         5 004013   000001 102003                    CMPX2   1,DU
         5 004014   004034 601000 5                  TNZ     s:12590

     1983    12586    2               CALL CONCAT (TARGET,

  12586  5 004015   300004 236100                    LDQ     4,,PR3
         5 004016   000033 772000                    QRL     27
         5 004017   000000 623006                    EAX3    0,QL
         5 004020   200242 474500                    LDP4    @TARGET,,AUTO
         5 004021   040100 100540                    MLR     fill='040'O
         5 004022   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:353  
         5 004023   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28
         5 004024   000034 116007                    CMPQ    28,DL
         5 004025   004033 603000 5                  TRC     s:12586+14
         5 004026   777743 620006                    EAX0    -29,QL
         5 004027   777777 660003                    ERX0    -1,DU
         5 004030   040146 100400                    MLR     fill='040'O
         5 004031   000073 000005 1                  ADSC9   FEP+5                    cn=0,n=5
         5 004032   400000 000010                    ADSC9   0,Q,PR4                  cn=0,n=*X0
         5 004033   004101 710000 5                  TRA     s:12601

     1984    12587    2                           PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,   /* NAME ONLY */
     1985    12588    2                           '.:SYS');
     1986    12589    2            ELSE
     1987    12590    2            IF PTR$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = 2 THEN

  12590  5 004034   000002 102003                    CMPX2   2,DU
         5 004035   004101 601000 5                  TNZ     s:12601

     1988    12591    3               DO;  /* acct only */

     1989    12592    3                  CALL INDEX(INDX,'.',TARGET);

  12592  5 004036   200242 474500                    LDP4    @TARGET,,AUTO
         5 004037   000000 124500                    SCM     mask='000'O
         5 004040   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28
         5 004041   000201 000001 6                  ADSC9   129                      cn=0,n=1
         5 004042   200017 000100                    ARG     INDX,,AUTO

     1990    12593    4                  IF INDX >= LENGTHC(TARGET)-1 THEN DO;

  12593  5 004043   200017 235100                    LDA     INDX,,AUTO
         5 004044   000033 115007                    CMPA    27,DL
         5 004045   004071 602000 5                  TNC     s:12599

     1991    12594    4                     CALL INDEX(INDX,' ',TARGET);

  12594  5 004046   000000 124500                    SCM     mask='000'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:354  
         5 004047   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28
         5 004050   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 004051   200017 000100                    ARG     INDX,,AUTO

     1992    12595    4                     SUBSTR (TARGET,INDX,1) = '.';

  12595  5 004052   200017 235100                    LDA     INDX,,AUTO
         5 004053   040105 100400                    MLR     fill='040'O
         5 004054   000201 000001 6                  ADSC9   129                      cn=0,n=1
         5 004055   400000 000001                    ADSC9   0,A,PR4                  cn=0,n=1

     1993    12596    4                     SUBSTR (TARGET,INDX+1) = PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  12596  5 004056   000000 471500                    LDP1    0,,PR0
         5 004057   100003 473500                    LDP3    3,,PR1
         5 004060   300004 236100                    LDQ     4,,PR3
         5 004061   000033 772000                    QRL     27
         5 004062   777744 620005                    EAX0    -28,AL
         5 004063   777777 660003                    ERX0    -1,DU
         5 004064   000000 621006                    EAX1    0,QL
         5 004065   040145 100540                    MLR     fill='040'O
         5 004066   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         5 004067   400000 200010                    ADSC9   0,A,PR4                  cn=1,n=*X0

     1994    12597    4                     END;

  12597  5 004070   004101 710000 5                  TRA     s:12601

     1995    12598    3                  ELSE
     1996    12599    3                     SUBSTR (TARGET,INDX+1) = PTR$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  12599  5 004071   300004 236100                    LDQ     4,,PR3
         5 004072   000033 772000                    QRL     27
         5 004073   777744 623005                    EAX3    -28,AL
         5 004074   777777 663003                    ERX3    -1,DU
         5 004075   000000 624006                    EAX4    0,QL
         5 004076   040145 100540                    MLR     fill='040'O
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:355  
         5 004077   300004 200014                    ADSC9   4,,PR3                   cn=1,n=*X4
         5 004100   400000 200013                    ADSC9   0,A,PR4                  cn=1,n=*X3

     1997    12600    3               END;   /* acct only */

     1998    12601    2   END ALTER_FID;

  12601  5 004101   200240 221300                    LDX1  ! HANDNR+1,,AUTO
         5 004102   000001 702211                    TSX2  ! 1,X1

     1999    12602    1   RESET_PARAMS_TO_DEFAULTS: PROC;

  12602  5 004103   200240 741300       RESET_PARAM* STX1  ! HANDNR+1,,AUTO

     2000    12603
     2001    12604                                        /*
     2002    12605                                           rewrite the handler
     2003    12606                                           record.  ks$hndlr with defaults from
     2004    12607                                           ks_tables_d.
     2005    12608                                        */
     2006    12609    2                                I = 1;

  12609  5 004104   000001 235007                    LDA     1,DL
         5 004105   200016 755100                    STA     I,,AUTO

     2007    12610    3          SRCH_TBL1:             DO WHILE KS_HAND_INFO.TEXT(I) ~= ' ';

  12610  5 004106   200016 236100       SRCH_TBL1    LDQ     I,,AUTO
         5 004107   000024 402007                    MPY     20,DL
         5 004110   040000 106406                    CMPC    fill='040'O
         5 004111   000000 000010 xsym               ADSC9   KS_HAND_INFO,Q           cn=0,n=8
         5 004112   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 004113   004134 600000 5                  TZE     s:12617

     2008    12611    3                                  IF KS_HAND_INFO.TEXT(I) = SUBSTR(KS$HNDLR.HNDLRNAME,
             12611                                            0,SIZEC(KS$HNDLR.HNDLRNAME)) THEN

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:356  
  12611  5 004114   200016 236100                    LDQ     I,,AUTO
         5 004115   000024 402007                    MPY     20,DL
         5 004116   000160 470400 2                  LDP0    HANDLER$
         5 004117   040100 106406                    CMPC    fill='040'O
         5 004120   000000 000010 xsym               ADSC9   KS_HAND_INFO,Q           cn=0,n=8
         5 004121   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         5 004122   004134 600000 5                  TZE     s:12617

     2009    12612    3                                      EXIT SRCH_TBL1;
     2010    12613    3                                   ELSE
     2011    12614    3                                      I = I + 1;

  12614  5 004123   200016 235100                    LDA     I,,AUTO
         5 004124   000001 035007                    ADLA    1,DL
         5 004125   200016 755100                    STA     I,,AUTO

     2012    12615    3                                 END;

  12615  5 004126   200016 236100                    LDQ     I,,AUTO
         5 004127   000024 402007                    MPY     20,DL
         5 004130   040000 106406                    CMPC    fill='040'O
         5 004131   000000 000010 xsym               ADSC9   KS_HAND_INFO,Q           cn=0,n=8
         5 004132   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 004133   004114 601000 5                  TNZ     s:12611

     2013    12616
     2014    12617    2                                PTR$ = KS_HAND_INFO.PARAMS$(I);

  12617  5 004134   200016 236100                    LDQ     I,,AUTO
         5 004135   000005 402007                    MPY     5,DL
         5 004136   000004 236006 xsym               LDQ     KS_HAND_INFO+4,QL
         5 004137   200147 756100                    STQ     PTR$,,AUTO

     2015    12618    2                                IF KS_HAND_INFO.SZ(I) <= %KL_FIXED_HI THEN

  12618  5 004140   200016 236100                    LDQ     I,,AUTO
         5 004141   000005 402007                    MPY     5,DL
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:357  
         5 004142   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         5 004143   000036 115007                    CMPA    30,DL
         5 004144   004152 603000 5                  TRC     s:12621

     2016    12619    2                                    KS$HNDLR.NPARAMS = KS_HAND_INFO.SZ(I);

  12619  5 004145   000160 470400 2                  LDP0    HANDLER$
         5 004146   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         5 004147   000011 736000                    QLS     9
         5 004150   000014 552110                    STBQ    12,'10'O,PR0
         5 004151   004155 710000 5                  TRA     s:12622

     2017    12620    2                                ELSE
     2018    12621    2                                   KS$HNDLR.NPARAMS = %KL_FIXED_HI;

  12621  5 004152   000160 470400 2                  LDP0    HANDLER$
         5 004153   035000 236007                    LDQ     14848,DL
         5 004154   000014 552110                    STBQ    12,'10'O,PR0

     2019    12622    3                                DO K = 0 TO KS$HNDLR.NPARAMS - 1;

  12622  5 004155   200103 450100                    STZ     K,,AUTO
         5 004156   004173 710000 5                  TRA     s:12624+3

     2020    12623    3                                   KS$HNDLR.PARAMS(K) = PTR$->KS$PRM.DEFAULT(K);

  12623  5 004157   200103 235100                    LDA     K,,AUTO
         5 004160   000004 735000                    ALS     4
         5 004161   200103 236100                    LDQ     K,,AUTO
         5 004162   000001 736000                    QLS     1
         5 004163   200147 470500                    LDP0    PTR$,,AUTO
         5 004164   000160 471400 2                  LDP1    HANDLER$
         5 004165   000106 101505                    MRL     fill='000'O
         5 004166   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         5 004167   100015 000002                    ADSC9   13,Q,PR1                 cn=0,n=2

     2021    12624    3                                END;
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:358  

  12624  5 004170   200103 235100                    LDA     K,,AUTO
         5 004171   000001 035007                    ADLA    1,DL
         5 004172   200103 755100                    STA     K,,AUTO
         5 004173   000160 470400 2                  LDP0    HANDLER$
         5 004174   000014 236100                    LDQ     12,,PR0
         5 004175   000011 772000                    QRL     9
         5 004176   000777 376007                    ANQ     511,DL
         5 004177   200103 116100                    CMPQ    K,,AUTO
         5 004200   004202 600000 5                  TZE     s:12625
         5 004201   004157 603000 5                  TRC     s:12623

     2022    12625    2                                IF KS_HAND_INFO.SZ(I) > %KL_FIXED_HI THEN

  12625  5 004202   200016 236100                    LDQ     I,,AUTO
         5 004203   000005 402007                    MPY     5,DL
         5 004204   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         5 004205   000036 115007                    CMPA    30,DL
         5 004206   004336 602000 5                  TNC     s:12643

     2023    12626    3                                   DO;

     2024    12627    3                                  KS$HNDLR.NPARAMI = KS_HAND_INFO.SZ(I) - %KL_FIXED_HI
             12627                                            ;

  12627  5 004207   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         5 004210   000035 136007                    SBLQ    29,DL
         5 004211   000014 552104                    STBQ    12,'04'O,PR0

     2025    12628    3                                   OUT$ = PINCRW(ADDR(HNDLR_BUF),SIZEW(KS_HANDLER));

  12628  5 004212   000202 236000 6                  LDQ     130
         5 004213   200151 756100                    STQ     OUT$,,AUTO

     2026    12629    3                                   IF KS_HAND_INFO.SZ(I) - %KL_FIXED_HI >

  12629  5 004214   200016 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:359  
         5 004215   000005 402007                    MPY     5,DL
         5 004216   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         5 004217   000035 135007                    SBLA    29,DL
         5 004220   200244 755100                    STA     @TARGET+2,,AUTO
         5 004221   001252 236000 2                  LDQ     KS_HANDLER+12
         5 004222   000777 376007                    ANQ     511,DL
         5 004223   200244 116100                    CMPQ    @TARGET+2,,AUTO
         5 004224   004236 605000 5                  TPL     s:12632

     2027    12630    3                                      KS_HANDLER.NPARAMI THEN
     2028    12631    3  OUT$ = PINCRW(OUT$,((KS_HAND_INFO.SZ(I) - %KL_FIXED_HI - KS_HANDLER.NPARAMI) * SIZEW
             12631            (KS_HANDLER.IPARAM(0))));

  12631  5 004225   200244 756100                    STQ     @TARGET+2,,AUTO
         5 004226   200016 236100                    LDQ     I,,AUTO
         5 004227   000005 402007                    MPY     5,DL
         5 004230   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         5 004231   200244 136100                    SBLQ    @TARGET+2,,AUTO
         5 004232   000022 736000                    QLS     18
         5 004233   000035 136003                    SBLQ    29,DU
         5 004234   200151 036100                    ADLQ    OUT$,,AUTO
         5 004235   200151 756100                    STQ     OUT$,,AUTO

     2029    12632    4                                   DO K = %KL_FIXED_HI  TO KS_HAND_INFO.SZ(I) - 1;

  12632  5 004236   000035 235007                    LDA     29,DL
         5 004237   200103 755100                    STA     K,,AUTO
         5 004240   004327 710000 5                  TRA     s:12640+3

     2030    12633    4                                      DFLT_OPT$ = PTR$->KS$PRM.SPCL_TBL$(K);

  12633  5 004241   200103 235100                    LDA     K,,AUTO
         5 004242   000002 735000                    ALS     2
         5 004243   200147 470500                    LDP0    PTR$,,AUTO
         5 004244   000002 236105                    LDQ     2,AL,PR0
         5 004245   200150 756100                    STQ     DFLT_OPT$,,AUTO

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:360  
     2031    12634    4                                      KS$HNDLR.IPARAM.OFFSET(K-%KL_HNDLRPARM_BLOCK) =
             12634                                               POFFW(OUT$,ADDR(HNDLR_BUF));

  12634  5 004246   000021 236000 6                  LDQ     17
         5 004247   000022 772000                    QRL     18
         5 004250   200244 756100                    STQ     @TARGET+2,,AUTO
         5 004251   200151 236100                    LDQ     OUT$,,AUTO
         5 004252   000022 772000                    QRL     18
         5 004253   200244 136100                    SBLQ    @TARGET+2,,AUTO
         5 004254   000000 620006                    EAX0    0,QL
         5 004255   000160 471400 2                  LDP1    HANDLER$
         5 004256   200103 721100                    LXL1    K,,AUTO
         5 004257   177777 740111                    STX0    -1,X1,PR1

     2032    12635    4                                     KS$HNDLR.IPARAM.ARRAY_SZ(K-%KL_HNDLRPARM_BLOCK) =
             12635                                               KS_HAND_INFO.PARAMS$(I)->KS$PRM.ARRAY_SZ(K);

  12635  5 004260   200016 236100                    LDQ     I,,AUTO
         5 004261   000005 402007                    MPY     5,DL
         5 004262   000004 473406 xsym               LDP3    KS_HAND_INFO+4,QL
         5 004263   200103 235100                    LDA     K,,AUTO
         5 004264   000002 735000                    ALS     2
         5 004265   300001 236105                    LDQ     1,AL,PR3
         5 004266   000011 736000                    QLS     9
         5 004267   177776 676111                    ERQ     -2,X1,PR1
         5 004270   777000 376007                    ANQ     -512,DL
         5 004271   177776 656111                    ERSQ    -2,X1,PR1

     2033    12636    5                                      DO L = 0 TO KS$HNDLR.IPARAM.ARRAY_SZ(K-%
             12636                                               KL_HNDLRPARM_BLOCK);

  12636  5 004272   200124 450100                    STZ     L,,AUTO
         5 004273   004310 710000 5                  TRA     s:12638+3

     2034    12637    5                                        OUT$->VALUE_B(L) = DFLT_OPT$->KS$PRM.DEFAULT(L
             12637                                                  );

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:361  
  12637  5 004274   200124 235100                    LDA     L,,AUTO
         5 004275   000004 735000                    ALS     4
         5 004276   200124 236100                    LDQ     L,,AUTO
         5 004277   000001 736000                    QLS     1
         5 004300   200150 470500                    LDP0    DFLT_OPT$,,AUTO
         5 004301   200151 471500                    LDP1    OUT$,,AUTO
         5 004302   000106 101505                    MRL     fill='000'O
         5 004303   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         5 004304   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2

     2035    12638    5                                      END;

  12638  5 004305   200124 235100                    LDA     L,,AUTO
         5 004306   000001 035007                    ADLA    1,DL
         5 004307   200124 755100                    STA     L,,AUTO
         5 004310   000160 470400 2                  LDP0    HANDLER$
         5 004311   200103 720100                    LXL0    K,,AUTO
         5 004312   077776 236110                    LDQ     -2,X0,PR0
         5 004313   000011 772000                    QRL     9
         5 004314   000777 376007                    ANQ     511,DL
         5 004315   200124 116100                    CMPQ    L,,AUTO
         5 004316   004274 603000 5                  TRC     s:12637

     2036    12639    4                                      OUT$ = PINCRW(OUT$,(KS$HNDLR.IPARAM.ARRAY_SZ(K-%
             12639                                               KL_HNDLRPARM_BLOCK)+2)/2);

  12639  5 004317   000002 036007                    ADLQ    2,DL
         5 004320   000001 772000                    QRL     1
         5 004321   000022 736000                    QLS     18
         5 004322   200151 036100                    ADLQ    OUT$,,AUTO
         5 004323   200151 756100                    STQ     OUT$,,AUTO

     2037    12640    4                                   END;  /* # of indx params */

  12640  5 004324   200103 235100                    LDA     K,,AUTO
         5 004325   000001 035007                    ADLA    1,DL
         5 004326   200103 755100                    STA     K,,AUTO
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:362  
         5 004327   200016 236100                    LDQ     I,,AUTO
         5 004330   000005 402007                    MPY     5,DL
         5 004331   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         5 004332   200103 116100                    CMPQ    K,,AUTO
         5 004333   004335 600000 5                  TZE     s:12641
         5 004334   004241 603000 5                  TRC     s:12633

     2038    12641    3                                   END;

  12641  5 004335   004340 710000 5                  TRA     s:12644

     2039    12642    2                                ELSE
     2040    12643    2                                   KS$HNDLR.NPARAMI = 0;
             12643                                            /* reset if no indexed params */

  12643  5 004336   000000 236003                    LDQ     0,DU
         5 004337   000014 552104                    STBQ    12,'04'O,PR0

     2041    12644    2   END RESET_PARAMS_TO_DEFAULTS;

  12644  5 004340   200240 221300                    LDX1  ! HANDNR+1,,AUTO
         5 004341   000001 702211                    TSX2  ! 1,X1

     2042    12645    1   END KSC$SET;

  12645  5 004342   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:363  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$SET.
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:364  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$SET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 EQUALS                    66-0-0/c CHAR(3)     r     1 FEP
    26-0-0/c CHAR(16)    r     1 HEX_DIGITS                32-0-0/c CHAR(25)    r     1 HNDLRFID
    17-0-0/c CHAR(26)    r     1 HNDLRNAME                 41-0-0/c CHAR(25)    r     1 LIBACCT
     2-0-0/c CHAR(21)    r     1 MONFID                    64-0-0/c CHAR(7)     r     1 NETCON
    10-0-0/c CHAR(28)    r     1 NHNDLRS
    50-0-0/c CHAR        r     1 WRITE_SUCCESSFULL_FMT
    62-0-0/d BIT (72)    r     1 WRITE_SUCCESSFULL_VEC

  ****  Section 002  Data  KSC$SET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   306-0-0/w PTR         r     1 DEFAULT$
   224-0-0/w UBIN        r     1 DEFAULT_BUF(0:49)
  1326-0-0/d STRC(360)   r     1 DELREC_NETCON            212-0-0/w CHAR(28)    r     1 FIDNAME
  1340-0-0/d STRC(2088)  r     1 FPT_OPEN                 160-0-0/w PTR         r     1 HANDLER$
  1222-0-0/w PTR         r     1 HDR$
    13-0-0/c CHAR        r     1 HNDLR_BUF(0:400)
  1223-0-0/w STRC(396)   r     1 KS_CONTROL               221-0-0/w STRC(99)    r     1 KS_DEFAULT_KEY
   312-0-0/w STRC(936)   r     1 KS_FEPBOOT               344-0-0/w STRC(27)    r     1 KS_FEPBOOT_KEY
   345-0-0/w STRC(792)   r     1 KS_FEPCTL                373-0-0/w STRC(27)    r     1 KS_FEPCTL_KEY
   374-0-0/w STRC(1656)  r     1 KS_FEPHNDLR              452-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY
  1236-0-0/w STRC(1062)  r     1 KS_HANDLER               307-0-0/w STRC(99)    r     1 KS_HANDLER_KEY
   453-0-0/w STRC(12888) r     1 KS_PSEUDO               1221-0-0/w STRC(27)    r     1 KS_PSEUDO_KEY
  1432-0-0/d STRC(864)   r     1 NETCON_FID              1274-0-0/d STRC(504)   r     1 READ_NETCON
     0-0-0/w STRC(369)   r     1 TEXTC                   1462-0-0/c STRC(72)    r     1 VLP_ACCT
  1464-0-0/c STRC(288)   r     1 VLP_NAME                1474-0-0/c STRC(72)    r     1 VLP_PASS
  1476-0-0/d STRC(90)    r     1 VLP_SN                  1502-0-0/c STRC(72)    r     1 VLP_WSN
  1504-0-0/d STRC(324)   r     1 VLR_FID                 1312-0-0/d STRC(432)   r     1 WRITE_NETCON
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:365  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   241-0-0/w PTR         r     1 @PTR$                    242-0-0/w PTR         r     1 @TARGET
     3-0-0/w PTR         r     1 @TOP$                    145-0-0/w PTR         r     1 BLK$
     4-0-0/b BIT         r     1 BOOT_FLAG                150-0-0/w PTR         r     1 DFLT_OPT$
     5-0-0/b BIT         r     1 FID_FLAG                 155-0-0/c CHAR(8)     r     1 HANDLERNAME
   235-0-0/w BIT         r     1 HANDLER_FOUND            237-0-0/w UBIN        r     1 HANDNR
    11-0-0/c CHAR        r     1 HEX_CHAR                  12-0-0/w UBIN        r     1 HEX_DIGIT
    10-0-0/b BIT         r     1 HNDLREXISTS               13-0-0/w UBIN        r     1 HNDLRX
    16-0-0/w UBIN        r     1 I                         17-0-0/w UBIN        r     1 INDX
   152-0-0/w UBIN(9)     r     1 INDX_R
    20-0-0/w UBIN        r     1 INDX_VEC(0:49)
   102-0-0/w UBIN        r     1 J                        103-0-0/w UBIN        r     1 K
   114-0-0/w STRC(288)   r     1 KS_SUB_BUF_4             124-0-0/w UBIN        r     1 L
   133-0-0/w UBIN        r     1 NUM_INDX
   231-0-0/b BIT         r     1 OLD_BOOTIME(0:20)
   157-0-0/w CHAR(8)     r     1 OLD_HANDLER(0:20)
   232-0-0/w UBIN        r     1 OLD_NRHAND               151-0-0/w PTR         r     1 OUT$
   131-0-0/w UBIN        r     1 PARMTYPE                 130-0-0/w UBIN        r     1 PARMX
   132-0-0/w UBIN(9)     r     1 PERM_PARM                147-0-0/w PTR         r     1 PTR$
    *0-0-0/w PTR         r     1 PTR$                     236-0-0/w BIT         r     1 RCVCQ_SNDCQ
   234-0-0/w BIT         r     1 RECORD_CHANGED           233-0-0/w UBIN        r     1 RECORD_SIZE
   134-0-0/w UBIN        r     1 SCNOPTS                  135-0-0/w PTR         r     1 SUBLK$
   136-0-0/w UBIN        r     1 SUBLOP                    *0-0-0/w CHAR(28)    r     1 TARGET
   137-0-0/w UBIN        r     1 TEMP1                    140-0-0/w UBIN        r     1 TEMP2
   142-0-0/w PTR         r     1 TMP$                      *0-0-0/w PTR         r     1 TOP$
   146-0-0/w PTR         r     1 TOP2$                    141-0-0/w SBIN        r     1 T_PSEUDO#
   143-0-0/w UBIN        r     1 VALUE                    143-0-0/w STRC        r     1 VALUEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:366  

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w SBIN        r     1 KS_CMD
     0-0-0/w SBIN        r     1 KS_FID                     0-0-0/w SBIN        r     1 KS_HAND
     0-0-0/w STRC(180)   r     1 KS_HAND_INFO(0:0)
     0-0-0/w UBIN(9)     r     1 KS_HNDLRINDX               0-0-0/c CHAR(8)     r     1 KS_HNDLRNAME
     0-0-0/w SBIN        r     1 KS_LIB                     0-0-0/c CHAR(400)   r     1 KS_MSGBUF
     0-0-0/w PTR         r     1 KS_MSGBUF$                 0-0-0/w SBIN        r     1 KS_NODE
     0-0-0/c CHAR(8)     r     1 KS_NODENAME                0-0-0/w SBIN        r     1 KS_NRHAND
     0-0-0/w UBIN(9)     r     1 KS_SELPRMOPT               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_3
     0-0-0/w PTR         r     1 KS_TBL(0:9)                0-0-0/c STRC(90)    r     1 PROMPT
     0-0-0/w STRC(504)   r     1 P_PCB

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/b STRC(19)    r     1 HND
     0-0-0/w STRC(306)   r     1 KS$HDR                     0-0-0/w STRC(1062)  r     1 KS$HNDLR
     0-0-0/w STRC(144)   r     1 KS$PARAM(0:0)
     0-0-0/w STRC(144)   r     1 KS$PRM(0:0)                0-0-0/w ASTR(387)   r     1 KS_DEFAULT_REC
     0-0-0/w STRC(306)   r     1 KS_HDR                     0-0-0N  NULL        r     1 M$NETCON
     0-0-0/c ASTR(9)     r     1 NAME                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w STRC(144)   r     1 OUT$BLK2                   0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w ASTR(153)   r     1 OUT$SYM2
     0-0-0/h UBIN(18)    r     1 VALUE_B(0:0)


   Procedure KSC$SET requires 2275 words for executable code.
   Procedure KSC$SET requires 172 words of local(AUTO) storage.

    No errors detected in file KSC$COMMANDS1.:E05TSI    .
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:367  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:368  
          MINI XREF LISTING

ALTER_FID
     12575**PROC    11760--CALL    11831--CALL    11994--CALL    12073--CALL
B$ALT.CODE
     11290**DCL     11290--REDEF   11291--REDEF   11291--REDEF
B$ALT.ERR.CODE
     11292**DCL     12464>>IF
B$ALT.ERR.ERR#
     11292**DCL     11292--REDEF
B$ALT.EVID
     11291**DCL     11291--REDEF   11291--REDEF
B$TCB.ALT$
     11286**DCL     12464>>IF
B$TCB$
      9668**DCL     12464>>IF
BLK$
     11268**DCL     11724<<ASSIGN  11725>>DOCASE  11727>>IF      11744>>DOINDEX 11746>>ASSIGN  11779>>IF
     11779>>IF      11788>>ASSIGN  12175>>ASSIGN  12176>>ASSIGN  12231>>ASSIGN  12266>>ASSIGN  12329>>IF
     12330>>ASSIGN  12478>>IF      12478>>IF      12498>>ASSIGN  12498>>ASSIGN  12510>>DOINDEX 12511>>ASSIGN
BOOT_FLAG
     11221**DCL     11816<<ASSIGN
DEFAULT$
     10036**DCL     10804--IMP-PTR 11800>>CALL    11800>>CALL    11802>>CALL    11802>>CALL    11803>>CALL
     11803>>CALL    12148>>CALL    12148>>CALL    12150>>CALL    12150>>CALL    12151>>CALL    12151>>CALL
DEFAULT_BUF
     10035**DCL     10036--DCLINIT
DELREC_NETCON
     11409**DCL     11853<>CALL    11860<>CALL    12111<>CALL    12115<>CALL
DELREC_NETCON.KEY_
     11409**DCL     11852<<ASSIGN  11859<<ASSIGN  12110<<ASSIGN  12114<<ASSIGN
DELREC_NETCON.V
     11412**DCL     11409--DCLINIT
DFLT_OPT$
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:369  
     11271**DCL     12633<<ASSIGN  12637>>ASSIGN
DOI
     11723**LABEL   12171--EXIT
END_LOOP
     12554**LABEL   12189--GOTO    12197--GOTO    12299--GOTO    12554--GOTO    12563--GOTO    12569--GOTO
EQUALS
      9968**DCL     11991--CALL    12012--CALL    12026--CALL    12070--CALL    12160--CALL
F$DCB.ACTPOS
      9578**DCL      9578--REDEF
F$DCB.ARS
      9553**DCL      9553--REDEF
F$DCB.ATTR
      9571**DCL      9572--REDEF
F$DCB.BORROW
      9586**DCL      9586--REDEF    9586--REDEF    9586--REDEF
F$DCB.DCBNAME.L
      9600**DCL      9600--IMP-SIZ
F$DCB.EOMCHAR
      9557**DCL      9557--REDEF
F$DCB.FLDID
      9581**DCL      9581--REDEF
F$DCB.FORM$
      9575**DCL      9575--REDEF
F$DCB.FSECT
      9591**DCL      9591--REDEF
F$DCB.FSN
      9568**DCL      9568--REDEF    9568--REDEF    9569--REDEF
F$DCB.HEADER$
      9574**DCL      9574--REDEF
F$DCB.IXTNSIZE
      9572**DCL      9572--REDEF
F$DCB.LASTSTA$
      9562**DCL      9562--REDEF
F$DCB.LVL
      9587**DCL      9587--REDEF
F$DCB.NAME.C
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:370  
      9562**DCL      9562--REDEF
F$DCB.NOEOF
      9583**DCL      9583--REDEF
F$DCB.NRECS
      9573**DCL      9573--REDEF
F$DCB.NRECX
      9592**DCL      9592--REDEF
F$DCB.OHDR
      9584**DCL      9584--REDEF
F$DCB.ORG
      9567**DCL      9567--REDEF
F$DCB.PRECNO
      9590**DCL      9590--REDEF
F$DCB.RCSZ
      9595**DCL      9595--REDEF
F$DCB.RES
      9563**DCL      9563--REDEF
F$DCB.SETX
      9575**DCL      9575--REDEF
F$DCB.TAB$
      9574**DCL      9575--REDEF
F$DCB.TDA
      9589**DCL      9589--REDEF
F$DCB.WSN
      9564**DCL      9564--REDEF
FEP
      9981**DCL     12346--CALL
FEPHNDSRCH
     11778**LABEL   11784--EXIT
FIDNAME
     10015**DCL     11544--DCLINIT
FID_FLAG
     11222**DCL     11815<<ASSIGN
FIND_HANDLER
     12035**LABEL   12039--EXIT
FIND_HANDLER2
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:371  
     12099**LABEL   12103--EXIT
FPT_OPEN.ACSVEH_
     11485**DCL     11486--REDEF
FPT_OPEN.ALTKEYS_
     11491**DCL     11492--REDEF   11492--REDEF
FPT_OPEN.HDR_
     11490**DCL     11491--REDEF
FPT_OPEN.TAB_
     11489**DCL     11490--REDEF
FPT_OPEN.UHL_
     11483**DCL     11484--REDEF   11484--REDEF
FPT_OPEN.V
     11492**DCL     11483--DCLINIT
FPT_OPEN.V.ASN#
     11502**DCL     11547--DCLINIT
FPT_OPEN.V.FSN#
     11523**DCL     11523--REDEF   11523--REDEF
FPT_OPEN.V.RES#
     11507**DCL     11547--DCLINIT
FPT_OPEN.WSN_
     11489**DCL     11489--REDEF
HANDLER$
     10013**DCL     10658--IMP-PTR 11782>>ASSIGN  11783>>ASSIGN  11791>>ASSIGN  11792>>ASSIGN  11822>>ASSIGN
     11822>>ASSIGN  11823>>CALLBLT 11824>>ASSIGN  11831>>CALL    11901>>ASSIGN  11902>>CALLBLT 11903>>ASSIGN
     11907>>IF      11908>>ASSIGN  11908>>ASSIGN  11909>>ASSIGN  11909>>ASSIGN  12052>>ASSIGN  12053>>ASSIGN
     12054>>IF      12056>>ASSIGN  12056>>ASSIGN  12057>>CALLBLT 12058>>ASSIGN  12066>>CALLBLT 12068>>ASSIGN
     12073>>CALL    12079>>IF      12080>>ASSIGN  12080>>ASSIGN  12081>>ASSIGN  12081>>ASSIGN  12395>>IF
     12397>>IF      12399>>ASSIGN  12404>>ASSIGN  12409>>ASSIGN  12424>>IF      12426>>ASSIGN  12426>>ASSIGN
     12427>>ASSIGN  12427>>ASSIGN  12611>>IF      12619>>ASSIGN  12621>>ASSIGN  12622>>DOINDEX 12623>>ASSIGN
     12627>>ASSIGN  12634>>ASSIGN  12635>>ASSIGN  12636>>DOINDEX 12639>>ASSIGN  12643>>ASSIGN
HANDLERNAME
     11276**DCL     11783<<ASSIGN  11792<<ASSIGN  11795>>ASSIGN  11799>>ASSIGN  11809>>ASSIGN  11850>>ASSIGN
     11858>>ASSIGN  11863>>ASSIGN  11864--ASSIGN  11901>>ASSIGN
HANDLER_FOUND
     11282**DCL     12033<<ASSIGN  12038<<ASSIGN  12043>>IF      12097<<ASSIGN  12102<<ASSIGN  12107>>IF
HANDNR
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:372  
     11284**DCL     12020<<ASSIGN  12025--CALL    12069--CALL
HDR$
     10247**DCL     10722--IMP-PTR 12351>>DOSELCT
HEX_CHAR
     11226**DCL     12280<<ASSIGN  12281>>CALLBLT
HEX_DIGIT
     11227**DCL     12281<<CALLBLT 12282>>ASSIGN
HEX_DIGITS
      9973**DCL     12281>>CALLBLT
HND.DAT
     11025**DCL     12221>>IF
HNDLREXISTS
     11225**DCL     11777<<ASSIGN  11781<<ASSIGN  11789>>IF      11820>>IF      11862>>IF
HNDLRFID
      9974**DCL     12069--CALL
HNDLRNAME
      9972**DCL     12025--CALL
HNDLRX
     11228**DCL     11778<<DOINDEX 11779>>IF      11782>>ASSIGN  11794<<ASSIGN  11795>>ASSIGN  11796>>ASSIGN
     11825>>ASSIGN  11836>>IF      11838>>DOINDEX 11875>>ASSIGN  11877>>ASSIGN  11904>>ASSIGN  11918>>ASSIGN
HNDLR_BUF
     10012**DCL     10013--DCLINIT 11745<<ASSIGN  11811--ASSIGN  11908--ASSIGN  11912--ASSIGN  11915--ASSIGN
     11919--ASSIGN  12045--CALL    12080--ASSIGN  12084--ASSIGN  12087--CALL    12087--CALL    12387--CALL
     12403--ASSIGN  12408--ASSIGN  12423--ASSIGN  12426--ASSIGN  12430--ASSIGN  12433--ASSIGN  12628--ASSIGN
     12634--ASSIGN
I
     11231**DCL     11723<<DOINDEX 11724>>ASSIGN  11925<<ASSIGN  11927>>DOWHILE 11928>>IF      11934>>DOINDEX
     11941<<ASSIGN  11941>>ASSIGN  12125<<DOINDEX 12126>>IF      12128>>IF      12130>>ASSIGN  12131>>ASSIGN
     12145<<DOINDEX 12146>>ASSIGN  12609<<ASSIGN  12610>>DOWHILE 12611>>IF      12614<<ASSIGN  12614>>ASSIGN
     12617>>ASSIGN  12618>>IF      12619>>ASSIGN  12625>>IF      12627>>ASSIGN  12629>>IF      12631>>ASSIGN
     12632>>DOINDEX 12635>>ASSIGN
INDX
     11232**DCL     11823<<CALLBLT 11824>>ASSIGN  11902<<CALLBLT 11903>>ASSIGN  12264<<ASSIGN  12294>>ASSIGN
     12338>>ASSIGN  12397>>IF      12399>>ASSIGN  12405>>ASSIGN  12592<<CALLBLT 12593>>IF      12594<<CALLBLT
     12595>>ASSIGN  12596>>ASSIGN  12599>>ASSIGN
INDX_R
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:373  
     11273**DCL     12394<<ASSIGN  12395>>IF      12397>>IF      12399>>ASSIGN  12404>>ASSIGN
INDX_VEC
     11233**DCL     12201<<ASSIGN  12236<<ASSIGN  12244<<ASSIGN  12251<<ASSIGN  12257<<ASSIGN  12264>>ASSIGN
J
     11234**DCL     11934<<DOINDEX 11935>>ASSIGN  11935>>ASSIGN  11936>>ASSIGN  11936>>ASSIGN  11984<<CALLBLT
     11986<<ASSIGN  11988>>ASSIGN  11989>>ASSIGN  12019<<DOINDEX 12020>>ASSIGN  12022>>CALLBLT 12024>>ASSIGN
     12028>>ASSIGN  12029>>ASSIGN  12036>>IF      12046>>ASSIGN  12051>>ASSIGN  12053>>ASSIGN  12096<<DOINDEX
     12100>>IF      12109>>ASSIGN  12113>>ASSIGN  12117>>IF      12118>>ASSIGN  12124<<ASSIGN  12125>>DOINDEX
     12243<<DOINDEX 12244>>ASSIGN  12244>>ASSIGN  12250<<DOINDEX 12251>>ASSIGN  12256<<DOINDEX 12257>>ASSIGN
     12257>>ASSIGN  12279<<DOINDEX 12280>>ASSIGN  12477<<DOINDEX 12478>>IF      12480>>ASSIGN  12489>>IF
K
     11235**DCL     11838<<DOINDEX 11839>>ASSIGN  11839>>ASSIGN  11840>>ASSIGN  11840>>ASSIGN  12022<<CALLBLT
     12023>>ASSIGN  12024>>ASSIGN  12035<<DOINDEX 12036>>IF      12046>>ASSIGN  12057<<CALLBLT 12058>>ASSIGN
     12066<<CALLBLT 12067>>ASSIGN  12068>>ASSIGN  12099<<DOINDEX 12100>>IF      12123<<ASSIGN  12128>>IF
     12130>>ASSIGN  12131>>ASSIGN  12133<<ASSIGN  12133>>ASSIGN  12136>>ASSIGN  12156<<CALLBLT 12157>>ASSIGN
     12158>>ASSIGN  12263<<DOINDEX 12264>>ASSIGN  12510<<DOINDEX 12511>>ASSIGN  12622<<DOINDEX 12623>>ASSIGN
     12623>>ASSIGN  12632<<DOINDEX 12633>>ASSIGN  12634>>ASSIGN  12635>>ASSIGN  12635>>ASSIGN  12636>>DOINDEX
     12639>>ASSIGN
KS$HDR.RESULTS.ERR#
     10780**DCL     12351>>DOSELCT
KS$HNDLR.HNDLRFID
     10659**DCL     11822<<ASSIGN  11823>>CALLBLT 11824<<ASSIGN  11831<>CALL    11901<<ASSIGN  11902>>CALLBLT
     11903<<ASSIGN  12052<<ASSIGN  12056<<ASSIGN  12057>>CALLBLT 12058<<ASSIGN  12066>>CALLBLT 12068>>ASSIGN
     12073<>CALL
KS$HNDLR.HNDLRNAME
     10662**DCL     11782<<ASSIGN  11783>>ASSIGN  11791<<ASSIGN  11792>>ASSIGN  11822>>ASSIGN  12053<<ASSIGN
     12054>>IF      12056>>ASSIGN  12611>>IF      12611--IF
KS$HNDLR.IPARAM.ARRAY_SZ
     10691**DCL     11909>>ASSIGN  12081>>ASSIGN  12397>>IF      12399<<ASSIGN  12427>>ASSIGN  12635<<ASSIGN
     12636>>DOINDEX 12639>>ASSIGN
KS$HNDLR.IPARAM.OFFSET
     10700**DCL     11908>>ASSIGN  12080>>ASSIGN  12404>>ASSIGN  12426>>ASSIGN  12634<<ASSIGN
KS$HNDLR.NPARAMI
     10680**DCL     11907>>IF      11908>>ASSIGN  11909>>ASSIGN  12079>>IF      12080>>ASSIGN  12081>>ASSIGN
     12395>>IF      12424>>IF      12426>>ASSIGN  12427>>ASSIGN  12627<<ASSIGN  12643<<ASSIGN
KS$HNDLR.NPARAMS
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:374  
     10675**DCL     12619<<ASSIGN  12621<<ASSIGN  12622>>DOINDEX
KS$HNDLR.PARAMS
     10685**DCL     12409<<ASSIGN  12623<<ASSIGN
KS$PARAM.FLAGS.DISPONLY
     11055**DCL     12191>>IF
KS$PARAM.FLAGS.INDX
     11050**DCL     12230>>IF      12392>>IF
KS$PARAM.FLAGS.SPECIAL
     11051**DCL     12305>>IF
KS$PARAM.HND
     11057**DCL     12221--IF
KS$PARAM.MAX
     11075**DCL     12307>>IF      12311>>CALL    12316<>CALL
KS$PARAM.MIN
     11079**DCL     12307>>IF      12312>>CALL    12317<>CALL
KS$PARAM.TEXTNAME
     11044**DCL     12177>>ASSIGN  12178>>ASSIGN  12178>>ASSIGN  12215>>ASSIGN  12216>>ASSIGN  12216>>ASSIGN
KS$PRM.ARRAY_SZ
     11137**DCL     12635>>ASSIGN
KS$PRM.DEFAULT
     11161**DCL     12623>>ASSIGN  12637>>ASSIGN
KS$PRM.SPCL_TBL$
     11154**DCL     12633>>ASSIGN
KSE$ERRMSG
      9629**DCL-ENT 11716--CALL    11867--CALL    11947--CALL    12139--CALL    12186--CALL    12193--CALL
     12208--CALL    12223--CALL    12321--CALL    12356--CALL    12364--CALL    12366--CALL    12389--CALL
     12441--CALL    12442--CALL    12450--CALL    12550--CALL    12553--CALL    12558--CALL    12565--CALL
KSR$RD_HLPCG
      9630**DCL-ENT 12344--CALL
KSR$WR_HLPCG
      9631**DCL-ENT 12343--CALL
KSU$INIT_DEFCNFG
      9638**DCL-ENT 11802--CALL    12150--CALL
KSU$READ_NETCON
      9636**DCL-ENT 11800--CALL    11978--CALL    12003--CALL    12045--CALL    12148--CALL    12387--CALL
KSU$STRIP_ZEROS
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:375  
      9640**DCL-ENT 12311--CALL    12312--CALL    12316--CALL    12317--CALL
KSU$UNPACK
      9635**DCL-ENT 12340--CALL
KSU$WRITE_NETCON
      9637**DCL-ENT 11803--CALL    11995--CALL    12087--CALL    12151--CALL    12166--CALL
KSW$WRITE
      9633**DCL-ENT 11990--CALL    12011--CALL    12025--CALL    12069--CALL    12159--CALL    12298--CALL
     12346--CALL    12383--CALL    12435--CALL
KS_CMD
      9674**DCL     12170--ASSIGN
KS_CONTROL
     10282**DCL     12343--CALL
KS_CONTROL.CMD
     10353**DCL     12336<<ASSIGN
KS_CONTROL.HANDLER
     10291**DCL     12301<<ASSIGN  12303<<ASSIGN
KS_CONTROL.INDX
     10369**DCL     12338<<ASSIGN
KS_CONTROL.PARMX
     10363**DCL     12337<<ASSIGN
KS_CONTROL.VALUE
     10375**DCL     12340<>CALL    12342<<ASSIGN
KS_DEFAULT_KEY
     10029**DCL     11800--CALL    11803--CALL    11859--ASSIGN  12114--ASSIGN  12148--CALL    12151--CALL
KS_DEFAULT_KEY.HNDLR
     10033**DCL     11799<<ASSIGN  11858<<ASSIGN  12113<<ASSIGN  12146<<ASSIGN
KS_DEFAULT_KEY.NODE
     10032**DCL     11798<<ASSIGN  11857<<ASSIGN  12112<<ASSIGN  12147<<ASSIGN
KS_DEFAULT_REC
     10804**DCL     11800--CALL    11802<>CALL    11803--CALL    12148--CALL    12150<>CALL    12151--CALL
KS_DEFAULT_REC.LGN.LGNSIZE
     10941**DCL     10942--IMP-SIZ 11800>>CALL    11802>>CALL    11803>>CALL    12148>>CALL    12150>>CALL
     12151>>CALL
KS_FEPBOOT
     10069**DCL     11731<<ASSIGN  11751--ASSIGN  11762--ASSIGN  11978--CALL    11995--CALL    12292--ASSIGN
     12296--ASSIGN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:376  
KS_FEPBOOT.BOOTFID
     10070**DCL     11758<<ASSIGN  11760<>CALL    11984>>CALLBLT 11986--ASSIGN  11989>>ASSIGN  11994<>CALL
KS_FEPBOOT.BOOTPARAMS
     10076**DCL     12294<<ASSIGN
KS_FEPBOOT_KEY
     10094**DCL     11752--ASSIGN  11763--ASSIGN  11978--CALL    11995--CALL    12291--ASSIGN  12295--ASSIGN
KS_FEPBOOT_KEY.NODE
     10097**DCL     11750<<ASSIGN  11970<<ASSIGN  12290<<ASSIGN
KS_FEPCTL
     10112**DCL     12377--ASSIGN  12381--ASSIGN
KS_FEPCTL.PARAMS
     10115**DCL     12379<<ASSIGN
KS_FEPCTL_KEY
     10132**DCL     12376--ASSIGN  12380--ASSIGN
KS_FEPCTL_KEY.NODE
     10135**DCL     12375<<ASSIGN
KS_FEPHNDLR
     10150**DCL     11729<<ASSIGN  11740--ASSIGN  11954--ASSIGN  12003--CALL    12166--CALL
KS_FEPHNDLR.BOOTIME
     10157**DCL     11796<<ASSIGN  11825<<ASSIGN  11840<<ASSIGN  11840>>ASSIGN  11875<<ASSIGN  11877<<ASSIGN
     11904<<ASSIGN  11936<<ASSIGN  11936>>ASSIGN  12007>>ASSIGN  12046<<ASSIGN  12051<<ASSIGN  12131<<ASSIGN
     12131>>ASSIGN
KS_FEPHNDLR.DEFLIBACCT
     10154**DCL     11768<<ASSIGN  11956--ASSIGN  12156>>CALLBLT 12158>>ASSIGN  12162<<ASSIGN  12164--ASSIGN
KS_FEPHNDLR.HANDLER
     10161**DCL     11779>>IF      11782>>ASSIGN  11795<<ASSIGN  11839<<ASSIGN  11839>>ASSIGN  11844<<ASSIGN
     11918>>ASSIGN  11928>>IF      11935<<ASSIGN  11935>>ASSIGN  11938<<ASSIGN  11943>>IF      11946>>IF
     11956--ASSIGN  12006>>ASSIGN  12022>>CALLBLT 12024>>ASSIGN  12028<<ASSIGN  12029>>ASSIGN  12036>>IF
     12053>>ASSIGN  12100>>IF      12118<<ASSIGN  12126>>IF      12130<<ASSIGN  12130>>ASSIGN  12138>>IF
     12146>>ASSIGN  12164--ASSIGN
KS_FEPHNDLR.NHANDLERS
     10151**DCL     11778>>DOINDEX 11793<<ASSIGN  11793>>ASSIGN  11794>>ASSIGN  11836>>IF      11838>>DOINDEX
     11844>>ASSIGN  11845<<ASSIGN  11845>>ASSIGN  11926>>ASSIGN  11934>>DOINDEX 11938>>ASSIGN  11939<<ASSIGN
     11939>>ASSIGN  11943>>IF      11944<<ASSIGN  11944>>ASSIGN  11956--ASSIGN  11956>>ASSIGN  12005>>ASSIGN
     12011--CALL    12014<<CALLBLT 12019>>DOINDEX 12099>>DOINDEX 12117>>IF      12124>>ASSIGN  12136<<ASSIGN
     12145>>DOINDEX 12164--ASSIGN  12164>>ASSIGN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:377  
KS_FEPHNDLR_KEY
     10180**DCL     11741--ASSIGN  11955--ASSIGN  12003--CALL    12166--CALL
KS_FEPHNDLR_KEY.NODE
     10183**DCL     11739<<ASSIGN  11953<<ASSIGN  11971<<ASSIGN
KS_FID
      9670**DCL     11991<>CALL    12070<>CALL
KS_HAND
      9672**DCL     12026<>CALL
KS_HANDLER
     10402**DCL     11913--ASSIGN  12085--ASSIGN  12431--ASSIGN  12628--ASSIGN
KS_HANDLER.IPARAM
     10434**DCL     12631--ASSIGN
KS_HANDLER.NPARAMI
     10424**DCL     12629>>IF      12631>>ASSIGN
KS_HANDLER_KEY
     10050**DCL     11810--ASSIGN  11852--ASSIGN  11916--ASSIGN  12045--CALL    12087--CALL    12110--ASSIGN
     12387--CALL    12422--ASSIGN
KS_HANDLER_KEY.HNDLR
     10054**DCL     11809<<ASSIGN  11850<<ASSIGN  11918<<ASSIGN  12029<<ASSIGN  12109<<ASSIGN  12386<<ASSIGN
KS_HANDLER_KEY.NODE
     10053**DCL     11808<<ASSIGN  11851<<ASSIGN  11917<<ASSIGN  11972<<ASSIGN  12385<<ASSIGN
KS_HAND_INFO.PARAMS$
      9907**DCL     12617>>ASSIGN  12635>>ASSIGN
KS_HAND_INFO.SZ
      9902**DCL     12618>>IF      12619>>ASSIGN  12625>>IF      12627>>ASSIGN  12629>>IF      12631>>ASSIGN
     12632>>DOINDEX
KS_HAND_INFO.TEXT
      9892**DCL     12610>>DOWHILE 12611>>IF
KS_HDR.RESULTS
     10990**DCL     12353<>CALL    12362<>CALL
KS_HNDLRINDX
      3893**DCL     12214>>ASSIGN  12221>>IF
KS_HNDLRNAME
      3893**DCL     12206>>IF      12217--ASSIGN  12218>>ASSIGN  12303>>ASSIGN  12319--ASSIGN  12320>>ASSIGN
     12386>>ASSIGN
KS_LIB
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:378  
      9671**DCL     12160<>CALL
KS_MSGBUF
      3895**DCL     10247--DCLINIT
KS_MSGBUF$
      3895**DCL      3895--IMP-PTR 10960--IMP-PTR 12353>>CALL    12362>>CALL
KS_MYSTATION
      3891**DCL      3891--REDEF
KS_NODE
      3892**DCL     11739>>ASSIGN  11750>>ASSIGN  11798>>ASSIGN  11808>>ASSIGN  11851>>ASSIGN  11857>>ASSIGN
     11917>>ASSIGN  11953>>ASSIGN  11970>>ASSIGN  11971>>ASSIGN  11972>>ASSIGN  12112>>ASSIGN  12147>>ASSIGN
     12290>>ASSIGN  12375>>ASSIGN  12385>>ASSIGN  12459>>ASSIGN
KS_NODENAME
      3891**DCL     11715>>IF      11865>>ASSIGN  11866--ASSIGN  12169>>ASSIGN  12219--ASSIGN  12220>>ASSIGN
     12454>>ASSIGN  12556--ASSIGN  12557>>ASSIGN
KS_NRHAND
      9673**DCL     12012<>CALL
KS_PSEUDO
     10198**DCL     12461--ASSIGN  12466<<ASSIGN  12541--ASSIGN
KS_PSEUDO.PSEUDO.MAX_CG
     10213**DCL     12517<<ASSIGN
KS_PSEUDO.PSEUDO.MAX_GHST
     10223**DCL     12526<<ASSIGN
KS_PSEUDO.PSEUDO.MAX_HAND
     10218**DCL     12522<<ASSIGN
KS_PSEUDO.PSEUDO.MAX_SYS
     10204**DCL     12531<<ASSIGN
KS_PSEUDO.PSEUDO.MAX_USR
     10208**DCL     12536<<ASSIGN
KS_PSEUDO.PSEUDO.NAME
     10202**DCL     12478>>IF      12498<<ASSIGN
KS_PSEUDO.PSEUDO#
     10199**DCL     12477>>DOINDEX 12498>>ASSIGN  12499>>ASSIGN  12500<<ASSIGN  12500>>ASSIGN  12542>>ASSIGN
KS_PSEUDO_KEY
     10242**DCL     12460--ASSIGN  12540--ASSIGN
KS_PSEUDO_KEY.NODE
     10245**DCL     12459<<ASSIGN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:379  
KS_SELPRMOPT
      3892**DCL     12332>>ASSIGN
KS_SUB_BUF_1
      3896**DCL     11867--CALL    12193--CALL    12223--CALL    12298--CALL    12346--CALL    12356--CALL
     12364--CALL    12366--CALL    12383--CALL    12435--CALL    12450--CALL    12558--CALL
KS_SUB_BUF_1.COUNT
      3896**DCL     11864<<ASSIGN  11973<<ASSIGN  12177<<ASSIGN  12215<<ASSIGN  12551<<ASSIGN  12556<<ASSIGN
KS_SUB_BUF_1.TEXT
      3896**DCL     11863<<ASSIGN  11974<<ASSIGN  12178<<ASSIGN  12216<<ASSIGN  12552<<ASSIGN  12557<<ASSIGN
KS_SUB_BUF_2
      3896**DCL     11867--CALL    12223--CALL    12321--CALL    12366--CALL    12389--CALL
KS_SUB_BUF_2.COUNT
      3897**DCL     11866<<ASSIGN  12217<<ASSIGN  12311<>CALL    12316<>CALL
KS_SUB_BUF_2.TEXT
      3897**DCL     11865<<ASSIGN  12218<<ASSIGN  12311<>CALL    12316<>CALL
KS_SUB_BUF_3
      3897**DCL     12321--CALL    12389--CALL
KS_SUB_BUF_3.COUNT
      3897**DCL     12219<<ASSIGN  12312<>CALL    12317<>CALL
KS_SUB_BUF_3.TEXT
      3897**DCL     12220<<ASSIGN  12312<>CALL    12317<>CALL
KS_SUB_BUF_4
     11243**DCL     12321--CALL
KS_SUB_BUF_4.COUNT
     11244**DCL     12319<<ASSIGN
KS_SUB_BUF_4.TEXT
     11245**DCL     12320<<ASSIGN
KS_SUB_BUF_TEMP2.TEXT_C
     11238**DCL     11241--REDEF
KS_TBL
      9669**DCL     12177>>ASSIGN  12178>>ASSIGN  12178>>ASSIGN  12191>>IF      12215>>ASSIGN  12216>>ASSIGN
     12216>>ASSIGN  12221>>IF      12230>>IF      12305>>IF      12307>>IF      12307>>IF      12311>>CALL
     12312>>CALL    12316>>CALL    12317>>CALL    12392>>IF
L
     11246**DCL     11926<<ASSIGN  11927>>DOWHILE 12636<<DOINDEX 12637>>ASSIGN  12637>>ASSIGN
LIBACCT
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:380  
      9975**DCL     12159--CALL
M$DELREC
        21**DCL-ENT 11853--CALL    11860--CALL    12111--CALL    12115--CALL
M$READ
        20**DCL-ENT 11742--CALL    11753--CALL    11812--CALL    12293--CALL    12378--CALL    12462--CALL
M$WRITE
        20**DCL-ENT 11764--CALL    11920--CALL    11961--CALL    12297--CALL    12382--CALL    12434--CALL
     12547--CALL
MONFID
     11978**LABEL   11990--CALL
NAME.L#
     11192**DCL     11192--IMP-SIZ 12177>>ASSIGN  12178>>ASSIGN  12215>>ASSIGN  12216>>ASSIGN
NAME.NAME#
     11192**DCL     12178>>ASSIGN  12216>>ASSIGN
NETCON
      9980**DCL     12298--CALL    12383--CALL    12435--CALL
NETCON_FID.V
     11548**DCL     11544--DCLINIT
NHNDLRS
     12003**LABEL   12011--CALL
NUM_INDX
     11253**DCL     12200<<ASSIGN  12227<<ASSIGN  12235<<ASSIGN  12242<<ASSIGN  12249<<ASSIGN  12251>>ASSIGN
     12252<<ASSIGN  12252>>ASSIGN  12255<<ASSIGN  12263>>DOINDEX
OLD_BOOTIME
     11278**DCL     12007<<ASSIGN  12046>>ASSIGN
OLD_HANDLER
     11277**DCL     12006<<ASSIGN  12036>>IF      12100>>IF      12109>>ASSIGN  12113>>ASSIGN
OLD_NRHAND
     11279**DCL     12005<<ASSIGN  12035>>DOINDEX 12096>>DOINDEX
OUT$
     11272**DCL     12628<<ASSIGN  12631<<ASSIGN  12631>>ASSIGN  12634>>ASSIGN  12637>>ASSIGN  12639<<ASSIGN
     12639>>ASSIGN
OUT$BLK.CODE
     10491**DCL     11725>>DOCASE  11747>>DOCASE  11828>>DOCASE  11874>>IF      11883>>IF      12175>>ASSIGN
     12176>>ASSIGN  12236>>ASSIGN  12240>>DOCASE  12244>>ASSIGN  12247>>ASSIGN  12248>>ASSIGN  12267>>DOCASE
     12330>>ASSIGN  12339>>IF      12339>>IF      12512>>DOCASE  12585>>IF      12590>>IF
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:381  
OUT$BLK.NSUBLKS
     10495**DCL     11723>>DOINDEX 11727>>IF      11744>>DOINDEX 11757>>IF      11818>>IF      11827>>DOINDEX
     11880>>IF      12013>>IF      12027>>IF      12071>>IF      12161>>IF      12242>>ASSIGN  12243>>DOINDEX
     12329>>IF      12510>>DOINDEX 12579>>IF
OUT$BLK.SUBLK$
     10516**DCL     11724>>ASSIGN  11746>>ASSIGN  11768>>ASSIGN  11768>>ASSIGN  11779>>IF      11779>>IF
     11779>>IF      11779>>IF      11788>>ASSIGN  11791>>ASSIGN  11791>>ASSIGN  11828>>DOCASE  11831>>CALL
     11831<>CALL    11874>>IF      11874>>IF      11880>>IF      11883>>IF      11883>>IF      11883>>IF
     12162>>ASSIGN  12162>>ASSIGN  12175>>ASSIGN  12176>>ASSIGN  12176>>ASSIGN  12231>>ASSIGN  12231>>ASSIGN
     12231>>ASSIGN  12244>>ASSIGN  12247>>ASSIGN  12248>>ASSIGN  12266>>ASSIGN  12279>>DOINDEX 12280>>ASSIGN
     12280>>ASSIGN  12330>>ASSIGN  12330>>ASSIGN  12478>>IF      12478>>IF      12498>>ASSIGN  12498>>ASSIGN
     12511>>ASSIGN  12515>>IF      12516>>CALLBLT 12516>>CALLBLT 12520>>IF      12521>>CALLBLT 12521>>CALLBLT
     12524>>IF      12525>>CALLBLT 12525>>CALLBLT 12529>>IF      12530>>CALLBLT 12530>>CALLBLT 12534>>IF
     12535>>CALLBLT 12535>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12585>>IF
     12586>>CALLBLT 12586>>CALLBLT 12590>>IF      12596>>ASSIGN  12596>>ASSIGN  12599>>ASSIGN  12599>>ASSIGN
OUT$BLK2.NSUBLKS
     10578**DCL     11992>>IF
OUT$SYM.COUNT
     10552**DCL     10555--IMP-SIZ 11768>>ASSIGN  11779>>IF      11791>>ASSIGN  12014>>CALLBLT 12028>>ASSIGN
     12162>>ASSIGN  12269>>CALLBLT 12279>>DOINDEX 12280>>ASSIGN  12286>>ASSIGN  12478>>IF      12498>>ASSIGN
     12515>>IF      12516>>CALLBLT 12520>>IF      12521>>CALLBLT 12524>>IF      12525>>CALLBLT 12529>>IF
     12530>>CALLBLT 12534>>IF      12535>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12586>>CALLBLT 12596>>ASSIGN
     12599>>ASSIGN
OUT$SYM.TEXT
     10555**DCL     11768>>ASSIGN  11779>>IF      11791>>ASSIGN  12014>>CALLBLT 12028>>ASSIGN  12162>>ASSIGN
     12269>>CALLBLT 12280>>ASSIGN  12286>>ASSIGN  12478>>IF      12498>>ASSIGN  12516>>CALLBLT 12521>>CALLBLT
     12525>>CALLBLT 12530>>CALLBLT 12535>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12586>>CALLBLT 12596>>ASSIGN
     12599>>ASSIGN
OUT$SYM2.COUNT
     10635**DCL     10638--IMP-SIZ
PARMTYPE
     11251**DCL     12175<<ASSIGN  12177>>ASSIGN  12178>>ASSIGN  12178>>ASSIGN  12184>>IF      12191>>IF
     12204>>IF      12214<<ASSIGN  12214>>ASSIGN  12230>>IF      12270>>IF      12288>>DOCASE  12305>>IF
     12307>>IF      12307>>IF      12311>>CALL    12312>>CALL    12316>>CALL    12317>>CALL    12355>>IF
     12373>>DOCASE  12392>>IF
PARMX
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:382  
     11250**DCL     12176<<ASSIGN  12177>>ASSIGN  12178>>ASSIGN  12178>>ASSIGN  12184>>IF      12191>>IF
     12215>>ASSIGN  12216>>ASSIGN  12216>>ASSIGN  12221>>IF      12230>>IF      12232>>IF      12232>>IF
     12270>>IF      12270>>IF      12294>>ASSIGN  12305>>IF      12307>>IF      12307>>IF      12311>>CALL
     12312>>CALL    12316>>CALL    12317>>CALL    12337>>ASSIGN  12379>>ASSIGN  12392>>IF      12394>>ASSIGN
     12409>>ASSIGN
PERM_PARM
     11252**DCL     12330<<ASSIGN  12332<<ASSIGN  12334>>IF      12334>>IF      12371>>IF      12371>>IF
PROMPT.NODENAME
     10249**DCL     12169<<ASSIGN  12454<<ASSIGN
PSEDO_SRCH
     12477**LABEL   12481--EXIT
PSEUDO_SET_ERR
     12550**LABEL   12465--GOTO    12547--CALLALT
PTR$
     11270**DCL     11908<<ASSIGN  11909<<ASSIGN  11909>>ASSIGN  11912<<ASSIGN  11913<<ASSIGN  11913>>ASSIGN
     11919>>ASSIGN  12080<<ASSIGN  12081<<ASSIGN  12081>>ASSIGN  12084<<ASSIGN  12085<<ASSIGN  12085>>ASSIGN
     12087>>CALL    12231<<ASSIGN  12236>>ASSIGN  12240>>DOCASE  12242>>ASSIGN  12243>>DOINDEX 12244>>ASSIGN
     12247>>ASSIGN  12248>>ASSIGN  12266<<ASSIGN  12267>>DOCASE  12269>>CALLBLT 12269>>CALLBLT 12279>>DOINDEX
     12280>>ASSIGN  12280>>ASSIGN  12286>>ASSIGN  12286>>ASSIGN  12339>>IF      12339>>IF      12403<<ASSIGN
     12404<<ASSIGN  12404>>ASSIGN  12405>>ASSIGN  12408<<ASSIGN  12426<<ASSIGN  12427<<ASSIGN  12427>>ASSIGN
     12430<<ASSIGN  12431<<ASSIGN  12431>>ASSIGN  12433>>ASSIGN  12617<<ASSIGN  12623>>ASSIGN  12633>>ASSIGN
PTR$ IN PROCEDURE ALTER_FID
     12576**DCL     12575--PROC    12579>>IF      12580>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT 12580>>CALLBLT
     12585>>IF      12586>>CALLBLT 12586>>CALLBLT 12590>>IF      12596>>ASSIGN  12596>>ASSIGN  12599>>ASSIGN
     12599>>ASSIGN
P_PCB.OUT$
      9706**DCL     12170<<ASSIGN
RCVCQ_SNDCQ
     11283**DCL     12265<<ASSIGN  12275<<ASSIGN  12309>>IF
READ_NETCON
     11343**DCL     11742<>CALL    11753<>CALL    11812<>CALL    12293<>CALL    12378<>CALL    12462<>CALL
READ_NETCON.BUF_
     11345**DCL     11740<<ASSIGN  11751<<ASSIGN  11811<<ASSIGN  12292<<ASSIGN  12377<<ASSIGN  12461<<ASSIGN
READ_NETCON.KEY_
     11343**DCL     11741<<ASSIGN  11752<<ASSIGN  11810<<ASSIGN  12291<<ASSIGN  12376<<ASSIGN  12460<<ASSIGN
READ_NETCON.STATION_
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:383  
     11346**DCL     11347--REDEF
READ_NETCON.V
     11347**DCL     11343--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     11358**DCL     11358--REDEF
READ_NETCON.V.INDX#
     11356**DCL     11356--REDEF
RECORD_CHANGED
     11281**DCL     12021<<ASSIGN  12050<<ASSIGN  12074<<ASSIGN  12077>>IF
RECORD_SIZE
     11280**DCL     12164<<ASSIGN  12166<>CALL
RESET_PARAMS_TO_DEFAULTS
     12602**PROC    11797--CALL    11881--CALL    11885--CALL    12060--CALL
SCNOPTS
     11254**DCL     11744<<DOINDEX 11746>>ASSIGN  11779>>IF      11779>>IF      11788>>ASSIGN
SETCODE
     11747**LABEL   11753--CALLALT 11870--EXIT
SET_ERR
     12450**LABEL   11742--CALLALT 11764--CALLALT 11812--CALLALT 11920--CALLALT 11961--CALLALT 11978--CALLALT
     11995--CALLALT 12003--CALLALT 12166--CALLALT 12211--GOTO    12228--GOTO    12326--GOTO    12367--GOTO
     12390--GOTO
SRCH_TBL1 IN PROCEDURE RESET_PARAMS_TO_DEFAULTS
     12610**LABEL   12612--EXIT
SUBLK$
     11255**DCL     11788<<ASSIGN  11791>>ASSIGN  11791>>ASSIGN  11827>>DOINDEX 11828>>DOCASE  11831>>CALL
     11874>>IF      11880>>IF      11883>>IF      12511<<ASSIGN  12512>>DOCASE  12515>>IF      12516>>CALLBLT
     12516>>CALLBLT 12520>>IF      12521>>CALLBLT 12521>>CALLBLT 12524>>IF      12525>>CALLBLT 12525>>CALLBLT
     12529>>IF      12530>>CALLBLT 12530>>CALLBLT 12534>>IF      12535>>CALLBLT 12535>>CALLBLT
SUBLOP
     11256**DCL     11827<<DOINDEX 11828>>DOCASE  11831>>CALL    11874>>IF      11880>>IF      11883>>IF
TARGET IN PROCEDURE ALTER_FID
     12577**DCL     12575--PROC    12580<<CALLBLT 12586<<CALLBLT 12592>>CALLBLT 12593--IF      12594>>CALLBLT
     12595<<ASSIGN  12596<<ASSIGN  12599<<ASSIGN
TEMP1
     11257**DCL     12247<<ASSIGN  12250>>DOINDEX 12516<<CALLBLT 12517>>ASSIGN  12521<<CALLBLT 12522>>ASSIGN
     12525<<CALLBLT 12526>>ASSIGN  12530<<CALLBLT 12531>>ASSIGN  12535<<CALLBLT 12536>>ASSIGN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:384  
TEMP2
     11258**DCL     12248<<ASSIGN  12250>>DOINDEX
TEXTC
     10009**DCL     11990--CALL    12025--CALL    12069--CALL    12159--CALL
TEXTC.COUNT
     10010**DCL     11988<<ASSIGN  12023<<ASSIGN  12067<<ASSIGN  12157<<ASSIGN
TEXTC.TEXT
     10011**DCL     11989<<ASSIGN  12024<<ASSIGN  12068<<ASSIGN  12158<<ASSIGN
TMP$
     11260**DCL     11746<<ASSIGN  11747>>DOCASE  11757>>IF      11760<>CALL    11768>>ASSIGN  11768>>ASSIGN
     11818>>IF
TOO_BIG
     12565**LABEL   12515--GOTO    12520--GOTO    12524--GOTO    12529--GOTO    12534--GOTO
TOO_MANY_PSEUDO
     12556**LABEL   12490--GOTO
TOP$
         8**DCL         6--PROC    10483--IMP-PTR 11723>>DOINDEX 11724>>ASSIGN
TOP2$
     11269**DCL     10566--IMP-PTR 11991<>CALL    11992>>IF      11994<>CALL    12012<>CALL    12013>>IF
     12014>>CALLBLT 12014>>CALLBLT 12026<>CALL    12027>>IF      12028>>ASSIGN  12028>>ASSIGN  12070<>CALL
     12071>>IF      12073<>CALL    12160<>CALL    12161>>IF      12162>>ASSIGN  12162>>ASSIGN
T_PSEUDO#
     11259**DCL     12476<<ASSIGN  12480<<ASSIGN  12496>>IF      12499<<ASSIGN  12517>>ASSIGN  12522>>ASSIGN
     12526>>ASSIGN  12531>>ASSIGN  12536>>ASSIGN
UPDATE_FILE
     12371**LABEL   12343--CALLALT
UPD_NETCON_ERR
     12441**LABEL   12293--CALLALT 12297--CALLALT 12378--CALLALT 12382--CALLALT 12434--CALLALT
VALUE
     11261**DCL     11262--REDEF   12269<<CALLBLT 12274<<ASSIGN  12274>>ASSIGN  12278<<ASSIGN  12282<<ASSIGN
     12282>>ASSIGN  12285<<ASSIGN  12294>>ASSIGN  12307>>IF      12307>>IF      12340<>CALL    12342>>ASSIGN
     12379>>ASSIGN  12405>>ASSIGN  12409>>ASSIGN
VALUEC.RES
     11264**DCL     12286<<ASSIGN
VALUE_B
     11166**DCL     12405<<ASSIGN  12637<<ASSIGN
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:385  
VLP_ACCT
     11568**DCL     11545--DCLINIT
VLP_NAME
     11595**DCL     11545--DCLINIT
VLP_PASS
     11608**DCL     11546--DCLINIT
VLP_SN
     11621**DCL     11546--DCLINIT
VLP_WSN
     11634**DCL     11546--DCLINIT
VLR_FID
     11647**DCL     11548--DCLINIT
WRITE_NETCON
     11383**DCL     11764<>CALL    11920<>CALL    11961<>CALL    12297<>CALL    12382<>CALL    12434<>CALL
     12547<>CALL
WRITE_NETCON.BUF_
     11383**DCL     11762<<ASSIGN  11915<<ASSIGN  11954<<ASSIGN  12296<<ASSIGN  12381<<ASSIGN  12423<<ASSIGN
     12541<<ASSIGN
WRITE_NETCON.BUF_.BOUND
     11383**DCL     11919<<ASSIGN  11956<<ASSIGN  12433<<ASSIGN  12542<<ASSIGN
WRITE_NETCON.KEY_
     11383**DCL     11763<<ASSIGN  11916<<ASSIGN  11955<<ASSIGN  12295<<ASSIGN  12380<<ASSIGN  12422<<ASSIGN
     12540<<ASSIGN
WRITE_NETCON.STATION_
     11385**DCL     11385--REDEF
WRITE_NETCON.V
     11386**DCL     11383--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
     11392**DCL     11392--REDEF
WRITE_SUCCESSFULL_FMT
      9976**DCL      9979--DCLINIT
WRITE_SUCCESSFULL_VEC
      9978**DCL     12298<>CALL    12346<>CALL    12383<>CALL    12435<>CALL
XUR$ERRMSG
      9639**DCL-ENT 12353--CALL    12362--CALL
XUR$GETCMD
PL6.E3A0      #004=KSC$SET File=KSC$COMMANDS1.:E05TSI                            WED 07/30/97 01:45 Page:386  
      9634**DCL-ENT 11991--CALL    12012--CALL    12026--CALL    12070--CALL    12160--CALL
