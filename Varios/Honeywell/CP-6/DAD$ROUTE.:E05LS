VERSION E05

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:1    
        1        1        /*M*   Display Route tables for ANLZ                                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*                                                                    */
        8        8        /*D* NAME: DAD$ROUTE
        9        9             CALL: CALL DAD$ROUTE(TOP);
       10       10             INPUT: TOP - Parser output block from DISPLAY ROUTE command.
       11       11             DISCRIPTION:  If TOP.NSUBLKS is 0 then the entire ROUTE table
       12       12                is displayed.  Otherwise, table entries for nodes specified in
       13       13                the DISPLAY command are displayed.
       14       14                                                                              */
       15       15        DAD$ROUTE: PROC(TOP);
       16       16
       17       17        %INCLUDE DA_FORMAT_C;
       18      259        %INCLUDE DA_ANLZ_R;
       19      272        %INCLUDE DA_MAP_R;
       20      302        %INCLUDE DA_TEXTC_C;
       21      333        %INCLUDE DA_MONSYM_C;
       22      384        %INCLUDE KI$QHDR;
       23      536        %INCLUDE KI$MHDR;
       24      677        %INCLUDE KJ_FCNS_C;
       25      704        %INCLUDE KI_MACROS_C;
       26     1312        %INCLUDE XU_MACRO_C;
       27     4418        /*                                                                    */
       28     4419    1   DCL B$IS$ PTR SYMREF;
       29     4420        /*                                                                    */
       30     4421    1   DCL DAM$MAP ENTRY(5) ALTRET;
       31     4422    1   DCL DAF$WRITE EPTR SYMREF;
       32     4423    1   DCL DAF$INIT ENTRY(1) ALTRET;
       33     4424    1   DCL DAF$NEWPAGE ENTRY;
       34     4425    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       35     4426    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
       36     4427    1   DCL DBM$PACK4 ENTRY(2);
       37     4428    1   DCL RTETTL CONSTANT CHAR(0) INIT('ROUTE TABLES');
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:2    
       38     4429    1   DCL RLINE0 STATIC CHAR(0) INIT(
       39     4430    1   ' ---- -------- --- --- ---- ---- ----');
       40     4431    1   DCL 1 ROUTE,
       41     4432    1         2 NODE UBIN,
       42     4433    1         2 NAME CHAR(8),
       43     4434    1         2 FEI UBIN,
       44     4435    1         2 QOS UBIN,
       45     4436    1         2 AQOS UBIN,
       46     4437    1         2 HOST CHAR(4),
       47     4438    1         2 LINK CHAR(4);
       48     4439    1   DCL 1 ROUTELINK,
       49     4440    1         2 FEI UBIN,
       50     4441    1         2 NODE UBIN,
       51     4442    1         2 QOS UBIN,
       52     4443    1         2 MSGS_IN UBIN,
       53     4444    1         2 MSGS_OUT UBIN;
       54     4445    1   DCL 1 FEI,
       55     4446    1         2 FEI UBIN,
       56     4447    1         2 NODE UBIN,
       57     4448    1         2 STATE CHAR(4),
       58     4449    1         2 TCNT UBIN,
       59     4450    1         2 OCQ$ PTR,
       60     4451    1         2 OCQ REDEF OCQ$ UBIN,
       61     4452    1         2 FRZN CHAR(4),
       62     4453    1         2 NOTIME CHAR(4),
       63     4454    1         2 QOS UBIN,
       64     4455    1         2 PROB CHAR(4),
       65     4456    1         2 PSTATE CHAR(4),
       66     4457    1         2 QFLHD$ PTR,
       67     4458    1         2 BDU# UBIN,
       68     4459    1         2 IOM UBIN,
       69     4460    1         2 DEV UBIN;
       70     4461    1   DCL 1 QHDR,
       71     4462    1        2 FEI# UBIN,
       72     4463    1        2 HOST_NODE UBIN,
       73     4464    1        2 FEP_NODE  UBIN,
       74     4465    1        2 INTLOCK UBIN,
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:3    
       75     4466    1        2 QSIZE UBIN(36),
       76     4467    1        2 GATE BIT(72),
       77     4468    1        2 GATE_R REDEF GATE,
       78     4469    1           3 L_GATE BIT(36),
       79     4470    1           3 U_GATE BIT(36),
       80     4471    1        2 RPTR UBIN(36),
       81     4472    1        2 IPTR UBIN(36),
       82     4473    1        2 QOS UBIN,
       83     4474    1        2 FLAG BIT(36),
       84     4475    1        2 TOTMES UBIN,
       85     4476    1        2 CCMD BIT(36),
       86     4477    1        2 LSTIPTR UBIN;
       87     4478    1   DCL 1 QMSG,
       88     4479    1        2 FREEFLAG UBIN,
       89     4480    1        2 CURR UBIN,
       90     4481    1        2 FEI# UBIN,
       91     4482    1        2 FUNCTION CHAR(8),
       92     4483    1        2 ACTSIZ UBIN,
       93     4484    1        2 OFFSET UBIN,
       94     4485    1        2 SIZE UBIN,
       95     4486    1        2 UID UBIN,
       96     4487    1        2 FPTSZ UBIN,
       97     4488    1        2 MSGSIZ UBIN;
       98     4489    1   DCL QMSGFMT CHAR(0) STATIC INIT(
       99     4490    1   ' %4O .%Z6O %4D %8A %7D %6D  %6D  .%Z6O %7D %7D');
      100     4491    1   DCL QHDRFMT STATIC CHAR(0) INIT('
      101     4492        %/Fei#:%3D
      102     4493        %/Host#:%3D %16-Fep#:%3D %37-Intlock:.%L12O
      103     4494        %/Qsize: %L7D %16-Lock: .%L12O %37-Unlock: .%L12O
      104     4495        %/Rptr: .%L12O %16-Iptr: .%L12O %37-Qos:%3D
      105     4496        %/Flags: .%L12O %16-Totmes: .%L12O %37-Ccmd: .%L12O
      106     4497    1   %/Last Iptr: .%L12O');
      107     4498        %TEXTC(NAME=QHDRHDR,TEXT=
      108     4499        ' Free     Loc Fei# Function Actsize Offset    Size      Uid Fptsize Msgsize');
      109     4523        %TEXTC(NAME=QHDRHDR1,TEXT=
      110     4524        ' ----     --- ---- -------- ------- ------    ----      --- ------- -------');
      111     4548
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:4    
      112     4549    1   DCL STATE(0:8) CHAR(4) CONSTANT INIT('Down','Init','Run','QFUL','DEBG','Dump','Boot'
              4549            ,'Mask','Stpg');
      113     4550    1   DCL FUNCTION(0:%KJ_MAXOFUNCTIONS) CHAR(8) CONSTANT INIT('Nopi','Timer','Imok','Sdbg'
              4550            ,
      114     4551    1                                           'Rdbg','Idata','Unknown'*26,'Nop',
      115     4552    1                                           'Time','Ruok','Odata');
      116     4553    1   DCL CURR UBIN;
      117     4554    1   DCL CURR$ PTR;
      118     4555    1   DCL PROBLEM (0:20) CHAR(4) CONSTANT INIT(
      119     4556    1   'Up','Tout','QFL','Nobt','Scrh','Cplr','Bint','Bdln','Mfmt','Bfcn',
      120     4557    1   'Dcft','Boot','6alz','Stop','Part','Uprt','Freq','Lnku','Lnkd','Qos','???');
      121     4558    1   DCL FMTBUF CHAR(180) STATIC;
      122     4559    1   DCL 1 FMTVEC STATIC,
      123     4560    1         2 CT UBIN(20) UNAL,
      124     4561    1         2 * UBIN(16) UNAL INIT(0),
      125     4562    1         2 P$ PTR;
      126     4563    1   DCL RFMT0 STATIC CHAR(0) INIT(
      127     4564    1   ' %/Node:%3D Name: %8A Fei:%3D Qos:%3D Aqos:%3D Host: %4A Link: %4A');
      128     4565    1   DCL RFMT1 STATIC CHAR(0) INIT(
      129     4566    1   '         Fei:%3D Node:%3D Qos:%3D In:%8D Out:%8D');
      130     4567        %TEXTC (NAME=FEIHDR0,TEXT=
      131     4568        ' FEI Node State Tcnt Cqls  Frzn Notime Qos Prob State    Qfldhd    BDU# Chan');
      132     4592        %TEXTC (NAME=FEIHDR1,TEXT=
      133     4593        ' --- ---- ----- ---- ----- ---- ------ --- ---- ----- ------------ ---- -----');
      134     4617    1   DCL FEIFMT CHAR(0) CONSTANT INIT(
      135     4618    1   ' %3D %4D  %4A %4D $LS%2D  %4A  %4A %3D %4A  %4A %Z12O %3D  %1D-%3D');
      136     4619    1   DCL NODES UBIN;
      137     4620    1   DCL MXFE UBIN;
      138     4621    1   DCL ROUTE$$ PTR;
      139     4622    1   DCL ROUTE$ PTR;
      140     4623    1   DCL FEI$ PTR;
      141     4624    1   DCL FEI$$ PTR;
      142     4625    1   DCL A UBIN BASED;
      143     4626    1   DCL SBINWORD SBIN BASED;
      144     4627    1   DCL UBINWORD UBIN BASED;
      145     4628    1   DCL PTR$ PTR BASED;
      146     4629    1   DCL P$ PTR;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:5    
      147     4630    1   DCL Q$ PTR;
      148     4631    1   DCL TOPOQ$ PTR;
      149     4632    1   DCL TEMP$ PTR;
      150     4633    1   DCL TEMP REDEF TEMP$ UBIN;
      151     4634    1   DCL VECT VECTOR STATIC INIT(VECTOR(NIL));
      152     4635    1   DCL FEI## UBIN;
      153     4636    1   DCL LFEI# UBIN;
      154     4637    1   DCL HFEI# UBIN;
      155     4638    1   DCL IPTR UBIN;
      156     4639    1   DCL RPTR UBIN;
      157     4640    1   DCL LAST_PTR UBIN;
      158     4641    1   DCL TUID UBIN;
      159     4642    1   DCL QSIZE UBIN;
      160     4643    1   DCL 1 TUID_B BASED ALIGNED,
      161     4644    1        2 * BIT(4) UNAL,
      162     4645    1        2 D UBIN(32) UNAL;
      163     4646    1   DCL ICQ BIT(1);
      164     4647    1   DCL UID UBIN WORD;
      165     4648    1   DCL I UBIN;
      166     4649    1   DCL J UBIN;
      167     4650
      168     4651        %KI$ROUTE;
      169     4705    1   DCL KI$ROUTE$(0:0) PTR BASED;
      170     4706        %KI$FEI;
      171     4790    1   DCL KI$FEI$(0:0) PTR BASED;
      172     4791        %KI$QMHDR(STCLASS="BASED(Q$)");
      173     4840        %REPORT (NAME=RRPRT,TITLE='ROUTE TABLES',HEADER=NO);
      174     4906        %REPORT (NAME=FEIRPRT,TITLE='FEI TABLES',HEADER=YES);
      175     4972        %HEADER (TEXTADR=FEIHDR0,LAST=NO);
      176     5014        %HEADER (TEXTADR=FEIHDR1);
      177     5056        %REPORT (NAME=ICQRPRT,TITLE='INPUT CIRCULAR QUEUE',HEADER=YES);
      178     5122        %HEADER (TEXTADR=QHDRHDR,LAST=NO);
      179     5164        %HEADER (TEXTADR=QHDRHDR1);
      180     5206        %REPORT (NAME=OCQRPRT,TITLE='OUTPUT CIRCULAR QUEUE',HEADER=YES);
      181     5272        %HEADER (TEXTADR=QHDRHDR,LAST=NO);
      182     5314        %HEADER (TEXTADR=QHDRHDR1);
      183     5356        %REPORT (NAME=OCQHDRRPT,TITLE='OUTPUT CIRCULAR QUEUE HEADER',HEADER=NO);
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:6    
      184     5422        %REPORT (NAME=ICQHDRRPT,TITLE='INPUT CIRCULAR QUEUE HEADER',HEADER=NO);
      185     5488        %PARSE$OUT (NAME=TOP,STCLASS=" ");
      186     5533        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      187     5578        %SUB NEVER="WHILE('0'B)";
      188     5579        %SUB FOREVER="WHILE('1'B)";
      189     5580        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:7    
      190     5581    1           CALL DAF$INIT(RRPRT);
      191     5582
      192     5583    1           CALL DAS$SDMONPTR(%M#KI_NODES,P$) ALTRET(ALT);
      193     5584    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      194     5585    1           NODES = P$->SBINWORD;
      195     5586    1           CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);
      196     5587    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      197     5588    1           MXFE = P$->SBINWORD;
      198     5589    1           CALL DAS$SDMONPTR(%M#KI_ROUTE$$,ROUTE$$) ALTRET(ALT);
      199     5590    1           CALL DAM$MAP(ROUTE$$,ROUTE$$,,,DA_MONISDATA) ALTRET(ALT);
      200     5591    1           ROUTE$$ = ROUTE$$->PTR$;
      201     5592    1           CALL DAM$MAP(ROUTE$$,ROUTE$$);
      202     5593    1           CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);
      203     5594    1           CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);
      204     5595    1           FEI$$ = FEI$$->PTR$;
      205     5596    1           CALL DAM$MAP(FEI$$,FEI$$);
      206     5597    1           IF TOP.NSUBLKS = 0
      207     5598    1           THEN
      208     5599    2           DO I = 0 TO NODES;
      209     5600    2              CALL DROUTE(I);
      210     5601    2              END;
      211     5602    1           ELSE
      212     5603    2           DO I = 0 TO TOP.NSUBLKS-1;
      213     5604    2              CALL DAA$VALUE(TOP.SUBLK$(I)->OUT.SUBLK$(0)->OUT,J);
      214     5605    2              CALL DROUTE(J);
      215     5606    2              END;
      216     5607
      217     5608    1           RETURN;
      218     5609    1   ALT:    RETURN;
      219     5610        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:8    
      220     5611    1   DROUTE: PROC (NODE);
      221     5612    2   DCL NODE UBIN;
      222     5613
      223     5614    2           ROUTE$ = ROUTE$$->KI$ROUTE$(NODE);
      224     5615    2           CALL DAM$MAP(ROUTE$,ROUTE$);
      225     5616    2           IF ROUTE$->KI$ROUTE.CURRENT_QOS ~= 255 OR TOP.NSUBLKS ~= 0
      226     5617    3           THEN DO;
      227     5618    3              ROUTE.NODE = NODE;
      228     5619    3              ROUTE.NAME = ROUTE$->KI$ROUTE.NODE_NAME;
      229     5620    3              ROUTE.FEI = ROUTE$->KI$ROUTE.FEI#;
      230     5621    3              ROUTE.QOS = ROUTE$->KI$ROUTE.CURRENT_QOS;
      231     5622    3              ROUTE.AQOS = ROUTE$->KI$ROUTE.ALT_QOS;
      232     5623    3              IF ROUTE$->KI$ROUTE.HOST
      233     5624    3              THEN
      234     5625    3                 ROUTE.HOST = 'Yes';
      235     5626    3              ELSE
      236     5627    3                 ROUTE.HOST = 'No';
      237     5628    3              IF ROUTE$->KI$ROUTE.LINK_CONNECTED
      238     5629    3              THEN
      239     5630    3                 ROUTE.LINK = 'Yes';
      240     5631    3              ELSE
      241     5632    3                 ROUTE.LINK = 'No';
      242     5633    3              CALL DAF$WRITE(VECTOR(RFMT0),VECTOR(ROUTE));
      243     5634    4              DO J = 1 TO MXFE;
      244     5635    4                 ROUTELINK.FEI = J;
      245     5636    4                 IF ROUTE$->KI$ROUTE.FEI# = 0
      246     5637    4                 THEN
      247     5638    4                    ROUTELINK.NODE = 0;
      248     5639    5                 ELSE DO;
      249     5640    5                    FEI$ = FEI$$->KI$FEI$(J);
      250     5641    5                    CALL DAM$MAP(FEI$,FEI$);
      251     5642    5                    ROUTELINK.NODE = FEI$->KI$FEI.FEP#;
      252     5643    5                    END;
      253     5644    4                 ROUTELINK.QOS = ROUTE$->KI$ROUTE.LINK.QOS(J);
      254     5645    4                 ROUTELINK.MSGS_IN = ROUTE$->KI$ROUTE.LINK.MSGS_IN(J);
      255     5646    4                 ROUTELINK.MSGS_OUT = ROUTE$->KI$ROUTE.LINK.MSGS_OUT(J);
      256     5647    4                 IF ROUTELINK.QOS ~= 255
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:9    
      257     5648    4                OR (ROUTELINK.MSGS_IN+ROUTELINK.MSGS_OUT)~=0
      258     5649    4                 THEN
      259     5650    4                    CALL DAF$WRITE(VECTOR(RFMT1),VECTOR(ROUTELINK));
      260     5651    4                 END;
      261     5652    3              END;
      262     5653    2           RETURN;
      263     5654
      264     5655    2   END DROUTE;
      265     5656
      266     5657        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:10   
      267     5658    1   DAD$FEI: ENTRY(TOP);
      268     5659    1           CALL DAF$INIT(FEIRPRT);
      269     5660
      270     5661    1           CALL DAS$SDMONPTR(%M#KI_NODES,P$) ALTRET(ALT);
      271     5662    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      272     5663    1           NODES = P$->SBINWORD;
      273     5664    1           CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);
      274     5665    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      275     5666    1           MXFE = P$->SBINWORD;
      276     5667    1           CALL DAS$SDMONPTR(%M#KI_ROUTE$$,ROUTE$$) ALTRET(ALT);
      277     5668    1           CALL DAM$MAP(ROUTE$$,ROUTE$$,,,DA_MONISDATA) ALTRET(ALT);
      278     5669    1           ROUTE$$ = ROUTE$$->PTR$;
      279     5670    1           CALL DAM$MAP(ROUTE$$,ROUTE$$);
      280     5671    1           CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);
      281     5672    1           CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);
      282     5673    1           FEI$$ = FEI$$->PTR$;
      283     5674    1           CALL DAM$MAP(FEI$$,FEI$$);
      284     5675    1           IF TOP.NSUBLKS = 0
      285     5676    1           THEN
      286     5677    2           DO I = 1 TO MXFE;
      287     5678    2              CALL DFEI(I);
      288     5679    2              END;
      289     5680    1           ELSE
      290     5681    2           DO I = 0 TO TOP.NSUBLKS-1;
      291     5682    2              CALL DAA$VALUE(TOP.SUBLK$(I)->OUT.SUBLK$(0)->OUT,J);
      292     5683    2              CALL DFEI(J);
      293     5684    2              END;
      294     5685
      295     5686    1           RETURN;
      296     5687        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:11   
      297     5688    1   DFEI:   PROC (FEI#);
      298     5689
      299     5690    2   DCL FEI# UBIN;
      300     5691
      301     5692    2           IF FEI# = 0 OR FEI# > MXFE
      302     5693    2           THEN
      303     5694    2              RETURN;
      304     5695    2           FEI.FEI = FEI#;
      305     5696    2           FEI$ = FEI$$->KI$FEI$(FEI#);
      306     5697    2           CALL DAM$MAP (FEI$,FEI$);
      307     5698    2           FEI.NODE = FEI$->KI$FEI.FEP#;
      308     5699    2           FEI.STATE = STATE(FEI$->KI$FEI.FEST);
      309     5700    2           FEI.TCNT = FEI$->KI$FEI.TCNT;
      310     5701    2           FEI.OCQ$ = FEI$->KI$FEI.OCQ$;
      311     5702    2           FEI.OCQ = MOD(FEI.OCQ,256);
      312     5703    2           CALL YESNO (FEI$->KI$FEI.FROZEN,FEI.FRZN);
      313     5704    2           CALL YESNO (FEI$->KI$FEI.NOTIME,FEI.NOTIME);
      314     5705    2           FEI.QOS = FEI$->KI$FEI.QOS;
      315     5706    2           FEI.PROB = PROBLEM(FEI$->KI$FEI.PBST.PROB);
      316     5707    2           FEI.PSTATE = STATE(FEI$->KI$FEI.PBST.STATE);
      317     5708    2           FEI.QFLHD$ = FEI$->KI$FEI.QFLHD$;
      318     5709    2           FEI.BDU# = FEI$->KI$FEI.BDU#;
      319     5710    2           FEI.IOM = FEI$->KI$FEI.FECH.IOM;
      320     5711    2           FEI.DEV = FEI$->KI$FEI.FECH.DEV;
      321     5712    2           CALL DAF$WRITE(VECTOR(FEIFMT),VECTOR(FEI));
      322     5713    2           RETURN;
      323     5714
      324     5715    2   YESNO:  PROC(FLAG,TEXT);
      325     5716    3   DCL FLAG BIT(1) UNAL;
      326     5717    3   DCL TEXT CHAR(4);
      327     5718    3           IF FLAG
      328     5719    3           THEN
      329     5720    3              TEXT = 'Yes';
      330     5721    3           ELSE
      331     5722    3              TEXT = 'No';
      332     5723    3           RETURN;
      333     5724
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:12   
      334     5725    3   END YESNO;
      335     5726
      336     5727    2   END DFEI;
      337     5728        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:13   
      338     5729    1   DAD$OCQ: ENTRY(TOP);
      339     5730    1     CALL DAF$INIT(OCQHDRRPT);
      340     5731    1     ICQ = '0'B;
      341     5732    1     GOTO COMMON;
      342     5733
      343     5734    1   DAD$ICQ: ENTRY(TOP);
      344     5735    1     CALL DAF$INIT(ICQHDRRPT);
      345     5736    1     ICQ = '1'B;
      346     5737
      347     5738    1   COMMON:;
      348     5739    1     CALL DAA$VALUE(TOP.SUBLK$(0)->OUT.SUBLK$(0)->OUT,FEI##);
      349     5740    1     CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);
      350     5741    1     CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      351     5742    1     MXFE = P$->SBINWORD;
      352     5743    1     IF FEI## > MXFE THEN
      353     5744    1        RETURN;
      354     5745    2     IF FEI## = 0 THEN DO;
      355     5746    2        LFEI# = 1;
      356     5747    2        HFEI# = MXFE;
      357     5748    2        END;
      358     5749    2     ELSE DO;
      359     5750    2        LFEI# = FEI##;
      360     5751    2        HFEI# = FEI##;
      361     5752    2        END;
      362     5753    2     DO FEI## = LFEI# TO HFEI#;
      363     5754    2        CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);
      364     5755    2        CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);
      365     5756    2        FEI$$ = FEI$$->PTR$;
      366     5757    2        CALL DAM$MAP(FEI$$,FEI$$);
      367     5758    2        FEI$ = FEI$$->KI$FEI$(FEI##);
      368     5759    2        CALL DAM$MAP(FEI$,FEI$);
      369     5760    2        IF ICQ THEN
      370     5761    2           Q$ = FEI$->KI$FEI.ICQ$;
      371     5762    2        ELSE
      372     5763    2           Q$ = FEI$->KI$FEI.OCQ$;
      373     5764    2        TOPOQ$ = Q$;
      374     5765    2        CALL DOQHDR;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:14   
      375     5766    2        IF ICQ THEN
      376     5767    2           CALL DAF$INIT(ICQRPRT);
      377     5768    2        ELSE
      378     5769    2           CALL DAF$INIT(OCQRPRT);
      379     5770    2        CALL DOQ;
      380     5771    2        END;
      381     5772    1     RETURN;
      382     5773
      383     5774        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:15   
      384     5775    1   DOQHDR: PROC;
      385     5776    2     VBASE(VECT) = Q$;
      386     5777    2     VBOUND(VECT) = SIZEC(KI$QHDR)-1;
      387     5778    3     CALL DAM$MAP(Q$,Q$,,,VECT) WHENALTRETURN DO;
      388     5779    3        RETURN;
      389     5780    3        END;
      390     5781    2     QHDR.FEI# = FEI##;
      391     5782    2     QHDR.CCMD = Q$->KI$QHDR.CCMD;
      392     5783    2     QHDR.HOST_NODE = Q$->KI$QHDR.HOST_NODE#;
      393     5784    2     QHDR.FEP_NODE = Q$->KI$QHDR.FEP_NODE#;
      394     5785    2     QHDR.QOS = Q$->KI$QHDR.QOS;
      395     5786    2     QHDR.INTLOCK = Q$->KI$QHDR.INTLOCK;
      396     5787    2     QHDR.QSIZE = Q$->KI$QHDR.QSIZE;
      397     5788    2     QHDR.GATE = Q$->KI$QHDR.GATE;
      398     5789    2     QHDR.RPTR = Q$->KI$QHDR.RPTR;
      399     5790    2     QHDR.IPTR = Q$->KI$QHDR.IPTR;
      400     5791    2     QHDR.FLAG = Q$->KI$QHDR.FLG;
      401     5792    2     QHDR.TOTMES = Q$->KI$QHDR.TOTMES;
      402     5793    2     QHDR.LSTIPTR = Q$->KI$QHDR.LAST_PTR;
      403     5794    2     CALL DAF$WRITE(VECTOR(QHDRFMT),VECTOR(QHDR));
      404     5795    2     RETURN;
      405     5796    2   END DOQHDR;
      406     5797        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:16   
      407     5798    1   DOQ: PROC;
      408     5799    2        IPTR = 0;
      409     5800    2        RPTR = 0;
      410     5801    2        QSIZE = 0;
      411     5802    2        LAST_PTR = 0;
      412     5803    2        ADDR(IPTR)->TUID_B.D = Q$->KI$QHDR.IPTR;
      413     5804    2        ADDR(RPTR)->TUID_B.D = Q$->KI$QHDR.RPTR;
      414     5805    2        ADDR(LAST_PTR)->TUID_B.D = Q$->KI$QHDR.LAST_PTR;
      415     5806    2        ADDR(QSIZE)->TUID_B.D = Q$->KI$QHDR.QSIZE;
      416     5807    2        IF TOP.NSUBLKS > 1 THEN
      417     5808    3           DO;
      418     5809    3           IF IPTR = SIZEW(KI$QHDR) THEN
      419     5810    4              DO;
      420     5811    5              CALL GETNXT (LAST_PTR) WHENALTRETURN DO;
      421     5812    5                 RETURN;
      422     5813    5                 END;
      423     5814
      424     5815    5              DO WHILE CURR > SIZEW(KI$QHDR);
      425     5816    5                 CALL DISPMSG(CURR$);
      426     5817    6                 IF ICQ THEN DO;
      427     5818    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN
      428     5819        /*                  message has not been scanned yet.  last_iptr hasn't been
      429     5820                            moved to uid */
      430     5821    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;
      431     5822    6                    ELSE
      432     5823    6                       TUID = CURR$->KI$QMHDR.UID;
      433     5824    6                    CALL DBM$PACK4(TUID,UID);
      434     5825    6                    END;
      435     5826    5                 ELSE
      436     5827    5                    UID = KI$QMHDR.UID;
      437     5828    6                 CALL GETNXT(UID) WHENALTRETURN DO;
      438     5829    6                    RETURN;
      439     5830    6                    END;
      440     5831    5                 END;
      441     5832    4              CALL DISPMSG(CURR$);
      442     5833    4              RETURN;
      443     5834    4              END;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:17   
      444     5835
      445     5836    3           ELSE
      446     5837    4              DO;
      447     5838    4                 IF ICQ THEN
      448     5839    5                    CALL GETNXT(LAST_PTR) WHENALTRETURN DO;
      449     5840    5                 RETURN;
      450     5841    5                 END;
      451     5842    5              DO WHILE CURR > SIZEW(KI$QHDR);
      452     5843    5                 CALL DISPMSG(CURR$);
      453     5844    6                 IF ICQ THEN DO;
      454     5845    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN
      455     5846        /*                  message has not been scanned yet.  last_iptr hasn't been
      456     5847                            moved to uid */
      457     5848    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;
      458     5849    6                    ELSE
      459     5850    6                       TUID = CURR$->KI$QMHDR.UID;
      460     5851    6                    CALL DBM$PACK4(TUID,UID);
      461     5852    6                    END;
      462     5853    5                 ELSE
      463     5854    5                    UID = KI$QMHDR.UID;
      464     5855    6                 CALL GETNXT(UID) WHENALTRETURN DO;RETURN;END;
      465     5856    5                 END;
      466     5857    4              CALL DISPMSG(CURR$);
      467     5858    5                IF ICQ THEN DO;
      468     5859    5                   IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN
      469     5860        /*               message has not been scanned yet.  last_iptr hasn't been
      470     5861                         moved to uid */
      471     5862    5                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;
      472     5863    5                    ELSE
      473     5864    5                       TUID = CURR$->KI$QMHDR.UID;
      474     5865    5                    CALL DBM$PACK4(TUID,UID);
      475     5866    5                    END;
      476     5867    4                 ELSE
      477     5868    4                 UID = KI$QMHDR.UID;
      478     5869    5              CALL GETNXT(UID) WHENALTRETURN DO;
      479     5870    5                 RETURN;
      480     5871    5                 END;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:18   
      481     5872    5              DO WHILE CURR > IPTR;
      482     5873    5                 CALL DISPMSG(CURR$);
      483     5874    6                 IF ICQ THEN DO;
      484     5875    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN
      485     5876        /*                  message has not been scanned yet.  last_iptr hasn't been
      486     5877                            moved to uid */
      487     5878    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;
      488     5879    6                    ELSE
      489     5880    6                       TUID = CURR$->KI$QMHDR.UID;
      490     5881    6                    CALL DBM$PACK4(TUID,UID);
      491     5882    6                    END;
      492     5883    5                 ELSE
      493     5884    5                    UID = KI$QMHDR.UID;
      494     5885    6                 CALL GETNXT(UID) WHENALTRETURN DO;
      495     5886    6                    RETURN;
      496     5887    6                    END;
      497     5888    5                 END;
      498     5889    4              END;  /* ELSE*/
      499     5890    3           END;  /* if nsublks>0 then */
      500     5891    2        ELSE
      501     5892    3           DO;
      502     5893    3           IF IPTR = RPTR THEN
      503     5894    3              RETURN;
      504     5895    3           IF IPTR > RPTR THEN
      505     5896    4              DO;   /*  just disp from here to rptr */
      506     5897    5              CALL GETNXT(RPTR) WHENALTRETURN DO; RETURN;END;
      507     5898    5              DO WHILE CURR < IPTR;
      508     5899    5                 CALL DISPMSG(CURR$);
      509     5900    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT
      510     5901    5                        + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      511     5902    6                 CALL GETNXT(TUID) WHENALTRETURN DO;
      512     5903    6                    RETURN;
      513     5904    6                    END;
      514     5905    5                 END;
      515     5906    4              END;
      516     5907    3           ELSE
      517     5908    4              DO;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:19   
      518     5909    5              CALL GETNXT(RPTR) WHENALTRETURN DO;RETURN;END;
      519     5910    5              DO WHILE CURR < QSIZE;
      520     5911
      521     5912    5                 CALL DISPMSG(CURR$);
      522     5913    5                 IF CURR$->KI$QMHDR.FUNCTION = %KJ_FCN_NOP OR
      523     5914    5                    CURR$->KI$QMHDR.FUNCTION = %KJ_FCN_NOPI THEN
      524     5915    5                         GOTO TOPOQ;
      525     5916    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT
      526     5917    5                          + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      527     5918    6                 CALL GETNXT(TUID) WHENALTRETURN DO;
      528     5919    6                    RETURN;
      529     5920    6                    END;
      530     5921    5                 END;
      531     5922    4              TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT
      532     5923    4                       + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      533     5924    5              CALL GETNXT(TUID) WHENALTRETURN DO;
      534     5925    5                 RETURN;
      535     5926    5                 END;
      536     5927    4              CALL DISPMSG(CURR$);
      537     5928    4   TOPOQ:     TUID = 0;
      538     5929    5              CALL GETNXT(TUID) WHENALTRETURN DO;RETURN;END;
      539     5930    5              DO WHILE CURR < IPTR;
      540     5931    5                 CALL DISPMSG(CURR$);
      541     5932    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT
      542     5933    5                       + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      543     5934    6                 CALL GETNXT(TUID) WHENALTRETURN DO;
      544     5935    6                    RETURN;
      545     5936    6                    END;
      546     5937    5                 END;
      547     5938    4              END;  /* ELSE  */
      548     5939    3           END;  /* IF TOP.NSUBLKS <= 1 */
      549     5940    2   RETURN;
      550     5941        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:20   
      551     5942    2   DISPMSG: PROC(QMSG$);
      552     5943    3     DCL QMSG$ PTR;
      553     5944
      554     5945    3     IF QMSG$->KI$QMHDR.FREFLG THEN
      555     5946    3        QMSG.FREEFLAG = 1;
      556     5947    3     ELSE
      557     5948    3        QMSG.FREEFLAG = 0;
      558     5949    3     QMSG.CURR = CURR + SIZEW(KI$QHDR);
      559     5950    3     TEMP$ = TOPOQ$;
      560     5951    3     TEMP = TEMP/262144;
      561     5952    3     QMSG.CURR = QMSG.CURR + TEMP;
      562     5953    3     QMSG.FEI# = QMSG$->KI$QMHDR.FEI#;
      563     5954    3     IF QMSG$->KI$QMHDR.FUNCTION > %KJ_MAXOFUNCTIONS THEN
      564     5955    3        QMSG.FUNCTION = 'Unknown';
      565     5956    3     ELSE
      566     5957    3        QMSG.FUNCTION = FUNCTION(QMSG$->KI$QMHDR.FUNCTION);
      567     5958    3     QMSG.ACTSIZ = QMSG$->KI$QMHDR.ACTSZ;
      568     5959    3     QMSG.OFFSET = QMSG$->KI$QMHDR.OFFSET;
      569     5960    3     QMSG.SIZE = QMSG$->KI$QMHDR.SIZE;
      570     5961    3     QMSG.UID = QMSG$->KI$QMHDR.UID;
      571     5962    3     QMSG.FPTSZ = QMSG$->KI$QMHDR.FPTSZ;
      572     5963    3     QMSG.MSGSIZ =((256*QMSG$->KI$QMHDR.MSGSZB.TOP + QMSG$->KI$QMHDR.MSGSZB.BOT
      573     5964    3            + 3 + 4*SIZEW(KI$QMHDR) ));
      574     5965    3     CALL DAF$WRITE(VECTOR(QMSGFMT),VECTOR(QMSG));
      575     5966    3   END DISPMSG;
      576     5967        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:21   
      577     5968    2   GETNXT: PROC(OFFSET) ALTRET;
      578     5969    3     DCL 1 OFFSET UBIN;      /* WORD OFFSET TO NEXT MESSAGE */
      579     5970
      580     5971    3   CURR = OFFSET;
      581     5972    3   CURR$ = PINCRW(TOPOQ$,SIZEW(KI$QHDR)+CURR);
      582     5973    3   VBASE(VECT) = CURR$;
      583     5974    4   CALL DAM$MAP(CURR$,CURR$,,,VECT) WHENALTRETURN DO;
      584     5975    4     ALTRETURN;
      585     5976    4   END;
      586     5977    3   RETURN;
      587     5978    3   END GETNXT;
      588     5979    2   END DOQ;
      589     5980    1   END DAD$ROUTE;
      590     5981        %EOD;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:22   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_TEXTC_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DAD$ROUTE.

   Procedure DAD$ROUTE requires 1268 words for executable code.
   Procedure DAD$ROUTE requires 92 words of local(AUTO) storage.

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:23   

 Object Unit name= DAD$ROUTE                                  File name= DAD$ROUTE.:E05TOU
 UTS= JUL 29 '97 12:44:35.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    126    176  DAD$ROUTE
    1   Data  even  none   338    522  DAD$ROUTE
    2   Proc  even  none  1268   2364  DAD$ROUTE
    3  RoData even  none    38     46  DAD$ROUTE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  DAD$ROUTE
     2    462                  yes      Std        1  DAD$FEI
     2   1101                  yes      Std        1  DAD$OCQ
     2   1111                  yes      Std        1  DAD$ICQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       2 DAS$SDMONPTR
 yes     yes           Std       5 DAM$MAP
 yes     yes           Std       3 DAA$VALUE
         yes           Std       2 DBM$PACK4
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:24   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DA_MONISDATA                          DAF$WRITE                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:25   


        1        1        /*M*   Display Route tables for ANLZ                                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*                                                                    */
        8        8        /*D* NAME: DAD$ROUTE
        9        9             CALL: CALL DAD$ROUTE(TOP);
       10       10             INPUT: TOP - Parser output block from DISPLAY ROUTE command.
       11       11             DISCRIPTION:  If TOP.NSUBLKS is 0 then the entire ROUTE table
       12       12                is displayed.  Otherwise, table entries for nodes specified in
       13       13                the DISPLAY command are displayed.
       14       14                                                                              */
       15       15        DAD$ROUTE: PROC(TOP);

     15  2 000000   000000 700200 xent  DAD$ROUTE    TSX0  ! X66_AUTO_1
         2 000001   000134 000001                    ZERO    92,1

       16       16
       17       17        %INCLUDE DA_FORMAT_C;
       18      259        %INCLUDE DA_ANLZ_R;
       19      272        %INCLUDE DA_MAP_R;
       20      302        %INCLUDE DA_TEXTC_C;
       21      333        %INCLUDE DA_MONSYM_C;
       22      384        %INCLUDE KI$QHDR;
       23      536        %INCLUDE KI$MHDR;
       24      677        %INCLUDE KJ_FCNS_C;
       25      704        %INCLUDE KI_MACROS_C;
       26     1312        %INCLUDE XU_MACRO_C;
       27     4418        /*                                                                    */
       28     4419    1   DCL B$IS$ PTR SYMREF;
       29     4420        /*                                                                    */
       30     4421    1   DCL DAM$MAP ENTRY(5) ALTRET;
       31     4422    1   DCL DAF$WRITE EPTR SYMREF;
       32     4423    1   DCL DAF$INIT ENTRY(1) ALTRET;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:26   
       33     4424    1   DCL DAF$NEWPAGE ENTRY;
       34     4425    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       35     4426    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
       36     4427    1   DCL DBM$PACK4 ENTRY(2);
       37     4428    1   DCL RTETTL CONSTANT CHAR(0) INIT('ROUTE TABLES');
       38     4429    1   DCL RLINE0 STATIC CHAR(0) INIT(
       39     4430    1   ' ---- -------- --- --- ---- ---- ----');
       40     4431    1   DCL 1 ROUTE,
       41     4432    1         2 NODE UBIN,
       42     4433    1         2 NAME CHAR(8),
       43     4434    1         2 FEI UBIN,
       44     4435    1         2 QOS UBIN,
       45     4436    1         2 AQOS UBIN,
       46     4437    1         2 HOST CHAR(4),
       47     4438    1         2 LINK CHAR(4);
       48     4439    1   DCL 1 ROUTELINK,
       49     4440    1         2 FEI UBIN,
       50     4441    1         2 NODE UBIN,
       51     4442    1         2 QOS UBIN,
       52     4443    1         2 MSGS_IN UBIN,
       53     4444    1         2 MSGS_OUT UBIN;
       54     4445    1   DCL 1 FEI,
       55     4446    1         2 FEI UBIN,
       56     4447    1         2 NODE UBIN,
       57     4448    1         2 STATE CHAR(4),
       58     4449    1         2 TCNT UBIN,
       59     4450    1         2 OCQ$ PTR,
       60     4451    1         2 OCQ REDEF OCQ$ UBIN,
       61     4452    1         2 FRZN CHAR(4),
       62     4453    1         2 NOTIME CHAR(4),
       63     4454    1         2 QOS UBIN,
       64     4455    1         2 PROB CHAR(4),
       65     4456    1         2 PSTATE CHAR(4),
       66     4457    1         2 QFLHD$ PTR,
       67     4458    1         2 BDU# UBIN,
       68     4459    1         2 IOM UBIN,
       69     4460    1         2 DEV UBIN;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:27   
       70     4461    1   DCL 1 QHDR,
       71     4462    1        2 FEI# UBIN,
       72     4463    1        2 HOST_NODE UBIN,
       73     4464    1        2 FEP_NODE  UBIN,
       74     4465    1        2 INTLOCK UBIN,
       75     4466    1        2 QSIZE UBIN(36),
       76     4467    1        2 GATE BIT(72),
       77     4468    1        2 GATE_R REDEF GATE,
       78     4469    1           3 L_GATE BIT(36),
       79     4470    1           3 U_GATE BIT(36),
       80     4471    1        2 RPTR UBIN(36),
       81     4472    1        2 IPTR UBIN(36),
       82     4473    1        2 QOS UBIN,
       83     4474    1        2 FLAG BIT(36),
       84     4475    1        2 TOTMES UBIN,
       85     4476    1        2 CCMD BIT(36),
       86     4477    1        2 LSTIPTR UBIN;
       87     4478    1   DCL 1 QMSG,
       88     4479    1        2 FREEFLAG UBIN,
       89     4480    1        2 CURR UBIN,
       90     4481    1        2 FEI# UBIN,
       91     4482    1        2 FUNCTION CHAR(8),
       92     4483    1        2 ACTSIZ UBIN,
       93     4484    1        2 OFFSET UBIN,
       94     4485    1        2 SIZE UBIN,
       95     4486    1        2 UID UBIN,
       96     4487    1        2 FPTSZ UBIN,
       97     4488    1        2 MSGSIZ UBIN;
       98     4489    1   DCL QMSGFMT CHAR(0) STATIC INIT(
       99     4490    1   ' %4O .%Z6O %4D %8A %7D %6D  %6D  .%Z6O %7D %7D');
      100     4491    1   DCL QHDRFMT STATIC CHAR(0) INIT('
      101     4492        %/Fei#:%3D
      102     4493        %/Host#:%3D %16-Fep#:%3D %37-Intlock:.%L12O
      103     4494        %/Qsize: %L7D %16-Lock: .%L12O %37-Unlock: .%L12O
      104     4495        %/Rptr: .%L12O %16-Iptr: .%L12O %37-Qos:%3D
      105     4496        %/Flags: .%L12O %16-Totmes: .%L12O %37-Ccmd: .%L12O
      106     4497    1   %/Last Iptr: .%L12O');
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:28   
      107     4498        %TEXTC(NAME=QHDRHDR,TEXT=
      108     4499        ' Free     Loc Fei# Function Actsize Offset    Size      Uid Fptsize Msgsize');
      109     4523        %TEXTC(NAME=QHDRHDR1,TEXT=
      110     4524        ' ----     --- ---- -------- ------- ------    ----      --- ------- -------');
      111     4548
      112     4549    1  DCL STATE(0:8) CHAR(4) CONSTANT INIT('Down','Init','Run','QFUL','DEBG','Dump','Boot'
              4549            ,'Mask','Stpg');
      113     4550    1  DCL FUNCTION(0:%KJ_MAXOFUNCTIONS) CHAR(8) CONSTANT INIT('Nopi','Timer','Imok','Sdbg'
              4550            ,
      114     4551    1                                           'Rdbg','Idata','Unknown'*26,'Nop',
      115     4552    1                                           'Time','Ruok','Odata');
      116     4553    1   DCL CURR UBIN;
      117     4554    1   DCL CURR$ PTR;
      118     4555    1   DCL PROBLEM (0:20) CHAR(4) CONSTANT INIT(
      119     4556    1   'Up','Tout','QFL','Nobt','Scrh','Cplr','Bint','Bdln','Mfmt','Bfcn',
      120     4557    1   'Dcft','Boot','6alz','Stop','Part','Uprt','Freq','Lnku','Lnkd','Qos','???');
      121     4558    1   DCL FMTBUF CHAR(180) STATIC;
      122     4559    1   DCL 1 FMTVEC STATIC,
      123     4560    1         2 CT UBIN(20) UNAL,
      124     4561    1         2 * UBIN(16) UNAL INIT(0),
      125     4562    1         2 P$ PTR;
      126     4563    1   DCL RFMT0 STATIC CHAR(0) INIT(
      127     4564    1   ' %/Node:%3D Name: %8A Fei:%3D Qos:%3D Aqos:%3D Host: %4A Link: %4A');
      128     4565    1   DCL RFMT1 STATIC CHAR(0) INIT(
      129     4566    1   '         Fei:%3D Node:%3D Qos:%3D In:%8D Out:%8D');
      130     4567        %TEXTC (NAME=FEIHDR0,TEXT=
      131     4568        ' FEI Node State Tcnt Cqls  Frzn Notime Qos Prob State    Qfldhd    BDU# Chan');
      132     4592        %TEXTC (NAME=FEIHDR1,TEXT=
      133     4593        ' --- ---- ----- ---- ----- ---- ------ --- ---- ----- ------------ ---- -----');
      134     4617    1   DCL FEIFMT CHAR(0) CONSTANT INIT(
      135     4618    1   ' %3D %4D  %4A %4D $LS%2D  %4A  %4A %3D %4A  %4A %Z12O %3D  %1D-%3D');
      136     4619    1   DCL NODES UBIN;
      137     4620    1   DCL MXFE UBIN;
      138     4621    1   DCL ROUTE$$ PTR;
      139     4622    1   DCL ROUTE$ PTR;
      140     4623    1   DCL FEI$ PTR;
      141     4624    1   DCL FEI$$ PTR;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:29   
      142     4625    1   DCL A UBIN BASED;
      143     4626    1   DCL SBINWORD SBIN BASED;
      144     4627    1   DCL UBINWORD UBIN BASED;
      145     4628    1   DCL PTR$ PTR BASED;
      146     4629    1   DCL P$ PTR;
      147     4630    1   DCL Q$ PTR;
      148     4631    1   DCL TOPOQ$ PTR;
      149     4632    1   DCL TEMP$ PTR;
      150     4633    1   DCL TEMP REDEF TEMP$ UBIN;
      151     4634    1   DCL VECT VECTOR STATIC INIT(VECTOR(NIL));
      152     4635    1   DCL FEI## UBIN;
      153     4636    1   DCL LFEI# UBIN;
      154     4637    1   DCL HFEI# UBIN;
      155     4638    1   DCL IPTR UBIN;
      156     4639    1   DCL RPTR UBIN;
      157     4640    1   DCL LAST_PTR UBIN;
      158     4641    1   DCL TUID UBIN;
      159     4642    1   DCL QSIZE UBIN;
      160     4643    1   DCL 1 TUID_B BASED ALIGNED,
      161     4644    1        2 * BIT(4) UNAL,
      162     4645    1        2 D UBIN(32) UNAL;
      163     4646    1   DCL ICQ BIT(1);
      164     4647    1   DCL UID UBIN WORD;
      165     4648    1   DCL I UBIN;
      166     4649    1   DCL J UBIN;
      167     4650
      168     4651        %KI$ROUTE;
      169     4705    1   DCL KI$ROUTE$(0:0) PTR BASED;
      170     4706        %KI$FEI;
      171     4790    1   DCL KI$FEI$(0:0) PTR BASED;
      172     4791        %KI$QMHDR(STCLASS="BASED(Q$)");
      173     4840        %REPORT (NAME=RRPRT,TITLE='ROUTE TABLES',HEADER=NO);
      174     4906        %REPORT (NAME=FEIRPRT,TITLE='FEI TABLES',HEADER=YES);
      175     4972        %HEADER (TEXTADR=FEIHDR0,LAST=NO);
      176     5014        %HEADER (TEXTADR=FEIHDR1);
      177     5056        %REPORT (NAME=ICQRPRT,TITLE='INPUT CIRCULAR QUEUE',HEADER=YES);
      178     5122        %HEADER (TEXTADR=QHDRHDR,LAST=NO);
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:30   
      179     5164        %HEADER (TEXTADR=QHDRHDR1);
      180     5206        %REPORT (NAME=OCQRPRT,TITLE='OUTPUT CIRCULAR QUEUE',HEADER=YES);
      181     5272        %HEADER (TEXTADR=QHDRHDR,LAST=NO);
      182     5314        %HEADER (TEXTADR=QHDRHDR1);
      183     5356        %REPORT (NAME=OCQHDRRPT,TITLE='OUTPUT CIRCULAR QUEUE HEADER',HEADER=NO);
      184     5422        %REPORT (NAME=ICQHDRRPT,TITLE='INPUT CIRCULAR QUEUE HEADER',HEADER=NO);
      185     5488        %PARSE$OUT (NAME=TOP,STCLASS=" ");
      186     5533        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      187     5578        %SUB NEVER="WHILE('0'B)";
      188     5579        %SUB FOREVER="WHILE('1'B)";
      189     5580        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:31   
      190     5581    1           CALL DAF$INIT(RRPRT);

   5581  2 000002   000000 630400 3                  EPPR0   0
         2 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000004   000000 701000 xent               TSX1    DAF$INIT
         2 000005   000000 011000                    NOP     0

      191     5582
      192     5583    1           CALL DAS$SDMONPTR(%M#KI_NODES,P$) ALTRET(ALT);

   5583  2 000006   200100 630500                    EPPR0   P$,,AUTO
         2 000007   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000010   000001 236000 3                  LDQ     1
         2 000011   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000012   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000013   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000014   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000015   000241 702000 2                  TSX2    ALT

      193     5584    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

   5584  2 000016   000002 236000 3                  LDQ     2
         2 000017   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000020   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000021   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000022   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000023   200100 630500                    EPPR0   P$,,AUTO
         2 000024   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000025   200100 631500                    EPPR1   P$,,AUTO
         2 000026   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000027   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000030   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000031   000000 701000 xent               TSX1    DAM$MAP
         2 000032   000241 702000 2                  TSX2    ALT

      194     5585    1           NODES = P$->SBINWORD;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:32   
   5585  2 000033   200100 470500                    LDP0    P$,,AUTO
         2 000034   000000 235100                    LDA     0,,PR0
         2 000035   200072 755100                    STA     NODES,,AUTO

      195     5586    1           CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);

   5586  2 000036   200100 631500                    EPPR1   P$,,AUTO
         2 000037   200127 451500                    STP1    @TEXT+3,,AUTO
         2 000040   000004 236000 3                  LDQ     4
         2 000041   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000042   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000044   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000045   000241 702000 2                  TSX2    ALT

      196     5587    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

   5587  2 000046   000002 236000 3                  LDQ     2
         2 000047   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000050   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000051   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000052   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000053   200100 630500                    EPPR0   P$,,AUTO
         2 000054   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000055   200100 631500                    EPPR1   P$,,AUTO
         2 000056   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000057   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000060   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000061   000000 701000 xent               TSX1    DAM$MAP
         2 000062   000241 702000 2                  TSX2    ALT

      197     5588    1           MXFE = P$->SBINWORD;

   5588  2 000063   200100 470500                    LDP0    P$,,AUTO
         2 000064   000000 235100                    LDA     0,,PR0
         2 000065   200073 755100                    STA     MXFE,,AUTO

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:33   
      198     5589    1           CALL DAS$SDMONPTR(%M#KI_ROUTE$$,ROUTE$$) ALTRET(ALT);

   5589  2 000066   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000067   200127 451500                    STP1    @TEXT+3,,AUTO
         2 000070   000006 236000 3                  LDQ     6
         2 000071   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000072   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000074   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000075   000241 702000 2                  TSX2    ALT

      199     5590    1           CALL DAM$MAP(ROUTE$$,ROUTE$$,,,DA_MONISDATA) ALTRET(ALT);

   5590  2 000076   000002 236000 3                  LDQ     2
         2 000077   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000100   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000101   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000102   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000103   200074 630500                    EPPR0   ROUTE$$,,AUTO
         2 000104   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000105   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000106   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000107   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000110   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000111   000000 701000 xent               TSX1    DAM$MAP
         2 000112   000241 702000 2                  TSX2    ALT

      200     5591    1           ROUTE$$ = ROUTE$$->PTR$;

   5591  2 000113   200074 470500                    LDP0    ROUTE$$,,AUTO
         2 000114   000000 236100                    LDQ     0,,PR0
         2 000115   200074 756100                    STQ     ROUTE$$,,AUTO

      201     5592    1           CALL DAM$MAP(ROUTE$$,ROUTE$$);

   5592  2 000116   200074 630500                    EPPR0   ROUTE$$,,AUTO
         2 000117   200127 450500                    STP0    @TEXT+3,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:34   
         2 000120   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000121   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000122   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000123   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000124   000000 701000 xent               TSX1    DAM$MAP
         2 000125   000000 011000                    NOP     0

      202     5593    1           CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);

   5593  2 000126   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000127   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000130   000010 236000 3                  LDQ     8
         2 000131   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000132   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000133   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000134   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000135   000241 702000 2                  TSX2    ALT

      203     5594    1           CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);

   5594  2 000136   000002 236000 3                  LDQ     2
         2 000137   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000140   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000141   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000142   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000143   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000144   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000145   200077 631500                    EPPR1   FEI$$,,AUTO
         2 000146   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000147   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000150   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000151   000000 701000 xent               TSX1    DAM$MAP
         2 000152   000241 702000 2                  TSX2    ALT

      204     5595    1           FEI$$ = FEI$$->PTR$;

   5595  2 000153   200077 470500                    LDP0    FEI$$,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:35   
         2 000154   000000 236100                    LDQ     0,,PR0
         2 000155   200077 756100                    STQ     FEI$$,,AUTO

      205     5596    1           CALL DAM$MAP(FEI$$,FEI$$);

   5596  2 000156   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000157   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000160   200077 631500                    EPPR1   FEI$$,,AUTO
         2 000161   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000162   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000163   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000164   000000 701000 xent               TSX1    DAM$MAP
         2 000165   000000 011000                    NOP     0

      206     5597    1           IF TOP.NSUBLKS = 0

   5597  2 000166   200003 470500                    LDP0    @TOP,,AUTO
         2 000167   000001 220100                    LDX0    1,,PR0
         2 000170   000206 601000 2                  TNZ     s:5603

      207     5598    1           THEN
      208     5599    2           DO I = 0 TO NODES;

   5599  2 000171   200116 450100                    STZ     I,,AUTO
         2 000172   000202 710000 2                  TRA     s:5601+3

      209     5600    2              CALL DROUTE(I);

   5600  2 000173   200116 630500                    EPPR0   I,,AUTO
         2 000174   200121 450500                    STP0    J+2,,AUTO
         2 000175   000242 701000 2                  TSX1    DROUTE
         2 000176   000000 011000                    NOP     0

      210     5601    2              END;

   5601  2 000177   200116 235100                    LDA     I,,AUTO
         2 000200   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:36   
         2 000201   200116 755100                    STA     I,,AUTO
         2 000202   200072 236100                    LDQ     NODES,,AUTO
         2 000203   200116 116100                    CMPQ    I,,AUTO
         2 000204   000173 603000 2                  TRC     s:5600
         2 000205   000240 710000 2                  TRA     s:5608

      211     5602    1           ELSE
      212     5603    2           DO I = 0 TO TOP.NSUBLKS-1;

   5603  2 000206   200116 450100                    STZ     I,,AUTO
         2 000207   000232 710000 2                  TRA     s:5606+3

      213     5604    2              CALL DAA$VALUE(TOP.SUBLK$(I)->OUT.SUBLK$(0)->OUT,J);

   5604  2 000210   200003 470500                    LDP0    @TOP,,AUTO
         2 000211   200116 720100                    LXL0    I,,AUTO
         2 000212   000003 471510                    LDP1    3,X0,PR0
         2 000213   100003 473500                    LDP3    3,,PR1
         2 000214   200117 634500                    EPPR4   J,,AUTO
         2 000215   200127 454500                    STP4    @TEXT+3,,AUTO
         2 000216   200126 453500                    STP3    @TEXT+2,,AUTO
         2 000217   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000220   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000221   000000 701000 xent               TSX1    DAA$VALUE
         2 000222   000000 011000                    NOP     0

      214     5605    2              CALL DROUTE(J);

   5605  2 000223   200117 630500                    EPPR0   J,,AUTO
         2 000224   200121 450500                    STP0    J+2,,AUTO
         2 000225   000242 701000 2                  TSX1    DROUTE
         2 000226   000000 011000                    NOP     0

      215     5606    2              END;

   5606  2 000227   200116 235100                    LDA     I,,AUTO
         2 000230   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:37   
         2 000231   200116 755100                    STA     I,,AUTO
         2 000232   200003 470500                    LDP0    @TOP,,AUTO
         2 000233   000001 236100                    LDQ     1,,PR0
         2 000234   000022 772000                    QRL     18
         2 000235   200116 116100                    CMPQ    I,,AUTO
         2 000236   000240 600000 2                  TZE     s:5608
         2 000237   000210 603000 2                  TRC     s:5604

      216     5607
      217     5608    1           RETURN;

   5608  2 000240   000000 702200 xent               TSX2  ! X66_ARET

      218     5609    1   ALT:    RETURN;

   5609  2 000241   000000 702200 xent  ALT          TSX2  ! X66_ARET

      219     5610        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:38   
      220     5611    1   DROUTE: PROC (NODE);

   5611  2 000242   200120 741300       DROUTE       STX1  ! J+1,,AUTO

      221     5612    2   DCL NODE UBIN;
      222     5613
      223     5614    2           ROUTE$ = ROUTE$$->KI$ROUTE$(NODE);

   5614  2 000243   200121 470500                    LDP0    @NODE,,AUTO
         2 000244   000000 720100                    LXL0    0,,PR0
         2 000245   200074 471500                    LDP1    ROUTE$$,,AUTO
         2 000246   100000 236110                    LDQ     0,X0,PR1
         2 000247   200075 756100                    STQ     ROUTE$,,AUTO

      224     5615    2           CALL DAM$MAP(ROUTE$,ROUTE$);

   5615  2 000250   200075 633500                    EPPR3   ROUTE$,,AUTO
         2 000251   200127 453500                    STP3    @TEXT+3,,AUTO
         2 000252   200075 634500                    EPPR4   ROUTE$,,AUTO
         2 000253   200126 454500                    STP4    @TEXT+2,,AUTO
         2 000254   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000255   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000256   000000 701000 xent               TSX1    DAM$MAP
         2 000257   000000 011000                    NOP     0

      225     5616    2           IF ROUTE$->KI$ROUTE.CURRENT_QOS ~= 255 OR TOP.NSUBLKS ~= 0

   5616  2 000260   200075 470500                    LDP0    ROUTE$,,AUTO
         2 000261   000002 236100                    LDQ     2,,PR0
         2 000262   000777 376003                    ANQ     511,DU
         2 000263   000377 116003                    CMPQ    255,DU
         2 000264   000270 601000 2                  TNZ     s:5618
         2 000265   200003 471500                    LDP1    @TOP,,AUTO
         2 000266   100001 220100                    LDX0    1,,PR1
         2 000267   000460 600000 2                  TZE     s:5653

      226     5617    3           THEN DO;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:39   

      227     5618    3              ROUTE.NODE = NODE;

   5618  2 000270   200121 471500                    LDP1    @NODE,,AUTO
         2 000271   100000 235100                    LDA     0,,PR1
         2 000272   200004 755100                    STA     ROUTE,,AUTO

      228     5619    3              ROUTE.NAME = ROUTE$->KI$ROUTE.NODE_NAME;

   5619  2 000273   040100 100500                    MLR     fill='040'O
         2 000274   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 000275   200005 000010                    ADSC9   ROUTE+1,,AUTO            cn=0,n=8

      229     5620    3              ROUTE.FEI = ROUTE$->KI$ROUTE.FEI#;

   5620  2 000276   000002 236100                    LDQ     2,,PR0
         2 000277   000033 772000                    QRL     27
         2 000300   200007 756100                    STQ     ROUTE+3,,AUTO

      230     5621    3              ROUTE.QOS = ROUTE$->KI$ROUTE.CURRENT_QOS;

   5621  2 000301   000002 236100                    LDQ     2,,PR0
         2 000302   000022 772000                    QRL     18
         2 000303   000777 376007                    ANQ     511,DL
         2 000304   200010 756100                    STQ     ROUTE+4,,AUTO

      231     5622    3              ROUTE.AQOS = ROUTE$->KI$ROUTE.ALT_QOS;

   5622  2 000305   000002 236100                    LDQ     2,,PR0
         2 000306   000011 772000                    QRL     9
         2 000307   000777 376007                    ANQ     511,DL
         2 000310   200011 756100                    STQ     ROUTE+5,,AUTO

      232     5623    3              IF ROUTE$->KI$ROUTE.HOST

   5623  2 000311   000002 236100                    LDQ     2,,PR0
         2 000312   000400 316007                    CANQ    256,DL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:40   
         2 000313   000321 600000 2                  TZE     s:5627

      233     5624    3              THEN
      234     5625    3                 ROUTE.HOST = 'Yes';

   5625  2 000314   000172 236000 0                  LDQ     FEIFMT+17
         2 000315   000011 376000 3                  ANQ     9
         2 000316   000040 276007                    ORQ     32,DL
         2 000317   200012 756100                    STQ     ROUTE+6,,AUTO
         2 000320   000325 710000 2                  TRA     s:5628

      235     5626    3              ELSE
      236     5627    3                 ROUTE.HOST = 'No';

   5627  2 000321   000173 236000 0                  LDQ     FEIFMT+18
         2 000322   777777 376003                    ANQ     -1,DU
         2 000323   040040 276007                    ORQ     16416,DL
         2 000324   200012 756100                    STQ     ROUTE+6,,AUTO

      237     5628    3              IF ROUTE$->KI$ROUTE.LINK_CONNECTED

   5628  2 000325   000002 236100                    LDQ     2,,PR0
         2 000326   000200 316007                    CANQ    128,DL
         2 000327   000335 600000 2                  TZE     s:5632

      238     5629    3              THEN
      239     5630    3                 ROUTE.LINK = 'Yes';

   5630  2 000330   000172 236000 0                  LDQ     FEIFMT+17
         2 000331   000011 376000 3                  ANQ     9
         2 000332   000040 276007                    ORQ     32,DL
         2 000333   200013 756100                    STQ     ROUTE+7,,AUTO
         2 000334   000341 710000 2                  TRA     s:5633

      240     5631    3              ELSE
      241     5632    3                 ROUTE.LINK = 'No';

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:41   
   5632  2 000335   000173 236000 0                  LDQ     FEIFMT+18
         2 000336   777777 376003                    ANQ     -1,DU
         2 000337   040040 276007                    ORQ     16416,DL
         2 000340   200013 756100                    STQ     ROUTE+7,,AUTO

      242     5633    3              CALL DAF$WRITE(VECTOR(RFMT0),VECTOR(ROUTE));

   5633  2 000341   000014 235000 3                  LDA     12
         2 000342   200126 452500                    STP2    @TEXT+2,,AUTO
         2 000343   200126 236100                    LDQ     @TEXT+2,,AUTO
         2 000344   000004 036003                    ADLQ    4,DU
         2 000345   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000346   200130 633500                    EPPR3   @TEXT+4,,AUTO
         2 000347   200133 453500                    STP3    @TEXT+7,,AUTO
         2 000350   000015 236000 3                  LDQ     13
         2 000351   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000352   200132 630500                    EPPR0   @TEXT+6,,AUTO
         2 000353   000000 220000 xsym               LDX0    DAF$WRITE
         2 000354   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000355   000000 701010                    TSX1    0,X0
         2 000356   000000 011000                    NOP     0

      243     5634    4              DO J = 1 TO MXFE;

   5634  2 000357   000001 235007                    LDA     1,DL
         2 000360   200117 755100                    STA     J,,AUTO
         2 000361   000455 710000 2                  TRA     s:5651+3

      244     5635    4                 ROUTELINK.FEI = J;

   5635  2 000362   200117 235100                    LDA     J,,AUTO
         2 000363   200014 755100                    STA     ROUTELINK,,AUTO

      245     5636    4                 IF ROUTE$->KI$ROUTE.FEI# = 0

   5636  2 000364   200075 470500                    LDP0    ROUTE$,,AUTO
         2 000365   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:42   
         2 000366   777000 316003                    CANQ    -512,DU
         2 000367   000372 601000 2                  TNZ     s:5640

      246     5637    4                 THEN
      247     5638    4                    ROUTELINK.NODE = 0;

   5638  2 000370   200015 450100                    STZ     ROUTELINK+1,,AUTO
         2 000371   000412 710000 2                  TRA     s:5644

      248     5639    5                 ELSE DO;

      249     5640    5                    FEI$ = FEI$$->KI$FEI$(J);

   5640  2 000372   200077 471500                    LDP1    FEI$$,,AUTO
         2 000373   100000 236105                    LDQ     0,AL,PR1
         2 000374   200076 756100                    STQ     FEI$,,AUTO

      250     5641    5                    CALL DAM$MAP(FEI$,FEI$);

   5641  2 000375   200076 633500                    EPPR3   FEI$,,AUTO
         2 000376   200127 453500                    STP3    @TEXT+3,,AUTO
         2 000377   200076 634500                    EPPR4   FEI$,,AUTO
         2 000400   200126 454500                    STP4    @TEXT+2,,AUTO
         2 000401   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000403   000000 701000 xent               TSX1    DAM$MAP
         2 000404   000000 011000                    NOP     0

      251     5642    5                    ROUTELINK.NODE = FEI$->KI$FEI.FEP#;

   5642  2 000405   200076 470500                    LDP0    FEI$,,AUTO
         2 000406   000012 236100                    LDQ     10,,PR0
         2 000407   000011 772000                    QRL     9
         2 000410   000777 376007                    ANQ     511,DL
         2 000411   200015 756100                    STQ     ROUTELINK+1,,AUTO

      252     5643    5                    END;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:43   

      253     5644    4                 ROUTELINK.QOS = ROUTE$->KI$ROUTE.LINK.QOS(J);

   5644  2 000412   200117 236100                    LDQ     J,,AUTO
         2 000413   000003 402007                    MPY     3,DL
         2 000414   200075 470500                    LDP0    ROUTE$,,AUTO
         2 000415   000003 236106                    LDQ     3,QL,PR0
         2 000416   000033 772000                    QRL     27
         2 000417   200016 756100                    STQ     ROUTELINK+2,,AUTO

      254     5645    4                 ROUTELINK.MSGS_IN = ROUTE$->KI$ROUTE.LINK.MSGS_IN(J);

   5645  2 000420   200117 236100                    LDQ     J,,AUTO
         2 000421   000003 402007                    MPY     3,DL
         2 000422   000004 235106                    LDA     4,QL,PR0
         2 000423   200017 755100                    STA     ROUTELINK+3,,AUTO

      255     5646    4                 ROUTELINK.MSGS_OUT = ROUTE$->KI$ROUTE.LINK.MSGS_OUT(J);

   5646  2 000424   000005 235106                    LDA     5,QL,PR0
         2 000425   200020 755100                    STA     ROUTELINK+4,,AUTO

      256     5647    4                 IF ROUTELINK.QOS ~= 255

   5647  2 000426   200016 235100                    LDA     ROUTELINK+2,,AUTO
         2 000427   000377 115007                    CMPA    255,DL
         2 000430   000434 601000 2                  TNZ     s:5650
         2 000431   200017 236100                    LDQ     ROUTELINK+3,,AUTO
         2 000432   200020 036100                    ADLQ    ROUTELINK+4,,AUTO
         2 000433   000452 600000 2                  TZE     s:5651

      257     5648    4                OR (ROUTELINK.MSGS_IN+ROUTELINK.MSGS_OUT)~=0
      258     5649    4                 THEN
      259     5650    4                    CALL DAF$WRITE(VECTOR(RFMT1),VECTOR(ROUTELINK));

   5650  2 000434   000020 235000 3                  LDA     16
         2 000435   200126 452500                    STP2    @TEXT+2,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:44   
         2 000436   200126 236100                    LDQ     @TEXT+2,,AUTO
         2 000437   000014 036003                    ADLQ    12,DU
         2 000440   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000441   200130 631500                    EPPR1   @TEXT+4,,AUTO
         2 000442   200133 451500                    STP1    @TEXT+7,,AUTO
         2 000443   000021 236000 3                  LDQ     17
         2 000444   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000445   200132 630500                    EPPR0   @TEXT+6,,AUTO
         2 000446   000000 220000 xsym               LDX0    DAF$WRITE
         2 000447   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000450   000000 701010                    TSX1    0,X0
         2 000451   000000 011000                    NOP     0

      260     5651    4                 END;

   5651  2 000452   200117 235100                    LDA     J,,AUTO
         2 000453   000001 035007                    ADLA    1,DL
         2 000454   200117 755100                    STA     J,,AUTO
         2 000455   200073 236100                    LDQ     MXFE,,AUTO
         2 000456   200117 116100                    CMPQ    J,,AUTO
         2 000457   000362 603000 2                  TRC     s:5635

      261     5652    3              END;

      262     5653    2           RETURN;

   5653  2 000460   200120 221300                    LDX1  ! J+1,,AUTO
         2 000461   000001 702211                    TSX2  ! 1,X1

      263     5654
      264     5655    2   END DROUTE;
      265     5656
      266     5657        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:45   
      267     5658    1   DAD$FEI: ENTRY(TOP);

   5658  2 000462   000000 700200 xent  DAD$FEI      TSX0  ! X66_AUTO_1
         2 000463   000134 000001                    ZERO    92,1

      268     5659    1           CALL DAF$INIT(FEIRPRT);

   5659  2 000464   000022 630400 3                  EPPR0   18
         2 000465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000466   000000 701000 xent               TSX1    DAF$INIT
         2 000467   000000 011000                    NOP     0

      269     5660
      270     5661    1           CALL DAS$SDMONPTR(%M#KI_NODES,P$) ALTRET(ALT);

   5661  2 000470   200100 630500                    EPPR0   P$,,AUTO
         2 000471   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000472   000001 236000 3                  LDQ     1
         2 000473   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000474   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000475   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000476   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000477   000241 702000 2                  TSX2    ALT

      271     5662    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

   5662  2 000500   000002 236000 3                  LDQ     2
         2 000501   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000502   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000503   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000504   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000505   200100 630500                    EPPR0   P$,,AUTO
         2 000506   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000507   200100 631500                    EPPR1   P$,,AUTO
         2 000510   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000511   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000512   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:46   
         2 000513   000000 701000 xent               TSX1    DAM$MAP
         2 000514   000241 702000 2                  TSX2    ALT

      272     5663    1           NODES = P$->SBINWORD;

   5663  2 000515   200100 470500                    LDP0    P$,,AUTO
         2 000516   000000 235100                    LDA     0,,PR0
         2 000517   200072 755100                    STA     NODES,,AUTO

      273     5664    1           CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);

   5664  2 000520   200100 631500                    EPPR1   P$,,AUTO
         2 000521   200127 451500                    STP1    @TEXT+3,,AUTO
         2 000522   000004 236000 3                  LDQ     4
         2 000523   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000524   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000525   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000526   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000527   000241 702000 2                  TSX2    ALT

      274     5665    1           CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

   5665  2 000530   000002 236000 3                  LDQ     2
         2 000531   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000532   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000533   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000534   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000535   200100 630500                    EPPR0   P$,,AUTO
         2 000536   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000537   200100 631500                    EPPR1   P$,,AUTO
         2 000540   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000541   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000542   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000543   000000 701000 xent               TSX1    DAM$MAP
         2 000544   000241 702000 2                  TSX2    ALT

      275     5666    1           MXFE = P$->SBINWORD;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:47   

   5666  2 000545   200100 470500                    LDP0    P$,,AUTO
         2 000546   000000 235100                    LDA     0,,PR0
         2 000547   200073 755100                    STA     MXFE,,AUTO

      276     5667    1           CALL DAS$SDMONPTR(%M#KI_ROUTE$$,ROUTE$$) ALTRET(ALT);

   5667  2 000550   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000551   200127 451500                    STP1    @TEXT+3,,AUTO
         2 000552   000006 236000 3                  LDQ     6
         2 000553   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000554   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000555   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000556   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000557   000241 702000 2                  TSX2    ALT

      277     5668    1           CALL DAM$MAP(ROUTE$$,ROUTE$$,,,DA_MONISDATA) ALTRET(ALT);

   5668  2 000560   000002 236000 3                  LDQ     2
         2 000561   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000562   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000563   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000564   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000565   200074 630500                    EPPR0   ROUTE$$,,AUTO
         2 000566   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000567   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000570   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000571   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000572   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000573   000000 701000 xent               TSX1    DAM$MAP
         2 000574   000241 702000 2                  TSX2    ALT

      278     5669    1           ROUTE$$ = ROUTE$$->PTR$;

   5669  2 000575   200074 470500                    LDP0    ROUTE$$,,AUTO
         2 000576   000000 236100                    LDQ     0,,PR0
         2 000577   200074 756100                    STQ     ROUTE$$,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:48   

      279     5670    1           CALL DAM$MAP(ROUTE$$,ROUTE$$);

   5670  2 000600   200074 630500                    EPPR0   ROUTE$$,,AUTO
         2 000601   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000602   200074 631500                    EPPR1   ROUTE$$,,AUTO
         2 000603   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000604   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000605   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000606   000000 701000 xent               TSX1    DAM$MAP
         2 000607   000000 011000                    NOP     0

      280     5671    1           CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);

   5671  2 000610   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000611   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000612   000010 236000 3                  LDQ     8
         2 000613   200126 756100                    STQ     @TEXT+2,,AUTO
         2 000614   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000615   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000616   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000617   000241 702000 2                  TSX2    ALT

      281     5672    1           CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);

   5672  2 000620   000002 236000 3                  LDQ     2
         2 000621   200132 756100                    STQ     @TEXT+6,,AUTO
         2 000622   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000623   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000624   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 000625   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000626   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000627   200077 631500                    EPPR1   FEI$$,,AUTO
         2 000630   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000631   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000632   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000633   000000 701000 xent               TSX1    DAM$MAP
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:49   
         2 000634   000241 702000 2                  TSX2    ALT

      282     5673    1           FEI$$ = FEI$$->PTR$;

   5673  2 000635   200077 470500                    LDP0    FEI$$,,AUTO
         2 000636   000000 236100                    LDQ     0,,PR0
         2 000637   200077 756100                    STQ     FEI$$,,AUTO

      283     5674    1           CALL DAM$MAP(FEI$$,FEI$$);

   5674  2 000640   200077 630500                    EPPR0   FEI$$,,AUTO
         2 000641   200127 450500                    STP0    @TEXT+3,,AUTO
         2 000642   200077 631500                    EPPR1   FEI$$,,AUTO
         2 000643   200126 451500                    STP1    @TEXT+2,,AUTO
         2 000644   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000645   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000646   000000 701000 xent               TSX1    DAM$MAP
         2 000647   000000 011000                    NOP     0

      284     5675    1           IF TOP.NSUBLKS = 0

   5675  2 000650   200003 470500                    LDP0    @TOP,,AUTO
         2 000651   000001 220100                    LDX0    1,,PR0
         2 000652   000671 601000 2                  TNZ     s:5681

      285     5676    1           THEN
      286     5677    2           DO I = 1 TO MXFE;

   5677  2 000653   000001 235007                    LDA     1,DL
         2 000654   200116 755100                    STA     I,,AUTO
         2 000655   000665 710000 2                  TRA     s:5679+3

      287     5678    2              CALL DFEI(I);

   5678  2 000656   200116 630500                    EPPR0   I,,AUTO
         2 000657   200121 450500                    STP0    J+2,,AUTO
         2 000660   000724 701000 2                  TSX1    DFEI
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:50   
         2 000661   000000 011000                    NOP     0

      288     5679    2              END;

   5679  2 000662   200116 235100                    LDA     I,,AUTO
         2 000663   000001 035007                    ADLA    1,DL
         2 000664   200116 755100                    STA     I,,AUTO
         2 000665   200073 236100                    LDQ     MXFE,,AUTO
         2 000666   200116 116100                    CMPQ    I,,AUTO
         2 000667   000656 603000 2                  TRC     s:5678
         2 000670   000723 710000 2                  TRA     s:5686

      289     5680    1           ELSE
      290     5681    2           DO I = 0 TO TOP.NSUBLKS-1;

   5681  2 000671   200116 450100                    STZ     I,,AUTO
         2 000672   000715 710000 2                  TRA     s:5684+3

      291     5682    2              CALL DAA$VALUE(TOP.SUBLK$(I)->OUT.SUBLK$(0)->OUT,J);

   5682  2 000673   200003 470500                    LDP0    @TOP,,AUTO
         2 000674   200116 720100                    LXL0    I,,AUTO
         2 000675   000003 471510                    LDP1    3,X0,PR0
         2 000676   100003 473500                    LDP3    3,,PR1
         2 000677   200117 634500                    EPPR4   J,,AUTO
         2 000700   200127 454500                    STP4    @TEXT+3,,AUTO
         2 000701   200126 453500                    STP3    @TEXT+2,,AUTO
         2 000702   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000703   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000704   000000 701000 xent               TSX1    DAA$VALUE
         2 000705   000000 011000                    NOP     0

      292     5683    2              CALL DFEI(J);

   5683  2 000706   200117 630500                    EPPR0   J,,AUTO
         2 000707   200121 450500                    STP0    J+2,,AUTO
         2 000710   000724 701000 2                  TSX1    DFEI
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:51   
         2 000711   000000 011000                    NOP     0

      293     5684    2              END;

   5684  2 000712   200116 235100                    LDA     I,,AUTO
         2 000713   000001 035007                    ADLA    1,DL
         2 000714   200116 755100                    STA     I,,AUTO
         2 000715   200003 470500                    LDP0    @TOP,,AUTO
         2 000716   000001 236100                    LDQ     1,,PR0
         2 000717   000022 772000                    QRL     18
         2 000720   200116 116100                    CMPQ    I,,AUTO
         2 000721   000723 600000 2                  TZE     s:5686
         2 000722   000673 603000 2                  TRC     s:5682

      294     5685
      295     5686    1           RETURN;

   5686  2 000723   000000 702200 xent               TSX2  ! X66_ARET

      296     5687        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:52   
      297     5688    1   DFEI:   PROC (FEI#);

   5688  2 000724   200120 741300       DFEI         STX1  ! J+1,,AUTO

      298     5689
      299     5690    2   DCL FEI# UBIN;
      300     5691
      301     5692    2           IF FEI# = 0 OR FEI# > MXFE

   5692  2 000725   200121 470500                    LDP0    @FEI#,,AUTO
         2 000726   000000 235100                    LDA     0,,PR0
         2 000727   000733 600000 2                  TZE     s:5694
         2 000730   200073 236100                    LDQ     MXFE,,AUTO
         2 000731   000000 116100                    CMPQ    0,,PR0
         2 000732   000734 603000 2                  TRC     s:5695

      302     5693    2           THEN
      303     5694    2              RETURN;

   5694  2 000733   000001 702211                    TSX2  ! 1,X1

      304     5695    2           FEI.FEI = FEI#;

   5695  2 000734   200021 755100                    STA     FEI,,AUTO

      305     5696    2           FEI$ = FEI$$->KI$FEI$(FEI#);

   5696  2 000735   000000 720100                    LXL0    0,,PR0
         2 000736   200077 471500                    LDP1    FEI$$,,AUTO
         2 000737   100000 236110                    LDQ     0,X0,PR1
         2 000740   200076 756100                    STQ     FEI$,,AUTO

      306     5697    2           CALL DAM$MAP (FEI$,FEI$);

   5697  2 000741   200076 633500                    EPPR3   FEI$,,AUTO
         2 000742   200127 453500                    STP3    @TEXT+3,,AUTO
         2 000743   200076 634500                    EPPR4   FEI$,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:53   
         2 000744   200126 454500                    STP4    @TEXT+2,,AUTO
         2 000745   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 000746   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000747   000000 701000 xent               TSX1    DAM$MAP
         2 000750   000000 011000                    NOP     0

      307     5698    2           FEI.NODE = FEI$->KI$FEI.FEP#;

   5698  2 000751   200076 470500                    LDP0    FEI$,,AUTO
         2 000752   000012 236100                    LDQ     10,,PR0
         2 000753   000011 772000                    QRL     9
         2 000754   000777 376007                    ANQ     511,DL
         2 000755   200022 756100                    STQ     FEI+1,,AUTO

      308     5699    2           FEI.STATE = STATE(FEI$->KI$FEI.FEST);

   5699  2 000756   000002 220100                    LDX0    2,,PR0
         2 000757   000777 360003                    ANX0    511,DU
         2 000760   000003 236010 0                  LDQ     STATE,X0
         2 000761   200023 756100                    STQ     FEI+2,,AUTO

      309     5700    2           FEI.TCNT = FEI$->KI$FEI.TCNT;

   5700  2 000762   000002 236100                    LDQ     2,,PR0
         2 000763   000022 736000                    QLS     18
         2 000764   000022 732000                    QRS     18
         2 000765   200024 756100                    STQ     FEI+3,,AUTO

      310     5701    2           FEI.OCQ$ = FEI$->KI$FEI.OCQ$;

   5701  2 000766   000003 236100                    LDQ     3,,PR0
         2 000767   200025 756100                    STQ     FEI+4,,AUTO

      311     5702    2           FEI.OCQ = MOD(FEI.OCQ,256);

   5702  2 000770   200025 236100                    LDQ     FEI+4,,AUTO
         2 000771   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:54   
         2 000772   200025 756100                    STQ     FEI+4,,AUTO

      312     5703    2           CALL YESNO (FEI$->KI$FEI.FROZEN,FEI.FRZN);

   5703  2 000773   200026 631500                    EPPR1   FEI+5,,AUTO
         2 000774   200124 451500                    STP1    @OFFSET+1,,AUTO
         2 000775   200076 236100                    LDQ     FEI$,,AUTO
         2 000776   000007 036003                    ADLQ    7,DU
         2 000777   200123 756100                    STQ     @FEI#+2,,AUTO
         2 001000   001060 701000 2                  TSX1    YESNO
         2 001001   000000 011000                    NOP     0

      313     5704    2           CALL YESNO (FEI$->KI$FEI.NOTIME,FEI.NOTIME);

   5704  2 001002   200027 630500                    EPPR0   FEI+6,,AUTO
         2 001003   200124 450500                    STP0    @OFFSET+1,,AUTO
         2 001004   200076 236100                    LDQ     FEI$,,AUTO
         2 001005   000023 036000 3                  ADLQ    19
         2 001006   200123 756100                    STQ     @FEI#+2,,AUTO
         2 001007   001060 701000 2                  TSX1    YESNO
         2 001010   000000 011000                    NOP     0

      314     5705    2           FEI.QOS = FEI$->KI$FEI.QOS;

   5705  2 001011   200076 470500                    LDP0    FEI$,,AUTO
         2 001012   000012 236100                    LDQ     10,,PR0
         2 001013   000777 376007                    ANQ     511,DL
         2 001014   200030 756100                    STQ     FEI+7,,AUTO

      315     5706    2           FEI.PROB = PROBLEM(FEI$->KI$FEI.PBST.PROB);

   5706  2 001015   000015 220100                    LDX0    13,,PR0
         2 001016   000124 236010 0                  LDQ     PROBLEM,X0
         2 001017   200031 756100                    STQ     FEI+8,,AUTO

      316     5707    2           FEI.PSTATE = STATE(FEI$->KI$FEI.PBST.STATE);

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:55   
   5707  2 001020   000015 720100                    LXL0    13,,PR0
         2 001021   000003 236010 0                  LDQ     STATE,X0
         2 001022   200032 756100                    STQ     FEI+9,,AUTO

      317     5708    2           FEI.QFLHD$ = FEI$->KI$FEI.QFLHD$;

   5708  2 001023   000017 236100                    LDQ     15,,PR0
         2 001024   200033 756100                    STQ     FEI+10,,AUTO

      318     5709    2           FEI.BDU# = FEI$->KI$FEI.BDU#;

   5709  2 001025   000007 236100                    LDQ     7,,PR0
         2 001026   000022 772000                    QRL     18
         2 001027   000777 376007                    ANQ     511,DL
         2 001030   200034 756100                    STQ     FEI+11,,AUTO

      319     5710    2           FEI.IOM = FEI$->KI$FEI.FECH.IOM;

   5710  2 001031   000002 236100                    LDQ     2,,PR0
         2 001032   000042 772000                    QRL     34
         2 001033   200035 756100                    STQ     FEI+12,,AUTO

      320     5711    2           FEI.DEV = FEI$->KI$FEI.FECH.DEV;

   5711  2 001034   000002 236100                    LDQ     2,,PR0
         2 001035   000033 772000                    QRL     27
         2 001036   000177 376007                    ANQ     127,DL
         2 001037   200036 756100                    STQ     FEI+13,,AUTO

      321     5712    2           CALL DAF$WRITE(VECTOR(FEIFMT),VECTOR(FEI));

   5712  2 001040   000026 235000 3                  LDA     22
         2 001041   200126 452500                    STP2    @TEXT+2,,AUTO
         2 001042   200126 236100                    LDQ     @TEXT+2,,AUTO
         2 001043   000021 036003                    ADLQ    17,DU
         2 001044   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 001045   200130 631500                    EPPR1   @TEXT+4,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:56   
         2 001046   200133 451500                    STP1    @TEXT+7,,AUTO
         2 001047   000027 236000 3                  LDQ     23
         2 001050   200132 756100                    STQ     @TEXT+6,,AUTO
         2 001051   200132 630500                    EPPR0   @TEXT+6,,AUTO
         2 001052   000000 220000 xsym               LDX0    DAF$WRITE
         2 001053   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001054   000000 701010                    TSX1    0,X0
         2 001055   000000 011000                    NOP     0

      322     5713    2           RETURN;

   5713  2 001056   200120 221300                    LDX1  ! J+1,,AUTO
         2 001057   000001 702211                    TSX2  ! 1,X1

      323     5714
      324     5715    2   YESNO:  PROC(FLAG,TEXT);

   5715  2 001060   200122 741300       YESNO        STX1  ! @FEI#+1,,AUTO

      325     5716    3   DCL FLAG BIT(1) UNAL;
      326     5717    3   DCL TEXT CHAR(4);
      327     5718    3           IF FLAG

   5718  2 001061   200123 470500                    LDP0    @FLAG,,AUTO
         2 001062   000000 066500                    CMPB    filb='0'B
         2 001063   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 001064   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001065   001073 600000 2                  TZE     s:5722

      328     5719    3           THEN
      329     5720    3              TEXT = 'Yes';

   5720  2 001066   200124 471500                    LDP1    @TEXT,,AUTO
         2 001067   040100 100400                    MLR     fill='040'O
         2 001070   000172 000003 0                  ADSC9   FEIFMT+17                cn=0,n=3
         2 001071   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 001072   001077 710000 2                  TRA     s:5723
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:57   

      330     5721    3           ELSE
      331     5722    3              TEXT = 'No';

   5722  2 001073   200124 471500                    LDP1    @TEXT,,AUTO
         2 001074   040100 100400                    MLR     fill='040'O
         2 001075   000173 000002 0                  ADSC9   FEIFMT+18                cn=0,n=2
         2 001076   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      332     5723    3           RETURN;

   5723  2 001077   200122 221300                    LDX1  ! @FEI#+1,,AUTO
         2 001100   000001 702211                    TSX2  ! 1,X1

      333     5724
      334     5725    3   END YESNO;
      335     5726
      336     5727    2   END DFEI;
      337     5728        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:58   
      338     5729    1   DAD$OCQ: ENTRY(TOP);

   5729  2 001101   000000 700200 xent  DAD$OCQ      TSX0  ! X66_AUTO_1
         2 001102   000134 000001                    ZERO    92,1

      339     5730    1     CALL DAF$INIT(OCQHDRRPT);

   5730  2 001103   000030 630400 3                  EPPR0   24
         2 001104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001105   000000 701000 xent               TSX1    DAF$INIT
         2 001106   000000 011000                    NOP     0

      340     5731    1     ICQ = '0'B;

   5731  2 001107   200114 450100                    STZ     ICQ,,AUTO

      341     5732    1     GOTO COMMON;

   5732  2 001110   001121 710000 2                  TRA     COMMON

      342     5733
      343     5734    1   DAD$ICQ: ENTRY(TOP);

   5734  2 001111   000000 700200 xent  DAD$ICQ      TSX0  ! X66_AUTO_1
         2 001112   000134 000001                    ZERO    92,1

      344     5735    1     CALL DAF$INIT(ICQHDRRPT);

   5735  2 001113   000031 630400 3                  EPPR0   25
         2 001114   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001115   000000 701000 xent               TSX1    DAF$INIT
         2 001116   000000 011000                    NOP     0

      345     5736    1     ICQ = '1'B;

   5736  2 001117   400000 236003                    LDQ     -131072,DU
         2 001120   200114 756100                    STQ     ICQ,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:59   

   5736  2 001121                       COMMON       null
      346     5737
      347     5738    1   COMMON:;
      348     5739    1     CALL DAA$VALUE(TOP.SUBLK$(0)->OUT.SUBLK$(0)->OUT,FEI##);

   5739  2 001121   200003 470500                    LDP0    @TOP,,AUTO
         2 001122   000003 471500                    LDP1    3,,PR0
         2 001123   100003 473500                    LDP3    3,,PR1
         2 001124   200104 634500                    EPPR4   FEI##,,AUTO
         2 001125   200127 454500                    STP4    @TEXT+3,,AUTO
         2 001126   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001127   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001131   000000 701000 xent               TSX1    DAA$VALUE
         2 001132   000000 011000                    NOP     0

      349     5740    1     CALL DAS$SDMONPTR(%M#KI_MXFE,P$) ALTRET(ALT);

   5740  2 001133   200100 630500                    EPPR0   P$,,AUTO
         2 001134   200127 450500                    STP0    @TEXT+3,,AUTO
         2 001135   000004 236000 3                  LDQ     4
         2 001136   200126 756100                    STQ     @TEXT+2,,AUTO
         2 001137   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001140   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001141   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 001142   000241 702000 2                  TSX2    ALT

      350     5741    1     CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

   5741  2 001143   000002 236000 3                  LDQ     2
         2 001144   200132 756100                    STQ     @TEXT+6,,AUTO
         2 001145   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001146   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001147   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 001150   200100 630500                    EPPR0   P$,,AUTO
         2 001151   200127 450500                    STP0    @TEXT+3,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:60   
         2 001152   200100 631500                    EPPR1   P$,,AUTO
         2 001153   200126 451500                    STP1    @TEXT+2,,AUTO
         2 001154   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001155   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001156   000000 701000 xent               TSX1    DAM$MAP
         2 001157   000241 702000 2                  TSX2    ALT

      351     5742    1     MXFE = P$->SBINWORD;

   5742  2 001160   200100 470500                    LDP0    P$,,AUTO
         2 001161   000000 235100                    LDA     0,,PR0
         2 001162   200073 755100                    STA     MXFE,,AUTO

      352     5743    1     IF FEI## > MXFE THEN

   5743  2 001163   200073 236100                    LDQ     MXFE,,AUTO
         2 001164   200104 116100                    CMPQ    FEI##,,AUTO
         2 001165   001167 603000 2                  TRC     s:5745

      353     5744    1        RETURN;

   5744  2 001166   000000 702200 xent               TSX2  ! X66_ARET

      354     5745    2     IF FEI## = 0 THEN DO;

   5745  2 001167   200104 235100                    LDA     FEI##,,AUTO
         2 001170   001175 601000 2                  TNZ     s:5750

      355     5746    2        LFEI# = 1;

   5746  2 001171   000001 235007                    LDA     1,DL
         2 001172   200105 755100                    STA     LFEI#,,AUTO

      356     5747    2        HFEI# = MXFE;

   5747  2 001173   200106 756100                    STQ     HFEI#,,AUTO

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:61   
      357     5748    2        END;

   5748  2 001174   001177 710000 2                  TRA     s:5753

      358     5749    2     ELSE DO;

      359     5750    2        LFEI# = FEI##;

   5750  2 001175   200105 755100                    STA     LFEI#,,AUTO

      360     5751    2        HFEI# = FEI##;

   5751  2 001176   200106 755100                    STA     HFEI#,,AUTO

      361     5752    2        END;

      362     5753    2     DO FEI## = LFEI# TO HFEI#;

   5753  2 001177   200104 755100                    STA     FEI##,,AUTO
         2 001200   001311 710000 2                  TRA     s:5771+3

      363     5754    2        CALL DAS$SDMONPTR(%M#KI_FEI$$,FEI$$) ALTRET(ALT);

   5754  2 001201   200077 630500                    EPPR0   FEI$$,,AUTO
         2 001202   200127 450500                    STP0    @TEXT+3,,AUTO
         2 001203   000010 236000 3                  LDQ     8
         2 001204   200126 756100                    STQ     @TEXT+2,,AUTO
         2 001205   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001206   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001207   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 001210   000241 702000 2                  TSX2    ALT

      364     5755    2        CALL DAM$MAP(FEI$$,FEI$$,,,DA_MONISDATA) ALTRET(ALT);

   5755  2 001211   000002 236000 3                  LDQ     2
         2 001212   200132 756100                    STQ     @TEXT+6,,AUTO
         2 001213   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:62   
         2 001214   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001215   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 001216   200077 630500                    EPPR0   FEI$$,,AUTO
         2 001217   200127 450500                    STP0    @TEXT+3,,AUTO
         2 001220   200077 631500                    EPPR1   FEI$$,,AUTO
         2 001221   200126 451500                    STP1    @TEXT+2,,AUTO
         2 001222   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001223   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001224   000000 701000 xent               TSX1    DAM$MAP
         2 001225   000241 702000 2                  TSX2    ALT

      365     5756    2        FEI$$ = FEI$$->PTR$;

   5756  2 001226   200077 470500                    LDP0    FEI$$,,AUTO
         2 001227   000000 236100                    LDQ     0,,PR0
         2 001230   200077 756100                    STQ     FEI$$,,AUTO

      366     5757    2        CALL DAM$MAP(FEI$$,FEI$$);

   5757  2 001231   200077 630500                    EPPR0   FEI$$,,AUTO
         2 001232   200127 450500                    STP0    @TEXT+3,,AUTO
         2 001233   200077 631500                    EPPR1   FEI$$,,AUTO
         2 001234   200126 451500                    STP1    @TEXT+2,,AUTO
         2 001235   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001237   000000 701000 xent               TSX1    DAM$MAP
         2 001240   000000 011000                    NOP     0

      367     5758    2        FEI$ = FEI$$->KI$FEI$(FEI##);

   5758  2 001241   200077 470500                    LDP0    FEI$$,,AUTO
         2 001242   200104 720100                    LXL0    FEI##,,AUTO
         2 001243   000000 236110                    LDQ     0,X0,PR0
         2 001244   200076 756100                    STQ     FEI$,,AUTO

      368     5759    2        CALL DAM$MAP(FEI$,FEI$);

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:63   
   5759  2 001245   200076 631500                    EPPR1   FEI$,,AUTO
         2 001246   200127 451500                    STP1    @TEXT+3,,AUTO
         2 001247   200076 633500                    EPPR3   FEI$,,AUTO
         2 001250   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001251   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001252   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001253   000000 701000 xent               TSX1    DAM$MAP
         2 001254   000000 011000                    NOP     0

      369     5760    2        IF ICQ THEN

   5760  2 001255   200114 234100                    SZN     ICQ,,AUTO
         2 001256   001263 605000 2                  TPL     s:5763

      370     5761    2           Q$ = FEI$->KI$FEI.ICQ$;

   5761  2 001257   200076 470500                    LDP0    FEI$,,AUTO
         2 001260   000004 236100                    LDQ     4,,PR0
         2 001261   200101 756100                    STQ     Q$,,AUTO
         2 001262   001266 710000 2                  TRA     s:5764

      371     5762    2        ELSE
      372     5763    2           Q$ = FEI$->KI$FEI.OCQ$;

   5763  2 001263   200076 470500                    LDP0    FEI$,,AUTO
         2 001264   000003 236100                    LDQ     3,,PR0
         2 001265   200101 756100                    STQ     Q$,,AUTO

      373     5764    2        TOPOQ$ = Q$;

   5764  2 001266   200102 756100                    STQ     TOPOQ$,,AUTO

      374     5765    2        CALL DOQHDR;

   5765  2 001267   001315 701000 2                  TSX1    DOQHDR
         2 001270   000000 011000                    NOP     0

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:64   
      375     5766    2        IF ICQ THEN

   5766  2 001271   200114 234100                    SZN     ICQ,,AUTO
         2 001272   001300 605000 2                  TPL     s:5769

      376     5767    2           CALL DAF$INIT(ICQRPRT);

   5767  2 001273   000032 630400 3                  EPPR0   26
         2 001274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001275   000000 701000 xent               TSX1    DAF$INIT
         2 001276   000000 011000                    NOP     0
         2 001277   001304 710000 2                  TRA     s:5770

      377     5768    2        ELSE
      378     5769    2           CALL DAF$INIT(OCQRPRT);

   5769  2 001300   000033 630400 3                  EPPR0   27
         2 001301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001302   000000 701000 xent               TSX1    DAF$INIT
         2 001303   000000 011000                    NOP     0

      379     5770    2        CALL DOQ;

   5770  2 001304   001432 701000 2                  TSX1    DOQ
         2 001305   000000 011000                    NOP     0

      380     5771    2        END;

   5771  2 001306   200104 235100                    LDA     FEI##,,AUTO
         2 001307   000001 035007                    ADLA    1,DL
         2 001310   200104 755100                    STA     FEI##,,AUTO
         2 001311   200106 236100                    LDQ     HFEI#,,AUTO
         2 001312   200104 116100                    CMPQ    FEI##,,AUTO
         2 001313   001201 603000 2                  TRC     s:5754

      381     5772    1     RETURN;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:65   
   5772  2 001314   000000 702200 xent               TSX2  ! X66_ARET

      382     5773
      383     5774        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:66   
      384     5775    1   DOQHDR: PROC;

   5775  2 001315   200120 741300       DOQHDR       STX1  ! J+1,,AUTO

      385     5776    2     VBASE(VECT) = Q$;

   5776  2 001316   200101 236100                    LDQ     Q$,,AUTO
         2 001317   000347 756000 1                  STQ     VECT+1

      386     5777    2     VBOUND(VECT) = SIZEC(KI$QHDR)-1;

   5777  2 001320   000346 236000 1                  LDQ     VECT
         2 001321   177777 376007                    ANQ     65535,DL
         2 001322   000034 276000 3                  ORQ     28
         2 001323   000346 756000 1                  STQ     VECT

      387     5778    3     CALL DAM$MAP(Q$,Q$,,,VECT) WHENALTRETURN DO;

   5778  2 001324   000035 236000 3                  LDQ     29
         2 001325   200132 756100                    STQ     @TEXT+6,,AUTO
         2 001326   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001327   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001330   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 001331   200101 630500                    EPPR0   Q$,,AUTO
         2 001332   200127 450500                    STP0    @TEXT+3,,AUTO
         2 001333   200101 631500                    EPPR1   Q$,,AUTO
         2 001334   200126 451500                    STP1    @TEXT+2,,AUTO
         2 001335   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001336   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001337   000000 701000 xent               TSX1    DAM$MAP
         2 001340   001342 702000 2                  TSX2    s:5779
         2 001341   001344 710000 2                  TRA     s:5781

      388     5779    3        RETURN;

   5779  2 001342   200120 221300                    LDX1  ! J+1,,AUTO
         2 001343   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:67   

      389     5780    3        END;
      390     5781    2     QHDR.FEI# = FEI##;

   5781  2 001344   200104 235100                    LDA     FEI##,,AUTO
         2 001345   200037 755100                    STA     QHDR,,AUTO

      391     5782    2     QHDR.CCMD = Q$->KI$QHDR.CCMD;

   5782  2 001346   200101 470500                    LDP0    Q$,,AUTO
         2 001347   000000 236100                    LDQ     0,,PR0
         2 001350   200053 756100                    STQ     QHDR+12,,AUTO

      392     5783    2     QHDR.HOST_NODE = Q$->KI$QHDR.HOST_NODE#;

   5783  2 001351   000003 236100                    LDQ     3,,PR0
         2 001352   000033 772000                    QRL     27
         2 001353   200040 756100                    STQ     QHDR+1,,AUTO

      393     5784    2     QHDR.FEP_NODE = Q$->KI$QHDR.FEP_NODE#;

   5784  2 001354   000003 236100                    LDQ     3,,PR0
         2 001355   000022 772000                    QRL     18
         2 001356   000777 376007                    ANQ     511,DL
         2 001357   200041 756100                    STQ     QHDR+2,,AUTO

      394     5785    2     QHDR.QOS = Q$->KI$QHDR.QOS;

   5785  2 001360   000003 236100                    LDQ     3,,PR0
         2 001361   000011 772000                    QRL     9
         2 001362   000777 376007                    ANQ     511,DL
         2 001363   200050 756100                    STQ     QHDR+9,,AUTO

      395     5786    2     QHDR.INTLOCK = Q$->KI$QHDR.INTLOCK;

   5786  2 001364   000004 235100                    LDA     4,,PR0
         2 001365   200042 755100                    STA     QHDR+3,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:68   

      396     5787    2     QHDR.QSIZE = Q$->KI$QHDR.QSIZE;

   5787  2 001366   000005 236100                    LDQ     5,,PR0
         2 001367   000004 772000                    QRL     4
         2 001370   200043 756100                    STQ     QHDR+4,,AUTO

      397     5788    2     QHDR.GATE = Q$->KI$QHDR.GATE;

   5788  2 001371   000006 237100                    LDAQ    6,,PR0
         2 001372   200044 757100                    STAQ    QHDR+5,,AUTO

      398     5789    2     QHDR.RPTR = Q$->KI$QHDR.RPTR;

   5789  2 001373   000011 236100                    LDQ     9,,PR0
         2 001374   000004 772000                    QRL     4
         2 001375   200046 756100                    STQ     QHDR+7,,AUTO

      399     5790    2     QHDR.IPTR = Q$->KI$QHDR.IPTR;

   5790  2 001376   000012 236100                    LDQ     10,,PR0
         2 001377   000004 772000                    QRL     4
         2 001400   200047 756100                    STQ     QHDR+8,,AUTO

      400     5791    2     QHDR.FLAG = Q$->KI$QHDR.FLG;

   5791  2 001401   000013 236100                    LDQ     11,,PR0
         2 001402   777700 376003                    ANQ     -64,DU
         2 001403   200051 756100                    STQ     QHDR+10,,AUTO

      401     5792    2     QHDR.TOTMES = Q$->KI$QHDR.TOTMES;

   5792  2 001404   000014 236100                    LDQ     12,,PR0
         2 001405   000004 772000                    QRL     4
         2 001406   200052 756100                    STQ     QHDR+11,,AUTO

      402     5793    2     QHDR.LSTIPTR = Q$->KI$QHDR.LAST_PTR;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:69   

   5793  2 001407   000015 236100                    LDQ     13,,PR0
         2 001410   000004 772000                    QRL     4
         2 001411   200054 756100                    STQ     QHDR+13,,AUTO

      403     5794    2     CALL DAF$WRITE(VECTOR(QHDRFMT),VECTOR(QHDR));

   5794  2 001412   000026 235000 3                  LDA     22
         2 001413   200126 452500                    STP2    @TEXT+2,,AUTO
         2 001414   200126 236100                    LDQ     @TEXT+2,,AUTO
         2 001415   000037 036003                    ADLQ    31,DU
         2 001416   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 001417   200130 631500                    EPPR1   @TEXT+4,,AUTO
         2 001420   200133 451500                    STP1    @TEXT+7,,AUTO
         2 001421   000040 236000 3                  LDQ     32
         2 001422   200132 756100                    STQ     @TEXT+6,,AUTO
         2 001423   200132 630500                    EPPR0   @TEXT+6,,AUTO
         2 001424   000000 220000 xsym               LDX0    DAF$WRITE
         2 001425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001426   000000 701010                    TSX1    0,X0
         2 001427   000000 011000                    NOP     0

      404     5795    2     RETURN;

   5795  2 001430   200120 221300                    LDX1  ! J+1,,AUTO
         2 001431   000001 702211                    TSX2  ! 1,X1

      405     5796    2   END DOQHDR;
      406     5797        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:70   
      407     5798    1   DOQ: PROC;

   5798  2 001432   200120 741300       DOQ          STX1  ! J+1,,AUTO

      408     5799    2        IPTR = 0;

   5799  2 001433   200107 450100                    STZ     IPTR,,AUTO

      409     5800    2        RPTR = 0;

   5800  2 001434   200110 450100                    STZ     RPTR,,AUTO

      410     5801    2        QSIZE = 0;

   5801  2 001435   200113 450100                    STZ     QSIZE,,AUTO

      411     5802    2        LAST_PTR = 0;

   5802  2 001436   200111 450100                    STZ     LAST_PTR,,AUTO

      412     5803    2        ADDR(IPTR)->TUID_B.D = Q$->KI$QHDR.IPTR;

   5803  2 001437   200101 470500                    LDP0    Q$,,AUTO
         2 001440   000012 236100                    LDQ     10,,PR0
         2 001441   000004 772000                    QRL     4
         2 001442   200107 676100                    ERQ     IPTR,,AUTO
         2 001443   000041 376000 3                  ANQ     33
         2 001444   200107 656100                    ERSQ    IPTR,,AUTO

      413     5804    2        ADDR(RPTR)->TUID_B.D = Q$->KI$QHDR.RPTR;

   5804  2 001445   000011 236100                    LDQ     9,,PR0
         2 001446   000004 772000                    QRL     4
         2 001447   200110 676100                    ERQ     RPTR,,AUTO
         2 001450   000041 376000 3                  ANQ     33
         2 001451   200110 656100                    ERSQ    RPTR,,AUTO

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:71   
      414     5805    2        ADDR(LAST_PTR)->TUID_B.D = Q$->KI$QHDR.LAST_PTR;

   5805  2 001452   000015 236100                    LDQ     13,,PR0
         2 001453   000004 772000                    QRL     4
         2 001454   200111 676100                    ERQ     LAST_PTR,,AUTO
         2 001455   000041 376000 3                  ANQ     33
         2 001456   200111 656100                    ERSQ    LAST_PTR,,AUTO

      415     5806    2        ADDR(QSIZE)->TUID_B.D = Q$->KI$QHDR.QSIZE;

   5806  2 001457   000005 236100                    LDQ     5,,PR0
         2 001460   000004 772000                    QRL     4
         2 001461   200113 676100                    ERQ     QSIZE,,AUTO
         2 001462   000041 376000 3                  ANQ     33
         2 001463   200113 656100                    ERSQ    QSIZE,,AUTO

      416     5807    2        IF TOP.NSUBLKS > 1 THEN

   5807  2 001464   200003 471500                    LDP1    @TOP,,AUTO
         2 001465   100001 220100                    LDX0    1,,PR1
         2 001466   000002 100003                    CMPX0   2,DU
         2 001467   001760 602000 2                  TNC     s:5893

      417     5808    3           DO;

      418     5809    3           IF IPTR = SIZEW(KI$QHDR) THEN

   5809  2 001470   200107 235100                    LDA     IPTR,,AUTO
         2 001471   000020 115007                    CMPA    16,DL
         2 001472   001560 601000 2                  TNZ     s:5838

      419     5810    4              DO;

      420     5811    5              CALL GETNXT (LAST_PTR) WHENALTRETURN DO;

   5811  2 001473   200111 633500                    EPPR3   LAST_PTR,,AUTO
         2 001474   200123 453500                    STP3    @FLAG,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:72   
         2 001475   002330 701000 2                  TSX1    GETNXT
         2 001476   001500 702000 2                  TSX2    s:5812
         2 001477   001502 710000 2                  TRA     s:5815

      421     5812    5                 RETURN;

   5812  2 001500   200120 221300                    LDX1  ! J+1,,AUTO
         2 001501   000001 702211                    TSX2  ! 1,X1

      422     5813    5                 END;
      423     5814
      424     5815    5              DO WHILE CURR > SIZEW(KI$QHDR);

   5815  2 001502   001547 710000 2                  TRA     s:5831

      425     5816    5                 CALL DISPMSG(CURR$);

   5816  2 001503   200071 630500                    EPPR0   CURR$,,AUTO
         2 001504   200123 450500                    STP0    @FLAG,,AUTO
         2 001505   002204 701000 2                  TSX1    DISPMSG
         2 001506   000000 011000                    NOP     0

      426     5817    6                 IF ICQ THEN DO;

   5817  2 001507   200114 234100                    SZN     ICQ,,AUTO
         2 001510   001535 605000 2                  TPL     s:5827

      427     5818    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN

   5818  2 001511   200071 470500                    LDP0    CURR$,,AUTO
         2 001512   000000 236100                    LDQ     0,,PR0
         2 001513   000033 772000                    QRL     27
         2 001514   000377 376007                    ANQ     255,DL
         2 001515   200104 116100                    CMPQ    FEI##,,AUTO
         2 001516   001522 600000 2                  TZE     s:5823

      428     5819        /*                  message has not been scanned yet.  last_iptr hasn't been
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:73   
      429     5820                            moved to uid */
      430     5821    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;

   5821  2 001517   000001 235100                    LDA     1,,PR0
         2 001520   200112 755100                    STA     TUID,,AUTO
         2 001521   001524 710000 2                  TRA     s:5824

      431     5822    6                    ELSE
      432     5823    6                       TUID = CURR$->KI$QMHDR.UID;

   5823  2 001522   000002 235100                    LDA     2,,PR0
         2 001523   200112 755100                    STA     TUID,,AUTO

      433     5824    6                    CALL DBM$PACK4(TUID,UID);

   5824  2 001524   200115 631500                    EPPR1   UID,,AUTO
         2 001525   200127 451500                    STP1    @TEXT+3,,AUTO
         2 001526   200112 633500                    EPPR3   TUID,,AUTO
         2 001527   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001530   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001532   000000 701000 xent               TSX1    DBM$PACK4
         2 001533   000000 011000                    NOP     0

      434     5825    6                    END;

   5825  2 001534   001540 710000 2                  TRA     s:5828

      435     5826    5                 ELSE
      436     5827    5                    UID = KI$QMHDR.UID;

   5827  2 001535   200101 470500                    LDP0    Q$,,AUTO
         2 001536   000002 235100                    LDA     2,,PR0
         2 001537   200115 755100                    STA     UID,,AUTO

      437     5828    6                 CALL GETNXT(UID) WHENALTRETURN DO;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:74   
   5828  2 001540   200115 630500                    EPPR0   UID,,AUTO
         2 001541   200123 450500                    STP0    @FLAG,,AUTO
         2 001542   002330 701000 2                  TSX1    GETNXT
         2 001543   001545 702000 2                  TSX2    s:5829
         2 001544   001547 710000 2                  TRA     s:5831

      438     5829    6                    RETURN;

   5829  2 001545   200120 221300                    LDX1  ! J+1,,AUTO
         2 001546   000001 702211                    TSX2  ! 1,X1

      439     5830    6                    END;
      440     5831    5                 END;

   5831  2 001547   200070 235100                    LDA     CURR,,AUTO
         2 001550   000021 115007                    CMPA    17,DL
         2 001551   001503 603000 2                  TRC     s:5816

      441     5832    4              CALL DISPMSG(CURR$);

   5832  2 001552   200071 630500                    EPPR0   CURR$,,AUTO
         2 001553   200123 450500                    STP0    @FLAG,,AUTO
         2 001554   002204 701000 2                  TSX1    DISPMSG
         2 001555   000000 011000                    NOP     0

      442     5833    4              RETURN;

   5833  2 001556   200120 221300                    LDX1  ! J+1,,AUTO
         2 001557   000001 702211                    TSX2  ! 1,X1

      443     5834    4              END;
      444     5835
      445     5836    3           ELSE
      446     5837    4              DO;

      447     5838    4                 IF ICQ THEN

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:75   
   5838  2 001560   200114 234100                    SZN     ICQ,,AUTO
         2 001561   001571 605000 2                  TPL     s:5842

      448     5839    5                    CALL GETNXT(LAST_PTR) WHENALTRETURN DO;

   5839  2 001562   200111 633500                    EPPR3   LAST_PTR,,AUTO
         2 001563   200123 453500                    STP3    @FLAG,,AUTO
         2 001564   002330 701000 2                  TSX1    GETNXT
         2 001565   001567 702000 2                  TSX2    s:5840
         2 001566   001571 710000 2                  TRA     s:5842

      449     5840    5                 RETURN;

   5840  2 001567   200120 221300                    LDX1  ! J+1,,AUTO
         2 001570   000001 702211                    TSX2  ! 1,X1

      450     5841    5                 END;
      451     5842    5              DO WHILE CURR > SIZEW(KI$QHDR);

   5842  2 001571   001636 710000 2                  TRA     s:5856

      452     5843    5                 CALL DISPMSG(CURR$);

   5843  2 001572   200071 630500                    EPPR0   CURR$,,AUTO
         2 001573   200123 450500                    STP0    @FLAG,,AUTO
         2 001574   002204 701000 2                  TSX1    DISPMSG
         2 001575   000000 011000                    NOP     0

      453     5844    6                 IF ICQ THEN DO;

   5844  2 001576   200114 234100                    SZN     ICQ,,AUTO
         2 001577   001624 605000 2                  TPL     s:5854

      454     5845    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN

   5845  2 001600   200071 470500                    LDP0    CURR$,,AUTO
         2 001601   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:76   
         2 001602   000033 772000                    QRL     27
         2 001603   000377 376007                    ANQ     255,DL
         2 001604   200104 116100                    CMPQ    FEI##,,AUTO
         2 001605   001611 600000 2                  TZE     s:5850

      455     5846        /*                  message has not been scanned yet.  last_iptr hasn't been
      456     5847                            moved to uid */
      457     5848    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;

   5848  2 001606   000001 235100                    LDA     1,,PR0
         2 001607   200112 755100                    STA     TUID,,AUTO
         2 001610   001613 710000 2                  TRA     s:5851

      458     5849    6                    ELSE
      459     5850    6                       TUID = CURR$->KI$QMHDR.UID;

   5850  2 001611   000002 235100                    LDA     2,,PR0
         2 001612   200112 755100                    STA     TUID,,AUTO

      460     5851    6                    CALL DBM$PACK4(TUID,UID);

   5851  2 001613   200115 631500                    EPPR1   UID,,AUTO
         2 001614   200127 451500                    STP1    @TEXT+3,,AUTO
         2 001615   200112 633500                    EPPR3   TUID,,AUTO
         2 001616   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001617   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001620   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001621   000000 701000 xent               TSX1    DBM$PACK4
         2 001622   000000 011000                    NOP     0

      461     5852    6                    END;

   5852  2 001623   001627 710000 2                  TRA     s:5855

      462     5853    5                 ELSE
      463     5854    5                    UID = KI$QMHDR.UID;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:77   
   5854  2 001624   200101 470500                    LDP0    Q$,,AUTO
         2 001625   000002 235100                    LDA     2,,PR0
         2 001626   200115 755100                    STA     UID,,AUTO

      464     5855    6                 CALL GETNXT(UID) WHENALTRETURN DO;RETURN;END;

   5855  2 001627   200115 630500                    EPPR0   UID,,AUTO
         2 001630   200123 450500                    STP0    @FLAG,,AUTO
         2 001631   002330 701000 2                  TSX1    GETNXT
         2 001632   001634 702000 2                  TSX2    s:5855+5
         2 001633   001636 710000 2                  TRA     s:5856

   5855  2 001634   200120 221300                    LDX1  ! J+1,,AUTO
         2 001635   000001 702211                    TSX2  ! 1,X1

      465     5856    5                 END;

   5856  2 001636   200070 235100                    LDA     CURR,,AUTO
         2 001637   000021 115007                    CMPA    17,DL
         2 001640   001572 603000 2                  TRC     s:5843

      466     5857    4              CALL DISPMSG(CURR$);

   5857  2 001641   200071 630500                    EPPR0   CURR$,,AUTO
         2 001642   200123 450500                    STP0    @FLAG,,AUTO
         2 001643   002204 701000 2                  TSX1    DISPMSG
         2 001644   000000 011000                    NOP     0

      467     5858    5                IF ICQ THEN DO;

   5858  2 001645   200114 234100                    SZN     ICQ,,AUTO
         2 001646   001673 605000 2                  TPL     s:5868

      468     5859    5                   IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN

   5859  2 001647   200071 470500                    LDP0    CURR$,,AUTO
         2 001650   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:78   
         2 001651   000033 772000                    QRL     27
         2 001652   000377 376007                    ANQ     255,DL
         2 001653   200104 116100                    CMPQ    FEI##,,AUTO
         2 001654   001660 600000 2                  TZE     s:5864

      469     5860        /*               message has not been scanned yet.  last_iptr hasn't been
      470     5861                         moved to uid */
      471     5862    5                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;

   5862  2 001655   000001 235100                    LDA     1,,PR0
         2 001656   200112 755100                    STA     TUID,,AUTO
         2 001657   001662 710000 2                  TRA     s:5865

      472     5863    5                    ELSE
      473     5864    5                       TUID = CURR$->KI$QMHDR.UID;

   5864  2 001660   000002 235100                    LDA     2,,PR0
         2 001661   200112 755100                    STA     TUID,,AUTO

      474     5865    5                    CALL DBM$PACK4(TUID,UID);

   5865  2 001662   200115 631500                    EPPR1   UID,,AUTO
         2 001663   200127 451500                    STP1    @TEXT+3,,AUTO
         2 001664   200112 633500                    EPPR3   TUID,,AUTO
         2 001665   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001666   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001667   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001670   000000 701000 xent               TSX1    DBM$PACK4
         2 001671   000000 011000                    NOP     0

      475     5866    5                    END;

   5866  2 001672   001676 710000 2                  TRA     s:5869

      476     5867    4                 ELSE
      477     5868    4                 UID = KI$QMHDR.UID;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:79   
   5868  2 001673   200101 470500                    LDP0    Q$,,AUTO
         2 001674   000002 235100                    LDA     2,,PR0
         2 001675   200115 755100                    STA     UID,,AUTO

      478     5869    5              CALL GETNXT(UID) WHENALTRETURN DO;

   5869  2 001676   200115 630500                    EPPR0   UID,,AUTO
         2 001677   200123 450500                    STP0    @FLAG,,AUTO
         2 001700   002330 701000 2                  TSX1    GETNXT
         2 001701   001703 702000 2                  TSX2    s:5870
         2 001702   001705 710000 2                  TRA     s:5872

      479     5870    5                 RETURN;

   5870  2 001703   200120 221300                    LDX1  ! J+1,,AUTO
         2 001704   000001 702211                    TSX2  ! 1,X1

      480     5871    5                 END;
      481     5872    5              DO WHILE CURR > IPTR;

   5872  2 001705   200107 236100                    LDQ     IPTR,,AUTO
         2 001706   200070 116100                    CMPQ    CURR,,AUTO
         2 001707   002202 603000 2                  TRC     s:5940

      482     5873    5                 CALL DISPMSG(CURR$);

   5873  2 001710   200071 630500                    EPPR0   CURR$,,AUTO
         2 001711   200123 450500                    STP0    @FLAG,,AUTO
         2 001712   002204 701000 2                  TSX1    DISPMSG
         2 001713   000000 011000                    NOP     0

      483     5874    6                 IF ICQ THEN DO;

   5874  2 001714   200114 234100                    SZN     ICQ,,AUTO
         2 001715   001742 605000 2                  TPL     s:5884

      484     5875    6                    IF FEI## ~= CURR$->KI$QMHDR.FEI# THEN
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:80   

   5875  2 001716   200071 470500                    LDP0    CURR$,,AUTO
         2 001717   000000 236100                    LDQ     0,,PR0
         2 001720   000033 772000                    QRL     27
         2 001721   000377 376007                    ANQ     255,DL
         2 001722   200104 116100                    CMPQ    FEI##,,AUTO
         2 001723   001727 600000 2                  TZE     s:5880

      485     5876        /*                  message has not been scanned yet.  last_iptr hasn't been
      486     5877                            moved to uid */
      487     5878    6                       TUID = ADDR(CURR$->KI$QMHDR.OFFSET)->UBINWORD;

   5878  2 001724   000001 235100                    LDA     1,,PR0
         2 001725   200112 755100                    STA     TUID,,AUTO
         2 001726   001731 710000 2                  TRA     s:5881

      488     5879    6                    ELSE
      489     5880    6                       TUID = CURR$->KI$QMHDR.UID;

   5880  2 001727   000002 235100                    LDA     2,,PR0
         2 001730   200112 755100                    STA     TUID,,AUTO

      490     5881    6                    CALL DBM$PACK4(TUID,UID);

   5881  2 001731   200115 631500                    EPPR1   UID,,AUTO
         2 001732   200127 451500                    STP1    @TEXT+3,,AUTO
         2 001733   200112 633500                    EPPR3   TUID,,AUTO
         2 001734   200126 453500                    STP3    @TEXT+2,,AUTO
         2 001735   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 001736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001737   000000 701000 xent               TSX1    DBM$PACK4
         2 001740   000000 011000                    NOP     0

      491     5882    6                    END;

   5882  2 001741   001745 710000 2                  TRA     s:5885

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:81   
      492     5883    5                 ELSE
      493     5884    5                    UID = KI$QMHDR.UID;

   5884  2 001742   200101 470500                    LDP0    Q$,,AUTO
         2 001743   000002 235100                    LDA     2,,PR0
         2 001744   200115 755100                    STA     UID,,AUTO

      494     5885    6                 CALL GETNXT(UID) WHENALTRETURN DO;

   5885  2 001745   200115 630500                    EPPR0   UID,,AUTO
         2 001746   200123 450500                    STP0    @FLAG,,AUTO
         2 001747   002330 701000 2                  TSX1    GETNXT
         2 001750   001752 702000 2                  TSX2    s:5886
         2 001751   001754 710000 2                  TRA     s:5888

      495     5886    6                    RETURN;

   5886  2 001752   200120 221300                    LDX1  ! J+1,,AUTO
         2 001753   000001 702211                    TSX2  ! 1,X1

      496     5887    6                    END;
      497     5888    5                 END;

   5888  2 001754   200107 236100                    LDQ     IPTR,,AUTO
         2 001755   200070 116100                    CMPQ    CURR,,AUTO
         2 001756   001710 602000 2                  TNC     s:5873

      498     5889    4              END;  /* ELSE*/

      499     5890    3           END;  /* if nsublks>0 then */

   5890  2 001757   002202 710000 2                  TRA     s:5940

      500     5891    2        ELSE
      501     5892    3           DO;

      502     5893    3           IF IPTR = RPTR THEN
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:82   

   5893  2 001760   200107 236100                    LDQ     IPTR,,AUTO
         2 001761   200110 116100                    CMPQ    RPTR,,AUTO
         2 001762   001764 601000 2                  TNZ     s:5895

      503     5894    3              RETURN;

   5894  2 001763   000001 702211                    TSX2  ! 1,X1

      504     5895    3           IF IPTR > RPTR THEN

   5895  2 001764   002033 602000 2                  TNC     s:5909
         2 001765   002033 600000 2                  TZE     s:5909

      505     5896    4              DO;   /*  just disp from here to rptr */

      506     5897    5              CALL GETNXT(RPTR) WHENALTRETURN DO; RETURN;END;

   5897  2 001766   200110 633500                    EPPR3   RPTR,,AUTO
         2 001767   200123 453500                    STP3    @FLAG,,AUTO
         2 001770   002330 701000 2                  TSX1    GETNXT
         2 001771   001773 702000 2                  TSX2    s:5897+5
         2 001772   001775 710000 2                  TRA     s:5898

   5897  2 001773   200120 221300                    LDX1  ! J+1,,AUTO
         2 001774   000001 702211                    TSX2  ! 1,X1

      507     5898    5              DO WHILE CURR < IPTR;

   5898  2 001775   200070 236100                    LDQ     CURR,,AUTO
         2 001776   200107 116100                    CMPQ    IPTR,,AUTO
         2 001777   002202 603000 2                  TRC     s:5940

      508     5899    5                 CALL DISPMSG(CURR$);

   5899  2 002000   200071 630500                    EPPR0   CURR$,,AUTO
         2 002001   200123 450500                    STP0    @FLAG,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:83   
         2 002002   002204 701000 2                  TSX1    DISPMSG
         2 002003   000000 011000                    NOP     0

      509     5900    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT

   5900  2 002004   200071 470500                    LDP0    CURR$,,AUTO
         2 002005   000003 236100                    LDQ     3,,PR0
         2 002006   000377 376007                    ANQ     255,DL
         2 002007   200126 756100                    STQ     @TEXT+2,,AUTO
         2 002010   000003 236100                    LDQ     3,,PR0
         2 002011   000001 772000                    QRL     1
         2 002012   177400 376007                    ANQ     65280,DL
         2 002013   200126 036100                    ADLQ    @TEXT+2,,AUTO
         2 002014   000023 036007                    ADLQ    19,DL
         2 002015   000002 772000                    QRL     2
         2 002016   200070 036100                    ADLQ    CURR,,AUTO
         2 002017   200112 756100                    STQ     TUID,,AUTO

      510     5901    5                        + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      511     5902    6                 CALL GETNXT(TUID) WHENALTRETURN DO;

   5902  2 002020   200112 631500                    EPPR1   TUID,,AUTO
         2 002021   200123 451500                    STP1    @FLAG,,AUTO
         2 002022   002330 701000 2                  TSX1    GETNXT
         2 002023   002025 702000 2                  TSX2    s:5903
         2 002024   002027 710000 2                  TRA     s:5905

      512     5903    6                    RETURN;

   5903  2 002025   200120 221300                    LDX1  ! J+1,,AUTO
         2 002026   000001 702211                    TSX2  ! 1,X1

      513     5904    6                    END;
      514     5905    5                 END;

   5905  2 002027   200070 236100                    LDQ     CURR,,AUTO
         2 002030   200107 116100                    CMPQ    IPTR,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:84   
         2 002031   002000 602000 2                  TNC     s:5899

      515     5906    4              END;

   5906  2 002032   002202 710000 2                  TRA     s:5940

      516     5907    3           ELSE
      517     5908    4              DO;

      518     5909    5              CALL GETNXT(RPTR) WHENALTRETURN DO;RETURN;END;

   5909  2 002033   200110 633500                    EPPR3   RPTR,,AUTO
         2 002034   200123 453500                    STP3    @FLAG,,AUTO
         2 002035   002330 701000 2                  TSX1    GETNXT
         2 002036   002040 702000 2                  TSX2    s:5909+5
         2 002037   002042 710000 2                  TRA     s:5910

   5909  2 002040   200120 221300                    LDX1  ! J+1,,AUTO
         2 002041   000001 702211                    TSX2  ! 1,X1

      519     5910    5              DO WHILE CURR < QSIZE;

   5910  2 002042   200070 236100                    LDQ     CURR,,AUTO
         2 002043   200113 116100                    CMPQ    QSIZE,,AUTO
         2 002044   002106 603000 2                  TRC     s:5922

      520     5911
      521     5912    5                 CALL DISPMSG(CURR$);

   5912  2 002045   200071 630500                    EPPR0   CURR$,,AUTO
         2 002046   200123 450500                    STP0    @FLAG,,AUTO
         2 002047   002204 701000 2                  TSX1    DISPMSG
         2 002050   000000 011000                    NOP     0

      522     5913    5                 IF CURR$->KI$QMHDR.FUNCTION = %KJ_FCN_NOP OR

   5913  2 002051   200071 470500                    LDP0    CURR$,,AUTO
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:85   
         2 002052   000000 236100                    LDQ     0,,PR0
         2 002053   000777 376003                    ANQ     511,DU
         2 002054   000040 116003                    CMPQ    32,DU
         2 002055   002135 600000 2                  TZE     TOPOQ
         2 002056   000000 236100                    LDQ     0,,PR0
         2 002057   000777 316003                    CANQ    511,DU
         2 002060   002135 600000 2                  TZE     TOPOQ

      523     5914    5                    CURR$->KI$QMHDR.FUNCTION = %KJ_FCN_NOPI THEN
      524     5915    5                         GOTO TOPOQ;
      525     5916    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT

   5916  2 002061   000003 236100                    LDQ     3,,PR0
         2 002062   000377 376007                    ANQ     255,DL
         2 002063   200126 756100                    STQ     @TEXT+2,,AUTO
         2 002064   000003 236100                    LDQ     3,,PR0
         2 002065   000001 772000                    QRL     1
         2 002066   177400 376007                    ANQ     65280,DL
         2 002067   200126 036100                    ADLQ    @TEXT+2,,AUTO
         2 002070   000023 036007                    ADLQ    19,DL
         2 002071   000002 772000                    QRL     2
         2 002072   200070 036100                    ADLQ    CURR,,AUTO
         2 002073   200112 756100                    STQ     TUID,,AUTO

      526     5917    5                          + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      527     5918    6                 CALL GETNXT(TUID) WHENALTRETURN DO;

   5918  2 002074   200112 631500                    EPPR1   TUID,,AUTO
         2 002075   200123 451500                    STP1    @FLAG,,AUTO
         2 002076   002330 701000 2                  TSX1    GETNXT
         2 002077   002101 702000 2                  TSX2    s:5919
         2 002100   002103 710000 2                  TRA     s:5921

      528     5919    6                    RETURN;

   5919  2 002101   200120 221300                    LDX1  ! J+1,,AUTO
         2 002102   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:86   

      529     5920    6                    END;
      530     5921    5                 END;

   5921  2 002103   200070 236100                    LDQ     CURR,,AUTO
         2 002104   200113 116100                    CMPQ    QSIZE,,AUTO
         2 002105   002045 602000 2                  TNC     s:5912

      531     5922    4              TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT

   5922  2 002106   200071 470500                    LDP0    CURR$,,AUTO
         2 002107   000003 236100                    LDQ     3,,PR0
         2 002110   000377 376007                    ANQ     255,DL
         2 002111   200126 756100                    STQ     @TEXT+2,,AUTO
         2 002112   000003 236100                    LDQ     3,,PR0
         2 002113   000001 772000                    QRL     1
         2 002114   177400 376007                    ANQ     65280,DL
         2 002115   200126 036100                    ADLQ    @TEXT+2,,AUTO
         2 002116   000023 036007                    ADLQ    19,DL
         2 002117   000002 772000                    QRL     2
         2 002120   200070 036100                    ADLQ    CURR,,AUTO
         2 002121   200112 756100                    STQ     TUID,,AUTO

      532     5923    4                       + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      533     5924    5              CALL GETNXT(TUID) WHENALTRETURN DO;

   5924  2 002122   200112 631500                    EPPR1   TUID,,AUTO
         2 002123   200123 451500                    STP1    @FLAG,,AUTO
         2 002124   002330 701000 2                  TSX1    GETNXT
         2 002125   002127 702000 2                  TSX2    s:5925
         2 002126   002131 710000 2                  TRA     s:5927

      534     5925    5                 RETURN;

   5925  2 002127   200120 221300                    LDX1  ! J+1,,AUTO
         2 002130   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:87   
      535     5926    5                 END;
      536     5927    4              CALL DISPMSG(CURR$);

   5927  2 002131   200071 630500                    EPPR0   CURR$,,AUTO
         2 002132   200123 450500                    STP0    @FLAG,,AUTO
         2 002133   002204 701000 2                  TSX1    DISPMSG
         2 002134   000000 011000                    NOP     0

      537     5928    4   TOPOQ:     TUID = 0;

   5928  2 002135   200112 450100       TOPOQ        STZ     TUID,,AUTO

      538     5929    5              CALL GETNXT(TUID) WHENALTRETURN DO;RETURN;END;

   5929  2 002136   200112 630500                    EPPR0   TUID,,AUTO
         2 002137   200123 450500                    STP0    @FLAG,,AUTO
         2 002140   002330 701000 2                  TSX1    GETNXT
         2 002141   002143 702000 2                  TSX2    s:5929+5
         2 002142   002145 710000 2                  TRA     s:5930

   5929  2 002143   200120 221300                    LDX1  ! J+1,,AUTO
         2 002144   000001 702211                    TSX2  ! 1,X1

      539     5930    5              DO WHILE CURR < IPTR;

   5930  2 002145   200070 236100                    LDQ     CURR,,AUTO
         2 002146   200107 116100                    CMPQ    IPTR,,AUTO
         2 002147   002202 603000 2                  TRC     s:5940

      540     5931    5                 CALL DISPMSG(CURR$);

   5931  2 002150   200071 630500                    EPPR0   CURR$,,AUTO
         2 002151   200123 450500                    STP0    @FLAG,,AUTO
         2 002152   002204 701000 2                  TSX1    DISPMSG
         2 002153   000000 011000                    NOP     0

      541     5932    5                 TUID = ((256*CURR$->KI$QMHDR.MSGSZB.TOP + CURR$->KI$QMHDR.MSGSZB.BOT
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:88   

   5932  2 002154   200071 470500                    LDP0    CURR$,,AUTO
         2 002155   000003 236100                    LDQ     3,,PR0
         2 002156   000377 376007                    ANQ     255,DL
         2 002157   200126 756100                    STQ     @TEXT+2,,AUTO
         2 002160   000003 236100                    LDQ     3,,PR0
         2 002161   000001 772000                    QRL     1
         2 002162   177400 376007                    ANQ     65280,DL
         2 002163   200126 036100                    ADLQ    @TEXT+2,,AUTO
         2 002164   000023 036007                    ADLQ    19,DL
         2 002165   000002 772000                    QRL     2
         2 002166   200070 036100                    ADLQ    CURR,,AUTO
         2 002167   200112 756100                    STQ     TUID,,AUTO

      542     5933    5                       + 3 + 4*SIZEW(KI$QMHDR) ) / 4) + CURR;
      543     5934    6                 CALL GETNXT(TUID) WHENALTRETURN DO;

   5934  2 002170   200112 631500                    EPPR1   TUID,,AUTO
         2 002171   200123 451500                    STP1    @FLAG,,AUTO
         2 002172   002330 701000 2                  TSX1    GETNXT
         2 002173   002175 702000 2                  TSX2    s:5935
         2 002174   002177 710000 2                  TRA     s:5937

      544     5935    6                    RETURN;

   5935  2 002175   200120 221300                    LDX1  ! J+1,,AUTO
         2 002176   000001 702211                    TSX2  ! 1,X1

      545     5936    6                    END;
      546     5937    5                 END;

   5937  2 002177   200070 236100                    LDQ     CURR,,AUTO
         2 002200   200107 116100                    CMPQ    IPTR,,AUTO
         2 002201   002150 602000 2                  TNC     s:5931

      547     5938    4              END;  /* ELSE  */

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:89   
      548     5939    3           END;  /* IF TOP.NSUBLKS <= 1 */

      549     5940    2   RETURN;

   5940  2 002202   200120 221300                    LDX1  ! J+1,,AUTO
         2 002203   000001 702211                    TSX2  ! 1,X1

      550     5941        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:90   
      551     5942    2   DISPMSG: PROC(QMSG$);

   5942  2 002204   200122 741300       DISPMSG      STX1  ! @FEI#+1,,AUTO

      552     5943    3     DCL QMSG$ PTR;
      553     5944
      554     5945    3     IF QMSG$->KI$QMHDR.FREFLG THEN

   5945  2 002205   200123 470500                    LDP0    @QMSG$,,AUTO
         2 002206   000000 471500                    LDP1    0,,PR0
         2 002207   100000 234100                    SZN     0,,PR1
         2 002210   002214 605000 2                  TPL     s:5948

      555     5946    3        QMSG.FREEFLAG = 1;

   5946  2 002211   000001 235007                    LDA     1,DL
         2 002212   200055 755100                    STA     QMSG,,AUTO
         2 002213   002215 710000 2                  TRA     s:5949

      556     5947    3     ELSE
      557     5948    3        QMSG.FREEFLAG = 0;

   5948  2 002214   200055 450100                    STZ     QMSG,,AUTO

      558     5949    3     QMSG.CURR = CURR + SIZEW(KI$QHDR);

   5949  2 002215   200070 235100                    LDA     CURR,,AUTO
         2 002216   000020 035007                    ADLA    16,DL
         2 002217   200056 755100                    STA     QMSG+1,,AUTO

      559     5950    3     TEMP$ = TOPOQ$;

   5950  2 002220   200102 236100                    LDQ     TOPOQ$,,AUTO
         2 002221   200103 756100                    STQ     TEMP$,,AUTO

      560     5951    3     TEMP = TEMP/262144;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:91   
   5951  2 002222   200103 236100                    LDQ     TEMP$,,AUTO
         2 002223   000022 772000                    QRL     18
         2 002224   200103 756100                    STQ     TEMP$,,AUTO

      561     5952    3     QMSG.CURR = QMSG.CURR + TEMP;

   5952  2 002225   200056 036100                    ADLQ    QMSG+1,,AUTO
         2 002226   200056 756100                    STQ     QMSG+1,,AUTO

      562     5953    3     QMSG.FEI# = QMSG$->KI$QMHDR.FEI#;

   5953  2 002227   000000 471500                    LDP1    0,,PR0
         2 002230   100000 236100                    LDQ     0,,PR1
         2 002231   000033 772000                    QRL     27
         2 002232   000377 376007                    ANQ     255,DL
         2 002233   200057 756100                    STQ     QMSG+2,,AUTO

      563     5954    3     IF QMSG$->KI$QMHDR.FUNCTION > %KJ_MAXOFUNCTIONS THEN

   5954  2 002234   000000 471500                    LDP1    0,,PR0
         2 002235   100000 236100                    LDQ     0,,PR1
         2 002236   000777 376003                    ANQ     511,DU
         2 002237   000044 116003                    CMPQ    36,DU
         2 002240   002245 602000 2                  TNC     s:5957

      564     5955    3        QMSG.FUNCTION = 'Unknown';

   5955  2 002241   040100 100400                    MLR     fill='040'O
         2 002242   000174 000007 0                  ADSC9   FEIFMT+19                cn=0,n=7
         2 002243   200060 000010                    ADSC9   QMSG+3,,AUTO             cn=0,n=8
         2 002244   002253 710000 2                  TRA     s:5958

      565     5956    3     ELSE
      566     5957    3        QMSG.FUNCTION = FUNCTION(QMSG$->KI$QMHDR.FUNCTION);

   5957  2 002245   100000 220100                    LDX0    0,,PR1
         2 002246   000777 360003                    ANX0    511,DU
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:92   
         2 002247   000000 635010                    EAA     0,X0
         2 002250   000021 771000                    ARL     17
         2 002251   000014 237005 0                  LDAQ    FUNCTION,AL
         2 002252   200060 757100                    STAQ    QMSG+3,,AUTO

      567     5958    3     QMSG.ACTSIZ = QMSG$->KI$QMHDR.ACTSZ;

   5958  2 002253   000000 471500                    LDP1    0,,PR0
         2 002254   100000 236100                    LDQ     0,,PR1
         2 002255   777777 376007                    ANQ     -1,DL
         2 002256   200062 756100                    STQ     QMSG+5,,AUTO

      568     5959    3     QMSG.OFFSET = QMSG$->KI$QMHDR.OFFSET;

   5959  2 002257   000000 471500                    LDP1    0,,PR0
         2 002260   100001 236100                    LDQ     1,,PR1
         2 002261   000022 772000                    QRL     18
         2 002262   200063 756100                    STQ     QMSG+6,,AUTO

      569     5960    3     QMSG.SIZE = QMSG$->KI$QMHDR.SIZE;

   5960  2 002263   000000 471500                    LDP1    0,,PR0
         2 002264   100001 236100                    LDQ     1,,PR1
         2 002265   777777 376007                    ANQ     -1,DL
         2 002266   200064 756100                    STQ     QMSG+7,,AUTO

      570     5961    3     QMSG.UID = QMSG$->KI$QMHDR.UID;

   5961  2 002267   000000 471500                    LDP1    0,,PR0
         2 002270   100002 235100                    LDA     2,,PR1
         2 002271   200065 755100                    STA     QMSG+8,,AUTO

      571     5962    3     QMSG.FPTSZ = QMSG$->KI$QMHDR.FPTSZ;

   5962  2 002272   000000 471500                    LDP1    0,,PR0
         2 002273   100003 236100                    LDQ     3,,PR1
         2 002274   000022 772000                    QRL     18
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:93   
         2 002275   200066 756100                    STQ     QMSG+9,,AUTO

      572     5963    3     QMSG.MSGSIZ =((256*QMSG$->KI$QMHDR.MSGSZB.TOP + QMSG$->KI$QMHDR.MSGSZB.BOT

   5963  2 002276   000000 471500                    LDP1    0,,PR0
         2 002277   100003 236100                    LDQ     3,,PR1
         2 002300   000377 376007                    ANQ     255,DL
         2 002301   200126 756100                    STQ     @TEXT+2,,AUTO
         2 002302   100003 236100                    LDQ     3,,PR1
         2 002303   000001 772000                    QRL     1
         2 002304   177400 376007                    ANQ     65280,DL
         2 002305   200126 036100                    ADLQ    @TEXT+2,,AUTO
         2 002306   000023 036007                    ADLQ    19,DL
         2 002307   200067 756100                    STQ     QMSG+10,,AUTO

      573     5964    3            + 3 + 4*SIZEW(KI$QMHDR) ));
      574     5965    3     CALL DAF$WRITE(VECTOR(QMSGFMT),VECTOR(QMSG));

   5965  2 002310   000044 235000 3                  LDA     36
         2 002311   200126 452500                    STP2    @TEXT+2,,AUTO
         2 002312   200126 236100                    LDQ     @TEXT+2,,AUTO
         2 002313   000055 036003                    ADLQ    45,DU
         2 002314   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 002315   200130 631500                    EPPR1   @TEXT+4,,AUTO
         2 002316   200133 451500                    STP1    @TEXT+7,,AUTO
         2 002317   000045 236000 3                  LDQ     37
         2 002320   200132 756100                    STQ     @TEXT+6,,AUTO
         2 002321   200132 630500                    EPPR0   @TEXT+6,,AUTO
         2 002322   000000 220000 xsym               LDX0    DAF$WRITE
         2 002323   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002324   000000 701010                    TSX1    0,X0
         2 002325   000000 011000                    NOP     0

      575     5966    3   END DISPMSG;

   5966  2 002326   200122 221300                    LDX1  ! @FEI#+1,,AUTO
         2 002327   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:94   

      576     5967        %EJECT;
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:95   
      577     5968    2   GETNXT: PROC(OFFSET) ALTRET;

   5968  2 002330   200122 741300       GETNXT       STX1  ! @FEI#+1,,AUTO

      578     5969    3     DCL 1 OFFSET UBIN;      /* WORD OFFSET TO NEXT MESSAGE */
      579     5970
      580     5971    3   CURR = OFFSET;

   5971  2 002331   200123 470500                    LDP0    @OFFSET,,AUTO
         2 002332   000000 235100                    LDA     0,,PR0
         2 002333   200070 755100                    STA     CURR,,AUTO

      581     5972    3   CURR$ = PINCRW(TOPOQ$,SIZEW(KI$QHDR)+CURR);

   5972  2 002334   200070 236100                    LDQ     CURR,,AUTO
         2 002335   000022 736000                    QLS     18
         2 002336   000020 036003                    ADLQ    16,DU
         2 002337   200102 036100                    ADLQ    TOPOQ$,,AUTO
         2 002340   200071 756100                    STQ     CURR$,,AUTO

      582     5973    3   VBASE(VECT) = CURR$;

   5973  2 002341   000347 756000 1                  STQ     VECT+1

      583     5974    4   CALL DAM$MAP(CURR$,CURR$,,,VECT) WHENALTRETURN DO;

   5974  2 002342   000035 236000 3                  LDQ     29
         2 002343   200132 756100                    STQ     @TEXT+6,,AUTO
         2 002344   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002345   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002346   200130 757100                    STAQ    @TEXT+4,,AUTO
         2 002347   200071 631500                    EPPR1   CURR$,,AUTO
         2 002350   200127 451500                    STP1    @TEXT+3,,AUTO
         2 002351   200071 633500                    EPPR3   CURR$,,AUTO
         2 002352   200126 453500                    STP3    @TEXT+2,,AUTO
         2 002353   200126 630500                    EPPR0   @TEXT+2,,AUTO
         2 002354   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:96   
         2 002355   000000 701000 xent               TSX1    DAM$MAP
         2 002356   002360 702000 2                  TSX2    s:5975
         2 002357   002362 710000 2                  TRA     s:5977

      584     5975    4     ALTRETURN;

   5975  2 002360   200122 221300                    LDX1  ! @FEI#+1,,AUTO
         2 002361   000000 702211                    TSX2  ! 0,X1

      585     5976    4   END;
      586     5977    3   RETURN;

   5977  2 002362   200122 221300                    LDX1  ! @FEI#+1,,AUTO
         2 002363   000001 702211                    TSX2  ! 1,X1
      587     5978    3   END GETNXT;
      588     5979    2   END DOQ;
      589     5980    1   END DAD$ROUTE;
      590     5981        %EOD;

PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:97   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_TEXTC_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DAD$ROUTE.
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:98   

 **** Variables and constants ****

  ****  Section 000 RoData DAD$ROUTE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   151-0-0/c CHAR(66)    r     1 FEIFMT
    14-0-0/c CHAR(8)     r     1 FUNCTION(0:35)
   124-0-0/c CHAR(4)     r     1 PROBLEM(0:20)              3-0-0/c CHAR(4)     r     1 STATE(0:8)

  ****  Section 001  Data  DAD$ROUTE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   276-0-0/w STRC(693)   r     1 FEIHDR0                  322-0-0/w STRC(702)   r     1 FEIHDR1
   364-0-0/w STRC(288)   r     1 FEIRPRT                  377-0-0/w STRC(144)   r     1 FEIRPRTHD00
   403-0-0/w STRC(144)   r     1 FEIRPRTHD01              374-0-0/c STRC(99)    r     1 FEIRPRTTX00
   503-0-0/w STRC(288)   r     1 ICQHDRRPT                513-0-0/c STRC(252)   r     1 ICQHDRRPTTX00
   407-0-0/w STRC(288)   r     1 ICQRPRT                  425-0-0/w STRC(144)   r     1 ICQRPRTHD00
   431-0-0/w STRC(144)   r     1 ICQRPRTHD01              417-0-0/c STRC(189)   r     1 ICQRPRTTX00
   463-0-0/w STRC(288)   r     1 OCQHDRRPT                473-0-0/c STRC(261)   r     1 OCQHDRRPTTX00
   435-0-0/w STRC(288)   r     1 OCQRPRT                  453-0-0/w STRC(144)   r     1 OCQRPRTHD00
   457-0-0/w STRC(144)   r     1 OCQRPRTHD01              445-0-0/c STRC(198)   r     1 OCQRPRTTX00
    26-0-0/c CHAR(215)   r     1 QHDRFMT                  114-0-0/w STRC(684)   r     1 QHDRHDR
   137-0-0/w STRC(684)   r     1 QHDRHDR1                  12-0-0/c CHAR(46)    r     1 QMSGFMT
   241-0-0/c CHAR(66)    r     1 RFMT0                    262-0-0/c CHAR(48)    r     1 RFMT1
   350-0-0/w STRC(288)   r     1 RRPRT                    360-0-0/c STRC(117)   r     1 RRPRTTX00
   346-0-0/d VECT        r     1 VECT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   121-0-0/w PTR         r     1 @FEI#                    123-0-0/w PTR         r     1 @FLAG
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:99   
   121-0-0/w PTR         r     1 @NODE                    123-0-0/w PTR         r     1 @OFFSET
   123-0-0/w PTR         r     1 @QMSG$                   124-0-0/w PTR         r     1 @TEXT
     3-0-0/w PTR         r     1 @TOP                      70-0-0/w UBIN        r     1 CURR
    71-0-0/w PTR         r     1 CURR$                     21-0-0/w STRC(504)   r     1 FEI
    *0-0-0/w UBIN        r     1 FEI#                     104-0-0/w UBIN        r     1 FEI##
    76-0-0/w PTR         r     1 FEI$                      77-0-0/w PTR         r     1 FEI$$
    *0-0-0/b BIT         r     1 FLAG                     106-0-0/w UBIN        r     1 HFEI#
   116-0-0/w UBIN        r     1 I                        114-0-0/b BIT         r     1 ICQ
   107-0-0/w UBIN        r     1 IPTR                     117-0-0/w UBIN        r     1 J
   111-0-0/w UBIN        r     1 LAST_PTR                 105-0-0/w UBIN        r     1 LFEI#
    73-0-0/w UBIN        r     1 MXFE                      *0-0-0/w UBIN        r     1 NODE
    72-0-0/w UBIN        r     1 NODES                     *0-0-0/w UBIN        r     1 OFFSET
   100-0-0/w PTR         r     1 P$                       101-0-0/w PTR         r     1 Q$
    37-0-0/w STRC(504)   r     1 QHDR                      55-0-0/w STRC(396)   r     1 QMSG
    *0-0-0/w PTR         r     1 QMSG$                    113-0-0/w UBIN        r     1 QSIZE
     4-0-0/w STRC(288)   r     1 ROUTE                     75-0-0/w PTR         r     1 ROUTE$
    74-0-0/w PTR         r     1 ROUTE$$                   14-0-0/w STRC(180)   r     1 ROUTELINK
   110-0-0/w UBIN        r     1 RPTR                     103-0-0/w UBIN        r     1 TEMP
   103-0-0/w PTR         r     1 TEMP$                     *0-0-0/c CHAR(4)     r     1 TEXT
    *0-0-0/w STRC(144)   r     1 TOP                      102-0-0/w PTR         r     1 TOPOQ$
   112-0-0/w UBIN        r     1 TUID                     115-0-0/w UBIN        r     1 UID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/b BIT (72)    r     1 DA_MONISDATA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR                    0-0-0/w STRC(144)   r     1 KI$QMHDR
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:100  
     0-0-0/w STRC(216)   r     1 KI$ROUTE
     0-0-0/w PTR         r     1 KI$ROUTE$(0:0)
     0-0-0/w STRC(144)   r     1 OUT                        0-0-0/w PTR         r     1 PTR$
     0-0-0/w SBIN        r     1 SBINWORD                   0-0-0/w STRC        r     1 TUID_B
     0-0-0/w UBIN        r     1 UBINWORD


   Procedure DAD$ROUTE requires 1268 words for executable code.
   Procedure DAD$ROUTE requires 92 words of local(AUTO) storage.
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:101  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:102  
          MINI XREF LISTING

ALT
      5609**LABEL    5583--CALLALT  5584--CALLALT  5586--CALLALT  5587--CALLALT  5589--CALLALT  5590--CALLALT
      5593--CALLALT  5594--CALLALT  5661--CALLALT  5662--CALLALT  5664--CALLALT  5665--CALLALT  5667--CALLALT
      5668--CALLALT  5671--CALLALT  5672--CALLALT  5740--CALLALT  5741--CALLALT  5754--CALLALT  5755--CALLALT
COMMON
      5736**LABEL    5732--GOTO
CURR
      4553**DCL      5815>>DOWHILE  5842>>DOWHILE  5872>>DOWHILE  5898>>DOWHILE  5900>>ASSIGN   5910>>DOWHILE
      5916>>ASSIGN   5922>>ASSIGN   5930>>DOWHILE  5932>>ASSIGN   5949>>ASSIGN   5971<<ASSIGN   5972>>ASSIGN
CURR$
      4554**DCL      5816<>CALL     5818>>IF       5821>>ASSIGN   5823>>ASSIGN   5832<>CALL     5843<>CALL
      5845>>IF       5848>>ASSIGN   5850>>ASSIGN   5857<>CALL     5859>>IF       5862>>ASSIGN   5864>>ASSIGN
      5873<>CALL     5875>>IF       5878>>ASSIGN   5880>>ASSIGN   5899<>CALL     5900>>ASSIGN   5900>>ASSIGN
      5912<>CALL     5913>>IF       5913>>IF       5916>>ASSIGN   5916>>ASSIGN   5922>>ASSIGN   5922>>ASSIGN
      5927<>CALL     5931<>CALL     5932>>ASSIGN   5932>>ASSIGN   5972<<ASSIGN   5973>>ASSIGN   5974<>CALL
      5974<>CALL
DAA$VALUE
      4425**DCL-ENT  5604--CALL     5682--CALL     5739--CALL
DAF$INIT
      4423**DCL-ENT  5581--CALL     5659--CALL     5730--CALL     5735--CALL     5767--CALL     5769--CALL
DAF$WRITE
      4422**DCL      5633>>CALL     5650>>CALL     5712>>CALL     5794>>CALL     5965>>CALL
DAM$MAP
      4421**DCL-ENT  5584--CALL     5587--CALL     5590--CALL     5592--CALL     5594--CALL     5596--CALL
      5615--CALL     5641--CALL     5662--CALL     5665--CALL     5668--CALL     5670--CALL     5672--CALL
      5674--CALL     5697--CALL     5741--CALL     5755--CALL     5757--CALL     5759--CALL     5778--CALL
      5974--CALL
DAS$SDMONPTR
      4426**DCL-ENT  5583--CALL     5586--CALL     5589--CALL     5593--CALL     5661--CALL     5664--CALL
      5667--CALL     5671--CALL     5740--CALL     5754--CALL
DA_MAPSEG.P
       297**DCL       298--REDEF
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:103  
DA_MONISDATA
       290**DCL      5584<>CALL     5587<>CALL     5590<>CALL     5594<>CALL     5662<>CALL     5665<>CALL
      5668<>CALL     5672<>CALL     5741<>CALL     5755<>CALL
DA_SDASN.DESC.TYPE0
       282**DCL       282--REDEF
DA_TIGRSEG.P
       298**DCL       299--REDEF
DBM$PACK4
      4427**DCL-ENT  5824--CALL     5851--CALL     5865--CALL     5881--CALL
DFEI
      5688**PROC     5678--CALL     5683--CALL
DISPMSG IN PROCEDURE DOQ
      5942**PROC     5816--CALL     5832--CALL     5843--CALL     5857--CALL     5873--CALL     5899--CALL
      5912--CALL     5927--CALL     5931--CALL
DOQ
      5798**PROC     5770--CALL
DOQHDR
      5775**PROC     5765--CALL
DROUTE
      5611**PROC     5600--CALL     5605--CALL
FEI
      4445**DCL      5712--CALL
FEI.BDU#
      4458**DCL      5709<<ASSIGN
FEI.DEV
      4460**DCL      5711<<ASSIGN
FEI.FEI
      4446**DCL      5695<<ASSIGN
FEI.FRZN
      4452**DCL      5703<>CALL
FEI.IOM
      4459**DCL      5710<<ASSIGN
FEI.NODE
      4447**DCL      5698<<ASSIGN
FEI.NOTIME
      4453**DCL      5704<>CALL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:104  
FEI.OCQ
      4451**DCL      5702<<ASSIGN   5702>>ASSIGN
FEI.OCQ$
      4450**DCL      4451--REDEF    5701<<ASSIGN
FEI.PROB
      4455**DCL      5706<<ASSIGN
FEI.PSTATE
      4456**DCL      5707<<ASSIGN
FEI.QFLHD$
      4457**DCL      5708<<ASSIGN
FEI.QOS
      4454**DCL      5705<<ASSIGN
FEI.STATE
      4448**DCL      5699<<ASSIGN
FEI.TCNT
      4449**DCL      5700<<ASSIGN
FEI# IN PROCEDURE DFEI
      5690**DCL      5688--PROC     5692>>IF       5692>>IF       5695>>ASSIGN   5696>>ASSIGN
FEI##
      4635**DCL      5739<>CALL     5743>>IF       5745>>IF       5750>>ASSIGN   5751>>ASSIGN   5753<<DOINDEX
      5758>>ASSIGN   5781>>ASSIGN   5818>>IF       5845>>IF       5859>>IF       5875>>IF
FEI$
      4623**DCL      5640<<ASSIGN   5641<>CALL     5641<>CALL     5642>>ASSIGN   5696<<ASSIGN   5697<>CALL
      5697<>CALL     5698>>ASSIGN   5699>>ASSIGN   5700>>ASSIGN   5701>>ASSIGN   5703>>CALL     5704>>CALL
      5705>>ASSIGN   5706>>ASSIGN   5707>>ASSIGN   5708>>ASSIGN   5709>>ASSIGN   5710>>ASSIGN   5711>>ASSIGN
      5758<<ASSIGN   5759<>CALL     5759<>CALL     5761>>ASSIGN   5763>>ASSIGN
FEI$$
      4624**DCL      5593<>CALL     5594<>CALL     5594<>CALL     5595<<ASSIGN   5595>>ASSIGN   5596<>CALL
      5596<>CALL     5640>>ASSIGN   5671<>CALL     5672<>CALL     5672<>CALL     5673<<ASSIGN   5673>>ASSIGN
      5674<>CALL     5674<>CALL     5696>>ASSIGN   5754<>CALL     5755<>CALL     5755<>CALL     5756<<ASSIGN
      5756>>ASSIGN   5757<>CALL     5757<>CALL     5758>>ASSIGN
FEIFMT
      4617**DCL      5712--CALL
FEIHDR0
      4588**DCL      4995--DCLINIT
FEIHDR1
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:105  
      4613**DCL      5037--DCLINIT
FEIRPRT
      4923**DCL      5659<>CALL
FEIRPRTHD00
      4989**DCL      4958--DCLINIT
FEIRPRTHD01
      5031**DCL      5004--DCLINIT
FEIRPRTTX00
      4966**DCL      4953--DCLINIT
FLAG IN PROCEDURE YESNO
      5716**DCL      5715--PROC     5718>>IF
FUNCTION
      4550**DCL      5957>>ASSIGN
GETNXT IN PROCEDURE DOQ
      5968**PROC     5811--CALL     5828--CALL     5839--CALL     5855--CALL     5869--CALL     5885--CALL
      5897--CALL     5902--CALL     5909--CALL     5918--CALL     5924--CALL     5929--CALL     5934--CALL
HFEI#
      4637**DCL      5747<<ASSIGN   5751<<ASSIGN   5753>>DOINDEX
I
      4648**DCL      5599<<DOINDEX  5600<>CALL     5603<<DOINDEX  5604>>CALL     5677<<DOINDEX  5678<>CALL
      5681<<DOINDEX  5682>>CALL
ICQ
      4646**DCL      5731<<ASSIGN   5736<<ASSIGN   5760>>IF       5766>>IF       5817>>IF       5838>>IF
      5844>>IF       5858>>IF       5874>>IF
ICQHDRRPT
      5439**DCL      5735<>CALL
ICQHDRRPTTX00
      5482**DCL      5469--DCLINIT
ICQRPRT
      5073**DCL      5767<>CALL
ICQRPRTHD00
      5139**DCL      5108--DCLINIT
ICQRPRTHD01
      5181**DCL      5154--DCLINIT
ICQRPRTTX00
      5116**DCL      5103--DCLINIT
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:106  
IPTR
      4638**DCL      5799<<ASSIGN   5803--ASSIGN   5809>>IF       5872>>DOWHILE  5893>>IF       5895>>IF
      5898>>DOWHILE  5930>>DOWHILE
J
      4649**DCL      5604<>CALL     5605<>CALL     5634<<DOINDEX  5635>>ASSIGN   5640>>ASSIGN   5644>>ASSIGN
      5645>>ASSIGN   5646>>ASSIGN   5682<>CALL     5683<>CALL
KI$FEI.BD$
      4754**DCL      4755--REDEF
KI$FEI.BDAD.WADDR
      4756**DCL      4757--REDEF
KI$FEI.BDU#
      4752**DCL      5709>>ASSIGN
KI$FEI.FECH.DEV
      4723**DCL      5711>>ASSIGN
KI$FEI.FECH.IOM
      4722**DCL      5710>>ASSIGN
KI$FEI.FEP#
      4764**DCL      5642>>ASSIGN   5698>>ASSIGN
KI$FEI.FEST
      4724**DCL      5699>>ASSIGN
KI$FEI.FROZEN
      4749**DCL      5703<>CALL
KI$FEI.ICQ$
      4741**DCL      5761>>ASSIGN
KI$FEI.NOTIME
      4750**DCL      5704<>CALL
KI$FEI.OCQ$
      4735**DCL      5701>>ASSIGN   5763>>ASSIGN
KI$FEI.PBST.PROB
      4772**DCL      5706>>ASSIGN
KI$FEI.PBST.STATE
      4776**DCL      5707>>ASSIGN
KI$FEI.QFLHD$
      4783**DCL      5708>>ASSIGN
KI$FEI.QOS
      4765**DCL      5705>>ASSIGN
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:107  
KI$FEI.RCVPB
      4770**DCL      4771--REDEF
KI$FEI.TCNT
      4731**DCL      5700>>ASSIGN
KI$FEI$
      4790**DCL      5640>>ASSIGN   5696>>ASSIGN   5758>>ASSIGN
KI$QHDR
       413**DCL      5777--ASSIGN   5809--IF       5815--DOWHILE  5842--DOWHILE  5949--ASSIGN   5972--ASSIGN
KI$QHDR.CCMD
       414**DCL      5782>>ASSIGN
KI$QHDR.FEP_NODE#
       429**DCL      5784>>ASSIGN
KI$QHDR.FLG
       441**DCL      5791>>ASSIGN
KI$QHDR.GATE
       435**DCL      5788>>ASSIGN
KI$QHDR.HOST_NODE#
       428**DCL      5783>>ASSIGN
KI$QHDR.INTLOCK
       432**DCL      5786>>ASSIGN
KI$QHDR.IPTR
       439**DCL      5790>>ASSIGN   5803>>ASSIGN
KI$QHDR.LAST_PTR
       450**DCL      5793>>ASSIGN   5805>>ASSIGN
KI$QHDR.QOS
       430**DCL      5785>>ASSIGN
KI$QHDR.QSIZE
       433**DCL      5787>>ASSIGN   5806>>ASSIGN
KI$QHDR.RPTR
       437**DCL      5789>>ASSIGN   5804>>ASSIGN
KI$QHDR.TOTMES
       448**DCL      5792>>ASSIGN
KI$QMHDR
      4792**DCL      5900--ASSIGN   5916--ASSIGN   5922--ASSIGN   5932--ASSIGN   5963--ASSIGN
KI$QMHDR.ACTSZ
      4814**DCL      5958>>ASSIGN
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:108  
KI$QMHDR.FEI#
      4794**DCL      5818>>IF       5845>>IF       5859>>IF       5875>>IF       5953>>ASSIGN
KI$QMHDR.FPTSZ
      4827**DCL      4828--REDEF    5962>>ASSIGN
KI$QMHDR.FREFLG
      4793**DCL      5945>>IF
KI$QMHDR.FUNCTION
      4795**DCL      5913>>IF       5913>>IF       5954>>IF       5957>>ASSIGN
KI$QMHDR.MSGSZ
      4833**DCL      4834--REDEF
KI$QMHDR.MSGSZB.BOT
      4838**DCL      5900>>ASSIGN   5916>>ASSIGN   5922>>ASSIGN   5932>>ASSIGN   5963>>ASSIGN
KI$QMHDR.MSGSZB.TOP
      4836**DCL      5900>>ASSIGN   5916>>ASSIGN   5922>>ASSIGN   5932>>ASSIGN   5963>>ASSIGN
KI$QMHDR.OFFSET
      4821**DCL      5821--ASSIGN   5848--ASSIGN   5862--ASSIGN   5878--ASSIGN   5959>>ASSIGN
KI$QMHDR.SIZE
      4822**DCL      5960>>ASSIGN
KI$QMHDR.UID
      4823**DCL      4824--REDEF    5823>>ASSIGN   5827>>ASSIGN   5850>>ASSIGN   5854>>ASSIGN   5864>>ASSIGN
      5868>>ASSIGN   5880>>ASSIGN   5884>>ASSIGN   5961>>ASSIGN
KI$ROUTE.ALT_QOS
      4669**DCL      5622>>ASSIGN
KI$ROUTE.CURRENT_QOS
      4668**DCL      5616>>IF       5621>>ASSIGN
KI$ROUTE.FEI#
      4663**DCL      5620>>ASSIGN   5636>>IF
KI$ROUTE.HOST
      4670**DCL      5623>>IF
KI$ROUTE.LINK.MSGS_IN
      4694**DCL      5645>>ASSIGN
KI$ROUTE.LINK.MSGS_OUT
      4699**DCL      5646>>ASSIGN
KI$ROUTE.LINK.QOS
      4690**DCL      5644>>ASSIGN
KI$ROUTE.LINK_CONNECTED
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:109  
      4674**DCL      5628>>IF
KI$ROUTE.NODE_NAME
      4653**DCL      5619>>ASSIGN
KI$ROUTE$
      4705**DCL      5614>>ASSIGN
LAST_PTR
      4640**DCL      5802<<ASSIGN   5805--ASSIGN   5811<>CALL     5839<>CALL
LFEI#
      4636**DCL      5746<<ASSIGN   5750<<ASSIGN   5753>>DOINDEX
MXFE
      4620**DCL      5588<<ASSIGN   5634>>DOINDEX  5666<<ASSIGN   5677>>DOINDEX  5692>>IF       5742<<ASSIGN
      5743>>IF       5747>>ASSIGN
NODE IN PROCEDURE DROUTE
      5612**DCL      5611--PROC     5614>>ASSIGN   5618>>ASSIGN
NODES
      4619**DCL      5585<<ASSIGN   5599>>DOINDEX  5663<<ASSIGN
OCQHDRRPT
      5373**DCL      5730<>CALL
OCQHDRRPTTX00
      5416**DCL      5403--DCLINIT
OCQRPRT
      5223**DCL      5769<>CALL
OCQRPRTHD00
      5289**DCL      5258--DCLINIT
OCQRPRTHD01
      5331**DCL      5304--DCLINIT
OCQRPRTTX00
      5266**DCL      5253--DCLINIT
OFFSET IN PROCEDURE GETNXT
      5969**DCL      5968--PROC     5971>>ASSIGN
OUT
      5539**DCL      5604<>CALL     5682<>CALL     5739<>CALL
OUT.SUBLK$
      5572**DCL      5604>>CALL     5682>>CALL     5739>>CALL
P$
      4629**DCL      5583<>CALL     5584<>CALL     5584<>CALL     5585>>ASSIGN   5586<>CALL     5587<>CALL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:110  
      5587<>CALL     5588>>ASSIGN   5661<>CALL     5662<>CALL     5662<>CALL     5663>>ASSIGN   5664<>CALL
      5665<>CALL     5665<>CALL     5666>>ASSIGN   5740<>CALL     5741<>CALL     5741<>CALL     5742>>ASSIGN
PROBLEM
      4555**DCL      5706>>ASSIGN
PTR$
      4628**DCL      5591>>ASSIGN   5595>>ASSIGN   5669>>ASSIGN   5673>>ASSIGN   5756>>ASSIGN
Q$
      4630**DCL      4792--IMP-PTR  5761<<ASSIGN   5763<<ASSIGN   5764>>ASSIGN   5776>>ASSIGN   5778<>CALL
      5778<>CALL     5782>>ASSIGN   5783>>ASSIGN   5784>>ASSIGN   5785>>ASSIGN   5786>>ASSIGN   5787>>ASSIGN
      5788>>ASSIGN   5789>>ASSIGN   5790>>ASSIGN   5791>>ASSIGN   5792>>ASSIGN   5793>>ASSIGN   5803>>ASSIGN
      5804>>ASSIGN   5805>>ASSIGN   5806>>ASSIGN   5827>>ASSIGN   5854>>ASSIGN   5868>>ASSIGN   5884>>ASSIGN
QHDR
      4461**DCL      5794--CALL
QHDR.CCMD
      4476**DCL      5782<<ASSIGN
QHDR.FEI#
      4462**DCL      5781<<ASSIGN
QHDR.FEP_NODE
      4464**DCL      5784<<ASSIGN
QHDR.FLAG
      4474**DCL      5791<<ASSIGN
QHDR.GATE
      4467**DCL      4468--REDEF    5788<<ASSIGN
QHDR.HOST_NODE
      4463**DCL      5783<<ASSIGN
QHDR.INTLOCK
      4465**DCL      5786<<ASSIGN
QHDR.IPTR
      4472**DCL      5790<<ASSIGN
QHDR.LSTIPTR
      4477**DCL      5793<<ASSIGN
QHDR.QOS
      4473**DCL      5785<<ASSIGN
QHDR.QSIZE
      4466**DCL      5787<<ASSIGN
QHDR.RPTR
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:111  
      4471**DCL      5789<<ASSIGN
QHDR.TOTMES
      4475**DCL      5792<<ASSIGN
QHDRFMT
      4491**DCL      5794--CALL
QHDRHDR
      4519**DCL      5145--DCLINIT  5295--DCLINIT
QHDRHDR1
      4544**DCL      5187--DCLINIT  5337--DCLINIT
QMSG
      4478**DCL      5965--CALL
QMSG.ACTSIZ
      4483**DCL      5958<<ASSIGN
QMSG.CURR
      4480**DCL      5949<<ASSIGN   5952<<ASSIGN   5952>>ASSIGN
QMSG.FEI#
      4481**DCL      5953<<ASSIGN
QMSG.FPTSZ
      4487**DCL      5962<<ASSIGN
QMSG.FREEFLAG
      4479**DCL      5946<<ASSIGN   5948<<ASSIGN
QMSG.FUNCTION
      4482**DCL      5955<<ASSIGN   5957<<ASSIGN
QMSG.MSGSIZ
      4488**DCL      5963<<ASSIGN
QMSG.OFFSET
      4484**DCL      5959<<ASSIGN
QMSG.SIZE
      4485**DCL      5960<<ASSIGN
QMSG.UID
      4486**DCL      5961<<ASSIGN
QMSG$ IN PROCEDURE DISPMSG
      5943**DCL      5942--PROC     5945>>IF       5953>>ASSIGN   5954>>IF       5957>>ASSIGN   5958>>ASSIGN
      5959>>ASSIGN   5960>>ASSIGN   5961>>ASSIGN   5962>>ASSIGN   5963>>ASSIGN   5963>>ASSIGN
QMSGFMT
      4489**DCL      5965--CALL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:112  
QSIZE
      4642**DCL      5801<<ASSIGN   5806--ASSIGN   5910>>DOWHILE
RFMT0
      4563**DCL      5633--CALL
RFMT1
      4565**DCL      5650--CALL
ROUTE
      4431**DCL      5633--CALL
ROUTE.AQOS
      4436**DCL      5622<<ASSIGN
ROUTE.FEI
      4434**DCL      5620<<ASSIGN
ROUTE.HOST
      4437**DCL      5625<<ASSIGN   5627<<ASSIGN
ROUTE.LINK
      4438**DCL      5630<<ASSIGN   5632<<ASSIGN
ROUTE.NAME
      4433**DCL      5619<<ASSIGN
ROUTE.NODE
      4432**DCL      5618<<ASSIGN
ROUTE.QOS
      4435**DCL      5621<<ASSIGN
ROUTE$
      4622**DCL      5614<<ASSIGN   5615<>CALL     5615<>CALL     5616>>IF       5619>>ASSIGN   5620>>ASSIGN
      5621>>ASSIGN   5622>>ASSIGN   5623>>IF       5628>>IF       5636>>IF       5644>>ASSIGN   5645>>ASSIGN
      5646>>ASSIGN
ROUTE$$
      4621**DCL      5589<>CALL     5590<>CALL     5590<>CALL     5591<<ASSIGN   5591>>ASSIGN   5592<>CALL
      5592<>CALL     5614>>ASSIGN   5667<>CALL     5668<>CALL     5668<>CALL     5669<<ASSIGN   5669>>ASSIGN
      5670<>CALL     5670<>CALL
ROUTELINK
      4439**DCL      5650--CALL
ROUTELINK.FEI
      4440**DCL      5635<<ASSIGN
ROUTELINK.MSGS_IN
      4443**DCL      5645<<ASSIGN   5647>>IF
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:113  
ROUTELINK.MSGS_OUT
      4444**DCL      5646<<ASSIGN   5647>>IF
ROUTELINK.NODE
      4441**DCL      5638<<ASSIGN   5642<<ASSIGN
ROUTELINK.QOS
      4442**DCL      5644<<ASSIGN   5647>>IF
RPTR
      4639**DCL      5800<<ASSIGN   5804--ASSIGN   5893>>IF       5895>>IF       5897<>CALL     5909<>CALL
RRPRT
      4857**DCL      5581<>CALL
RRPRTTX00
      4900**DCL      4887--DCLINIT
SBINWORD
      4626**DCL      5585>>ASSIGN   5588>>ASSIGN   5663>>ASSIGN   5666>>ASSIGN   5742>>ASSIGN
STATE
      4549**DCL      5699>>ASSIGN   5707>>ASSIGN
TEMP
      4633**DCL      5951<<ASSIGN   5951>>ASSIGN   5952>>ASSIGN
TEMP$
      4632**DCL      4633--REDEF    5950<<ASSIGN
TEXT IN PROCEDURE YESNO
      5717**DCL      5715--PROC     5720<<ASSIGN   5722<<ASSIGN
TOP
      5494**DCL        15--PROC     5658--ENTRY    5729--ENTRY    5734--ENTRY
TOP.NSUBLKS
      5506**DCL      5597>>IF       5603>>DOINDEX  5616>>IF       5675>>IF       5681>>DOINDEX  5807>>IF
TOP.SUBLK$
      5527**DCL      5604>>CALL     5682>>CALL     5739>>CALL
TOPOQ IN PROCEDURE DOQ
      5928**LABEL    5915--GOTO
TOPOQ$
      4631**DCL      5764<<ASSIGN   5950>>ASSIGN   5972>>ASSIGN
TUID
      4641**DCL      5821<<ASSIGN   5823<<ASSIGN   5824<>CALL     5848<<ASSIGN   5850<<ASSIGN   5851<>CALL
      5862<<ASSIGN   5864<<ASSIGN   5865<>CALL     5878<<ASSIGN   5880<<ASSIGN   5881<>CALL     5900<<ASSIGN
      5902<>CALL     5916<<ASSIGN   5918<>CALL     5922<<ASSIGN   5924<>CALL     5928<<ASSIGN   5929<>CALL
PL6.E3A0      #001=DAD$ROUTE File=DAD$ROUTE.:E05TSI                              TUE 07/29/97 12:44 Page:114  
      5932<<ASSIGN   5934<>CALL
TUID_B.D
      4645**DCL      5803<<ASSIGN   5804<<ASSIGN   5805<<ASSIGN   5806<<ASSIGN
UBINWORD
      4627**DCL      5821>>ASSIGN   5848>>ASSIGN   5862>>ASSIGN   5878>>ASSIGN
UID
      4647**DCL      5824<>CALL     5827<<ASSIGN   5828<>CALL     5851<>CALL     5854<<ASSIGN   5855<>CALL
      5865<>CALL     5868<<ASSIGN   5869<>CALL     5881<>CALL     5884<<ASSIGN   5885<>CALL
VECT
      4634**DCL      5776<<ASSIGN   5777<<ASSIGN   5778<>CALL     5973<<ASSIGN   5974<>CALL
YESNO IN PROCEDURE DFEI
      5715**PROC     5703--CALL     5704--CALL

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:115  
      591        1        /*T***********************************************************/
      592        2        /*T*                                                         */
      593        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      594        4        /*T*                                                         */
      595        5        /*T***********************************************************/
      596        6        /*F*    NAME: DAD$TCTX
      597        7                PURPOSE: To process the TCTX command for the Host.
      598        8
      599        9        */
      600       10        DAD$TCTX: PROC(TOP);
      601       11
      602       12        /*X* PLM=3,IND=5,ECU=0,ENU=0,MOC   */
      603       13
      604       14        %INCLUDE CP_6;
      605     5573        %INCLUDE DA_FORMAT_C;
      606     5815        %INCLUDE DA_MONSYM_C;
      607     5866        %INCLUDE KI_MACROS_C;
      608     6474        %INCLUDE K_ADDRESS_M;
      609     6977        %INCLUDE K_INTERFACE_M;
      610     7386        %INCLUDE KN_DATA_M;
      611     9172        %INCLUDE XU_MACRO_C;
      612    12278        %INCLUDE DA_ANLZ_R;
      613    12291        %INCLUDE DA_MAP_R;
      614    12321
      615    12322        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
      616    12367        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      617    12412
      618    12413    1   DCL DAA$VALUE ENTRY(3) ALTRET;
      619    12414    1   DCL DAF$WRITE EPTR SYMREF;
      620    12415    1   DCL DAF$INIT ENTRY(1) ALTRET;
      621    12416    1   DCL DAM$MAP ENTRY(5) ALTRET;
      622    12417    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
      623    12418    1   DCL DAS$SDSRCHPTR ENTRY(2) ALTRET;
      624    12419
      625    12420
      626    12421        %REPORT (NAME=TCTXRPT1,TRUNC=YES,TABDFLT=5,HEADER=YES,TITLE='FEP Transport Context')
             12421            ;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:116  
      627    12487        %HEADER (LAST=NO,TEXT=
      628    12488        '$LS83-> TCTX# STATE    NODE LFEP DST_REF SENDN RECVN CLASS FLAGS   RSN ERR');
      629    12530        %HEADER (TEXT=
      630    12531        '------- ----- -------- ---- ---- ------- ----- ----- ----- ------- --- ---');
      631    12573    1   DCL 1 TCTX_FMT1 CHAR(0) CONSTANT INIT(
      632    12574    1   '.%6ZO %5D %A %4D %4D %7D %5D %5D %5D .%6ZO %3D %3D');
      633    12575
      634    12576
      635    12577        %K_TCTX_ST_TXT (FPTN=K_TCTX_STATE, STCLASS=STATIC);
      636    12594        %KI$TCTX_FLGS_TEXT (STCLASS=STATIC);
      637    12622        %KI$TCTX_OPTS_TEXT (STCLASS=STATIC);
      638    12650
      639    12651    1   DCL BAD_TCTX_ADDR CHAR(0) CONSTANT INIT(
      640    12652    1      'Invalid TCTX address');
      641    12653
      642    12654    1   DCL 1 KI_TCTX$$ CONSTANT,
      643    12655    1         2 * UBIN(9) UNAL INIT(9),
      644    12656    1         2 * CHAR(9) UNAL INIT('KI_TCTX$$');
      645    12657
      646    12658
      647    12659        /* AUTO Storage */
      648    12660        %KI$TCTX (NAME=K$TCTX,STCLASS="BASED(THIS_TCTX$)",ANLZ=YES);
      649    13218
      650    13219    1   DCL I SBIN;
      651    13220    1   DCL X UBIN;
      652    13221
      653    13222    1   DCL THIS_TCTX$ PTR;
      654    13223    1   DCL THIS_TCTX# REDEF THIS_TCTX$ UBIN;
      655    13224    1   DCL TCTX$$ PTR;
      656    13225    1   DCL TCTX## REDEF TCTX$$ UBIN;
      657    13226    1   DCL TCTX_MAX# UBIN;
      658    13227    1   DCL P$ PTR;
      659    13228    1   DCL 1 P$$ REDEF P$,
      660    13229    1         2 OFFSET UBIN(18) UNAL,
      661    13230    1         2 * UBIN(18) UNAL;
      662    13231    1   DCL P# UBIN;
      663    13232    1   DCL FLAGS UBIN(18);
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:117  
      664    13233    1   DCL LNK$ UBIN;
      665    13234    1   DCL ACTION UBIN;              /* 0 = display all     1 = display if in use    */
      666    13235    1   DCL ENTRY_TYPE UBIN;          /* 0 = display TCTXs     1 = check TCTX chain*/
      667    13236    1   DCL HEADER0 UBIN;
      668    13237
      669    13238    1   DCL 1 TCTXFLG,
      670    13239    1         2 F BIT(18) UNAL,
      671    13240    1         2 * BIT(18) UNAL;
      672    13241
      673    13242    1   DCL SBINWORD SBIN BASED;
      674    13243    1   DCL PTR$ PTR BASED;
      675    13244    1   DCL K$TCTX$(0:0) PTR BASED;
      676    13245
      677    13246        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:118  
      678    13247    1      ENTRY_TYPE=0/*display TCTXs*/;
      679    13248    1      GOTO TCTX_START;
      680    13249
      681    13250    1   DAD$TCTX_CHECK: ENTRY(TOP);
      682    13251    1      ENTRY_TYPE=1/*check TCTX chain*/;
      683    13252
      684    13253    1   TCTX_START: ;
      685    13254    1      HEADER0 = 0;
      686    13255
      687    13256    1      CALL DAS$SDMONPTR(%M#KI_TCTX_MAX#,P$) ALTRET(ALT);
      688    13257    1      CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);
      689    13258    1      TCTX_MAX# = P$->SBINWORD;
      690    13259
      691    13260    1      CALL DAS$SDSRCHPTR(KI_TCTX$$,TCTX$$) ALTRET(ALT);
      692    13261    1      CALL DAM$MAP(TCTX$$,TCTX$$,,,DA_MONISDATA) ALTRET(ALT);
      693    13262    1      TCTX$$ = TCTX$$->PTR$;
      694    13263    1      CALL DAM$MAP(TCTX$$,TCTX$$);
      695    13264
      696    13265    1      IF (ENTRY_TYPE=1/*if check*/)
      697    13266    2      THEN DO;
      698    13267    2   ALT:    ;
      699    13268    2           RETURN;
      700    13269    2           END/*do if check*/;
      701    13270
      702    13271        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:119  
      703    13272    1   DISPLAY_ALL: ;
      704    13273    1      IF TOP.NSUBLKS=0
      705    13274    2      THEN DO;
      706    13275    2           ACTION=1/*display all in use*/;
      707    13276    2   DISPLAY_LOOP: ;
      708    13277    3           DO I=1 TO TCTX_MAX#;
      709    13278    3                THIS_TCTX$ = TCTX$$->K$TCTX$(I);
      710    13279    3                THIS_TCTX# = I;
      711    13280    3                CALL DISP_TCTX;
      712    13281    3                END;
      713    13282    2           END;
      714    13283
      715    13284    2      ELSE DO;
      716    13285    3           DO X=0 TO TOP.NSUBLKS-1;
      717    13286    3                CALL DAA$VALUE(TOP.SUBLK$(X)->OUT,THIS_TCTX#)
      718    13287    4                WHENRETURN DO;
      719    13288    4                     IF THIS_TCTX# = 0
      720    13289    5                     THEN DO;
      721    13290    5                          ACTION=0/*display all*/;
      722    13291    5                          GOTO DISPLAY_LOOP;
      723    13292    5                          END;
      724    13293
      725    13294    4                     CALL DISP_TCTX
      726    13295    5                     WHENRETURN DO;
      727    13296    5                          IF TOP.NSUBLKS=1
      728    13297    6                          THEN DO;
      729    13298    6                               TCTXFLG.F = K$TCTX.FLAGS;
      730    13299    6                               KI$TCTX_FLGS_TEXT.SREST = 'set: ';
      731    13300    6                               CALL DAF$WRITE(VECTOR(KI$TCTX_FLGS_TEXT),VECTOR(TCTXFLG.
             13300                                        F));
      732    13301
      733    13302    6                               TCTXFLG.F = K$TCTX.SSN.TR_FLAGS;
      734    13303    6                               KI$TCTX_OPTS_TEXT.SREST = 'set: ';
      735    13304    6                               CALL DAF$WRITE(VECTOR(KI$TCTX_OPTS_TEXT),VECTOR(TCTXFLG.
             13304                                        F));
      736    13305    6                               END/*do if single display*/;
      737    13306    5                          END/*return from disp_tctx*/;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:120  
      738    13307    4                     END/*return from daa$value*/;
      739    13308
      740    13309    3                END/*do X=0 to nsublks-1*/;
      741    13310    2           END/*else do*/;
      742    13311
      743    13312
      744    13313    1      RETURN;
      745    13314
      746    13315        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:121  
      747    13316    1   DISP_TCTX: PROC ALTRET;
      748    13317
      749    13318    2      IF THIS_TCTX# <= TCTX_MAX#
      750    13319    3      THEN DO;
      751    13320    3           THIS_TCTX$ = TCTX$$->K$TCTX$(THIS_TCTX#);
      752    13321    3           P$ = THIS_TCTX$;
      753    13322    3           P# = P$$.OFFSET;
      754    13323    3           END;
      755    13324
      756    13325    2      IF THIS_TCTX# < TCTX##
      757    13326    3      THEN DO;
      758    13327    3   REPORT_BAD_TCTX: ;
      759    13328    3           CALL DAF$WRITE(VECTOR(BAD_TCTX_ADDR));
      760    13329    3           ALTRETURN;
      761    13330    3           END;
      762    13331
      763    13332    2      CALL DAM$MAP(THIS_TCTX$,THIS_TCTX$)
      764    13333    3      WHENALTRETURN DO; RETURN; END;
      765    13334
      766    13335    2      IF (ACTION=1/*display only in use*/)
      767    13336    3      THEN DO;
      768    13337    3           IF K$TCTX.STATE=%KI_TSTATE_NULL OR K$TCTX.STATE=%KI_TSTATE_CLOSED THEN
             13337                    RETURN;
      769    13338    3           END;
      770    13339
      771    13340    2      IF HEADER0 = 0
      772    13341    3      THEN DO;
      773    13342    3           CALL DAF$INIT(TCTXRPT1);
      774    13343    3           HEADER0 = 1;
      775    13344    3           END;
      776    13345
      777    13346    2      CALL DAF$WRITE(VECTOR(TCTX_FMT1),
      778    13347    2        VECTOR(P#),
      779    13348    2        VECTOR(K$TCTX.SRC_REF),
      780    13349    2        VECTOR(K_TCTX_STATE(K$TCTX.STATE)),
      781    13350    2        VECTOR(K$TCTX.NODE),
      782    13351    2        VECTOR(K$TCTX.LOCAL_FEP),
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:122  
      783    13352    2        VECTOR(K$TCTX.DST_REF),
      784    13353    2        VECTOR(K$TCTX.SEND_NEXT),
      785    13354    2        VECTOR(K$TCTX.RECV_NEXT),
      786    13355    2        VECTOR(K$TCTX.SSN.CLASS),
      787    13356    2        VECTOR(K$TCTX.FLAGS),
      788    13357    2        VECTOR(K$TCTX.REASON),
      789    13358    2        VECTOR(K$TCTX.ERR)  );
      790    13359
      791    13360    2   END DISP_TCTX;
      792    13361
      793    13362    1   END DAD$TCTX;
      794    13363        %EOD;

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:123  
--  Include file information  --

   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KN_DATA_M.:E05TOU  is referenced.
   K_INTERFACE_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$TCTX.

   Procedure DAD$TCTX requires 326 words for executable code.
   Procedure DAD$TCTX requires 84 words of local(AUTO) storage.

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:124  

 Object Unit name= DAD$TCTX                                   File name= DAD$ROUTE.:E05TOU
 UTS= JUL 29 '97 12:45:01.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   174    256  DAD$TCTX
    2  RoData even  UTS     23     27  DAD$TCTX
    3   Proc  even  none   326    506  DAD$TCTX
    4  RoData even  none    25     31  DAD$TCTX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DAD$TCTX
     3      4                  yes      Std        1  DAD$TCTX_CHECK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DAS$SDMONPTR
 yes     yes           Std       2 DAS$SDSRCHPTR
 yes     yes           Std       5 DAM$MAP
 yes     yes           Std       3 DAA$VALUE
 yes     yes           Std       1 DAF$INIT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:125  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DA_MONISDATA                          DAF$WRITE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:126  


      591        1        /*T***********************************************************/
      592        2        /*T*                                                         */
      593        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      594        4        /*T*                                                         */
      595        5        /*T***********************************************************/
      596        6        /*F*    NAME: DAD$TCTX
      597        7                PURPOSE: To process the TCTX command for the Host.
      598        8
      599        9        */
      600       10        DAD$TCTX: PROC(TOP);

     10  3 000000   000000 700200 xent  DAD$TCTX     TSX0  ! X66_AUTO_1
         3 000001   000124 000001                    ZERO    84,1

      601       11
      602       12        /*X* PLM=3,IND=5,ECU=0,ENU=0,MOC   */
      603       13
      604       14        %INCLUDE CP_6;
      605     5573        %INCLUDE DA_FORMAT_C;
      606     5815        %INCLUDE DA_MONSYM_C;
      607     5866        %INCLUDE KI_MACROS_C;
      608     6474        %INCLUDE K_ADDRESS_M;
      609     6977        %INCLUDE K_INTERFACE_M;
      610     7386        %INCLUDE KN_DATA_M;
      611     9172        %INCLUDE XU_MACRO_C;
      612    12278        %INCLUDE DA_ANLZ_R;
      613    12291        %INCLUDE DA_MAP_R;
      614    12321
      615    12322        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
      616    12367        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      617    12412
      618    12413    1   DCL DAA$VALUE ENTRY(3) ALTRET;
      619    12414    1   DCL DAF$WRITE EPTR SYMREF;
      620    12415    1   DCL DAF$INIT ENTRY(1) ALTRET;
      621    12416    1   DCL DAM$MAP ENTRY(5) ALTRET;
      622    12417    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:127  
      623    12418    1   DCL DAS$SDSRCHPTR ENTRY(2) ALTRET;
      624    12419
      625    12420
      626    12421       %REPORT (NAME=TCTXRPT1,TRUNC=YES,TABDFLT=5,HEADER=YES,TITLE='FEP Transport Context')
             12421            ;
      627    12487        %HEADER (LAST=NO,TEXT=
      628    12488        '$LS83-> TCTX# STATE    NODE LFEP DST_REF SENDN RECVN CLASS FLAGS   RSN ERR');
      629    12530        %HEADER (TEXT=
      630    12531        '------- ----- -------- ---- ---- ------- ----- ----- ----- ------- --- ---');
      631    12573    1   DCL 1 TCTX_FMT1 CHAR(0) CONSTANT INIT(
      632    12574    1   '.%6ZO %5D %A %4D %4D %7D %5D %5D %5D .%6ZO %3D %3D');
      633    12575
      634    12576
      635    12577        %K_TCTX_ST_TXT (FPTN=K_TCTX_STATE, STCLASS=STATIC);
      636    12594        %KI$TCTX_FLGS_TEXT (STCLASS=STATIC);
      637    12622        %KI$TCTX_OPTS_TEXT (STCLASS=STATIC);
      638    12650
      639    12651    1   DCL BAD_TCTX_ADDR CHAR(0) CONSTANT INIT(
      640    12652    1      'Invalid TCTX address');
      641    12653
      642    12654    1   DCL 1 KI_TCTX$$ CONSTANT,
      643    12655    1         2 * UBIN(9) UNAL INIT(9),
      644    12656    1         2 * CHAR(9) UNAL INIT('KI_TCTX$$');
      645    12657
      646    12658
      647    12659        /* AUTO Storage */
      648    12660        %KI$TCTX (NAME=K$TCTX,STCLASS="BASED(THIS_TCTX$)",ANLZ=YES);
      649    13218
      650    13219    1   DCL I SBIN;
      651    13220    1   DCL X UBIN;
      652    13221
      653    13222    1   DCL THIS_TCTX$ PTR;
      654    13223    1   DCL THIS_TCTX# REDEF THIS_TCTX$ UBIN;
      655    13224    1   DCL TCTX$$ PTR;
      656    13225    1   DCL TCTX## REDEF TCTX$$ UBIN;
      657    13226    1   DCL TCTX_MAX# UBIN;
      658    13227    1   DCL P$ PTR;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:128  
      659    13228    1   DCL 1 P$$ REDEF P$,
      660    13229    1         2 OFFSET UBIN(18) UNAL,
      661    13230    1         2 * UBIN(18) UNAL;
      662    13231    1   DCL P# UBIN;
      663    13232    1   DCL FLAGS UBIN(18);
      664    13233    1   DCL LNK$ UBIN;
      665    13234    1   DCL ACTION UBIN;              /* 0 = display all     1 = display if in use    */
      666    13235    1   DCL ENTRY_TYPE UBIN;          /* 0 = display TCTXs     1 = check TCTX chain*/
      667    13236    1   DCL HEADER0 UBIN;
      668    13237
      669    13238    1   DCL 1 TCTXFLG,
      670    13239    1         2 F BIT(18) UNAL,
      671    13240    1         2 * BIT(18) UNAL;
      672    13241
      673    13242    1   DCL SBINWORD SBIN BASED;
      674    13243    1   DCL PTR$ PTR BASED;
      675    13244    1   DCL K$TCTX$(0:0) PTR BASED;
      676    13245
      677    13246        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:129  
      678    13247    1      ENTRY_TYPE=0/*display TCTXs*/;

  13247  3 000002   200016 450100                    STZ     ENTRY_TYPE,,AUTO

      679    13248    1      GOTO TCTX_START;

  13248  3 000003   000010 710000 3                  TRA     TCTX_START

      680    13249
      681    13250    1   DAD$TCTX_CHECK: ENTRY(TOP);

  13250  3 000004   000000 700200 xent  DAD$TCTX_CH* TSX0  ! X66_AUTO_1
         3 000005   000124 000001                    ZERO    84,1

      682    13251    1      ENTRY_TYPE=1/*check TCTX chain*/;

  13251  3 000006   000001 235007                    LDA     1,DL
         3 000007   200016 755100                    STA     ENTRY_TYPE,,AUTO

  13251  3 000010                       TCTX_START   null
      683    13252
      684    13253    1   TCTX_START: ;
      685    13254    1      HEADER0 = 0;

  13254  3 000010   200017 450100                    STZ     HEADER0,,AUTO

      686    13255
      687    13256    1      CALL DAS$SDMONPTR(%M#KI_TCTX_MAX#,P$) ALTRET(ALT);

  13256  3 000011   200011 630500                    EPPR0   P$,,AUTO
         3 000012   200025 450500                    STP0    TCTXFLG+5,,AUTO
         3 000013   000001 236000 4                  LDQ     1
         3 000014   200024 756100                    STQ     TCTXFLG+4,,AUTO
         3 000015   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000017   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000020   000104 702000 3                  TSX2    ALT
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:130  

      688    13257    1      CALL DAM$MAP(P$,P$,,,DA_MONISDATA) ALTRET(ALT);

  13257  3 000021   000002 236000 4                  LDQ     2
         3 000022   200030 756100                    STQ     TCTXFLG+8,,AUTO
         3 000023   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000024   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000025   200026 757100                    STAQ    TCTXFLG+6,,AUTO
         3 000026   200011 630500                    EPPR0   P$,,AUTO
         3 000027   200025 450500                    STP0    TCTXFLG+5,,AUTO
         3 000030   200011 631500                    EPPR1   P$,,AUTO
         3 000031   200024 451500                    STP1    TCTXFLG+4,,AUTO
         3 000032   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000033   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000034   000000 701000 xent               TSX1    DAM$MAP
         3 000035   000104 702000 3                  TSX2    ALT

      689    13258    1      TCTX_MAX# = P$->SBINWORD;

  13258  3 000036   200011 470500                    LDP0    P$,,AUTO
         3 000037   000000 235100                    LDA     0,,PR0
         3 000040   200010 755100                    STA     TCTX_MAX#,,AUTO

      690    13259
      691    13260    1      CALL DAS$SDSRCHPTR(KI_TCTX$$,TCTX$$) ALTRET(ALT);

  13260  3 000041   200007 631500                    EPPR1   TCTX$$,,AUTO
         3 000042   200025 451500                    STP1    TCTXFLG+5,,AUTO
         3 000043   000003 236000 4                  LDQ     3
         3 000044   200024 756100                    STQ     TCTXFLG+4,,AUTO
         3 000045   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000047   000000 701000 xent               TSX1    DAS$SDSRCHPTR
         3 000050   000104 702000 3                  TSX2    ALT

      692    13261    1      CALL DAM$MAP(TCTX$$,TCTX$$,,,DA_MONISDATA) ALTRET(ALT);

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:131  
  13261  3 000051   000002 236000 4                  LDQ     2
         3 000052   200030 756100                    STQ     TCTXFLG+8,,AUTO
         3 000053   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000054   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000055   200026 757100                    STAQ    TCTXFLG+6,,AUTO
         3 000056   200007 630500                    EPPR0   TCTX$$,,AUTO
         3 000057   200025 450500                    STP0    TCTXFLG+5,,AUTO
         3 000060   200007 631500                    EPPR1   TCTX$$,,AUTO
         3 000061   200024 451500                    STP1    TCTXFLG+4,,AUTO
         3 000062   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000063   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000064   000000 701000 xent               TSX1    DAM$MAP
         3 000065   000104 702000 3                  TSX2    ALT

      693    13262    1      TCTX$$ = TCTX$$->PTR$;

  13262  3 000066   200007 470500                    LDP0    TCTX$$,,AUTO
         3 000067   000000 236100                    LDQ     0,,PR0
         3 000070   200007 756100                    STQ     TCTX$$,,AUTO

      694    13263    1      CALL DAM$MAP(TCTX$$,TCTX$$);

  13263  3 000071   200007 630500                    EPPR0   TCTX$$,,AUTO
         3 000072   200025 450500                    STP0    TCTXFLG+5,,AUTO
         3 000073   200007 631500                    EPPR1   TCTX$$,,AUTO
         3 000074   200024 451500                    STP1    TCTXFLG+4,,AUTO
         3 000075   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000076   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000077   000000 701000 xent               TSX1    DAM$MAP
         3 000100   000000 011000                    NOP     0

      695    13264
      696    13265    1      IF (ENTRY_TYPE=1/*if check*/)

  13265  3 000101   200016 235100                    LDA     ENTRY_TYPE,,AUTO
         3 000102   000001 115007                    CMPA    1,DL
         3 000103   000105 601000 3                  TNZ     DISPLAY_ALL
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:132  

      697    13266    2      THEN DO;

  13261  3 000104                       ALT          null
      698    13267    2   ALT:    ;
      699    13268    2           RETURN;

  13268  3 000104   000000 702200 xent               TSX2  ! X66_ARET

  13265  3 000105                       DISPLAY_ALL  null
      700    13269    2           END/*do if check*/;
      701    13270
      702    13271        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:133  
      703    13272    1   DISPLAY_ALL: ;
      704    13273    1      IF TOP.NSUBLKS=0

  13273  3 000105   200003 470500                    LDP0    @TOP,,AUTO
         3 000106   000001 220100                    LDX0    1,,PR0
         3 000107   000133 601000 3                  TNZ     s:13285

      705    13274    2      THEN DO;

      706    13275    2           ACTION=1/*display all in use*/;

  13275  3 000110   000001 236007                    LDQ     1,DL
         3 000111   200015 756100                    STQ     ACTION,,AUTO

  13275  3 000112                       DISPLAY_LOOP null
      707    13276    2   DISPLAY_LOOP: ;
      708    13277    3           DO I=1 TO TCTX_MAX#;

  13277  3 000112   000001 235007                    LDA     1,DL
         3 000113   200004 755100                    STA     I,,AUTO
         3 000114   000126 710000 3                  TRA     s:13281+1

      709    13278    3                THIS_TCTX$ = TCTX$$->K$TCTX$(I);

  13278  3 000115   200007 470500                    LDP0    TCTX$$,,AUTO
         3 000116   200004 720100                    LXL0    I,,AUTO
         3 000117   000000 236110                    LDQ     0,X0,PR0
         3 000120   200006 756100                    STQ     THIS_TCTX$,,AUTO

      710    13279    3                THIS_TCTX# = I;

  13279  3 000121   200004 235100                    LDA     I,,AUTO
         3 000122   200006 755100                    STA     THIS_TCTX$,,AUTO

      711    13280    3                CALL DISP_TCTX;

  13280  3 000123   000243 701000 3                  TSX1    DISP_TCTX
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:134  
         3 000124   000000 011000                    NOP     0

      712    13281    3                END;

  13281  3 000125   200004 054100                    AOS     I,,AUTO
         3 000126   200010 236100                    LDQ     TCTX_MAX#,,AUTO
         3 000127   000115 604000 3                  TMI     s:13278
         3 000130   200004 116100                    CMPQ    I,,AUTO
         3 000131   000115 605000 3                  TPL     s:13278

      713    13282    2           END;

  13282  3 000132   000242 710000 3                  TRA     s:13313

      714    13283
      715    13284    2      ELSE DO;

      716    13285    3           DO X=0 TO TOP.NSUBLKS-1;

  13285  3 000133   200005 450100                    STZ     X,,AUTO
         3 000134   000234 710000 3                  TRA     s:13309+3

      717    13286    3                CALL DAA$VALUE(TOP.SUBLK$(X)->OUT,THIS_TCTX#)

  13286  3 000135   200003 470500                    LDP0    @TOP,,AUTO
         3 000136   200005 720100                    LXL0    X,,AUTO
         3 000137   000003 471510                    LDP1    3,X0,PR0
         3 000140   200006 633500                    EPPR3   THIS_TCTX$,,AUTO
         3 000141   200025 453500                    STP3    TCTXFLG+5,,AUTO
         3 000142   200024 451500                    STP1    TCTXFLG+4,,AUTO
         3 000143   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000144   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000145   000000 701000 xent               TSX1    DAA$VALUE
         3 000146   000231 702000 3                  TSX2    s:13309

      718    13287    4                WHENRETURN DO;

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:135  
      719    13288    4                     IF THIS_TCTX# = 0

  13288  3 000147   200006 235100                    LDA     THIS_TCTX$,,AUTO
         3 000150   000153 601000 3                  TNZ     s:13294

      720    13289    5                     THEN DO;

      721    13290    5                          ACTION=0/*display all*/;

  13290  3 000151   200015 450100                    STZ     ACTION,,AUTO

      722    13291    5                          GOTO DISPLAY_LOOP;

  13291  3 000152   000112 710000 3                  TRA     DISPLAY_LOOP

      723    13292    5                          END;
      724    13293
      725    13294    4                     CALL DISP_TCTX

  13294  3 000153   000243 701000 3                  TSX1    DISP_TCTX
         3 000154   000231 702000 3                  TSX2    s:13309

      726    13295    5                     WHENRETURN DO;

      727    13296    5                          IF TOP.NSUBLKS=1

  13296  3 000155   200003 470500                    LDP0    @TOP,,AUTO
         3 000156   000001 220100                    LDX0    1,,PR0
         3 000157   000001 100003                    CMPX0   1,DU
         3 000160   000231 601000 3                  TNZ     s:13309

      728    13297    6                          THEN DO;

      729    13298    6                               TCTXFLG.F = K$TCTX.FLAGS;

  13298  3 000161   200006 471500                    LDP1    THIS_TCTX$,,AUTO
         3 000162   100002 721100                    LXL1    2,,PR1
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:136  
         3 000163   200020 741100                    STX1    TCTXFLG,,AUTO

      730    13299    6                               KI$TCTX_FLGS_TEXT.SREST = 'set: ';

  13299  3 000164   040000 100400                    MLR     fill='040'O
         3 000165   000025 000005 2                  ADSC9   KI_TCTX$$+3              cn=0,n=5
         3 000166   000125 400007 1                  ADSC9   KI$TCTX_FLGS_TEXT+1      cn=2,n=7

      731    13300    6                              CALL DAF$WRITE(VECTOR(KI$TCTX_FLGS_TEXT),VECTOR(TCTXFLG.
             13300                                        F));

  13300  3 000167   377640 235007                    LDA     130976,DL
         3 000170   200024 452500                    STP2    TCTXFLG+4,,AUTO
         3 000171   200024 236100                    LDQ     TCTXFLG+4,,AUTO
         3 000172   000020 036003                    ADLQ    16,DU
         3 000173   200026 757100                    STAQ    TCTXFLG+6,,AUTO
         3 000174   200026 633500                    EPPR3   TCTXFLG+6,,AUTO
         3 000175   200031 453500                    STP3    TCTXFLG+9,,AUTO
         3 000176   000006 236000 4                  LDQ     6
         3 000177   200030 756100                    STQ     TCTXFLG+8,,AUTO
         3 000200   200030 630500                    EPPR0   TCTXFLG+8,,AUTO
         3 000201   000000 220000 xsym               LDX0    DAF$WRITE
         3 000202   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000203   000000 701010                    TSX1    0,X0
         3 000204   000000 011000                    NOP     0

      732    13301
      733    13302    6                               TCTXFLG.F = K$TCTX.SSN.TR_FLAGS;

  13302  3 000205   200006 470500                    LDP0    THIS_TCTX$,,AUTO
         3 000206   000016 720100                    LXL0    14,,PR0
         3 000207   200020 740100                    STX0    TCTXFLG,,AUTO

      734    13303    6                               KI$TCTX_OPTS_TEXT.SREST = 'set: ';

  13303  3 000210   040000 100400                    MLR     fill='040'O
         3 000211   000025 000005 2                  ADSC9   KI_TCTX$$+3              cn=0,n=5
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:137  
         3 000212   000201 000007 1                  ADSC9   KI$TCTX_OPTS_TEXT+2      cn=0,n=7

      735    13304    6                              CALL DAF$WRITE(VECTOR(KI$TCTX_OPTS_TEXT),VECTOR(TCTXFLG.
             13304                                        F));

  13304  3 000213   377640 235007                    LDA     130976,DL
         3 000214   200024 452500                    STP2    TCTXFLG+4,,AUTO
         3 000215   200024 236100                    LDQ     TCTXFLG+4,,AUTO
         3 000216   000020 036003                    ADLQ    16,DU
         3 000217   200026 757100                    STAQ    TCTXFLG+6,,AUTO
         3 000220   200026 631500                    EPPR1   TCTXFLG+6,,AUTO
         3 000221   200031 451500                    STP1    TCTXFLG+9,,AUTO
         3 000222   000012 236000 4                  LDQ     10
         3 000223   200030 756100                    STQ     TCTXFLG+8,,AUTO
         3 000224   200030 630500                    EPPR0   TCTXFLG+8,,AUTO
         3 000225   000000 221000 xsym               LDX1    DAF$WRITE
         3 000226   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000227   000000 701011                    TSX1    0,X1
         3 000230   000000 011000                    NOP     0

      736    13305    6                               END/*do if single display*/;

      737    13306    5                          END/*return from disp_tctx*/;

      738    13307    4                     END/*return from daa$value*/;

      739    13308
      740    13309    3                END/*do X=0 to nsublks-1*/;

  13309  3 000231   200005 235100                    LDA     X,,AUTO
         3 000232   000001 035007                    ADLA    1,DL
         3 000233   200005 755100                    STA     X,,AUTO
         3 000234   200003 470500                    LDP0    @TOP,,AUTO
         3 000235   000001 236100                    LDQ     1,,PR0
         3 000236   000022 772000                    QRL     18
         3 000237   200005 116100                    CMPQ    X,,AUTO
         3 000240   000242 600000 3                  TZE     s:13313
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:138  
         3 000241   000135 603000 3                  TRC     s:13286

      741    13310    2           END/*else do*/;

      742    13311
      743    13312
      744    13313    1      RETURN;

  13313  3 000242   000000 702200 xent               TSX2  ! X66_ARET

      745    13314
      746    13315        %EJECT;
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:139  
      747    13316    1   DISP_TCTX: PROC ALTRET;

  13316  3 000243   200022 741300       DISP_TCTX    STX1  ! TCTXFLG+2,,AUTO

      748    13317
      749    13318    2      IF THIS_TCTX# <= TCTX_MAX#

  13318  3 000244   200010 236100                    LDQ     TCTX_MAX#,,AUTO
         3 000245   200006 116100                    CMPQ    THIS_TCTX$,,AUTO
         3 000246   000257 602000 3                  TNC     s:13325

      750    13319    3      THEN DO;

      751    13320    3           THIS_TCTX$ = TCTX$$->K$TCTX$(THIS_TCTX#);

  13320  3 000247   200007 470500                    LDP0    TCTX$$,,AUTO
         3 000250   200006 720100                    LXL0    THIS_TCTX$,,AUTO
         3 000251   000000 236110                    LDQ     0,X0,PR0
         3 000252   200006 756100                    STQ     THIS_TCTX$,,AUTO

      752    13321    3           P$ = THIS_TCTX$;

  13321  3 000253   200011 756100                    STQ     P$,,AUTO

      753    13322    3           P# = P$$.OFFSET;

  13322  3 000254   200011 235100                    LDA     P$,,AUTO
         3 000255   000022 771000                    ARL     18
         3 000256   200012 755100                    STA     P#,,AUTO

      754    13323    3           END;

      755    13324
      756    13325    2      IF THIS_TCTX# < TCTX##

  13325  3 000257   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000260   200007 116100                    CMPQ    TCTX$$,,AUTO
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:140  
         3 000261   000271 603000 3                  TRC     s:13332

      757    13326    3      THEN DO;

  13322  3 000262                       REPORT_BAD_* null
      758    13327    3   REPORT_BAD_TCTX: ;
      759    13328    3           CALL DAF$WRITE(VECTOR(BAD_TCTX_ADDR));

  13328  3 000262   000016 630400 4                  EPPR0   14
         3 000263   000000 220000 xsym               LDX0    DAF$WRITE
         3 000264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000265   000000 701010                    TSX1    0,X0
         3 000266   000000 011000                    NOP     0

      760    13329    3           ALTRETURN;

  13329  3 000267   200022 221300                    LDX1  ! TCTXFLG+2,,AUTO
         3 000270   000000 702211                    TSX2  ! 0,X1

      761    13330    3           END;
      762    13331
      763    13332    2      CALL DAM$MAP(THIS_TCTX$,THIS_TCTX$)

  13332  3 000271   200006 630500                    EPPR0   THIS_TCTX$,,AUTO
         3 000272   200025 450500                    STP0    TCTXFLG+5,,AUTO
         3 000273   200006 631500                    EPPR1   THIS_TCTX$,,AUTO
         3 000274   200024 451500                    STP1    TCTXFLG+4,,AUTO
         3 000275   200024 630500                    EPPR0   TCTXFLG+4,,AUTO
         3 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000277   000000 701000 xent               TSX1    DAM$MAP
         3 000300   000302 702000 3                  TSX2    s:13333
         3 000301   000304 710000 3                  TRA     s:13335

      764    13333    3      WHENALTRETURN DO; RETURN; END;

  13333  3 000302   200022 221300                    LDX1  ! TCTXFLG+2,,AUTO
         3 000303   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:141  

      765    13334
      766    13335    2      IF (ACTION=1/*display only in use*/)

  13335  3 000304   200015 235100                    LDA     ACTION,,AUTO
         3 000305   000001 115007                    CMPA    1,DL
         3 000306   000321 601000 3                  TNZ     s:13340

      767    13336    3      THEN DO;

      768    13337    3           IF K$TCTX.STATE=%KI_TSTATE_NULL OR K$TCTX.STATE=%KI_TSTATE_CLOSED THEN
             13337                    RETURN;

  13337  3 000307   200006 470500                    LDP0    THIS_TCTX$,,AUTO
         3 000310   000000 236100                    LDQ     0,,PR0
         3 000311   777000 316003                    CANQ    -512,DU
         3 000312   000317 600000 3                  TZE     s:13337+8
         3 000313   000000 236100                    LDQ     0,,PR0
         3 000314   777000 376003                    ANQ     -512,DU
         3 000315   002000 116003                    CMPQ    1024,DU
         3 000316   000321 601000 3                  TNZ     s:13340

  13337  3 000317   200022 221300                    LDX1  ! TCTXFLG+2,,AUTO
         3 000320   000001 702211                    TSX2  ! 1,X1

      769    13338    3           END;
      770    13339
      771    13340    2      IF HEADER0 = 0

  13340  3 000321   200017 236100                    LDQ     HEADER0,,AUTO
         3 000322   000331 601000 3                  TNZ     s:13353

      772    13341    3      THEN DO;

      773    13342    3           CALL DAF$INIT(TCTXRPT1);

  13342  3 000323   000017 630400 4                  EPPR0   15
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:142  
         3 000324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000325   000000 701000 xent               TSX1    DAF$INIT
         3 000326   000000 011000                    NOP     0

      774    13343    3           HEADER0 = 1;

  13343  3 000327   000001 235007                    LDA     1,DL
         3 000330   200017 755100                    STA     HEADER0,,AUTO

      775    13344    3           END;

      776    13345
      777    13346    2      CALL DAF$WRITE(VECTOR(TCTX_FMT1),
      778    13347    2        VECTOR(P#),
      779    13348    2        VECTOR(K$TCTX.SRC_REF),
      780    13349    2        VECTOR(K_TCTX_STATE(K$TCTX.STATE)),
      781    13350    2        VECTOR(K$TCTX.NODE),
      782    13351    2        VECTOR(K$TCTX.LOCAL_FEP),
      783    13352    2        VECTOR(K$TCTX.DST_REF),
      784    13353    2        VECTOR(K$TCTX.SEND_NEXT),

  13353  3 000331   777640 235007                    LDA     -96,DL
         3 000332   200024 452500                    STP2    TCTXFLG+4,,AUTO
         3 000333   200024 236100                    LDQ     TCTXFLG+4,,AUTO
         3 000334   000012 036003                    ADLQ    10,DU
         3 000335   200026 757100                    STAQ    TCTXFLG+6,,AUTO
         3 000336   377640 235007                    LDA     130976,DL
         3 000337   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000340   000022 036000 4                  ADLQ    18
         3 000341   200006 470500                    LDP0    THIS_TCTX$,,AUTO
         3 000342   200030 757100                    STAQ    TCTXFLG+8,,AUTO
         3 000343   000000 236100                    LDQ     0,,PR0
         3 000344   000033 772000                    QRL     27
         3 000345   000023 235000 4                  LDA     19
         3 000346   000023 736000                    QLS     19
         3 000347   000024 036000 4                  ADLQ    20
         3 000350   200032 757100                    STAQ    TCTXFLG+10,,AUTO
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:143  
         3 000351   177640 235007                    LDA     65440,DL
         3 000352   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000353   200000 036007                    ADLQ    65536,DL
         3 000354   200034 757100                    STAQ    TCTXFLG+12,,AUTO
         3 000355   177640 235007                    LDA     65440,DL
         3 000356   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000357   000002 036003                    ADLQ    2,DU
         3 000360   200036 757100                    STAQ    TCTXFLG+14,,AUTO
         3 000361   377640 235007                    LDA     130976,DL
         3 000362   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000363   000001 036003                    ADLQ    1,DU
         3 000364   200040 757100                    STAQ    TCTXFLG+16,,AUTO
         3 000365   777640 235007                    LDA     -96,DL
         3 000366   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000367   000006 036003                    ADLQ    6,DU
         3 000370   200042 757100                    STAQ    TCTXFLG+18,,AUTO
         3 000371   777640 235007                    LDA     -96,DL
         3 000372   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000373   000004 036003                    ADLQ    4,DU
         3 000374   200044 757100                    STAQ    TCTXFLG+20,,AUTO
         3 000375   177640 235007                    LDA     65440,DL
         3 000376   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000377   000025 036000 4                  ADLQ    21
         3 000400   200046 757100                    STAQ    TCTXFLG+22,,AUTO
         3 000401   377640 235007                    LDA     130976,DL
         3 000402   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000403   000026 036000 4                  ADLQ    22
         3 000404   200050 757100                    STAQ    TCTXFLG+24,,AUTO
         3 000405   177640 235007                    LDA     65440,DL
         3 000406   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000407   400000 036007                    ADLQ    -131072,DL
         3 000410   200052 757100                    STAQ    TCTXFLG+26,,AUTO
         3 000411   177640 235007                    LDA     65440,DL
         3 000412   200006 236100                    LDQ     THIS_TCTX$,,AUTO
         3 000413   600000 036007                    ADLQ    -65536,DL
         3 000414   200056 757100                    STAQ    TCTXFLG+30,,AUTO
         3 000415   200026 237100                    LDAQ    TCTXFLG+6,,AUTO
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:144  
         3 000416   200054 757100                    STAQ    TCTXFLG+28,,AUTO
         3 000417   200030 237100                    LDAQ    TCTXFLG+8,,AUTO
         3 000420   200060 757100                    STAQ    TCTXFLG+32,,AUTO
         3 000421   200032 237100                    LDAQ    TCTXFLG+10,,AUTO
         3 000422   200062 757100                    STAQ    TCTXFLG+34,,AUTO
         3 000423   200034 237100                    LDAQ    TCTXFLG+12,,AUTO
         3 000424   200064 757100                    STAQ    TCTXFLG+36,,AUTO
         3 000425   200036 237100                    LDAQ    TCTXFLG+14,,AUTO
         3 000426   200066 757100                    STAQ    TCTXFLG+38,,AUTO
         3 000427   200040 237100                    LDAQ    TCTXFLG+16,,AUTO
         3 000430   200070 757100                    STAQ    TCTXFLG+40,,AUTO
         3 000431   200042 237100                    LDAQ    TCTXFLG+18,,AUTO
         3 000432   200072 757100                    STAQ    TCTXFLG+42,,AUTO
         3 000433   200044 237100                    LDAQ    TCTXFLG+20,,AUTO
         3 000434   200074 757100                    STAQ    TCTXFLG+44,,AUTO
         3 000435   200046 237100                    LDAQ    TCTXFLG+22,,AUTO
         3 000436   200076 757100                    STAQ    TCTXFLG+46,,AUTO
         3 000437   200050 237100                    LDAQ    TCTXFLG+24,,AUTO
         3 000440   200100 757100                    STAQ    TCTXFLG+48,,AUTO
         3 000441   200052 237100                    LDAQ    TCTXFLG+26,,AUTO
         3 000442   200102 757100                    STAQ    TCTXFLG+50,,AUTO
         3 000443   200056 237100                    LDAQ    TCTXFLG+30,,AUTO
         3 000444   200104 757100                    STAQ    TCTXFLG+52,,AUTO
         3 000445   200104 631500                    EPPR1   TCTXFLG+52,,AUTO
         3 000446   200122 451500                    STP1    TCTXFLG+66,,AUTO
         3 000447   200102 633500                    EPPR3   TCTXFLG+50,,AUTO
         3 000450   200121 453500                    STP3    TCTXFLG+65,,AUTO
         3 000451   200100 634500                    EPPR4   TCTXFLG+48,,AUTO
         3 000452   200120 454500                    STP4    TCTXFLG+64,,AUTO
         3 000453   200076 635500                    EPPR5   TCTXFLG+46,,AUTO
         3 000454   200117 455500                    STP5    TCTXFLG+63,,AUTO
         3 000455   200074 636500                    EPPR6   TCTXFLG+44,,AUTO
         3 000456   200116 456500                    STP6    TCTXFLG+62,,AUTO
         3 000457   200072 637500                    EPPR7   TCTXFLG+42,,AUTO
         3 000460   200115 457500                    STP7    TCTXFLG+61,,AUTO
         3 000461   200070 630500                    EPPR0   TCTXFLG+40,,AUTO
         3 000462   200114 450500                    STP0    TCTXFLG+60,,AUTO
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:145  
         3 000463   200066 630500                    EPPR0   TCTXFLG+38,,AUTO
         3 000464   200113 450500                    STP0    TCTXFLG+59,,AUTO
         3 000465   200064 630500                    EPPR0   TCTXFLG+36,,AUTO
         3 000466   200112 450500                    STP0    TCTXFLG+58,,AUTO
         3 000467   200062 630500                    EPPR0   TCTXFLG+34,,AUTO
         3 000470   200111 450500                    STP0    TCTXFLG+57,,AUTO
         3 000471   200060 630500                    EPPR0   TCTXFLG+32,,AUTO
         3 000472   200110 450500                    STP0    TCTXFLG+56,,AUTO
         3 000473   200054 630500                    EPPR0   TCTXFLG+28,,AUTO
         3 000474   200107 450500                    STP0    TCTXFLG+55,,AUTO
         3 000475   000030 236000 4                  LDQ     24
         3 000476   200106 756100                    STQ     TCTXFLG+54,,AUTO
         3 000477   200106 630500                    EPPR0   TCTXFLG+54,,AUTO
         3 000500   000000 220000 xsym               LDX0    DAF$WRITE
         3 000501   000027 631400 4                  EPPR1   23
         3 000502   000000 701010                    TSX1    0,X0
         3 000503   000000 011000                    NOP     0

      785    13354    2        VECTOR(K$TCTX.RECV_NEXT),
      786    13355    2        VECTOR(K$TCTX.SSN.CLASS),
      787    13356    2        VECTOR(K$TCTX.FLAGS),
      788    13357    2        VECTOR(K$TCTX.REASON),
      789    13358    2        VECTOR(K$TCTX.ERR)  );
      790    13359
      791    13360    2   END DISP_TCTX;

  13360  3 000504   200022 221300                    LDX1  ! TCTXFLG+2,,AUTO
         3 000505   000001 702211                    TSX2  ! 1,X1
      792    13361
      793    13362    1   END DAD$TCTX;
      794    13363        %EOD;

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:146  
--  Include file information  --

   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KN_DATA_M.:E05TOU  is referenced.
   K_INTERFACE_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$TCTX.
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:147  

 **** Variables and constants ****

  ****  Section 001  Data  DAD$TCTX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   124-0-0/c STRC(1530)  r     1 KI$TCTX_FLGS_TEXT        177-0-0/c STRC(1692)  r     1 KI$TCTX_OPTS_TEXT
    74-0-0/c CHAR(8)     r     1 K_TCTX_STATE(0:11)
     0-0-0/w STRC(288)   r     1 TCTXRPT1                  16-0-0/w STRC(144)   r     1 TCTXRPT1HD00
    45-0-0/w STRC(144)   r     1 TCTXRPT1HD01              10-0-0/c STRC(198)   r     1 TCTXRPT1TX00
    22-0-0/c STRC(675)   r     1 TCTXRPT1TX01              51-0-0/c STRC(675)   r     1 TCTXRPT1TX02

  ****  Section 002 RoData DAD$TCTX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/c CHAR(20)    r     1 BAD_TCTX_ADDR             22-0-0/c STRC(90)    r     1 KI_TCTX$$
     0-0-0/c CHAR(50)    r     1 TCTX_FMT1

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP                      15-0-0/w UBIN        r     1 ACTION
    16-0-0/w UBIN        r     1 ENTRY_TYPE                17-0-0/w UBIN        r     1 HEADER0
     4-0-0/w SBIN        r     1 I                         12-0-0/w UBIN        r     1 P#
    11-0-0/w PTR         r     1 P$                        11-0-0/w STRC        r     1 P$$
     7-0-0/w UBIN        r     1 TCTX##                     7-0-0/w PTR         r     1 TCTX$$
    20-0-0/b STRC        r     1 TCTXFLG                   10-0-0/w UBIN        r     1 TCTX_MAX#
     6-0-0/w UBIN        r     1 THIS_TCTX#                 6-0-0/w PTR         r     1 THIS_TCTX$
    *0-0-0/w STRC(144)   r     1 TOP                        5-0-0/w UBIN        r     1 X

  ****  SYMREF variables  ****

PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:148  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/b BIT (72)    r     1 DA_MONISDATA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1620)  r     1 K$TCTX
     0-0-0/w PTR         r     1 K$TCTX$(0:0)
     0-0-0/w STRC(144)   r     1 OUT                        0-0-0/w PTR         r     1 PTR$
     0-0-0/w SBIN        r     1 SBINWORD


   Procedure DAD$TCTX requires 326 words for executable code.
   Procedure DAD$TCTX requires 84 words of local(AUTO) storage.
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:149  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:150  
          MINI XREF LISTING

ACTION
     13234**DCL     13275<<ASSIGN  13290<<ASSIGN  13335>>IF
ALT
     13261**LABEL   13256--CALLALT 13257--CALLALT 13260--CALLALT 13261--CALLALT
BAD_TCTX_ADDR
     12651**DCL     13328--CALL
DAA$VALUE
     12413**DCL-ENT 13286--CALL
DAF$INIT
     12415**DCL-ENT 13342--CALL
DAF$WRITE
     12414**DCL     13300>>CALL    13304>>CALL    13328>>CALL    13353>>CALL
DAM$MAP
     12416**DCL-ENT 13257--CALL    13261--CALL    13263--CALL    13332--CALL
DAS$SDMONPTR
     12417**DCL-ENT 13256--CALL
DAS$SDSRCHPTR
     12418**DCL-ENT 13260--CALL
DA_MAPSEG.P
     12316**DCL     12317--REDEF
DA_MONISDATA
     12309**DCL     13257<>CALL    13261<>CALL
DA_SDASN.DESC.TYPE0
     12301**DCL     12301--REDEF
DA_TIGRSEG.P
     12317**DCL     12318--REDEF
DISPLAY_LOOP
     13275**LABEL   13291--GOTO
DISP_TCTX
     13316**PROC    13280--CALL    13294--CALL
ENTRY_TYPE
     13235**DCL     13247<<ASSIGN  13251<<ASSIGN  13265>>IF
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:151  
HEADER0
     13236**DCL     13254<<ASSIGN  13340>>IF      13343<<ASSIGN
I
     13219**DCL     13277<<DOINDEX 13278>>ASSIGN  13279>>ASSIGN
K$TCTX.DST_REF
     12688**DCL     13353--CALL
K$TCTX.ERR
     12682**DCL     13353--CALL
K$TCTX.FLAGS
     12719**DCL     13298>>ASSIGN  13353--CALL
K$TCTX.LOCAL_FEP
     12704**DCL     13353--CALL
K$TCTX.NODE
     12668**DCL     13353--CALL
K$TCTX.REASON
     12676**DCL     13353--CALL
K$TCTX.RECV_NEXT
     12759**DCL     13353--CALL
K$TCTX.SEND_NEXT
     12772**DCL     13353--CALL
K$TCTX.SRC_REF
     12696**DCL     13353--CALL
K$TCTX.SSN.CLASS
     12850**DCL     13353--CALL
K$TCTX.SSN.DST_NSAP.ADDRESS_N
     13117**DCL     13118--REDEF
K$TCTX.SSN.SRC_NSAP.ADDRESS_N
     13057**DCL     13058--REDEF
K$TCTX.SSN.TPDUSIZE
     12820**DCL     12821--REDEF
K$TCTX.SSN.TR_FLAGS
     12857**DCL     13302>>ASSIGN
K$TCTX.STATE
     12662**DCL     13337>>IF      13337>>IF      13353>>CALL
K$TCTX$
     13244**DCL     13278>>ASSIGN  13320>>ASSIGN
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:152  
KI$TCTX_FLGS_TEXT
     12599**DCL     13300--CALL
KI$TCTX_FLGS_TEXT.SREST
     12601**DCL     13299<<ASSIGN
KI$TCTX_OPTS_TEXT
     12627**DCL     13304--CALL
KI$TCTX_OPTS_TEXT.SREST
     12629**DCL     13303<<ASSIGN
KI_TCTX$$
     12654**DCL     13260<>CALL
K_TCTX_STATE
     12586**DCL     13353--CALL
OUT
     12373**DCL     13286<>CALL
P#
     13231**DCL     13322<<ASSIGN  13353--CALL
P$
     13227**DCL     13228--REDEF   13256<>CALL    13257<>CALL    13257<>CALL    13258>>ASSIGN  13321<<ASSIGN
P$$.OFFSET
     13229**DCL     13322>>ASSIGN
PTR$
     13243**DCL     13262>>ASSIGN
SBINWORD
     13242**DCL     13258>>ASSIGN
TCTX##
     13225**DCL     13325>>IF
TCTX$$
     13224**DCL     13225--REDEF   13260<>CALL    13261<>CALL    13261<>CALL    13262<<ASSIGN  13262>>ASSIGN
     13263<>CALL    13263<>CALL    13278>>ASSIGN  13320>>ASSIGN
TCTXFLG.F
     13239**DCL     13298<<ASSIGN  13300--CALL    13302<<ASSIGN  13304--CALL
TCTXRPT1
     12438**DCL     13342<>CALL
TCTXRPT1HD00
     12505**DCL     12473--DCLINIT
TCTXRPT1HD01
PL6.E3A0      #002=DAD$TCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:153  
     12548**DCL     12520--DCLINIT
TCTXRPT1TX00
     12481**DCL     12468--DCLINIT
TCTXRPT1TX01
     12523**DCL     12513--DCLINIT
TCTXRPT1TX02
     12566**DCL     12556--DCLINIT
TCTX_FMT1
     12573**DCL     13353--CALL
TCTX_MAX#
     13226**DCL     13258<<ASSIGN  13277>>DOINDEX 13318>>IF
TCTX_START
     13251**LABEL   13248--GOTO
THIS_TCTX#
     13223**DCL     13279<<ASSIGN  13286<>CALL    13288>>IF      13318>>IF      13320>>ASSIGN  13325>>IF
THIS_TCTX$
     13222**DCL     12661--IMP-PTR 13223--REDEF   13278<<ASSIGN  13298>>ASSIGN  13302>>ASSIGN  13320<<ASSIGN
     13321>>ASSIGN  13332<>CALL    13332<>CALL    13337>>IF      13337>>IF      13353>>CALL    13353>>CALL
     13353>>CALL    13353>>CALL    13353>>CALL    13353>>CALL    13353>>CALL    13353>>CALL    13353>>CALL
     13353>>CALL    13353>>CALL
TOP
     12328**DCL        10--PROC    13250--ENTRY
TOP.NSUBLKS
     12340**DCL     13273>>IF      13285>>DOINDEX 13296>>IF
TOP.SUBLK$
     12361**DCL     13286>>CALL
X
     13220**DCL     13285<<DOINDEX 13286>>CALL

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:154  
      795        1        /*T***********************************************************/
      796        2        /*T*                                                         */
      797        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      798        4        /*T*                                                         */
      799        5        /*T***********************************************************/
      800        6        /*F*    NAME: DAD$SCTX
      801        7                PURPOSE: To process the SCTX command for the Host.
      802        8        */
      803        9        /*X* DDA */
      804       10        DAD$SCTX: PROC( TOP);
      805       11        %INCLUDE CP_6;
      806     5570        %INCLUDE CP_6_SUBS;
      807     6110        %INCLUDE DA_FORMAT_C;
      808     6352        %INCLUDE DA_MONSYM_C;
      809     6403        %INCLUDE DA_ANLZ_R;
      810     6416        %INCLUDE DA_MAP_R;
      811     6446        %INCLUDE K_ADDRESS_M;
      812     6949        %INCLUDE K_SESSION_M;
      813     7039            %KIS$APPL( NAME=APPL, STCLASS=BASED);
      814     7108        %INCLUDE XU_MACRO_C;
      815    10214            %PARSE$OUT( NAME=TOP, STCLASS=PARAM);
      816    10259            %PARSE$OUT( NAME=OUT, STCLASS=BASED);
      817    10304
      818    10305    1       DCL DAA$VALUE ENTRY(3) ALTRET;
      819    10306    1       DCL DAF$INIT ENTRY(1) ALTRET;
      820    10307    1       DCL DAF$WRITE EPTR SYMREF;
      821    10308    1       DCL DAM$MAP ENTRY(5) ALTRET;
      822    10309    1       DCL DAS$SDMONPTR ENTRY(2) ALTRET;
      823    10310
      824    10311    1       DCL B$HALF UBIN(18) BASED;
      825    10312    1       DCL B$PTR PTR BASED;
      826    10313    1       DCL B$SBIN SBIN BASED;
      827    10314    1       DCL DISPALL BIT(1);
      828    10315    1       DCL I SBIN;
      829    10316    1       DCL J SBIN;
      830    10317    1       DCL KIS_MAJOR$ PTR;
      831    10318    1       DCL KIS_MINOR$ PTR;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:155  
      832    10319    1       DCL KIS_SSN_CLIENTS SBIN;
      833    10320    1       DCL KIS_SSN_SERVERS SBIN;
      834    10321    1       DCL KIS_SSN_MAX SBIN;
      835    10322    1       DCL MAJCLNT# SBIN;
      836    10323    1       DCL MAJSRVR# SBIN;
      837    10324    1       DCL MINCLNT# SBIN;
      838    10325    1       DCL MINSRVR# SBIN;
      839    10326    1       DCL NEEDHDR BIT(1);
      840    10327    1       DCL P$ PTR;
      841    10328    1       DCL SCTX UBIN STATIC;
      842    10329    1       DCL SCTX_ VECTOR CONSTANT INIT( VECTOR( SCTX));
      843    10330    1       DCL TYPE CHAR(4) STATIC;
      844    10331    1       DCL TYPE_ VECTOR CONSTANT INIT( VECTOR( TYPE));
      845    10332    1       DCL X SBIN;
      846    10333
      847    10334            %REPORT( NAME=RPT, TRUNC=YES, TABDFLT=5, HEADER=YES,
      848    10335                     TITLE='Host OSI Session context');
      849    10401            %HEADER( LAST=NO, TEXT=
      850    10402        '$LS83-> SCTX TYPE  MajMin   SCID LDCTX AUDCT  USER TSAP/TCTX/Cookie');
      851    10444            %HEADER( TEXT=
      852    10445        '------- ---- ---- ------- ------ ----- ----- ----- -------------------------------'
             10445            );
      853    10487    1       DCL FMTMAJCLNT CHAR(0) CONSTANT INIT(
      854    10488    1   '.%6ZO %4D %A .%3ZO    %6D  .%3ZO        .%3ZO');
      855    10489    1       DCL FMTMAJCLNT_ VECTOR CONSTANT INIT( VECTOR( FMTMAJCLNT));
      856    10490    1       DCL FMTMAJSRVR CHAR(0) CONSTANT INIT(
      857    10491    1   '.%6ZO %4D %A .%3ZO    %6D  .%3ZO  .%3ZO  .%3ZO %A');
      858    10492    1       DCL FMTMAJSRVR_ VECTOR CONSTANT INIT( VECTOR( FMTMAJSRVR));
      859    10493    1       DCL FMTMIN CHAR(0) CONSTANT INIT(
      860    10494    1   '.%6ZO      %A .%3ZO%3ZO %6D                   TCTX=%D, Cookie=%D');
      861    10495    1       DCL FMTMIN_ VECTOR CONSTANT INIT( VECTOR( FMTMIN));
      862    10496    1       DCL FMTMAJSUM CHAR(0) CONSTANT INIT(
      863    10497    1   'Major Table: %D slots (%D Srvr, %D Clnt), %D in use (%D Srvr, %D Clnt), %D free');
      864    10498    1       DCL FMTMAJSUM_ VECTOR CONSTANT INIT( VECTOR( FMTMAJSUM));
      865    10499    1       DCL FMTMINSUM CHAR(0) CONSTANT INIT(
      866    10500    1   'Minor Table: %D slots (%D Srvr or Clnt), %D in use (%D Srvr, %D Clnt), %D free');
      867    10501    1       DCL FMTMINSUM_ VECTOR CONSTANT INIT( VECTOR( FMTMINSUM));
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:156  
      868    10502
      869    10503            /* get max number of clients */
      870    10504    1       CALL DAS$SDMONPTR( %M#KIS_SSN_CLIENTS, P$) ALTRET( DONE);
      871    10505    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);
      872    10506    1       KIS_SSN_CLIENTS = P$->B$SBIN;
      873    10507            /* get max number of servers */
      874    10508    1       CALL DAS$SDMONPTR( %M#KIS_SSN_SERVERS, P$) ALTRET( DONE);
      875    10509    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);
      876    10510    1       KIS_SSN_SERVERS = P$->B$SBIN;
      877    10511            /* get max number of connections */
      878    10512    1       CALL DAS$SDMONPTR( %M#KIS_SSN_MAX, P$) ALTRET( DONE);
      879    10513    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);
      880    10514    1       KIS_SSN_MAX = P$->B$SBIN;
      881    10515            /* get ptr to major table */
      882    10516    1       CALL DAS$SDMONPTR( %M#KIS_MAJOR$, P$) ALTRET( DONE);
      883    10517    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);
      884    10518    1       KIS_MAJOR$ = P$->B$PTR;
      885    10519    1       CALL DAM$MAP( KIS_MAJOR$, KIS_MAJOR$);
      886    10520            /* get ptr to minor table */
      887    10521    1       CALL DAS$SDMONPTR( %M#KIS_MINOR$, P$) ALTRET( DONE);
      888    10522    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);
      889    10523    1       KIS_MINOR$ = P$->B$PTR;
      890    10524    1       CALL DAM$MAP( KIS_MINOR$, KIS_MINOR$);
      891    10525            /* o.k.... let's get going */
      892    10526    1       MAJCLNT# = 0;
      893    10527    1       MAJSRVR# = 0;
      894    10528    1       MINCLNT# = 0;
      895    10529    1       MINSRVR# = 0;
      896    10530    1       DISPALL = %NO#;
      897    10531    1       NEEDHDR = %YES#;
      898    10532    2       IF TOP.NSUBLKS = 1 THEN DO;
      899    10533    2           CALL DAA$VALUE( TOP.SUBLK$(0)->OUT, I) ALTRET( RUNALL);
      900    10534    3           IF I = 0 THEN DO;
      901    10535    3               DISPALL = %YES#;
      902    10536    3               GOTO RUNALL;
      903    10537    3               END;
      904    10538    2           END;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:157  
      905    10539    2       IF TOP.NSUBLKS > 0 THEN DO;
      906    10540    3           DO X = 0 TO TOP.NSUBLKS - 1;
      907    10541    3               CALL DAA$VALUE( TOP.SUBLK$( X)->OUT, I) ALTRET( NEXT);
      908    10542    4               IF I < 10*KIS_SSN_SERVERS THEN DO;
      909    10543    4                   IF I = 1+10*((I-1)/10) THEN
      910    10544    4                       CALL MAJSRVR( PINCRW( KIS_MAJOR$, I), %YES#);
      911    10545    4                   ELSE
      912    10546    4                       GOTO NEXT;
      913    10547    4                   END;
      914    10548    3               ELSE
      915    10549    3                   IF I <= 10*KIS_SSN_SERVERS + KIS_SSN_CLIENTS THEN
      916    10550    3                       CALL MAJCLNT( PINCRW( KIS_MAJOR$, I), %YES#);
      917    10551    3   NEXT:
      918    10552    3               END;
      919    10553    2           RETURN;
      920    10554    2           END;
      921    10555    1   RUNALL:
      922    10556            /* run the server part of the major table */
      923    10557    2       DO I = 1 TO KIS_SSN_SERVERS;
      924    10558    2           P$ = PINCRW( KIS_MAJOR$, 10*I - 9);
      925    10559    2           CALL MAJSRVR( P$, DISPALL);
      926    10560    2           END;
      927    10561            /* run the client part of the major table */
      928    10562    2       DO I = 1 TO KIS_SSN_CLIENTS;
      929    10563    2           P$ = PINCRW( KIS_MAJOR$, I + 10*KIS_SSN_SERVERS);
      930    10564    2           CALL MAJCLNT( P$, DISPALL);
      931    10565    2           END;
      932    10566    1       CALL DSPMAJSUM;  /* display major table summary */
      933    10567            /* run the minor table if necessary */
      934    10568    2       IF DISPALL THEN DO;
      935    10569    2           P$ = PINCRW( KIS_MINOR$, KIS_MINOR$->APPL.Z.LINK);
      936    10570    2           CALL MINFREE( P$, %YES#);
      937    10571    2           END;
      938    10572    1       CALL DSPMINSUM;  /* display minor table summary */
      939    10573    1   DONE:
      940    10574    1       RETURN;
      941    10575        %EJECT;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:158  
      942    10576    1   CHAIN: PROC( P$, FLAG);
      943    10577
      944    10578    2       DCL ACTION SBIN;
      945    10579        %EQU SRVR = 0;
      946    10580        %EQU CLNT = 1;
      947    10581        %EQU FREE = 2;
      948    10582    2       DCL P$ PTR;
      949    10583    2       DCL FLAG BIT(1);
      950    10584
      951    10585    2   MAJSRVR: ENTRY( P$, FLAG);
      952    10586
      953    10587    2       ACTION = %SRVR;
      954    10588    2       TYPE = 'Srvr';
      955    10589    2       IF P$->APPL.LDCTX > 0 THEN
      956    10590    2           MAJSRVR# = MAJSRVR# + 1;
      957    10591    2       GOTO COMMON;
      958    10592
      959    10593    2   MAJCLNT: ENTRY( P$, FLAG);
      960    10594
      961    10595    2       ACTION = %CLNT;
      962    10596    2       TYPE = 'Clnt';
      963    10597    2       IF P$->APPL.LDCTX > 0 THEN
      964    10598    2           MAJCLNT# = MAJCLNT# + 1;
      965    10599    2       GOTO COMMON;
      966    10600
      967    10601    2   MINFREE: ENTRY( P$, FLAG);
      968    10602
      969    10603    2       ACTION = %FREE;
      970    10604    2       TYPE = 'Free';
      971    10605    2       SCTX = 0;
      972    10606    2   COMMON:
      973    10607    3       DO CASE( ACTION);
      974    10608    3           CASE( %SRVR);
      975    10609    3               IF FLAG OR P$->APPL.LDCTX > 0 THEN
      976    10610    3                   CALL DSPMAJSRVR( P$);
      977    10611    3               IF P$->APPL.LDCTX = 0 THEN
      978    10612    3                   GOTO DONE;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:159  
      979    10613    3   CHAINCHK:
      980    10614    3               J = P$->APPL.Z.LINK;
      981    10615    4               DO WHILE( J > 0);
      982    10616    4                   P$ = PINCRW( KIS_MINOR$, J);
      983    10617    4                   IF FLAG OR P$->APPL.TCTX > 0 THEN
      984    10618    4                       CALL DSPMIN( P$);
      985    10619    4                   IF P$->APPL.TCTX > 0 THEN
      986    10620    4                       IF ACTION = %SRVR THEN
      987    10621    4                           MINSRVR# = MINSRVR# + 1;
      988    10622    4                       ELSE
      989    10623    4                           IF ACTION = %CLNT THEN
      990    10624    4                               MINCLNT# = MINCLNT# + 1;
      991    10625    4                   J = P$->APPL.Z.LINK;
      992    10626    4                   END;
      993    10627    3           CASE( %CLNT);
      994    10628    3               IF FLAG OR P$->APPL.LDCTX > 0 THEN
      995    10629    3                   CALL DSPMAJCLNT( P$);
      996    10630    3               IF P$->APPL.LDCTX > 0 THEN
      997    10631    3                   GOTO CHAINCHK;
      998    10632    3           CASE( %FREE);
      999    10633    3               IF FLAG OR P$->APPL.TCTX > 0 THEN
     1000    10634    3                   CALL DSPMIN( P$);
     1001    10635    3               GOTO CHAINCHK;
     1002    10636    3           END;
     1003    10637    2   DONE:
     1004    10638    2       RETURN;
     1005    10639
     1006    10640    2       END CHAIN;
     1007    10641        %EJECT;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:160  
     1008    10642    1   DISPLAY: PROC( P$);
     1009    10643
     1010    10644    2       DCL ACTION SBIN;
     1011    10645    2       DCL FMT_ VECTOR;
     1012    10646    2       DCL LS83 UBIN STATIC;
     1013    10647    2       DCL LS83_ VECTOR CONSTANT INIT( VECTOR( LS83));
     1014    10648    2       DCL MAJ SBIN STATIC;
     1015    10649    2       DCL MAJ_ VECTOR CONSTANT INIT( VECTOR( MAJ));
     1016    10650    2       DCL MIN SBIN STATIC;
     1017    10651    2       DCL MIN_ VECTOR CONSTANT INIT( VECTOR( MIN));
     1018    10652    2       DCL P$ PTR;
     1019    10653    2       DCL SCID UBIN STATIC;
     1020    10654    2       DCL SCID_ VECTOR CONSTANT INIT( VECTOR( SCID));
     1021    10655
     1022    10656    2   DSPMAJSRVR: ENTRY( P$);  /* display single major table entry (server type) */
     1023    10657
     1024    10658    2       ACTION = %SRVR;
     1025    10659    2       FMT_ = FMTMAJSRVR_;
     1026    10660    2       GOTO MAJCOMMON;
     1027    10661
     1028    10662    2   DSPMAJCLNT: ENTRY( P$);  /* display single major table entry (client type) */
     1029    10663
     1030    10664    2       ACTION = %CLNT;
     1031    10665    2       FMT_ = FMTMAJCLNT_;
     1032    10666    2   MAJCOMMON:
     1033    10667    2       SCTX = POFFW( P$, KIS_MAJOR$);
     1034    10668    2       MIN = 0;
     1035    10669    2       GOTO COMMON;
     1036    10670
     1037    10671    2   DSPMIN: ENTRY( P$);   /* display single minor table entry */
     1038    10672
     1039    10673    2       ACTION = %FREE;
     1040    10674    2       FMT_ = FMTMIN_;
     1041    10675    2       MIN = POFFW( P$, KIS_MINOR$);
     1042    10676    2   COMMON:
     1043    10677    3       IF NEEDHDR THEN DO;
     1044    10678    3           CALL DAF$INIT( RPT);
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:161  
     1045    10679    3           NEEDHDR = %NO#;
     1046    10680    3           END;
     1047    10681    2       LS83 = ADDR( P$)->B$HALF;
     1048    10682    2       MAJ = SCTX;
     1049    10683    2       SCID = MAJ*512 + MIN;
     1050    10684    3       DO CASE( ACTION);
     1051    10685    3           CASE( %SRVR);
     1052    10686    3               CALL DAF$WRITE( FMT_,
     1053    10687    3                       LS83_,
     1054    10688    3                       SCTX_,
     1055    10689    3                       TYPE_,
     1056    10690    3                       MAJ_,
     1057    10691    3                       SCID_,
     1058    10692    3                       VECTOR( P$->APPL.LDCTX),
     1059    10693    3                       VECTOR( P$->APPL.AUDCT),
     1060    10694    3                       VECTOR( P$->APPL.Z.USER),
     1061    10695    3                       VECTOR( SUBSTR( P$->APPL.TSAP.TSAP, 0, P$->APPL.TSAP.LEN)));
     1062    10696    3           CASE( %CLNT);
     1063    10697    3               CALL DAF$WRITE( FMT_,
     1064    10698    3                       LS83_,
     1065    10699    3                       SCTX_,
     1066    10700    3                       TYPE_,
     1067    10701    3                       MAJ_,
     1068    10702    3                       SCID_,
     1069    10703    3                       VECTOR( P$->APPL.LDCTX),
     1070    10704    3                       VECTOR( P$->APPL.Z.USER));
     1071    10705    3           CASE( %FREE);
     1072    10706    3               CALL DAF$WRITE( FMT_,
     1073    10707    3                       LS83_,
     1074    10708    3                       TYPE_,
     1075    10709    3                       MAJ_,
     1076    10710    3                       MIN_,
     1077    10711    3                       SCID_,
     1078    10712    3                       VECTOR( P$->APPL.TCTX),
     1079    10713    3                       VECTOR( P$->APPL.Z.COOKIE));
     1080    10714    3           END;
     1081    10715    2       RETURN;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:162  
     1082    10716
     1083    10717    2   DSPMAJSUM: ENTRY;  /* display major table summary */
     1084    10718
     1085    10719    2       I = KIS_SSN_CLIENTS + KIS_SSN_SERVERS;
     1086    10720    2       J = MAJCLNT# + MAJSRVR#;
     1087    10721    2       X = I - J;
     1088    10722    2       CALL DAF$WRITE( FMTMAJSUM_,
     1089    10723    2               VECTOR( I),
     1090    10724    2               VECTOR( KIS_SSN_SERVERS),
     1091    10725    2               VECTOR( KIS_SSN_CLIENTS),
     1092    10726    2               VECTOR( J),
     1093    10727    2               VECTOR( MAJSRVR#),
     1094    10728    2               VECTOR( MAJCLNT#),
     1095    10729    2               VECTOR( X));
     1096    10730    2       RETURN;
     1097    10731
     1098    10732    2   DSPMINSUM: ENTRY;  /* display minor table summary */
     1099    10733
     1100    10734    2       I = KIS_SSN_MAX;
     1101    10735    2       J = MINCLNT# + MINSRVR#;
     1102    10736    2       X = I - J;
     1103    10737    2       CALL DAF$WRITE( FMTMINSUM_,
     1104    10738    2               VECTOR( I),
     1105    10739    2               VECTOR( KIS_SSN_MAX),
     1106    10740    2               VECTOR( J),
     1107    10741    2               VECTOR( MINSRVR#),
     1108    10742    2               VECTOR( MINCLNT#),
     1109    10743    2               VECTOR( X));
     1110    10744    2       RETURN;
     1111    10745
     1112    10746    2       END DISPLAY;
     1113    10747
     1114    10748    1       END DAD$SCTX;

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:163  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   K_SESSION_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$SCTX.

   Procedure DAD$SCTX requires 738 words for executable code.
   Procedure DAD$SCTX requires 82 words of local(AUTO) storage.

    No errors detected in file DAD$ROUTE.:E05TSI    .

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:164  

 Object Unit name= DAD$SCTX                                   File name= DAD$ROUTE.:E05TOU
 UTS= JUL 29 '97 12:45:20.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    67    103  DAD$SCTX
    2  RoData even  UTS    107    153  DAD$SCTX
    3   Proc  even  none   738   1342  DAD$SCTX
    4  RoData even  none    28     34  DAD$SCTX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DAD$SCTX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DAS$SDMONPTR
 yes     yes           Std       5 DAM$MAP
 yes     yes           Std       3 DAA$VALUE
 yes     yes           Std       1 DAF$INIT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:165  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DA_MONISDATA                          DAF$WRITE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:166  


      795        1        /*T***********************************************************/
      796        2        /*T*                                                         */
      797        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      798        4        /*T*                                                         */
      799        5        /*T***********************************************************/
      800        6        /*F*    NAME: DAD$SCTX
      801        7                PURPOSE: To process the SCTX command for the Host.
      802        8        */
      803        9        /*X* DDA */
      804       10        DAD$SCTX: PROC( TOP);

     10  3 000000   000000 700200 xent  DAD$SCTX     TSX0  ! X66_AUTO_1
         3 000001   000122 000001                    ZERO    82,1

      805       11        %INCLUDE CP_6;
      806     5570        %INCLUDE CP_6_SUBS;
      807     6110        %INCLUDE DA_FORMAT_C;
      808     6352        %INCLUDE DA_MONSYM_C;
      809     6403        %INCLUDE DA_ANLZ_R;
      810     6416        %INCLUDE DA_MAP_R;
      811     6446        %INCLUDE K_ADDRESS_M;
      812     6949        %INCLUDE K_SESSION_M;
      813     7039            %KIS$APPL( NAME=APPL, STCLASS=BASED);
      814     7108        %INCLUDE XU_MACRO_C;
      815    10214            %PARSE$OUT( NAME=TOP, STCLASS=PARAM);
      816    10259            %PARSE$OUT( NAME=OUT, STCLASS=BASED);
      817    10304
      818    10305    1       DCL DAA$VALUE ENTRY(3) ALTRET;
      819    10306    1       DCL DAF$INIT ENTRY(1) ALTRET;
      820    10307    1       DCL DAF$WRITE EPTR SYMREF;
      821    10308    1       DCL DAM$MAP ENTRY(5) ALTRET;
      822    10309    1       DCL DAS$SDMONPTR ENTRY(2) ALTRET;
      823    10310
      824    10311    1       DCL B$HALF UBIN(18) BASED;
      825    10312    1       DCL B$PTR PTR BASED;
      826    10313    1       DCL B$SBIN SBIN BASED;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:167  
      827    10314    1       DCL DISPALL BIT(1);
      828    10315    1       DCL I SBIN;
      829    10316    1       DCL J SBIN;
      830    10317    1       DCL KIS_MAJOR$ PTR;
      831    10318    1       DCL KIS_MINOR$ PTR;
      832    10319    1       DCL KIS_SSN_CLIENTS SBIN;
      833    10320    1       DCL KIS_SSN_SERVERS SBIN;
      834    10321    1       DCL KIS_SSN_MAX SBIN;
      835    10322    1       DCL MAJCLNT# SBIN;
      836    10323    1       DCL MAJSRVR# SBIN;
      837    10324    1       DCL MINCLNT# SBIN;
      838    10325    1       DCL MINSRVR# SBIN;
      839    10326    1       DCL NEEDHDR BIT(1);
      840    10327    1       DCL P$ PTR;
      841    10328    1       DCL SCTX UBIN STATIC;
      842    10329    1       DCL SCTX_ VECTOR CONSTANT INIT( VECTOR( SCTX));
      843    10330    1       DCL TYPE CHAR(4) STATIC;
      844    10331    1       DCL TYPE_ VECTOR CONSTANT INIT( VECTOR( TYPE));
      845    10332    1       DCL X SBIN;
      846    10333
      847    10334            %REPORT( NAME=RPT, TRUNC=YES, TABDFLT=5, HEADER=YES,
      848    10335                     TITLE='Host OSI Session context');
      849    10401            %HEADER( LAST=NO, TEXT=
      850    10402        '$LS83-> SCTX TYPE  MajMin   SCID LDCTX AUDCT  USER TSAP/TCTX/Cookie');
      851    10444            %HEADER( TEXT=
      852    10445       '------- ---- ---- ------- ------ ----- ----- ----- -------------------------------'
             10445            );
      853    10487    1       DCL FMTMAJCLNT CHAR(0) CONSTANT INIT(
      854    10488    1   '.%6ZO %4D %A .%3ZO    %6D  .%3ZO        .%3ZO');
      855    10489    1       DCL FMTMAJCLNT_ VECTOR CONSTANT INIT( VECTOR( FMTMAJCLNT));
      856    10490    1       DCL FMTMAJSRVR CHAR(0) CONSTANT INIT(
      857    10491    1   '.%6ZO %4D %A .%3ZO    %6D  .%3ZO  .%3ZO  .%3ZO %A');
      858    10492    1       DCL FMTMAJSRVR_ VECTOR CONSTANT INIT( VECTOR( FMTMAJSRVR));
      859    10493    1       DCL FMTMIN CHAR(0) CONSTANT INIT(
      860    10494    1   '.%6ZO      %A .%3ZO%3ZO %6D                   TCTX=%D, Cookie=%D');
      861    10495    1       DCL FMTMIN_ VECTOR CONSTANT INIT( VECTOR( FMTMIN));
      862    10496    1       DCL FMTMAJSUM CHAR(0) CONSTANT INIT(
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:168  
      863    10497    1   'Major Table: %D slots (%D Srvr, %D Clnt), %D in use (%D Srvr, %D Clnt), %D free');
      864    10498    1       DCL FMTMAJSUM_ VECTOR CONSTANT INIT( VECTOR( FMTMAJSUM));
      865    10499    1       DCL FMTMINSUM CHAR(0) CONSTANT INIT(
      866    10500    1   'Minor Table: %D slots (%D Srvr or Clnt), %D in use (%D Srvr, %D Clnt), %D free');
      867    10501    1       DCL FMTMINSUM_ VECTOR CONSTANT INIT( VECTOR( FMTMINSUM));
      868    10502
      869    10503            /* get max number of clients */
      870    10504    1       CALL DAS$SDMONPTR( %M#KIS_SSN_CLIENTS, P$) ALTRET( DONE);

  10504  3 000002   200021 630500                    EPPR0   P$,,AUTO
         3 000003   200037 450500                    STP0    FMT_+3,,AUTO
         3 000004   000001 236000 4                  LDQ     1
         3 000005   200036 756100                    STQ     FMT_+2,,AUTO
         3 000006   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000010   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000011   000422 702000 3                  TSX2    DONE

      871    10505    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);

  10505  3 000012   000002 236000 4                  LDQ     2
         3 000013   200042 756100                    STQ     FMT_+6,,AUTO
         3 000014   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000015   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000016   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000017   200021 630500                    EPPR0   P$,,AUTO
         3 000020   200037 450500                    STP0    FMT_+3,,AUTO
         3 000021   200021 631500                    EPPR1   P$,,AUTO
         3 000022   200036 451500                    STP1    FMT_+2,,AUTO
         3 000023   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000024   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000025   000000 701000 xent               TSX1    DAM$MAP
         3 000026   000422 702000 3                  TSX2    DONE

      872    10506    1       KIS_SSN_CLIENTS = P$->B$SBIN;

  10506  3 000027   200021 470500                    LDP0    P$,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:169  
         3 000030   000000 235100                    LDA     0,,PR0
         3 000031   200011 755100                    STA     KIS_SSN_CLIENTS,,AUTO

      873    10507            /* get max number of servers */
      874    10508    1       CALL DAS$SDMONPTR( %M#KIS_SSN_SERVERS, P$) ALTRET( DONE);

  10508  3 000032   200021 631500                    EPPR1   P$,,AUTO
         3 000033   200037 451500                    STP1    FMT_+3,,AUTO
         3 000034   000004 236000 4                  LDQ     4
         3 000035   200036 756100                    STQ     FMT_+2,,AUTO
         3 000036   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000040   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000041   000422 702000 3                  TSX2    DONE

      875    10509    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);

  10509  3 000042   000002 236000 4                  LDQ     2
         3 000043   200042 756100                    STQ     FMT_+6,,AUTO
         3 000044   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000045   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000046   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000047   200021 630500                    EPPR0   P$,,AUTO
         3 000050   200037 450500                    STP0    FMT_+3,,AUTO
         3 000051   200021 631500                    EPPR1   P$,,AUTO
         3 000052   200036 451500                    STP1    FMT_+2,,AUTO
         3 000053   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000054   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000055   000000 701000 xent               TSX1    DAM$MAP
         3 000056   000422 702000 3                  TSX2    DONE

      876    10510    1       KIS_SSN_SERVERS = P$->B$SBIN;

  10510  3 000057   200021 470500                    LDP0    P$,,AUTO
         3 000060   000000 235100                    LDA     0,,PR0
         3 000061   200012 755100                    STA     KIS_SSN_SERVERS,,AUTO

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:170  
      877    10511            /* get max number of connections */
      878    10512    1       CALL DAS$SDMONPTR( %M#KIS_SSN_MAX, P$) ALTRET( DONE);

  10512  3 000062   200021 631500                    EPPR1   P$,,AUTO
         3 000063   200037 451500                    STP1    FMT_+3,,AUTO
         3 000064   000006 236000 4                  LDQ     6
         3 000065   200036 756100                    STQ     FMT_+2,,AUTO
         3 000066   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000067   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000070   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000071   000422 702000 3                  TSX2    DONE

      879    10513    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);

  10513  3 000072   000002 236000 4                  LDQ     2
         3 000073   200042 756100                    STQ     FMT_+6,,AUTO
         3 000074   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000075   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000076   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000077   200021 630500                    EPPR0   P$,,AUTO
         3 000100   200037 450500                    STP0    FMT_+3,,AUTO
         3 000101   200021 631500                    EPPR1   P$,,AUTO
         3 000102   200036 451500                    STP1    FMT_+2,,AUTO
         3 000103   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000104   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000105   000000 701000 xent               TSX1    DAM$MAP
         3 000106   000422 702000 3                  TSX2    DONE

      880    10514    1       KIS_SSN_MAX = P$->B$SBIN;

  10514  3 000107   200021 470500                    LDP0    P$,,AUTO
         3 000110   000000 235100                    LDA     0,,PR0
         3 000111   200013 755100                    STA     KIS_SSN_MAX,,AUTO

      881    10515            /* get ptr to major table */
      882    10516    1       CALL DAS$SDMONPTR( %M#KIS_MAJOR$, P$) ALTRET( DONE);

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:171  
  10516  3 000112   200021 631500                    EPPR1   P$,,AUTO
         3 000113   200037 451500                    STP1    FMT_+3,,AUTO
         3 000114   000010 236000 4                  LDQ     8
         3 000115   200036 756100                    STQ     FMT_+2,,AUTO
         3 000116   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000117   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000120   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000121   000422 702000 3                  TSX2    DONE

      883    10517    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);

  10517  3 000122   000002 236000 4                  LDQ     2
         3 000123   200042 756100                    STQ     FMT_+6,,AUTO
         3 000124   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000125   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000126   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000127   200021 630500                    EPPR0   P$,,AUTO
         3 000130   200037 450500                    STP0    FMT_+3,,AUTO
         3 000131   200021 631500                    EPPR1   P$,,AUTO
         3 000132   200036 451500                    STP1    FMT_+2,,AUTO
         3 000133   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000134   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000135   000000 701000 xent               TSX1    DAM$MAP
         3 000136   000422 702000 3                  TSX2    DONE

      884    10518    1       KIS_MAJOR$ = P$->B$PTR;

  10518  3 000137   200021 470500                    LDP0    P$,,AUTO
         3 000140   000000 236100                    LDQ     0,,PR0
         3 000141   200007 756100                    STQ     KIS_MAJOR$,,AUTO

      885    10519    1       CALL DAM$MAP( KIS_MAJOR$, KIS_MAJOR$);

  10519  3 000142   200007 631500                    EPPR1   KIS_MAJOR$,,AUTO
         3 000143   200037 451500                    STP1    FMT_+3,,AUTO
         3 000144   200007 633500                    EPPR3   KIS_MAJOR$,,AUTO
         3 000145   200036 453500                    STP3    FMT_+2,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:172  
         3 000146   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000147   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000150   000000 701000 xent               TSX1    DAM$MAP
         3 000151   000000 011000                    NOP     0

      886    10520            /* get ptr to minor table */
      887    10521    1       CALL DAS$SDMONPTR( %M#KIS_MINOR$, P$) ALTRET( DONE);

  10521  3 000152   200021 630500                    EPPR0   P$,,AUTO
         3 000153   200037 450500                    STP0    FMT_+3,,AUTO
         3 000154   000012 236000 4                  LDQ     10
         3 000155   200036 756100                    STQ     FMT_+2,,AUTO
         3 000156   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000160   000000 701000 xent               TSX1    DAS$SDMONPTR
         3 000161   000422 702000 3                  TSX2    DONE

      888    10522    1       CALL DAM$MAP( P$, P$, , , DA_MONISDATA) ALTRET( DONE);

  10522  3 000162   000002 236000 4                  LDQ     2
         3 000163   200042 756100                    STQ     FMT_+6,,AUTO
         3 000164   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000165   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000166   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000167   200021 630500                    EPPR0   P$,,AUTO
         3 000170   200037 450500                    STP0    FMT_+3,,AUTO
         3 000171   200021 631500                    EPPR1   P$,,AUTO
         3 000172   200036 451500                    STP1    FMT_+2,,AUTO
         3 000173   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000174   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000175   000000 701000 xent               TSX1    DAM$MAP
         3 000176   000422 702000 3                  TSX2    DONE

      889    10523    1       KIS_MINOR$ = P$->B$PTR;

  10523  3 000177   200021 470500                    LDP0    P$,,AUTO
         3 000200   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:173  
         3 000201   200010 756100                    STQ     KIS_MINOR$,,AUTO

      890    10524    1       CALL DAM$MAP( KIS_MINOR$, KIS_MINOR$);

  10524  3 000202   200010 631500                    EPPR1   KIS_MINOR$,,AUTO
         3 000203   200037 451500                    STP1    FMT_+3,,AUTO
         3 000204   200010 633500                    EPPR3   KIS_MINOR$,,AUTO
         3 000205   200036 453500                    STP3    FMT_+2,,AUTO
         3 000206   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000207   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000210   000000 701000 xent               TSX1    DAM$MAP
         3 000211   000000 011000                    NOP     0

      891    10525            /* o.k.... let's get going */
      892    10526    1       MAJCLNT# = 0;

  10526  3 000212   200014 450100                    STZ     MAJCLNT#,,AUTO

      893    10527    1       MAJSRVR# = 0;

  10527  3 000213   200015 450100                    STZ     MAJSRVR#,,AUTO

      894    10528    1       MINCLNT# = 0;

  10528  3 000214   200016 450100                    STZ     MINCLNT#,,AUTO

      895    10529    1       MINSRVR# = 0;

  10529  3 000215   200017 450100                    STZ     MINSRVR#,,AUTO

      896    10530    1       DISPALL = %NO#;

  10530  3 000216   200004 450100                    STZ     DISPALL,,AUTO

      897    10531    1       NEEDHDR = %YES#;

  10531  3 000217   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:174  
         3 000220   200020 756100                    STQ     NEEDHDR,,AUTO

      898    10532    2       IF TOP.NSUBLKS = 1 THEN DO;

  10532  3 000221   200003 470500                    LDP0    @TOP,,AUTO
         3 000222   000001 220100                    LDX0    1,,PR0
         3 000223   000001 100003                    CMPX0   1,DU
         3 000224   000242 601000 3                  TNZ     s:10539

      899    10533    2           CALL DAA$VALUE( TOP.SUBLK$(0)->OUT, I) ALTRET( RUNALL);

  10533  3 000225   000003 471500                    LDP1    3,,PR0
         3 000226   200005 633500                    EPPR3   I,,AUTO
         3 000227   200037 453500                    STP3    FMT_+3,,AUTO
         3 000230   200036 451500                    STP1    FMT_+2,,AUTO
         3 000231   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000232   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000233   000000 701000 xent               TSX1    DAA$VALUE
         3 000234   000333 702000 3                  TSX2    RUNALL

      900    10534    3           IF I = 0 THEN DO;

  10534  3 000235   200005 235100                    LDA     I,,AUTO
         3 000236   000242 601000 3                  TNZ     s:10539

      901    10535    3               DISPALL = %YES#;

  10535  3 000237   400000 236003                    LDQ     -131072,DU
         3 000240   200004 756100                    STQ     DISPALL,,AUTO

      902    10536    3               GOTO RUNALL;

  10536  3 000241   000333 710000 3                  TRA     RUNALL

      903    10537    3               END;
      904    10538    2           END;
      905    10539    2       IF TOP.NSUBLKS > 0 THEN DO;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:175  

  10539  3 000242   200003 470500                    LDP0    @TOP,,AUTO
         3 000243   000001 220100                    LDX0    1,,PR0
         3 000244   000333 600000 3                  TZE     RUNALL

      906    10540    3           DO X = 0 TO TOP.NSUBLKS - 1;

  10540  3 000245   200022 450100                    STZ     X,,AUTO
         3 000246   000325 710000 3                  TRA     NEXT+1

      907    10541    3               CALL DAA$VALUE( TOP.SUBLK$( X)->OUT, I) ALTRET( NEXT);

  10541  3 000247   200003 470500                    LDP0    @TOP,,AUTO
         3 000250   200022 720100                    LXL0    X,,AUTO
         3 000251   000003 471510                    LDP1    3,X0,PR0
         3 000252   200005 633500                    EPPR3   I,,AUTO
         3 000253   200037 453500                    STP3    FMT_+3,,AUTO
         3 000254   200036 451500                    STP1    FMT_+2,,AUTO
         3 000255   200036 630500                    EPPR0   FMT_+2,,AUTO
         3 000256   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000257   000000 701000 xent               TSX1    DAA$VALUE
         3 000260   000324 702000 3                  TSX2    NEXT

      908    10542    4               IF I < 10*KIS_SSN_SERVERS THEN DO;

  10542  3 000261   200012 236100                    LDQ     KIS_SSN_SERVERS,,AUTO
         3 000262   000012 402007                    MPY     10,DL
         3 000263   200005 116100                    CMPQ    I,,AUTO
         3 000264   000307 604400 3                  TMOZ    s:10549

      909    10543    4                   IF I = 1+10*((I-1)/10) THEN

  10543  3 000265   200005 236100                    LDQ     I,,AUTO
         3 000266   000001 136007                    SBLQ    1,DL
         3 000267   000012 506007                    DIV     10,DL
         3 000270   000012 402007                    MPY     10,DL
         3 000271   000001 036007                    ADLQ    1,DL
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:176  
         3 000272   200005 116100                    CMPQ    I,,AUTO
         3 000273   000324 601000 3                  TNZ     NEXT

      910    10544    4                       CALL MAJSRVR( PINCRW( KIS_MAJOR$, I), %YES#);

  10544  3 000274   200005 236100                    LDQ     I,,AUTO
         3 000275   000022 736000                    QLS     18
         3 000276   200007 036100                    ADLQ    KIS_MAJOR$,,AUTO
         3 000277   200120 756100                    STQ     FMT_+52,,AUTO
         3 000300   000013 236000 4                  LDQ     11
         3 000301   200026 756100                    STQ     @P$+1,,AUTO
         3 000302   200120 630500                    EPPR0   FMT_+52,,AUTO
         3 000303   200025 450500                    STP0    X+3,,AUTO
         3 000304   000425 701000 3                  TSX1    MAJSRVR
         3 000305   000000 011000                    NOP     0
         3 000306   000324 710000 3                  TRA     NEXT

      911    10545    4                   ELSE
      912    10546    4                       GOTO NEXT;
      913    10547    4                   END;
      914    10548    3               ELSE
      915    10549    3                   IF I <= 10*KIS_SSN_SERVERS + KIS_SSN_CLIENTS THEN

  10549  3 000307   200011 036100                    ADLQ    KIS_SSN_CLIENTS,,AUTO
         3 000310   200005 116100                    CMPQ    I,,AUTO
         3 000311   000324 604000 3                  TMI     NEXT

      916    10550    3                       CALL MAJCLNT( PINCRW( KIS_MAJOR$, I), %YES#);

  10550  3 000312   200005 236100                    LDQ     I,,AUTO
         3 000313   000022 736000                    QLS     18
         3 000314   200007 036100                    ADLQ    KIS_MAJOR$,,AUTO
         3 000315   200121 756100                    STQ     FMT_+53,,AUTO
         3 000316   000013 236000 4                  LDQ     11
         3 000317   200026 756100                    STQ     @P$+1,,AUTO
         3 000320   200121 630500                    EPPR0   FMT_+53,,AUTO
         3 000321   200025 450500                    STP0    X+3,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:177  
         3 000322   000437 701000 3                  TSX1    MAJCLNT
         3 000323   000000 011000                    NOP     0

      917    10551    3   NEXT:
      918    10552    3               END;

  10552  3 000324   200022 054100       NEXT         AOS     X,,AUTO
         3 000325   200003 470500                    LDP0    @TOP,,AUTO
         3 000326   000001 236100                    LDQ     1,,PR0
         3 000327   000022 772000                    QRL     18
         3 000330   200022 116100                    CMPQ    X,,AUTO
         3 000331   000247 605400 3                  TPNZ    s:10541

      919    10553    2           RETURN;

  10553  3 000332   000000 702200 xent               TSX2  ! X66_ARET

      920    10554    2           END;
      921    10555    1   RUNALL:
      922    10556            /* run the server part of the major table */
      923    10557    2       DO I = 1 TO KIS_SSN_SERVERS;

  10557  3 000333   000001 235007       RUNALL       LDA     1,DL
         3 000334   200005 755100                    STA     I,,AUTO
         3 000335   000352 710000 3                  TRA     s:10560+1

      924    10558    2           P$ = PINCRW( KIS_MAJOR$, 10*I - 9);

  10558  3 000336   200005 236100                    LDQ     I,,AUTO
         3 000337   000012 402003                    MPY     10,DU
         3 000340   000011 136003                    SBLQ    9,DU
         3 000341   200007 036100                    ADLQ    KIS_MAJOR$,,AUTO
         3 000342   200021 756100                    STQ     P$,,AUTO

      925    10559    2           CALL MAJSRVR( P$, DISPALL);

  10559  3 000343   200004 630500                    EPPR0   DISPALL,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:178  
         3 000344   200026 450500                    STP0    @P$+1,,AUTO
         3 000345   200021 631500                    EPPR1   P$,,AUTO
         3 000346   200025 451500                    STP1    X+3,,AUTO
         3 000347   000425 701000 3                  TSX1    MAJSRVR
         3 000350   000000 011000                    NOP     0

      926    10560    2           END;

  10560  3 000351   200005 054100                    AOS     I,,AUTO
         3 000352   200005 236100                    LDQ     I,,AUTO
         3 000353   200012 116100                    CMPQ    KIS_SSN_SERVERS,,AUTO
         3 000354   000336 604400 3                  TMOZ    s:10558

      927    10561            /* run the client part of the major table */
      928    10562    2       DO I = 1 TO KIS_SSN_CLIENTS;

  10562  3 000355   000001 235007                    LDA     1,DL
         3 000356   200005 755100                    STA     I,,AUTO
         3 000357   000375 710000 3                  TRA     s:10565+1

      929    10563    2           P$ = PINCRW( KIS_MAJOR$, I + 10*KIS_SSN_SERVERS);

  10563  3 000360   200012 236100                    LDQ     KIS_SSN_SERVERS,,AUTO
         3 000361   000012 402007                    MPY     10,DL
         3 000362   200005 036100                    ADLQ    I,,AUTO
         3 000363   000022 736000                    QLS     18
         3 000364   200007 036100                    ADLQ    KIS_MAJOR$,,AUTO
         3 000365   200021 756100                    STQ     P$,,AUTO

      930    10564    2           CALL MAJCLNT( P$, DISPALL);

  10564  3 000366   200004 630500                    EPPR0   DISPALL,,AUTO
         3 000367   200026 450500                    STP0    @P$+1,,AUTO
         3 000370   200021 631500                    EPPR1   P$,,AUTO
         3 000371   200025 451500                    STP1    X+3,,AUTO
         3 000372   000437 701000 3                  TSX1    MAJCLNT
         3 000373   000000 011000                    NOP     0
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:179  

      931    10565    2           END;

  10565  3 000374   200005 054100                    AOS     I,,AUTO
         3 000375   200005 236100                    LDQ     I,,AUTO
         3 000376   200011 116100                    CMPQ    KIS_SSN_CLIENTS,,AUTO
         3 000377   000360 604400 3                  TMOZ    s:10563

      932    10566    1       CALL DSPMAJSUM;  /* display major table summary */

  10566  3 000400   001110 701000 3                  TSX1    DSPMAJSUM
         3 000401   000000 011000                    NOP     0

      933    10567            /* run the minor table if necessary */
      934    10568    2       IF DISPALL THEN DO;

  10568  3 000402   200004 234100                    SZN     DISPALL,,AUTO
         3 000403   000420 605000 3                  TPL     s:10572

      935    10569    2           P$ = PINCRW( KIS_MINOR$, KIS_MINOR$->APPL.Z.LINK);

  10569  3 000404   200010 470500                    LDP0    KIS_MINOR$,,AUTO
         3 000405   000000 720100                    LXL0    0,,PR0
         3 000406   000777 360003                    ANX0    511,DU
         3 000407   000000 636010                    EAQ     0,X0
         3 000410   200010 036100                    ADLQ    KIS_MINOR$,,AUTO
         3 000411   200021 756100                    STQ     P$,,AUTO

      936    10570    2           CALL MINFREE( P$, %YES#);

  10570  3 000412   000013 236000 4                  LDQ     11
         3 000413   200026 756100                    STQ     @P$+1,,AUTO
         3 000414   200021 631500                    EPPR1   P$,,AUTO
         3 000415   200025 451500                    STP1    X+3,,AUTO
         3 000416   000452 701000 3                  TSX1    MINFREE
         3 000417   000000 011000                    NOP     0

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:180  
      937    10571    2           END;

      938    10572    1       CALL DSPMINSUM;  /* display minor table summary */

  10572  3 000420   001232 701000 3                  TSX1    DSPMINSUM
         3 000421   000000 011000                    NOP     0

      939    10573    1   DONE:
      940    10574    1       RETURN;

  10574  3 000422   000000 702200 xent  DONE         TSX2  ! X66_ARET

      941    10575        %EJECT;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:181  
      942    10576    1   CHAIN: PROC( P$, FLAG);

  10576  3 000423   200024 741300       CHAIN        STX1  ! X+2,,AUTO
         3 000424   000426 710000 3                  TRA     s:10587

      943    10577
      944    10578    2       DCL ACTION SBIN;
      945    10579        %EQU SRVR = 0;
      946    10580        %EQU CLNT = 1;
      947    10581        %EQU FREE = 2;
      948    10582    2       DCL P$ PTR;
      949    10583    2       DCL FLAG BIT(1);
      950    10584
      951    10585    2   MAJSRVR: ENTRY( P$, FLAG);

  10585  3 000425   200024 741300       MAJSRVR      STX1  ! X+2,,AUTO

      952    10586
      953    10587    2       ACTION = %SRVR;

  10587  3 000426   200027 450100                    STZ     ACTION,,AUTO

      954    10588    2       TYPE = 'Srvr';

  10588  3 000427   000150 236000 2                  LDQ     SCID_+2
         3 000430   000001 756000 1                  STQ     TYPE

      955    10589    2       IF P$->APPL.LDCTX > 0 THEN

  10589  3 000431   200025 470500                    LDP0    @P$,,AUTO
         3 000432   000000 471500                    LDP1    0,,PR0
         3 000433   100000 220100                    LDX0    0,,PR1
         3 000434   000436 600000 3                  TZE     s:10591

      956    10590    2           MAJSRVR# = MAJSRVR# + 1;

  10590  3 000435   200015 054100                    AOS     MAJSRVR#,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:182  

      957    10591    2       GOTO COMMON;

  10591  3 000436   000460 710000 3                  TRA     COMMON

      958    10592
      959    10593    2   MAJCLNT: ENTRY( P$, FLAG);

  10593  3 000437   200024 741300       MAJCLNT      STX1  ! X+2,,AUTO

      960    10594
      961    10595    2       ACTION = %CLNT;

  10595  3 000440   000001 235007                    LDA     1,DL
         3 000441   200027 755100                    STA     ACTION,,AUTO

      962    10596    2       TYPE = 'Clnt';

  10596  3 000442   000151 236000 2                  LDQ     SCID_+3
         3 000443   000001 756000 1                  STQ     TYPE

      963    10597    2       IF P$->APPL.LDCTX > 0 THEN

  10597  3 000444   200025 470500                    LDP0    @P$,,AUTO
         3 000445   000000 471500                    LDP1    0,,PR0
         3 000446   100000 220100                    LDX0    0,,PR1
         3 000447   000451 600000 3                  TZE     s:10599

      964    10598    2           MAJCLNT# = MAJCLNT# + 1;

  10598  3 000450   200014 054100                    AOS     MAJCLNT#,,AUTO

      965    10599    2       GOTO COMMON;

  10599  3 000451   000460 710000 3                  TRA     COMMON

      966    10600
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:183  
      967    10601    2   MINFREE: ENTRY( P$, FLAG);

  10601  3 000452   200024 741300       MINFREE      STX1  ! X+2,,AUTO

      968    10602
      969    10603    2       ACTION = %FREE;

  10603  3 000453   000002 235007                    LDA     2,DL
         3 000454   200027 755100                    STA     ACTION,,AUTO

      970    10604    2       TYPE = 'Free';

  10604  3 000455   000152 236000 2                  LDQ     SCID_+4
         3 000456   000001 756000 1                  STQ     TYPE

      971    10605    2       SCTX = 0;

  10605  3 000457   000000 450000 1                  STZ     SCTX

      972    10606    2   COMMON:
      973    10607    3       DO CASE( ACTION);

  10607  3 000460   200027 235100       COMMON       LDA     ACTION,,AUTO
         3 000461   000003 115007                    CMPA    3,DL
         3 000462   000464 602005 3                  TNC     COMMON+4,AL
         3 000463   000620 710000 3                  TRA     DONE
         3 000464   000467 710000 3                  TRA     s:10609
         3 000465   000560 710000 3                  TRA     s:10628
         3 000466   000602 710000 3                  TRA     s:10633

      974    10608    3           CASE( %SRVR);

      975    10609    3               IF FLAG OR P$->APPL.LDCTX > 0 THEN

  10609  3 000467   200026 470500                    LDP0    @FLAG,,AUTO
         3 000470   000000 066500                    CMPB    filb='0'B
         3 000471   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:184  
         3 000472   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000473   000500 601000 3                  TNZ     s:10610
         3 000474   200025 471500                    LDP1    @P$,,AUTO
         3 000475   100000 473500                    LDP3    0,,PR1
         3 000476   300000 220100                    LDX0    0,,PR3
         3 000477   000504 600000 3                  TZE     s:10611

      976    10610    3                   CALL DSPMAJSRVR( P$);

  10610  3 000500   200025 236100                    LDQ     @P$,,AUTO
         3 000501   200031 756100                    STQ     ACTION+2,,AUTO
         3 000502   000624 701000 3                  TSX1    DSPMAJSRVR
         3 000503   000000 011000                    NOP     0

      977    10611    3               IF P$->APPL.LDCTX = 0 THEN

  10611  3 000504   200025 470500                    LDP0    @P$,,AUTO
         3 000505   000000 471500                    LDP1    0,,PR0
         3 000506   100000 220100                    LDX0    0,,PR1
         3 000507   000620 600000 3                  TZE     DONE

      978    10612    3                   GOTO DONE;
      979    10613    3   CHAINCHK:
      980    10614    3               J = P$->APPL.Z.LINK;

  10614  3 000510   200025 470500       CHAINCHK     LDP0    @P$,,AUTO
         3 000511   000000 471500                    LDP1    0,,PR0
         3 000512   100000 236100                    LDQ     0,,PR1
         3 000513   000777 376007                    ANQ     511,DL
         3 000514   200006 756100                    STQ     J,,AUTO

      981    10615    4               DO WHILE( J > 0);

  10615  3 000515   000620 604400 3                  TMOZ    DONE

      982    10616    4                   P$ = PINCRW( KIS_MINOR$, J);

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:185  
  10616  3 000516   200006 236100                    LDQ     J,,AUTO
         3 000517   000022 736000                    QLS     18
         3 000520   200010 036100                    ADLQ    KIS_MINOR$,,AUTO
         3 000521   200025 470500                    LDP0    @P$,,AUTO
         3 000522   000000 756100                    STQ     0,,PR0

      983    10617    4                   IF FLAG OR P$->APPL.TCTX > 0 THEN

  10617  3 000523   200026 471500                    LDP1    @FLAG,,AUTO
         3 000524   000000 066500                    CMPB    filb='0'B
         3 000525   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         3 000526   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000527   000533 601000 3                  TNZ     s:10618
         3 000530   000000 473500                    LDP3    0,,PR0
         3 000531   300000 220100                    LDX0    0,,PR3
         3 000532   000537 600000 3                  TZE     s:10619

      984    10618    4                       CALL DSPMIN( P$);

  10618  3 000533   200025 236100                    LDQ     @P$,,AUTO
         3 000534   200031 756100                    STQ     ACTION+2,,AUTO
         3 000535   000650 701000 3                  TSX1    DSPMIN
         3 000536   000000 011000                    NOP     0

      985    10619    4                   IF P$->APPL.TCTX > 0 THEN

  10619  3 000537   200025 470500                    LDP0    @P$,,AUTO
         3 000540   000000 471500                    LDP1    0,,PR0
         3 000541   100000 220100                    LDX0    0,,PR1
         3 000542   000552 600000 3                  TZE     s:10625

      986    10620    4                       IF ACTION = %SRVR THEN

  10620  3 000543   200027 235100                    LDA     ACTION,,AUTO
         3 000544   000547 601000 3                  TNZ     s:10623

      987    10621    4                           MINSRVR# = MINSRVR# + 1;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:186  

  10621  3 000545   200017 054100                    AOS     MINSRVR#,,AUTO
         3 000546   000552 710000 3                  TRA     s:10625

      988    10622    4                       ELSE
      989    10623    4                           IF ACTION = %CLNT THEN

  10623  3 000547   000001 115007                    CMPA    1,DL
         3 000550   000552 601000 3                  TNZ     s:10625

      990    10624    4                               MINCLNT# = MINCLNT# + 1;

  10624  3 000551   200016 054100                    AOS     MINCLNT#,,AUTO

      991    10625    4                   J = P$->APPL.Z.LINK;

  10625  3 000552   000000 471500                    LDP1    0,,PR0
         3 000553   100000 236100                    LDQ     0,,PR1
         3 000554   000777 376007                    ANQ     511,DL
         3 000555   200006 756100                    STQ     J,,AUTO

      992    10626    4                   END;

  10626  3 000556   000516 605400 3                  TPNZ    s:10616
         3 000557   000620 710000 3                  TRA     DONE

      993    10627    3           CASE( %CLNT);

      994    10628    3               IF FLAG OR P$->APPL.LDCTX > 0 THEN

  10628  3 000560   200026 470500                    LDP0    @FLAG,,AUTO
         3 000561   000000 066500                    CMPB    filb='0'B
         3 000562   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 000563   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000564   000571 601000 3                  TNZ     s:10629
         3 000565   200025 471500                    LDP1    @P$,,AUTO
         3 000566   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:187  
         3 000567   300000 220100                    LDX0    0,,PR3
         3 000570   000575 600000 3                  TZE     s:10630

      995    10629    3                   CALL DSPMAJCLNT( P$);

  10629  3 000571   200025 236100                    LDQ     @P$,,AUTO
         3 000572   200031 756100                    STQ     ACTION+2,,AUTO
         3 000573   000631 701000 3                  TSX1    DSPMAJCLNT
         3 000574   000000 011000                    NOP     0

      996    10630    3               IF P$->APPL.LDCTX > 0 THEN

  10630  3 000575   200025 470500                    LDP0    @P$,,AUTO
         3 000576   000000 471500                    LDP1    0,,PR0
         3 000577   100000 220100                    LDX0    0,,PR1
         3 000600   000510 601000 3                  TNZ     CHAINCHK
         3 000601   000620 710000 3                  TRA     DONE

      997    10631    3                   GOTO CHAINCHK;
      998    10632    3           CASE( %FREE);

      999    10633    3               IF FLAG OR P$->APPL.TCTX > 0 THEN

  10633  3 000602   200026 470500                    LDP0    @FLAG,,AUTO
         3 000603   000000 066500                    CMPB    filb='0'B
         3 000604   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 000605   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000606   000613 601000 3                  TNZ     s:10634
         3 000607   200025 471500                    LDP1    @P$,,AUTO
         3 000610   100000 473500                    LDP3    0,,PR1
         3 000611   300000 220100                    LDX0    0,,PR3
         3 000612   000617 600000 3                  TZE     s:10635

     1000    10634    3                   CALL DSPMIN( P$);

  10634  3 000613   200025 236100                    LDQ     @P$,,AUTO
         3 000614   200031 756100                    STQ     ACTION+2,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:188  
         3 000615   000650 701000 3                  TSX1    DSPMIN
         3 000616   000000 011000                    NOP     0

     1001    10635    3               GOTO CHAINCHK;

  10635  3 000617   000510 710000 3                  TRA     CHAINCHK

     1002    10636    3           END;

     1003    10637    2   DONE:
     1004    10638    2       RETURN;

  10638  3 000620   200024 221300       DONE         LDX1  ! X+2,,AUTO
         3 000621   000001 702211                    TSX2  ! 1,X1

     1005    10639
     1006    10640    2       END CHAIN;
     1007    10641        %EJECT;
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:189  
     1008    10642    1   DISPLAY: PROC( P$);

  10642  3 000622   200030 741300       DISPLAY      STX1  ! ACTION+1,,AUTO
         3 000623   000625 710000 3                  TRA     s:10658

     1009    10643
     1010    10644    2       DCL ACTION SBIN;
     1011    10645    2       DCL FMT_ VECTOR;
     1012    10646    2       DCL LS83 UBIN STATIC;
     1013    10647    2       DCL LS83_ VECTOR CONSTANT INIT( VECTOR( LS83));
     1014    10648    2       DCL MAJ SBIN STATIC;
     1015    10649    2       DCL MAJ_ VECTOR CONSTANT INIT( VECTOR( MAJ));
     1016    10650    2       DCL MIN SBIN STATIC;
     1017    10651    2       DCL MIN_ VECTOR CONSTANT INIT( VECTOR( MIN));
     1018    10652    2       DCL P$ PTR;
     1019    10653    2       DCL SCID UBIN STATIC;
     1020    10654    2       DCL SCID_ VECTOR CONSTANT INIT( VECTOR( SCID));
     1021    10655
     1022    10656    2   DSPMAJSRVR: ENTRY( P$);  /* display single major table entry (server type) */

  10656  3 000624   200030 741300       DSPMAJSRVR   STX1  ! ACTION+1,,AUTO

     1023    10657
     1024    10658    2       ACTION = %SRVR;

  10658  3 000625   200032 450100                    STZ     ACTION,,AUTO

     1025    10659    2       FMT_ = FMTMAJSRVR_;

  10659  3 000626   000040 237000 2                  LDAQ    FMTMAJSRVR_
         3 000627   200034 757100                    STAQ    FMT_,,AUTO

     1026    10660    2       GOTO MAJCOMMON;

  10660  3 000630   000636 710000 3                  TRA     MAJCOMMON

     1027    10661
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:190  
     1028    10662    2   DSPMAJCLNT: ENTRY( P$);  /* display single major table entry (client type) */

  10662  3 000631   200030 741300       DSPMAJCLNT   STX1  ! ACTION+1,,AUTO

     1029    10663
     1030    10664    2       ACTION = %CLNT;

  10664  3 000632   000001 235007                    LDA     1,DL
         3 000633   200032 755100                    STA     ACTION,,AUTO

     1031    10665    2       FMT_ = FMTMAJCLNT_;

  10665  3 000634   000020 237000 2                  LDAQ    FMTMAJCLNT_
         3 000635   200034 757100                    STAQ    FMT_,,AUTO

     1032    10666    2   MAJCOMMON:
     1033    10667    2       SCTX = POFFW( P$, KIS_MAJOR$);

  10667  3 000636   200007 235100       MAJCOMMON    LDA     KIS_MAJOR$,,AUTO
         3 000637   000022 771000                    ARL     18
         3 000640   200036 755100                    STA     FMT_+2,,AUTO
         3 000641   200031 470500                    LDP0    @P$,,AUTO
         3 000642   000000 236100                    LDQ     0,,PR0
         3 000643   000022 772000                    QRL     18
         3 000644   200036 136100                    SBLQ    FMT_+2,,AUTO
         3 000645   000000 756000 1                  STQ     SCTX

     1034    10668    2       MIN = 0;

  10668  3 000646   000101 450000 1                  STZ     MIN

     1035    10669    2       GOTO COMMON;

  10669  3 000647   000665 710000 3                  TRA     COMMON

     1036    10670
     1037    10671    2   DSPMIN: ENTRY( P$);   /* display single minor table entry */
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:191  

  10671  3 000650   200030 741300       DSPMIN       STX1  ! ACTION+1,,AUTO

     1038    10672
     1039    10673    2       ACTION = %FREE;

  10673  3 000651   000002 235007                    LDA     2,DL
         3 000652   200032 755100                    STA     ACTION,,AUTO

     1040    10674    2       FMT_ = FMTMIN_;

  10674  3 000653   000062 237000 2                  LDAQ    FMTMIN_
         3 000654   200034 757100                    STAQ    FMT_,,AUTO

     1041    10675    2       MIN = POFFW( P$, KIS_MINOR$);

  10675  3 000655   200010 235100                    LDA     KIS_MINOR$,,AUTO
         3 000656   000022 771000                    ARL     18
         3 000657   200036 755100                    STA     FMT_+2,,AUTO
         3 000660   200031 470500                    LDP0    @P$,,AUTO
         3 000661   000000 236100                    LDQ     0,,PR0
         3 000662   000022 772000                    QRL     18
         3 000663   200036 136100                    SBLQ    FMT_+2,,AUTO
         3 000664   000101 756000 1                  STQ     MIN

     1042    10676    2   COMMON:
     1043    10677    3       IF NEEDHDR THEN DO;

  10677  3 000665   200020 234100       COMMON       SZN     NEEDHDR,,AUTO
         3 000666   000674 605000 3                  TPL     s:10681

     1044    10678    3           CALL DAF$INIT( RPT);

  10678  3 000667   000014 630400 4                  EPPR0   12
         3 000670   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000671   000000 701000 xent               TSX1    DAF$INIT
         3 000672   000000 011000                    NOP     0
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:192  

     1045    10679    3           NEEDHDR = %NO#;

  10679  3 000673   200020 450100                    STZ     NEEDHDR,,AUTO

     1046    10680    3           END;

     1047    10681    2       LS83 = ADDR( P$)->B$HALF;

  10681  3 000674   200031 470500                    LDP0    @P$,,AUTO
         3 000675   000000 236100                    LDQ     0,,PR0
         3 000676   000022 772000                    QRL     18
         3 000677   000077 756000 1                  STQ     LS83

     1048    10682    2       MAJ = SCTX;

  10682  3 000700   000000 235000 1                  LDA     SCTX
         3 000701   000100 755000 1                  STA     MAJ

     1049    10683    2       SCID = MAJ*512 + MIN;

  10683  3 000702   000100 236000 1                  LDQ     MAJ
         3 000703   000011 736000                    QLS     9
         3 000704   000101 036000 1                  ADLQ    MIN
         3 000705   000102 756000 1                  STQ     SCID

     1050    10684    3       DO CASE( ACTION);

  10684  3 000706   200032 235100                    LDA     ACTION,,AUTO
         3 000707   000003 115007                    CMPA    3,DL
         3 000710   000712 602005 3                  TNC     s:10684+4,AL
         3 000711   001106 710000 3                  TRA     s:10715
         3 000712   000715 710000 3                  TRA     s:10695
         3 000713   001005 710000 3                  TRA     s:10697
         3 000714   001046 710000 3                  TRA     s:10706

     1051    10685    3           CASE( %SRVR);
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:193  

     1052    10686    3               CALL DAF$WRITE( FMT_,
     1053    10687    3                       LS83_,
     1054    10688    3                       SCTX_,
     1055    10689    3                       TYPE_,
     1056    10690    3                       MAJ_,
     1057    10691    3                       SCID_,
     1058    10692    3                       VECTOR( P$->APPL.LDCTX),
     1059    10693    3                       VECTOR( P$->APPL.AUDCT),
     1060    10694    3                       VECTOR( P$->APPL.Z.USER),
     1061    10695    3                       VECTOR( SUBSTR( P$->APPL.TSAP.TSAP, 0, P$->APPL.TSAP.LEN)));

  10695  3 000715   000000 471500                    LDP1    0,,PR0
         3 000716   377640 235007                    LDA     130976,DL
         3 000717   200036 451500                    STP1    FMT_+2,,AUTO
         3 000720   200036 236100                    LDQ     FMT_+2,,AUTO
         3 000721   000000 473500                    LDP3    0,,PR0
         3 000722   200040 757100                    STAQ    FMT_+4,,AUTO
         3 000723   377640 235007                    LDA     130976,DL
         3 000724   200042 453500                    STP3    FMT_+6,,AUTO
         3 000725   200042 236100                    LDQ     FMT_+6,,AUTO
         3 000726   000015 036000 4                  ADLQ    13
         3 000727   000000 474500                    LDP4    0,,PR0
         3 000730   200044 757100                    STAQ    FMT_+8,,AUTO
         3 000731   177640 235007                    LDA     65440,DL
         3 000732   200046 454500                    STP4    FMT_+10,,AUTO
         3 000733   200046 236100                    LDQ     FMT_+10,,AUTO
         3 000734   400000 036007                    ADLQ    -131072,DL
         3 000735   000000 475500                    LDP5    0,,PR0
         3 000736   500001 220100                    LDX0    1,,PR5
         3 000737   200050 757100                    STAQ    FMT_+12,,AUTO
         3 000740   000000 635010                    EAA     0,X0
         3 000741   000002 771000                    ARL     2
         3 000742   000140 135007                    SBLA    96,DL
         3 000743   200052 455500                    STP5    FMT_+14,,AUTO
         3 000744   200052 236100                    LDQ     FMT_+14,,AUTO
         3 000745   000016 036000 4                  ADLQ    14
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:194  
         3 000746   200056 757100                    STAQ    FMT_+18,,AUTO
         3 000747   200040 237100                    LDAQ    FMT_+4,,AUTO
         3 000750   200054 757100                    STAQ    FMT_+16,,AUTO
         3 000751   200044 237100                    LDAQ    FMT_+8,,AUTO
         3 000752   200060 757100                    STAQ    FMT_+20,,AUTO
         3 000753   200050 237100                    LDAQ    FMT_+12,,AUTO
         3 000754   200062 757100                    STAQ    FMT_+22,,AUTO
         3 000755   200056 237100                    LDAQ    FMT_+18,,AUTO
         3 000756   200064 757100                    STAQ    FMT_+24,,AUTO
         3 000757   200064 636500                    EPPR6   FMT_+24,,AUTO
         3 000760   200077 456500                    STP6    FMT_+35,,AUTO
         3 000761   200062 637500                    EPPR7   FMT_+22,,AUTO
         3 000762   200076 457500                    STP7    FMT_+34,,AUTO
         3 000763   200060 630500                    EPPR0   FMT_+20,,AUTO
         3 000764   200075 450500                    STP0    FMT_+33,,AUTO
         3 000765   200054 630500                    EPPR0   FMT_+16,,AUTO
         3 000766   200074 450500                    STP0    FMT_+32,,AUTO
         3 000767   000020 237000 4                  LDAQ    16
         3 000770   200072 757100                    STAQ    FMT_+30,,AUTO
         3 000771   000022 237000 4                  LDAQ    18
         3 000772   200070 757100                    STAQ    FMT_+28,,AUTO
         3 000773   000024 236000 4                  LDQ     20
         3 000774   200067 756100                    STQ     FMT_+27,,AUTO
         3 000775   200034 630500                    EPPR0   FMT_,,AUTO
         3 000776   200066 450500                    STP0    FMT_+26,,AUTO
         3 000777   200066 630500                    EPPR0   FMT_+26,,AUTO
         3 001000   000000 220000 xsym               LDX0    DAF$WRITE
         3 001001   000017 631400 4                  EPPR1   15
         3 001002   000000 701010                    TSX1    0,X0
         3 001003   000000 011000                    NOP     0
         3 001004   001106 710000 3                  TRA     s:10715

     1062    10696    3           CASE( %CLNT);

     1063    10697    3               CALL DAF$WRITE( FMT_,

  10697  3 001005   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:195  
         3 001006   377640 235007                    LDA     130976,DL
         3 001007   200036 451500                    STP1    FMT_+2,,AUTO
         3 001010   200036 236100                    LDQ     FMT_+2,,AUTO
         3 001011   000000 473500                    LDP3    0,,PR0
         3 001012   200040 757100                    STAQ    FMT_+4,,AUTO
         3 001013   177640 235007                    LDA     65440,DL
         3 001014   200042 453500                    STP3    FMT_+6,,AUTO
         3 001015   200042 236100                    LDQ     FMT_+6,,AUTO
         3 001016   400000 036007                    ADLQ    -131072,DL
         3 001017   200046 757100                    STAQ    FMT_+10,,AUTO
         3 001020   200040 237100                    LDAQ    FMT_+4,,AUTO
         3 001021   200044 757100                    STAQ    FMT_+8,,AUTO
         3 001022   200046 237100                    LDAQ    FMT_+10,,AUTO
         3 001023   200050 757100                    STAQ    FMT_+12,,AUTO
         3 001024   200050 634500                    EPPR4   FMT_+12,,AUTO
         3 001025   200061 454500                    STP4    FMT_+21,,AUTO
         3 001026   200044 635500                    EPPR5   FMT_+8,,AUTO
         3 001027   200060 455500                    STP5    FMT_+20,,AUTO
         3 001030   000020 237000 4                  LDAQ    16
         3 001031   200056 757100                    STAQ    FMT_+18,,AUTO
         3 001032   000022 237000 4                  LDAQ    18
         3 001033   200054 757100                    STAQ    FMT_+16,,AUTO
         3 001034   000024 236000 4                  LDQ     20
         3 001035   200053 756100                    STQ     FMT_+15,,AUTO
         3 001036   200034 636500                    EPPR6   FMT_,,AUTO
         3 001037   200052 456500                    STP6    FMT_+14,,AUTO
         3 001040   200052 630500                    EPPR0   FMT_+14,,AUTO
         3 001041   000000 220000 xsym               LDX0    DAF$WRITE
         3 001042   000026 631400 xsym               EPPR1   B_VECTNIL+22
         3 001043   000000 701010                    TSX1    0,X0
         3 001044   000000 011000                    NOP     0
         3 001045   001106 710000 3                  TRA     s:10715

     1064    10698    3                       LS83_,
     1065    10699    3                       SCTX_,
     1066    10700    3                       TYPE_,
     1067    10701    3                       MAJ_,
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:196  
     1068    10702    3                       SCID_,
     1069    10703    3                       VECTOR( P$->APPL.LDCTX),
     1070    10704    3                       VECTOR( P$->APPL.Z.USER));
     1071    10705    3           CASE( %FREE);

     1072    10706    3               CALL DAF$WRITE( FMT_,

  10706  3 001046   000000 471500                    LDP1    0,,PR0
         3 001047   377640 235007                    LDA     130976,DL
         3 001050   200036 451500                    STP1    FMT_+2,,AUTO
         3 001051   200036 236100                    LDQ     FMT_+2,,AUTO
         3 001052   000000 473500                    LDP3    0,,PR0
         3 001053   200040 757100                    STAQ    FMT_+4,,AUTO
         3 001054   177640 235007                    LDA     65440,DL
         3 001055   200042 453500                    STP3    FMT_+6,,AUTO
         3 001056   200042 236100                    LDQ     FMT_+6,,AUTO
         3 001057   400000 036007                    ADLQ    -131072,DL
         3 001060   200046 757100                    STAQ    FMT_+10,,AUTO
         3 001061   200040 237100                    LDAQ    FMT_+4,,AUTO
         3 001062   200044 757100                    STAQ    FMT_+8,,AUTO
         3 001063   200046 237100                    LDAQ    FMT_+10,,AUTO
         3 001064   200050 757100                    STAQ    FMT_+12,,AUTO
         3 001065   200050 634500                    EPPR4   FMT_+12,,AUTO
         3 001066   200061 454500                    STP4    FMT_+21,,AUTO
         3 001067   200044 635500                    EPPR5   FMT_+8,,AUTO
         3 001070   200060 455500                    STP5    FMT_+20,,AUTO
         3 001071   000026 237000 4                  LDAQ    22
         3 001072   200056 757100                    STAQ    FMT_+18,,AUTO
         3 001073   000030 237000 4                  LDAQ    24
         3 001074   200054 757100                    STAQ    FMT_+16,,AUTO
         3 001075   000024 236000 4                  LDQ     20
         3 001076   200053 756100                    STQ     FMT_+15,,AUTO
         3 001077   200034 636500                    EPPR6   FMT_,,AUTO
         3 001100   200052 456500                    STP6    FMT_+14,,AUTO
         3 001101   200052 630500                    EPPR0   FMT_+14,,AUTO
         3 001102   000000 220000 xsym               LDX0    DAF$WRITE
         3 001103   000026 631400 xsym               EPPR1   B_VECTNIL+22
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:197  
         3 001104   000000 701010                    TSX1    0,X0
         3 001105   000000 011000                    NOP     0

     1073    10707    3                       LS83_,
     1074    10708    3                       TYPE_,
     1075    10709    3                       MAJ_,
     1076    10710    3                       MIN_,
     1077    10711    3                       SCID_,
     1078    10712    3                       VECTOR( P$->APPL.TCTX),
     1079    10713    3                       VECTOR( P$->APPL.Z.COOKIE));
     1080    10714    3           END;

     1081    10715    2       RETURN;

  10715  3 001106   200030 221300                    LDX1  ! ACTION+1,,AUTO
         3 001107   000001 702211                    TSX2  ! 1,X1

     1082    10716
     1083    10717    2   DSPMAJSUM: ENTRY;  /* display major table summary */

  10717  3 001110   200030 741300       DSPMAJSUM    STX1  ! ACTION+1,,AUTO

     1084    10718
     1085    10719    2       I = KIS_SSN_CLIENTS + KIS_SSN_SERVERS;

  10719  3 001111   200011 236100                    LDQ     KIS_SSN_CLIENTS,,AUTO
         3 001112   200012 036100                    ADLQ    KIS_SSN_SERVERS,,AUTO
         3 001113   200005 756100                    STQ     I,,AUTO

     1086    10720    2       J = MAJCLNT# + MAJSRVR#;

  10720  3 001114   200014 236100                    LDQ     MAJCLNT#,,AUTO
         3 001115   200015 036100                    ADLQ    MAJSRVR#,,AUTO
         3 001116   200006 756100                    STQ     J,,AUTO

     1087    10721    2       X = I - J;

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:198  
  10721  3 001117   200005 236100                    LDQ     I,,AUTO
         3 001120   200006 136100                    SBLQ    J,,AUTO
         3 001121   200022 756100                    STQ     X,,AUTO

     1088    10722    2       CALL DAF$WRITE( FMTMAJSUM_,

  10722  3 001122   777640 235007                    LDA     -96,DL
         3 001123   200036 452500                    STP2    FMT_+2,,AUTO
         3 001124   200036 236100                    LDQ     FMT_+2,,AUTO
         3 001125   000005 036003                    ADLQ    5,DU
         3 001126   200040 757100                    STAQ    FMT_+4,,AUTO
         3 001127   777640 235007                    LDA     -96,DL
         3 001130   200042 452500                    STP2    FMT_+6,,AUTO
         3 001131   200042 236100                    LDQ     FMT_+6,,AUTO
         3 001132   000012 036003                    ADLQ    10,DU
         3 001133   200044 757100                    STAQ    FMT_+8,,AUTO
         3 001134   777640 235007                    LDA     -96,DL
         3 001135   200046 452500                    STP2    FMT_+10,,AUTO
         3 001136   200046 236100                    LDQ     FMT_+10,,AUTO
         3 001137   000011 036003                    ADLQ    9,DU
         3 001140   200050 757100                    STAQ    FMT_+12,,AUTO
         3 001141   777640 235007                    LDA     -96,DL
         3 001142   200052 452500                    STP2    FMT_+14,,AUTO
         3 001143   200052 236100                    LDQ     FMT_+14,,AUTO
         3 001144   000006 036003                    ADLQ    6,DU
         3 001145   200054 757100                    STAQ    FMT_+16,,AUTO
         3 001146   777640 235007                    LDA     -96,DL
         3 001147   200056 452500                    STP2    FMT_+18,,AUTO
         3 001150   200056 236100                    LDQ     FMT_+18,,AUTO
         3 001151   000015 036003                    ADLQ    13,DU
         3 001152   200060 757100                    STAQ    FMT_+20,,AUTO
         3 001153   777640 235007                    LDA     -96,DL
         3 001154   200062 452500                    STP2    FMT_+22,,AUTO
         3 001155   200062 236100                    LDQ     FMT_+22,,AUTO
         3 001156   000014 036003                    ADLQ    12,DU
         3 001157   200064 757100                    STAQ    FMT_+24,,AUTO
         3 001160   777640 235007                    LDA     -96,DL
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:199  
         3 001161   200066 452500                    STP2    FMT_+26,,AUTO
         3 001162   200066 236100                    LDQ     FMT_+26,,AUTO
         3 001163   000022 036003                    ADLQ    18,DU
         3 001164   200072 757100                    STAQ    FMT_+30,,AUTO
         3 001165   200040 237100                    LDAQ    FMT_+4,,AUTO
         3 001166   200070 757100                    STAQ    FMT_+28,,AUTO
         3 001167   200044 237100                    LDAQ    FMT_+8,,AUTO
         3 001170   200074 757100                    STAQ    FMT_+32,,AUTO
         3 001171   200050 237100                    LDAQ    FMT_+12,,AUTO
         3 001172   200076 757100                    STAQ    FMT_+34,,AUTO
         3 001173   200054 237100                    LDAQ    FMT_+16,,AUTO
         3 001174   200100 757100                    STAQ    FMT_+36,,AUTO
         3 001175   200060 237100                    LDAQ    FMT_+20,,AUTO
         3 001176   200102 757100                    STAQ    FMT_+38,,AUTO
         3 001177   200064 237100                    LDAQ    FMT_+24,,AUTO
         3 001200   200104 757100                    STAQ    FMT_+40,,AUTO
         3 001201   200072 237100                    LDAQ    FMT_+30,,AUTO
         3 001202   200106 757100                    STAQ    FMT_+42,,AUTO
         3 001203   200106 630500                    EPPR0   FMT_+42,,AUTO
         3 001204   200117 450500                    STP0    FMT_+51,,AUTO
         3 001205   200104 631500                    EPPR1   FMT_+40,,AUTO
         3 001206   200116 451500                    STP1    FMT_+50,,AUTO
         3 001207   200102 633500                    EPPR3   FMT_+38,,AUTO
         3 001210   200115 453500                    STP3    FMT_+49,,AUTO
         3 001211   200100 634500                    EPPR4   FMT_+36,,AUTO
         3 001212   200114 454500                    STP4    FMT_+48,,AUTO
         3 001213   200076 635500                    EPPR5   FMT_+34,,AUTO
         3 001214   200113 455500                    STP5    FMT_+47,,AUTO
         3 001215   200074 636500                    EPPR6   FMT_+32,,AUTO
         3 001216   200112 456500                    STP6    FMT_+46,,AUTO
         3 001217   200070 637500                    EPPR7   FMT_+28,,AUTO
         3 001220   200111 457500                    STP7    FMT_+45,,AUTO
         3 001221   000032 236000 4                  LDQ     26
         3 001222   200110 756100                    STQ     FMT_+44,,AUTO
         3 001223   200110 630500                    EPPR0   FMT_+44,,AUTO
         3 001224   000000 220000 xsym               LDX0    DAF$WRITE
         3 001225   000026 631400 xsym               EPPR1   B_VECTNIL+22
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:200  
         3 001226   000000 701010                    TSX1    0,X0
         3 001227   000000 011000                    NOP     0

     1089    10723    2               VECTOR( I),
     1090    10724    2               VECTOR( KIS_SSN_SERVERS),
     1091    10725    2               VECTOR( KIS_SSN_CLIENTS),
     1092    10726    2               VECTOR( J),
     1093    10727    2               VECTOR( MAJSRVR#),
     1094    10728    2               VECTOR( MAJCLNT#),
     1095    10729    2               VECTOR( X));
     1096    10730    2       RETURN;

  10730  3 001230   200030 221300                    LDX1  ! ACTION+1,,AUTO
         3 001231   000001 702211                    TSX2  ! 1,X1

     1097    10731
     1098    10732    2   DSPMINSUM: ENTRY;  /* display minor table summary */

  10732  3 001232   200030 741300       DSPMINSUM    STX1  ! ACTION+1,,AUTO

     1099    10733
     1100    10734    2       I = KIS_SSN_MAX;

  10734  3 001233   200013 235100                    LDA     KIS_SSN_MAX,,AUTO
         3 001234   200005 755100                    STA     I,,AUTO

     1101    10735    2       J = MINCLNT# + MINSRVR#;

  10735  3 001235   200016 236100                    LDQ     MINCLNT#,,AUTO
         3 001236   200017 036100                    ADLQ    MINSRVR#,,AUTO
         3 001237   200006 756100                    STQ     J,,AUTO

     1102    10736    2       X = I - J;

  10736  3 001240   200005 236100                    LDQ     I,,AUTO
         3 001241   200006 136100                    SBLQ    J,,AUTO
         3 001242   200022 756100                    STQ     X,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:201  

     1103    10737    2       CALL DAF$WRITE( FMTMINSUM_,

  10737  3 001243   777640 235007                    LDA     -96,DL
         3 001244   200036 452500                    STP2    FMT_+2,,AUTO
         3 001245   200036 236100                    LDQ     FMT_+2,,AUTO
         3 001246   000005 036003                    ADLQ    5,DU
         3 001247   200040 757100                    STAQ    FMT_+4,,AUTO
         3 001250   777640 235007                    LDA     -96,DL
         3 001251   200042 452500                    STP2    FMT_+6,,AUTO
         3 001252   200042 236100                    LDQ     FMT_+6,,AUTO
         3 001253   000013 036003                    ADLQ    11,DU
         3 001254   200044 757100                    STAQ    FMT_+8,,AUTO
         3 001255   777640 235007                    LDA     -96,DL
         3 001256   200046 452500                    STP2    FMT_+10,,AUTO
         3 001257   200046 236100                    LDQ     FMT_+10,,AUTO
         3 001260   000006 036003                    ADLQ    6,DU
         3 001261   200050 757100                    STAQ    FMT_+12,,AUTO
         3 001262   777640 235007                    LDA     -96,DL
         3 001263   200052 452500                    STP2    FMT_+14,,AUTO
         3 001264   200052 236100                    LDQ     FMT_+14,,AUTO
         3 001265   000017 036003                    ADLQ    15,DU
         3 001266   200054 757100                    STAQ    FMT_+16,,AUTO
         3 001267   777640 235007                    LDA     -96,DL
         3 001270   200056 452500                    STP2    FMT_+18,,AUTO
         3 001271   200056 236100                    LDQ     FMT_+18,,AUTO
         3 001272   000016 036003                    ADLQ    14,DU
         3 001273   200060 757100                    STAQ    FMT_+20,,AUTO
         3 001274   777640 235007                    LDA     -96,DL
         3 001275   200062 452500                    STP2    FMT_+22,,AUTO
         3 001276   200062 236100                    LDQ     FMT_+22,,AUTO
         3 001277   000022 036003                    ADLQ    18,DU
         3 001300   200066 757100                    STAQ    FMT_+26,,AUTO
         3 001301   200040 237100                    LDAQ    FMT_+4,,AUTO
         3 001302   200064 757100                    STAQ    FMT_+24,,AUTO
         3 001303   200044 237100                    LDAQ    FMT_+8,,AUTO
         3 001304   200070 757100                    STAQ    FMT_+28,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:202  
         3 001305   200050 237100                    LDAQ    FMT_+12,,AUTO
         3 001306   200072 757100                    STAQ    FMT_+30,,AUTO
         3 001307   200054 237100                    LDAQ    FMT_+16,,AUTO
         3 001310   200074 757100                    STAQ    FMT_+32,,AUTO
         3 001311   200060 237100                    LDAQ    FMT_+20,,AUTO
         3 001312   200076 757100                    STAQ    FMT_+34,,AUTO
         3 001313   200066 237100                    LDAQ    FMT_+26,,AUTO
         3 001314   200100 757100                    STAQ    FMT_+36,,AUTO
         3 001315   200100 630500                    EPPR0   FMT_+36,,AUTO
         3 001316   200110 450500                    STP0    FMT_+44,,AUTO
         3 001317   200076 631500                    EPPR1   FMT_+34,,AUTO
         3 001320   200107 451500                    STP1    FMT_+43,,AUTO
         3 001321   200074 633500                    EPPR3   FMT_+32,,AUTO
         3 001322   200106 453500                    STP3    FMT_+42,,AUTO
         3 001323   200072 634500                    EPPR4   FMT_+30,,AUTO
         3 001324   200105 454500                    STP4    FMT_+41,,AUTO
         3 001325   200070 635500                    EPPR5   FMT_+28,,AUTO
         3 001326   200104 455500                    STP5    FMT_+40,,AUTO
         3 001327   200064 636500                    EPPR6   FMT_+24,,AUTO
         3 001330   200103 456500                    STP6    FMT_+39,,AUTO
         3 001331   000033 236000 4                  LDQ     27
         3 001332   200102 756100                    STQ     FMT_+38,,AUTO
         3 001333   200102 630500                    EPPR0   FMT_+38,,AUTO
         3 001334   000000 220000 xsym               LDX0    DAF$WRITE
         3 001335   000025 631400 xsym               EPPR1   B_VECTNIL+21
         3 001336   000000 701010                    TSX1    0,X0
         3 001337   000000 011000                    NOP     0

     1104    10738    2               VECTOR( I),
     1105    10739    2               VECTOR( KIS_SSN_MAX),
     1106    10740    2               VECTOR( J),
     1107    10741    2               VECTOR( MINSRVR#),
     1108    10742    2               VECTOR( MINCLNT#),
     1109    10743    2               VECTOR( X));
     1110    10744    2       RETURN;

  10744  3 001340   200030 221300                    LDX1  ! ACTION+1,,AUTO
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:203  
         3 001341   000001 702211                    TSX2  ! 1,X1
     1111    10745
     1112    10746    2       END DISPLAY;
     1113    10747
     1114    10748    1       END DAD$SCTX;

PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:204  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   K_SESSION_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$SCTX.
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:205  

 **** Variables and constants ****

  ****  Section 001  Data  DAD$SCTX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    77-0-0/w UBIN        r     1 LS83                     100-0-0/w SBIN        r     1 MAJ
   101-0-0/w SBIN        r     1 MIN                        2-0-0/w STRC(288)   r     1 RPT
    21-0-0/w STRC(144)   r     1 RPTHD00                   46-0-0/w STRC(144)   r     1 RPTHD01
    12-0-0/c STRC(225)   r     1 RPTTX00                   25-0-0/c STRC(612)   r     1 RPTTX01
    52-0-0/c STRC(747)   r     1 RPTTX02                  102-0-0/w UBIN        r     1 SCID
     0-0-0/w UBIN        r     1 SCTX                       1-0-0/c CHAR(4)     r     1 TYPE

  ****  Section 002 RoData DAD$SCTX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/c CHAR(45)    r     1 FMTMAJCLNT                20-0-0/d VECT        r     1 FMTMAJCLNT_
    22-0-0/c CHAR(49)    r     1 FMTMAJSRVR                40-0-0/d VECT        r     1 FMTMAJSRVR_
    64-0-0/c CHAR(79)    r     1 FMTMAJSUM                110-0-0/d VECT        r     1 FMTMAJSUM_
    42-0-0/c CHAR(64)    r     1 FMTMIN                   112-0-0/c CHAR(78)    r     1 FMTMINSUM
   136-0-0/d VECT        r     1 FMTMINSUM_                62-0-0/d VECT        r     1 FMTMIN_
   140-0-0/d VECT        r     1 LS83_                    142-0-0/d VECT        r     1 MAJ_
   144-0-0/d VECT        r     1 MIN_                     146-0-0/d VECT        r     1 SCID_
     0-0-0/d VECT        r     1 SCTX_                      2-0-0/d VECT        r     1 TYPE_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    26-0-0/w PTR         r     1 @FLAG                     25-0-0/w PTR         r     1 @P$
    31-0-0/w PTR         r     1 @P$                        3-0-0/w PTR         r     1 @TOP
    27-0-0/w SBIN        r     1 ACTION                    32-0-0/w SBIN        r     1 ACTION
     4-0-0/b BIT         r     1 DISPALL                   *0-0-0/b BIT         r     1 FLAG
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:206  
    34-0-0/d VECT        r     1 FMT_                       5-0-0/w SBIN        r     1 I
     6-0-0/w SBIN        r     1 J                          7-0-0/w PTR         r     1 KIS_MAJOR$
    10-0-0/w PTR         r     1 KIS_MINOR$                11-0-0/w SBIN        r     1 KIS_SSN_CLIENTS
    13-0-0/w SBIN        r     1 KIS_SSN_MAX               12-0-0/w SBIN        r     1 KIS_SSN_SERVERS
    14-0-0/w SBIN        r     1 MAJCLNT#                  15-0-0/w SBIN        r     1 MAJSRVR#
    16-0-0/w SBIN        r     1 MINCLNT#                  17-0-0/w SBIN        r     1 MINSRVR#
    20-0-0/b BIT         r     1 NEEDHDR                   21-0-0/w PTR         r     1 P$
    *0-0-0/w PTR         r     1 P$                        *0-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(144)   r     1 TOP                       22-0-0/w SBIN        r     1 X

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/b BIT (72)    r     1 DA_MONISDATA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(360)   r     1 APPL                       0-0-0/w UBIN(18)    r     1 B$HALF
     0-0-0/w PTR         r     1 B$PTR                      0-0-0/w SBIN        r     1 B$SBIN
     0-0-0/w STRC(144)   r     1 OUT


   Procedure DAD$SCTX requires 738 words for executable code.
   Procedure DAD$SCTX requires 82 words of local(AUTO) storage.

    No errors detected in file DAD$ROUTE.:E05TSI    .
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:207  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:208  
          MINI XREF LISTING

ACTION IN PROCEDURE CHAIN
     10578**DCL     10587<<ASSIGN  10595<<ASSIGN  10603<<ASSIGN  10607>>DOCASE  10620>>IF      10623>>IF
ACTION IN PROCEDURE DISPLAY
     10644**DCL     10658<<ASSIGN  10664<<ASSIGN  10673<<ASSIGN  10684>>DOCASE
APPL.AUDCT
      7106**DCL     10695--CALL
APPL.CLNTHD
      7066**DCL      7067--REDEF
APPL.LDCTX
      7064**DCL     10589>>IF      10597>>IF      10609>>IF      10611>>IF      10628>>IF      10630>>IF
     10695--CALL    10697--CALL
APPL.TCTX
      7063**DCL      7064--REDEF    7065--REDEF   10617>>IF      10619>>IF      10633>>IF      10706--CALL
APPL.TSAP.LEN
      7091**DCL     10695>>CALL
APPL.TSAP.TSAP
      7099**DCL     10695--CALL
APPL.Z.COOKIE
      7068**DCL      7069--REDEF   10706--CALL
APPL.Z.LINK
      7070**DCL     10569>>ASSIGN  10614>>ASSIGN  10625>>ASSIGN
APPL.Z.USER
      7069**DCL     10695--CALL    10697--CALL
B$HALF
     10311**DCL     10681>>ASSIGN
B$PTR
     10312**DCL     10518>>ASSIGN  10523>>ASSIGN
B$SBIN
     10313**DCL     10506>>ASSIGN  10510>>ASSIGN  10514>>ASSIGN
CHAINCHK IN PROCEDURE CHAIN
     10614**LABEL   10631--GOTO    10635--GOTO
COMMON IN PROCEDURE CHAIN
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:209  
     10607**LABEL   10591--GOTO    10599--GOTO
COMMON IN PROCEDURE DISPLAY
     10677**LABEL   10669--GOTO
DAA$VALUE
     10305**DCL-ENT 10533--CALL    10541--CALL
DAF$INIT
     10306**DCL-ENT 10678--CALL
DAF$WRITE
     10307**DCL     10695>>CALL    10697>>CALL    10706>>CALL    10722>>CALL    10737>>CALL
DAM$MAP
     10308**DCL-ENT 10505--CALL    10509--CALL    10513--CALL    10517--CALL    10519--CALL    10522--CALL
     10524--CALL
DAS$SDMONPTR
     10309**DCL-ENT 10504--CALL    10508--CALL    10512--CALL    10516--CALL    10521--CALL
DA_MAPSEG.P
      6441**DCL      6442--REDEF
DA_MONISDATA
      6434**DCL     10505<>CALL    10509<>CALL    10513<>CALL    10517<>CALL    10522<>CALL
DA_SDASN.DESC.TYPE0
      6426**DCL      6426--REDEF
DA_TIGRSEG.P
      6442**DCL      6443--REDEF
DISPALL
     10314**DCL     10530<<ASSIGN  10535<<ASSIGN  10559<>CALL    10564<>CALL    10568>>IF
DONE
     10574**LABEL   10504--CALLALT 10505--CALLALT 10508--CALLALT 10509--CALLALT 10512--CALLALT 10513--CALLALT
     10516--CALLALT 10517--CALLALT 10521--CALLALT 10522--CALLALT
DONE IN PROCEDURE CHAIN
     10638**LABEL   10612--GOTO
DSPMAJCLNT IN PROCEDURE DISPLAY
     10662**ENTRY   10629--CALL
DSPMAJSRVR IN PROCEDURE DISPLAY
     10656**ENTRY   10610--CALL
DSPMAJSUM IN PROCEDURE DISPLAY
     10717**ENTRY   10566--CALL
DSPMIN IN PROCEDURE DISPLAY
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:210  
     10671**ENTRY   10618--CALL    10634--CALL
DSPMINSUM IN PROCEDURE DISPLAY
     10732**ENTRY   10572--CALL
FLAG IN PROCEDURE CHAIN
     10583**DCL     10576--PROC    10585--ENTRY   10593--ENTRY   10601--ENTRY   10609>>IF      10617>>IF
     10628>>IF      10633>>IF
FMTMAJCLNT
     10487**DCL     10489--DCLINIT
FMTMAJCLNT_
     10489**DCL     10665>>ASSIGN
FMTMAJSRVR
     10490**DCL     10492--DCLINIT
FMTMAJSRVR_
     10492**DCL     10659>>ASSIGN
FMTMAJSUM
     10496**DCL     10498--DCLINIT
FMTMAJSUM_
     10498**DCL     10722<>CALL
FMTMIN
     10493**DCL     10495--DCLINIT
FMTMINSUM
     10499**DCL     10501--DCLINIT
FMTMINSUM_
     10501**DCL     10737<>CALL
FMTMIN_
     10495**DCL     10674>>ASSIGN
FMT_ IN PROCEDURE DISPLAY
     10645**DCL     10659<<ASSIGN  10665<<ASSIGN  10674<<ASSIGN  10695<>CALL    10697<>CALL    10706<>CALL
I
     10315**DCL     10533<>CALL    10534>>IF      10541<>CALL    10542>>IF      10543>>IF      10543>>IF
     10544>>CALL    10549>>IF      10550>>CALL    10557<<DOINDEX 10558>>ASSIGN  10562<<DOINDEX 10563>>ASSIGN
     10719<<ASSIGN  10721>>ASSIGN  10722--CALL    10734<<ASSIGN  10736>>ASSIGN  10737--CALL
J
     10316**DCL     10614<<ASSIGN  10615>>DOWHILE 10616>>ASSIGN  10625<<ASSIGN  10720<<ASSIGN  10721>>ASSIGN
     10722--CALL    10735<<ASSIGN  10736>>ASSIGN  10737--CALL
KIS_MAJOR$
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:211  
     10317**DCL     10518<<ASSIGN  10519<>CALL    10519<>CALL    10544>>CALL    10550>>CALL    10558>>ASSIGN
     10563>>ASSIGN  10667>>ASSIGN
KIS_MINOR$
     10318**DCL     10523<<ASSIGN  10524<>CALL    10524<>CALL    10569>>ASSIGN  10569>>ASSIGN  10616>>ASSIGN
     10675>>ASSIGN
KIS_SSN_CLIENTS
     10319**DCL     10506<<ASSIGN  10549>>IF      10562>>DOINDEX 10719>>ASSIGN  10722--CALL
KIS_SSN_MAX
     10321**DCL     10514<<ASSIGN  10734>>ASSIGN  10737--CALL
KIS_SSN_SERVERS
     10320**DCL     10510<<ASSIGN  10542>>IF      10549>>IF      10557>>DOINDEX 10563>>ASSIGN  10719>>ASSIGN
     10722--CALL
LS83 IN PROCEDURE DISPLAY
     10646**DCL     10647--DCLINIT 10681<<ASSIGN
LS83_ IN PROCEDURE DISPLAY
     10647**DCL     10695<>CALL    10697<>CALL    10706<>CALL
MAJ IN PROCEDURE DISPLAY
     10648**DCL     10649--DCLINIT 10682<<ASSIGN  10683>>ASSIGN
MAJCLNT IN PROCEDURE CHAIN
     10593**ENTRY   10550--CALL    10564--CALL
MAJCLNT#
     10322**DCL     10526<<ASSIGN  10598<<ASSIGN  10598>>ASSIGN  10720>>ASSIGN  10722--CALL
MAJCOMMON IN PROCEDURE DISPLAY
     10667**LABEL   10660--GOTO
MAJSRVR IN PROCEDURE CHAIN
     10585**ENTRY   10544--CALL    10559--CALL
MAJSRVR#
     10323**DCL     10527<<ASSIGN  10590<<ASSIGN  10590>>ASSIGN  10720>>ASSIGN  10722--CALL
MAJ_ IN PROCEDURE DISPLAY
     10649**DCL     10695<>CALL    10697<>CALL    10706<>CALL
MIN IN PROCEDURE DISPLAY
     10650**DCL     10651--DCLINIT 10668<<ASSIGN  10675<<ASSIGN  10683>>ASSIGN
MINCLNT#
     10324**DCL     10528<<ASSIGN  10624<<ASSIGN  10624>>ASSIGN  10735>>ASSIGN  10737--CALL
MINFREE IN PROCEDURE CHAIN
     10601**ENTRY   10570--CALL
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:212  
MINSRVR#
     10325**DCL     10529<<ASSIGN  10621<<ASSIGN  10621>>ASSIGN  10735>>ASSIGN  10737--CALL
MIN_ IN PROCEDURE DISPLAY
     10651**DCL     10706<>CALL
NEEDHDR
     10326**DCL     10531<<ASSIGN  10677>>IF      10679<<ASSIGN
NEXT
     10552**LABEL   10541--CALLALT 10546--GOTO
OUT
     10265**DCL     10533<>CALL    10541<>CALL
P$
     10327**DCL     10504<>CALL    10505<>CALL    10505<>CALL    10506>>ASSIGN  10508<>CALL    10509<>CALL
     10509<>CALL    10510>>ASSIGN  10512<>CALL    10513<>CALL    10513<>CALL    10514>>ASSIGN  10516<>CALL
     10517<>CALL    10517<>CALL    10518>>ASSIGN  10521<>CALL    10522<>CALL    10522<>CALL    10523>>ASSIGN
     10558<<ASSIGN  10559<>CALL    10563<<ASSIGN  10564<>CALL    10569<<ASSIGN  10570<>CALL
P$ IN PROCEDURE CHAIN
     10582**DCL     10576--PROC    10585--ENTRY   10589>>IF      10593--ENTRY   10597>>IF      10601--ENTRY
     10609>>IF      10610<>CALL    10611>>IF      10614>>ASSIGN  10616<<ASSIGN  10617>>IF      10618<>CALL
     10619>>IF      10625>>ASSIGN  10628>>IF      10629<>CALL    10630>>IF      10633>>IF      10634<>CALL
P$ IN PROCEDURE DISPLAY
     10652**DCL     10642--PROC    10656--ENTRY   10662--ENTRY   10667>>ASSIGN  10671--ENTRY   10675>>ASSIGN
     10681--ASSIGN  10695>>CALL    10695>>CALL    10695>>CALL    10695>>CALL    10695>>CALL    10697>>CALL
     10697>>CALL    10706>>CALL    10706>>CALL
RPT
     10352**DCL     10678<>CALL
RPTHD00
     10419**DCL     10387--DCLINIT
RPTHD01
     10462**DCL     10434--DCLINIT
RPTTX00
     10395**DCL     10382--DCLINIT
RPTTX01
     10437**DCL     10427--DCLINIT
RPTTX02
     10480**DCL     10470--DCLINIT
RUNALL
PL6.E3A0      #003=DAD$SCTX File=DAD$ROUTE.:E05TSI                               TUE 07/29/97 12:45 Page:213  
     10557**LABEL   10533--CALLALT 10536--GOTO
SCID IN PROCEDURE DISPLAY
     10653**DCL     10654--DCLINIT 10683<<ASSIGN
SCID_ IN PROCEDURE DISPLAY
     10654**DCL     10695<>CALL    10697<>CALL    10706<>CALL
SCTX
     10328**DCL     10329--DCLINIT 10605<<ASSIGN  10667<<ASSIGN  10682>>ASSIGN
SCTX_
     10329**DCL     10695<>CALL    10697<>CALL
TOP
     10220**DCL        10--PROC
TOP.NSUBLKS
     10232**DCL     10532>>IF      10539>>IF      10540>>DOINDEX
TOP.SUBLK$
     10253**DCL     10533>>CALL    10541>>CALL
TYPE
     10330**DCL     10331--DCLINIT 10588<<ASSIGN  10596<<ASSIGN  10604<<ASSIGN
TYPE_
     10331**DCL     10695<>CALL    10697<>CALL    10706<>CALL
X
     10332**DCL     10540<<DOINDEX 10541>>CALL    10721<<ASSIGN  10722--CALL    10736<<ASSIGN  10737--CALL
