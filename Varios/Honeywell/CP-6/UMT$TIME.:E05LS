VERSION E05

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:1    
        1        1        /*M*  UMT$TIME:    MONITOR DATE AND TIME SERVICE PROCEDURE            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /*                                                                    */
        9        9        /*    TRANSLATE LOCAL FORMAT DATE AND TIME TO UTS                     */
       10       10        /*                                                                    */
       11       11        UMT$LCLDATE: PROC(UTSTMP,DATE,TIME) ALTRET;
       12       12        /*                                                                    */
       13       13    1   DCL   UTSTMP UBIN(36);
       14       14    1   DCL   DATE CHAR(8);
       15       15    1   DCL   DTCHR(0:7) REDEF DATE CHAR(1);
       16       16    1   DCL   DTASC(0:7) REDEF DATE UBIN BYTE CALIGNED;
       17       17    1   DCL   TIME CHAR(5);
       18       18    1   DCL   TMASC(0:4) REDEF TIME UBIN BYTE CALIGNED;
       19       19    1   DCL   TMCHR(0:4) REDEF TIME CHAR(1);
       20       20        /*                                                                    */
       21       21    1   DCL   SSS$SYSTIME ENTRY(1);             /* GET CURRENT UTS                    */
       22       22    1   DCL   SSS$SETBTIME ENTRY(1);
       23       23    1   DCL SSS$UTS_L6 ENTRY(2) ALTRET;
       24       24    1   DCL SSS$L6_UTS ENTRY(2) ALTRET;
       25       25    1   DCL   HFF$DSIZ ENTRY(2);
       26       26    1   DCL   HFF$NILERASE ENTRY(1) ALTRET;
       27       27    1   DCL TMB$MCA ENTRY(4) ALTRET;
       28       28    1   DCL TMB$BUF_ALLOC ENTRY(3) ALTRET;
       29       29    1   DCL TMB$BUF_DEALLOC ENTRY(2) ALTRET;
       30       30
       31       31                                                /* LAST-DELIVERED UNIQUE TIMESTAMP */
       32       32    1   DCL UMT_UNIQUE UBIN WORD STATIC SYMDEF;
       33       33
       34       34
       35       35        /*                                                                    */
       36       36    1   DCL   B$JIT$ PTR SYMREF;
       37       37    1   DCL B_BYEAR CONSTANT UBIN(36) INIT(78); /* SYS ORG DATE 1/1/78     */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:2    
       38       38    1   DCL   B_BMON CONSTANT UBIN(36) INIT(1);
       39       39    1   DCL   B_BDAY CONSTANT UBIN(36) INIT(1);
       40       40    1   dcl B_CYEAR constant ubin init(93);     /* UTS cusp -- 01/01/93 00:00:00.00 */
       41       41    1   DCL   A UBIN BASED CALIGNED;
       42       42    1   DCL   AC REDEF A CHAR(4);
       43       43    1   DCL   UTIME UBIN(36);
       44       44    1   DCL   UTIMEC REDEF UTIME CHAR(4);
       45       45    1   DCL   UTI UBIN(36);
       46       46    1   DCL   UTC REDEF UTI CHAR(4);
       47       47    1   DCL   I SBIN;
       48       48    1   DCL   J SBIN;
       49       49    1   DCL   K SBIN;
       50       50    1   DCL   DTSZ UBIN;
       51       51    1   DCL   TMSZ UBIN;
       52       52    1   DCL   TUNITS UBIN(36);
       53       53    1   DCL   T$ PTR;
       54       54    1   DCL B$PS0$ PTR SYMREF;
       55       55    1   DCL B$PS1$ PTR SYMREF;
       56       56    1   DCL B$PS2$ PTR SYMREF;
       57       57    1   DCL B$PS3$ PTR SYMREF;
       58       58    1   DCL B$PS4$ PTR SYMREF;
       59       59    1   DCL   T1$ PTR;
       60       60    1   DCL   ST3 CHAR(3) BASED;
       61       61    1   DCL   ST4 CHAR(4) BASED;
       62       62    1   DCL   ST5 CHAR(5) BASED;
       63       63    1   DCL   ST6 CHAR(6) BASED;
       64       64    1   DCL   ST8 CHAR(8) BASED;
       65       65    1   DCL   ST10 CHAR(10) BASED;
       66       66    1   DCL   STTMSZ CHAR(TMSZ) BASED;
       67       67    1   DCL   HSEC CHAR(2);                     /* 1/100 SEC                          */
       68       68    1   DCL   SEC CHAR(2);
       69       69    1   DCL   CTEMP CHAR(12);
       70       70    1   DCL   MINS CHAR(2);
       71       71    1   DCL   HRS CHAR(2);
       72       72    1   DCL   MON CHAR(2);
       73       73    1   DCL   DAY CHAR(2);
       74       74    1   DCL   YR CHAR(2);
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:3    
       75       75    1   DCL   LD SBIN;                          /* #LEAP DAYS                         */
       76       76    1   DCL   D1 SBIN;                          /* TEMP                               */
       77       77    1   DCL   Y1 UBIN(36);
       78       78    1   DCL   WKD UBIN(36);                     /* DAY OF WEEK                        */
       79       79    1   DCL   JDAY CHAR(3);                     /* JULIEN DAY                         */
       80       80    1   DCL   JD SBIN;                          /*  "                                 */
       81       81    1   DCL   YY_MOD4 SBIN;
       82       82    1   DCL 1 B,
       83       83    1          2 MM SBIN,
       84       84    1          2 DD SBIN,
       85       85    1          2 YY SBIN,
       86       86    1          2 HH SBIN,
       87       87    1          2 MI SBIN,
       88       88    1          2 SS SBIN,
       89       89    1          2 SS00 SBIN;
       90       90    1   DCL   DT(0:6) REDEF B UBIN;
       91       91    1   DCL   ST(0:6) REDEF B SBIN;
       92       92        /*                                                                    */
       93       93    1   DCL   WKDAY(0:6) CONSTANT CHAR(3) INIT(
       94       94    1              'SUN','MON','TUE','WED','THU','FRI','SAT');
       95       95    1   DCL   MONTH(0:11) CONSTANT CHAR(4) INIT(
       96       96    1              'JAN ','FEB ','MAR ','APR ','MAY ','JUN ','JUL ',
       97       97    1              'AUG ','SEP ','OCT ','NOV ','DEC ');
       98       98    1   DCL  MONS(0:51) CONSTANT UBIN(36) INIT( /* each month * 4 - for leap years */
       99       99    1                0,  0,  0,  0,
      100      100    1               31, 31, 31, 31,             /* jan */
      101      101    1               60, 59, 59, 59,             /* feb */
      102      102    1               91, 90, 90, 90,             /* mar */
      103      103    1              121,120,120,120,             /* apr */
      104      104    1              152,151,151,151,             /* may */
      105      105    1              182,181,181,181,             /* jun */
      106      106    1              213,212,212,212,             /* jul */
      107      107    1              244,243,243,243,             /* aug */
      108      108    1              274,273,273,273,             /* sep */
      109      109    1              305,304,304,304,             /* oct */
      110      110    1              335,334,334,334,             /* nov */
      111      111    1              366,365,365,365);            /* dec */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:4    
      112      112    1   DCL   LPS(0:4) UBIN(36) CONSTANT INIT(790,2251,3712,5173,
      113      113    1              6634);
      114      114        /**/
      115      115        %INCLUDE TM_DATA_M;
      116      217        %INCLUDE TM_DATA_R;
      117      226        %INCLUDE HF_DATA_R;
      118      269        %INCLUDE NI$TABLES;
      119      485        %INCLUDE UM_CP6;
      120     1337        %INCLUDE B$TABLES_C;
      121     1445        %B$SR_NON_DEC( NAME=NON_DECIMAL );
      122     1449        %NI$DQH;
      123     1472    1   DCL BUF$ PTR;
      124     1473    1   DCL BUFX SBIN;
      125     1474    1   DCL DQH$ PTR;
      126     1475    1   DCL UTS_B UBIN BASED;
      127     1476        /*                                                                    */
      128     1477        %INCLUDE CP_6_SUBS;
      129     2017        %INCLUDE UD_ERRORS_C;
      130     2059        %INCLUDE UM_ERRORS_C;
      131     2093        %INCLUDE UM$CP6V_C;
      132     2280        %FPT$TIME_V;
      133     2284        %INCLUDE SS_SCHED_C;
      134     2517    1   DCL SSR$REG ENTRY(3) ALTRET;
      135     2518    1   DCL SSS$BLOCK     ENTRY;
      136     2519        %INCLUDE B$JIT_C;
      137     2833        %B$JIT0;
      138     2922        %U$JIT1X;
      139     2925        %M$JIT2X;
      140     2928        %F$JIT3X;
      141     2931        %S$JIT4X;
      142     2934        %J$JIT5X;
      143     2937        %A$JIT6X;
      144     2940        %include XUD_UTS_M;                     /* include file with UTS constants */
      145     3022        %XUD_UTS_EQU;                 /* macro to EQUate UTS constants in this module */
      146     3033        /* UTS value for midnight before rollover:  02/07/20 00:00:00.00 */
      147     3034        %EQU JudgementDay# = chartext ('bitbin (''777773220400''o)');
      148     3035        %EQU B_CDAYS# = 5479; /* UTS_CUSP# / UTS_CSEC_DAY#  days from startup to cusp */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:5    
      149     3036        %EQU B_EDAYS# = 9898; /* JudgementDay#-UTS_CUSP# / UTS_25TH_DAY# casp - Boom */
      150     3037        %XUD$UTS_ENTRIES;
      151     3069        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      152     3088        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:6    
      153     3089    2        DO DTSZ = 0 TO 7;
      154     3090    2           IF DTCHR(DTSZ) = ' ' OR DTCHR(DTSZ) = BINASC(0) THEN
      155     3091    2              GOTO LCLDT1;
      156     3092    2           END;
      157     3093    1        DTSZ=8;
      158     3094    1   LCLDT1:
      159     3095    2        DO TMSZ = 0 TO 4;
      160     3096    2           IF TMCHR(TMSZ) = ' ' OR TMCHR(TMSZ) = BINASC(0) THEN
      161     3097    2              GOTO LCLDT2;
      162     3098    2           END;
      163     3099    1        TMSZ=5;
      164     3100    1   LCLDT2:
      165     3101    1        CALL LOCALDATE(DATE) ALTRET(BADDT);
      166     3102    1        CALL LOCALTIME(TIME) ALTRET(BADDT);
      167     3103    1        CALL DATEUTS;                      /* BUILD UTS                          */
      168     3104    1        if UTIME > %JudgementDay# then
      169     3105    1           GOTO BADDT;
      170     3106    1        UTSTMP=UTIME;
      171     3107    1        RETURN;
      172     3108    1   BADDT: ALTRETURN;
      173     3109        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:7    
      174     3110        /*    RETURN JULIEN DATE FOR CURRENT TIME OR INPUT UTS                */
      175     3111        /*                                                                    */
      176     3112    1   UMT$JDATE: ENTRY(UTSTMP,DATE) ALTRET;
      177     3113        /*                                                                    */
      178     3114    1        IF ADDR(DATE) = ADDR(NIL) THEN CALL SSS$SYSTIME(UTIME);
      179     3115    2        ELSE DO;
      180     3116    2           T$=ADDR(DATE);
      181     3117    2           UTIME=T$->A;
      182     3118    2           END;
      183     3119    1        T$=ADDR(UTSTMP);
      184     3120    1        CALL UTSDATE;                      /* TRANSLATE UTS TO BINARY            */
      185     3121    1        call binchar (YR, mod (B.YY, 100));
      186     3122    1        CALL BINCHAR(JDAY,JD);             /* JULIEN DAY                         */
      187     3123    1        CALL CONCAT(T$->ST5,YR,JDAY);      /* RETURN STRING                      */
      188     3124    1        RETURN;
      189     3125        /*                                                                    */
      190     3126        /*    RETURN UTS FOR GIVEN JULIEN DATE                                */
      191     3127    1   UMT$UTSJ: ENTRY(UTSTMP,DATE) ALTRET;
      192     3128        /*                                                                    */
      193     3129    1        CALL ANSDATE(DATE) ALTRET(BADDT);
      194     3130    1        CALL DATEUTS ALTRET(BADDT);
      195     3131    1        UTSTMP = UTIME;
      196     3132    1        RETURN;
      197     3133        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:8    
      198     3134        /*         RETURN INTERNAL DATE AND TIME IN QUASI-LOCAL FORMAT        */
      199     3135        /*                                                                    */
      200     3136    1   UMT$IDT: ENTRY(UTSTMP,DATE) ALTRET;
      201     3137        /*                                                                    */
      202     3138    1        T$=ADDR(UTSTMP);
      203     3139    1        T1$=ADDR(DATE);
      204     3140    1        IF HW_IMX AND TM_MCA_DO_TIME
      205     3141    2        THEN DO;
      206     3142    2           CALL TMB$BUF_ALLOC (BUF$,BUFX,DQH$) ALTRET (DTERR);
      207     3143    3           CALL TMB$MCA (DQH$->NI$DQH,TM_OC_TIME_READ#,BUFX) WHENALTRETURN DO;
      208     3144    3              CALL TMB$BUF_DEALLOC (BUF$,BUFX);
      209     3145    3              GOTO DTERR;
      210     3146    3              END;
      211     3147    2           UTIME = BUF$ -> UTS_B;
      212     3148    2           CALL SSS$SETBTIME(UTIME);
      213     3149    2           CALL TMB$BUF_DEALLOC (BUF$,BUFX);
      214     3150    2           END;
      215     3151    1        ELSE CALL SSS$SYSTIME(UTIME);      /* GET CURRENT TIME                   */
      216     3152
      217     3153    1   COMMON_IDT:
      218     3154    1        CALL UTSDATE;                      /* CONVERT TO BINARY                  */
      219     3155    1        CALL BINCHAR(HRS,B.HH);            /* CONVERT TO STRINGS                 */
      220     3156    1        CALL BINCHAR(MINS,B.MI);
      221     3157    1        CALL BINCHAR(DAY,B.DD);
      222     3158    1        call binchar (YR, mod (B.YY, 100));
      223     3159    1        CALL BINCHAR(MON,B.MM);
      224     3160    1        CALL CONCAT(T$->ST8,MON,'/',DAY,'/',YR); /* OUTPUT                         */
      225     3161    1        CALL CONCAT(T1$->ST5,HRS,':',MINS);
      226     3162    1        RETURN;
      227     3163
      228     3164        /*   Return internal date and time from input UTS.
      229     3165        */
      230     3166    1   UMT$IDT2: ENTRY(UTSTMP,DATE,TIME) ALTRET;
      231     3167    1        UTIME = UTSTMP;
      232     3168    1        T$ = ADDR(DATE);
      233     3169    1        T1$ = ADDR(TIME);
      234     3170    1        GOTO COMMON_IDT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:9    
      235     3171
      236     3172        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:10   
      237     3173    1   UMT$TIME: ENTRY ALTRET;
      238     3174        /*                                                                    */
      239     3175        /* THIS PROCEDURE CONVERTS AN INPUT, WHOSE FORMAT IS SPECIFIED BY     */
      240     3176        /* 'SOURCE' IN THE FPT, TO AN OUTPUT DATE AND TIME.  THE OUTPUT FORMAT*/
      241     3177        /* IS SELECTED BY THE FPT 'DEST' OPTION.                              */
      242     3178        /*                                                                    */
      243     3179        /*         CONVERT SOURCE TO BINARY DATE AND TIME                     */
      244     3180    2        DO CASE (B$PS0$->FPT$TIME_V.SOURCE);
      245     3181    2        CASE(%ANS#);
      246     3182    2           CALL HFF$NILERASE(1)
      247     3183    3           WHENRETURN DO;
      248     3184    3              CALL HFF$DSIZ(1,DTSZ);
      249     3185    3              CALL ANSDATE(B$PS1$->A) ALTRET(DTERR);
      250     3186    3              END;
      251     3187    3           WHENALTRETURN DO;
      252     3188    3              CALL JULDATE(B$PS3$->A) ALTRET(DTERR);
      253     3189    3              END;
      254     3190    2           CALL HFF$DSIZ(2,TMSZ);
      255     3191    2           CALL ANSTIME(B$PS2$->A) ALTRET(DTERR);
      256     3192    2        CASE (%LOCAL#);
      257     3193    2           CALL HFF$DSIZ(1,DTSZ);
      258     3194    2           CALL LOCALDATE(B$PS1$->A) ALTRET (DTERR);
      259     3195    2           CALL HFF$DSIZ(2,TMSZ);
      260     3196    2           CALL LOCALTIME(B$PS2$->A) ALTRET (DTERR);
      261     3197    2        CASE (%CLOCK#);
      262     3198    2           CALL SSS$SYSTIME(UTIME);        /* CONVERT CURRENT CLOCK TIME         */
      263     3199    2           CALL UTSDATE;
      264     3200    2        CASE (%UTS#,%FUTS#);
      265     3201    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);
      266     3202    2           UTIMEC=B$PS4$->AC;              /* CONVERT INPUT UTS                  */
      267     3203    2           IF B$PS0$->FPT$TIME_V.SOURCE = %FUTS# THEN
      268     3204    2              CALL SSS$L6_UTS (UTIMEC,UTIMEC) ALTRET(DTERR);
      269     3205    2           CALL UTSDATE;
      270     3206    2        CASE (%TUN#);
      271     3207    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);
      272     3208    2           UTC=B$PS4$->AC;
      273     3209    2           CALL SSS$SYSTIME(UTIME);   /* GET CURRENT TIME, SUBSTITUTE INPUT TUN*/
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:11   
      274     3210    2           IF UTIME > %UTS_CUSP# THEN      /* post-cusp UTSes use new tic */
      275     3211    2              UTIME = (UTIME / %UTS_25TH_DAY#) * %UTS_25TH_DAY# + UTI/40;
      276     3212    2           ELSE
      277     3213    2              UTIME = (UTIME / %UTS_CSEC_DAY#) * %UTS_CSEC_DAY# + UTI/10;
      278     3214    2           CALL UTSDATE;
      279     3215
      280     3216    2        CASE (%UNQUTS#);
      281     3217
      282     3218    2           CALL SSS$BLOCK;                 /* BLOCK FOR MASTER */
      283     3219    2           CALL SSS$SYSTIME (UTIME);
      284     3220    3           DO WHILE (UMT_UNIQUE >= UTIME);
      285     3221    3              CALL SSR$REG (%SS_SL, ADDR(NIL), 1);
      286     3222    3              CALL SSS$SYSTIME (UTIME);
      287     3223    3              END;                         /* DO WHILE */
      288     3224    2           UMT_UNIQUE = UTIME;
      289     3225    2           CALL UTSDATE;
      290     3226
      291     3227    2        END;
      292     3228    1        I = 0;                        /* figure out if we have an offset to add */
      293     3229    1        IF B$PS0$->FPT$TIME_V.SOURCE_BASIS = %UTC_BASIS#
      294     3230    1        THEN
      295     3231    1           I = I + B_SITEINFO.UTC_OFFSET#;
      296     3232    1        IF B$PS0$->FPT$TIME_V.DEST_BASIS = %UTC_BASIS#
      297     3233    1        THEN
      298     3234    1           I = I - B_SITEINFO.UTC_OFFSET#;
      299     3235    1        IF I ~= 0                     /* we have an offset to add to the time */
      300     3236    2        THEN DO;
      301     3237    2           CALL DATEUTS ALTRET(DTERR);
      302     3238    2           CALL XUD$UTS_ADJUST(UTIME, UTIME, I) ALTRET(DTERR);
      303     3239    2           CALL UTSDATE;
      304     3240    2           END;
      305     3241        /*         FORMAT DATE AND TIME FOR OUTPUT                            */
      306     3242    2        DO CASE (B$PS0$->FPT$TIME_V.DEST); /*  FORMAT OUTPUT                     */
      307     3243    2        CASE(%UTS#,%FUTS#);
      308     3244    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);
      309     3245    2           CALL DATEUTS ALTRET(DTERR);
      310     3246    2           IF B$PS0$->FPT$TIME_V.DEST = %FUTS#
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:12   
      311     3247    3           THEN DO;
      312     3248    3              CALL SSS$UTS_L6 (UTIMEC,UTIMEC) ALTRET(DTERR);
      313     3249    3              END;
      314     3250    2           B$PS4$->AC=UTIMEC;
      315     3251    2           RETURN;
      316     3252
      317     3253
      318     3254    2        CASE (%TUN#);
      319     3255    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);
      320     3256    2           CALL DATEUTS ALTRET(DTERR);
      321     3257    2           UTIME=TUNITS;
      322     3258    2           B$PS4$->AC=UTIMEC;
      323     3259    2           RETURN;
      324     3260    2        CASE (%EXT#,%ANS#,%LOCAL#);
      325     3261    2           WKD=MOD(B.YY*365+(B.YY-1)/4 +JD,7); /* Day of the week */
      326     3262    2           CALL BINCHAR(SEC,B.SS);         /* CONVERT DATE & TIME TO CHARS       */
      327     3263    2           CALL BINCHAR(HSEC,B.SS00);
      328     3264    2           CALL BINCHAR(HRS,B.HH);
      329     3265    2           CALL BINCHAR(MINS,B.MI);
      330     3266    2           CALL BINCHAR(DAY,B.DD);
      331     3267    2           CALL BINCHAR(MON,B.MM);
      332     3268    2           CALL BINCHAR (YR, MOD (B.YY, 100));
      333     3269    2           CALL BINCHAR(JDAY,JD);
      334     3270        /*                                                  normalize the B structure */
      335     3271        /**/
      336     3272    2           CALL HFF$NILERASE(1) ALTRET(TM2);
      337     3273    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);
      338     3274    3           CASE(%ANS#);                    /* FORMAT DATE                        */
      339     3275    3              CALL CONCAT (CTEMP,YR,MON,DAY);
      340     3276    3              B$PS1$->ST6 = CTEMP;
      341     3277    3           CASE (%LOCAL#);
      342     3278    3              CALL CONCAT (CTEMP,MON,'/',DAY,'/',YR);
      343     3279    3              B$PS1$->ST8 = CTEMP;
      344     3280    3           CASE (%EXT#);
      345     3281    3              CALL CONCAT (CTEMP,MONTH(B.MM-1),DAY,' ''',YR);
      346     3282    3              B$PS1$->ST10 = CTEMP;
      347     3283    3           END;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:13   
      348     3284    2   TM2:    CALL HFF$NILERASE(2) ALTRET(TM3); /* FORMAT TIME                        */
      349     3285    2           CALL HFF$DSIZ(2,TMSZ);
      350     3286    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);
      351     3287    3           CASE (%ANS#);
      352     3288    3              CALL CONCAT (CTEMP,HRS,MINS,SEC,HSEC);
      353     3289    3           CASE (%LOCAL#,%EXT#);
      354     3290    3              CALL CONCAT (CTEMP,HRS,':',MINS,':',SEC,'.');
      355     3291    3              SUBSTR(CTEMP,9,2) = HSEC;
      356     3292    3           END;
      357     3293    2           B$PS2$->STTMSZ = CTEMP;
      358     3294    2   TM3:    CALL HFF$NILERASE(3) ALTRET(UT);
      359     3295    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);
      360     3296    3           CASE (%ANS#);
      361     3297    3              CALL CONCAT(B$PS3$->ST5,YR,JDAY);
      362     3298    3           CASE (%LOCAL#,%EXT#);
      363     3299    3              B$PS3$->ST3=WKDAY(WKD);
      364     3300    3           END;
      365     3301    2        END;
      366     3302    1   UT:  CALL HFF$NILERASE(4) ALTRET(XTIME);
      367     3303    1        IF B$PS0$->FPT$TIME_V.SOURCE ~= %UTS# AND
      368     3304    1           B$PS0$->FPT$TIME_V.SOURCE ~= %FUTS# AND
      369     3305    2           B$PS0$->FPT$TIME_V.SOURCE ~= %TUN# THEN DO;
      370     3306    2           CALL DATEUTS ALTRET(DTERR);
      371     3307    2           B$PS4$->AC=UTIMEC;              /* RETURN UTS                         */
      372     3308    2           END;
      373     3309    1   XTIME: RETURN;
      374     3310    1   DTERR: B$JIT.ERR=%(CONCAT ('251524'O, BINBIT (E$BADDT,15), '6'O));
      375     3311        /*E*  ERROR: UMT-E$BADDT-0
      376     3312              MESSAGE: Date or Time format error
      377     3313              DESCRIPTION: Date or time character string non numeric or
      378     3314              incorrectly formatted.       */
      379     3315    1        RETURN;
      380     3316    1   NOPS4: B$JIT.ERR=%(CONCAT ('251524'O, BINBIT (E$BADVECT4,15), '6'O));
      381     3317                                                /* NEEDED B$PS4$ BUT DIDNT HAVE IT    */
      382     3318        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:14   
      383     3319        /*                                                                    */
      384     3320        /*         CONVERT LOCAL FORM TO BINARY DATE AND TIME                 */
      385     3321    1   LOCALDATE: PROC(DATE) ALTRET;
      386     3322        /*                                                                    */
      387     3323    2   DCL   DATE CHAR(8);
      388     3324    2   DCL   TMP CHAR(12);
      389     3325    2   DCL   X SBIN;
      390     3326        /*                                                                    */
      391     3327    2        B = '0'B;
      392     3328    2        TMP = SUBSTR (DATE, 0, MINIMUM( DTSZ, 8));
      393     3329    2        CALL SEARCH (I,X,NON_DECIMAL,TMP);
      394     3330    2        IF SUBSTR (TMP,I,1) ~= '/' THEN GOTO DATERR;
      395     3331    2        IF I > 0 THEN CALL CHARBIN (B.MM,SUBSTR(TMP,0,I));
      396     3332    2        CALL SEARCH (J,X,NON_DECIMAL,TMP,I+1);
      397     3333    2        IF SUBSTR (TMP,J,1) ~= '/' THEN GOTO DATERR;
      398     3334    2        K = J-I-1;
      399     3335    2        IF K > 0 THEN CALL CHARBIN (B.DD,SUBSTR(TMP,I+1,K));
      400     3336    2        CALL SEARCH (I,X,NON_DECIMAL,TMP,J+1);
      401     3337    2        K = I-J-1;
      402     3338    2        IF K > 0 THEN CALL CHARBIN (B.YY,SUBSTR(TMP,J+1,K));
      403     3339    2   LCL1:
      404     3340    2        if B.YY <= 20 then B.YY = B.YY + 100; /* year in range 2000 - 2020 */
      405     3341    2        YY_MOD4 = MOD(B.YY,4);
      406     3342    2        JD=MONS((B.MM-1)*4+YY_MOD4)+B.DD;
      407     3343    2        IF B.MM < 1 OR B.MM > 12 OR
      408     3344    2           B.DD < 1 OR B.DD > (MONS(B.MM*4+YY_MOD4)-MONS((B.MM-1)*4+YY_MOD4)) OR
      409     3345    2           B.YY > 120 THEN
      410     3346    2           GOTO DATERR;
      411     3347    2        RETURN;
      412     3348        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:15   
      413     3349        /*                                                                    */
      414     3350        /*         CONVERT JULIEN FORM TO BINARY DATE                         */
      415     3351    2   JULDATE: ENTRY(DATE) ALTRET;
      416     3352        /**/
      417     3353    2        B = '0'B;
      418     3354    2        TMP = SUBSTR (DATE, 0, 5);
      419     3355    2        CALL SEARCH (I,X,NON_DECIMAL,SUBSTR(TMP,0,5))
      420     3356    3        WHENRETURN DO;
      421     3357    3           GOTO DATERR;
      422     3358    3           END;
      423     3359    2        CALL CHARBIN(B.YY,SUBSTR(TMP,0,2));
      424     3360    2        CALL CHARBIN(JD,SUBSTR(TMP,2,3));
      425     3361    2        IF B.YY <= 20 THEN B.YY = B.YY + 100; /* year in range 2000 - 2020 */
      426     3362    2        YY_MOD4 = MOD(B.YY,4);
      427     3363    2        IF JD > MONS(12*4+YY_MOD4) THEN GOTO DATERR;
      428     3364    2        B.MM = JD/32 + 1;
      429     3365    2        IF (JD > MONS(B.MM*4+YY_MOD4)) THEN B.MM = B.MM+1;
      430     3366    2        B.DD = JD - MONS((B.MM-1)*4+YY_MOD4);
      431     3367    2        RETURN;
      432     3368        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:16   
      433     3369        /*                                                                    */
      434     3370        /*         CONVERT LOCAL FORM TO BINARY TIME                          */
      435     3371    2   LOCALTIME: ENTRY(DATE) ALTRET;
      436     3372        /**/
      437     3373    2        IF TMSZ <= 0 THEN RETURN;
      438     3374    2        K=0;
      439     3375    2        TMP = SUBSTR (DATE, 0, TMSZ);
      440     3376    3        DO I=3 TO 6;   /* GET TIME FIELDS                                     */
      441     3377    3           CALL SEARCH (J,X,NON_DECIMAL,TMP,K);
      442     3378    3           IF J-K ~= 0 THEN
      443     3379    3              CALL CHARBIN(DT(I),SUBSTR(TMP,K,J-K));
      444     3380    3           K=J+1;
      445     3381    3           IF I = 5 AND TMSZ > K+2 THEN GOTO DATERR;
      446     3382    3           IF J >= TMSZ THEN GOTO LCL4;
      447     3383    3           IF I < 5 THEN IF SUBSTR(TMP,J,1) ~= ':' THEN GOTO DATERR; ELSE;
      448     3384    3           ELSE IF I = 5 THEN IF SUBSTR(TMP,J,1) ~= '.' THEN GOTO DATERR; ELSE;
      449     3385    3              ELSE GOTO DATERR;
      450     3386    3           END;
      451     3387    2        IF I = 6 AND (J-K) = 1 THEN DT(6)=DT(6)*10;
      452     3388    2   LCL4: IF B.HH>23 OR B.MI>59 OR B.SS>59 OR B.SS00>99 THEN GOTO DATERR;
      453     3389    2        RETURN;
      454     3390        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:17   
      455     3391        /*        CONVERT ANS FORM TO BINARY DATE AND TIME                    */
      456     3392        /*                                                                    */
      457     3393    2   ANSDATE: ENTRY(DATE) ALTRET;
      458     3394        /**/
      459     3395    2        B = '0'B;
      460     3396    2        TMP = SUBSTR(DATE,0,6);
      461     3397    2        CALL SEARCH (I, I, NON_DECIMAL, SUBSTR(TMP, 0, 6))
      462     3398    3        WHENRETURN DO;
      463     3399    3           GOTO DATERR;
      464     3400    3           END;
      465     3401    2        CALL CHARBIN(B.YY,SUBSTR(DATE,0,2));
      466     3402    2        CALL CHARBIN(B.MM,SUBSTR(DATE,2,2));
      467     3403    2        CALL CHARBIN(B.DD,SUBSTR(DATE,4,2));
      468     3404    2        GOTO LCL1;
      469     3405        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:18   
      470     3406        /*        CONVERT ANS FORM TO BINARY TIME                             */
      471     3407        /*                                                                    */
      472     3408    2   ANSTIME: ENTRY(DATE) ALTRET;
      473     3409        /**/
      474     3410    3        IF TMSZ > 0 THEN DO;
      475     3411    3           TMP = SUBSTR(DATE,0,8);
      476     3412    3           CALL SEARCH (I, I, NON_DECIMAL, SUBSTR(TMP, 0, 8))
      477     3413    4           WHENRETURN DO;
      478     3414    4              GOTO DATERR;
      479     3415    4              END;
      480     3416    3           CALL CHARBIN(B.HH,SUBSTR(TMP,0,2));
      481     3417    3           CALL CHARBIN(B.MI,SUBSTR(TMP,2,2));
      482     3418    3           CALL CHARBIN(B.SS,SUBSTR(TMP,4,2));
      483     3419    3           CALL CHARBIN(B.SS00,SUBSTR(TMP,6,2));
      484     3420    3           END;
      485     3421    2        GOTO LCL4;
      486     3422    2   DATERR: ALTRETURN;
      487     3423    2   END LOCALDATE;
      488     3424        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:19   
      489     3425        /*         CONVERT UTS TO DATE AND TIME                               */
      490     3426        /*                                                                    */
      491     3427    1   UTSDATE: PROC;
      492     3428    3        if UTIME > %UTS_CUSP# then do;
      493     3429    3           I = UTIME - %UTS_CUSP#;         /* time since cusp in 1/25th sec tics */
      494     3430    3           B.SS00 = MOD (I, %UTS_25TH_SEC#) * 4; /* fractional seconds to CSECs */
      495     3431    3           B.SS = I / %UTS_25TH_SEC# +     /* seconds since cusp */
      496     3432    3              %(B_CDAYS# * 86400);         /* plus secs since cusp */
      497     3433    3           end;
      498     3434    3        else do;
      499     3435    3           B.SS = UTIME / %UTS_CSEC_SEC#;
      500     3436    3           B.SS00 = UTIME - B.SS * %UTS_CSEC_SEC#;
      501     3437    3           end;
      502     3438    2        B.MI=B.SS/60;
      503     3439    2        B.SS=MOD(B.SS,60);                 /* SECONDS                            */
      504     3440    2        B.HH=B.MI/60;
      505     3441    2        B.MI=MOD(B.MI,60);                 /* MINUTES                            */
      506     3442    2        D1=B.HH/24 + 1;
      507     3443    2        B.HH=MOD(B.HH,24);                 /* HOURS                              */
      508     3444    2        LD=((B_BYEAR-76)*365+D1-59)/1461;  /* # LEAP DAYS                        */
      509     3445    2        Y1=(D1-1-LD)/365;                  /* #YEARS SINCE START                 */
      510     3446    2        B.YY=B_BYEAR+Y1;
      511     3447    2        YY_MOD4 = MOD (B.YY,4);
      512     3448    2        JD=D1-LD-(Y1*365);                 /* JULIEN DAY                         */
      513     3449    2        B.MM=JD/32 + 1;
      514     3450    2        IF (JD > MONS(B.MM*4+1)) THEN
      515     3451    2           B.MM=B.MM+1;
      516     3452    2        B.DD=JD-MONS((B.MM-1)*4+1);        /* DAY OF MONTH           */
      517     3453    2        IF MOD(B.YY,4)=0 THEN
      518     3454    3        DO;
      519     3455    3           IF MOD (D1-790, 1461) = 0 THEN  /* IS IT FEB 29? */
      520     3456    4           DO;
      521     3457    4              B.MM=2;
      522     3458    4              B.DD=29;
      523     3459    4              JD = JD + 1;                 /* allow for leap day */
      524     3460    4              END;
      525     3461    3           else if JD >= 60 then           /* is date after Feb 29? */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:20   
      526     3462    4              DO;
      527     3463    4   TM4:          JD = JD + 1;
      528     3464    4                 END;
      529     3465    3           END;
      530     3466    2        RETURN;
      531     3467    2   END UTSDATE;
      532     3468        /*                                                                    */
      533     3469    1   DATEUTS: PROC ALTRET;
      534     3470    2        LD=((B.YY-76)*12-3+B.MM)/48;       /* CONVERT DATE & TIME TO UTS         */
      535     3471    2        D1=(B.YY-B_BYEAR)*365+MONS((B.MM-1)*4+1)+B.DD-1+LD; /* NUMBER DAYS       */
      536     3472    2        IF D1 < 0 OR
      537     3473    2           D1 >= %(B_EDAYS# + B_CDAYS#)
      538     3474    2        THEN
      539     3475    2           ALTRETURN;
      540     3476    2        TUNITS=(B.HH*60+B.MI)*6000+B.SS*100+B.SS00; /* TIME IN 1/100 SECS          */
      541     3477    2        if B.YY >= B_CYEAR then            /* date is in new UTS era (post cusp) */
      542     3478    2           UTIME = %UTS_CUSP# + (D1-%B_CDAYS#) * %UTS_25TH_DAY# + TUNITS/4;
      543     3479    2        else UTIME = D1 * %UTS_CSEC_DAY# + TUNITS; /* old UTS (pre cusp) */
      544     3480    2        TUNITS=TUNITS*10;                  /* TIME IN MSECS                      */
      545     3481    2        RETURN;
      546     3482    2   END DATEUTS;
      547     3483        /*                                                                    */
      548     3484    1   END UMT$LCLDATE;
      549     3485        %EOD;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:21   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_M.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$LCLDATE.

   Procedure UMT$LCLDATE requires 1195 words for executable code.
   Procedure UMT$LCLDATE requires 54 words of local(AUTO) storage.

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:22   

 Object Unit name= UMT$LCLDATE                                File name= UMT$TIME.:E05TOU
 UTS= JUL 30 '97 07:01:11.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     1      1  UMT$LCLDATE
    1  RoData even  UTS     84    124  UMT$LCLDATE
    2   Proc  even  none  1195   2253  UMT$LCLDATE
    3  RoData even  none    17     21  UMT$LCLDATE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  UMT$LCLDATE
     2     66          yes     yes      Std        2  UMT$JDATE
     2    134          yes     yes      Std        2  UMT$UTSJ
     2    150          yes     yes      Std        2  UMT$IDT
     2    326          yes     yes      Std        3  UMT$IDT2
     2    340          yes     yes      Std        0  UMT$TIME

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  UMT_UNIQUE
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:23   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       1 SSS$SYSTIME
 yes     yes           Std       3 SSR$REG
 yes     yes           Std       4 TMB$MCA
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       2 SSS$UTS_L6
 yes     yes           Std       3 TMB$BUF_ALLOC
 yes     yes           Std       2 TMB$BUF_DEALLOC
 yes     yes           Std       2 SSS$L6_UTS
         yes           Std       0 SSS$BLOCK
         yes           Std       1 SSS$SETBTIME
 yes     yes           Std       3 XUD$UTS_ADJUST
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$PS0$                                B$PS1$
     B$PS2$                                B$PS3$                                B$PS4$
     TM_MCA_DO_TIME                        HW_IMX                           r    B$SR_NON_DEC$
     B_SITEINFO                            B_VECTNIL
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:24   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:25   


        1        1        /*M*  UMT$TIME:    MONITOR DATE AND TIME SERVICE PROCEDURE            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /*                                                                    */
        9        9        /*    TRANSLATE LOCAL FORMAT DATE AND TIME TO UTS                     */
       10       10        /*                                                                    */
       11       11        UMT$LCLDATE: PROC(UTSTMP,DATE,TIME) ALTRET;

     11  2 000000   000000 700200 xent  UMT$LCLDATE  TSX0  ! X66_AUTO_3
         2 000001   000066 000003                    ZERO    54,3

       12       12        /*                                                                    */
       13       13    1   DCL   UTSTMP UBIN(36);
       14       14    1   DCL   DATE CHAR(8);
       15       15    1   DCL   DTCHR(0:7) REDEF DATE CHAR(1);
       16       16    1   DCL   DTASC(0:7) REDEF DATE UBIN BYTE CALIGNED;
       17       17    1   DCL   TIME CHAR(5);
       18       18    1   DCL   TMASC(0:4) REDEF TIME UBIN BYTE CALIGNED;
       19       19    1   DCL   TMCHR(0:4) REDEF TIME CHAR(1);
       20       20        /*                                                                    */
       21       21    1   DCL   SSS$SYSTIME ENTRY(1);             /* GET CURRENT UTS                    */
       22       22    1   DCL   SSS$SETBTIME ENTRY(1);
       23       23    1   DCL SSS$UTS_L6 ENTRY(2) ALTRET;
       24       24    1   DCL SSS$L6_UTS ENTRY(2) ALTRET;
       25       25    1   DCL   HFF$DSIZ ENTRY(2);
       26       26    1   DCL   HFF$NILERASE ENTRY(1) ALTRET;
       27       27    1   DCL TMB$MCA ENTRY(4) ALTRET;
       28       28    1   DCL TMB$BUF_ALLOC ENTRY(3) ALTRET;
       29       29    1   DCL TMB$BUF_DEALLOC ENTRY(2) ALTRET;
       30       30
       31       31                                                /* LAST-DELIVERED UNIQUE TIMESTAMP */
       32       32    1   DCL UMT_UNIQUE UBIN WORD STATIC SYMDEF;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:26   
       33       33
       34       34
       35       35        /*                                                                    */
       36       36    1   DCL   B$JIT$ PTR SYMREF;
       37       37    1   DCL B_BYEAR CONSTANT UBIN(36) INIT(78); /* SYS ORG DATE 1/1/78     */
       38       38    1   DCL   B_BMON CONSTANT UBIN(36) INIT(1);
       39       39    1   DCL   B_BDAY CONSTANT UBIN(36) INIT(1);
       40       40    1   dcl B_CYEAR constant ubin init(93);     /* UTS cusp -- 01/01/93 00:00:00.00 */
       41       41    1   DCL   A UBIN BASED CALIGNED;
       42       42    1   DCL   AC REDEF A CHAR(4);
       43       43    1   DCL   UTIME UBIN(36);
       44       44    1   DCL   UTIMEC REDEF UTIME CHAR(4);
       45       45    1   DCL   UTI UBIN(36);
       46       46    1   DCL   UTC REDEF UTI CHAR(4);
       47       47    1   DCL   I SBIN;
       48       48    1   DCL   J SBIN;
       49       49    1   DCL   K SBIN;
       50       50    1   DCL   DTSZ UBIN;
       51       51    1   DCL   TMSZ UBIN;
       52       52    1   DCL   TUNITS UBIN(36);
       53       53    1   DCL   T$ PTR;
       54       54    1   DCL B$PS0$ PTR SYMREF;
       55       55    1   DCL B$PS1$ PTR SYMREF;
       56       56    1   DCL B$PS2$ PTR SYMREF;
       57       57    1   DCL B$PS3$ PTR SYMREF;
       58       58    1   DCL B$PS4$ PTR SYMREF;
       59       59    1   DCL   T1$ PTR;
       60       60    1   DCL   ST3 CHAR(3) BASED;
       61       61    1   DCL   ST4 CHAR(4) BASED;
       62       62    1   DCL   ST5 CHAR(5) BASED;
       63       63    1   DCL   ST6 CHAR(6) BASED;
       64       64    1   DCL   ST8 CHAR(8) BASED;
       65       65    1   DCL   ST10 CHAR(10) BASED;
       66       66    1   DCL   STTMSZ CHAR(TMSZ) BASED;
       67       67    1   DCL   HSEC CHAR(2);                     /* 1/100 SEC                          */
       68       68    1   DCL   SEC CHAR(2);
       69       69    1   DCL   CTEMP CHAR(12);
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:27   
       70       70    1   DCL   MINS CHAR(2);
       71       71    1   DCL   HRS CHAR(2);
       72       72    1   DCL   MON CHAR(2);
       73       73    1   DCL   DAY CHAR(2);
       74       74    1   DCL   YR CHAR(2);
       75       75    1   DCL   LD SBIN;                          /* #LEAP DAYS                         */
       76       76    1   DCL   D1 SBIN;                          /* TEMP                               */
       77       77    1   DCL   Y1 UBIN(36);
       78       78    1   DCL   WKD UBIN(36);                     /* DAY OF WEEK                        */
       79       79    1   DCL   JDAY CHAR(3);                     /* JULIEN DAY                         */
       80       80    1   DCL   JD SBIN;                          /*  "                                 */
       81       81    1   DCL   YY_MOD4 SBIN;
       82       82    1   DCL 1 B,
       83       83    1          2 MM SBIN,
       84       84    1          2 DD SBIN,
       85       85    1          2 YY SBIN,
       86       86    1          2 HH SBIN,
       87       87    1          2 MI SBIN,
       88       88    1          2 SS SBIN,
       89       89    1          2 SS00 SBIN;
       90       90    1   DCL   DT(0:6) REDEF B UBIN;
       91       91    1   DCL   ST(0:6) REDEF B SBIN;
       92       92        /*                                                                    */
       93       93    1   DCL   WKDAY(0:6) CONSTANT CHAR(3) INIT(
       94       94    1              'SUN','MON','TUE','WED','THU','FRI','SAT');
       95       95    1   DCL   MONTH(0:11) CONSTANT CHAR(4) INIT(
       96       96    1              'JAN ','FEB ','MAR ','APR ','MAY ','JUN ','JUL ',
       97       97    1              'AUG ','SEP ','OCT ','NOV ','DEC ');
       98       98    1   DCL  MONS(0:51) CONSTANT UBIN(36) INIT( /* each month * 4 - for leap years */
       99       99    1                0,  0,  0,  0,
      100      100    1               31, 31, 31, 31,             /* jan */
      101      101    1               60, 59, 59, 59,             /* feb */
      102      102    1               91, 90, 90, 90,             /* mar */
      103      103    1              121,120,120,120,             /* apr */
      104      104    1              152,151,151,151,             /* may */
      105      105    1              182,181,181,181,             /* jun */
      106      106    1              213,212,212,212,             /* jul */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:28   
      107      107    1              244,243,243,243,             /* aug */
      108      108    1              274,273,273,273,             /* sep */
      109      109    1              305,304,304,304,             /* oct */
      110      110    1              335,334,334,334,             /* nov */
      111      111    1              366,365,365,365);            /* dec */
      112      112    1   DCL   LPS(0:4) UBIN(36) CONSTANT INIT(790,2251,3712,5173,
      113      113    1              6634);
      114      114        /**/
      115      115        %INCLUDE TM_DATA_M;
      116      217        %INCLUDE TM_DATA_R;
      117      226        %INCLUDE HF_DATA_R;
      118      269        %INCLUDE NI$TABLES;
      119      485        %INCLUDE UM_CP6;
      120     1337        %INCLUDE B$TABLES_C;
      121     1445        %B$SR_NON_DEC( NAME=NON_DECIMAL );
      122     1449        %NI$DQH;
      123     1472    1   DCL BUF$ PTR;
      124     1473    1   DCL BUFX SBIN;
      125     1474    1   DCL DQH$ PTR;
      126     1475    1   DCL UTS_B UBIN BASED;
      127     1476        /*                                                                    */
      128     1477        %INCLUDE CP_6_SUBS;
      129     2017        %INCLUDE UD_ERRORS_C;
      130     2059        %INCLUDE UM_ERRORS_C;
      131     2093        %INCLUDE UM$CP6V_C;
      132     2280        %FPT$TIME_V;
      133     2284        %INCLUDE SS_SCHED_C;
      134     2517    1   DCL SSR$REG ENTRY(3) ALTRET;
      135     2518    1   DCL SSS$BLOCK     ENTRY;
      136     2519        %INCLUDE B$JIT_C;
      137     2833        %B$JIT0;
      138     2922        %U$JIT1X;
      139     2925        %M$JIT2X;
      140     2928        %F$JIT3X;
      141     2931        %S$JIT4X;
      142     2934        %J$JIT5X;
      143     2937        %A$JIT6X;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:29   
      144     2940        %include XUD_UTS_M;                     /* include file with UTS constants */
      145     3022        %XUD_UTS_EQU;                 /* macro to EQUate UTS constants in this module */
      146     3033        /* UTS value for midnight before rollover:  02/07/20 00:00:00.00 */
      147     3034        %EQU JudgementDay# = chartext ('bitbin (''777773220400''o)');
      148     3035        %EQU B_CDAYS# = 5479; /* UTS_CUSP# / UTS_CSEC_DAY#  days from startup to cusp */
      149     3036        %EQU B_EDAYS# = 9898; /* JudgementDay#-UTS_CUSP# / UTS_25TH_DAY# casp - Boom */
      150     3037        %XUD$UTS_ENTRIES;
      151     3069        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      152     3088        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:30   
      153     3089    2        DO DTSZ = 0 TO 7;

   3089  2 000002   200013 450100                    STZ     DTSZ,,AUTO

      154     3090    2           IF DTCHR(DTSZ) = ' ' OR DTCHR(DTSZ) = BINASC(0) THEN

   3090  2 000003   200004 470500                    LDP0    @DATE,,AUTO
         2 000004   200013 235100                    LDA     DTSZ,,AUTO
         2 000005   040000 106505                    CMPC    fill='040'O
         2 000006   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000007   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000010   000023 600000 2                  TZE     LCLDT1
         2 000011   040000 106505                    CMPC    fill='040'O
         2 000012   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000013   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000014   000023 600000 2                  TZE     LCLDT1

      155     3091    2              GOTO LCLDT1;
      156     3092    2           END;

   3092  2 000015   000001 035007                    ADLA    1,DL
         2 000016   200013 755100                    STA     DTSZ,,AUTO
         2 000017   000010 115007                    CMPA    8,DL
         2 000020   000003 602000 2                  TNC     s:3090

      157     3093    1        DTSZ=8;

   3093  2 000021   000010 236007                    LDQ     8,DL
         2 000022   200013 756100                    STQ     DTSZ,,AUTO

      158     3094    1   LCLDT1:
      159     3095    2        DO TMSZ = 0 TO 4;

   3095  2 000023   200014 450100       LCLDT1       STZ     TMSZ,,AUTO

      160     3096    2           IF TMCHR(TMSZ) = ' ' OR TMCHR(TMSZ) = BINASC(0) THEN

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:31   
   3096  2 000024   200005 470500                    LDP0    @TIME,,AUTO
         2 000025   200014 235100                    LDA     TMSZ,,AUTO
         2 000026   040000 106505                    CMPC    fill='040'O
         2 000027   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000030   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000031   000044 600000 2                  TZE     LCLDT2
         2 000032   040000 106505                    CMPC    fill='040'O
         2 000033   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000034   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000035   000044 600000 2                  TZE     LCLDT2

      161     3097    2              GOTO LCLDT2;
      162     3098    2           END;

   3098  2 000036   000001 035007                    ADLA    1,DL
         2 000037   200014 755100                    STA     TMSZ,,AUTO
         2 000040   000005 115007                    CMPA    5,DL
         2 000041   000024 602000 2                  TNC     s:3096

      163     3099    1        TMSZ=5;

   3099  2 000042   000005 236007                    LDQ     5,DL
         2 000043   200014 756100                    STQ     TMSZ,,AUTO

      164     3100    1   LCLDT2:
      165     3101    1        CALL LOCALDATE(DATE) ALTRET(BADDT);

   3101  2 000044   200004 236100       LCLDT2       LDQ     @DATE,,AUTO
         2 000045   200055 756100                    STQ     DQH$+3,,AUTO
         2 000046   001276 701000 2                  TSX1    LOCALDATE
         2 000047   000065 702000 2                  TSX2    BADDT

      166     3102    1        CALL LOCALTIME(TIME) ALTRET(BADDT);

   3102  2 000050   200005 236100                    LDQ     @TIME,,AUTO
         2 000051   200055 756100                    STQ     DQH$+3,,AUTO
         2 000052   001564 701000 2                  TSX1    LOCALTIME
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:32   
         2 000053   000065 702000 2                  TSX2    BADDT

      167     3103    1        CALL DATEUTS;                      /* BUILD UTS                          */

   3103  2 000054   002166 701000 2                  TSX1    DATEUTS
         2 000055   000000 011000                    NOP     0

      168     3104    1        if UTIME > %JudgementDay# then

   3104  2 000056   000117 236000 1                  LDQ     MONS+57
         2 000057   200006 116100                    CMPQ    UTIME,,AUTO
         2 000060   000065 602000 2                  TNC     BADDT

      169     3105    1           GOTO BADDT;
      170     3106    1        UTSTMP=UTIME;

   3106  2 000061   200003 470500                    LDP0    @UTSTMP,,AUTO
         2 000062   200006 235100                    LDA     UTIME,,AUTO
         2 000063   000000 755100                    STA     0,,PR0

      171     3107    1        RETURN;

   3107  2 000064   000000 702200 xent               TSX2  ! X66_ARET

      172     3108    1   BADDT: ALTRETURN;

   3108  2 000065   000000 702200 xent  BADDT        TSX2  ! X66_AALT

      173     3109        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:33   
      174     3110        /*    RETURN JULIEN DATE FOR CURRENT TIME OR INPUT UTS                */
      175     3111        /*                                                                    */
      176     3112    1   UMT$JDATE: ENTRY(UTSTMP,DATE) ALTRET;

   3112  2 000066   000000 700200 xent  UMT$JDATE    TSX0  ! X66_AUTO_3
         2 000067   000066 000003                    ZERO    54,3

      177     3113        /*                                                                    */
      178     3114    1        IF ADDR(DATE) = ADDR(NIL) THEN CALL SSS$SYSTIME(UTIME);

   3114  2 000070   200004 236100                    LDQ     @DATE,,AUTO
         2 000071   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000072   000102 601000 2                  TNZ     s:3116

   3114  2 000073   200006 630500                    EPPR0   UTIME,,AUTO
         2 000074   200062 450500                    STP0    X+1,,AUTO
         2 000075   200062 630500                    EPPR0   X+1,,AUTO
         2 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000077   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000100   000000 011000                    NOP     0
         2 000101   000107 710000 2                  TRA     s:3119

      179     3115    2        ELSE DO;

      180     3116    2           T$=ADDR(DATE);

   3116  2 000102   200016 756100                    STQ     T$,,AUTO

      181     3117    2           UTIME=T$->A;

   3117  2 000103   200016 470500                    LDP0    T$,,AUTO
         2 000104   000100 100500                    MLR     fill='000'O
         2 000105   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         2 000106   200006 000004                    ADSC9   UTIME,,AUTO              cn=0,n=4

      182     3118    2           END;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:34   
      183     3119    1        T$=ADDR(UTSTMP);

   3119  2 000107   200003 236100                    LDQ     @UTSTMP,,AUTO
         2 000110   200016 756100                    STQ     T$,,AUTO

      184     3120    1        CALL UTSDATE;                      /* TRANSLATE UTS TO BINARY            */

   3120  2 000111   002021 701000 2                  TSX1    UTSDATE
         2 000112   000000 011000                    NOP     0

      185     3121    1        call binchar (YR, mod (B.YY, 100));

   3121  2 000113   200043 236100                    LDQ     B+2,,AUTO
         2 000114   000144 506007                    DIV     100,DL
         2 000115   200062 755100                    STA     X+1,,AUTO
         2 000116   000100 301500                    BTD
         2 000117   200062 000004                    NDSC9   X+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000120   200031 030002                    NDSC9   YR,,AUTO                 cn=0,s=nosgn,sf=0,n=2

      186     3122    1        CALL BINCHAR(JDAY,JD);             /* JULIEN DAY                         */

   3122  2 000121   000100 301500                    BTD
         2 000122   200037 000004                    NDSC9   JD,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 000123   200036 030003                    NDSC9   JDAY,,AUTO               cn=0,s=nosgn,sf=0,n=3

      187     3123    1        CALL CONCAT(T$->ST5,YR,JDAY);      /* RETURN STRING                      */

   3123  2 000124   200016 470500                    LDP0    T$,,AUTO
         2 000125   040100 100500                    MLR     fill='040'O
         2 000126   200031 000002                    ADSC9   YR,,AUTO                 cn=0,n=2
         2 000127   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000130   040100 100500                    MLR     fill='040'O
         2 000131   200036 000003                    ADSC9   JDAY,,AUTO               cn=0,n=3
         2 000132   000000 400003                    ADSC9   0,,PR0                   cn=2,n=3

      188     3124    1        RETURN;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:35   
   3124  2 000133   000000 702200 xent               TSX2  ! X66_ARET

      189     3125        /*                                                                    */
      190     3126        /*    RETURN UTS FOR GIVEN JULIEN DATE                                */
      191     3127    1   UMT$UTSJ: ENTRY(UTSTMP,DATE) ALTRET;

   3127  2 000134   000000 700200 xent  UMT$UTSJ     TSX0  ! X66_AUTO_3
         2 000135   000066 000003                    ZERO    54,3

      192     3128        /*                                                                    */
      193     3129    1        CALL ANSDATE(DATE) ALTRET(BADDT);

   3129  2 000136   200004 236100                    LDQ     @DATE,,AUTO
         2 000137   200055 756100                    STQ     DQH$+3,,AUTO
         2 000140   001721 701000 2                  TSX1    ANSDATE
         2 000141   000065 702000 2                  TSX2    BADDT

      194     3130    1        CALL DATEUTS ALTRET(BADDT);

   3130  2 000142   002166 701000 2                  TSX1    DATEUTS
         2 000143   000065 702000 2                  TSX2    BADDT

      195     3131    1        UTSTMP = UTIME;

   3131  2 000144   200003 470500                    LDP0    @UTSTMP,,AUTO
         2 000145   200006 235100                    LDA     UTIME,,AUTO
         2 000146   000000 755100                    STA     0,,PR0

      196     3132    1        RETURN;

   3132  2 000147   000000 702200 xent               TSX2  ! X66_ARET

      197     3133        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:36   
      198     3134        /*         RETURN INTERNAL DATE AND TIME IN QUASI-LOCAL FORMAT        */
      199     3135        /*                                                                    */
      200     3136    1   UMT$IDT: ENTRY(UTSTMP,DATE) ALTRET;

   3136  2 000150   000000 700200 xent  UMT$IDT      TSX0  ! X66_AUTO_3
         2 000151   000066 000003                    ZERO    54,3

      201     3137        /*                                                                    */
      202     3138    1        T$=ADDR(UTSTMP);

   3138  2 000152   200003 236100                    LDQ     @UTSTMP,,AUTO
         2 000153   200016 756100                    STQ     T$,,AUTO

      203     3139    1        T1$=ADDR(DATE);

   3139  2 000154   200004 236100                    LDQ     @DATE,,AUTO
         2 000155   200017 756100                    STQ     T1$,,AUTO

      204     3140    1        IF HW_IMX AND TM_MCA_DO_TIME

   3140  2 000156   000000 234000 xsym               SZN     HW_IMX
         2 000157   000241 605000 2                  TPL     s:3151
         2 000160   000000 234000 xsym               SZN     TM_MCA_DO_TIME
         2 000161   000241 605000 2                  TPL     s:3151

      205     3141    2        THEN DO;

      206     3142    2           CALL TMB$BUF_ALLOC (BUF$,BUFX,DQH$) ALTRET (DTERR);

   3142  2 000162   200052 630500                    EPPR0   DQH$,,AUTO
         2 000163   200064 450500                    STP0    X+3,,AUTO
         2 000164   200051 631500                    EPPR1   BUFX,,AUTO
         2 000165   200063 451500                    STP1    X+2,,AUTO
         2 000166   200050 633500                    EPPR3   BUF$,,AUTO
         2 000167   200062 453500                    STP3    X+1,,AUTO
         2 000170   200062 630500                    EPPR0   X+1,,AUTO
         2 000171   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:37   
         2 000172   000000 701000 xent               TSX1    TMB$BUF_ALLOC
         2 000173   001266 702000 2                  TSX2    DTERR

      207     3143    3           CALL TMB$MCA (DQH$->NI$DQH,TM_OC_TIME_READ#,BUFX) WHENALTRETURN DO;

   3143  2 000174   200051 630500                    EPPR0   BUFX,,AUTO
         2 000175   200064 450500                    STP0    X+3,,AUTO
         2 000176   000001 236000 3                  LDQ     1
         2 000177   200052 235100                    LDA     DQH$,,AUTO
         2 000200   200062 757100                    STAQ    X+1,,AUTO
         2 000201   200062 630500                    EPPR0   X+1,,AUTO
         2 000202   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000203   000000 701000 xent               TSX1    TMB$MCA
         2 000204   000206 702000 2                  TSX2    s:3144
         2 000205   000217 710000 2                  TRA     s:3147

      208     3144    3              CALL TMB$BUF_DEALLOC (BUF$,BUFX);

   3144  2 000206   200051 630500                    EPPR0   BUFX,,AUTO
         2 000207   200063 450500                    STP0    X+2,,AUTO
         2 000210   200050 631500                    EPPR1   BUF$,,AUTO
         2 000211   200062 451500                    STP1    X+1,,AUTO
         2 000212   200062 630500                    EPPR0   X+1,,AUTO
         2 000213   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000214   000000 701000 xent               TSX1    TMB$BUF_DEALLOC
         2 000215   000000 011000                    NOP     0

      209     3145    3              GOTO DTERR;

   3145  2 000216   001266 710000 2                  TRA     DTERR

      210     3146    3              END;
      211     3147    2           UTIME = BUF$ -> UTS_B;

   3147  2 000217   200050 470500                    LDP0    BUF$,,AUTO
         2 000220   000000 235100                    LDA     0,,PR0
         2 000221   200006 755100                    STA     UTIME,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:38   

      212     3148    2           CALL SSS$SETBTIME(UTIME);

   3148  2 000222   200006 631500                    EPPR1   UTIME,,AUTO
         2 000223   200062 451500                    STP1    X+1,,AUTO
         2 000224   200062 630500                    EPPR0   X+1,,AUTO
         2 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000226   000000 701000 xent               TSX1    SSS$SETBTIME
         2 000227   000000 011000                    NOP     0

      213     3149    2           CALL TMB$BUF_DEALLOC (BUF$,BUFX);

   3149  2 000230   200051 630500                    EPPR0   BUFX,,AUTO
         2 000231   200063 450500                    STP0    X+2,,AUTO
         2 000232   200050 631500                    EPPR1   BUF$,,AUTO
         2 000233   200062 451500                    STP1    X+1,,AUTO
         2 000234   200062 630500                    EPPR0   X+1,,AUTO
         2 000235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000236   000000 701000 xent               TSX1    TMB$BUF_DEALLOC
         2 000237   000000 011000                    NOP     0

      214     3150    2           END;

   3150  2 000240   000247 710000 2                  TRA     COMMON_IDT

      215     3151    1        ELSE CALL SSS$SYSTIME(UTIME);      /* GET CURRENT TIME                   */

   3151  2 000241   200006 630500                    EPPR0   UTIME,,AUTO
         2 000242   200062 450500                    STP0    X+1,,AUTO
         2 000243   200062 630500                    EPPR0   X+1,,AUTO
         2 000244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000245   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000246   000000 011000                    NOP     0

      216     3152
      217     3153    1   COMMON_IDT:
      218     3154    1        CALL UTSDATE;                      /* CONVERT TO BINARY                  */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:39   

   3154  2 000247   002021 701000 2     COMMON_IDT   TSX1    UTSDATE
         2 000250   000000 011000                    NOP     0

      219     3155    1        CALL BINCHAR(HRS,B.HH);            /* CONVERT TO STRINGS                 */

   3155  2 000251   000100 301500                    BTD
         2 000252   200044 000004                    NDSC9   B+3,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000253   200026 030002                    NDSC9   HRS,,AUTO                cn=0,s=nosgn,sf=0,n=2

      220     3156    1        CALL BINCHAR(MINS,B.MI);

   3156  2 000254   000100 301500                    BTD
         2 000255   200045 000004                    NDSC9   B+4,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000256   200025 030002                    NDSC9   MINS,,AUTO               cn=0,s=nosgn,sf=0,n=2

      221     3157    1        CALL BINCHAR(DAY,B.DD);

   3157  2 000257   000100 301500                    BTD
         2 000260   200042 000004                    NDSC9   B+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000261   200030 030002                    NDSC9   DAY,,AUTO                cn=0,s=nosgn,sf=0,n=2

      222     3158    1        call binchar (YR, mod (B.YY, 100));

   3158  2 000262   200043 236100                    LDQ     B+2,,AUTO
         2 000263   000144 506007                    DIV     100,DL
         2 000264   200062 755100                    STA     X+1,,AUTO
         2 000265   000100 301500                    BTD
         2 000266   200062 000004                    NDSC9   X+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000267   200031 030002                    NDSC9   YR,,AUTO                 cn=0,s=nosgn,sf=0,n=2

      223     3159    1        CALL BINCHAR(MON,B.MM);

   3159  2 000270   000100 301500                    BTD
         2 000271   200041 000004                    NDSC9   B,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 000272   200027 030002                    NDSC9   MON,,AUTO                cn=0,s=nosgn,sf=0,n=2

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:40   
      224     3160    1        CALL CONCAT(T$->ST8,MON,'/',DAY,'/',YR); /* OUTPUT                         */

   3160  2 000273   200016 470500                    LDP0    T$,,AUTO
         2 000274   040100 100500                    MLR     fill='040'O
         2 000275   200027 000002                    ADSC9   MON,,AUTO                cn=0,n=2
         2 000276   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000277   040100 100400                    MLR     fill='040'O
         2 000300   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000301   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 000302   040100 100500                    MLR     fill='040'O
         2 000303   200030 000002                    ADSC9   DAY,,AUTO                cn=0,n=2
         2 000304   000000 600002                    ADSC9   0,,PR0                   cn=3,n=2
         2 000305   040100 100400                    MLR     fill='040'O
         2 000306   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000307   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         2 000310   040100 100500                    MLR     fill='040'O
         2 000311   200031 000002                    ADSC9   YR,,AUTO                 cn=0,n=2
         2 000312   000001 400002                    ADSC9   1,,PR0                   cn=2,n=2

      225     3161    1        CALL CONCAT(T1$->ST5,HRS,':',MINS);

   3161  2 000313   200017 470500                    LDP0    T1$,,AUTO
         2 000314   040100 100500                    MLR     fill='040'O
         2 000315   200026 000002                    ADSC9   HRS,,AUTO                cn=0,n=2
         2 000316   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000317   040100 100400                    MLR     fill='040'O
         2 000320   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000321   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 000322   040100 100500                    MLR     fill='040'O
         2 000323   200025 000002                    ADSC9   MINS,,AUTO               cn=0,n=2
         2 000324   000000 600002                    ADSC9   0,,PR0                   cn=3,n=2

      226     3162    1        RETURN;

   3162  2 000325   000000 702200 xent               TSX2  ! X66_ARET

      227     3163
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:41   
      228     3164        /*   Return internal date and time from input UTS.
      229     3165        */
      230     3166    1   UMT$IDT2: ENTRY(UTSTMP,DATE,TIME) ALTRET;

   3166  2 000326   000000 700200 xent  UMT$IDT2     TSX0  ! X66_AUTO_3
         2 000327   000066 000003                    ZERO    54,3

      231     3167    1        UTIME = UTSTMP;

   3167  2 000330   200003 470500                    LDP0    @UTSTMP,,AUTO
         2 000331   000000 235100                    LDA     0,,PR0
         2 000332   200006 755100                    STA     UTIME,,AUTO

      232     3168    1        T$ = ADDR(DATE);

   3168  2 000333   200004 236100                    LDQ     @DATE,,AUTO
         2 000334   200016 756100                    STQ     T$,,AUTO

      233     3169    1        T1$ = ADDR(TIME);

   3169  2 000335   200005 236100                    LDQ     @TIME,,AUTO
         2 000336   200017 756100                    STQ     T1$,,AUTO

      234     3170    1        GOTO COMMON_IDT;

   3170  2 000337   000247 710000 2                  TRA     COMMON_IDT

      235     3171
      236     3172        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:42   
      237     3173    1   UMT$TIME: ENTRY ALTRET;

   3173  2 000340   000000 700200 xent  UMT$TIME     TSX0  ! X66_AUTO_3
         2 000341   000066 000003                    ZERO    54,3

      238     3174        /*                                                                    */
      239     3175        /* THIS PROCEDURE CONVERTS AN INPUT, WHOSE FORMAT IS SPECIFIED BY     */
      240     3176        /* 'SOURCE' IN THE FPT, TO AN OUTPUT DATE AND TIME.  THE OUTPUT FORMAT*/
      241     3177        /* IS SELECTED BY THE FPT 'DEST' OPTION.                              */
      242     3178        /*                                                                    */
      243     3179        /*         CONVERT SOURCE TO BINARY DATE AND TIME                     */
      244     3180    2        DO CASE (B$PS0$->FPT$TIME_V.SOURCE);

   3180  2 000342   000000 470400 xsym               LDP0    B$PS0$
         2 000343   000000 236100                    LDQ     0,,PR0
         2 000344   000033 772000                    QRL     27
         2 000345   000011 116007                    CMPQ    9,DL
         2 000346   000350 602006 2                  TNC     s:3180+6,QL
         2 000347   000637 710000 2                  TRA     s:3228
         2 000350   000454 710000 2                  TRA     s:3198
         2 000351   000637 710000 2                  TRA     s:3228
         2 000352   000361 710000 2                  TRA     s:3182
         2 000353   000423 710000 2                  TRA     s:3193
         2 000354   000465 710000 2                  TRA     s:3201
         2 000355   000515 710000 2                  TRA     s:3207
         2 000356   000465 710000 2                  TRA     s:3201
         2 000357   000637 710000 2                  TRA     s:3228
         2 000360   000572 710000 2                  TRA     s:3218

      245     3181    2        CASE(%ANS#);

      246     3182    2           CALL HFF$NILERASE(1)

   3182  2 000361   000004 630400 3                  EPPR0   4
         2 000362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000363   000000 701000 xent               TSX1    HFF$NILERASE
         2 000364   000402 702000 2                  TSX2    s:3188
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:43   

      247     3183    3           WHENRETURN DO;

      248     3184    3              CALL HFF$DSIZ(1,DTSZ);

   3184  2 000365   200013 630500                    EPPR0   DTSZ,,AUTO
         2 000366   200063 450500                    STP0    X+2,,AUTO
         2 000367   000004 236000 3                  LDQ     4
         2 000370   200062 756100                    STQ     X+1,,AUTO
         2 000371   200062 630500                    EPPR0   X+1,,AUTO
         2 000372   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000373   000000 701000 xent               TSX1    HFF$DSIZ
         2 000374   000000 011000                    NOP     0

      249     3185    3              CALL ANSDATE(B$PS1$->A) ALTRET(DTERR);

   3185  2 000375   000000 236000 xsym               LDQ     B$PS1$
         2 000376   200055 756100                    STQ     DQH$+3,,AUTO
         2 000377   001721 701000 2                  TSX1    ANSDATE
         2 000400   001266 702000 2                  TSX2    DTERR

      250     3186    3              END;

   3186  2 000401   000406 710000 2                  TRA     s:3190

      251     3187    3           WHENALTRETURN DO;

      252     3188    3              CALL JULDATE(B$PS3$->A) ALTRET(DTERR);

   3188  2 000402   000000 236000 xsym               LDQ     B$PS3$
         2 000403   200055 756100                    STQ     DQH$+3,,AUTO
         2 000404   001473 701000 2                  TSX1    JULDATE
         2 000405   001266 702000 2                  TSX2    DTERR

      253     3189    3              END;

      254     3190    2           CALL HFF$DSIZ(2,TMSZ);
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:44   

   3190  2 000406   200014 630500                    EPPR0   TMSZ,,AUTO
         2 000407   200063 450500                    STP0    X+2,,AUTO
         2 000410   000005 236000 3                  LDQ     5
         2 000411   200062 756100                    STQ     X+1,,AUTO
         2 000412   200062 630500                    EPPR0   X+1,,AUTO
         2 000413   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000414   000000 701000 xent               TSX1    HFF$DSIZ
         2 000415   000000 011000                    NOP     0

      255     3191    2           CALL ANSTIME(B$PS2$->A) ALTRET(DTERR);

   3191  2 000416   000000 236000 xsym               LDQ     B$PS2$
         2 000417   200055 756100                    STQ     DQH$+3,,AUTO
         2 000420   001757 701000 2                  TSX1    ANSTIME
         2 000421   001266 702000 2                  TSX2    DTERR
         2 000422   000637 710000 2                  TRA     s:3228

      256     3192    2        CASE (%LOCAL#);

      257     3193    2           CALL HFF$DSIZ(1,DTSZ);

   3193  2 000423   200013 631500                    EPPR1   DTSZ,,AUTO
         2 000424   200063 451500                    STP1    X+2,,AUTO
         2 000425   000004 236000 3                  LDQ     4
         2 000426   200062 756100                    STQ     X+1,,AUTO
         2 000427   200062 630500                    EPPR0   X+1,,AUTO
         2 000430   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000431   000000 701000 xent               TSX1    HFF$DSIZ
         2 000432   000000 011000                    NOP     0

      258     3194    2           CALL LOCALDATE(B$PS1$->A) ALTRET (DTERR);

   3194  2 000433   000000 236000 xsym               LDQ     B$PS1$
         2 000434   200055 756100                    STQ     DQH$+3,,AUTO
         2 000435   001276 701000 2                  TSX1    LOCALDATE
         2 000436   001266 702000 2                  TSX2    DTERR
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:45   

      259     3195    2           CALL HFF$DSIZ(2,TMSZ);

   3195  2 000437   200014 630500                    EPPR0   TMSZ,,AUTO
         2 000440   200063 450500                    STP0    X+2,,AUTO
         2 000441   000005 236000 3                  LDQ     5
         2 000442   200062 756100                    STQ     X+1,,AUTO
         2 000443   200062 630500                    EPPR0   X+1,,AUTO
         2 000444   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000445   000000 701000 xent               TSX1    HFF$DSIZ
         2 000446   000000 011000                    NOP     0

      260     3196    2           CALL LOCALTIME(B$PS2$->A) ALTRET (DTERR);

   3196  2 000447   000000 236000 xsym               LDQ     B$PS2$
         2 000450   200055 756100                    STQ     DQH$+3,,AUTO
         2 000451   001564 701000 2                  TSX1    LOCALTIME
         2 000452   001266 702000 2                  TSX2    DTERR
         2 000453   000637 710000 2                  TRA     s:3228

      261     3197    2        CASE (%CLOCK#);

      262     3198    2           CALL SSS$SYSTIME(UTIME);        /* CONVERT CURRENT CLOCK TIME         */

   3198  2 000454   200006 631500                    EPPR1   UTIME,,AUTO
         2 000455   200062 451500                    STP1    X+1,,AUTO
         2 000456   200062 630500                    EPPR0   X+1,,AUTO
         2 000457   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000460   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000461   000000 011000                    NOP     0

      263     3199    2           CALL UTSDATE;

   3199  2 000462   002021 701000 2                  TSX1    UTSDATE
         2 000463   000000 011000                    NOP     0
         2 000464   000637 710000 2                  TRA     s:3228

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:46   
      264     3200    2        CASE (%UTS#,%FUTS#);

      265     3201    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);

   3201  2 000465   000006 630400 3                  EPPR0   6
         2 000466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000467   000000 701000 xent               TSX1    HFF$NILERASE
         2 000470   001272 702000 2                  TSX2    NOPS4

      266     3202    2           UTIMEC=B$PS4$->AC;              /* CONVERT INPUT UTS                  */

   3202  2 000471   000000 470400 xsym               LDP0    B$PS4$
         2 000472   040100 100500                    MLR     fill='040'O
         2 000473   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         2 000474   200006 000004                    ADSC9   UTIME,,AUTO              cn=0,n=4

      267     3203    2           IF B$PS0$->FPT$TIME_V.SOURCE = %FUTS# THEN

   3203  2 000475   000000 471400 xsym               LDP1    B$PS0$
         2 000476   100000 236100                    LDQ     0,,PR1
         2 000477   777000 376003                    ANQ     -512,DU
         2 000500   006000 116003                    CMPQ    3072,DU
         2 000501   000512 601000 2                  TNZ     s:3205

      268     3204    2              CALL SSS$L6_UTS (UTIMEC,UTIMEC) ALTRET(DTERR);

   3204  2 000502   200006 633500                    EPPR3   UTIME,,AUTO
         2 000503   200063 453500                    STP3    X+2,,AUTO
         2 000504   200006 634500                    EPPR4   UTIME,,AUTO
         2 000505   200062 454500                    STP4    X+1,,AUTO
         2 000506   200062 630500                    EPPR0   X+1,,AUTO
         2 000507   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000510   000000 701000 xent               TSX1    SSS$L6_UTS
         2 000511   001266 702000 2                  TSX2    DTERR

      269     3205    2           CALL UTSDATE;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:47   
   3205  2 000512   002021 701000 2                  TSX1    UTSDATE
         2 000513   000000 011000                    NOP     0
         2 000514   000637 710000 2                  TRA     s:3228

      270     3206    2        CASE (%TUN#);

      271     3207    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);

   3207  2 000515   000006 630400 3                  EPPR0   6
         2 000516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000517   000000 701000 xent               TSX1    HFF$NILERASE
         2 000520   001272 702000 2                  TSX2    NOPS4

      272     3208    2           UTC=B$PS4$->AC;

   3208  2 000521   000000 470400 xsym               LDP0    B$PS4$
         2 000522   040100 100500                    MLR     fill='040'O
         2 000523   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         2 000524   200007 000004                    ADSC9   UTI,,AUTO                cn=0,n=4

      273     3209    2           CALL SSS$SYSTIME(UTIME);   /* GET CURRENT TIME, SUBSTITUTE INPUT TUN*/

   3209  2 000525   200006 631500                    EPPR1   UTIME,,AUTO
         2 000526   200062 451500                    STP1    X+1,,AUTO
         2 000527   200062 630500                    EPPR0   X+1,,AUTO
         2 000530   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000531   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000532   000000 011000                    NOP     0

      274     3210    2           IF UTIME > %UTS_CUSP# THEN      /* post-cusp UTSes use new tic */

   3210  2 000533   000120 236000 1                  LDQ     MONS+58
         2 000534   200006 116100                    CMPQ    UTIME,,AUTO
         2 000535   000553 603000 2                  TRC     s:3213

      275     3211    2              UTIME = (UTIME / %UTS_25TH_DAY#) * %UTS_25TH_DAY# + UTI/40;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:48   
   3211  2 000536   200006 236100                    LDQ     UTIME,,AUTO
         2 000537   000001 772000                    QRL     1
         2 000540   000007 506000 3                  DIV     7
         2 000541   200062 756100                    STQ     X+1,,AUTO
         2 000542   200007 236100                    LDQ     UTI,,AUTO
         2 000543   000001 772000                    QRL     1
         2 000544   000024 506007                    DIV     20,DL
         2 000545   200063 756100                    STQ     X+2,,AUTO
         2 000546   200062 236100                    LDQ     X+1,,AUTO
         2 000547   000010 402000 3                  MPY     8
         2 000550   200063 036100                    ADLQ    X+2,,AUTO
         2 000551   200006 756100                    STQ     UTIME,,AUTO
         2 000552   000567 710000 2                  TRA     s:3214

      276     3212    2           ELSE
      277     3213    2              UTIME = (UTIME / %UTS_CSEC_DAY#) * %UTS_CSEC_DAY# + UTI/10;

   3213  2 000553   200006 236100                    LDQ     UTIME,,AUTO
         2 000554   000001 772000                    QRL     1
         2 000555   000011 506000 3                  DIV     9
         2 000556   200062 756100                    STQ     X+1,,AUTO
         2 000557   200007 236100                    LDQ     UTI,,AUTO
         2 000560   000001 772000                    QRL     1
         2 000561   000005 506007                    DIV     5,DL
         2 000562   200063 756100                    STQ     X+2,,AUTO
         2 000563   200062 236100                    LDQ     X+1,,AUTO
         2 000564   000012 402000 3                  MPY     10
         2 000565   200063 036100                    ADLQ    X+2,,AUTO
         2 000566   200006 756100                    STQ     UTIME,,AUTO

      278     3214    2           CALL UTSDATE;

   3214  2 000567   002021 701000 2                  TSX1    UTSDATE
         2 000570   000000 011000                    NOP     0
         2 000571   000637 710000 2                  TRA     s:3228

      279     3215
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:49   
      280     3216    2        CASE (%UNQUTS#);

      281     3217
      282     3218    2           CALL SSS$BLOCK;                 /* BLOCK FOR MASTER */

   3218  2 000572   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000573   000000 701000 xent               TSX1    SSS$BLOCK
         2 000574   000000 011000                    NOP     0

      283     3219    2           CALL SSS$SYSTIME (UTIME);

   3219  2 000575   200006 630500                    EPPR0   UTIME,,AUTO
         2 000576   200062 450500                    STP0    X+1,,AUTO
         2 000577   200062 630500                    EPPR0   X+1,,AUTO
         2 000600   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000601   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000602   000000 011000                    NOP     0

      284     3220    3           DO WHILE (UMT_UNIQUE >= UTIME);

   3220  2 000603   000000 236000 0                  LDQ     UMT_UNIQUE
         2 000604   200006 116100                    CMPQ    UTIME,,AUTO
         2 000605   000633 602000 2                  TNC     s:3224

      285     3221    3              CALL SSR$REG (%SS_SL, ADDR(NIL), 1);

   3221  2 000606   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000607   200062 756100                    STQ     X+1,,AUTO
         2 000610   000004 236000 3                  LDQ     4
         2 000611   200065 756100                    STQ     X+4,,AUTO
         2 000612   200062 630500                    EPPR0   X+1,,AUTO
         2 000613   200064 450500                    STP0    X+3,,AUTO
         2 000614   000014 236000 3                  LDQ     12
         2 000615   200063 756100                    STQ     X+2,,AUTO
         2 000616   200063 630500                    EPPR0   X+2,,AUTO
         2 000617   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000620   000000 701000 xent               TSX1    SSR$REG
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:50   
         2 000621   000000 011000                    NOP     0

      286     3222    3              CALL SSS$SYSTIME (UTIME);

   3222  2 000622   200006 630500                    EPPR0   UTIME,,AUTO
         2 000623   200062 450500                    STP0    X+1,,AUTO
         2 000624   200062 630500                    EPPR0   X+1,,AUTO
         2 000625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000626   000000 701000 xent               TSX1    SSS$SYSTIME
         2 000627   000000 011000                    NOP     0

      287     3223    3              END;                         /* DO WHILE */

   3223  2 000630   000000 236000 0                  LDQ     UMT_UNIQUE
         2 000631   200006 116100                    CMPQ    UTIME,,AUTO
         2 000632   000606 603000 2                  TRC     s:3221

      288     3224    2           UMT_UNIQUE = UTIME;

   3224  2 000633   200006 235100                    LDA     UTIME,,AUTO
         2 000634   000000 755000 0                  STA     UMT_UNIQUE

      289     3225    2           CALL UTSDATE;

   3225  2 000635   002021 701000 2                  TSX1    UTSDATE
         2 000636   000000 011000                    NOP     0

      290     3226
      291     3227    2        END;

      292     3228    1        I = 0;                        /* figure out if we have an offset to add */

   3228  2 000637   200010 450100                    STZ     I,,AUTO

      293     3229    1        IF B$PS0$->FPT$TIME_V.SOURCE_BASIS = %UTC_BASIS#

   3229  2 000640   000000 470400 xsym               LDP0    B$PS0$
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:51   
         2 000641   000000 236100                    LDQ     0,,PR0
         2 000642   700000 376007                    ANQ     -32768,DL
         2 000643   100000 116007                    CMPQ    32768,DL
         2 000644   000650 601000 2                  TNZ     s:3232

      294     3230    1        THEN
      295     3231    1           I = I + B_SITEINFO.UTC_OFFSET#;

   3231  2 000645   200010 236100                    LDQ     I,,AUTO
         2 000646   000072 036000 xsym               ADLQ    B_SITEINFO+58
         2 000647   200010 756100                    STQ     I,,AUTO

      296     3232    1        IF B$PS0$->FPT$TIME_V.DEST_BASIS = %UTC_BASIS#

   3232  2 000650   000000 236100                    LDQ     0,,PR0
         2 000651   070000 376007                    ANQ     28672,DL
         2 000652   010000 116007                    CMPQ    4096,DL
         2 000653   000657 601000 2                  TNZ     s:3235

      297     3233    1        THEN
      298     3234    1           I = I - B_SITEINFO.UTC_OFFSET#;

   3234  2 000654   200010 236100                    LDQ     I,,AUTO
         2 000655   000072 136000 xsym               SBLQ    B_SITEINFO+58
         2 000656   200010 756100                    STQ     I,,AUTO

      299     3235    1        IF I ~= 0                     /* we have an offset to add to the time */

   3235  2 000657   200010 235100                    LDA     I,,AUTO
         2 000660   000677 600000 2                  TZE     s:3242

      300     3236    2        THEN DO;

      301     3237    2           CALL DATEUTS ALTRET(DTERR);

   3237  2 000661   002166 701000 2                  TSX1    DATEUTS
         2 000662   001266 702000 2                  TSX2    DTERR
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:52   

      302     3238    2           CALL XUD$UTS_ADJUST(UTIME, UTIME, I) ALTRET(DTERR);

   3238  2 000663   200010 630500                    EPPR0   I,,AUTO
         2 000664   200064 450500                    STP0    X+3,,AUTO
         2 000665   200006 631500                    EPPR1   UTIME,,AUTO
         2 000666   200063 451500                    STP1    X+2,,AUTO
         2 000667   200006 633500                    EPPR3   UTIME,,AUTO
         2 000670   200062 453500                    STP3    X+1,,AUTO
         2 000671   200062 630500                    EPPR0   X+1,,AUTO
         2 000672   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000673   000000 701000 xent               TSX1    XUD$UTS_ADJUST
         2 000674   001266 702000 2                  TSX2    DTERR

      303     3239    2           CALL UTSDATE;

   3239  2 000675   002021 701000 2                  TSX1    UTSDATE
         2 000676   000000 011000                    NOP     0

      304     3240    2           END;

      305     3241        /*         FORMAT DATE AND TIME FOR OUTPUT                            */
      306     3242    2        DO CASE (B$PS0$->FPT$TIME_V.DEST); /*  FORMAT OUTPUT                     */

   3242  2 000677   000000 470400 xsym               LDP0    B$PS0$
         2 000700   000000 220100                    LDX0    0,,PR0
         2 000701   000777 360003                    ANX0    511,DU
         2 000702   000007 100003                    CMPX0   7,DU
         2 000703   000705 602010 2                  TNC     s:3242+6,X0
         2 000704   001242 710000 2                  TRA     UT
         2 000705   001242 710000 2                  TRA     UT
         2 000706   000761 710000 2                  TRA     s:3261
         2 000707   000761 710000 2                  TRA     s:3261
         2 000710   000761 710000 2                  TRA     s:3261
         2 000711   000714 710000 2                  TRA     s:3244
         2 000712   000744 710000 2                  TRA     s:3255
         2 000713   000714 710000 2                  TRA     s:3244
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:53   

      307     3243    2        CASE(%UTS#,%FUTS#);

      308     3244    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);

   3244  2 000714   000006 630400 3                  EPPR0   6
         2 000715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000716   000000 701000 xent               TSX1    HFF$NILERASE
         2 000717   001272 702000 2                  TSX2    NOPS4

      309     3245    2           CALL DATEUTS ALTRET(DTERR);

   3245  2 000720   002166 701000 2                  TSX1    DATEUTS
         2 000721   001266 702000 2                  TSX2    DTERR

      310     3246    2           IF B$PS0$->FPT$TIME_V.DEST = %FUTS#

   3246  2 000722   000000 470400 xsym               LDP0    B$PS0$
         2 000723   000000 236100                    LDQ     0,,PR0
         2 000724   000777 376003                    ANQ     511,DU
         2 000725   000006 116003                    CMPQ    6,DU
         2 000726   000737 601000 2                  TNZ     s:3250

      311     3247    3           THEN DO;

      312     3248    3              CALL SSS$UTS_L6 (UTIMEC,UTIMEC) ALTRET(DTERR);

   3248  2 000727   200006 631500                    EPPR1   UTIME,,AUTO
         2 000730   200063 451500                    STP1    X+2,,AUTO
         2 000731   200006 633500                    EPPR3   UTIME,,AUTO
         2 000732   200062 453500                    STP3    X+1,,AUTO
         2 000733   200062 630500                    EPPR0   X+1,,AUTO
         2 000734   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000735   000000 701000 xent               TSX1    SSS$UTS_L6
         2 000736   001266 702000 2                  TSX2    DTERR

      313     3249    3              END;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:54   

      314     3250    2           B$PS4$->AC=UTIMEC;

   3250  2 000737   000000 470400 xsym               LDP0    B$PS4$
         2 000740   040100 100500                    MLR     fill='040'O
         2 000741   200006 000004                    ADSC9   UTIME,,AUTO              cn=0,n=4
         2 000742   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      315     3251    2           RETURN;

   3251  2 000743   000000 702200 xent               TSX2  ! X66_ARET

      316     3252
      317     3253
      318     3254    2        CASE (%TUN#);

      319     3255    2           CALL HFF$NILERASE(4) ALTRET(NOPS4);

   3255  2 000744   000006 630400 3                  EPPR0   6
         2 000745   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000746   000000 701000 xent               TSX1    HFF$NILERASE
         2 000747   001272 702000 2                  TSX2    NOPS4

      320     3256    2           CALL DATEUTS ALTRET(DTERR);

   3256  2 000750   002166 701000 2                  TSX1    DATEUTS
         2 000751   001266 702000 2                  TSX2    DTERR

      321     3257    2           UTIME=TUNITS;

   3257  2 000752   200015 235100                    LDA     TUNITS,,AUTO
         2 000753   200006 755100                    STA     UTIME,,AUTO

      322     3258    2           B$PS4$->AC=UTIMEC;

   3258  2 000754   000000 470400 xsym               LDP0    B$PS4$
         2 000755   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:55   
         2 000756   200006 000004                    ADSC9   UTIME,,AUTO              cn=0,n=4
         2 000757   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      323     3259    2           RETURN;

   3259  2 000760   000000 702200 xent               TSX2  ! X66_ARET

      324     3260    2        CASE (%EXT#,%ANS#,%LOCAL#);

      325     3261    2           WKD=MOD(B.YY*365+(B.YY-1)/4 +JD,7); /* Day of the week */

   3261  2 000761   200043 236100                    LDQ     B+2,,AUTO
         2 000762   000001 136007                    SBLQ    1,DL
         2 000763   000004 506007                    DIV     4,DL
         2 000764   200062 756100                    STQ     X+1,,AUTO
         2 000765   200043 236100                    LDQ     B+2,,AUTO
         2 000766   000555 402007                    MPY     365,DL
         2 000767   200062 036100                    ADLQ    X+1,,AUTO
         2 000770   200037 036100                    ADLQ    JD,,AUTO
         2 000771   000007 506007                    DIV     7,DL
         2 000772   200035 755100                    STA     WKD,,AUTO

      326     3262    2           CALL BINCHAR(SEC,B.SS);         /* CONVERT DATE & TIME TO CHARS       */

   3262  2 000773   000100 301500                    BTD
         2 000774   200046 000004                    NDSC9   B+5,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 000775   200021 030002                    NDSC9   SEC,,AUTO                cn=0,s=nosgn,sf=0,n=2

      327     3263    2           CALL BINCHAR(HSEC,B.SS00);

   3263  2 000776   000100 301500                    BTD
         2 000777   200047 000004                    NDSC9   B+6,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 001000   200020 030002                    NDSC9   HSEC,,AUTO               cn=0,s=nosgn,sf=0,n=2

      328     3264    2           CALL BINCHAR(HRS,B.HH);

   3264  2 001001   000100 301500                    BTD
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:56   
         2 001002   200044 000004                    NDSC9   B+3,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 001003   200026 030002                    NDSC9   HRS,,AUTO                cn=0,s=nosgn,sf=0,n=2

      329     3265    2           CALL BINCHAR(MINS,B.MI);

   3265  2 001004   000100 301500                    BTD
         2 001005   200045 000004                    NDSC9   B+4,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 001006   200025 030002                    NDSC9   MINS,,AUTO               cn=0,s=nosgn,sf=0,n=2

      330     3266    2           CALL BINCHAR(DAY,B.DD);

   3266  2 001007   000100 301500                    BTD
         2 001010   200042 000004                    NDSC9   B+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 001011   200030 030002                    NDSC9   DAY,,AUTO                cn=0,s=nosgn,sf=0,n=2

      331     3267    2           CALL BINCHAR(MON,B.MM);

   3267  2 001012   000100 301500                    BTD
         2 001013   200041 000004                    NDSC9   B,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 001014   200027 030002                    NDSC9   MON,,AUTO                cn=0,s=nosgn,sf=0,n=2

      332     3268    2           CALL BINCHAR (YR, MOD (B.YY, 100));

   3268  2 001015   200043 236100                    LDQ     B+2,,AUTO
         2 001016   000144 506007                    DIV     100,DL
         2 001017   200062 755100                    STA     X+1,,AUTO
         2 001020   000100 301500                    BTD
         2 001021   200062 000004                    NDSC9   X+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         2 001022   200031 030002                    NDSC9   YR,,AUTO                 cn=0,s=nosgn,sf=0,n=2

      333     3269    2           CALL BINCHAR(JDAY,JD);

   3269  2 001023   000100 301500                    BTD
         2 001024   200037 000004                    NDSC9   JD,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
         2 001025   200036 030003                    NDSC9   JDAY,,AUTO               cn=0,s=nosgn,sf=0,n=3

      334     3270        /*                                                  normalize the B structure */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:57   
      335     3271        /**/
      336     3272    2           CALL HFF$NILERASE(1) ALTRET(TM2);

   3272  2 001026   000004 630400 3                  EPPR0   4
         2 001027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001030   000000 701000 xent               TSX1    HFF$NILERASE
         2 001031   001120 702000 2                  TSX2    TM2

      337     3273    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);

   3273  2 001032   000000 470400 xsym               LDP0    B$PS0$
         2 001033   000000 220100                    LDX0    0,,PR0
         2 001034   000777 360003                    ANX0    511,DU
         2 001035   000004 100003                    CMPX0   4,DU
         2 001036   001040 602010 2                  TNC     s:3273+6,X0
         2 001037   001120 710000 2                  TRA     TM2
         2 001040   001120 710000 2                  TRA     TM2
         2 001041   001101 710000 2                  TRA     s:3281
         2 001042   001044 710000 2                  TRA     s:3275
         2 001043   001060 710000 2                  TRA     s:3278

      338     3274    3           CASE(%ANS#);                    /* FORMAT DATE                        */

      339     3275    3              CALL CONCAT (CTEMP,YR,MON,DAY);

   3275  2 001044   200031 221100                    LDX1    YR,,AUTO
         2 001045   200022 741100                    STX1    CTEMP,,AUTO
         2 001046   200027 222100                    LDX2    MON,,AUTO
         2 001047   200022 442100                    SXL2    CTEMP,,AUTO
         2 001050   040100 100500                    MLR     fill='040'O
         2 001051   200030 000002                    ADSC9   DAY,,AUTO                cn=0,n=2
         2 001052   200023 000010                    ADSC9   CTEMP+1,,AUTO            cn=0,n=8

      340     3276    3              B$PS1$->ST6 = CTEMP;

   3276  2 001053   000000 470400 xsym               LDP0    B$PS1$
         2 001054   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:58   
         2 001055   200022 000006                    ADSC9   CTEMP,,AUTO              cn=0,n=6
         2 001056   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         2 001057   001120 710000 2                  TRA     TM2

      341     3277    3           CASE (%LOCAL#);

      342     3278    3              CALL CONCAT (CTEMP,MON,'/',DAY,'/',YR);

   3278  2 001060   200027 221100                    LDX1    MON,,AUTO
         2 001061   200022 741100                    STX1    CTEMP,,AUTO
         2 001062   057000 236007                    LDQ     24064,DL
         2 001063   200022 552110                    STBQ    CTEMP,'10'O,AUTO
         2 001064   040100 100500                    MLR     fill='040'O
         2 001065   200030 000002                    ADSC9   DAY,,AUTO                cn=0,n=2
         2 001066   200022 600002                    ADSC9   CTEMP,,AUTO              cn=3,n=2
         2 001067   000057 236003                    LDQ     47,DU
         2 001070   200023 552120                    STBQ    CTEMP+1,'20'O,AUTO
         2 001071   040100 100500                    MLR     fill='040'O
         2 001072   200031 000002                    ADSC9   YR,,AUTO                 cn=0,n=2
         2 001073   200023 400006                    ADSC9   CTEMP+1,,AUTO            cn=2,n=6

      343     3279    3              B$PS1$->ST8 = CTEMP;

   3279  2 001074   000000 470400 xsym               LDP0    B$PS1$
         2 001075   040100 100500                    MLR     fill='040'O
         2 001076   200022 000010                    ADSC9   CTEMP,,AUTO              cn=0,n=8
         2 001077   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 001100   001120 710000 2                  TRA     TM2

      344     3280    3           CASE (%EXT#);

      345     3281    3              CALL CONCAT (CTEMP,MONTH(B.MM-1),DAY,' ''',YR);

   3281  2 001101   200041 721100                    LXL1    B,,AUTO
         2 001102   000011 236011 1                  LDQ     WKDAY+5,X1
         2 001103   200022 756100                    STQ     CTEMP,,AUTO
         2 001104   200030 222100                    LDX2    DAY,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:59   
         2 001105   200023 742100                    STX2    CTEMP+1,,AUTO
         2 001106   000121 223000 1                  LDX3    MONS+59
         2 001107   200023 443100                    SXL3    CTEMP+1,,AUTO
         2 001110   200031 236100                    LDQ     YR,,AUTO
         2 001111   777777 376003                    ANQ     -1,DU
         2 001112   040040 276007                    ORQ     16416,DL
         2 001113   200024 756100                    STQ     CTEMP+2,,AUTO

      346     3282    3              B$PS1$->ST10 = CTEMP;

   3282  2 001114   000000 470400 xsym               LDP0    B$PS1$
         2 001115   040100 100500                    MLR     fill='040'O
         2 001116   200022 000012                    ADSC9   CTEMP,,AUTO              cn=0,n=10
         2 001117   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10

      347     3283    3           END;

      348     3284    2   TM2:    CALL HFF$NILERASE(2) ALTRET(TM3); /* FORMAT TIME                        */

   3284  2 001120   000005 630400 3     TM2          EPPR0   5
         2 001121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001122   000000 701000 xent               TSX1    HFF$NILERASE
         2 001123   001205 702000 2                  TSX2    TM3

      349     3285    2           CALL HFF$DSIZ(2,TMSZ);

   3285  2 001124   200014 630500                    EPPR0   TMSZ,,AUTO
         2 001125   200063 450500                    STP0    X+2,,AUTO
         2 001126   000005 236000 3                  LDQ     5
         2 001127   200062 756100                    STQ     X+1,,AUTO
         2 001130   200062 630500                    EPPR0   X+1,,AUTO
         2 001131   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001132   000000 701000 xent               TSX1    HFF$DSIZ
         2 001133   000000 011000                    NOP     0

      350     3286    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:60   
   3286  2 001134   000000 470400 xsym               LDP0    B$PS0$
         2 001135   000000 220100                    LDX0    0,,PR0
         2 001136   000777 360003                    ANX0    511,DU
         2 001137   000004 100003                    CMPX0   4,DU
         2 001140   001142 602010 2                  TNC     s:3286+6,X0
         2 001141   001200 710000 2                  TRA     s:3293
         2 001142   001200 710000 2                  TRA     s:3293
         2 001143   001160 710000 2                  TRA     s:3290
         2 001144   001146 710000 2                  TRA     s:3288
         2 001145   001160 710000 2                  TRA     s:3290

      351     3287    3           CASE (%ANS#);

      352     3288    3              CALL CONCAT (CTEMP,HRS,MINS,SEC,HSEC);

   3288  2 001146   200026 221100                    LDX1    HRS,,AUTO
         2 001147   200022 741100                    STX1    CTEMP,,AUTO
         2 001150   200025 222100                    LDX2    MINS,,AUTO
         2 001151   200022 442100                    SXL2    CTEMP,,AUTO
         2 001152   200021 223100                    LDX3    SEC,,AUTO
         2 001153   200023 743100                    STX3    CTEMP+1,,AUTO
         2 001154   040100 100500                    MLR     fill='040'O
         2 001155   200020 000002                    ADSC9   HSEC,,AUTO               cn=0,n=2
         2 001156   200023 400006                    ADSC9   CTEMP+1,,AUTO            cn=2,n=6
         2 001157   001200 710000 2                  TRA     s:3293

      353     3289    3           CASE (%LOCAL#,%EXT#);

      354     3290    3              CALL CONCAT (CTEMP,HRS,':',MINS,':',SEC,'.');

   3290  2 001160   200026 221100                    LDX1    HRS,,AUTO
         2 001161   200022 741100                    STX1    CTEMP,,AUTO
         2 001162   072000 236007                    LDQ     29696,DL
         2 001163   200022 552110                    STBQ    CTEMP,'10'O,AUTO
         2 001164   040100 100500                    MLR     fill='040'O
         2 001165   200025 000002                    ADSC9   MINS,,AUTO               cn=0,n=2
         2 001166   200022 600002                    ADSC9   CTEMP,,AUTO              cn=3,n=2
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:61   
         2 001167   000072 236003                    LDQ     58,DU
         2 001170   200023 552120                    STBQ    CTEMP+1,'20'O,AUTO
         2 001171   200021 222100                    LDX2    SEC,,AUTO
         2 001172   200023 442100                    SXL2    CTEMP+1,,AUTO
         2 001173   000015 236000 3                  LDQ     13
         2 001174   200024 756100                    STQ     CTEMP+2,,AUTO

      355     3291    3              SUBSTR(CTEMP,9,2) = HSEC;

   3291  2 001175   200020 236100                    LDQ     HSEC,,AUTO
         2 001176   000011 772000                    QRL     9
         2 001177   200024 552130                    STBQ    CTEMP+2,'30'O,AUTO

      356     3292    3           END;

      357     3293    2           B$PS2$->STTMSZ = CTEMP;

   3293  2 001200   000000 470400 xsym               LDP0    B$PS2$
         2 001201   200014 720100                    LXL0    TMSZ,,AUTO
         2 001202   040140 100500                    MLR     fill='040'O
         2 001203   200022 000014                    ADSC9   CTEMP,,AUTO              cn=0,n=12
         2 001204   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      358     3294    2   TM3:    CALL HFF$NILERASE(3) ALTRET(UT);

   3294  2 001205   000001 630400 3     TM3          EPPR0   1
         2 001206   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001207   000000 701000 xent               TSX1    HFF$NILERASE
         2 001210   001242 702000 2                  TSX2    UT

      359     3295    3           DO CASE (B$PS0$->FPT$TIME_V.DEST);

   3295  2 001211   000000 470400 xsym               LDP0    B$PS0$
         2 001212   000000 220100                    LDX0    0,,PR0
         2 001213   000777 360003                    ANX0    511,DU
         2 001214   000004 100003                    CMPX0   4,DU
         2 001215   001217 602010 2                  TNC     s:3295+6,X0
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:62   
         2 001216   001242 710000 2                  TRA     UT
         2 001217   001242 710000 2                  TRA     UT
         2 001220   001234 710000 2                  TRA     s:3299
         2 001221   001223 710000 2                  TRA     s:3297
         2 001222   001234 710000 2                  TRA     s:3299

      360     3296    3           CASE (%ANS#);

      361     3297    3              CALL CONCAT(B$PS3$->ST5,YR,JDAY);

   3297  2 001223   000000 471400 xsym               LDP1    B$PS3$
         2 001224   040100 100500                    MLR     fill='040'O
         2 001225   200031 000002                    ADSC9   YR,,AUTO                 cn=0,n=2
         2 001226   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         2 001227   000000 470400 xsym               LDP0    B$PS3$
         2 001230   040100 100500                    MLR     fill='040'O
         2 001231   200036 000003                    ADSC9   JDAY,,AUTO               cn=0,n=3
         2 001232   000000 400003                    ADSC9   0,,PR0                   cn=2,n=3
         2 001233   001242 710000 2                  TRA     UT

      362     3298    3           CASE (%LOCAL#,%EXT#);

      363     3299    3              B$PS3$->ST3=WKDAY(WKD);

   3299  2 001234   200035 236100                    LDQ     WKD,,AUTO
         2 001235   000003 402007                    MPY     3,DL
         2 001236   000000 471400 xsym               LDP1    B$PS3$
         2 001237   040100 100406                    MLR     fill='040'O
         2 001240   000004 000003 1                  ADSC9   WKDAY,Q                  cn=0,n=3
         2 001241   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3

      364     3300    3           END;

      365     3301    2        END;

      366     3302    1   UT:  CALL HFF$NILERASE(4) ALTRET(XTIME);

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:63   
   3302  2 001242   000006 630400 3     UT           EPPR0   6
         2 001243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001244   000000 701000 xent               TSX1    HFF$NILERASE
         2 001245   001265 702000 2                  TSX2    XTIME

      367     3303    1        IF B$PS0$->FPT$TIME_V.SOURCE ~= %UTS# AND

   3303  2 001246   000000 470400 xsym               LDP0    B$PS0$
         2 001247   000000 236100                    LDQ     0,,PR0
         2 001250   777000 376003                    ANQ     -512,DU
         2 001251   004000 116003                    CMPQ    2048,DU
         2 001252   001265 600000 2                  TZE     XTIME
         2 001253   006000 116003                    CMPQ    3072,DU
         2 001254   001265 600000 2                  TZE     XTIME
         2 001255   005000 116003                    CMPQ    2560,DU
         2 001256   001265 600000 2                  TZE     XTIME

      368     3304    1           B$PS0$->FPT$TIME_V.SOURCE ~= %FUTS# AND
      369     3305    2           B$PS0$->FPT$TIME_V.SOURCE ~= %TUN# THEN DO;

      370     3306    2           CALL DATEUTS ALTRET(DTERR);

   3306  2 001257   002166 701000 2                  TSX1    DATEUTS
         2 001260   001266 702000 2                  TSX2    DTERR

      371     3307    2           B$PS4$->AC=UTIMEC;              /* RETURN UTS                         */

   3307  2 001261   000000 470400 xsym               LDP0    B$PS4$
         2 001262   040100 100500                    MLR     fill='040'O
         2 001263   200006 000004                    ADSC9   UTIME,,AUTO              cn=0,n=4
         2 001264   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      372     3308    2           END;

      373     3309    1   XTIME: RETURN;

   3309  2 001265   000000 702200 xent  XTIME        TSX2  ! X66_ARET
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:64   

      374     3310    1   DTERR: B$JIT.ERR=%(CONCAT ('251524'O, BINBIT (E$BADDT,15), '6'O));

   3310  2 001266   000122 236000 1     DTERR        LDQ     MONS+60
         2 001267   000000 470400 xsym               LDP0    B$JIT$
         2 001270   000012 756100                    STQ     10,,PR0

      375     3311        /*E*  ERROR: UMT-E$BADDT-0
      376     3312              MESSAGE: Date or Time format error
      377     3313              DESCRIPTION: Date or time character string non numeric or
      378     3314              incorrectly formatted.       */
      379     3315    1        RETURN;

   3315  2 001271   000000 702200 xent               TSX2  ! X66_ARET

      380     3316    1   NOPS4: B$JIT.ERR=%(CONCAT ('251524'O, BINBIT (E$BADVECT4,15), '6'O));

   3316  2 001272   000123 236000 1     NOPS4        LDQ     MONS+61
         2 001273   000000 470400 xsym               LDP0    B$JIT$
         2 001274   000012 756100                    STQ     10,,PR0
         2 001275   002252 710000 2                  TRA     s:3484

      381     3317                                                /* NEEDED B$PS4$ BUT DIDNT HAVE IT    */
      382     3318        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:65   
      383     3319        /*                                                                    */
      384     3320        /*         CONVERT LOCAL FORM TO BINARY DATE AND TIME                 */
      385     3321    1   LOCALDATE: PROC(DATE) ALTRET;

   3321  2 001276   200054 741300       LOCALDATE    STX1  ! DQH$+2,,AUTO

      386     3322        /*                                                                    */
      387     3323    2   DCL   DATE CHAR(8);
      388     3324    2   DCL   TMP CHAR(12);
      389     3325    2   DCL   X SBIN;
      390     3326        /*                                                                    */
      391     3327    2        B = '0'B;

   3327  2 001277   000100 100400                    MLR     fill='000'O
         2 001300   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001301   200041 000034                    ADSC9   B,,AUTO                  cn=0,n=28

      392     3328    2        TMP = SUBSTR (DATE, 0, MINIMUM( DTSZ, 8));

   3328  2 001302   000010 236007                    LDQ     8,DL
         2 001303   200013 116100                    CMPQ    DTSZ,,AUTO
         2 001304   001307 602000 2                  TNC     s:3328+5
         2 001305   001307 600000 2                  TZE     s:3328+5
         2 001306   200013 236100                    LDQ     DTSZ,,AUTO
         2 001307   200055 470500                    LDP0    @DATE,,AUTO
         2 001310   000000 620006                    EAX0    0,QL
         2 001311   040100 100540                    MLR     fill='040'O
         2 001312   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001313   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12

      393     3329    2        CALL SEARCH (I,X,NON_DECIMAL,TMP);

   3329  2 001314   000000 471400 xsym               LDP1    B$SR_NON_DEC$
         2 001315   000000 164500                    TCT
         2 001316   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12
         2 001317   100000 000100                    ARG     0,,PR1
         2 001320   200010 000100                    ARG     I,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:66   
         2 001321   200010 235100                    LDA     I,,AUTO
         2 001322   000033 771000                    ARL     27
         2 001323   200061 755100                    STA     X,,AUTO
         2 001324   200010 551140                    STBA    I,'40'O,AUTO

      394     3330    2        IF SUBSTR (TMP,I,1) ~= '/' THEN GOTO DATERR;

   3330  2 001325   200010 236100                    LDQ     I,,AUTO
         2 001326   040000 106506                    CMPC    fill='040'O
         2 001327   200056 000001                    ADSC9   TMP,Q,AUTO               cn=0,n=1
         2 001330   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 001331   002017 601000 2                  TNZ     DATERR

      395     3331    2        IF I > 0 THEN CALL CHARBIN (B.MM,SUBSTR(TMP,0,I));

   3331  2 001332   000000 116003                    CMPQ    0,DU
         2 001333   001340 604400 2                  TMOZ    s:3332

   3331  2 001334   000000 620006                    EAX0    0,QL
         2 001335   000100 305540                    DTB
         2 001336   200056 030010                    NDSC9   TMP,,AUTO                cn=0,s=nosgn,sf=0,n=*X0
         2 001337   200041 000004                    NDSC9   B,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      396     3332    2        CALL SEARCH (J,X,NON_DECIMAL,TMP,I+1);

   3332  2 001340   200010 720100                    LXL0    I,,AUTO
         2 001341   777764 620010                    EAX0    -12,X0
         2 001342   777777 660003                    ERX0    -1,DU
         2 001343   200010 236100                    LDQ     I,,AUTO
         2 001344   000001 036007                    ADLQ    1,DL
         2 001345   200010 235100                    LDA     I,,AUTO
         2 001346   000000 164545                    TCT
         2 001347   200056 200010                    ADSC9   TMP,A,AUTO               cn=1,n=*X0
         2 001350   100000 000100                    ARG     0,,PR1
         2 001351   200011 000100                    ARG     J,,AUTO
         2 001352   200011 235100                    LDA     J,,AUTO
         2 001353   000033 771000                    ARL     27
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:67   
         2 001354   200061 755100                    STA     X,,AUTO
         2 001355   200011 551140                    STBA    J,'40'O,AUTO
         2 001356   200011 056100                    ASQ     J,,AUTO

      397     3333    2        IF SUBSTR (TMP,J,1) ~= '/' THEN GOTO DATERR;

   3333  2 001357   200011 235100                    LDA     J,,AUTO
         2 001360   040000 106505                    CMPC    fill='040'O
         2 001361   200056 000001                    ADSC9   TMP,A,AUTO               cn=0,n=1
         2 001362   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 001363   002017 601000 2                  TNZ     DATERR

      398     3334    2        K = J-I-1;

   3334  2 001364   200011 236100                    LDQ     J,,AUTO
         2 001365   200010 136100                    SBLQ    I,,AUTO
         2 001366   000001 136007                    SBLQ    1,DL
         2 001367   200012 756100                    STQ     K,,AUTO

      399     3335    2        IF K > 0 THEN CALL CHARBIN (B.DD,SUBSTR(TMP,I+1,K));

   3335  2 001370   001376 604400 2                  TMOZ    s:3336

   3335  2 001371   000000 622006                    EAX2    0,QL
         2 001372   200010 236100                    LDQ     I,,AUTO
         2 001373   000100 305546                    DTB
         2 001374   200056 230012                    NDSC9   TMP,Q,AUTO               cn=1,s=nosgn,sf=0,n=*X2
         2 001375   200042 000004                    NDSC9   B+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      400     3336    2        CALL SEARCH (I,X,NON_DECIMAL,TMP,J+1);

   3336  2 001376   777764 622005                    EAX2    -12,AL
         2 001377   777777 662003                    ERX2    -1,DU
         2 001400   200011 236100                    LDQ     J,,AUTO
         2 001401   000001 036007                    ADLQ    1,DL
         2 001402   000000 164545                    TCT
         2 001403   200056 200012                    ADSC9   TMP,A,AUTO               cn=1,n=*X2
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:68   
         2 001404   100000 000100                    ARG     0,,PR1
         2 001405   200010 000100                    ARG     I,,AUTO
         2 001406   200010 235100                    LDA     I,,AUTO
         2 001407   000033 771000                    ARL     27
         2 001410   200061 755100                    STA     X,,AUTO
         2 001411   200010 551140                    STBA    I,'40'O,AUTO
         2 001412   200010 056100                    ASQ     I,,AUTO

      401     3337    2        K = I-J-1;

   3337  2 001413   200010 236100                    LDQ     I,,AUTO
         2 001414   200011 136100                    SBLQ    J,,AUTO
         2 001415   000001 136007                    SBLQ    1,DL
         2 001416   200012 756100                    STQ     K,,AUTO

      402     3338    2        IF K > 0 THEN CALL CHARBIN (B.YY,SUBSTR(TMP,J+1,K));

   3338  2 001417   001425 604400 2                  TMOZ    LCL1

   3338  2 001420   000000 620006                    EAX0    0,QL
         2 001421   200011 236100                    LDQ     J,,AUTO
         2 001422   000100 305546                    DTB
         2 001423   200056 230010                    NDSC9   TMP,Q,AUTO               cn=1,s=nosgn,sf=0,n=*X0
         2 001424   200043 000004                    NDSC9   B+2,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      403     3339    2   LCL1:
      404     3340    2        if B.YY <= 20 then B.YY = B.YY + 100; /* year in range 2000 - 2020 */

   3340  2 001425   200043 235100       LCL1         LDA     B+2,,AUTO
         2 001426   000024 115007                    CMPA    20,DL
         2 001427   001432 605400 2                  TPNZ    s:3341

   3340  2 001430   000144 236007                    LDQ     100,DL
         2 001431   200043 056100                    ASQ     B+2,,AUTO

      405     3341    2        YY_MOD4 = MOD(B.YY,4);

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:69   
   3341  2 001432   200043 236100                    LDQ     B+2,,AUTO
         2 001433   000004 506007                    DIV     4,DL
         2 001434   200040 755100                    STA     YY_MOD4,,AUTO

      406     3342    2        JD=MONS((B.MM-1)*4+YY_MOD4)+B.DD;

   3342  2 001435   200041 236100                    LDQ     B,,AUTO
         2 001436   000002 736000                    QLS     2
         2 001437   200040 036100                    ADLQ    YY_MOD4,,AUTO
         2 001440   000022 236006 1                  LDQ     MONTH+8,QL
         2 001441   200042 036100                    ADLQ    B+1,,AUTO
         2 001442   200037 756100                    STQ     JD,,AUTO

      407     3343    2        IF B.MM < 1 OR B.MM > 12 OR

   3343  2 001443   200041 235100                    LDA     B,,AUTO
         2 001444   002017 604400 2                  TMOZ    DATERR
         2 001445   000014 115007                    CMPA    12,DL
         2 001446   002017 605400 2                  TPNZ    DATERR
         2 001447   200042 235100                    LDA     B+1,,AUTO
         2 001450   002017 604400 2                  TMOZ    DATERR
         2 001451   200041 236100                    LDQ     B,,AUTO
         2 001452   000002 736000                    QLS     2
         2 001453   200040 036100                    ADLQ    YY_MOD4,,AUTO
         2 001454   200062 756100                    STQ     X+1,,AUTO
         2 001455   200041 236100                    LDQ     B,,AUTO
         2 001456   000002 736000                    QLS     2
         2 001457   200040 036100                    ADLQ    YY_MOD4,,AUTO
         2 001460   000000 620006                    EAX0    0,QL
         2 001461   200062 721100                    LXL1    X+1,,AUTO
         2 001462   000026 236011 1                  LDQ     MONS,X1
         2 001463   000022 136010 1                  SBLQ    MONTH+8,X0
         2 001464   200042 116100                    CMPQ    B+1,,AUTO
         2 001465   002017 604000 2                  TMI     DATERR
         2 001466   200043 236100                    LDQ     B+2,,AUTO
         2 001467   000170 116007                    CMPQ    120,DL
         2 001470   002017 605400 2                  TPNZ    DATERR
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:70   

      408     3344    2           B.DD < 1 OR B.DD > (MONS(B.MM*4+YY_MOD4)-MONS((B.MM-1)*4+YY_MOD4)) OR
      409     3345    2           B.YY > 120 THEN
      410     3346    2           GOTO DATERR;
      411     3347    2        RETURN;

   3347  2 001471   200054 221300                    LDX1  ! DQH$+2,,AUTO
         2 001472   000001 702211                    TSX2  ! 1,X1

      412     3348        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:71   
      413     3349        /*                                                                    */
      414     3350        /*         CONVERT JULIEN FORM TO BINARY DATE                         */
      415     3351    2   JULDATE: ENTRY(DATE) ALTRET;

   3351  2 001473   200054 741300       JULDATE      STX1  ! DQH$+2,,AUTO

      416     3352        /**/
      417     3353    2        B = '0'B;

   3353  2 001474   000100 100400                    MLR     fill='000'O
         2 001475   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001476   200041 000034                    ADSC9   B,,AUTO                  cn=0,n=28

      418     3354    2        TMP = SUBSTR (DATE, 0, 5);

   3354  2 001477   200055 470500                    LDP0    @DATE,,AUTO
         2 001500   040100 100500                    MLR     fill='040'O
         2 001501   000000 000005                    ADSC9   0,,PR0                   cn=0,n=5
         2 001502   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12

      419     3355    2        CALL SEARCH (I,X,NON_DECIMAL,SUBSTR(TMP,0,5))

   3355  2 001503   000000 471400 xsym               LDP1    B$SR_NON_DEC$
         2 001504   000000 164500                    TCT
         2 001505   200056 000005                    ADSC9   TMP,,AUTO                cn=0,n=5
         2 001506   100000 000100                    ARG     0,,PR1
         2 001507   200010 000100                    ARG     I,,AUTO
         2 001510   200010 235100                    LDA     I,,AUTO
         2 001511   000033 771000                    ARL     27
         2 001512   200061 755100                    STA     X,,AUTO
         2 001513   200010 551140                    STBA    I,'40'O,AUTO
         2 001514   001516 606400 2                  TTN     s:3359

      420     3356    3        WHENRETURN DO;

      421     3357    3           GOTO DATERR;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:72   
   3357  2 001515   002017 710000 2                  TRA     DATERR

      422     3358    3           END;
      423     3359    2        CALL CHARBIN(B.YY,SUBSTR(TMP,0,2));

   3359  2 001516   000100 305500                    DTB
         2 001517   200056 030002                    NDSC9   TMP,,AUTO                cn=0,s=nosgn,sf=0,n=2
         2 001520   200043 000004                    NDSC9   B+2,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      424     3360    2        CALL CHARBIN(JD,SUBSTR(TMP,2,3));

   3360  2 001521   000100 305500                    DTB
         2 001522   200056 430003                    NDSC9   TMP,,AUTO                cn=2,s=nosgn,sf=0,n=3
         2 001523   200037 000004                    NDSC9   JD,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

      425     3361    2        IF B.YY <= 20 THEN B.YY = B.YY + 100; /* year in range 2000 - 2020 */

   3361  2 001524   200043 235100                    LDA     B+2,,AUTO
         2 001525   000024 115007                    CMPA    20,DL
         2 001526   001531 605400 2                  TPNZ    s:3362

   3361  2 001527   000144 236007                    LDQ     100,DL
         2 001530   200043 056100                    ASQ     B+2,,AUTO

      426     3362    2        YY_MOD4 = MOD(B.YY,4);

   3362  2 001531   200043 236100                    LDQ     B+2,,AUTO
         2 001532   000004 506007                    DIV     4,DL
         2 001533   200040 755100                    STA     YY_MOD4,,AUTO

      427     3363    2        IF JD > MONS(12*4+YY_MOD4) THEN GOTO DATERR;

   3363  2 001534   000106 236005 1                  LDQ     MONS+48,AL
         2 001535   001540 604000 2                  TMI     s:3364
         2 001536   200037 116100                    CMPQ    JD,,AUTO
         2 001537   002017 604000 2                  TMI     DATERR

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:73   
      428     3364    2        B.MM = JD/32 + 1;

   3364  2 001540   200037 236100                    LDQ     JD,,AUTO
         2 001541   000040 506007                    DIV     32,DL
         2 001542   000001 036007                    ADLQ    1,DL
         2 001543   200041 756100                    STQ     B,,AUTO

      429     3365    2        IF (JD > MONS(B.MM*4+YY_MOD4)) THEN B.MM = B.MM+1;

   3365  2 001544   000002 736000                    QLS     2
         2 001545   200040 036100                    ADLQ    YY_MOD4,,AUTO
         2 001546   000026 236006 1                  LDQ     MONS,QL
         2 001547   001553 604000 2                  TMI     s:3366
         2 001550   200037 116100                    CMPQ    JD,,AUTO
         2 001551   001553 605000 2                  TPL     s:3366

   3365  2 001552   200041 054100                    AOS     B,,AUTO

      430     3366    2        B.DD = JD - MONS((B.MM-1)*4+YY_MOD4);

   3366  2 001553   200041 236100                    LDQ     B,,AUTO
         2 001554   000002 736000                    QLS     2
         2 001555   200040 036100                    ADLQ    YY_MOD4,,AUTO
         2 001556   000000 620006                    EAX0    0,QL
         2 001557   200037 236100                    LDQ     JD,,AUTO
         2 001560   000022 136010 1                  SBLQ    MONTH+8,X0
         2 001561   200042 756100                    STQ     B+1,,AUTO

      431     3367    2        RETURN;

   3367  2 001562   200054 221300                    LDX1  ! DQH$+2,,AUTO
         2 001563   000001 702211                    TSX2  ! 1,X1

      432     3368        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:74   
      433     3369        /*                                                                    */
      434     3370        /*         CONVERT LOCAL FORM TO BINARY TIME                          */
      435     3371    2   LOCALTIME: ENTRY(DATE) ALTRET;

   3371  2 001564   200054 741300       LOCALTIME    STX1  ! DQH$+2,,AUTO

      436     3372        /**/
      437     3373    2        IF TMSZ <= 0 THEN RETURN;

   3373  2 001565   200014 235100                    LDA     TMSZ,,AUTO
         2 001566   001570 601000 2                  TNZ     s:3374

   3373  2 001567   000001 702211                    TSX2  ! 1,X1

      438     3374    2        K=0;

   3374  2 001570   200012 450100                    STZ     K,,AUTO

      439     3375    2        TMP = SUBSTR (DATE, 0, TMSZ);

   3375  2 001571   200055 470500                    LDP0    @DATE,,AUTO
         2 001572   000000 620005                    EAX0    0,AL
         2 001573   040100 100540                    MLR     fill='040'O
         2 001574   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001575   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12

      440     3376    3        DO I=3 TO 6;   /* GET TIME FIELDS                                     */

   3376  2 001576   000003 235007                    LDA     3,DL
         2 001577   200010 755100                    STA     I,,AUTO

      441     3377    3           CALL SEARCH (J,X,NON_DECIMAL,TMP,K);

   3377  2 001600   200012 720100                    LXL0    K,,AUTO
         2 001601   777763 620010                    EAX0    -13,X0
         2 001602   777777 660003                    ERX0    -1,DU
         2 001603   200012 236100                    LDQ     K,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:75   
         2 001604   000000 470400 xsym               LDP0    B$SR_NON_DEC$
         2 001605   000000 164546                    TCT
         2 001606   200056 000010                    ADSC9   TMP,Q,AUTO               cn=0,n=*X0
         2 001607   000000 000100                    ARG     0,,PR0
         2 001610   200011 000100                    ARG     J,,AUTO
         2 001611   200011 235100                    LDA     J,,AUTO
         2 001612   000033 771000                    ARL     27
         2 001613   200061 755100                    STA     X,,AUTO
         2 001614   200011 551140                    STBA    J,'40'O,AUTO
         2 001615   200011 056100                    ASQ     J,,AUTO

      442     3378    3           IF J-K ~= 0 THEN

   3378  2 001616   200011 236100                    LDQ     J,,AUTO
         2 001617   200012 136100                    SBLQ    K,,AUTO
         2 001620   001633 600000 2                  TZE     s:3380

      443     3379    3              CALL CHARBIN(DT(I),SUBSTR(TMP,K,J-K));

   3379  2 001621   200011 236100                    LDQ     J,,AUTO
         2 001622   200012 136100                    SBLQ    K,,AUTO
         2 001623   000000 621006                    EAX1    0,QL
         2 001624   200012 236100                    LDQ     K,,AUTO
         2 001625   000100 305546                    DTB
         2 001626   200056 030011                    NDSC9   TMP,Q,AUTO               cn=0,s=nosgn,sf=0,n=*X1
         2 001627   200062 000010                    NDSC9   X+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         2 001630   200010 721100                    LXL1    I,,AUTO
         2 001631   200063 235100                    LDA     X+2,,AUTO
         2 001632   200041 755111                    STA     B,X1,AUTO

      444     3380    3           K=J+1;

   3380  2 001633   200011 235100                    LDA     J,,AUTO
         2 001634   000001 035007                    ADLA    1,DL
         2 001635   200012 755100                    STA     K,,AUTO

      445     3381    3           IF I = 5 AND TMSZ > K+2 THEN GOTO DATERR;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:76   

   3381  2 001636   200010 236100                    LDQ     I,,AUTO
         2 001637   000005 116007                    CMPQ    5,DL
         2 001640   001646 601000 2                  TNZ     s:3382
         2 001641   200012 236100                    LDQ     K,,AUTO
         2 001642   000002 036007                    ADLQ    2,DL
         2 001643   002017 604000 2                  TMI     DATERR
         2 001644   200014 116100                    CMPQ    TMSZ,,AUTO
         2 001645   002017 602000 2                  TNC     DATERR

      446     3382    3           IF J >= TMSZ THEN GOTO LCL4;

   3382  2 001646   200011 236100                    LDQ     J,,AUTO
         2 001647   001652 604000 2                  TMI     s:3383
         2 001650   200014 116100                    CMPQ    TMSZ,,AUTO
         2 001651   001703 603000 2                  TRC     LCL4

      447     3383    3           IF I < 5 THEN IF SUBSTR(TMP,J,1) ~= ':' THEN GOTO DATERR; ELSE;

   3383  2 001652   200010 235100                    LDA     I,,AUTO
         2 001653   000005 115007                    CMPA    5,DL
         2 001654   001662 605000 2                  TPL     s:3384

   3383  2 001655   040000 106506                    CMPC    fill='040'O
         2 001656   200056 000001                    ADSC9   TMP,Q,AUTO               cn=0,n=1
         2 001657   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 001660   002017 601000 2                  TNZ     DATERR
         2 001661   001670 710000 2                  TRA     s:3386

      448     3384    3           ELSE IF I = 5 THEN IF SUBSTR(TMP,J,1) ~= '.' THEN GOTO DATERR; ELSE;

   3384  2 001662   002017 601000 2                  TNZ     DATERR

   3384  2 001663   040000 106506                    CMPC    fill='040'O
         2 001664   200056 000001                    ADSC9   TMP,Q,AUTO               cn=0,n=1
         2 001665   000015 000001 3                  ADSC9   13                       cn=0,n=1
         2 001666   002017 601000 2                  TNZ     DATERR
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:77   
         2 001667   001670 710000 2                  TRA     s:3386

      449     3385    3              ELSE GOTO DATERR;
      450     3386    3           END;

   3386  2 001670   200010 054100                    AOS     I,,AUTO
         2 001671   200010 235100                    LDA     I,,AUTO
         2 001672   000006 115007                    CMPA    6,DL
         2 001673   001600 604400 2                  TMOZ    s:3377

      451     3387    2        IF I = 6 AND (J-K) = 1 THEN DT(6)=DT(6)*10;

   3387  2 001674   001703 601000 2                  TNZ     LCL4
         2 001675   200012 136100                    SBLQ    K,,AUTO
         2 001676   000001 116007                    CMPQ    1,DL
         2 001677   001703 601000 2                  TNZ     LCL4

   3387  2 001700   200047 236100                    LDQ     B+6,,AUTO
         2 001701   000012 402007                    MPY     10,DL
         2 001702   200047 756100                    STQ     B+6,,AUTO

      452     3388    2   LCL4: IF B.HH>23 OR B.MI>59 OR B.SS>59 OR B.SS00>99 THEN GOTO DATERR;

   3388  2 001703   200044 235100       LCL4         LDA     B+3,,AUTO
         2 001704   000027 115007                    CMPA    23,DL
         2 001705   002017 605400 2                  TPNZ    DATERR
         2 001706   200045 236100                    LDQ     B+4,,AUTO
         2 001707   000073 116007                    CMPQ    59,DL
         2 001710   002017 605400 2                  TPNZ    DATERR
         2 001711   200046 235100                    LDA     B+5,,AUTO
         2 001712   000073 115007                    CMPA    59,DL
         2 001713   002017 605400 2                  TPNZ    DATERR
         2 001714   200047 235100                    LDA     B+6,,AUTO
         2 001715   000143 115007                    CMPA    99,DL
         2 001716   002017 605400 2                  TPNZ    DATERR

      453     3389    2        RETURN;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:78   

   3389  2 001717   200054 221300                    LDX1  ! DQH$+2,,AUTO
         2 001720   000001 702211                    TSX2  ! 1,X1

      454     3390        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:79   
      455     3391        /*        CONVERT ANS FORM TO BINARY DATE AND TIME                    */
      456     3392        /*                                                                    */
      457     3393    2   ANSDATE: ENTRY(DATE) ALTRET;

   3393  2 001721   200054 741300       ANSDATE      STX1  ! DQH$+2,,AUTO

      458     3394        /**/
      459     3395    2        B = '0'B;

   3395  2 001722   000100 100400                    MLR     fill='000'O
         2 001723   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001724   200041 000034                    ADSC9   B,,AUTO                  cn=0,n=28

      460     3396    2        TMP = SUBSTR(DATE,0,6);

   3396  2 001725   200055 470500                    LDP0    @DATE,,AUTO
         2 001726   040100 100500                    MLR     fill='040'O
         2 001727   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         2 001730   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12

      461     3397    2        CALL SEARCH (I, I, NON_DECIMAL, SUBSTR(TMP, 0, 6))

   3397  2 001731   000000 471400 xsym               LDP1    B$SR_NON_DEC$
         2 001732   000000 164500                    TCT
         2 001733   200056 000006                    ADSC9   TMP,,AUTO                cn=0,n=6
         2 001734   100000 000100                    ARG     0,,PR1
         2 001735   200010 000100                    ARG     I,,AUTO
         2 001736   200010 235100                    LDA     I,,AUTO
         2 001737   000033 771000                    ARL     27
         2 001740   200010 755100                    STA     I,,AUTO
         2 001741   200010 551140                    STBA    I,'40'O,AUTO
         2 001742   001744 606400 2                  TTN     s:3401

      462     3398    3        WHENRETURN DO;

      463     3399    3           GOTO DATERR;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:80   
   3399  2 001743   002017 710000 2                  TRA     DATERR

      464     3400    3           END;
      465     3401    2        CALL CHARBIN(B.YY,SUBSTR(DATE,0,2));

   3401  2 001744   200055 470500                    LDP0    @DATE,,AUTO
         2 001745   000100 305500                    DTB
         2 001746   000000 030002                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=2
         2 001747   200043 000004                    NDSC9   B+2,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      466     3402    2        CALL CHARBIN(B.MM,SUBSTR(DATE,2,2));

   3402  2 001750   000100 305500                    DTB
         2 001751   000000 430002                    NDSC9   0,,PR0                   cn=2,s=nosgn,sf=0,n=2
         2 001752   200041 000004                    NDSC9   B,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      467     3403    2        CALL CHARBIN(B.DD,SUBSTR(DATE,4,2));

   3403  2 001753   000100 305500                    DTB
         2 001754   000001 030002                    NDSC9   1,,PR0                   cn=0,s=nosgn,sf=0,n=2
         2 001755   200042 000004                    NDSC9   B+1,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      468     3404    2        GOTO LCL1;

   3404  2 001756   001425 710000 2                  TRA     LCL1

      469     3405        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:81   
      470     3406        /*        CONVERT ANS FORM TO BINARY TIME                             */
      471     3407        /*                                                                    */
      472     3408    2   ANSTIME: ENTRY(DATE) ALTRET;

   3408  2 001757   200054 741300       ANSTIME      STX1  ! DQH$+2,,AUTO

      473     3409        /**/
      474     3410    3        IF TMSZ > 0 THEN DO;

   3410  2 001760   200014 235100                    LDA     TMSZ,,AUTO
         2 001761   002016 600000 2                  TZE     s:3421

      475     3411    3           TMP = SUBSTR(DATE,0,8);

   3411  2 001762   200055 470500                    LDP0    @DATE,,AUTO
         2 001763   040100 100500                    MLR     fill='040'O
         2 001764   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 001765   200056 000014                    ADSC9   TMP,,AUTO                cn=0,n=12

      476     3412    3           CALL SEARCH (I, I, NON_DECIMAL, SUBSTR(TMP, 0, 8))

   3412  2 001766   000000 471400 xsym               LDP1    B$SR_NON_DEC$
         2 001767   000000 164500                    TCT
         2 001770   200056 000010                    ADSC9   TMP,,AUTO                cn=0,n=8
         2 001771   100000 000100                    ARG     0,,PR1
         2 001772   200010 000100                    ARG     I,,AUTO
         2 001773   200010 236100                    LDQ     I,,AUTO
         2 001774   000044 737000                    LLS     36
         2 001775   000033 771000                    ARL     27
         2 001776   200010 755100                    STA     I,,AUTO
         2 001777   200010 551140                    STBA    I,'40'O,AUTO
         2 002000   002002 606400 2                  TTN     s:3416

      477     3413    4           WHENRETURN DO;

      478     3414    4              GOTO DATERR;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:82   
   3414  2 002001   002017 710000 2                  TRA     DATERR

      479     3415    4              END;
      480     3416    3           CALL CHARBIN(B.HH,SUBSTR(TMP,0,2));

   3416  2 002002   000100 305500                    DTB
         2 002003   200056 030002                    NDSC9   TMP,,AUTO                cn=0,s=nosgn,sf=0,n=2
         2 002004   200044 000004                    NDSC9   B+3,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      481     3417    3           CALL CHARBIN(B.MI,SUBSTR(TMP,2,2));

   3417  2 002005   000100 305500                    DTB
         2 002006   200056 430002                    NDSC9   TMP,,AUTO                cn=2,s=nosgn,sf=0,n=2
         2 002007   200045 000004                    NDSC9   B+4,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      482     3418    3           CALL CHARBIN(B.SS,SUBSTR(TMP,4,2));

   3418  2 002010   000100 305500                    DTB
         2 002011   200057 030002                    NDSC9   TMP+1,,AUTO              cn=0,s=nosgn,sf=0,n=2
         2 002012   200046 000004                    NDSC9   B+5,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      483     3419    3           CALL CHARBIN(B.SS00,SUBSTR(TMP,6,2));

   3419  2 002013   000100 305500                    DTB
         2 002014   200057 430002                    NDSC9   TMP+1,,AUTO              cn=2,s=nosgn,sf=0,n=2
         2 002015   200047 000004                    NDSC9   B+6,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      484     3420    3           END;

      485     3421    2        GOTO LCL4;

   3421  2 002016   001703 710000 2                  TRA     LCL4

      486     3422    2   DATERR: ALTRETURN;

   3422  2 002017   200054 221300       DATERR       LDX1  ! DQH$+2,,AUTO
         2 002020   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:83   

      487     3423    2   END LOCALDATE;
      488     3424        %EJECT;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:84   
      489     3425        /*         CONVERT UTS TO DATE AND TIME                               */
      490     3426        /*                                                                    */
      491     3427    1   UTSDATE: PROC;

   3427  2 002021   200054 741300       UTSDATE      STX1  ! DQH$+2,,AUTO

      492     3428    3        if UTIME > %UTS_CUSP# then do;

   3428  2 002022   000120 236000 1                  LDQ     MONS+58
         2 002023   200006 116100                    CMPQ    UTIME,,AUTO
         2 002024   002040 603000 2                  TRC     s:3435

      493     3429    3           I = UTIME - %UTS_CUSP#;         /* time since cusp in 1/25th sec tics */

   3429  2 002025   200006 236100                    LDQ     UTIME,,AUTO
         2 002026   000120 136000 1                  SBLQ    MONS+58
         2 002027   200010 756100                    STQ     I,,AUTO

      494     3430    3           B.SS00 = MOD (I, %UTS_25TH_SEC#) * 4; /* fractional seconds to CSECs */

   3430  2 002030   000031 506007                    DIV     25,DL
         2 002031   000002 735000                    ALS     2
         2 002032   200047 755100                    STA     B+6,,AUTO

      495     3431    3           B.SS = I / %UTS_25TH_SEC# +     /* seconds since cusp */

   3431  2 002033   200010 236100                    LDQ     I,,AUTO
         2 002034   000031 506007                    DIV     25,DL
         2 002035   000016 036000 3                  ADLQ    14
         2 002036   200046 756100                    STQ     B+5,,AUTO

      496     3432    3              %(B_CDAYS# * 86400);         /* plus secs since cusp */
      497     3433    3           end;

   3433  2 002037   002047 710000 2                  TRA     s:3438

      498     3434    3        else do;
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:85   

      499     3435    3           B.SS = UTIME / %UTS_CSEC_SEC#;

   3435  2 002040   200006 236100                    LDQ     UTIME,,AUTO
         2 002041   000001 772000                    QRL     1
         2 002042   000062 506007                    DIV     50,DL
         2 002043   200046 756100                    STQ     B+5,,AUTO

      500     3436    3           B.SS00 = UTIME - B.SS * %UTS_CSEC_SEC#;

   3436  2 002044   000017 402000 3                  MPY     15
         2 002045   200006 036100                    ADLQ    UTIME,,AUTO
         2 002046   200047 756100                    STQ     B+6,,AUTO

      501     3437    3           end;

      502     3438    2        B.MI=B.SS/60;

   3438  2 002047   200046 236100                    LDQ     B+5,,AUTO
         2 002050   000074 506007                    DIV     60,DL
         2 002051   200045 756100                    STQ     B+4,,AUTO

      503     3439    2        B.SS=MOD(B.SS,60);                 /* SECONDS                            */

   3439  2 002052   200046 236100                    LDQ     B+5,,AUTO
         2 002053   000074 506007                    DIV     60,DL
         2 002054   200046 755100                    STA     B+5,,AUTO

      504     3440    2        B.HH=B.MI/60;

   3440  2 002055   200045 236100                    LDQ     B+4,,AUTO
         2 002056   000074 506007                    DIV     60,DL
         2 002057   200044 756100                    STQ     B+3,,AUTO

      505     3441    2        B.MI=MOD(B.MI,60);                 /* MINUTES                            */

   3441  2 002060   200045 236100                    LDQ     B+4,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:86   
         2 002061   000074 506007                    DIV     60,DL
         2 002062   200045 755100                    STA     B+4,,AUTO

      506     3442    2        D1=B.HH/24 + 1;

   3442  2 002063   200044 236100                    LDQ     B+3,,AUTO
         2 002064   000030 506007                    DIV     24,DL
         2 002065   000001 036007                    ADLQ    1,DL
         2 002066   200033 756100                    STQ     D1,,AUTO

      507     3443    2        B.HH=MOD(B.HH,24);                 /* HOURS                              */

   3443  2 002067   200044 236100                    LDQ     B+3,,AUTO
         2 002070   000030 506007                    DIV     24,DL
         2 002071   200044 755100                    STA     B+3,,AUTO

      508     3444    2        LD=((B_BYEAR-76)*365+D1-59)/1461;  /* # LEAP DAYS                        */

   3444  2 002072   000000 236000 1                  LDQ     B_BYEAR
         2 002073   000555 402007                    MPY     365,DL
         2 002074   200033 036100                    ADLQ    D1,,AUTO
         2 002075   066227 136007                    SBLQ    27799,DL
         2 002076   002665 506007                    DIV     1461,DL
         2 002077   200032 756100                    STQ     LD,,AUTO

      509     3445    2        Y1=(D1-1-LD)/365;                  /* #YEARS SINCE START                 */

   3445  2 002100   200033 236100                    LDQ     D1,,AUTO
         2 002101   200032 136100                    SBLQ    LD,,AUTO
         2 002102   000001 136007                    SBLQ    1,DL
         2 002103   000555 506007                    DIV     365,DL
         2 002104   200034 756100                    STQ     Y1,,AUTO

      510     3446    2        B.YY=B_BYEAR+Y1;

   3446  2 002105   000000 036000 1                  ADLQ    B_BYEAR
         2 002106   200043 756100                    STQ     B+2,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:87   

      511     3447    2        YY_MOD4 = MOD (B.YY,4);

   3447  2 002107   000004 506007                    DIV     4,DL
         2 002110   200040 755100                    STA     YY_MOD4,,AUTO

      512     3448    2        JD=D1-LD-(Y1*365);                 /* JULIEN DAY                         */

   3448  2 002111   200033 236100                    LDQ     D1,,AUTO
         2 002112   200032 136100                    SBLQ    LD,,AUTO
         2 002113   200062 756100                    STQ     X+1,,AUTO
         2 002114   000000 236003                    LDQ     0,DU
         2 002115   200034 136100                    SBLQ    Y1,,AUTO
         2 002116   000555 402007                    MPY     365,DL
         2 002117   200062 036100                    ADLQ    X+1,,AUTO
         2 002120   200037 756100                    STQ     JD,,AUTO

      513     3449    2        B.MM=JD/32 + 1;

   3449  2 002121   000040 506007                    DIV     32,DL
         2 002122   000001 036007                    ADLQ    1,DL
         2 002123   200041 756100                    STQ     B,,AUTO

      514     3450    2        IF (JD > MONS(B.MM*4+1)) THEN

   3450  2 002124   200041 235100                    LDA     B,,AUTO
         2 002125   000002 735000                    ALS     2
         2 002126   000027 236005 1                  LDQ     MONS+1,AL
         2 002127   002133 604000 2                  TMI     s:3452
         2 002130   200037 116100                    CMPQ    JD,,AUTO
         2 002131   002133 605000 2                  TPL     s:3452

      515     3451    2           B.MM=B.MM+1;

   3451  2 002132   200041 054100                    AOS     B,,AUTO

      516     3452    2        B.DD=JD-MONS((B.MM-1)*4+1);        /* DAY OF MONTH           */
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:88   

   3452  2 002133   200041 235100                    LDA     B,,AUTO
         2 002134   000002 735000                    ALS     2
         2 002135   200037 236100                    LDQ     JD,,AUTO
         2 002136   000023 136005 1                  SBLQ    MONTH+9,AL
         2 002137   200042 756100                    STQ     B+1,,AUTO

      517     3453    2        IF MOD(B.YY,4)=0 THEN

   3453  2 002140   200043 236100                    LDQ     B+2,,AUTO
         2 002141   000004 506007                    DIV     4,DL
         2 002142   000044 733000                    LRS     36
         2 002143   000000 116003                    CMPQ    0,DU
         2 002144   002165 601000 2                  TNZ     s:3466

      518     3454    3        DO;

      519     3455    3           IF MOD (D1-790, 1461) = 0 THEN  /* IS IT FEB 29? */

   3455  2 002145   200033 236100                    LDQ     D1,,AUTO
         2 002146   001426 136007                    SBLQ    790,DL
         2 002147   002665 506007                    DIV     1461,DL
         2 002150   000044 733000                    LRS     36
         2 002151   000000 116003                    CMPQ    0,DU
         2 002152   002161 601000 2                  TNZ     s:3461

      520     3456    4           DO;

      521     3457    4              B.MM=2;

   3457  2 002153   000002 235007                    LDA     2,DL
         2 002154   200041 755100                    STA     B,,AUTO

      522     3458    4              B.DD=29;

   3458  2 002155   000035 236007                    LDQ     29,DL
         2 002156   200042 756100                    STQ     B+1,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:89   

      523     3459    4              JD = JD + 1;                 /* allow for leap day */

   3459  2 002157   200037 054100                    AOS     JD,,AUTO

      524     3460    4              END;

   3460  2 002160   002165 710000 2                  TRA     s:3466

      525     3461    3           else if JD >= 60 then           /* is date after Feb 29? */

   3461  2 002161   200037 235100                    LDA     JD,,AUTO
         2 002162   000074 115007                    CMPA    60,DL
         2 002163   002165 604000 2                  TMI     s:3466

      526     3462    4              DO;

      527     3463    4   TM4:          JD = JD + 1;

   3463  2 002164   200037 054100       TM4          AOS     JD,,AUTO

      528     3464    4                 END;

      529     3465    3           END;

      530     3466    2        RETURN;

   3466  2 002165   000001 702211                    TSX2  ! 1,X1

      531     3467    2   END UTSDATE;
      532     3468        /*                                                                    */
      533     3469    1   DATEUTS: PROC ALTRET;

   3469  2 002166   200054 741300       DATEUTS      STX1  ! DQH$+2,,AUTO

      534     3470    2        LD=((B.YY-76)*12-3+B.MM)/48;       /* CONVERT DATE & TIME TO UTS         */

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:90   
   3470  2 002167   200043 236100                    LDQ     B+2,,AUTO
         2 002170   000014 402007                    MPY     12,DL
         2 002171   200041 036100                    ADLQ    B,,AUTO
         2 002172   001623 136007                    SBLQ    915,DL
         2 002173   000060 506007                    DIV     48,DL
         2 002174   200032 756100                    STQ     LD,,AUTO

      535     3471    2        D1=(B.YY-B_BYEAR)*365+MONS((B.MM-1)*4+1)+B.DD-1+LD; /* NUMBER DAYS       */

   3471  2 002175   200043 236100                    LDQ     B+2,,AUTO
         2 002176   000000 136000 1                  SBLQ    B_BYEAR
         2 002177   200041 235100                    LDA     B,,AUTO
         2 002200   000002 735000                    ALS     2
         2 002201   000000 620005                    EAX0    0,AL
         2 002202   000555 402007                    MPY     365,DL
         2 002203   000023 036010 1                  ADLQ    MONTH+9,X0
         2 002204   200042 036100                    ADLQ    B+1,,AUTO
         2 002205   200032 036100                    ADLQ    LD,,AUTO
         2 002206   000001 136007                    SBLQ    1,DL
         2 002207   200033 756100                    STQ     D1,,AUTO

      536     3472    2        IF D1 < 0 OR

   3472  2 002210   002213 604000 2                  TMI     s:3475
         2 002211   036021 116007                    CMPQ    15377,DL
         2 002212   002214 604000 2                  TMI     s:3476

      537     3473    2           D1 >= %(B_EDAYS# + B_CDAYS#)
      538     3474    2        THEN
      539     3475    2           ALTRETURN;

   3475  2 002213   000000 702211                    TSX2  ! 0,X1

      540     3476    2        TUNITS=(B.HH*60+B.MI)*6000+B.SS*100+B.SS00; /* TIME IN 1/100 SECS          */

   3476  2 002214   200044 236100                    LDQ     B+3,,AUTO
         2 002215   000074 402007                    MPY     60,DL
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:91   
         2 002216   200045 036100                    ADLQ    B+4,,AUTO
         2 002217   000074 402007                    MPY     60,DL
         2 002220   200046 036100                    ADLQ    B+5,,AUTO
         2 002221   000144 402007                    MPY     100,DL
         2 002222   200047 036100                    ADLQ    B+6,,AUTO
         2 002223   200015 756100                    STQ     TUNITS,,AUTO

      541     3477    2        if B.YY >= B_CYEAR then            /* date is in new UTS era (post cusp) */

   3477  2 002224   200043 236100                    LDQ     B+2,,AUTO
         2 002225   002242 604000 2                  TMI     s:3479
         2 002226   000003 116000 1                  CMPQ    B_CYEAR
         2 002227   002242 602000 2                  TNC     s:3479

      542     3478    2           UTIME = %UTS_CUSP# + (D1-%B_CDAYS#) * %UTS_25TH_DAY# + TUNITS/4;

   3478  2 002230   200033 236100                    LDQ     D1,,AUTO
         2 002231   000010 402000 3                  MPY     8
         2 002232   000120 036000 1                  ADLQ    MONS+58
         2 002233   200062 756100                    STQ     X+1,,AUTO
         2 002234   200015 236100                    LDQ     TUNITS,,AUTO
         2 002235   000002 772000                    QRL     2
         2 002236   200062 036100                    ADLQ    X+1,,AUTO
         2 002237   000020 136000 3                  SBLQ    16
         2 002240   200006 756100                    STQ     UTIME,,AUTO
         2 002241   002246 710000 2                  TRA     s:3480

      543     3479    2        else UTIME = D1 * %UTS_CSEC_DAY# + TUNITS; /* old UTS (pre cusp) */

   3479  2 002242   200033 236100                    LDQ     D1,,AUTO
         2 002243   000012 402000 3                  MPY     10
         2 002244   200015 036100                    ADLQ    TUNITS,,AUTO
         2 002245   200006 756100                    STQ     UTIME,,AUTO

      544     3480    2        TUNITS=TUNITS*10;                  /* TIME IN MSECS                      */

   3480  2 002246   200015 236100                    LDQ     TUNITS,,AUTO
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:92   
         2 002247   000012 402007                    MPY     10,DL
         2 002250   200015 756100                    STQ     TUNITS,,AUTO

      545     3481    2        RETURN;

   3481  2 002251   000001 702211                    TSX2  ! 1,X1

      546     3482    2   END DATEUTS;
      547     3483        /*                                                                    */
      548     3484    1   END UMT$LCLDATE;

   3484  2 002252   000000 702200 xent               TSX2  ! X66_ARET

B_BYEAR
 Sect OctLoc
   1     000   000000 000116                                                    ...N

(unnamed)
 Sect OctLoc
   1     001   000000 000001   000000 000001                                    ........

B_CYEAR
 Sect OctLoc
   1     003   000000 000135                                                    ...]

WKDAY
 Sect OctLoc
   1     004   123125 116115   117116 124125   105127 105104   124110 125106    SUNMONTUEWEDTHUF
   1     010   122111 123101   124*** ******                                    RISAT...

MONTH
 Sect OctLoc
   1     012   112101 116040   106105 102040   115101 122040   101120 122040    JAN FEB MAR APR
   1     016   115101 131040   112125 116040   112125 114040   101125 107040    MAY JUN JUL AUG
   1     022   123105 120040   117103 124040   116117 126040   104105 103040    SEP OCT NOV DEC

MONS
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:93   
 Sect OctLoc
   1     026   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     032   000000 000037   000000 000037   000000 000037   000000 000037    ................
   1     036   000000 000074   000000 000073   000000 000073   000000 000073    ...<...;...;...;
   1     042   000000 000133   000000 000132   000000 000132   000000 000132    ...[...Z...Z...Z
   1     046   000000 000171   000000 000170   000000 000170   000000 000170    ...y...x...x...x
   1     052   000000 000230   000000 000227   000000 000227   000000 000227    ................
   1     056   000000 000266   000000 000265   000000 000265   000000 000265    ................
   1     062   000000 000325   000000 000324   000000 000324   000000 000324    ................
   1     066   000000 000364   000000 000363   000000 000363   000000 000363    ................
   1     072   000000 000422   000000 000421   000000 000421   000000 000421    ................
   1     076   000000 000461   000000 000460   000000 000460   000000 000460    ................
   1     102   000000 000517   000000 000516   000000 000516   000000 000516    ................
   1     106   000000 000556   000000 000555   000000 000555   000000 000555    ................

(unnamed)
 Sect OctLoc
   1     112   000000 001426   000000 004313   000000 007200   000000 012065    ...............5
   1     116   000000 014752   777773 220400   540546 215000   040047 040040    ............ '
   1     122   251524 015266   251524 006506                                    ........

(unnamed)
 Sect OctLoc
   3     000   000040 040040   000005 006000   057040 040040   072040 040040    .   ..../   :
   3     004   000003 006000   000004 006000   000006 006000   000004 075300    ..............=.
   3     010   000010 172600   000020 365400   000040 753000   000000 000031    ..z...... ......
   3     014   000013 006000   056040 040040   003415 645200   777777 777634    .....   ........
   3     020   130131 443200                                                    XY..
      549     3485        %EOD;

PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:94   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_M.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$LCLDATE.
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:95   

 **** Variables and constants ****

  ****  Section 000  Data  UMT$LCLDATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 UMT_UNIQUE

  ****  Section 001 RoData UMT$LCLDATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 B_BYEAR                    3-0-0/w UBIN        r     1 B_CYEAR
    26-0-0/w UBIN        r     1 MONS(0:51)                12-0-0/c CHAR(4)     r     1 MONTH(0:11)
     4-0-0/c CHAR(3)     r     1 WKDAY(0:6)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DATE                     55-0-0/w PTR         r     1 @DATE
     5-0-0/w PTR         r     1 @TIME                      3-0-0/w PTR         r     1 @UTSTMP
    41-0-0/w STRC(252)   r     1 B                         50-0-0/w PTR         r     1 BUF$
    51-0-0/w SBIN        r     1 BUFX                      22-0-0/c CHAR(12)    r     1 CTEMP
    33-0-0/w SBIN        r     1 D1                        *0-0-0/c CHAR(8)     r     1 DATE
    *0-0-0/c CHAR(8)     r     1 DATE                      30-0-0/c CHAR(2)     r     1 DAY
    52-0-0/w PTR         r     1 DQH$                      41-0-0/w UBIN        r     1 DT(0:6)
    *0-0-0/c CHAR        r     1 DTCHR(0:7)                13-0-0/w UBIN        r     1 DTSZ
    26-0-0/c CHAR(2)     r     1 HRS                       20-0-0/c CHAR(2)     r     1 HSEC
    10-0-0/w SBIN        r     1 I                         11-0-0/w SBIN        r     1 J
    37-0-0/w SBIN        r     1 JD                        36-0-0/c CHAR(3)     r     1 JDAY
    12-0-0/w SBIN        r     1 K                         32-0-0/w SBIN        r     1 LD
    25-0-0/c CHAR(2)     r     1 MINS                      27-0-0/c CHAR(2)     r     1 MON
    21-0-0/c CHAR(2)     r     1 SEC                       16-0-0/w PTR         r     1 T$
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:96   
    17-0-0/w PTR         r     1 T1$                       *0-0-0/c CHAR(5)     r     1 TIME
    *0-0-0/c CHAR        r     1 TMCHR(0:4)                56-0-0/c CHAR(12)    r     1 TMP
    14-0-0/w UBIN        r     1 TMSZ                      15-0-0/w UBIN        r     1 TUNITS
     7-0-0/w CHAR(4)     r     1 UTC                        7-0-0/w UBIN        r     1 UTI
     6-0-0/w UBIN        r     1 UTIME                      6-0-0/w CHAR(4)     r     1 UTIMEC
    *0-0-0/w UBIN        r     1 UTSTMP                    35-0-0/w UBIN        r     1 WKD
    61-0-0/w SBIN        r     1 X                         34-0-0/w UBIN        r     1 Y1
    31-0-0/c CHAR(2)     r     1 YR                        40-0-0/w SBIN        r     1 YY_MOD4

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 B$PS4$
     0-0-0/w PTR         r     1 B$SR_NON_DEC$              0-0-0/d STRC(2232)  r     1 B_SITEINFO
     0-0-0/w BIT         r     1 HW_IMX                     0-0-0/w BIT         r     1 TM_MCA_DO_TIME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c UBIN        r     1 A                          0-0-0/c CHAR(4)     r     1 AC
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC        r     1 FPT$TIME_V
     0-0-0/w STRC(648)   r     1 NI$DQH                     0-0-0/d STRC(4608)  r     1 NON_DECIMAL
     0-0-0/c CHAR(10)    r     1 ST10                       0-0-0/c CHAR(3)     r     1 ST3
     0-0-0/c CHAR(5)     r     1 ST5                        0-0-0/c CHAR(6)     r     1 ST6
     0-0-0/c CHAR(8)     r     1 ST8                        0-0-0/c ACHR        r     1 STTMSZ
     0-0-0/w UBIN        r     1 UTS_B


   Procedure UMT$LCLDATE requires 1195 words for executable code.
   Procedure UMT$LCLDATE requires 54 words of local(AUTO) storage.
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:97   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:98   
          MINI XREF LISTING

A
        41**DCL        42--REDEF    3117>>ASSIGN   3185<>CALL     3188<>CALL     3191<>CALL     3194<>CALL
      3196<>CALL
AC
        42**DCL      3202>>ASSIGN   3208>>ASSIGN   3250<<ASSIGN   3258<<ASSIGN   3307<<ASSIGN
ANSDATE IN PROCEDURE LOCALDATE
      3393**ENTRY    3129--CALL     3185--CALL
ANSTIME IN PROCEDURE LOCALDATE
      3408**ENTRY    3191--CALL
B
        82**DCL        90--REDEF      91--REDEF    3327<<ASSIGN   3353<<ASSIGN   3395<<ASSIGN
B.DD
        84**DCL      3157>>CALLBLT  3266>>CALLBLT  3335<<CALLBLT  3342>>ASSIGN   3343>>IF       3343>>IF
      3366<<ASSIGN   3403<<CALLBLT  3452<<ASSIGN   3458<<ASSIGN   3471>>ASSIGN
B.HH
        86**DCL      3155>>CALLBLT  3264>>CALLBLT  3388>>IF       3416<<CALLBLT  3440<<ASSIGN   3442>>ASSIGN
      3443<<ASSIGN   3443>>ASSIGN   3476>>ASSIGN
B.MI
        87**DCL      3156>>CALLBLT  3265>>CALLBLT  3388>>IF       3417<<CALLBLT  3438<<ASSIGN   3440>>ASSIGN
      3441<<ASSIGN   3441>>ASSIGN   3476>>ASSIGN
B.MM
        83**DCL      3159>>CALLBLT  3267>>CALLBLT  3281>>CALLBLT  3331<<CALLBLT  3342>>ASSIGN   3343>>IF
      3343>>IF       3343>>IF       3343>>IF       3364<<ASSIGN   3365>>IF       3365<<ASSIGN   3365>>ASSIGN
      3366>>ASSIGN   3402<<CALLBLT  3449<<ASSIGN   3450>>IF       3451<<ASSIGN   3451>>ASSIGN   3452>>ASSIGN
      3457<<ASSIGN   3470>>ASSIGN   3471>>ASSIGN
B.SS
        88**DCL      3262>>CALLBLT  3388>>IF       3418<<CALLBLT  3431<<ASSIGN   3435<<ASSIGN   3436>>ASSIGN
      3438>>ASSIGN   3439<<ASSIGN   3439>>ASSIGN   3476>>ASSIGN
B.SS00
        89**DCL      3263>>CALLBLT  3388>>IF       3419<<CALLBLT  3430<<ASSIGN   3436<<ASSIGN   3476>>ASSIGN
B.YY
        85**DCL      3121>>CALLBLT  3158>>CALLBLT  3261>>ASSIGN   3261>>ASSIGN   3268>>CALLBLT  3338<<CALLBLT
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:99   
      3340>>IF       3340<<ASSIGN   3340>>ASSIGN   3341>>ASSIGN   3343>>IF       3359<<CALLBLT  3361>>IF
      3361<<ASSIGN   3361>>ASSIGN   3362>>ASSIGN   3401<<CALLBLT  3446<<ASSIGN   3447>>ASSIGN   3453>>IF
      3470>>ASSIGN   3471>>ASSIGN   3477>>IF
B$JIT.ERR
      2839**DCL      3310<<ASSIGN   3316<<ASSIGN
B$JIT.ERR.MID
      2840**DCL      2840--REDEF
B$JIT$
        36**DCL      2834--IMP-PTR  3310>>ASSIGN   3316>>ASSIGN
B$PS0$
        54**DCL      3180>>DOCASE   3203>>IF       3229>>IF       3232>>IF       3242>>DOCASE   3246>>IF
      3273>>DOCASE   3286>>DOCASE   3295>>DOCASE   3303>>IF       3303>>IF       3303>>IF
B$PS1$
        55**DCL      3185>>CALL     3194>>CALL     3276>>ASSIGN   3279>>ASSIGN   3282>>ASSIGN
B$PS2$
        56**DCL      3191>>CALL     3196>>CALL     3293>>ASSIGN
B$PS3$
        57**DCL      3188>>CALL     3297>>CALLBLT  3299>>ASSIGN
B$PS4$
        58**DCL      3202>>ASSIGN   3208>>ASSIGN   3250>>ASSIGN   3258>>ASSIGN   3307>>ASSIGN
B$SR_NON_DEC$
      1446**DCL      1447--IMP-PTR  3329>>CALLBLT  3332>>CALLBLT  3336>>CALLBLT  3355>>CALLBLT  3377>>CALLBLT
      3397>>CALLBLT  3412>>CALLBLT
BADDT
      3108**LABEL    3101--CALLALT  3102--CALLALT  3105--GOTO     3129--CALLALT  3130--CALLALT
BUF$
      1472**DCL      3142<>CALL     3144<>CALL     3147>>ASSIGN   3149<>CALL
BUFX
      1473**DCL      3142<>CALL     3143<>CALL     3144<>CALL     3149<>CALL
B_BYEAR
        37**DCL      3444>>ASSIGN   3446>>ASSIGN   3471>>ASSIGN
B_CYEAR
        40**DCL      3477>>IF
B_SITEINFO.UTC_OFFSET#
      3086**DCL      3231>>ASSIGN   3234>>ASSIGN
COMMON_IDT
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:100  
      3154**LABEL    3170--GOTO
CTEMP
        69**DCL      3275<<CALLBLT  3276>>ASSIGN   3278<<CALLBLT  3279>>ASSIGN   3281<<CALLBLT  3282>>ASSIGN
      3288<<CALLBLT  3290<<CALLBLT  3291<<ASSIGN   3293>>ASSIGN
D1
        76**DCL      3442<<ASSIGN   3444>>ASSIGN   3445>>ASSIGN   3448>>ASSIGN   3455>>IF       3471<<ASSIGN
      3472>>IF       3472>>IF       3478>>ASSIGN   3479>>ASSIGN
DATE
        14**DCL        11--PROC       15--REDEF      16--REDEF    3101<>CALL     3112--ENTRY    3114--IF
      3116--ASSIGN   3127--ENTRY    3129<>CALL     3136--ENTRY    3139--ASSIGN   3166--ENTRY    3168--ASSIGN
DATE IN PROCEDURE LOCALDATE
      3323**DCL      3321--PROC     3328>>ASSIGN   3351--ENTRY    3354>>ASSIGN   3371--ENTRY    3375>>ASSIGN
      3393--ENTRY    3396>>ASSIGN   3401>>CALLBLT  3402>>CALLBLT  3403>>CALLBLT  3408--ENTRY    3411>>ASSIGN
DATERR IN PROCEDURE LOCALDATE
      3422**LABEL    3330--GOTO     3333--GOTO     3346--GOTO     3357--GOTO     3363--GOTO     3381--GOTO
      3383--GOTO     3384--GOTO     3385--GOTO     3388--GOTO     3399--GOTO     3414--GOTO
DATEUTS
      3469**PROC     3103--CALL     3130--CALL     3237--CALL     3245--CALL     3256--CALL     3306--CALL
DAY
        73**DCL      3157<<CALLBLT  3160>>CALLBLT  3266<<CALLBLT  3275>>CALLBLT  3278>>CALLBLT  3281>>CALLBLT
DQH$
      1474**DCL      3142<>CALL     3143>>CALL
DT
        90**DCL      3379<<CALLBLT  3387<<ASSIGN   3387>>ASSIGN
DTCHR
        15**DCL      3090>>IF       3090>>IF
DTERR
      3310**LABEL    3142--CALLALT  3145--GOTO     3185--CALLALT  3188--CALLALT  3191--CALLALT  3194--CALLALT
      3196--CALLALT  3204--CALLALT  3237--CALLALT  3238--CALLALT  3245--CALLALT  3248--CALLALT  3256--CALLALT
      3306--CALLALT
DTSZ
        50**DCL      3089<<DOINDEX  3090>>IF       3090>>IF       3093<<ASSIGN   3184<>CALL     3193<>CALL
      3328>>ASSIGN
FPT$TIME_V.DEST
      2281**DCL      3242>>DOCASE   3246>>IF       3273>>DOCASE   3286>>DOCASE   3295>>DOCASE
FPT$TIME_V.DEST_BASIS
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:101  
      2281**DCL      3232>>IF
FPT$TIME_V.SOURCE
      2281**DCL      3180>>DOCASE   3203>>IF       3303>>IF       3303>>IF       3303>>IF
FPT$TIME_V.SOURCE_BASIS
      2281**DCL      3229>>IF
HFF$DSIZ
        25**DCL-ENT  3184--CALL     3190--CALL     3193--CALL     3195--CALL     3285--CALL
HFF$NILERASE
        26**DCL-ENT  3182--CALL     3201--CALL     3207--CALL     3244--CALL     3255--CALL     3272--CALL
      3284--CALL     3294--CALL     3302--CALL
HRS
        71**DCL      3155<<CALLBLT  3161>>CALLBLT  3264<<CALLBLT  3288>>CALLBLT  3290>>CALLBLT
HSEC
        67**DCL      3263<<CALLBLT  3288>>CALLBLT  3291>>ASSIGN
HW_IMX
       268**DCL      3140>>IF
I
        47**DCL      3228<<ASSIGN   3231<<ASSIGN   3231>>ASSIGN   3234<<ASSIGN   3234>>ASSIGN   3235>>IF
      3238<>CALL     3329<<CALLBLT  3330>>IF       3331>>IF       3331>>CALLBLT  3332>>CALLBLT  3334>>ASSIGN
      3335>>CALLBLT  3336<<CALLBLT  3337>>ASSIGN   3355<<CALLBLT  3376<<DOINDEX  3379>>CALLBLT  3381>>IF
      3383>>IF       3384>>IF       3387>>IF       3397<<CALLBLT  3397<<CALLBLT  3412<<CALLBLT  3412<<CALLBLT
      3429<<ASSIGN   3430>>ASSIGN   3431>>ASSIGN
J
        48**DCL      3332<<CALLBLT  3333>>IF       3334>>ASSIGN   3336>>CALLBLT  3337>>ASSIGN   3338>>CALLBLT
      3377<<CALLBLT  3378>>IF       3379>>CALLBLT  3380>>ASSIGN   3382>>IF       3383>>IF       3384>>IF
      3387>>IF
JD
        80**DCL      3122>>CALLBLT  3261>>ASSIGN   3269>>CALLBLT  3342<<ASSIGN   3360<<CALLBLT  3363>>IF
      3364>>ASSIGN   3365>>IF       3366>>ASSIGN   3448<<ASSIGN   3449>>ASSIGN   3450>>IF       3452>>ASSIGN
      3459<<ASSIGN   3459>>ASSIGN   3461>>IF       3463<<ASSIGN   3463>>ASSIGN
JDAY
        79**DCL      3122<<CALLBLT  3123>>CALLBLT  3269<<CALLBLT  3297>>CALLBLT
JULDATE IN PROCEDURE LOCALDATE
      3351**ENTRY    3188--CALL
K
        49**DCL      3334<<ASSIGN   3335>>IF       3335>>CALLBLT  3337<<ASSIGN   3338>>IF       3338>>CALLBLT
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:102  
      3374<<ASSIGN   3377>>CALLBLT  3378>>IF       3379>>CALLBLT  3379>>CALLBLT  3380<<ASSIGN   3381>>IF
      3387>>IF
LCL1 IN PROCEDURE LOCALDATE
      3340**LABEL    3404--GOTO
LCL4 IN PROCEDURE LOCALDATE
      3388**LABEL    3382--GOTO     3421--GOTO
LCLDT1
      3095**LABEL    3091--GOTO
LCLDT2
      3101**LABEL    3097--GOTO
LD
        75**DCL      3444<<ASSIGN   3445>>ASSIGN   3448>>ASSIGN   3470<<ASSIGN   3471>>ASSIGN
LOCALDATE
      3321**PROC     3101--CALL     3194--CALL
LOCALTIME IN PROCEDURE LOCALDATE
      3371**ENTRY    3102--CALL     3196--CALL
MINS
        70**DCL      3156<<CALLBLT  3161>>CALLBLT  3265<<CALLBLT  3288>>CALLBLT  3290>>CALLBLT
MON
        72**DCL      3159<<CALLBLT  3160>>CALLBLT  3267<<CALLBLT  3275>>CALLBLT  3278>>CALLBLT
MONS
        98**DCL      3342>>ASSIGN   3343>>IF       3343>>IF       3363>>IF       3365>>IF       3366>>ASSIGN
      3450>>IF       3452>>ASSIGN   3471>>ASSIGN
MONTH
        95**DCL      3281>>CALLBLT
NI$DQH
      1458**DCL      3143<>CALL
NI$DQH.IOCHANX
      1460**DCL      1461--REDEF
NI$DQH.MBX$
      1469**DCL      1470--REDEF
NON_DECIMAL
      1447**DCL      3329>>CALLBLT  3332>>CALLBLT  3336>>CALLBLT  3355>>CALLBLT  3377>>CALLBLT  3397>>CALLBLT
      3412>>CALLBLT
NOPS4
      3316**LABEL    3201--CALLALT  3207--CALLALT  3244--CALLALT  3255--CALLALT
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:103  
SEC
        68**DCL      3262<<CALLBLT  3288>>CALLBLT  3290>>CALLBLT
SSR$REG
      2517**DCL-ENT  3221--CALL
SSS$BLOCK
      2518**DCL-ENT  3218--CALL
SSS$L6_UTS
        24**DCL-ENT  3204--CALL
SSS$SETBTIME
        22**DCL-ENT  3148--CALL
SSS$SYSTIME
        21**DCL-ENT  3114--CALL     3151--CALL     3198--CALL     3209--CALL     3219--CALL     3222--CALL
SSS$UTS_L6
        23**DCL-ENT  3248--CALL
ST10
        65**DCL      3282<<ASSIGN
ST3
        60**DCL      3299<<ASSIGN
ST5
        62**DCL      3123<<CALLBLT  3161<<CALLBLT  3297<<CALLBLT
ST6
        63**DCL      3276<<ASSIGN
ST8
        64**DCL      3160<<CALLBLT  3279<<ASSIGN
STTMSZ
        66**DCL      3293<<ASSIGN
T$
        53**DCL      3116<<ASSIGN   3117>>ASSIGN   3119<<ASSIGN   3123>>CALLBLT  3138<<ASSIGN   3160>>CALLBLT
      3168<<ASSIGN
T1$
        59**DCL      3139<<ASSIGN   3161>>CALLBLT  3169<<ASSIGN
TIME
        17**DCL        11--PROC       18--REDEF      19--REDEF    3102<>CALL     3166--ENTRY    3169--ASSIGN
TM2
      3284**LABEL    3272--CALLALT
TM3
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:104  
      3294**LABEL    3284--CALLALT
TMB$BUF_ALLOC
        28**DCL-ENT  3142--CALL
TMB$BUF_DEALLOC
        29**DCL-ENT  3144--CALL     3149--CALL
TMB$MCA
        27**DCL-ENT  3143--CALL
TMCHR
        19**DCL      3096>>IF       3096>>IF
TMP IN PROCEDURE LOCALDATE
      3324**DCL      3328<<ASSIGN   3329>>CALLBLT  3330>>IF       3331>>CALLBLT  3332>>CALLBLT  3333>>IF
      3335>>CALLBLT  3336>>CALLBLT  3338>>CALLBLT  3354<<ASSIGN   3355>>CALLBLT  3359>>CALLBLT  3360>>CALLBLT
      3375<<ASSIGN   3377>>CALLBLT  3379>>CALLBLT  3383>>IF       3384>>IF       3396<<ASSIGN   3397>>CALLBLT
      3411<<ASSIGN   3412>>CALLBLT  3416>>CALLBLT  3417>>CALLBLT  3418>>CALLBLT  3419>>CALLBLT
TMSZ
        51**DCL        66--IMP-SIZ  3095<<DOINDEX  3096>>IF       3096>>IF       3099<<ASSIGN   3190<>CALL
      3195<>CALL     3285<>CALL     3293>>ASSIGN   3373>>IF       3375>>ASSIGN   3381>>IF       3382>>IF
      3410>>IF
TM_MCA_DO_TIME
       225**DCL      3140>>IF
TUNITS
        52**DCL      3257>>ASSIGN   3476<<ASSIGN   3478>>ASSIGN   3479>>ASSIGN   3480<<ASSIGN   3480>>ASSIGN
UMT_UNIQUE
        32**DCL      3220>>DOWHILE  3224<<ASSIGN
UT
      3302**LABEL    3294--CALLALT
UTC
        46**DCL      3208<<ASSIGN
UTI
        45**DCL        46--REDEF    3211>>ASSIGN   3213>>ASSIGN
UTIME
        43**DCL        44--REDEF    3104>>IF       3106>>ASSIGN   3114<>CALL     3117<<ASSIGN   3131>>ASSIGN
      3147<<ASSIGN   3148<>CALL     3151<>CALL     3167<<ASSIGN   3198<>CALL     3209<>CALL     3210>>IF
      3211<<ASSIGN   3211>>ASSIGN   3213<<ASSIGN   3213>>ASSIGN   3219<>CALL     3220>>DOWHILE  3222<>CALL
      3224>>ASSIGN   3238<>CALL     3238<>CALL     3257<<ASSIGN   3428>>IF       3429>>ASSIGN   3435>>ASSIGN
      3436>>ASSIGN   3478<<ASSIGN   3479<<ASSIGN
PL6.E3A0      #001=UMT$LCLDATE File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:105  
UTIMEC
        44**DCL      3202<<ASSIGN   3204<>CALL     3204<>CALL     3248<>CALL     3248<>CALL     3250>>ASSIGN
      3258>>ASSIGN   3307>>ASSIGN
UTSDATE
      3427**PROC     3120--CALL     3154--CALL     3199--CALL     3205--CALL     3214--CALL     3225--CALL
      3239--CALL
UTSTMP
        13**DCL        11--PROC     3106<<ASSIGN   3112--ENTRY    3119--ASSIGN   3127--ENTRY    3131<<ASSIGN
      3136--ENTRY    3138--ASSIGN   3166--ENTRY    3167>>ASSIGN
UTS_B
      1475**DCL      3147>>ASSIGN
WKD
        78**DCL      3261<<ASSIGN   3299>>ASSIGN
WKDAY
        93**DCL      3299>>ASSIGN
X IN PROCEDURE LOCALDATE
      3325**DCL      3329<<CALLBLT  3332<<CALLBLT  3336<<CALLBLT  3355<<CALLBLT  3377<<CALLBLT
XTIME
      3309**LABEL    3302--CALLALT
XUD$UTS_ADJUST
      3056**DCL-ENT  3238--CALL
Y1
        77**DCL      3445<<ASSIGN   3446>>ASSIGN   3448>>ASSIGN
YR
        74**DCL      3121<<CALLBLT  3123>>CALLBLT  3158<<CALLBLT  3160>>CALLBLT  3268<<CALLBLT  3275>>CALLBLT
      3278>>CALLBLT  3281>>CALLBLT  3297>>CALLBLT
YY_MOD4
        81**DCL      3341<<ASSIGN   3342>>ASSIGN   3343>>IF       3343>>IF       3362<<ASSIGN   3363>>IF
      3365>>IF       3366>>ASSIGN   3447<<ASSIGN

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:106  
      550        1        /*M*  UMT$SYSLOAD:   RETURN SYSTEM LOAD PARAMETERS                    */
      551        2        /*T***********************************************************/
      552        3        /*T*                                                         */
      553        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      554        5        /*T*                                                         */
      555        6        /*T***********************************************************/
      556        7        /*                                                                    */
      557        8        UMT$SYSLOAD: PROC;
      558        9        /*                                                                    */
      559       10        /*                                                                    */
      560       11    1   DCL   SSC$SASYNC ENTRY;
      561       12    1   DCL   SSC$SERV ENTRY;
      562       13    1   DCL   HFF$DSIZ ENTRY(2);
      563       14    1   DCL   SSR$REG ENTRY(3) ALTRET;
      564       15    1   DCL   SSS$CURTIME ENTRY(1);
      565       16    1   DCL   SSS$XEQTIME ENTRY(3);
      566       17    1   DCL   ELA$SYSLOG ENTRY(6) ALTRET;
      567       18    1   DCL   MMC$MAPXLAT ENTRY(1);
      568       19    1   DCL   MMC$MAPXLATALT ENTRY(1);
      569       20    1   DCL   B$JIT$ PTR SYMREF;
      570       21    1   DCL   HFF$NILERASE ENTRY(1) ALTRET;
      571       22    1   DCL   LOAD(0:2) UBIN(36) BASED;
      572       23    1   DCL   PERF(0:11) BASED SBIN;
      573       24    1   DCL   T UBIN;
      574       25    1   DCL   D$ PTR;
      575       26        %INCLUDE SS_SCHED_C;
      576      259        %INCLUDE SS_SCHED_R;
      577      302        %INCLUDE P_PMDAT_R;
      578      610        %INCLUDE CP_6_SUBS;
      579     1150        %INCLUDE UE$CP6V_C;
      580     1234        %INCLUDE UM$CP6V_C;
      581     1421        %INCLUDE B$USER;
      582     1637        %B$USERREFS;
      583     1641        %INCLUDE EL_SUBS_C;
      584     1725        %INCLUDE ES_SUBS_E;
      585     1751        %INCLUDE ES_TABLES_M;
      586     2145        %ES$PRIV_CHANGE(STCLASS=AUTO);
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:107  
      587     2159        %INCLUDE PC_SUBS_C;                /* EQU's for ES_LOGPRIVCHNG (security log) */
      588     2491        %INCLUDE HF_LOCK_C;
      589     2505        %INCLUDE B$JIT_C;
      590     2819        %INCLUDE XUD_UTS_M;
      591     2901        %B$JIT0;
      592     2990        %U$JIT1;
      593     3064        %M$JIT2X;
      594     3067        %F$JIT3X;
      595     3070        %S$JIT4;
      596     3076        %J$JIT5;
      597     3164        %A$JIT6X;
      598     3167        %FPT$WAIT_V;
      599     3170        %VLR$DISPLAY_V;
      600     3174        %XUD$UTS_ENTRIES;
      601     3206        %XUD_UTS_EQU;
      602     3217    1   DCL B$PS0$ PTR SYMREF;
      603     3218    1   DCL B$PS1$ PTR SYMREF;
      604     3219    1   DCL B$UPT$ PTR SYMREF;
      605     3220    1   DCL ES_PRIVMASK     BIT(36) SYMREF;     /* From ES_CNTRL_D */
      606     3221    1   DCL ES_LOGPRIVCHNG  UBIN WORD SYMREF;   /* From ES_CNTRL_D */
      607     3222    1   DCL ES_PRIVCHNGMASK BIT(36) SYMREF;     /* From ES_CNTRL_D */
      608     3223    1   DCL P$ PTR;
      609     3224    1   DCL BTEMP BIT(36);
      610     3225    1   DCL HTEMP UBIN HALF;
      611     3226    1   DCL UTEMP UBIN;
      612     3227    1   DCL BBASED BIT(36) BASED(B$PS0$) ALIGNED;
      613     3228    1   DCL 1 VALFPT BASED(B$PS0$) ALIGNED,
      614     3229    1          2 FLAG BIT(1),
      615     3230    1          2 FLAG1 BIT(1),
      616     3231    1          2 FLAG2 BIT(1),
      617     3232    1          2 * BIT(33),
      618     3233    1          2 UARR(0:3) UBIN HALF UNAL;
      619     3234    1   DCL 1 VAL BASED(P$) ALIGNED,
      620     3235    1          2 UARR(0:3) UBIN HALF UNAL;
      621     3236        %MACRO ERRCODE(NAME=ERRWD,SEV#=0,COD#=0);
      622     3237        DCL 1 NAME CONSTANT,
      623     3238               2 * BIT(12) INIT('2515'O),
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:108  
      624     3239               2 * BIT(6) INIT('24'O),
      625     3240               2 C UBIN(15) UNAL INIT(COD#),
      626     3241               2 S UBIN(3) UNAL INIT(SEV#);
      627     3242        %MEND;
      628     3243        %ERRCODE (NAME=ENOPRIV,COD#=409);
      629     3250        %ERRCODE (NAME=EMAXCHG,COD#=410);
      630     3257        %ERRCODE (NAME=EPRIV,COD#=612,SEV#=2);
      631     3264        /* Mask which has '1's for pprivs not to grant with just prc privs */
      632     3265    1   DCL PPR_MASK BIT(36) ALIGNED CONSTANT INIT(
      633     3266    1   %(%PPR_CNTRLC#|%PPR_SUPER#|%PPR_NETCON#|%PPR_SUPERAUTH#|%PPR_SUPERWSN#|%
              3266            PPR_SUPERFORM#|%PPR_PADMIN#|%PPR_SUPERD#|%PPR_REPLAY#));
      634     3267        /*                                                                    */
      635     3268    1        B$PS0$->VLR$DISPLAY_V.USERS=S_CTUIS;
      636     3269    1        B$PS0$->VLR$DISPLAY_V.ETMF=P_ETMF;
      637     3270    1        B$PS0$->VLR$DISPLAY_V.RESP=P_RT90;
      638     3271    1        CALL HFF$DSIZ (0,T);
      639     3272    1        IF T < SIZEC (VLR$DISPLAY_V) THEN
      640     3273    1           RETURN;
      641     3274    1        B$PS0$->VLR$DISPLAY_V.OUSERS=S_CUIS(%M_INT#);
      642     3275    1        B$PS0$->VLR$DISPLAY_V.BUSERS=S_CUIS(%M_BATCH#);
      643     3276    1        B$PS0$->VLR$DISPLAY_V.GUSERS=S_CUIS(%M_GHOST#);
      644     3277    1        B$PS0$->VLR$DISPLAY_V.TPUSERS=S_CUIS(%M_TP#);
      645     3278    1        RETURN;
      646     3279        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:109  
      647     3280        /*    UMT$WAIT:   PUT USER TO SLEEP                                   */
      648     3281        /*                                                                    */
      649     3282    1   UMT$WAIT: ENTRY;
      650     3283        /*                                                                    */
      651     3284    1        CALL HFF$NILERASE(0) ALTRET(WT1);
      652     3285    1        CALL SSC$SASYNC;
      653     3286        /* ACCESS VECTOR 0 BEFORE LOCKING GATE. #42362.                 */
      654     3287    1        HTEMP = VALFPT.UARR(1);
      655     3288             %LOCK (G#=S_UDLGATE);
      656     3291    1        D$=S$CU$->B$U.DL$;                 /* IF EVENT WAITING, DON'T SLEEP      */
      657     3292    2        DO WHILE (D$ ~= ADDR(NIL));
      658     3293    2           IF D$->B$DO.BUSY THEN
      659     3294    2              D$=D$->B$DO.LNK$;
      660     3295    2           ELSE
      661     3296    3           DO;
      662     3297    3              CALL HFF$NILERASE(1) ALTRET(WT0);
      663     3298                          /* move specified time into
      664     3299                                              UETIME and return to user */
      665     3300    3              B$PS1$->LOAD(0)=B$PS0$->FPT$WAIT_V.UNITS;
      666     3301    3   WT0:       ;
      667     3302                   %UNLOCK (G#=S_UDLGATE);
      668     3305    3              CALL SSC$SERV;
      669     3306    3              RETURN;
      670     3307    3              END;
      671     3308    2           END;
      672     3309                 /* fix per 32651; allow M$WAIT in smaller
      673     3310                                      intervals */
      674     3311    2        DO CASE (B$PS0$->FPT$WAIT_V.UTYPE);
      675     3312
      676     3313    2        CASE (%MIN#);                      /* 60 sec/min * 100 tun/sec */
      677     3314    2           T=B$PS0$->FPT$WAIT_V.UNITS*(60*100);
      678     3315
      679     3316    2        CASE (%TUN#);
      680     3317    2           T=B$PS0$->FPT$WAIT_V.UNITS;
      681     3318
      682     3319    2        CASE (ELSE);                       /* assume seconds */
      683     3320    2           T=B$PS0$->FPT$WAIT_V.UNITS*100;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:110  
      684     3321
      685     3322    2        END;                               /* do case parameter type */
      686     3323
      687     3324                                                /* centiseconds in 24 hours */
      688     3325    1        T=MOD(T,8640000);
      689     3326    1        CALL SSR$REG(%SS_SLPMME,ADDR(NIL),T);
      690     3327    1        CALL HFF$NILERASE(1) ALTRET(WT1);
      691     3328    1        CALL SSS$CURTIME(T);               /* GET TIME                           */
      692     3329    1        IF S$CU$->B$U.MISC <= T THEN
      693     3330    1           B$PS1$->LOAD(0)=0;
      694     3331    1        ELSE
      695     3332    2        DO;
      696     3333    2           CALL XUD$UTS_DIFF (T, S$CU$->B$U.MISC, (T));
      697     3334    3           DO CASE (B$PS0$->FPT$WAIT_V.UTYPE);
      698     3335
      699     3336    3           CASE (%MIN#);                   /* 60 sec/min * 100 tun/sec */
      700     3337    3              T=T/(100*60);
      701     3338
      702     3339    3           CASE (%TUN#);
      703     3340    3              ;                            /* T is already in CSECs */
      704     3341
      705     3342    3           CASE (ELSE);                    /* assume seconds */
      706     3343    3              T=T/100;
      707     3344
      708     3345    3           END;                            /* do case parameter type */
      709     3346
      710     3347    2           IF T=0 THEN T=1;                /* guarantee "flag" for unexpired */
      711     3348
      712     3349    2           B$PS1$->LOAD(0)=T;
      713     3350
      714     3351    2           END;                            /* DO CASE UNEXPIRED CLOCK */
      715     3352    1   WT1: RETURN;
      716     3353        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:111  
      717     3354        /*    UMT$XEQTIME:  RETURN EXECUTION AND SERVICE TIME SERVICE         */
      718     3355        /*                                                                    */
      719     3356    1   UMT$XEQTIME: ENTRY;
      720     3357        /*                                                                    */
      721     3358    1        CALL HFF$NILERASE(0) ALTRET(WT1);
      722     3359    1        IF B$JIT.RUNFLAGS & %RUN_PROC# THEN
      723     3360    1           CALL SSS$XEQTIME(B$JIT.TPEXT,B$JIT.EXTUS,B$JIT.XTIME);
      724     3361    1        ELSE
      725     3362    1           CALL SSS$XEQTIME(B$JIT.TUEXT,B$JIT.EXTUS,B$JIT.XTIME);
      726     3363    1        CALL HFF$DSIZ(0,T);
      727     3364    1        IF T < 48 THEN RETURN;             /* STANDARD FPT                       */
      728     3365    1        B$PS0$->PERF(4)=S_MXEQTIME(0);
      729     3366    1        B$PS0$->PERF(5)=S_MXUSEC(0);
      730     3367    1        B$PS0$->PERF(6)=S_MIDLTIME(0);
      731     3368    1        B$PS0$->PERF(7)=S_MIDUSEC(0);
      732     3369    1        B$PS0$->PERF(8)=S_MIDLWIO(0);
      733     3370    1        B$PS0$->PERF(9)=S_MIIUSEC(0);
      734     3371    1        B$PS0$->PERF(10)=P_RUE#(0);
      735     3372    1        B$PS0$->PERF(11)=P_SCHD#(0);
      736     3373    1        RETURN;
      737     3374        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:112  
      738     3375        /* SET/RESET PRIVILEGES */
      739     3376    1   UMT$SPRIV: ENTRY;
      740     3377    1        IF PINCRW(B$PS0$,1)->VALFPT.FLAG1
      741     3378    2        THEN DO;
      742     3379    2           IF (B$JIT.PPRIV&BBASED)=BBASED
      743     3380    2              OR (((B$JIT.PRIV.JOB&B$JIT.PRIV.PRC)=B$JIT.PRIV.PRC AND B$JIT.PRIV.PRC)
              3380                       AND (NOT BBASED&PPR_MASK))
      744     3381    2           THEN RETURN;
      745     3382    2           ELSE GOTO SETNPRIV;
      746     3383    2           END;
      747     3384    1        IF PINCRW(B$PS0$,1)->VALFPT.FLAG
      748     3385    1        THEN
      749     3386    1           BTEMP=B$JIT.PRIV.AUTH & ES_PRIVMASK;
      750     3387    1        ELSE
      751     3388    1           BTEMP=(B$JIT.PRIV.JOB&ES_PRIVMASK)|B$JIT.PRIV.PRC;
      752     3389    1        B$JIT.PRIV.ACTIVE=B$JIT.PRIV.ACTIVE|
      753     3390    1           (BBASED&BTEMP);
      754     3391    1        CALL JIT;                          /* Update %JITSID descriptor flags */
      755     3392    2        IF (BBASED&BTEMP)=BBASED THEN DO;  /* Granted the request */
      756     3393              /* Do we consider logging? */
      757     3394    3           IF ES_LOGPRIVCHNG=%PC_ES_GRANTED# OR ES_LOGPRIVCHNG=%PC_ES_ALL# THEN DO;
      758     3395                 /* Did he ask for a priv we care about? */
      759     3396    3              ES$PRIV_CHANGE.PRIV#=BBASED & ES_PRIVCHNGMASK;
      760     3397                 /* Log granted privs only if they're not in PRC. */
      761     3398    3              IF NOT PINCRW(B$PS0$,1)->VALFPT.FLAG THEN
      762     3399    3                 ES$PRIV_CHANGE.PRIV#=ES$PRIV_CHANGE.PRIV# & (~B$JIT.PRIV.PRC);
      763     3400    4              IF ES$PRIV_CHANGE.PRIV# THEN DO;
      764     3401    4                 ES$PRIV_CHANGE.REASON#=%ES_PRIV_CHNG_GRANTED#;
      765     3402    4                 ES$PRIV_CHANGE.GRANTED#='1'B;
      766     3403    4                 CALL ELA$SYSLOG(EL_PRIV_CHANGE,ES$PRIV_CHANGE,
      767     3404    4                    SIZEW(ES$PRIV_CHANGE),'0'B,EL_SEC,UTEMP);
      768     3405    4                 END;
      769     3406    3              END;
      770     3407    2           END;
      771     3408    2        ELSE DO;                      /* Denied at least part of this request */
      772     3409              /* Do we consider logging? */
      773     3410    3           IF ES_LOGPRIVCHNG=%PC_ES_DENIED# OR ES_LOGPRIVCHNG=%PC_ES_ALL# THEN DO;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:113  
      774     3411                 /* Did he ask for a priv we care about? */
      775     3412    3              ES$PRIV_CHANGE.PRIV#=BBASED&(~BTEMP)&ES_PRIVCHNGMASK;
      776     3413    4              IF ES$PRIV_CHANGE.PRIV# THEN DO;
      777     3414    4                 ES$PRIV_CHANGE.REASON#=%ES_PRIV_CHNG_DENIED#;
      778     3415    4                 ES$PRIV_CHANGE.GRANTED#='0'B;
      779     3416    4                 B$JIT.ERR=ENOPRIV;
      780     3417    4                 CALL ELA$SYSLOG(EL_PRIV_CHANGE,ES$PRIV_CHANGE,
      781     3418    4                    SIZEW(ES$PRIV_CHANGE),'0'B,EL_SEC,UTEMP);
      782     3419    4                 END;
      783     3420    3              END;
      784     3421    2   SETNPRIV:;
      785     3422    2           B$JIT.ERR=ENOPRIV;
      786     3423    2           END;
      787     3424        /*E* ERROR: UMT-E$NOPRIV-C
      788     3425             MESSAGE: Cannot effect entire privilege change requested.
      789     3426        */
      790     3427    1        RETURN;
      791     3428        /*
      792     3429        */
      793     3430    1   UMT$RPRIV: ENTRY;
      794     3431    1        BTEMP=B$JIT.PRIV.ACTIVE&BBASED;
      795     3432    1        B$JIT.PRIV.ACTIVE=B$JIT.PRIV.ACTIVE&~BBASED;
      796     3433    1        CALL JIT;                          /* Update %JITSID descriptor flags */
      797     3434    1        IF BTEMP~=BBASED
      798     3435    1        THEN GOTO SETNPRIV;
      799     3436    1        RETURN;
      800     3437
      801     3438    1   JIT: PROC;                              /* Update %JITSID descriptor flags */
      802     3439
      803     3440        %INCLUDE MM_DATA_R;
      804     3960        %INCLUDE B_SEGIDS_C;
      805     4499
      806     4500    2   DCL B$USERLS$ PTR SYMREF READONLY;
      807     4501    2   DCL B$DBLS$ PTR SYMREF READONLY;
      808     4502
      809     4503    2        IF B$JIT.PRIV.ACTIVE & %PR_JIT#
      810     4504    3        THEN DO;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:114  
      811     4505                %SETFLG(LS$=B$USERLS$,SEGID=%JITSID,FLG="%DSWRITE");
      812     4508    3           IF (S$CU$->B$U.FLG & %U_DIC)
      813     4509    4           THEN DO;
      814     4510                   %SETFLG(LS$=B$DBLS$,SEGID=%JITSID,FLG="%DSWRITE");
      815     4513    4              END;
      816     4514    3           END;
      817     4515    3        ELSE DO;
      818     4516                %SETFLG(LS$=B$USERLS$,SEGID=%JITSID,FLG="%DSREAD");
      819     4519    3           IF (S$CU$->B$U.FLG & %U_DIC)
      820     4520    4           THEN DO;
      821     4521                   %SETFLG(LS$=B$DBLS$,SEGID=%JITSID,FLG="%DSREAD");
      822     4524    4              END;
      823     4525    3           END;
      824     4526
      825     4527    2   END JIT;
      826     4528
      827     4529        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:115  
      828     4530        /* SET/RESET PSEUDO SWITCHES */
      829     4531    1   UMT$SSWITCH: ENTRY;
      830     4532    1        BTEMP=B$JIT.SWITCH;
      831     4533    1           B$JIT.SWITCH=BTEMP|BBASED;
      832     4534    1           RETURN;
      833     4535    1           UMT$RSWITCH: ENTRY;
      834     4536    1           BTEMP=B$JIT.SWITCH;
      835     4537    1           B$JIT.SWITCH=BTEMP&~BBASED;
      836     4538    1           RETURN;
      837     4539                %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:116  
      838     4540        /* INCREMENT TRANSACTION COUNTERS */
      839     4541    1           UMT$CHGUNIT: ENTRY;
      840     4542    1           IF VALFPT.FLAG
      841     4543    1           THEN P$=ADDR(B$JIT.STEPUNIT);
      842     4544    1        ELSE P$=ADDR(B$JIT.JOBUNIT);
      843     4545    1        T=0;
      844     4546    2        DO WHILE (T<4);
      845     4547    2           UTEMP=VAL.UARR(T)+VALFPT.UARR(T);
      846     4548    2           IF UTEMP>262143
      847     4549    3           THEN DO;
      848     4550    3              UTEMP=262143;
      849     4551    3              B$JIT.ERR=EMAXCHG;
      850     4552        /*E* ERROR: UMT-E$MAXCHG-C
      851     4553             MESSAGE: Charges have exceeded field size.
      852     4554        */
      853     4555    3              END;
      854     4556    2           VAL.UARR(T)=UTEMP;
      855     4557    2           T=T+1;
      856     4558    2           END;
      857     4559    1        RETURN;
      858     4560        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:117  
      859     4561        /* SET USER/INST WORDS */
      860     4562    1   UMT$MISC: ENTRY;
      861     4563    1        IF VALFPT.FLAG
      862     4564    1        THEN P$=ADDR(B$JIT.USERWORD);
      863     4565    2        ELSE DO;
      864     4566    2           IF B$JIT.PRIV.ACTIVE & %PR_EXMM#
      865     4567    2           THEN P$=ADDR(B$JIT.INSTWORD);
      866     4568    3           ELSE DO;
      867     4569    3              B$JIT.ERR = EPRIV;
      868     4570    3              RETURN;
      869     4571    3              END;
      870     4572    2           END;
      871     4573    1        T=0;
      872     4574    2        DO WHILE (T<4);
      873     4575    2           UTEMP=VALFPT.UARR(T);
      874     4576    2           IF UTEMP~=262143 THEN
      875     4577    2              VAL.UARR(T)=UTEMP;
      876     4578    2           T=T+1;
      877     4579    2           END;
      878     4580    1        IF VALFPT.FLAG2
      879     4581    1        THEN
      880     4582    1           CALL MMC$MAPXLATALT (B$UPT$);
      881     4583    1        IF VALFPT.FLAG1
      882     4584    1        THEN
      883     4585    1           CALL MMC$MAPXLAT (B$UPT$);
      884     4586    1        RETURN;
      885     4587    1   END UMT$SYSLOAD;
      886     4588        %EOD;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:118  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   UE$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$SYSLOAD.

   Procedure UMT$SYSLOAD requires 549 words for executable code.
   Procedure UMT$SYSLOAD requires 20 words of local(AUTO) storage.

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:119  

 Object Unit name= UMT$SYSLOAD                                File name= UMT$TIME.:E05TOU
 UTS= JUL 30 '97 07:01:47.36 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      6      6  UMT$SYSLOAD
    1   Proc  even  none   549   1045  UMT$SYSLOAD
    2  RoData even  none    13     15  UMT$SYSLOAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  UMT$SYSLOAD
     1     40                  yes      Std        0  UMT$WAIT
     1    251                  yes      Std        0  UMT$XEQTIME
     1    356                  yes      Std        0  UMT$SPRIV
     1    541                  yes      Std        0  UMT$RPRIV
     1    647                  yes      Std        0  UMT$SSWITCH
     1    660                  yes      Std        0  UMT$RSWITCH
     1    673                  yes      Std        0  UMT$CHGUNIT
     1    752                  yes      Std        0  UMT$MISC
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:120  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
         yes           Std       0 SSC$SERV
         yes           Std       0 SSC$SASYNC
         yes           Std       1 HFC$LOCK
 yes     yes           Std       6 ELA$SYSLOG
         yes           Std       1 MMC$MAPXLAT
         yes           Std       1 MMC$MAPXLATALT
         yes           Std       1 SSS$CURTIME
         yes           Std       3 SSS$XEQTIME
 yes     yes           Std       3 XUD$UTS_DIFF
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                S_CUIS                                S_CTUIS
     S_MXUSEC                              S_MIDUSEC                             S_MIIUSEC
     S_MXEQTIME                            S_MIDLTIME                            S_MIDLWIO
     S_UDLGATE                             P_RESOURCE$                           P_RUE#
     P_SCHD#                               P_ETMF                                P_RT90
     P_UPTIME                              P_NSCPU                               S$CU$
     B$PS0$                                B$PS1$                                B$UPT$
     ES_PRIVMASK                           ES_LOGPRIVCHNG                        ES_PRIVCHNGMASK
r    MM_BYP$                          r    B$USERLS$                        r    B$DBLS$
     B_VECTNIL
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:121  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:122  


      550        1        /*M*  UMT$SYSLOAD:   RETURN SYSTEM LOAD PARAMETERS                    */
      551        2        /*T***********************************************************/
      552        3        /*T*                                                         */
      553        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      554        5        /*T*                                                         */
      555        6        /*T***********************************************************/
      556        7        /*                                                                    */
      557        8        UMT$SYSLOAD: PROC;

      8  1 000000   000000 700200 xent  UMT$SYSLOAD  TSX0  ! X66_AUTO_0
         1 000001   000024 000000                    ZERO    20,0

      558        9        /*                                                                    */
      559       10        /*                                                                    */
      560       11    1   DCL   SSC$SASYNC ENTRY;
      561       12    1   DCL   SSC$SERV ENTRY;
      562       13    1   DCL   HFF$DSIZ ENTRY(2);
      563       14    1   DCL   SSR$REG ENTRY(3) ALTRET;
      564       15    1   DCL   SSS$CURTIME ENTRY(1);
      565       16    1   DCL   SSS$XEQTIME ENTRY(3);
      566       17    1   DCL   ELA$SYSLOG ENTRY(6) ALTRET;
      567       18    1   DCL   MMC$MAPXLAT ENTRY(1);
      568       19    1   DCL   MMC$MAPXLATALT ENTRY(1);
      569       20    1   DCL   B$JIT$ PTR SYMREF;
      570       21    1   DCL   HFF$NILERASE ENTRY(1) ALTRET;
      571       22    1   DCL   LOAD(0:2) UBIN(36) BASED;
      572       23    1   DCL   PERF(0:11) BASED SBIN;
      573       24    1   DCL   T UBIN;
      574       25    1   DCL   D$ PTR;
      575       26        %INCLUDE SS_SCHED_C;
      576      259        %INCLUDE SS_SCHED_R;
      577      302        %INCLUDE P_PMDAT_R;
      578      610        %INCLUDE CP_6_SUBS;
      579     1150        %INCLUDE UE$CP6V_C;
      580     1234        %INCLUDE UM$CP6V_C;
      581     1421        %INCLUDE B$USER;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:123  
      582     1637        %B$USERREFS;
      583     1641        %INCLUDE EL_SUBS_C;
      584     1725        %INCLUDE ES_SUBS_E;
      585     1751        %INCLUDE ES_TABLES_M;
      586     2145        %ES$PRIV_CHANGE(STCLASS=AUTO);
      587     2159        %INCLUDE PC_SUBS_C;                /* EQU's for ES_LOGPRIVCHNG (security log) */
      588     2491        %INCLUDE HF_LOCK_C;
      589     2505        %INCLUDE B$JIT_C;
      590     2819        %INCLUDE XUD_UTS_M;
      591     2901        %B$JIT0;
      592     2990        %U$JIT1;
      593     3064        %M$JIT2X;
      594     3067        %F$JIT3X;
      595     3070        %S$JIT4;
      596     3076        %J$JIT5;
      597     3164        %A$JIT6X;
      598     3167        %FPT$WAIT_V;
      599     3170        %VLR$DISPLAY_V;
      600     3174        %XUD$UTS_ENTRIES;
      601     3206        %XUD_UTS_EQU;
      602     3217    1   DCL B$PS0$ PTR SYMREF;
      603     3218    1   DCL B$PS1$ PTR SYMREF;
      604     3219    1   DCL B$UPT$ PTR SYMREF;
      605     3220    1   DCL ES_PRIVMASK     BIT(36) SYMREF;     /* From ES_CNTRL_D */
      606     3221    1   DCL ES_LOGPRIVCHNG  UBIN WORD SYMREF;   /* From ES_CNTRL_D */
      607     3222    1   DCL ES_PRIVCHNGMASK BIT(36) SYMREF;     /* From ES_CNTRL_D */
      608     3223    1   DCL P$ PTR;
      609     3224    1   DCL BTEMP BIT(36);
      610     3225    1   DCL HTEMP UBIN HALF;
      611     3226    1   DCL UTEMP UBIN;
      612     3227    1   DCL BBASED BIT(36) BASED(B$PS0$) ALIGNED;
      613     3228    1   DCL 1 VALFPT BASED(B$PS0$) ALIGNED,
      614     3229    1          2 FLAG BIT(1),
      615     3230    1          2 FLAG1 BIT(1),
      616     3231    1          2 FLAG2 BIT(1),
      617     3232    1          2 * BIT(33),
      618     3233    1          2 UARR(0:3) UBIN HALF UNAL;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:124  
      619     3234    1   DCL 1 VAL BASED(P$) ALIGNED,
      620     3235    1          2 UARR(0:3) UBIN HALF UNAL;
      621     3236        %MACRO ERRCODE(NAME=ERRWD,SEV#=0,COD#=0);
      622     3237        DCL 1 NAME CONSTANT,
      623     3238               2 * BIT(12) INIT('2515'O),
      624     3239               2 * BIT(6) INIT('24'O),
      625     3240               2 C UBIN(15) UNAL INIT(COD#),
      626     3241               2 S UBIN(3) UNAL INIT(SEV#);
      627     3242        %MEND;
      628     3243        %ERRCODE (NAME=ENOPRIV,COD#=409);
      629     3250        %ERRCODE (NAME=EMAXCHG,COD#=410);
      630     3257        %ERRCODE (NAME=EPRIV,COD#=612,SEV#=2);
      631     3264        /* Mask which has '1's for pprivs not to grant with just prc privs */
      632     3265    1   DCL PPR_MASK BIT(36) ALIGNED CONSTANT INIT(
      633     3266    1   %(%PPR_CNTRLC#|%PPR_SUPER#|%PPR_NETCON#|%PPR_SUPERAUTH#|%PPR_SUPERWSN#|%
              3266            PPR_SUPERFORM#|%PPR_PADMIN#|%PPR_SUPERD#|%PPR_REPLAY#));
      634     3267        /*                                                                    */
      635     3268    1        B$PS0$->VLR$DISPLAY_V.USERS=S_CTUIS;

   3268  1 000002   000000 235000 xsym               LDA     S_CTUIS
         1 000003   000000 470400 xsym               LDP0    B$PS0$
         1 000004   000000 755100                    STA     0,,PR0

      636     3269    1        B$PS0$->VLR$DISPLAY_V.ETMF=P_ETMF;

   3269  1 000005   000000 235000 xsym               LDA     P_ETMF
         1 000006   000000 470400 xsym               LDP0    B$PS0$
         1 000007   000001 755100                    STA     1,,PR0

      637     3270    1        B$PS0$->VLR$DISPLAY_V.RESP=P_RT90;

   3270  1 000010   000000 236000 xsym               LDQ     P_RT90
         1 000011   000002 756100                    STQ     2,,PR0

      638     3271    1        CALL HFF$DSIZ (0,T);

   3271  1 000012   200003 631500                    EPPR1   T,,AUTO
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:125  
         1 000013   200017 451500                    STP1    UTEMP+5,,AUTO
         1 000014   000000 236000 2                  LDQ     0
         1 000015   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000016   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000020   000000 701000 xent               TSX1    HFF$DSIZ
         1 000021   000000 011000                    NOP     0

      639     3272    1        IF T < SIZEC (VLR$DISPLAY_V) THEN

   3272  1 000022   200003 235100                    LDA     T,,AUTO
         1 000023   000040 115007                    CMPA    32,DL
         1 000024   000026 603000 1                  TRC     s:3274

      640     3273    1           RETURN;

   3273  1 000025   000000 702200 xent               TSX2  ! X66_ARET

      641     3274    1        B$PS0$->VLR$DISPLAY_V.OUSERS=S_CUIS(%M_INT#);

   3274  1 000026   000003 236000 xsym               LDQ     S_CUIS+3
         1 000027   000000 470400 xsym               LDP0    B$PS0$
         1 000030   000005 756100                    STQ     5,,PR0

      642     3275    1        B$PS0$->VLR$DISPLAY_V.BUSERS=S_CUIS(%M_BATCH#);

   3275  1 000031   000001 235000 xsym               LDA     S_CUIS+1
         1 000032   000003 755100                    STA     3,,PR0

      643     3276    1        B$PS0$->VLR$DISPLAY_V.GUSERS=S_CUIS(%M_GHOST#);

   3276  1 000033   000002 235000 xsym               LDA     S_CUIS+2
         1 000034   000004 755100                    STA     4,,PR0

      644     3277    1        B$PS0$->VLR$DISPLAY_V.TPUSERS=S_CUIS(%M_TP#);

   3277  1 000035   000004 235000 xsym               LDA     S_CUIS+4
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:126  
         1 000036   000006 755100                    STA     6,,PR0

      645     3278    1        RETURN;

   3278  1 000037   000000 702200 xent               TSX2  ! X66_ARET

      646     3279        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:127  
      647     3280        /*    UMT$WAIT:   PUT USER TO SLEEP                                   */
      648     3281        /*                                                                    */
      649     3282    1   UMT$WAIT: ENTRY;

   3282  1 000040   000000 700200 xent  UMT$WAIT     TSX0  ! X66_AUTO_0
         1 000041   000024 000000                    ZERO    20,0

      650     3283        /*                                                                    */
      651     3284    1        CALL HFF$NILERASE(0) ALTRET(WT1);

   3284  1 000042   000000 630400 2                  EPPR0   0
         1 000043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000044   000000 701000 xent               TSX1    HFF$NILERASE
         1 000045   000250 702000 1                  TSX2    WT1

      652     3285    1        CALL SSC$SASYNC;

   3285  1 000046   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000047   000000 701000 xent               TSX1    SSC$SASYNC
         1 000050   000000 011000                    NOP     0

      653     3286        /* ACCESS VECTOR 0 BEFORE LOCKING GATE. #42362.                 */
      654     3287    1        HTEMP = VALFPT.UARR(1);

   3287  1 000051   000000 470400 xsym               LDP0    B$PS0$
         1 000052   000001 720100                    LXL0    1,,PR0
         1 000053   200011 740100                    STX0    HTEMP,,AUTO

      655     3288             %LOCK (G#=S_UDLGATE);

   3289  1 000054   000001 630400 2                  EPPR0   1
         1 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000056   000000 701000 xent               TSX1    HFC$LOCK
         1 000057   000000 011000                    NOP     0

      656     3291    1        D$=S$CU$->B$U.DL$;                 /* IF EVENT WAITING, DON'T SLEEP      */

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:128  
   3291  1 000060   000000 470400 xsym               LDP0    S$CU$
         1 000061   000015 236100                    LDQ     13,,PR0
         1 000062   200004 756100                    STQ     D$,,AUTO

      657     3292    2        DO WHILE (D$ ~= ADDR(NIL));

   3292  1 000063   000112 710000 1                  TRA     s:3308

      658     3293    2           IF D$->B$DO.BUSY THEN

   3293  1 000064   200004 470500                    LDP0    D$,,AUTO
         1 000065   000002 234100                    SZN     2,,PR0
         1 000066   000072 605000 1                  TPL     s:3297

      659     3294    2              D$=D$->B$DO.LNK$;

   3294  1 000067   000000 236100                    LDQ     0,,PR0
         1 000070   200004 756100                    STQ     D$,,AUTO
         1 000071   000112 710000 1                  TRA     s:3308

      660     3295    2           ELSE
      661     3296    3           DO;

      662     3297    3              CALL HFF$NILERASE(1) ALTRET(WT0);

   3297  1 000072   000002 630400 2                  EPPR0   2
         1 000073   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000074   000000 701000 xent               TSX1    HFF$NILERASE
         1 000075   000102 702000 1                  TSX2    WT0

      663     3298                          /* move specified time into
      664     3299                                              UETIME and return to user */
      665     3300    3              B$PS1$->LOAD(0)=B$PS0$->FPT$WAIT_V.UNITS;

   3300  1 000076   000000 470400 xsym               LDP0    B$PS0$
         1 000077   000000 471400 xsym               LDP1    B$PS1$
         1 000100   000000 235100                    LDA     0,,PR0
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:129  
         1 000101   100000 755100                    STA     0,,PR1

   3300  1 000102                       WT0          null
      666     3301    3   WT0:       ;
      667     3302                   %UNLOCK (G#=S_UDLGATE);

   3303  1 000102   000001 630400 2                  EPPR0   1
         1 000103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000104   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000105   000000 011000                    NOP     0

      668     3305    3              CALL SSC$SERV;

   3305  1 000106   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000107   000000 701000 xent               TSX1    SSC$SERV
         1 000110   000000 011000                    NOP     0

      669     3306    3              RETURN;

   3306  1 000111   000000 702200 xent               TSX2  ! X66_ARET

      670     3307    3              END;
      671     3308    2           END;

   3308  1 000112   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000113   000064 601000 1                  TNZ     s:3293

      672     3309                 /* fix per 32651; allow M$WAIT in smaller
      673     3310                                      intervals */
      674     3311    2        DO CASE (B$PS0$->FPT$WAIT_V.UTYPE);

   3311  1 000114   000000 470400 xsym               LDP0    B$PS0$
         1 000115   000001 235100                    LDA     1,,PR0
         1 000116   000006 115007                    CMPA    6,DL
         1 000117   000121 602005 1                  TNC     s:3311+5,AL
         1 000120   000136 710000 1                  TRA     s:3320
         1 000121   000136 710000 1                  TRA     s:3320
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:130  
         1 000122   000136 710000 1                  TRA     s:3320
         1 000123   000127 710000 1                  TRA     s:3314
         1 000124   000136 710000 1                  TRA     s:3320
         1 000125   000136 710000 1                  TRA     s:3320
         1 000126   000133 710000 1                  TRA     s:3317

      675     3312
      676     3313    2        CASE (%MIN#);                      /* 60 sec/min * 100 tun/sec */

      677     3314    2           T=B$PS0$->FPT$WAIT_V.UNITS*(60*100);

   3314  1 000127   000000 236100                    LDQ     0,,PR0
         1 000130   013560 402007                    MPY     6000,DL
         1 000131   200003 756100                    STQ     T,,AUTO
         1 000132   000141 710000 1                  TRA     s:3325

      678     3315
      679     3316    2        CASE (%TUN#);

      680     3317    2           T=B$PS0$->FPT$WAIT_V.UNITS;

   3317  1 000133   000000 235100                    LDA     0,,PR0
         1 000134   200003 755100                    STA     T,,AUTO
         1 000135   000141 710000 1                  TRA     s:3325

      681     3318
      682     3319    2        CASE (ELSE);                       /* assume seconds */

      683     3320    2           T=B$PS0$->FPT$WAIT_V.UNITS*100;

   3320  1 000136   000000 236100                    LDQ     0,,PR0
         1 000137   000144 402007                    MPY     100,DL
         1 000140   200003 756100                    STQ     T,,AUTO

      684     3321
      685     3322    2        END;                               /* do case parameter type */

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:131  
      686     3323
      687     3324                                                /* centiseconds in 24 hours */
      688     3325    1        T=MOD(T,8640000);

   3325  1 000141   200003 235100                    LDA     T,,AUTO
         1 000142   000043 773000                    LRL     35
         1 000143   000003 507000 2                  DVF     3
         1 000144   200003 756100                    STQ     T,,AUTO

      689     3326    1        CALL SSR$REG(%SS_SLPMME,ADDR(NIL),T);

   3326  1 000145   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000146   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000147   200003 631500                    EPPR1   T,,AUTO
         1 000150   200021 451500                    STP1    UTEMP+7,,AUTO
         1 000151   200016 633500                    EPPR3   UTEMP+4,,AUTO
         1 000152   200020 453500                    STP3    UTEMP+6,,AUTO
         1 000153   000005 236000 2                  LDQ     5
         1 000154   200017 756100                    STQ     UTEMP+5,,AUTO
         1 000155   200017 630500                    EPPR0   UTEMP+5,,AUTO
         1 000156   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000157   000000 701000 xent               TSX1    SSR$REG
         1 000160   000000 011000                    NOP     0

      690     3327    1        CALL HFF$NILERASE(1) ALTRET(WT1);

   3327  1 000161   000002 630400 2                  EPPR0   2
         1 000162   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000163   000000 701000 xent               TSX1    HFF$NILERASE
         1 000164   000250 702000 1                  TSX2    WT1

      691     3328    1        CALL SSS$CURTIME(T);               /* GET TIME                           */

   3328  1 000165   200003 630500                    EPPR0   T,,AUTO
         1 000166   200016 450500                    STP0    UTEMP+4,,AUTO
         1 000167   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000170   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:132  
         1 000171   000000 701000 xent               TSX1    SSS$CURTIME
         1 000172   000000 011000                    NOP     0

      692     3329    1        IF S$CU$->B$U.MISC <= T THEN

   3329  1 000173   000000 470400 xsym               LDP0    S$CU$
         1 000174   200003 236100                    LDQ     T,,AUTO
         1 000175   000017 116100                    CMPQ    15,,PR0
         1 000176   000202 602000 1                  TNC     s:3333

      693     3330    1           B$PS1$->LOAD(0)=0;

   3330  1 000177   000000 471400 xsym               LDP1    B$PS1$
         1 000200   100000 450100                    STZ     0,,PR1
         1 000201   000250 710000 1                  TRA     WT1

      694     3331    1        ELSE
      695     3332    2        DO;

      696     3333    2           CALL XUD$UTS_DIFF (T, S$CU$->B$U.MISC, (T));

   3333  1 000202   200003 631500                    EPPR1   T,,AUTO
         1 000203   200020 451500                    STP1    UTEMP+6,,AUTO
         1 000204   000000 236000 xsym               LDQ     S$CU$
         1 000205   000017 036003                    ADLQ    15,DU
         1 000206   200017 756100                    STQ     UTEMP+5,,AUTO
         1 000207   200003 633500                    EPPR3   T,,AUTO
         1 000210   200016 453500                    STP3    UTEMP+4,,AUTO
         1 000211   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000212   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000213   000000 701000 xent               TSX1    XUD$UTS_DIFF
         1 000214   000000 011000                    NOP     0

      697     3334    3           DO CASE (B$PS0$->FPT$WAIT_V.UTYPE);

   3334  1 000215   000000 470400 xsym               LDP0    B$PS0$
         1 000216   000001 235100                    LDA     1,,PR0
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:133  
         1 000217   000006 115007                    CMPA    6,DL
         1 000220   000222 602005 1                  TNC     s:3334+5,AL
         1 000221   000235 710000 1                  TRA     s:3343
         1 000222   000235 710000 1                  TRA     s:3343
         1 000223   000235 710000 1                  TRA     s:3343
         1 000224   000230 710000 1                  TRA     s:3337
         1 000225   000235 710000 1                  TRA     s:3343
         1 000226   000235 710000 1                  TRA     s:3343
         1 000227   000241 710000 1                  TRA     s:3347

      698     3335
      699     3336    3           CASE (%MIN#);                   /* 60 sec/min * 100 tun/sec */

      700     3337    3              T=T/(100*60);

   3337  1 000230   200003 236100                    LDQ     T,,AUTO
         1 000231   000001 772000                    QRL     1
         1 000232   005670 506007                    DIV     3000,DL
         1 000233   200003 756100                    STQ     T,,AUTO
         1 000234   000241 710000 1                  TRA     s:3347

      701     3338
      702     3339    3           CASE (%TUN#);

      703     3340    3              ;                            /* T is already in CSECs */
      704     3341
      705     3342    3           CASE (ELSE);                    /* assume seconds */

      706     3343    3              T=T/100;

   3343  1 000235   200003 236100                    LDQ     T,,AUTO
         1 000236   000001 772000                    QRL     1
         1 000237   000062 506007                    DIV     50,DL
         1 000240   200003 756100                    STQ     T,,AUTO

      707     3344
      708     3345    3           END;                            /* do case parameter type */
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:134  

      709     3346
      710     3347    2           IF T=0 THEN T=1;                /* guarantee "flag" for unexpired */

   3347  1 000241   200003 235100                    LDA     T,,AUTO
         1 000242   000245 601000 1                  TNZ     s:3349

   3347  1 000243   000001 236007                    LDQ     1,DL
         1 000244   200003 756100                    STQ     T,,AUTO

      711     3348
      712     3349    2           B$PS1$->LOAD(0)=T;

   3349  1 000245   000000 471400 xsym               LDP1    B$PS1$
         1 000246   200003 235100                    LDA     T,,AUTO
         1 000247   100000 755100                    STA     0,,PR1

      713     3350
      714     3351    2           END;                            /* DO CASE UNEXPIRED CLOCK */

      715     3352    1   WT1: RETURN;

   3352  1 000250   000000 702200 xent  WT1          TSX2  ! X66_ARET

      716     3353        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:135  
      717     3354        /*    UMT$XEQTIME:  RETURN EXECUTION AND SERVICE TIME SERVICE         */
      718     3355        /*                                                                    */
      719     3356    1   UMT$XEQTIME: ENTRY;

   3356  1 000251   000000 700200 xent  UMT$XEQTIME  TSX0  ! X66_AUTO_0
         1 000252   000024 000000                    ZERO    20,0

      720     3357        /*                                                                    */
      721     3358    1        CALL HFF$NILERASE(0) ALTRET(WT1);

   3358  1 000253   000000 630400 2                  EPPR0   0
         1 000254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000255   000000 701000 xent               TSX1    HFF$NILERASE
         1 000256   000250 702000 1                  TSX2    WT1

      722     3359    1        IF B$JIT.RUNFLAGS & %RUN_PROC# THEN

   3359  1 000257   000000 470400 xsym               LDP0    B$JIT$
         1 000260   000314 236100                    LDQ     204,,PR0
         1 000261   000022 736000                    QLS     18
         1 000262   777000 376003                    ANQ     -512,DU
         1 000263   002000 376003                    ANQ     1024,DU
         1 000264   000303 600000 1                  TZE     s:3362

      723     3360    1           CALL SSS$XEQTIME(B$JIT.TPEXT,B$JIT.EXTUS,B$JIT.XTIME);

   3360  1 000265   000000 236000 xsym               LDQ     B$JIT$
         1 000266   000262 036003                    ADLQ    178,DU
         1 000267   200020 756100                    STQ     UTEMP+6,,AUTO
         1 000270   000000 236000 xsym               LDQ     B$JIT$
         1 000271   000303 036003                    ADLQ    195,DU
         1 000272   200017 756100                    STQ     UTEMP+5,,AUTO
         1 000273   000000 236000 xsym               LDQ     B$JIT$
         1 000274   000270 036003                    ADLQ    184,DU
         1 000275   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000276   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000277   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:136  
         1 000300   000000 701000 xent               TSX1    SSS$XEQTIME
         1 000301   000000 011000                    NOP     0
         1 000302   000320 710000 1                  TRA     s:3363

      724     3361    1        ELSE
      725     3362    1           CALL SSS$XEQTIME(B$JIT.TUEXT,B$JIT.EXTUS,B$JIT.XTIME);

   3362  1 000303   000000 236000 xsym               LDQ     B$JIT$
         1 000304   000262 036003                    ADLQ    178,DU
         1 000305   200020 756100                    STQ     UTEMP+6,,AUTO
         1 000306   000000 236000 xsym               LDQ     B$JIT$
         1 000307   000303 036003                    ADLQ    195,DU
         1 000310   200017 756100                    STQ     UTEMP+5,,AUTO
         1 000311   000000 236000 xsym               LDQ     B$JIT$
         1 000312   000273 036003                    ADLQ    187,DU
         1 000313   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000314   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000315   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000316   000000 701000 xent               TSX1    SSS$XEQTIME
         1 000317   000000 011000                    NOP     0

      726     3363    1        CALL HFF$DSIZ(0,T);

   3363  1 000320   200003 630500                    EPPR0   T,,AUTO
         1 000321   200017 450500                    STP0    UTEMP+5,,AUTO
         1 000322   000000 236000 2                  LDQ     0
         1 000323   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000324   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000325   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000326   000000 701000 xent               TSX1    HFF$DSIZ
         1 000327   000000 011000                    NOP     0

      727     3364    1        IF T < 48 THEN RETURN;             /* STANDARD FPT                       */

   3364  1 000330   200003 235100                    LDA     T,,AUTO
         1 000331   000060 115007                    CMPA    48,DL
         1 000332   000334 603000 1                  TRC     s:3365
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:137  

   3364  1 000333   000000 702200 xent               TSX2  ! X66_ARET

      728     3365    1        B$PS0$->PERF(4)=S_MXEQTIME(0);

   3365  1 000334   000000 470400 xsym               LDP0    B$PS0$
         1 000335   000000 236000 xsym               LDQ     S_MXEQTIME
         1 000336   000004 756100                    STQ     4,,PR0

      729     3366    1        B$PS0$->PERF(5)=S_MXUSEC(0);

   3366  1 000337   000000 235000 xsym               LDA     S_MXUSEC
         1 000340   000005 755100                    STA     5,,PR0

      730     3367    1        B$PS0$->PERF(6)=S_MIDLTIME(0);

   3367  1 000341   000000 235000 xsym               LDA     S_MIDLTIME
         1 000342   000006 755100                    STA     6,,PR0

      731     3368    1        B$PS0$->PERF(7)=S_MIDUSEC(0);

   3368  1 000343   000000 235000 xsym               LDA     S_MIDUSEC
         1 000344   000007 755100                    STA     7,,PR0

      732     3369    1        B$PS0$->PERF(8)=S_MIDLWIO(0);

   3369  1 000345   000000 235000 xsym               LDA     S_MIDLWIO
         1 000346   000010 755100                    STA     8,,PR0

      733     3370    1        B$PS0$->PERF(9)=S_MIIUSEC(0);

   3370  1 000347   000000 235000 xsym               LDA     S_MIIUSEC
         1 000350   000011 755100                    STA     9,,PR0

      734     3371    1        B$PS0$->PERF(10)=P_RUE#(0);

   3371  1 000351   000000 235000 xsym               LDA     P_RUE#
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:138  
         1 000352   000012 755100                    STA     10,,PR0

      735     3372    1        B$PS0$->PERF(11)=P_SCHD#(0);

   3372  1 000353   000000 235000 xsym               LDA     P_SCHD#
         1 000354   000013 755100                    STA     11,,PR0

      736     3373    1        RETURN;

   3373  1 000355   000000 702200 xent               TSX2  ! X66_ARET

      737     3374        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:139  
      738     3375        /* SET/RESET PRIVILEGES */
      739     3376    1   UMT$SPRIV: ENTRY;

   3376  1 000356   000000 700200 xent  UMT$SPRIV    TSX0  ! X66_AUTO_0
         1 000357   000024 000000                    ZERO    20,0

      740     3377    1        IF PINCRW(B$PS0$,1)->VALFPT.FLAG1

   3377  1 000360   000000 470400 xsym               LDP0    B$PS0$
         1 000361   000001 236100                    LDQ     1,,PR0
         1 000362   200000 316003                    CANQ    65536,DU
         1 000363   000403 600000 1                  TZE     s:3384

      741     3378    2        THEN DO;

      742     3379    2           IF (B$JIT.PPRIV&BBASED)=BBASED

   3379  1 000364   000000 471400 xsym               LDP1    B$JIT$
         1 000365   100020 236100                    LDQ     16,,PR1
         1 000366   000000 376100                    ANQ     0,,PR0
         1 000367   000000 116100                    CMPQ    0,,PR0
         1 000370   000402 600000 1                  TZE     s:3381
         1 000371   100015 236100                    LDQ     13,,PR1
         1 000372   100016 376100                    ANQ     14,,PR1
         1 000373   100016 116100                    CMPQ    14,,PR1
         1 000374   000535 601000 1                  TNZ     SETNPRIV
         1 000375   100016 235100                    LDA     14,,PR1
         1 000376   000535 600000 1                  TZE     SETNPRIV
         1 000377   000000 236100                    LDQ     0,,PR0
         1 000400   000003 376000 0                  ANQ     PPR_MASK
         1 000401   000535 601000 1                  TNZ     SETNPRIV

      743     3380    2              OR (((B$JIT.PRIV.JOB&B$JIT.PRIV.PRC)=B$JIT.PRIV.PRC AND B$JIT.PRIV.PRC)
              3380                       AND (NOT BBASED&PPR_MASK))
      744     3381    2           THEN RETURN;

   3381  1 000402   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:140  

      745     3382    2           ELSE GOTO SETNPRIV;
      746     3383    2           END;
      747     3384    1        IF PINCRW(B$PS0$,1)->VALFPT.FLAG

   3384  1 000403   000001 234100                    SZN     1,,PR0
         1 000404   000412 605000 1                  TPL     s:3388

      748     3385    1        THEN
      749     3386    1           BTEMP=B$JIT.PRIV.AUTH & ES_PRIVMASK;

   3386  1 000405   000000 471400 xsym               LDP1    B$JIT$
         1 000406   100014 236100                    LDQ     12,,PR1
         1 000407   000000 376000 xsym               ANQ     ES_PRIVMASK
         1 000410   200010 756100                    STQ     BTEMP,,AUTO
         1 000411   000417 710000 1                  TRA     s:3389

      750     3387    1        ELSE
      751     3388    1           BTEMP=(B$JIT.PRIV.JOB&ES_PRIVMASK)|B$JIT.PRIV.PRC;

   3388  1 000412   000000 471400 xsym               LDP1    B$JIT$
         1 000413   100015 236100                    LDQ     13,,PR1
         1 000414   000000 376000 xsym               ANQ     ES_PRIVMASK
         1 000415   100016 276100                    ORQ     14,,PR1
         1 000416   200010 756100                    STQ     BTEMP,,AUTO

      752     3389    1        B$JIT.PRIV.ACTIVE=B$JIT.PRIV.ACTIVE|

   3389  1 000417   000000 376100                    ANQ     0,,PR0
         1 000420   100013 276100                    ORQ     11,,PR1
         1 000421   100013 756100                    STQ     11,,PR1

      753     3390    1           (BBASED&BTEMP);
      754     3391    1        CALL JIT;                          /* Update %JITSID descriptor flags */

   3391  1 000422   000563 701000 1                  TSX1    JIT
         1 000423   000000 011000                    NOP     0
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:141  

      755     3392    2        IF (BBASED&BTEMP)=BBASED THEN DO;  /* Granted the request */

   3392  1 000424   000000 470400 xsym               LDP0    B$PS0$
         1 000425   000000 236100                    LDQ     0,,PR0
         1 000426   200010 376100                    ANQ     BTEMP,,AUTO
         1 000427   000000 116100                    CMPQ    0,,PR0
         1 000430   000475 601000 1                  TNZ     s:3410

      756     3393              /* Do we consider logging? */
      757     3394    3           IF ES_LOGPRIVCHNG=%PC_ES_GRANTED# OR ES_LOGPRIVCHNG=%PC_ES_ALL# THEN DO;

   3394  1 000431   000000 235000 xsym               LDA     ES_LOGPRIVCHNG
         1 000432   000002 115007                    CMPA    2,DL
         1 000433   000436 600000 1                  TZE     s:3396
         1 000434   000003 115007                    CMPA    3,DL
         1 000435   000540 601000 1                  TNZ     s:3427

      758     3395                 /* Did he ask for a priv we care about? */
      759     3396    3              ES$PRIV_CHANGE.PRIV#=BBASED & ES_PRIVCHNGMASK;

   3396  1 000436   000000 236100                    LDQ     0,,PR0
         1 000437   000000 376000 xsym               ANQ     ES_PRIVCHNGMASK
         1 000440   200006 756100                    STQ     ES$PRIV_CHANGE+1,,AUTO

      760     3397                 /* Log granted privs only if they're not in PRC. */
      761     3398    3              IF NOT PINCRW(B$PS0$,1)->VALFPT.FLAG THEN

   3398  1 000441   000001 234100                    SZN     1,,PR0
         1 000442   000450 604000 1                  TMI     s:3400

      762     3399    3                 ES$PRIV_CHANGE.PRIV#=ES$PRIV_CHANGE.PRIV# & (~B$JIT.PRIV.PRC);

   3399  1 000443   000000 471400 xsym               LDP1    B$JIT$
         1 000444   100016 236100                    LDQ     14,,PR1
         1 000445   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000446   200006 376100                    ANQ     ES$PRIV_CHANGE+1,,AUTO
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:142  
         1 000447   200006 756100                    STQ     ES$PRIV_CHANGE+1,,AUTO

      763     3400    4              IF ES$PRIV_CHANGE.PRIV# THEN DO;

   3400  1 000450   000000 116003                    CMPQ    0,DU
         1 000451   000540 600000 1                  TZE     s:3427

      764     3401    4                 ES$PRIV_CHANGE.REASON#=%ES_PRIV_CHNG_GRANTED#;

   3401  1 000452   002000 236003                    LDQ     1024,DU
         1 000453   200005 552140                    STBQ    ES$PRIV_CHANGE,'40'O,AUTO

      765     3402    4                 ES$PRIV_CHANGE.GRANTED#='1'B;

   3402  1 000454   000400 236003                    LDQ     256,DU
         1 000455   200005 256100                    ORSQ    ES$PRIV_CHANGE,,AUTO

      766     3403    4                 CALL ELA$SYSLOG(EL_PRIV_CHANGE,ES$PRIV_CHANGE,

   3403  1 000456   200012 631500                    EPPR1   UTEMP,,AUTO
         1 000457   200023 451500                    STP1    UTEMP+9,,AUTO
         1 000460   000007 236000 2                  LDQ     7
         1 000461   200022 756100                    STQ     UTEMP+8,,AUTO
         1 000462   000010 237000 2                  LDAQ    8
         1 000463   200020 757100                    STAQ    UTEMP+6,,AUTO
         1 000464   200005 633500                    EPPR3   ES$PRIV_CHANGE,,AUTO
         1 000465   200017 453500                    STP3    UTEMP+5,,AUTO
         1 000466   000012 236000 2                  LDQ     10
         1 000467   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000470   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000471   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000472   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000473   000000 011000                    NOP     0

      767     3404    4                    SIZEW(ES$PRIV_CHANGE),'0'B,EL_SEC,UTEMP);
      768     3405    4                 END;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:143  
      769     3406    3              END;

      770     3407    2           END;

   3407  1 000474   000540 710000 1                  TRA     s:3427

      771     3408    2        ELSE DO;                      /* Denied at least part of this request */

      772     3409              /* Do we consider logging? */
      773     3410    3           IF ES_LOGPRIVCHNG=%PC_ES_DENIED# OR ES_LOGPRIVCHNG=%PC_ES_ALL# THEN DO;

   3410  1 000475   000000 235000 xsym               LDA     ES_LOGPRIVCHNG
         1 000476   000001 115007                    CMPA    1,DL
         1 000477   000502 600000 1                  TZE     s:3412
         1 000500   000003 115007                    CMPA    3,DL
         1 000501   000535 601000 1                  TNZ     SETNPRIV

      774     3411                 /* Did he ask for a priv we care about? */
      775     3412    3              ES$PRIV_CHANGE.PRIV#=BBASED&(~BTEMP)&ES_PRIVCHNGMASK;

   3412  1 000502   200010 236100                    LDQ     BTEMP,,AUTO
         1 000503   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000504   000000 376100                    ANQ     0,,PR0
         1 000505   000000 376000 xsym               ANQ     ES_PRIVCHNGMASK
         1 000506   200006 756100                    STQ     ES$PRIV_CHANGE+1,,AUTO

      776     3413    4              IF ES$PRIV_CHANGE.PRIV# THEN DO;

   3413  1 000507   000535 600000 1                  TZE     SETNPRIV

      777     3414    4                 ES$PRIV_CHANGE.REASON#=%ES_PRIV_CHNG_DENIED#;

   3414  1 000510   001000 236003                    LDQ     512,DU
         1 000511   200005 552140                    STBQ    ES$PRIV_CHANGE,'40'O,AUTO

      778     3415    4                 ES$PRIV_CHANGE.GRANTED#='0'B;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:144  
   3415  1 000512   000013 236000 2                  LDQ     11
         1 000513   200005 356100                    ANSQ    ES$PRIV_CHANGE,,AUTO

      779     3416    4                 B$JIT.ERR=ENOPRIV;

   3416  1 000514   000000 236000 0                  LDQ     ENOPRIV
         1 000515   000000 471400 xsym               LDP1    B$JIT$
         1 000516   100012 756100                    STQ     10,,PR1

      780     3417    4                 CALL ELA$SYSLOG(EL_PRIV_CHANGE,ES$PRIV_CHANGE,

   3417  1 000517   200012 633500                    EPPR3   UTEMP,,AUTO
         1 000520   200023 453500                    STP3    UTEMP+9,,AUTO
         1 000521   000007 236000 2                  LDQ     7
         1 000522   200022 756100                    STQ     UTEMP+8,,AUTO
         1 000523   000010 237000 2                  LDAQ    8
         1 000524   200020 757100                    STAQ    UTEMP+6,,AUTO
         1 000525   200005 634500                    EPPR4   ES$PRIV_CHANGE,,AUTO
         1 000526   200017 454500                    STP4    UTEMP+5,,AUTO
         1 000527   000012 236000 2                  LDQ     10
         1 000530   200016 756100                    STQ     UTEMP+4,,AUTO
         1 000531   200016 630500                    EPPR0   UTEMP+4,,AUTO
         1 000532   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000533   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000534   000000 011000                    NOP     0

      781     3418    4                    SIZEW(ES$PRIV_CHANGE),'0'B,EL_SEC,UTEMP);
      782     3419    4                 END;

      783     3420    3              END;

   3418  1 000535                       SETNPRIV     null
      784     3421    2   SETNPRIV:;
      785     3422    2           B$JIT.ERR=ENOPRIV;

   3422  1 000535   000000 236000 0                  LDQ     ENOPRIV
         1 000536   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:145  
         1 000537   000012 756100                    STQ     10,,PR0

      786     3423    2           END;

      787     3424        /*E* ERROR: UMT-E$NOPRIV-C
      788     3425             MESSAGE: Cannot effect entire privilege change requested.
      789     3426        */
      790     3427    1        RETURN;

   3427  1 000540   000000 702200 xent               TSX2  ! X66_ARET

      791     3428        /*
      792     3429        */
      793     3430    1   UMT$RPRIV: ENTRY;

   3430  1 000541   000000 700200 xent  UMT$RPRIV    TSX0  ! X66_AUTO_0
         1 000542   000024 000000                    ZERO    20,0

      794     3431    1        BTEMP=B$JIT.PRIV.ACTIVE&BBASED;

   3431  1 000543   000000 470400 xsym               LDP0    B$JIT$
         1 000544   000000 471400 xsym               LDP1    B$PS0$
         1 000545   000013 236100                    LDQ     11,,PR0
         1 000546   100000 376100                    ANQ     0,,PR1
         1 000547   200010 756100                    STQ     BTEMP,,AUTO

      795     3432    1        B$JIT.PRIV.ACTIVE=B$JIT.PRIV.ACTIVE&~BBASED;

   3432  1 000550   100000 236100                    LDQ     0,,PR1
         1 000551   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000552   000013 376100                    ANQ     11,,PR0
         1 000553   000013 756100                    STQ     11,,PR0

      796     3433    1        CALL JIT;                          /* Update %JITSID descriptor flags */

   3433  1 000554   000563 701000 1                  TSX1    JIT
         1 000555   000000 011000                    NOP     0
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:146  

      797     3434    1        IF BTEMP~=BBASED

   3434  1 000556   000000 470400 xsym               LDP0    B$PS0$
         1 000557   200010 236100                    LDQ     BTEMP,,AUTO
         1 000560   000000 116100                    CMPQ    0,,PR0
         1 000561   000535 601000 1                  TNZ     SETNPRIV

      798     3435    1        THEN GOTO SETNPRIV;
      799     3436    1        RETURN;

   3436  1 000562   000000 702200 xent               TSX2  ! X66_ARET

      800     3437
      801     3438    1   JIT: PROC;                              /* Update %JITSID descriptor flags */

   3438  1 000563   200014 741300       JIT          STX1  ! UTEMP+2,,AUTO

      802     3439
      803     3440        %INCLUDE MM_DATA_R;
      804     3960        %INCLUDE B_SEGIDS_C;
      805     4499
      806     4500    2   DCL B$USERLS$ PTR SYMREF READONLY;
      807     4501    2   DCL B$DBLS$ PTR SYMREF READONLY;
      808     4502
      809     4503    2        IF B$JIT.PRIV.ACTIVE & %PR_JIT#

   4503  1 000564   000000 470400 xsym               LDP0    B$JIT$
         1 000565   000013 236100                    LDQ     11,,PR0
         1 000566   000004 376000 0                  ANQ     PPR_MASK+1
         1 000567   000617 600000 1                  TZE     s:4517

      810     4504    3        THEN DO;

      811     4505                %SETFLG(LS$=B$USERLS$,SEGID=%JITSID,FLG="%DSWRITE");

   4506  1 000570   000000 471400 xsym               LDP1    B$USERLS$
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:147  
         1 000571   100002 236100                    LDQ     2,,PR1
         1 000572   000024 736000                    QLS     20
         1 000573   777000 376003                    ANQ     -512,DU
         1 000574   200000 276003                    ORQ     65536,DU
         1 000575   000024 772000                    QRL     20
         1 000576   100002 676100                    ERQ     2,,PR1
         1 000577   177600 376007                    ANQ     65408,DL
         1 000600   100002 656100                    ERSQ    2,,PR1

      812     4508    3           IF (S$CU$->B$U.FLG & %U_DIC)

   4508  1 000601   000000 473400 xsym               LDP3    S$CU$
         1 000602   300000 236100                    LDQ     0,,PR3
         1 000603   000005 376000 0                  ANQ     PPR_MASK+2
         1 000604   000645 600000 1                  TZE     s:4527

      813     4509    4           THEN DO;

      814     4510                   %SETFLG(LS$=B$DBLS$,SEGID=%JITSID,FLG="%DSWRITE");

   4511  1 000605   000000 474400 xsym               LDP4    B$DBLS$
         1 000606   400002 236100                    LDQ     2,,PR4
         1 000607   000024 736000                    QLS     20
         1 000610   777000 376003                    ANQ     -512,DU
         1 000611   200000 276003                    ORQ     65536,DU
         1 000612   000024 772000                    QRL     20
         1 000613   400002 676100                    ERQ     2,,PR4
         1 000614   177600 376007                    ANQ     65408,DL
         1 000615   400002 656100                    ERSQ    2,,PR4

      815     4513    4              END;

      816     4514    3           END;

   4514  1 000616   000645 710000 1                  TRA     s:4527

      817     4515    3        ELSE DO;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:148  

      818     4516                %SETFLG(LS$=B$USERLS$,SEGID=%JITSID,FLG="%DSREAD");

   4517  1 000617   000000 471400 xsym               LDP1    B$USERLS$
         1 000620   100002 236100                    LDQ     2,,PR1
         1 000621   000024 736000                    QLS     20
         1 000622   777000 376003                    ANQ     -512,DU
         1 000623   400000 276003                    ORQ     -131072,DU
         1 000624   000024 772000                    QRL     20
         1 000625   100002 676100                    ERQ     2,,PR1
         1 000626   177600 376007                    ANQ     65408,DL
         1 000627   100002 656100                    ERSQ    2,,PR1

      819     4519    3           IF (S$CU$->B$U.FLG & %U_DIC)

   4519  1 000630   000000 473400 xsym               LDP3    S$CU$
         1 000631   300000 236100                    LDQ     0,,PR3
         1 000632   000005 376000 0                  ANQ     PPR_MASK+2
         1 000633   000645 600000 1                  TZE     s:4527

      820     4520    4           THEN DO;

      821     4521                   %SETFLG(LS$=B$DBLS$,SEGID=%JITSID,FLG="%DSREAD");

   4522  1 000634   000000 474400 xsym               LDP4    B$DBLS$
         1 000635   400002 236100                    LDQ     2,,PR4
         1 000636   000024 736000                    QLS     20
         1 000637   777000 376003                    ANQ     -512,DU
         1 000640   400000 276003                    ORQ     -131072,DU
         1 000641   000024 772000                    QRL     20
         1 000642   400002 676100                    ERQ     2,,PR4
         1 000643   177600 376007                    ANQ     65408,DL
         1 000644   400002 656100                    ERSQ    2,,PR4

      822     4524    4              END;

      823     4525    3           END;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:149  

      824     4526
      825     4527    2   END JIT;

   4527  1 000645   200014 221300                    LDX1  ! UTEMP+2,,AUTO
         1 000646   000001 702211                    TSX2  ! 1,X1

      826     4528
      827     4529        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:150  
      828     4530        /* SET/RESET PSEUDO SWITCHES */
      829     4531    1   UMT$SSWITCH: ENTRY;

   4531  1 000647   000000 700200 xent  UMT$SSWITCH  TSX0  ! X66_AUTO_0
         1 000650   000024 000000                    ZERO    20,0

      830     4532    1        BTEMP=B$JIT.SWITCH;

   4532  1 000651   000000 470400 xsym               LDP0    B$JIT$
         1 000652   000031 236100                    LDQ     25,,PR0
         1 000653   200010 756100                    STQ     BTEMP,,AUTO

      831     4533    1           B$JIT.SWITCH=BTEMP|BBASED;

   4533  1 000654   000000 471400 xsym               LDP1    B$PS0$
         1 000655   100000 276100                    ORQ     0,,PR1
         1 000656   000031 756100                    STQ     25,,PR0

      832     4534    1           RETURN;

   4534  1 000657   000000 702200 xent               TSX2  ! X66_ARET

      833     4535    1           UMT$RSWITCH: ENTRY;

   4535  1 000660   000000 700200 xent  UMT$RSWITCH  TSX0  ! X66_AUTO_0
         1 000661   000024 000000                    ZERO    20,0

      834     4536    1           BTEMP=B$JIT.SWITCH;

   4536  1 000662   000000 470400 xsym               LDP0    B$JIT$
         1 000663   000031 236100                    LDQ     25,,PR0
         1 000664   200010 756100                    STQ     BTEMP,,AUTO

      835     4537    1           B$JIT.SWITCH=BTEMP&~BBASED;

   4537  1 000665   000000 471400 xsym               LDP1    B$PS0$
         1 000666   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:151  
         1 000667   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000670   200010 376100                    ANQ     BTEMP,,AUTO
         1 000671   000031 756100                    STQ     25,,PR0

      836     4538    1           RETURN;

   4538  1 000672   000000 702200 xent               TSX2  ! X66_ARET

      837     4539                %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:152  
      838     4540        /* INCREMENT TRANSACTION COUNTERS */
      839     4541    1           UMT$CHGUNIT: ENTRY;

   4541  1 000673   000000 700200 xent  UMT$CHGUNIT  TSX0  ! X66_AUTO_0
         1 000674   000024 000000                    ZERO    20,0

      840     4542    1           IF VALFPT.FLAG

   4542  1 000675   000000 470400 xsym               LDP0    B$PS0$
         1 000676   000000 234100                    SZN     0,,PR0
         1 000677   000704 605000 1                  TPL     s:4544

      841     4543    1           THEN P$=ADDR(B$JIT.STEPUNIT);

   4543  1 000700   000000 236000 xsym               LDQ     B$JIT$
         1 000701   000141 036003                    ADLQ    97,DU
         1 000702   200007 756100                    STQ     P$,,AUTO
         1 000703   000707 710000 1                  TRA     s:4545

      842     4544    1        ELSE P$=ADDR(B$JIT.JOBUNIT);

   4544  1 000704   000000 236000 xsym               LDQ     B$JIT$
         1 000705   000137 036003                    ADLQ    95,DU
         1 000706   200007 756100                    STQ     P$,,AUTO

      843     4545    1        T=0;

   4545  1 000707   200003 450100                    STZ     T,,AUTO

      844     4546    2        DO WHILE (T<4);

   4546  1 000710   200003 235100                    LDA     T,,AUTO
         1 000711   000004 115007                    CMPA    4,DL
         1 000712   000751 603000 1                  TRC     s:4559

      845     4547    2           UTEMP=VAL.UARR(T)+VALFPT.UARR(T);

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:153  
   4547  1 000713   200003 235100                    LDA     T,,AUTO
         1 000714   000001 735000                    ALS     1
         1 000715   000000 470400 xsym               LDP0    B$PS0$
         1 000716   000100 101505                    MRL     fill='000'O
         1 000717   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         1 000720   200016 000004                    ADSC9   UTEMP+4,,AUTO            cn=0,n=4
         1 000721   200007 471500                    LDP1    P$,,AUTO
         1 000722   000100 101505                    MRL     fill='000'O
         1 000723   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
         1 000724   200017 000004                    ADSC9   UTEMP+5,,AUTO            cn=0,n=4
         1 000725   200017 236100                    LDQ     UTEMP+5,,AUTO
         1 000726   200016 036100                    ADLQ    UTEMP+4,,AUTO
         1 000727   200012 756100                    STQ     UTEMP,,AUTO

      846     4548    2           IF UTEMP>262143

   4548  1 000730   000001 116003                    CMPQ    1,DU
         1 000731   000737 602000 1                  TNC     s:4556

      847     4549    3           THEN DO;

      848     4550    3              UTEMP=262143;

   4550  1 000732   777777 235007                    LDA     -1,DL
         1 000733   200012 755100                    STA     UTEMP,,AUTO

      849     4551    3              B$JIT.ERR=EMAXCHG;

   4551  1 000734   000001 236000 0                  LDQ     EMAXCHG
         1 000735   000000 473400 xsym               LDP3    B$JIT$
         1 000736   300012 756100                    STQ     10,,PR3

      850     4552        /*E* ERROR: UMT-E$MAXCHG-C
      851     4553             MESSAGE: Charges have exceeded field size.
      852     4554        */
      853     4555    3              END;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:154  
      854     4556    2           VAL.UARR(T)=UTEMP;

   4556  1 000737   200003 235100                    LDA     T,,AUTO
         1 000740   000001 735000                    ALS     1
         1 000741   000105 101500                    MRL     fill='000'O
         1 000742   200012 000004                    ADSC9   UTEMP,,AUTO              cn=0,n=4
         1 000743   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

      855     4557    2           T=T+1;

   4557  1 000744   200003 235100                    LDA     T,,AUTO
         1 000745   000001 035007                    ADLA    1,DL
         1 000746   200003 755100                    STA     T,,AUTO

      856     4558    2           END;

   4558  1 000747   000004 115007                    CMPA    4,DL
         1 000750   000713 602000 1                  TNC     s:4547

      857     4559    1        RETURN;

   4559  1 000751   000000 702200 xent               TSX2  ! X66_ARET

      858     4560        %EJECT;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:155  
      859     4561        /* SET USER/INST WORDS */
      860     4562    1   UMT$MISC: ENTRY;

   4562  1 000752   000000 700200 xent  UMT$MISC     TSX0  ! X66_AUTO_0
         1 000753   000024 000000                    ZERO    20,0

      861     4563    1        IF VALFPT.FLAG

   4563  1 000754   000000 470400 xsym               LDP0    B$PS0$
         1 000755   000000 234100                    SZN     0,,PR0
         1 000756   000763 605000 1                  TPL     s:4566

      862     4564    1        THEN P$=ADDR(B$JIT.USERWORD);

   4564  1 000757   000000 236000 xsym               LDQ     B$JIT$
         1 000760   000133 036003                    ADLQ    91,DU
         1 000761   200007 756100                    STQ     P$,,AUTO
         1 000762   000776 710000 1                  TRA     s:4573

      863     4565    2        ELSE DO;

      864     4566    2           IF B$JIT.PRIV.ACTIVE & %PR_EXMM#

   4566  1 000763   000000 471400 xsym               LDP1    B$JIT$
         1 000764   100013 236100                    LDQ     11,,PR1
         1 000765   000004 376000 xsym               ANQ     B_VECTNIL+4
         1 000766   000773 600000 1                  TZE     s:4569

      865     4567    2           THEN P$=ADDR(B$JIT.INSTWORD);

   4567  1 000767   000000 236000 xsym               LDQ     B$JIT$
         1 000770   000135 036003                    ADLQ    93,DU
         1 000771   200007 756100                    STQ     P$,,AUTO
         1 000772   000776 710000 1                  TRA     s:4573

      866     4568    3           ELSE DO;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:156  
      867     4569    3              B$JIT.ERR = EPRIV;

   4569  1 000773   000002 236000 0                  LDQ     EPRIV
         1 000774   100012 756100                    STQ     10,,PR1

      868     4570    3              RETURN;

   4570  1 000775   000000 702200 xent               TSX2  ! X66_ARET

      869     4571    3              END;
      870     4572    2           END;
      871     4573    1        T=0;

   4573  1 000776   200003 450100                    STZ     T,,AUTO

      872     4574    2        DO WHILE (T<4);

   4574  1 000777   200003 235100                    LDA     T,,AUTO
         1 001000   000004 115007                    CMPA    4,DL
         1 001001   001024 603000 1                  TRC     s:4580

      873     4575    2           UTEMP=VALFPT.UARR(T);

   4575  1 001002   200003 235100                    LDA     T,,AUTO
         1 001003   000001 735000                    ALS     1
         1 001004   000000 470400 xsym               LDP0    B$PS0$
         1 001005   000100 101505                    MRL     fill='000'O
         1 001006   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         1 001007   200012 000004                    ADSC9   UTEMP,,AUTO              cn=0,n=4

      874     4576    2           IF UTEMP~=262143 THEN

   4576  1 001010   200012 236100                    LDQ     UTEMP,,AUTO
         1 001011   777777 116007                    CMPQ    -1,DL
         1 001012   001017 600000 1                  TZE     s:4578

      875     4577    2              VAL.UARR(T)=UTEMP;
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:157  

   4577  1 001013   200007 471500                    LDP1    P$,,AUTO
         1 001014   000105 101500                    MRL     fill='000'O
         1 001015   200012 000004                    ADSC9   UTEMP,,AUTO              cn=0,n=4
         1 001016   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

      876     4578    2           T=T+1;

   4578  1 001017   200003 235100                    LDA     T,,AUTO
         1 001020   000001 035007                    ADLA    1,DL
         1 001021   200003 755100                    STA     T,,AUTO

      877     4579    2           END;

   4579  1 001022   000004 115007                    CMPA    4,DL
         1 001023   001002 602000 1                  TNC     s:4575

      878     4580    1        IF VALFPT.FLAG2

   4580  1 001024   000000 470400 xsym               LDP0    B$PS0$
         1 001025   000000 236100                    LDQ     0,,PR0
         1 001026   100000 316003                    CANQ    32768,DU
         1 001027   001034 600000 1                  TZE     s:4583

      879     4581    1        THEN
      880     4582    1           CALL MMC$MAPXLATALT (B$UPT$);

   4582  1 001030   000014 630400 2                  EPPR0   12
         1 001031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001032   000000 701000 xent               TSX1    MMC$MAPXLATALT
         1 001033   000000 011000                    NOP     0

      881     4583    1        IF VALFPT.FLAG1

   4583  1 001034   000000 470400 xsym               LDP0    B$PS0$
         1 001035   000000 236100                    LDQ     0,,PR0
         1 001036   200000 316003                    CANQ    65536,DU
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:158  
         1 001037   001044 600000 1                  TZE     s:4586

      882     4584    1        THEN
      883     4585    1           CALL MMC$MAPXLAT (B$UPT$);

   4585  1 001040   000014 630400 2                  EPPR0   12
         1 001041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001042   000000 701000 xent               TSX1    MMC$MAPXLAT
         1 001043   000000 011000                    NOP     0

      884     4586    1        RETURN;

   4586  1 001044   000000 702200 xent               TSX2  ! X66_ARET

ENOPRIV
 Sect OctLoc
   0     000   251524 006310                                                    ....

EMAXCHG
 Sect OctLoc
   0     001   251524 006320                                                    ....

EPRIV
 Sect OctLoc
   0     002   251524 011442                                                    ....

PPR_MASK
 Sect OctLoc
   0     003   200775 000000                                                    ....

(unnamed)
 Sect OctLoc
   0     004   000000 000040   100000 000000                                    ... @...

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000000 006000   000003 006000   000040 753000    ............. ..
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:159  
   2     004   000000 000032   000004 006000   000000 000766   000005 006000    ................
   2     010   000004 006000   000002 006000   000006 006000   777377 777777    ................
   2     014   000000 006000                                                    ....
      885     4587    1   END UMT$SYSLOAD;
      886     4588        %EOD;

PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:160  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   ES_TABLES_M.:E05TOU  is referenced.
   ES_SUBS_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   UE$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$SYSLOAD.
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:161  

 **** Variables and constants ****

  ****  Section 000 RoData UMT$SYSLOAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 EMAXCHG                    0-0-0/b STRC        r     1 ENOPRIV
     2-0-0/b STRC        r     1 EPRIV                      3-0-0/w BIT         r     1 PPR_MASK

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/b BIT         r     1 BTEMP                      4-0-0/w PTR         r     1 D$
     5-0-0/w STRC(72)    r     1 ES$PRIV_CHANGE            11-0-0/w UBIN(18)    r     1 HTEMP
     7-0-0/w PTR         r     1 P$                         3-0-0/w UBIN        r     1 T
    12-0-0/w UBIN        r     1 UTEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DBLS$                    0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$PS0$                     0-0-0/w PTR         r     1 B$PS1$
     0-0-0/w PTR         r     1 B$UPT$                     0-0-0/w PTR         r     1 B$USERLS$
     0-0-0/w UBIN        r     1 ES_LOGPRIVCHNG             0-0-0/b BIT         r     1 ES_PRIVCHNGMASK
     0-0-0/b BIT         r     1 ES_PRIVMASK                0-0-0/w PTR         r     1 MM_BYP$
     0-0-0/w SBIN        r     1 P_ETMF                     0-0-0/w PTR         r     1 P_RESOURCE$
     0-0-0/w SBIN        r     1 P_RT90                     0-0-0/w SBIN        r     1 P_RUE#(0:7)
     0-0-0/w SBIN        r     1 P_SCHD#(0:7)
     0-0-0/w PTR         r     1 S$CU$                      0-0-0/w SBIN        r     1 S_CTUIS
     0-0-0/w SBIN        r     1 S_CUIS(0:4)
     0-0-0/w SBIN        r     1 S_MIDLTIME(0:7)
     0-0-0/w SBIN        r     1 S_MIDLWIO(0:7)
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:162  
     0-0-0/w SBIN        r     1 S_MIDUSEC(0:7)
     0-0-0/w SBIN        r     1 S_MIIUSEC(0:7)
     0-0-0/w SBIN        r     1 S_MXEQTIME(0:7)
     0-0-0/w SBIN        r     1 S_MXUSEC(0:7)
     0-0-0/b BIT (72)    r     1 S_UDLGATE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 B$DO                       0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/w BIT         r     1 BBASED
     0-0-0/d STRC(72)    r     1 FPT$WAIT_V                 0-0-0/w UBIN        r     1 LOAD(0:2)
     0-0-0/d STRC(72)    r     1 MM$DESC(0:0)
     0-0-0/w SBIN        r     1 PERF(0:11)                 0-0-0/w STRC(72)    r     1 VAL
     0-0-0/w STRC(108)   r     1 VALFPT                     0-0-0/d STRC(252)   r     1 VLR$DISPLAY_V


   Procedure UMT$SYSLOAD requires 549 words for executable code.
   Procedure UMT$SYSLOAD requires 20 words of local(AUTO) storage.
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:163  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:164  
          MINI XREF LISTING

B$DBLS$ IN PROCEDURE JIT
      4501**DCL      4511>>ASSIGN   4511>>ASSIGN   4522>>ASSIGN   4522>>ASSIGN
B$DO.BUSY
      1559**DCL      3293>>IF
B$DO.ECCINFO
      1572**DCL      1573--REDEF
B$DO.LNK$
      1557**DCL      3294>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3001**DCL      3001--REDEF
B$JIT.ERR
      2907**DCL      3416<<ASSIGN   3422<<ASSIGN   4551<<ASSIGN   4569<<ASSIGN
B$JIT.ERR.MID
      2908**DCL      2908--REDEF
B$JIT.EXTUS
      3074**DCL      3360<>CALL     3362<>CALL
B$JIT.INSTWORD
      2995**DCL      4567--ASSIGN
B$JIT.JOBUNIT
      2996**DCL      4544--ASSIGN
B$JIT.PNR
      3073**DCL      3073--REDEF
B$JIT.PPRIV
      2963**DCL      3379>>IF
B$JIT.PRIV.ACTIVE
      2908**DCL      3389<<ASSIGN   3389>>ASSIGN   3431>>ASSIGN   3432<<ASSIGN   3432>>ASSIGN   4503>>IF
      4566>>IF
B$JIT.PRIV.AUTH
      2948**DCL      3386>>ASSIGN
B$JIT.PRIV.JOB
      2951**DCL      3379>>IF       3388>>ASSIGN
B$JIT.PRIV.PRC
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:165  
      2955**DCL      3379>>IF       3379>>IF       3379>>IF       3388>>ASSIGN   3399>>ASSIGN
B$JIT.RUNFLAGS
      3094**DCL      3359>>IF
B$JIT.STEPUNIT
      2996**DCL      4543--ASSIGN
B$JIT.SWITCH
      2995**DCL      4532>>ASSIGN   4533<<ASSIGN   4536>>ASSIGN   4537<<ASSIGN
B$JIT.TPEXT
      3072**DCL      3360<>CALL
B$JIT.TUEXT
      3072**DCL      3362<>CALL
B$JIT.USERWORD
      2995**DCL      4564--ASSIGN
B$JIT.XTIME
      3071**DCL      3360<>CALL     3362<>CALL
B$JIT$
        20**DCL      2902--IMP-PTR  3359>>IF       3360>>CALL     3360>>CALL     3360>>CALL     3362>>CALL
      3362>>CALL     3362>>CALL     3379>>IF       3379>>IF       3379>>IF       3379>>IF       3379>>IF
      3386>>ASSIGN   3388>>ASSIGN   3388>>ASSIGN   3389>>ASSIGN   3389>>ASSIGN   3399>>ASSIGN   3416>>ASSIGN
      3422>>ASSIGN   3431>>ASSIGN   3432>>ASSIGN   3432>>ASSIGN   4503>>IF       4532>>ASSIGN   4533>>ASSIGN
      4536>>ASSIGN   4537>>ASSIGN   4543>>ASSIGN   4544>>ASSIGN   4551>>ASSIGN   4564>>ASSIGN   4566>>IF
      4567>>ASSIGN   4569>>ASSIGN
B$PS0$
      3217**DCL      3227--IMP-PTR  3228--IMP-PTR  3268>>ASSIGN   3269>>ASSIGN   3270>>ASSIGN   3274>>ASSIGN
      3275>>ASSIGN   3276>>ASSIGN   3277>>ASSIGN   3287>>ASSIGN   3300>>ASSIGN   3311>>DOCASE   3314>>ASSIGN
      3317>>ASSIGN   3320>>ASSIGN   3334>>DOCASE   3365>>ASSIGN   3366>>ASSIGN   3367>>ASSIGN   3368>>ASSIGN
      3369>>ASSIGN   3370>>ASSIGN   3371>>ASSIGN   3372>>ASSIGN   3377>>IF       3379>>IF       3379>>IF
      3379>>IF       3384>>IF       3389>>ASSIGN   3392>>IF       3392>>IF       3396>>ASSIGN   3398>>IF
      3412>>ASSIGN   3431>>ASSIGN   3432>>ASSIGN   3434>>IF       4533>>ASSIGN   4537>>ASSIGN   4542>>IF
      4547>>ASSIGN   4563>>IF       4575>>ASSIGN   4580>>IF       4583>>IF
B$PS1$
      3218**DCL      3300>>ASSIGN   3330>>ASSIGN   3349>>ASSIGN
B$U.DL$
      1547**DCL      3291>>ASSIGN
B$U.FLG
      1438**DCL      4508>>IF       4519>>IF
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:166  
B$U.MISC
      1551**DCL      1552--REDEF    3329>>IF       3333<>CALL
B$UPT$
      3219**DCL      4582<>CALL     4585<>CALL
B$USER.MISC
      1627**DCL      1628--REDEF
B$USERLS$ IN PROCEDURE JIT
      4500**DCL      4506>>ASSIGN   4506>>ASSIGN   4517>>ASSIGN   4517>>ASSIGN
BBASED
      3227**DCL      3379>>IF       3379>>IF       3379>>IF       3389>>ASSIGN   3392>>IF       3392>>IF
      3396>>ASSIGN   3412>>ASSIGN   3431>>ASSIGN   3432>>ASSIGN   3434>>IF       4533>>ASSIGN   4537>>ASSIGN
BTEMP
      3224**DCL      3386<<ASSIGN   3388<<ASSIGN   3389>>ASSIGN   3392>>IF       3412>>ASSIGN   3431<<ASSIGN
      3434>>IF       4532<<ASSIGN   4533>>ASSIGN   4536<<ASSIGN   4537>>ASSIGN
D$
        25**DCL      3291<<ASSIGN   3292>>DOWHILE  3293>>IF       3294<<ASSIGN   3294>>ASSIGN
ELA$SYSLOG
        17**DCL-ENT  3403--CALL     3417--CALL
EMAXCHG
      3251**DCL      4551>>ASSIGN
ENOPRIV
      3244**DCL      3416>>ASSIGN   3422>>ASSIGN
EPRIV
      3258**DCL      4569>>ASSIGN
ES$PRIV_CHANGE
      2156**DCL      3403<>CALL     3403--CALL     3417<>CALL     3417--CALL
ES$PRIV_CHANGE.GRANTED#
      2156**DCL      3402<<ASSIGN   3415<<ASSIGN
ES$PRIV_CHANGE.PRIV#
      2157**DCL      3396<<ASSIGN   3399<<ASSIGN   3399>>ASSIGN   3400>>IF       3412<<ASSIGN   3413>>IF
ES$PRIV_CHANGE.REASON#
      2156**DCL      3401<<ASSIGN   3414<<ASSIGN
ES_LOGPRIVCHNG
      3221**DCL      3394>>IF       3394>>IF       3410>>IF       3410>>IF
ES_PRIVCHNGMASK
      3222**DCL      3396>>ASSIGN   3412>>ASSIGN
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:167  
ES_PRIVMASK
      3220**DCL      3386>>ASSIGN   3388>>ASSIGN
FPT$WAIT_V.UNITS
      3168**DCL      3300>>ASSIGN   3314>>ASSIGN   3317>>ASSIGN   3320>>ASSIGN
FPT$WAIT_V.UTYPE
      3168**DCL      3311>>DOCASE   3334>>DOCASE
HFC$LOCK
      2504**DCL-ENT  3289--CALL
HFC$UNLOCK
      2504**DCL-ENT  3303--CALL
HFF$DSIZ
        13**DCL-ENT  3271--CALL     3363--CALL
HFF$NILERASE
        21**DCL-ENT  3284--CALL     3297--CALL     3327--CALL     3358--CALL
HTEMP
      3225**DCL      3287<<ASSIGN
JIT
      3438**PROC     3391--CALL     3433--CALL
LOAD
        22**DCL      3300<<ASSIGN   3330<<ASSIGN   3349<<ASSIGN
MM$DESC.BOUND IN PROCEDURE JIT
      3911**DCL      3912--REDEF
MM$DESC.FLGS IN PROCEDURE JIT
      3912**DCL      3912--REDEF    4506<<ASSIGN   4506>>ASSIGN   4511<<ASSIGN   4511>>ASSIGN   4517<<ASSIGN
      4517>>ASSIGN   4522<<ASSIGN   4522>>ASSIGN
MM$PPUT.USER# IN PROCEDURE JIT
      3900**DCL      3900--REDEF
MMC$MAPXLAT
        18**DCL-ENT  4585--CALL
MMC$MAPXLATALT
        19**DCL-ENT  4582--CALL
MM_BYP$ IN PROCEDURE JIT
      3831**DCL      3831--IMP-PTR
P$
      3223**DCL      3234--IMP-PTR  4543<<ASSIGN   4544<<ASSIGN   4547>>ASSIGN   4556>>ASSIGN   4564<<ASSIGN
      4567<<ASSIGN   4577>>ASSIGN
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:168  
PERF
        23**DCL      3365<<ASSIGN   3366<<ASSIGN   3367<<ASSIGN   3368<<ASSIGN   3369<<ASSIGN   3370<<ASSIGN
      3371<<ASSIGN   3372<<ASSIGN
PPR_MASK
      3265**DCL      3379>>IF
P_ETMF
       563**DCL      3269>>ASSIGN
P_NSCPU
       590**DCL       591--REDEF
P_RESOURCE.RES
       463**DCL       530--REDEF
P_RESOURCE$
       543**DCL       431--IMP-PTR
P_RT90
       565**DCL      3270>>ASSIGN
P_RUE#
       561**DCL      3371>>ASSIGN
P_SCHD#
       562**DCL      3372>>ASSIGN
P_UPTIME
       579**DCL       580--REDEF
S$CU$
      1638**DCL      3291>>ASSIGN   3329>>IF       3333>>CALL     4508>>IF       4519>>IF
SETNPRIV
      3418**LABEL    3382--GOTO     3435--GOTO
SSC$SASYNC
        11**DCL-ENT  3285--CALL
SSC$SERV
        12**DCL-ENT  3305--CALL
SSR$REG
        14**DCL-ENT  3326--CALL
SSS$CURTIME
        15**DCL-ENT  3328--CALL
SSS$XEQTIME
        16**DCL-ENT  3360--CALL     3362--CALL
S_CTUIS
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:169  
       285**DCL      3268>>ASSIGN
S_CUIS
       285**DCL      3274>>ASSIGN   3275>>ASSIGN   3276>>ASSIGN   3277>>ASSIGN
S_MIDLTIME
       295**DCL      3367>>ASSIGN
S_MIDLWIO
       295**DCL      3369>>ASSIGN
S_MIDUSEC
       293**DCL      3368>>ASSIGN
S_MIIUSEC
       293**DCL      3370>>ASSIGN
S_MXEQTIME
       295**DCL      3365>>ASSIGN
S_MXUSEC
       293**DCL      3366>>ASSIGN
S_UDLGATE
       299**DCL      3289<>CALL     3303<>CALL
T
        24**DCL      3271<>CALL     3272>>IF       3314<<ASSIGN   3317<<ASSIGN   3320<<ASSIGN   3325<<ASSIGN
      3325>>ASSIGN   3326<>CALL     3328<>CALL     3329>>IF       3333<>CALL     3333<>CALL     3337<<ASSIGN
      3337>>ASSIGN   3343<<ASSIGN   3343>>ASSIGN   3347>>IF       3347<<ASSIGN   3349>>ASSIGN   3363<>CALL
      3364>>IF       4545<<ASSIGN   4546>>DOWHILE  4547>>ASSIGN   4547>>ASSIGN   4556>>ASSIGN   4557<<ASSIGN
      4557>>ASSIGN   4573<<ASSIGN   4574>>DOWHILE  4575>>ASSIGN   4577>>ASSIGN   4578<<ASSIGN   4578>>ASSIGN
UTEMP
      3226**DCL      3403<>CALL     3417<>CALL     4547<<ASSIGN   4548>>IF       4550<<ASSIGN   4556>>ASSIGN
      4575<<ASSIGN   4576>>IF       4577>>ASSIGN
VAL.UARR
      3235**DCL      4547>>ASSIGN   4556<<ASSIGN   4577<<ASSIGN
VALFPT.FLAG
      3229**DCL      3384>>IF       3398>>IF       4542>>IF       4563>>IF
VALFPT.FLAG1
      3230**DCL      3377>>IF       4583>>IF
VALFPT.FLAG2
      3231**DCL      4580>>IF
VALFPT.UARR
      3233**DCL      3287>>ASSIGN   4547>>ASSIGN   4575>>ASSIGN
PL6.E3A0      #002=UMT$SYSLOAD File=UMT$TIME.:E05TSI                             WED 07/30/97 07:01 Page:170  
VLR$DISPLAY_V
      3171**DCL      3272--IF
VLR$DISPLAY_V.BUSERS
      3171**DCL      3275<<ASSIGN
VLR$DISPLAY_V.ETMF
      3171**DCL      3269<<ASSIGN
VLR$DISPLAY_V.GUSERS
      3171**DCL      3276<<ASSIGN
VLR$DISPLAY_V.OUSERS
      3171**DCL      3274<<ASSIGN
VLR$DISPLAY_V.RESP
      3171**DCL      3270<<ASSIGN
VLR$DISPLAY_V.TPUSERS
      3171**DCL      3277<<ASSIGN
VLR$DISPLAY_V.USERS
      3171**DCL      3268<<ASSIGN
WT0
      3300**LABEL    3297--CALLALT
WT1
      3352**LABEL    3284--CALLALT  3327--CALLALT  3358--CALLALT
XUD$UTS_DIFF
      3175**DCL-ENT  3333--CALL

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:171  
      887        1        /*T***********************************************************/
      888        2        /*T*                                                         */
      889        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      890        4        /*T*                                                         */
      891        5        /*T***********************************************************/
      892        6        UMT$MONINFO: PROC;
      893        7        %INCLUDE UM_CP6;
      894      859        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      895      878        %VLR_SITEINFO (FPTN=VLR_SITEINFO,STCLASS="BASED(B$PS0$)");
      896      897        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
      897      915        %VLR_MONINFO (FPTN=VLR_MONINFO,STCLASS="BASED(B$PS1$)");
      898      933        %VLR_MONPTRS (FPTN=B_MONPTRS,STCLASS=SYMREF);
      899      948        %VLR_MONPTRS (FPTN=VLR_MONPTRS,STCLASS="BASED(B$PS2$)");
      900      963        %VLR_SYMBINFO (FPTN=FO_SYMBINFO,STCLASS=SYMREF);
      901      979        %VLR_SYMBINFO (FPTN=VLR_SYMBINFO,STCLASS="BASED(B$PS3$)");
      902      995        /**/
      903      996        %INCLUDE MM_DATA_R;
      904     1516        %INCLUDE FM_CACHE_R;
      905     1528        %INCLUDE UMT_CNTRL_R;
      906     1537        %INCLUDE B$JIT;
      907     2140    1   DCL B$JIT$ PTR SYMREF;
      908     2141    1   DCL FT_PROT SBIN SYMREF;
      909     2142        /**/
      910     2143    1   DCL SP_INFO BIT(36) CONSTANT SYMDEF INIT('777777777777'O);
      911     2144    1   DCL B$AWORD BIT(36) BASED ALIGNED;
      912     2145    1   DCL PRIV BIT(36);
      913     2146        /**/
      914     2147    1   DCL B$PS0$ PTR SYMREF;
      915     2148    1   DCL B$PS1$ PTR SYMREF;
      916     2149    1   DCL B$PS2$ PTR SYMREF;
      917     2150    1   DCL B$PS3$ PTR SYMREF;
      918     2151    1   DCL B$PS4$ PTR SYMREF;
      919     2152    1   DCL B$PS5$ PTR SYMREF;
      920     2153    1   DCL 1 K_HEADER SYMREF,
      921     2154    1          2 CNT UBIN BYTE UNAL,
      922     2155    1          2 TEXT CHAR(K_HEADER.CNT) UNAL;
      923     2156    1   DCL 1 HEADER BASED(B$PS5$),
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:172  
      924     2157    1          2 CNT UBIN BYTE UNAL,
      925     2158    1          2 TEXT CHAR(K_HEADER.CNT) UNAL;
      926     2159        /**/
      927     2160    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      928     2161    1   DCL HFF$WRITE1 ENTRY(1) ALTRET;
      929     2162        /**/
      930     2163        %INCLUDE J_ERRSET_C;
      931     2183        %INCLUDE UD_ERRORS_C;
      932     2225        %INCLUDE UD_SEV_C;
      933     2239        %ERRCODE (NAME=ENOTAUTH,FCG#='2515'O,MID#='24'O,COD#=%E$NOTAUTH);
      934     2247        %ERRCODE (NAME=ENOTPURCHASED,FCG#='0000'O,MID#='00'O,COD#=%E$NOTPURCHASED,SEV#=
              2247            SEV_CONT#);
      935     2255        /**/
      936     2256        %EJECT;
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:173  
      937     2257    1        PRIV = B$JIT.PRIV.ACTIVE & (%PR_SPCLMM#|%PR_EXMM#);
      938     2258    1        CALL HFF$NILERASE(B$PS0$) ALTRET(NO_SITEINFO);
      939     2259    1        B_SITEINFO.ANSPROT#=FT_PROT;
      940     2260    1        B_SITEINFO.TIMEZONE#=UMT_TIMEZONE;
      941     2261    1        B_SITEINFO.UTC_OFFSET#=UMT_UTC_OFFSET;
      942     2262    1        VLR_SITEINFO=B_SITEINFO;
      943     2263
      944     2264    1   NO_SITEINFO: ;
      945     2265
      946     2266    1        CALL HFF$NILERASE(B$PS1$) ALTRET(NO_MONINFO);
      947     2267    1        IF NOT PRIV THEN GOTO NOT_PRIV;
      948     2268    1        B_MONINFO.ACORE# = MM_FPPC + MM_AUTO + MM_CGQD.FPPC + FMC_CACHEPGCNT;
      949     2269    1        B_MONINFO.PCORE#=MM_PCORE - MM_GAPSZ;
      950     2270    1        VLR_MONINFO=B_MONINFO;
      951     2271
      952     2272    1   NO_MONINFO: ;
      953     2273
      954     2274    1        CALL HFF$NILERASE(B$PS2$) ALTRET(NO_MONPTRS);
      955     2275    1        IF NOT PRIV THEN GOTO NOT_PRIV;
      956     2276    1        VLR_MONPTRS=B_MONPTRS;
      957     2277
      958     2278    1   NO_MONPTRS: ;
      959     2279
      960     2280    1        CALL HFF$NILERASE(B$PS3$) ALTRET(NO_SYMBINFO);
      961     2281    1        IF NOT PRIV THEN GOTO NOT_PRIV;
      962     2282    1        VLR_SYMBINFO=FO_SYMBINFO;
      963     2283
      964     2284    1   NO_SYMBINFO: ;
      965     2285
      966     2286    1        CALL HFF$NILERASE(B$PS4$) ALTRET(NO_SPINFO);
      967     2287    1        IF (B$PS4$->B$AWORD & SP_INFO) ~= B$PS4$->B$AWORD
      968     2288    1        THEN B$JIT.ERR=ENOTPURCHASED;
      969     2289
      970     2290        /*E*    ERROR: -E$NOTPURCHASED-0
      971     2291         MESSAGE: That separately priced software has not been purchased by your installatio
              2291        n.
      972     2292        */
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:174  
      973     2293
      974     2294    1        CALL HFF$WRITE1(B$PS4$) ALTRET(NO_SPINFO);
      975     2295    1        B$PS4$->B$AWORD = (B$PS4$->B$AWORD & SP_INFO);
      976     2296
      977     2297    1   NO_SPINFO: ;
      978     2298
      979     2299
      980     2300    2        CALL HFF$NILERASE(B$PS5$) WHENRETURN DO;
      981     2301    2           HEADER = K_HEADER;
      982     2302    2           END;
      983     2303
      984     2304    1        RETURN;
      985     2305        /**/
      986     2306    1   NOT_PRIV: ;
      987     2307    1        B$JIT.ERR=ENOTAUTH;
      988     2308        /*E*    ERROR:      UMT-E$NOTAUTH
      989     2309                MESSAGE:    Insufficient privilege for this PMME.
      990     2310        */
      991     2311    1        RETURN;
      992     2312    1   END UMT$MONINFO;

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:175  
--  Include file information  --

   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   J_ERRSET_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   UMT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FM_CACHE_R.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$MONINFO.

   Procedure UMT$MONINFO requires 95 words for executable code.
   Procedure UMT$MONINFO requires 4 words of local(AUTO) storage.

    No errors detected in file UMT$TIME.:E05TSI    .

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:176  

 Object Unit name= UMT$MONINFO                                File name= UMT$TIME.:E05TOU
 UTS= JUL 30 '97 07:02:24.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      3      3  UMT$MONINFO
    1   Proc  even  none    95    137  UMT$MONINFO
    2  RoData even  none     6      6  UMT$MONINFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  UMT$MONINFO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  SP_INFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 HFF$NILERASE
 yes     yes           Std       1 HFF$WRITE1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:177  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_SITEINFO                            B_MONINFO                             B_MONPTRS
     FO_SYMBINFO                           MM_FPPC                               MM_AUTO
r    MM_BYP$                               MM_PCORE                              MM_GAPSZ
     MM_CGQD                               FMC_CACHEPGCNT                        FMC_CACHEPGCNT$
     UMT_TIMEZONE                          UMT_UTC_OFFSET                        B$JIT$
     FT_PROT                               B$PS0$                                B$PS1$
     B$PS2$                                B$PS3$                                B$PS4$
     B$PS5$                                K_HEADER                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:178  


      887        1        /*T***********************************************************/
      888        2        /*T*                                                         */
      889        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      890        4        /*T*                                                         */
      891        5        /*T***********************************************************/
      892        6        UMT$MONINFO: PROC;

      6  1 000000   000000 700200 xent  UMT$MONINFO  TSX0  ! X66_AUTO_0
         1 000001   000004 000000                    ZERO    4,0

      893        7        %INCLUDE UM_CP6;
      894      859        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      895      878        %VLR_SITEINFO (FPTN=VLR_SITEINFO,STCLASS="BASED(B$PS0$)");
      896      897        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
      897      915        %VLR_MONINFO (FPTN=VLR_MONINFO,STCLASS="BASED(B$PS1$)");
      898      933        %VLR_MONPTRS (FPTN=B_MONPTRS,STCLASS=SYMREF);
      899      948        %VLR_MONPTRS (FPTN=VLR_MONPTRS,STCLASS="BASED(B$PS2$)");
      900      963        %VLR_SYMBINFO (FPTN=FO_SYMBINFO,STCLASS=SYMREF);
      901      979        %VLR_SYMBINFO (FPTN=VLR_SYMBINFO,STCLASS="BASED(B$PS3$)");
      902      995        /**/
      903      996        %INCLUDE MM_DATA_R;
      904     1516        %INCLUDE FM_CACHE_R;
      905     1528        %INCLUDE UMT_CNTRL_R;
      906     1537        %INCLUDE B$JIT;
      907     2140    1   DCL B$JIT$ PTR SYMREF;
      908     2141    1   DCL FT_PROT SBIN SYMREF;
      909     2142        /**/
      910     2143    1   DCL SP_INFO BIT(36) CONSTANT SYMDEF INIT('777777777777'O);
      911     2144    1   DCL B$AWORD BIT(36) BASED ALIGNED;
      912     2145    1   DCL PRIV BIT(36);
      913     2146        /**/
      914     2147    1   DCL B$PS0$ PTR SYMREF;
      915     2148    1   DCL B$PS1$ PTR SYMREF;
      916     2149    1   DCL B$PS2$ PTR SYMREF;
      917     2150    1   DCL B$PS3$ PTR SYMREF;
      918     2151    1   DCL B$PS4$ PTR SYMREF;
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:179  
      919     2152    1   DCL B$PS5$ PTR SYMREF;
      920     2153    1   DCL 1 K_HEADER SYMREF,
      921     2154    1          2 CNT UBIN BYTE UNAL,
      922     2155    1          2 TEXT CHAR(K_HEADER.CNT) UNAL;
      923     2156    1   DCL 1 HEADER BASED(B$PS5$),
      924     2157    1          2 CNT UBIN BYTE UNAL,
      925     2158    1          2 TEXT CHAR(K_HEADER.CNT) UNAL;
      926     2159        /**/
      927     2160    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      928     2161    1   DCL HFF$WRITE1 ENTRY(1) ALTRET;
      929     2162        /**/
      930     2163        %INCLUDE J_ERRSET_C;
      931     2183        %INCLUDE UD_ERRORS_C;
      932     2225        %INCLUDE UD_SEV_C;
      933     2239        %ERRCODE (NAME=ENOTAUTH,FCG#='2515'O,MID#='24'O,COD#=%E$NOTAUTH);
      934     2247        %ERRCODE (NAME=ENOTPURCHASED,FCG#='0000'O,MID#='00'O,COD#=%E$NOTPURCHASED,SEV#=
              2247            SEV_CONT#);
      935     2255        /**/
      936     2256        %EJECT;
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:180  
      937     2257    1        PRIV = B$JIT.PRIV.ACTIVE & (%PR_SPCLMM#|%PR_EXMM#);

   2257  1 000002   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000003   000004 276000 xsym               ORQ     B_VECTNIL+4
         1 000004   000000 470400 xsym               LDP0    B$JIT$
         1 000005   000013 376100                    ANQ     11,,PR0
         1 000006   200003 756100                    STQ     PRIV,,AUTO

      938     2258    1        CALL HFF$NILERASE(B$PS0$) ALTRET(NO_SITEINFO);

   2258  1 000007   000000 630400 2                  EPPR0   0
         1 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000011   000000 701000 xent               TSX1    HFF$NILERASE
         1 000012   000025 702000 1                  TSX2    NO_SITEINFO

      939     2259    1        B_SITEINFO.ANSPROT#=FT_PROT;

   2259  1 000013   000000 235000 xsym               LDA     FT_PROT
         1 000014   000063 755000 xsym               STA     B_SITEINFO+51

      940     2260    1        B_SITEINFO.TIMEZONE#=UMT_TIMEZONE;

   2260  1 000015   000000 236000 xsym               LDQ     UMT_TIMEZONE
         1 000016   000071 756000 xsym               STQ     B_SITEINFO+57

      941     2261    1        B_SITEINFO.UTC_OFFSET#=UMT_UTC_OFFSET;

   2261  1 000017   000000 235000 xsym               LDA     UMT_UTC_OFFSET
         1 000020   000072 755000 xsym               STA     B_SITEINFO+58

      942     2262    1        VLR_SITEINFO=B_SITEINFO;

   2262  1 000021   000000 470400 xsym               LDP0    B$PS0$
         1 000022   000100 100400                    MLR     fill='000'O
         1 000023   000000 000370 xsym               ADSC9   B_SITEINFO               cn=0,n=248
         1 000024   000000 000370                    ADSC9   0,,PR0                   cn=0,n=248

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:181  
   2262  1 000025                       NO_SITEINFO  null
      943     2263
      944     2264    1   NO_SITEINFO: ;
      945     2265
      946     2266    1        CALL HFF$NILERASE(B$PS1$) ALTRET(NO_MONINFO);

   2266  1 000025   000001 630400 2                  EPPR0   1
         1 000026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000027   000000 701000 xent               TSX1    HFF$NILERASE
         1 000030   000047 702000 1                  TSX2    NO_MONINFO

      947     2267    1        IF NOT PRIV THEN GOTO NOT_PRIV;

   2267  1 000031   200003 235100                    LDA     PRIV,,AUTO
         1 000032   000133 600000 1                  TZE     NOT_PRIV

      948     2268    1        B_MONINFO.ACORE# = MM_FPPC + MM_AUTO + MM_CGQD.FPPC + FMC_CACHEPGCNT;

   2268  1 000033   000000 236000 xsym               LDQ     MM_FPPC
         1 000034   000000 036000 xsym               ADLQ    MM_AUTO
         1 000035   000000 036000 xsym               ADLQ    MM_CGQD
         1 000036   000000 036000 xsym               ADLQ    FMC_CACHEPGCNT
         1 000037   000003 756000 xsym               STQ     B_MONINFO+3

      949     2269    1        B_MONINFO.PCORE#=MM_PCORE - MM_GAPSZ;

   2269  1 000040   000000 236000 xsym               LDQ     MM_PCORE
         1 000041   000000 136000 xsym               SBLQ    MM_GAPSZ
         1 000042   000004 756000 xsym               STQ     B_MONINFO+4

      950     2270    1        VLR_MONINFO=B_MONINFO;

   2270  1 000043   000000 470400 xsym               LDP0    B$PS1$
         1 000044   000100 100400                    MLR     fill='000'O
         1 000045   000000 000074 xsym               ADSC9   B_MONINFO                cn=0,n=60
         1 000046   000000 000074                    ADSC9   0,,PR0                   cn=0,n=60

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:182  
   2270  1 000047                       NO_MONINFO   null
      951     2271
      952     2272    1   NO_MONINFO: ;
      953     2273
      954     2274    1        CALL HFF$NILERASE(B$PS2$) ALTRET(NO_MONPTRS);

   2274  1 000047   000002 630400 2                  EPPR0   2
         1 000050   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000051   000000 701000 xent               TSX1    HFF$NILERASE
         1 000052   000061 702000 1                  TSX2    NO_MONPTRS

      955     2275    1        IF NOT PRIV THEN GOTO NOT_PRIV;

   2275  1 000053   200003 235100                    LDA     PRIV,,AUTO
         1 000054   000133 600000 1                  TZE     NOT_PRIV

      956     2276    1        VLR_MONPTRS=B_MONPTRS;

   2276  1 000055   000000 470400 xsym               LDP0    B$PS2$
         1 000056   000100 100400                    MLR     fill='000'O
         1 000057   000000 000064 xsym               ADSC9   B_MONPTRS                cn=0,n=52
         1 000060   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

   2276  1 000061                       NO_MONPTRS   null
      957     2277
      958     2278    1   NO_MONPTRS: ;
      959     2279
      960     2280    1        CALL HFF$NILERASE(B$PS3$) ALTRET(NO_SYMBINFO);

   2280  1 000061   000003 630400 2                  EPPR0   3
         1 000062   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000063   000000 701000 xent               TSX1    HFF$NILERASE
         1 000064   000073 702000 1                  TSX2    NO_SYMBINFO

      961     2281    1        IF NOT PRIV THEN GOTO NOT_PRIV;

   2281  1 000065   200003 235100                    LDA     PRIV,,AUTO
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:183  
         1 000066   000133 600000 1                  TZE     NOT_PRIV

      962     2282    1        VLR_SYMBINFO=FO_SYMBINFO;

   2282  1 000067   000000 470400 xsym               LDP0    B$PS3$
         1 000070   000100 100400                    MLR     fill='000'O
         1 000071   000000 000200 xsym               ADSC9   FO_SYMBINFO              cn=0,n=128
         1 000072   000000 000200                    ADSC9   0,,PR0                   cn=0,n=128

   2282  1 000073                       NO_SYMBINFO  null
      963     2283
      964     2284    1   NO_SYMBINFO: ;
      965     2285
      966     2286    1        CALL HFF$NILERASE(B$PS4$) ALTRET(NO_SPINFO);

   2286  1 000073   000004 630400 2                  EPPR0   4
         1 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000075   000000 701000 xent               TSX1    HFF$NILERASE
         1 000076   000117 702000 1                  TSX2    NO_SPINFO

      967     2287    1        IF (B$PS4$->B$AWORD & SP_INFO) ~= B$PS4$->B$AWORD

   2287  1 000077   000000 470400 xsym               LDP0    B$PS4$
         1 000100   000000 236100                    LDQ     0,,PR0
         1 000101   000000 376000 0                  ANQ     SP_INFO
         1 000102   000000 116100                    CMPQ    0,,PR0
         1 000103   000107 600000 1                  TZE     s:2294

      968     2288    1        THEN B$JIT.ERR=ENOTPURCHASED;

   2288  1 000104   000002 236000 0                  LDQ     ENOTPURCHASED
         1 000105   000000 471400 xsym               LDP1    B$JIT$
         1 000106   100012 756100                    STQ     10,,PR1

      969     2289
      970     2290        /*E*    ERROR: -E$NOTPURCHASED-0
      971     2291        MESSAGE: That separately priced software has not been purchased by your installatio
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:184  
              2291        n.
      972     2292        */
      973     2293
      974     2294    1        CALL HFF$WRITE1(B$PS4$) ALTRET(NO_SPINFO);

   2294  1 000107   000004 630400 2                  EPPR0   4
         1 000110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000111   000000 701000 xent               TSX1    HFF$WRITE1
         1 000112   000117 702000 1                  TSX2    NO_SPINFO

      975     2295    1        B$PS4$->B$AWORD = (B$PS4$->B$AWORD & SP_INFO);

   2295  1 000113   000000 470400 xsym               LDP0    B$PS4$
         1 000114   000000 236100                    LDQ     0,,PR0
         1 000115   000000 376000 0                  ANQ     SP_INFO
         1 000116   000000 756100                    STQ     0,,PR0

   2295  1 000117                       NO_SPINFO    null
      976     2296
      977     2297    1   NO_SPINFO: ;
      978     2298
      979     2299
      980     2300    2        CALL HFF$NILERASE(B$PS5$) WHENRETURN DO;

   2300  1 000117   000005 630400 2                  EPPR0   5
         1 000120   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000121   000000 701000 xent               TSX1    HFF$NILERASE
         1 000122   000132 702000 1                  TSX2    s:2304

      981     2301    2           HEADER = K_HEADER;

   2301  1 000123   000000 236000 xsym               LDQ     K_HEADER
         1 000124   000033 772000                    QRL     27
         1 000125   000001 620006                    EAX0    1,QL
         1 000126   000000 470400 xsym               LDP0    B$PS5$
         1 000127   000140 100440                    MLR     fill='000'O
         1 000130   000000 000010 xsym               ADSC9   K_HEADER                 cn=0,n=*X0
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:185  
         1 000131   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      982     2302    2           END;

      983     2303
      984     2304    1        RETURN;

   2304  1 000132   000000 702200 xent               TSX2  ! X66_ARET

   2295  1 000133                       NOT_PRIV     null
      985     2305        /**/
      986     2306    1   NOT_PRIV: ;
      987     2307    1        B$JIT.ERR=ENOTAUTH;

   2307  1 000133   000001 236000 0                  LDQ     ENOTAUTH
         1 000134   000000 470400 xsym               LDP0    B$JIT$
         1 000135   000012 756100                    STQ     10,,PR0

      988     2308        /*E*    ERROR:      UMT-E$NOTAUTH
      989     2309                MESSAGE:    Insufficient privilege for this PMME.
      990     2310        */
      991     2311    1        RETURN;

   2311  1 000136   000000 702200 xent               TSX2  ! X66_ARET

SP_INFO
 Sect OctLoc
   0     000   777777 777777                                                    ....

ENOTAUTH
 Sect OctLoc
   0     001   251524 406254                                                    ....

ENOTPURCHASED
 Sect OctLoc
   0     002   000000 407010                                                    ....

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:186  
(unnamed)
 Sect OctLoc
   2     000   000000 006000   000000 006000   000000 006000   000000 006000    ................
   2     004   000000 006000   000000 006000                                    ........
      992     2312    1   END UMT$MONINFO;

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:187  
--  Include file information  --

   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   J_ERRSET_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   UMT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FM_CACHE_R.:E05TOU  cannot be made into a system file and is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UM_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure UMT$MONINFO.
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:188  

 **** Variables and constants ****

  ****  Section 000 RoData UMT$MONINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 ENOTAUTH                   2-0-0/b STRC        r     1 ENOTPURCHASED
     0-0-0/b BIT         r     1 SP_INFO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 PRIV

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 B$PS4$
     0-0-0/w PTR         r     1 B$PS5$                     0-0-0/d STRC(540)   r     1 B_MONINFO
     0-0-0/d STRC(468)   r     1 B_MONPTRS                  0-0-0/d STRC(2232)  r     1 B_SITEINFO
     0-0-0/w SBIN        r     1 FMC_CACHEPGCNT             0-0-0/w PTR         r     1 FMC_CACHEPGCNT$
     0-0-0/w STRC(1152)  r     1 FO_SYMBINFO                0-0-0/w SBIN        r     1 FT_PROT
     0-0-0/c ASTR(9)     r     1 K_HEADER                   0-0-0/w SBIN        r     1 MM_AUTO
     0-0-0/w PTR         r     1 MM_BYP$                    0-0-0/w STRC(288)   r     1 MM_CGQD
     0-0-0/w SBIN        r     1 MM_FPPC                    0-0-0/w SBIN        r     1 MM_GAPSZ
     0-0-0/w SBIN        r     1 MM_PCORE                   0-0-0/c CHAR(4)     r     1 UMT_TIMEZONE
     0-0-0/w SBIN        r     1 UMT_UTC_OFFSET

  ****  BASED and DCB variables  ****

PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:189  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 B$AWORD                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/c ASTR(9)     r     1 HEADER                     0-0-0/d STRC(540)   r     1 VLR_MONINFO
     0-0-0/d STRC(468)   r     1 VLR_MONPTRS                0-0-0/d STRC(2232)  r     1 VLR_SITEINFO
     0-0-0/w STRC(1152)  r     1 VLR_SYMBINFO


   Procedure UMT$MONINFO requires 95 words for executable code.
   Procedure UMT$MONINFO requires 4 words of local(AUTO) storage.

    No errors detected in file UMT$TIME.:E05TSI    .
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:190  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:191  
          MINI XREF LISTING

B$AWORD
      2144**DCL      2287>>IF       2287>>IF       2295<<ASSIGN   2295>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      1958**DCL      1958--REDEF
B$JIT.ERR
      1864**DCL      2288<<ASSIGN   2307<<ASSIGN
B$JIT.ERR.MID
      1865**DCL      1865--REDEF
B$JIT.JRESPEAK
      2026**DCL      2027--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2135**DCL      2135--REDEF    2136--REDEF
B$JIT.PNR
      2039**DCL      2039--REDEF
B$JIT.PRIV.ACTIVE
      1865**DCL      2257>>ASSIGN
B$JIT.TSLINE
      2133**DCL      2134--REDEF
B$JIT$
      2140**DCL      1859--IMP-PTR  2257>>ASSIGN   2288>>ASSIGN   2307>>ASSIGN
B$PS0$
      2147**DCL       889--IMP-PTR  2258<>CALL     2262>>ASSIGN
B$PS1$
      2148**DCL       926--IMP-PTR  2266<>CALL     2270>>ASSIGN
B$PS2$
      2149**DCL       959--IMP-PTR  2274<>CALL     2276>>ASSIGN
B$PS3$
      2150**DCL       990--IMP-PTR  2280<>CALL     2282>>ASSIGN
B$PS4$
      2151**DCL      2286<>CALL     2287>>IF       2287>>IF       2294<>CALL     2295>>ASSIGN   2295>>ASSIGN
B$PS5$
      2152**DCL      2156--IMP-PTR  2300<>CALL     2301>>ASSIGN
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:192  
B_MONINFO
       908**DCL      2270>>ASSIGN
B_MONINFO.ACORE#
       909**DCL      2268<<ASSIGN
B_MONINFO.PCORE#
       909**DCL      2269<<ASSIGN
B_MONPTRS
       944**DCL      2276>>ASSIGN
B_SITEINFO
       870**DCL      2262>>ASSIGN
B_SITEINFO.ANSPROT#
       872**DCL      2259<<ASSIGN
B_SITEINFO.TIMEZONE#
       875**DCL      2260<<ASSIGN
B_SITEINFO.UTC_OFFSET#
       876**DCL      2261<<ASSIGN
ENOTAUTH
      2240**DCL      2307>>ASSIGN
ENOTPURCHASED
      2248**DCL      2288>>ASSIGN
FMC_CACHEPGCNT
      1525**DCL      2268>>ASSIGN
FMC_CACHEPGCNT$
      1525**DCL      1525--IMP-PTR  1525--REDEF
FO_SYMBINFO
       974**DCL      2282>>ASSIGN
FT_PROT
      2141**DCL      2259>>ASSIGN
HEADER
      2156**DCL      2301<<ASSIGN
HFF$NILERASE
      2160**DCL-ENT  2258--CALL     2266--CALL     2274--CALL     2280--CALL     2286--CALL     2300--CALL
HFF$WRITE1
      2161**DCL-ENT  2294--CALL
K_HEADER
      2153**DCL      2301>>ASSIGN
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:193  
K_HEADER.CNT
      2154**DCL      2155--IMP-SIZ  2158--IMP-SIZ  2301>>ASSIGN   2301>>ASSIGN
MM$DESC.BOUND
      1467**DCL      1468--REDEF
MM$DESC.FLGS
      1468**DCL      1468--REDEF
MM$PPUT.USER#
      1456**DCL      1456--REDEF
MM_AUTO
      1386**DCL      2268>>ASSIGN
MM_BYP$
      1387**DCL      1387--IMP-PTR
MM_CGQD.FPPC
      1409**DCL      2268>>ASSIGN
MM_FPPC
      1384**DCL      2268>>ASSIGN
MM_GAPSZ
      1389**DCL      2269>>ASSIGN
MM_PCORE
      1389**DCL      2269>>ASSIGN
NOT_PRIV
      2295**LABEL    2267--GOTO     2275--GOTO     2281--GOTO
NO_MONINFO
      2270**LABEL    2266--CALLALT
NO_MONPTRS
      2276**LABEL    2274--CALLALT
NO_SITEINFO
      2262**LABEL    2258--CALLALT
NO_SPINFO
      2295**LABEL    2286--CALLALT  2294--CALLALT
NO_SYMBINFO
      2282**LABEL    2280--CALLALT
PRIV
      2145**DCL      2257<<ASSIGN   2267>>IF       2275>>IF       2281>>IF
SP_INFO
      2143**DCL      2287>>IF       2295>>ASSIGN
PL6.E3A0      #003=UMT$MONINFO File=UMT$TIME.:E05TSI                             WED 07/30/97 07:02 Page:194  
UMT_TIMEZONE
      1536**DCL      2260>>ASSIGN
UMT_UTC_OFFSET
      1536**DCL      2261>>ASSIGN
VLR_MONINFO
       926**DCL      2270<<ASSIGN
VLR_MONPTRS
       959**DCL      2276<<ASSIGN
VLR_SITEINFO
       889**DCL      2262<<ASSIGN
VLR_SYMBINFO
       990**DCL      2282<<ASSIGN
