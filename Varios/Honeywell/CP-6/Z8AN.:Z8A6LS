VERSION A06

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:1    
        1        1        /*M* Z8AN$NEW_ILL -- Create an ILL item and associated items. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*    NAME: Z8AN$NEW_ILL
       10       10
       11       11             PURPOSE: Reserve an ILL item on the ILL table.
       12       12        */
       13       13
       14       14        /*D*    NAME: Z8AN$NEW_ILL
       15       15
       16       16                CALL: CALL Z8AN$NEW_ILL (Redefinition-code, id, ill-ptr,
       17       17                                         ils-list-ptr) ;
       18       18
       19       19           INTERFACE: Uses %RESERVE_ILL macro which could call Z8AR.
       20       20
       21       21               INPUT: REDEF_CODE -- (arg#1) -- redefinition code:
       22       22                                               %NO_REDEF, %ONE_REDEF,
       23       23                                               %TWO_REDEFS, or %LABEL_REDEF.
       24       24                      ID -- (arg#2) -- ILL ID (eg, %MVII, %DISPL, etc.).
       25       25                      LIST$ -- (arg#4) -- Ptr to an ILS_LIST.
       26       26                      REDEF1$ -- [arg#5] -- ILL field that is redefined.
       27       27                      REDEF2$ -- [arg#6] -- ILL field that is redefined.
       28       28
       29       29              OUTPUT: P_ILL$ -- (arg#3) -- Returned ptr to the item created.
       30       30                      LIST$ -- (arg#4) -- Ptr to an ILS_LIST.
       31       31
       32       32           DESCRIPTION: This routine creates ILL/ILS items as follows:
       33       33                    (1) Creates a LINOI ILL item and an associated OPN
       34       34                        item if necessary.
       35       35                    (2) Creates the ILL item requested (ID).
       36       36                    (3) Creates the associated ILS item (OPN, OPV, or OPA).
       37       37                    (4) Fills in all ILS fields.
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:2    
       38       38
       39       39        */
       40       40        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:3    
       41       41
       42       42        Z8AN$NEW_ILL2: PROC (REDEF_CODE, ID, P_ILL$, LIST$, REDEF1$, REDEF2$) ;
       43       43
       44       44        %EQU PHASE = 0 ;
       45       45        %EQU UPPER_DPI_LIMIT = 40 ;
       46       46        %EQU LOWER_DPI_LIMIT = 4 ;
       47       47
       48       48        %INCLUDE Z8A_DEFC ;
       49      116        %INCLUDE Z8A_SUPP_MAC ;
       50     2516        %INCLUDE Z8A_ILS ;
       51     2625        %INCLUDE Z8A_DPI ;
       52     2709        %INCLUDE Z8A_ILL ;
       53     3402        %INCLUDE Z8A_ST ;
       54     7061        %INCLUDE Z8A_QLT;
       55     7167        %INCLUDE Z8A_ETT ;
       56     7468        %INCLUDE Z8E_STACKS ;
       57     9734        %INCLUDE Z8E_NEW_ILL ;
       58     9748        %INCLUDE Z8E_ILS_LIST ;
       59     9832        %INCLUDE Z8E_O1COM ;
       60    10593        %INCLUDE Z8A_COMCOM ;
       61    11243
       62    11244    1   DCL REDEF_CODE   UBIN WORD ;
       63    11245    1   DCL ID           UBIN WORD ;
       64    11246    1   DCL LIMIT        UBIN WORD ;
       65    11247    1   DCL P_ILL$       PTR ;
       66    11248    1   DCL LIST$        PTR ;
       67    11249    1   DCL REDEF1$      PTR ;
       68    11250    1   DCL REDEF2$      PTR ;
       69    11251    1   DCL NEW_LINE     BOOLEAN ;
       70    11252    1   DCL LAST_LINE    SBIN STATIC INIT (0) ;
       71    11253    1   DCL HEAD_DPI$    PTR ;
       72    11254    1   DCL TAIL_DPI$    PTR ;
       73    11255    1   DCL DUMMY$       PTR ;
       74    11256    1   DCL ST1$         PTR ;
       75    11257    1   DCL ST2$         PTR ;
       76    11258    1   DCL Z8AR$RESERVER ENTRY (1) ;
       77    11259    1   DCL Z8AN$ADD_DPIS_FOR_STRUCTURE ENTRY (2) ALTRET;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:4    
       78    11260
       79    11261        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:5    
       80    11262    1          GOTO START ;
       81    11263
       82    11264    1   Z8AN$NEW_ILL1: ENTRY (REDEF_CODE, ID, P_ILL$, LIST$, REDEF1$) ;
       83    11265
       84    11266    1          GOTO START ;
       85    11267
       86    11268    1   Z8AN$NEW_ILL: ENTRY (REDEF_CODE, ID, P_ILL$, LIST$) ;
       87    11269
       88    11270    1   START:
       89    11271
       90    11272    2          IF REDEF_CODE = %NO_REDEF THEN DO ;
       91    11273    2            IF LIST$ -> ILS_LIST.HEAD$ = ADDR (NIL)
       92    11274    2            OR O1COM.LINE_NO ~= LAST_LINE
       93    11275    2            OR O1COM.STATEMENT_TYPE ~= %NO_STATEMENT_TYPE
       94    11276    2            THEN NEW_LINE = TRUE ;
       95    11277    2            ELSE NEW_LINE = FALSE ;
       96    11278    2          END ;
       97    11279
       98    11280    2          ELSE DO ; /* REDEF_CODE <> %NO_REDEF */
       99    11281    3            IF LIST$ -> ILS_LIST.TAIL$ ~= ADDR(NIL) THEN DO ;
      100    11282    3              ILL$ = LIST$ -> ILS_LIST.TAIL$ -> ILS.ILL$ ;
      101    11283    4              IF ILL$ -> ILL.ID = %LINOI THEN DO ;
      102    11284    4                IF  ILL$ -> LINOI.LINE_NO = O1COM.LINE_NO
      103    11285    4                AND O1COM.STATEMENT_TYPE = %NO_STATEMENT_TYPE
      104    11286    4                THEN NEW_LINE = FALSE ;
      105    11287    4                ELSE NEW_LINE = TRUE ;
      106    11288    4              END ;
      107    11289    3              ELSE NEW_LINE = TRUE ;
      108    11290    3            END ;
      109    11291    2            ELSE NEW_LINE = TRUE ;
      110    11292    2          END ;
      111    11293
      112    11294    1          IF NEW_LINE
      113    11295    1          OR ID = %LINOI
      114    11296    2          OR ID = %END THEN DO ;
      115    11297
      116    11298                 /* Reserve the LINOI item and associated OPN */
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:6    
      117    11299
      118    11300                 %RESERVE_ILL (ITEM = %LINOI, POINTER = ILL$) ;
      119    11310    2            ILL$->LINOI.LINE_NO = O1COM.LINE_NO ;
      120    11311    2            ILL$->LINOI.COLUMN_NO = O1COM.COLUMN_NO ;
      121    11312    2            ILL$->LINOI.TYPE = O1COM.STATEMENT_TYPE ;
      122    11313
      123    11314    2            LAST_LINE = O1COM.LINE_NO ;
      124    11315
      125    11316                 %RESERVE_ILS (ITEM = %OPN, POINTER = ILS$) ;
      126    11345    2            ILS$->ILS.ILL$ = ILL$ ;
      127    11346
      128    11347                 %ADD_ILS_TO_LIST_TAIL (@LIST$ = LIST$, @ILS$ = ILS$) ;
      129    11361
      130    11362    2          END ;
      131    11363
      132    11364    2          IF ID ~= %LINOI THEN DO ;
      133    11365
      134    11366    3            DO CASE (REDEF_CODE) ;
      135    11367
      136    11368    3              CASE (%NO_REDEF, %LABEL_REDEF) ;
      137    11369
      138    11370                     %RESERVE_ILS (ITEM = %OPN, POINTER = ILS$) ;
      139    11399
      140    11400    3              CASE (%ONE_REDEF) ;
      141    11401
      142    11402                     %FISH (TRIAD = REDEF1$, RTN = ST1$) ;
      143    11410
      144    11411    3                IF ST1$ -> VARIABLE.B.ELEMENTARY
      145    11412    3                   AND (ST1$ -> VARIABLE.QLT$ -> QLT.FATHER = ADDR(NIL))
      146    11413    3                   AND NOT ST1$ -> VARIABLE.B.REDEF_SUB
      147    11414    3                   AND NOT ST1$ -> VARIABLE.B.REDEF_OBJ
      148    11415    3                  AND NOT ST1$ -> VARIABLE.B.LINKAGE THEN
      149    11416    4                DO;
      150    11417
      151    11418    4                  IF ST1$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND
      152    11419    4                      ST1$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
      153    11420    4                    ST1$ -> VARIABLE.LTS$ = ADDR(NIL);
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:7    
      154    11421    4                  IF NOT ST1$ -> VARIABLE.B.RENAMED
      155    11422    4                     AND NOT ST1$ -> VARIABLE.QLT$ -> QLT.B.RENAMES THEN
      156    11423    5                    DO;
      157    11424                           %RESERVE_ILS (ITEM = %OPV, POINTER = ILS$) ;
      158    11453    5                      ILS$->ILS.DNAME = REDEF1$ ;
      159    11454    5                    END;
      160    11455    4                  ELSE
      161    11456    5                    DO;
      162    11457                           %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$);
      163    11486    5                      ILS$ -> ILS.B.CDEF = '1'B;
      164    11487    5                    END;
      165    11488
      166    11489    4                END ; /* Elementary */
      167    11490
      168    11491    4                ELSE DO ; /* Build DPI chain for GROUP moves or redefs */
      169    11492
      170    11493                       %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;
      171    11522    4                  CALL BUILD_DPI_CHAIN( ST1$, HEAD_DPI$, TAIL_DPI$)
      172    11523    4                    WHENALTRETURN
      173    11524    5                      DO;
      174    11525    5                        HEAD_DPI$ = ADDR(NIL);
      175    11526    5                        ILS$ -> ILS.B.CDEF = '1'B;
      176    11527    5                      END;
      177    11528    4                  ILS$ -> ILS.DEF = HEAD_DPI$;
      178    11529
      179    11530    4                END ; /* Non-Elementary */
      180    11531
      181    11532    3              CASE (%TWO_REDEFS) ;
      182    11533
      183    11534                     %FISH (TRIAD = REDEF1$, RTN = ST1$) ;
      184    11542                     %FISH (TRIAD = REDEF2$, RTN = ST2$) ;
      185    11550
      186    11551
      187    11552
      188    11553                     %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;
      189    11582
      190    11583    3                CALL BUILD_DPI_CHAIN(ST1$, HEAD_DPI$, TAIL_DPI$)
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:8    
      191    11584    3                  WHENRETURN
      192    11585    4                    DO;
      193    11586    4                      CALL BUILD_DPI_CHAIN(ST2$, TAIL_DPI$ -> DPI.NEXT,
      194    11587    4                                            DUMMY$)
      195    11588    4                      WHENALTRETURN
      196    11589    5                        DO;
      197    11590    5                          ILS$ -> ILS.B.CDEF = '1'B;
      198    11591    5                          HEAD_DPI$ = ADDR(NIL);
      199    11592    5                        END;
      200    11593    4                    END;
      201    11594
      202    11595    3                  WHENALTRETURN
      203    11596    4                    DO;
      204    11597    4                      ILS$ -> ILS.B.CDEF = '1'B;
      205    11598    4                      HEAD_DPI$ = ADDR(NIL);
      206    11599    4                    END;
      207    11600
      208    11601    3                ILS$ -> ILS.DEF = HEAD_DPI$;
      209    11602
      210    11603    3              CASE (%PFORM_OR_CALL) ;
      211    11604
      212    11605                     %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;
      213    11634    3                ILS$->ILS.DEF = ADDR(NIL) ;
      214    11635    3                ILS$->ILS.B.CDEF = '1'B ;
      215    11636
      216    11637    3            END /* Case of REDEF_CODE */ ;
      217    11638
      218    11639                 %RESERVE_ILL (ITEM = ID, POINTER = P_ILL$) ;
      219    11649
      220    11650    2            ILS$->ILS.ILL$ = P_ILL$ ;
      221    11651
      222    11652                 %ADD_ILS_TO_LIST_TAIL (@LIST$ = LIST$, @ILS$ = ILS$) ;
      223    11666
      224    11667    2          END ; /* If ID <> Linoi */
      225    11668
      226    11669    1          O1COM.STATEMENT_TYPE = %NO_STATEMENT_TYPE ;
      227    11670
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:9    
      228    11671    1          IF REDEF_CODE ~= %NO_REDEF
      229    11672    1          THEN LAST_LINE = 0 ; /* Forces new LINOI after Redef. */
      230    11673
      231    11674    1          RETURN ;
      232    11675
      233    11676        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:10   
      234    11677    1   BUILD_DPI_CHAIN : PROC(ST$$, HEAD_DPI$, TAIL_DPI$) ALTRET;
      235    11678        /*I*
      236    11679             NAME: BUILD_DPI_CHAIN
      237    11680             PURPOSE:
      238    11681                  Given an ST item, build a chain of DPI items.  Each DPI
      239    11682                  item will point to an ST item that may be redefined when
      240    11683                  the item pointed to by ST$$ is redefined.
      241    11684             CALL:
      242    11685                  CALL BUILD_DPI_CHAIN (ST$$, HEAD_DPI$, TAIL_DPI$);
      243    11686             PARAMETERS:
      244    11687                  ST$$ - item that is explicitly redefined.
      245    11688                  HEAD_DPI$ - Pointer to head of created DPI chain.
      246    11689                  TAIL_DPI$ - Pointer to tail of created DPI chain.
      247    11690             DATA:
      248    11691                  ST table, QLT table.
      249    11692             DESCRIPTION:
      250    11693                  Create a chain of DPI items, each of which point
      251    11694                  to an item that may be redefined if ST$$ -> ST is
      252    11695                  redefined.  To do this walk the QLT.  All fathers
      253    11696                  may be redefined, and everything below the item
      254    11697                  in the structure may be redefined.
      255    11698
      256    11699                  If all the items that might possibly be
      257    11700                  changed when ST$$ is changed can't be
      258    11701                  determined then altreturn.
      259    11702        */
      260    11703
      261    11704    2   DCL ST$$ PTR;  /* Input - ST item that is explicitly redefined */
      262    11705    2   DCL HEAD_DPI$ PTR; /* Output - Head of DPI chain created */
      263    11706    2   DCL TAIL_DPI$ PTR; /* Output - Tail of DPI chain created */
      264    11707
      265    11708
      266    11709    2   DCL DPI$$ PTR;
      267    11710    2   DCL P$ PTR;
      268    11711    2   DCL QLT$$ PTR;
      269    11712    2   DCL REDEF_OBJ$ PTR;
      270    11713
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:11   
      271    11714
      272    11715
      273    11716    2       IF ST$$ -> VARIABLE.B.RENAMED
      274    11717    2          OR ST$$ -> VARIABLE.QLT$ -> QLT.B.RENAMES
      275    11718    2          OR ST$$ -> VARIABLE.B.LINKAGE
      276    11719    2          OR (ST$$ -> VARIABLE.B.EXTERNAL
      277    11720    2              AND ST$$ -> VARIABLE.PROC$ -> PROC_.PROC_DEF$ ->
      278    11721    2                  PROC_DEF.ARGLIST$ ~= ADDR(NIL))
      279    11722    2          OR (ST$$ -> VARIABLE.B.GLOBAL AND
      280    11723    2              ST$$ -> VARIABLE.PROC$ -> PROC_.PROC_DEF$ ->
      281    11724    2                  PROC_DEF.ARGLIST$ ~= ADDR(NIL) AND
      282    11725    2              ST$$ -> VARIABLE.PROC$ -> PROC_.FATHER ~= ADDR(NIL)) THEN
      283    11726    2         ALTRETURN;
      284    11727
      285    11728
      286    11729            /* If this is a group item and redefined, then give up */
      287    11730
      288    11731    2       IF   ST$$ -> VARIABLE.B.ELEMENTARY = FALSE
      289    11732    2       AND (ST$$ -> SCALAR.B.REDEF_SUB
      290    11733    2         OR ST$$ -> SCALAR.B.REDEF_OBJ) THEN
      291    11734    2         ALTRETURN ;
      292    11735
      293    11736            /* In order to control the number of DPI items generated,
      294    11737               we set an arbitrary limit on the DPI table size (in KW).
      295    11738            */
      296    11739
      297    11740    2       IF COMCOM.OB.OPTZ
      298    11741    2       THEN LIMIT = %UPPER_DPI_LIMIT ;
      299    11742    2       ELSE LIMIT = %LOWER_DPI_LIMIT ;
      300    11743
      301    11744    3       IF DPI_.SIZE > LIMIT THEN DO ;
      302    11745
      303    11746    3         IF ST$$ -> VARIABLE.B.ELEMENTARY = FALSE OR
      304    11747    3             ST$$ -> VARIABLE.B.REDEF_SUB OR
      305    11748    3             ST$$ -> VARIABLE.B.REDEF_OBJ THEN
      306    11749    3           ALTRETURN ;
      307    11750
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:12   
      308    11751    3       END ; /* DPI size > Limit */
      309    11752
      310    11753                /* Scan up the fathers and check for redefines objects
      311    11754                   and subjects.  If any are found, then give up: ALTRET.
      312    11755                   Things get too complex otherwise.
      313    11756                 */
      314    11757    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;
      315    11758    3       DO WHILE QLT$$ ~= ADDR(NIL);
      316    11759    3         IF QLT$$ -> QLT.ST$ -> SCALAR.B.REDEF_SUB
      317    11760    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.REDEF_OBJ
      318    11761    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.RENAMED
      319    11762    3            OR QLT$$ -> QLT.B.RENAMES
      320    11763    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.LINKAGE
      321    11764    3            OR (QLT$$ -> QLT.ST$ -> SCALAR.B.EXTERNAL AND
      322    11765    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.PROC_DEF$ ->
      323    11766    3                    PROC_DEF.ARGLIST$ ~= ADDR(NIL))
      324    11767    3            OR (QLT$$ -> QLT.ST$ -> SCALAR.B.GLOBAL AND
      325    11768    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.PROC_DEF$ ->
      326    11769    3                    PROC_DEF.ARGLIST$ ~= ADDR(NIL) AND
      327    11770    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.FATHER
      328    11771    3                      ~= ADDR(NIL) ) THEN
      329    11772    3           ALTRETURN;
      330    11773
      331    11774    3         QLT$$ = QLT$$ -> QLT.FATHER;
      332    11775    3       END;
      333    11776
      334    11777    2       IF ST$$ -> VARIABLE.B.REDEF_SUB THEN
      335    11778    3         DO;
      336    11779    3           CALL SEARCH_FOR_REDEF_OBJ(ST$$, REDEF_OBJ$)
      337    11780    3             WHENALTRETURN
      338    11781    4               DO;
      339    11782    4                 ALTRETURN;
      340    11783    4               END;
      341    11784    3           ST$$ = REDEF_OBJ$;
      342    11785    3         END;
      343    11786
      344    11787            %BUILD_DPI(@DPI$=DPI$$,
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:13   
      345    11788                       @DNAME=ST$$);
      346    11807
      347    11808    2       HEAD_DPI$ = DPI$$;
      348    11809
      349    11810    2       IF ST$$ -> VARIABLE.B.REDEF_OBJ THEN
      350    11811    3         DO;
      351    11812    3           QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.BROTHER;
      352    11813
      353    11814    4           DO WHILE (QLT$$ ~= ADDR(NIL))
      354    11815    4                    AND (QLT$$ -> QLT.ST$ -> VARIABLE.B.REDEF_SUB
      355    11816    4                         OR QLT$$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED);
      356    11817                                 /* Last clause needed in case of variables created
      357    11818                                    by syntax error recovery. */
      358    11819    4             IF NOT QLT$$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED THEN
      359    11820    5               DO;
      360    11821                      %BUILD_DPI(@DPI$="DPI$$->DPI.NEXT",              /*#39440*/
      361    11822                                 @DNAME="QLT$$->QLT.ST$");
      362    11841    5                 DPI$$ = DPI$$ -> DPI.NEXT;
      363    11842    5                 IF QLT$$ -> QLT.SON ~= ADDR(NIL) THEN
      364    11843    5                  CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(QLT$$ -> QLT.SON, DPI$$)
      365    11844    5                   WHENALTRETURN
      366    11845    6                     DO;
      367    11846    6                       ALTRETURN;
      368    11847    6                     END;
      369    11848    5               END;
      370    11849    4             QLT$$ = QLT$$ -> QLT.BROTHER;
      371    11850    4           END;
      372    11851    3         END;
      373    11852
      374    11853
      375    11854
      376    11855
      377    11856                  /* Walk up father chain of ST$$ and build a chain of
      378    11857                     DPIs for implicit redefinition of containing groups.
      379    11858                  */
      380    11859    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;
      381    11860    3       DO WHILE QLT$$ ~= ADDR(NIL);
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:14   
      382    11861    3         IF (QLT$$ -> QLT.ST$ -> VARIABLE.ADSC.N < 17
      383    11862    3         AND QLT$$ -> QLT.ST$ -> VARIABLE.B.LENGTH_4096 = '0'B)
      384    11863    4         OR  QLT$$ -> QLT.ST$ -> VARIABLE.ID ~= %SCALAR THEN DO;
      385    11864    4           P$ = DPI$$;
      386    11865                %BUILD_DPI (@DPI$=DPI$$,
      387    11866                            @DNAME="QLT$$->QLT.ST$");
      388    11885    4           P$ -> DPI.NEXT = DPI$$;
      389    11886    4         END; /* Exclude group items greater than 16 bytes */
      390    11887    3         QLT$$ = QLT$$ -> QLT.FATHER;
      391    11888    3       END;
      392    11889
      393    11890
      394    11891    2       IF ST$$ -> VARIABLE.B.ELEMENTARY = '0'B THEN
      395    11892    2         CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(ST$$ -> VARIABLE.QLT$ ->
      396    11893    2                                            QLT.SON,
      397    11894    2                                          DPI$$)
      398    11895    2           WHENALTRETURN
      399    11896    3             DO;
      400    11897    3               DPI$$ = ADDR(NIL);
      401    11898    3               ALTRETURN;
      402    11899    3             END;
      403    11900    2       ELSE IF ST$$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND
      404    11901    2           ST$$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
      405    11902    2         ST$$ -> VARIABLE.LTS$ = ADDR(NIL);
      406    11903    2       TAIL_DPI$ = DPI$$;
      407    11904    2   END BUILD_DPI_CHAIN;
      408    11905        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:15   
      409    11906    1   SEARCH_FOR_REDEF_OBJ : PROC(ST$$, REDEF_OBJ$) ALTRET;
      410    11907        /*I*
      411    11908             NAME: SEARCH_FOR_REDEF_OBJ
      412    11909             PURPOSE:
      413    11910                  Given a pointer to an ST item that is a redefines subject,
      414    11911                  find the ST item that it redefines.
      415    11912             PARAMETERS:
      416    11913                  ST$$ - Input: Points at ST item that is redefines subject.
      417    11914                  REDEF_OBJ$ - Points at ST item that is redefines object
      418    11915                               of ST$$.
      419    11916             DESCRIPTION:
      420    11917                  Walk up QLT to father of ST$$, then walk down to its son.
      421    11918                  Look through all the sons, for redef objects.  When a
      422    11919                  redef object is found, look through its brothers for ST$$.
      423    11920                  If the structure is too complex, or ST$$ is not found then
      424    11921                  altreturn.
      425    11922        */
      426    11923
      427    11924    2   DCL ST$$ PTR;
      428    11925    2   DCL REDEF_OBJ$ PTR;
      429    11926    2   DCL QLT$$ PTR;
      430    11927    2   DCL SON$ PTR;
      431    11928    2   DCL FOUND BIT(1);
      432    11929
      433    11930    2   DCL Z8AE$ERROR ENTRY(12);
      434    11931        %INCLUDE Z8A_ERR_NUMS;
      435    12695
      436    12696    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;
      437    12697
      438    12698            /*N*  If we are looking at an 01 level guy, we'll search
      439    12699                  the whole QLT.  This may be too expensive and may
      440    12700                  need to be narrowed down.  We may need to give up and
      441    12701                  declare a common redefinition.
      442    12702            */
      443    12703    2       IF QLT$$ = ADDR(NIL) THEN
      444    12704              %TOP_QLT(POINTER=SON$);
      445    12709    2       ELSE
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:16   
      446    12710    2         SON$ = QLT$$ -> QLT.SON;
      447    12711
      448    12712    2       FOUND = FALSE;
      449    12713
      450    12714    3       DO WHILE (SON$ ~= ADDR(NIL))
      451    12715    3                AND NOT FOUND;
      452    12716    3         IF SON$ -> QLT.ST$ -> VARIABLE.B.REDEF_OBJ THEN
      453    12717    4           DO;
      454    12718    4             REDEF_OBJ$ = SON$ -> QLT.ST$;
      455    12719    4             SON$ = SON$ -> QLT.BROTHER;
      456    12720
      457    12721    5             DO WHILE (SON$ ~= ADDR(NIL))
      458    12722    5                      AND (SON$ -> QLT.ST$ -> VARIABLE.B.REDEF_SUB
      459    12723    5                           OR SON$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED)
      460    12724    5                      AND NOT FOUND;
      461    12725    5               IF SON$ -> QLT.ST$ = ST$$ THEN
      462    12726    5                 FOUND = TRUE;
      463    12727    5               ELSE
      464    12728    5                 SON$ = SON$ -> QLT.BROTHER;
      465    12729    5             END;
      466    12730    4           END;
      467    12731    3         ELSE
      468    12732    3           SON$ = SON$ -> QLT.BROTHER;
      469    12733
      470    12734    3       END; /* WHILE */
      471    12735
      472    12736
      473    12737    2       IF NOT FOUND THEN
      474    12738    3         DO;
      475    12739    3           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
      476    12740    3           ALTRETURN;
      477    12741    3         END;
      478    12742
      479    12743    2   END SEARCH_FOR_REDEF_OBJ;
      480    12744    1   END Z8AN$NEW_ILL2 ;
      481    12745        %EOD;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:17   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8AN$NEW_ILL2.

   Procedure Z8AN$NEW_ILL2 requires 877 words for executable code.
   Procedure Z8AN$NEW_ILL2 requires 32 words of local(AUTO) storage.

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:18   

 Object Unit name= Z8AN$NEW_ILL2                              File name= Z8AN.:Z8A6TOU
 UTS= AUG 09 '97 10:45:44.44 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILS$
    2  LblCom even  none     5      5  ILS_
    3  LblCom even  none     1      1  DPI$
    4  LblCom even  none     5      5  DPI_
    5  LblCom even  none     1      1  ILL$
    6  LblCom even  none     5      5  ILL_
    7  LblCom even  none     1      1  ST$
    8  LblCom even  none     5      5  ST_
    9  LblCom even  none     1      1  QLT$
   10  LblCom even  none     1      1  PREV_01_QLT$
   11  LblCom even  none     5      5  QLT_
   12  LblCom even  none     1      1  ETT$
   13  LblCom even  none     1      1  HEAD_ETT$
   14  LblCom even  none   512   1000  ETT_BUCKETS
   15  LblCom even  none     5      5  ETT_
   16  LblCom even  none    90    132  LEX_SYMBOL
   17  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   18  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   19  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   20   Data  even  none     1      1  Z8AN$NEW_ILL2
   21   Proc  even  none   877   1555  Z8AN$NEW_ILL2
   22  RoData even  none     8     10  Z8AN$NEW_ILL2
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:19   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        6  Z8AN$NEW_ILL2
    21      3                  yes      Std        5  Z8AN$NEW_ILL1
    21      6                  yes      Std        4  Z8AN$NEW_ILL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
 yes     yes           Std       2 Z8AN$ADD_DPIS_FOR_STRUCTURE
         yes           Std      12 Z8AE$ERROR
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILS_STEP_TABLE                   r    ILL_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK                               COMCOM

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:20   


        1        1        /*M* Z8AN$NEW_ILL -- Create an ILL item and associated items. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*P*    NAME: Z8AN$NEW_ILL
       10       10
       11       11             PURPOSE: Reserve an ILL item on the ILL table.
       12       12        */
       13       13
       14       14        /*D*    NAME: Z8AN$NEW_ILL
       15       15
       16       16                CALL: CALL Z8AN$NEW_ILL (Redefinition-code, id, ill-ptr,
       17       17                                         ils-list-ptr) ;
       18       18
       19       19           INTERFACE: Uses %RESERVE_ILL macro which could call Z8AR.
       20       20
       21       21               INPUT: REDEF_CODE -- (arg#1) -- redefinition code:
       22       22                                               %NO_REDEF, %ONE_REDEF,
       23       23                                               %TWO_REDEFS, or %LABEL_REDEF.
       24       24                      ID -- (arg#2) -- ILL ID (eg, %MVII, %DISPL, etc.).
       25       25                      LIST$ -- (arg#4) -- Ptr to an ILS_LIST.
       26       26                      REDEF1$ -- [arg#5] -- ILL field that is redefined.
       27       27                      REDEF2$ -- [arg#6] -- ILL field that is redefined.
       28       28
       29       29              OUTPUT: P_ILL$ -- (arg#3) -- Returned ptr to the item created.
       30       30                      LIST$ -- (arg#4) -- Ptr to an ILS_LIST.
       31       31
       32       32           DESCRIPTION: This routine creates ILL/ILS items as follows:
       33       33                    (1) Creates a LINOI ILL item and an associated OPN
       34       34                        item if necessary.
       35       35                    (2) Creates the ILL item requested (ID).
       36       36                    (3) Creates the associated ILS item (OPN, OPV, or OPA).
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:21   
       37       37                    (4) Fills in all ILS fields.
       38       38
       39       39        */
       40       40        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:22   
       41       41
       42       42        Z8AN$NEW_ILL2: PROC (REDEF_CODE, ID, P_ILL$, LIST$, REDEF1$, REDEF2$) ;

     42 21 000000   000000 700200 xent  Z8AN$NEW_IL* TSX0  ! X66_AUTO_N
        21 000001   000040 000006                    ZERO    32,6

       43       43
       44       44        %EQU PHASE = 0 ;
       45       45        %EQU UPPER_DPI_LIMIT = 40 ;
       46       46        %EQU LOWER_DPI_LIMIT = 4 ;
       47       47
       48       48        %INCLUDE Z8A_DEFC ;
       49      116        %INCLUDE Z8A_SUPP_MAC ;
       50     2516        %INCLUDE Z8A_ILS ;
       51     2625        %INCLUDE Z8A_DPI ;
       52     2709        %INCLUDE Z8A_ILL ;
       53     3402        %INCLUDE Z8A_ST ;
       54     7061        %INCLUDE Z8A_QLT;
       55     7167        %INCLUDE Z8A_ETT ;
       56     7468        %INCLUDE Z8E_STACKS ;
       57     9734        %INCLUDE Z8E_NEW_ILL ;
       58     9748        %INCLUDE Z8E_ILS_LIST ;
       59     9832        %INCLUDE Z8E_O1COM ;
       60    10593        %INCLUDE Z8A_COMCOM ;
       61    11243
       62    11244    1   DCL REDEF_CODE   UBIN WORD ;
       63    11245    1   DCL ID           UBIN WORD ;
       64    11246    1   DCL LIMIT        UBIN WORD ;
       65    11247    1   DCL P_ILL$       PTR ;
       66    11248    1   DCL LIST$        PTR ;
       67    11249    1   DCL REDEF1$      PTR ;
       68    11250    1   DCL REDEF2$      PTR ;
       69    11251    1   DCL NEW_LINE     BOOLEAN ;
       70    11252    1   DCL LAST_LINE    SBIN STATIC INIT (0) ;
       71    11253    1   DCL HEAD_DPI$    PTR ;
       72    11254    1   DCL TAIL_DPI$    PTR ;
       73    11255    1   DCL DUMMY$       PTR ;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:23   
       74    11256    1   DCL ST1$         PTR ;
       75    11257    1   DCL ST2$         PTR ;
       76    11258    1   DCL Z8AR$RESERVER ENTRY (1) ;
       77    11259    1   DCL Z8AN$ADD_DPIS_FOR_STRUCTURE ENTRY (2) ALTRET;
       78    11260
       79    11261        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:24   
       80    11262    1          GOTO START ;

  11262 21 000002   000010 710000 21                 TRA     START

       81    11263
       82    11264    1   Z8AN$NEW_ILL1: ENTRY (REDEF_CODE, ID, P_ILL$, LIST$, REDEF1$) ;

  11264 21 000003   000000 700200 xent  Z8AN$NEW_IL* TSX0  ! X66_AUTO_N
        21 000004   000040 000006                    ZERO    32,6

       83    11265
       84    11266    1          GOTO START ;

  11266 21 000005   000010 710000 21                 TRA     START

       85    11267
       86    11268    1   Z8AN$NEW_ILL: ENTRY (REDEF_CODE, ID, P_ILL$, LIST$) ;

  11268 21 000006   000000 700200 xent  Z8AN$NEW_ILL TSX0  ! X66_AUTO_N
        21 000007   000040 000006                    ZERO    32,6

       87    11269
       88    11270    1   START:
       89    11271
       90    11272    2          IF REDEF_CODE = %NO_REDEF THEN DO ;

  11272 21 000010   200003 470500       START        LDP0    @REDEF_CODE,,AUTO
        21 000011   000000 235100                    LDA     0,,PR0
        21 000012   000033 601000 21                 TNZ     s:11281

       91    11273    2            IF LIST$ -> ILS_LIST.HEAD$ = ADDR (NIL)

  11273 21 000013   200006 471500                    LDP1    @LIST$,,AUTO
        21 000014   100000 473500                    LDP3    0,,PR1
        21 000015   300001 236100                    LDQ     1,,PR3
        21 000016   000000 116000 22                 CMPQ    0
        21 000017   000026 600000 21                 TZE     s:11276
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:25   
        21 000020   000007 236000 xsym               LDQ     O1COM+7
        21 000021   000026 604000 21                 TMI     s:11276
        21 000022   000000 116000 20                 CMPQ    LAST_LINE
        21 000023   000026 601000 21                 TNZ     s:11276
        21 000024   000011 235000 xsym               LDA     O1COM+9
        21 000025   000031 600000 21                 TZE     s:11277

       92    11274    2            OR O1COM.LINE_NO ~= LAST_LINE
       93    11275    2            OR O1COM.STATEMENT_TYPE ~= %NO_STATEMENT_TYPE
       94    11276    2            THEN NEW_LINE = TRUE ;

  11276 21 000026   400000 236003                    LDQ     -131072,DU
        21 000027   200012 756100                    STQ     NEW_LINE,,AUTO
        21 000030   000067 710000 21                 TRA     s:11294

       95    11277    2            ELSE NEW_LINE = FALSE ;

  11277 21 000031   200012 450100                    STZ     NEW_LINE,,AUTO

       96    11278    2          END ;

  11278 21 000032   000067 710000 21                 TRA     s:11294

       97    11279
       98    11280    2          ELSE DO ; /* REDEF_CODE <> %NO_REDEF */

       99    11281    3            IF LIST$ -> ILS_LIST.TAIL$ ~= ADDR(NIL) THEN DO ;

  11281 21 000033   200006 471500                    LDP1    @LIST$,,AUTO
        21 000034   100000 473500                    LDP3    0,,PR1
        21 000035   300002 236100                    LDQ     2,,PR3
        21 000036   000000 116000 22                 CMPQ    0
        21 000037   000065 600000 21                 TZE     s:11291

      100    11282    3              ILL$ = LIST$ -> ILS_LIST.TAIL$ -> ILS.ILL$ ;

  11282 21 000040   300002 474500                    LDP4    2,,PR3
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:26   
        21 000041   400003 236100                    LDQ     3,,PR4
        21 000042   000000 756000 5                  STQ     ILL$

      101    11283    4              IF ILL$ -> ILL.ID = %LINOI THEN DO ;

  11283 21 000043   000000 473400 5                  LDP3    ILL$
        21 000044   300000 220100                    LDX0    0,,PR3
        21 000045   000373 100003                    CMPX0   251,DU
        21 000046   000062 601000 21                 TNZ     s:11289

      102    11284    4                IF  ILL$ -> LINOI.LINE_NO = O1COM.LINE_NO

  11284 21 000047   300001 236100                    LDQ     1,,PR3
        21 000050   777777 376007                    ANQ     -1,DL
        21 000051   000007 116000 xsym               CMPQ    O1COM+7
        21 000052   000057 601000 21                 TNZ     s:11287
        21 000053   000011 235000 xsym               LDA     O1COM+9
        21 000054   000057 601000 21                 TNZ     s:11287

      103    11285    4                AND O1COM.STATEMENT_TYPE = %NO_STATEMENT_TYPE
      104    11286    4                THEN NEW_LINE = FALSE ;

  11286 21 000055   200012 450100                    STZ     NEW_LINE,,AUTO
        21 000056   000067 710000 21                 TRA     s:11294

      105    11287    4                ELSE NEW_LINE = TRUE ;

  11287 21 000057   400000 236003                    LDQ     -131072,DU
        21 000060   200012 756100                    STQ     NEW_LINE,,AUTO

      106    11288    4              END ;

  11288 21 000061   000067 710000 21                 TRA     s:11294

      107    11289    3              ELSE NEW_LINE = TRUE ;

  11289 21 000062   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:27   
        21 000063   200012 756100                    STQ     NEW_LINE,,AUTO

      108    11290    3            END ;

  11290 21 000064   000067 710000 21                 TRA     s:11294

      109    11291    2            ELSE NEW_LINE = TRUE ;

  11291 21 000065   400000 236003                    LDQ     -131072,DU
        21 000066   200012 756100                    STQ     NEW_LINE,,AUTO

      110    11292    2          END ;

      111    11293
      112    11294    1          IF NEW_LINE

  11294 21 000067   200012 234100                    SZN     NEW_LINE,,AUTO
        21 000070   000077 604000 21                 TMI     s:11302
        21 000071   200004 473500                    LDP3    @ID,,AUTO
        21 000072   300000 235100                    LDA     0,,PR3
        21 000073   000373 115007                    CMPA    251,DL
        21 000074   000077 600000 21                 TZE     s:11302
        21 000075   000374 115007                    CMPA    252,DL
        21 000076   000210 601000 21                 TNZ     s:11364

      113    11295    1          OR ID = %LINOI
      114    11296    2          OR ID = %END THEN DO ;

      115    11297
      116    11298                 /* Reserve the LINOI item and associated OPN */
      117    11299
      118    11300                 %RESERVE_ILL (ITEM = %LINOI, POINTER = ILL$) ;

  11302 21 000077   000145 235000 xsym               LDA     ILL_STEP+101
        21 000100   000000 755000 0                  STA     ITERATION

  11303 21 000101   000002 236000 6                  LDQ     ILL_+2
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:28   
        21 000102   000000 036000 0                  ADLQ    ITERATION
        21 000103   000003 116000 6                  CMPQ    ILL_+3
        21 000104   000115 604000 21                 TMI     s:11305

  11304 21 000105   000002 236000 22                 LDQ     2
        21 000106   200036 756100                    STQ     FOUND+1,,AUTO
        21 000107   200036 633500                    EPPR3   FOUND+1,,AUTO
        21 000110   200037 453500                    STP3    FOUND+2,,AUTO
        21 000111   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000112   000001 631400 22                 EPPR1   1
        21 000113   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000114   000000 011000                    NOP     0

  11305 21 000115   000002 236000 6                  LDQ     ILL_+2
        21 000116   000022 736000                    QLS     18
        21 000117   000001 036000 6                  ADLQ    ILL_+1
        21 000120   000000 756000 5                  STQ     ILL$

  11306 21 000121   000002 236000 6                  LDQ     ILL_+2
        21 000122   000000 036000 0                  ADLQ    ITERATION
        21 000123   000002 756000 6                  STQ     ILL_+2

  11307 21 000124   000373 220003                    LDX0    251,DU
        21 000125   000000 470400 5                  LDP0    ILL$
        21 000126   000000 740100                    STX0    0,,PR0

      119    11310    2            ILL$->LINOI.LINE_NO = O1COM.LINE_NO ;

  11310 21 000127   000007 721000 xsym               LXL1    O1COM+7
        21 000130   000000 470400 5                  LDP0    ILL$
        21 000131   000001 441100                    SXL1    1,,PR0

      120    11311    2            ILL$->LINOI.COLUMN_NO = O1COM.COLUMN_NO ;

  11311 21 000132   000010 722000 xsym               LXL2    O1COM+8
        21 000133   000001 742100                    STX2    1,,PR0

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:29   
      121    11312    2            ILL$->LINOI.TYPE = O1COM.STATEMENT_TYPE ;

  11312 21 000134   000011 723000 xsym               LXL3    O1COM+9
        21 000135   000002 743100                    STX3    2,,PR0

      122    11313
      123    11314    2            LAST_LINE = O1COM.LINE_NO ;

  11314 21 000136   000007 235000 xsym               LDA     O1COM+7
        21 000137   000000 755000 20                 STA     LAST_LINE

      124    11315
      125    11316                 %RESERVE_ILS (ITEM = %OPN, POINTER = ILS$) ;

  11336 21 000140   000002 236000 2                  LDQ     ILS_+2
        21 000141   000004 036007                    ADLQ    4,DL
        21 000142   000003 116000 2                  CMPQ    ILS_+3
        21 000143   000154 602000 21                 TNC     s:11338

  11337 21 000144   000003 236000 22                 LDQ     3
        21 000145   200036 756100                    STQ     FOUND+1,,AUTO
        21 000146   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 000147   200037 451500                    STP1    FOUND+2,,AUTO
        21 000150   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000151   000001 631400 22                 EPPR1   1
        21 000152   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000153   000000 011000                    NOP     0

  11338 21 000154   000002 236000 2                  LDQ     ILS_+2
        21 000155   000022 736000                    QLS     18
        21 000156   000001 036000 2                  ADLQ    ILS_+1
        21 000157   000000 756000 1                  STQ     ILS$

  11339 21 000160   000002 235000 2                  LDA     ILS_+2
        21 000161   000004 035007                    ADLA    4,DL
        21 000162   000002 755000 2                  STA     ILS_+2

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:30   
  11340 21 000163   000740 220003                    LDX0    480,DU
        21 000164   000000 470400 1                  LDP0    ILS$
        21 000165   000000 740100                    STX0    0,,PR0

  11341 21 000166   000000 236000 22                 LDQ     0
        21 000167   000000 470400 1                  LDP0    ILS$
        21 000170   000002 756100                    STQ     2,,PR0

      126    11345    2            ILS$->ILS.ILL$ = ILL$ ;

  11345 21 000171   000000 236000 5                  LDQ     ILL$
        21 000172   000003 756100                    STQ     3,,PR0

      127    11346
      128    11347                 %ADD_ILS_TO_LIST_TAIL (@LIST$ = LIST$, @ILS$ = ILS$) ;

  11352 21 000173   200006 471500                    LDP1    @LIST$,,AUTO
        21 000174   100000 473500                    LDP3    0,,PR1
        21 000175   300001 236100                    LDQ     1,,PR3
        21 000176   000000 116000 22                 CMPQ    0
        21 000177   000203 601000 21                 TNZ     s:11356

  11353 21 000200   000000 236000 1                  LDQ     ILS$
        21 000201   300001 756100                    STQ     1,,PR3

  11354 21 000202   000206 710000 21                 TRA     s:11358

  11356 21 000203   300002 474500                    LDP4    2,,PR3
        21 000204   000000 236000 1                  LDQ     ILS$
        21 000205   400002 756100                    STQ     2,,PR4

  11358 21 000206   100000 473500                    LDP3    0,,PR1
        21 000207   300002 756100                    STQ     2,,PR3

      129    11361
      130    11362    2          END ;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:31   
      131    11363
      132    11364    2          IF ID ~= %LINOI THEN DO ;

  11364 21 000210   200004 470500                    LDP0    @ID,,AUTO
        21 000211   000000 235100                    LDA     0,,PR0
        21 000212   000373 115007                    CMPA    251,DL
        21 000213   000740 600000 21                 TZE     s:11669

      133    11365
      134    11366    3            DO CASE (REDEF_CODE) ;

  11366 21 000214   200003 473500                    LDP3    @REDEF_CODE,,AUTO
        21 000215   300000 235100                    LDA     0,,PR3
        21 000216   000005 115007                    CMPA    5,DL
        21 000217   000221 602005 21                 TNC     s:11366+5,AL
        21 000220   000664 710000 21                 TRA     s:11641
        21 000221   000226 710000 21                 TRA     s:11390
        21 000222   000260 710000 21                 TRA     s:11404
        21 000223   000502 710000 21                 TRA     s:11536
        21 000224   000226 710000 21                 TRA     s:11390
        21 000225   000630 710000 21                 TRA     s:11625

      135    11367
      136    11368    3              CASE (%NO_REDEF, %LABEL_REDEF) ;

      137    11369
      138    11370                     %RESERVE_ILS (ITEM = %OPN, POINTER = ILS$) ;

  11390 21 000226   000002 236000 2                  LDQ     ILS_+2
        21 000227   000004 036007                    ADLQ    4,DL
        21 000230   000003 116000 2                  CMPQ    ILS_+3
        21 000231   000242 602000 21                 TNC     s:11392

  11391 21 000232   000003 236000 22                 LDQ     3
        21 000233   200036 756100                    STQ     FOUND+1,,AUTO
        21 000234   200036 634500                    EPPR4   FOUND+1,,AUTO
        21 000235   200037 454500                    STP4    FOUND+2,,AUTO
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:32   
        21 000236   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000237   000001 631400 22                 EPPR1   1
        21 000240   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000241   000000 011000                    NOP     0

  11392 21 000242   000002 236000 2                  LDQ     ILS_+2
        21 000243   000022 736000                    QLS     18
        21 000244   000001 036000 2                  ADLQ    ILS_+1
        21 000245   000000 756000 1                  STQ     ILS$

  11393 21 000246   000002 235000 2                  LDA     ILS_+2
        21 000247   000004 035007                    ADLA    4,DL
        21 000250   000002 755000 2                  STA     ILS_+2

  11394 21 000251   000740 220003                    LDX0    480,DU
        21 000252   000000 470400 1                  LDP0    ILS$
        21 000253   000000 740100                    STX0    0,,PR0

  11395 21 000254   000000 236000 22                 LDQ     0
        21 000255   000000 470400 1                  LDP0    ILS$
        21 000256   000002 756100                    STQ     2,,PR0

  11397 21 000257   000664 710000 21                 TRA     s:11641

      139    11399
      140    11400    3              CASE (%ONE_REDEF) ;

      141    11401
      142    11402                     %FISH (TRIAD = REDEF1$, RTN = ST1$) ;

  11404 21 000260   200007 474500                    LDP4    @REDEF1$,,AUTO
        21 000261   400000 236100                    LDQ     0,,PR4
        21 000262   200016 756100                    STQ     ST1$,,AUTO

  11405 21 000263   200016 475500                    LDP5    ST1$,,AUTO
        21 000264   500000 220100                    LDX0    0,,PR5
        21 000265   000751 100003                    CMPX0   489,DU
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:33   
        21 000266   000276 603000 21                 TRC     s:11411

  11406 21 000267   200016 470500                    LDP0    ST1$,,AUTO
        21 000270   000001 236100                    LDQ     1,,PR0
        21 000271   200016 756100                    STQ     ST1$,,AUTO

  11407 21 000272   200016 470500                    LDP0    ST1$,,AUTO
        21 000273   000000 220100                    LDX0    0,,PR0
        21 000274   000751 100003                    CMPX0   489,DU
        21 000275   000267 602000 21                 TNC     s:11406

      143    11410
      144    11411    3                IF ST1$ -> VARIABLE.B.ELEMENTARY

  11411 21 000276   200016 470500                    LDP0    ST1$,,AUTO
        21 000277   000003 236100                    LDQ     3,,PR0
        21 000300   010000 316003                    CANQ    4096,DU
        21 000301   000427 600000 21                 TZE     s:11513
        21 000302   000007 471500                    LDP1    7,,PR0
        21 000303   100001 236100                    LDQ     1,,PR1
        21 000304   000000 116000 22                 CMPQ    0
        21 000305   000427 601000 21                 TNZ     s:11513
        21 000306   000003 430100                    FSZN    3,,PR0
        21 000307   000427 604000 21                 TMI     s:11513
        21 000310   000003 236100                    LDQ     3,,PR0
        21 000311   000400 316003                    CANQ    256,DU
        21 000312   000427 601000 21                 TNZ     s:11513
        21 000313   000002 316003                    CANQ    2,DU
        21 000314   000427 601000 21                 TNZ     s:11513

      145    11412    3                   AND (ST1$ -> VARIABLE.QLT$ -> QLT.FATHER = ADDR(NIL))
      146    11413    3                   AND NOT ST1$ -> VARIABLE.B.REDEF_SUB
      147    11414    3                   AND NOT ST1$ -> VARIABLE.B.REDEF_OBJ
      148    11415    3                  AND NOT ST1$ -> VARIABLE.B.LINKAGE THEN
      149    11416    4                DO;

      150    11417
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:34   
      151    11418    4                  IF ST1$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND

  11418 21 000315   000005 236100                    LDQ     5,,PR0
        21 000316   000000 116000 22                 CMPQ    0
        21 000317   000326 600000 21                 TZE     s:11421
        21 000320   000005 473500                    LDP3    5,,PR0
        21 000321   300000 220100                    LDX0    0,,PR3
        21 000322   000015 100003                    CMPX0   13,DU
        21 000323   000326 601000 21                 TNZ     s:11421

      152    11419    4                      ST1$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
      153    11420    4                    ST1$ -> VARIABLE.LTS$ = ADDR(NIL);

  11420 21 000324   000000 236000 22                 LDQ     0
        21 000325   000005 756100                    STQ     5,,PR0

      154    11421    4                  IF NOT ST1$ -> VARIABLE.B.RENAMED

  11421 21 000326   200016 470500                    LDP0    ST1$,,AUTO
        21 000327   000003 236100                    LDQ     3,,PR0
        21 000330   400000 316007                    CANQ    -131072,DL
        21 000331   000373 601000 21                 TNZ     s:11477
        21 000332   000007 471500                    LDP1    7,,PR0
        21 000333   100000 236100                    LDQ     0,,PR1
        21 000334   040000 316007                    CANQ    16384,DL
        21 000335   000373 601000 21                 TNZ     s:11477

      155    11422    4                     AND NOT ST1$ -> VARIABLE.QLT$ -> QLT.B.RENAMES THEN
      156    11423    5                    DO;

      157    11424                           %RESERVE_ILS (ITEM = %OPV, POINTER = ILS$) ;

  11444 21 000336   000002 236000 2                  LDQ     ILS_+2
        21 000337   000005 036007                    ADLQ    5,DL
        21 000340   000003 116000 2                  CMPQ    ILS_+3
        21 000341   000352 602000 21                 TNC     s:11446

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:35   
  11445 21 000342   000003 236000 22                 LDQ     3
        21 000343   200036 756100                    STQ     FOUND+1,,AUTO
        21 000344   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 000345   200037 451500                    STP1    FOUND+2,,AUTO
        21 000346   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000347   000001 631400 22                 EPPR1   1
        21 000350   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000351   000000 011000                    NOP     0

  11446 21 000352   000002 236000 2                  LDQ     ILS_+2
        21 000353   000022 736000                    QLS     18
        21 000354   000001 036000 2                  ADLQ    ILS_+1
        21 000355   000000 756000 1                  STQ     ILS$

  11447 21 000356   000002 235000 2                  LDA     ILS_+2
        21 000357   000005 035007                    ADLA    5,DL
        21 000360   000002 755000 2                  STA     ILS_+2

  11448 21 000361   000741 220003                    LDX0    481,DU
        21 000362   000000 470400 1                  LDP0    ILS$
        21 000363   000000 740100                    STX0    0,,PR0

  11449 21 000364   000000 236000 22                 LDQ     0
        21 000365   000000 470400 1                  LDP0    ILS$
        21 000366   000002 756100                    STQ     2,,PR0

      158    11453    5                      ILS$->ILS.DNAME = REDEF1$ ;

  11453 21 000367   200007 471500                    LDP1    @REDEF1$,,AUTO
        21 000370   100000 236100                    LDQ     0,,PR1
        21 000371   000004 756100                    STQ     4,,PR0

      159    11454    5                    END;

  11454 21 000372   000664 710000 21                 TRA     s:11641

      160    11455    4                  ELSE
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:36   
      161    11456    5                    DO;

      162    11457                           %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$);

  11477 21 000373   000002 236000 2                  LDQ     ILS_+2
        21 000374   000005 036007                    ADLQ    5,DL
        21 000375   000003 116000 2                  CMPQ    ILS_+3
        21 000376   000407 602000 21                 TNC     s:11479

  11478 21 000377   000003 236000 22                 LDQ     3
        21 000400   200036 756100                    STQ     FOUND+1,,AUTO
        21 000401   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 000402   200037 451500                    STP1    FOUND+2,,AUTO
        21 000403   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000404   000001 631400 22                 EPPR1   1
        21 000405   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000406   000000 011000                    NOP     0

  11479 21 000407   000002 236000 2                  LDQ     ILS_+2
        21 000410   000022 736000                    QLS     18
        21 000411   000001 036000 2                  ADLQ    ILS_+1
        21 000412   000000 756000 1                  STQ     ILS$

  11480 21 000413   000002 235000 2                  LDA     ILS_+2
        21 000414   000005 035007                    ADLA    5,DL
        21 000415   000002 755000 2                  STA     ILS_+2

  11481 21 000416   000742 220003                    LDX0    482,DU
        21 000417   000000 470400 1                  LDP0    ILS$
        21 000420   000000 740100                    STX0    0,,PR0

  11482 21 000421   000000 236000 22                 LDQ     0
        21 000422   000000 470400 1                  LDP0    ILS$
        21 000423   000002 756100                    STQ     2,,PR0

      163    11486    5                      ILS$ -> ILS.B.CDEF = '1'B;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:37   
  11486 21 000424   400000 236003                    LDQ     -131072,DU
        21 000425   000001 256100                    ORSQ    1,,PR0

      164    11487    5                    END;

      165    11488
      166    11489    4                END ; /* Elementary */

  11489 21 000426   000664 710000 21                 TRA     s:11641

      167    11490
      168    11491    4                ELSE DO ; /* Build DPI chain for GROUP moves or redefs */

      169    11492
      170    11493                       %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;

  11513 21 000427   000002 236000 2                  LDQ     ILS_+2
        21 000430   000005 036007                    ADLQ    5,DL
        21 000431   000003 116000 2                  CMPQ    ILS_+3
        21 000432   000443 602000 21                 TNC     s:11515

  11514 21 000433   000003 236000 22                 LDQ     3
        21 000434   200036 756100                    STQ     FOUND+1,,AUTO
        21 000435   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 000436   200037 451500                    STP1    FOUND+2,,AUTO
        21 000437   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000440   000001 631400 22                 EPPR1   1
        21 000441   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000442   000000 011000                    NOP     0

  11515 21 000443   000002 236000 2                  LDQ     ILS_+2
        21 000444   000022 736000                    QLS     18
        21 000445   000001 036000 2                  ADLQ    ILS_+1
        21 000446   000000 756000 1                  STQ     ILS$

  11516 21 000447   000002 235000 2                  LDA     ILS_+2
        21 000450   000005 035007                    ADLA    5,DL
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:38   
        21 000451   000002 755000 2                  STA     ILS_+2

  11517 21 000452   000742 220003                    LDX0    482,DU
        21 000453   000000 470400 1                  LDP0    ILS$
        21 000454   000000 740100                    STX0    0,,PR0

  11518 21 000455   000000 236000 22                 LDQ     0
        21 000456   000000 470400 1                  LDP0    ILS$
        21 000457   000002 756100                    STQ     2,,PR0

      171    11522    4                  CALL BUILD_DPI_CHAIN( ST1$, HEAD_DPI$, TAIL_DPI$)

  11522 21 000460   200014 631500                    EPPR1   TAIL_DPI$,,AUTO
        21 000461   200023 451500                    STP1    @HEAD_DPI$+1,,AUTO
        21 000462   200013 633500                    EPPR3   HEAD_DPI$,,AUTO
        21 000463   200022 453500                    STP3    @ST$$+1,,AUTO
        21 000464   200016 634500                    EPPR4   ST1$,,AUTO
        21 000465   200021 454500                    STP4    ST2$+2,,AUTO
        21 000466   000746 701000 21                 TSX1    BUILD_DPI_CHAIN
        21 000467   000471 702000 21                 TSX2    s:11525
        21 000470   000476 710000 21                 TRA     s:11528

      172    11523    4                    WHENALTRETURN
      173    11524    5                      DO;

      174    11525    5                        HEAD_DPI$ = ADDR(NIL);

  11525 21 000471   000000 236000 22                 LDQ     0
        21 000472   200013 756100                    STQ     HEAD_DPI$,,AUTO

      175    11526    5                        ILS$ -> ILS.B.CDEF = '1'B;

  11526 21 000473   000000 470400 1                  LDP0    ILS$
        21 000474   400000 236003                    LDQ     -131072,DU
        21 000475   000001 256100                    ORSQ    1,,PR0

      176    11527    5                      END;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:39   

      177    11528    4                  ILS$ -> ILS.DEF = HEAD_DPI$;

  11528 21 000476   200013 236100                    LDQ     HEAD_DPI$,,AUTO
        21 000477   000000 470400 1                  LDP0    ILS$
        21 000500   000004 756100                    STQ     4,,PR0

      178    11529
      179    11530    4                END ; /* Non-Elementary */

  11530 21 000501   000664 710000 21                 TRA     s:11641

      180    11531
      181    11532    3              CASE (%TWO_REDEFS) ;

      182    11533
      183    11534                     %FISH (TRIAD = REDEF1$, RTN = ST1$) ;

  11536 21 000502   200007 474500                    LDP4    @REDEF1$,,AUTO
        21 000503   400000 236100                    LDQ     0,,PR4
        21 000504   200016 756100                    STQ     ST1$,,AUTO

  11537 21 000505   200016 475500                    LDP5    ST1$,,AUTO
        21 000506   500000 220100                    LDX0    0,,PR5
        21 000507   000751 100003                    CMPX0   489,DU
        21 000510   000520 603000 21                 TRC     s:11544

  11538 21 000511   200016 470500                    LDP0    ST1$,,AUTO
        21 000512   000001 236100                    LDQ     1,,PR0
        21 000513   200016 756100                    STQ     ST1$,,AUTO

  11539 21 000514   200016 470500                    LDP0    ST1$,,AUTO
        21 000515   000000 220100                    LDX0    0,,PR0
        21 000516   000751 100003                    CMPX0   489,DU
        21 000517   000511 602000 21                 TNC     s:11538

      184    11542                     %FISH (TRIAD = REDEF2$, RTN = ST2$) ;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:40   

  11544 21 000520   200010 470500                    LDP0    @REDEF2$,,AUTO
        21 000521   000000 236100                    LDQ     0,,PR0
        21 000522   200017 756100                    STQ     ST2$,,AUTO

  11545 21 000523   200017 471500                    LDP1    ST2$,,AUTO
        21 000524   100000 220100                    LDX0    0,,PR1
        21 000525   000751 100003                    CMPX0   489,DU
        21 000526   000536 603000 21                 TRC     s:11573

  11546 21 000527   200017 470500                    LDP0    ST2$,,AUTO
        21 000530   000001 236100                    LDQ     1,,PR0
        21 000531   200017 756100                    STQ     ST2$,,AUTO

  11547 21 000532   200017 470500                    LDP0    ST2$,,AUTO
        21 000533   000000 220100                    LDX0    0,,PR0
        21 000534   000751 100003                    CMPX0   489,DU
        21 000535   000527 602000 21                 TNC     s:11546

      185    11550
      186    11551
      187    11552
      188    11553                     %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;

  11573 21 000536   000002 236000 2                  LDQ     ILS_+2
        21 000537   000005 036007                    ADLQ    5,DL
        21 000540   000003 116000 2                  CMPQ    ILS_+3
        21 000541   000552 602000 21                 TNC     s:11575

  11574 21 000542   000003 236000 22                 LDQ     3
        21 000543   200036 756100                    STQ     FOUND+1,,AUTO
        21 000544   200036 630500                    EPPR0   FOUND+1,,AUTO
        21 000545   200037 450500                    STP0    FOUND+2,,AUTO
        21 000546   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000547   000001 631400 22                 EPPR1   1
        21 000550   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000551   000000 011000                    NOP     0
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:41   

  11575 21 000552   000002 236000 2                  LDQ     ILS_+2
        21 000553   000022 736000                    QLS     18
        21 000554   000001 036000 2                  ADLQ    ILS_+1
        21 000555   000000 756000 1                  STQ     ILS$

  11576 21 000556   000002 235000 2                  LDA     ILS_+2
        21 000557   000005 035007                    ADLA    5,DL
        21 000560   000002 755000 2                  STA     ILS_+2

  11577 21 000561   000742 220003                    LDX0    482,DU
        21 000562   000000 470400 1                  LDP0    ILS$
        21 000563   000000 740100                    STX0    0,,PR0

  11578 21 000564   000000 236000 22                 LDQ     0
        21 000565   000000 470400 1                  LDP0    ILS$
        21 000566   000002 756100                    STQ     2,,PR0

      189    11582
      190    11583    3                CALL BUILD_DPI_CHAIN(ST1$, HEAD_DPI$, TAIL_DPI$)

  11583 21 000567   200014 631500                    EPPR1   TAIL_DPI$,,AUTO
        21 000570   200023 451500                    STP1    @HEAD_DPI$+1,,AUTO
        21 000571   200013 633500                    EPPR3   HEAD_DPI$,,AUTO
        21 000572   200022 453500                    STP3    @ST$$+1,,AUTO
        21 000573   200016 634500                    EPPR4   ST1$,,AUTO
        21 000574   200021 454500                    STP4    ST2$+2,,AUTO
        21 000575   000746 701000 21                 TSX1    BUILD_DPI_CHAIN
        21 000576   000617 702000 21                 TSX2    s:11597

      191    11584    3                  WHENRETURN
      192    11585    4                    DO;

      193    11586    4                      CALL BUILD_DPI_CHAIN(ST2$, TAIL_DPI$ -> DPI.NEXT,

  11586 21 000577   200015 630500                    EPPR0   DUMMY$,,AUTO
        21 000600   200023 450500                    STP0    @HEAD_DPI$+1,,AUTO
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:42   
        21 000601   200014 236100                    LDQ     TAIL_DPI$,,AUTO
        21 000602   000002 036003                    ADLQ    2,DU
        21 000603   200022 756100                    STQ     @ST$$+1,,AUTO
        21 000604   200017 631500                    EPPR1   ST2$,,AUTO
        21 000605   200021 451500                    STP1    ST2$+2,,AUTO
        21 000606   000746 701000 21                 TSX1    BUILD_DPI_CHAIN
        21 000607   000611 702000 21                 TSX2    s:11590
        21 000610   000616 710000 21                 TRA     s:11593

      194    11587    4                                            DUMMY$)
      195    11588    4                      WHENALTRETURN
      196    11589    5                        DO;

      197    11590    5                          ILS$ -> ILS.B.CDEF = '1'B;

  11590 21 000611   000000 470400 1                  LDP0    ILS$
        21 000612   400000 236003                    LDQ     -131072,DU
        21 000613   000001 256100                    ORSQ    1,,PR0

      198    11591    5                          HEAD_DPI$ = ADDR(NIL);

  11591 21 000614   000000 236000 22                 LDQ     0
        21 000615   200013 756100                    STQ     HEAD_DPI$,,AUTO

      199    11592    5                        END;

      200    11593    4                    END;

  11593 21 000616   000624 710000 21                 TRA     s:11601

      201    11594
      202    11595    3                  WHENALTRETURN
      203    11596    4                    DO;

      204    11597    4                      ILS$ -> ILS.B.CDEF = '1'B;

  11597 21 000617   000000 470400 1                  LDP0    ILS$
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:43   
        21 000620   400000 236003                    LDQ     -131072,DU
        21 000621   000001 256100                    ORSQ    1,,PR0

      205    11598    4                      HEAD_DPI$ = ADDR(NIL);

  11598 21 000622   000000 236000 22                 LDQ     0
        21 000623   200013 756100                    STQ     HEAD_DPI$,,AUTO

      206    11599    4                    END;

      207    11600
      208    11601    3                ILS$ -> ILS.DEF = HEAD_DPI$;

  11601 21 000624   200013 236100                    LDQ     HEAD_DPI$,,AUTO
        21 000625   000000 470400 1                  LDP0    ILS$
        21 000626   000004 756100                    STQ     4,,PR0
        21 000627   000664 710000 21                 TRA     s:11641

      209    11602
      210    11603    3              CASE (%PFORM_OR_CALL) ;

      211    11604
      212    11605                     %RESERVE_ILS (ITEM = %OPA, POINTER = ILS$) ;

  11625 21 000630   000002 236000 2                  LDQ     ILS_+2
        21 000631   000005 036007                    ADLQ    5,DL
        21 000632   000003 116000 2                  CMPQ    ILS_+3
        21 000633   000644 602000 21                 TNC     s:11627

  11626 21 000634   000003 236000 22                 LDQ     3
        21 000635   200036 756100                    STQ     FOUND+1,,AUTO
        21 000636   200036 634500                    EPPR4   FOUND+1,,AUTO
        21 000637   200037 454500                    STP4    FOUND+2,,AUTO
        21 000640   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000641   000001 631400 22                 EPPR1   1
        21 000642   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000643   000000 011000                    NOP     0
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:44   

  11627 21 000644   000002 236000 2                  LDQ     ILS_+2
        21 000645   000022 736000                    QLS     18
        21 000646   000001 036000 2                  ADLQ    ILS_+1
        21 000647   000000 756000 1                  STQ     ILS$

  11628 21 000650   000002 235000 2                  LDA     ILS_+2
        21 000651   000005 035007                    ADLA    5,DL
        21 000652   000002 755000 2                  STA     ILS_+2

  11629 21 000653   000742 220003                    LDX0    482,DU
        21 000654   000000 470400 1                  LDP0    ILS$
        21 000655   000000 740100                    STX0    0,,PR0

  11630 21 000656   000000 236000 22                 LDQ     0
        21 000657   000000 470400 1                  LDP0    ILS$
        21 000660   000002 756100                    STQ     2,,PR0

      213    11634    3                ILS$->ILS.DEF = ADDR(NIL) ;

  11634 21 000661   000004 756100                    STQ     4,,PR0

      214    11635    3                ILS$->ILS.B.CDEF = '1'B ;

  11635 21 000662   400000 236003                    LDQ     -131072,DU
        21 000663   000001 256100                    ORSQ    1,,PR0

      215    11636
      216    11637    3            END /* Case of REDEF_CODE */ ;

      217    11638
      218    11639                 %RESERVE_ILL (ITEM = ID, POINTER = P_ILL$) ;

  11641 21 000664   200004 470500                    LDP0    @ID,,AUTO
        21 000665   000000 720100                    LXL0    0,,PR0
        21 000666   777552 235010 xsym               LDA     ILL_STEP-150,X0
        21 000667   000000 755000 0                  STA     ITERATION
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:45   

  11642 21 000670   000002 236000 6                  LDQ     ILL_+2
        21 000671   000000 036000 0                  ADLQ    ITERATION
        21 000672   000003 116000 6                  CMPQ    ILL_+3
        21 000673   000704 604000 21                 TMI     s:11644

  11643 21 000674   000002 236000 22                 LDQ     2
        21 000675   200036 756100                    STQ     FOUND+1,,AUTO
        21 000676   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 000677   200037 451500                    STP1    FOUND+2,,AUTO
        21 000700   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 000701   000001 631400 22                 EPPR1   1
        21 000702   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 000703   000000 011000                    NOP     0

  11644 21 000704   000002 236000 6                  LDQ     ILL_+2
        21 000705   000022 736000                    QLS     18
        21 000706   000001 036000 6                  ADLQ    ILL_+1
        21 000707   200005 470500                    LDP0    @P_ILL$,,AUTO
        21 000710   000000 756100                    STQ     0,,PR0

  11645 21 000711   000002 236000 6                  LDQ     ILL_+2
        21 000712   000000 036000 0                  ADLQ    ITERATION
        21 000713   000002 756000 6                  STQ     ILL_+2

  11646 21 000714   000000 471500                    LDP1    0,,PR0
        21 000715   200004 473500                    LDP3    @ID,,AUTO
        21 000716   300000 720100                    LXL0    0,,PR3
        21 000717   100000 740100                    STX0    0,,PR1

      219    11649
      220    11650    2            ILS$->ILS.ILL$ = P_ILL$ ;

  11650 21 000720   000000 236100                    LDQ     0,,PR0
        21 000721   000000 471400 1                  LDP1    ILS$
        21 000722   100003 756100                    STQ     3,,PR1

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:46   
      221    11651
      222    11652                 %ADD_ILS_TO_LIST_TAIL (@LIST$ = LIST$, @ILS$ = ILS$) ;

  11657 21 000723   200006 474500                    LDP4    @LIST$,,AUTO
        21 000724   400000 475500                    LDP5    0,,PR4
        21 000725   500001 236100                    LDQ     1,,PR5
        21 000726   000000 116000 22                 CMPQ    0
        21 000727   000733 601000 21                 TNZ     s:11661

  11658 21 000730   000000 236000 1                  LDQ     ILS$
        21 000731   500001 756100                    STQ     1,,PR5

  11659 21 000732   000736 710000 21                 TRA     s:11663

  11661 21 000733   500002 476500                    LDP6    2,,PR5
        21 000734   000000 236000 1                  LDQ     ILS$
        21 000735   600002 756100                    STQ     2,,PR6

  11663 21 000736   400000 475500                    LDP5    0,,PR4
        21 000737   500002 756100                    STQ     2,,PR5

      223    11666
      224    11667    2          END ; /* If ID <> Linoi */

      225    11668
      226    11669    1          O1COM.STATEMENT_TYPE = %NO_STATEMENT_TYPE ;

  11669 21 000740   000011 450000 xsym               STZ     O1COM+9

      227    11670
      228    11671    1          IF REDEF_CODE ~= %NO_REDEF

  11671 21 000741   200003 470500                    LDP0    @REDEF_CODE,,AUTO
        21 000742   000000 235100                    LDA     0,,PR0
        21 000743   000745 600000 21                 TZE     s:11674

      229    11672    1          THEN LAST_LINE = 0 ; /* Forces new LINOI after Redef. */
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:47   

  11672 21 000744   000000 450000 20                 STZ     LAST_LINE

      230    11673
      231    11674    1          RETURN ;

  11674 21 000745   000000 702200 xent               TSX2  ! X66_ARET

      232    11675
      233    11676        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:48   
      234    11677    1   BUILD_DPI_CHAIN : PROC(ST$$, HEAD_DPI$, TAIL_DPI$) ALTRET;

  11677 21 000746   200020 741300       BUILD_DPI_C* STX1  ! ST2$+1,,AUTO

      235    11678        /*I*
      236    11679             NAME: BUILD_DPI_CHAIN
      237    11680             PURPOSE:
      238    11681                  Given an ST item, build a chain of DPI items.  Each DPI
      239    11682                  item will point to an ST item that may be redefined when
      240    11683                  the item pointed to by ST$$ is redefined.
      241    11684             CALL:
      242    11685                  CALL BUILD_DPI_CHAIN (ST$$, HEAD_DPI$, TAIL_DPI$);
      243    11686             PARAMETERS:
      244    11687                  ST$$ - item that is explicitly redefined.
      245    11688                  HEAD_DPI$ - Pointer to head of created DPI chain.
      246    11689                  TAIL_DPI$ - Pointer to tail of created DPI chain.
      247    11690             DATA:
      248    11691                  ST table, QLT table.
      249    11692             DESCRIPTION:
      250    11693                  Create a chain of DPI items, each of which point
      251    11694                  to an item that may be redefined if ST$$ -> ST is
      252    11695                  redefined.  To do this walk the QLT.  All fathers
      253    11696                  may be redefined, and everything below the item
      254    11697                  in the structure may be redefined.
      255    11698
      256    11699                  If all the items that might possibly be
      257    11700                  changed when ST$$ is changed can't be
      258    11701                  determined then altreturn.
      259    11702        */
      260    11703
      261    11704    2   DCL ST$$ PTR;  /* Input - ST item that is explicitly redefined */
      262    11705    2   DCL HEAD_DPI$ PTR; /* Output - Head of DPI chain created */
      263    11706    2   DCL TAIL_DPI$ PTR; /* Output - Tail of DPI chain created */
      264    11707
      265    11708
      266    11709    2   DCL DPI$$ PTR;
      267    11710    2   DCL P$ PTR;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:49   
      268    11711    2   DCL QLT$$ PTR;
      269    11712    2   DCL REDEF_OBJ$ PTR;
      270    11713
      271    11714
      272    11715
      273    11716    2       IF ST$$ -> VARIABLE.B.RENAMED

  11716 21 000747   200021 470500                    LDP0    @ST$$,,AUTO
        21 000750   000000 471500                    LDP1    0,,PR0
        21 000751   100003 236100                    LDQ     3,,PR1
        21 000752   400000 316007                    CANQ    -131072,DL
        21 000753   001005 601000 21                 TNZ     s:11726
        21 000754   100007 473500                    LDP3    7,,PR1
        21 000755   300000 236100                    LDQ     0,,PR3
        21 000756   040000 316007                    CANQ    16384,DL
        21 000757   001005 601000 21                 TNZ     s:11726
        21 000760   100003 236100                    LDQ     3,,PR1
        21 000761   000002 316003                    CANQ    2,DU
        21 000762   001005 601000 21                 TNZ     s:11726
        21 000763   000004 316003                    CANQ    4,DU
        21 000764   000772 600000 21                 TZE     s:11716+19
        21 000765   100011 474500                    LDP4    9,,PR1
        21 000766   400006 475500                    LDP5    6,,PR4
        21 000767   500005 236100                    LDQ     5,,PR5
        21 000770   000000 116000 22                 CMPQ    0
        21 000771   001005 601000 21                 TNZ     s:11726
        21 000772   100003 236100                    LDQ     3,,PR1
        21 000773   000010 316003                    CANQ    8,DU
        21 000774   001006 600000 21                 TZE     s:11731
        21 000775   100011 474500                    LDP4    9,,PR1
        21 000776   400006 475500                    LDP5    6,,PR4
        21 000777   500005 236100                    LDQ     5,,PR5
        21 001000   000000 116000 22                 CMPQ    0
        21 001001   001006 600000 21                 TZE     s:11731
        21 001002   400011 236100                    LDQ     9,,PR4
        21 001003   000000 116000 22                 CMPQ    0
        21 001004   001006 600000 21                 TZE     s:11731
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:50   

      274    11717    2          OR ST$$ -> VARIABLE.QLT$ -> QLT.B.RENAMES
      275    11718    2          OR ST$$ -> VARIABLE.B.LINKAGE
      276    11719    2          OR (ST$$ -> VARIABLE.B.EXTERNAL
      277    11720    2              AND ST$$ -> VARIABLE.PROC$ -> PROC_.PROC_DEF$ ->
      278    11721    2                  PROC_DEF.ARGLIST$ ~= ADDR(NIL))
      279    11722    2          OR (ST$$ -> VARIABLE.B.GLOBAL AND
      280    11723    2              ST$$ -> VARIABLE.PROC$ -> PROC_.PROC_DEF$ ->
      281    11724    2                  PROC_DEF.ARGLIST$ ~= ADDR(NIL) AND
      282    11725    2              ST$$ -> VARIABLE.PROC$ -> PROC_.FATHER ~= ADDR(NIL)) THEN
      283    11726    2         ALTRETURN;

  11726 21 001005   000000 702211                    TSX2  ! 0,X1

      284    11727
      285    11728
      286    11729            /* If this is a group item and redefined, then give up */
      287    11730
      288    11731    2       IF   ST$$ -> VARIABLE.B.ELEMENTARY = FALSE

  11731 21 001006   100003 236100                    LDQ     3,,PR1
        21 001007   010000 316003                    CANQ    4096,DU
        21 001010   001016 601000 21                 TNZ     s:11740
        21 001011   100003 430100                    FSZN    3,,PR1
        21 001012   001015 604000 21                 TMI     s:11734
        21 001013   000400 316003                    CANQ    256,DU
        21 001014   001016 600000 21                 TZE     s:11740

      289    11732    2       AND (ST$$ -> SCALAR.B.REDEF_SUB
      290    11733    2         OR ST$$ -> SCALAR.B.REDEF_OBJ) THEN
      291    11734    2         ALTRETURN ;

  11734 21 001015   000000 702211                    TSX2  ! 0,X1

      292    11735
      293    11736            /* In order to control the number of DPI items generated,
      294    11737               we set an arbitrary limit on the DPI table size (in KW).
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:51   
      295    11738            */
      296    11739
      297    11740    2       IF COMCOM.OB.OPTZ

  11740 21 001016   000014 234000 xsym               SZN     COMCOM+12
        21 001017   001023 605000 21                 TPL     s:11742

      298    11741    2       THEN LIMIT = %UPPER_DPI_LIMIT ;

  11741 21 001020   000050 235007                    LDA     40,DL
        21 001021   200011 755100                    STA     LIMIT,,AUTO
        21 001022   001025 710000 21                 TRA     s:11744

      299    11742    2       ELSE LIMIT = %LOWER_DPI_LIMIT ;

  11742 21 001023   000004 235007                    LDA     4,DL
        21 001024   200011 755100                    STA     LIMIT,,AUTO

      300    11743
      301    11744    3       IF DPI_.SIZE > LIMIT THEN DO ;

  11744 21 001025   200011 236100                    LDQ     LIMIT,,AUTO
        21 001026   000004 116000 4                  CMPQ    DPI_+4
        21 001027   001040 603000 21                 TRC     s:11757

      302    11745
      303    11746    3         IF ST$$ -> VARIABLE.B.ELEMENTARY = FALSE OR

  11746 21 001030   100003 236100                    LDQ     3,,PR1
        21 001031   010000 316003                    CANQ    4096,DU
        21 001032   001037 600000 21                 TZE     s:11749
        21 001033   100003 430100                    FSZN    3,,PR1
        21 001034   001037 604000 21                 TMI     s:11749
        21 001035   000400 316003                    CANQ    256,DU
        21 001036   001040 600000 21                 TZE     s:11757

      304    11747    3             ST$$ -> VARIABLE.B.REDEF_SUB OR
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:52   
      305    11748    3             ST$$ -> VARIABLE.B.REDEF_OBJ THEN
      306    11749    3           ALTRETURN ;

  11749 21 001037   000000 702211                    TSX2  ! 0,X1

      307    11750
      308    11751    3       END ; /* DPI size > Limit */
      309    11752
      310    11753                /* Scan up the fathers and check for redefines objects
      311    11754                   and subjects.  If any are found, then give up: ALTRET.
      312    11755                   Things get too complex otherwise.
      313    11756                 */
      314    11757    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;

  11757 21 001040   300001 236100                    LDQ     1,,PR3
        21 001041   200026 756100                    STQ     QLT$$,,AUTO

      315    11758    3       DO WHILE QLT$$ ~= ADDR(NIL);

  11758 21 001042   001110 710000 21                 TRA     s:11775

      316    11759    3         IF QLT$$ -> QLT.ST$ -> SCALAR.B.REDEF_SUB

  11759 21 001043   200026 470500                    LDP0    QLT$$,,AUTO
        21 001044   000004 471500                    LDP1    4,,PR0
        21 001045   100003 430100                    FSZN    3,,PR1
        21 001046   001104 604000 21                 TMI     s:11772
        21 001047   100003 236100                    LDQ     3,,PR1
        21 001050   000400 316003                    CANQ    256,DU
        21 001051   001104 601000 21                 TNZ     s:11772
        21 001052   400000 316007                    CANQ    -131072,DL
        21 001053   001104 601000 21                 TNZ     s:11772
        21 001054   000000 236100                    LDQ     0,,PR0
        21 001055   040000 316007                    CANQ    16384,DL
        21 001056   001104 601000 21                 TNZ     s:11772
        21 001057   100003 236100                    LDQ     3,,PR1
        21 001060   000002 316003                    CANQ    2,DU
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:53   
        21 001061   001104 601000 21                 TNZ     s:11772
        21 001062   000004 316003                    CANQ    4,DU
        21 001063   001071 600000 21                 TZE     s:11759+22
        21 001064   100011 473500                    LDP3    9,,PR1
        21 001065   300006 474500                    LDP4    6,,PR3
        21 001066   400005 236100                    LDQ     5,,PR4
        21 001067   000000 116000 22                 CMPQ    0
        21 001070   001104 601000 21                 TNZ     s:11772
        21 001071   100003 236100                    LDQ     3,,PR1
        21 001072   000010 316003                    CANQ    8,DU
        21 001073   001106 600000 21                 TZE     s:11774
        21 001074   100011 473500                    LDP3    9,,PR1
        21 001075   300006 474500                    LDP4    6,,PR3
        21 001076   400005 236100                    LDQ     5,,PR4
        21 001077   000000 116000 22                 CMPQ    0
        21 001100   001106 600000 21                 TZE     s:11774
        21 001101   300011 236100                    LDQ     9,,PR3
        21 001102   000000 116000 22                 CMPQ    0
        21 001103   001106 600000 21                 TZE     s:11774

      317    11760    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.REDEF_OBJ
      318    11761    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.RENAMED
      319    11762    3            OR QLT$$ -> QLT.B.RENAMES
      320    11763    3            OR QLT$$ -> QLT.ST$ -> SCALAR.B.LINKAGE
      321    11764    3            OR (QLT$$ -> QLT.ST$ -> SCALAR.B.EXTERNAL AND
      322    11765    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.PROC_DEF$ ->
      323    11766    3                    PROC_DEF.ARGLIST$ ~= ADDR(NIL))
      324    11767    3            OR (QLT$$ -> QLT.ST$ -> SCALAR.B.GLOBAL AND
      325    11768    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.PROC_DEF$ ->
      326    11769    3                    PROC_DEF.ARGLIST$ ~= ADDR(NIL) AND
      327    11770    3                QLT$$ -> QLT.ST$ -> SCALAR.PROC$ -> PROC_.FATHER
      328    11771    3                      ~= ADDR(NIL) ) THEN
      329    11772    3           ALTRETURN;

  11772 21 001104   200020 221300                    LDX1  ! ST2$+1,,AUTO
        21 001105   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:54   
      330    11773
      331    11774    3         QLT$$ = QLT$$ -> QLT.FATHER;

  11774 21 001106   000001 236100                    LDQ     1,,PR0
        21 001107   200026 756100                    STQ     QLT$$,,AUTO

      332    11775    3       END;

  11775 21 001110   000000 116000 22                 CMPQ    0
        21 001111   001043 601000 21                 TNZ     s:11759

      333    11776
      334    11777    2       IF ST$$ -> VARIABLE.B.REDEF_SUB THEN

  11777 21 001112   200021 470500                    LDP0    @ST$$,,AUTO
        21 001113   000000 471500                    LDP1    0,,PR0
        21 001114   100003 430100                    FSZN    3,,PR1
        21 001115   001132 605000 21                 TPL     s:11795

      335    11778    3         DO;

      336    11779    3           CALL SEARCH_FOR_REDEF_OBJ(ST$$, REDEF_OBJ$)

  11779 21 001116   200027 633500                    EPPR3   REDEF_OBJ$,,AUTO
        21 001117   200032 453500                    STP3    @ST$$+1,,AUTO
        21 001120   200021 236100                    LDQ     @ST$$,,AUTO
        21 001121   200031 756100                    STQ     REDEF_OBJ$+2,,AUTO
        21 001122   001452 701000 21                 TSX1    SEARCH_FOR_REDEF_OBJ
        21 001123   001125 702000 21                 TSX2    s:11782
        21 001124   001127 710000 21                 TRA     s:11784

      337    11780    3             WHENALTRETURN
      338    11781    4               DO;

      339    11782    4                 ALTRETURN;

  11782 21 001125   200020 221300                    LDX1  ! ST2$+1,,AUTO
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:55   
        21 001126   000000 702211                    TSX2  ! 0,X1

      340    11783    4               END;
      341    11784    3           ST$$ = REDEF_OBJ$;

  11784 21 001127   200027 236100                    LDQ     REDEF_OBJ$,,AUTO
        21 001130   200021 470500                    LDP0    @ST$$,,AUTO
        21 001131   000000 756100                    STQ     0,,PR0

      342    11785    3         END;

      343    11786
      344    11787            %BUILD_DPI(@DPI$=DPI$$,
      345    11788                       @DNAME=ST$$);

  11795 21 001132   000002 236000 4                  LDQ     DPI_+2
        21 001133   000003 036007                    ADLQ    3,DL
        21 001134   000003 116000 4                  CMPQ    DPI_+3
        21 001135   001146 602000 21                 TNC     s:11797

  11796 21 001136   000004 236000 22                 LDQ     4
        21 001137   200036 756100                    STQ     FOUND+1,,AUTO
        21 001140   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 001141   200037 451500                    STP1    FOUND+2,,AUTO
        21 001142   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 001143   000001 631400 22                 EPPR1   1
        21 001144   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 001145   000000 011000                    NOP     0

  11797 21 001146   000002 236000 4                  LDQ     DPI_+2
        21 001147   000022 736000                    QLS     18
        21 001150   000001 036000 4                  ADLQ    DPI_+1
        21 001151   200024 756100                    STQ     DPI$$,,AUTO

  11798 21 001152   000002 235000 4                  LDA     DPI_+2
        21 001153   000003 035007                    ADLA    3,DL
        21 001154   000002 755000 4                  STA     DPI_+2
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:56   

  11799 21 001155   000743 220003                    LDX0    483,DU
        21 001156   200024 470500                    LDP0    DPI$$,,AUTO
        21 001157   000000 740100                    STX0    0,,PR0

  11800 21 001160   000000 236000 22                 LDQ     0
        21 001161   200024 470500                    LDP0    DPI$$,,AUTO
        21 001162   000002 756100                    STQ     2,,PR0

  11803 21 001163   200021 470500                    LDP0    @ST$$,,AUTO
        21 001164   000000 236100                    LDQ     0,,PR0
        21 001165   200024 471500                    LDP1    DPI$$,,AUTO
        21 001166   100001 756100                    STQ     1,,PR1

  11804 21 001167   000000 236000 22                 LDQ     0
        21 001170   200024 471500                    LDP1    DPI$$,,AUTO
        21 001171   100002 756100                    STQ     2,,PR1

      346    11807
      347    11808    2       HEAD_DPI$ = DPI$$;

  11808 21 001172   200024 236100                    LDQ     DPI$$,,AUTO
        21 001173   200022 471500                    LDP1    @HEAD_DPI$,,AUTO
        21 001174   100000 756100                    STQ     0,,PR1

      348    11809
      349    11810    2       IF ST$$ -> VARIABLE.B.REDEF_OBJ THEN

  11810 21 001175   000000 473500                    LDP3    0,,PR0
        21 001176   300003 236100                    LDQ     3,,PR3
        21 001177   000400 316003                    CANQ    256,DU
        21 001200   001315 600000 21                 TZE     s:11859

      350    11811    3         DO;

      351    11812    3           QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.BROTHER;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:57   
  11812 21 001201   300007 474500                    LDP4    7,,PR3
        21 001202   400002 236100                    LDQ     2,,PR4
        21 001203   200026 756100                    STQ     QLT$$,,AUTO

      352    11813
      353    11814    4           DO WHILE (QLT$$ ~= ADDR(NIL))

  11814 21 001204   001304 710000 21                 TRA     s:11850

      354    11815    4                    AND (QLT$$ -> QLT.ST$ -> VARIABLE.B.REDEF_SUB
      355    11816    4                         OR QLT$$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED);
      356    11817                                 /* Last clause needed in case of variables created
      357    11818                                    by syntax error recovery. */
      358    11819    4             IF NOT QLT$$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED THEN

  11819 21 001205   200026 470500                    LDP0    QLT$$,,AUTO
        21 001206   000004 471500                    LDP1    4,,PR0
        21 001207   100003 236100                    LDQ     3,,PR1
        21 001210   100000 316003                    CANQ    32768,DU
        21 001211   001301 601000 21                 TNZ     s:11849

      359    11820    5               DO;

      360    11821                      %BUILD_DPI(@DPI$="DPI$$->DPI.NEXT",              /*#39440*/
      361    11822                                 @DNAME="QLT$$->QLT.ST$");

  11829 21 001212   000002 236000 4                  LDQ     DPI_+2
        21 001213   000003 036007                    ADLQ    3,DL
        21 001214   000003 116000 4                  CMPQ    DPI_+3
        21 001215   001226 602000 21                 TNC     s:11831

  11830 21 001216   000004 236000 22                 LDQ     4
        21 001217   200036 756100                    STQ     FOUND+1,,AUTO
        21 001220   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 001221   200037 451500                    STP1    FOUND+2,,AUTO
        21 001222   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 001223   000001 631400 22                 EPPR1   1
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:58   
        21 001224   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 001225   000000 011000                    NOP     0

  11831 21 001226   000002 236000 4                  LDQ     DPI_+2
        21 001227   000022 736000                    QLS     18
        21 001230   000001 036000 4                  ADLQ    DPI_+1
        21 001231   200024 470500                    LDP0    DPI$$,,AUTO
        21 001232   000002 756100                    STQ     2,,PR0

  11832 21 001233   000002 235000 4                  LDA     DPI_+2
        21 001234   000003 035007                    ADLA    3,DL
        21 001235   000002 755000 4                  STA     DPI_+2

  11833 21 001236   200024 470500                    LDP0    DPI$$,,AUTO
        21 001237   000002 471500                    LDP1    2,,PR0
        21 001240   000743 220003                    LDX0    483,DU
        21 001241   100000 740100                    STX0    0,,PR1

  11834 21 001242   200024 470500                    LDP0    DPI$$,,AUTO
        21 001243   000002 471500                    LDP1    2,,PR0
        21 001244   000000 236000 22                 LDQ     0
        21 001245   100002 756100                    STQ     2,,PR1

  11837 21 001246   200024 470500                    LDP0    DPI$$,,AUTO
        21 001247   000002 471500                    LDP1    2,,PR0
        21 001250   200026 473500                    LDP3    QLT$$,,AUTO
        21 001251   300004 236100                    LDQ     4,,PR3
        21 001252   100001 756100                    STQ     1,,PR1

  11838 21 001253   200024 470500                    LDP0    DPI$$,,AUTO
        21 001254   000002 471500                    LDP1    2,,PR0
        21 001255   000000 236000 22                 LDQ     0
        21 001256   100002 756100                    STQ     2,,PR1

      362    11841    5                 DPI$$ = DPI$$ -> DPI.NEXT;

  11841 21 001257   200024 470500                    LDP0    DPI$$,,AUTO
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:59   
        21 001260   000002 236100                    LDQ     2,,PR0
        21 001261   200024 756100                    STQ     DPI$$,,AUTO

      363    11842    5                 IF QLT$$ -> QLT.SON ~= ADDR(NIL) THEN

  11842 21 001262   300003 236100                    LDQ     3,,PR3
        21 001263   000000 116000 22                 CMPQ    0
        21 001264   001301 600000 21                 TZE     s:11849

      364    11843    5                  CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(QLT$$ -> QLT.SON, DPI$$)

  11843 21 001265   200024 630500                    EPPR0   DPI$$,,AUTO
        21 001266   200037 450500                    STP0    FOUND+2,,AUTO
        21 001267   200026 236100                    LDQ     QLT$$,,AUTO
        21 001270   000003 036003                    ADLQ    3,DU
        21 001271   200036 756100                    STQ     FOUND+1,,AUTO
        21 001272   200036 630500                    EPPR0   FOUND+1,,AUTO
        21 001273   000005 631400 22                 EPPR1   5
        21 001274   000000 701000 xent               TSX1    Z8AN$ADD_DPIS_FOR_STRUCTURE
        21 001275   001277 702000 21                 TSX2    s:11846
        21 001276   001301 710000 21                 TRA     s:11849

      365    11844    5                   WHENALTRETURN
      366    11845    6                     DO;

      367    11846    6                       ALTRETURN;

  11846 21 001277   200020 221300                    LDX1  ! ST2$+1,,AUTO
        21 001300   000000 702211                    TSX2  ! 0,X1

      368    11847    6                     END;
      369    11848    5               END;

      370    11849    4             QLT$$ = QLT$$ -> QLT.BROTHER;

  11849 21 001301   200026 470500                    LDP0    QLT$$,,AUTO
        21 001302   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:60   
        21 001303   200026 756100                    STQ     QLT$$,,AUTO

      371    11850    4           END;

  11850 21 001304   000000 116000 22                 CMPQ    0
        21 001305   001315 600000 21                 TZE     s:11859
        21 001306   200026 470500                    LDP0    QLT$$,,AUTO
        21 001307   000004 471500                    LDP1    4,,PR0
        21 001310   100003 430100                    FSZN    3,,PR1
        21 001311   001205 604000 21                 TMI     s:11819
        21 001312   100003 236100                    LDQ     3,,PR1
        21 001313   100000 316003                    CANQ    32768,DU
        21 001314   001205 601000 21                 TNZ     s:11819

      372    11851    3         END;

      373    11852
      374    11853
      375    11854
      376    11855
      377    11856                  /* Walk up father chain of ST$$ and build a chain of
      378    11857                     DPIs for implicit redefinition of containing groups.
      379    11858                  */
      380    11859    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;

  11859 21 001315   200021 470500                    LDP0    @ST$$,,AUTO
        21 001316   000000 471500                    LDP1    0,,PR0
        21 001317   100007 473500                    LDP3    7,,PR1
        21 001320   300001 236100                    LDQ     1,,PR3
        21 001321   200026 756100                    STQ     QLT$$,,AUTO

      381    11860    3       DO WHILE QLT$$ ~= ADDR(NIL);

  11860 21 001322   001406 710000 21                 TRA     s:11888

      382    11861    3         IF (QLT$$ -> QLT.ST$ -> VARIABLE.ADSC.N < 17

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:61   
  11861 21 001323   200026 470500                    LDP0    QLT$$,,AUTO
        21 001324   000004 471500                    LDP1    4,,PR0
        21 001325   100001 236100                    LDQ     1,,PR1
        21 001326   007777 376007                    ANQ     4095,DL
        21 001327   000021 116007                    CMPQ    17,DL
        21 001330   001334 603000 21                 TRC     s:11861+9
        21 001331   100003 236100                    LDQ     3,,PR1
        21 001332   004000 316003                    CANQ    2048,DU
        21 001333   001337 600000 21                 TZE     s:11864
        21 001334   100000 220100                    LDX0    0,,PR1
        21 001335   000766 100003                    CMPX0   502,DU
        21 001336   001404 600000 21                 TZE     s:11887

      383    11862    3         AND QLT$$ -> QLT.ST$ -> VARIABLE.B.LENGTH_4096 = '0'B)
      384    11863    4         OR  QLT$$ -> QLT.ST$ -> VARIABLE.ID ~= %SCALAR THEN DO;

      385    11864    4           P$ = DPI$$;

  11864 21 001337   200024 236100                    LDQ     DPI$$,,AUTO
        21 001340   200025 756100                    STQ     P$,,AUTO

      386    11865                %BUILD_DPI (@DPI$=DPI$$,
      387    11866                            @DNAME="QLT$$->QLT.ST$");

  11873 21 001341   000002 236000 4                  LDQ     DPI_+2
        21 001342   000003 036007                    ADLQ    3,DL
        21 001343   000003 116000 4                  CMPQ    DPI_+3
        21 001344   001355 602000 21                 TNC     s:11875

  11874 21 001345   000004 236000 22                 LDQ     4
        21 001346   200036 756100                    STQ     FOUND+1,,AUTO
        21 001347   200036 631500                    EPPR1   FOUND+1,,AUTO
        21 001350   200037 451500                    STP1    FOUND+2,,AUTO
        21 001351   200037 630500                    EPPR0   FOUND+2,,AUTO
        21 001352   000001 631400 22                 EPPR1   1
        21 001353   000000 701000 xent               TSX1    Z8AR$RESERVER
        21 001354   000000 011000                    NOP     0
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:62   

  11875 21 001355   000002 236000 4                  LDQ     DPI_+2
        21 001356   000022 736000                    QLS     18
        21 001357   000001 036000 4                  ADLQ    DPI_+1
        21 001360   200024 756100                    STQ     DPI$$,,AUTO

  11876 21 001361   000002 235000 4                  LDA     DPI_+2
        21 001362   000003 035007                    ADLA    3,DL
        21 001363   000002 755000 4                  STA     DPI_+2

  11877 21 001364   000743 220003                    LDX0    483,DU
        21 001365   200024 470500                    LDP0    DPI$$,,AUTO
        21 001366   000000 740100                    STX0    0,,PR0

  11878 21 001367   000000 236000 22                 LDQ     0
        21 001370   200024 470500                    LDP0    DPI$$,,AUTO
        21 001371   000002 756100                    STQ     2,,PR0

  11881 21 001372   200026 470500                    LDP0    QLT$$,,AUTO
        21 001373   000004 236100                    LDQ     4,,PR0
        21 001374   200024 471500                    LDP1    DPI$$,,AUTO
        21 001375   100001 756100                    STQ     1,,PR1

  11882 21 001376   000000 236000 22                 LDQ     0
        21 001377   200024 471500                    LDP1    DPI$$,,AUTO
        21 001400   100002 756100                    STQ     2,,PR1

      388    11885    4           P$ -> DPI.NEXT = DPI$$;

  11885 21 001401   200024 236100                    LDQ     DPI$$,,AUTO
        21 001402   200025 471500                    LDP1    P$,,AUTO
        21 001403   100002 756100                    STQ     2,,PR1

      389    11886    4         END; /* Exclude group items greater than 16 bytes */

      390    11887    3         QLT$$ = QLT$$ -> QLT.FATHER;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:63   
  11887 21 001404   000001 236100                    LDQ     1,,PR0
        21 001405   200026 756100                    STQ     QLT$$,,AUTO

      391    11888    3       END;

  11888 21 001406   000000 116000 22                 CMPQ    0
        21 001407   001323 601000 21                 TNZ     s:11861

      392    11889
      393    11890
      394    11891    2       IF ST$$ -> VARIABLE.B.ELEMENTARY = '0'B THEN

  11891 21 001410   200021 470500                    LDP0    @ST$$,,AUTO
        21 001411   000000 471500                    LDP1    0,,PR0
        21 001412   100003 236100                    LDQ     3,,PR1
        21 001413   010000 316003                    CANQ    4096,DU
        21 001414   001434 601000 21                 TNZ     s:11900

      395    11892    2         CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(ST$$ -> VARIABLE.QLT$ ->

  11892 21 001415   100007 473500                    LDP3    7,,PR1
        21 001416   200024 634500                    EPPR4   DPI$$,,AUTO
        21 001417   200037 454500                    STP4    FOUND+2,,AUTO
        21 001420   300003 631500                    EPPR1   3,,PR3
        21 001421   200036 451500                    STP1    FOUND+1,,AUTO
        21 001422   200036 630500                    EPPR0   FOUND+1,,AUTO
        21 001423   000005 631400 22                 EPPR1   5
        21 001424   000000 701000 xent               TSX1    Z8AN$ADD_DPIS_FOR_STRUCTURE
        21 001425   001427 702000 21                 TSX2    s:11897
        21 001426   001433 710000 21                 TRA     s:11898+2

      396    11893    2                                            QLT.SON,
      397    11894    2                                          DPI$$)
      398    11895    2           WHENALTRETURN
      399    11896    3             DO;

      400    11897    3               DPI$$ = ADDR(NIL);
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:64   

  11897 21 001427   000000 236000 22                 LDQ     0
        21 001430   200024 756100                    STQ     DPI$$,,AUTO

      401    11898    3               ALTRETURN;

  11898 21 001431   200020 221300                    LDX1  ! ST2$+1,,AUTO
        21 001432   000000 702211                    TSX2  ! 0,X1
        21 001433   001445 710000 21                 TRA     s:11903

      402    11899    3             END;
      403    11900    2       ELSE IF ST$$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND

  11900 21 001434   100005 236100                    LDQ     5,,PR1
        21 001435   000000 116000 22                 CMPQ    0
        21 001436   001445 600000 21                 TZE     s:11903
        21 001437   100005 473500                    LDP3    5,,PR1
        21 001440   300000 220100                    LDX0    0,,PR3
        21 001441   000015 100003                    CMPX0   13,DU
        21 001442   001445 601000 21                 TNZ     s:11903

      404    11901    2           ST$$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
      405    11902    2         ST$$ -> VARIABLE.LTS$ = ADDR(NIL);

  11902 21 001443   000000 236000 22                 LDQ     0
        21 001444   100005 756100                    STQ     5,,PR1

      406    11903    2       TAIL_DPI$ = DPI$$;

  11903 21 001445   200024 236100                    LDQ     DPI$$,,AUTO
        21 001446   200023 470500                    LDP0    @TAIL_DPI$,,AUTO
        21 001447   000000 756100                    STQ     0,,PR0

      407    11904    2   END BUILD_DPI_CHAIN;

  11904 21 001450   200020 221300                    LDX1  ! ST2$+1,,AUTO
        21 001451   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:65   

      408    11905        %EJECT;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:66   
      409    11906    1   SEARCH_FOR_REDEF_OBJ : PROC(ST$$, REDEF_OBJ$) ALTRET;

  11906 21 001452   200030 741300       SEARCH_FOR_* STX1  ! REDEF_OBJ$+1,,AUTO

      410    11907        /*I*
      411    11908             NAME: SEARCH_FOR_REDEF_OBJ
      412    11909             PURPOSE:
      413    11910                  Given a pointer to an ST item that is a redefines subject,
      414    11911                  find the ST item that it redefines.
      415    11912             PARAMETERS:
      416    11913                  ST$$ - Input: Points at ST item that is redefines subject.
      417    11914                  REDEF_OBJ$ - Points at ST item that is redefines object
      418    11915                               of ST$$.
      419    11916             DESCRIPTION:
      420    11917                  Walk up QLT to father of ST$$, then walk down to its son.
      421    11918                  Look through all the sons, for redef objects.  When a
      422    11919                  redef object is found, look through its brothers for ST$$.
      423    11920                  If the structure is too complex, or ST$$ is not found then
      424    11921                  altreturn.
      425    11922        */
      426    11923
      427    11924    2   DCL ST$$ PTR;
      428    11925    2   DCL REDEF_OBJ$ PTR;
      429    11926    2   DCL QLT$$ PTR;
      430    11927    2   DCL SON$ PTR;
      431    11928    2   DCL FOUND BIT(1);
      432    11929
      433    11930    2   DCL Z8AE$ERROR ENTRY(12);
      434    11931        %INCLUDE Z8A_ERR_NUMS;
      435    12695
      436    12696    2       QLT$$ = ST$$ -> VARIABLE.QLT$ -> QLT.FATHER;

  12696 21 001453   200031 470500                    LDP0    @ST$$,,AUTO
        21 001454   000000 471500                    LDP1    0,,PR0
        21 001455   100007 473500                    LDP3    7,,PR1
        21 001456   300001 236100                    LDQ     1,,PR3
        21 001457   200033 756100                    STQ     QLT$$,,AUTO
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:67   

      437    12697
      438    12698            /*N*  If we are looking at an 01 level guy, we'll search
      439    12699                  the whole QLT.  This may be too expensive and may
      440    12700                  need to be narrowed down.  We may need to give up and
      441    12701                  declare a common redefinition.
      442    12702            */
      443    12703    2       IF QLT$$ = ADDR(NIL) THEN

  12703 21 001460   000000 116000 22                 CMPQ    0
        21 001461   001465 601000 21                 TNZ     s:12710

      444    12704              %TOP_QLT(POINTER=SON$);

  12706 21 001462   000000 236000 11                 LDQ     QLT_
        21 001463   200034 756100                    STQ     SON$,,AUTO

  12707 21 001464   001470 710000 21                 TRA     s:12712

      445    12709    2       ELSE
      446    12710    2         SON$ = QLT$$ -> QLT.SON;

  12710 21 001465   200033 474500                    LDP4    QLT$$,,AUTO
        21 001466   400003 236100                    LDQ     3,,PR4
        21 001467   200034 756100                    STQ     SON$,,AUTO

      447    12711
      448    12712    2       FOUND = FALSE;

  12712 21 001470   200035 450100                    STZ     FOUND,,AUTO

      449    12713
      450    12714    3       DO WHILE (SON$ ~= ADDR(NIL))

  12714 21 001471   001536 710000 21                 TRA     s:12734

      451    12715    3                AND NOT FOUND;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:68   
      452    12716    3         IF SON$ -> QLT.ST$ -> VARIABLE.B.REDEF_OBJ THEN

  12716 21 001472   200034 470500                    LDP0    SON$,,AUTO
        21 001473   000004 471500                    LDP1    4,,PR0
        21 001474   100003 236100                    LDQ     3,,PR1
        21 001475   000400 316003                    CANQ    256,DU
        21 001476   001534 600000 21                 TZE     s:12732

      453    12717    4           DO;

      454    12718    4             REDEF_OBJ$ = SON$ -> QLT.ST$;

  12718 21 001477   000004 236100                    LDQ     4,,PR0
        21 001500   200032 473500                    LDP3    @REDEF_OBJ$,,AUTO
        21 001501   300000 756100                    STQ     0,,PR3

      455    12719    4             SON$ = SON$ -> QLT.BROTHER;

  12719 21 001502   000002 236100                    LDQ     2,,PR0
        21 001503   200034 756100                    STQ     SON$,,AUTO

      456    12720
      457    12721    5             DO WHILE (SON$ ~= ADDR(NIL))

  12721 21 001504   001517 710000 21                 TRA     s:12729

      458    12722    5                      AND (SON$ -> QLT.ST$ -> VARIABLE.B.REDEF_SUB
      459    12723    5                           OR SON$ -> QLT.ST$ -> VARIABLE.B.COMPILER_CREATED)
      460    12724    5                      AND NOT FOUND;
      461    12725    5               IF SON$ -> QLT.ST$ = ST$$ THEN

  12725 21 001505   200034 470500                    LDP0    SON$,,AUTO
        21 001506   200031 471500                    LDP1    @ST$$,,AUTO
        21 001507   000004 236100                    LDQ     4,,PR0
        21 001510   100000 116100                    CMPQ    0,,PR1
        21 001511   001515 601000 21                 TNZ     s:12728

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:69   
      462    12726    5                 FOUND = TRUE;

  12726 21 001512   400000 236003                    LDQ     -131072,DU
        21 001513   200035 756100                    STQ     FOUND,,AUTO
        21 001514   001517 710000 21                 TRA     s:12729

      463    12727    5               ELSE
      464    12728    5                 SON$ = SON$ -> QLT.BROTHER;

  12728 21 001515   000002 236100                    LDQ     2,,PR0
        21 001516   200034 756100                    STQ     SON$,,AUTO

      465    12729    5             END;

  12729 21 001517   200034 236100                    LDQ     SON$,,AUTO
        21 001520   000000 116000 22                 CMPQ    0
        21 001521   001533 600000 21                 TZE     s:12730
        21 001522   200034 470500                    LDP0    SON$,,AUTO
        21 001523   000004 471500                    LDP1    4,,PR0
        21 001524   100003 430100                    FSZN    3,,PR1
        21 001525   001531 604000 21                 TMI     s:12729+10
        21 001526   100003 236100                    LDQ     3,,PR1
        21 001527   100000 316003                    CANQ    32768,DU
        21 001530   001533 600000 21                 TZE     s:12730
        21 001531   200035 234100                    SZN     FOUND,,AUTO
        21 001532   001505 605000 21                 TPL     s:12725

      466    12730    4           END;

  12730 21 001533   001536 710000 21                 TRA     s:12734

      467    12731    3         ELSE
      468    12732    3           SON$ = SON$ -> QLT.BROTHER;

  12732 21 001534   000002 236100                    LDQ     2,,PR0
        21 001535   200034 756100                    STQ     SON$,,AUTO

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:70   
      469    12733
      470    12734    3       END; /* WHILE */

  12734 21 001536   200034 236100                    LDQ     SON$,,AUTO
        21 001537   000000 116000 22                 CMPQ    0
        21 001540   001543 600000 21                 TZE     s:12737
        21 001541   200035 234100                    SZN     FOUND,,AUTO
        21 001542   001472 605000 21                 TPL     s:12716

      471    12735
      472    12736
      473    12737    2       IF NOT FOUND THEN

  12737 21 001543   200035 234100                    SZN     FOUND,,AUTO
        21 001544   001553 604000 21                 TMI     s:12743

      474    12738    3         DO;

      475    12739    3           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  12739 21 001545   000007 630400 22                 EPPR0   7
        21 001546   000001 631400 22                 EPPR1   1
        21 001547   000000 701000 xent               TSX1    Z8AE$ERROR
        21 001550   000000 011000                    NOP     0

      476    12740    3           ALTRETURN;

  12740 21 001551   200030 221300                    LDX1  ! REDEF_OBJ$+1,,AUTO
        21 001552   000000 702211                    TSX2  ! 0,X1

      477    12741    3         END;
      478    12742
      479    12743    2   END SEARCH_FOR_REDEF_OBJ;

  12743 21 001553   200030 221300                    LDX1  ! REDEF_OBJ$+1,,AUTO
        21 001554   000001 702211                    TSX2  ! 1,X1
      480    12744    1   END Z8AN$NEW_ILL2 ;
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:71   
      481    12745        %EOD;

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:72   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8AN$NEW_ILL2.
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:73   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 002 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILS_

  ****  Section 003 LblCom DPI$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DPI$

  ****  Section 004 LblCom DPI_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 DPI_

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:74   
  ****  Section 005 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 006 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILL_

  ****  Section 007 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 008 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 009 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 010 LblCom PREV_01_QLT$

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:75   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 011 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 QLT_

  ****  Section 012 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 013 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 014 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 015 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:76   

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 016 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 017 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 018 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 019 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 020  Data  Z8AN$NEW_ILL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LAST_LINE
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:77   

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/w PTR         r     1 @HEAD_DPI$                 4-0-0/w PTR         r     1 @ID
     6-0-0/w PTR         r     1 @LIST$                     5-0-0/w PTR         r     1 @P_ILL$
     7-0-0/w PTR         r     1 @REDEF1$                  10-0-0/w PTR         r     1 @REDEF2$
     3-0-0/w PTR         r     1 @REDEF_CODE               32-0-0/w PTR         r     1 @REDEF_OBJ$
    21-0-0/w PTR         r     1 @ST$$                     31-0-0/w PTR         r     1 @ST$$
    23-0-0/w PTR         r     1 @TAIL_DPI$                24-0-0/w PTR         r     1 DPI$$
    15-0-0/w PTR         r     1 DUMMY$                    35-0-0/b BIT         r     1 FOUND
    13-0-0/w PTR         r     1 HEAD_DPI$                 *0-0-0/w PTR         r     1 HEAD_DPI$
    *0-0-0/w UBIN        r     1 ID                        11-0-0/w UBIN        r     1 LIMIT
    *0-0-0/w PTR         r     1 LIST$                     12-0-0/b BIT         r     1 NEW_LINE
    25-0-0/w PTR         r     1 P$                        *0-0-0/w PTR         r     1 P_ILL$
    26-0-0/w PTR         r     1 QLT$$                     33-0-0/w PTR         r     1 QLT$$
    *0-0-0/w PTR         r     1 REDEF1$                   *0-0-0/w PTR         r     1 REDEF2$
    *0-0-0/w UBIN        r     1 REDEF_CODE                27-0-0/w PTR         r     1 REDEF_OBJ$
    *0-0-0/w PTR         r     1 REDEF_OBJ$                34-0-0/w PTR         r     1 SON$
    *0-0-0/w PTR         r     1 ST$$                      *0-0-0/w PTR         r     1 ST$$
    16-0-0/w PTR         r     1 ST1$                      17-0-0/w PTR         r     1 ST2$
    14-0-0/w PTR         r     1 TAIL_DPI$                 *0-0-0/w PTR         r     1 TAIL_DPI$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:78   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)         1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(108)   r     1 DPI                        0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)   r     1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)   r     1 ILS
     0-0-0/w STRC(288)   r     1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(108)   r     1 LINOI
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
PL6.E3A0      #001=Z8AN$NEW_ILL2 File=Z8AN.:Z8A6TSI                              SAT 08/09/97 10:45 Page:79   
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)   r     1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)   r     1 PROC_DEF                   0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(396)         1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8AN$NEW_ILL2 requires 877 words for executable code.
   Procedure Z8AN$NEW_ILL2 requires 32 words of local(AUTO) storage.

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:80   
      482        1        /*T***********************************************************/
      483        2        /*T*                                                         */
      484        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      485        4        /*T*                                                         */
      486        5        /*T***********************************************************/
      487        6        Z8AN$ADD_DPIS_FOR_STRUCTURE: PROC(QLT$$, DPI$$) ALTRET;
      488        7        /*D*
      489        8             NAME: Z8AN$ADD_DPIS_FOR_STRUCTURE
      490        9             CALL:
      491       10                  CALL Z8AN$ADD_DPIS_FOR_STRUCTURE (QLT$$, DPI$$);
      492       11             PARAMETERS:
      493       12                  QLT$$ - Points to QLT item from which DPIs are created.
      494       13                  DPI$$ - Points to DPI item (possibly a chain of em)
      495       14             DESCRIPTION:
      496       15                  Create a DPI chain for every item in a structure.
      497       16                  When a group level item is redefined, all the items
      498       17                  below it in the structure are also redefined.  This
      499       18                  procedure is called recursively to walk the QLT for
      500       19                  ST$$.  By 'redefined' above, I mean that the item is
      501       20                  changed, as when its a recieving guy in a MOVE.
      502       21
      503       22                  If the all the DPIs cant be created then altreturn
      504       23                  will be taken.
      505       24        */
      506       25
      507       26    1   DCL DPI$$ PTR;
      508       27    1   DCL P$ PTR;
      509       28    1   DCL P2$ PTR;
      510       29    1   DCL QLT$$ PTR;
      511       30    1   DCL LQLT$ PTR;
      512       31
      513       32        %EQU PHASE = 0;
      514       33        %INCLUDE Z8A_DEFC;
      515      101        %INCLUDE Z8A_SUPP_MAC;
      516     2501        %INCLUDE Z8A_ETT;
      517     2802        %INCLUDE Z8A_ILS;
      518     2911        %INCLUDE Z8A_DPI;
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:81   
      519     2995        %INCLUDE Z8A_ST;
      520     6654        %INCLUDE Z8A_QLT;
      521     6760    1   DCL Z8AR$RESERVER ENTRY (1);
      522     6761
      523     6762
      524     6763    1       P$ = DPI$$;
      525     6764    1       LQLT$ = QLT$$;
      526     6765
      527     6766
      528     6767    2       DO WHILE LQLT$ ~= ADDR(NIL);
      529     6768    3        IF LQLT$ -> QLT.ST$ -> ST.ID ~= %CONDITION THEN DO;
      530     6769    3         IF LQLT$ -> QLT.ST$ -> VARIABLE.B.RENAMED
      531     6770    3            OR LQLT$ -> QLT.B.RENAMES THEN
      532     6771    3           ALTRETURN;
      533     6772
      534     6773    3         P2$ = P$;
      535     6774
      536     6775              %BUILD_DPI(@DPI$=P$,
      537     6776                         @DNAME="LQLT$->QLT.ST$");
      538     6795    3         IF LQLT$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND
      539     6796    3             LQLT$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
      540     6797    3           LQLT$ -> VARIABLE.LTS$ = ADDR(NIL);
      541     6798    3         P2$ -> DPI.NEXT = P$;
      542     6799
      543     6800    3         IF (LQLT$ -> QLT.SON ~= ADDR(NIL)) THEN
      544     6801    3           CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(LQLT$ -> QLT.SON, P$)
      545     6802    3             WHENALTRETURN
      546     6803    4               DO;
      547     6804    4                 ALTRETURN;
      548     6805    4               END;
      549     6806
      550     6807    3        END; /* NOT CONDITION */
      551     6808    2        LQLT$ = LQLT$ -> QLT.BROTHER;
      552     6809    2       END; /* DO WHILE */
      553     6810
      554     6811    1       DPI$$ = P$;
      555     6812    1   END Z8AN$ADD_DPIS_FOR_STRUCTURE;
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:82   

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:83   
--  Include file information  --

   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8AN$ADD_DPIS_FOR_STRUCTURE.

   Procedure Z8AN$ADD_DPIS_FOR_STRUCTURE requires 90 words for executable code.
   Procedure Z8AN$ADD_DPIS_FOR_STRUCTURE requires 10 words of local(AUTO) storage.

    No errors detected in file Z8AN.:Z8A6TSI    .

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:84   

 Object Unit name= Z8AN$ADD_DPIS_FOR_STRUCTURE                File name= Z8AN.:Z8A6TOU
 UTS= AUG 09 '97 10:51:21.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ETT$
    2  LblCom even  none     1      1  HEAD_ETT$
    3  LblCom even  none   512   1000  ETT_BUCKETS
    4  LblCom even  none     5      5  ETT_
    5  LblCom even  none     1      1  ILS$
    6  LblCom even  none     5      5  ILS_
    7  LblCom even  none     1      1  DPI$
    8  LblCom even  none     5      5  DPI_
    9  LblCom even  none     1      1  ST$
   10  LblCom even  none     5      5  ST_
   11  LblCom even  none     1      1  QLT$
   12  LblCom even  none     1      1  PREV_01_QLT$
   13  LblCom even  none     5      5  QLT_
   14   Proc  even  none    90    132  Z8AN$ADD_DPIS_FOR_STRUCTURE
   15  RoData even  none     4      4  Z8AN$ADD_DPIS_FOR_STRUCTURE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes    yes     yes      Std        2  Z8AN$ADD_DPIS_FOR_STRUCTURE
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:85   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILS_STEP_TABLE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:86   


      482        1        /*T***********************************************************/
      483        2        /*T*                                                         */
      484        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      485        4        /*T*                                                         */
      486        5        /*T***********************************************************/
      487        6        Z8AN$ADD_DPIS_FOR_STRUCTURE: PROC(QLT$$, DPI$$) ALTRET;

      6 14 000000   000000 700200 xent  Z8AN$ADD_DP* TSX0  ! X66_AUTO_2
        14 000001   000012 000002                    ZERO    10,2

      488        7        /*D*
      489        8             NAME: Z8AN$ADD_DPIS_FOR_STRUCTURE
      490        9             CALL:
      491       10                  CALL Z8AN$ADD_DPIS_FOR_STRUCTURE (QLT$$, DPI$$);
      492       11             PARAMETERS:
      493       12                  QLT$$ - Points to QLT item from which DPIs are created.
      494       13                  DPI$$ - Points to DPI item (possibly a chain of em)
      495       14             DESCRIPTION:
      496       15                  Create a DPI chain for every item in a structure.
      497       16                  When a group level item is redefined, all the items
      498       17                  below it in the structure are also redefined.  This
      499       18                  procedure is called recursively to walk the QLT for
      500       19                  ST$$.  By 'redefined' above, I mean that the item is
      501       20                  changed, as when its a recieving guy in a MOVE.
      502       21
      503       22                  If the all the DPIs cant be created then altreturn
      504       23                  will be taken.
      505       24        */
      506       25
      507       26    1   DCL DPI$$ PTR;
      508       27    1   DCL P$ PTR;
      509       28    1   DCL P2$ PTR;
      510       29    1   DCL QLT$$ PTR;
      511       30    1   DCL LQLT$ PTR;
      512       31
      513       32        %EQU PHASE = 0;
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:87   
      514       33        %INCLUDE Z8A_DEFC;
      515      101        %INCLUDE Z8A_SUPP_MAC;
      516     2501        %INCLUDE Z8A_ETT;
      517     2802        %INCLUDE Z8A_ILS;
      518     2911        %INCLUDE Z8A_DPI;
      519     2995        %INCLUDE Z8A_ST;
      520     6654        %INCLUDE Z8A_QLT;
      521     6760    1   DCL Z8AR$RESERVER ENTRY (1);
      522     6761
      523     6762
      524     6763    1       P$ = DPI$$;

   6763 14 000002   200004 470500                    LDP0    @DPI$$,,AUTO
        14 000003   000000 236100                    LDQ     0,,PR0
        14 000004   200005 756100                    STQ     P$,,AUTO

      525     6764    1       LQLT$ = QLT$$;

   6764 14 000005   200003 471500                    LDP1    @QLT$$,,AUTO
        14 000006   100000 236100                    LDQ     0,,PR1
        14 000007   200007 756100                    STQ     LQLT$,,AUTO

      526     6765
      527     6766
      528     6767    2       DO WHILE LQLT$ ~= ADDR(NIL);

   6767 14 000010   000124 710000 14                 TRA     s:6809

      529     6768    3        IF LQLT$ -> QLT.ST$ -> ST.ID ~= %CONDITION THEN DO;

   6768 14 000011   200007 470500                    LDP0    LQLT$,,AUTO
        14 000012   000004 471500                    LDP1    4,,PR0
        14 000013   100000 220100                    LDX0    0,,PR1
        14 000014   000764 100003                    CMPX0   500,DU
        14 000015   000121 600000 14                 TZE     s:6808

      530     6769    3         IF LQLT$ -> QLT.ST$ -> VARIABLE.B.RENAMED
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:88   

   6769 14 000016   100003 236100                    LDQ     3,,PR1
        14 000017   400000 316007                    CANQ    -131072,DL
        14 000020   000024 601000 14                 TNZ     s:6771
        14 000021   000000 236100                    LDQ     0,,PR0
        14 000022   040000 316007                    CANQ    16384,DL
        14 000023   000025 600000 14                 TZE     s:6773

      531     6770    3            OR LQLT$ -> QLT.B.RENAMES THEN
      532     6771    3           ALTRETURN;

   6771 14 000024   000000 702200 xent               TSX2  ! X66_AALT

      533     6772
      534     6773    3         P2$ = P$;

   6773 14 000025   200005 236100                    LDQ     P$,,AUTO
        14 000026   200006 756100                    STQ     P2$,,AUTO

      535     6774
      536     6775              %BUILD_DPI(@DPI$=P$,
      537     6776                         @DNAME="LQLT$->QLT.ST$");

   6783 14 000027   000002 236000 8                  LDQ     DPI_+2
        14 000030   000003 036007                    ADLQ    3,DL
        14 000031   000003 116000 8                  CMPQ    DPI_+3
        14 000032   000043 602000 14                 TNC     s:6785

   6784 14 000033   000002 236000 15                 LDQ     2
        14 000034   200010 756100                    STQ     LQLT$+1,,AUTO
        14 000035   200010 631500                    EPPR1   LQLT$+1,,AUTO
        14 000036   200011 451500                    STP1    LQLT$+2,,AUTO
        14 000037   200011 630500                    EPPR0   LQLT$+2,,AUTO
        14 000040   000001 631400 15                 EPPR1   1
        14 000041   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000042   000000 011000                    NOP     0

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:89   
   6785 14 000043   000002 236000 8                  LDQ     DPI_+2
        14 000044   000022 736000                    QLS     18
        14 000045   000001 036000 8                  ADLQ    DPI_+1
        14 000046   200005 756100                    STQ     P$,,AUTO

   6786 14 000047   000002 235000 8                  LDA     DPI_+2
        14 000050   000003 035007                    ADLA    3,DL
        14 000051   000002 755000 8                  STA     DPI_+2

   6787 14 000052   000743 220003                    LDX0    483,DU
        14 000053   200005 470500                    LDP0    P$,,AUTO
        14 000054   000000 740100                    STX0    0,,PR0

   6788 14 000055   000000 236000 15                 LDQ     0
        14 000056   200005 470500                    LDP0    P$,,AUTO
        14 000057   000002 756100                    STQ     2,,PR0

   6791 14 000060   200007 470500                    LDP0    LQLT$,,AUTO
        14 000061   000004 236100                    LDQ     4,,PR0
        14 000062   200005 471500                    LDP1    P$,,AUTO
        14 000063   100001 756100                    STQ     1,,PR1

   6792 14 000064   000000 236000 15                 LDQ     0
        14 000065   200005 471500                    LDP1    P$,,AUTO
        14 000066   100002 756100                    STQ     2,,PR1

      538     6795    3         IF LQLT$ -> VARIABLE.LTS$ ~= ADDR(NIL) AND

   6795 14 000067   000005 236100                    LDQ     5,,PR0
        14 000070   000000 116000 15                 CMPQ    0
        14 000071   000100 600000 14                 TZE     s:6798
        14 000072   000005 471500                    LDP1    5,,PR0
        14 000073   100000 221100                    LDX1    0,,PR1
        14 000074   000015 101003                    CMPX1   13,DU
        14 000075   000100 601000 14                 TNZ     s:6798

      539     6796    3             LQLT$ -> VARIABLE.LTS$ -> ETT.ID = %TRIAD THEN
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:90   
      540     6797    3           LQLT$ -> VARIABLE.LTS$ = ADDR(NIL);

   6797 14 000076   000000 236000 15                 LDQ     0
        14 000077   000005 756100                    STQ     5,,PR0

      541     6798    3         P2$ -> DPI.NEXT = P$;

   6798 14 000100   200005 236100                    LDQ     P$,,AUTO
        14 000101   200006 471500                    LDP1    P2$,,AUTO
        14 000102   100002 756100                    STQ     2,,PR1

      542     6799
      543     6800    3         IF (LQLT$ -> QLT.SON ~= ADDR(NIL)) THEN

   6800 14 000103   000003 236100                    LDQ     3,,PR0
        14 000104   000000 116000 15                 CMPQ    0
        14 000105   000121 600000 14                 TZE     s:6808

      544     6801    3           CALL Z8AN$ADD_DPIS_FOR_STRUCTURE(LQLT$ -> QLT.SON, P$)

   6801 14 000106   200005 633500                    EPPR3   P$,,AUTO
        14 000107   200011 453500                    STP3    LQLT$+2,,AUTO
        14 000110   200007 236100                    LDQ     LQLT$,,AUTO
        14 000111   000003 036003                    ADLQ    3,DU
        14 000112   200010 756100                    STQ     LQLT$+1,,AUTO
        14 000113   200010 630500                    EPPR0   LQLT$+1,,AUTO
        14 000114   000003 631400 15                 EPPR1   3
        14 000115   000000 701000 14                 TSX1    s:6
        14 000116   000120 702000 14                 TSX2    s:6804
        14 000117   000121 710000 14                 TRA     s:6808

      545     6802    3             WHENALTRETURN
      546     6803    4               DO;

      547     6804    4                 ALTRETURN;

   6804 14 000120   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:91   

      548     6805    4               END;
      549     6806
      550     6807    3        END; /* NOT CONDITION */

      551     6808    2        LQLT$ = LQLT$ -> QLT.BROTHER;

   6808 14 000121   200007 470500                    LDP0    LQLT$,,AUTO
        14 000122   000002 236100                    LDQ     2,,PR0
        14 000123   200007 756100                    STQ     LQLT$,,AUTO

      552     6809    2       END; /* DO WHILE */

   6809 14 000124   000000 116000 15                 CMPQ    0
        14 000125   000011 601000 14                 TNZ     s:6768

      553     6810
      554     6811    1       DPI$$ = P$;

   6811 14 000126   200005 236100                    LDQ     P$,,AUTO
        14 000127   200004 470500                    LDP0    @DPI$$,,AUTO
        14 000130   000000 756100                    STQ     0,,PR0

      555     6812    1   END Z8AN$ADD_DPIS_FOR_STRUCTURE;

   6812 14 000131   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:92   
--  Include file information  --

   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8AN$ADD_DPIS_FOR_STRUCTURE.
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:93   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 002 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 003 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 004 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:94   
  ****  Section 005 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 006 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 007 LblCom DPI$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DPI$

  ****  Section 008 LblCom DPI_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 DPI_

  ****  Section 009 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 010 LblCom ST_

PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:95   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 011 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 012 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 013 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DPI$$                     3-0-0/w PTR         r     1 @QLT$$
    *0-0-0/w PTR         r     1 DPI$$                      7-0-0/w PTR         r     1 LQLT$
     5-0-0/w PTR         r     1 P$                         6-0-0/w PTR         r     1 P2$
    *0-0-0/w PTR         r     1 QLT$$

  ****  SYMREF variables  ****
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:96   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(396)         1 CD
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(108)   r     1 DPI                        0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(180)         1 ILS
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(216)   r     1 QLT                        0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(396)   r     1 VARIABLE


   Procedure Z8AN$ADD_DPIS_FOR_STRUCTURE requires 90 words for executable code.
   Procedure Z8AN$ADD_DPIS_FOR_STRUCTURE requires 10 words of local(AUTO) storage.
PL6.E3A0      #002=Z8AN$ADD_DPIS_FOR_STRUCTURE File=Z8AN.:Z8A6TSI                SAT 08/09/97 10:51 Page:97   

    No errors detected in file Z8AN.:Z8A6TSI    .
