VERSION A01

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:1    
        1        1        /*M*    XSS$DECODE      Decode an incoming Session PDU                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$DECODE
        9        9                    This routine decodes one or more incoming Session PDUs and fills
       10       10                    in a Session FPT structure for each one.  The Session state
       11       11                    machine is then called.  ALTRETURNs if anything wrong with SPDU.
       12       12        */
       13       13        XSS$DECODE: PROC( VBLK) ALTRET;
       14       14        %INCLUDE UM_CP6;
       15      866        %INCLUDE K_ADDRESS_M;
       16     1369        %INCLUDE XSS_SESSION_E;
       17     1934        %INCLUDE XSS_SESSION_M;
       18     4577            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       19     7956            %XSS_PRIMITIVES( STCLASS="CONSTANT SYMDEF");
       20    11335        %INCLUDE XSS_INTERNAL_E;
       21    11633        %INCLUDE XSS_INTERNAL_M;
       22    12222            %XSS$VBLK( NAME=VBLK, STCLASS="");
       23    12327            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( VBLK.CTX$)");
       24    12761        %INCLUDE XSC_COMMON_M;
       25    13414            %XSC$ADDRESS( NAME=UADR, STCLASS=BASED);
       26    13697        %SET NEXTBYTE = CHARTEXT( CONCAT(
       27    13698                'ASCBIN( SUBSTR( PDU, PDUIDX, 1));',
       28    13699                'PDUIDX = PDUIDX + 1;',
       29    13700                'CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;'));
       30    13701        %EQU ITEMMAX = 31;
       31    13702        %EQU MAXDEPTH = 4;
       32    13703
       33    13704    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       34    13705    1       DCL XSS$MACHINE ENTRY(1) ALTRET;
       35    13706    1       DCL XSS$EVLOG ENTRY(2);
       36    13707
       37    13708    1       DCL XSS_ITEMCNT SBIN SYMREF;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:2    
       38    13709
       39    13710    1       DCL B$BIT8 BIT(8) BASED UNAL;
       40    13711    1       DCL B$UBIN UBIN BASED;
       41    13712    1       DCL B$UBIN9 UBIN(9) BASED CALIGNED;
       42    13713    1       DCL BTMP BIT(36) ALIGNED;
       43    13714    1       DCL BYTES CHAR( SCANITEM.X.LEN) BASED CALIGNED;
       44    13715    1       DCL CURRLEN(0:%MAXDEPTH) SBIN;
       45    13716    1       DCL DATALEN SBIN;
       46    13717    1       DCL DATALVL SBIN;
       47    13718    1       DCL DATATAG SBIN;
       48    13719    1       DCL DEPTH SBIN;
       49    13720    1       DCL DST$ PTR CALIGNED;
       50    13721    1       DCL BDST$ PTR UNAL;
       51    13722    1       DCL DSTLEN SBIN;
       52    13723    1       DCL DSTBYTES CHAR( DSTLEN) BASED CALIGNED;
       53    13724    1       DCL I SBIN;
       54    13725    1       DCL INITLEN(0:%MAXDEPTH) SBIN;
       55    13726    1       DCL ITEMCUR SBIN;
       56    13727    1       DCL ITEMNUM SBIN;
       57    13728    1       DCL PDU CHAR(16384) BASED( PDU$) CALIGNED;
       58    13729    1       DCL PDU$ PTR CALIGNED;
       59    13730    1       DCL PDUIDX SBIN;
       60    13731    1       DCL SFPT$ PTR;
       61    13732    1       DCL SPDUCUR SBIN;
       62    13733    1       DCL SPDUNUM SBIN;
       63    13734    1       DCL 1 SPDULIST(0:3),
       64    13735    1            2 TAG UBIN BYTE CALIGNED,
       65    13736    1            2 ITEMFRST UBIN BYTE CALIGNED,
       66    13737    1            2 ITEMLAST UBIN BYTE CALIGNED,
       67    13738    1            2 ORDER UBIN BYTE CALIGNED;
       68    13739    1       DCL SRC$ PTR CALIGNED;
       69    13740    1       DCL BSRC$ PTR UNAL;
       70    13741    1       DCL SRCLEN SBIN;
       71    13742    1       DCL SRCBYTES CHAR( SRCLEN) BASED CALIGNED;
       72    13743    1       DCL TAG SBIN;
       73    13744    1       DCL TEMP SBIN;
       74    13745    1       DCL 1 TXTC BASED,
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:3    
       75    13746    1            2 LEN UBIN BYTE CALIGNED,
       76    13747    1            2 TXT CHAR(16384) CALIGNED;
       77    13748            %ITEM( NAME=SCANITEM, STCLASS=AUTO);              /* THESE TWO LINES..  */
       78    13773            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);/* MUST BE CONTIGUOUS */
       79    13798
       80    13799    1       SFPT$ = VBLK.FPT$;
       81    13800    1       PDU$ = VBLK.PDU.PTR$;
       82    13801    1       TEMP = VBLK.PDU.SIZE;
       83    13802    1       INITLEN = '0'B;
       84    13803    1       INITLEN(0) = TEMP;
       85    13804    1       INITLEN(1) = TEMP;
       86    13805    1       CURRLEN = '0'B;
       87    13806    1       CURRLEN(0) = TEMP;
       88    13807    1       CURRLEN(1) = TEMP;
       89    13808    1       ITEMLIST = '0'B;
       90    13809    1       ITEMLIST.Z(0) = TEMP*262144;  /* set up LEN */
       91    13810    1       ITEMLIST.P(0) = PDU$;
       92    13811    1       SPDULIST = '0'B;
       93    13812    1       SPDUNUM = 0;
       94    13813    1       ITEMNUM = 1;
       95    13814    1       DEPTH = 1;
       96    13815    1       PDUIDX = 0;
       97    13816        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:4    
       98    13817    1   NEXTITEM:
       99    13818    2       IF CURRLEN( DEPTH) > 0 THEN DO;
      100    13819    2           TAG = %NEXTBYTE;
      101    13820    3           IF DEPTH = 1 THEN DO;
      102    13821                    /* beginning of an SPDU */
      103    13822    3               SPDULIST.TAG( SPDUNUM) = TAG;
      104    13823    3               SPDULIST.ITEMFRST( SPDUNUM) = ITEMNUM;
      105    13824    3               END;
      106    13825    2           CALL GETLEN ALTRET( SCANERR);  /* parse length of item into TEMP */
      107    13826    2           ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512 + TEMP*262144;
      108    13827    2           ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);
      109    13828    2           ITEMNUM = ITEMNUM + 1;
      110    13829    2           IF DEPTH = 1 OR
      111    13830    3                   ( TAG = %PGI_CI OR TAG = %PGI_CAI OR TAG = %PGI_LI) THEN DO;
      112    13831                    /* this is a constructed item */
      113    13832    3               DEPTH = DEPTH + 1;
      114    13833    3               IF DEPTH > %MAXDEPTH THEN
      115    13834    3                   GOTO SCANERR;
      116    13835    3               CURRLEN( DEPTH) = TEMP;
      117    13836    3               INITLEN( DEPTH) = TEMP;
      118    13837    3               GOTO NEXTITEM;
      119    13838    3               END;
      120    13839    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - TEMP;
      121    13840    2           PDUIDX = PDUIDX + TEMP;
      122    13841    2           IF PDUIDX < VBLK.PDU.SIZE THEN
      123    13842    2               GOTO NEXTITEM;
      124    13843    2           END;
      125    13844            /* reached the end of an item */
      126    13845    1       TEMP = DEPTH;
      127    13846    1       DEPTH = DEPTH - 1;
      128    13847    2       IF DEPTH >= 0 THEN DO;
      129    13848    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - INITLEN( TEMP);
      130    13849    2           INITLEN( TEMP) = 0;
      131    13850    3           IF DEPTH = 1 THEN DO;
      132    13851    3               TAG = SPDULIST.TAG( SPDUNUM);
      133    13852    3               IF CURRLEN( DEPTH) > 0 AND
      134    13853    3                       ( ( TAG = %SI_DT AND SPDUNUM > 0) OR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:5    
      135    13854    4                         TAG = %SI_EX OR TAG = %SI_TD) THEN DO;
      136    13855                        /* handle User Information Field specially */
      137    13856    4                   ITEMLIST.Z( ITEMNUM) = ( DEPTH+1) + CURRLEN( DEPTH)*262144;
      138    13857    4                   ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);
      139    13858    4                   ITEMNUM = ITEMNUM + 1;
      140    13859    4                   CURRLEN( DEPTH) = 0;
      141    13860    4                   END;
      142    13861                    /* end of an SPDU */
      143    13862    3               SPDULIST.ITEMLAST( SPDUNUM) = ITEMNUM;
      144    13863    3               SPDUNUM = SPDUNUM + 1;
      145    13864    3               END;
      146    13865    2           GOTO NEXTITEM;
      147    13866    2           END;
      148    13867        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:6    
      149    13868            /* Done scanning the SPDU(s).. order them if necessary */
      150    13869    2       DO CASE( SPDUNUM);
      151    13870    2           CASE( 1);  /* no concatenation */
      152    13871                    /* Any category 0 or category 1 SPDU is fine as-is. */
      153    13872    2               SPDULIST.ORDER(0) = 0;
      154    13873    2           CASE( 2);  /* basic or extended concatenation */
      155    13874                    /* GT/PT, other */
      156    13875    2               SPDULIST.ORDER(1) = 0;  /* Any other SPDU is handled.. */
      157    13876    2               SPDULIST.ORDER(0) = 1;  /* before the GT or PT SPDU. */
      158    13877    2           CASE( 3);  /* extended concatenation */
      159    13878    2               TAG = SPDULIST.TAG(1);
      160    13879    3               IF TAG = %SI_AS OR TAG = %SI_AR THEN DO;
      161    13880                        /* GT, AS/AR, MIP/MAP/AE or */
      162    13881                        /* GT, AS/AR, DT */
      163    13882    3                   SPDULIST.ORDER(1) = 0;  /* Handle the AS or AR first.. */
      164    13883    3                   SPDULIST.ORDER(2) = 1;  /* then the DT or MIP/MAP/AE.. */
      165    13884    3                   END;
      166    13885    3               ELSE DO;
      167    13886                        /* GT, AE/AEA, DT or */
      168    13887                        /* GT, MIP/MIA/MAP/MAA, DT */
      169    13888    3                   SPDULIST.ORDER(2) = 0;  /* Handle the DT SPDU first.. */
      170    13889    3                   SPDULIST.ORDER(1) = 1;  /* then the MIP/MIA/MAP/MAA.. */
      171    13890    3                   END;
      172    13891    2               SPDULIST.ORDER(0) = 2;  /* and finally do the GT SPDU. */
      173    13892    2           CASE( 4);  /* extended concatenation */
      174    13893                    /* GT, AS/AR, MIP/MAP/AE, DT */
      175    13894    2               SPDULIST.ORDER(1) = 0;  /* Handle the AS or AR SPDU first.. */
      176    13895    2               SPDULIST.ORDER(3) = 1;  /* then the DT SPDU.. */
      177    13896    2               SPDULIST.ORDER(2) = 2;  /* then the MIP, MAP, or AE SPDU.. */
      178    13897    2               SPDULIST.ORDER(0) = 3;  /* and finally the GT SPDU. */
      179    13898    2           CASE( ELSE);
      180    13899    2               GOTO SCANERR;
      181    13900    2           END;
      182    13901        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:7    
      183    13902    1       XSS_ITEMCNT = -1;  /* make SCAN/LOAD load into SCANITEM, not ITEMLIST */
      184    13903    1       ITEMCUR = 0;
      185    13904    1       ITEMNUM = 0;
      186    13905            %SCAN( LVL=0, TYP=NONE, LEN="VBLK.PDU.SIZE");
      187    13974            /* Now process each concatenated SPDU in turn, in the correct order */
      188    13975    1       SPDUCUR = 0;
      189    13976    1   NEXTSPDU:
      190    13977    2       DO TEMP = 0 TO 3;
      191    13978    3           IF SPDULIST.ORDER( TEMP) = SPDUCUR THEN DO;
      192    13979    3               ITEMCUR = SPDULIST.ITEMFRST( TEMP);
      193    13980    3               ITEMNUM = SPDULIST.ITEMLAST( TEMP);
      194    13981    3               EXIT NEXTSPDU;
      195    13982    3               END;
      196    13983    2           END;
      197    13984    1       DATALVL = 0;
      198    13985    1       DATALEN = 262143;  /* max length of UserData unless changed */
      199    13986    1       DATATAG = %PGI_DATA;
      200    13987    1       TEMP = ITEMLIST.X.TAG( ITEMCUR);
      201    13988    1       CALL XSS$EVLOG( 'DP', TEMP*512 + SCTX.SCID);
      202    13989    1   SFNCCASE:
      203    13990    2       DO CASE( TEMP);
      204    13991        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:8    
      205    13992        /*****************************************************************************
      206    13993        *
      207    13994        *       AA              ABORT ACCEPT SPDU
      208    13995        *       AIA             ACTIVITY INTERRUPT ACK SPDU
      209    13996        *
      210    13997        *****************************************************************************/
      211    13998    2           CASE( %SI_AA);  /* ..same as %SI_AIA */
      212    13999                    %SCAN( LVL=1, TAG=SI_AA, TYP=NONE);
      213    14068    2               VBLK.EVENT = %XSS_SEV_AA;  /* ..same as %XSS_SEV_AIA */
      214    14069        /*****************************************************************************
      215    14070        *
      216    14071        *       AB_NR           ABORT (NO REUSE) SPDU
      217    14072        *       AB_R            ABORT (REUSE) SPDU
      218    14073        *       AI              ACTIVITY INTERRUPT SPDU
      219    14074        *
      220    14075        *****************************************************************************/
      221    14076    2           CASE( %SI_AB);  /* ..same as %SI_AI */
      222    14077                    %SCAN( LVL=1, TAG=SI_AB, TYP=NONE);
      223    14146    3               IF SPDUNUM = 1 THEN DO;  /* AB is never concatenated */
      224    14147                        /* this is an AB SPDU */
      225    14148    3                   XSS$U_ABORT = XSS_U_ABORT;
      226    14149    3                   XSS$U_ABORT.FNC = %XSS_FNC_SUABIND#;
      227    14150                        %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL=BTMP);
      228    14219    3                   SCTX.TD = BTMP;
      229    14220    3                   SCTX.RPV = '0'B;
      230    14221                        %SCAN( LVL=2, TAG=PGI_RPV, TYP=CPTR, OPT=Y,
      231    14222                                LEN=9, VAL="SCTX.RPV");
      232    14291    3                   DATALVL = 2;
      233    14292    3                   IF SCTX.TD.TCREL THEN
      234    14293    3                       VBLK.EVENT = %XSS_SEV_AB_NR;
      235    14294    3                   ELSE
      236    14295    3                       VBLK.EVENT = %XSS_SEV_AB_R;
      237    14296    3                   END;
      238    14297    3               ELSE DO;  /* AI is always concatenated */
      239    14298                        /* this is an AI SPDU */
      240    14299    3                   XSS$ACTIVITY_INTERRUPT = XSS_ACTIVITY_INTERRUPT;
      241    14300    3                   XSS$ACTIVITY_INTERRUPT.FNC = %XSS_FNC_SACIIND#;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:9    
      242    14301                        %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);
      243    14370    3                   XSS$ACTIVITY_INTERRUPT.REASON = TEMP;
      244    14371    3                   VBLK.EVENT = %XSS_SEV_AI;
      245    14372    3                   END;
      246    14373        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:10   
      247    14374        /*****************************************************************************
      248    14375        *
      249    14376        *       AC              ACCEPT SPDU
      250    14377        *
      251    14378        *****************************************************************************/
      252    14379    2           CASE( %SI_AC);
      253    14380    2               XSS$CONNECT = XSS_CONNECT;
      254    14381    2               XSS$CONNECT.FNC = %XSS_FNC_SCONCNF#;
      255    14382    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);
      256    14383    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);
      257    14384    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);
      258    14385                    %SCAN( LVL=1, TAG=SI_AC, TYP=NONE);
      259    14454                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);
      260    14523    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;
      261    14524                        %SCAN( LVL=3, TAG=PI_ASSUR, TYP=TXTC, OPT=Y,
      262    14525                                LEN=224, VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");
      263    14594                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      264    14595                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");
      265    14664                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      266    14665                                LEN=4, VAL="XSS$CONNECT.ARI");
      267    14734    3                   END;
      268    14735                    %SCAN( LVL=2, TAG=PGI_CAI, TYP=NONE, OPT=Y);
      269    14804    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;
      270    14805                        %SCAN( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL=TEMP);
      271    14874    3                   SCTX.PO = TEMP;
      272    14875                        %SCAN( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, OPT=Y,
      273    14876                                LEN=4, VAL=TEMP);
      274    14945    3                   SCTX.TSDUMS.INI = TEMP / 65536;
      275    14946    3                   SCTX.TSDUMS.RSP = MOD( TEMP, 65536);
      276    14947                        %SCAN( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL=TEMP);
      277    15016    3                   SCTX.VN = TEMP;
      278    15017                        %SCAN( LVL=3, TAG=PI_ISN, TYP=UBC6, OPT=Y,
      279    15018                                LEN=6, VAL="XSS$CONNECT.SERNUM");
      280    15087                        %SCAN( LVL=3, TAG=PI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      281    15156    3                   XSS$CONNECT.ITOKENS = BTMP;
      282    15157    3                   END;
      283    15158                    %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:11   
      284    15227    2               XSS$CONNECT.TOKENS = BTMP;
      285    15228    2               SCTX.FU = '0'B;
      286    15229    2               SCTX.FU.HD = %TRUE;
      287    15230    2               SCTX.FU.SY = %TRUE;
      288    15231    2               SCTX.FU.ACT = %TRUE;
      289    15232    2               SCTX.FU.CD = %TRUE;
      290    15233    2               SCTX.FU.EXCEP = %TRUE;
      291    15234                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);
      292    15303    2               XSS$CONNECT.SFU = BTMP;
      293    15304                    %SCAN( LVL=2, TAG=PGI_ISSEL, TYP=TXTC, OPT=Y,
      294    15305                            LEN=16, VAL="XSS$CONNECT.CALLING$->UADR.SSAP");
      295    15374    2               XSS$CONNECT.RESPONDING$->UADR.SSAP = '0'B;
      296    15375                    %SCAN( LVL=2, TAG=PGI_ASSEL, TYP=TXTC, OPT=Y,
      297    15376                            LEN=16, VAL="XSS$CONNECT.RESPONDING$->UADR.SSAP");
      298    15445    2               DATALVL = 2;
      299    15446    2               VBLK.EVENT = %XSS_SEV_AC;
      300    15447        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:12   
      301    15448        /*****************************************************************************
      302    15449        *
      303    15450        *       AD              ACTIVITY DISCARD SPDU
      304    15451        *
      305    15452        *****************************************************************************/
      306    15453    2           CASE( %SI_AD);
      307    15454    2               XSS$ACTIVITY_DISCARD = XSS_ACTIVITY_DISCARD;
      308    15455    2               XSS$ACTIVITY_DISCARD.FNC = %XSS_FNC_SACDIND#;
      309    15456                    %SCAN( LVL=1, TAG=SI_AD, TYP=NONE);
      310    15525                    %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);
      311    15594    2               XSS$ACTIVITY_DISCARD.REASON = TEMP;
      312    15595    2               VBLK.EVENT = %XSS_SEV_AD;
      313    15596        /*****************************************************************************
      314    15597        *
      315    15598        *       ADA             ACTIVITY DISCARD ACK SPDU
      316    15599        *
      317    15600        *****************************************************************************/
      318    15601    2           CASE( %SI_ADA);
      319    15602                    %SCAN( LVL=1, TAG=SI_ADA, TYP=NONE);
      320    15671    2               VBLK.EVENT = %XSS_SEV_ADA;
      321    15672        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:13   
      322    15673        /*****************************************************************************
      323    15674        *
      324    15675        *       AE              ACTIVITY END SPDU
      325    15676        *       MAP             MAJOR SYNC POINT SPDU
      326    15677        *
      327    15678        *****************************************************************************/
      328    15679    2           CASE( %SI_AE);  /* ..same as %SI_MAP */
      329    15680                    %SCAN( LVL=1, TAG=SI_AE, TYP=NONE);
      330    15749    2               IF ITEMCUR <= ITEMNUM AND
      331    15750    3                       ITEMLIST.X.TAG( ITEMCUR) = %PGI_STI THEN DO;
      332    15751                        /* this is a MAP SPDU */
      333    15752    3                   XSS$SYNC_MAJOR = XSS_SYNC_MAJOR;
      334    15753    3                   XSS$SYNC_MAJOR.FNC = %XSS_FNC_SSMAIND#;
      335    15754                        %SCAN( LVL=2, TAG=PGI_STI, TYP=UBIN, LEN=1, VAL=TEMP);
      336    15823    3                   XSS$SYNC_MAJOR.TYPE = TEMP;
      337    15824                        %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      338    15825                                LEN=6, VAL="XSS$SYNC_MAJOR.SERNUM");
      339    15894    3                   DATALVL = 2;
      340    15895    3                   VBLK.EVENT = %XSS_SEV_MAP;
      341    15896    3                   END;
      342    15897    3               ELSE DO;
      343    15898                        /* this is an AE SPDU */
      344    15899    3                   XSS$ACTIVITY_END = XSS_ACTIVITY_END;
      345    15900    3                   XSS$ACTIVITY_END.FNC = %XSS_FNC_SACEIND#;
      346    15901                        %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      347    15902                                LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");
      348    15971    3                   DATALVL = 2;
      349    15972    3                   VBLK.EVENT = %XSS_SEV_AE;
      350    15973    3                   END;
      351    15974        /*****************************************************************************
      352    15975        *
      353    15976        *       AEA             ACTIVITY END ACK SPDU
      354    15977        *       MAA             MAJOR SYNC ACK SPDU
      355    15978        *
      356    15979        *****************************************************************************/
      357    15980    2           CASE( %SI_AEA); /* ..same as %SI_MAA */
      358    15981    2               XSS$ACTIVITY_END = XSS_ACTIVITY_END;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:14   
      359    15982    2               XSS$ACTIVITY_END.FNC = %XSS_FNC_SACECNF#;
      360    15983                    %SCAN( LVL=1, TAG=SI_AEA, TYP=NONE);
      361    16052                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      362    16053                            LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");
      363    16122    2               DATALVL = 2;
      364    16123    2               VBLK.EVENT = %XSS_SEV_AEA;  /* ..same as %XSS_SEV_MAA */
      365    16124        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:15   
      366    16125        /*****************************************************************************
      367    16126        *
      368    16127        *       AR              ACTIVITY RESUME SPDU
      369    16128        *
      370    16129        *****************************************************************************/
      371    16130    2           CASE( %SI_AR);
      372    16131    2               XSS$ACTIVITY_RESUME = XSS_ACTIVITY_RESUME;
      373    16132    2               XSS$ACTIVITY_RESUME.FNC = %XSS_FNC_SACRIND#;
      374    16133    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$ACTIVITY_RESUME.CALLING$);
      375    16134    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$ACTIVITY_RESUME.CALLED$);
      376    16135    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$ACTIVITY_RESUME.COMMON$);
      377    16136                    %SCAN( LVL=1, TAG=SI_AR, TYP=NONE);
      378    16205                    %SCAN( LVL=2, TAG=PGI_LI, TYP=NONE);
      379    16274                    %SCAN( LVL=3, TAG=PI_ASSEL, TYP=TXTC, OPT=Y,
      380    16275                            LEN=224, VAL="XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP");
      381    16344                    %SCAN( LVL=3, TAG=PI_ISSEL, TYP=TXTC, OPT=Y,
      382    16345                            LEN=224, VAL="XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP");
      383    16414                    %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      384    16415                            LEN=64, VAL="XSS$ACTIVITY_RESUME.COMMON$->TXTC");
      385    16484                    %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      386    16485                            LEN=4, VAL="XSS$ACTIVITY_RESUME.ARI");
      387    16554                    %SCAN( LVL=3, TAG=PI_AI, TYP=TXTC,
      388    16555                            LEN=6, VAL="XSS$ACTIVITY_RESUME.OACTID");
      389    16624                    %SCAN( LVL=3, TAG=PI_SN, TYP=UBC6,
      390    16625                            LEN=6, VAL="XSS$ACTIVITY_RESUME.SERNUM");
      391    16694                    %SCAN( LVL=2, TAG=PGI_AI, TYP=TXTC,
      392    16695                            LEN=6, VAL="XSS$ACTIVITY_RESUME.ACTID");
      393    16764    2               DATALVL = 2;
      394    16765    2               VBLK.EVENT = %XSS_SEV_AR;
      395    16766        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:16   
      396    16767        /*****************************************************************************
      397    16768        *
      398    16769        *       AS              ACTIVITY START SPDU
      399    16770        *
      400    16771        *****************************************************************************/
      401    16772    2           CASE( %SI_AS);
      402    16773    2               XSS$ACTIVITY_START = XSS_ACTIVITY_START;
      403    16774    2               XSS$ACTIVITY_START.FNC = %XSS_FNC_SACSIND#;
      404    16775                    %SCAN( LVL=1, TAG=SI_AS, TYP=NONE);
      405    16844                    %SCAN( LVL=2, TAG=PGI_AI, TYP=TXTC,
      406    16845                            LEN=6, VAL="XSS$ACTIVITY_START.ACTID");
      407    16914    2               DATALVL = 2;
      408    16915    2               VBLK.EVENT = %XSS_SEV_AS;
      409    16916        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:17   
      410    16917        /*****************************************************************************
      411    16918        *
      412    16919        *       CD              CAPABILITY DATA SPDU
      413    16920        *
      414    16921        *****************************************************************************/
      415    16922    2           CASE( %SI_CD);
      416    16923    2               XSS$CAPABILITY_DATA = XSS_CAPABILITY_DATA;
      417    16924    2               XSS$CAPABILITY_DATA.FNC = %XSS_FNC_SCADIND#;
      418    16925                    %SCAN( LVL=1, TAG=SI_CD, TYP=NONE);
      419    16994    2               DATALVL = 2;
      420    16995    2               VBLK.EVENT = %XSS_SEV_CD;
      421    16996        /*****************************************************************************
      422    16997        *
      423    16998        *       CDA             CAPABILITY DATA ACK SPDU
      424    16999        *
      425    17000        *****************************************************************************/
      426    17001    2           CASE( %SI_CDA);
      427    17002    2               XSS$CAPABILITY_DATA = XSS_CAPABILITY_DATA;
      428    17003    2               XSS$CAPABILITY_DATA.FNC = %XSS_FNC_SCADCNF#;
      429    17004                    %SCAN( LVL=1, TAG=SI_CDA, TYP=NONE);
      430    17073    2               DATALVL = 2;
      431    17074    2               VBLK.EVENT = %XSS_SEV_CDA;
      432    17075        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:18   
      433    17076        /*****************************************************************************
      434    17077        *
      435    17078        *       CN              CONNECT SPDU
      436    17079        *
      437    17080        *****************************************************************************/
      438    17081    2           CASE( %SI_CN);
      439    17082    2               XSS$CONNECT = XSS_CONNECT;
      440    17083    2               XSS$CONNECT.FNC = %XSS_FNC_SCONIND#;
      441    17084    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);
      442    17085    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.CALLED$);
      443    17086    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);
      444    17087                    %SCAN( LVL=1, TAG=SI_CN, TYP=NONE);
      445    17156                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);
      446    17225    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;
      447    17226                        %SCAN( LVL=3, TAG=PI_ISSUR, TYP=TXTC, OPT=Y,
      448    17227                                LEN=224, VAL="XSS$CONNECT.CALLING$->UADR.PSAP");
      449    17296                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      450    17297                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");
      451    17366                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      452    17367                                LEN=4, VAL="XSS$CONNECT.ARI");
      453    17436    3                   END;
      454    17437                    %SCAN( LVL=2, TAG=PGI_CAI, TYP=NONE, OPT=Y);
      455    17506    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;
      456    17507                        %SCAN( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL=TEMP);
      457    17576    3                   SCTX.PO = TEMP;
      458    17577                        %SCAN( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, OPT=Y,
      459    17578                                LEN=4, VAL=TEMP);
      460    17647    3                   SCTX.TSDUMS.INI = TEMP / 65536;
      461    17648    3                   SCTX.TSDUMS.RSP = MOD( TEMP, 65536);
      462    17649                        %SCAN( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL=TEMP);
      463    17718    3                   SCTX.VN = TEMP;
      464    17719                        %SCAN( LVL=3, TAG=PI_ISN, TYP=UBC6, OPT=Y,
      465    17720                                LEN=6, VAL="XSS$CONNECT.SERNUM");
      466    17789                        %SCAN( LVL=3, TAG=PI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      467    17858    3                   XSS$CONNECT.ITOKENS = BTMP;
      468    17859    3                   END;
      469    17860    2               XSS$CONNECT.SFU = '0'B;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:19   
      470    17861    2               XSS$CONNECT.SFU.HD = %TRUE;
      471    17862    2               XSS$CONNECT.SFU.SY = %TRUE;
      472    17863    2               XSS$CONNECT.SFU.ACT = %TRUE;
      473    17864    2               XSS$CONNECT.SFU.CD = %TRUE;
      474    17865    2               XSS$CONNECT.SFU.EXCEP = %TRUE;
      475    17866                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);
      476    17935    2               XSS$CONNECT.SFU = BTMP;
      477    17936    2               SCTX.FU = XSS$CONNECT.SFU;  /* negotiate this down on AC */
      478    17937                    %SCAN( LVL=2, TAG=PGI_ISSEL, TYP=TXTC, OPT=Y,
      479    17938                            LEN=16, VAL="XSS$CONNECT.CALLING$->UADR.SSAP");
      480    18007    2               XSS$CONNECT.CALLED$->UADR.SSAP = '0'B;
      481    18008                    %SCAN( LVL=2, TAG=PGI_ASSEL, TYP=TXTC, OPT=Y,
      482    18009                            LEN=16, VAL="XSS$CONNECT.CALLED$->UADR.SSAP");
      483    18078    2               DATALVL = 2;
      484    18079    2               VBLK.EVENT = %XSS_SEV_CN;
      485    18080        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:20   
      486    18081        /*****************************************************************************
      487    18082        *
      488    18083        *       DN              DISCONNECT SPDU
      489    18084        *
      490    18085        *****************************************************************************/
      491    18086    2           CASE( %SI_DN);
      492    18087    2               XSS$RELEASE = XSS_RELEASE;
      493    18088    2               XSS$RELEASE.FNC = %XSS_FNC_SRELIND#;
      494    18089                    %SCAN( LVL=1, TAG=SI_DN, TYP=NONE);
      495    18158    2               DATALVL = 2;
      496    18159    2               VBLK.EVENT = %XSS_SEV_DN;
      497    18160        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:21   
      498    18161        /*****************************************************************************
      499    18162        *
      500    18163        *       DT              DATA TRANSFER SPDU
      501    18164        *       GT              GIVE TOKENS SPDU
      502    18165        *
      503    18166        *****************************************************************************/
      504    18167    2           CASE( %SI_DT);  /* ..same as %SI_GT */
      505    18168                    %SCAN( LVL=1, TAG=SI_DT, TYP=NONE);
      506    18237    2               IF SCANITEM.X.LEN = 0 AND ITEMCUR = ITEMNUM THEN
      507    18238    2                   GOTO ENDSPDU;
      508    18239    3               IF SPDUCUR = SPDUNUM - 1 THEN DO;  /* GT always last */
      509    18240                        /* this is a GT SPDU */
      510    18241    3                   XSS$TOKEN_GIVE = XSS_TOKEN_GIVE;
      511    18242    3                   XSS$TOKEN_GIVE.FNC = %XSS_FNC_STKGIND#;
      512    18243                        %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      513    18312    3                   IF BTMP = '000000000'B THEN
      514    18313    3                       GOTO ENDSPDU;  /* no tokens given; cut short */
      515    18314    3                   XSS$TOKEN_GIVE.TOKENS = BTMP;
      516    18315    3                   VBLK.EVENT = %XSS_SEV_GT;
      517    18316    3                   END;
      518    18317    3               ELSE DO;  /* DT never last */
      519    18318                        /* this is a DT SPDU */
      520    18319    3                   XSS$DATA = XSS_DATA;
      521    18320    3                   XSS$DATA.FNC = %XSS_FNC_SDATIND#;
      522    18321    4                   IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_EI THEN
             18321                            DO;
      523    18322                            %SCAN( LVL=2, TAG=PGI_EI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      524    18391    4                       VBLK.EI = BTMP;
      525    18392    4                       END;
      526    18393    4                   ELSE DO;
      527    18394    4                       VBLK.EI.BOSSDU = %TRUE;
      528    18395    4                       VBLK.EI.EOSSDU = %TRUE;
      529    18396    4                       END;
      530    18397    3                   DATALVL = 2;
      531    18398    3                   DATATAG = 0;
      532    18399    3                   VBLK.EVENT = %XSS_SEV_DT;
      533    18400    3                   END;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:22   
      534    18401        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:23   
      535    18402        /*****************************************************************************
      536    18403        *
      537    18404        *       ED              EXCEPTION DATA SPDU
      538    18405        *
      539    18406        *****************************************************************************/
      540    18407    2           CASE( %SI_ED);
      541    18408    2               XSS$U_EXCEPTION_REPORT = XSS_U_EXCEPTION_REPORT;
      542    18409    2               XSS$U_EXCEPTION_REPORT.FNC = %XSS_FNC_SUERIND#;
      543    18410                    %SCAN( LVL=1, TAG=SI_ED, TYP=NONE);
      544    18479                    %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, LEN=1, VAL=TEMP);
      545    18548    2               XSS$U_EXCEPTION_REPORT.REASON = TEMP;
      546    18549    2               DATALVL = 2;
      547    18550    2               VBLK.EVENT = %XSS_SEV_ED;
      548    18551        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:24   
      549    18552        /*****************************************************************************
      550    18553        *
      551    18554        *       ER              EXCEPTION REPORT SPDU
      552    18555        *
      553    18556        *****************************************************************************/
      554    18557    2           CASE( %SI_ER);
      555    18558    2               XSS$U_EXCEPTION_REPORT = XSS_U_EXCEPTION_REPORT;
      556    18559    2               XSS$U_EXCEPTION_REPORT.FNC = %XSS_FNC_SPERIND#;
      557    18560                    %SCAN( LVL=1, TAG=SI_ER, TYP=NONE);
      558    18629                    %SCAN( LVL=2, TAG=PGI_RPV, TYP=CPTR, LEN=262143, VAL=NIL);
      559    18698    2               SCANITEM.X.LEN = MINIMUM( 9, SCANITEM.X.LEN);
      560    18699    2               SCTX.RPV = '0'B;
      561    18700    2               ADDR( SCTX.RPV)->BYTES = SCANITEM.P->BYTES;
      562    18701    2               VBLK.EVENT = %XSS_SEV_ER;
      563    18702        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:25   
      564    18703        /*****************************************************************************
      565    18704        *
      566    18705        *       EX              EXPEDITED DATA SPDU
      567    18706        *
      568    18707        *****************************************************************************/
      569    18708    2           CASE( %SI_EX);
      570    18709    2               XSS$EXPEDITED_DATA = XSS_EXPEDITED_DATA;
      571    18710    2               XSS$EXPEDITED_DATA.FNC = %XSS_FNC_SEXPIND#;
      572    18711                    %SCAN( LVL=1, TAG=SI_EX, TYP=NONE);
      573    18780    2               DATALVL = 2;
      574    18781    2               DATALEN = 14;
      575    18782    2               DATATAG = 0;
      576    18783    2               VBLK.EVENT = %XSS_SEV_EX;
      577    18784        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:26   
      578    18785        /*****************************************************************************
      579    18786        *
      580    18787        *       FN_NR           FINISH (NO REUSE) SPDU
      581    18788        *       FN_R            FINISH (REUSE) SPDU
      582    18789        *
      583    18790        *****************************************************************************/
      584    18791    2           CASE( %SI_FN);
      585    18792    2               XSS$RELEASE = XSS_RELEASE;
      586    18793    2               XSS$RELEASE.FNC = %XSS_FNC_SRELCNF#;
      587    18794                    %SCAN( LVL=1, TAG=SI_FN, TYP=NONE);
      588    18863                    %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      589    18932    2               SCTX.TD = BTMP;
      590    18933    2               DATALVL = 2;
      591    18934    2               IF SCTX.TD.TCREL THEN
      592    18935    2                   VBLK.EVENT = %XSS_SEV_FN_NR;
      593    18936    2               ELSE
      594    18937    2                   VBLK.EVENT = %XSS_SEV_FN_R;
      595    18938        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:27   
      596    18939        /*****************************************************************************
      597    18940        *
      598    18941        *       GTA             GIVE TOKENS ACK SPDU
      599    18942        *
      600    18943        *****************************************************************************/
      601    18944    2           CASE( %SI_GTA);
      602    18945                    %SCAN( LVL=1, TAG=SI_GTA, TYP=NONE);
      603    19014    2               VBLK.EVENT = %XSS_SEV_GTA;
      604    19015        /*****************************************************************************
      605    19016        *
      606    19017        *       GTC             GIVE TOKENS CONFIRM SPDU
      607    19018        *
      608    19019        *****************************************************************************/
      609    19020    2           CASE( %SI_GTC);
      610    19021    2               XSS$CONTROL_GIVE = XSS_CONTROL_GIVE;
      611    19022                    %SCAN( LVL=1, TAG=SI_GTC, TYP=NONE);
      612    19091    2               XSS$CONTROL_GIVE.TOKENS.TR = %TRUE;
      613    19092    2               XSS$CONTROL_GIVE.TOKENS.MA = %TRUE;
      614    19093    2               XSS$CONTROL_GIVE.TOKENS.MI = %TRUE;
      615    19094    2               XSS$CONTROL_GIVE.TOKENS.DK = %TRUE;
      616    19095    2               VBLK.EVENT = %XSS_SEV_GTC;
      617    19096        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:28   
      618    19097        /*****************************************************************************
      619    19098        *
      620    19099        *       MIA             MINOR SYNC ACK SPDU
      621    19100        *
      622    19101        *****************************************************************************/
      623    19102    2           CASE( %SI_MIA);
      624    19103    2               XSS$SYNC_MINOR = XSS_SYNC_MINOR;
      625    19104    2               XSS$SYNC_MINOR.FNC = %XSS_FNC_SSMICNF#;
      626    19105                    %SCAN( LVL=1, TAG=SI_MIA, TYP=NONE);
      627    19174                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      628    19175                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");
      629    19244                    %SCAN( LVL=2, TAG=PGI_UD, TYP=CPTR, OPT=Y, LEN=262143, VAL=NIL);
      630    19313    3               IF SCANITEM.X.LEN > 0 THEN DO;
      631    19314    3                   XSS$SYNC_MINOR.DATA.PTR$ = SCANITEM.P;
      632    19315    3                   XSS$SYNC_MINOR.DATA.SIZE = SCANITEM.X.LEN;
      633    19316    3                   END;
      634    19317    2               VBLK.EVENT = %XSS_SEV_MIA;
      635    19318        /*****************************************************************************
      636    19319        *
      637    19320        *       MIP             MINOR SYNC POINT SPDU
      638    19321        *
      639    19322        *****************************************************************************/
      640    19323    2           CASE( %SI_MIP);
      641    19324    2               XSS$SYNC_MINOR = XSS_SYNC_MINOR;
      642    19325    2               XSS$SYNC_MINOR.FNC = %XSS_FNC_SSMIIND#;
      643    19326                    %SCAN( LVL=1, TAG=SI_MIP, TYP=NONE);
      644    19395                    %SCAN( LVL=2, TAG=PGI_STI, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);
      645    19464    2               XSS$SYNC_MINOR.TYPE = TEMP;
      646    19465                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      647    19466                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");
      648    19535    2               DATALVL = 2;
      649    19536    2               VBLK.EVENT = %XSS_SEV_MIP;
      650    19537        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:29   
      651    19538        /*****************************************************************************
      652    19539        *
      653    19540        *       NF              NOT FINISHED SPDU
      654    19541        *
      655    19542        *****************************************************************************/
      656    19543    2           CASE( %SI_NF);
      657    19544    2               XSS$RELEASE = XSS_RELEASE;
      658    19545    2               XSS$RELEASE.FNC = %XSS_FNC_SRELCNF#;
      659    19546                    %SCAN( LVL=1, TAG=SI_NF, TYP=NONE);
      660    19615    2               DATALVL = 2;
      661    19616    2               VBLK.EVENT = %XSS_SEV_NF;
      662    19617        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:30   
      663    19618        /*****************************************************************************
      664    19619        *
      665    19620        *       PR_MAA          PREPARE (MAJOR SYNC ACK) SPDU
      666    19621        *       PR_RA           PREPARE (RESYNCHRONIZE ACK) SPDU
      667    19622        *       PR_RS           PREPARE (RESYNCHRONIZE) SPDU
      668    19623        *
      669    19624        *****************************************************************************/
      670    19625    2           CASE( %SI_PR);
      671    19626                    %SCAN( LVL=1, TAG=SI_PR, TYP=NONE);
      672    19695                    %SCAN( LVL=2, TAG=PGI_PT, TYP=UBIN, LEN=1, VAL=TEMP);
      673    19764    3               DO CASE( TEMP);
      674    19765    3                   CASE( %XSS_PT_MAA#);
      675    19766    3                       VBLK.EVENT = %XSS_SEV_PR_MAA;
      676    19767    3                   CASE( %XSS_PT_RS#);
      677    19768    3                       VBLK.EVENT = %XSS_SEV_PR_RS;
      678    19769    3                   CASE( %XSS_PT_RA#);
      679    19770    3                       VBLK.EVENT = %XSS_SEV_PR_RA;
      680    19771    3                   CASE( ELSE);
      681    19772    3                       GOTO SCANERR;
      682    19773    3                   END;
      683    19774        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:31   
      684    19775        /*****************************************************************************
      685    19776        *
      686    19777        *       PT              PLEASE TOKENS SPDU
      687    19778        *
      688    19779        *****************************************************************************/
      689    19780    2           CASE( %SI_PT);
      690    19781    2               IF ITEMLIST.X.LEN( ITEMCUR) = 0 THEN
      691    19782    2                   GOTO ENDSPDU;
      692    19783    2               XSS$TOKEN_PLEASE = XSS_TOKEN_PLEASE;
      693    19784    2               XSS$TOKEN_PLEASE.FNC = %XSS_FNC_STKPIND#;
      694    19785                    %SCAN( LVL=1, TAG=SI_PT, TYP=NONE);
      695    19854                    %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      696    19923    2               IF BTMP = '000000000'B THEN
      697    19924    2                   GOTO ENDSPDU;  /* no tokens; cut short */
      698    19925    2               XSS$TOKEN_PLEASE.TOKENS = BTMP;
      699    19926    2               DATALVL = 2;
      700    19927    2               VBLK.EVENT = %XSS_SEV_PT;
      701    19928        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:32   
      702    19929        /*****************************************************************************
      703    19930        *
      704    19931        *       RA              RESYNCHRONIZE ACK SPDU
      705    19932        *
      706    19933        *****************************************************************************/
      707    19934    2           CASE( %SI_RA);
      708    19935    2               XSS$RESYNCHRONIZE = XSS_RESYNCHRONIZE;
      709    19936    2               XSS$RESYNCHRONIZE.FNC = %XSS_FNC_SRSXCNF#;
      710    19937                    %SCAN( LVL=1, TAG=SI_RA, TYP=NONE);
      711    20006                    %SCAN( LVL=2, TAG=PGI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      712    20075    2               XSS$RESYNCHRONIZE.TOKENS = BTMP;
      713    20076                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      714    20077                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");
      715    20146    2               DATALVL = 2;
      716    20147    2               VBLK.EVENT = %XSS_SEV_RA;
      717    20148        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:33   
      718    20149        /*****************************************************************************
      719    20150        *
      720    20151        *       RF_NR           REFUSE (NO REUSE) SPDU
      721    20152        *       RF_R            REFUSE (REUSE) SPDU
      722    20153        *
      723    20154        *****************************************************************************/
      724    20155    2           CASE( %SI_RF);
      725    20156    2               XSS$CONNECT = XSS_CONNECT;
      726    20157    2               XSS$CONNECT.FNC = %XSS_FNC_SCONCNF#;
      727    20158    2               XSS$CONNECT.RESULT = %XSS_RSLT_FAILURE#;
      728    20159    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);
      729    20160    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);
      730    20161    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);
      731    20162                    %SCAN( LVL=1, TAG=SI_RF, TYP=NONE);
      732    20231                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);
      733    20300    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;
      734    20301                        %SCAN( LVL=3, TAG=PI_ASSUR, TYP=TXTC, OPT=Y,
      735    20302                                LEN=224, VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");
      736    20371                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      737    20372                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");
      738    20441                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      739    20442                                LEN=4, VAL="XSS$CONNECT.ARI");
      740    20511    3                   END;
      741    20512    3               IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_TD THEN DO;
      742    20513                        %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      743    20582    3                   SCTX.TD = BTMP;
      744    20583    3                   END;
      745    20584    3               ELSE DO;
      746    20585    3                   SCTX.TD = '0'B;
      747    20586    3                   SCTX.TD.TCREL = %TRUE;
      748    20587    3                   END;
      749    20588                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);
      750    20657    2               XSS$CONNECT.SFU = BTMP;
      751    20658                    %SCAN( LVL=2, TAG=PGI_VN, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);
      752    20727    2               SCTX.VN = TEMP;
      753    20728                    %SCAN( LVL=2, TAG=PGI_RC, TYP=CPTR, OPT=Y, LEN=513, VAL=NIL);
      754    20797    3               IF SCANITEM.X.LEN > 0 THEN DO;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:34   
      755    20798    3                   XSS$CONNECT.REASON = SCANITEM.P->B$UBIN9;
      756    20799    3                   IF SCANITEM.X.LEN > 1 THEN
      757    20800    3                       XSS$CONNECT.DATA.PTR$ = PINCRC( SCANITEM.P, 1);
      758    20801    3                   XSS$CONNECT.DATA.SIZE = SCANITEM.X.LEN - 1;
      759    20802    3                   END;
      760    20803    2               IF SCTX.TD.TCREL THEN
      761    20804    2                   VBLK.EVENT = %XSS_SEV_RF_NR;
      762    20805    2               ELSE
      763    20806    2                   VBLK.EVENT = %XSS_SEV_RF_R;
      764    20807        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:35   
      765    20808        /*****************************************************************************
      766    20809        *
      767    20810        *       RS_A            RESYNCHRONIZE (ABANDON) SPDU
      768    20811        *       RS_R            RESYNCHRONIZE (RESTART) SPDU
      769    20812        *       RS_S            RESYNCHRONIZE (SET) SPDU
      770    20813        *
      771    20814        *****************************************************************************/
      772    20815    2           CASE( %SI_RS);
      773    20816    2               XSS$RESYNCHRONIZE = XSS_RESYNCHRONIZE;
      774    20817    2               XSS$RESYNCHRONIZE.FNC = %XSS_FNC_SRSXIND#;
      775    20818                    %SCAN( LVL=1, TAG=SI_RS, TYP=NONE);
      776    20887                    %SCAN( LVL=2, TAG=PGI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      777    20956    2               XSS$RESYNCHRONIZE.TOKENS = BTMP;
      778    20957                    %SCAN( LVL=2, TAG=PGI_RT, TYP=UBIN, LEN=1, VAL=TEMP);
      779    21026    3               DO CASE( TEMP);
      780    21027    3                   CASE( %XSS_RT_RESTART#);
      781    21028    3                       VBLK.EVENT = %XSS_SEV_RS_R;
      782    21029    3                   CASE( %XSS_RT_ABANDON#);
      783    21030    3                       VBLK.EVENT = %XSS_SEV_RS_A;
      784    21031    3                   CASE( %XSS_RT_SET#);
      785    21032    3                       VBLK.EVENT = %XSS_SEV_RS_S;
      786    21033    3                   CASE( ELSE);
      787    21034    3                       GOTO SCANERR;
      788    21035    3                   END;
      789    21036                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      790    21037                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");
      791    21106    2               DATALVL = 2;
      792    21107        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:36   
      793    21108        /*****************************************************************************
      794    21109        *
      795    21110        *       TD              TYPED DATA SPDU
      796    21111        *
      797    21112        *****************************************************************************/
      798    21113    2           CASE( %SI_TD);
      799    21114    2               XSS$TYPED_DATA = XSS_TYPED_DATA;
      800    21115    2               XSS$TYPED_DATA.FNC = %XSS_FNC_STYDIND#;
      801    21116                    %SCAN( LVL=1, TAG=SI_TD, TYP=NONE);
      802    21185    3               IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_EI THEN DO;
      803    21186                        %SCAN( LVL=2, TAG=PGI_EI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);
      804    21255    3                   VBLK.EI = BTMP;
      805    21256    3                   END;
      806    21257    3               ELSE DO;
      807    21258    3                   VBLK.EI.BOSSDU = %TRUE;
      808    21259    3                   VBLK.EI.EOSSDU = %TRUE;
      809    21260    3                   END;
      810    21261    2               DATALVL = 2;
      811    21262    2               DATATAG = 0;
      812    21263    2               VBLK.EVENT = %XSS_SEV_TD;
      813    21264        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:37   
      814    21265        /*****************************************************************************
      815    21266        *
      816    21267        *       Illegal SI value
      817    21268        *
      818    21269        *****************************************************************************/
      819    21270    2           CASE( ELSE);
      820    21271    2               GOTO SCANERR;
      821    21272    2           END;
      822    21273    2       IF DATALVL > 0 AND ITEMCUR < ITEMNUM THEN DO;
      823    21274    2           IF DATATAG = 0 THEN
      824    21275                    %SCAN( LVL=DATALVL, TAG=0, TYP=DATA, OPT=Y,
      825    21276                            LEN=DATALEN, VAL=NIL);
      826    21345    2           ELSE
      827    21346                    %SCAN( LVL=DATALVL, TAG=PGI_DATA, TYP=DATA, OPT=Y,
      828    21347                            LEN=DATALEN, VAL=NIL);
      829    21416    3           IF SCANITEM.X.LEN > 0 THEN DO;
      830    21417    3               XSS$GENERIC.DATA.PTR$ = SCANITEM.P;
      831    21418    3               XSS$GENERIC.DATA.SIZE = SCANITEM.X.LEN;
      832    21419    3               END;
      833    21420    2           END;
      834    21421    1       XSS$GENERIC.SCID = SCTX.SCID;
      835    21422    1       CALL XSS$MACHINE( VBLK)
      836    21423    2       WHENALTRETURN DO;
      837    21424                /* The connection has gone away, but we'll keep going. */
      838    21425    2           END;
      839    21426    1   ENDSPDU:
      840    21427            /* End of processing for this SPDU.  See if any others. */
      841    21428    1       SPDUCUR = SPDUCUR + 1;
      842    21429    1       IF SPDUCUR < SPDUNUM THEN
      843    21430    1           GOTO NEXTSPDU;
      844    21431    1       RETURN;
      845    21432    1   SCANERR:
      846    21433            /* An error occurred while decoding an SPDU */
      847    21434    1       ALTRETURN;
      848    21435        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:38   
      849    21436        /*I*    NAME:   SCAN
      850    21437
      851    21438                SCAN is called for each item of the SPDU expected to be seen.  The
      852    21439                contents of SCANITEM are compared with the current item.  If they
      853    21440                match, the associated value is moved from the current item to the
      854    21441                VAL field indicated in SCANITEM.  Otherwise, heuristics are used to
      855    21442                figure out if the SPDU is in error or we need to skip over optional
      856    21443                items not supplied in the SPDU.
      857    21444        */
      858    21445    1   SCAN: PROC ALTRET;
      859    21446
      860    21447    2       IF ITEMCUR > ITEMNUM THEN
      861    21448                /* fell off the end of the SPDU */
      862    21449    2           ALTRETURN;
      863    21450    3       IF ITEMCUR = ITEMNUM THEN DO;
      864    21451                /* should only happen when trailing optional item missing */
      865    21452    3           SCANITEM.X.LEN = 0;
      866    21453    3           RETURN;
      867    21454    3           END;
      868    21455    2       TEMP = 0;
      869    21456    2       BTMP = '000000000000'O;
      870    21457            /* compare LVLs */
      871    21458    2       IF ITEMLIST.X.LVL( ITEMCUR) < SCANITEM.X.LVL THEN
      872    21459    2           RETURN;  /* skip ahead to resynchronize levels */
      873    21460    3       IF ITEMLIST.X.LVL( ITEMCUR) = SCANITEM.X.LVL THEN DO;
      874    21461                /* compare TAGs */
      875    21462    3           IF SCANITEM.X.TAG = 0 OR
      876    21463    4                   ITEMLIST.X.TAG( ITEMCUR) = SCANITEM.X.TAG THEN DO;
      877    21464                    /* O.K. We have a match!  Now we move the value part of the
      878    21465                       matched tag-length-value item to the given buffer. */
      879    21466    4               SRCLEN = ITEMLIST.X.LEN( ITEMCUR);
      880    21467    5               IF SRCLEN = 0 OR SCANITEM.X.TYP = %NONE THEN DO;
      881    21468    5                   SCANITEM.X.LEN = 0;
      882    21469    5                   GOTO RET;  /* no value.. we're done */
      883    21470    5                   END;
      884    21471    4               IF SCANITEM.X.TYP = %BITS THEN
      885    21472    4                   SRCLEN = SRCLEN * 8;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:39   
      886    21473    4               DSTLEN = SCANITEM.X.LEN;
      887    21474    4               IF SRCLEN > DSTLEN THEN
      888    21475    4                   ALTRETURN;  /* source is too long for buffer */
      889    21476    5               DO CASE( SCANITEM.X.TYP);
      890    21477    5                   CASE( %BITS);
      891    21478                            /* NOTE! SRCLEN AND DSTLEN CONTAIN LENGTHS IN *BITS* */
      892    21479    5                       SRCLEN = ( SRCLEN + 8) / 9;  /* now byte-length */
      893    21480    5                       BSRC$ = ITEMLIST.P( ITEMCUR);
      894    21481    5                       BDST$ = SCANITEM.P;
      895    21482    6                       DO I = 1 TO SRCLEN;
      896    21483    6                           BDST$->B$BIT8 = PINCRB( BSRC$, 1)->B$BIT8;
      897    21484    6                           BDST$ = PINCRB( BDST$, 8);
      898    21485    6                           BSRC$ = PINCRC( BSRC$, 1);
      899    21486    6                           END;
      900    21487    5                   CASE( %CPTR,
      901    21488    5                         %CVEC,
      902    21489    5                         %DATA);
      903    21490    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);
      904    21491    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;
      905    21492                                /* don't copy data; just point at it in the SPDU */
      906    21493    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);
      907    21494    6                           SCANITEM.X.LEN = DSTLEN;
      908    21495    6                           END;
      909    21496    5                       ELSE
      910    21497    5                           SCANITEM.P->DSTBYTES = ITEMLIST.P( ITEMCUR)->SRCBYTES;
      911    21498    5                   CASE( %TXTC);
      912    21499    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);
      913    21500    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;
      914    21501                                /* don't copy data; just point at it in the SPDU */
      915    21502    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);
      916    21503    6                           SCANITEM.X.LEN = DSTLEN;
      917    21504    6                           END;
      918    21505    6                       ELSE DO;
      919    21506    6                           SCANITEM.P->TXTC.LEN = DSTLEN;
      920    21507    6                           ADDR( SCANITEM.P->TXTC.TXT)->DSTBYTES =
      921    21508    6                                   ITEMLIST.P( ITEMCUR)->DSTBYTES;
      922    21509    6                           END;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:40   
      923    21510    5                   CASE( %UBC6);
      924    21511    5                       SRC$ = ITEMLIST.P( ITEMCUR);
      925    21512    5                       CALL CHARBIN( SCANITEM.P->B$UBIN, SRC$->SRCBYTES);
      926    21513    5                   CASE( %UBIN);
      927    21514    5                       BSRC$ = ITEMLIST.P( ITEMCUR);
      928    21515    5                       BDST$ = PINCRB( SCANITEM.P, 4 + 8*(4-SRCLEN));
      929    21516    6                       DO I = 1 TO SRCLEN;
      930    21517    6                           BDST$->B$BIT8 = PINCRB( BSRC$, 1)->B$BIT8;
      931    21518    6                           BDST$ = PINCRB( BDST$, 8);
      932    21519    6                           BSRC$ = PINCRC( BSRC$, 1);
      933    21520    6                           END;
      934    21521    5                   CASE( ELSE);
      935    21522                            /* bad SCANITEM.X.TYP */
      936    21523    5                       ALTRETURN;
      937    21524    5                   END;
      938    21525    4               GOTO RET;
      939    21526    4               END;
      940    21527    4           IF SCANITEM.X.OPT = 1 THEN DO;
      941    21528                    /* looks like this optional item is not present */
      942    21529    4               SCANITEM.X.LEN = 0;
      943    21530    4               RETURN;
      944    21531    4               END;
      945    21532                /* this required item is not present */
      946    21533    3           ALTRETURN;
      947    21534    3           END;
      948    21535            /*N* something's wrong.. don't know what to do yet...... */
      949    21536    2       ALTRETURN;
      950    21537    2   RET:
      951    21538    2       ITEMCUR = ITEMCUR + 1;
      952    21539    2       RETURN;
      953    21540
      954    21541    2       END SCAN;
      955    21542        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:41   
      956    21543    1   GETLEN: PROC ALTRET;
      957    21544
      958    21545    2       TEMP = %NEXTBYTE;
      959    21546    2       IF TEMP < 255 THEN
      960    21547    2           RETURN;
      961    21548    2       IF TEMP ~= 255 THEN
      962    21549    2           ALTRETURN;
      963    21550    2       TEMP = %NEXTBYTE;
      964    21551    2       TEMP = ( 256 * TEMP) + %NEXTBYTE;
      965    21552    2       RETURN;
      966    21553
      967    21554    2       END GETLEN;
      968    21555
      969    21556    1       END XSS$DECODE;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:42   
--  Include file information  --

   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
      No diagnostics issued in procedure XSS$DECODE.

   Procedure XSS$DECODE requires 2270 words for executable code.
   Procedure XSS$DECODE requires 112 words of local(AUTO) storage.

    No errors detected in file XSS$DECODE.:XSA1TSI    .

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:43   

 Object Unit name= XSS$DECODE                                 File name= XSS$DECODE.:XSA1TOU
 UTS= OCT 01 '97 12:16:20.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    116    164  XSS$DECODE
    1   Proc  even  none  2270   4336  XSS$DECODE
    2  RoData even  none    39     47  XSS$DECODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  XSS$DECODE
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:44   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  XSS_GENERIC                        0     16  XSS_ACTIVITY_DISCARD
    0     20  XSS_ACTIVITY_END                   0     26  XSS_ACTIVITY_INTERRUPT
    0     30  XSS_ACTIVITY_RESUME                0     46  XSS_ACTIVITY_START
    0     54  XSS_CAPABILITY_DATA                0     60  XSS_CONNECT
    0     74  XSS_CONTROL_GIVE                   0     76  XSS_DATA
    0    102  XSS_EXPEDITED_DATA                 0    106  XSS_P_ABORT
    0    110  XSS_P_EXCEPTION_REPORT             0    112  XSS_RELEASE
    0    116  XSS_RESYNCHRONIZE                  0    124  XSS_SYNC_MAJOR
    0    132  XSS_SYNC_MINOR                     0    140  XSS_TOKEN_GIVE
    0    142  XSS_TOKEN_PLEASE                   0    146  XSS_TYPED_DATA
    0    152  XSS_U_ABORT                        0    156  XSS_U_EXCEPTION_REPORT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 XSS$EVLOG
 yes     yes           Std       1 XSS$MACHINE
 yes     yes           Std       2 XSS$BUFPTR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XSS_ITEMCNT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:45   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:46   


        1        1        /*M*    XSS$DECODE      Decode an incoming Session PDU                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$DECODE
        9        9                    This routine decodes one or more incoming Session PDUs and fills
       10       10                    in a Session FPT structure for each one.  The Session state
       11       11                    machine is then called.  ALTRETURNs if anything wrong with SPDU.
       12       12        */
       13       13        XSS$DECODE: PROC( VBLK) ALTRET;

     13  1 000000   000000 700200 xent  XSS$DECODE   TSX0  ! X66_AUTO_1
         1 000001   000160 000001                    ZERO    112,1

       14       14        %INCLUDE UM_CP6;
       15      866        %INCLUDE K_ADDRESS_M;
       16     1369        %INCLUDE XSS_SESSION_E;
       17     1934        %INCLUDE XSS_SESSION_M;
       18     4577            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       19     7956            %XSS_PRIMITIVES( STCLASS="CONSTANT SYMDEF");
       20    11335        %INCLUDE XSS_INTERNAL_E;
       21    11633        %INCLUDE XSS_INTERNAL_M;
       22    12222            %XSS$VBLK( NAME=VBLK, STCLASS="");
       23    12327            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( VBLK.CTX$)");
       24    12761        %INCLUDE XSC_COMMON_M;
       25    13414            %XSC$ADDRESS( NAME=UADR, STCLASS=BASED);
       26    13697        %SET NEXTBYTE = CHARTEXT( CONCAT(
       27    13698                'ASCBIN( SUBSTR( PDU, PDUIDX, 1));',
       28    13699                'PDUIDX = PDUIDX + 1;',
       29    13700                'CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;'));
       30    13701        %EQU ITEMMAX = 31;
       31    13702        %EQU MAXDEPTH = 4;
       32    13703
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:47   
       33    13704    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       34    13705    1       DCL XSS$MACHINE ENTRY(1) ALTRET;
       35    13706    1       DCL XSS$EVLOG ENTRY(2);
       36    13707
       37    13708    1       DCL XSS_ITEMCNT SBIN SYMREF;
       38    13709
       39    13710    1       DCL B$BIT8 BIT(8) BASED UNAL;
       40    13711    1       DCL B$UBIN UBIN BASED;
       41    13712    1       DCL B$UBIN9 UBIN(9) BASED CALIGNED;
       42    13713    1       DCL BTMP BIT(36) ALIGNED;
       43    13714    1       DCL BYTES CHAR( SCANITEM.X.LEN) BASED CALIGNED;
       44    13715    1       DCL CURRLEN(0:%MAXDEPTH) SBIN;
       45    13716    1       DCL DATALEN SBIN;
       46    13717    1       DCL DATALVL SBIN;
       47    13718    1       DCL DATATAG SBIN;
       48    13719    1       DCL DEPTH SBIN;
       49    13720    1       DCL DST$ PTR CALIGNED;
       50    13721    1       DCL BDST$ PTR UNAL;
       51    13722    1       DCL DSTLEN SBIN;
       52    13723    1       DCL DSTBYTES CHAR( DSTLEN) BASED CALIGNED;
       53    13724    1       DCL I SBIN;
       54    13725    1       DCL INITLEN(0:%MAXDEPTH) SBIN;
       55    13726    1       DCL ITEMCUR SBIN;
       56    13727    1       DCL ITEMNUM SBIN;
       57    13728    1       DCL PDU CHAR(16384) BASED( PDU$) CALIGNED;
       58    13729    1       DCL PDU$ PTR CALIGNED;
       59    13730    1       DCL PDUIDX SBIN;
       60    13731    1       DCL SFPT$ PTR;
       61    13732    1       DCL SPDUCUR SBIN;
       62    13733    1       DCL SPDUNUM SBIN;
       63    13734    1       DCL 1 SPDULIST(0:3),
       64    13735    1            2 TAG UBIN BYTE CALIGNED,
       65    13736    1            2 ITEMFRST UBIN BYTE CALIGNED,
       66    13737    1            2 ITEMLAST UBIN BYTE CALIGNED,
       67    13738    1            2 ORDER UBIN BYTE CALIGNED;
       68    13739    1       DCL SRC$ PTR CALIGNED;
       69    13740    1       DCL BSRC$ PTR UNAL;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:48   
       70    13741    1       DCL SRCLEN SBIN;
       71    13742    1       DCL SRCBYTES CHAR( SRCLEN) BASED CALIGNED;
       72    13743    1       DCL TAG SBIN;
       73    13744    1       DCL TEMP SBIN;
       74    13745    1       DCL 1 TXTC BASED,
       75    13746    1            2 LEN UBIN BYTE CALIGNED,
       76    13747    1            2 TXT CHAR(16384) CALIGNED;
       77    13748            %ITEM( NAME=SCANITEM, STCLASS=AUTO);              /* THESE TWO LINES..  */
       78    13773            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);/* MUST BE CONTIGUOUS */
       79    13798
       80    13799    1       SFPT$ = VBLK.FPT$;

  13799  1 000002   200003 470500                    LDP0    @VBLK,,AUTO
         1 000003   000002 236100                    LDQ     2,,PR0
         1 000004   200033 756100                    STQ     SFPT$,,AUTO

       81    13800    1       PDU$ = VBLK.PDU.PTR$;

  13800  1 000005   000004 236100                    LDQ     4,,PR0
         1 000006   200031 756100                    STQ     PDU$,,AUTO

       82    13801    1       TEMP = VBLK.PDU.SIZE;

  13801  1 000007   000005 235100                    LDA     5,,PR0
         1 000010   200046 755100                    STA     TEMP,,AUTO

       83    13802    1       INITLEN = '0'B;

  13802  1 000011   000100 100400                    MLR     fill='000'O
         1 000012   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000013   200022 000024                    ADSC9   INITLEN,,AUTO            cn=0,n=20

       84    13803    1       INITLEN(0) = TEMP;

  13803  1 000014   200022 755100                    STA     INITLEN,,AUTO

       85    13804    1       INITLEN(1) = TEMP;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:49   

  13804  1 000015   200023 755100                    STA     INITLEN+1,,AUTO

       86    13805    1       CURRLEN = '0'B;

  13805  1 000016   000100 100400                    MLR     fill='000'O
         1 000017   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000020   200005 000024                    ADSC9   CURRLEN,,AUTO            cn=0,n=20

       87    13806    1       CURRLEN(0) = TEMP;

  13806  1 000021   200005 755100                    STA     CURRLEN,,AUTO

       88    13807    1       CURRLEN(1) = TEMP;

  13807  1 000022   200006 755100                    STA     CURRLEN+1,,AUTO

       89    13808    1       ITEMLIST = '0'B;

  13808  1 000023   000100 100400                    MLR     fill='000'O
         1 000024   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000025   200051 000400                    ADSC9   ITEMLIST,,AUTO           cn=0,n=256

       90    13809    1       ITEMLIST.Z(0) = TEMP*262144;  /* set up LEN */

  13809  1 000026   000022 735000                    ALS     18
         1 000027   200051 755100                    STA     ITEMLIST,,AUTO

       91    13810    1       ITEMLIST.P(0) = PDU$;

  13810  1 000030   200052 756100                    STQ     ITEMLIST+1,,AUTO

       92    13811    1       SPDULIST = '0'B;

  13811  1 000031   000100 100400                    MLR     fill='000'O
         1 000032   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000033   200036 000020                    ADSC9   SPDULIST,,AUTO           cn=0,n=16
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:50   

       93    13812    1       SPDUNUM = 0;

  13812  1 000034   200035 450100                    STZ     SPDUNUM,,AUTO

       94    13813    1       ITEMNUM = 1;

  13813  1 000035   000001 235007                    LDA     1,DL
         1 000036   200030 755100                    STA     ITEMNUM,,AUTO

       95    13814    1       DEPTH = 1;

  13814  1 000037   200015 755100                    STA     DEPTH,,AUTO

       96    13815    1       PDUIDX = 0;

  13815  1 000040   200032 450100                    STZ     PDUIDX,,AUTO

       97    13816        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:51   
       98    13817    1   NEXTITEM:
       99    13818    2       IF CURRLEN( DEPTH) > 0 THEN DO;

  13818  1 000041   200015 720100       NEXTITEM     LXL0    DEPTH,,AUTO
         1 000042   200005 235110                    LDA     CURRLEN,X0,AUTO
         1 000043   000152 604400 1                  TMOZ    s:13845

      100    13819    2           TAG = %NEXTBYTE;

  13819  1 000044   200031 470500                    LDP0    PDU$,,AUTO
         1 000045   200032 236100                    LDQ     PDUIDX,,AUTO
         1 000046   000100 101506                    MRL     fill='000'O
         1 000047   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         1 000050   200154 000004                    ADSC9   ITEMLIST+67,,AUTO        cn=0,n=4
         1 000051   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 000052   200045 756100                    STQ     TAG,,AUTO

  13819  1 000053   200032 054100                    AOS     PDUIDX,,AUTO

  13819  1 000054   000001 336007                    LCQ     1,DL
         1 000055   200005 056110                    ASQ     CURRLEN,X0,AUTO

      101    13820    3           IF DEPTH = 1 THEN DO;

  13820  1 000056   200015 235100                    LDA     DEPTH,,AUTO
         1 000057   000001 115007                    CMPA    1,DL
         1 000060   000074 601000 1                  TNZ     s:13825

      102    13821                    /* beginning of an SPDU */
      103    13822    3               SPDULIST.TAG( SPDUNUM) = TAG;

  13822  1 000061   200035 721100                    LXL1    SPDUNUM,,AUTO
         1 000062   200045 236100                    LDQ     TAG,,AUTO
         1 000063   000033 736000                    QLS     27
         1 000064   200036 676111                    ERQ     SPDULIST,X1,AUTO
         1 000065   777000 376003                    ANQ     -512,DU
         1 000066   200036 656111                    ERSQ    SPDULIST,X1,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:52   

      104    13823    3               SPDULIST.ITEMFRST( SPDUNUM) = ITEMNUM;

  13823  1 000067   200030 236100                    LDQ     ITEMNUM,,AUTO
         1 000070   000022 736000                    QLS     18
         1 000071   200036 676111                    ERQ     SPDULIST,X1,AUTO
         1 000072   000777 376003                    ANQ     511,DU
         1 000073   200036 656111                    ERSQ    SPDULIST,X1,AUTO

      105    13824    3               END;

      106    13825    2           CALL GETLEN ALTRET( SCANERR);  /* parse length of item into TEMP */

  13825  1 000074   004265 701000 1                  TSX1    GETLEN
         1 000075   003743 702000 1                  TSX2    SCANERR

      107    13826    2           ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512 + TEMP*262144;

  13826  1 000076   200030 235100                    LDA     ITEMNUM,,AUTO
         1 000077   000001 735000                    ALS     1
         1 000100   200045 236100                    LDQ     TAG,,AUTO
         1 000101   000011 736000                    QLS     9
         1 000102   200015 036100                    ADLQ    DEPTH,,AUTO
         1 000103   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 000104   200046 236100                    LDQ     TEMP,,AUTO
         1 000105   000022 736000                    QLS     18
         1 000106   200154 036100                    ADLQ    ITEMLIST+67,,AUTO
         1 000107   200051 756105                    STQ     ITEMLIST,AL,AUTO

      108    13827    2           ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);

  13827  1 000110   200032 236100                    LDQ     PDUIDX,,AUTO
         1 000111   000020 736000                    QLS     16
         1 000112   200031 036100                    ADLQ    PDU$,,AUTO
         1 000113   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

      109    13828    2           ITEMNUM = ITEMNUM + 1;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:53   

  13828  1 000114   200030 054100                    AOS     ITEMNUM,,AUTO

      110    13829    2           IF DEPTH = 1 OR

  13829  1 000115   200015 235100                    LDA     DEPTH,,AUTO
         1 000116   000001 115007                    CMPA    1,DL
         1 000117   000127 600000 1                  TZE     s:13832
         1 000120   200045 236100                    LDQ     TAG,,AUTO
         1 000121   000001 116007                    CMPQ    1,DL
         1 000122   000127 600000 1                  TZE     s:13832
         1 000123   000005 116007                    CMPQ    5,DL
         1 000124   000127 600000 1                  TZE     s:13832
         1 000125   000041 116007                    CMPQ    33,DL
         1 000126   000140 601000 1                  TNZ     s:13839

      111    13830    3                   ( TAG = %PGI_CI OR TAG = %PGI_CAI OR TAG = %PGI_LI) THEN DO;

      112    13831                    /* this is a constructed item */
      113    13832    3               DEPTH = DEPTH + 1;

  13832  1 000127   200015 054100                    AOS     DEPTH,,AUTO

      114    13833    3               IF DEPTH > %MAXDEPTH THEN

  13833  1 000130   200015 235100                    LDA     DEPTH,,AUTO
         1 000131   000004 115007                    CMPA    4,DL
         1 000132   003743 605400 1                  TPNZ    SCANERR

      115    13834    3                   GOTO SCANERR;
      116    13835    3               CURRLEN( DEPTH) = TEMP;

  13835  1 000133   200046 236100                    LDQ     TEMP,,AUTO
         1 000134   200005 756105                    STQ     CURRLEN,AL,AUTO

      117    13836    3               INITLEN( DEPTH) = TEMP;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:54   
  13836  1 000135   200015 720100                    LXL0    DEPTH,,AUTO
         1 000136   200022 756110                    STQ     INITLEN,X0,AUTO

      118    13837    3               GOTO NEXTITEM;

  13837  1 000137   000041 710000 1                  TRA     NEXTITEM

      119    13838    3               END;
      120    13839    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - TEMP;

  13839  1 000140   200005 236105                    LDQ     CURRLEN,AL,AUTO
         1 000141   200046 136100                    SBLQ    TEMP,,AUTO
         1 000142   200015 720100                    LXL0    DEPTH,,AUTO
         1 000143   200005 756110                    STQ     CURRLEN,X0,AUTO

      121    13840    2           PDUIDX = PDUIDX + TEMP;

  13840  1 000144   200032 236100                    LDQ     PDUIDX,,AUTO
         1 000145   200046 036100                    ADLQ    TEMP,,AUTO
         1 000146   200032 756100                    STQ     PDUIDX,,AUTO

      122    13841    2           IF PDUIDX < VBLK.PDU.SIZE THEN

  13841  1 000147   200003 470500                    LDP0    @VBLK,,AUTO
         1 000150   000005 116100                    CMPQ    5,,PR0
         1 000151   000041 604000 1                  TMI     NEXTITEM

      123    13842    2               GOTO NEXTITEM;
      124    13843    2           END;

      125    13844            /* reached the end of an item */
      126    13845    1       TEMP = DEPTH;

  13845  1 000152   200015 235100                    LDA     DEPTH,,AUTO
         1 000153   200046 755100                    STA     TEMP,,AUTO

      127    13846    1       DEPTH = DEPTH - 1;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:55   

  13846  1 000154   000001 336007                    LCQ     1,DL
         1 000155   200015 056100                    ASQ     DEPTH,,AUTO

      128    13847    2       IF DEPTH >= 0 THEN DO;

  13847  1 000156   000232 604000 1                  TMI     s:13869

      129    13848    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - INITLEN( TEMP);

  13848  1 000157   200015 720100                    LXL0    DEPTH,,AUTO
         1 000160   200005 236110                    LDQ     CURRLEN,X0,AUTO
         1 000161   200022 136105                    SBLQ    INITLEN,AL,AUTO
         1 000162   200005 756110                    STQ     CURRLEN,X0,AUTO

      130    13849    2           INITLEN( TEMP) = 0;

  13849  1 000163   200046 721100                    LXL1    TEMP,,AUTO
         1 000164   200022 450111                    STZ     INITLEN,X1,AUTO

      131    13850    3           IF DEPTH = 1 THEN DO;

  13850  1 000165   200015 235100                    LDA     DEPTH,,AUTO
         1 000166   000001 115007                    CMPA    1,DL
         1 000167   000231 601000 1                  TNZ     s:13865

      132    13851    3               TAG = SPDULIST.TAG( SPDUNUM);

  13851  1 000170   200035 722100                    LXL2    SPDUNUM,,AUTO
         1 000171   200036 236112                    LDQ     SPDULIST,X2,AUTO
         1 000172   000033 772000                    QRL     27
         1 000173   200045 756100                    STQ     TAG,,AUTO

      133    13852    3               IF CURRLEN( DEPTH) > 0 AND

  13852  1 000174   200005 235110                    LDA     CURRLEN,X0,AUTO
         1 000175   000223 604400 1                  TMOZ    s:13862
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:56   
         1 000176   000001 116007                    CMPQ    1,DL
         1 000177   000202 601000 1                  TNZ     s:13852+6
         1 000200   200035 235100                    LDA     SPDUNUM,,AUTO
         1 000201   000206 605400 1                  TPNZ    s:13856
         1 000202   000005 116007                    CMPQ    5,DL
         1 000203   000206 600000 1                  TZE     s:13856
         1 000204   000041 116007                    CMPQ    33,DL
         1 000205   000223 601000 1                  TNZ     s:13862

      134    13853    3                       ( ( TAG = %SI_DT AND SPDUNUM > 0) OR
      135    13854    4                         TAG = %SI_EX OR TAG = %SI_TD) THEN DO;

      136    13855                        /* handle User Information Field specially */
      137    13856    4                   ITEMLIST.Z( ITEMNUM) = ( DEPTH+1) + CURRLEN( DEPTH)*262144;

  13856  1 000206   200030 235100                    LDA     ITEMNUM,,AUTO
         1 000207   000001 735000                    ALS     1
         1 000210   200005 236110                    LDQ     CURRLEN,X0,AUTO
         1 000211   000022 736000                    QLS     18
         1 000212   200015 036100                    ADLQ    DEPTH,,AUTO
         1 000213   000001 036007                    ADLQ    1,DL
         1 000214   200051 756105                    STQ     ITEMLIST,AL,AUTO

      138    13857    4                   ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);

  13857  1 000215   200032 236100                    LDQ     PDUIDX,,AUTO
         1 000216   000020 736000                    QLS     16
         1 000217   200031 036100                    ADLQ    PDU$,,AUTO
         1 000220   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

      139    13858    4                   ITEMNUM = ITEMNUM + 1;

  13858  1 000221   200030 054100                    AOS     ITEMNUM,,AUTO

      140    13859    4                   CURRLEN( DEPTH) = 0;

  13859  1 000222   200005 450110                    STZ     CURRLEN,X0,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:57   

      141    13860    4                   END;

      142    13861                    /* end of an SPDU */
      143    13862    3               SPDULIST.ITEMLAST( SPDUNUM) = ITEMNUM;

  13862  1 000223   200030 236100                    LDQ     ITEMNUM,,AUTO
         1 000224   000011 736000                    QLS     9
         1 000225   200036 676112                    ERQ     SPDULIST,X2,AUTO
         1 000226   777000 376007                    ANQ     -512,DL
         1 000227   200036 656112                    ERSQ    SPDULIST,X2,AUTO

      144    13863    3               SPDUNUM = SPDUNUM + 1;

  13863  1 000230   200035 054100                    AOS     SPDUNUM,,AUTO

      145    13864    3               END;

      146    13865    2           GOTO NEXTITEM;

  13865  1 000231   000041 710000 1                  TRA     NEXTITEM

      147    13866    2           END;
      148    13867        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:58   
      149    13868            /* Done scanning the SPDU(s).. order them if necessary */
      150    13869    2       DO CASE( SPDUNUM);

  13869  1 000232   200035 235100                    LDA     SPDUNUM,,AUTO
         1 000233   000005 115007                    CMPA    5,DL
         1 000234   000236 602005 1                  TNC     s:13869+4,AL
         1 000235   000307 710000 1                  TRA     s:13899
         1 000236   000307 710000 1                  TRA     s:13899
         1 000237   000243 710000 1                  TRA     s:13872
         1 000240   000246 710000 1                  TRA     s:13875
         1 000241   000253 710000 1                  TRA     s:13878
         1 000242   000276 710000 1                  TRA     s:13894

      151    13870    2           CASE( 1);  /* no concatenation */

      152    13871                    /* Any category 0 or category 1 SPDU is fine as-is. */
      153    13872    2               SPDULIST.ORDER(0) = 0;

  13872  1 000243   000000 236003                    LDQ     0,DU
         1 000244   200036 552104                    STBQ    SPDULIST,'04'O,AUTO
         1 000245   000310 710000 1                  TRA     s:13902

      154    13873    2           CASE( 2);  /* basic or extended concatenation */

      155    13874                    /* GT/PT, other */
      156    13875    2               SPDULIST.ORDER(1) = 0;  /* Any other SPDU is handled.. */

  13875  1 000246   000000 236003                    LDQ     0,DU
         1 000247   200037 552104                    STBQ    SPDULIST+1,'04'O,AUTO

      157    13876    2               SPDULIST.ORDER(0) = 1;  /* before the GT or PT SPDU. */

  13876  1 000250   000001 236007                    LDQ     1,DL
         1 000251   200036 552104                    STBQ    SPDULIST,'04'O,AUTO
         1 000252   000310 710000 1                  TRA     s:13902

      158    13877    2           CASE( 3);  /* extended concatenation */
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:59   

      159    13878    2               TAG = SPDULIST.TAG(1);

  13878  1 000253   200037 236100                    LDQ     SPDULIST+1,,AUTO
         1 000254   000033 772000                    QRL     27
         1 000255   200045 756100                    STQ     TAG,,AUTO

      160    13879    3               IF TAG = %SI_AS OR TAG = %SI_AR THEN DO;

  13879  1 000256   000055 116007                    CMPQ    45,DL
         1 000257   000262 600000 1                  TZE     s:13882
         1 000260   000035 116007                    CMPQ    29,DL
         1 000261   000267 601000 1                  TNZ     s:13888

      161    13880                        /* GT, AS/AR, MIP/MAP/AE or */
      162    13881                        /* GT, AS/AR, DT */
      163    13882    3                   SPDULIST.ORDER(1) = 0;  /* Handle the AS or AR first.. */

  13882  1 000262   000000 236003                    LDQ     0,DU
         1 000263   200037 552104                    STBQ    SPDULIST+1,'04'O,AUTO

      164    13883    3                   SPDULIST.ORDER(2) = 1;  /* then the DT or MIP/MAP/AE.. */

  13883  1 000264   000001 236007                    LDQ     1,DL
         1 000265   200040 552104                    STBQ    SPDULIST+2,'04'O,AUTO

      165    13884    3                   END;

  13884  1 000266   000273 710000 1                  TRA     s:13891

      166    13885    3               ELSE DO;

      167    13886                        /* GT, AE/AEA, DT or */
      168    13887                        /* GT, MIP/MIA/MAP/MAA, DT */
      169    13888    3                   SPDULIST.ORDER(2) = 0;  /* Handle the DT SPDU first.. */

  13888  1 000267   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:60   
         1 000270   200040 552104                    STBQ    SPDULIST+2,'04'O,AUTO

      170    13889    3                   SPDULIST.ORDER(1) = 1;  /* then the MIP/MIA/MAP/MAA.. */

  13889  1 000271   000001 236007                    LDQ     1,DL
         1 000272   200037 552104                    STBQ    SPDULIST+1,'04'O,AUTO

      171    13890    3                   END;

      172    13891    2               SPDULIST.ORDER(0) = 2;  /* and finally do the GT SPDU. */

  13891  1 000273   000002 236007                    LDQ     2,DL
         1 000274   200036 552104                    STBQ    SPDULIST,'04'O,AUTO
         1 000275   000310 710000 1                  TRA     s:13902

      173    13892    2           CASE( 4);  /* extended concatenation */

      174    13893                    /* GT, AS/AR, MIP/MAP/AE, DT */
      175    13894    2               SPDULIST.ORDER(1) = 0;  /* Handle the AS or AR SPDU first.. */

  13894  1 000276   000000 236003                    LDQ     0,DU
         1 000277   200037 552104                    STBQ    SPDULIST+1,'04'O,AUTO

      176    13895    2               SPDULIST.ORDER(3) = 1;  /* then the DT SPDU.. */

  13895  1 000300   000001 236007                    LDQ     1,DL
         1 000301   200041 552104                    STBQ    SPDULIST+3,'04'O,AUTO

      177    13896    2               SPDULIST.ORDER(2) = 2;  /* then the MIP, MAP, or AE SPDU.. */

  13896  1 000302   000002 236007                    LDQ     2,DL
         1 000303   200040 552104                    STBQ    SPDULIST+2,'04'O,AUTO

      178    13897    2               SPDULIST.ORDER(0) = 3;  /* and finally the GT SPDU. */

  13897  1 000304   000003 236007                    LDQ     3,DL
         1 000305   200036 552104                    STBQ    SPDULIST,'04'O,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:61   
         1 000306   000310 710000 1                  TRA     s:13902

      179    13898    2           CASE( ELSE);

      180    13899    2               GOTO SCANERR;

  13899  1 000307   003743 710000 1                  TRA     SCANERR

      181    13900    2           END;

      182    13901        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:62   
      183    13902    1       XSS_ITEMCNT = -1;  /* make SCAN/LOAD load into SCANITEM, not ITEMLIST */

  13902  1 000310   000001 336007                    LCQ     1,DL
         1 000311   000000 756000 xsym               STQ     XSS_ITEMCNT

      184    13903    1       ITEMCUR = 0;

  13903  1 000312   200027 450100                    STZ     ITEMCUR,,AUTO

      185    13904    1       ITEMNUM = 0;

  13904  1 000313   200030 450100                    STZ     ITEMNUM,,AUTO

      186    13905            %SCAN( LVL=0, TYP=NONE, LEN="VBLK.PDU.SIZE");

  13964  1 000314   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000315   000001 735000                    ALS     1
         1 000316   200003 470500                    LDP0    @VBLK,,AUTO
         1 000317   000000 620005                    EAX0    0,AL
         1 000320   000005 235100                    LDA     5,,PR0
         1 000321   000022 735000                    ALS     18
         1 000322   200051 755110                    STA     ITEMLIST,X0,AUTO

  13971  1 000323   003744 701000 1                  TSX1    SCAN
         1 000324   003743 702000 1                  TSX2    SCANERR

      187    13974            /* Now process each concatenated SPDU in turn, in the correct order */
      188    13975    1       SPDUCUR = 0;

  13975  1 000325   200034 450100                    STZ     SPDUCUR,,AUTO

      189    13976    1   NEXTSPDU:
      190    13977    2       DO TEMP = 0 TO 3;

  13977  1 000326   200046 450100       NEXTSPDU     STZ     TEMP,,AUTO

      191    13978    3           IF SPDULIST.ORDER( TEMP) = SPDUCUR THEN DO;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:63   

  13978  1 000327   200046 720100                    LXL0    TEMP,,AUTO
         1 000330   200036 236110                    LDQ     SPDULIST,X0,AUTO
         1 000331   000777 376007                    ANQ     511,DL
         1 000332   200034 116100                    CMPQ    SPDUCUR,,AUTO
         1 000333   000345 601000 1                  TNZ     s:13983

      192    13979    3               ITEMCUR = SPDULIST.ITEMFRST( TEMP);

  13979  1 000334   200036 236110                    LDQ     SPDULIST,X0,AUTO
         1 000335   000022 772000                    QRL     18
         1 000336   000777 376007                    ANQ     511,DL
         1 000337   200027 756100                    STQ     ITEMCUR,,AUTO

      193    13980    3               ITEMNUM = SPDULIST.ITEMLAST( TEMP);

  13980  1 000340   200036 236110                    LDQ     SPDULIST,X0,AUTO
         1 000341   000011 772000                    QRL     9
         1 000342   000777 376007                    ANQ     511,DL
         1 000343   200030 756100                    STQ     ITEMNUM,,AUTO

      194    13981    3               EXIT NEXTSPDU;

  13981  1 000344   000351 710000 1                  TRA     s:13984

      195    13982    3               END;
      196    13983    2           END;

  13983  1 000345   200046 054100                    AOS     TEMP,,AUTO
         1 000346   200046 235100                    LDA     TEMP,,AUTO
         1 000347   000003 115007                    CMPA    3,DL
         1 000350   000327 604400 1                  TMOZ    s:13978

      197    13984    1       DATALVL = 0;

  13984  1 000351   200013 450100                    STZ     DATALVL,,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:64   
      198    13985    1       DATALEN = 262143;  /* max length of UserData unless changed */

  13985  1 000352   777777 235007                    LDA     -1,DL
         1 000353   200012 755100                    STA     DATALEN,,AUTO

      199    13986    1       DATATAG = %PGI_DATA;

  13986  1 000354   000301 236007                    LDQ     193,DL
         1 000355   200014 756100                    STQ     DATATAG,,AUTO

      200    13987    1       TEMP = ITEMLIST.X.TAG( ITEMCUR);

  13987  1 000356   200027 235100                    LDA     ITEMCUR,,AUTO
         1 000357   000001 735000                    ALS     1
         1 000360   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 000361   000011 772000                    QRL     9
         1 000362   000377 376007                    ANQ     255,DL
         1 000363   200046 756100                    STQ     TEMP,,AUTO

      201    13988    1       CALL XSS$EVLOG( 'DP', TEMP*512 + SCTX.SCID);

  13988  1 000364   200003 470500                    LDP0    @VBLK,,AUTO
         1 000365   000000 471500                    LDP1    0,,PR0
         1 000366   100015 236100                    LDQ     13,,PR1
         1 000367   000022 772000                    QRL     18
         1 000370   000777 376007                    ANQ     511,DL
         1 000371   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 000372   200046 236100                    LDQ     TEMP,,AUTO
         1 000373   000011 736000                    QLS     9
         1 000374   200154 036100                    ADLQ    ITEMLIST+67,,AUTO
         1 000375   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 000376   200155 631500                    EPPR1   ITEMLIST+68,,AUTO
         1 000377   200157 451500                    STP1    ITEMLIST+70,,AUTO
         1 000400   000002 236000 2                  LDQ     2
         1 000401   200156 756100                    STQ     ITEMLIST+69,,AUTO
         1 000402   200156 630500                    EPPR0   ITEMLIST+69,,AUTO
         1 000403   000001 631400 2                  EPPR1   1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:65   
         1 000404   000000 701000 xent               TSX1    XSS$EVLOG
         1 000405   000000 011000                    NOP     0

      202    13989    1   SFNCCASE:
      203    13990    2       DO CASE( TEMP);

  13990  1 000406   200046 235100       SFNCCASE     LDA     TEMP,,AUTO
         1 000407   000077 115007                    CMPA    63,DL
         1 000410   000412 602005 1                  TNC     SFNCCASE+4,AL
         1 000411   003655 710000 1                  TRA     s:21271
         1 000412   002461 710000 1                  TRA     s:18558
         1 000413   002303 710000 1                  TRA     s:18227
         1 000414   003100 710000 1                  TRA     s:19781
         1 000415   003655 710000 1                  TRA     s:21271
         1 000416   003655 710000 1                  TRA     s:21271
         1 000417   002535 710000 1                  TRA     s:18709
         1 000420   003655 710000 1                  TRA     s:21271
         1 000421   003035 710000 1                  TRA     s:19685
         1 000422   003013 710000 1                  TRA     s:19544
         1 000423   002562 710000 1                  TRA     s:18792
         1 000424   002261 710000 1                  TRA     s:18087
         1 000425   003655 710000 1                  TRA     s:21271
         1 000426   003213 710000 1                  TRA     s:20156
         1 000427   001720 710000 1                  TRA     s:17082
         1 000430   000641 710000 1                  TRA     s:14380
         1 000431   003655 710000 1                  TRA     s:21271
         1 000432   003655 710000 1                  TRA     s:21271
         1 000433   003655 710000 1                  TRA     s:21271
         1 000434   003655 710000 1                  TRA     s:21271
         1 000435   003655 710000 1                  TRA     s:21271
         1 000436   003655 710000 1                  TRA     s:21271
         1 000437   002641 710000 1                  TRA     s:19021
         1 000440   002627 710000 1                  TRA     s:19004
         1 000441   003655 710000 1                  TRA     s:21271
         1 000442   003655 710000 1                  TRA     s:21271
         1 000443   000523 710000 1                  TRA     s:14136
         1 000444   000511 710000 1                  TRA     s:14058
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:66   
         1 000445   003655 710000 1                  TRA     s:21271
         1 000446   003655 710000 1                  TRA     s:21271
         1 000447   001427 710000 1                  TRA     s:16131
         1 000450   003655 710000 1                  TRA     s:21271
         1 000451   003655 710000 1                  TRA     s:21271
         1 000452   003655 710000 1                  TRA     s:21271
         1 000453   003577 710000 1                  TRA     s:21114
         1 000454   003144 710000 1                  TRA     s:19935
         1 000455   003655 710000 1                  TRA     s:21271
         1 000456   003655 710000 1                  TRA     s:21271
         1 000457   003655 710000 1                  TRA     s:21271
         1 000460   003655 710000 1                  TRA     s:21271
         1 000461   003655 710000 1                  TRA     s:21271
         1 000462   003655 710000 1                  TRA     s:21271
         1 000463   001267 710000 1                  TRA     s:15739
         1 000464   001374 710000 1                  TRA     s:15981
         1 000465   003655 710000 1                  TRA     s:21271
         1 000466   003655 710000 1                  TRA     s:21271
         1 000467   001621 710000 1                  TRA     s:16773
         1 000470   003655 710000 1                  TRA     s:21271
         1 000471   003655 710000 1                  TRA     s:21271
         1 000472   002423 710000 1                  TRA     s:18408
         1 000473   002744 710000 1                  TRA     s:19324
         1 000474   002670 710000 1                  TRA     s:19103
         1 000475   003655 710000 1                  TRA     s:21271
         1 000476   003655 710000 1                  TRA     s:21271
         1 000477   003477 710000 1                  TRA     s:20816
         1 000500   003655 710000 1                  TRA     s:21271
         1 000501   003655 710000 1                  TRA     s:21271
         1 000502   003655 710000 1                  TRA     s:21271
         1 000503   001221 710000 1                  TRA     s:15454
         1 000504   001255 710000 1                  TRA     s:15661
         1 000505   003655 710000 1                  TRA     s:21271
         1 000506   003655 710000 1                  TRA     s:21271
         1 000507   001654 710000 1                  TRA     s:16923
         1 000510   001676 710000 1                  TRA     s:17002

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:67   
      204    13991        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:68   
      205    13992        /*****************************************************************************
      206    13993        *
      207    13994        *       AA              ABORT ACCEPT SPDU
      208    13995        *       AIA             ACTIVITY INTERRUPT ACK SPDU
      209    13996        *
      210    13997        *****************************************************************************/
      211    13998    2           CASE( %SI_AA);  /* ..same as %SI_AIA */

      212    13999                    %SCAN( LVL=1, TAG=SI_AA, TYP=NONE);

  14058  1 000511   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 000512   000001 736000                    QLS     1
         1 000513   032001 235007                    LDA     13313,DL
         1 000514   200051 755106                    STA     ITEMLIST,QL,AUTO

  14065  1 000515   003744 701000 1                  TSX1    SCAN
         1 000516   003743 702000 1                  TSX2    SCANERR

      213    14068    2               VBLK.EVENT = %XSS_SEV_AA;  /* ..same as %XSS_SEV_AIA */

  14068  1 000517   200003 470500                    LDP0    @VBLK,,AUTO
         1 000520   000001 236007                    LDQ     1,DL
         1 000521   000001 552104                    STBQ    1,'04'O,PR0
         1 000522   003656 710000 1                  TRA     s:21273

      214    14069        /*****************************************************************************
      215    14070        *
      216    14071        *       AB_NR           ABORT (NO REUSE) SPDU
      217    14072        *       AB_R            ABORT (REUSE) SPDU
      218    14073        *       AI              ACTIVITY INTERRUPT SPDU
      219    14074        *
      220    14075        *****************************************************************************/
      221    14076    2           CASE( %SI_AB);  /* ..same as %SI_AI */

      222    14077                    %SCAN( LVL=1, TAG=SI_AB, TYP=NONE);

  14136  1 000523   000000 236000 xsym               LDQ     XSS_ITEMCNT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:69   
         1 000524   000001 736000                    QLS     1
         1 000525   031001 235007                    LDA     12801,DL
         1 000526   200051 755106                    STA     ITEMLIST,QL,AUTO

  14143  1 000527   003744 701000 1                  TSX1    SCAN
         1 000530   003743 702000 1                  TSX2    SCANERR

      223    14146    3               IF SPDUNUM = 1 THEN DO;  /* AB is never concatenated */

  14146  1 000531   200035 235100                    LDA     SPDUNUM,,AUTO
         1 000532   000001 115007                    CMPA    1,DL
         1 000533   000613 601000 1                  TNZ     s:14299

      224    14147                        /* this is an AB SPDU */
      225    14148    3                   XSS$U_ABORT = XSS_U_ABORT;

  14148  1 000534   200033 470500                    LDP0    SFPT$,,AUTO
         1 000535   000100 100400                    MLR     fill='000'O
         1 000536   000152 000020 0                  ADSC9   XSS_U_ABORT              cn=0,n=16
         1 000537   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      226    14149    3                   XSS$U_ABORT.FNC = %XSS_FNC_SUABIND#;

  14149  1 000540   066000 236003                    LDQ     27648,DU
         1 000541   000000 552140                    STBQ    0,'40'O,PR0

      227    14150                        %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL=BTMP);

  14203  1 000542   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000543   000001 735000                    ALS     1
         1 000544   200004 631500                    EPPR1   BTMP,,AUTO
         1 000545   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  14209  1 000546   000003 236000 2                  LDQ     3
         1 000547   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14216  1 000550   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:70   
         1 000551   003743 702000 1                  TSX2    SCANERR

      228    14219    3                   SCTX.TD = BTMP;

  14219  1 000552   200003 470500                    LDP0    @VBLK,,AUTO
         1 000553   000000 471500                    LDP1    0,,PR0
         1 000554   200004 236100                    LDQ     BTMP,,AUTO
         1 000555   000022 772000                    QRL     18
         1 000556   100015 552110                    STBQ    13,'10'O,PR1

      229    14220    3                   SCTX.RPV = '0'B;

  14220  1 000557   000000 471500                    LDP1    0,,PR0
         1 000560   000100 100400                    MLR     fill='000'O
         1 000561   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000562   100000 400012                    ADSC9   0,,PR1                   cn=2,n=10

      230    14221                        %SCAN( LVL=2, TAG=PGI_RPV, TYP=CPTR, OPT=Y,
      231    14222                                LEN=9, VAL="SCTX.RPV");

  14272  1 000563   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000564   000001 735000                    ALS     1
         1 000565   000000 471500                    LDP1    0,,PR0
         1 000566   200154 451500                    STP1    ITEMLIST+67,,AUTO
         1 000567   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 000570   400000 036007                    ADLQ    -131072,DL
         1 000571   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  14281  1 000572   000004 236000 2                  LDQ     4
         1 000573   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14288  1 000574   003744 701000 1                  TSX1    SCAN
         1 000575   003743 702000 1                  TSX2    SCANERR

      232    14291    3                   DATALVL = 2;

  14291  1 000576   000002 235007                    LDA     2,DL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:71   
         1 000577   200013 755100                    STA     DATALVL,,AUTO

      233    14292    3                   IF SCTX.TD.TCREL THEN

  14292  1 000600   200003 470500                    LDP0    @VBLK,,AUTO
         1 000601   000000 471500                    LDP1    0,,PR0
         1 000602   100015 236100                    LDQ     13,,PR1
         1 000603   002000 316007                    CANQ    1024,DL
         1 000604   000610 600000 1                  TZE     s:14295

      234    14293    3                       VBLK.EVENT = %XSS_SEV_AB_NR;

  14293  1 000605   000002 236007                    LDQ     2,DL
         1 000606   000001 552104                    STBQ    1,'04'O,PR0
         1 000607   003656 710000 1                  TRA     s:21273

      235    14294    3                   ELSE
      236    14295    3                       VBLK.EVENT = %XSS_SEV_AB_R;

  14295  1 000610   000003 236007                    LDQ     3,DL
         1 000611   000001 552104                    STBQ    1,'04'O,PR0

      237    14296    3                   END;

  14296  1 000612   003656 710000 1                  TRA     s:21273

      238    14297    3               ELSE DO;  /* AI is always concatenated */

      239    14298                        /* this is an AI SPDU */
      240    14299    3                   XSS$ACTIVITY_INTERRUPT = XSS_ACTIVITY_INTERRUPT;

  14299  1 000613   200033 470500                    LDP0    SFPT$,,AUTO
         1 000614   000026 237000 0                  LDAQ    XSS_ACTIVITY_INTERRUPT
         1 000615   000000 755100                    STA     0,,PR0
         1 000616   000001 756100                    STQ     1,,PR0

      241    14300    3                   XSS$ACTIVITY_INTERRUPT.FNC = %XSS_FNC_SACIIND#;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:72   

  14300  1 000617   012000 236003                    LDQ     5120,DU
         1 000620   000000 552140                    STBQ    0,'40'O,PR0

      242    14301                        %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);

  14346  1 000621   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000622   000001 735000                    ALS     1
         1 000623   200046 631500                    EPPR1   TEMP,,AUTO
         1 000624   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  14360  1 000625   000005 236000 2                  LDQ     5
         1 000626   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14367  1 000627   003744 701000 1                  TSX1    SCAN
         1 000630   003743 702000 1                  TSX2    SCANERR

      243    14370    3                   XSS$ACTIVITY_INTERRUPT.REASON = TEMP;

  14370  1 000631   200033 470500                    LDP0    SFPT$,,AUTO
         1 000632   200046 236100                    LDQ     TEMP,,AUTO
         1 000633   000011 736000                    QLS     9
         1 000634   000000 552110                    STBQ    0,'10'O,PR0

      244    14371    3                   VBLK.EVENT = %XSS_SEV_AI;

  14371  1 000635   200003 471500                    LDP1    @VBLK,,AUTO
         1 000636   000011 236007                    LDQ     9,DL
         1 000637   100001 552104                    STBQ    1,'04'O,PR1

      245    14372    3                   END;

  14372  1 000640   003656 710000 1                  TRA     s:21273

      246    14373        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:73   
      247    14374        /*****************************************************************************
      248    14375        *
      249    14376        *       AC              ACCEPT SPDU
      250    14377        *
      251    14378        *****************************************************************************/
      252    14379    2           CASE( %SI_AC);

      253    14380    2               XSS$CONNECT = XSS_CONNECT;

  14380  1 000641   200033 470500                    LDP0    SFPT$,,AUTO
         1 000642   000100 100400                    MLR     fill='000'O
         1 000643   000060 000054 0                  ADSC9   XSS_CONNECT              cn=0,n=44
         1 000644   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44

      254    14381    2               XSS$CONNECT.FNC = %XSS_FNC_SCONCNF#;

  14381  1 000645   030000 236003                    LDQ     12288,DU
         1 000646   000000 552140                    STBQ    0,'40'O,PR0

      255    14382    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);

  14382  1 000647   200003 471500                    LDP1    @VBLK,,AUTO
         1 000650   100000 473500                    LDP3    0,,PR1
         1 000651   200033 236100                    LDQ     SFPT$,,AUTO
         1 000652   000006 036003                    ADLQ    6,DU
         1 000653   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 000654   300003 634500                    EPPR4   3,,PR3
         1 000655   200154 454500                    STP4    ITEMLIST+67,,AUTO
         1 000656   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 000657   000001 631400 2                  EPPR1   1
         1 000660   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000661   000000 011000                    NOP     0

      256    14383    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);

  14383  1 000662   200003 470500                    LDP0    @VBLK,,AUTO
         1 000663   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:74   
         1 000664   200033 236100                    LDQ     SFPT$,,AUTO
         1 000665   000007 036003                    ADLQ    7,DU
         1 000666   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 000667   200156 451500                    STP1    ITEMLIST+69,,AUTO
         1 000670   200156 236100                    LDQ     ITEMLIST+69,,AUTO
         1 000671   000006 036000 2                  ADLQ    6
         1 000672   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 000673   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 000674   000001 631400 2                  EPPR1   1
         1 000675   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000676   000000 011000                    NOP     0

      257    14384    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);

  14384  1 000677   200003 470500                    LDP0    @VBLK,,AUTO
         1 000700   000000 471500                    LDP1    0,,PR0
         1 000701   200033 236100                    LDQ     SFPT$,,AUTO
         1 000702   000005 036003                    ADLQ    5,DU
         1 000703   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 000704   100004 633500                    EPPR3   4,,PR1
         1 000705   200154 453500                    STP3    ITEMLIST+67,,AUTO
         1 000706   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 000707   000001 631400 2                  EPPR1   1
         1 000710   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000711   000000 011000                    NOP     0

      258    14385                    %SCAN( LVL=1, TAG=SI_AC, TYP=NONE);

  14444  1 000712   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000713   000001 735000                    ALS     1
         1 000714   016001 236007                    LDQ     7169,DL
         1 000715   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14451  1 000716   003744 701000 1                  TSX1    SCAN
         1 000717   003743 702000 1                  TSX2    SCANERR

      259    14454                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:75   

  14513  1 000720   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000721   000001 735000                    ALS     1
         1 000722   401002 236007                    LDQ     -130558,DL
         1 000723   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14520  1 000724   003744 701000 1                  TSX1    SCAN
         1 000725   003743 702000 1                  TSX2    SCANERR

      260    14523    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;

  14523  1 000726   200027 235100                    LDA     ITEMCUR,,AUTO
         1 000727   000001 735000                    ALS     1
         1 000730   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 000731   000007 376007                    ANQ     7,DL
         1 000732   000003 116007                    CMPQ    3,DL
         1 000733   000767 602000 1                  TNC     s:14794

      261    14524                        %SCAN( LVL=3, TAG=PI_ASSUR, TYP=TXTC, OPT=Y,
      262    14525                                LEN=224, VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");

  14575  1 000734   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000735   000001 735000                    ALS     1
         1 000736   200033 470500                    LDP0    SFPT$,,AUTO
         1 000737   000007 471500                    LDP1    7,,PR0
         1 000740   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  14584  1 000741   000007 236000 2                  LDQ     7
         1 000742   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14591  1 000743   003744 701000 1                  TSX1    SCAN
         1 000744   003743 702000 1                  TSX2    SCANERR

      263    14594                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      264    14595                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");

  14645  1 000745   000000 235000 xsym               LDA     XSS_ITEMCNT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:76   
         1 000746   000001 735000                    ALS     1
         1 000747   200033 470500                    LDP0    SFPT$,,AUTO
         1 000750   000005 471500                    LDP1    5,,PR0
         1 000751   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  14654  1 000752   000010 236000 2                  LDQ     8
         1 000753   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14661  1 000754   003744 701000 1                  TSX1    SCAN
         1 000755   003743 702000 1                  TSX2    SCANERR

      265    14664                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      266    14665                                LEN=4, VAL="XSS$CONNECT.ARI");

  14710  1 000756   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000757   000001 735000                    ALS     1
         1 000760   200033 236100                    LDQ     SFPT$,,AUTO
         1 000761   000012 036003                    ADLQ    10,DU
         1 000762   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  14724  1 000763   000011 236000 2                  LDQ     9
         1 000764   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14731  1 000765   003744 701000 1                  TSX1    SCAN
         1 000766   003743 702000 1                  TSX2    SCANERR

      267    14734    3                   END;

      268    14735                    %SCAN( LVL=2, TAG=PGI_CAI, TYP=NONE, OPT=Y);

  14794  1 000767   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 000770   000001 735000                    ALS     1
         1 000771   405002 236007                    LDQ     -128510,DL
         1 000772   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14801  1 000773   003744 701000 1                  TSX1    SCAN
         1 000774   003743 702000 1                  TSX2    SCANERR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:77   

      269    14804    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;

  14804  1 000775   200027 235100                    LDA     ITEMCUR,,AUTO
         1 000776   000001 735000                    ALS     1
         1 000777   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 001000   000007 376007                    ANQ     7,DL
         1 001001   000003 116007                    CMPQ    3,DL
         1 001002   001106 602000 1                  TNC     s:15211

      270    14805                        %SCAN( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL=TEMP);

  14850  1 001003   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001004   000001 735000                    ALS     1
         1 001005   200046 630500                    EPPR0   TEMP,,AUTO
         1 001006   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  14864  1 001007   000012 236000 2                  LDQ     10
         1 001010   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14871  1 001011   003744 701000 1                  TSX1    SCAN
         1 001012   003743 702000 1                  TSX2    SCANERR

      271    14874    3                   SCTX.PO = TEMP;

  14874  1 001013   200003 470500                    LDP0    @VBLK,,AUTO
         1 001014   000000 471500                    LDP1    0,,PR0
         1 001015   200046 236100                    LDQ     TEMP,,AUTO
         1 001016   000033 736000                    QLS     27
         1 001017   100013 552140                    STBQ    11,'40'O,PR1

      272    14875                        %SCAN( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, OPT=Y,
      273    14876                                LEN=4, VAL=TEMP);

  14921  1 001020   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001021   000001 735000                    ALS     1
         1 001022   200046 631500                    EPPR1   TEMP,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:78   
         1 001023   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  14935  1 001024   000013 236000 2                  LDQ     11
         1 001025   200051 756105                    STQ     ITEMLIST,AL,AUTO

  14942  1 001026   003744 701000 1                  TSX1    SCAN
         1 001027   003743 702000 1                  TSX2    SCANERR

      274    14945    3                   SCTX.TSDUMS.INI = TEMP / 65536;

  14945  1 001030   200003 470500                    LDP0    @VBLK,,AUTO
         1 001031   000000 471500                    LDP1    0,,PR0
         1 001032   200046 236100                    LDQ     TEMP,,AUTO
         1 001033   200000 506007                    DIV     65536,DL
         1 001034   000000 620006                    EAX0    0,QL
         1 001035   100014 740100                    STX0    12,,PR1

      275    14946    3                   SCTX.TSDUMS.RSP = MOD( TEMP, 65536);

  14946  1 001036   000000 471500                    LDP1    0,,PR0
         1 001037   200046 236100                    LDQ     TEMP,,AUTO
         1 001040   200000 506007                    DIV     65536,DL
         1 001041   000000 620005                    EAX0    0,AL
         1 001042   100014 440100                    SXL0    12,,PR1

      276    14947                        %SCAN( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL=TEMP);

  14992  1 001043   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001044   000001 735000                    ALS     1
         1 001045   200046 631500                    EPPR1   TEMP,,AUTO
         1 001046   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  15006  1 001047   000014 236000 2                  LDQ     12
         1 001050   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15013  1 001051   003744 701000 1                  TSX1    SCAN
         1 001052   003743 702000 1                  TSX2    SCANERR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:79   

      277    15016    3                   SCTX.VN = TEMP;

  15016  1 001053   200003 470500                    LDP0    @VBLK,,AUTO
         1 001054   000000 471500                    LDP1    0,,PR0
         1 001055   200046 236100                    LDQ     TEMP,,AUTO
         1 001056   000026 736000                    QLS     22
         1 001057   100013 676100                    ERQ     11,,PR1
         1 001060   000360 376003                    ANQ     240,DU
         1 001061   100013 656100                    ERSQ    11,,PR1

      278    15017                        %SCAN( LVL=3, TAG=PI_ISN, TYP=UBC6, OPT=Y,
      279    15018                                LEN=6, VAL="XSS$CONNECT.SERNUM");

  15063  1 001062   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001063   000001 735000                    ALS     1
         1 001064   200033 236100                    LDQ     SFPT$,,AUTO
         1 001065   000004 036003                    ADLQ    4,DU
         1 001066   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  15077  1 001067   000015 236000 2                  LDQ     13
         1 001070   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15084  1 001071   003744 701000 1                  TSX1    SCAN
         1 001072   003743 702000 1                  TSX2    SCANERR

      280    15087                        %SCAN( LVL=3, TAG=PI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  15140  1 001073   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001074   000001 735000                    ALS     1
         1 001075   200004 630500                    EPPR0   BTMP,,AUTO
         1 001076   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  15146  1 001077   000016 236000 2                  LDQ     14
         1 001100   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15153  1 001101   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:80   
         1 001102   003743 702000 1                  TSX2    SCANERR

      281    15156    3                   XSS$CONNECT.ITOKENS = BTMP;

  15156  1 001103   200033 470500                    LDP0    SFPT$,,AUTO
         1 001104   200004 236100                    LDQ     BTMP,,AUTO
         1 001105   000010 552140                    STBQ    8,'40'O,PR0

      282    15157    3                   END;

      283    15158                    %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  15211  1 001106   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001107   000001 735000                    ALS     1
         1 001110   200004 630500                    EPPR0   BTMP,,AUTO
         1 001111   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  15217  1 001112   000017 236000 2                  LDQ     15
         1 001113   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15224  1 001114   003744 701000 1                  TSX1    SCAN
         1 001115   003743 702000 1                  TSX2    SCANERR

      284    15227    2               XSS$CONNECT.TOKENS = BTMP;

  15227  1 001116   200033 470500                    LDP0    SFPT$,,AUTO
         1 001117   200004 236100                    LDQ     BTMP,,AUTO
         1 001120   000033 772000                    QRL     27
         1 001121   000000 552104                    STBQ    0,'04'O,PR0

      285    15228    2               SCTX.FU = '0'B;

  15228  1 001122   200003 471500                    LDP1    @VBLK,,AUTO
         1 001123   100000 473500                    LDP3    0,,PR1
         1 001124   000000 220003                    LDX0    0,DU
         1 001125   300006 740100                    STX0    6,,PR3

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:81   
      286    15229    2               SCTX.FU.HD = %TRUE;

  15229  1 001126   100000 473500                    LDP3    0,,PR1
         1 001127   000004 236003                    LDQ     4,DU
         1 001130   300006 256100                    ORSQ    6,,PR3

      287    15230    2               SCTX.FU.SY = %TRUE;

  15230  1 001131   100000 473500                    LDP3    0,,PR1
         1 001132   000040 236003                    LDQ     32,DU
         1 001133   300006 256100                    ORSQ    6,,PR3

      288    15231    2               SCTX.FU.ACT = %TRUE;

  15231  1 001134   100000 473500                    LDP3    0,,PR1
         1 001135   000400 236003                    LDQ     256,DU
         1 001136   300006 256100                    ORSQ    6,,PR3

      289    15232    2               SCTX.FU.CD = %TRUE;

  15232  1 001137   100000 473500                    LDP3    0,,PR1
         1 001140   002000 236003                    LDQ     1024,DU
         1 001141   300006 256100                    ORSQ    6,,PR3

      290    15233    2               SCTX.FU.EXCEP = %TRUE;

  15233  1 001142   100000 473500                    LDP3    0,,PR1
         1 001143   004000 236003                    LDQ     2048,DU
         1 001144   300006 256100                    ORSQ    6,,PR3

      291    15234                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);

  15287  1 001145   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001146   000001 735000                    ALS     1
         1 001147   200004 633500                    EPPR3   BTMP,,AUTO
         1 001150   200052 453505                    STP3    ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:82   
  15293  1 001151   000020 236000 2                  LDQ     16
         1 001152   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15300  1 001153   003744 701000 1                  TSX1    SCAN
         1 001154   003743 702000 1                  TSX2    SCANERR

      292    15303    2               XSS$CONNECT.SFU = BTMP;

  15303  1 001155   200004 220100                    LDX0    BTMP,,AUTO
         1 001156   200033 470500                    LDP0    SFPT$,,AUTO
         1 001157   000010 440100                    SXL0    8,,PR0

      293    15304                    %SCAN( LVL=2, TAG=PGI_ISSEL, TYP=TXTC, OPT=Y,
      294    15305                            LEN=16, VAL="XSS$CONNECT.CALLING$->UADR.SSAP");

  15355  1 001160   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001161   000001 735000                    ALS     1
         1 001162   000006 471500                    LDP1    6,,PR0
         1 001163   200154 451500                    STP1    ITEMLIST+67,,AUTO
         1 001164   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 001165   000021 036000 2                  ADLQ    17
         1 001166   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  15364  1 001167   000022 236000 2                  LDQ     18
         1 001170   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15371  1 001171   003744 701000 1                  TSX1    SCAN
         1 001172   003743 702000 1                  TSX2    SCANERR

      295    15374    2               XSS$CONNECT.RESPONDING$->UADR.SSAP = '0'B;

  15374  1 001173   200033 470500                    LDP0    SFPT$,,AUTO
         1 001174   000007 471500                    LDP1    7,,PR0
         1 001175   000100 100400                    MLR     fill='000'O
         1 001176   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 001177   100070 200021                    ADSC9   56,,PR1                  cn=1,n=17

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:83   
      296    15375                    %SCAN( LVL=2, TAG=PGI_ASSEL, TYP=TXTC, OPT=Y,
      297    15376                            LEN=16, VAL="XSS$CONNECT.RESPONDING$->UADR.SSAP");

  15426  1 001200   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001201   000001 735000                    ALS     1
         1 001202   000007 471500                    LDP1    7,,PR0
         1 001203   200154 451500                    STP1    ITEMLIST+67,,AUTO
         1 001204   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 001205   000021 036000 2                  ADLQ    17
         1 001206   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  15435  1 001207   000023 236000 2                  LDQ     19
         1 001210   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15442  1 001211   003744 701000 1                  TSX1    SCAN
         1 001212   003743 702000 1                  TSX2    SCANERR

      298    15445    2               DATALVL = 2;

  15445  1 001213   000002 235007                    LDA     2,DL
         1 001214   200013 755100                    STA     DATALVL,,AUTO

      299    15446    2               VBLK.EVENT = %XSS_SEV_AC;

  15446  1 001215   200003 470500                    LDP0    @VBLK,,AUTO
         1 001216   000004 236007                    LDQ     4,DL
         1 001217   000001 552104                    STBQ    1,'04'O,PR0
         1 001220   003656 710000 1                  TRA     s:21273

      300    15447        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:84   
      301    15448        /*****************************************************************************
      302    15449        *
      303    15450        *       AD              ACTIVITY DISCARD SPDU
      304    15451        *
      305    15452        *****************************************************************************/
      306    15453    2           CASE( %SI_AD);

      307    15454    2               XSS$ACTIVITY_DISCARD = XSS_ACTIVITY_DISCARD;

  15454  1 001221   200033 470500                    LDP0    SFPT$,,AUTO
         1 001222   000016 237000 0                  LDAQ    XSS_ACTIVITY_DISCARD
         1 001223   000000 755100                    STA     0,,PR0
         1 001224   000001 756100                    STQ     1,,PR0

      308    15455    2               XSS$ACTIVITY_DISCARD.FNC = %XSS_FNC_SACDIND#;

  15455  1 001225   002000 236003                    LDQ     1024,DU
         1 001226   000000 552140                    STBQ    0,'40'O,PR0

      309    15456                    %SCAN( LVL=1, TAG=SI_AD, TYP=NONE);

  15515  1 001227   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001230   000001 735000                    ALS     1
         1 001231   071001 236007                    LDQ     29185,DL
         1 001232   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15522  1 001233   003744 701000 1                  TSX1    SCAN
         1 001234   003743 702000 1                  TSX2    SCANERR

      310    15525                    %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);

  15570  1 001235   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001236   000001 735000                    ALS     1
         1 001237   200046 630500                    EPPR0   TEMP,,AUTO
         1 001240   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  15584  1 001241   000005 236000 2                  LDQ     5
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:85   
         1 001242   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15591  1 001243   003744 701000 1                  TSX1    SCAN
         1 001244   003743 702000 1                  TSX2    SCANERR

      311    15594    2               XSS$ACTIVITY_DISCARD.REASON = TEMP;

  15594  1 001245   200033 470500                    LDP0    SFPT$,,AUTO
         1 001246   200046 236100                    LDQ     TEMP,,AUTO
         1 001247   000011 736000                    QLS     9
         1 001250   000000 552110                    STBQ    0,'10'O,PR0

      312    15595    2               VBLK.EVENT = %XSS_SEV_AD;

  15595  1 001251   200003 471500                    LDP1    @VBLK,,AUTO
         1 001252   000005 236007                    LDQ     5,DL
         1 001253   100001 552104                    STBQ    1,'04'O,PR1
         1 001254   003656 710000 1                  TRA     s:21273

      313    15596        /*****************************************************************************
      314    15597        *
      315    15598        *       ADA             ACTIVITY DISCARD ACK SPDU
      316    15599        *
      317    15600        *****************************************************************************/
      318    15601    2           CASE( %SI_ADA);

      319    15602                    %SCAN( LVL=1, TAG=SI_ADA, TYP=NONE);

  15661  1 001255   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 001256   000001 736000                    QLS     1
         1 001257   072001 235007                    LDA     29697,DL
         1 001260   200051 755106                    STA     ITEMLIST,QL,AUTO

  15668  1 001261   003744 701000 1                  TSX1    SCAN
         1 001262   003743 702000 1                  TSX2    SCANERR

      320    15671    2               VBLK.EVENT = %XSS_SEV_ADA;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:86   

  15671  1 001263   200003 470500                    LDP0    @VBLK,,AUTO
         1 001264   000006 236007                    LDQ     6,DL
         1 001265   000001 552104                    STBQ    1,'04'O,PR0
         1 001266   003656 710000 1                  TRA     s:21273

      321    15672        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:87   
      322    15673        /*****************************************************************************
      323    15674        *
      324    15675        *       AE              ACTIVITY END SPDU
      325    15676        *       MAP             MAJOR SYNC POINT SPDU
      326    15677        *
      327    15678        *****************************************************************************/
      328    15679    2           CASE( %SI_AE);  /* ..same as %SI_MAP */

      329    15680                    %SCAN( LVL=1, TAG=SI_AE, TYP=NONE);

  15739  1 001267   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 001270   000001 736000                    QLS     1
         1 001271   051001 235007                    LDA     20993,DL
         1 001272   200051 755106                    STA     ITEMLIST,QL,AUTO

  15746  1 001273   003744 701000 1                  TSX1    SCAN
         1 001274   003743 702000 1                  TSX2    SCANERR

      330    15749    2               IF ITEMCUR <= ITEMNUM AND

  15749  1 001275   200027 236100                    LDQ     ITEMCUR,,AUTO
         1 001276   200030 116100                    CMPQ    ITEMNUM,,AUTO
         1 001277   001347 605400 1                  TPNZ    s:15899
         1 001300   200027 235100                    LDA     ITEMCUR,,AUTO
         1 001301   000001 735000                    ALS     1
         1 001302   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 001303   377000 376007                    ANQ     130560,DL
         1 001304   017000 116007                    CMPQ    7680,DL
         1 001305   001347 601000 1                  TNZ     s:15899

      331    15750    3                       ITEMLIST.X.TAG( ITEMCUR) = %PGI_STI THEN DO;

      332    15751                        /* this is a MAP SPDU */
      333    15752    3                   XSS$SYNC_MAJOR = XSS_SYNC_MAJOR;

  15752  1 001306   200033 470500                    LDP0    SFPT$,,AUTO
         1 001307   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:88   
         1 001310   000124 000024 0                  ADSC9   XSS_SYNC_MAJOR           cn=0,n=20
         1 001311   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      334    15753    3                   XSS$SYNC_MAJOR.FNC = %XSS_FNC_SSMAIND#;

  15753  1 001312   050000 236003                    LDQ     20480,DU
         1 001313   000000 552140                    STBQ    0,'40'O,PR0

      335    15754                        %SCAN( LVL=2, TAG=PGI_STI, TYP=UBIN, LEN=1, VAL=TEMP);

  15799  1 001314   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001315   000001 735000                    ALS     1
         1 001316   200046 631500                    EPPR1   TEMP,,AUTO
         1 001317   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  15813  1 001320   000024 236000 2                  LDQ     20
         1 001321   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15820  1 001322   003744 701000 1                  TSX1    SCAN
         1 001323   003743 702000 1                  TSX2    SCANERR

      336    15823    3                   XSS$SYNC_MAJOR.TYPE = TEMP;

  15823  1 001324   200033 470500                    LDP0    SFPT$,,AUTO
         1 001325   200046 236100                    LDQ     TEMP,,AUTO
         1 001326   000011 736000                    QLS     9
         1 001327   000000 552110                    STBQ    0,'10'O,PR0

      337    15824                        %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      338    15825                                LEN=6, VAL="XSS$SYNC_MAJOR.SERNUM");

  15870  1 001330   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001331   000001 735000                    ALS     1
         1 001332   200033 236100                    LDQ     SFPT$,,AUTO
         1 001333   000004 036003                    ADLQ    4,DU
         1 001334   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:89   
  15884  1 001335   000025 236000 2                  LDQ     21
         1 001336   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15891  1 001337   003744 701000 1                  TSX1    SCAN
         1 001340   003743 702000 1                  TSX2    SCANERR

      339    15894    3                   DATALVL = 2;

  15894  1 001341   000002 235007                    LDA     2,DL
         1 001342   200013 755100                    STA     DATALVL,,AUTO

      340    15895    3                   VBLK.EVENT = %XSS_SEV_MAP;

  15895  1 001343   200003 470500                    LDP0    @VBLK,,AUTO
         1 001344   000033 236007                    LDQ     27,DL
         1 001345   000001 552104                    STBQ    1,'04'O,PR0

      341    15896    3                   END;

  15896  1 001346   003656 710000 1                  TRA     s:21273

      342    15897    3               ELSE DO;

      343    15898                        /* this is an AE SPDU */
      344    15899    3                   XSS$ACTIVITY_END = XSS_ACTIVITY_END;

  15899  1 001347   200033 470500                    LDP0    SFPT$,,AUTO
         1 001350   000100 100400                    MLR     fill='000'O
         1 001351   000020 000024 0                  ADSC9   XSS_ACTIVITY_END         cn=0,n=20
         1 001352   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      345    15900    3                   XSS$ACTIVITY_END.FNC = %XSS_FNC_SACEIND#;

  15900  1 001353   006000 236003                    LDQ     3072,DU
         1 001354   000000 552140                    STBQ    0,'40'O,PR0

      346    15901                        %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:90   
      347    15902                                LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");

  15947  1 001355   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001356   000001 735000                    ALS     1
         1 001357   200033 236100                    LDQ     SFPT$,,AUTO
         1 001360   000004 036003                    ADLQ    4,DU
         1 001361   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  15961  1 001362   000025 236000 2                  LDQ     21
         1 001363   200051 756105                    STQ     ITEMLIST,AL,AUTO

  15968  1 001364   003744 701000 1                  TSX1    SCAN
         1 001365   003743 702000 1                  TSX2    SCANERR

      348    15971    3                   DATALVL = 2;

  15971  1 001366   000002 235007                    LDA     2,DL
         1 001367   200013 755100                    STA     DATALVL,,AUTO

      349    15972    3                   VBLK.EVENT = %XSS_SEV_AE;

  15972  1 001370   200003 470500                    LDP0    @VBLK,,AUTO
         1 001371   000007 236007                    LDQ     7,DL
         1 001372   000001 552104                    STBQ    1,'04'O,PR0

      350    15973    3                   END;

  15973  1 001373   003656 710000 1                  TRA     s:21273

      351    15974        /*****************************************************************************
      352    15975        *
      353    15976        *       AEA             ACTIVITY END ACK SPDU
      354    15977        *       MAA             MAJOR SYNC ACK SPDU
      355    15978        *
      356    15979        *****************************************************************************/
      357    15980    2           CASE( %SI_AEA); /* ..same as %SI_MAA */

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:91   
      358    15981    2               XSS$ACTIVITY_END = XSS_ACTIVITY_END;

  15981  1 001374   200033 470500                    LDP0    SFPT$,,AUTO
         1 001375   000100 100400                    MLR     fill='000'O
         1 001376   000020 000024 0                  ADSC9   XSS_ACTIVITY_END         cn=0,n=20
         1 001377   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      359    15982    2               XSS$ACTIVITY_END.FNC = %XSS_FNC_SACECNF#;

  15982  1 001400   010000 236003                    LDQ     4096,DU
         1 001401   000000 552140                    STBQ    0,'40'O,PR0

      360    15983                    %SCAN( LVL=1, TAG=SI_AEA, TYP=NONE);

  16042  1 001402   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001403   000001 735000                    ALS     1
         1 001404   052001 236007                    LDQ     21505,DL
         1 001405   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16049  1 001406   003744 701000 1                  TSX1    SCAN
         1 001407   003743 702000 1                  TSX2    SCANERR

      361    16052                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      362    16053                            LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");

  16098  1 001410   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001411   000001 735000                    ALS     1
         1 001412   200033 236100                    LDQ     SFPT$,,AUTO
         1 001413   000004 036003                    ADLQ    4,DU
         1 001414   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  16112  1 001415   000025 236000 2                  LDQ     21
         1 001416   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16119  1 001417   003744 701000 1                  TSX1    SCAN
         1 001420   003743 702000 1                  TSX2    SCANERR

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:92   
      363    16122    2               DATALVL = 2;

  16122  1 001421   000002 235007                    LDA     2,DL
         1 001422   200013 755100                    STA     DATALVL,,AUTO

      364    16123    2               VBLK.EVENT = %XSS_SEV_AEA;  /* ..same as %XSS_SEV_MAA */

  16123  1 001423   200003 470500                    LDP0    @VBLK,,AUTO
         1 001424   000010 236007                    LDQ     8,DL
         1 001425   000001 552104                    STBQ    1,'04'O,PR0
         1 001426   003656 710000 1                  TRA     s:21273

      365    16124        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:93   
      366    16125        /*****************************************************************************
      367    16126        *
      368    16127        *       AR              ACTIVITY RESUME SPDU
      369    16128        *
      370    16129        *****************************************************************************/
      371    16130    2           CASE( %SI_AR);

      372    16131    2               XSS$ACTIVITY_RESUME = XSS_ACTIVITY_RESUME;

  16131  1 001427   200033 470500                    LDP0    SFPT$,,AUTO
         1 001430   000100 100400                    MLR     fill='000'O
         1 001431   000030 000064 0                  ADSC9   XSS_ACTIVITY_RESUME      cn=0,n=52
         1 001432   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

      373    16132    2               XSS$ACTIVITY_RESUME.FNC = %XSS_FNC_SACRIND#;

  16132  1 001433   016000 236003                    LDQ     7168,DU
         1 001434   000000 552140                    STBQ    0,'40'O,PR0

      374    16133    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$ACTIVITY_RESUME.CALLING$);

  16133  1 001435   200003 471500                    LDP1    @VBLK,,AUTO
         1 001436   100000 473500                    LDP3    0,,PR1
         1 001437   200033 236100                    LDQ     SFPT$,,AUTO
         1 001440   000006 036003                    ADLQ    6,DU
         1 001441   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001442   300003 634500                    EPPR4   3,,PR3
         1 001443   200154 454500                    STP4    ITEMLIST+67,,AUTO
         1 001444   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001445   000001 631400 2                  EPPR1   1
         1 001446   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001447   000000 011000                    NOP     0

      375    16134    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$ACTIVITY_RESUME.CALLED$);

  16134  1 001450   200003 470500                    LDP0    @VBLK,,AUTO
         1 001451   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:94   
         1 001452   200033 236100                    LDQ     SFPT$,,AUTO
         1 001453   000007 036003                    ADLQ    7,DU
         1 001454   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001455   200156 451500                    STP1    ITEMLIST+69,,AUTO
         1 001456   200156 236100                    LDQ     ITEMLIST+69,,AUTO
         1 001457   000006 036000 2                  ADLQ    6
         1 001460   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 001461   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001462   000001 631400 2                  EPPR1   1
         1 001463   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001464   000000 011000                    NOP     0

      376    16135    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$ACTIVITY_RESUME.COMMON$);

  16135  1 001465   200003 470500                    LDP0    @VBLK,,AUTO
         1 001466   000000 471500                    LDP1    0,,PR0
         1 001467   200033 236100                    LDQ     SFPT$,,AUTO
         1 001470   000005 036003                    ADLQ    5,DU
         1 001471   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001472   100004 633500                    EPPR3   4,,PR1
         1 001473   200154 453500                    STP3    ITEMLIST+67,,AUTO
         1 001474   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001475   000001 631400 2                  EPPR1   1
         1 001476   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001477   000000 011000                    NOP     0

      377    16136                    %SCAN( LVL=1, TAG=SI_AR, TYP=NONE);

  16195  1 001500   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001501   000001 735000                    ALS     1
         1 001502   035001 236007                    LDQ     14849,DL
         1 001503   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16202  1 001504   003744 701000 1                  TSX1    SCAN
         1 001505   003743 702000 1                  TSX2    SCANERR

      378    16205                    %SCAN( LVL=2, TAG=PGI_LI, TYP=NONE);
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:95   

  16264  1 001506   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001507   000001 735000                    ALS     1
         1 001510   041002 236007                    LDQ     16898,DL
         1 001511   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16271  1 001512   003744 701000 1                  TSX1    SCAN
         1 001513   003743 702000 1                  TSX2    SCANERR

      379    16274                    %SCAN( LVL=3, TAG=PI_ASSEL, TYP=TXTC, OPT=Y,
      380    16275                            LEN=224, VAL="XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP");

  16325  1 001514   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001515   000001 735000                    ALS     1
         1 001516   200033 470500                    LDP0    SFPT$,,AUTO
         1 001517   000007 471500                    LDP1    7,,PR0
         1 001520   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  16334  1 001521   000026 236000 2                  LDQ     22
         1 001522   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16341  1 001523   003744 701000 1                  TSX1    SCAN
         1 001524   003743 702000 1                  TSX2    SCANERR

      381    16344                    %SCAN( LVL=3, TAG=PI_ISSEL, TYP=TXTC, OPT=Y,
      382    16345                            LEN=224, VAL="XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP");

  16395  1 001525   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001526   000001 735000                    ALS     1
         1 001527   200033 470500                    LDP0    SFPT$,,AUTO
         1 001530   000006 471500                    LDP1    6,,PR0
         1 001531   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  16404  1 001532   000027 236000 2                  LDQ     23
         1 001533   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16411  1 001534   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:96   
         1 001535   003743 702000 1                  TSX2    SCANERR

      383    16414                    %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      384    16415                            LEN=64, VAL="XSS$ACTIVITY_RESUME.COMMON$->TXTC");

  16465  1 001536   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001537   000001 735000                    ALS     1
         1 001540   200033 470500                    LDP0    SFPT$,,AUTO
         1 001541   000005 471500                    LDP1    5,,PR0
         1 001542   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  16474  1 001543   000010 236000 2                  LDQ     8
         1 001544   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16481  1 001545   003744 701000 1                  TSX1    SCAN
         1 001546   003743 702000 1                  TSX2    SCANERR

      385    16484                    %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      386    16485                            LEN=4, VAL="XSS$ACTIVITY_RESUME.ARI");

  16530  1 001547   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001550   000001 735000                    ALS     1
         1 001551   200033 236100                    LDQ     SFPT$,,AUTO
         1 001552   000014 036003                    ADLQ    12,DU
         1 001553   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  16544  1 001554   000011 236000 2                  LDQ     9
         1 001555   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16551  1 001556   003744 701000 1                  TSX1    SCAN
         1 001557   003743 702000 1                  TSX2    SCANERR

      387    16554                    %SCAN( LVL=3, TAG=PI_AI, TYP=TXTC,
      388    16555                            LEN=6, VAL="XSS$ACTIVITY_RESUME.OACTID");

  16605  1 001560   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001561   000001 735000                    ALS     1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:97   
         1 001562   200033 236100                    LDQ     SFPT$,,AUTO
         1 001563   000012 036003                    ADLQ    10,DU
         1 001564   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  16614  1 001565   000030 236000 2                  LDQ     24
         1 001566   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16621  1 001567   003744 701000 1                  TSX1    SCAN
         1 001570   003743 702000 1                  TSX2    SCANERR

      389    16624                    %SCAN( LVL=3, TAG=PI_SN, TYP=UBC6,
      390    16625                            LEN=6, VAL="XSS$ACTIVITY_RESUME.SERNUM");

  16670  1 001571   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001572   000001 735000                    ALS     1
         1 001573   200033 236100                    LDQ     SFPT$,,AUTO
         1 001574   000004 036003                    ADLQ    4,DU
         1 001575   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  16684  1 001576   000031 236000 2                  LDQ     25
         1 001577   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16691  1 001600   003744 701000 1                  TSX1    SCAN
         1 001601   003743 702000 1                  TSX2    SCANERR

      391    16694                    %SCAN( LVL=2, TAG=PGI_AI, TYP=TXTC,
      392    16695                            LEN=6, VAL="XSS$ACTIVITY_RESUME.ACTID");

  16745  1 001602   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001603   000001 735000                    ALS     1
         1 001604   200033 236100                    LDQ     SFPT$,,AUTO
         1 001605   000010 036003                    ADLQ    8,DU
         1 001606   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  16754  1 001607   000032 236000 2                  LDQ     26
         1 001610   200051 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:98   
  16761  1 001611   003744 701000 1                  TSX1    SCAN
         1 001612   003743 702000 1                  TSX2    SCANERR

      393    16764    2               DATALVL = 2;

  16764  1 001613   000002 235007                    LDA     2,DL
         1 001614   200013 755100                    STA     DATALVL,,AUTO

      394    16765    2               VBLK.EVENT = %XSS_SEV_AR;

  16765  1 001615   200003 470500                    LDP0    @VBLK,,AUTO
         1 001616   000013 236007                    LDQ     11,DL
         1 001617   000001 552104                    STBQ    1,'04'O,PR0
         1 001620   003656 710000 1                  TRA     s:21273

      395    16766        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:99   
      396    16767        /*****************************************************************************
      397    16768        *
      398    16769        *       AS              ACTIVITY START SPDU
      399    16770        *
      400    16771        *****************************************************************************/
      401    16772    2           CASE( %SI_AS);

      402    16773    2               XSS$ACTIVITY_START = XSS_ACTIVITY_START;

  16773  1 001621   200033 470500                    LDP0    SFPT$,,AUTO
         1 001622   000100 100400                    MLR     fill='000'O
         1 001623   000046 000030 0                  ADSC9   XSS_ACTIVITY_START       cn=0,n=24
         1 001624   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24

      403    16774    2               XSS$ACTIVITY_START.FNC = %XSS_FNC_SACSIND#;

  16774  1 001625   020000 236003                    LDQ     8192,DU
         1 001626   000000 552140                    STBQ    0,'40'O,PR0

      404    16775                    %SCAN( LVL=1, TAG=SI_AS, TYP=NONE);

  16834  1 001627   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001630   000001 735000                    ALS     1
         1 001631   055001 236007                    LDQ     23041,DL
         1 001632   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16841  1 001633   003744 701000 1                  TSX1    SCAN
         1 001634   003743 702000 1                  TSX2    SCANERR

      405    16844                    %SCAN( LVL=2, TAG=PGI_AI, TYP=TXTC,
      406    16845                            LEN=6, VAL="XSS$ACTIVITY_START.ACTID");

  16895  1 001635   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001636   000001 735000                    ALS     1
         1 001637   200033 236100                    LDQ     SFPT$,,AUTO
         1 001640   000004 036003                    ADLQ    4,DU
         1 001641   200052 756105                    STQ     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:100  

  16904  1 001642   000032 236000 2                  LDQ     26
         1 001643   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16911  1 001644   003744 701000 1                  TSX1    SCAN
         1 001645   003743 702000 1                  TSX2    SCANERR

      407    16914    2               DATALVL = 2;

  16914  1 001646   000002 235007                    LDA     2,DL
         1 001647   200013 755100                    STA     DATALVL,,AUTO

      408    16915    2               VBLK.EVENT = %XSS_SEV_AS;

  16915  1 001650   200003 470500                    LDP0    @VBLK,,AUTO
         1 001651   000014 236007                    LDQ     12,DL
         1 001652   000001 552104                    STBQ    1,'04'O,PR0
         1 001653   003656 710000 1                  TRA     s:21273

      409    16916        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:101  
      410    16917        /*****************************************************************************
      411    16918        *
      412    16919        *       CD              CAPABILITY DATA SPDU
      413    16920        *
      414    16921        *****************************************************************************/
      415    16922    2           CASE( %SI_CD);

      416    16923    2               XSS$CAPABILITY_DATA = XSS_CAPABILITY_DATA;

  16923  1 001654   200033 470500                    LDP0    SFPT$,,AUTO
         1 001655   000100 100400                    MLR     fill='000'O
         1 001656   000054 000020 0                  ADSC9   XSS_CAPABILITY_DATA      cn=0,n=16
         1 001657   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      417    16924    2               XSS$CAPABILITY_DATA.FNC = %XSS_FNC_SCADIND#;

  16924  1 001660   022000 236003                    LDQ     9216,DU
         1 001661   000000 552140                    STBQ    0,'40'O,PR0

      418    16925                    %SCAN( LVL=1, TAG=SI_CD, TYP=NONE);

  16984  1 001662   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001663   000001 735000                    ALS     1
         1 001664   075001 236007                    LDQ     31233,DL
         1 001665   200051 756105                    STQ     ITEMLIST,AL,AUTO

  16991  1 001666   003744 701000 1                  TSX1    SCAN
         1 001667   003743 702000 1                  TSX2    SCANERR

      419    16994    2               DATALVL = 2;

  16994  1 001670   000002 235007                    LDA     2,DL
         1 001671   200013 755100                    STA     DATALVL,,AUTO

      420    16995    2               VBLK.EVENT = %XSS_SEV_CD;

  16995  1 001672   200003 470500                    LDP0    @VBLK,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:102  
         1 001673   000015 236007                    LDQ     13,DL
         1 001674   000001 552104                    STBQ    1,'04'O,PR0
         1 001675   003656 710000 1                  TRA     s:21273

      421    16996        /*****************************************************************************
      422    16997        *
      423    16998        *       CDA             CAPABILITY DATA ACK SPDU
      424    16999        *
      425    17000        *****************************************************************************/
      426    17001    2           CASE( %SI_CDA);

      427    17002    2               XSS$CAPABILITY_DATA = XSS_CAPABILITY_DATA;

  17002  1 001676   200033 470500                    LDP0    SFPT$,,AUTO
         1 001677   000100 100400                    MLR     fill='000'O
         1 001700   000054 000020 0                  ADSC9   XSS_CAPABILITY_DATA      cn=0,n=16
         1 001701   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      428    17003    2               XSS$CAPABILITY_DATA.FNC = %XSS_FNC_SCADCNF#;

  17003  1 001702   024000 236003                    LDQ     10240,DU
         1 001703   000000 552140                    STBQ    0,'40'O,PR0

      429    17004                    %SCAN( LVL=1, TAG=SI_CDA, TYP=NONE);

  17063  1 001704   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001705   000001 735000                    ALS     1
         1 001706   076001 236007                    LDQ     31745,DL
         1 001707   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17070  1 001710   003744 701000 1                  TSX1    SCAN
         1 001711   003743 702000 1                  TSX2    SCANERR

      430    17073    2               DATALVL = 2;

  17073  1 001712   000002 235007                    LDA     2,DL
         1 001713   200013 755100                    STA     DATALVL,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:103  

      431    17074    2               VBLK.EVENT = %XSS_SEV_CDA;

  17074  1 001714   200003 470500                    LDP0    @VBLK,,AUTO
         1 001715   000016 236007                    LDQ     14,DL
         1 001716   000001 552104                    STBQ    1,'04'O,PR0
         1 001717   003656 710000 1                  TRA     s:21273

      432    17075        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:104  
      433    17076        /*****************************************************************************
      434    17077        *
      435    17078        *       CN              CONNECT SPDU
      436    17079        *
      437    17080        *****************************************************************************/
      438    17081    2           CASE( %SI_CN);

      439    17082    2               XSS$CONNECT = XSS_CONNECT;

  17082  1 001720   200033 470500                    LDP0    SFPT$,,AUTO
         1 001721   000100 100400                    MLR     fill='000'O
         1 001722   000060 000054 0                  ADSC9   XSS_CONNECT              cn=0,n=44
         1 001723   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44

      440    17083    2               XSS$CONNECT.FNC = %XSS_FNC_SCONIND#;

  17083  1 001724   026000 236003                    LDQ     11264,DU
         1 001725   000000 552140                    STBQ    0,'40'O,PR0

      441    17084    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);

  17084  1 001726   200003 471500                    LDP1    @VBLK,,AUTO
         1 001727   100000 473500                    LDP3    0,,PR1
         1 001730   200033 236100                    LDQ     SFPT$,,AUTO
         1 001731   000006 036003                    ADLQ    6,DU
         1 001732   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001733   300003 634500                    EPPR4   3,,PR3
         1 001734   200154 454500                    STP4    ITEMLIST+67,,AUTO
         1 001735   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001736   000001 631400 2                  EPPR1   1
         1 001737   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001740   000000 011000                    NOP     0

      442    17085    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.CALLED$);

  17085  1 001741   200003 470500                    LDP0    @VBLK,,AUTO
         1 001742   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:105  
         1 001743   200033 236100                    LDQ     SFPT$,,AUTO
         1 001744   000007 036003                    ADLQ    7,DU
         1 001745   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001746   200156 451500                    STP1    ITEMLIST+69,,AUTO
         1 001747   200156 236100                    LDQ     ITEMLIST+69,,AUTO
         1 001750   000006 036000 2                  ADLQ    6
         1 001751   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 001752   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001753   000001 631400 2                  EPPR1   1
         1 001754   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001755   000000 011000                    NOP     0

      443    17086    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);

  17086  1 001756   200003 470500                    LDP0    @VBLK,,AUTO
         1 001757   000000 471500                    LDP1    0,,PR0
         1 001760   200033 236100                    LDQ     SFPT$,,AUTO
         1 001761   000005 036003                    ADLQ    5,DU
         1 001762   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 001763   100004 633500                    EPPR3   4,,PR1
         1 001764   200154 453500                    STP3    ITEMLIST+67,,AUTO
         1 001765   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 001766   000001 631400 2                  EPPR1   1
         1 001767   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001770   000000 011000                    NOP     0

      444    17087                    %SCAN( LVL=1, TAG=SI_CN, TYP=NONE);

  17146  1 001771   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 001772   000001 735000                    ALS     1
         1 001773   015001 236007                    LDQ     6657,DL
         1 001774   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17153  1 001775   003744 701000 1                  TSX1    SCAN
         1 001776   003743 702000 1                  TSX2    SCANERR

      445    17156                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:106  

  17215  1 001777   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002000   000001 735000                    ALS     1
         1 002001   401002 236007                    LDQ     -130558,DL
         1 002002   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17222  1 002003   003744 701000 1                  TSX1    SCAN
         1 002004   003743 702000 1                  TSX2    SCANERR

      446    17225    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;

  17225  1 002005   200027 235100                    LDA     ITEMCUR,,AUTO
         1 002006   000001 735000                    ALS     1
         1 002007   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 002010   000007 376007                    ANQ     7,DL
         1 002011   000003 116007                    CMPQ    3,DL
         1 002012   002046 602000 1                  TNC     s:17496

      447    17226                        %SCAN( LVL=3, TAG=PI_ISSUR, TYP=TXTC, OPT=Y,
      448    17227                                LEN=224, VAL="XSS$CONNECT.CALLING$->UADR.PSAP");

  17277  1 002013   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002014   000001 735000                    ALS     1
         1 002015   200033 470500                    LDP0    SFPT$,,AUTO
         1 002016   000006 471500                    LDP1    6,,PR0
         1 002017   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  17286  1 002020   000033 236000 2                  LDQ     27
         1 002021   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17293  1 002022   003744 701000 1                  TSX1    SCAN
         1 002023   003743 702000 1                  TSX2    SCANERR

      449    17296                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      450    17297                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");

  17347  1 002024   000000 235000 xsym               LDA     XSS_ITEMCNT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:107  
         1 002025   000001 735000                    ALS     1
         1 002026   200033 470500                    LDP0    SFPT$,,AUTO
         1 002027   000005 471500                    LDP1    5,,PR0
         1 002030   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  17356  1 002031   000010 236000 2                  LDQ     8
         1 002032   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17363  1 002033   003744 701000 1                  TSX1    SCAN
         1 002034   003743 702000 1                  TSX2    SCANERR

      451    17366                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      452    17367                                LEN=4, VAL="XSS$CONNECT.ARI");

  17412  1 002035   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002036   000001 735000                    ALS     1
         1 002037   200033 236100                    LDQ     SFPT$,,AUTO
         1 002040   000012 036003                    ADLQ    10,DU
         1 002041   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  17426  1 002042   000011 236000 2                  LDQ     9
         1 002043   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17433  1 002044   003744 701000 1                  TSX1    SCAN
         1 002045   003743 702000 1                  TSX2    SCANERR

      453    17436    3                   END;

      454    17437                    %SCAN( LVL=2, TAG=PGI_CAI, TYP=NONE, OPT=Y);

  17496  1 002046   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002047   000001 735000                    ALS     1
         1 002050   405002 236007                    LDQ     -128510,DL
         1 002051   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17503  1 002052   003744 701000 1                  TSX1    SCAN
         1 002053   003743 702000 1                  TSX2    SCANERR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:108  

      455    17506    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;

  17506  1 002054   200027 235100                    LDA     ITEMCUR,,AUTO
         1 002055   000001 735000                    ALS     1
         1 002056   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 002057   000007 376007                    ANQ     7,DL
         1 002060   000003 116007                    CMPQ    3,DL
         1 002061   002165 602000 1                  TNC     s:17860

      456    17507                        %SCAN( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL=TEMP);

  17552  1 002062   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002063   000001 735000                    ALS     1
         1 002064   200046 630500                    EPPR0   TEMP,,AUTO
         1 002065   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  17566  1 002066   000012 236000 2                  LDQ     10
         1 002067   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17573  1 002070   003744 701000 1                  TSX1    SCAN
         1 002071   003743 702000 1                  TSX2    SCANERR

      457    17576    3                   SCTX.PO = TEMP;

  17576  1 002072   200003 470500                    LDP0    @VBLK,,AUTO
         1 002073   000000 471500                    LDP1    0,,PR0
         1 002074   200046 236100                    LDQ     TEMP,,AUTO
         1 002075   000033 736000                    QLS     27
         1 002076   100013 552140                    STBQ    11,'40'O,PR1

      458    17577                        %SCAN( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, OPT=Y,
      459    17578                                LEN=4, VAL=TEMP);

  17623  1 002077   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002100   000001 735000                    ALS     1
         1 002101   200046 631500                    EPPR1   TEMP,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:109  
         1 002102   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  17637  1 002103   000013 236000 2                  LDQ     11
         1 002104   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17644  1 002105   003744 701000 1                  TSX1    SCAN
         1 002106   003743 702000 1                  TSX2    SCANERR

      460    17647    3                   SCTX.TSDUMS.INI = TEMP / 65536;

  17647  1 002107   200003 470500                    LDP0    @VBLK,,AUTO
         1 002110   000000 471500                    LDP1    0,,PR0
         1 002111   200046 236100                    LDQ     TEMP,,AUTO
         1 002112   200000 506007                    DIV     65536,DL
         1 002113   000000 620006                    EAX0    0,QL
         1 002114   100014 740100                    STX0    12,,PR1

      461    17648    3                   SCTX.TSDUMS.RSP = MOD( TEMP, 65536);

  17648  1 002115   000000 471500                    LDP1    0,,PR0
         1 002116   200046 236100                    LDQ     TEMP,,AUTO
         1 002117   200000 506007                    DIV     65536,DL
         1 002120   000000 620005                    EAX0    0,AL
         1 002121   100014 440100                    SXL0    12,,PR1

      462    17649                        %SCAN( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL=TEMP);

  17694  1 002122   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002123   000001 735000                    ALS     1
         1 002124   200046 631500                    EPPR1   TEMP,,AUTO
         1 002125   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  17708  1 002126   000014 236000 2                  LDQ     12
         1 002127   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17715  1 002130   003744 701000 1                  TSX1    SCAN
         1 002131   003743 702000 1                  TSX2    SCANERR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:110  

      463    17718    3                   SCTX.VN = TEMP;

  17718  1 002132   200003 470500                    LDP0    @VBLK,,AUTO
         1 002133   000000 471500                    LDP1    0,,PR0
         1 002134   200046 236100                    LDQ     TEMP,,AUTO
         1 002135   000026 736000                    QLS     22
         1 002136   100013 676100                    ERQ     11,,PR1
         1 002137   000360 376003                    ANQ     240,DU
         1 002140   100013 656100                    ERSQ    11,,PR1

      464    17719                        %SCAN( LVL=3, TAG=PI_ISN, TYP=UBC6, OPT=Y,
      465    17720                                LEN=6, VAL="XSS$CONNECT.SERNUM");

  17765  1 002141   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002142   000001 735000                    ALS     1
         1 002143   200033 236100                    LDQ     SFPT$,,AUTO
         1 002144   000004 036003                    ADLQ    4,DU
         1 002145   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  17779  1 002146   000015 236000 2                  LDQ     13
         1 002147   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17786  1 002150   003744 701000 1                  TSX1    SCAN
         1 002151   003743 702000 1                  TSX2    SCANERR

      466    17789                        %SCAN( LVL=3, TAG=PI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  17842  1 002152   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002153   000001 735000                    ALS     1
         1 002154   200004 630500                    EPPR0   BTMP,,AUTO
         1 002155   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  17848  1 002156   000016 236000 2                  LDQ     14
         1 002157   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17855  1 002160   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:111  
         1 002161   003743 702000 1                  TSX2    SCANERR

      467    17858    3                   XSS$CONNECT.ITOKENS = BTMP;

  17858  1 002162   200033 470500                    LDP0    SFPT$,,AUTO
         1 002163   200004 236100                    LDQ     BTMP,,AUTO
         1 002164   000010 552140                    STBQ    8,'40'O,PR0

      468    17859    3                   END;

      469    17860    2               XSS$CONNECT.SFU = '0'B;

  17860  1 002165   000000 220003                    LDX0    0,DU
         1 002166   200033 470500                    LDP0    SFPT$,,AUTO
         1 002167   000010 440100                    SXL0    8,,PR0

      470    17861    2               XSS$CONNECT.SFU.HD = %TRUE;

  17861  1 002170   000004 236007                    LDQ     4,DL
         1 002171   000010 256100                    ORSQ    8,,PR0

      471    17862    2               XSS$CONNECT.SFU.SY = %TRUE;

  17862  1 002172   000040 236007                    LDQ     32,DL
         1 002173   000010 256100                    ORSQ    8,,PR0

      472    17863    2               XSS$CONNECT.SFU.ACT = %TRUE;

  17863  1 002174   000400 236007                    LDQ     256,DL
         1 002175   000010 256100                    ORSQ    8,,PR0

      473    17864    2               XSS$CONNECT.SFU.CD = %TRUE;

  17864  1 002176   002000 236007                    LDQ     1024,DL
         1 002177   000010 256100                    ORSQ    8,,PR0

      474    17865    2               XSS$CONNECT.SFU.EXCEP = %TRUE;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:112  

  17865  1 002200   004000 236007                    LDQ     2048,DL
         1 002201   000010 256100                    ORSQ    8,,PR0

      475    17866                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);

  17919  1 002202   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002203   000001 735000                    ALS     1
         1 002204   200004 631500                    EPPR1   BTMP,,AUTO
         1 002205   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  17925  1 002206   000020 236000 2                  LDQ     16
         1 002207   200051 756105                    STQ     ITEMLIST,AL,AUTO

  17932  1 002210   003744 701000 1                  TSX1    SCAN
         1 002211   003743 702000 1                  TSX2    SCANERR

      476    17935    2               XSS$CONNECT.SFU = BTMP;

  17935  1 002212   200004 220100                    LDX0    BTMP,,AUTO
         1 002213   200033 470500                    LDP0    SFPT$,,AUTO
         1 002214   000010 440100                    SXL0    8,,PR0

      477    17936    2               SCTX.FU = XSS$CONNECT.SFU;  /* negotiate this down on AC */

  17936  1 002215   200003 471500                    LDP1    @VBLK,,AUTO
         1 002216   100000 473500                    LDP3    0,,PR1
         1 002217   300006 740100                    STX0    6,,PR3

      478    17937                    %SCAN( LVL=2, TAG=PGI_ISSEL, TYP=TXTC, OPT=Y,
      479    17938                            LEN=16, VAL="XSS$CONNECT.CALLING$->UADR.SSAP");

  17988  1 002220   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002221   000001 735000                    ALS     1
         1 002222   000006 473500                    LDP3    6,,PR0
         1 002223   200154 453500                    STP3    ITEMLIST+67,,AUTO
         1 002224   200154 236100                    LDQ     ITEMLIST+67,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:113  
         1 002225   000021 036000 2                  ADLQ    17
         1 002226   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  17997  1 002227   000022 236000 2                  LDQ     18
         1 002230   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18004  1 002231   003744 701000 1                  TSX1    SCAN
         1 002232   003743 702000 1                  TSX2    SCANERR

      480    18007    2               XSS$CONNECT.CALLED$->UADR.SSAP = '0'B;

  18007  1 002233   200033 470500                    LDP0    SFPT$,,AUTO
         1 002234   000007 471500                    LDP1    7,,PR0
         1 002235   000100 100400                    MLR     fill='000'O
         1 002236   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 002237   100070 200021                    ADSC9   56,,PR1                  cn=1,n=17

      481    18008                    %SCAN( LVL=2, TAG=PGI_ASSEL, TYP=TXTC, OPT=Y,
      482    18009                            LEN=16, VAL="XSS$CONNECT.CALLED$->UADR.SSAP");

  18059  1 002240   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002241   000001 735000                    ALS     1
         1 002242   000007 471500                    LDP1    7,,PR0
         1 002243   200154 451500                    STP1    ITEMLIST+67,,AUTO
         1 002244   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 002245   000021 036000 2                  ADLQ    17
         1 002246   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  18068  1 002247   000023 236000 2                  LDQ     19
         1 002250   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18075  1 002251   003744 701000 1                  TSX1    SCAN
         1 002252   003743 702000 1                  TSX2    SCANERR

      483    18078    2               DATALVL = 2;

  18078  1 002253   000002 235007                    LDA     2,DL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:114  
         1 002254   200013 755100                    STA     DATALVL,,AUTO

      484    18079    2               VBLK.EVENT = %XSS_SEV_CN;

  18079  1 002255   200003 470500                    LDP0    @VBLK,,AUTO
         1 002256   000017 236007                    LDQ     15,DL
         1 002257   000001 552104                    STBQ    1,'04'O,PR0
         1 002260   003656 710000 1                  TRA     s:21273

      485    18080        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:115  
      486    18081        /*****************************************************************************
      487    18082        *
      488    18083        *       DN              DISCONNECT SPDU
      489    18084        *
      490    18085        *****************************************************************************/
      491    18086    2           CASE( %SI_DN);

      492    18087    2               XSS$RELEASE = XSS_RELEASE;

  18087  1 002261   200033 470500                    LDP0    SFPT$,,AUTO
         1 002262   000100 100400                    MLR     fill='000'O
         1 002263   000112 000020 0                  ADSC9   XSS_RELEASE              cn=0,n=16
         1 002264   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      493    18088    2               XSS$RELEASE.FNC = %XSS_FNC_SRELIND#;

  18088  1 002265   040000 236003                    LDQ     16384,DU
         1 002266   000000 552140                    STBQ    0,'40'O,PR0

      494    18089                    %SCAN( LVL=1, TAG=SI_DN, TYP=NONE);

  18148  1 002267   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002270   000001 735000                    ALS     1
         1 002271   012001 236007                    LDQ     5121,DL
         1 002272   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18155  1 002273   003744 701000 1                  TSX1    SCAN
         1 002274   003743 702000 1                  TSX2    SCANERR

      495    18158    2               DATALVL = 2;

  18158  1 002275   000002 235007                    LDA     2,DL
         1 002276   200013 755100                    STA     DATALVL,,AUTO

      496    18159    2               VBLK.EVENT = %XSS_SEV_DN;

  18159  1 002277   200003 470500                    LDP0    @VBLK,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:116  
         1 002300   000020 236007                    LDQ     16,DL
         1 002301   000001 552104                    STBQ    1,'04'O,PR0
         1 002302   003656 710000 1                  TRA     s:21273

      497    18160        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:117  
      498    18161        /*****************************************************************************
      499    18162        *
      500    18163        *       DT              DATA TRANSFER SPDU
      501    18164        *       GT              GIVE TOKENS SPDU
      502    18165        *
      503    18166        *****************************************************************************/
      504    18167    2           CASE( %SI_DT);  /* ..same as %SI_GT */

      505    18168                    %SCAN( LVL=1, TAG=SI_DT, TYP=NONE);

  18227  1 002303   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 002304   000001 736000                    QLS     1
         1 002305   001001 235007                    LDA     513,DL
         1 002306   200051 755106                    STA     ITEMLIST,QL,AUTO

  18234  1 002307   003744 701000 1                  TSX1    SCAN
         1 002310   003743 702000 1                  TSX2    SCANERR

      506    18237    2               IF SCANITEM.X.LEN = 0 AND ITEMCUR = ITEMNUM THEN

  18237  1 002311   200047 220100                    LDX0    SCANITEM,,AUTO
         1 002312   002316 601000 1                  TNZ     s:18239
         1 002313   200027 236100                    LDQ     ITEMCUR,,AUTO
         1 002314   200030 116100                    CMPQ    ITEMNUM,,AUTO
         1 002315   003736 600000 1                  TZE     ENDSPDU

      507    18238    2                   GOTO ENDSPDU;
      508    18239    3               IF SPDUCUR = SPDUNUM - 1 THEN DO;  /* GT always last */

  18239  1 002316   200035 236100                    LDQ     SPDUNUM,,AUTO
         1 002317   000001 136007                    SBLQ    1,DL
         1 002320   200034 116100                    CMPQ    SPDUCUR,,AUTO
         1 002321   002352 601000 1                  TNZ     s:18319

      509    18240                        /* this is a GT SPDU */
      510    18241    3                   XSS$TOKEN_GIVE = XSS_TOKEN_GIVE;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:118  
  18241  1 002322   200033 470500                    LDP0    SFPT$,,AUTO
         1 002323   000140 237000 0                  LDAQ    XSS_TOKEN_GIVE
         1 002324   000000 755100                    STA     0,,PR0
         1 002325   000001 756100                    STQ     1,,PR0

      511    18242    3                   XSS$TOKEN_GIVE.FNC = %XSS_FNC_STKGIND#;

  18242  1 002326   060000 236003                    LDQ     24576,DU
         1 002327   000000 552140                    STBQ    0,'40'O,PR0

      512    18243                        %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  18296  1 002330   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002331   000001 735000                    ALS     1
         1 002332   200004 631500                    EPPR1   BTMP,,AUTO
         1 002333   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  18302  1 002334   000017 236000 2                  LDQ     15
         1 002335   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18309  1 002336   003744 701000 1                  TSX1    SCAN
         1 002337   003743 702000 1                  TSX2    SCANERR

      513    18312    3                   IF BTMP = '000000000'B THEN

  18312  1 002340   200004 235100                    LDA     BTMP,,AUTO
         1 002341   003736 600000 1                  TZE     ENDSPDU

      514    18313    3                       GOTO ENDSPDU;  /* no tokens given; cut short */
      515    18314    3                   XSS$TOKEN_GIVE.TOKENS = BTMP;

  18314  1 002342   200033 470500                    LDP0    SFPT$,,AUTO
         1 002343   200004 236100                    LDQ     BTMP,,AUTO
         1 002344   000033 772000                    QRL     27
         1 002345   000000 552104                    STBQ    0,'04'O,PR0

      516    18315    3                   VBLK.EVENT = %XSS_SEV_GT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:119  

  18315  1 002346   200003 471500                    LDP1    @VBLK,,AUTO
         1 002347   000027 236007                    LDQ     23,DL
         1 002350   100001 552104                    STBQ    1,'04'O,PR1

      517    18316    3                   END;

  18316  1 002351   003656 710000 1                  TRA     s:21273

      518    18317    3               ELSE DO;  /* DT never last */

      519    18318                        /* this is a DT SPDU */
      520    18319    3                   XSS$DATA = XSS_DATA;

  18319  1 002352   200033 470500                    LDP0    SFPT$,,AUTO
         1 002353   000100 100400                    MLR     fill='000'O
         1 002354   000076 000020 0                  ADSC9   XSS_DATA                 cn=0,n=16
         1 002355   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      521    18320    3                   XSS$DATA.FNC = %XSS_FNC_SDATIND#;

  18320  1 002356   034000 236003                    LDQ     14336,DU
         1 002357   000000 552140                    STBQ    0,'40'O,PR0

      522    18321    4                   IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_EI THEN
             18321                            DO;

  18321  1 002360   200030 236100                    LDQ     ITEMNUM,,AUTO
         1 002361   000001 136007                    SBLQ    1,DL
         1 002362   200027 116100                    CMPQ    ITEMCUR,,AUTO
         1 002363   002407 604400 1                  TMOZ    s:18394
         1 002364   200027 235100                    LDA     ITEMCUR,,AUTO
         1 002365   000001 735000                    ALS     1
         1 002366   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 002367   377000 376007                    ANQ     130560,DL
         1 002370   031000 116007                    CMPQ    12800,DL
         1 002371   002407 601000 1                  TNZ     s:18394
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:120  

      523    18322                            %SCAN( LVL=2, TAG=PGI_EI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  18375  1 002372   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002373   000001 735000                    ALS     1
         1 002374   200004 631500                    EPPR1   BTMP,,AUTO
         1 002375   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  18381  1 002376   000034 236000 2                  LDQ     28
         1 002377   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18388  1 002400   003744 701000 1                  TSX1    SCAN
         1 002401   003743 702000 1                  TSX2    SCANERR

      524    18391    4                       VBLK.EI = BTMP;

  18391  1 002402   200003 470500                    LDP0    @VBLK,,AUTO
         1 002403   200004 236100                    LDQ     BTMP,,AUTO
         1 002404   000022 772000                    QRL     18
         1 002405   000001 552110                    STBQ    1,'10'O,PR0

      525    18392    4                       END;

  18392  1 002406   002414 710000 1                  TRA     s:18397

      526    18393    4                   ELSE DO;

      527    18394    4                       VBLK.EI.BOSSDU = %TRUE;

  18394  1 002407   200003 471500                    LDP1    @VBLK,,AUTO
         1 002410   004000 236007                    LDQ     2048,DL
         1 002411   100001 256100                    ORSQ    1,,PR1

      528    18395    4                       VBLK.EI.EOSSDU = %TRUE;

  18395  1 002412   002000 236007                    LDQ     1024,DL
         1 002413   100001 256100                    ORSQ    1,,PR1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:121  

      529    18396    4                       END;

      530    18397    3                   DATALVL = 2;

  18397  1 002414   000002 235007                    LDA     2,DL
         1 002415   200013 755100                    STA     DATALVL,,AUTO

      531    18398    3                   DATATAG = 0;

  18398  1 002416   200014 450100                    STZ     DATATAG,,AUTO

      532    18399    3                   VBLK.EVENT = %XSS_SEV_DT;

  18399  1 002417   200003 470500                    LDP0    @VBLK,,AUTO
         1 002420   000021 236007                    LDQ     17,DL
         1 002421   000001 552104                    STBQ    1,'04'O,PR0

      533    18400    3                   END;

  18400  1 002422   003656 710000 1                  TRA     s:21273

      534    18401        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:122  
      535    18402        /*****************************************************************************
      536    18403        *
      537    18404        *       ED              EXCEPTION DATA SPDU
      538    18405        *
      539    18406        *****************************************************************************/
      540    18407    2           CASE( %SI_ED);

      541    18408    2               XSS$U_EXCEPTION_REPORT = XSS_U_EXCEPTION_REPORT;

  18408  1 002423   200033 470500                    LDP0    SFPT$,,AUTO
         1 002424   000100 100400                    MLR     fill='000'O
         1 002425   000156 000020 0                  ADSC9   XSS_U_EXCEPTION_REPORT   cn=0,n=16
         1 002426   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      542    18409    2               XSS$U_EXCEPTION_REPORT.FNC = %XSS_FNC_SUERIND#;

  18409  1 002427   070000 236003                    LDQ     28672,DU
         1 002430   000000 552140                    STBQ    0,'40'O,PR0

      543    18410                    %SCAN( LVL=1, TAG=SI_ED, TYP=NONE);

  18469  1 002431   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002432   000001 735000                    ALS     1
         1 002433   060001 236007                    LDQ     24577,DL
         1 002434   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18476  1 002435   003744 701000 1                  TSX1    SCAN
         1 002436   003743 702000 1                  TSX2    SCANERR

      544    18479                    %SCAN( LVL=2, TAG=PGI_RC, TYP=UBIN, LEN=1, VAL=TEMP);

  18524  1 002437   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002440   000001 735000                    ALS     1
         1 002441   200046 630500                    EPPR0   TEMP,,AUTO
         1 002442   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  18538  1 002443   000035 236000 2                  LDQ     29
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:123  
         1 002444   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18545  1 002445   003744 701000 1                  TSX1    SCAN
         1 002446   003743 702000 1                  TSX2    SCANERR

      545    18548    2               XSS$U_EXCEPTION_REPORT.REASON = TEMP;

  18548  1 002447   200033 470500                    LDP0    SFPT$,,AUTO
         1 002450   200046 236100                    LDQ     TEMP,,AUTO
         1 002451   000011 736000                    QLS     9
         1 002452   000000 552110                    STBQ    0,'10'O,PR0

      546    18549    2               DATALVL = 2;

  18549  1 002453   000002 235007                    LDA     2,DL
         1 002454   200013 755100                    STA     DATALVL,,AUTO

      547    18550    2               VBLK.EVENT = %XSS_SEV_ED;

  18550  1 002455   200003 471500                    LDP1    @VBLK,,AUTO
         1 002456   000022 236007                    LDQ     18,DL
         1 002457   100001 552104                    STBQ    1,'04'O,PR1
         1 002460   003656 710000 1                  TRA     s:21273

      548    18551        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:124  
      549    18552        /*****************************************************************************
      550    18553        *
      551    18554        *       ER              EXCEPTION REPORT SPDU
      552    18555        *
      553    18556        *****************************************************************************/
      554    18557    2           CASE( %SI_ER);

      555    18558    2               XSS$U_EXCEPTION_REPORT = XSS_U_EXCEPTION_REPORT;

  18558  1 002461   200033 470500                    LDP0    SFPT$,,AUTO
         1 002462   000100 100400                    MLR     fill='000'O
         1 002463   000156 000020 0                  ADSC9   XSS_U_EXCEPTION_REPORT   cn=0,n=16
         1 002464   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      556    18559    2               XSS$U_EXCEPTION_REPORT.FNC = %XSS_FNC_SPERIND#;

  18559  1 002465   072000 236003                    LDQ     29696,DU
         1 002466   000000 552140                    STBQ    0,'40'O,PR0

      557    18560                    %SCAN( LVL=1, TAG=SI_ER, TYP=NONE);

  18619  1 002467   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002470   000001 735000                    ALS     1
         1 002471   000001 236007                    LDQ     1,DL
         1 002472   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18626  1 002473   003744 701000 1                  TSX1    SCAN
         1 002474   003743 702000 1                  TSX2    SCANERR

      558    18629                    %SCAN( LVL=2, TAG=PGI_RPV, TYP=CPTR, LEN=262143, VAL=NIL);

  18679  1 002475   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002476   000001 735000                    ALS     1
         1 002477   000036 236000 2                  LDQ     30
         1 002500   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  18688  1 002501   777777 236007                    LDQ     -1,DL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:125  
         1 002502   000000 620005                    EAX0    0,AL
         1 002503   000001 402003                    MPY     1,DU
         1 002504   061022 036007                    ADLQ    25106,DL
         1 002505   200051 756110                    STQ     ITEMLIST,X0,AUTO

  18695  1 002506   003744 701000 1                  TSX1    SCAN
         1 002507   003743 702000 1                  TSX2    SCANERR

      559    18698    2               SCANITEM.X.LEN = MINIMUM( 9, SCANITEM.X.LEN);

  18698  1 002510   200047 236100                    LDQ     SCANITEM,,AUTO
         1 002511   000022 772000                    QRL     18
         1 002512   000011 116007                    CMPQ    9,DL
         1 002513   002516 602000 1                  TNC     s:18698+6
         1 002514   002516 600000 1                  TZE     s:18698+6
         1 002515   000011 236007                    LDQ     9,DL
         1 002516   000000 620006                    EAX0    0,QL
         1 002517   200047 740100                    STX0    SCANITEM,,AUTO

      560    18699    2               SCTX.RPV = '0'B;

  18699  1 002520   200003 470500                    LDP0    @VBLK,,AUTO
         1 002521   000000 471500                    LDP1    0,,PR0
         1 002522   000100 100400                    MLR     fill='000'O
         1 002523   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 002524   100000 400012                    ADSC9   0,,PR1                   cn=2,n=10

      561    18700    2               ADDR( SCTX.RPV)->BYTES = SCANITEM.P->BYTES;

  18700  1 002525   000000 471500                    LDP1    0,,PR0
         1 002526   200050 473500                    LDP3    SCANITEM+1,,AUTO
         1 002527   040140 100540                    MLR     fill='040'O
         1 002530   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 002531   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0

      562    18701    2               VBLK.EVENT = %XSS_SEV_ER;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:126  
  18701  1 002532   000023 236007                    LDQ     19,DL
         1 002533   000001 552104                    STBQ    1,'04'O,PR0
         1 002534   003656 710000 1                  TRA     s:21273

      563    18702        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:127  
      564    18703        /*****************************************************************************
      565    18704        *
      566    18705        *       EX              EXPEDITED DATA SPDU
      567    18706        *
      568    18707        *****************************************************************************/
      569    18708    2           CASE( %SI_EX);

      570    18709    2               XSS$EXPEDITED_DATA = XSS_EXPEDITED_DATA;

  18709  1 002535   200033 470500                    LDP0    SFPT$,,AUTO
         1 002536   000100 100400                    MLR     fill='000'O
         1 002537   000102 000020 0                  ADSC9   XSS_EXPEDITED_DATA       cn=0,n=16
         1 002540   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      571    18710    2               XSS$EXPEDITED_DATA.FNC = %XSS_FNC_SEXPIND#;

  18710  1 002541   036000 236003                    LDQ     15360,DU
         1 002542   000000 552140                    STBQ    0,'40'O,PR0

      572    18711                    %SCAN( LVL=1, TAG=SI_EX, TYP=NONE);

  18770  1 002543   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002544   000001 735000                    ALS     1
         1 002545   005001 236007                    LDQ     2561,DL
         1 002546   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18777  1 002547   003744 701000 1                  TSX1    SCAN
         1 002550   003743 702000 1                  TSX2    SCANERR

      573    18780    2               DATALVL = 2;

  18780  1 002551   000002 235007                    LDA     2,DL
         1 002552   200013 755100                    STA     DATALVL,,AUTO

      574    18781    2               DATALEN = 14;

  18781  1 002553   000016 236007                    LDQ     14,DL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:128  
         1 002554   200012 756100                    STQ     DATALEN,,AUTO

      575    18782    2               DATATAG = 0;

  18782  1 002555   200014 450100                    STZ     DATATAG,,AUTO

      576    18783    2               VBLK.EVENT = %XSS_SEV_EX;

  18783  1 002556   200003 470500                    LDP0    @VBLK,,AUTO
         1 002557   000024 236007                    LDQ     20,DL
         1 002560   000001 552104                    STBQ    1,'04'O,PR0
         1 002561   003656 710000 1                  TRA     s:21273

      577    18784        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:129  
      578    18785        /*****************************************************************************
      579    18786        *
      580    18787        *       FN_NR           FINISH (NO REUSE) SPDU
      581    18788        *       FN_R            FINISH (REUSE) SPDU
      582    18789        *
      583    18790        *****************************************************************************/
      584    18791    2           CASE( %SI_FN);

      585    18792    2               XSS$RELEASE = XSS_RELEASE;

  18792  1 002562   200033 470500                    LDP0    SFPT$,,AUTO
         1 002563   000100 100400                    MLR     fill='000'O
         1 002564   000112 000020 0                  ADSC9   XSS_RELEASE              cn=0,n=16
         1 002565   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      586    18793    2               XSS$RELEASE.FNC = %XSS_FNC_SRELCNF#;

  18793  1 002566   042000 236003                    LDQ     17408,DU
         1 002567   000000 552140                    STBQ    0,'40'O,PR0

      587    18794                    %SCAN( LVL=1, TAG=SI_FN, TYP=NONE);

  18853  1 002570   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002571   000001 735000                    ALS     1
         1 002572   011001 236007                    LDQ     4609,DL
         1 002573   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18860  1 002574   003744 701000 1                  TSX1    SCAN
         1 002575   003743 702000 1                  TSX2    SCANERR

      588    18863                    %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  18916  1 002576   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002577   000001 735000                    ALS     1
         1 002600   200004 630500                    EPPR0   BTMP,,AUTO
         1 002601   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:130  
  18922  1 002602   000037 236000 2                  LDQ     31
         1 002603   200051 756105                    STQ     ITEMLIST,AL,AUTO

  18929  1 002604   003744 701000 1                  TSX1    SCAN
         1 002605   003743 702000 1                  TSX2    SCANERR

      589    18932    2               SCTX.TD = BTMP;

  18932  1 002606   200003 470500                    LDP0    @VBLK,,AUTO
         1 002607   000000 471500                    LDP1    0,,PR0
         1 002610   200004 236100                    LDQ     BTMP,,AUTO
         1 002611   000022 772000                    QRL     18
         1 002612   100015 552110                    STBQ    13,'10'O,PR1

      590    18933    2               DATALVL = 2;

  18933  1 002613   000002 235007                    LDA     2,DL
         1 002614   200013 755100                    STA     DATALVL,,AUTO

      591    18934    2               IF SCTX.TD.TCREL THEN

  18934  1 002615   000000 471500                    LDP1    0,,PR0
         1 002616   100015 236100                    LDQ     13,,PR1
         1 002617   002000 316007                    CANQ    1024,DL
         1 002620   002624 600000 1                  TZE     s:18937

      592    18935    2                   VBLK.EVENT = %XSS_SEV_FN_NR;

  18935  1 002621   000025 236007                    LDQ     21,DL
         1 002622   000001 552104                    STBQ    1,'04'O,PR0
         1 002623   003656 710000 1                  TRA     s:21273

      593    18936    2               ELSE
      594    18937    2                   VBLK.EVENT = %XSS_SEV_FN_R;

  18937  1 002624   000026 236007                    LDQ     22,DL
         1 002625   000001 552104                    STBQ    1,'04'O,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:131  
         1 002626   003656 710000 1                  TRA     s:21273

      595    18938        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:132  
      596    18939        /*****************************************************************************
      597    18940        *
      598    18941        *       GTA             GIVE TOKENS ACK SPDU
      599    18942        *
      600    18943        *****************************************************************************/
      601    18944    2           CASE( %SI_GTA);

      602    18945                    %SCAN( LVL=1, TAG=SI_GTA, TYP=NONE);

  19004  1 002627   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 002630   000001 736000                    QLS     1
         1 002631   026001 235007                    LDA     11265,DL
         1 002632   200051 755106                    STA     ITEMLIST,QL,AUTO

  19011  1 002633   003744 701000 1                  TSX1    SCAN
         1 002634   003743 702000 1                  TSX2    SCANERR

      603    19014    2               VBLK.EVENT = %XSS_SEV_GTA;

  19014  1 002635   200003 470500                    LDP0    @VBLK,,AUTO
         1 002636   000030 236007                    LDQ     24,DL
         1 002637   000001 552104                    STBQ    1,'04'O,PR0
         1 002640   003656 710000 1                  TRA     s:21273

      604    19015        /*****************************************************************************
      605    19016        *
      606    19017        *       GTC             GIVE TOKENS CONFIRM SPDU
      607    19018        *
      608    19019        *****************************************************************************/
      609    19020    2           CASE( %SI_GTC);

      610    19021    2               XSS$CONTROL_GIVE = XSS_CONTROL_GIVE;

  19021  1 002641   200033 470500                    LDP0    SFPT$,,AUTO
         1 002642   000074 237000 0                  LDAQ    XSS_CONTROL_GIVE
         1 002643   000000 755100                    STA     0,,PR0
         1 002644   000001 756100                    STQ     1,,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:133  

      611    19022                    %SCAN( LVL=1, TAG=SI_GTC, TYP=NONE);

  19081  1 002645   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002646   000001 735000                    ALS     1
         1 002647   025001 236007                    LDQ     10753,DL
         1 002650   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19088  1 002651   003744 701000 1                  TSX1    SCAN
         1 002652   003743 702000 1                  TSX2    SCANERR

      612    19091    2               XSS$CONTROL_GIVE.TOKENS.TR = %TRUE;

  19091  1 002653   200033 470500                    LDP0    SFPT$,,AUTO
         1 002654   000200 236007                    LDQ     128,DL
         1 002655   000000 256100                    ORSQ    0,,PR0

      613    19092    2               XSS$CONTROL_GIVE.TOKENS.MA = %TRUE;

  19092  1 002656   000040 236007                    LDQ     32,DL
         1 002657   000000 256100                    ORSQ    0,,PR0

      614    19093    2               XSS$CONTROL_GIVE.TOKENS.MI = %TRUE;

  19093  1 002660   000010 236007                    LDQ     8,DL
         1 002661   000000 256100                    ORSQ    0,,PR0

      615    19094    2               XSS$CONTROL_GIVE.TOKENS.DK = %TRUE;

  19094  1 002662   000002 236007                    LDQ     2,DL
         1 002663   000000 256100                    ORSQ    0,,PR0

      616    19095    2               VBLK.EVENT = %XSS_SEV_GTC;

  19095  1 002664   200003 471500                    LDP1    @VBLK,,AUTO
         1 002665   000031 236007                    LDQ     25,DL
         1 002666   100001 552104                    STBQ    1,'04'O,PR1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:134  
         1 002667   003656 710000 1                  TRA     s:21273

      617    19096        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:135  
      618    19097        /*****************************************************************************
      619    19098        *
      620    19099        *       MIA             MINOR SYNC ACK SPDU
      621    19100        *
      622    19101        *****************************************************************************/
      623    19102    2           CASE( %SI_MIA);

      624    19103    2               XSS$SYNC_MINOR = XSS_SYNC_MINOR;

  19103  1 002670   200033 470500                    LDP0    SFPT$,,AUTO
         1 002671   000100 100400                    MLR     fill='000'O
         1 002672   000132 000024 0                  ADSC9   XSS_SYNC_MINOR           cn=0,n=20
         1 002673   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      625    19104    2               XSS$SYNC_MINOR.FNC = %XSS_FNC_SSMICNF#;

  19104  1 002674   056000 236003                    LDQ     23552,DU
         1 002675   000000 552140                    STBQ    0,'40'O,PR0

      626    19105                    %SCAN( LVL=1, TAG=SI_MIA, TYP=NONE);

  19164  1 002676   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002677   000001 735000                    ALS     1
         1 002700   062001 236007                    LDQ     25601,DL
         1 002701   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19171  1 002702   003744 701000 1                  TSX1    SCAN
         1 002703   003743 702000 1                  TSX2    SCANERR

      627    19174                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      628    19175                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");

  19220  1 002704   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002705   000001 735000                    ALS     1
         1 002706   200033 236100                    LDQ     SFPT$,,AUTO
         1 002707   000004 036003                    ADLQ    4,DU
         1 002710   200052 756105                    STQ     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:136  

  19234  1 002711   000025 236000 2                  LDQ     21
         1 002712   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19241  1 002713   003744 701000 1                  TSX1    SCAN
         1 002714   003743 702000 1                  TSX2    SCANERR

      629    19244                    %SCAN( LVL=2, TAG=PGI_UD, TYP=CPTR, OPT=Y, LEN=262143, VAL=NIL);

  19294  1 002715   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002716   000001 735000                    ALS     1
         1 002717   000036 236000 2                  LDQ     30
         1 002720   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  19303  1 002721   777777 236007                    LDQ     -1,DL
         1 002722   000000 620005                    EAX0    0,AL
         1 002723   000001 402003                    MPY     1,DU
         1 002724   456022 036007                    ADLQ    -107502,DL
         1 002725   200051 756110                    STQ     ITEMLIST,X0,AUTO

  19310  1 002726   003744 701000 1                  TSX1    SCAN
         1 002727   003743 702000 1                  TSX2    SCANERR

      630    19313    3               IF SCANITEM.X.LEN > 0 THEN DO;

  19313  1 002730   200047 220100                    LDX0    SCANITEM,,AUTO
         1 002731   002740 600000 1                  TZE     s:19317

      631    19314    3                   XSS$SYNC_MINOR.DATA.PTR$ = SCANITEM.P;

  19314  1 002732   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 002733   200033 470500                    LDP0    SFPT$,,AUTO
         1 002734   000002 756100                    STQ     2,,PR0

      632    19315    3                   XSS$SYNC_MINOR.DATA.SIZE = SCANITEM.X.LEN;

  19315  1 002735   200047 235100                    LDA     SCANITEM,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:137  
         1 002736   000022 771000                    ARL     18
         1 002737   000003 755100                    STA     3,,PR0

      633    19316    3                   END;

      634    19317    2               VBLK.EVENT = %XSS_SEV_MIA;

  19317  1 002740   200003 470500                    LDP0    @VBLK,,AUTO
         1 002741   000034 236007                    LDQ     28,DL
         1 002742   000001 552104                    STBQ    1,'04'O,PR0
         1 002743   003656 710000 1                  TRA     s:21273

      635    19318        /*****************************************************************************
      636    19319        *
      637    19320        *       MIP             MINOR SYNC POINT SPDU
      638    19321        *
      639    19322        *****************************************************************************/
      640    19323    2           CASE( %SI_MIP);

      641    19324    2               XSS$SYNC_MINOR = XSS_SYNC_MINOR;

  19324  1 002744   200033 470500                    LDP0    SFPT$,,AUTO
         1 002745   000100 100400                    MLR     fill='000'O
         1 002746   000132 000024 0                  ADSC9   XSS_SYNC_MINOR           cn=0,n=20
         1 002747   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      642    19325    2               XSS$SYNC_MINOR.FNC = %XSS_FNC_SSMIIND#;

  19325  1 002750   054000 236003                    LDQ     22528,DU
         1 002751   000000 552140                    STBQ    0,'40'O,PR0

      643    19326                    %SCAN( LVL=1, TAG=SI_MIP, TYP=NONE);

  19385  1 002752   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002753   000001 735000                    ALS     1
         1 002754   061001 236007                    LDQ     25089,DL
         1 002755   200051 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:138  

  19392  1 002756   003744 701000 1                  TSX1    SCAN
         1 002757   003743 702000 1                  TSX2    SCANERR

      644    19395                    %SCAN( LVL=2, TAG=PGI_STI, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);

  19440  1 002760   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002761   000001 735000                    ALS     1
         1 002762   200046 630500                    EPPR0   TEMP,,AUTO
         1 002763   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  19454  1 002764   000040 236000 2                  LDQ     32
         1 002765   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19461  1 002766   003744 701000 1                  TSX1    SCAN
         1 002767   003743 702000 1                  TSX2    SCANERR

      645    19464    2               XSS$SYNC_MINOR.TYPE = TEMP;

  19464  1 002770   200033 470500                    LDP0    SFPT$,,AUTO
         1 002771   200046 236100                    LDQ     TEMP,,AUTO
         1 002772   000011 736000                    QLS     9
         1 002773   000000 552110                    STBQ    0,'10'O,PR0

      646    19465                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      647    19466                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");

  19511  1 002774   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 002775   000001 735000                    ALS     1
         1 002776   200033 236100                    LDQ     SFPT$,,AUTO
         1 002777   000004 036003                    ADLQ    4,DU
         1 003000   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  19525  1 003001   000025 236000 2                  LDQ     21
         1 003002   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19532  1 003003   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:139  
         1 003004   003743 702000 1                  TSX2    SCANERR

      648    19535    2               DATALVL = 2;

  19535  1 003005   000002 235007                    LDA     2,DL
         1 003006   200013 755100                    STA     DATALVL,,AUTO

      649    19536    2               VBLK.EVENT = %XSS_SEV_MIP;

  19536  1 003007   200003 470500                    LDP0    @VBLK,,AUTO
         1 003010   000035 236007                    LDQ     29,DL
         1 003011   000001 552104                    STBQ    1,'04'O,PR0
         1 003012   003656 710000 1                  TRA     s:21273

      650    19537        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:140  
      651    19538        /*****************************************************************************
      652    19539        *
      653    19540        *       NF              NOT FINISHED SPDU
      654    19541        *
      655    19542        *****************************************************************************/
      656    19543    2           CASE( %SI_NF);

      657    19544    2               XSS$RELEASE = XSS_RELEASE;

  19544  1 003013   200033 470500                    LDP0    SFPT$,,AUTO
         1 003014   000100 100400                    MLR     fill='000'O
         1 003015   000112 000020 0                  ADSC9   XSS_RELEASE              cn=0,n=16
         1 003016   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      658    19545    2               XSS$RELEASE.FNC = %XSS_FNC_SRELCNF#;

  19545  1 003017   042000 236003                    LDQ     17408,DU
         1 003020   000000 552140                    STBQ    0,'40'O,PR0

      659    19546                    %SCAN( LVL=1, TAG=SI_NF, TYP=NONE);

  19605  1 003021   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003022   000001 735000                    ALS     1
         1 003023   010001 236007                    LDQ     4097,DL
         1 003024   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19612  1 003025   003744 701000 1                  TSX1    SCAN
         1 003026   003743 702000 1                  TSX2    SCANERR

      660    19615    2               DATALVL = 2;

  19615  1 003027   000002 235007                    LDA     2,DL
         1 003030   200013 755100                    STA     DATALVL,,AUTO

      661    19616    2               VBLK.EVENT = %XSS_SEV_NF;

  19616  1 003031   200003 470500                    LDP0    @VBLK,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:141  
         1 003032   000036 236007                    LDQ     30,DL
         1 003033   000001 552104                    STBQ    1,'04'O,PR0
         1 003034   003656 710000 1                  TRA     s:21273

      662    19617        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:142  
      663    19618        /*****************************************************************************
      664    19619        *
      665    19620        *       PR_MAA          PREPARE (MAJOR SYNC ACK) SPDU
      666    19621        *       PR_RA           PREPARE (RESYNCHRONIZE ACK) SPDU
      667    19622        *       PR_RS           PREPARE (RESYNCHRONIZE) SPDU
      668    19623        *
      669    19624        *****************************************************************************/
      670    19625    2           CASE( %SI_PR);

      671    19626                    %SCAN( LVL=1, TAG=SI_PR, TYP=NONE);

  19685  1 003035   000000 236000 xsym               LDQ     XSS_ITEMCNT
         1 003036   000001 736000                    QLS     1
         1 003037   007001 235007                    LDA     3585,DL
         1 003040   200051 755106                    STA     ITEMLIST,QL,AUTO

  19692  1 003041   003744 701000 1                  TSX1    SCAN
         1 003042   003743 702000 1                  TSX2    SCANERR

      672    19695                    %SCAN( LVL=2, TAG=PGI_PT, TYP=UBIN, LEN=1, VAL=TEMP);

  19740  1 003043   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003044   000001 735000                    ALS     1
         1 003045   200046 630500                    EPPR0   TEMP,,AUTO
         1 003046   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  19754  1 003047   000041 236000 2                  LDQ     33
         1 003050   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19761  1 003051   003744 701000 1                  TSX1    SCAN
         1 003052   003743 702000 1                  TSX2    SCANERR

      673    19764    3               DO CASE( TEMP);

  19764  1 003053   200046 235100                    LDA     TEMP,,AUTO
         1 003054   000004 115007                    CMPA    4,DL
         1 003055   003057 602005 1                  TNC     s:19764+4,AL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:143  
         1 003056   003077 710000 1                  TRA     s:19772
         1 003057   003077 710000 1                  TRA     s:19772
         1 003060   003063 710000 1                  TRA     s:19766
         1 003061   003067 710000 1                  TRA     s:19768
         1 003062   003073 710000 1                  TRA     s:19770

      674    19765    3                   CASE( %XSS_PT_MAA#);

      675    19766    3                       VBLK.EVENT = %XSS_SEV_PR_MAA;

  19766  1 003063   200003 470500                    LDP0    @VBLK,,AUTO
         1 003064   000037 236007                    LDQ     31,DL
         1 003065   000001 552104                    STBQ    1,'04'O,PR0
         1 003066   003656 710000 1                  TRA     s:21273

      676    19767    3                   CASE( %XSS_PT_RS#);

      677    19768    3                       VBLK.EVENT = %XSS_SEV_PR_RS;

  19768  1 003067   200003 470500                    LDP0    @VBLK,,AUTO
         1 003070   000041 236007                    LDQ     33,DL
         1 003071   000001 552104                    STBQ    1,'04'O,PR0
         1 003072   003656 710000 1                  TRA     s:21273

      678    19769    3                   CASE( %XSS_PT_RA#);

      679    19770    3                       VBLK.EVENT = %XSS_SEV_PR_RA;

  19770  1 003073   200003 470500                    LDP0    @VBLK,,AUTO
         1 003074   000040 236007                    LDQ     32,DL
         1 003075   000001 552104                    STBQ    1,'04'O,PR0
         1 003076   003656 710000 1                  TRA     s:21273

      680    19771    3                   CASE( ELSE);

      681    19772    3                       GOTO SCANERR;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:144  
  19772  1 003077   003743 710000 1                  TRA     SCANERR

      682    19773    3                   END;

      683    19774        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:145  
      684    19775        /*****************************************************************************
      685    19776        *
      686    19777        *       PT              PLEASE TOKENS SPDU
      687    19778        *
      688    19779        *****************************************************************************/
      689    19780    2           CASE( %SI_PT);

      690    19781    2               IF ITEMLIST.X.LEN( ITEMCUR) = 0 THEN

  19781  1 003100   200027 236100                    LDQ     ITEMCUR,,AUTO
         1 003101   000001 736000                    QLS     1
         1 003102   200051 220106                    LDX0    ITEMLIST,QL,AUTO
         1 003103   003736 600000 1                  TZE     ENDSPDU

      691    19782    2                   GOTO ENDSPDU;
      692    19783    2               XSS$TOKEN_PLEASE = XSS_TOKEN_PLEASE;

  19783  1 003104   200033 470500                    LDP0    SFPT$,,AUTO
         1 003105   000100 100400                    MLR     fill='000'O
         1 003106   000142 000020 0                  ADSC9   XSS_TOKEN_PLEASE         cn=0,n=16
         1 003107   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      693    19784    2               XSS$TOKEN_PLEASE.FNC = %XSS_FNC_STKPIND#;

  19784  1 003110   062000 236003                    LDQ     25600,DU
         1 003111   000000 552140                    STBQ    0,'40'O,PR0

      694    19785                    %SCAN( LVL=1, TAG=SI_PT, TYP=NONE);

  19844  1 003112   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003113   000001 735000                    ALS     1
         1 003114   002001 236007                    LDQ     1025,DL
         1 003115   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19851  1 003116   003744 701000 1                  TSX1    SCAN
         1 003117   003743 702000 1                  TSX2    SCANERR

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:146  
      695    19854                    %SCAN( LVL=2, TAG=PGI_TI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  19907  1 003120   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003121   000001 735000                    ALS     1
         1 003122   200004 630500                    EPPR0   BTMP,,AUTO
         1 003123   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  19913  1 003124   000017 236000 2                  LDQ     15
         1 003125   200051 756105                    STQ     ITEMLIST,AL,AUTO

  19920  1 003126   003744 701000 1                  TSX1    SCAN
         1 003127   003743 702000 1                  TSX2    SCANERR

      696    19923    2               IF BTMP = '000000000'B THEN

  19923  1 003130   200004 235100                    LDA     BTMP,,AUTO
         1 003131   003736 600000 1                  TZE     ENDSPDU

      697    19924    2                   GOTO ENDSPDU;  /* no tokens; cut short */
      698    19925    2               XSS$TOKEN_PLEASE.TOKENS = BTMP;

  19925  1 003132   200033 470500                    LDP0    SFPT$,,AUTO
         1 003133   200004 236100                    LDQ     BTMP,,AUTO
         1 003134   000033 772000                    QRL     27
         1 003135   000000 552104                    STBQ    0,'04'O,PR0

      699    19926    2               DATALVL = 2;

  19926  1 003136   000002 235007                    LDA     2,DL
         1 003137   200013 755100                    STA     DATALVL,,AUTO

      700    19927    2               VBLK.EVENT = %XSS_SEV_PT;

  19927  1 003140   200003 471500                    LDP1    @VBLK,,AUTO
         1 003141   000042 236007                    LDQ     34,DL
         1 003142   100001 552104                    STBQ    1,'04'O,PR1
         1 003143   003656 710000 1                  TRA     s:21273
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:147  

      701    19928        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:148  
      702    19929        /*****************************************************************************
      703    19930        *
      704    19931        *       RA              RESYNCHRONIZE ACK SPDU
      705    19932        *
      706    19933        *****************************************************************************/
      707    19934    2           CASE( %SI_RA);

      708    19935    2               XSS$RESYNCHRONIZE = XSS_RESYNCHRONIZE;

  19935  1 003144   200033 470500                    LDP0    SFPT$,,AUTO
         1 003145   000100 100400                    MLR     fill='000'O
         1 003146   000116 000024 0                  ADSC9   XSS_RESYNCHRONIZE        cn=0,n=20
         1 003147   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      709    19936    2               XSS$RESYNCHRONIZE.FNC = %XSS_FNC_SRSXCNF#;

  19936  1 003150   046000 236003                    LDQ     19456,DU
         1 003151   000000 552140                    STBQ    0,'40'O,PR0

      710    19937                    %SCAN( LVL=1, TAG=SI_RA, TYP=NONE);

  19996  1 003152   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003153   000001 735000                    ALS     1
         1 003154   042001 236007                    LDQ     17409,DL
         1 003155   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20003  1 003156   003744 701000 1                  TSX1    SCAN
         1 003157   003743 702000 1                  TSX2    SCANERR

      711    20006                    %SCAN( LVL=2, TAG=PGI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  20059  1 003160   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003161   000001 735000                    ALS     1
         1 003162   200004 630500                    EPPR0   BTMP,,AUTO
         1 003163   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  20065  1 003164   000042 236000 2                  LDQ     34
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:149  
         1 003165   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20072  1 003166   003744 701000 1                  TSX1    SCAN
         1 003167   003743 702000 1                  TSX2    SCANERR

      712    20075    2               XSS$RESYNCHRONIZE.TOKENS = BTMP;

  20075  1 003170   200033 470500                    LDP0    SFPT$,,AUTO
         1 003171   200004 236100                    LDQ     BTMP,,AUTO
         1 003172   000033 772000                    QRL     27
         1 003173   000000 552104                    STBQ    0,'04'O,PR0

      713    20076                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      714    20077                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");

  20122  1 003174   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003175   000001 735000                    ALS     1
         1 003176   200033 236100                    LDQ     SFPT$,,AUTO
         1 003177   000004 036003                    ADLQ    4,DU
         1 003200   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  20136  1 003201   000025 236000 2                  LDQ     21
         1 003202   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20143  1 003203   003744 701000 1                  TSX1    SCAN
         1 003204   003743 702000 1                  TSX2    SCANERR

      715    20146    2               DATALVL = 2;

  20146  1 003205   000002 235007                    LDA     2,DL
         1 003206   200013 755100                    STA     DATALVL,,AUTO

      716    20147    2               VBLK.EVENT = %XSS_SEV_RA;

  20147  1 003207   200003 470500                    LDP0    @VBLK,,AUTO
         1 003210   000043 236007                    LDQ     35,DL
         1 003211   000001 552104                    STBQ    1,'04'O,PR0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:150  
         1 003212   003656 710000 1                  TRA     s:21273

      717    20148        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:151  
      718    20149        /*****************************************************************************
      719    20150        *
      720    20151        *       RF_NR           REFUSE (NO REUSE) SPDU
      721    20152        *       RF_R            REFUSE (REUSE) SPDU
      722    20153        *
      723    20154        *****************************************************************************/
      724    20155    2           CASE( %SI_RF);

      725    20156    2               XSS$CONNECT = XSS_CONNECT;

  20156  1 003213   200033 470500                    LDP0    SFPT$,,AUTO
         1 003214   000100 100400                    MLR     fill='000'O
         1 003215   000060 000054 0                  ADSC9   XSS_CONNECT              cn=0,n=44
         1 003216   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44

      726    20157    2               XSS$CONNECT.FNC = %XSS_FNC_SCONCNF#;

  20157  1 003217   030000 236003                    LDQ     12288,DU
         1 003220   000000 552140                    STBQ    0,'40'O,PR0

      727    20158    2               XSS$CONNECT.RESULT = %XSS_RSLT_FAILURE#;

  20158  1 003221   000001 236003                    LDQ     1,DU
         1 003222   000010 552120                    STBQ    8,'20'O,PR0

      728    20159    2               CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);

  20159  1 003223   200003 471500                    LDP1    @VBLK,,AUTO
         1 003224   100000 473500                    LDP3    0,,PR1
         1 003225   200033 236100                    LDQ     SFPT$,,AUTO
         1 003226   000006 036003                    ADLQ    6,DU
         1 003227   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 003230   300003 634500                    EPPR4   3,,PR3
         1 003231   200154 454500                    STP4    ITEMLIST+67,,AUTO
         1 003232   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 003233   000001 631400 2                  EPPR1   1
         1 003234   000000 701000 xent               TSX1    XSS$BUFPTR
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:152  
         1 003235   000000 011000                    NOP     0

      729    20160    2               CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);

  20160  1 003236   200003 470500                    LDP0    @VBLK,,AUTO
         1 003237   000000 471500                    LDP1    0,,PR0
         1 003240   200033 236100                    LDQ     SFPT$,,AUTO
         1 003241   000007 036003                    ADLQ    7,DU
         1 003242   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 003243   200156 451500                    STP1    ITEMLIST+69,,AUTO
         1 003244   200156 236100                    LDQ     ITEMLIST+69,,AUTO
         1 003245   000006 036000 2                  ADLQ    6
         1 003246   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 003247   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 003250   000001 631400 2                  EPPR1   1
         1 003251   000000 701000 xent               TSX1    XSS$BUFPTR
         1 003252   000000 011000                    NOP     0

      730    20161    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);

  20161  1 003253   200003 470500                    LDP0    @VBLK,,AUTO
         1 003254   000000 471500                    LDP1    0,,PR0
         1 003255   200033 236100                    LDQ     SFPT$,,AUTO
         1 003256   000005 036003                    ADLQ    5,DU
         1 003257   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 003260   100004 633500                    EPPR3   4,,PR1
         1 003261   200154 453500                    STP3    ITEMLIST+67,,AUTO
         1 003262   200154 630500                    EPPR0   ITEMLIST+67,,AUTO
         1 003263   000001 631400 2                  EPPR1   1
         1 003264   000000 701000 xent               TSX1    XSS$BUFPTR
         1 003265   000000 011000                    NOP     0

      731    20162                    %SCAN( LVL=1, TAG=SI_RF, TYP=NONE);

  20221  1 003266   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003267   000001 735000                    ALS     1
         1 003270   014001 236007                    LDQ     6145,DL
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:153  
         1 003271   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20228  1 003272   003744 701000 1                  TSX1    SCAN
         1 003273   003743 702000 1                  TSX2    SCANERR

      732    20231                    %SCAN( LVL=2, TAG=PGI_CI, TYP=NONE, OPT=Y);

  20290  1 003274   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003275   000001 735000                    ALS     1
         1 003276   401002 236007                    LDQ     -130558,DL
         1 003277   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20297  1 003300   003744 701000 1                  TSX1    SCAN
         1 003301   003743 702000 1                  TSX2    SCANERR

      733    20300    3               IF ITEMLIST.X.LVL( ITEMCUR) > 2 THEN DO;

  20300  1 003302   200027 235100                    LDA     ITEMCUR,,AUTO
         1 003303   000001 735000                    ALS     1
         1 003304   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 003305   000007 376007                    ANQ     7,DL
         1 003306   000003 116007                    CMPQ    3,DL
         1 003307   003343 602000 1                  TNC     s:20512

      734    20301                        %SCAN( LVL=3, TAG=PI_ASSUR, TYP=TXTC, OPT=Y,
      735    20302                                LEN=224, VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");

  20352  1 003310   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003311   000001 735000                    ALS     1
         1 003312   200033 470500                    LDP0    SFPT$,,AUTO
         1 003313   000007 471500                    LDP1    7,,PR0
         1 003314   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  20361  1 003315   000007 236000 2                  LDQ     7
         1 003316   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20368  1 003317   003744 701000 1                  TSX1    SCAN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:154  
         1 003320   003743 702000 1                  TSX2    SCANERR

      736    20371                        %SCAN( LVL=3, TAG=PI_CR, TYP=TXTC, OPT=Y,
      737    20372                                LEN=64, VAL="XSS$CONNECT.COMMON$->TXTC");

  20422  1 003321   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003322   000001 735000                    ALS     1
         1 003323   200033 470500                    LDP0    SFPT$,,AUTO
         1 003324   000005 471500                    LDP1    5,,PR0
         1 003325   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  20431  1 003326   000010 236000 2                  LDQ     8
         1 003327   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20438  1 003330   003744 701000 1                  TSX1    SCAN
         1 003331   003743 702000 1                  TSX2    SCANERR

      738    20441                        %SCAN( LVL=3, TAG=PI_ARI, TYP=UBIN, OPT=Y,
      739    20442                                LEN=4, VAL="XSS$CONNECT.ARI");

  20487  1 003332   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003333   000001 735000                    ALS     1
         1 003334   200033 236100                    LDQ     SFPT$,,AUTO
         1 003335   000012 036003                    ADLQ    10,DU
         1 003336   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  20501  1 003337   000011 236000 2                  LDQ     9
         1 003340   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20508  1 003341   003744 701000 1                  TSX1    SCAN
         1 003342   003743 702000 1                  TSX2    SCANERR

      740    20511    3                   END;

      741    20512    3               IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_TD THEN DO;

  20512  1 003343   200030 236100                    LDQ     ITEMNUM,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:155  
         1 003344   000001 136007                    SBLQ    1,DL
         1 003345   200027 116100                    CMPQ    ITEMCUR,,AUTO
         1 003346   003373 604400 1                  TMOZ    s:20585
         1 003347   200027 235100                    LDA     ITEMCUR,,AUTO
         1 003350   000001 735000                    ALS     1
         1 003351   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 003352   377000 376007                    ANQ     130560,DL
         1 003353   021000 116007                    CMPQ    8704,DL
         1 003354   003373 601000 1                  TNZ     s:20585

      742    20513                        %SCAN( LVL=2, TAG=PGI_TD, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  20566  1 003355   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003356   000001 735000                    ALS     1
         1 003357   200004 630500                    EPPR0   BTMP,,AUTO
         1 003360   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  20572  1 003361   000037 236000 2                  LDQ     31
         1 003362   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20579  1 003363   003744 701000 1                  TSX1    SCAN
         1 003364   003743 702000 1                  TSX2    SCANERR

      743    20582    3                   SCTX.TD = BTMP;

  20582  1 003365   200003 470500                    LDP0    @VBLK,,AUTO
         1 003366   000000 471500                    LDP1    0,,PR0
         1 003367   200004 236100                    LDQ     BTMP,,AUTO
         1 003370   000022 772000                    QRL     18
         1 003371   100015 552110                    STBQ    13,'10'O,PR1

      744    20583    3                   END;

  20583  1 003372   003402 710000 1                  TRA     s:20641

      745    20584    3               ELSE DO;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:156  
      746    20585    3                   SCTX.TD = '0'B;

  20585  1 003373   200003 470500                    LDP0    @VBLK,,AUTO
         1 003374   000000 471500                    LDP1    0,,PR0
         1 003375   000000 236003                    LDQ     0,DU
         1 003376   100015 552110                    STBQ    13,'10'O,PR1

      747    20586    3                   SCTX.TD.TCREL = %TRUE;

  20586  1 003377   000000 471500                    LDP1    0,,PR0
         1 003400   002000 236007                    LDQ     1024,DL
         1 003401   100015 256100                    ORSQ    13,,PR1

      748    20587    3                   END;

      749    20588                    %SCAN( LVL=2, TAG=PGI_SUR, TYP=BITS, OPT=Y, LEN=16, VAL=BTMP);

  20641  1 003402   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003403   000001 735000                    ALS     1
         1 003404   200004 631500                    EPPR1   BTMP,,AUTO
         1 003405   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  20647  1 003406   000020 236000 2                  LDQ     16
         1 003407   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20654  1 003410   003744 701000 1                  TSX1    SCAN
         1 003411   003743 702000 1                  TSX2    SCANERR

      750    20657    2               XSS$CONNECT.SFU = BTMP;

  20657  1 003412   200004 220100                    LDX0    BTMP,,AUTO
         1 003413   200033 470500                    LDP0    SFPT$,,AUTO
         1 003414   000010 440100                    SXL0    8,,PR0

      751    20658                    %SCAN( LVL=2, TAG=PGI_VN, TYP=UBIN, OPT=Y, LEN=1, VAL=TEMP);

  20703  1 003415   000000 235000 xsym               LDA     XSS_ITEMCNT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:157  
         1 003416   000001 735000                    ALS     1
         1 003417   200046 631500                    EPPR1   TEMP,,AUTO
         1 003420   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  20717  1 003421   000043 236000 2                  LDQ     35
         1 003422   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20724  1 003423   003744 701000 1                  TSX1    SCAN
         1 003424   003743 702000 1                  TSX2    SCANERR

      752    20727    2               SCTX.VN = TEMP;

  20727  1 003425   200003 470500                    LDP0    @VBLK,,AUTO
         1 003426   000000 471500                    LDP1    0,,PR0
         1 003427   200046 236100                    LDQ     TEMP,,AUTO
         1 003430   000026 736000                    QLS     22
         1 003431   100013 676100                    ERQ     11,,PR1
         1 003432   000360 376003                    ANQ     240,DU
         1 003433   100013 656100                    ERSQ    11,,PR1

      753    20728                    %SCAN( LVL=2, TAG=PGI_RC, TYP=CPTR, OPT=Y, LEN=513, VAL=NIL);

  20778  1 003434   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003435   000001 735000                    ALS     1
         1 003436   000036 236000 2                  LDQ     30
         1 003437   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  20787  1 003440   000044 236000 2                  LDQ     36
         1 003441   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20794  1 003442   003744 701000 1                  TSX1    SCAN
         1 003443   003743 702000 1                  TSX2    SCANERR

      754    20797    3               IF SCANITEM.X.LEN > 0 THEN DO;

  20797  1 003444   200047 220100                    LDX0    SCANITEM,,AUTO
         1 003445   003464 600000 1                  TZE     s:20803
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:158  

      755    20798    3                   XSS$CONNECT.REASON = SCANITEM.P->B$UBIN9;

  20798  1 003446   200050 470500                    LDP0    SCANITEM+1,,AUTO
         1 003447   200033 471500                    LDP1    SFPT$,,AUTO
         1 003450   000100 100500                    MLR     fill='000'O
         1 003451   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 003452   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

      756    20799    3                   IF SCANITEM.X.LEN > 1 THEN

  20799  1 003453   000002 100003                    CMPX0   2,DU
         1 003454   003460 602000 1                  TNC     s:20801

      757    20800    3                       XSS$CONNECT.DATA.PTR$ = PINCRC( SCANITEM.P, 1);

  20800  1 003455   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 003456   200000 036007                    ADLQ    65536,DL
         1 003457   100002 756100                    STQ     2,,PR1

      758    20801    3                   XSS$CONNECT.DATA.SIZE = SCANITEM.X.LEN - 1;

  20801  1 003460   200047 235100                    LDA     SCANITEM,,AUTO
         1 003461   000022 771000                    ARL     18
         1 003462   000001 135007                    SBLA    1,DL
         1 003463   100003 755100                    STA     3,,PR1

      759    20802    3                   END;

      760    20803    2               IF SCTX.TD.TCREL THEN

  20803  1 003464   200003 470500                    LDP0    @VBLK,,AUTO
         1 003465   000000 471500                    LDP1    0,,PR0
         1 003466   100015 236100                    LDQ     13,,PR1
         1 003467   002000 316007                    CANQ    1024,DL
         1 003470   003474 600000 1                  TZE     s:20806

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:159  
      761    20804    2                   VBLK.EVENT = %XSS_SEV_RF_NR;

  20804  1 003471   000044 236007                    LDQ     36,DL
         1 003472   000001 552104                    STBQ    1,'04'O,PR0
         1 003473   003656 710000 1                  TRA     s:21273

      762    20805    2               ELSE
      763    20806    2                   VBLK.EVENT = %XSS_SEV_RF_R;

  20806  1 003474   000045 236007                    LDQ     37,DL
         1 003475   000001 552104                    STBQ    1,'04'O,PR0
         1 003476   003656 710000 1                  TRA     s:21273

      764    20807        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:160  
      765    20808        /*****************************************************************************
      766    20809        *
      767    20810        *       RS_A            RESYNCHRONIZE (ABANDON) SPDU
      768    20811        *       RS_R            RESYNCHRONIZE (RESTART) SPDU
      769    20812        *       RS_S            RESYNCHRONIZE (SET) SPDU
      770    20813        *
      771    20814        *****************************************************************************/
      772    20815    2           CASE( %SI_RS);

      773    20816    2               XSS$RESYNCHRONIZE = XSS_RESYNCHRONIZE;

  20816  1 003477   200033 470500                    LDP0    SFPT$,,AUTO
         1 003500   000100 100400                    MLR     fill='000'O
         1 003501   000116 000024 0                  ADSC9   XSS_RESYNCHRONIZE        cn=0,n=20
         1 003502   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      774    20817    2               XSS$RESYNCHRONIZE.FNC = %XSS_FNC_SRSXIND#;

  20817  1 003503   044000 236003                    LDQ     18432,DU
         1 003504   000000 552140                    STBQ    0,'40'O,PR0

      775    20818                    %SCAN( LVL=1, TAG=SI_RS, TYP=NONE);

  20877  1 003505   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003506   000001 735000                    ALS     1
         1 003507   065001 236007                    LDQ     27137,DL
         1 003510   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20884  1 003511   003744 701000 1                  TSX1    SCAN
         1 003512   003743 702000 1                  TSX2    SCANERR

      776    20887                    %SCAN( LVL=2, TAG=PGI_TSI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  20940  1 003513   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003514   000001 735000                    ALS     1
         1 003515   200004 630500                    EPPR0   BTMP,,AUTO
         1 003516   200052 450505                    STP0    ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:161  

  20946  1 003517   000042 236000 2                  LDQ     34
         1 003520   200051 756105                    STQ     ITEMLIST,AL,AUTO

  20953  1 003521   003744 701000 1                  TSX1    SCAN
         1 003522   003743 702000 1                  TSX2    SCANERR

      777    20956    2               XSS$RESYNCHRONIZE.TOKENS = BTMP;

  20956  1 003523   200033 470500                    LDP0    SFPT$,,AUTO
         1 003524   200004 236100                    LDQ     BTMP,,AUTO
         1 003525   000033 772000                    QRL     27
         1 003526   000000 552104                    STBQ    0,'04'O,PR0

      778    20957                    %SCAN( LVL=2, TAG=PGI_RT, TYP=UBIN, LEN=1, VAL=TEMP);

  21002  1 003527   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003530   000001 735000                    ALS     1
         1 003531   200046 631500                    EPPR1   TEMP,,AUTO
         1 003532   200052 451505                    STP1    ITEMLIST+1,AL,AUTO

  21016  1 003533   000045 236000 2                  LDQ     37
         1 003534   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21023  1 003535   003744 701000 1                  TSX1    SCAN
         1 003536   003743 702000 1                  TSX2    SCANERR

      779    21026    3               DO CASE( TEMP);

  21026  1 003537   200046 235100                    LDA     TEMP,,AUTO
         1 003540   000003 115007                    CMPA    3,DL
         1 003541   003543 602005 1                  TNC     s:21026+4,AL
         1 003542   003562 710000 1                  TRA     s:21034
         1 003543   003546 710000 1                  TRA     s:21028
         1 003544   003552 710000 1                  TRA     s:21030
         1 003545   003556 710000 1                  TRA     s:21032

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:162  
      780    21027    3                   CASE( %XSS_RT_RESTART#);

      781    21028    3                       VBLK.EVENT = %XSS_SEV_RS_R;

  21028  1 003546   200003 470500                    LDP0    @VBLK,,AUTO
         1 003547   000047 236007                    LDQ     39,DL
         1 003550   000001 552104                    STBQ    1,'04'O,PR0
         1 003551   003563 710000 1                  TRA     s:21082

      782    21029    3                   CASE( %XSS_RT_ABANDON#);

      783    21030    3                       VBLK.EVENT = %XSS_SEV_RS_A;

  21030  1 003552   200003 470500                    LDP0    @VBLK,,AUTO
         1 003553   000046 236007                    LDQ     38,DL
         1 003554   000001 552104                    STBQ    1,'04'O,PR0
         1 003555   003563 710000 1                  TRA     s:21082

      784    21031    3                   CASE( %XSS_RT_SET#);

      785    21032    3                       VBLK.EVENT = %XSS_SEV_RS_S;

  21032  1 003556   200003 470500                    LDP0    @VBLK,,AUTO
         1 003557   000050 236007                    LDQ     40,DL
         1 003560   000001 552104                    STBQ    1,'04'O,PR0
         1 003561   003563 710000 1                  TRA     s:21082

      786    21033    3                   CASE( ELSE);

      787    21034    3                       GOTO SCANERR;

  21034  1 003562   003743 710000 1                  TRA     SCANERR

      788    21035    3                   END;

      789    21036                    %SCAN( LVL=2, TAG=PGI_SN, TYP=UBC6,
      790    21037                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:163  

  21082  1 003563   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003564   000001 735000                    ALS     1
         1 003565   200033 236100                    LDQ     SFPT$,,AUTO
         1 003566   000004 036003                    ADLQ    4,DU
         1 003567   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  21096  1 003570   000025 236000 2                  LDQ     21
         1 003571   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21103  1 003572   003744 701000 1                  TSX1    SCAN
         1 003573   003743 702000 1                  TSX2    SCANERR

      791    21106    2               DATALVL = 2;

  21106  1 003574   000002 235007                    LDA     2,DL
         1 003575   200013 755100                    STA     DATALVL,,AUTO
         1 003576   003656 710000 1                  TRA     s:21273

      792    21107        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:164  
      793    21108        /*****************************************************************************
      794    21109        *
      795    21110        *       TD              TYPED DATA SPDU
      796    21111        *
      797    21112        *****************************************************************************/
      798    21113    2           CASE( %SI_TD);

      799    21114    2               XSS$TYPED_DATA = XSS_TYPED_DATA;

  21114  1 003577   200033 470500                    LDP0    SFPT$,,AUTO
         1 003600   000100 100400                    MLR     fill='000'O
         1 003601   000146 000020 0                  ADSC9   XSS_TYPED_DATA           cn=0,n=16
         1 003602   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      800    21115    2               XSS$TYPED_DATA.FNC = %XSS_FNC_STYDIND#;

  21115  1 003603   064000 236003                    LDQ     26624,DU
         1 003604   000000 552140                    STBQ    0,'40'O,PR0

      801    21116                    %SCAN( LVL=1, TAG=SI_TD, TYP=NONE);

  21175  1 003605   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003606   000001 735000                    ALS     1
         1 003607   041001 236007                    LDQ     16897,DL
         1 003610   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21182  1 003611   003744 701000 1                  TSX1    SCAN
         1 003612   003743 702000 1                  TSX2    SCANERR

      802    21185    3               IF ITEMCUR < ITEMNUM-1 AND ITEMLIST.X.TAG( ITEMCUR) = %PGI_EI THEN DO;

  21185  1 003613   200030 236100                    LDQ     ITEMNUM,,AUTO
         1 003614   000001 136007                    SBLQ    1,DL
         1 003615   200027 116100                    CMPQ    ITEMCUR,,AUTO
         1 003616   003642 604400 1                  TMOZ    s:21258
         1 003617   200027 235100                    LDA     ITEMCUR,,AUTO
         1 003620   000001 735000                    ALS     1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:165  
         1 003621   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 003622   377000 376007                    ANQ     130560,DL
         1 003623   031000 116007                    CMPQ    12800,DL
         1 003624   003642 601000 1                  TNZ     s:21258

      803    21186                        %SCAN( LVL=2, TAG=PGI_EI, TYP=BITS, OPT=Y, LEN=8, VAL=BTMP);

  21239  1 003625   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003626   000001 735000                    ALS     1
         1 003627   200004 630500                    EPPR0   BTMP,,AUTO
         1 003630   200052 450505                    STP0    ITEMLIST+1,AL,AUTO

  21245  1 003631   000034 236000 2                  LDQ     28
         1 003632   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21252  1 003633   003744 701000 1                  TSX1    SCAN
         1 003634   003743 702000 1                  TSX2    SCANERR

      804    21255    3                   VBLK.EI = BTMP;

  21255  1 003635   200003 470500                    LDP0    @VBLK,,AUTO
         1 003636   200004 236100                    LDQ     BTMP,,AUTO
         1 003637   000022 772000                    QRL     18
         1 003640   000001 552110                    STBQ    1,'10'O,PR0

      805    21256    3                   END;

  21256  1 003641   003647 710000 1                  TRA     s:21261

      806    21257    3               ELSE DO;

      807    21258    3                   VBLK.EI.BOSSDU = %TRUE;

  21258  1 003642   200003 470500                    LDP0    @VBLK,,AUTO
         1 003643   004000 236007                    LDQ     2048,DL
         1 003644   000001 256100                    ORSQ    1,,PR0

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:166  
      808    21259    3                   VBLK.EI.EOSSDU = %TRUE;

  21259  1 003645   002000 236007                    LDQ     1024,DL
         1 003646   000001 256100                    ORSQ    1,,PR0

      809    21260    3                   END;

      810    21261    2               DATALVL = 2;

  21261  1 003647   000002 235007                    LDA     2,DL
         1 003650   200013 755100                    STA     DATALVL,,AUTO

      811    21262    2               DATATAG = 0;

  21262  1 003651   200014 450100                    STZ     DATATAG,,AUTO

      812    21263    2               VBLK.EVENT = %XSS_SEV_TD;

  21263  1 003652   000051 236007                    LDQ     41,DL
         1 003653   000001 552104                    STBQ    1,'04'O,PR0
         1 003654   003656 710000 1                  TRA     s:21273

      813    21264        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:167  
      814    21265        /*****************************************************************************
      815    21266        *
      816    21267        *       Illegal SI value
      817    21268        *
      818    21269        *****************************************************************************/
      819    21270    2           CASE( ELSE);

      820    21271    2               GOTO SCANERR;

  21271  1 003655   003743 710000 1                  TRA     SCANERR

      821    21272    2           END;

      822    21273    2       IF DATALVL > 0 AND ITEMCUR < ITEMNUM THEN DO;

  21273  1 003656   200013 235100                    LDA     DATALVL,,AUTO
         1 003657   003724 604400 1                  TMOZ    s:21421
         1 003660   200027 236100                    LDQ     ITEMCUR,,AUTO
         1 003661   200030 116100                    CMPQ    ITEMNUM,,AUTO
         1 003662   003724 605000 1                  TPL     s:21421

      823    21274    2           IF DATATAG = 0 THEN

  21274  1 003663   200014 235100                    LDA     DATATAG,,AUTO
         1 003664   003701 601000 1                  TNZ     s:21397

      824    21275                    %SCAN( LVL=DATALVL, TAG=0, TYP=DATA, OPT=Y,
      825    21276                            LEN=DATALEN, VAL=NIL);

  21326  1 003665   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003666   000001 735000                    ALS     1
         1 003667   000036 236000 2                  LDQ     30
         1 003670   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  21335  1 003671   200012 236100                    LDQ     DATALEN,,AUTO
         1 003672   000022 736000                    QLS     18
         1 003673   200013 036100                    ADLQ    DATALVL,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:168  
         1 003674   400050 036007                    ADLQ    -131032,DL
         1 003675   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21342  1 003676   003744 701000 1                  TSX1    SCAN
         1 003677   003743 702000 1                  TSX2    SCANERR

  21343  1 003700   003714 710000 1                  TRA     s:21416

      826    21345    2           ELSE
      827    21346                    %SCAN( LVL=DATALVL, TAG=PGI_DATA, TYP=DATA, OPT=Y,
      828    21347                            LEN=DATALEN, VAL=NIL);

  21397  1 003701   000000 235000 xsym               LDA     XSS_ITEMCNT
         1 003702   000001 735000                    ALS     1
         1 003703   000036 236000 2                  LDQ     30
         1 003704   200052 756105                    STQ     ITEMLIST+1,AL,AUTO

  21406  1 003705   200012 236100                    LDQ     DATALEN,,AUTO
         1 003706   000022 736000                    QLS     18
         1 003707   200013 036100                    ADLQ    DATALVL,,AUTO
         1 003710   701050 036007                    ADLQ    -32216,DL
         1 003711   200051 756105                    STQ     ITEMLIST,AL,AUTO

  21413  1 003712   003744 701000 1                  TSX1    SCAN
         1 003713   003743 702000 1                  TSX2    SCANERR

      829    21416    3           IF SCANITEM.X.LEN > 0 THEN DO;

  21416  1 003714   200047 220100                    LDX0    SCANITEM,,AUTO
         1 003715   003724 600000 1                  TZE     s:21421

      830    21417    3               XSS$GENERIC.DATA.PTR$ = SCANITEM.P;

  21417  1 003716   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 003717   200033 470500                    LDP0    SFPT$,,AUTO
         1 003720   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:169  
      831    21418    3               XSS$GENERIC.DATA.SIZE = SCANITEM.X.LEN;

  21418  1 003721   200047 235100                    LDA     SCANITEM,,AUTO
         1 003722   000022 771000                    ARL     18
         1 003723   000003 755100                    STA     3,,PR0

      832    21419    3               END;

      833    21420    2           END;

      834    21421    1       XSS$GENERIC.SCID = SCTX.SCID;

  21421  1 003724   200003 470500                    LDP0    @VBLK,,AUTO
         1 003725   000000 471500                    LDP1    0,,PR0
         1 003726   200033 473500                    LDP3    SFPT$,,AUTO
         1 003727   100015 236100                    LDQ     13,,PR1
         1 003730   300000 552120                    STBQ    0,'20'O,PR3

      835    21422    1       CALL XSS$MACHINE( VBLK)

  21422  1 003731   200003 630500                    EPPR0   @VBLK,,AUTO
         1 003732   000046 631400 2                  EPPR1   38
         1 003733   000000 701000 xent               TSX1    XSS$MACHINE
         1 003734   003736 702000 1                  TSX2    ENDSPDU
         1 003735   003736 710000 1                  TRA     ENDSPDU

      836    21423    2       WHENALTRETURN DO;

      837    21424                /* The connection has gone away, but we'll keep going. */
      838    21425    2           END;

      839    21426    1   ENDSPDU:
      840    21427            /* End of processing for this SPDU.  See if any others. */
      841    21428    1       SPDUCUR = SPDUCUR + 1;

  21428  1 003736   200034 054100       ENDSPDU      AOS     SPDUCUR,,AUTO

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:170  
      842    21429    1       IF SPDUCUR < SPDUNUM THEN

  21429  1 003737   200034 236100                    LDQ     SPDUCUR,,AUTO
         1 003740   200035 116100                    CMPQ    SPDUNUM,,AUTO
         1 003741   000326 604000 1                  TMI     NEXTSPDU

      843    21430    1           GOTO NEXTSPDU;
      844    21431    1       RETURN;

  21431  1 003742   000000 702200 xent               TSX2  ! X66_ARET

      845    21432    1   SCANERR:
      846    21433            /* An error occurred while decoding an SPDU */
      847    21434    1       ALTRETURN;

  21434  1 003743   000000 702200 xent  SCANERR      TSX2  ! X66_AALT

      848    21435        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:171  
      849    21436        /*I*    NAME:   SCAN
      850    21437
      851    21438                SCAN is called for each item of the SPDU expected to be seen.  The
      852    21439                contents of SCANITEM are compared with the current item.  If they
      853    21440                match, the associated value is moved from the current item to the
      854    21441                VAL field indicated in SCANITEM.  Otherwise, heuristics are used to
      855    21442                figure out if the SPDU is in error or we need to skip over optional
      856    21443                items not supplied in the SPDU.
      857    21444        */
      858    21445    1   SCAN: PROC ALTRET;

  21445  1 003744   200152 741300       SCAN         STX1  ! ITEMLIST+65,,AUTO

      859    21446
      860    21447    2       IF ITEMCUR > ITEMNUM THEN

  21447  1 003745   200027 236100                    LDQ     ITEMCUR,,AUTO
         1 003746   200030 116100                    CMPQ    ITEMNUM,,AUTO
         1 003747   003751 604400 1                  TMOZ    s:21450

      861    21448                /* fell off the end of the SPDU */
      862    21449    2           ALTRETURN;

  21449  1 003750   000000 702211                    TSX2  ! 0,X1

      863    21450    3       IF ITEMCUR = ITEMNUM THEN DO;

  21450  1 003751   003755 601000 1                  TNZ     s:21455

      864    21451                /* should only happen when trailing optional item missing */
      865    21452    3           SCANITEM.X.LEN = 0;

  21452  1 003752   000000 220003                    LDX0    0,DU
         1 003753   200047 740100                    STX0    SCANITEM,,AUTO

      866    21453    3           RETURN;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:172  
  21453  1 003754   000001 702211                    TSX2  ! 1,X1

      867    21454    3           END;
      868    21455    2       TEMP = 0;

  21455  1 003755   200046 450100                    STZ     TEMP,,AUTO

      869    21456    2       BTMP = '000000000000'O;

  21456  1 003756   000163 236000 0                  LDQ     XSS_U_EXCEPTION_REPORT+5
         1 003757   200004 756100                    STQ     BTMP,,AUTO

      870    21457            /* compare LVLs */
      871    21458    2       IF ITEMLIST.X.LVL( ITEMCUR) < SCANITEM.X.LVL THEN

  21458  1 003760   200047 236100                    LDQ     SCANITEM,,AUTO
         1 003761   000007 376007                    ANQ     7,DL
         1 003762   200154 756100                    STQ     ITEMLIST+67,,AUTO
         1 003763   200027 235100                    LDA     ITEMCUR,,AUTO
         1 003764   000001 735000                    ALS     1
         1 003765   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 003766   000007 376007                    ANQ     7,DL
         1 003767   200154 116100                    CMPQ    ITEMLIST+67,,AUTO
         1 003770   003772 605000 1                  TPL     s:21460

      872    21459    2           RETURN;  /* skip ahead to resynchronize levels */

  21459  1 003771   000001 702211                    TSX2  ! 1,X1

      873    21460    3       IF ITEMLIST.X.LVL( ITEMCUR) = SCANITEM.X.LVL THEN DO;

  21460  1 003772   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 003773   200047 676100                    ERQ     SCANITEM,,AUTO
         1 003774   000007 376007                    ANQ     7,DL
         1 003775   004261 601000 1                  TNZ     s:21536

      874    21461                /* compare TAGs */
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:173  
      875    21462    3           IF SCANITEM.X.TAG = 0 OR

  21462  1 003776   200047 236100                    LDQ     SCANITEM,,AUTO
         1 003777   377000 316007                    CANQ    130560,DL
         1 004000   004005 600000 1                  TZE     s:21466
         1 004001   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 004002   200047 676100                    ERQ     SCANITEM,,AUTO
         1 004003   377000 376007                    ANQ     130560,DL
         1 004004   004251 601000 1                  TNZ     s:21527

      876    21463    4                   ITEMLIST.X.TAG( ITEMCUR) = SCANITEM.X.TAG THEN DO;

      877    21464                    /* O.K. We have a match!  Now we move the value part of the
      878    21465                       matched tag-length-value item to the given buffer. */
      879    21466    4               SRCLEN = ITEMLIST.X.LEN( ITEMCUR);

  21466  1 004005   200051 236105                    LDQ     ITEMLIST,AL,AUTO
         1 004006   000022 772000                    QRL     18
         1 004007   200044 756100                    STQ     SRCLEN,,AUTO

      880    21467    5               IF SRCLEN = 0 OR SCANITEM.X.TYP = %NONE THEN DO;

  21467  1 004010   004014 600000 1                  TZE     s:21468
         1 004011   200047 236100                    LDQ     SCANITEM,,AUTO
         1 004012   000370 316007                    CANQ    248,DL
         1 004013   004017 601000 1                  TNZ     s:21471

      881    21468    5                   SCANITEM.X.LEN = 0;

  21468  1 004014   000000 220003                    LDX0    0,DU
         1 004015   200047 740100                    STX0    SCANITEM,,AUTO

      882    21469    5                   GOTO RET;  /* no value.. we're done */

  21469  1 004016   004262 710000 1                  TRA     RET

      883    21470    5                   END;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:174  
      884    21471    4               IF SCANITEM.X.TYP = %BITS THEN

  21471  1 004017   200047 236100                    LDQ     SCANITEM,,AUTO
         1 004020   000370 376007                    ANQ     248,DL
         1 004021   000060 116007                    CMPQ    48,DL
         1 004022   004026 601000 1                  TNZ     s:21473

      885    21472    4                   SRCLEN = SRCLEN * 8;

  21472  1 004023   200044 235100                    LDA     SRCLEN,,AUTO
         1 004024   000003 735000                    ALS     3
         1 004025   200044 755100                    STA     SRCLEN,,AUTO

      886    21473    4               DSTLEN = SCANITEM.X.LEN;

  21473  1 004026   200047 235100                    LDA     SCANITEM,,AUTO
         1 004027   000022 771000                    ARL     18
         1 004030   200020 755100                    STA     DSTLEN,,AUTO

      887    21474    4               IF SRCLEN > DSTLEN THEN

  21474  1 004031   200044 236100                    LDQ     SRCLEN,,AUTO
         1 004032   200020 116100                    CMPQ    DSTLEN,,AUTO
         1 004033   004035 604400 1                  TMOZ    s:21476

      888    21475    4                   ALTRETURN;  /* source is too long for buffer */

  21475  1 004034   000000 702211                    TSX2  ! 0,X1

      889    21476    5               DO CASE( SCANITEM.X.TYP);

  21476  1 004035   200047 236100                    LDQ     SCANITEM,,AUTO
         1 004036   000003 772000                    QRL     3
         1 004037   000037 376007                    ANQ     31,DL
         1 004040   000010 116007                    CMPQ    8,DL
         1 004041   004043 602006 1                  TNC     s:21476+6,QL
         1 004042   004247 710000 1                  TRA     s:21523
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:175  
         1 004043   004247 710000 1                  TRA     s:21523
         1 004044   004211 710000 1                  TRA     s:21514
         1 004045   004110 710000 1                  TRA     s:21490
         1 004046   004174 710000 1                  TRA     s:21511
         1 004047   004110 710000 1                  TRA     s:21490
         1 004050   004110 710000 1                  TRA     s:21490
         1 004051   004053 710000 1                  TRA     s:21479
         1 004052   004141 710000 1                  TRA     s:21499

      890    21477    5                   CASE( %BITS);

      891    21478                            /* NOTE! SRCLEN AND DSTLEN CONTAIN LENGTHS IN *BITS* */
      892    21479    5                       SRCLEN = ( SRCLEN + 8) / 9;  /* now byte-length */

  21479  1 004053   200044 236100                    LDQ     SRCLEN,,AUTO
         1 004054   000010 036007                    ADLQ    8,DL
         1 004055   000011 506007                    DIV     9,DL
         1 004056   200044 756100                    STQ     SRCLEN,,AUTO

      893    21480    5                       BSRC$ = ITEMLIST.P( ITEMCUR);

  21480  1 004057   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004060   000001 735000                    ALS     1
         1 004061   200052 236105                    LDQ     ITEMLIST+1,AL,AUTO
         1 004062   200043 756100                    STQ     BSRC$,,AUTO

      894    21481    5                       BDST$ = SCANITEM.P;

  21481  1 004063   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 004064   200017 756100                    STQ     BDST$,,AUTO

      895    21482    6                       DO I = 1 TO SRCLEN;

  21482  1 004065   000001 235007                    LDA     1,DL
         1 004066   200021 755100                    STA     I,,AUTO
         1 004067   004104 710000 1                  TRA     s:21486+1

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:176  
      896    21483    6                           BDST$->B$BIT8 = PINCRB( BSRC$, 1)->B$BIT8;

  21483  1 004070   200043 470500                    LDP0    BSRC$,,AUTO
         1 004071   200017 471500                    LDP1    BDST$,,AUTO
         1 004072   003100 060500                    CSL     bolr='003'O
         1 004073   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8
         1 004074   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=8

      897    21484    6                           BDST$ = PINCRB( BDST$, 8);

  21484  1 004075   000010 220003                    LDX0    8,DU
         1 004076   100000 503510                    ABD     0,X0,PR1
         1 004077   200017 451500                    STP1    BDST$,,AUTO

      898    21485    6                           BSRC$ = PINCRC( BSRC$, 1);

  21485  1 004100   200043 236100                    LDQ     BSRC$,,AUTO
         1 004101   200000 036007                    ADLQ    65536,DL
         1 004102   200043 756100                    STQ     BSRC$,,AUTO

      899    21486    6                           END;

  21486  1 004103   200021 054100                    AOS     I,,AUTO
         1 004104   200021 236100                    LDQ     I,,AUTO
         1 004105   200044 116100                    CMPQ    SRCLEN,,AUTO
         1 004106   004070 604400 1                  TMOZ    s:21483
         1 004107   004250 710000 1                  TRA     s:21525

      900    21487    5                   CASE( %CPTR,

      901    21488    5                         %CVEC,
      902    21489    5                         %DATA);
      903    21490    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);

  21490  1 004110   200044 236100                    LDQ     SRCLEN,,AUTO
         1 004111   200020 116100                    CMPQ    DSTLEN,,AUTO
         1 004112   004114 604400 1                  TMOZ    s:21490+4
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:177  
         1 004113   200020 236100                    LDQ     DSTLEN,,AUTO
         1 004114   200020 756100                    STQ     DSTLEN,,AUTO

      904    21491    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;

  21491  1 004115   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 004116   000036 116000 2                  CMPQ    30
         1 004117   004127 601000 1                  TNZ     s:21497

      905    21492                                /* don't copy data; just point at it in the SPDU */
      906    21493    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);

  21493  1 004120   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004121   000001 735000                    ALS     1
         1 004122   200052 236105                    LDQ     ITEMLIST+1,AL,AUTO
         1 004123   200050 756100                    STQ     SCANITEM+1,,AUTO

      907    21494    6                           SCANITEM.X.LEN = DSTLEN;

  21494  1 004124   200020 720100                    LXL0    DSTLEN,,AUTO
         1 004125   200047 740100                    STX0    SCANITEM,,AUTO

      908    21495    6                           END;

  21495  1 004126   004250 710000 1                  TRA     s:21525

      909    21496    5                       ELSE
      910    21497    5                           SCANITEM.P->DSTBYTES = ITEMLIST.P( ITEMCUR)->SRCBYTES;

  21497  1 004127   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004130   000001 735000                    ALS     1
         1 004131   200052 470505                    LDP0    ITEMLIST+1,AL,AUTO
         1 004132   200044 720100                    LXL0    SRCLEN,,AUTO
         1 004133   200050 471500                    LDP1    SCANITEM+1,,AUTO
         1 004134   200020 722100                    LXL2    DSTLEN,,AUTO
         1 004135   040140 100540                    MLR     fill='040'O
         1 004136   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:178  
         1 004137   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         1 004140   004250 710000 1                  TRA     s:21525

      911    21498    5                   CASE( %TXTC);

      912    21499    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);

  21499  1 004141   200044 236100                    LDQ     SRCLEN,,AUTO
         1 004142   200020 116100                    CMPQ    DSTLEN,,AUTO
         1 004143   004145 604400 1                  TMOZ    s:21499+4
         1 004144   200020 236100                    LDQ     DSTLEN,,AUTO
         1 004145   200020 756100                    STQ     DSTLEN,,AUTO

      913    21500    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;

  21500  1 004146   200050 236100                    LDQ     SCANITEM+1,,AUTO
         1 004147   000036 116000 2                  CMPQ    30
         1 004150   004160 601000 1                  TNZ     s:21506

      914    21501                                /* don't copy data; just point at it in the SPDU */
      915    21502    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);

  21502  1 004151   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004152   000001 735000                    ALS     1
         1 004153   200052 236105                    LDQ     ITEMLIST+1,AL,AUTO
         1 004154   200050 756100                    STQ     SCANITEM+1,,AUTO

      916    21503    6                           SCANITEM.X.LEN = DSTLEN;

  21503  1 004155   200020 720100                    LXL0    DSTLEN,,AUTO
         1 004156   200047 740100                    STX0    SCANITEM,,AUTO

      917    21504    6                           END;

  21504  1 004157   004250 710000 1                  TRA     s:21525

      918    21505    6                       ELSE DO;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:179  

      919    21506    6                           SCANITEM.P->TXTC.LEN = DSTLEN;

  21506  1 004160   200050 470500                    LDP0    SCANITEM+1,,AUTO
         1 004161   000100 101500                    MRL     fill='000'O
         1 004162   200020 000004                    ADSC9   DSTLEN,,AUTO             cn=0,n=4
         1 004163   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      920    21507    6                           ADDR( SCANITEM.P->TXTC.TXT)->DSTBYTES =

  21507  1 004164   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004165   000001 735000                    ALS     1
         1 004166   200052 471505                    LDP1    ITEMLIST+1,AL,AUTO
         1 004167   200020 720100                    LXL0    DSTLEN,,AUTO
         1 004170   040140 100540                    MLR     fill='040'O
         1 004171   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 004172   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      921    21508    6                                   ITEMLIST.P( ITEMCUR)->DSTBYTES;
      922    21509    6                           END;

  21509  1 004173   004250 710000 1                  TRA     s:21525

      923    21510    5                   CASE( %UBC6);

      924    21511    5                       SRC$ = ITEMLIST.P( ITEMCUR);

  21511  1 004174   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004175   000001 735000                    ALS     1
         1 004176   200052 236105                    LDQ     ITEMLIST+1,AL,AUTO
         1 004177   200042 756100                    STQ     SRC$,,AUTO

      925    21512    5                       CALL CHARBIN( SCANITEM.P->B$UBIN, SRC$->SRCBYTES);

  21512  1 004200   200042 470500                    LDP0    SRC$,,AUTO
         1 004201   200044 720100                    LXL0    SRCLEN,,AUTO
         1 004202   000100 305540                    DTB
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:180  
         1 004203   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         1 004204   200154 000010                    NDSC9   ITEMLIST+67,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         1 004205   200050 471500                    LDP1    SCANITEM+1,,AUTO
         1 004206   200155 235100                    LDA     ITEMLIST+68,,AUTO
         1 004207   100000 755100                    STA     0,,PR1
         1 004210   004250 710000 1                  TRA     s:21525

      926    21513    5                   CASE( %UBIN);

      927    21514    5                       BSRC$ = ITEMLIST.P( ITEMCUR);

  21514  1 004211   200027 235100                    LDA     ITEMCUR,,AUTO
         1 004212   000001 735000                    ALS     1
         1 004213   200052 236105                    LDQ     ITEMLIST+1,AL,AUTO
         1 004214   200043 756100                    STQ     BSRC$,,AUTO

      928    21515    5                       BDST$ = PINCRB( SCANITEM.P, 4 + 8*(4-SRCLEN));

  21515  1 004215   200050 470500                    LDP0    SCANITEM+1,,AUTO
         1 004216   200044 335100                    LCA     SRCLEN,,AUTO
         1 004217   000003 735000                    ALS     3
         1 004220   004222 605000 1                  TPL     s:21515+5
         1 004221   000044 035003                    ADLA    36,DU
         1 004222   000001 503505                    ABD     1,AL,PR0
         1 004223   200017 450500                    STP0    BDST$,,AUTO

      929    21516    6                       DO I = 1 TO SRCLEN;

  21516  1 004224   000001 235007                    LDA     1,DL
         1 004225   200021 755100                    STA     I,,AUTO
         1 004226   004243 710000 1                  TRA     s:21520+1

      930    21517    6                           BDST$->B$BIT8 = PINCRB( BSRC$, 1)->B$BIT8;

  21517  1 004227   200043 470500                    LDP0    BSRC$,,AUTO
         1 004230   200017 471500                    LDP1    BDST$,,AUTO
         1 004231   003100 060500                    CSL     bolr='003'O
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:181  
         1 004232   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8
         1 004233   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=8

      931    21518    6                           BDST$ = PINCRB( BDST$, 8);

  21518  1 004234   000010 220003                    LDX0    8,DU
         1 004235   100000 503510                    ABD     0,X0,PR1
         1 004236   200017 451500                    STP1    BDST$,,AUTO

      932    21519    6                           BSRC$ = PINCRC( BSRC$, 1);

  21519  1 004237   200043 236100                    LDQ     BSRC$,,AUTO
         1 004240   200000 036007                    ADLQ    65536,DL
         1 004241   200043 756100                    STQ     BSRC$,,AUTO

      933    21520    6                           END;

  21520  1 004242   200021 054100                    AOS     I,,AUTO
         1 004243   200021 236100                    LDQ     I,,AUTO
         1 004244   200044 116100                    CMPQ    SRCLEN,,AUTO
         1 004245   004227 604400 1                  TMOZ    s:21517
         1 004246   004250 710000 1                  TRA     s:21525

      934    21521    5                   CASE( ELSE);

      935    21522                            /* bad SCANITEM.X.TYP */
      936    21523    5                       ALTRETURN;

  21523  1 004247   000000 702211                    TSX2  ! 0,X1

      937    21524    5                   END;

      938    21525    4               GOTO RET;

  21525  1 004250   004262 710000 1                  TRA     RET

      939    21526    4               END;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:182  
      940    21527    4           IF SCANITEM.X.OPT = 1 THEN DO;

  21527  1 004251   200047 236100                    LDQ     SCANITEM,,AUTO
         1 004252   400000 376007                    ANQ     -131072,DL
         1 004253   400000 116007                    CMPQ    -131072,DL
         1 004254   004260 601000 1                  TNZ     s:21533

      941    21528                    /* looks like this optional item is not present */
      942    21529    4               SCANITEM.X.LEN = 0;

  21529  1 004255   000000 220003                    LDX0    0,DU
         1 004256   200047 740100                    STX0    SCANITEM,,AUTO

      943    21530    4               RETURN;

  21530  1 004257   000001 702211                    TSX2  ! 1,X1

      944    21531    4               END;
      945    21532                /* this required item is not present */
      946    21533    3           ALTRETURN;

  21533  1 004260   000000 702211                    TSX2  ! 0,X1

      947    21534    3           END;
      948    21535            /*N* something's wrong.. don't know what to do yet...... */
      949    21536    2       ALTRETURN;

  21536  1 004261   000000 702211                    TSX2  ! 0,X1

      950    21537    2   RET:
      951    21538    2       ITEMCUR = ITEMCUR + 1;

  21538  1 004262   200027 054100       RET          AOS     ITEMCUR,,AUTO

      952    21539    2       RETURN;

  21539  1 004263   200152 221300                    LDX1  ! ITEMLIST+65,,AUTO
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:183  
         1 004264   000001 702211                    TSX2  ! 1,X1

      953    21540
      954    21541    2       END SCAN;
      955    21542        %EJECT;
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:184  
      956    21543    1   GETLEN: PROC ALTRET;

  21543  1 004265   200152 741300       GETLEN       STX1  ! ITEMLIST+65,,AUTO

      957    21544
      958    21545    2       TEMP = %NEXTBYTE;

  21545  1 004266   200031 470500                    LDP0    PDU$,,AUTO
         1 004267   200032 235100                    LDA     PDUIDX,,AUTO
         1 004270   000100 101505                    MRL     fill='000'O
         1 004271   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 004272   200154 000004                    ADSC9   ITEMLIST+67,,AUTO        cn=0,n=4
         1 004273   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 004274   200046 756100                    STQ     TEMP,,AUTO

  21545  1 004275   200032 054100                    AOS     PDUIDX,,AUTO

  21545  1 004276   200015 720100                    LXL0    DEPTH,,AUTO
         1 004277   000001 336007                    LCQ     1,DL
         1 004300   200005 056110                    ASQ     CURRLEN,X0,AUTO

      959    21546    2       IF TEMP < 255 THEN

  21546  1 004301   200046 235100                    LDA     TEMP,,AUTO
         1 004302   000377 115007                    CMPA    255,DL
         1 004303   004305 605000 1                  TPL     s:21548

      960    21547    2           RETURN;

  21547  1 004304   000001 702211                    TSX2  ! 1,X1

      961    21548    2       IF TEMP ~= 255 THEN

  21548  1 004305   004307 600000 1                  TZE     s:21550

      962    21549    2           ALTRETURN;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:185  
  21549  1 004306   000000 702211                    TSX2  ! 0,X1

      963    21550    2       TEMP = %NEXTBYTE;

  21550  1 004307   200032 235100                    LDA     PDUIDX,,AUTO
         1 004310   000100 101505                    MRL     fill='000'O
         1 004311   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 004312   200154 000004                    ADSC9   ITEMLIST+67,,AUTO        cn=0,n=4
         1 004313   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 004314   200046 756100                    STQ     TEMP,,AUTO

  21550  1 004315   200032 054100                    AOS     PDUIDX,,AUTO

  21550  1 004316   000001 336007                    LCQ     1,DL
         1 004317   200005 056110                    ASQ     CURRLEN,X0,AUTO

      964    21551    2       TEMP = ( 256 * TEMP) + %NEXTBYTE;

  21551  1 004320   200032 235100                    LDA     PDUIDX,,AUTO
         1 004321   000100 101505                    MRL     fill='000'O
         1 004322   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 004323   200154 000004                    ADSC9   ITEMLIST+67,,AUTO        cn=0,n=4
         1 004324   200154 236100                    LDQ     ITEMLIST+67,,AUTO
         1 004325   200155 756100                    STQ     ITEMLIST+68,,AUTO
         1 004326   200046 236100                    LDQ     TEMP,,AUTO
         1 004327   000010 736000                    QLS     8
         1 004330   200155 036100                    ADLQ    ITEMLIST+68,,AUTO
         1 004331   200046 756100                    STQ     TEMP,,AUTO

  21551  1 004332   200032 054100                    AOS     PDUIDX,,AUTO

  21551  1 004333   000001 336007                    LCQ     1,DL
         1 004334   200005 056110                    ASQ     CURRLEN,X0,AUTO

      965    21552    2       RETURN;

  21552  1 004335   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:186  

(unnamed)
 Sect OctLoc
   0     000   000000 000000   302323 000200   000000 006014   000000 000000    ................
   0     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     014*  000000 000000   000000 000000                                    ........

XSS_ACTIVITY_DISCARD
 Sect OctLoc
   0     016   000000 000000   302323 000200                                    ........

XSS_ACTIVITY_END
 Sect OctLoc
   0     020   000000 000000   302323 000200   000000 006014   000000 000000    ................
   0     024   000000 000000                                                    ....

XSS_ACTIVITY_INTERRUPT
 Sect OctLoc
   0     026   000000 000000   302323 000200                                    ........

XSS_ACTIVITY_RESUME
 Sect OctLoc
   0     030   015000 000000   302323 000200   000000 006014   000000 000000    ................
   0     034   000000 000000   000000 006014   000000 006014   000000 006014    ................
   0     040   000040 040040   040040 040***   000040 040040   040040 040***    .      ..      .
   0     044   055055 055055                                                    ----

XSS_ACTIVITY_START
 Sect OctLoc
   0     046   017000 000000   302323 000200   000000 006014   000000 000000    ................
   0     052   000040 040040   040040 040***                                    .      .

XSS_CAPABILITY_DATA
 Sect OctLoc
   0     054   000000 000000   302323 000200   000000 006014   000000 000000    ................

XSS_CONNECT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:187  
 Sect OctLoc
   0     060   000000 000000   302323 000200   000000 006014   000000 000000    ................
   0     064   000000 000000   000000 006014   000000 006014   000000 006014    ................
   0     070   776000 000000   000000 000000   055055 055055                    ........----

XSS_CONTROL_GIVE
 Sect OctLoc
   0     074   031000 000000   302323 000200                                    ........

XSS_DATA
 Sect OctLoc
   0     076   033000 000000   302323 000200   000000 006014   000000 000000    ................

XSS_EXPEDITED_DATA
 Sect OctLoc
   0     102   035000 000000   302323 000200   000000 006014   000000 000000    ................

(unnamed)
 Sect OctLoc
   0     106   071000 000000   302323 000200   072000 000000   302323 000200    9.......:.......

XSS_RELEASE
 Sect OctLoc
   0     112   000000 000000   302323 000200   000000 006014   000000 000000    ................

XSS_RESYNCHRONIZE
 Sect OctLoc
   0     116   000000 003000   302323 000200   000000 006014   000000 000000    ................
   0     122   000000 000000                                                    ....

XSS_SYNC_MAJOR
 Sect OctLoc
   0     124   000000 001000   302323 000200   000000 006014   000000 000000    ................
   0     130   000000 000000                                                    ....

XSS_SYNC_MINOR
 Sect OctLoc
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:188  
   0     132   000000 001000   302323 000200   000000 006014   000000 000000    ................
   0     136   000000 000000                                                    ....

XSS_TOKEN_GIVE
 Sect OctLoc
   0     140   057000 000000   302323 000200                                    /.......

XSS_TOKEN_PLEASE
 Sect OctLoc
   0     142   061000 000000   302323 000200   000000 006014   000000 000000    1...............

XSS_TYPED_DATA
 Sect OctLoc
   0     146   063000 000000   302323 000200   000000 006014   000000 000000    3...............

XSS_U_ABORT
 Sect OctLoc
   0     152   065000 000000   302323 000200   000000 006014   000000 000000    5...............

XSS_U_EXCEPTION_REPORT
 Sect OctLoc
   0     156   067000 000000   302323 000200   000000 006014   000000 000000    7...............

(unnamed)
 Sect OctLoc
   0     162   104120 040040   000000 000000                                    DP  ....

(unnamed)
 Sect OctLoc
   2     000   000000 000000   000002 000000   000162 006000   000010 021062    .........r.....2
   2     004   000011 461022   000001 462012   000003 400000   000340 411073    ...............;
   2     010   000100 413073   000004 414013   000001 023013   000004 425013    .@.;............
   2     014   000001 026013   000006 427033   000010 432063   000010 420062    ...........3...2
   2     020   000020 424062   000070 200000   000020 463072   000020 464072    ...2.8.....:...:
   2     024   000001 017012   000006 052032   000340 464073   000340 463073    ......*....;...;
   2     030   000006 051073   000006 052033   000006 051072   000340 412073    ..);..*...):...;
   2     034   000010 431062   000001 062012   000000 006014   000010 421062    ...2..2........2
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:189  
   2     040   000001 417012   000001 030012   000010 432062   000001 426012    ...........2....
   2     044   001001 462022   000001 033012   000001 000000                    ............
      966    21553
      967    21554    2       END GETLEN;
      968    21555
      969    21556    1       END XSS$DECODE;

PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:190  
--  Include file information  --

   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
      No diagnostics issued in procedure XSS$DECODE.
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:191  

 **** Variables and constants ****

  ****  Section 000 RoData XSS$DECODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w STRC(72)    r     1 XSS_ACTIVITY_DISCARD      20-0-0/d STRC(180)   r     1 XSS_ACTIVITY_END
    26-0-0/w STRC(72)    r     1 XSS_ACTIVITY_INTERRUPT
    30-0-0/d STRC(468)   r     1 XSS_ACTIVITY_RESUME       46-0-0/d STRC(216)   r     1 XSS_ACTIVITY_START
    54-0-0/d STRC(144)   r     1 XSS_CAPABILITY_DATA       60-0-0/d STRC(396)   r     1 XSS_CONNECT
    74-0-0/w STRC(72)    r     1 XSS_CONTROL_GIVE          76-0-0/d STRC(144)   r     1 XSS_DATA
   102-0-0/d STRC(144)   r     1 XSS_EXPEDITED_DATA       112-0-0/d STRC(144)   r     1 XSS_RELEASE
   116-0-0/d STRC(180)   r     1 XSS_RESYNCHRONIZE        124-0-0/d STRC(180)   r     1 XSS_SYNC_MAJOR
   132-0-0/d STRC(180)   r     1 XSS_SYNC_MINOR           140-0-0/w STRC(72)    r     1 XSS_TOKEN_GIVE
   142-0-0/d STRC(144)   r     1 XSS_TOKEN_PLEASE         146-0-0/d STRC(144)   r     1 XSS_TYPED_DATA
   152-0-0/d STRC(144)   r     1 XSS_U_ABORT
   156-0-0/d STRC(144)   r     1 XSS_U_EXCEPTION_REPORT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @VBLK                     17-0-0/b PTR         r     1 BDST$
    43-0-0/b PTR         r     1 BSRC$                      4-0-0/w BIT         r     1 BTMP
     5-0-0/w SBIN        r     1 CURRLEN(0:4)
    12-0-0/w SBIN        r     1 DATALEN                   13-0-0/w SBIN        r     1 DATALVL
    14-0-0/w SBIN        r     1 DATATAG                   15-0-0/w SBIN        r     1 DEPTH
    20-0-0/w SBIN        r     1 DSTLEN                    21-0-0/w SBIN        r     1 I
    22-0-0/w SBIN        r     1 INITLEN(0:4)
    27-0-0/w SBIN        r     1 ITEMCUR
    51-0-0/w STRC(72)    r     1 ITEMLIST(0:31)
    30-0-0/w SBIN        r     1 ITEMNUM                   31-0-0/c PTR         r     1 PDU$
    32-0-0/w SBIN        r     1 PDUIDX                    47-0-0/w STRC(72)    r     1 SCANITEM
    33-0-0/w PTR         r     1 SFPT$                     34-0-0/w SBIN        r     1 SPDUCUR
    36-0-0/c STRC        r     1 SPDULIST(0:3)
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:192  
    35-0-0/w SBIN        r     1 SPDUNUM                   42-0-0/c PTR         r     1 SRC$
    44-0-0/w SBIN        r     1 SRCLEN                    45-0-0/w SBIN        r     1 TAG
    46-0-0/w SBIN        r     1 TEMP                      *0-0-0/d STRC(288)   r     1 VBLK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 XSS_ITEMCNT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (8)     r     1 B$BIT8                     0-0-0/w UBIN        r     1 B$UBIN
     0-0-0/c UBIN(9)     r     1 B$UBIN9                    0-0-0/c ACHR        r     1 BYTES
     0-0-0/c ACHR        r     1 DSTBYTES                   0-0-0/c CHAR(16384) r     1 PDU
     0-0-0/w STRC(1260)  r     1 SCTX                       0-0-0/c ACHR        r     1 SRCBYTES
     0-0-0/c STRC)       r     1 TXTC                       0-0-0/w STRC(2718)  r     1 UADR
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_DISCARD       0-0-0/d STRC(180)   r     1 XSS$ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_INTERRUPT
     0-0-0/d STRC(468)   r     1 XSS$ACTIVITY_RESUME        0-0-0/d STRC(216)   r     1 XSS$ACTIVITY_START
     0-0-0/d STRC(144)   r     1 XSS$CAPABILITY_DATA        0-0-0/d STRC(396)   r     1 XSS$CONNECT
     0-0-0/w STRC(72)    r     1 XSS$CONTROL_GIVE           0-0-0/d STRC(144)   r     1 XSS$DATA
     0-0-0/d STRC(144)   r     1 XSS$EXPEDITED_DATA         0-0-0/d STRC(504)   r     1 XSS$GENERIC
     0-0-0/d STRC(144)   r     1 XSS$RELEASE                0-0-0/d STRC(180)   r     1 XSS$RESYNCHRONIZE
     0-0-0/d STRC(180)   r     1 XSS$SYNC_MAJOR             0-0-0/d STRC(180)   r     1 XSS$SYNC_MINOR
     0-0-0/w STRC(72)    r     1 XSS$TOKEN_GIVE             0-0-0/d STRC(144)   r     1 XSS$TOKEN_PLEASE
     0-0-0/d STRC(144)   r     1 XSS$TYPED_DATA             0-0-0/d STRC(144)   r     1 XSS$U_ABORT
     0-0-0/d STRC(144)   r     1 XSS$U_EXCEPTION_REPORT


   Procedure XSS$DECODE requires 2270 words for executable code.
   Procedure XSS$DECODE requires 112 words of local(AUTO) storage.
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:193  

    No errors detected in file XSS$DECODE.:XSA1TSI    .
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:194  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:195  
          MINI XREF LISTING

B$BIT8
     13710**DCL     21483<<ASSIGN  21483>>ASSIGN  21517<<ASSIGN  21517>>ASSIGN
B$UBIN
     13711**DCL     21512<<CALLBLT
B$UBIN9
     13712**DCL     20798>>ASSIGN
BDST$
     13721**DCL     21481<<ASSIGN  21483>>ASSIGN  21484<<ASSIGN  21484>>ASSIGN  21515<<ASSIGN  21517>>ASSIGN
     21518<<ASSIGN  21518>>ASSIGN
BSRC$
     13740**DCL     21480<<ASSIGN  21483>>ASSIGN  21485<<ASSIGN  21485>>ASSIGN  21514<<ASSIGN  21517>>ASSIGN
     21519<<ASSIGN  21519>>ASSIGN
BTMP
     13713**DCL     14203--ASSIGN  14219>>ASSIGN  15140--ASSIGN  15156>>ASSIGN  15211--ASSIGN  15227>>ASSIGN
     15287--ASSIGN  15303>>ASSIGN  17842--ASSIGN  17858>>ASSIGN  17919--ASSIGN  17935>>ASSIGN  18296--ASSIGN
     18312>>IF      18314>>ASSIGN  18375--ASSIGN  18391>>ASSIGN  18916--ASSIGN  18932>>ASSIGN  19907--ASSIGN
     19923>>IF      19925>>ASSIGN  20059--ASSIGN  20075>>ASSIGN  20566--ASSIGN  20582>>ASSIGN  20641--ASSIGN
     20657>>ASSIGN  20940--ASSIGN  20956>>ASSIGN  21239--ASSIGN  21255>>ASSIGN  21456<<ASSIGN
BYTES
     13714**DCL     18700<<ASSIGN  18700>>ASSIGN
CURRLEN
     13715**DCL     13805<<ASSIGN  13806<<ASSIGN  13807<<ASSIGN  13818>>IF      13819<<ASSIGN  13819>>ASSIGN
     13835<<ASSIGN  13839<<ASSIGN  13839>>ASSIGN  13848<<ASSIGN  13848>>ASSIGN  13852>>IF      13856>>ASSIGN
     13859<<ASSIGN  21545<<ASSIGN  21545>>ASSIGN  21550<<ASSIGN  21550>>ASSIGN  21551<<ASSIGN  21551>>ASSIGN
DATALEN
     13716**DCL     13985<<ASSIGN  18781<<ASSIGN  21335>>ASSIGN  21406>>ASSIGN
DATALVL
     13717**DCL     13984<<ASSIGN  14291<<ASSIGN  15445<<ASSIGN  15894<<ASSIGN  15971<<ASSIGN  16122<<ASSIGN
     16764<<ASSIGN  16914<<ASSIGN  16994<<ASSIGN  17073<<ASSIGN  18078<<ASSIGN  18158<<ASSIGN  18397<<ASSIGN
     18549<<ASSIGN  18780<<ASSIGN  18933<<ASSIGN  19535<<ASSIGN  19615<<ASSIGN  19926<<ASSIGN  20146<<ASSIGN
     21106<<ASSIGN  21261<<ASSIGN  21273>>IF      21335>>ASSIGN  21406>>ASSIGN
DATATAG
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:196  
     13718**DCL     13986<<ASSIGN  18398<<ASSIGN  18782<<ASSIGN  21262<<ASSIGN  21274>>IF
DEPTH
     13719**DCL     13814<<ASSIGN  13818>>IF      13819>>ASSIGN  13819>>ASSIGN  13820>>IF      13826>>ASSIGN
     13829>>IF      13832<<ASSIGN  13832>>ASSIGN  13833>>IF      13835>>ASSIGN  13836>>ASSIGN  13839>>ASSIGN
     13839>>ASSIGN  13845>>ASSIGN  13846<<ASSIGN  13846>>ASSIGN  13847>>IF      13848>>ASSIGN  13848>>ASSIGN
     13850>>IF      13852>>IF      13856>>ASSIGN  13856>>ASSIGN  13859>>ASSIGN  21545>>ASSIGN  21545>>ASSIGN
     21550>>ASSIGN  21550>>ASSIGN  21551>>ASSIGN  21551>>ASSIGN
DSTBYTES
     13723**DCL     21497<<ASSIGN  21507<<ASSIGN  21507>>ASSIGN
DSTLEN
     13722**DCL     13723--IMP-SIZ 21473<<ASSIGN  21474>>IF      21490<<ASSIGN  21490>>ASSIGN  21494>>ASSIGN
     21497>>ASSIGN  21499<<ASSIGN  21499>>ASSIGN  21503>>ASSIGN  21506>>ASSIGN  21507>>ASSIGN  21507>>ASSIGN
ENDSPDU
     21428**LABEL   18238--GOTO    18313--GOTO    19782--GOTO    19924--GOTO
GETLEN
     21543**PROC    13825--CALL
I
     13724**DCL     21482<<DOINDEX 21516<<DOINDEX
INITLEN
     13725**DCL     13802<<ASSIGN  13803<<ASSIGN  13804<<ASSIGN  13836<<ASSIGN  13848>>ASSIGN  13849<<ASSIGN
ITEMCUR
     13726**DCL     13903<<ASSIGN  13979<<ASSIGN  13987>>ASSIGN  14523>>IF      14804>>IF      15749>>IF
     15749>>IF      17225>>IF      17506>>IF      18237>>IF      18321>>IF      18321>>IF      19781>>IF
     20300>>IF      20512>>IF      20512>>IF      21185>>IF      21185>>IF      21273>>IF      21447>>IF
     21450>>IF      21458>>IF      21460>>IF      21462>>IF      21466>>ASSIGN  21480>>ASSIGN  21493>>ASSIGN
     21497>>ASSIGN  21502>>ASSIGN  21507>>ASSIGN  21511>>ASSIGN  21514>>ASSIGN  21538<<ASSIGN  21538>>ASSIGN
ITEMLIST
     13778**DCL     13808<<ASSIGN
ITEMLIST.P
     13795**DCL     13810<<ASSIGN  13827<<ASSIGN  13857<<ASSIGN  14203<<ASSIGN  14272<<ASSIGN  14346<<ASSIGN
     14575<<ASSIGN  14645<<ASSIGN  14710<<ASSIGN  14850<<ASSIGN  14921<<ASSIGN  14992<<ASSIGN  15063<<ASSIGN
     15140<<ASSIGN  15211<<ASSIGN  15287<<ASSIGN  15355<<ASSIGN  15426<<ASSIGN  15570<<ASSIGN  15799<<ASSIGN
     15870<<ASSIGN  15947<<ASSIGN  16098<<ASSIGN  16325<<ASSIGN  16395<<ASSIGN  16465<<ASSIGN  16530<<ASSIGN
     16605<<ASSIGN  16670<<ASSIGN  16745<<ASSIGN  16895<<ASSIGN  17277<<ASSIGN  17347<<ASSIGN  17412<<ASSIGN
     17552<<ASSIGN  17623<<ASSIGN  17694<<ASSIGN  17765<<ASSIGN  17842<<ASSIGN  17919<<ASSIGN  17988<<ASSIGN
     18059<<ASSIGN  18296<<ASSIGN  18375<<ASSIGN  18524<<ASSIGN  18679<<ASSIGN  18916<<ASSIGN  19220<<ASSIGN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:197  
     19294<<ASSIGN  19440<<ASSIGN  19511<<ASSIGN  19740<<ASSIGN  19907<<ASSIGN  20059<<ASSIGN  20122<<ASSIGN
     20352<<ASSIGN  20422<<ASSIGN  20487<<ASSIGN  20566<<ASSIGN  20641<<ASSIGN  20703<<ASSIGN  20778<<ASSIGN
     20940<<ASSIGN  21002<<ASSIGN  21082<<ASSIGN  21239<<ASSIGN  21326<<ASSIGN  21397<<ASSIGN  21480>>ASSIGN
     21493>>ASSIGN  21497>>ASSIGN  21502>>ASSIGN  21507>>ASSIGN  21511>>ASSIGN  21514>>ASSIGN
ITEMLIST.U
     13793**DCL     13794--REDEF   13795--REDEF   13796--REDEF
ITEMLIST.X.LEN
     13787**DCL     19781>>IF      21466>>ASSIGN
ITEMLIST.X.LVL
     13792**DCL     14523>>IF      14804>>IF      17225>>IF      17506>>IF      20300>>IF      21458>>IF
     21460>>IF
ITEMLIST.X.TAG
     13789**DCL     13987>>ASSIGN  15749>>IF      18321>>IF      20512>>IF      21185>>IF      21462>>IF
ITEMLIST.Z
     13785**DCL     13786--REDEF   13809<<ASSIGN  13826<<ASSIGN  13856<<ASSIGN  13964<<ASSIGN  14058<<ASSIGN
     14136<<ASSIGN  14209<<ASSIGN  14281<<ASSIGN  14360<<ASSIGN  14444<<ASSIGN  14513<<ASSIGN  14584<<ASSIGN
     14654<<ASSIGN  14724<<ASSIGN  14794<<ASSIGN  14864<<ASSIGN  14935<<ASSIGN  15006<<ASSIGN  15077<<ASSIGN
     15146<<ASSIGN  15217<<ASSIGN  15293<<ASSIGN  15364<<ASSIGN  15435<<ASSIGN  15515<<ASSIGN  15584<<ASSIGN
     15661<<ASSIGN  15739<<ASSIGN  15813<<ASSIGN  15884<<ASSIGN  15961<<ASSIGN  16042<<ASSIGN  16112<<ASSIGN
     16195<<ASSIGN  16264<<ASSIGN  16334<<ASSIGN  16404<<ASSIGN  16474<<ASSIGN  16544<<ASSIGN  16614<<ASSIGN
     16684<<ASSIGN  16754<<ASSIGN  16834<<ASSIGN  16904<<ASSIGN  16984<<ASSIGN  17063<<ASSIGN  17146<<ASSIGN
     17215<<ASSIGN  17286<<ASSIGN  17356<<ASSIGN  17426<<ASSIGN  17496<<ASSIGN  17566<<ASSIGN  17637<<ASSIGN
     17708<<ASSIGN  17779<<ASSIGN  17848<<ASSIGN  17925<<ASSIGN  17997<<ASSIGN  18068<<ASSIGN  18148<<ASSIGN
     18227<<ASSIGN  18302<<ASSIGN  18381<<ASSIGN  18469<<ASSIGN  18538<<ASSIGN  18619<<ASSIGN  18688<<ASSIGN
     18770<<ASSIGN  18853<<ASSIGN  18922<<ASSIGN  19004<<ASSIGN  19081<<ASSIGN  19164<<ASSIGN  19234<<ASSIGN
     19303<<ASSIGN  19385<<ASSIGN  19454<<ASSIGN  19525<<ASSIGN  19605<<ASSIGN  19685<<ASSIGN  19754<<ASSIGN
     19844<<ASSIGN  19913<<ASSIGN  19996<<ASSIGN  20065<<ASSIGN  20136<<ASSIGN  20221<<ASSIGN  20290<<ASSIGN
     20361<<ASSIGN  20431<<ASSIGN  20501<<ASSIGN  20572<<ASSIGN  20647<<ASSIGN  20717<<ASSIGN  20787<<ASSIGN
     20877<<ASSIGN  20946<<ASSIGN  21016<<ASSIGN  21096<<ASSIGN  21175<<ASSIGN  21245<<ASSIGN  21335<<ASSIGN
     21406<<ASSIGN
ITEMNUM
     13727**DCL     13813<<ASSIGN  13823>>ASSIGN  13826>>ASSIGN  13827>>ASSIGN  13828<<ASSIGN  13828>>ASSIGN
     13856>>ASSIGN  13857>>ASSIGN  13858<<ASSIGN  13858>>ASSIGN  13862>>ASSIGN  13904<<ASSIGN  13980<<ASSIGN
     15749>>IF      18237>>IF      18321>>IF      20512>>IF      21185>>IF      21273>>IF      21447>>IF
     21450>>IF
NEXTITEM
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:198  
     13818**LABEL   13837--GOTO    13842--GOTO    13865--GOTO
NEXTSPDU
     13977**LABEL   13981--EXIT    21430--GOTO
PDU
     13728**DCL     13819>>ASSIGN  21545>>ASSIGN  21550>>ASSIGN  21551>>ASSIGN
PDU$
     13729**DCL     13728--IMP-PTR 13800<<ASSIGN  13810>>ASSIGN  13819>>ASSIGN  13827>>ASSIGN  13857>>ASSIGN
     21545>>ASSIGN  21550>>ASSIGN  21551>>ASSIGN
PDUIDX
     13730**DCL     13815<<ASSIGN  13819>>ASSIGN  13819<<ASSIGN  13819>>ASSIGN  13827>>ASSIGN  13840<<ASSIGN
     13840>>ASSIGN  13841>>IF      13857>>ASSIGN  21545>>ASSIGN  21545<<ASSIGN  21545>>ASSIGN  21550>>ASSIGN
     21550<<ASSIGN  21550>>ASSIGN  21551>>ASSIGN  21551<<ASSIGN  21551>>ASSIGN
RET IN PROCEDURE SCAN
     21538**LABEL   21469--GOTO    21525--GOTO
SCAN
     21445**PROC    13971--CALL    14065--CALL    14143--CALL    14216--CALL    14288--CALL    14367--CALL
     14451--CALL    14520--CALL    14591--CALL    14661--CALL    14731--CALL    14801--CALL    14871--CALL
     14942--CALL    15013--CALL    15084--CALL    15153--CALL    15224--CALL    15300--CALL    15371--CALL
     15442--CALL    15522--CALL    15591--CALL    15668--CALL    15746--CALL    15820--CALL    15891--CALL
     15968--CALL    16049--CALL    16119--CALL    16202--CALL    16271--CALL    16341--CALL    16411--CALL
     16481--CALL    16551--CALL    16621--CALL    16691--CALL    16761--CALL    16841--CALL    16911--CALL
     16991--CALL    17070--CALL    17153--CALL    17222--CALL    17293--CALL    17363--CALL    17433--CALL
     17503--CALL    17573--CALL    17644--CALL    17715--CALL    17786--CALL    17855--CALL    17932--CALL
     18004--CALL    18075--CALL    18155--CALL    18234--CALL    18309--CALL    18388--CALL    18476--CALL
     18545--CALL    18626--CALL    18695--CALL    18777--CALL    18860--CALL    18929--CALL    19011--CALL
     19088--CALL    19171--CALL    19241--CALL    19310--CALL    19392--CALL    19461--CALL    19532--CALL
     19612--CALL    19692--CALL    19761--CALL    19851--CALL    19920--CALL    20003--CALL    20072--CALL
     20143--CALL    20228--CALL    20297--CALL    20368--CALL    20438--CALL    20508--CALL    20579--CALL
     20654--CALL    20724--CALL    20794--CALL    20884--CALL    20953--CALL    21023--CALL    21103--CALL
     21182--CALL    21252--CALL    21342--CALL    21413--CALL
SCANERR
     21434**LABEL   13825--CALLALT 13834--GOTO    13899--GOTO    13971--CALLALT 14065--CALLALT 14143--CALLALT
     14216--CALLALT 14288--CALLALT 14367--CALLALT 14451--CALLALT 14520--CALLALT 14591--CALLALT 14661--CALLALT
     14731--CALLALT 14801--CALLALT 14871--CALLALT 14942--CALLALT 15013--CALLALT 15084--CALLALT 15153--CALLALT
     15224--CALLALT 15300--CALLALT 15371--CALLALT 15442--CALLALT 15522--CALLALT 15591--CALLALT 15668--CALLALT
     15746--CALLALT 15820--CALLALT 15891--CALLALT 15968--CALLALT 16049--CALLALT 16119--CALLALT 16202--CALLALT
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:199  
     16271--CALLALT 16341--CALLALT 16411--CALLALT 16481--CALLALT 16551--CALLALT 16621--CALLALT 16691--CALLALT
     16761--CALLALT 16841--CALLALT 16911--CALLALT 16991--CALLALT 17070--CALLALT 17153--CALLALT 17222--CALLALT
     17293--CALLALT 17363--CALLALT 17433--CALLALT 17503--CALLALT 17573--CALLALT 17644--CALLALT 17715--CALLALT
     17786--CALLALT 17855--CALLALT 17932--CALLALT 18004--CALLALT 18075--CALLALT 18155--CALLALT 18234--CALLALT
     18309--CALLALT 18388--CALLALT 18476--CALLALT 18545--CALLALT 18626--CALLALT 18695--CALLALT 18777--CALLALT
     18860--CALLALT 18929--CALLALT 19011--CALLALT 19088--CALLALT 19171--CALLALT 19241--CALLALT 19310--CALLALT
     19392--CALLALT 19461--CALLALT 19532--CALLALT 19612--CALLALT 19692--CALLALT 19761--CALLALT 19772--GOTO
     19851--CALLALT 19920--CALLALT 20003--CALLALT 20072--CALLALT 20143--CALLALT 20228--CALLALT 20297--CALLALT
     20368--CALLALT 20438--CALLALT 20508--CALLALT 20579--CALLALT 20654--CALLALT 20724--CALLALT 20794--CALLALT
     20884--CALLALT 20953--CALLALT 21023--CALLALT 21034--GOTO    21103--CALLALT 21182--CALLALT 21252--CALLALT
     21271--GOTO    21342--CALLALT 21413--CALLALT
SCANITEM.P
     13770**DCL     18700>>ASSIGN  19314>>ASSIGN  20798>>ASSIGN  20800>>ASSIGN  21417>>ASSIGN  21481>>ASSIGN
     21491>>IF      21493<<ASSIGN  21497>>ASSIGN  21500>>IF      21502<<ASSIGN  21506>>ASSIGN  21507>>ASSIGN
     21512>>CALLBLT 21515>>ASSIGN
SCANITEM.U
     13768**DCL     13769--REDEF   13770--REDEF   13771--REDEF
SCANITEM.X.LEN
     13762**DCL     13714--IMP-SIZ 18237>>IF      18698<<ASSIGN  18698>>ASSIGN  18700>>ASSIGN  18700>>ASSIGN
     19313>>IF      19315>>ASSIGN  20797>>IF      20799>>IF      20801>>ASSIGN  21416>>IF      21418>>ASSIGN
     21452<<ASSIGN  21468<<ASSIGN  21473>>ASSIGN  21494<<ASSIGN  21503<<ASSIGN  21529<<ASSIGN
SCANITEM.X.LVL
     13767**DCL     21458>>IF      21460>>IF
SCANITEM.X.OPT
     13763**DCL     21527>>IF
SCANITEM.X.TAG
     13764**DCL     21462>>IF      21462>>IF
SCANITEM.X.TYP
     13766**DCL     21467>>IF      21471>>IF      21476>>DOCASE
SCANITEM.Z
     13760**DCL     13761--REDEF
SCTX.COMX
     12366**DCL     14384<>CALL    16135<>CALL    17086<>CALL    20161<>CALL
SCTX.DSTX
     12365**DCL     14383<>CALL    16134<>CALL    17085<>CALL    20160<>CALL
SCTX.FU
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:200  
     12591**DCL     15228<<ASSIGN  17936<<ASSIGN
SCTX.FU.ACT
     12597**DCL     15231<<ASSIGN
SCTX.FU.CD
     12595**DCL     15232<<ASSIGN
SCTX.FU.EXCEP
     12594**DCL     15233<<ASSIGN
SCTX.FU.HD
     12603**DCL     15229<<ASSIGN
SCTX.FU.SY
     12600**DCL     15230<<ASSIGN
SCTX.HISTZ
     12659**DCL     12660--REDEF
SCTX.PO
     12625**DCL     14874<<ASSIGN  17576<<ASSIGN
SCTX.RPV
     12361**DCL     14220<<ASSIGN  14272--ASSIGN  18699<<ASSIGN  18700--ASSIGN
SCTX.SCID
     12646**DCL     13988>>CALL    21421>>ASSIGN
SCTX.SRCX
     12364**DCL     14382<>CALL    16133<>CALL    17084<>CALL    20159<>CALL
SCTX.TD
     12647**DCL     14219<<ASSIGN  18932<<ASSIGN  20582<<ASSIGN  20585<<ASSIGN
SCTX.TD.TCREL
     12652**DCL     14292>>IF      18934>>IF      20586<<ASSIGN  20803>>IF
SCTX.TSDUMS.INI
     12643**DCL     14945<<ASSIGN  17647<<ASSIGN
SCTX.TSDUMS.RSP
     12644**DCL     14946<<ASSIGN  17648<<ASSIGN
SCTX.VN
     12629**DCL     15016<<ASSIGN  17718<<ASSIGN  20727<<ASSIGN
SFPT$
     13731**DCL      4595--IMP-PTR  4741--IMP-PTR  4839--IMP-PTR  4990--IMP-PTR  5088--IMP-PTR  5314--IMP-PTR
      5477--IMP-PTR  5623--IMP-PTR  5946--IMP-PTR  6070--IMP-PTR  6214--IMP-PTR  6358--IMP-PTR  6444--IMP-PTR
      6530--IMP-PTR  6682--IMP-PTR  6895--IMP-PTR  7054--IMP-PTR  7213--IMP-PTR  7343--IMP-PTR  7535--IMP-PTR
      7679--IMP-PTR  7823--IMP-PTR 13799<<ASSIGN  14148>>ASSIGN  14149>>ASSIGN  14299>>ASSIGN  14300>>ASSIGN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:201  
     14370>>ASSIGN  14380>>ASSIGN  14381>>ASSIGN  14382>>CALL    14383>>CALL    14384>>CALL    14575>>ASSIGN
     14645>>ASSIGN  14710>>ASSIGN  15063>>ASSIGN  15156>>ASSIGN  15227>>ASSIGN  15303>>ASSIGN  15355>>ASSIGN
     15374>>ASSIGN  15426>>ASSIGN  15454>>ASSIGN  15455>>ASSIGN  15594>>ASSIGN  15752>>ASSIGN  15753>>ASSIGN
     15823>>ASSIGN  15870>>ASSIGN  15899>>ASSIGN  15900>>ASSIGN  15947>>ASSIGN  15981>>ASSIGN  15982>>ASSIGN
     16098>>ASSIGN  16131>>ASSIGN  16132>>ASSIGN  16133>>CALL    16134>>CALL    16135>>CALL    16325>>ASSIGN
     16395>>ASSIGN  16465>>ASSIGN  16530>>ASSIGN  16605>>ASSIGN  16670>>ASSIGN  16745>>ASSIGN  16773>>ASSIGN
     16774>>ASSIGN  16895>>ASSIGN  16923>>ASSIGN  16924>>ASSIGN  17002>>ASSIGN  17003>>ASSIGN  17082>>ASSIGN
     17083>>ASSIGN  17084>>CALL    17085>>CALL    17086>>CALL    17277>>ASSIGN  17347>>ASSIGN  17412>>ASSIGN
     17765>>ASSIGN  17858>>ASSIGN  17860>>ASSIGN  17861>>ASSIGN  17862>>ASSIGN  17863>>ASSIGN  17864>>ASSIGN
     17865>>ASSIGN  17935>>ASSIGN  17936>>ASSIGN  17988>>ASSIGN  18007>>ASSIGN  18059>>ASSIGN  18087>>ASSIGN
     18088>>ASSIGN  18241>>ASSIGN  18242>>ASSIGN  18314>>ASSIGN  18319>>ASSIGN  18320>>ASSIGN  18408>>ASSIGN
     18409>>ASSIGN  18548>>ASSIGN  18558>>ASSIGN  18559>>ASSIGN  18709>>ASSIGN  18710>>ASSIGN  18792>>ASSIGN
     18793>>ASSIGN  19021>>ASSIGN  19091>>ASSIGN  19092>>ASSIGN  19093>>ASSIGN  19094>>ASSIGN  19103>>ASSIGN
     19104>>ASSIGN  19220>>ASSIGN  19314>>ASSIGN  19315>>ASSIGN  19324>>ASSIGN  19325>>ASSIGN  19464>>ASSIGN
     19511>>ASSIGN  19544>>ASSIGN  19545>>ASSIGN  19783>>ASSIGN  19784>>ASSIGN  19925>>ASSIGN  19935>>ASSIGN
     19936>>ASSIGN  20075>>ASSIGN  20122>>ASSIGN  20156>>ASSIGN  20157>>ASSIGN  20158>>ASSIGN  20159>>CALL
     20160>>CALL    20161>>CALL    20352>>ASSIGN  20422>>ASSIGN  20487>>ASSIGN  20657>>ASSIGN  20798>>ASSIGN
     20800>>ASSIGN  20801>>ASSIGN  20816>>ASSIGN  20817>>ASSIGN  20956>>ASSIGN  21082>>ASSIGN  21114>>ASSIGN
     21115>>ASSIGN  21417>>ASSIGN  21418>>ASSIGN  21421>>ASSIGN
SPDUCUR
     13732**DCL     13975<<ASSIGN  13978>>IF      18239>>IF      21428<<ASSIGN  21428>>ASSIGN  21429>>IF
SPDULIST
     13734**DCL     13811<<ASSIGN
SPDULIST.ITEMFRST
     13736**DCL     13823<<ASSIGN  13979>>ASSIGN
SPDULIST.ITEMLAST
     13737**DCL     13862<<ASSIGN  13980>>ASSIGN
SPDULIST.ORDER
     13738**DCL     13872<<ASSIGN  13875<<ASSIGN  13876<<ASSIGN  13882<<ASSIGN  13883<<ASSIGN  13888<<ASSIGN
     13889<<ASSIGN  13891<<ASSIGN  13894<<ASSIGN  13895<<ASSIGN  13896<<ASSIGN  13897<<ASSIGN  13978>>IF
SPDULIST.TAG
     13735**DCL     13822<<ASSIGN  13851>>ASSIGN  13878>>ASSIGN
SPDUNUM
     13733**DCL     13812<<ASSIGN  13822>>ASSIGN  13823>>ASSIGN  13851>>ASSIGN  13852>>IF      13862>>ASSIGN
     13863<<ASSIGN  13863>>ASSIGN  13869>>DOCASE  14146>>IF      18239>>IF      21429>>IF
SRC$
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:202  
     13739**DCL     21511<<ASSIGN  21512>>CALLBLT
SRCBYTES
     13742**DCL     21497>>ASSIGN  21512>>CALLBLT
SRCLEN
     13741**DCL     13742--IMP-SIZ 21466<<ASSIGN  21467>>IF      21472<<ASSIGN  21472>>ASSIGN  21474>>IF
     21479<<ASSIGN  21479>>ASSIGN  21482>>DOINDEX 21490>>ASSIGN  21497>>ASSIGN  21499>>ASSIGN  21512>>CALLBLT
     21515>>ASSIGN  21516>>DOINDEX
TAG
     13743**DCL     13819<<ASSIGN  13822>>ASSIGN  13826>>ASSIGN  13829>>IF      13829>>IF      13829>>IF
     13851<<ASSIGN  13852>>IF      13852>>IF      13852>>IF      13878<<ASSIGN  13879>>IF      13879>>IF
TEMP
     13744**DCL     13801<<ASSIGN  13803>>ASSIGN  13804>>ASSIGN  13806>>ASSIGN  13807>>ASSIGN  13809>>ASSIGN
     13826>>ASSIGN  13835>>ASSIGN  13836>>ASSIGN  13839>>ASSIGN  13840>>ASSIGN  13845<<ASSIGN  13848>>ASSIGN
     13849>>ASSIGN  13977<<DOINDEX 13978>>IF      13979>>ASSIGN  13980>>ASSIGN  13987<<ASSIGN  13988>>CALL
     13990>>DOCASE  14346--ASSIGN  14370>>ASSIGN  14850--ASSIGN  14874>>ASSIGN  14921--ASSIGN  14945>>ASSIGN
     14946>>ASSIGN  14992--ASSIGN  15016>>ASSIGN  15570--ASSIGN  15594>>ASSIGN  15799--ASSIGN  15823>>ASSIGN
     17552--ASSIGN  17576>>ASSIGN  17623--ASSIGN  17647>>ASSIGN  17648>>ASSIGN  17694--ASSIGN  17718>>ASSIGN
     18524--ASSIGN  18548>>ASSIGN  19440--ASSIGN  19464>>ASSIGN  19740--ASSIGN  19764>>DOCASE  20703--ASSIGN
     20727>>ASSIGN  21002--ASSIGN  21026>>DOCASE  21455<<ASSIGN  21545<<ASSIGN  21546>>IF      21548>>IF
     21550<<ASSIGN  21551<<ASSIGN  21551>>ASSIGN
TXTC
     13745**DCL     14645--ASSIGN  16465--ASSIGN  17347--ASSIGN  20422--ASSIGN
TXTC.LEN
     13746**DCL     21506<<ASSIGN
TXTC.TXT
     13747**DCL     21507--ASSIGN
UADR.NSAP.ADDRESS_N
     13692**DCL     13693--REDEF
UADR.PSAP
     13468**DCL     14575--ASSIGN  16325--ASSIGN  16395--ASSIGN  17277--ASSIGN  20352--ASSIGN
UADR.SSAP
     13531**DCL     15355--ASSIGN  15374<<ASSIGN  15426--ASSIGN  17988--ASSIGN  18007<<ASSIGN  18059--ASSIGN
VBLK
     12239**DCL        13--PROC    21422<>CALL
VBLK.CTX$
     12247**DCL     12345--IMP-PTR 13988>>CALL    14219>>ASSIGN  14220>>ASSIGN  14272>>ASSIGN  14292>>IF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:203  
     14382>>CALL    14383>>CALL    14384>>CALL    14874>>ASSIGN  14945>>ASSIGN  14946>>ASSIGN  15016>>ASSIGN
     15228>>ASSIGN  15229>>ASSIGN  15230>>ASSIGN  15231>>ASSIGN  15232>>ASSIGN  15233>>ASSIGN  16133>>CALL
     16134>>CALL    16135>>CALL    17084>>CALL    17085>>CALL    17086>>CALL    17576>>ASSIGN  17647>>ASSIGN
     17648>>ASSIGN  17718>>ASSIGN  17936>>ASSIGN  18699>>ASSIGN  18700>>ASSIGN  18932>>ASSIGN  18934>>IF
     20159>>CALL    20160>>CALL    20161>>CALL    20582>>ASSIGN  20585>>ASSIGN  20586>>ASSIGN  20727>>ASSIGN
     20803>>IF      21421>>ASSIGN
VBLK.EI
     12250**DCL     18391<<ASSIGN  21255<<ASSIGN
VBLK.EI.BOSSDU
     12252**DCL     18394<<ASSIGN  21258<<ASSIGN
VBLK.EI.EOSSDU
     12253**DCL     18395<<ASSIGN  21259<<ASSIGN
VBLK.EVENT
     12257**DCL     14068<<ASSIGN  14293<<ASSIGN  14295<<ASSIGN  14371<<ASSIGN  15446<<ASSIGN  15595<<ASSIGN
     15671<<ASSIGN  15895<<ASSIGN  15972<<ASSIGN  16123<<ASSIGN  16765<<ASSIGN  16915<<ASSIGN  16995<<ASSIGN
     17074<<ASSIGN  18079<<ASSIGN  18159<<ASSIGN  18315<<ASSIGN  18399<<ASSIGN  18550<<ASSIGN  18701<<ASSIGN
     18783<<ASSIGN  18935<<ASSIGN  18937<<ASSIGN  19014<<ASSIGN  19095<<ASSIGN  19317<<ASSIGN  19536<<ASSIGN
     19616<<ASSIGN  19766<<ASSIGN  19768<<ASSIGN  19770<<ASSIGN  19927<<ASSIGN  20147<<ASSIGN  20804<<ASSIGN
     20806<<ASSIGN  21028<<ASSIGN  21030<<ASSIGN  21032<<ASSIGN  21263<<ASSIGN
VBLK.FPT$
     12258**DCL     13799>>ASSIGN
VBLK.PDU.PTR$
     12290**DCL     13800>>ASSIGN
VBLK.PDU.SIZE
     12291**DCL     13801>>ASSIGN  13841>>IF      13964>>ASSIGN
XSS$ACTIVITY_DISCARD
      4741**DCL     15454<<ASSIGN
XSS$ACTIVITY_DISCARD.ERRDEF
      4785**DCL      4811--REDEF
XSS$ACTIVITY_DISCARD.FNC
      4764**DCL     15455<<ASSIGN
XSS$ACTIVITY_DISCARD.REASON
      4783**DCL     15594<<ASSIGN
XSS$ACTIVITY_END
      4839**DCL     15899<<ASSIGN  15981<<ASSIGN
XSS$ACTIVITY_END.ERRDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:204  
      4875**DCL      4895--REDEF
XSS$ACTIVITY_END.FNC
      4862**DCL     15900<<ASSIGN  15982<<ASSIGN
XSS$ACTIVITY_END.SERNUM
      4971**DCL     15947--ASSIGN  16098--ASSIGN
XSS$ACTIVITY_INTERRUPT
      4990**DCL     14299<<ASSIGN
XSS$ACTIVITY_INTERRUPT.ERRDEF
      5040**DCL      5060--REDEF
XSS$ACTIVITY_INTERRUPT.FNC
      5013**DCL     14300<<ASSIGN
XSS$ACTIVITY_INTERRUPT.REASON
      5032**DCL     14370<<ASSIGN
XSS$ACTIVITY_RESUME
      5088**DCL     16131<<ASSIGN
XSS$ACTIVITY_RESUME.ACTID
      5277**DCL     16745--ASSIGN
XSS$ACTIVITY_RESUME.ARI
      5295**DCL     16530--ASSIGN
XSS$ACTIVITY_RESUME.CALLED$
      5251**DCL     16134<>CALL    16325>>ASSIGN
XSS$ACTIVITY_RESUME.CALLING$
      5242**DCL     16133<>CALL    16395>>ASSIGN
XSS$ACTIVITY_RESUME.COMMON$
      5233**DCL     16135<>CALL    16465>>ASSIGN
XSS$ACTIVITY_RESUME.ERRDEF
      5127**DCL      5147--REDEF
XSS$ACTIVITY_RESUME.FNC
      5109**DCL     16132<<ASSIGN
XSS$ACTIVITY_RESUME.OACTID
      5287**DCL     16605--ASSIGN
XSS$ACTIVITY_RESUME.SERNUM
      5223**DCL     16670--ASSIGN
XSS$ACTIVITY_START
      5314**DCL     16773<<ASSIGN
XSS$ACTIVITY_START.ACTID
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:205  
      5456**DCL     16895--ASSIGN
XSS$ACTIVITY_START.ERRDEF
      5348**DCL      5368--REDEF
XSS$ACTIVITY_START.FNC
      5335**DCL     16774<<ASSIGN
XSS$BUFPTR
     13704**DCL-ENT 14382--CALL    14383--CALL    14384--CALL    16133--CALL    16134--CALL    16135--CALL
     17084--CALL    17085--CALL    17086--CALL    20159--CALL    20160--CALL    20161--CALL
XSS$CAPABILITY_DATA
      5477**DCL     16923<<ASSIGN  17002<<ASSIGN
XSS$CAPABILITY_DATA.ERRDEF
      5513**DCL      5533--REDEF
XSS$CAPABILITY_DATA.FNC
      5500**DCL     16924<<ASSIGN  17003<<ASSIGN
XSS$CONNECT
      5623**DCL     14380<<ASSIGN  17082<<ASSIGN  20156<<ASSIGN
XSS$CONNECT.ARI
      5927**DCL     14710--ASSIGN  17412--ASSIGN  20487--ASSIGN
XSS$CONNECT.CALLED$
      5849**DCL      5850--REDEF   17085<>CALL    18007>>ASSIGN  18059>>ASSIGN
XSS$CONNECT.CALLING$
      5832**DCL     14382<>CALL    15355>>ASSIGN  17084<>CALL    17277>>ASSIGN  17988>>ASSIGN  20159<>CALL
XSS$CONNECT.COMMON$
      5823**DCL     14384<>CALL    14645>>ASSIGN  17086<>CALL    17347>>ASSIGN  20161<>CALL    20422>>ASSIGN
XSS$CONNECT.DATA.PTR$
      5795**DCL     20800<<ASSIGN
XSS$CONNECT.DATA.SIZE
      5801**DCL     20801<<ASSIGN
XSS$CONNECT.ERRDEF
      5717**DCL      5737--REDEF
XSS$CONNECT.FNC
      5646**DCL     14381<<ASSIGN  17083<<ASSIGN  20157<<ASSIGN
XSS$CONNECT.ITOKENS
      5866**DCL     15156<<ASSIGN  17858<<ASSIGN
XSS$CONNECT.REASON
      5665**DCL     20798<<ASSIGN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:206  
XSS$CONNECT.RESPONDING$
      5850**DCL     14383<>CALL    14575>>ASSIGN  15374>>ASSIGN  15426>>ASSIGN  20160<>CALL    20352>>ASSIGN
XSS$CONNECT.RESULT
      5879**DCL     20158<<ASSIGN
XSS$CONNECT.SERNUM
      5813**DCL     15063--ASSIGN  17765--ASSIGN
XSS$CONNECT.SFU
      5902**DCL     15303<<ASSIGN  17860<<ASSIGN  17935<<ASSIGN  17936>>ASSIGN  20657<<ASSIGN
XSS$CONNECT.SFU.ACT
      5908**DCL     17863<<ASSIGN
XSS$CONNECT.SFU.CD
      5906**DCL     17864<<ASSIGN
XSS$CONNECT.SFU.EXCEP
      5905**DCL     17865<<ASSIGN
XSS$CONNECT.SFU.HD
      5914**DCL     17861<<ASSIGN
XSS$CONNECT.SFU.SY
      5911**DCL     17862<<ASSIGN
XSS$CONNECT.TOKENS
      5693**DCL     15227<<ASSIGN
XSS$CONTROL_GIVE
      5946**DCL     19021<<ASSIGN
XSS$CONTROL_GIVE.ERRDEF
      6022**DCL      6042--REDEF
XSS$CONTROL_GIVE.TOKENS.DK
      6010**DCL     19094<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.MA
      6006**DCL     19092<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.MI
      6008**DCL     19093<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.TR
      6004**DCL     19091<<ASSIGN
XSS$DATA
      6070**DCL     18319<<ASSIGN
XSS$DATA.ERRDEF
      6104**DCL      6124--REDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:207  
XSS$DATA.FNC
      6091**DCL     18320<<ASSIGN
XSS$EVLOG
     13706**DCL-ENT 13988--CALL
XSS$EXPEDITED_DATA
      6214**DCL     18709<<ASSIGN
XSS$EXPEDITED_DATA.ERRDEF
      6248**DCL      6268--REDEF
XSS$EXPEDITED_DATA.FNC
      6235**DCL     18710<<ASSIGN
XSS$GENERIC.DATA.PTR$
      4713**DCL     21417<<ASSIGN
XSS$GENERIC.DATA.SIZE
      4719**DCL     21418<<ASSIGN
XSS$GENERIC.ERRDEF
      4649**DCL      4669--REDEF
XSS$GENERIC.SCID
      4610**DCL     21421<<ASSIGN
XSS$MACHINE
     13705**DCL-ENT 21422--CALL
XSS$P_ABORT.ERRDEF
      6396**DCL      6416--REDEF
XSS$P_EXCEPTION_REPORT.ERRDEF
      6482**DCL      6502--REDEF
XSS$RELEASE
      6530**DCL     18087<<ASSIGN  18792<<ASSIGN  19544<<ASSIGN
XSS$RELEASE.ERRDEF
      6572**DCL      6592--REDEF
XSS$RELEASE.FNC
      6553**DCL     18088<<ASSIGN  18793<<ASSIGN  19545<<ASSIGN
XSS$RESYNCHRONIZE
      6682**DCL     19935<<ASSIGN  20816<<ASSIGN
XSS$RESYNCHRONIZE.ERRDEF
      6780**DCL      6800--REDEF
XSS$RESYNCHRONIZE.FNC
      6705**DCL     19936<<ASSIGN  20817<<ASSIGN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:208  
XSS$RESYNCHRONIZE.SERNUM
      6876**DCL     20122--ASSIGN  21082--ASSIGN
XSS$RESYNCHRONIZE.TOKENS
      6756**DCL     20075<<ASSIGN  20956<<ASSIGN
XSS$SYNC_MAJOR
      6895**DCL     15752<<ASSIGN
XSS$SYNC_MAJOR.ERRDEF
      6939**DCL      6959--REDEF
XSS$SYNC_MAJOR.FNC
      6918**DCL     15753<<ASSIGN
XSS$SYNC_MAJOR.SERNUM
      7035**DCL     15870--ASSIGN
XSS$SYNC_MAJOR.TYPE
      6931**DCL     15823<<ASSIGN
XSS$SYNC_MINOR
      7054**DCL     19103<<ASSIGN  19324<<ASSIGN
XSS$SYNC_MINOR.DATA.PTR$
      7176**DCL     19314<<ASSIGN
XSS$SYNC_MINOR.DATA.SIZE
      7182**DCL     19315<<ASSIGN
XSS$SYNC_MINOR.ERRDEF
      7098**DCL      7118--REDEF
XSS$SYNC_MINOR.FNC
      7077**DCL     19104<<ASSIGN  19325<<ASSIGN
XSS$SYNC_MINOR.SERNUM
      7194**DCL     19220--ASSIGN  19511--ASSIGN
XSS$SYNC_MINOR.TYPE
      7090**DCL     19464<<ASSIGN
XSS$TOKEN_GIVE
      7213**DCL     18241<<ASSIGN
XSS$TOKEN_GIVE.ERRDEF
      7295**DCL      7315--REDEF
XSS$TOKEN_GIVE.FNC
      7234**DCL     18242<<ASSIGN
XSS$TOKEN_GIVE.TOKENS
      7271**DCL     18314<<ASSIGN
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:209  
XSS$TOKEN_PLEASE
      7343**DCL     19783<<ASSIGN
XSS$TOKEN_PLEASE.ERRDEF
      7425**DCL      7445--REDEF
XSS$TOKEN_PLEASE.FNC
      7364**DCL     19784<<ASSIGN
XSS$TOKEN_PLEASE.TOKENS
      7401**DCL     19925<<ASSIGN
XSS$TYPED_DATA
      7535**DCL     21114<<ASSIGN
XSS$TYPED_DATA.ERRDEF
      7569**DCL      7589--REDEF
XSS$TYPED_DATA.FNC
      7556**DCL     21115<<ASSIGN
XSS$U_ABORT
      7679**DCL     14148<<ASSIGN
XSS$U_ABORT.ERRDEF
      7713**DCL      7733--REDEF
XSS$U_ABORT.FNC
      7700**DCL     14149<<ASSIGN
XSS$U_EXCEPTION_REPORT
      7823**DCL     18408<<ASSIGN  18558<<ASSIGN
XSS$U_EXCEPTION_REPORT.ERRDEF
      7862**DCL      7882--REDEF
XSS$U_EXCEPTION_REPORT.FNC
      7844**DCL     18409<<ASSIGN  18559<<ASSIGN
XSS$U_EXCEPTION_REPORT.REASON
      7854**DCL     18548<<ASSIGN
XSS_ACTIVITY_DISCARD
      8120**DCL     15454>>ASSIGN
XSS_ACTIVITY_DISCARD.ERRDEF
      8164**DCL      8190--REDEF
XSS_ACTIVITY_END
      8218**DCL     15899>>ASSIGN  15981>>ASSIGN
XSS_ACTIVITY_END.ERRDEF
      8254**DCL      8274--REDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:210  
XSS_ACTIVITY_INTERRUPT
      8369**DCL     14299>>ASSIGN
XSS_ACTIVITY_INTERRUPT.ERRDEF
      8419**DCL      8439--REDEF
XSS_ACTIVITY_RESUME
      8467**DCL     16131>>ASSIGN
XSS_ACTIVITY_RESUME.ERRDEF
      8506**DCL      8526--REDEF
XSS_ACTIVITY_START
      8693**DCL     16773>>ASSIGN
XSS_ACTIVITY_START.ERRDEF
      8727**DCL      8747--REDEF
XSS_CAPABILITY_DATA
      8856**DCL     16923>>ASSIGN  17002>>ASSIGN
XSS_CAPABILITY_DATA.ERRDEF
      8892**DCL      8912--REDEF
XSS_CONNECT
      9002**DCL     14380>>ASSIGN  17082>>ASSIGN  20156>>ASSIGN
XSS_CONNECT.CALLED$
      9228**DCL      9229--REDEF
XSS_CONNECT.ERRDEF
      9096**DCL      9116--REDEF
XSS_CONTROL_GIVE
      9325**DCL     19021>>ASSIGN
XSS_CONTROL_GIVE.ERRDEF
      9401**DCL      9421--REDEF
XSS_DATA
      9449**DCL     18319>>ASSIGN
XSS_DATA.ERRDEF
      9483**DCL      9503--REDEF
XSS_EXPEDITED_DATA
      9593**DCL     18709>>ASSIGN
XSS_EXPEDITED_DATA.ERRDEF
      9627**DCL      9647--REDEF
XSS_GENERIC.ERRDEF
      8028**DCL      8048--REDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:211  
XSS_ITEMCNT
     13708**DCL     13902<<ASSIGN  13964>>ASSIGN  14058>>ASSIGN  14136>>ASSIGN  14203>>ASSIGN  14209>>ASSIGN
     14272>>ASSIGN  14281>>ASSIGN  14346>>ASSIGN  14360>>ASSIGN  14444>>ASSIGN  14513>>ASSIGN  14575>>ASSIGN
     14584>>ASSIGN  14645>>ASSIGN  14654>>ASSIGN  14710>>ASSIGN  14724>>ASSIGN  14794>>ASSIGN  14850>>ASSIGN
     14864>>ASSIGN  14921>>ASSIGN  14935>>ASSIGN  14992>>ASSIGN  15006>>ASSIGN  15063>>ASSIGN  15077>>ASSIGN
     15140>>ASSIGN  15146>>ASSIGN  15211>>ASSIGN  15217>>ASSIGN  15287>>ASSIGN  15293>>ASSIGN  15355>>ASSIGN
     15364>>ASSIGN  15426>>ASSIGN  15435>>ASSIGN  15515>>ASSIGN  15570>>ASSIGN  15584>>ASSIGN  15661>>ASSIGN
     15739>>ASSIGN  15799>>ASSIGN  15813>>ASSIGN  15870>>ASSIGN  15884>>ASSIGN  15947>>ASSIGN  15961>>ASSIGN
     16042>>ASSIGN  16098>>ASSIGN  16112>>ASSIGN  16195>>ASSIGN  16264>>ASSIGN  16325>>ASSIGN  16334>>ASSIGN
     16395>>ASSIGN  16404>>ASSIGN  16465>>ASSIGN  16474>>ASSIGN  16530>>ASSIGN  16544>>ASSIGN  16605>>ASSIGN
     16614>>ASSIGN  16670>>ASSIGN  16684>>ASSIGN  16745>>ASSIGN  16754>>ASSIGN  16834>>ASSIGN  16895>>ASSIGN
     16904>>ASSIGN  16984>>ASSIGN  17063>>ASSIGN  17146>>ASSIGN  17215>>ASSIGN  17277>>ASSIGN  17286>>ASSIGN
     17347>>ASSIGN  17356>>ASSIGN  17412>>ASSIGN  17426>>ASSIGN  17496>>ASSIGN  17552>>ASSIGN  17566>>ASSIGN
     17623>>ASSIGN  17637>>ASSIGN  17694>>ASSIGN  17708>>ASSIGN  17765>>ASSIGN  17779>>ASSIGN  17842>>ASSIGN
     17848>>ASSIGN  17919>>ASSIGN  17925>>ASSIGN  17988>>ASSIGN  17997>>ASSIGN  18059>>ASSIGN  18068>>ASSIGN
     18148>>ASSIGN  18227>>ASSIGN  18296>>ASSIGN  18302>>ASSIGN  18375>>ASSIGN  18381>>ASSIGN  18469>>ASSIGN
     18524>>ASSIGN  18538>>ASSIGN  18619>>ASSIGN  18679>>ASSIGN  18688>>ASSIGN  18770>>ASSIGN  18853>>ASSIGN
     18916>>ASSIGN  18922>>ASSIGN  19004>>ASSIGN  19081>>ASSIGN  19164>>ASSIGN  19220>>ASSIGN  19234>>ASSIGN
     19294>>ASSIGN  19303>>ASSIGN  19385>>ASSIGN  19440>>ASSIGN  19454>>ASSIGN  19511>>ASSIGN  19525>>ASSIGN
     19605>>ASSIGN  19685>>ASSIGN  19740>>ASSIGN  19754>>ASSIGN  19844>>ASSIGN  19907>>ASSIGN  19913>>ASSIGN
     19996>>ASSIGN  20059>>ASSIGN  20065>>ASSIGN  20122>>ASSIGN  20136>>ASSIGN  20221>>ASSIGN  20290>>ASSIGN
     20352>>ASSIGN  20361>>ASSIGN  20422>>ASSIGN  20431>>ASSIGN  20487>>ASSIGN  20501>>ASSIGN  20566>>ASSIGN
     20572>>ASSIGN  20641>>ASSIGN  20647>>ASSIGN  20703>>ASSIGN  20717>>ASSIGN  20778>>ASSIGN  20787>>ASSIGN
     20877>>ASSIGN  20940>>ASSIGN  20946>>ASSIGN  21002>>ASSIGN  21016>>ASSIGN  21082>>ASSIGN  21096>>ASSIGN
     21175>>ASSIGN  21239>>ASSIGN  21245>>ASSIGN  21326>>ASSIGN  21335>>ASSIGN  21397>>ASSIGN  21406>>ASSIGN
XSS_P_ABORT.ERRDEF
      9775**DCL      9795--REDEF
XSS_P_EXCEPTION_REPORT.ERRDEF
      9861**DCL      9881--REDEF
XSS_RELEASE
      9909**DCL     18087>>ASSIGN  18792>>ASSIGN  19544>>ASSIGN
XSS_RELEASE.ERRDEF
      9951**DCL      9971--REDEF
XSS_RESYNCHRONIZE
     10061**DCL     19935>>ASSIGN  20816>>ASSIGN
XSS_RESYNCHRONIZE.ERRDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:212  
     10159**DCL     10179--REDEF
XSS_SYNC_MAJOR
     10274**DCL     15752>>ASSIGN
XSS_SYNC_MAJOR.ERRDEF
     10318**DCL     10338--REDEF
XSS_SYNC_MINOR
     10433**DCL     19103>>ASSIGN  19324>>ASSIGN
XSS_SYNC_MINOR.ERRDEF
     10477**DCL     10497--REDEF
XSS_TOKEN_GIVE
     10592**DCL     18241>>ASSIGN
XSS_TOKEN_GIVE.ERRDEF
     10674**DCL     10694--REDEF
XSS_TOKEN_PLEASE
     10722**DCL     19783>>ASSIGN
XSS_TOKEN_PLEASE.ERRDEF
     10804**DCL     10824--REDEF
XSS_TYPED_DATA
     10914**DCL     21114>>ASSIGN
XSS_TYPED_DATA.ERRDEF
     10948**DCL     10968--REDEF
XSS_U_ABORT
     11058**DCL     14148>>ASSIGN
XSS_U_ABORT.ERRDEF
     11092**DCL     11112--REDEF
XSS_U_EXCEPTION_REPORT
     11202**DCL     18408>>ASSIGN  18558>>ASSIGN
XSS_U_EXCEPTION_REPORT.ERRDEF
     11241**DCL     11261--REDEF
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:213  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$DECODE File=XSS$DECODE.:XSA1TSI                           WED 10/01/97 12:16 Page:214  
              MINI UREF LISTING

DST$   13720**DCL
SFNCCASE   13990**LABEL
XSS$DECODE      13**PROC
