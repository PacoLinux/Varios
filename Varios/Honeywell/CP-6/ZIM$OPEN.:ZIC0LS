
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:1    
        1        1        /*M* ZIO$DBOPEN opens the area pointed to by DBCB.IOWS.ACOPN.ACPTR
        2        2        */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        ZIO$DBOPEN: PROC ALTRET
        9        9         /* USE($PR5 FOR GLOBAL$) */
       10       10               AVOID($PR5,$PR6,$PR7);
       11       11        %INCLUDE ZI$GLOBAL;
       12      497            %GLOBALS;
       13      805        %INCLUDE ZI$DBCB;
       14     1447            %DBCB;
       15     1925            %AWS;
       16     1965        %INCLUDE ZI$SSS;
       17     2514            %AC;
       18     2609            %RA;
       19     2629            %RC;
       20     2661            %RS;
       21     2737            %CD;
       22     2756            %FR;
       23     2802            %SC1;
       24     2812        %INCLUDE ZI$USER;
       25     2957            %IA;
       26     3006            %RCW;
       27     3016        %INCLUDE CP_6;
       28     3097        %INCLUDE CP_6_SUBS;
       29     3637        %INCLUDE ZI_ERRORS_C;
       30     3963    1   DCL ZIB$DBINI ENTRY ALTRET;
       31     3964    1   DCL ZIO$DBCLOSE ENTRY ALTRET;
       32     3965    1   DCL ZIM$OPEN ENTRY ALTRET;
       33     3966    1   DCL ZIM$JBEGIN ENTRY;
       34     3967    1   DCL VLP$ PTR SYMREF;
       35     3968    1   DCL ERROR UBIN(36);
       36     3969    1       ERROR=0;
       37     3970    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:2    
       38     3971    1       SSS$=GLOBAL.ACTIVE.SSS$;
       39     3972    1       AC$=PINCRW(SSS$,DBCB.IOWS.ACOPN);
       40     3973    1       AWS$=GLOBAL.PARAN.IO.AWS$;
       41     3974    1       AWS='0'B;
       42     3975    1       IF GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)=%YES# THEN
       43     3976    2       DO;
       44     3977    2           GLOBAL.ACCT='        ';
       45     3978    2           GLOBAL.DCBNAME.LENGTH=30;
       46     3979    3           DO WHILE (IA.SNCHAR(GLOBAL.DCBNAME.LENGTH-1)=' ');
       47     3980    3               GLOBAL.DCBNAME.LENGTH=GLOBAL.DCBNAME.LENGTH-1;
       48     3981    3               IF GLOBAL.DCBNAME.LENGTH=0 THEN
       49     3982    3                   GOTO ER_NAME;
       50     3983    3               END;
       51     3984    2           GLOBAL.DCBNAME.TEXT=IA.SNAME;
       52     3985    2           GLOBAL.FILENAME=GLOBAL.DCBNAME;
       53     3986    2           END;
       54     3987    1       ELSE
       55     3988    2       DO;
       56     3989    2           GLOBAL.ACCT=DBCB.CSECT.SSACCT;
       57     3990    2           GLOBAL.DCBNAME.LENGTH=LENGTHC(AC.ANAM);
       58     3991    2           GLOBAL.DCBNAME.TEXT=AC.ANAM;
       59     3992    2           GLOBAL.FILENAME.LENGTH=AC.SANAM.EIS.COUNT;
       60     3993    2           GLOBAL.FILENAME.TEXT=
       61     3994    2              PINCRW(SSS$,AC.SANAM.EIS.OFFSET.WD)->SANAME;
       62     3995    2           END;
       63     3996    1       AWS.ATRIB.CHKSUM=AC.FLAGS.CHKSUM;
       64     3997    1       AWS.ATRIB.TJRNL=AC.FLAGS.TJRNL;
       65     3998    1       AWS.ATRIB.TMPLT=AC.FLAGS.TMPLT;
       66     3999    1       AWS.ATRIB.CJRNL=AC.FLAGS.CJRNL;
       67     4000    1       IF SSS$=GLOBAL.CANSSS$ THEN
       68     4001    2       DO;
       69     4002    2           AWS.ATRIB.CANSSS=%YES#;
       70     4003    2           AWS.ATRIB.LOAD=%NO#;
       71     4004    2           AWS.ATRIB.FUN=%IN#;
       72     4005    2           AWS.ATRIB.SHARE=%ALL#;
       73     4006    2           AWS.ATRIB.SHANY=%NO#;
       74     4007    2           AWS.ENCRP='0'B;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:3    
       75     4008    2           END;
       76     4009    1       ELSE
       77     4010    2       DO;
       78     4011    2           AWS.ATRIB.CANSSS=%NO#;
       79     4012    2           AWS.ATRIB.LOAD=VLP$->RCW.HW0.LOAD;
       80     4013    2           IF VLP$->RCW&RCW#MODES#IN THEN
       81     4014    3           DO;
       82     4015    3               AWS.ATRIB.FUN=%IN#;
       83     4016    3               IF GLOBAL.PENDING.SHANY THEN
       84     4017    3                   GLOBAL.PENDING.SHARE=%ALL#;
       85     4018    3               END;
       86     4019    2           ELSE
       87     4020    3           DO;
       88     4021    3               AWS.ATRIB.FUN=%UPDATE#;
       89     4022    3               IF GLOBAL.PENDING.SHANY THEN
       90     4023    3                   GLOBAL.PENDING.SHARE=%IN#;
       91     4024    3               END;
       92     4025    2           AWS.ATRIB.SHARE=GLOBAL.PENDING.SHARE;
       93     4026    2           AWS.ATRIB.SHANY=GLOBAL.PENDING.SHANY;
       94     4027    2           IF ~AC.FLAGS.ENCRP AND GLOBAL.ENCRP~='0'B THEN
       95     4028    2               GOTO ER_ENCRP;
       96     4029    2           AWS.ENCRP=GLOBAL.ENCRP;
       97     4030    2           END;
       98     4031    1       IF AC.DEF.ATMP OR DBCB.SWS.TEMP.INAFLAG=1 THEN
       99     4032    1           AWS.ATRIB.ATMP=%YES#;
      100     4033    1       ELSE
      101     4034    1           AWS.ATRIB.ATMP=%NO#;
      102     4035    1       AWS.ATRIB.INDEXED=AC.DEF.ORG.INDEXED;
      103     4036    1       AWS.ATRIB.KEYED=AC.DEF.ORG.KEYED&~AC.DEF.ORG.INDEXED;
      104     4037    1       AWS.HIGHPG=AC.PGLIM.IHIGHPG;
      105     4038    1       AWS.HIGHDBK=AC.DBLIM.IHIGHDBK;
      106     4039    1       AWS.FIPN=AC.IFIPN;
      107     4040    1       AWS.NCHA=AC.INCHA;
      108     4041    1       IF AWS.ATRIB.INDEXED AND AWS.ATRIB.ATMP THEN
      109     4042    1           CALL ZIM$IINIT;
      110     4043    1       GLOBAL.PARAN.IO.AWS$=AWS$;
      111     4044    1       CALL ZIM$OPEN ALTRET(ALT);
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:4    
      112     4045        /*          Begin journaling */
      113     4046    1       IF ~AWS.ATRIB.CANSSS THEN
      114     4047    1           CALL ZIM$JBEGIN;
      115     4048    1       IF ~AWS.ATRIB.INDEXED THEN
      116     4049    1           IF AWS.ATRIB.ATMP THEN
      117     4050                    %DBCAL(NAME=ZIB$DBINI,ALT=ER_INI);
      118     4066    1           ELSE
      119     4067    1               CALL ZIM$DBRAB ALTRET(ER_ATTR);
      120     4068    1       ELSE
      121     4069    1           IF ~AWS.ATRIB.ATMP THEN
      122     4070    1               CALL ZIM$ICHECK ALTRET(ER_CHECK);
      123     4071    1       RETURN;
      124     4072    1   ER_ENCRP: ERROR=ERR#IO#ENCPNA;
      125     4073    1       GOTO ALT;
      126     4074    1   ER_INI: ;
      127     4075    1   ER_ATTR: ;
      128     4076    1   ER_CHECK: ;
      129     4077    1       CALL ZIO$DBCLOSE ALTRET(ALT);
      130     4078    1   ER_NAME: ERROR=ERR#CM#INNM;
      131     4079    1       GOTO ALT;
      132     4080    1   ALT: ;
      133     4081            %DBALT;
      134     4095        %EJECT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:5    
      135     4096    1   ZIM$DBRAB: PROC ALTRET;
      136     4097        %INCLUDE ZI$PG_STRUCTS;
      137     4200         %ATBLK_PG(PSTCLASS=AUTO);
      138     4256         %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      139     4275    2   DCL ZIO$DBREAD ENTRY ALTRET;
      140     4276    2   DCL ZIO$MODIFY ENTRY ALTRET;
      141     4277    2   DCL ONEWORD UBIN(36) BASED;
      142     4278
      143     4279    2       GLOBAL.PARAN.IO.PGNO=0;
      144     4280    2       CALL ZIO$DBREAD ALTRET(ER_READ);
      145     4281    2       ATBLK$=PINCRW(GLOBAL.PARAN.IO.BUF$,-3);
      146     4282    2       IF ATBLK_PG.IDS_HDR~='IDS2' THEN
      147     4283    2           GOTO ER_CRPT;
      148     4284        /*       Repeat check here but params set up by DBREAD */
      149     4285    2       IF AWS.ATRIB.CHKSUM THEN
      150     4286    2           IF GLOBAL.PARAN.ICKSM.V~=
      151     4287    2              PINCRW(GLOBAL.PARAN.ICKSM.P$,2)->ONEWORD THEN
      152     4288    2               GOTO ER_CKSM;
      153     4289    2       IF GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)=%YES# THEN
      154     4290    2           IF ATBLK_PG.AREA_NM~=IA.SNAME THEN
      155     4291    2               GOTO ER_AREA;
      156     4292    2           ELSE;
      157     4293    2       ELSE
      158     4294
      159     4295    2           IF ATBLK_PG.AREA_NM~=
      160     4296    2              SUBSTR(PINCRW(SSS$,AC.SANAM.EIS.OFFSET.WD)->SANAME,0,AC.SANAM.EIS.COUNT)
              4296                       THEN
      161     4297    2               GOTO ER_AREA;
      162     4298    2       IF ATBLK_PG.STATUS.LOCKED THEN
      163     4299    2           GOTO ER_LOCKED;
      164     4300    2       IF ATBLK_PG.STATUS.LOCKUPD AND
      165     4301    2          AWS.ATRIB.FUN=%UPDATE# THEN
      166     4302    2           GOTO ER_LOCKUPD;
      167     4303    2       IF AWS.ATRIB.KEYED AND AWS.ATRIB.LOAD THEN /* LOAD MODE */
      168     4304    3       DO;
      169     4305    3           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      170     4306    3           ATBLK_PG.TIME_LOCKED=GLOBAL.TIME.TSTAMP;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:6    
      171     4307    3           ATBLK_PG.STATUS.KFILE_CURR='1'B; /* SET KEYFILE LOCK */
      172     4308    3           ATBLK_PG.REASON_LOCKED.LOAD_MODE='1'B;
      173     4309    3           CALL ZIO$MODIFY ALTRET(ALT);
      174     4310    3           END;
      175     4311    2       ELSE
      176     4312    2           IF AWS.ATRIB.KEYED AND ATBLK_PG.STATUS.KFILE_CURR THEN
      177     4313    2               GOTO ER_RBLDKYS;
      178     4314    2       IF AC.FLAGS.TMPLT THEN
      179     4315    3       DO;
      180     4316    3           AWS.HIGHPG=ATBLK_PG.NUM_DBPG;
      181     4317    3           AWS.HIGHDBK=ATBLK_PG.HIGH_DBK;
      182     4318    3           AWS.FIPN=ATBLK_PG.FIR_INV_PGNO;
      183     4319    3           AWS.NCHA=ATBLK_PG.TOT_CALC_HDRS;
      184     4320    3           END;
      185     4321    3       ELSE DO;
      186     4322         /* test AWS against attributes so we
      187     4323            are in the right area (not used
      188     4324            for templates) */
      189     4325    3           IF (ATBLK_PG.NUM_DBPG ~= AWS.HIGHPG) OR
      190     4326    3              (ATBLK_PG.FIR_INV_PGNO ~= AWS.FIPN) OR
      191     4327    4              (ATBLK_PG.HIGH_DBK ~= AWS.HIGHDBK) THEN DO;
      192     4328    4               GOTO ERR_INVAREA;
      193     4329    4               END;
      194     4330    3           END;
      195     4331    2       RETURN;
      196     4332    2   ER_CRPT: ERROR=ERR#IO#BADSEED;
      197     4333    2       GOTO ALT;
      198     4334    2   ER_CKSM:
      199     4335    2       ERROR=ERR#IO#CKSM;
      200     4336    2       GOTO ALT;
      201     4337    2   ER_AREA: ERROR=ERR#IO#ARNAF;
      202     4338    2       GOTO ALT;
      203     4339    2   ER_LOCKED: ERROR=ERR#IO#LOCKED;
      204     4340    2       GOTO ALT;
      205     4341    2   ER_LOCKUPD: ERROR=ERR#IO#LOCKUPD;
      206     4342    2       GOTO ALT;
      207     4343    2   ER_RBLDKYS: ERROR=ERR#IO#RBLDKYS;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:7    
      208     4344    2       GOTO ALT;
      209     4345    2   ERR_INVAREA: ERROR=ERR#IO#INVAREA;
      210     4346    2       GOTO ALT;
      211     4347    2   ER_READ: ;
      212     4348    2   ALT: ;
      213     4349            %DBALT;
      214     4363    2   END ZIM$DBRAB;
      215     4364        %EJECT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:8    
      216     4365    1   ZIM$ICHECK: PROC ALTRET;
      217     4366         %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS="BASED(ALTKEYS$)");
      218     4381         %FPT_OPEN(FPTN=FPT$OPEN,STCLASS=BASED);
      219     4490         %F$DCB;
      220     4547        %INCLUDE FM$FIT;
      221     4768         %FITALTKEYS(BASED="BASED(ALTKEYS$)");
      222     4774    2   DCL B$ROS$ PTR SYMREF;
      223     4775    2   DCL IXMAX UBIN WORD;
      224     4776    2   DCL INITFLAG BIT(1);
      225     4777    2   DCL IXNUM UBIN WORD;
      226     4778    2   DCL KEYX UBIN WORD;
      227     4779    2   DCL KEYL UBIN WORD;
      228     4780    2   DCL ALTKEYS$ PTR;
      229     4781    2       INITFLAG=%NO#;
      230     4782    2       GOTO COM;
      231     4783    2   ZIM$IINIT: ENTRY;
      232     4784    2       INITFLAG=%YES#;
      233     4785    2   COM: RA$=PINCRW(SSS$,AC.ACRAN);
      234     4786    2       RC$=PINCRW(SSS$,RA.RCRAH);
      235     4787    2       IXMAX=0;
      236     4788    2       IF INITFLAG THEN
      237     4789    2           ALTKEYS$=GLOBAL.ALTKEYS$;
      238     4790    2       ELSE
      239     4791    2           ALTKEYS$=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX);
      240     4792        /*  Set first SM to RC and start searching set for all keys */
      241     4793    2       RS$=RC$;
      242     4794    3       DO WHILE (RS.RCRSN~=0);
      243     4795    3           RS$=PINCRW(SSS$,RS.RCRSN);
      244     4796    3           IF RS.DEF.TYPE~=%RS_CLASS_MEMBER THEN
      245     4797    3               GOTO NEXTRS;
      246     4798    3           IXNUM=RS.DEF.IXNUM;
      247     4799    3           SC1$=PINCRW(SSS$,RS.SCRSH-SIZEW(SC1));
      248     4800    3           KEYL=SC1.KLNG;
      249     4801    3           CD$=PINCRW(SSS$,RS.RSCDN);
      250     4802    4           DO WHILE (CD.DEF.SYNC);
      251     4803    4               CD$=PINCRW(SSS$,CD.RSCDN);
      252     4804    4               END;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:9    
      253     4805    3           FR$=PINCRW(SSS$,CD.CDSH);
      254     4806         /* Change offset from nibbles to bytes */
      255     4807    3           KEYX=BITBIN(FR.ROFST.EIS.OFFSET)/2;
      256     4808    3           IF INITFLAG THEN
      257     4809    4               IF RS.DEF.VIA THEN DO;
      258     4810    4                   GLOBAL.OPEN$->FPT$OPEN.V.KEYL#=KEYL;
      259     4811    4                   GLOBAL.OPEN$->FPT$OPEN.V.KEYX#=KEYX;
      260     4812    4                   END;
      261     4813    4               ELSE DO;
      262     4814    4                   IF RS.DEF.DORD=2 THEN
      263     4815    4                       VLP$ALTKEYS.K.UNIQUE#(IXNUM-2)=%YES#;
      264     4816    4                   ELSE
      265     4817    4                       VLP$ALTKEYS.K.UNIQUE#(IXNUM-2)=%NO#;
      266     4818    4                   VLP$ALTKEYS.K.KEYL#(IXNUM-2)=KEYL;
      267     4819    4                   VLP$ALTKEYS.K.KEYX#(IXNUM-2)=KEYX;
      268     4820    4                   END;
      269     4821    3           ELSE
      270     4822    3               IF (RS.DEF.DORD=2 AND ~FITALTKEYS.K.UNIQUE(IXNUM-1)) OR
      271     4823    3                  (RS.DEF.DORD=3 AND FITALTKEYS.K.UNIQUE(IXNUM-1)) OR
      272     4824    3                  FITALTKEYS.K.KEYL(IXNUM-1)~=KEYL OR
      273     4825    3                  FITALTKEYS.K.KEYX(IXNUM-1)~=KEYX THEN
      274     4826    3                   GOTO ER_INIT;
      275     4827    3           IF IXNUM>IXMAX THEN
      276     4828    3               IXMAX=IXNUM;
      277     4829    3   NEXTRS: END;
      278     4830    2       IF INITFLAG THEN
      279     4831    2           VLP$ALTKEYS.SIZ#=IXMAX-1;
      280     4832    2       ELSE
      281     4833    2           IF FITALTKEYS.NUMENTS~=IXMAX THEN
      282     4834    2               GOTO ER_INIT;
      283     4835    2       RETURN;
      284     4836    2   ER_INIT: ERROR=ERR#IO#ARNAF;
      285     4837    2       GOTO ALT;
      286     4838    2   ALT: ;
      287     4839            %DBALT;
      288     4853    2   END ZIM$ICHECK;
      289     4854    1   END ZIO$DBOPEN;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:10   
      290     4855        %EOD;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:11   
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$DBOPEN.

   Procedure ZIO$DBOPEN requires 641 words for executable code.
   Procedure ZIO$DBOPEN requires 24 words of local(AUTO) storage.

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:12   

 Object Unit name= ZIO$DBOPEN                                 File name= ZIM$OPEN.:ZIC0TOU
 UTS= SEP 05 '97 13:03:20.92 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      4      4  ZIO$DBOPEN
    2   Proc  even  none   641   1201  ZIO$DBOPEN
    3  RoData even  none    12     14  ZIO$DBOPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      XStd       0  ZIO$DBOPEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           XStd      0 ZIM$OPEN
         yes           XStd      0 ZIM$JBEGIN
 yes     yes           XStd      0 ZIB$DBINI
         yes           XStd      0 ZIB$ERR
 yes     yes           XStd      0 ZIO$DBCLOSE
 yes     yes           XStd      0 ZIO$DBREAD
 yes     yes           XStd      0 ZIO$MODIFY
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               IA$                                   M$UC
     VLP$                                  B$ROS$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 NULLSID
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:14   


        1        1        /*M* ZIO$DBOPEN opens the area pointed to by DBCB.IOWS.ACOPN.ACPTR
        2        2        */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        ZIO$DBOPEN: PROC ALTRET

      8  2 000000   000000 700200 xent  ZIO$DBOPEN   TSX0  ! X66_AUTO_0
         2 000001   000030 000000                    ZERO    24,0

        9        9         /* USE($PR5 FOR GLOBAL$) */
       10       10               AVOID($PR5,$PR6,$PR7);
       11       11        %INCLUDE ZI$GLOBAL;
       12      497            %GLOBALS;
       13      805        %INCLUDE ZI$DBCB;
       14     1447            %DBCB;
       15     1925            %AWS;
       16     1965        %INCLUDE ZI$SSS;
       17     2514            %AC;
       18     2609            %RA;
       19     2629            %RC;
       20     2661            %RS;
       21     2737            %CD;
       22     2756            %FR;
       23     2802            %SC1;
       24     2812        %INCLUDE ZI$USER;
       25     2957            %IA;
       26     3006            %RCW;
       27     3016        %INCLUDE CP_6;
       28     3097        %INCLUDE CP_6_SUBS;
       29     3637        %INCLUDE ZI_ERRORS_C;
       30     3963    1   DCL ZIB$DBINI ENTRY ALTRET;
       31     3964    1   DCL ZIO$DBCLOSE ENTRY ALTRET;
       32     3965    1   DCL ZIM$OPEN ENTRY ALTRET;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:15   
       33     3966    1   DCL ZIM$JBEGIN ENTRY;
       34     3967    1   DCL VLP$ PTR SYMREF;
       35     3968    1   DCL ERROR UBIN(36);
       36     3969    1       ERROR=0;

   3969  2 000002   200015 450100                    STZ     ERROR,,AUTO

       37     3970    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   3970  2 000003   000000 470400 xsym               LDP0    GLOBAL$
         2 000004   000001 236100                    LDQ     1,,PR0
         2 000005   200003 756100                    STQ     DBCB$,,AUTO

       38     3971    1       SSS$=GLOBAL.ACTIVE.SSS$;

   3971  2 000006   000000 236100                    LDQ     0,,PR0
         2 000007   200005 756100                    STQ     SSS$,,AUTO

       39     3972    1       AC$=PINCRW(SSS$,DBCB.IOWS.ACOPN);

   3972  2 000010   200003 471500                    LDP1    DBCB$,,AUTO
         2 000011   101016 220100                    LDX0    526,,PR1
         2 000012   000000 636010                    EAQ     0,X0
         2 000013   200005 036100                    ADLQ    SSS$,,AUTO
         2 000014   200006 756100                    STQ     AC$,,AUTO

       40     3973    1       AWS$=GLOBAL.PARAN.IO.AWS$;

   3973  2 000015   000020 236100                    LDQ     16,,PR0
         2 000016   200004 756100                    STQ     AWS$,,AUTO

       41     3974    1       AWS='0'B;

   3974  2 000017   200004 473500                    LDP3    AWS$,,AUTO
         2 000020   000100 100400                    MLR     fill='000'O
         2 000021   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000022   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:16   

       42     3975    1       IF GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)=%YES# THEN

   3975  2 000023   000002 235100                    LDA     2,,PR0
         2 000024   000167 234105                    SZN     119,AL,PR0
         2 000025   000067 605000 2                  TPL     s:3989

       43     3976    2       DO;

       44     3977    2           GLOBAL.ACCT='        ';

   3977  2 000026   000000 237000 1                  LDAQ    0
         2 000027   004744 757100                    STAQ    2532,,PR0

       45     3978    2           GLOBAL.DCBNAME.LENGTH=30;

   3978  2 000030   036000 236003                    LDQ     15360,DU
         2 000031   004734 552140                    STBQ    2524,'40'O,PR0

       46     3979    3           DO WHILE (IA.SNCHAR(GLOBAL.DCBNAME.LENGTH-1)=' ');

   3979  2 000032   004734 236100                    LDQ     2524,,PR0
         2 000033   000033 772000                    QRL     27
         2 000034   000000 474400 xsym               LDP4    IA$
         2 000035   040000 106506                    CMPC    fill='040'O
         2 000036   400011 600001                    ADSC9   9,Q,PR4                  cn=3,n=1
         2 000037   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000040   000057 601000 2                  TNZ     s:3984

       47     3980    3               GLOBAL.DCBNAME.LENGTH=GLOBAL.DCBNAME.LENGTH-1;

   3980  2 000041   000000 470400 xsym               LDP0    GLOBAL$
         2 000042   004734 236100                    LDQ     2524,,PR0
         2 000043   777000 036003                    ADLQ    -512,DU
         2 000044   004734 552140                    STBQ    2524,'40'O,PR0

       48     3981    3               IF GLOBAL.DCBNAME.LENGTH=0 THEN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:17   

   3981  2 000045   004734 236100                    LDQ     2524,,PR0
         2 000046   777000 316003                    CANQ    -512,DU
         2 000047   000414 600000 2                  TZE     ER_NAME

       49     3982    3                   GOTO ER_NAME;
       50     3983    3               END;

   3983  2 000050   004734 236100                    LDQ     2524,,PR0
         2 000051   000033 772000                    QRL     27
         2 000052   000000 471400 xsym               LDP1    IA$
         2 000053   040000 106506                    CMPC    fill='040'O
         2 000054   100011 600001                    ADSC9   9,Q,PR1                  cn=3,n=1
         2 000055   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000056   000041 600000 2                  TZE     s:3980

       51     3984    2           GLOBAL.DCBNAME.TEXT=IA.SNAME;

   3984  2 000057   000000 471400 xsym               LDP1    IA$
         2 000060   040100 100500                    MLR     fill='040'O
         2 000061   100012 000036                    ADSC9   10,,PR1                  cn=0,n=30
         2 000062   004734 200037                    ADSC9   2524,,PR0                cn=1,n=31

       52     3985    2           GLOBAL.FILENAME=GLOBAL.DCBNAME;

   3985  2 000063   000100 100500                    MLR     fill='000'O
         2 000064   004734 000040                    ADSC9   2524,,PR0                cn=0,n=32
         2 000065   004724 000040                    ADSC9   2516,,PR0                cn=0,n=32

       53     3986    2           END;

   3986  2 000066   000122 710000 2                  TRA     s:3996

       54     3987    1       ELSE
       55     3988    2       DO;

       56     3989    2           GLOBAL.ACCT=DBCB.CSECT.SSACCT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:18   

   3989  2 000067   040100 100500                    MLR     fill='040'O
         2 000070   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         2 000071   004744 000010                    ADSC9   2532,,PR0                cn=0,n=8

       57     3990    2           GLOBAL.DCBNAME.LENGTH=LENGTHC(AC.ANAM);

   3990  2 000072   200006 474500                    LDP4    AC$,,AUTO
         2 000073   400000 720100                    LXL0    0,,PR4
         2 000074   000077 360003                    ANX0    63,DU
         2 000075   000000 636010                    EAQ     0,X0
         2 000076   000022 772000                    QRL     18
         2 000077   000033 736000                    QLS     27
         2 000100   004734 552140                    STBQ    2524,'40'O,PR0

       58     3991    2           GLOBAL.DCBNAME.TEXT=AC.ANAM;

   3991  2 000101   400000 720100                    LXL0    0,,PR4
         2 000102   000077 360003                    ANX0    63,DU
         2 000103   040100 100540                    MLR     fill='040'O
         2 000104   400026 000010                    ADSC9   22,,PR4                  cn=0,n=*X0
         2 000105   004734 200037                    ADSC9   2524,,PR0                cn=1,n=31

       59     3992    2           GLOBAL.FILENAME.LENGTH=AC.SANAM.EIS.COUNT;

   3992  2 000106   400005 236100                    LDQ     5,,PR4
         2 000107   000033 736000                    QLS     27
         2 000110   004724 552140                    STBQ    2516,'40'O,PR0

       60     3993    2           GLOBAL.FILENAME.TEXT=

   3993  2 000111   400005 220100                    LDX0    5,,PR4
         2 000112   077777 360003                    ANX0    32767,DU
         2 000113   000000 635010                    EAA     0,X0
         2 000114   000020 771000                    ARL     16
         2 000115   200005 470500                    LDP0    SSS$,,AUTO
         2 000116   000000 471400 xsym               LDP1    GLOBAL$
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:19   
         2 000117   040100 100505                    MLR     fill='040'O
         2 000120   000000 000037                    ADSC9   0,A,PR0                  cn=0,n=31
         2 000121   104724 200037                    ADSC9   2516,,PR1                cn=1,n=31

       61     3994    2              PINCRW(SSS$,AC.SANAM.EIS.OFFSET.WD)->SANAME;
       62     3995    2           END;

       63     3996    1       AWS.ATRIB.CHKSUM=AC.FLAGS.CHKSUM;

   3996  2 000122   200004 470500                    LDP0    AWS$,,AUTO
         2 000123   200006 471500                    LDP1    AC$,,AUTO
         2 000124   100015 236100                    LDQ     13,,PR1
         2 000125   000015 736000                    QLS     13
         2 000126   000000 676100                    ERQ     0,,PR0
         2 000127   010000 376003                    ANQ     4096,DU
         2 000130   000000 656100                    ERSQ    0,,PR0

       64     3997    1       AWS.ATRIB.TJRNL=AC.FLAGS.TJRNL;

   3997  2 000131   100015 236100                    LDQ     13,,PR1
         2 000132   000022 736000                    QLS     18
         2 000133   000000 676100                    ERQ     0,,PR0
         2 000134   020000 376003                    ANQ     8192,DU
         2 000135   000000 656100                    ERSQ    0,,PR0

       65     3998    1       AWS.ATRIB.TMPLT=AC.FLAGS.TMPLT;

   3998  2 000136   100015 236100                    LDQ     13,,PR1
         2 000137   000022 736000                    QLS     18
         2 000140   000000 676100                    ERQ     0,,PR0
         2 000141   040000 376003                    ANQ     16384,DU
         2 000142   000000 656100                    ERSQ    0,,PR0

       66     3999    1       AWS.ATRIB.CJRNL=AC.FLAGS.CJRNL;

   3999  2 000143   100015 236100                    LDQ     13,,PR1
         2 000144   000022 736000                    QLS     18
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:20   
         2 000145   000000 676100                    ERQ     0,,PR0
         2 000146   100000 376003                    ANQ     32768,DU
         2 000147   000000 656100                    ERSQ    0,,PR0

       67     4000    1       IF SSS$=GLOBAL.CANSSS$ THEN

   4000  2 000150   000000 473400 xsym               LDP3    GLOBAL$
         2 000151   200005 236100                    LDQ     SSS$,,AUTO
         2 000152   300003 116100                    CMPQ    3,,PR3
         2 000153   000174 601000 2                  TNZ     s:4011

       68     4001    2       DO;

       69     4002    2           AWS.ATRIB.CANSSS=%YES#;

   4002  2 000154   000200 236003                    LDQ     128,DU
         2 000155   000000 256100                    ORSQ    0,,PR0

       70     4003    2           AWS.ATRIB.LOAD=%NO#;

   4003  2 000156   000002 236000 3                  LDQ     2
         2 000157   000000 356100                    ANSQ    0,,PR0

       71     4004    2           AWS.ATRIB.FUN=%IN#;

   4004  2 000160   000000 236100                    LDQ     0,,PR0
         2 000161   000003 376000 3                  ANQ     3
         2 000162   000040 276003                    ORQ     32,DU
         2 000163   000000 756100                    STQ     0,,PR0

       72     4005    2           AWS.ATRIB.SHARE=%ALL#;

   4005  2 000164   000000 236100                    LDQ     0,,PR0
         2 000165   000004 376000 3                  ANQ     4
         2 000166   002000 276003                    ORQ     1024,DU
         2 000167   000000 756100                    STQ     0,,PR0

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:21   
       73     4006    2           AWS.ATRIB.SHANY=%NO#;

   4006  2 000170   000005 236000 3                  LDQ     5
         2 000171   000000 356100                    ANSQ    0,,PR0

       74     4007    2           AWS.ENCRP='0'B;

   4007  2 000172   000007 450100                    STZ     7,,PR0

       75     4008    2           END;

   4008  2 000173   000260 710000 2                  TRA     s:4031

       76     4009    1       ELSE
       77     4010    2       DO;

       78     4011    2           AWS.ATRIB.CANSSS=%NO#;

   4011  2 000174   000006 236000 3                  LDQ     6
         2 000175   000000 356100                    ANSQ    0,,PR0

       79     4012    2           AWS.ATRIB.LOAD=VLP$->RCW.HW0.LOAD;

   4012  2 000176   000000 474400 xsym               LDP4    VLP$
         2 000177   400000 236100                    LDQ     0,,PR4
         2 000200   000001 772000                    QRL     1
         2 000201   000000 676100                    ERQ     0,,PR0
         2 000202   000002 376003                    ANQ     2,DU
         2 000203   000000 656100                    ERSQ    0,,PR0

       80     4013    2           IF VLP$->RCW&RCW#MODES#IN THEN

   4013  2 000204   000000 474400 xsym               LDP4    VLP$
         2 000205   400000 236100                    LDQ     0,,PR4
         2 000206   000002 376000 1                  ANQ     2
         2 000207   000223 600000 2                  TZE     s:4021

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:22   
       81     4014    3           DO;

       82     4015    3               AWS.ATRIB.FUN=%IN#;

   4015  2 000210   000000 236100                    LDQ     0,,PR0
         2 000211   000003 376000 3                  ANQ     3
         2 000212   000040 276003                    ORQ     32,DU
         2 000213   000000 756100                    STQ     0,,PR0

       83     4016    3               IF GLOBAL.PENDING.SHANY THEN

   4016  2 000214   300017 236100                    LDQ     15,,PR3
         2 000215   002000 316003                    CANQ    1024,DU
         2 000216   000235 600000 2                  TZE     s:4025

       84     4017    3                   GLOBAL.PENDING.SHARE=%ALL#;

   4017  2 000217   000007 376000 3                  ANQ     7
         2 000220   100000 276003                    ORQ     32768,DU
         2 000221   300017 756100                    STQ     15,,PR3

       85     4018    3               END;

   4018  2 000222   000235 710000 2                  TRA     s:4025

       86     4019    2           ELSE
       87     4020    3           DO;

       88     4021    3               AWS.ATRIB.FUN=%UPDATE#;

   4021  2 000223   000000 236100                    LDQ     0,,PR0
         2 000224   000003 376000 3                  ANQ     3
         2 000225   000020 276003                    ORQ     16,DU
         2 000226   000000 756100                    STQ     0,,PR0

       89     4022    3               IF GLOBAL.PENDING.SHANY THEN

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:23   
   4022  2 000227   300017 236100                    LDQ     15,,PR3
         2 000230   002000 316003                    CANQ    1024,DU
         2 000231   000235 600000 2                  TZE     s:4025

       90     4023    3                   GLOBAL.PENDING.SHARE=%IN#;

   4023  2 000232   000007 376000 3                  ANQ     7
         2 000233   200000 276003                    ORQ     65536,DU
         2 000234   300017 756100                    STQ     15,,PR3

       91     4024    3               END;

       92     4025    2           AWS.ATRIB.SHARE=GLOBAL.PENDING.SHARE;

   4025  2 000235   300017 236100                    LDQ     15,,PR3
         2 000236   000005 772000                    QRL     5
         2 000237   000000 676100                    ERQ     0,,PR0
         2 000240   006000 376003                    ANQ     3072,DU
         2 000241   000000 656100                    ERSQ    0,,PR0

       93     4026    2           AWS.ATRIB.SHANY=GLOBAL.PENDING.SHANY;

   4026  2 000242   300017 236100                    LDQ     15,,PR3
         2 000243   000001 772000                    QRL     1
         2 000244   000000 676100                    ERQ     0,,PR0
         2 000245   001000 376003                    ANQ     512,DU
         2 000246   000000 656100                    ERSQ    0,,PR0

       94     4027    2           IF ~AC.FLAGS.ENCRP AND GLOBAL.ENCRP~='0'B THEN

   4027  2 000247   100015 236100                    LDQ     13,,PR1
         2 000250   000023 736000                    QLS     19
         2 000251   400000 376003                    ANQ     -131072,DU
         2 000252   400000 676003                    ERQ     -131072,DU
         2 000253   000256 600000 2                  TZE     s:4029
         2 000254   305000 235100                    LDA     2560,,PR3
         2 000255   000406 601000 2                  TNZ     ER_ENCRP
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:24   

       95     4028    2               GOTO ER_ENCRP;
       96     4029    2           AWS.ENCRP=GLOBAL.ENCRP;

   4029  2 000256   305000 236100                    LDQ     2560,,PR3
         2 000257   000007 756100                    STQ     7,,PR0

       97     4030    2           END;

       98     4031    1       IF AC.DEF.ATMP OR DBCB.SWS.TEMP.INAFLAG=1 THEN

   4031  2 000260   100000 236100                    LDQ     0,,PR1
         2 000261   000100 316007                    CANQ    64,DL
         2 000262   000267 601000 2                  TNZ     s:4032
         2 000263   200003 474500                    LDP4    DBCB$,,AUTO
         2 000264   400113 235100                    LDA     75,,PR4
         2 000265   000001 115007                    CMPA    1,DL
         2 000266   000272 601000 2                  TNZ     s:4034

       99     4032    1           AWS.ATRIB.ATMP=%YES#;

   4032  2 000267   000100 236003                    LDQ     64,DU
         2 000270   000000 256100                    ORSQ    0,,PR0
         2 000271   000274 710000 2                  TRA     s:4035

      100     4033    1       ELSE
      101     4034    1           AWS.ATRIB.ATMP=%NO#;

   4034  2 000272   000010 236000 3                  LDQ     8
         2 000273   000000 356100                    ANSQ    0,,PR0

      102     4035    1       AWS.ATRIB.INDEXED=AC.DEF.ORG.INDEXED;

   4035  2 000274   100000 236100                    LDQ     0,,PR1
         2 000275   000000 676100                    ERQ     0,,PR0
         2 000276   000010 376003                    ANQ     8,DU
         2 000277   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:25   

      103     4036    1       AWS.ATRIB.KEYED=AC.DEF.ORG.KEYED&~AC.DEF.ORG.INDEXED;

   4036  2 000300   100000 236100                    LDQ     0,,PR1
         2 000301   000016 736000                    QLS     14
         2 000302   400000 376003                    ANQ     -131072,DU
         2 000303   400000 676003                    ERQ     -131072,DU
         2 000304   200026 756100                    STQ     ALTKEYS$+2,,AUTO
         2 000305   100000 236100                    LDQ     0,,PR1
         2 000306   000017 736000                    QLS     15
         2 000307   400000 376003                    ANQ     -131072,DU
         2 000310   200026 376100                    ANQ     ALTKEYS$+2,,AUTO
         2 000311   000017 772000                    QRL     15
         2 000312   000000 676100                    ERQ     0,,PR0
         2 000313   000004 376003                    ANQ     4,DU
         2 000314   000000 656100                    ERSQ    0,,PR0

      104     4037    1       AWS.HIGHPG=AC.PGLIM.IHIGHPG;

   4037  2 000315   100007 235100                    LDA     7,,PR1
         2 000316   000004 755100                    STA     4,,PR0

      105     4038    1       AWS.HIGHDBK=AC.DBLIM.IHIGHDBK;

   4038  2 000317   100011 235100                    LDA     9,,PR1
         2 000320   000003 755100                    STA     3,,PR0

      106     4039    1       AWS.FIPN=AC.IFIPN;

   4039  2 000321   100021 235100                    LDA     17,,PR1
         2 000322   000005 755100                    STA     5,,PR0

      107     4040    1       AWS.NCHA=AC.INCHA;

   4040  2 000323   100016 235100                    LDA     14,,PR1
         2 000324   000002 755100                    STA     2,,PR0

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:26   
      108     4041    1       IF AWS.ATRIB.INDEXED AND AWS.ATRIB.ATMP THEN

   4041  2 000325   000000 236100                    LDQ     0,,PR0
         2 000326   000010 316003                    CANQ    8,DU
         2 000327   000334 600000 2                  TZE     s:4043
         2 000330   000100 316003                    CANQ    64,DU
         2 000331   000334 600000 2                  TZE     s:4043

      109     4042    1           CALL ZIM$IINIT;

   4042  2 000332   000670 701000 2                  TSX1    ZIM$IINIT
         2 000333   000000 011000                    NOP     0

      110     4043    1       GLOBAL.PARAN.IO.AWS$=AWS$;

   4043  2 000334   200004 236100                    LDQ     AWS$,,AUTO
         2 000335   000000 470400 xsym               LDP0    GLOBAL$
         2 000336   000020 756100                    STQ     16,,PR0

      111     4044    1       CALL ZIM$OPEN ALTRET(ALT);

   4044  2 000337   000000 631400 3                  EPPR1   0
         2 000340   000000 701000 xent               TSX1    ZIM$OPEN
         2 000341   000417 702000 2                  TSX2    ALT

      112     4045        /*          Begin journaling */
      113     4046    1       IF ~AWS.ATRIB.CANSSS THEN

   4046  2 000342   200004 470500                    LDP0    AWS$,,AUTO
         2 000343   000000 236100                    LDQ     0,,PR0
         2 000344   000012 736000                    QLS     10
         2 000345   400000 376003                    ANQ     -131072,DU
         2 000346   400000 676003                    ERQ     -131072,DU
         2 000347   000353 600000 2                  TZE     s:4048

      114     4047    1           CALL ZIM$JBEGIN;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:27   
   4047  2 000350   000000 631400 3                  EPPR1   0
         2 000351   000000 701000 xent               TSX1    ZIM$JBEGIN
         2 000352   000000 011000                    NOP     0

      115     4048    1       IF ~AWS.ATRIB.INDEXED THEN

   4048  2 000353   200004 470500                    LDP0    AWS$,,AUTO
         2 000354   000000 236100                    LDQ     0,,PR0
         2 000355   000016 736000                    QLS     14
         2 000356   400000 376003                    ANQ     -131072,DU
         2 000357   400000 676003                    ERQ     -131072,DU
         2 000360   000376 600000 2                  TZE     s:4069

      116     4049    1           IF AWS.ATRIB.ATMP THEN

   4049  2 000361   000000 236100                    LDQ     0,,PR0
         2 000362   000100 316003                    CANQ    64,DU
         2 000363   000373 600000 2                  TZE     s:4067

      117     4050                    %DBCAL(NAME=ZIB$DBINI,ALT=ER_INI);

   4054  2 000364   000000 631400 3                  EPPR1   0
         2 000365   000000 701000 xent               TSX1    ZIB$DBINI
         2 000366   000411 702000 2                  TSX2    ER_INI

   4055  2 000367   000000 470400 xsym               LDP0    GLOBAL$
         2 000370   000006 235100                    LDA     6,,PR0
         2 000371   000411 601000 2                  TNZ     ER_INI

   4064  2 000372   000405 710000 2                  TRA     s:4071

      118     4066    1           ELSE
      119     4067    1               CALL ZIM$DBRAB ALTRET(ER_ATTR);

   4067  2 000373   000440 701000 2                  TSX1    ZIM$DBRAB
         2 000374   000411 702000 2                  TSX2    ER_INI
         2 000375   000405 710000 2                  TRA     s:4071
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:28   

      120     4068    1       ELSE
      121     4069    1           IF ~AWS.ATRIB.ATMP THEN

   4069  2 000376   000000 236100                    LDQ     0,,PR0
         2 000377   000013 736000                    QLS     11
         2 000400   400000 376003                    ANQ     -131072,DU
         2 000401   400000 676003                    ERQ     -131072,DU
         2 000402   000405 600000 2                  TZE     s:4071

      122     4070    1               CALL ZIM$ICHECK ALTRET(ER_CHECK);

   4070  2 000403   000665 701000 2                  TSX1    ZIM$ICHECK
         2 000404   000411 702000 2                  TSX2    ER_INI

      123     4071    1       RETURN;

   4071  2 000405   000000 702200 xent               TSX2  ! X66_ARET

      124     4072    1   ER_ENCRP: ERROR=ERR#IO#ENCPNA;

   4072  2 000406   210711 236007       ER_ENCRP     LDQ     70089,DL
         2 000407   200015 756100                    STQ     ERROR,,AUTO

      125     4073    1       GOTO ALT;

   4073  2 000410   000417 710000 2                  TRA     ALT

   4069  2 000411                       ER_INI       null
   4069  2 000411                       ER_ATTR      null
   4069  2 000411                       ER_CHECK     null
      126     4074    1   ER_INI: ;
      127     4075    1   ER_ATTR: ;
      128     4076    1   ER_CHECK: ;
      129     4077    1       CALL ZIO$DBCLOSE ALTRET(ALT);

   4077  2 000411   000000 631400 3                  EPPR1   0
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:29   
         2 000412   000000 701000 xent               TSX1    ZIO$DBCLOSE
         2 000413   000417 702000 2                  TSX2    ALT

      130     4078    1   ER_NAME: ERROR=ERR#CM#INNM;

   4078  2 000414   210566 235007       ER_NAME      LDA     70006,DL
         2 000415   200015 755100                    STA     ERROR,,AUTO

      131     4079    1       GOTO ALT;

   4079  2 000416   000417 710000 2                  TRA     ALT

   4069  2 000417                       ALT          null
      132     4080    1   ALT: ;
      133     4081            %DBALT;

   4082  2 000417   000000 470400 xsym               LDP0    GLOBAL$
         2 000420   000006 235100                    LDA     6,,PR0
         2 000421   000430 601000 2                  TNZ     s:4090

   4084  2 000422   000010 450100                    STZ     8,,PR0

   4085  2 000423   000012 450100                    STZ     10,,PR0

   4086  2 000424   000013 450100                    STZ     11,,PR0

   4087  2 000425   000011 450100                    STZ     9,,PR0

   4088  2 000426   200015 236100                    LDQ     ERROR,,AUTO
         2 000427   000006 756100                    STQ     6,,PR0

   4090  2 000430   000006 235100                    LDA     6,,PR0
         2 000431   303240 115007                    CMPA    100000,DL
         2 000432   000434 603000 2                  TRC     s:4093

   4091  2 000433   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:30   
   4093  2 000434   000000 631400 3                  EPPR1   0
         2 000435   000000 701000 xent               TSX1    ZIB$ERR
         2 000436   000000 011000                    NOP     0
         2 000437   001200 710000 2                  TRA     s:4854

      134     4095        %EJECT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:31   
      135     4096    1   ZIM$DBRAB: PROC ALTRET;

   4096  2 000440   200016 741300       ZIM$DBRAB    STX1  ! ERROR+1,,AUTO

      136     4097        %INCLUDE ZI$PG_STRUCTS;
      137     4200         %ATBLK_PG(PSTCLASS=AUTO);
      138     4256         %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      139     4275    2   DCL ZIO$DBREAD ENTRY ALTRET;
      140     4276    2   DCL ZIO$MODIFY ENTRY ALTRET;
      141     4277    2   DCL ONEWORD UBIN(36) BASED;
      142     4278
      143     4279    2       GLOBAL.PARAN.IO.PGNO=0;

   4279  2 000441   000000 470400 xsym               LDP0    GLOBAL$
         2 000442   000021 450100                    STZ     17,,PR0

      144     4280    2       CALL ZIO$DBREAD ALTRET(ER_READ);

   4280  2 000443   000000 631400 3                  EPPR1   0
         2 000444   000000 701000 xent               TSX1    ZIO$DBREAD
         2 000445   000642 702000 2                  TSX2    ER_READ

      145     4281    2       ATBLK$=PINCRW(GLOBAL.PARAN.IO.BUF$,-3);

   4281  2 000446   000000 470400 xsym               LDP0    GLOBAL$
         2 000447   000022 236100                    LDQ     18,,PR0
         2 000450   777775 036003                    ADLQ    -3,DU
         2 000451   200017 756100                    STQ     ATBLK$,,AUTO

      146     4282    2       IF ATBLK_PG.IDS_HDR~='IDS2' THEN

   4282  2 000452   200017 471500                    LDP1    ATBLK$,,AUTO
         2 000453   100003 236100                    LDQ     3,,PR1
         2 000454   000003 116000 1                  CMPQ    3
         2 000455   000615 601000 2                  TNZ     ER_CRPT

      147     4283    2           GOTO ER_CRPT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:32   
      148     4284        /*       Repeat check here but params set up by DBREAD */
      149     4285    2       IF AWS.ATRIB.CHKSUM THEN

   4285  2 000456   200004 473500                    LDP3    AWS$,,AUTO
         2 000457   300000 236100                    LDQ     0,,PR3
         2 000460   010000 316003                    CANQ    4096,DU
         2 000461   000466 600000 2                  TZE     s:4289

      150     4286    2           IF GLOBAL.PARAN.ICKSM.V~=

   4286  2 000462   000023 474500                    LDP4    19,,PR0
         2 000463   000024 236100                    LDQ     20,,PR0
         2 000464   400002 116100                    CMPQ    2,,PR4
         2 000465   000620 601000 2                  TNZ     ER_CKSM

      151     4287    2              PINCRW(GLOBAL.PARAN.ICKSM.P$,2)->ONEWORD THEN
      152     4288    2               GOTO ER_CKSM;
      153     4289    2       IF GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)=%YES# THEN

   4289  2 000466   000002 235100                    LDA     2,,PR0
         2 000467   000167 234105                    SZN     119,AL,PR0
         2 000470   000477 605000 2                  TPL     s:4295

      154     4290    2           IF ATBLK_PG.AREA_NM~=IA.SNAME THEN

   4290  2 000471   000000 474400 xsym               LDP4    IA$
         2 000472   040100 106500                    CMPC    fill='040'O
         2 000473   100017 000040                    ADSC9   15,,PR1                  cn=0,n=32
         2 000474   400012 000036                    ADSC9   10,,PR4                  cn=0,n=30
         2 000475   000623 601000 2                  TNZ     ER_AREA
         2 000476   000513 710000 2                  TRA     s:4298

      155     4291    2               GOTO ER_AREA;
      156     4292    2           ELSE;
      157     4293    2       ELSE
      158     4294
      159     4295    2           IF ATBLK_PG.AREA_NM~=
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:33   

   4295  2 000477   200006 474500                    LDP4    AC$,,AUTO
         2 000500   400005 220100                    LDX0    5,,PR4
         2 000501   077777 360003                    ANX0    32767,DU
         2 000502   400005 721100                    LXL1    5,,PR4
         2 000503   007777 361003                    ANX1    4095,DU
         2 000504   000000 635010                    EAA     0,X0
         2 000505   000020 771000                    ARL     16
         2 000506   200005 470500                    LDP0    SSS$,,AUTO
         2 000507   040145 106500                    CMPC    fill='040'O
         2 000510   100017 000040                    ADSC9   15,,PR1                  cn=0,n=32
         2 000511   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         2 000512   000623 601000 2                  TNZ     ER_AREA

      160     4296    2              SUBSTR(PINCRW(SSS$,AC.SANAM.EIS.OFFSET.WD)->SANAME,0,AC.SANAM.EIS.COUNT)
              4296                       THEN
      161     4297    2               GOTO ER_AREA;
      162     4298    2       IF ATBLK_PG.STATUS.LOCKED THEN

   4298  2 000513   100041 234100                    SZN     33,,PR1
         2 000514   000626 604000 2                  TMI     ER_LOCKED

      163     4299    2           GOTO ER_LOCKED;
      164     4300    2       IF ATBLK_PG.STATUS.LOCKUPD AND

   4300  2 000515   100041 236100                    LDQ     33,,PR1
         2 000516   200000 316003                    CANQ    65536,DU
         2 000517   000524 600000 2                  TZE     s:4303
         2 000520   300000 236100                    LDQ     0,,PR3
         2 000521   000060 376003                    ANQ     48,DU
         2 000522   000020 116003                    CMPQ    16,DU
         2 000523   000631 600000 2                  TZE     ER_LOCKUPD

      165     4301    2          AWS.ATRIB.FUN=%UPDATE# THEN
      166     4302    2           GOTO ER_LOCKUPD;
      167     4303    2       IF AWS.ATRIB.KEYED AND AWS.ATRIB.LOAD THEN /* LOAD MODE */

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:34   
   4303  2 000524   300000 236100                    LDQ     0,,PR3
         2 000525   000004 316003                    CANQ    4,DU
         2 000526   000552 600000 2                  TZE     s:4312
         2 000527   000002 316003                    CANQ    2,DU
         2 000530   000552 600000 2                  TZE     s:4312

      168     4304    3       DO;

      169     4305    3           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4305  2 000531   000000 470400 xsym               LDP0    GLOBAL$
         2 000532   005117 474500                    LDP4    2639,,PR0
         2 000533   400000 630500                    EPPR0   0,,PR4
         2 000534   020004 713400                    CLIMB   8196
         2 000535   402000 401760                    pmme    nvectors=5

      170     4306    3           ATBLK_PG.TIME_LOCKED=GLOBAL.TIME.TSTAMP;

   4306  2 000536   000000 470400 xsym               LDP0    GLOBAL$
         2 000537   200017 471500                    LDP1    ATBLK$,,AUTO
         2 000540   005001 235100                    LDA     2561,,PR0
         2 000541   100042 755100                    STA     34,,PR1

      171     4307    3           ATBLK_PG.STATUS.KFILE_CURR='1'B; /* SET KEYFILE LOCK */

   4307  2 000542   100000 236003                    LDQ     32768,DU
         2 000543   100041 256100                    ORSQ    33,,PR1

      172     4308    3           ATBLK_PG.REASON_LOCKED.LOAD_MODE='1'B;

   4308  2 000544   200000 236003                    LDQ     65536,DU
         2 000545   100043 256100                    ORSQ    35,,PR1

      173     4309    3           CALL ZIO$MODIFY ALTRET(ALT);

   4309  2 000546   000000 631400 3                  EPPR1   0
         2 000547   000000 701000 xent               TSX1    ZIO$MODIFY
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:35   
         2 000550   000642 702000 2                  TSX2    ER_READ

      174     4310    3           END;

   4310  2 000551   000557 710000 2                  TRA     s:4314

      175     4311    2       ELSE
      176     4312    2           IF AWS.ATRIB.KEYED AND ATBLK_PG.STATUS.KFILE_CURR THEN

   4312  2 000552   000004 316003                    CANQ    4,DU
         2 000553   000557 600000 2                  TZE     s:4314
         2 000554   100041 236100                    LDQ     33,,PR1
         2 000555   100000 316003                    CANQ    32768,DU
         2 000556   000634 601000 2                  TNZ     ER_RBLDKYS

      177     4313    2               GOTO ER_RBLDKYS;
      178     4314    2       IF AC.FLAGS.TMPLT THEN

   4314  2 000557   200006 470500                    LDP0    AC$,,AUTO
         2 000560   000015 236100                    LDQ     13,,PR0
         2 000561   040000 316007                    CANQ    16384,DL
         2 000562   000576 600000 2                  TZE     s:4325

      179     4315    3       DO;

      180     4316    3           AWS.HIGHPG=ATBLK_PG.NUM_DBPG;

   4316  2 000563   200017 471500                    LDP1    ATBLK$,,AUTO
         2 000564   200004 473500                    LDP3    AWS$,,AUTO
         2 000565   100005 235100                    LDA     5,,PR1
         2 000566   300004 755100                    STA     4,,PR3

      181     4317    3           AWS.HIGHDBK=ATBLK_PG.HIGH_DBK;

   4317  2 000567   100016 235100                    LDA     14,,PR1
         2 000570   300003 755100                    STA     3,,PR3

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:36   
      182     4318    3           AWS.FIPN=ATBLK_PG.FIR_INV_PGNO;

   4318  2 000571   100014 235100                    LDA     12,,PR1
         2 000572   300005 755100                    STA     5,,PR3

      183     4319    3           AWS.NCHA=ATBLK_PG.TOT_CALC_HDRS;

   4319  2 000573   100013 235100                    LDA     11,,PR1
         2 000574   300002 755100                    STA     2,,PR3

      184     4320    3           END;

   4320  2 000575   000613 710000 2                  TRA     s:4331

      185     4321    3       ELSE DO;

      186     4322         /* test AWS against attributes so we
      187     4323            are in the right area (not used
      188     4324            for templates) */
      189     4325    3           IF (ATBLK_PG.NUM_DBPG ~= AWS.HIGHPG) OR

   4325  2 000576   200017 471500                    LDP1    ATBLK$,,AUTO
         2 000577   200004 473500                    LDP3    AWS$,,AUTO
         2 000600   100005 236100                    LDQ     5,,PR1
         2 000601   300004 116100                    CMPQ    4,,PR3
         2 000602   000612 601000 2                  TNZ     s:4328
         2 000603   100014 236100                    LDQ     12,,PR1
         2 000604   000612 604000 2                  TMI     s:4328
         2 000605   300005 116100                    CMPQ    5,,PR3
         2 000606   000612 601000 2                  TNZ     s:4328
         2 000607   100016 236100                    LDQ     14,,PR1
         2 000610   300003 116100                    CMPQ    3,,PR3
         2 000611   000613 600000 2                  TZE     s:4331

      190     4326    3              (ATBLK_PG.FIR_INV_PGNO ~= AWS.FIPN) OR
      191     4327    4              (ATBLK_PG.HIGH_DBK ~= AWS.HIGHDBK) THEN DO;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:37   
      192     4328    4               GOTO ERR_INVAREA;

   4328  2 000612   000637 710000 2                  TRA     ERR_INVAREA

      193     4329    4               END;
      194     4330    3           END;
      195     4331    2       RETURN;

   4331  2 000613   200016 221300                    LDX1  ! ERROR+1,,AUTO
         2 000614   000001 702211                    TSX2  ! 1,X1

      196     4332    2   ER_CRPT: ERROR=ERR#IO#BADSEED;

   4332  2 000615   210712 235007       ER_CRPT      LDA     70090,DL
         2 000616   200015 755100                    STA     ERROR,,AUTO

      197     4333    2       GOTO ALT;

   4333  2 000617   000642 710000 2                  TRA     ER_READ

      198     4334    2   ER_CKSM:
      199     4335    2       ERROR=ERR#IO#CKSM;

   4335  2 000620   303374 235007       ER_CKSM      LDA     100092,DL
         2 000621   200015 755100                    STA     ERROR,,AUTO

      200     4336    2       GOTO ALT;

   4336  2 000622   000642 710000 2                  TRA     ER_READ

      201     4337    2   ER_AREA: ERROR=ERR#IO#ARNAF;

   4337  2 000623   210713 235007       ER_AREA      LDA     70091,DL
         2 000624   200015 755100                    STA     ERROR,,AUTO

      202     4338    2       GOTO ALT;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:38   
   4338  2 000625   000642 710000 2                  TRA     ER_READ

      203     4339    2   ER_LOCKED: ERROR=ERR#IO#LOCKED;

   4339  2 000626   210752 235007       ER_LOCKED    LDA     70122,DL
         2 000627   200015 755100                    STA     ERROR,,AUTO

      204     4340    2       GOTO ALT;

   4340  2 000630   000642 710000 2                  TRA     ER_READ

      205     4341    2   ER_LOCKUPD: ERROR=ERR#IO#LOCKUPD;

   4341  2 000631   210753 235007       ER_LOCKUPD   LDA     70123,DL
         2 000632   200015 755100                    STA     ERROR,,AUTO

      206     4342    2       GOTO ALT;

   4342  2 000633   000642 710000 2                  TRA     ER_READ

      207     4343    2   ER_RBLDKYS: ERROR=ERR#IO#RBLDKYS;

   4343  2 000634   210754 235007       ER_RBLDKYS   LDA     70124,DL
         2 000635   200015 755100                    STA     ERROR,,AUTO

      208     4344    2       GOTO ALT;

   4344  2 000636   000642 710000 2                  TRA     ER_READ

      209     4345    2   ERR_INVAREA: ERROR=ERR#IO#INVAREA;

   4345  2 000637   210767 235007       ERR_INVAREA  LDA     70135,DL
         2 000640   200015 755100                    STA     ERROR,,AUTO

      210     4346    2       GOTO ALT;

   4346  2 000641   000642 710000 2                  TRA     ER_READ
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:39   

   4336  2 000642                       ER_READ      null
      211     4347    2   ER_READ: ;
      212     4348    2   ALT: ;

   4348  2 000642                       ALT          null
      213     4349            %DBALT;

   4350  2 000642   000000 470400 xsym               LDP0    GLOBAL$
         2 000643   000006 235100                    LDA     6,,PR0
         2 000644   000653 601000 2                  TNZ     s:4358

   4352  2 000645   000010 450100                    STZ     8,,PR0

   4353  2 000646   000012 450100                    STZ     10,,PR0

   4354  2 000647   000013 450100                    STZ     11,,PR0

   4355  2 000650   000011 450100                    STZ     9,,PR0

   4356  2 000651   200015 236100                    LDQ     ERROR,,AUTO
         2 000652   000006 756100                    STQ     6,,PR0

   4358  2 000653   000006 235100                    LDA     6,,PR0
         2 000654   303240 115007                    CMPA    100000,DL
         2 000655   000660 603000 2                  TRC     s:4361

   4359  2 000656   200016 221300                    LDX1  ! ERROR+1,,AUTO
         2 000657   000000 702211                    TSX2  ! 0,X1

   4361  2 000660   000000 631400 3                  EPPR1   0
         2 000661   000000 701000 xent               TSX1    ZIB$ERR
         2 000662   000000 011000                    NOP     0

      214     4363    2   END ZIM$DBRAB;

   4363  2 000663   200016 221300                    LDX1  ! ERROR+1,,AUTO
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:40   
         2 000664   000001 702211                    TSX2  ! 1,X1

      215     4364        %EJECT;
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:41   
      216     4365    1   ZIM$ICHECK: PROC ALTRET;

   4365  2 000665   200016 741300       ZIM$ICHECK   STX1  ! ERROR+1,,AUTO

      217     4366         %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS="BASED(ALTKEYS$)");
      218     4381         %FPT_OPEN(FPTN=FPT$OPEN,STCLASS=BASED);
      219     4490         %F$DCB;
      220     4547        %INCLUDE FM$FIT;
      221     4768         %FITALTKEYS(BASED="BASED(ALTKEYS$)");
      222     4774    2   DCL B$ROS$ PTR SYMREF;
      223     4775    2   DCL IXMAX UBIN WORD;
      224     4776    2   DCL INITFLAG BIT(1);
      225     4777    2   DCL IXNUM UBIN WORD;
      226     4778    2   DCL KEYX UBIN WORD;
      227     4779    2   DCL KEYL UBIN WORD;
      228     4780    2   DCL ALTKEYS$ PTR;
      229     4781    2       INITFLAG=%NO#;

   4781  2 000666   200020 450100                    STZ     INITFLAG,,AUTO

      230     4782    2       GOTO COM;

   4782  2 000667   000673 710000 2                  TRA     COM

      231     4783    2   ZIM$IINIT: ENTRY;

   4783  2 000670   200016 741300       ZIM$IINIT    STX1  ! ERROR+1,,AUTO

      232     4784    2       INITFLAG=%YES#;

   4784  2 000671   400000 236003                    LDQ     -131072,DU
         2 000672   200020 756100                    STQ     INITFLAG,,AUTO

      233     4785    2   COM: RA$=PINCRW(SSS$,AC.ACRAN);

   4785  2 000673   200006 470500       COM          LDP0    AC$,,AUTO
         2 000674   000001 720100                    LXL0    1,,PR0
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:42   
         2 000675   000000 636010                    EAQ     0,X0
         2 000676   200005 036100                    ADLQ    SSS$,,AUTO
         2 000677   200007 756100                    STQ     RA$,,AUTO

      234     4786    2       RC$=PINCRW(SSS$,RA.RCRAH);

   4786  2 000700   200007 471500                    LDP1    RA$,,AUTO
         2 000701   100002 222100                    LDX2    2,,PR1
         2 000702   000000 636012                    EAQ     0,X2
         2 000703   200005 036100                    ADLQ    SSS$,,AUTO
         2 000704   200010 756100                    STQ     RC$,,AUTO

      235     4787    2       IXMAX=0;

   4787  2 000705   200017 450100                    STZ     IXMAX,,AUTO

      236     4788    2       IF INITFLAG THEN

   4788  2 000706   200020 234100                    SZN     INITFLAG,,AUTO
         2 000707   000714 605000 2                  TPL     s:4791

      237     4789    2           ALTKEYS$=GLOBAL.ALTKEYS$;

   4789  2 000710   000000 473400 xsym               LDP3    GLOBAL$
         2 000711   305134 236100                    LDQ     2652,,PR3
         2 000712   200024 756100                    STQ     ALTKEYS$,,AUTO
         2 000713   000725 710000 2                  TRA     s:4793

      238     4790    2       ELSE
      239     4791    2           ALTKEYS$=PINCRW(B$ROS$,DCBADDR(AWS.DDCB)->F$DCB.ALTKEYX);

   4791  2 000714   000011 473400 3                  LDP3    9
         2 000715   300000 474500                    LDP4    0,,PR3
         2 000716   200004 470500                    LDP0    AWS$,,AUTO
         2 000717   000006 220100                    LDX0    6,,PR0
         2 000720   400000 470510                    LDP0    0,X0,PR4
         2 000721   000052 720100                    LXL0    42,,PR0
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:43   
         2 000722   000000 636010                    EAQ     0,X0
         2 000723   000000 036000 xsym               ADLQ    B$ROS$
         2 000724   200024 756100                    STQ     ALTKEYS$,,AUTO

      240     4792        /*  Set first SM to RC and start searching set for all keys */
      241     4793    2       RS$=RC$;

   4793  2 000725   200010 236100                    LDQ     RC$,,AUTO
         2 000726   200011 756100                    STQ     RS$,,AUTO

      242     4794    3       DO WHILE (RS.RCRSN~=0);

   4794  2 000727   200011 470500                    LDP0    RS$,,AUTO
         2 000730   000002 720100                    LXL0    2,,PR0
         2 000731   001133 600000 2                  TZE     s:4830

      243     4795    3           RS$=PINCRW(SSS$,RS.RCRSN);

   4795  2 000732   200011 470500                    LDP0    RS$,,AUTO
         2 000733   000002 720100                    LXL0    2,,PR0
         2 000734   000000 636010                    EAQ     0,X0
         2 000735   200005 036100                    ADLQ    SSS$,,AUTO
         2 000736   200011 756100                    STQ     RS$,,AUTO

      244     4796    3           IF RS.DEF.TYPE~=%RS_CLASS_MEMBER THEN

   4796  2 000737   200011 470500                    LDP0    RS$,,AUTO
         2 000740   000000 236100                    LDQ     0,,PR0
         2 000741   777700 376003                    ANQ     -64,DU
         2 000742   004000 116003                    CMPQ    2048,DU
         2 000743   001130 601000 2                  TNZ     NEXTRS

      245     4797    3               GOTO NEXTRS;
      246     4798    3           IXNUM=RS.DEF.IXNUM;

   4798  2 000744   000000 236100                    LDQ     0,,PR0
         2 000745   001777 376007                    ANQ     1023,DL
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:44   
         2 000746   200021 756100                    STQ     IXNUM,,AUTO

      247     4799    3           SC1$=PINCRW(SSS$,RS.SCRSH-SIZEW(SC1));

   4799  2 000747   000003 720100                    LXL0    3,,PR0
         2 000750   777776 636010                    EAQ     -2,X0
         2 000751   200005 036100                    ADLQ    SSS$,,AUTO
         2 000752   200014 756100                    STQ     SC1$,,AUTO

      248     4800    3           KEYL=SC1.KLNG;

   4800  2 000753   200014 471500                    LDP1    SC1$,,AUTO
         2 000754   100000 236100                    LDQ     0,,PR1
         2 000755   777777 376007                    ANQ     -1,DL
         2 000756   200023 756100                    STQ     KEYL,,AUTO

      249     4801    3           CD$=PINCRW(SSS$,RS.RSCDN);

   4801  2 000757   000001 221100                    LDX1    1,,PR0
         2 000760   000000 636011                    EAQ     0,X1
         2 000761   200005 036100                    ADLQ    SSS$,,AUTO
         2 000762   200012 756100                    STQ     CD$,,AUTO

      250     4802    4           DO WHILE (CD.DEF.SYNC);

   4802  2 000763   200012 473500                    LDP3    CD$,,AUTO
         2 000764   300000 236100                    LDQ     0,,PR3
         2 000765   000040 316003                    CANQ    32,DU
         2 000766   001000 600000 2                  TZE     s:4805

      251     4803    4               CD$=PINCRW(SSS$,CD.RSCDN);

   4803  2 000767   200012 470500                    LDP0    CD$,,AUTO
         2 000770   000001 220100                    LDX0    1,,PR0
         2 000771   000000 636010                    EAQ     0,X0
         2 000772   200005 036100                    ADLQ    SSS$,,AUTO
         2 000773   200012 756100                    STQ     CD$,,AUTO
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:45   

      252     4804    4               END;

   4804  2 000774   200012 470500                    LDP0    CD$,,AUTO
         2 000775   000000 236100                    LDQ     0,,PR0
         2 000776   000040 316003                    CANQ    32,DU
         2 000777   000767 601000 2                  TNZ     s:4803

      253     4805    3           FR$=PINCRW(SSS$,CD.CDSH);

   4805  2 001000   200012 470500                    LDP0    CD$,,AUTO
         2 001001   000002 220100                    LDX0    2,,PR0
         2 001002   000000 636010                    EAQ     0,X0
         2 001003   200005 036100                    ADLQ    SSS$,,AUTO
         2 001004   200013 756100                    STQ     FR$,,AUTO

      254     4806         /* Change offset from nibbles to bytes */
      255     4807    3           KEYX=BITBIN(FR.ROFST.EIS.OFFSET)/2;

   4807  2 001005   200013 471500                    LDP1    FR$,,AUTO
         2 001006   100001 236100                    LDQ     1,,PR1
         2 001007   000017 772000                    QRL     15
         2 001010   777777 376007                    ANQ     -1,DL
         2 001011   000001 772000                    QRL     1
         2 001012   200022 756100                    STQ     KEYX,,AUTO

      256     4808    3           IF INITFLAG THEN

   4808  2 001013   200020 234100                    SZN     INITFLAG,,AUTO
         2 001014   001057 605000 2                  TPL     s:4822

      257     4809    4               IF RS.DEF.VIA THEN DO;

   4809  2 001015   200011 473500                    LDP3    RS$,,AUTO
         2 001016   300000 236100                    LDQ     0,,PR3
         2 001017   000040 316003                    CANQ    32,DU
         2 001020   001032 600000 2                  TZE     s:4814
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:46   

      258     4810    4                   GLOBAL.OPEN$->FPT$OPEN.V.KEYL#=KEYL;

   4810  2 001021   000000 474400 xsym               LDP4    GLOBAL$
         2 001022   405066 470500                    LDP0    2614,,PR4
         2 001023   200023 236100                    LDQ     KEYL,,AUTO
         2 001024   000011 736000                    QLS     9
         2 001025   000051 552110                    STBQ    41,'10'O,PR0

      259     4811    4                   GLOBAL.OPEN$->FPT$OPEN.V.KEYX#=KEYX;

   4811  2 001026   405066 470500                    LDP0    2614,,PR4
         2 001027   200022 720100                    LXL0    KEYX,,AUTO
         2 001030   000051 740100                    STX0    41,,PR0

      260     4812    4                   END;

   4812  2 001031   001123 710000 2                  TRA     s:4827

      261     4813    4               ELSE DO;

      262     4814    4                   IF RS.DEF.DORD=2 THEN

   4814  2 001032   300000 236100                    LDQ     0,,PR3
         2 001033   600000 376007                    ANQ     -65536,DL
         2 001034   400000 116007                    CMPQ    -131072,DL
         2 001035   001043 601000 2                  TNZ     s:4817

      263     4815    4                       VLP$ALTKEYS.K.UNIQUE#(IXNUM-2)=%YES#;

   4815  2 001036   200024 474500                    LDP4    ALTKEYS$,,AUTO
         2 001037   200021 721100                    LXL1    IXNUM,,AUTO
         2 001040   400000 236003                    LDQ     -131072,DU
         2 001041   477777 256111                    ORSQ    -1,X1,PR4
         2 001042   001047 710000 2                  TRA     s:4818

      264     4816    4                   ELSE
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:47   
      265     4817    4                       VLP$ALTKEYS.K.UNIQUE#(IXNUM-2)=%NO#;

   4817  2 001043   200024 474500                    LDP4    ALTKEYS$,,AUTO
         2 001044   200021 721100                    LXL1    IXNUM,,AUTO
         2 001045   000013 236000 3                  LDQ     11
         2 001046   477777 356111                    ANSQ    -1,X1,PR4

      266     4818    4                   VLP$ALTKEYS.K.KEYL#(IXNUM-2)=KEYL;

   4818  2 001047   200023 236100                    LDQ     KEYL,,AUTO
         2 001050   000022 736000                    QLS     18
         2 001051   477777 676111                    ERQ     -1,X1,PR4
         2 001052   000777 376003                    ANQ     511,DU
         2 001053   477777 656111                    ERSQ    -1,X1,PR4

      267     4819    4                   VLP$ALTKEYS.K.KEYX#(IXNUM-2)=KEYX;

   4819  2 001054   200022 720100                    LXL0    KEYX,,AUTO
         2 001055   477777 440111                    SXL0    -1,X1,PR4

      268     4820    4                   END;

   4820  2 001056   001123 710000 2                  TRA     s:4827

      269     4821    3           ELSE
      270     4822    3               IF (RS.DEF.DORD=2 AND ~FITALTKEYS.K.UNIQUE(IXNUM-1)) OR

   4822  2 001057   200011 473500                    LDP3    RS$,,AUTO
         2 001060   300000 236100                    LDQ     0,,PR3
         2 001061   600000 376007                    ANQ     -65536,DL
         2 001062   400000 116007                    CMPQ    -131072,DL
         2 001063   001074 601000 2                  TNZ     s:4822+13
         2 001064   200021 236100                    LDQ     IXNUM,,AUTO
         2 001065   000006 402007                    MPY     6,DL
         2 001066   200024 474500                    LDP4    ALTKEYS$,,AUTO
         2 001067   477776 236106                    LDQ     -2,QL,PR4
         2 001070   000011 736000                    QLS     9
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:48   
         2 001071   400000 376003                    ANQ     -131072,DU
         2 001072   400000 676003                    ERQ     -131072,DU
         2 001073   001152 601000 2                  TNZ     ER_INIT
         2 001074   300000 236100                    LDQ     0,,PR3
         2 001075   600000 376007                    ANQ     -65536,DL
         2 001076   600000 116007                    CMPQ    -65536,DL
         2 001077   001106 601000 2                  TNZ     s:4822+23
         2 001100   200021 236100                    LDQ     IXNUM,,AUTO
         2 001101   000006 402007                    MPY     6,DL
         2 001102   200024 474500                    LDP4    ALTKEYS$,,AUTO
         2 001103   477776 236106                    LDQ     -2,QL,PR4
         2 001104   000400 316003                    CANQ    256,DU
         2 001105   001152 601000 2                  TNZ     ER_INIT
         2 001106   200021 236100                    LDQ     IXNUM,,AUTO
         2 001107   000006 402007                    MPY     6,DL
         2 001110   200024 474500                    LDP4    ALTKEYS$,,AUTO
         2 001111   477773 236106                    LDQ     -5,QL,PR4
         2 001112   000033 772000                    QRL     27
         2 001113   200023 116100                    CMPQ    KEYL,,AUTO
         2 001114   001152 601000 2                  TNZ     ER_INIT
         2 001115   200021 236100                    LDQ     IXNUM,,AUTO
         2 001116   000006 402007                    MPY     6,DL
         2 001117   477775 236106                    LDQ     -3,QL,PR4
         2 001120   777777 376007                    ANQ     -1,DL
         2 001121   200022 116100                    CMPQ    KEYX,,AUTO
         2 001122   001152 601000 2                  TNZ     ER_INIT

      271     4823    3                  (RS.DEF.DORD=3 AND FITALTKEYS.K.UNIQUE(IXNUM-1)) OR
      272     4824    3                  FITALTKEYS.K.KEYL(IXNUM-1)~=KEYL OR
      273     4825    3                  FITALTKEYS.K.KEYX(IXNUM-1)~=KEYX THEN
      274     4826    3                   GOTO ER_INIT;
      275     4827    3           IF IXNUM>IXMAX THEN

   4827  2 001123   200017 236100                    LDQ     IXMAX,,AUTO
         2 001124   200021 116100                    CMPQ    IXNUM,,AUTO
         2 001125   001130 603000 2                  TRC     NEXTRS

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:49   
      276     4828    3               IXMAX=IXNUM;

   4828  2 001126   200021 235100                    LDA     IXNUM,,AUTO
         2 001127   200017 755100                    STA     IXMAX,,AUTO

      277     4829    3   NEXTRS: END;

   4829  2 001130   200011 470500       NEXTRS       LDP0    RS$,,AUTO
         2 001131   000002 720100                    LXL0    2,,PR0
         2 001132   000732 601000 2                  TNZ     s:4795

      278     4830    2       IF INITFLAG THEN

   4830  2 001133   200020 234100                    SZN     INITFLAG,,AUTO
         2 001134   001142 605000 2                  TPL     s:4833

      279     4831    2           VLP$ALTKEYS.SIZ#=IXMAX-1;

   4831  2 001135   200024 471500                    LDP1    ALTKEYS$,,AUTO
         2 001136   200017 235100                    LDA     IXMAX,,AUTO
         2 001137   000001 135007                    SBLA    1,DL
         2 001140   100000 755100                    STA     0,,PR1
         2 001141   001150 710000 2                  TRA     s:4835

      280     4832    2       ELSE
      281     4833    2           IF FITALTKEYS.NUMENTS~=IXMAX THEN

   4833  2 001142   200024 471500                    LDP1    ALTKEYS$,,AUTO
         2 001143   100000 236100                    LDQ     0,,PR1
         2 001144   000022 772000                    QRL     18
         2 001145   000377 376007                    ANQ     255,DL
         2 001146   200017 116100                    CMPQ    IXMAX,,AUTO
         2 001147   001152 601000 2                  TNZ     ER_INIT

      282     4834    2               GOTO ER_INIT;
      283     4835    2       RETURN;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:50   
   4835  2 001150   200016 221300                    LDX1  ! ERROR+1,,AUTO
         2 001151   000001 702211                    TSX2  ! 1,X1

      284     4836    2   ER_INIT: ERROR=ERR#IO#ARNAF;

   4836  2 001152   210713 235007       ER_INIT      LDA     70091,DL
         2 001153   200015 755100                    STA     ERROR,,AUTO

      285     4837    2       GOTO ALT;

   4837  2 001154   001155 710000 2                  TRA     ALT

   4830  2 001155                       ALT          null
      286     4838    2   ALT: ;
      287     4839            %DBALT;

   4840  2 001155   000000 470400 xsym               LDP0    GLOBAL$
         2 001156   000006 235100                    LDA     6,,PR0
         2 001157   001166 601000 2                  TNZ     s:4848

   4842  2 001160   000010 450100                    STZ     8,,PR0

   4843  2 001161   000012 450100                    STZ     10,,PR0

   4844  2 001162   000013 450100                    STZ     11,,PR0

   4845  2 001163   000011 450100                    STZ     9,,PR0

   4846  2 001164   200015 236100                    LDQ     ERROR,,AUTO
         2 001165   000006 756100                    STQ     6,,PR0

   4848  2 001166   000006 235100                    LDA     6,,PR0
         2 001167   303240 115007                    CMPA    100000,DL
         2 001170   001173 603000 2                  TRC     s:4851

   4849  2 001171   200016 221300                    LDX1  ! ERROR+1,,AUTO
         2 001172   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:51   

   4851  2 001173   000000 631400 3                  EPPR1   0
         2 001174   000000 701000 xent               TSX1    ZIB$ERR
         2 001175   000000 011000                    NOP     0

      288     4853    2   END ZIM$ICHECK;

   4853  2 001176   200016 221300                    LDX1  ! ERROR+1,,AUTO
         2 001177   000001 702211                    TSX2  ! 1,X1

      289     4854    1   END ZIO$DBOPEN;

   4854  2 001200   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   040040 040040   040040 040040   000520 000000   111104 123062            ....IDS2

(unnamed)
 Sect OctLoc
   3     000   000000 000000   040040 040040   777775 777777   777717 777777    ....    ........
   3     004   771777 777777   776777 777777   777577 777777   477777 777777    ................
   3     010   777677 777777   000000 006003   000000 006014   377777 777777    ................
      290     4855        %EOD;

PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:52   
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$DBOPEN.

   Procedure ZIO$DBOPEN requires 641 words for executable code.
   Procedure ZIO$DBOPEN requires 24 words of local(AUTO) storage.
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:54   
          MINI XREF LISTING

AC.ACRAN
      2536**DCL      4785>>ASSIGN
AC.ANAM
      2605**DCL      3990--ASSIGN   3991>>ASSIGN
AC.DBLIM.IHIGHDBK
      2556**DCL      4038>>ASSIGN
AC.DEF.ANL
      2534**DCL      2605--IMP-SIZ  3990>>ASSIGN   3991>>ASSIGN
AC.DEF.ATMP
      2533**DCL      4031>>IF
AC.DEF.FORG
      2521**DCL      2525--REDEF
AC.DEF.ORG.INDEXED
      2527**DCL      4035>>ASSIGN   4036>>ASSIGN
AC.DEF.ORG.KEYED
      2528**DCL      4036>>ASSIGN
AC.FLAGS.CHKSUM
      2565**DCL      3996>>ASSIGN
AC.FLAGS.CJRNL
      2567**DCL      3999>>ASSIGN
AC.FLAGS.ENCRP
      2566**DCL      4027>>IF
AC.FLAGS.TJRNL
      2569**DCL      3997>>ASSIGN
AC.FLAGS.TMPLT
      2568**DCL      3998>>ASSIGN   4314>>IF
AC.IFIPN
      2576**DCL      4039>>ASSIGN
AC.INCHA
      2571**DCL      4040>>ASSIGN
AC.PGLIM.IHIGHPG
      2553**DCL      4037>>ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:55   
AC.SANAM.EIS.COUNT
      2550**DCL      3992>>ASSIGN   4295>>IF
AC.SANAM.EIS.OFFSET.WD
      2546**DCL      3993>>ASSIGN   4295>>IF
AC$
      2517**DCL      2518--IMP-PTR  3972<<ASSIGN   3990>>ASSIGN   3990>>ASSIGN   3991>>ASSIGN   3991>>ASSIGN
      3992>>ASSIGN   3993>>ASSIGN   3996>>ASSIGN   3997>>ASSIGN   3998>>ASSIGN   3999>>ASSIGN   4027>>IF
      4031>>IF       4035>>ASSIGN   4036>>ASSIGN   4036>>ASSIGN   4037>>ASSIGN   4038>>ASSIGN   4039>>ASSIGN
      4040>>ASSIGN   4295>>IF       4295>>IF       4314>>IF       4785>>ASSIGN
ALT
      4069**LABEL    4044--CALLALT  4073--GOTO     4077--CALLALT  4079--GOTO
ALT IN PROCEDURE ZIM$DBRAB
      4348**LABEL    4309--CALLALT  4333--GOTO     4336--GOTO     4338--GOTO     4340--GOTO     4342--GOTO
      4344--GOTO     4346--GOTO
ALT IN PROCEDURE ZIM$ICHECK
      4830**LABEL    4837--GOTO
ALTKEYS$ IN PROCEDURE ZIM$ICHECK
      4780**DCL      4377--IMP-PTR  4769--IMP-PTR  4789<<ASSIGN   4791<<ASSIGN   4815>>ASSIGN   4817>>ASSIGN
      4818>>ASSIGN   4819>>ASSIGN   4822>>IF       4822>>IF       4822>>IF       4822>>IF       4831>>ASSIGN
      4833>>IF
ATBLK$ IN PROCEDURE ZIM$DBRAB
      4201**DCL      4202--IMP-PTR  4281<<ASSIGN   4282>>IF       4290>>IF       4295>>IF       4298>>IF
      4300>>IF       4306>>ASSIGN   4307>>ASSIGN   4308>>ASSIGN   4312>>IF       4316>>ASSIGN   4317>>ASSIGN
      4318>>ASSIGN   4319>>ASSIGN   4325>>IF       4325>>IF       4325>>IF
ATBLK_PG.AREA_NM IN PROCEDURE ZIM$DBRAB
      4227**DCL      4228--REDEF    4290>>IF       4295>>IF
ATBLK_PG.FIR_INV_PGNO IN PROCEDURE ZIM$DBRAB
      4224**DCL      4318>>ASSIGN   4325>>IF
ATBLK_PG.HIGH_DBK IN PROCEDURE ZIM$DBRAB
      4226**DCL      4317>>ASSIGN   4325>>IF
ATBLK_PG.IDS_HDR IN PROCEDURE ZIM$DBRAB
      4207**DCL      4282>>IF
ATBLK_PG.NUM_DBPG IN PROCEDURE ZIM$DBRAB
      4209**DCL      4316>>ASSIGN   4325>>IF
ATBLK_PG.REASON_LOCKED.LOAD_MODE IN PROCEDURE ZIM$DBRAB
      4250**DCL      4308<<ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:56   
ATBLK_PG.STATUS IN PROCEDURE ZIM$DBRAB
      4236**DCL      4244--REDEF
ATBLK_PG.STATUS.KFILE_CURR IN PROCEDURE ZIM$DBRAB
      4239**DCL      4307<<ASSIGN   4312>>IF
ATBLK_PG.STATUS.LOCKED IN PROCEDURE ZIM$DBRAB
      4237**DCL      4298>>IF
ATBLK_PG.STATUS.LOCKUPD IN PROCEDURE ZIM$DBRAB
      4238**DCL      4300>>IF
ATBLK_PG.TIME_LOCKED IN PROCEDURE ZIM$DBRAB
      4247**DCL      4306<<ASSIGN
ATBLK_PG.TOT_CALC_HDRS IN PROCEDURE ZIM$DBRAB
      4223**DCL      4319>>ASSIGN
AWS
      1927**DCL      3974<<ASSIGN
AWS.ATRIB.ATMP
      1939**DCL      4032<<ASSIGN   4034<<ASSIGN   4041>>IF       4049>>IF       4069>>IF
AWS.ATRIB.CANSSS
      1938**DCL      4002<<ASSIGN   4011<<ASSIGN   4046>>IF
AWS.ATRIB.CHKSUM
      1934**DCL      3996<<ASSIGN   4285>>IF
AWS.ATRIB.CJRNL
      1931**DCL      3999<<ASSIGN
AWS.ATRIB.FUN
      1940**DCL      4004<<ASSIGN   4015<<ASSIGN   4021<<ASSIGN   4300>>IF
AWS.ATRIB.INDEXED
      1941**DCL      4035<<ASSIGN   4041>>IF       4048>>IF
AWS.ATRIB.KEYED
      1942**DCL      4036<<ASSIGN   4303>>IF       4312>>IF
AWS.ATRIB.LOAD
      1943**DCL      4003<<ASSIGN   4012<<ASSIGN   4303>>IF
AWS.ATRIB.SHANY
      1936**DCL      4006<<ASSIGN   4026<<ASSIGN
AWS.ATRIB.SHARE
      1935**DCL      4005<<ASSIGN   4025<<ASSIGN
AWS.ATRIB.TJRNL
      1933**DCL      3997<<ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:57   
AWS.ATRIB.TMPLT
      1932**DCL      3998<<ASSIGN
AWS.DDCB
      1952**DCL      4791--ASSIGN
AWS.ENCRP
      1954**DCL      4007<<ASSIGN   4029<<ASSIGN
AWS.FIPN
      1951**DCL      4039<<ASSIGN   4318<<ASSIGN   4325>>IF
AWS.HIGHDBK
      1949**DCL      4038<<ASSIGN   4317<<ASSIGN   4325>>IF
AWS.HIGHPG
      1950**DCL      4037<<ASSIGN   4316<<ASSIGN   4325>>IF
AWS.NCHA
      1948**DCL      4040<<ASSIGN   4319<<ASSIGN
AWS$
      1926**DCL      1927--IMP-PTR  3973<<ASSIGN   3974>>ASSIGN   3996>>ASSIGN   3997>>ASSIGN   3998>>ASSIGN
      3999>>ASSIGN   4002>>ASSIGN   4003>>ASSIGN   4004>>ASSIGN   4005>>ASSIGN   4006>>ASSIGN   4007>>ASSIGN
      4011>>ASSIGN   4012>>ASSIGN   4015>>ASSIGN   4021>>ASSIGN   4025>>ASSIGN   4026>>ASSIGN   4029>>ASSIGN
      4032>>ASSIGN   4034>>ASSIGN   4035>>ASSIGN   4036>>ASSIGN   4037>>ASSIGN   4038>>ASSIGN   4039>>ASSIGN
      4040>>ASSIGN   4041>>IF       4041>>IF       4043>>ASSIGN   4046>>IF       4048>>IF       4049>>IF
      4069>>IF       4285>>IF       4300>>IF       4303>>IF       4303>>IF       4312>>IF       4316>>ASSIGN
      4317>>ASSIGN   4318>>ASSIGN   4319>>ASSIGN   4325>>IF       4325>>IF       4325>>IF       4791>>ASSIGN
B$ROS$ IN PROCEDURE ZIM$ICHECK
      4774**DCL      4791>>ASSIGN
CD.CDSH
      2751**DCL      4805>>ASSIGN
CD.DEF.SYNC
      2743**DCL      4802>>DOWHILE
CD.RSCDN
      2749**DCL      4803>>ASSIGN
CD$
      2739**DCL      2740--IMP-PTR  4801<<ASSIGN   4802>>DOWHILE  4803<<ASSIGN   4803>>ASSIGN   4805>>ASSIGN
COM IN PROCEDURE ZIM$ICHECK
      4785**LABEL    4782--GOTO
DBCB.CSECT.SSACCT
      1454**DCL      3989>>ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:58   
DBCB.IOWS.ACOPN
      1842**DCL      3972>>ASSIGN
DBCB.IOWS.CFCT
      1877**DCL      1878--REDEF
DBCB.IOWS.DBKF.RQ
      1820**DCL      1821--REDEF
DBCB.IOWS.DBKR
      1817**DCL      1818--REDEF
DBCB.IOWS.NOBF
      1879**DCL      1880--REDEF
DBCB.IOWS.SPND
      1805**DCL      1806--REDEF
DBCB.SWS.RDYCW
      1543**DCL      1544--REDEF
DBCB.SWS.TEMP.INAFLAG
      1579**DCL      4031>>IF
DBCB.SWS.TEMP.PTR1$
      1577**DCL      1578--REDEF    1579--REDEF
DBCB.SWS.TEMP.PTR2$
      1580**DCL      1581--REDEF
DBCB$
      1448**DCL      1449--IMP-PTR  3970<<ASSIGN   3972>>ASSIGN   3989>>ASSIGN   4031>>IF
ERROR
      3968**DCL      3969<<ASSIGN   4072<<ASSIGN   4078<<ASSIGN   4088>>ASSIGN   4332<<ASSIGN   4335<<ASSIGN
      4337<<ASSIGN   4339<<ASSIGN   4341<<ASSIGN   4343<<ASSIGN   4345<<ASSIGN   4356>>ASSIGN   4836<<ASSIGN
      4846>>ASSIGN
ERR_INVAREA IN PROCEDURE ZIM$DBRAB
      4345**LABEL    4328--GOTO
ER_AREA IN PROCEDURE ZIM$DBRAB
      4337**LABEL    4291--GOTO     4297--GOTO
ER_ATTR
      4069**LABEL    4067--CALLALT
ER_CHECK
      4069**LABEL    4070--CALLALT
ER_CKSM IN PROCEDURE ZIM$DBRAB
      4335**LABEL    4288--GOTO
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:59   
ER_CRPT IN PROCEDURE ZIM$DBRAB
      4332**LABEL    4283--GOTO
ER_ENCRP
      4072**LABEL    4028--GOTO
ER_INI
      4069**LABEL    4054--CALLALT  4057--GOTO
ER_INIT IN PROCEDURE ZIM$ICHECK
      4836**LABEL    4826--GOTO     4834--GOTO
ER_LOCKED IN PROCEDURE ZIM$DBRAB
      4339**LABEL    4299--GOTO
ER_LOCKUPD IN PROCEDURE ZIM$DBRAB
      4341**LABEL    4302--GOTO
ER_NAME
      4078**LABEL    3982--GOTO
ER_RBLDKYS IN PROCEDURE ZIM$DBRAB
      4343**LABEL    4313--GOTO
ER_READ IN PROCEDURE ZIM$DBRAB
      4336**LABEL    4280--CALLALT
F$DCB.ACTPOS IN PROCEDURE ZIM$ICHECK
      4523**DCL      4523--REDEF
F$DCB.ALTKEYX IN PROCEDURE ZIM$ICHECK
      4522**DCL      4791>>ASSIGN
F$DCB.ARS# IN PROCEDURE ZIM$ICHECK
      4497**DCL      4497--REDEF
F$DCB.ATTR IN PROCEDURE ZIM$ICHECK
      4516**DCL      4517--REDEF
F$DCB.BORROW IN PROCEDURE ZIM$ICHECK
      4531**DCL      4531--REDEF    4531--REDEF    4531--REDEF
F$DCB.DCBNAME.L IN PROCEDURE ZIM$ICHECK
      4545**DCL      4545--IMP-SIZ
F$DCB.EOMCHAR# IN PROCEDURE ZIM$ICHECK
      4501**DCL      4501--REDEF
F$DCB.FLDID IN PROCEDURE ZIM$ICHECK
      4526**DCL      4526--REDEF
F$DCB.FORM$ IN PROCEDURE ZIM$ICHECK
      4520**DCL      4520--REDEF
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:60   
F$DCB.FSECT IN PROCEDURE ZIM$ICHECK
      4536**DCL      4536--REDEF
F$DCB.FSN# IN PROCEDURE ZIM$ICHECK
      4513**DCL      4513--REDEF    4513--REDEF    4514--REDEF
F$DCB.HEADER$ IN PROCEDURE ZIM$ICHECK
      4519**DCL      4519--REDEF
F$DCB.IXTNSIZE# IN PROCEDURE ZIM$ICHECK
      4517**DCL      4517--REDEF
F$DCB.LASTSTA$ IN PROCEDURE ZIM$ICHECK
      4506**DCL      4506--REDEF
F$DCB.LVL IN PROCEDURE ZIM$ICHECK
      4532**DCL      4532--REDEF
F$DCB.NAME#.C IN PROCEDURE ZIM$ICHECK
      4507**DCL      4507--REDEF
F$DCB.NOEOF IN PROCEDURE ZIM$ICHECK
      4529**DCL      4529--REDEF
F$DCB.NRECS# IN PROCEDURE ZIM$ICHECK
      4518**DCL      4518--REDEF
F$DCB.NRECX IN PROCEDURE ZIM$ICHECK
      4537**DCL      4537--REDEF
F$DCB.OHDR IN PROCEDURE ZIM$ICHECK
      4529**DCL      4529--REDEF
F$DCB.ORG# IN PROCEDURE ZIM$ICHECK
      4512**DCL      4512--REDEF
F$DCB.PRECNO IN PROCEDURE ZIM$ICHECK
      4535**DCL      4535--REDEF
F$DCB.RCSZ IN PROCEDURE ZIM$ICHECK
      4541**DCL      4541--REDEF
F$DCB.RES# IN PROCEDURE ZIM$ICHECK
      4508**DCL      4508--REDEF
F$DCB.SETX IN PROCEDURE ZIM$ICHECK
      4520**DCL      4520--REDEF
F$DCB.TAB$ IN PROCEDURE ZIM$ICHECK
      4520**DCL      4520--REDEF
F$DCB.TDA IN PROCEDURE ZIM$ICHECK
      4534**DCL      4535--REDEF
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:61   
F$DCB.WSN# IN PROCEDURE ZIM$ICHECK
      4508**DCL      4508--REDEF
FITALTKEYS.K.KEYL IN PROCEDURE ZIM$ICHECK
      4770**DCL      4822>>IF
FITALTKEYS.K.KEYX IN PROCEDURE ZIM$ICHECK
      4770**DCL      4822>>IF
FITALTKEYS.K.UNIQUE IN PROCEDURE ZIM$ICHECK
      4771**DCL      4822>>IF       4822>>IF
FITALTKEYS.NUMENTS IN PROCEDURE ZIM$ICHECK
      4769**DCL      4833>>IF
FPT$OPEN.ACSVEH_ IN PROCEDURE ZIM$ICHECK
      4448**DCL      4449--REDEF
FPT$OPEN.ALTKEYS_ IN PROCEDURE ZIM$ICHECK
      4454**DCL      4455--REDEF    4455--REDEF
FPT$OPEN.HDR_ IN PROCEDURE ZIM$ICHECK
      4453**DCL      4454--REDEF
FPT$OPEN.TAB_ IN PROCEDURE ZIM$ICHECK
      4452**DCL      4453--REDEF
FPT$OPEN.UHL_ IN PROCEDURE ZIM$ICHECK
      4446**DCL      4447--REDEF    4447--REDEF
FPT$OPEN.V.FSN# IN PROCEDURE ZIM$ICHECK
      4486**DCL      4486--REDEF    4486--REDEF
FPT$OPEN.V.KEYL# IN PROCEDURE ZIM$ICHECK
      4471**DCL      4810<<ASSIGN
FPT$OPEN.V.KEYX# IN PROCEDURE ZIM$ICHECK
      4470**DCL      4811<<ASSIGN
FPT$OPEN.WSN_ IN PROCEDURE ZIM$ICHECK
      4452**DCL      4452--REDEF
FPT$TIME IN PROCEDURE ZIM$DBRAB
      4267**DCL      4305<>CALL
FR.FNL
      2795**DCL      2799--IMP-SIZ
FR.ROFST.EIS.OFFSET
      2776**DCL      4807>>ASSIGN
FR.UOFST.EIS.OFFSET
      2785**DCL      2788--REDEF
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:62   
FR$
      2759**DCL      2760--IMP-PTR  4805<<ASSIGN   4807>>ASSIGN
GLOBAL.ACCT
       721**DCL      3977<<ASSIGN   3989<<ASSIGN
GLOBAL.ACTIVE.DBCB$
       504**DCL       505--REDEF    3970>>ASSIGN
GLOBAL.ACTIVE.DBNO
       508**DCL      3975>>IF       4289>>IF
GLOBAL.ACTIVE.SSS$
       500**DCL       501--REDEF    3971>>ASSIGN
GLOBAL.ALTKEYS$
       793**DCL      4789>>ASSIGN
GLOBAL.CANSSS$
       509**DCL      4000>>IF
GLOBAL.DB.FLAGS.SYSSUB
       600**DCL      3975>>IF       4289>>IF
GLOBAL.DCBNAME
       718**DCL      3985>>ASSIGN
GLOBAL.DCBNAME.LENGTH
       719**DCL      3978<<ASSIGN   3979>>DOWHILE  3980<<ASSIGN   3980>>ASSIGN   3981>>IF       3990<<ASSIGN
GLOBAL.DCBNAME.TEXT
       720**DCL      3984<<ASSIGN   3991<<ASSIGN
GLOBAL.ENCRP
       729**DCL      4027>>IF       4029>>ASSIGN
GLOBAL.FILENAME
       715**DCL      3985<<ASSIGN
GLOBAL.FILENAME.LENGTH
       716**DCL      3992<<ASSIGN
GLOBAL.FILENAME.TEXT
       717**DCL      3993<<ASSIGN
GLOBAL.KEY
       708**DCL       711--REDEF
GLOBAL.OPEN$
       755**DCL      4810>>ASSIGN   4811>>ASSIGN
GLOBAL.PARAN.ICKSM.P$
       551**DCL      4286>>IF
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:63   
GLOBAL.PARAN.ICKSM.V
       552**DCL      4286>>IF
GLOBAL.PARAN.IO.AWS$
       547**DCL      3973>>ASSIGN   4043<<ASSIGN
GLOBAL.PARAN.IO.BUF$
       549**DCL      4281>>ASSIGN
GLOBAL.PARAN.IO.PGNO
       548**DCL      4279<<ASSIGN
GLOBAL.PARAN.TRACE.MODE
       583**DCL       590--REDEF
GLOBAL.PENDING.SHANY
       538**DCL      4016>>IF       4022>>IF       4026>>ASSIGN
GLOBAL.PENDING.SHARE
       533**DCL      4017<<ASSIGN   4023<<ASSIGN   4025>>ASSIGN
GLOBAL.PRINTBUF.BUFFER
       742**DCL       743--REDEF     744--REDEF     745--REDEF
GLOBAL.PRINTBUF.ERR.V
       747**DCL       750--REDEF     751--REDEF     752--REDEF
GLOBAL.RET.AC#
       520**DCL      4084<<ASSIGN   4352<<ASSIGN   4842<<ASSIGN
GLOBAL.RET.ERROR#
       518**DCL      4055>>IF       4082>>IF       4088<<ASSIGN   4090>>IF       4350>>IF       4356<<ASSIGN
      4358>>IF       4840>>IF       4846<<ASSIGN   4848>>IF
GLOBAL.RET.FR#
       521**DCL      4087<<ASSIGN   4355<<ASSIGN   4845<<ASSIGN
GLOBAL.RET.RC#
       523**DCL      4086<<ASSIGN   4354<<ASSIGN   4844<<ASSIGN
GLOBAL.RET.SC#
       522**DCL      4085<<ASSIGN   4353<<ASSIGN   4843<<ASSIGN
GLOBAL.TIME.TSTAMP
       731**DCL      4306>>ASSIGN
GLOBAL.TIME$
       780**DCL      4305>>CALL
GLOBAL$
       802**DCL       498--IMP-PTR  3970>>ASSIGN   3971>>ASSIGN   3973>>ASSIGN   3975>>IF       3975>>IF
      3977>>ASSIGN   3978>>ASSIGN   3979>>DOWHILE  3980>>ASSIGN   3980>>ASSIGN   3981>>IF       3984>>ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:64   
      3985>>ASSIGN   3985>>ASSIGN   3989>>ASSIGN   3990>>ASSIGN   3991>>ASSIGN   3992>>ASSIGN   3993>>ASSIGN
      4000>>IF       4016>>IF       4017>>ASSIGN   4022>>IF       4023>>ASSIGN   4025>>ASSIGN   4026>>ASSIGN
      4027>>IF       4029>>ASSIGN   4043>>ASSIGN   4055>>IF       4082>>IF       4084>>ASSIGN   4085>>ASSIGN
      4086>>ASSIGN   4087>>ASSIGN   4088>>ASSIGN   4090>>IF       4279>>ASSIGN   4281>>ASSIGN   4286>>IF
      4286>>IF       4289>>IF       4289>>IF       4305>>CALL     4306>>ASSIGN   4350>>IF       4352>>ASSIGN
      4353>>ASSIGN   4354>>ASSIGN   4355>>ASSIGN   4356>>ASSIGN   4358>>IF       4789>>ASSIGN   4810>>ASSIGN
      4811>>ASSIGN   4840>>IF       4842>>ASSIGN   4843>>ASSIGN   4844>>ASSIGN   4845>>ASSIGN   4846>>ASSIGN
      4848>>IF
IA.SNAME
      2982**DCL      2983--REDEF    3984>>ASSIGN   4290>>IF
IA.SNCHAR
      2983**DCL      3979>>DOWHILE
IA.SSDT
      2994**DCL      2995--REDEF
IA.SSNAME
      2985**DCL      2986--REDEF
IA$
      2996**DCL      2961--IMP-PTR  3979>>DOWHILE  3984>>ASSIGN   4290>>IF
INITFLAG IN PROCEDURE ZIM$ICHECK
      4776**DCL      4781<<ASSIGN   4784<<ASSIGN   4788>>IF       4808>>IF       4830>>IF
IXMAX IN PROCEDURE ZIM$ICHECK
      4775**DCL      4787<<ASSIGN   4827>>IF       4828<<ASSIGN   4831>>ASSIGN   4833>>IF
IXNUM IN PROCEDURE ZIM$ICHECK
      4777**DCL      4798<<ASSIGN   4815>>ASSIGN   4817>>ASSIGN   4818>>ASSIGN   4819>>ASSIGN   4822>>IF
      4822>>IF       4822>>IF       4822>>IF       4827>>IF       4828>>ASSIGN
KEYL IN PROCEDURE ZIM$ICHECK
      4779**DCL      4800<<ASSIGN   4810>>ASSIGN   4818>>ASSIGN   4822>>IF
KEYX IN PROCEDURE ZIM$ICHECK
      4778**DCL      4807<<ASSIGN   4811>>ASSIGN   4819>>ASSIGN   4822>>IF
M$TIME
      3092**DCL-ENT  4305--CALL
NEXTRS IN PROCEDURE ZIM$ICHECK
      4829**LABEL    4797--GOTO
ONEWORD IN PROCEDURE ZIM$DBRAB
      4277**DCL      4286>>IF
RA.PGRNG.IHIGHDBK
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:65   
      2624**DCL      2625--REDEF
RA.RCRAH
      2620**DCL      4786>>ASSIGN
RA$
      2611**DCL      2612--IMP-PTR  4785<<ASSIGN   4786>>ASSIGN
RC.DEF.RNL
      2648**DCL      2658--IMP-SIZ
RC$
      2632**DCL      2633--IMP-PTR  4786<<ASSIGN   4793>>ASSIGN
RCW
      3007**DCL      4013>>IF
RCW.HW0.LOAD
      3010**DCL      4012>>ASSIGN
RS.DEF.DORD
      2675**DCL      4814>>IF       4822>>IF       4822>>IF
RS.DEF.IXNUM
      2682**DCL      4798>>ASSIGN
RS.DEF.TYPE
      2666**DCL      4796>>IF
RS.DEF.VIA
      2669**DCL      4809>>IF
RS.NPOS
      2689**DCL      2698--REDEF
RS.RCRSN
      2686**DCL      4794>>DOWHILE  4795>>ASSIGN
RS.RSCDN
      2683**DCL      4801>>ASSIGN
RS.SCRSH
      2688**DCL      4799>>ASSIGN
RS$
      2663**DCL      2664--IMP-PTR  4793<<ASSIGN   4794>>DOWHILE  4795<<ASSIGN   4795>>ASSIGN   4796>>IF
      4798>>ASSIGN   4799>>ASSIGN   4801>>ASSIGN   4809>>IF       4814>>IF       4822>>IF       4822>>IF
SANAME
      2606**DCL      3993>>ASSIGN   4295>>IF
SC1
      2805**DCL      4799--ASSIGN
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:66   
SC1.KLNG
      2807**DCL      4800>>ASSIGN
SC1$
      2804**DCL      2805--IMP-PTR  4799<<ASSIGN   4800>>ASSIGN
SSS$
      1972**DCL      3971<<ASSIGN   3972>>ASSIGN   3993>>ASSIGN   4000>>IF       4295>>IF       4785>>ASSIGN
      4786>>ASSIGN   4795>>ASSIGN   4799>>ASSIGN   4801>>ASSIGN   4803>>ASSIGN   4805>>ASSIGN
VLP$
      3967**DCL      4012>>ASSIGN   4013>>IF
VLP$ALTKEYS.K.KEYL# IN PROCEDURE ZIM$ICHECK
      4378**DCL      4818<<ASSIGN
VLP$ALTKEYS.K.KEYX# IN PROCEDURE ZIM$ICHECK
      4378**DCL      4819<<ASSIGN
VLP$ALTKEYS.K.UNIQUE# IN PROCEDURE ZIM$ICHECK
      4377**DCL      4815<<ASSIGN   4817<<ASSIGN
VLP$ALTKEYS.SIZ# IN PROCEDURE ZIM$ICHECK
      4377**DCL      4831<<ASSIGN
ZIB$DBINI
      3963**DCL-ENT  4054--CALL
ZIB$ERR
       803**DCL-ENT  4093--CALL     4361--CALL     4851--CALL
ZIM$DBRAB
      4096**PROC     4067--CALL
ZIM$ICHECK
      4365**PROC     4070--CALL
ZIM$IINIT IN PROCEDURE ZIM$ICHECK
      4783**ENTRY    4042--CALL
ZIM$JBEGIN
      3966**DCL-ENT  4047--CALL
ZIM$OPEN
      3965**DCL-ENT  4044--CALL
ZIO$DBCLOSE
      3964**DCL-ENT  4077--CALL
ZIO$DBREAD IN PROCEDURE ZIM$DBRAB
      4275**DCL-ENT  4280--CALL
ZIO$MODIFY IN PROCEDURE ZIM$DBRAB
PL6.E3A0      #001=ZIO$DBOPEN File=ZIM$OPEN.:ZIC0TSI                             FRI 09/05/97 13:03 Page:67   
      4276**DCL-ENT  4309--CALL

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:68   
      291        1        /*M*     ZIM$OPEN - Opens the area           */
      292        2        /*T***********************************************************/
      293        3        /*T*                                                         */
      294        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      295        5        /*T*                                                         */
      296        6        /*T***********************************************************/
      297        7        ZIM$OPEN: PROC ALTRET
      298        8         /* USE ($PR5 FOR GLOBAL$) */
      299        9               AVOID ($PR5,$PR6,$PR7);
      300       10    1   DCL FPT$ PTR;
      301       11    1   DCL B$TCB$ PTR SYMREF;
      302       12    1   DCL F$DCB$ PTR;
      303       13    1   DCL IDSSCHEMA CHAR(2) CONSTANT INIT('1I');
      304       14    1   DCL ERROR UBIN(36);
      305       15        %INCLUDE CP_6;
      306       96         %B$TCB;
      307       99         %B$ALT;
      308      107        %INCLUDE CP_6_SUBS;
      309      647        %F$DCB;
      310      704        %FPT_GETDCB (FPTN=FPT$GETDCB,STCLASS="BASED");
      311      719        %FPT_OPEN (FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      312      828        %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      313      937        %FPT_OPEN(FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      314     1046        %FPT_ENQ(FPTN=FPT$ENQS,STCLASS=BASED);
      315     1064        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      316     1106        %FPT_RELDCB(FPTN=FPT$RELDCB,STCLASS=BASED);
      317     1120        %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS=BASED);
      318     1135        %VLP_SN(FPTN=VLP_SN,N=1,SN='      ',STCLASS=AUTO);
      319     1148        %INCLUDE ZI$GLOBAL;
      320     1634        %GLOBALS;
      321     1942        %INCLUDE ZI$DBCB;
      322     2584        %AWS;
      323     2624        %INCLUDE ZI_ERRORS_C;
      324     2950        %INCLUDE B_ERRORS_C;
      325     4077        %SUB ALTF#SUFFIX=':';
      326     4078        %EJECT;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:69   
      327     4079    1       AWS$=GLOBAL.PARAN.IO.AWS$;
      328     4080    1       IF AWS.DDCB~=0 THEN
      329     4081    1           GOTO ER_AIR;
      330     4082    1       IF ( GLOBAL.DCBNAME.LENGTH > 31 )
      331     4083    1       THEN
      332     4084    1           GLOBAL.DCBNAME.LENGTH = 31;
      333     4085    1       GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;
      334     4086    1       CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_DDCB);
      335     4087    2       IF GLOBAL.DCBNUMBER=0 THEN DO;
      336     4088    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;
      337     4089    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_DDCB);
      338     4090    2           FPT$=GLOBAL.OPNDFLT$;
      339     4091    2           FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;
      340     4092    2           FPT$OPNDFLT.V.ASN#=%FILE#;
      341     4093    2           FPT$OPNDFLT.V.SHARE#=0;
      342     4094        /*             File name and account already set up. */
      343     4095    2           CALL M$OPEN(FPT$OPNDFLT) ALTRET(ER_DFLT);
      344     4096    2           END;
      345     4097    1       FPT$=GLOBAL.OPEN$;
      346     4098    1       FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;
      347     4099    1       FPT$OPEN.V.ASN#=%FILE#;
      348     4100    1       FPT$OPEN.V.ACS#=%DIRECT#;
      349     4101    2       IF AWS.ATRIB.ATMP THEN DO;
      350     4102    2           AWS.ATRIB.CJRNL=%NO#;
      351     4103    2           AWS.ATRIB.SHARE=%NONE#;
      352     4104    2           AWS.ATRIB.SHANY=%NO#;
      353     4105    2           AWS.ATRIB.FUN=%CREATE#;
      354     4106    2           FPT$OPEN.V.DISP#=%SCRATCH#;
      355     4107    2           FPT$OPEN.V.CTG#=%NO#;
      356     4108    2           FPT$OPEN.V.EXIST#=%NEWFILE#;
      357     4109    2           FPT$OPEN.V.TYPE#='II';
      358     4110    3           IF ~AWS.ATRIB.INDEXED THEN DO;
      359     4111    3               FPT$OPEN.V.IXTNSIZE#=AWS.HIGHPG+1;
      360     4112    3               FPT$OPEN.V.XTNSIZE#=0;
      361     4113    3               FPT$OPEN.V.ORG#=%IDS#;
      362     4114    3               FPT$OPEN.ALTKEYS_=VECTOR(GLOBAL.ALTKEYS$->VLP$ALTKEYS);
      363     4115    3               END;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:70   
      364     4116    3           ELSE DO;
      365     4117    3               FPT$OPEN.V.IXTNSIZE#=GLOBAL.ALTKEYS$->VLP$ALTKEYS.SIZ#;
      366     4118    3               FPT$OPEN.V.XTNSIZE#=GLOBAL.ALTKEYS$->VLP$ALTKEYS.SIZ#;
      367     4119    3               FPT$OPEN.V.ORG#=%INDEXED#;
      368     4120    3               END;
      369     4121    2           END;
      370     4122    1       IF AWS.ATRIB.INDEXED AND AWS.ATRIB.LOAD THEN
      371     4123    1           FPT$OPEN.V.LOAD#=%YES#;
      372     4124    1       ELSE
      373     4125    1           FPT$OPEN.V.LOAD#=%NO#;
      374     4126    1       FPT$OPEN.V.SHARE#=AWS.ATRIB.SHARE;
      375     4127    1       FPT$OPEN.V.FUN#=AWS.ATRIB.FUN;
      376     4128    1       F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);
      377     4129        /*          If program request for currencies only set bit. */
      378     4130    1       IF GLOBAL.PENDING.CURONLY THEN
      379     4131    1           FPT$OPEN.V.UOPT#(1)='1'B;
      380     4132    1       ELSE
      381     4133    1           FPT$OPEN.V.UOPT#(1)='01'B;
      382     4134    1       CALL M$OPEN(FPT$OPEN)
      383     4135    2       WHENALTRETURN DO;
      384     4136    2           FPT$OPEN.ALTKEYS_=VECTOR(NIL);
      385     4137    2           GOTO ER_DOPN;
      386     4138    2           END;
      387     4139    1       FPT$OPEN.ALTKEYS_=VECTOR(NIL);
      388     4140    1       IF NOT AWS.ATRIB.ATMP AND
      389     4141    1          AWS.ATRIB.SHARE=0 AND
      390     4142    1          F$DCB$->F$DCB.UOPT#(0) AND
      391     4143    1          ((F$DCB$->F$DCB.SHARE#=%IN# AND AWS.ATRIB.FUN=%UPDATE#) OR
      392     4144    1          (F$DCB$->F$DCB.SHARE#=%ALL# AND AWS.ATRIB.FUN=%IN#)) THEN
      393     4145    1           AWS.ATRIB.SHANY=%YES#;
      394     4146    1       AWS.ATRIB.SHARE=F$DCB$->F$DCB.SHARE#;
      395     4147    1       AWS.DDCB=GLOBAL.DCBNUMBER;
      396     4148    1       IF AWS.ATRIB.INDEXED AND F$DCB$->F$DCB.ORG#~=%INDEXED# THEN
      397     4149    1           GOTO ER_NOTIDX;
      398     4150    1       IF ~AWS.ATRIB.INDEXED AND F$DCB$->F$DCB.ORG#~=%IDS# THEN
      399     4151    1           GOTO ER_NOTIDS;
      400     4152    1       IF F$DCB$->F$DCB.FUN#=%IN# THEN
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:71   
      401     4153    2       DO;
      402     4154    2           IF ~F$DCB$->F$DCB.FFLG.READ# THEN
      403     4155    2               GOTO ER_ACCESS;
      404     4156    2           AWS.ATRIB.TJRNL=%NO#;
      405     4157    2           AWS.ATRIB.CJRNL=%NO#;
      406     4158    2           IF AWS.ATRIB.SHANY THEN
      407     4159    3           DO;
      408     4160    3               AWS.ATRIB.CAC=%NO#;
      409     4161    3               GLOBAL.SHANY=GLOBAL.SHANY+1;
      410     4162    3               END;
      411     4163    2           ELSE
      412     4164    2               IF F$DCB$->F$DCB.SHARE#=%ALL# THEN
      413     4165    3               DO;
      414     4166    3                   GLOBAL.ENQS$->FPT$ENQS.V.SHARE#=%ALL#;
      415     4167    3                   GLOBAL.ENQS$->FPT$ENQS.V.DCB#=GLOBAL.DCBNUMBER;
      416     4168    3                   CALL M$ENQ(GLOBAL.ENQS$->FPT$ENQS) ALTRET(ER_ENQIN);
      417     4169    3   CLEAN:          AWS.ATRIB.CAC=%YES#;
      418     4170    3                   END;
      419     4171    2               ELSE
      420     4172    2                   AWS.ATRIB.CAC=%NO#;
      421     4173    2           IF AWS.ATRIB.CAC AND ~AWS.ATRIB.CANSSS AND GLOBAL.UPDATE.NOTJRNL>0 THEN
      422     4174        /*             Can't start CAC if updater not journaling */
      423     4175    2               GOTO ER_JRNL;
      424     4176    2           END;
      425     4177    1       ELSE
      426     4178    2       DO;
      427     4179    2           IF NOT(F$DCB$->F$DCB.FFLG.READ# AND F$DCB$->F$DCB.FFLG.UPD#) THEN
      428     4180    2               GOTO ER_ACCESS;
      429     4181    2           IF F$DCB$->F$DCB.ORG#=%INDEXED# AND
      430     4182    2              NOT(F$DCB$->F$DCB.FFLG.DELR# AND
      431     4183    2              F$DCB$->F$DCB.FFLG.WNEW# AND
      432     4184    2              F$DCB$->F$DCB.FFLG.DELF#) THEN
      433     4185    2               GOTO ER_ACCESS;
      434     4186    2           IF AWS.ATRIB.SHANY THEN
      435     4187    3           DO;
      436     4188    3               GLOBAL.ENQS$->FPT$ENQS.V.SHARE#=%LIMITED#;
      437     4189    3               GLOBAL.ENQS$->FPT$ENQS.V.DCB#=GLOBAL.DCBNUMBER;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:72   
      438     4190    3               CALL M$ENQ(GLOBAL.ENQS$->FPT$ENQS) ALTRET(ER_ENQUP);
      439     4191    3               AWS.ATRIB.CAC=%NO#;
      440     4192    3               GLOBAL.SHANY=GLOBAL.SHANY+1;
      441     4193    3               END;
      442     4194    2           ELSE
      443     4195    3           DO;
      444     4196    3               IF F$DCB$->F$DCB.SHARE#=%NONE# THEN
      445     4197    3                   AWS.ATRIB.CAC=%NO#;
      446     4198    3               ELSE
      447     4199    4               DO;
      448     4200    4                   AWS.ATRIB.CAC=%YES#;
      449     4201    4                   AWS.ATRIB.TJRNL=%YES#;
      450     4202    4                   END;
      451     4203    3               END; /* not input only*/
      452     4204    2           IF ~AWS.ATRIB.TJRNL AND GLOBAL.CAC > 0 THEN
      453     4205        /******                                     ******
      454     4206         *  Updaters must TJRNL if CAC already active    *
      455     4207         ******                                     ******/
      456     4208    2               GOTO ER_JRNL;
      457     4209    2           IF AWS.ATRIB.TJRNL THEN
      458     4210    2               IF GLOBAL.UPDATE.NOTJRNL > 0 THEN
      459     4211    2                   GOTO ER_JRNL;
      460     4212    2               ELSE
      461     4213    2                   GLOBAL.UPDATE.TJRNL = GLOBAL.UPDATE.TJRNL + 1;
      462     4214    2           ELSE
      463     4215    2               IF GLOBAL.UPDATE.TJRNL > 0 THEN
      464     4216    2                   GOTO ER_JRNL;
      465     4217    2               ELSE
      466     4218    2                   GLOBAL.UPDATE.NOTJRNL = GLOBAL.UPDATE.NOTJRNL + 1;
      467     4219    2           END; /*  test journal spec by new user */
      468     4220    1       AWS.ATRIB.CURONLY='0'B; /* ASSUME NOT ENQ CURRENCY */
      469     4221    1       IF AWS.ATRIB.CAC THEN
      470     4222    2       DO;
      471     4223    2           GLOBAL.CAC=GLOBAL.CAC+1;
      472     4224    2           IF GLOBAL.PENDING.CURONLY OR
      473     4225    2              (GLOBAL.PENDING.SHARE=0 AND
      474     4226    2              F$DCB$->F$DCB.UOPT#(1)) THEN
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:73   
      475     4227    2               AWS.ATRIB.CURONLY='1'B;
      476     4228    2           END;
      477     4229    1       IF F$DCB$->F$DCB.ORG#=%IDS# AND F$DCB$->F$DCB.FUN#=%UPDATE# AND
      478     4230    1          AWS.ATRIB.ATMP='0'B AND AWS.ATRIB.TJRNL='0'B AND
      479     4231    1          GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)='0'B THEN
      480     4232    1           AWS.ATRIB.UNPROTECT = '1'B; /* MARK THIS AREA UNPROTECTED */
      481     4233    1       ELSE
      482     4234    1           AWS.ATRIB.UNPROTECT = '0'B;
      483     4235    1       IF AWS.ATRIB.KEYED=%YES# THEN
      484     4236    2       DO;
      485     4237    2           IF GLOBAL.DCBNAME.LENGTH<31 THEN
      486     4238    2               GLOBAL.DCBNAME.LENGTH=GLOBAL.DCBNAME.LENGTH+1;
      487     4239    2           CALL INSERT(GLOBAL.DCBNAME.TEXT,
      488     4240    2              GLOBAL.DCBNAME.LENGTH-1,1,ALTF#SUFFIX);
      489     4241    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;
      490     4242    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_KDCB);
      491     4243    2           GLOBAL.FILENAME.LENGTH=F$DCB$->F$DCB.NAME#.L;
      492     4244    2           GLOBAL.FILENAME.TEXT=F$DCB$->F$DCB.NAME#.C;
      493     4245    2           IF GLOBAL.FILENAME.LENGTH<31 THEN
      494     4246    2               GLOBAL.FILENAME.LENGTH=GLOBAL.FILENAME.LENGTH+1;
      495     4247    2           CALL INSERT(GLOBAL.FILENAME.TEXT,
      496     4248    2              GLOBAL.FILENAME.LENGTH-1,1,ALTF#SUFFIX);
      497     4249    2           GLOBAL.ACCT=F$DCB$->F$DCB.ACCT#;
      498     4250    2           FPT$=GLOBAL.OPNSCRB$;
      499     4251    2           FPT$OPNSCRB.PASS_=VECTOR(F$DCB$->F$DCB.PASS#);
      500     4252    2           VLP_SN.SN#(0)=F$DCB$->F$DCB.PSN#;
      501     4253    2           FPT$OPNSCRB.SN_=VECTOR(VLP_SN);
      502     4254    2           FPT$OPNSCRB.WSN_=VECTOR(F$DCB$->F$DCB.WSN#);
      503     4255    2           FPT$OPNSCRB.V.DCB#=GLOBAL.DCBNUMBER;
      504     4256    2           FPT$OPNSCRB.V.ACS#=%DIRECT#;
      505     4257    2           FPT$OPNSCRB.V.FUN#=F$DCB$->F$DCB.FUN#;
      506     4258    2           FPT$OPNSCRB.V.DISP#=F$DCB$->F$DCB.DISP#;
      507     4259    2           FPT$OPNSCRB.V.EXIST#=F$DCB$->F$DCB.EXIST#;
      508     4260    2           FPT$OPNSCRB.V.ORG#=%KEYED#;
      509     4261    2           FPT$OPNSCRB.V.CTG#=F$DCB$->F$DCB.CTG#;
      510     4262    2           FPT$OPNSCRB.V.EXPIRE#=F$DCB$->F$DCB.EXPIRE#;
      511     4263    2           FPT$OPNSCRB.V.LRDL0#=F$DCB$->F$DCB.LRDL0#;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:74   
      512     4264    2           FPT$OPNSCRB.V.LSLIDE#=F$DCB$->F$DCB.LSLIDE#;
      513     4265    2           FPT$OPNSCRB.V.TYPE#='II';
      514     4266    2           FPT$OPNSCRB.V.IXTNSIZE#=F$DCB$->F$DCB.IXTNSIZE#;
      515     4267    2           FPT$OPNSCRB.V.XTNSIZE#=F$DCB$->F$DCB.XTNSIZE#;
      516     4268    2           FPT$OPNSCRB.V.SHARE#=F$DCB$->F$DCB.SHARE#;
      517     4269    2           CALL M$OPEN(FPT$OPNSCRB)
      518     4270    3           WHENALTRETURN DO;
      519     4271    3               FPT$OPNSCRB.V.EXPIRE#=0;
      520     4272    3               FPT$OPNSCRB.V.LRDL0#=0;
      521     4273    3               FPT$OPNSCRB.V.LSLIDE#=0;
      522     4274    3               FPT$OPNSCRB.V.IXTNSIZE#=0;
      523     4275    3               FPT$OPNSCRB.V.XTNSIZE#=0;
      524     4276    3               FPT$OPNSCRB.PASS_=VECTOR(NIL);
      525     4277    3               FPT$OPNSCRB.SN_=VECTOR(NIL);
      526     4278    3               FPT$OPNSCRB.WSN_=VECTOR(NIL);
      527     4279    3               FPT$OPNSCRB.SN_=VECTOR(NIL);
      528     4280    3               GOTO ER_KOPN;
      529     4281    3               END;
      530     4282    2           FPT$OPNSCRB.V.EXPIRE#=0;
      531     4283    2           FPT$OPNSCRB.V.LRDL0#=0;
      532     4284    2           FPT$OPNSCRB.V.LSLIDE#=0;
      533     4285    2           FPT$OPNSCRB.V.IXTNSIZE#=0;
      534     4286    2           FPT$OPNSCRB.V.XTNSIZE#=0;
      535     4287    2           FPT$OPNSCRB.PASS_=VECTOR(NIL);
      536     4288    2           FPT$OPNSCRB.SN_=VECTOR(NIL);
      537     4289    2           FPT$OPNSCRB.WSN_=VECTOR(NIL);
      538     4290    2           AWS.KDCB=GLOBAL.DCBNUMBER;
      539     4291    2           F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);
      540     4292    2           IF F$DCB$->F$DCB.ORG#~=%KEYED# THEN
      541     4293    2               GOTO ER_NOTKEY;
      542     4294    2           IF F$DCB$->F$DCB.FUN#=%IN# AND ~F$DCB$->F$DCB.FFLG.READ# THEN
      543     4295    2               GOTO ER_KACCESS;
      544     4296    2           IF F$DCB$->F$DCB.FUN#~=%IN# AND NOT(F$DCB$->F$DCB.FFLG.READ# AND
      545     4297    2              F$DCB$->F$DCB.FFLG.DELR# AND F$DCB$->F$DCB.FFLG.WNEW# AND
      546     4298    2              F$DCB$->F$DCB.FFLG.UPD# AND F$DCB$->F$DCB.FFLG.DELF#) THEN
      547     4299    2               GOTO ER_KACCESS;
      548     4300    2           END;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:75   
      549     4301    1       RETURN;
      550     4302        /* Errors that close both files */
      551     4303    1   ER_KACCESS: ERROR=ERR#IO#ACCESS;
      552     4304    1       GOTO KCLOSE;
      553     4305    1   ER_NOTKEY: ERROR=ERR#IO#NOTKEY;
      554     4306    1   KCLOSE: GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.KDCB;
      555     4307    1       CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);
      556     4308    1       AWS.KDCB=0;
      557     4309    1       GOTO DCLOSE;
      558     4310        /* Errors that close the data file */
      559     4311    1   ER_NOTIDS: ERROR=ERR#IO#NOTIDS;
      560     4312    1       GOTO DCLOSE;
      561     4313    1   ER_NOTIDX: ERROR=ERR#IO#NOTIDX;
      562     4314    1       GOTO DCLOSE;
      563     4315    1   ER_ACCESS: ERROR=ERR#IO#ACCESS;
      564     4316    1       GOTO DCLOSE;
      565     4317    1   ER_JRNL: ERROR=ERR#IO#JRNL;
      566     4318    1       GOTO DCLOSE;
      567     4319    1   ER_ENQIN: ;
      568     4320    2       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;
      569     4321    2           GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;
      570     4322    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      571     4323    2           CALL M$ERR;
      572     4324    2           END;
      573     4325    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$TIMELIMIT THEN
      574     4326    1           ERROR=ERR#IO#SHALLIN;
      575     4327    1       ELSE
      576     4328    1           ERROR=ERR#IO#CAC;
      577     4329    1       GOTO DCLOSE;
      578     4330    1   ER_ENQUP: ;
      579     4331    2       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;
      580     4332    2           GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;
      581     4333    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      582     4334    2           CALL M$ERR;
      583     4335    2           END;
      584     4336    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$TIMELIMIT THEN
      585     4337    1           ERROR=ERR#IO#SHALLUP;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:76   
      586     4338    1       ELSE
      587     4339    1           ERROR=ERR#IO#CAC;
      588     4340    1       GOTO DCLOSE;
      589     4341    1   ER_KDCB: ERROR=ERR#IO#GDCB;
      590     4342    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      591     4343    1       GOTO DCLOSE;
      592     4344    1   ER_KOPN: ERROR=ERR#IO#OPNK;
      593     4345    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      594     4346    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      595     4347    1   DCLOSE: GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.DDCB;
      596     4348    1       CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);
      597     4349    1       AWS.DDCB=0;
      598     4350    1       GOTO ALT;
      599     4351        /* Errors that just set error codes */
      600     4352    1   ER_AIR: ERROR=EXC#AIR;
      601     4353    1       GOTO ALT;
      602     4354    1   ER_DDCB: ERROR=ERR#IO#GDCB;
      603     4355    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      604     4356    1       GOTO ALT;
      605     4357    1   ER_DFLT: ERROR=ERR#IO#OPND;
      606     4358    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      607     4359    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      608     4360    1       GOTO ALT;
      609     4361    1   ER_DOPN: IF AWS.ATRIB.INDEXED THEN
      610     4362    1           ERROR=ERR#IO#OPNI;
      611     4363    1       ELSE
      612     4364    1           ERROR=ERR#IO#OPND;
      613     4365    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      614     4366    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      615     4367    1       GOTO ALT;
      616     4368    1   ALT: ;
      617     4369            %DBALT;
      618     4383    1   END ZIM$OPEN;
      619     4384        %EOD;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:77   
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$OPEN.

   Procedure ZIM$OPEN requires 722 words for executable code.
   Procedure ZIM$OPEN requires 14 words of local(AUTO) storage.

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:78   

 Object Unit name= ZIM$OPEN                                   File name= ZIM$OPEN.:ZIC0TOU
 UTS= SEP 05 '97 13:03:43.52 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  ZIM$OPEN
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   722   1322  ZIM$OPEN
    3  RoData even  none    20     24  ZIM$OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      XStd       0  ZIM$OPEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$ERR
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$TCB$                                M$UC                             r    GLOBAL$
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:79   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 NULLSID
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:80   


      291        1        /*M*     ZIM$OPEN - Opens the area           */
      292        2        /*T***********************************************************/
      293        3        /*T*                                                         */
      294        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      295        5        /*T*                                                         */
      296        6        /*T***********************************************************/
      297        7        ZIM$OPEN: PROC ALTRET

      7  2 000000   000000 700200 xent  ZIM$OPEN     TSX0  ! X66_AUTO_0
         2 000001   000016 000000                    ZERO    14,0

      298        8         /* USE ($PR5 FOR GLOBAL$) */
      299        9               AVOID ($PR5,$PR6,$PR7);
      300       10    1   DCL FPT$ PTR;
      301       11    1   DCL B$TCB$ PTR SYMREF;
      302       12    1   DCL F$DCB$ PTR;
      303       13    1   DCL IDSSCHEMA CHAR(2) CONSTANT INIT('1I');
      304       14    1   DCL ERROR UBIN(36);
      305       15        %INCLUDE CP_6;
      306       96         %B$TCB;
      307       99         %B$ALT;
      308      107        %INCLUDE CP_6_SUBS;
      309      647        %F$DCB;
      310      704        %FPT_GETDCB (FPTN=FPT$GETDCB,STCLASS="BASED");
      311      719        %FPT_OPEN (FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      312      828        %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      313      937        %FPT_OPEN(FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      314     1046        %FPT_ENQ(FPTN=FPT$ENQS,STCLASS=BASED);
      315     1064        %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      316     1106        %FPT_RELDCB(FPTN=FPT$RELDCB,STCLASS=BASED);
      317     1120        %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS=BASED);
      318     1135        %VLP_SN(FPTN=VLP_SN,N=1,SN='      ',STCLASS=AUTO);
      319     1148        %INCLUDE ZI$GLOBAL;
      320     1634        %GLOBALS;
      321     1942        %INCLUDE ZI$DBCB;
      322     2584        %AWS;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:81   
      323     2624        %INCLUDE ZI_ERRORS_C;
      324     2950        %INCLUDE B_ERRORS_C;
      325     4077        %SUB ALTF#SUFFIX=':';
      326     4078        %EJECT;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:82   
      327     4079    1       AWS$=GLOBAL.PARAN.IO.AWS$;

   4079  2 000002   000000 470400 xsym               LDP0    GLOBAL$
         2 000003   000020 236100                    LDQ     16,,PR0
         2 000004   200012 756100                    STQ     AWS$,,AUTO

      328     4080    1       IF AWS.DDCB~=0 THEN

   4080  2 000005   200012 471500                    LDP1    AWS$,,AUTO
         2 000006   100006 220100                    LDX0    6,,PR1
         2 000007   001233 601000 2                  TNZ     ER_AIR

      329     4081    1           GOTO ER_AIR;
      330     4082    1       IF ( GLOBAL.DCBNAME.LENGTH > 31 )

   4082  2 000010   004734 236100                    LDQ     2524,,PR0
         2 000011   777000 376003                    ANQ     -512,DU
         2 000012   040000 116003                    CMPQ    16384,DU
         2 000013   000016 602000 2                  TNC     s:4085

      331     4083    1       THEN
      332     4084    1           GLOBAL.DCBNAME.LENGTH = 31;

   4084  2 000014   037000 236003                    LDQ     15872,DU
         2 000015   004734 552140                    STBQ    2524,'40'O,PR0

      333     4085    1       GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;

   4085  2 000016   005104 473500                    LDP3    2628,,PR0
         2 000017   200000 236007                    LDQ     65536,DL
         2 000020   300006 256100                    ORSQ    6,,PR3

      334     4086    1       CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_DDCB);

   4086  2 000021   005104 473500                    LDP3    2628,,PR0
         2 000022   300000 630500                    EPPR0   0,,PR3
         2 000023   460002 713400                    CLIMB   alt,+24578
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:83   
         2 000024   401000 401760                    pmme    nvectors=3
         2 000025   001236 702000 2                  TSX2    ER_DDCB

      335     4087    2       IF GLOBAL.DCBNUMBER=0 THEN DO;

   4087  2 000026   000000 470400 xsym               LDP0    GLOBAL$
         2 000027   004623 235100                    LDA     2451,,PR0
         2 000030   000057 601000 2                  TNZ     s:4097

      336     4088    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;

   4088  2 000031   005104 471500                    LDP1    2628,,PR0
         2 000032   000000 236000 3                  LDQ     0
         2 000033   100006 356100                    ANSQ    6,,PR1

      337     4089    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_DDCB);

   4089  2 000034   005104 471500                    LDP1    2628,,PR0
         2 000035   100000 630500                    EPPR0   0,,PR1
         2 000036   460002 713400                    CLIMB   alt,+24578
         2 000037   401000 401760                    pmme    nvectors=3
         2 000040   001236 702000 2                  TSX2    ER_DDCB

      338     4090    2           FPT$=GLOBAL.OPNDFLT$;

   4090  2 000041   000000 470400 xsym               LDP0    GLOBAL$
         2 000042   005067 236100                    LDQ     2615,,PR0
         2 000043   200003 756100                    STQ     FPT$,,AUTO

      339     4091    2           FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;

   4091  2 000044   004623 720100                    LXL0    2451,,PR0
         2 000045   200003 471500                    LDP1    FPT$,,AUTO
         2 000046   100044 740100                    STX0    36,,PR1

      340     4092    2           FPT$OPNDFLT.V.ASN#=%FILE#;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:84   
   4092  2 000047   000001 236007                    LDQ     1,DL
         2 000050   100045 552104                    STBQ    37,'04'O,PR1

      341     4093    2           FPT$OPNDFLT.V.SHARE#=0;

   4093  2 000051   000001 236000 3                  LDQ     1
         2 000052   100044 356100                    ANSQ    36,,PR1

      342     4094        /*             File name and account already set up. */
      343     4095    2           CALL M$OPEN(FPT$OPNDFLT) ALTRET(ER_DFLT);

   4095  2 000053   100000 630500                    EPPR0   0,,PR1
         2 000054   450000 713400                    CLIMB   alt,open
         2 000055   410400 401760                    pmme    nvectors=18
         2 000056   001246 702000 2                  TSX2    ER_DFLT

      344     4096    2           END;

      345     4097    1       FPT$=GLOBAL.OPEN$;

   4097  2 000057   000000 470400 xsym               LDP0    GLOBAL$
         2 000060   005066 236100                    LDQ     2614,,PR0
         2 000061   200003 756100                    STQ     FPT$,,AUTO

      346     4098    1       FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;

   4098  2 000062   004623 720100                    LXL0    2451,,PR0
         2 000063   200003 471500                    LDP1    FPT$,,AUTO
         2 000064   100044 740100                    STX0    36,,PR1

      347     4099    1       FPT$OPEN.V.ASN#=%FILE#;

   4099  2 000065   000001 236007                    LDQ     1,DL
         2 000066   100045 552104                    STBQ    37,'04'O,PR1

      348     4100    1       FPT$OPEN.V.ACS#=%DIRECT#;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:85   
   4100  2 000067   000002 236007                    LDQ     2,DL
         2 000070   100046 552104                    STBQ    38,'04'O,PR1

      349     4101    2       IF AWS.ATRIB.ATMP THEN DO;

   4101  2 000071   200012 473500                    LDP3    AWS$,,AUTO
         2 000072   300000 236100                    LDQ     0,,PR3
         2 000073   000100 316003                    CANQ    64,DU
         2 000074   000147 600000 2                  TZE     s:4122

      350     4102    2           AWS.ATRIB.CJRNL=%NO#;

   4102  2 000075   000002 236000 3                  LDQ     2
         2 000076   300000 356100                    ANSQ    0,,PR3

      351     4103    2           AWS.ATRIB.SHARE=%NONE#;

   4103  2 000077   006000 236003                    LDQ     3072,DU
         2 000100   300000 256100                    ORSQ    0,,PR3

      352     4104    2           AWS.ATRIB.SHANY=%NO#;

   4104  2 000101   000003 236000 3                  LDQ     3
         2 000102   300000 356100                    ANSQ    0,,PR3

      353     4105    2           AWS.ATRIB.FUN=%CREATE#;

   4105  2 000103   000060 236003                    LDQ     48,DU
         2 000104   300000 256100                    ORSQ    0,,PR3

      354     4106    2           FPT$OPEN.V.DISP#=%SCRATCH#;

   4106  2 000105   000001 236007                    LDQ     1,DL
         2 000106   100051 552104                    STBQ    41,'04'O,PR1

      355     4107    2           FPT$OPEN.V.CTG#=%NO#;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:86   
   4107  2 000107   000004 236000 3                  LDQ     4
         2 000110   100044 356100                    ANSQ    36,,PR1

      356     4108    2           FPT$OPEN.V.EXIST#=%NEWFILE#;

   4108  2 000111   000600 236007                    LDQ     384,DL
         2 000112   100044 256100                    ORSQ    36,,PR1

      357     4109    2           FPT$OPEN.V.TYPE#='II';

   4109  2 000113   000001 220000 0                  LDX0    IDSSCHEMA+1
         2 000114   100047 740100                    STX0    39,,PR1

      358     4110    3           IF ~AWS.ATRIB.INDEXED THEN DO;

   4110  2 000115   300000 236100                    LDQ     0,,PR3
         2 000116   000016 736000                    QLS     14
         2 000117   400000 376003                    ANQ     -131072,DU
         2 000120   400000 676003                    ERQ     -131072,DU
         2 000121   000137 600000 2                  TZE     s:4117

      359     4111    3               FPT$OPEN.V.IXTNSIZE#=AWS.HIGHPG+1;

   4111  2 000122   300004 235100                    LDA     4,,PR3
         2 000123   000001 035007                    ADLA    1,DL
         2 000124   100055 755100                    STA     45,,PR1

      360     4112    3               FPT$OPEN.V.XTNSIZE#=0;

   4112  2 000125   000000 221003                    LDX1    0,DU
         2 000126   100054 441100                    SXL1    44,,PR1

      361     4113    3               FPT$OPEN.V.ORG#=%IDS#;

   4113  2 000127   007000 236007                    LDQ     3584,DL
         2 000130   100046 552110                    STBQ    38,'10'O,PR1

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:87   
      362     4114    3               FPT$OPEN.ALTKEYS_=VECTOR(GLOBAL.ALTKEYS$->VLP$ALTKEYS);

   4114  2 000131   005134 474500                    LDP4    2652,,PR0
         2 000132   000005 235000 3                  LDA     5
         2 000133   200014 454500                    STP4    AWS$+2,,AUTO
         2 000134   200014 236100                    LDQ     AWS$+2,,AUTO
         2 000135   100042 757100                    STAQ    34,,PR1

      363     4115    3               END;

   4115  2 000136   000147 710000 2                  TRA     s:4122

      364     4116    3           ELSE DO;

      365     4117    3               FPT$OPEN.V.IXTNSIZE#=GLOBAL.ALTKEYS$->VLP$ALTKEYS.SIZ#;

   4117  2 000137   005134 474500                    LDP4    2652,,PR0
         2 000140   400000 235100                    LDA     0,,PR4
         2 000141   100055 755100                    STA     45,,PR1

      366     4118    3               FPT$OPEN.V.XTNSIZE#=GLOBAL.ALTKEYS$->VLP$ALTKEYS.SIZ#;

   4118  2 000142   005134 474500                    LDP4    2652,,PR0
         2 000143   400000 721100                    LXL1    0,,PR4
         2 000144   100054 441100                    SXL1    44,,PR1

      367     4119    3               FPT$OPEN.V.ORG#=%INDEXED#;

   4119  2 000145   006000 236007                    LDQ     3072,DL
         2 000146   100046 552110                    STBQ    38,'10'O,PR1

      368     4120    3               END;

      369     4121    2           END;

      370     4122    1       IF AWS.ATRIB.INDEXED AND AWS.ATRIB.LOAD THEN

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:88   
   4122  2 000147   300000 236100                    LDQ     0,,PR3
         2 000150   000010 316003                    CANQ    8,DU
         2 000151   000161 600000 2                  TZE     s:4125
         2 000152   000002 316003                    CANQ    2,DU
         2 000153   000161 600000 2                  TZE     s:4125

      371     4123    1           FPT$OPEN.V.LOAD#=%YES#;

   4123  2 000154   100047 236100                    LDQ     39,,PR1
         2 000155   000006 376000 3                  ANQ     6
         2 000156   001000 276007                    ORQ     512,DL
         2 000157   100047 756100                    STQ     39,,PR1
         2 000160   000163 710000 2                  TRA     s:4126

      372     4124    1       ELSE
      373     4125    1           FPT$OPEN.V.LOAD#=%NO#;

   4125  2 000161   000006 236000 3                  LDQ     6
         2 000162   100047 356100                    ANSQ    39,,PR1

      374     4126    1       FPT$OPEN.V.SHARE#=AWS.ATRIB.SHARE;

   4126  2 000163   300000 236100                    LDQ     0,,PR3
         2 000164   000031 772000                    QRL     25
         2 000165   100044 676100                    ERQ     36,,PR1
         2 000166   000030 376007                    ANQ     24,DL
         2 000167   100044 656100                    ERSQ    36,,PR1

      375     4127    1       FPT$OPEN.V.FUN#=AWS.ATRIB.FUN;

   4127  2 000170   300000 236100                    LDQ     0,,PR3
         2 000171   000060 376003                    ANQ     48,DU
         2 000172   000015 772000                    QRL     13
         2 000173   100045 552110                    STBQ    37,'10'O,PR1

      376     4128    1       F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:89   
   4128  2 000174   000007 474400 3                  LDP4    7
         2 000175   400000 470500                    LDP0    0,,PR4
         2 000176   000000 471400 xsym               LDP1    GLOBAL$
         2 000177   104623 720100                    LXL0    2451,,PR1
         2 000200   000000 236110                    LDQ     0,X0,PR0
         2 000201   200004 756100                    STQ     F$DCB$,,AUTO

      377     4129        /*          If program request for currencies only set bit. */
      378     4130    1       IF GLOBAL.PENDING.CURONLY THEN

   4130  2 000202   100017 236100                    LDQ     15,,PR1
         2 000203   000200 316003                    CANQ    128,DU
         2 000204   000213 600000 2                  TZE     s:4133

      379     4131    1           FPT$OPEN.V.UOPT#(1)='1'B;

   4131  2 000205   200003 470500                    LDP0    FPT$,,AUTO
         2 000206   000046 236100                    LDQ     38,,PR0
         2 000207   000010 376000 3                  ANQ     8
         2 000210   100000 276003                    ORQ     32768,DU
         2 000211   000046 756100                    STQ     38,,PR0
         2 000212   000220 710000 2                  TRA     s:4134

      380     4132    1       ELSE
      381     4133    1           FPT$OPEN.V.UOPT#(1)='01'B;

   4133  2 000213   200003 470500                    LDP0    FPT$,,AUTO
         2 000214   000046 236100                    LDQ     38,,PR0
         2 000215   000010 376000 3                  ANQ     8
         2 000216   040000 276003                    ORQ     16384,DU
         2 000217   000046 756100                    STQ     38,,PR0

      382     4134    1       CALL M$OPEN(FPT$OPEN)

   4134  2 000220   450000 713400                    CLIMB   alt,open
         2 000221   410400 401760                    pmme    nvectors=18
         2 000222   000224 702000 2                  TSX2    s:4136
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:90   
         2 000223   000230 710000 2                  TRA     s:4139

      383     4135    2       WHENALTRETURN DO;

      384     4136    2           FPT$OPEN.ALTKEYS_=VECTOR(NIL);

   4136  2 000224   000012 237000 3                  LDAQ    10
         2 000225   200003 470500                    LDP0    FPT$,,AUTO
         2 000226   000042 757100                    STAQ    34,,PR0

      385     4137    2           GOTO ER_DOPN;

   4137  2 000227   001260 710000 2                  TRA     ER_DOPN

      386     4138    2           END;
      387     4139    1       FPT$OPEN.ALTKEYS_=VECTOR(NIL);

   4139  2 000230   000012 237000 3                  LDAQ    10
         2 000231   200003 470500                    LDP0    FPT$,,AUTO
         2 000232   000042 757100                    STAQ    34,,PR0

      388     4140    1       IF NOT AWS.ATRIB.ATMP AND

   4140  2 000233   200012 471500                    LDP1    AWS$,,AUTO
         2 000234   100000 236100                    LDQ     0,,PR1
         2 000235   000100 316003                    CANQ    64,DU
         2 000236   000267 601000 2                  TNZ     s:4146
         2 000237   006000 316003                    CANQ    3072,DU
         2 000240   000267 601000 2                  TNZ     s:4146
         2 000241   200004 473500                    LDP3    F$DCB$,,AUTO
         2 000242   300031 236100                    LDQ     25,,PR3
         2 000243   000400 316003                    CANQ    256,DU
         2 000244   000267 600000 2                  TZE     s:4146
         2 000245   300031 236100                    LDQ     25,,PR3
         2 000246   000600 376007                    ANQ     384,DL
         2 000247   000400 116007                    CMPQ    256,DL
         2 000250   000255 601000 2                  TNZ     s:4140+18
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:91   
         2 000251   100000 236100                    LDQ     0,,PR1
         2 000252   000060 376003                    ANQ     48,DU
         2 000253   000020 116003                    CMPQ    16,DU
         2 000254   000265 600000 2                  TZE     s:4145
         2 000255   300031 236100                    LDQ     25,,PR3
         2 000256   000600 376007                    ANQ     384,DL
         2 000257   000200 116007                    CMPQ    128,DL
         2 000260   000267 601000 2                  TNZ     s:4146
         2 000261   100000 236100                    LDQ     0,,PR1
         2 000262   000060 376003                    ANQ     48,DU
         2 000263   000040 116003                    CMPQ    32,DU
         2 000264   000267 601000 2                  TNZ     s:4146

      389     4141    1          AWS.ATRIB.SHARE=0 AND
      390     4142    1          F$DCB$->F$DCB.UOPT#(0) AND
      391     4143    1          ((F$DCB$->F$DCB.SHARE#=%IN# AND AWS.ATRIB.FUN=%UPDATE#) OR
      392     4144    1          (F$DCB$->F$DCB.SHARE#=%ALL# AND AWS.ATRIB.FUN=%IN#)) THEN
      393     4145    1           AWS.ATRIB.SHANY=%YES#;

   4145  2 000265   001000 236003                    LDQ     512,DU
         2 000266   100000 256100                    ORSQ    0,,PR1

      394     4146    1       AWS.ATRIB.SHARE=F$DCB$->F$DCB.SHARE#;

   4146  2 000267   200004 473500                    LDP3    F$DCB$,,AUTO
         2 000270   300031 236100                    LDQ     25,,PR3
         2 000271   000025 736000                    QLS     21
         2 000272   100000 676100                    ERQ     0,,PR1
         2 000273   006000 376003                    ANQ     3072,DU
         2 000274   100000 656100                    ERSQ    0,,PR1

      395     4147    1       AWS.DDCB=GLOBAL.DCBNUMBER;

   4147  2 000275   000000 474400 xsym               LDP4    GLOBAL$
         2 000276   404623 720100                    LXL0    2451,,PR4
         2 000277   100006 740100                    STX0    6,,PR1

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:92   
      396     4148    1       IF AWS.ATRIB.INDEXED AND F$DCB$->F$DCB.ORG#~=%INDEXED# THEN

   4148  2 000300   100000 236100                    LDQ     0,,PR1
         2 000301   000010 316003                    CANQ    8,DU
         2 000302   000307 600000 2                  TZE     s:4150
         2 000303   300032 236100                    LDQ     26,,PR3
         2 000304   777000 376003                    ANQ     -512,DU
         2 000305   006000 116003                    CMPQ    3072,DU
         2 000306   001100 601000 2                  TNZ     ER_NOTIDX

      397     4149    1           GOTO ER_NOTIDX;
      398     4150    1       IF ~AWS.ATRIB.INDEXED AND F$DCB$->F$DCB.ORG#~=%IDS# THEN

   4150  2 000307   100000 236100                    LDQ     0,,PR1
         2 000310   000016 736000                    QLS     14
         2 000311   400000 376003                    ANQ     -131072,DU
         2 000312   400000 676003                    ERQ     -131072,DU
         2 000313   000320 600000 2                  TZE     s:4152
         2 000314   300032 236100                    LDQ     26,,PR3
         2 000315   777000 376003                    ANQ     -512,DU
         2 000316   007000 116003                    CMPQ    3584,DU
         2 000317   001075 601000 2                  TNZ     ER_NOTIDS

      399     4151    1           GOTO ER_NOTIDS;
      400     4152    1       IF F$DCB$->F$DCB.FUN#=%IN# THEN

   4152  2 000320   300032 236100                    LDQ     26,,PR3
         2 000321   000777 376003                    ANQ     511,DU
         2 000322   000002 116003                    CMPQ    2,DU
         2 000323   000407 601000 2                  TNZ     s:4179

      401     4153    2       DO;

      402     4154    2           IF ~F$DCB$->F$DCB.FFLG.READ# THEN

   4154  2 000324   300004 236100                    LDQ     4,,PR3
         2 000325   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:93   
         2 000326   400000 676003                    ERQ     -131072,DU
         2 000327   001103 601000 2                  TNZ     ER_ACCESS

      403     4155    2               GOTO ER_ACCESS;
      404     4156    2           AWS.ATRIB.TJRNL=%NO#;

   4156  2 000330   000011 236000 3                  LDQ     9
         2 000331   100000 356100                    ANSQ    0,,PR1

      405     4157    2           AWS.ATRIB.CJRNL=%NO#;

   4157  2 000332   000002 236000 3                  LDQ     2
         2 000333   100000 356100                    ANSQ    0,,PR1

      406     4158    2           IF AWS.ATRIB.SHANY THEN

   4158  2 000334   100000 430100                    FSZN    0,,PR1
         2 000335   000344 605000 2                  TPL     s:4164

      407     4159    3           DO;

      408     4160    3               AWS.ATRIB.CAC=%NO#;

   4160  2 000336   000014 236000 3                  LDQ     12
         2 000337   100000 356100                    ANSQ    0,,PR1

      409     4161    3               GLOBAL.SHANY=GLOBAL.SHANY+1;

   4161  2 000340   402615 235100                    LDA     1421,,PR4
         2 000341   000001 035007                    ADLA    1,DL
         2 000342   402615 755100                    STA     1421,,PR4

      410     4162    3               END;

   4162  2 000343   000372 710000 2                  TRA     s:4173

      411     4163    2           ELSE
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:94   
      412     4164    2               IF F$DCB$->F$DCB.SHARE#=%ALL# THEN

   4164  2 000344   300031 236100                    LDQ     25,,PR3
         2 000345   000600 376007                    ANQ     384,DL
         2 000346   000200 116007                    CMPQ    128,DL
         2 000347   000370 601000 2                  TNZ     s:4172

      413     4165    3               DO;

      414     4166    3                   GLOBAL.ENQS$->FPT$ENQS.V.SHARE#=%ALL#;

   4166  2 000350   405123 470500                    LDP0    2643,,PR4
         2 000351   000006 236100                    LDQ     6,,PR0
         2 000352   000015 376000 3                  ANQ     13
         2 000353   040000 276007                    ORQ     16384,DL
         2 000354   000006 756100                    STQ     6,,PR0

      415     4167    3                   GLOBAL.ENQS$->FPT$ENQS.V.DCB#=GLOBAL.DCBNUMBER;

   4167  2 000355   405123 470500                    LDP0    2643,,PR4
         2 000356   404623 720100                    LXL0    2451,,PR4
         2 000357   000006 740100                    STX0    6,,PR0

      416     4168    3                   CALL M$ENQ(GLOBAL.ENQS$->FPT$ENQS) ALTRET(ER_ENQIN);

   4168  2 000360   405123 470500                    LDP0    2643,,PR4
         2 000361   420002 713400                    CLIMB   alt,+8194
         2 000362   401000 401760                    pmme    nvectors=3
         2 000363   001111 702000 2                  TSX2    ER_ENQIN

      417     4169    3   CLEAN:          AWS.ATRIB.CAC=%YES#;

   4169  2 000364   200012 470500       CLEAN        LDP0    AWS$,,AUTO
         2 000365   000001 236003                    LDQ     1,DU
         2 000366   000000 256100                    ORSQ    0,,PR0

      418     4170    3                   END;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:95   

   4170  2 000367   000372 710000 2                  TRA     s:4173

      419     4171    2               ELSE
      420     4172    2                   AWS.ATRIB.CAC=%NO#;

   4172  2 000370   000014 236000 3                  LDQ     12
         2 000371   100000 356100                    ANSQ    0,,PR1

      421     4173    2           IF AWS.ATRIB.CAC AND ~AWS.ATRIB.CANSSS AND GLOBAL.UPDATE.NOTJRNL>0 THEN

   4173  2 000372   200012 470500                    LDP0    AWS$,,AUTO
         2 000373   000000 236100                    LDQ     0,,PR0
         2 000374   000001 316003                    CANQ    1,DU
         2 000375   000406 600000 2                  TZE     s:4176
         2 000376   000000 236100                    LDQ     0,,PR0
         2 000377   000012 736000                    QLS     10
         2 000400   400000 376003                    ANQ     -131072,DU
         2 000401   400000 676003                    ERQ     -131072,DU
         2 000402   000406 600000 2                  TZE     s:4176
         2 000403   000000 471400 xsym               LDP1    GLOBAL$
         2 000404   102613 720100                    LXL0    1419,,PR1
         2 000405   001106 601000 2                  TNZ     ER_JRNL

      422     4174        /*             Can't start CAC if updater not journaling */
      423     4175    2               GOTO ER_JRNL;
      424     4176    2           END;

   4176  2 000406   000521 710000 2                  TRA     s:4220

      425     4177    1       ELSE
      426     4178    2       DO;

      427     4179    2           IF NOT(F$DCB$->F$DCB.FFLG.READ# AND F$DCB$->F$DCB.FFLG.UPD#) THEN

   4179  2 000407   300004 234100                    SZN     4,,PR3
         2 000410   001103 605000 2                  TPL     ER_ACCESS
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:96   
         2 000411   300004 236100                    LDQ     4,,PR3
         2 000412   040000 316003                    CANQ    16384,DU
         2 000413   001103 600000 2                  TZE     ER_ACCESS

      428     4180    2               GOTO ER_ACCESS;
      429     4181    2           IF F$DCB$->F$DCB.ORG#=%INDEXED# AND

   4181  2 000414   300032 236100                    LDQ     26,,PR3
         2 000415   777000 376003                    ANQ     -512,DU
         2 000416   006000 116003                    CMPQ    3072,DU
         2 000417   000427 601000 2                  TNZ     s:4186
         2 000420   300004 236100                    LDQ     4,,PR3
         2 000421   200000 316003                    CANQ    65536,DU
         2 000422   001103 600000 2                  TZE     ER_ACCESS
         2 000423   100000 316003                    CANQ    32768,DU
         2 000424   001103 600000 2                  TZE     ER_ACCESS
         2 000425   020000 316003                    CANQ    8192,DU
         2 000426   001103 600000 2                  TZE     ER_ACCESS

      430     4182    2              NOT(F$DCB$->F$DCB.FFLG.DELR# AND
      431     4183    2              F$DCB$->F$DCB.FFLG.WNEW# AND
      432     4184    2              F$DCB$->F$DCB.FFLG.DELF#) THEN
      433     4185    2               GOTO ER_ACCESS;
      434     4186    2           IF AWS.ATRIB.SHANY THEN

   4186  2 000427   100000 430100                    FSZN    0,,PR1
         2 000430   000455 605000 2                  TPL     s:4196

      435     4187    3           DO;

      436     4188    3               GLOBAL.ENQS$->FPT$ENQS.V.SHARE#=%LIMITED#;

   4188  2 000431   405123 470500                    LDP0    2643,,PR4
         2 000432   000006 236100                    LDQ     6,,PR0
         2 000433   000015 376000 3                  ANQ     13
         2 000434   100000 276007                    ORQ     32768,DL
         2 000435   000006 756100                    STQ     6,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:97   

      437     4189    3               GLOBAL.ENQS$->FPT$ENQS.V.DCB#=GLOBAL.DCBNUMBER;

   4189  2 000436   405123 470500                    LDP0    2643,,PR4
         2 000437   404623 720100                    LXL0    2451,,PR4
         2 000440   000006 740100                    STX0    6,,PR0

      438     4190    3               CALL M$ENQ(GLOBAL.ENQS$->FPT$ENQS) ALTRET(ER_ENQUP);

   4190  2 000441   405123 470500                    LDP0    2643,,PR4
         2 000442   420002 713400                    CLIMB   alt,+8194
         2 000443   401000 401760                    pmme    nvectors=3
         2 000444   001143 702000 2                  TSX2    ER_ENQUP

      439     4191    3               AWS.ATRIB.CAC=%NO#;

   4191  2 000445   200012 470500                    LDP0    AWS$,,AUTO
         2 000446   000014 236000 3                  LDQ     12
         2 000447   000000 356100                    ANSQ    0,,PR0

      440     4192    3               GLOBAL.SHANY=GLOBAL.SHANY+1;

   4192  2 000450   000000 471400 xsym               LDP1    GLOBAL$
         2 000451   102615 235100                    LDA     1421,,PR1
         2 000452   000001 035007                    ADLA    1,DL
         2 000453   102615 755100                    STA     1421,,PR1

      441     4193    3               END;

   4193  2 000454   000470 710000 2                  TRA     s:4204

      442     4194    2           ELSE
      443     4195    3           DO;

      444     4196    3               IF F$DCB$->F$DCB.SHARE#=%NONE# THEN

   4196  2 000455   300031 236100                    LDQ     25,,PR3
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:98   
         2 000456   000600 376007                    ANQ     384,DL
         2 000457   000600 116007                    CMPQ    384,DL
         2 000460   000464 601000 2                  TNZ     s:4200

      445     4197    3                   AWS.ATRIB.CAC=%NO#;

   4197  2 000461   000014 236000 3                  LDQ     12
         2 000462   100000 356100                    ANSQ    0,,PR1
         2 000463   000470 710000 2                  TRA     s:4204

      446     4198    3               ELSE
      447     4199    4               DO;

      448     4200    4                   AWS.ATRIB.CAC=%YES#;

   4200  2 000464   000001 236003                    LDQ     1,DU
         2 000465   100000 256100                    ORSQ    0,,PR1

      449     4201    4                   AWS.ATRIB.TJRNL=%YES#;

   4201  2 000466   020000 236003                    LDQ     8192,DU
         2 000467   100000 256100                    ORSQ    0,,PR1

      450     4202    4                   END;

      451     4203    3               END; /* not input only*/

      452     4204    2           IF ~AWS.ATRIB.TJRNL AND GLOBAL.CAC > 0 THEN

   4204  2 000470   200012 470500                    LDP0    AWS$,,AUTO
         2 000471   000000 236100                    LDQ     0,,PR0
         2 000472   000004 736000                    QLS     4
         2 000473   400000 376003                    ANQ     -131072,DU
         2 000474   400000 676003                    ERQ     -131072,DU
         2 000475   000501 600000 2                  TZE     s:4209
         2 000476   000000 471400 xsym               LDP1    GLOBAL$
         2 000477   102614 235100                    LDA     1420,,PR1
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:99   
         2 000500   001106 601000 2                  TNZ     ER_JRNL

      453     4205        /******                                     ******
      454     4206         *  Updaters must TJRNL if CAC already active    *
      455     4207         ******                                     ******/
      456     4208    2               GOTO ER_JRNL;
      457     4209    2           IF AWS.ATRIB.TJRNL THEN

   4209  2 000501   000000 236100                    LDQ     0,,PR0
         2 000502   020000 316003                    CANQ    8192,DU
         2 000503   000513 600000 2                  TZE     s:4215

      458     4210    2               IF GLOBAL.UPDATE.NOTJRNL > 0 THEN

   4210  2 000504   000000 471400 xsym               LDP1    GLOBAL$
         2 000505   102613 720100                    LXL0    1419,,PR1
         2 000506   001106 601000 2                  TNZ     ER_JRNL

      459     4211    2                   GOTO ER_JRNL;
      460     4212    2               ELSE
      461     4213    2                   GLOBAL.UPDATE.TJRNL = GLOBAL.UPDATE.TJRNL + 1;

   4213  2 000507   102613 221100                    LDX1    1419,,PR1
         2 000510   000001 622011                    EAX2    1,X1
         2 000511   102613 742100                    STX2    1419,,PR1
         2 000512   000521 710000 2                  TRA     s:4220

      462     4214    2           ELSE
      463     4215    2               IF GLOBAL.UPDATE.TJRNL > 0 THEN

   4215  2 000513   000000 471400 xsym               LDP1    GLOBAL$
         2 000514   102613 220100                    LDX0    1419,,PR1
         2 000515   001106 601000 2                  TNZ     ER_JRNL

      464     4216    2                   GOTO ER_JRNL;
      465     4217    2               ELSE
      466     4218    2                   GLOBAL.UPDATE.NOTJRNL = GLOBAL.UPDATE.NOTJRNL + 1;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:100  

   4218  2 000516   102613 721100                    LXL1    1419,,PR1
         2 000517   000001 622011                    EAX2    1,X1
         2 000520   102613 442100                    SXL2    1419,,PR1

      467     4219    2           END; /*  test journal spec by new user */

      468     4220    1       AWS.ATRIB.CURONLY='0'B; /* ASSUME NOT ENQ CURRENCY */

   4220  2 000521   000016 236000 3                  LDQ     14
         2 000522   000000 356100                    ANSQ    0,,PR0

      469     4221    1       IF AWS.ATRIB.CAC THEN

   4221  2 000523   000000 236100                    LDQ     0,,PR0
         2 000524   000001 316003                    CANQ    1,DU
         2 000525   000545 600000 2                  TZE     s:4229

      470     4222    2       DO;

      471     4223    2           GLOBAL.CAC=GLOBAL.CAC+1;

   4223  2 000526   000000 471400 xsym               LDP1    GLOBAL$
         2 000527   102614 235100                    LDA     1420,,PR1
         2 000530   000001 035007                    ADLA    1,DL
         2 000531   102614 755100                    STA     1420,,PR1

      472     4224    2           IF GLOBAL.PENDING.CURONLY OR

   4224  2 000532   100017 236100                    LDQ     15,,PR1
         2 000533   000200 316003                    CANQ    128,DU
         2 000534   000543 601000 2                  TNZ     s:4227
         2 000535   300000 316003                    CANQ    98304,DU
         2 000536   000545 601000 2                  TNZ     s:4229
         2 000537   200004 473500                    LDP3    F$DCB$,,AUTO
         2 000540   300031 236100                    LDQ     25,,PR3
         2 000541   000200 316003                    CANQ    128,DU
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:101  
         2 000542   000545 600000 2                  TZE     s:4229

      473     4225    2              (GLOBAL.PENDING.SHARE=0 AND
      474     4226    2              F$DCB$->F$DCB.UOPT#(1)) THEN
      475     4227    2               AWS.ATRIB.CURONLY='1'B;

   4227  2 000543   200000 236003                    LDQ     65536,DU
         2 000544   000000 256100                    ORSQ    0,,PR0

      476     4228    2           END;

      477     4229    1       IF F$DCB$->F$DCB.ORG#=%IDS# AND F$DCB$->F$DCB.FUN#=%UPDATE# AND

   4229  2 000545   200004 471500                    LDP1    F$DCB$,,AUTO
         2 000546   100032 236100                    LDQ     26,,PR1
         2 000547   777000 376003                    ANQ     -512,DU
         2 000550   007000 116003                    CMPQ    3584,DU
         2 000551   000572 601000 2                  TNZ     s:4234
         2 000552   100032 236100                    LDQ     26,,PR1
         2 000553   000777 376003                    ANQ     511,DU
         2 000554   000001 116003                    CMPQ    1,DU
         2 000555   000572 601000 2                  TNZ     s:4234
         2 000556   000000 236100                    LDQ     0,,PR0
         2 000557   000100 316003                    CANQ    64,DU
         2 000560   000572 601000 2                  TNZ     s:4234
         2 000561   020000 316003                    CANQ    8192,DU
         2 000562   000572 601000 2                  TNZ     s:4234
         2 000563   000000 473400 xsym               LDP3    GLOBAL$
         2 000564   300002 235100                    LDA     2,,PR3
         2 000565   300167 234105                    SZN     119,AL,PR3
         2 000566   000572 604000 2                  TMI     s:4234

      478     4230    1          AWS.ATRIB.ATMP='0'B AND AWS.ATRIB.TJRNL='0'B AND
      479     4231    1          GLOBAL.DB.FLAGS.SYSSUB(GLOBAL.ACTIVE.DBNO)='0'B THEN
      480     4232    1           AWS.ATRIB.UNPROTECT = '1'B; /* MARK THIS AREA UNPROTECTED */

   4232  2 000567   400000 236007                    LDQ     -131072,DL
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:102  
         2 000570   000000 256100                    ORSQ    0,,PR0
         2 000571   000574 710000 2                  TRA     s:4235

      481     4233    1       ELSE
      482     4234    1           AWS.ATRIB.UNPROTECT = '0'B;

   4234  2 000572   000017 236000 3                  LDQ     15
         2 000573   000000 356100                    ANSQ    0,,PR0

      483     4235    1       IF AWS.ATRIB.KEYED=%YES# THEN

   4235  2 000574   000000 236100                    LDQ     0,,PR0
         2 000575   000004 316003                    CANQ    4,DU
         2 000576   001056 600000 2                  TZE     s:4301

      484     4236    2       DO;

      485     4237    2           IF GLOBAL.DCBNAME.LENGTH<31 THEN

   4237  2 000577   000000 473400 xsym               LDP3    GLOBAL$
         2 000600   304734 236100                    LDQ     2524,,PR3
         2 000601   777000 376003                    ANQ     -512,DU
         2 000602   037000 116003                    CMPQ    15872,DU
         2 000603   000607 603000 2                  TRC     s:4239

      486     4238    2               GLOBAL.DCBNAME.LENGTH=GLOBAL.DCBNAME.LENGTH+1;

   4238  2 000604   304734 236100                    LDQ     2524,,PR3
         2 000605   001000 036003                    ADLQ    512,DU
         2 000606   304734 552140                    STBQ    2524,'40'O,PR3

      487     4239    2           CALL INSERT(GLOBAL.DCBNAME.TEXT,

   4239  2 000607   304734 236100                    LDQ     2524,,PR3
         2 000610   000033 772000                    QRL     27
         2 000611   040106 100400                    MLR     fill='040'O
         2 000612   000020 000001 3                  ADSC9   16                       cn=0,n=1
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:103  
         2 000613   304734 000001                    ADSC9   2524,Q,PR3               cn=0,n=1

      488     4240    2              GLOBAL.DCBNAME.LENGTH-1,1,ALTF#SUFFIX);
      489     4241    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;

   4241  2 000614   305104 474500                    LDP4    2628,,PR3
         2 000615   000000 236000 3                  LDQ     0
         2 000616   400006 356100                    ANSQ    6,,PR4

      490     4242    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_KDCB);

   4242  2 000617   305104 474500                    LDP4    2628,,PR3
         2 000620   400000 630500                    EPPR0   0,,PR4
         2 000621   460002 713400                    CLIMB   alt,+24578
         2 000622   401000 401760                    pmme    nvectors=3
         2 000623   001175 702000 2                  TSX2    ER_KDCB

      491     4243    2           GLOBAL.FILENAME.LENGTH=F$DCB$->F$DCB.NAME#.L;

   4243  2 000624   200004 470500                    LDP0    F$DCB$,,AUTO
         2 000625   000000 471400 xsym               LDP1    GLOBAL$
         2 000626   000010 236100                    LDQ     8,,PR0
         2 000627   104724 552140                    STBQ    2516,'40'O,PR1

      492     4244    2           GLOBAL.FILENAME.TEXT=F$DCB$->F$DCB.NAME#.C;

   4244  2 000630   040100 100500                    MLR     fill='040'O
         2 000631   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
         2 000632   104724 200037                    ADSC9   2516,,PR1                cn=1,n=31

      493     4245    2           IF GLOBAL.FILENAME.LENGTH<31 THEN

   4245  2 000633   104724 236100                    LDQ     2516,,PR1
         2 000634   777000 376003                    ANQ     -512,DU
         2 000635   037000 116003                    CMPQ    15872,DU
         2 000636   000642 603000 2                  TRC     s:4247

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:104  
      494     4246    2               GLOBAL.FILENAME.LENGTH=GLOBAL.FILENAME.LENGTH+1;

   4246  2 000637   104724 236100                    LDQ     2516,,PR1
         2 000640   001000 036003                    ADLQ    512,DU
         2 000641   104724 552140                    STBQ    2516,'40'O,PR1

      495     4247    2           CALL INSERT(GLOBAL.FILENAME.TEXT,

   4247  2 000642   104724 236100                    LDQ     2516,,PR1
         2 000643   000033 772000                    QRL     27
         2 000644   040106 100400                    MLR     fill='040'O
         2 000645   000020 000001 3                  ADSC9   16                       cn=0,n=1
         2 000646   104724 000001                    ADSC9   2516,Q,PR1               cn=0,n=1

      496     4248    2              GLOBAL.FILENAME.LENGTH-1,1,ALTF#SUFFIX);
      497     4249    2           GLOBAL.ACCT=F$DCB$->F$DCB.ACCT#;

   4249  2 000647   000020 237100                    LDAQ    16,,PR0
         2 000650   104744 757100                    STAQ    2532,,PR1

      498     4250    2           FPT$=GLOBAL.OPNSCRB$;

   4250  2 000651   105070 236100                    LDQ     2616,,PR1
         2 000652   200003 756100                    STQ     FPT$,,AUTO

      499     4251    2           FPT$OPNSCRB.PASS_=VECTOR(F$DCB$->F$DCB.PASS#);

   4251  2 000653   000021 235000 3                  LDA     17
         2 000654   200004 236100                    LDQ     F$DCB$,,AUTO
         2 000655   000022 036003                    ADLQ    18,DU
         2 000656   200003 473500                    LDP3    FPT$,,AUTO
         2 000657   300010 757100                    STAQ    8,,PR3

      500     4252    2           VLP_SN.SN#(0)=F$DCB$->F$DCB.PSN#;

   4252  2 000660   040100 100500                    MLR     fill='040'O
         2 000661   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:105  
         2 000662   200007 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6

      501     4253    2           FPT$OPNSCRB.SN_=VECTOR(VLP_SN);

   4253  2 000663   000022 235000 3                  LDA     18
         2 000664   200014 452500                    STP2    AWS$+2,,AUTO
         2 000665   200014 236100                    LDQ     AWS$+2,,AUTO
         2 000666   000006 036003                    ADLQ    6,DU
         2 000667   300002 757100                    STAQ    2,,PR3

      502     4254    2           FPT$OPNSCRB.WSN_=VECTOR(F$DCB$->F$DCB.WSN#);

   4254  2 000670   000021 235000 3                  LDA     17
         2 000671   200004 236100                    LDQ     F$DCB$,,AUTO
         2 000672   000027 036003                    ADLQ    23,DU
         2 000673   300032 757100                    STAQ    26,,PR3

      503     4255    2           FPT$OPNSCRB.V.DCB#=GLOBAL.DCBNUMBER;

   4255  2 000674   104623 720100                    LXL0    2451,,PR1
         2 000675   300044 740100                    STX0    36,,PR3

      504     4256    2           FPT$OPNSCRB.V.ACS#=%DIRECT#;

   4256  2 000676   000002 236007                    LDQ     2,DL
         2 000677   300046 552104                    STBQ    38,'04'O,PR3

      505     4257    2           FPT$OPNSCRB.V.FUN#=F$DCB$->F$DCB.FUN#;

   4257  2 000700   000032 236100                    LDQ     26,,PR0
         2 000701   000011 772000                    QRL     9
         2 000702   300045 552110                    STBQ    37,'10'O,PR3

      506     4258    2           FPT$OPNSCRB.V.DISP#=F$DCB$->F$DCB.DISP#;

   4258  2 000703   000032 236100                    LDQ     26,,PR0
         2 000704   300051 552104                    STBQ    41,'04'O,PR3
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:106  

      507     4259    2           FPT$OPNSCRB.V.EXIST#=F$DCB$->F$DCB.EXIST#;

   4259  2 000705   000031 236100                    LDQ     25,,PR0
         2 000706   000002 772000                    QRL     2
         2 000707   300044 676100                    ERQ     36,,PR3
         2 000710   000600 376007                    ANQ     384,DL
         2 000711   300044 656100                    ERSQ    36,,PR3

      508     4260    2           FPT$OPNSCRB.V.ORG#=%KEYED#;

   4260  2 000712   002000 236007                    LDQ     1024,DL
         2 000713   300046 552110                    STBQ    38,'10'O,PR3

      509     4261    2           FPT$OPNSCRB.V.CTG#=F$DCB$->F$DCB.CTG#;

   4261  2 000714   000031 236100                    LDQ     25,,PR0
         2 000715   004000 376007                    ANQ     2048,DL
         2 000716   000005 772000                    QRL     5
         2 000717   300044 676100                    ERQ     36,,PR3
         2 000720   000140 376007                    ANQ     96,DL
         2 000721   300044 656100                    ERSQ    36,,PR3

      510     4262    2           FPT$OPNSCRB.V.EXPIRE#=F$DCB$->F$DCB.EXPIRE#;

   4262  2 000722   000035 235100                    LDA     29,,PR0
         2 000723   300057 755100                    STA     47,,PR3

      511     4263    2           FPT$OPNSCRB.V.LRDL0#=F$DCB$->F$DCB.LRDL0#;

   4263  2 000724   000037 721100                    LXL1    31,,PR0
         2 000725   000777 361003                    ANX1    511,DU
         2 000726   300053 441100                    SXL1    43,,PR3

      512     4264    2           FPT$OPNSCRB.V.LSLIDE#=F$DCB$->F$DCB.LSLIDE#;

   4264  2 000727   000037 236100                    LDQ     31,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:107  
         2 000730   000011 772000                    QRL     9
         2 000731   000777 376007                    ANQ     511,DL
         2 000732   000000 622006                    EAX2    0,QL
         2 000733   300053 742100                    STX2    43,,PR3

      513     4265    2           FPT$OPNSCRB.V.TYPE#='II';

   4265  2 000734   000001 223000 0                  LDX3    IDSSCHEMA+1
         2 000735   300047 743100                    STX3    39,,PR3

      514     4266    2           FPT$OPNSCRB.V.IXTNSIZE#=F$DCB$->F$DCB.IXTNSIZE#;

   4266  2 000736   000041 235100                    LDA     33,,PR0
         2 000737   300055 755100                    STA     45,,PR3

      515     4267    2           FPT$OPNSCRB.V.XTNSIZE#=F$DCB$->F$DCB.XTNSIZE#;

   4267  2 000740   000037 224100                    LDX4    31,,PR0
         2 000741   300054 444100                    SXL4    44,,PR3

      516     4268    2           FPT$OPNSCRB.V.SHARE#=F$DCB$->F$DCB.SHARE#;

   4268  2 000742   000031 236100                    LDQ     25,,PR0
         2 000743   000004 772000                    QRL     4
         2 000744   300044 676100                    ERQ     36,,PR3
         2 000745   000030 376007                    ANQ     24,DL
         2 000746   300044 656100                    ERSQ    36,,PR3

      517     4269    2           CALL M$OPEN(FPT$OPNSCRB)

   4269  2 000747   300000 630500                    EPPR0   0,,PR3
         2 000750   450000 713400                    CLIMB   alt,open
         2 000751   410400 401760                    pmme    nvectors=18
         2 000752   000754 702000 2                  TSX2    s:4271
         2 000753   000774 710000 2                  TRA     s:4282

      518     4270    3           WHENALTRETURN DO;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:108  

      519     4271    3               FPT$OPNSCRB.V.EXPIRE#=0;

   4271  2 000754   200003 470500                    LDP0    FPT$,,AUTO
         2 000755   000057 450100                    STZ     47,,PR0

      520     4272    3               FPT$OPNSCRB.V.LRDL0#=0;

   4272  2 000756   000000 220003                    LDX0    0,DU
         2 000757   000053 440100                    SXL0    43,,PR0

      521     4273    3               FPT$OPNSCRB.V.LSLIDE#=0;

   4273  2 000760   000053 740100                    STX0    43,,PR0

      522     4274    3               FPT$OPNSCRB.V.IXTNSIZE#=0;

   4274  2 000761   000055 450100                    STZ     45,,PR0

      523     4275    3               FPT$OPNSCRB.V.XTNSIZE#=0;

   4275  2 000762   000054 440100                    SXL0    44,,PR0

      524     4276    3               FPT$OPNSCRB.PASS_=VECTOR(NIL);

   4276  2 000763   000012 237000 3                  LDAQ    10
         2 000764   000010 757100                    STAQ    8,,PR0

      525     4277    3               FPT$OPNSCRB.SN_=VECTOR(NIL);

   4277  2 000765   000012 237000 3                  LDAQ    10
         2 000766   000002 757100                    STAQ    2,,PR0

      526     4278    3               FPT$OPNSCRB.WSN_=VECTOR(NIL);

   4278  2 000767   000012 237000 3                  LDAQ    10
         2 000770   000032 757100                    STAQ    26,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:109  

      527     4279    3               FPT$OPNSCRB.SN_=VECTOR(NIL);

   4279  2 000771   000012 237000 3                  LDAQ    10
         2 000772   000002 757100                    STAQ    2,,PR0

      528     4280    3               GOTO ER_KOPN;

   4280  2 000773   001205 710000 2                  TRA     ER_KOPN

      529     4281    3               END;
      530     4282    2           FPT$OPNSCRB.V.EXPIRE#=0;

   4282  2 000774   200003 470500                    LDP0    FPT$,,AUTO
         2 000775   000057 450100                    STZ     47,,PR0

      531     4283    2           FPT$OPNSCRB.V.LRDL0#=0;

   4283  2 000776   000000 220003                    LDX0    0,DU
         2 000777   000053 440100                    SXL0    43,,PR0

      532     4284    2           FPT$OPNSCRB.V.LSLIDE#=0;

   4284  2 001000   000053 740100                    STX0    43,,PR0

      533     4285    2           FPT$OPNSCRB.V.IXTNSIZE#=0;

   4285  2 001001   000055 450100                    STZ     45,,PR0

      534     4286    2           FPT$OPNSCRB.V.XTNSIZE#=0;

   4286  2 001002   000054 440100                    SXL0    44,,PR0

      535     4287    2           FPT$OPNSCRB.PASS_=VECTOR(NIL);

   4287  2 001003   000012 237000 3                  LDAQ    10
         2 001004   000010 757100                    STAQ    8,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:110  

      536     4288    2           FPT$OPNSCRB.SN_=VECTOR(NIL);

   4288  2 001005   000012 237000 3                  LDAQ    10
         2 001006   000002 757100                    STAQ    2,,PR0

      537     4289    2           FPT$OPNSCRB.WSN_=VECTOR(NIL);

   4289  2 001007   000012 237000 3                  LDAQ    10
         2 001010   000032 757100                    STAQ    26,,PR0

      538     4290    2           AWS.KDCB=GLOBAL.DCBNUMBER;

   4290  2 001011   000000 471400 xsym               LDP1    GLOBAL$
         2 001012   104623 721100                    LXL1    2451,,PR1
         2 001013   200012 473500                    LDP3    AWS$,,AUTO
         2 001014   300006 441100                    SXL1    6,,PR3

      539     4291    2           F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);

   4291  2 001015   000007 474400 3                  LDP4    7
         2 001016   400000 470500                    LDP0    0,,PR4
         2 001017   104623 722100                    LXL2    2451,,PR1
         2 001020   000000 236112                    LDQ     0,X2,PR0
         2 001021   200004 756100                    STQ     F$DCB$,,AUTO

      540     4292    2           IF F$DCB$->F$DCB.ORG#~=%KEYED# THEN

   4292  2 001022   200004 470500                    LDP0    F$DCB$,,AUTO
         2 001023   000032 236100                    LDQ     26,,PR0
         2 001024   777000 376003                    ANQ     -512,DU
         2 001025   002000 116003                    CMPQ    1024,DU
         2 001026   001062 601000 2                  TNZ     ER_NOTKEY

      541     4293    2               GOTO ER_NOTKEY;
      542     4294    2           IF F$DCB$->F$DCB.FUN#=%IN# AND ~F$DCB$->F$DCB.FFLG.READ# THEN

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:111  
   4294  2 001027   000032 236100                    LDQ     26,,PR0
         2 001030   000777 376003                    ANQ     511,DU
         2 001031   000002 116003                    CMPQ    2,DU
         2 001032   001037 601000 2                  TNZ     s:4296
         2 001033   000004 236100                    LDQ     4,,PR0
         2 001034   400000 376003                    ANQ     -131072,DU
         2 001035   400000 676003                    ERQ     -131072,DU
         2 001036   001057 601000 2                  TNZ     ER_KACCESS

      543     4295    2               GOTO ER_KACCESS;
      544     4296    2           IF F$DCB$->F$DCB.FUN#~=%IN# AND NOT(F$DCB$->F$DCB.FFLG.READ# AND

   4296  2 001037   000032 236100                    LDQ     26,,PR0
         2 001040   000777 376003                    ANQ     511,DU
         2 001041   000002 116003                    CMPQ    2,DU
         2 001042   001056 600000 2                  TZE     s:4301
         2 001043   000004 234100                    SZN     4,,PR0
         2 001044   001057 605000 2                  TPL     ER_KACCESS
         2 001045   000004 236100                    LDQ     4,,PR0
         2 001046   200000 316003                    CANQ    65536,DU
         2 001047   001057 600000 2                  TZE     ER_KACCESS
         2 001050   100000 316003                    CANQ    32768,DU
         2 001051   001057 600000 2                  TZE     ER_KACCESS
         2 001052   040000 316003                    CANQ    16384,DU
         2 001053   001057 600000 2                  TZE     ER_KACCESS
         2 001054   020000 316003                    CANQ    8192,DU
         2 001055   001057 600000 2                  TZE     ER_KACCESS

      545     4297    2              F$DCB$->F$DCB.FFLG.DELR# AND F$DCB$->F$DCB.FFLG.WNEW# AND
      546     4298    2              F$DCB$->F$DCB.FFLG.UPD# AND F$DCB$->F$DCB.FFLG.DELF#) THEN
      547     4299    2               GOTO ER_KACCESS;
      548     4300    2           END;

      549     4301    1       RETURN;

   4301  2 001056   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:112  
      550     4302        /* Errors that close both files */
      551     4303    1   ER_KACCESS: ERROR=ERR#IO#ACCESS;

   4303  2 001057   210750 236007       ER_KACCESS   LDQ     70120,DL
         2 001060   200005 756100                    STQ     ERROR,,AUTO

      552     4304    1       GOTO KCLOSE;

   4304  2 001061   001064 710000 2                  TRA     KCLOSE

      553     4305    1   ER_NOTKEY: ERROR=ERR#IO#NOTKEY;

   4305  2 001062   210707 235007       ER_NOTKEY    LDA     70087,DL
         2 001063   200005 755100                    STA     ERROR,,AUTO

      554     4306    1   KCLOSE: GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.KDCB;

   4306  2 001064   105072 470500       KCLOSE       LDP0    2618,,PR1
         2 001065   000032 741100                    STX1    26,,PR0

      555     4307    1       CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);

   4307  2 001066   105072 470500                    LDP0    2618,,PR1
         2 001067   050001 713400                    CLIMB   close
         2 001070   406000 401760                    pmme    nvectors=13

      556     4308    1       AWS.KDCB=0;

   4308  2 001071   000000 220003                    LDX0    0,DU
         2 001072   200012 470500                    LDP0    AWS$,,AUTO
         2 001073   000006 440100                    SXL0    6,,PR0

      557     4309    1       GOTO DCLOSE;

   4309  2 001074   001216 710000 2                  TRA     DCLOSE

      558     4310        /* Errors that close the data file */
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:113  
      559     4311    1   ER_NOTIDS: ERROR=ERR#IO#NOTIDS;

   4311  2 001075   210706 235007       ER_NOTIDS    LDA     70086,DL
         2 001076   200005 755100                    STA     ERROR,,AUTO

      560     4312    1       GOTO DCLOSE;

   4312  2 001077   001216 710000 2                  TRA     DCLOSE

      561     4313    1   ER_NOTIDX: ERROR=ERR#IO#NOTIDX;

   4313  2 001100   210757 235007       ER_NOTIDX    LDA     70127,DL
         2 001101   200005 755100                    STA     ERROR,,AUTO

      562     4314    1       GOTO DCLOSE;

   4314  2 001102   001216 710000 2                  TRA     DCLOSE

      563     4315    1   ER_ACCESS: ERROR=ERR#IO#ACCESS;

   4315  2 001103   210750 236007       ER_ACCESS    LDQ     70120,DL
         2 001104   200005 756100                    STQ     ERROR,,AUTO

      564     4316    1       GOTO DCLOSE;

   4316  2 001105   001216 710000 2                  TRA     DCLOSE

      565     4317    1   ER_JRNL: ERROR=ERR#IO#JRNL;

   4317  2 001106   210710 235007       ER_JRNL      LDA     70088,DL
         2 001107   200005 755100                    STA     ERROR,,AUTO

      566     4318    1       GOTO DCLOSE;

   4318  2 001110   001216 710000 2                  TRA     DCLOSE

   4308  2 001111                       ER_ENQIN     null
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:114  
      567     4319    1   ER_ENQIN: ;
      568     4320    2       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;

   4320  2 001111   000000 470400 xsym               LDP0    B$TCB$
         2 001112   000000 471500                    LDP1    0,,PR0
         2 001113   100102 236100                    LDQ     66,,PR1
         2 001114   377770 376007                    ANQ     131064,DL
         2 001115   014540 116007                    CMPQ    6496,DL
         2 001116   001127 601000 2                  TNZ     s:4325

      569     4321    2           GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;

   4321  2 001117   210763 235007                    LDA     70131,DL
         2 001120   000000 473400 xsym               LDP3    GLOBAL$
         2 001121   300006 755100                    STA     6,,PR3

      570     4322    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4322  2 001122   000000 471500                    LDP1    0,,PR0
         2 001123   100102 236100                    LDQ     66,,PR1
         2 001124   300007 756100                    STQ     7,,PR3

      571     4323    2           CALL M$ERR;

   4323  2 001125   000002 713400                    CLIMB   err
         2 001126   000000 401760                    pmme    nvectors=0

      572     4324    2           END;

      573     4325    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$TIMELIMIT THEN

   4325  2 001127   000000 470400 xsym               LDP0    B$TCB$
         2 001130   000000 471500                    LDP1    0,,PR0
         2 001131   100102 236100                    LDQ     66,,PR1
         2 001132   377770 376007                    ANQ     131064,DL
         2 001133   014420 116007                    CMPQ    6416,DL
         2 001134   001140 601000 2                  TNZ     s:4328
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:115  

      574     4326    1           ERROR=ERR#IO#SHALLIN;

   4326  2 001135   210745 235007                    LDA     70117,DL
         2 001136   200005 755100                    STA     ERROR,,AUTO
         2 001137   001142 710000 2                  TRA     s:4329

      575     4327    1       ELSE
      576     4328    1           ERROR=ERR#IO#CAC;

   4328  2 001140   303375 235007                    LDA     100093,DL
         2 001141   200005 755100                    STA     ERROR,,AUTO

      577     4329    1       GOTO DCLOSE;

   4329  2 001142   001216 710000 2                  TRA     DCLOSE

   4325  2 001143                       ER_ENQUP     null
      578     4330    1   ER_ENQUP: ;
      579     4331    2       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$ENQ_LIMIT THEN DO;

   4331  2 001143   000000 470400 xsym               LDP0    B$TCB$
         2 001144   000000 471500                    LDP1    0,,PR0
         2 001145   100102 236100                    LDQ     66,,PR1
         2 001146   377770 376007                    ANQ     131064,DL
         2 001147   014540 116007                    CMPQ    6496,DL
         2 001150   001161 601000 2                  TNZ     s:4336

      580     4332    2           GLOBAL.RET.ERROR#=ERR#IO#MAXENQ;

   4332  2 001151   210763 235007                    LDA     70131,DL
         2 001152   000000 473400 xsym               LDP3    GLOBAL$
         2 001153   300006 755100                    STA     6,,PR3

      581     4333    2           GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4333  2 001154   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:116  
         2 001155   100102 236100                    LDQ     66,,PR1
         2 001156   300007 756100                    STQ     7,,PR3

      582     4334    2           CALL M$ERR;

   4334  2 001157   000002 713400                    CLIMB   err
         2 001160   000000 401760                    pmme    nvectors=0

      583     4335    2           END;

      584     4336    1       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$TIMELIMIT THEN

   4336  2 001161   000000 470400 xsym               LDP0    B$TCB$
         2 001162   000000 471500                    LDP1    0,,PR0
         2 001163   100102 236100                    LDQ     66,,PR1
         2 001164   377770 376007                    ANQ     131064,DL
         2 001165   014420 116007                    CMPQ    6416,DL
         2 001166   001172 601000 2                  TNZ     s:4339

      585     4337    1           ERROR=ERR#IO#SHALLUP;

   4337  2 001167   210746 235007                    LDA     70118,DL
         2 001170   200005 755100                    STA     ERROR,,AUTO
         2 001171   001174 710000 2                  TRA     s:4340

      586     4338    1       ELSE
      587     4339    1           ERROR=ERR#IO#CAC;

   4339  2 001172   303375 235007                    LDA     100093,DL
         2 001173   200005 755100                    STA     ERROR,,AUTO

      588     4340    1       GOTO DCLOSE;

   4340  2 001174   001216 710000 2                  TRA     DCLOSE

      589     4341    1   ER_KDCB: ERROR=ERR#IO#GDCB;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:117  
   4341  2 001175   210676 235007       ER_KDCB      LDA     70078,DL
         2 001176   200005 755100                    STA     ERROR,,AUTO

      590     4342    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4342  2 001177   000000 470400 xsym               LDP0    B$TCB$
         2 001200   000000 471500                    LDP1    0,,PR0
         2 001201   100102 236100                    LDQ     66,,PR1
         2 001202   000000 473400 xsym               LDP3    GLOBAL$
         2 001203   300007 756100                    STQ     7,,PR3

      591     4343    1       GOTO DCLOSE;

   4343  2 001204   001216 710000 2                  TRA     DCLOSE

      592     4344    1   ER_KOPN: ERROR=ERR#IO#OPNK;

   4344  2 001205   210700 235007       ER_KOPN      LDA     70080,DL
         2 001206   200005 755100                    STA     ERROR,,AUTO

      593     4345    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4345  2 001207   000000 471400 xsym               LDP1    B$TCB$
         2 001210   100000 473500                    LDP3    0,,PR1
         2 001211   300102 236100                    LDQ     66,,PR3
         2 001212   000000 474400 xsym               LDP4    GLOBAL$
         2 001213   400007 756100                    STQ     7,,PR4

      594     4346    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   4346  2 001214   404623 721100                    LXL1    2451,,PR4
         2 001215   400014 741100                    STX1    12,,PR4

      595     4347    1   DCLOSE: GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.DDCB;

   4347  2 001216   000000 470400 xsym  DCLOSE       LDP0    GLOBAL$
         2 001217   005072 471500                    LDP1    2618,,PR0
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:118  
         2 001220   200012 473500                    LDP3    AWS$,,AUTO
         2 001221   300006 220100                    LDX0    6,,PR3
         2 001222   100032 740100                    STX0    26,,PR1

      596     4348    1       CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);

   4348  2 001223   005072 471500                    LDP1    2618,,PR0
         2 001224   100000 630500                    EPPR0   0,,PR1
         2 001225   050001 713400                    CLIMB   close
         2 001226   406000 401760                    pmme    nvectors=13

      597     4349    1       AWS.DDCB=0;

   4349  2 001227   000000 220003                    LDX0    0,DU
         2 001230   200012 470500                    LDP0    AWS$,,AUTO
         2 001231   000006 740100                    STX0    6,,PR0

      598     4350    1       GOTO ALT;

   4350  2 001232   001301 710000 2                  TRA     ALT

      599     4351        /* Errors that just set error codes */
      600     4352    1   ER_AIR: ERROR=EXC#AIR;

   4352  2 001233   022124 235007       ER_AIR       LDA     9300,DL
         2 001234   200005 755100                    STA     ERROR,,AUTO

      601     4353    1       GOTO ALT;

   4353  2 001235   001301 710000 2                  TRA     ALT

      602     4354    1   ER_DDCB: ERROR=ERR#IO#GDCB;

   4354  2 001236   210676 235007       ER_DDCB      LDA     70078,DL
         2 001237   200005 755100                    STA     ERROR,,AUTO

      603     4355    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:119  

   4355  2 001240   000000 470400 xsym               LDP0    B$TCB$
         2 001241   000000 471500                    LDP1    0,,PR0
         2 001242   100102 236100                    LDQ     66,,PR1
         2 001243   000000 473400 xsym               LDP3    GLOBAL$
         2 001244   300007 756100                    STQ     7,,PR3

      604     4356    1       GOTO ALT;

   4356  2 001245   001301 710000 2                  TRA     ALT

      605     4357    1   ER_DFLT: ERROR=ERR#IO#OPND;

   4357  2 001246   210677 235007       ER_DFLT      LDA     70079,DL
         2 001247   200005 755100                    STA     ERROR,,AUTO

      606     4358    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4358  2 001250   000000 470400 xsym               LDP0    B$TCB$
         2 001251   000000 471500                    LDP1    0,,PR0
         2 001252   100102 236100                    LDQ     66,,PR1
         2 001253   000000 473400 xsym               LDP3    GLOBAL$
         2 001254   300007 756100                    STQ     7,,PR3

      607     4359    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   4359  2 001255   304623 720100                    LXL0    2451,,PR3
         2 001256   300014 740100                    STX0    12,,PR3

      608     4360    1       GOTO ALT;

   4360  2 001257   001301 710000 2                  TRA     ALT

      609     4361    1   ER_DOPN: IF AWS.ATRIB.INDEXED THEN

   4361  2 001260   200012 471500       ER_DOPN      LDP1    AWS$,,AUTO
         2 001261   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:120  
         2 001262   000010 316003                    CANQ    8,DU
         2 001263   001267 600000 2                  TZE     s:4364

      610     4362    1           ERROR=ERR#IO#OPNI;

   4362  2 001264   210760 235007                    LDA     70128,DL
         2 001265   200005 755100                    STA     ERROR,,AUTO
         2 001266   001271 710000 2                  TRA     s:4365

      611     4363    1       ELSE
      612     4364    1           ERROR=ERR#IO#OPND;

   4364  2 001267   210677 235007                    LDA     70079,DL
         2 001270   200005 755100                    STA     ERROR,,AUTO

      613     4365    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4365  2 001271   000000 473400 xsym               LDP3    B$TCB$
         2 001272   300000 474500                    LDP4    0,,PR3
         2 001273   400102 236100                    LDQ     66,,PR4
         2 001274   000000 470400 xsym               LDP0    GLOBAL$
         2 001275   000007 756100                    STQ     7,,PR0

      614     4366    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   4366  2 001276   004623 720100                    LXL0    2451,,PR0
         2 001277   000014 740100                    STX0    12,,PR0

      615     4367    1       GOTO ALT;

   4367  2 001300   001301 710000 2                  TRA     ALT

   4366  2 001301                       ALT          null
      616     4368    1   ALT: ;
      617     4369            %DBALT;

   4370  2 001301   000000 470400 xsym               LDP0    GLOBAL$
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:121  
         2 001302   000006 235100                    LDA     6,,PR0
         2 001303   001312 601000 2                  TNZ     s:4378

   4372  2 001304   000010 450100                    STZ     8,,PR0

   4373  2 001305   000012 450100                    STZ     10,,PR0

   4374  2 001306   000013 450100                    STZ     11,,PR0

   4375  2 001307   000011 450100                    STZ     9,,PR0

   4376  2 001310   200005 236100                    LDQ     ERROR,,AUTO
         2 001311   000006 756100                    STQ     6,,PR0

   4378  2 001312   000006 235100                    LDA     6,,PR0
         2 001313   303240 115007                    CMPA    100000,DL
         2 001314   001316 603000 2                  TRC     s:4381

   4379  2 001315   000000 702200 xent               TSX2  ! X66_AALT

   4381  2 001316   000023 631400 3                  EPPR1   19
         2 001317   000000 701000 xent               TSX1    ZIB$ERR
         2 001320   000000 011000                    NOP     0

      618     4383    1   END ZIM$OPEN;

   4383  2 001321   000000 702200 xent               TSX2  ! X66_ARET

IDSSCHEMA
 Sect OctLoc
   0     000   061111 ******                                                    1I..

(unnamed)
 Sect OctLoc
   0     001   111111 040040                                                    II

(unnamed)
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:122  
 Sect OctLoc
   3     000   777777 577777   777777 777747   677777 777777   776777 777777    ................
   3     004   777777 777637   000025 777640   777777 776377   000000 006003    ................
   3     010   637777 777777   757777 777777   000000 177640   000000 006014    ................
   3     014   777776 777777   777777 637777   577777 777777   777777 377777    ................
   3     020   072040 040040   000001 777640   000003 777640   000000 000000    :   ............
      619     4384        %EOD;

PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:123  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$OPEN.

   Procedure ZIM$OPEN requires 722 words for executable code.
   Procedure ZIM$OPEN requires 14 words of local(AUTO) storage.
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:124  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:125  
          MINI XREF LISTING

ALT
      4366**LABEL    4350--GOTO     4353--GOTO     4356--GOTO     4360--GOTO     4367--GOTO
AWS.ATRIB.ATMP
      2598**DCL      4101>>IF       4140>>IF       4229>>IF
AWS.ATRIB.CAC
      2603**DCL      4160<<ASSIGN   4169<<ASSIGN   4172<<ASSIGN   4173>>IF       4191<<ASSIGN   4197<<ASSIGN
      4200<<ASSIGN   4221>>IF
AWS.ATRIB.CANSSS
      2597**DCL      4173>>IF
AWS.ATRIB.CJRNL
      2590**DCL      4102<<ASSIGN   4157<<ASSIGN
AWS.ATRIB.CURONLY
      2589**DCL      4220<<ASSIGN   4227<<ASSIGN
AWS.ATRIB.FUN
      2599**DCL      4105<<ASSIGN   4127>>ASSIGN   4140>>IF       4140>>IF
AWS.ATRIB.INDEXED
      2600**DCL      4110>>IF       4122>>IF       4148>>IF       4150>>IF       4361>>IF
AWS.ATRIB.KEYED
      2601**DCL      4235>>IF
AWS.ATRIB.LOAD
      2602**DCL      4122>>IF
AWS.ATRIB.SHANY
      2595**DCL      4104<<ASSIGN   4145<<ASSIGN   4158>>IF       4186>>IF
AWS.ATRIB.SHARE
      2594**DCL      4103<<ASSIGN   4126>>ASSIGN   4140>>IF       4146<<ASSIGN
AWS.ATRIB.TJRNL
      2592**DCL      4156<<ASSIGN   4201<<ASSIGN   4204>>IF       4209>>IF       4229>>IF
AWS.ATRIB.UNPROTECT
      2604**DCL      4232<<ASSIGN   4234<<ASSIGN
AWS.DDCB
      2611**DCL      4080>>IF       4147<<ASSIGN   4347>>ASSIGN   4349<<ASSIGN
AWS.HIGHPG
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:126  
      2609**DCL      4111>>ASSIGN
AWS.KDCB
      2612**DCL      4290<<ASSIGN   4306>>ASSIGN   4308<<ASSIGN
AWS$
      2585**DCL      2586--IMP-PTR  4079<<ASSIGN   4080>>IF       4101>>IF       4102>>ASSIGN   4103>>ASSIGN
      4104>>ASSIGN   4105>>ASSIGN   4110>>IF       4111>>ASSIGN   4122>>IF       4122>>IF       4126>>ASSIGN
      4127>>ASSIGN   4140>>IF       4140>>IF       4140>>IF       4140>>IF       4145>>ASSIGN   4146>>ASSIGN
      4147>>ASSIGN   4148>>IF       4150>>IF       4156>>ASSIGN   4157>>ASSIGN   4158>>IF       4160>>ASSIGN
      4169>>ASSIGN   4172>>ASSIGN   4173>>IF       4173>>IF       4186>>IF       4191>>ASSIGN   4197>>ASSIGN
      4200>>ASSIGN   4201>>ASSIGN   4204>>IF       4209>>IF       4220>>ASSIGN   4221>>IF       4227>>ASSIGN
      4229>>IF       4229>>IF       4232>>ASSIGN   4234>>ASSIGN   4235>>IF       4290>>ASSIGN   4306>>ASSIGN
      4308>>ASSIGN   4347>>ASSIGN   4349>>ASSIGN   4361>>IF
B$ALT.CODE
       101**DCL       101--REDEF     102--REDEF     102--REDEF
B$ALT.ERR
       102**DCL      4322>>ASSIGN   4333>>ASSIGN   4342>>ASSIGN   4345>>ASSIGN   4355>>ASSIGN   4358>>ASSIGN
      4365>>ASSIGN
B$ALT.ERR.ERR#
       103**DCL       103--REDEF    4320>>IF       4325>>IF       4331>>IF       4336>>IF
B$ALT.EVID
       102**DCL       102--REDEF     102--REDEF
B$TCB.ALT$
        97**DCL      4320>>IF       4322>>ASSIGN   4325>>IF       4331>>IF       4333>>ASSIGN   4336>>IF
      4342>>ASSIGN   4345>>ASSIGN   4355>>ASSIGN   4358>>ASSIGN   4365>>ASSIGN
B$TCB$
        11**DCL      4320>>IF       4322>>ASSIGN   4325>>IF       4331>>IF       4333>>ASSIGN   4336>>IF
      4342>>ASSIGN   4345>>ASSIGN   4355>>ASSIGN   4358>>ASSIGN   4365>>ASSIGN
DCLOSE
      4347**LABEL    4309--GOTO     4312--GOTO     4314--GOTO     4316--GOTO     4318--GOTO     4329--GOTO
      4340--GOTO     4343--GOTO
ERROR
        14**DCL      4303<<ASSIGN   4305<<ASSIGN   4311<<ASSIGN   4313<<ASSIGN   4315<<ASSIGN   4317<<ASSIGN
      4326<<ASSIGN   4328<<ASSIGN   4337<<ASSIGN   4339<<ASSIGN   4341<<ASSIGN   4344<<ASSIGN   4352<<ASSIGN
      4354<<ASSIGN   4357<<ASSIGN   4362<<ASSIGN   4364<<ASSIGN   4376>>ASSIGN
ER_ACCESS
      4315**LABEL    4155--GOTO     4180--GOTO     4185--GOTO
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:127  
ER_AIR
      4352**LABEL    4081--GOTO
ER_DDCB
      4354**LABEL    4086--CALLALT  4089--CALLALT
ER_DFLT
      4357**LABEL    4095--CALLALT
ER_DOPN
      4361**LABEL    4137--GOTO
ER_ENQIN
      4308**LABEL    4168--CALLALT
ER_ENQUP
      4325**LABEL    4190--CALLALT
ER_JRNL
      4317**LABEL    4175--GOTO     4208--GOTO     4211--GOTO     4216--GOTO
ER_KACCESS
      4303**LABEL    4295--GOTO     4299--GOTO
ER_KDCB
      4341**LABEL    4242--CALLALT
ER_KOPN
      4344**LABEL    4280--GOTO
ER_NOTIDS
      4311**LABEL    4151--GOTO
ER_NOTIDX
      4313**LABEL    4149--GOTO
ER_NOTKEY
      4305**LABEL    4293--GOTO
F$DCB.ACCT#
       664**DCL      4249>>ASSIGN
F$DCB.ACTPOS
       680**DCL       680--REDEF
F$DCB.ARS#
       654**DCL       654--REDEF
F$DCB.ATTR
       673**DCL       674--REDEF
F$DCB.BORROW
       688**DCL       688--REDEF     688--REDEF     688--REDEF
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:128  
F$DCB.CTG#
       668**DCL      4261>>ASSIGN
F$DCB.DCBNAME.L
       702**DCL       702--IMP-SIZ
F$DCB.DISP#
       669**DCL      4258>>ASSIGN
F$DCB.EOMCHAR#
       658**DCL       658--REDEF
F$DCB.EXIST#
       668**DCL      4259>>ASSIGN
F$DCB.EXPIRE#
       671**DCL      4262>>ASSIGN
F$DCB.FFLG.DELF#
       659**DCL      4181>>IF       4296>>IF
F$DCB.FFLG.DELR#
       659**DCL      4181>>IF       4296>>IF
F$DCB.FFLG.READ#
       659**DCL      4154>>IF       4179>>IF       4294>>IF       4296>>IF
F$DCB.FFLG.UPD#
       659**DCL      4179>>IF       4296>>IF
F$DCB.FFLG.WNEW#
       659**DCL      4181>>IF       4296>>IF
F$DCB.FLDID
       683**DCL       683--REDEF
F$DCB.FORM$
       677**DCL       677--REDEF
F$DCB.FSECT
       693**DCL       693--REDEF
F$DCB.FSN#
       670**DCL       670--REDEF     670--REDEF     671--REDEF
F$DCB.FUN#
       669**DCL      4152>>IF       4229>>IF       4257>>ASSIGN   4294>>IF       4296>>IF
F$DCB.HEADER$
       676**DCL       676--REDEF
F$DCB.IXTNSIZE#
       674**DCL       674--REDEF    4266>>ASSIGN
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:129  
F$DCB.LASTSTA$
       663**DCL       663--REDEF
F$DCB.LRDL0#
       672**DCL      4263>>ASSIGN
F$DCB.LSLIDE#
       672**DCL      4264>>ASSIGN
F$DCB.LVL
       689**DCL       689--REDEF
F$DCB.NAME#.C
       664**DCL       664--REDEF    4244>>ASSIGN
F$DCB.NAME#.L
       664**DCL      4243>>ASSIGN
F$DCB.NOEOF
       686**DCL       686--REDEF
F$DCB.NRECS#
       675**DCL       675--REDEF
F$DCB.NRECX
       694**DCL       694--REDEF
F$DCB.OHDR
       686**DCL       686--REDEF
F$DCB.ORG#
       669**DCL       669--REDEF    4148>>IF       4150>>IF       4181>>IF       4229>>IF       4292>>IF
F$DCB.PASS#
       664**DCL      4251--ASSIGN
F$DCB.PRECNO
       692**DCL       692--REDEF
F$DCB.PSN#
       664**DCL      4252>>ASSIGN
F$DCB.RCSZ
       698**DCL       698--REDEF
F$DCB.RES#
       665**DCL       665--REDEF
F$DCB.SETX
       677**DCL       677--REDEF
F$DCB.SHARE#
       668**DCL      4140>>IF       4140>>IF       4146>>ASSIGN   4164>>IF       4196>>IF       4268>>ASSIGN
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:130  
F$DCB.TAB$
       677**DCL       677--REDEF
F$DCB.TDA
       691**DCL       692--REDEF
F$DCB.UOPT#
       667**DCL      4140>>IF       4224>>IF
F$DCB.WSN#
       665**DCL       665--REDEF    4254--ASSIGN
F$DCB.XTNSIZE#
       672**DCL      4267>>ASSIGN
F$DCB$
        12**DCL      4128<<ASSIGN   4140>>IF       4140>>IF       4140>>IF       4146>>ASSIGN   4148>>IF
      4150>>IF       4152>>IF       4154>>IF       4164>>IF       4179>>IF       4179>>IF       4181>>IF
      4181>>IF       4181>>IF       4181>>IF       4196>>IF       4224>>IF       4229>>IF       4229>>IF
      4243>>ASSIGN   4244>>ASSIGN   4249>>ASSIGN   4251>>ASSIGN   4252>>ASSIGN   4254>>ASSIGN   4257>>ASSIGN
      4258>>ASSIGN   4259>>ASSIGN   4261>>ASSIGN   4262>>ASSIGN   4263>>ASSIGN   4264>>ASSIGN   4266>>ASSIGN
      4267>>ASSIGN   4268>>ASSIGN   4291<<ASSIGN   4292>>IF       4294>>IF       4294>>IF       4296>>IF
      4296>>IF       4296>>IF       4296>>IF       4296>>IF       4296>>IF
FPT$
        10**DCL       784--IMP-PTR   893--IMP-PTR  1002--IMP-PTR  4090<<ASSIGN   4091>>ASSIGN   4092>>ASSIGN
      4093>>ASSIGN   4095>>CALL     4097<<ASSIGN   4098>>ASSIGN   4099>>ASSIGN   4100>>ASSIGN   4106>>ASSIGN
      4107>>ASSIGN   4108>>ASSIGN   4109>>ASSIGN   4111>>ASSIGN   4112>>ASSIGN   4113>>ASSIGN   4114>>ASSIGN
      4117>>ASSIGN   4118>>ASSIGN   4119>>ASSIGN   4123>>ASSIGN   4125>>ASSIGN   4126>>ASSIGN   4127>>ASSIGN
      4131>>ASSIGN   4133>>ASSIGN   4134>>CALL     4136>>ASSIGN   4139>>ASSIGN   4250<<ASSIGN   4251>>ASSIGN
      4253>>ASSIGN   4254>>ASSIGN   4255>>ASSIGN   4256>>ASSIGN   4257>>ASSIGN   4258>>ASSIGN   4259>>ASSIGN
      4260>>ASSIGN   4261>>ASSIGN   4262>>ASSIGN   4263>>ASSIGN   4264>>ASSIGN   4265>>ASSIGN   4266>>ASSIGN
      4267>>ASSIGN   4268>>ASSIGN   4269>>CALL     4271>>ASSIGN   4272>>ASSIGN   4273>>ASSIGN   4274>>ASSIGN
      4275>>ASSIGN   4276>>ASSIGN   4277>>ASSIGN   4278>>ASSIGN   4279>>ASSIGN   4282>>ASSIGN   4283>>ASSIGN
      4284>>ASSIGN   4285>>ASSIGN   4286>>ASSIGN   4287>>ASSIGN   4288>>ASSIGN   4289>>ASSIGN
FPT$CLOSE
      1087**DCL      4307<>CALL     4348<>CALL
FPT$CLOSE.SN_
      1087**DCL      1087--REDEF
FPT$CLOSE.UTL_
      1088**DCL      1088--REDEF
FPT$CLOSE.V.DCB#
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:131  
      1093**DCL      4306<<ASSIGN   4347<<ASSIGN
FPT$CLOSE.V.EXPIRE#
      1102**DCL      1102--REDEF
FPT$CLOSE.V.TYPE#
      1100**DCL      1100--REDEF
FPT$CLOSE.V.XTNSIZE#
      1097**DCL      1097--REDEF    1099--REDEF
FPT$ENQS
      1057**DCL      4168<>CALL     4190<>CALL
FPT$ENQS.V.DCB#
      1058**DCL      4167<<ASSIGN   4189<<ASSIGN
FPT$ENQS.V.SHARE#
      1059**DCL      4166<<ASSIGN   4188<<ASSIGN
FPT$GETDCB
       715**DCL      4086<>CALL     4089<>CALL     4242<>CALL
FPT$GETDCB.V.TEST#
       717**DCL      4085<<ASSIGN   4088<<ASSIGN   4241<<ASSIGN
FPT$OPEN
       893**DCL      4134<>CALL
FPT$OPEN.ACSVEH_
       895**DCL       896--REDEF
FPT$OPEN.ALTKEYS_
       901**DCL       902--REDEF     902--REDEF    4114<<ASSIGN   4136<<ASSIGN   4139<<ASSIGN
FPT$OPEN.HDR_
       900**DCL       901--REDEF
FPT$OPEN.TAB_
       899**DCL       900--REDEF
FPT$OPEN.UHL_
       893**DCL       894--REDEF     894--REDEF
FPT$OPEN.V.ACS#
       913**DCL      4100<<ASSIGN
FPT$OPEN.V.ASN#
       912**DCL      4099<<ASSIGN
FPT$OPEN.V.CTG#
       906**DCL      4107<<ASSIGN
FPT$OPEN.V.DCB#
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:132  
       902**DCL      4098<<ASSIGN
FPT$OPEN.V.DISP#
       918**DCL      4106<<ASSIGN
FPT$OPEN.V.EXIST#
       906**DCL      4108<<ASSIGN
FPT$OPEN.V.FSN#
       933**DCL       933--REDEF     933--REDEF
FPT$OPEN.V.FUN#
       912**DCL      4127<<ASSIGN
FPT$OPEN.V.IXTNSIZE#
       921**DCL      4111<<ASSIGN   4117<<ASSIGN
FPT$OPEN.V.LOAD#
       916**DCL      4123<<ASSIGN   4125<<ASSIGN
FPT$OPEN.V.ORG#
       913**DCL      4113<<ASSIGN   4119<<ASSIGN
FPT$OPEN.V.SHARE#
       907**DCL      4126<<ASSIGN
FPT$OPEN.V.TYPE#
       914**DCL      4109<<ASSIGN
FPT$OPEN.V.UOPT#
       912**DCL      4131<<ASSIGN   4133<<ASSIGN
FPT$OPEN.V.XTNSIZE#
       921**DCL      4112<<ASSIGN   4118<<ASSIGN
FPT$OPEN.WSN_
       899**DCL       899--REDEF
FPT$OPNDFLT
       784**DCL      4095<>CALL
FPT$OPNDFLT.ACSVEH_
       786**DCL       787--REDEF
FPT$OPNDFLT.ALTKEYS_
       792**DCL       793--REDEF     793--REDEF
FPT$OPNDFLT.HDR_
       791**DCL       792--REDEF
FPT$OPNDFLT.TAB_
       790**DCL       791--REDEF
FPT$OPNDFLT.UHL_
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:133  
       784**DCL       785--REDEF     785--REDEF
FPT$OPNDFLT.V.ASN#
       803**DCL      4092<<ASSIGN
FPT$OPNDFLT.V.DCB#
       793**DCL      4091<<ASSIGN
FPT$OPNDFLT.V.FSN#
       824**DCL       824--REDEF     824--REDEF
FPT$OPNDFLT.V.SHARE#
       798**DCL      4093<<ASSIGN
FPT$OPNDFLT.WSN_
       790**DCL       790--REDEF
FPT$OPNSCRB
      1002**DCL      4269<>CALL
FPT$OPNSCRB.ACSVEH_
      1004**DCL      1005--REDEF
FPT$OPNSCRB.ALTKEYS_
      1010**DCL      1011--REDEF    1011--REDEF
FPT$OPNSCRB.HDR_
      1009**DCL      1010--REDEF
FPT$OPNSCRB.PASS_
      1004**DCL      4251<<ASSIGN   4276<<ASSIGN   4287<<ASSIGN
FPT$OPNSCRB.SN_
      1002**DCL      4253<<ASSIGN   4277<<ASSIGN   4279<<ASSIGN   4288<<ASSIGN
FPT$OPNSCRB.TAB_
      1008**DCL      1009--REDEF
FPT$OPNSCRB.UHL_
      1002**DCL      1003--REDEF    1003--REDEF
FPT$OPNSCRB.V.ACS#
      1022**DCL      4256<<ASSIGN
FPT$OPNSCRB.V.CTG#
      1015**DCL      4261<<ASSIGN
FPT$OPNSCRB.V.DCB#
      1011**DCL      4255<<ASSIGN
FPT$OPNSCRB.V.DISP#
      1027**DCL      4258<<ASSIGN
FPT$OPNSCRB.V.EXIST#
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:134  
      1015**DCL      4259<<ASSIGN
FPT$OPNSCRB.V.EXPIRE#
      1031**DCL      4262<<ASSIGN   4271<<ASSIGN   4282<<ASSIGN
FPT$OPNSCRB.V.FSN#
      1042**DCL      1042--REDEF    1042--REDEF
FPT$OPNSCRB.V.FUN#
      1021**DCL      4257<<ASSIGN
FPT$OPNSCRB.V.IXTNSIZE#
      1030**DCL      4266<<ASSIGN   4274<<ASSIGN   4285<<ASSIGN
FPT$OPNSCRB.V.LRDL0#
      1029**DCL      4263<<ASSIGN   4272<<ASSIGN   4283<<ASSIGN
FPT$OPNSCRB.V.LSLIDE#
      1028**DCL      4264<<ASSIGN   4273<<ASSIGN   4284<<ASSIGN
FPT$OPNSCRB.V.ORG#
      1022**DCL      4260<<ASSIGN
FPT$OPNSCRB.V.SHARE#
      1016**DCL      4268<<ASSIGN
FPT$OPNSCRB.V.TYPE#
      1023**DCL      4265<<ASSIGN
FPT$OPNSCRB.V.XTNSIZE#
      1030**DCL      4267<<ASSIGN   4275<<ASSIGN   4286<<ASSIGN
FPT$OPNSCRB.WSN_
      1008**DCL      1008--REDEF    4254<<ASSIGN   4278<<ASSIGN   4289<<ASSIGN
GLOBAL.ACCT
      1858**DCL      4249<<ASSIGN
GLOBAL.ACTIVE.DBCB$
      1641**DCL      1642--REDEF
GLOBAL.ACTIVE.DBNO
      1645**DCL      4229>>IF
GLOBAL.ACTIVE.SSS$
      1637**DCL      1638--REDEF
GLOBAL.ALTKEYS$
      1930**DCL      4114>>ASSIGN   4117>>ASSIGN   4118>>ASSIGN
GLOBAL.CAC
      1836**DCL      4204>>IF       4223<<ASSIGN   4223>>ASSIGN
GLOBAL.CLOSE$
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:135  
      1896**DCL      4306>>ASSIGN   4307>>CALL     4347>>ASSIGN   4348>>CALL
GLOBAL.DB.FLAGS.SYSSUB
      1737**DCL      4229>>IF
GLOBAL.DCBNAME.LENGTH
      1856**DCL      4082>>IF       4084<<ASSIGN   4237>>IF       4238<<ASSIGN   4238>>ASSIGN   4239>>CALLBLT
GLOBAL.DCBNAME.TEXT
      1857**DCL      4239<<CALLBLT
GLOBAL.DCBNUMBER
      1844**DCL      4087>>IF       4091>>ASSIGN   4098>>ASSIGN   4128--ASSIGN   4147>>ASSIGN   4167>>ASSIGN
      4189>>ASSIGN   4255>>ASSIGN   4290>>ASSIGN   4291--ASSIGN   4346>>ASSIGN   4359>>ASSIGN   4366>>ASSIGN
GLOBAL.ENQS$
      1921**DCL      4166>>ASSIGN   4167>>ASSIGN   4168>>CALL     4188>>ASSIGN   4189>>ASSIGN   4190>>CALL
GLOBAL.FILENAME.LENGTH
      1853**DCL      4243<<ASSIGN   4245>>IF       4246<<ASSIGN   4246>>ASSIGN   4247>>CALLBLT
GLOBAL.FILENAME.TEXT
      1854**DCL      4244<<ASSIGN   4247<<CALLBLT
GLOBAL.GETDCB$
      1906**DCL      4085>>ASSIGN   4086>>CALL     4088>>ASSIGN   4089>>CALL     4241>>ASSIGN   4242>>CALL
GLOBAL.KEY
      1845**DCL      1848--REDEF
GLOBAL.OPEN$
      1892**DCL      4097>>ASSIGN
GLOBAL.OPNDFLT$
      1893**DCL      4090>>ASSIGN
GLOBAL.OPNSCRB$
      1894**DCL      4250>>ASSIGN
GLOBAL.PARAN.IO.AWS$
      1684**DCL      4079>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
      1720**DCL      1727--REDEF
GLOBAL.PENDING.CURONLY
      1678**DCL      4130>>IF       4224>>IF
GLOBAL.PENDING.SHARE
      1670**DCL      4224>>IF
GLOBAL.PRINTBUF.BUFFER
      1879**DCL      1880--REDEF    1881--REDEF    1882--REDEF
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:136  
GLOBAL.PRINTBUF.ERR.V
      1884**DCL      1887--REDEF    1888--REDEF    1889--REDEF
GLOBAL.RET.AC#
      1657**DCL      4372<<ASSIGN
GLOBAL.RET.DCB#
      1661**DCL      4346<<ASSIGN   4359<<ASSIGN   4366<<ASSIGN
GLOBAL.RET.ERROR#
      1655**DCL      4321<<ASSIGN   4332<<ASSIGN   4370>>IF       4376<<ASSIGN   4378>>IF
GLOBAL.RET.FR#
      1658**DCL      4375<<ASSIGN
GLOBAL.RET.RC#
      1660**DCL      4374<<ASSIGN
GLOBAL.RET.SC#
      1659**DCL      4373<<ASSIGN
GLOBAL.RET.SYSERR#
      1656**DCL      4322<<ASSIGN   4333<<ASSIGN   4342<<ASSIGN   4345<<ASSIGN   4355<<ASSIGN   4358<<ASSIGN
      4365<<ASSIGN
GLOBAL.SHANY
      1837**DCL      4161<<ASSIGN   4161>>ASSIGN   4192<<ASSIGN   4192>>ASSIGN
GLOBAL.UPDATE.NOTJRNL
      1835**DCL      4173>>IF       4210>>IF       4218<<ASSIGN   4218>>ASSIGN
GLOBAL.UPDATE.TJRNL
      1834**DCL      4213<<ASSIGN   4213>>ASSIGN   4215>>IF
GLOBAL$
      1939**DCL      1635--IMP-PTR  4079>>ASSIGN   4082>>IF       4084>>ASSIGN   4085>>ASSIGN   4086>>CALL
      4087>>IF       4088>>ASSIGN   4089>>CALL     4090>>ASSIGN   4091>>ASSIGN   4097>>ASSIGN   4098>>ASSIGN
      4114>>ASSIGN   4117>>ASSIGN   4118>>ASSIGN   4128>>ASSIGN   4130>>IF       4147>>ASSIGN   4161>>ASSIGN
      4161>>ASSIGN   4166>>ASSIGN   4167>>ASSIGN   4167>>ASSIGN   4168>>CALL     4173>>IF       4188>>ASSIGN
      4189>>ASSIGN   4189>>ASSIGN   4190>>CALL     4192>>ASSIGN   4192>>ASSIGN   4204>>IF       4210>>IF
      4213>>ASSIGN   4213>>ASSIGN   4215>>IF       4218>>ASSIGN   4218>>ASSIGN   4223>>ASSIGN   4223>>ASSIGN
      4224>>IF       4224>>IF       4229>>IF       4229>>IF       4237>>IF       4238>>ASSIGN   4238>>ASSIGN
      4239>>CALLBLT  4239>>CALLBLT  4241>>ASSIGN   4242>>CALL     4243>>ASSIGN   4244>>ASSIGN   4245>>IF
      4246>>ASSIGN   4246>>ASSIGN   4247>>CALLBLT  4247>>CALLBLT  4249>>ASSIGN   4250>>ASSIGN   4255>>ASSIGN
      4290>>ASSIGN   4291>>ASSIGN   4306>>ASSIGN   4307>>CALL     4321>>ASSIGN   4322>>ASSIGN   4332>>ASSIGN
      4333>>ASSIGN   4342>>ASSIGN   4345>>ASSIGN   4346>>ASSIGN   4346>>ASSIGN   4347>>ASSIGN   4348>>CALL
      4355>>ASSIGN   4358>>ASSIGN   4359>>ASSIGN   4359>>ASSIGN   4365>>ASSIGN   4366>>ASSIGN   4366>>ASSIGN
PL6.E3A0      #002=ZIM$OPEN File=ZIM$OPEN.:ZIC0TSI                               FRI 09/05/97 13:03 Page:137  
      4370>>IF       4372>>ASSIGN   4373>>ASSIGN   4374>>ASSIGN   4375>>ASSIGN   4376>>ASSIGN   4378>>IF
KCLOSE
      4306**LABEL    4304--GOTO
M$CLOSE
        24**DCL-ENT  4307--CALL     4348--CALL
M$ENQ
        90**DCL-ENT  4168--CALL     4190--CALL
M$ERR
        36**DCL-ENT  4323--CALL     4334--CALL
M$GETDCB
        30**DCL-ENT  4086--CALL     4089--CALL     4242--CALL
M$OPEN
        24**DCL-ENT  4095--CALL     4134--CALL     4269--CALL
VLP$ALTKEYS
      1131**DCL      4114--ASSIGN
VLP$ALTKEYS.SIZ#
      1131**DCL      4117>>ASSIGN   4118>>ASSIGN
VLP_SN
      1146**DCL      4253--ASSIGN
VLP_SN.SN#
      1146**DCL      4252<<ASSIGN
ZIB$ERR
      1940**DCL-ENT  4381--CALL

PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:138  
      620        1        /*T***********************************************************/
      621        2        /*T*                                                         */
      622        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      623        4        /*T*                                                         */
      624        5        /*T***********************************************************/
      625        6        ZIO$DFLTOPN: PROC (DEVICE) ALTRET
      626        7         /* USE($PR5 FOR GLOBAL$) */
      627        8               AVOID($PR5,$PR6,$PR7);
      628        9    1   DCL DEVICE CHAR(4) ;
      629       10        %INCLUDE ZI$GLOBAL;
      630      496         %GLOBALS;
      631      804        %INCLUDE CP_6;
      632      885         %FPT_GETDCB(FPTN=FPT$GETDCB,STCLASS=BASED);
      633      900         %FPT_OPEN(FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      634     1009         %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      635     1118         %F$DCB;
      636     1175         %B$TCB;
      637     1178         %B$ALT;
      638     1186        %INCLUDE CP_6_SUBS;
      639     1726    1   DCL FPT$ PTR;
      640     1727    1   DCL B$TCB$ PTR SYMREF;
      641     1728    1       GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;
      642     1729    1       CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);
      643     1730    2       IF GLOBAL.DCBNUMBER=0 THEN DO;
      644     1731    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;
      645     1732    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);
      646     1733    2           FPT$=GLOBAL.OPNDFLT$;
      647     1734    2           FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;
      648     1735    2           FPT$OPNDFLT.V.IXTNSIZE#=2;
      649     1736    2           FPT$OPNDFLT.V.XTNSIZE#=2;
      650     1737    2           FPT$OPNDFLT.V.RES#=DEVICE;
      651     1738    2           FPT$OPNDFLT.V.ASN#=%DEVICE#;
      652     1739    2           FPT$OPNDFLT.V.FUN#=%CREATE#;
      653     1740    2           FPT$OPNDFLT.V.EXIST#=%OLDFILE#;
      654     1741    2           FPT$OPNDFLT.V.DISP#=%NAMED#;
      655     1742    2           FPT$OPNDFLT.V.CTG#=%YES#;
      656     1743    2           FPT$OPNDFLT.V.TYPE#='  ';
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:139  
      657     1744    2           FPT$OPNDFLT.V.SHARE#=%ALL#;
      658     1745    2           FPT$OPNDFLT.V.ORG#=%CONSEC#;
      659     1746    2           GLOBAL.FILENAME.LENGTH=0;
      660     1747    2           GLOBAL.ACCT=' ';
      661     1748    2           CALL M$OPEN(FPT$OPNDFLT)
      662     1749    3           WHENALTRETURN DO;
      663     1750    3               FPT$OPNDFLT.V.RES#=' ';
      664     1751    3               GOTO ER_OPEN;
      665     1752    3               END;
      666     1753    2           FPT$OPNDFLT.V.RES#=' ';
      667     1754    2           END;
      668     1755    1       ELSE
      669     1756    1           IF DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.FCD# THEN
      670     1757    1               GOTO RET;
      671     1758    1       FPT$=GLOBAL.OPEN$;
      672     1759    1       FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;
      673     1760    1       FPT$OPEN.V.ORG#=%CONSEC#;
      674     1761    1       FPT$OPEN.V.ACS#=%SEQUEN#;
      675     1762    1       FPT$OPEN.V.ASN#=0;
      676     1763    1       FPT$OPEN.V.FUN#=0;
      677     1764    1       FPT$OPEN.V.EXIST#=0;
      678     1765    1       CALL M$OPEN(FPT$OPEN) ALTRET(ER_OPEN);
      679     1766
      680     1767    1   RET:RETURN;
      681     1768    1   ER_GDCB: ;
      682     1769    1   ER_OPEN: ;
      683     1770    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      684     1771    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      685     1772    1       ALTRETURN;
      686     1773    1   END ZIO$DFLTOPN;

PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:140  
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$DFLTOPN.

   Procedure ZIO$DFLTOPN requires 111 words for executable code.
   Procedure ZIO$DFLTOPN requires 6 words of local(AUTO) storage.

    No errors detected in file ZIM$OPEN.:ZIC0TSI    .

PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:141  

 Object Unit name= ZIO$DFLTOPN                                File name= ZIM$OPEN.:ZIC0TOU
 UTS= SEP 05 '97 13:04:11.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      1      1  ZIO$DFLTOPN
    2   Proc  even  none   111    157  ZIO$DFLTOPN
    3  RoData even  none     6      6  ZIO$DFLTOPN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      XStd       1  ZIO$DFLTOPN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:142  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:143  


      620        1        /*T***********************************************************/
      621        2        /*T*                                                         */
      622        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      623        4        /*T*                                                         */
      624        5        /*T***********************************************************/
      625        6        ZIO$DFLTOPN: PROC (DEVICE) ALTRET

      6  2 000000   000000 700200 xent  ZIO$DFLTOPN  TSX0  ! X66_AUTO_1
         2 000001   000006 000001                    ZERO    6,1

      626        7         /* USE($PR5 FOR GLOBAL$) */
      627        8               AVOID($PR5,$PR6,$PR7);
      628        9    1   DCL DEVICE CHAR(4) ;
      629       10        %INCLUDE ZI$GLOBAL;
      630      496         %GLOBALS;
      631      804        %INCLUDE CP_6;
      632      885         %FPT_GETDCB(FPTN=FPT$GETDCB,STCLASS=BASED);
      633      900         %FPT_OPEN(FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      634     1009         %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      635     1118         %F$DCB;
      636     1175         %B$TCB;
      637     1178         %B$ALT;
      638     1186        %INCLUDE CP_6_SUBS;
      639     1726    1   DCL FPT$ PTR;
      640     1727    1   DCL B$TCB$ PTR SYMREF;
      641     1728    1       GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;

   1728  2 000002   000000 470400 xsym               LDP0    GLOBAL$
         2 000003   005104 471500                    LDP1    2628,,PR0
         2 000004   200000 236007                    LDQ     65536,DL
         2 000005   100006 256100                    ORSQ    6,,PR1

      642     1729    1       CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);

   1729  2 000006   005104 471500                    LDP1    2628,,PR0
         2 000007   100000 630500                    EPPR0   0,,PR1
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:144  
         2 000010   460002 713400                    CLIMB   alt,+24578
         2 000011   401000 401760                    pmme    nvectors=3
         2 000012   000147 702000 2                  TSX2    ER_GDCB

      643     1730    2       IF GLOBAL.DCBNUMBER=0 THEN DO;

   1730  2 000013   000000 470400 xsym               LDP0    GLOBAL$
         2 000014   004623 235100                    LDA     2451,,PR0
         2 000015   000114 601000 2                  TNZ     s:1756

      644     1731    2           GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;

   1731  2 000016   005104 471500                    LDP1    2628,,PR0
         2 000017   000000 236000 3                  LDQ     0
         2 000020   100006 356100                    ANSQ    6,,PR1

      645     1732    2           CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);

   1732  2 000021   005104 471500                    LDP1    2628,,PR0
         2 000022   100000 630500                    EPPR0   0,,PR1
         2 000023   460002 713400                    CLIMB   alt,+24578
         2 000024   401000 401760                    pmme    nvectors=3
         2 000025   000147 702000 2                  TSX2    ER_GDCB

      646     1733    2           FPT$=GLOBAL.OPNDFLT$;

   1733  2 000026   000000 470400 xsym               LDP0    GLOBAL$
         2 000027   005067 236100                    LDQ     2615,,PR0
         2 000030   200004 756100                    STQ     FPT$,,AUTO

      647     1734    2           FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;

   1734  2 000031   004623 720100                    LXL0    2451,,PR0
         2 000032   200004 471500                    LDP1    FPT$,,AUTO
         2 000033   100044 740100                    STX0    36,,PR1

      648     1735    2           FPT$OPNDFLT.V.IXTNSIZE#=2;
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:145  

   1735  2 000034   000002 235007                    LDA     2,DL
         2 000035   100055 755100                    STA     45,,PR1

      649     1736    2           FPT$OPNDFLT.V.XTNSIZE#=2;

   1736  2 000036   000002 221003                    LDX1    2,DU
         2 000037   100054 441100                    SXL1    44,,PR1

      650     1737    2           FPT$OPNDFLT.V.RES#=DEVICE;

   1737  2 000040   200003 473500                    LDP3    @DEVICE,,AUTO
         2 000041   040100 100500                    MLR     fill='040'O
         2 000042   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         2 000043   100050 000004                    ADSC9   40,,PR1                  cn=0,n=4

      651     1738    2           FPT$OPNDFLT.V.ASN#=%DEVICE#;

   1738  2 000044   000003 236007                    LDQ     3,DL
         2 000045   100045 552104                    STBQ    37,'04'O,PR1

      652     1739    2           FPT$OPNDFLT.V.FUN#=%CREATE#;

   1739  2 000046   003000 236007                    LDQ     1536,DL
         2 000047   100045 552110                    STBQ    37,'10'O,PR1

      653     1740    2           FPT$OPNDFLT.V.EXIST#=%OLDFILE#;

   1740  2 000050   100044 236100                    LDQ     36,,PR1
         2 000051   000001 376000 3                  ANQ     1
         2 000052   000400 276007                    ORQ     256,DL
         2 000053   100044 756100                    STQ     36,,PR1

      654     1741    2           FPT$OPNDFLT.V.DISP#=%NAMED#;

   1741  2 000054   000002 236007                    LDQ     2,DL
         2 000055   100051 552104                    STBQ    41,'04'O,PR1
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:146  

      655     1742    2           FPT$OPNDFLT.V.CTG#=%YES#;

   1742  2 000056   100044 236100                    LDQ     36,,PR1
         2 000057   000002 376000 3                  ANQ     2
         2 000060   000100 276007                    ORQ     64,DL
         2 000061   100044 756100                    STQ     36,,PR1

      656     1743    2           FPT$OPNDFLT.V.TYPE#='  ';

   1743  2 000062   000000 222000 1                  LDX2    0
         2 000063   100047 742100                    STX2    39,,PR1

      657     1744    2           FPT$OPNDFLT.V.SHARE#=%ALL#;

   1744  2 000064   100044 236100                    LDQ     36,,PR1
         2 000065   000003 376000 3                  ANQ     3
         2 000066   000010 276007                    ORQ     8,DL
         2 000067   100044 756100                    STQ     36,,PR1

      658     1745    2           FPT$OPNDFLT.V.ORG#=%CONSEC#;

   1745  2 000070   001000 236007                    LDQ     512,DL
         2 000071   100046 552110                    STBQ    38,'10'O,PR1

      659     1746    2           GLOBAL.FILENAME.LENGTH=0;

   1746  2 000072   000000 236003                    LDQ     0,DU
         2 000073   004724 552140                    STBQ    2516,'40'O,PR0

      660     1747    2           GLOBAL.ACCT=' ';

   1747  2 000074   000004 235000 3                  LDA     4
         2 000075   000004 236000 3                  LDQ     4
         2 000076   004744 757100                    STAQ    2532,,PR0

      661     1748    2           CALL M$OPEN(FPT$OPNDFLT)
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:147  

   1748  2 000077   100000 630500                    EPPR0   0,,PR1
         2 000100   450000 713400                    CLIMB   alt,open
         2 000101   410400 401760                    pmme    nvectors=18
         2 000102   000104 702000 2                  TSX2    s:1750
         2 000103   000110 710000 2                  TRA     s:1753

      662     1749    3           WHENALTRETURN DO;

      663     1750    3               FPT$OPNDFLT.V.RES#=' ';

   1750  2 000104   000004 236000 3                  LDQ     4
         2 000105   200004 470500                    LDP0    FPT$,,AUTO
         2 000106   000050 756100                    STQ     40,,PR0

      664     1751    3               GOTO ER_OPEN;

   1751  2 000107   000147 710000 2                  TRA     ER_GDCB

      665     1752    3               END;
      666     1753    2           FPT$OPNDFLT.V.RES#=' ';

   1753  2 000110   000004 236000 3                  LDQ     4
         2 000111   200004 470500                    LDP0    FPT$,,AUTO
         2 000112   000050 756100                    STQ     40,,PR0

      667     1754    2           END;

   1754  2 000113   000123 710000 2                  TRA     s:1758

      668     1755    1       ELSE
      669     1756    1           IF DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.FCD# THEN

   1756  2 000114   000005 471400 3                  LDP1    5
         2 000115   100000 473500                    LDP3    0,,PR1
         2 000116   004623 720100                    LXL0    2451,,PR0
         2 000117   300000 474510                    LDP4    0,X0,PR3
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:148  
         2 000120   400031 236100                    LDQ     25,,PR4
         2 000121   020000 316007                    CANQ    8192,DL
         2 000122   000146 601000 2                  TNZ     RET

      670     1757    1               GOTO RET;
      671     1758    1       FPT$=GLOBAL.OPEN$;

   1758  2 000123   000000 470400 xsym               LDP0    GLOBAL$
         2 000124   005066 236100                    LDQ     2614,,PR0
         2 000125   200004 756100                    STQ     FPT$,,AUTO

      672     1759    1       FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;

   1759  2 000126   004623 720100                    LXL0    2451,,PR0
         2 000127   200004 471500                    LDP1    FPT$,,AUTO
         2 000130   100044 740100                    STX0    36,,PR1

      673     1760    1       FPT$OPEN.V.ORG#=%CONSEC#;

   1760  2 000131   001000 236007                    LDQ     512,DL
         2 000132   100046 552110                    STBQ    38,'10'O,PR1

      674     1761    1       FPT$OPEN.V.ACS#=%SEQUEN#;

   1761  2 000133   000001 236007                    LDQ     1,DL
         2 000134   100046 552104                    STBQ    38,'04'O,PR1

      675     1762    1       FPT$OPEN.V.ASN#=0;

   1762  2 000135   000000 236003                    LDQ     0,DU
         2 000136   100045 552104                    STBQ    37,'04'O,PR1

      676     1763    1       FPT$OPEN.V.FUN#=0;

   1763  2 000137   100045 552110                    STBQ    37,'10'O,PR1

      677     1764    1       FPT$OPEN.V.EXIST#=0;
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:149  

   1764  2 000140   000001 236000 3                  LDQ     1
         2 000141   100044 356100                    ANSQ    36,,PR1

      678     1765    1       CALL M$OPEN(FPT$OPEN) ALTRET(ER_OPEN);

   1765  2 000142   100000 630500                    EPPR0   0,,PR1
         2 000143   450000 713400                    CLIMB   alt,open
         2 000144   410400 401760                    pmme    nvectors=18
         2 000145   000147 702000 2                  TSX2    ER_GDCB

      679     1766
      680     1767    1   RET:RETURN;

   1767  2 000146   000000 702200 xent  RET          TSX2  ! X66_ARET

   1764  2 000147                       ER_GDCB      null
   1764  2 000147                       ER_OPEN      null
      681     1768    1   ER_GDCB: ;
      682     1769    1   ER_OPEN: ;
      683     1770    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   1770  2 000147   000000 470400 xsym               LDP0    B$TCB$
         2 000150   000000 471500                    LDP1    0,,PR0
         2 000151   100102 236100                    LDQ     66,,PR1
         2 000152   000000 473400 xsym               LDP3    GLOBAL$
         2 000153   300007 756100                    STQ     7,,PR3

      684     1771    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   1771  2 000154   304623 720100                    LXL0    2451,,PR3
         2 000155   300014 740100                    STX0    12,,PR3

      685     1772    1       ALTRETURN;

   1772  2 000156   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:150  
(unnamed)
 Sect OctLoc
   1     000   040040 040040

(unnamed)
 Sect OctLoc
   3     000   777777 577777   777777 777177   777777 777637   777777 777747    ................
   3     004   040040 040040   000000 006003                                        ....
      686     1773    1   END ZIO$DFLTOPN;

PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:151  
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$DFLTOPN.

   Procedure ZIO$DFLTOPN requires 111 words for executable code.
   Procedure ZIO$DFLTOPN requires 6 words of local(AUTO) storage.

    No errors detected in file ZIM$OPEN.:ZIC0TSI    .
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:152  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:153  
          MINI XREF LISTING

B$ALT.CODE
      1180**DCL      1180--REDEF    1181--REDEF    1181--REDEF
B$ALT.ERR
      1181**DCL      1770>>ASSIGN
B$ALT.ERR.ERR#
      1182**DCL      1182--REDEF
B$ALT.EVID
      1181**DCL      1181--REDEF    1181--REDEF
B$TCB.ALT$
      1176**DCL      1770>>ASSIGN
B$TCB$
      1727**DCL      1770>>ASSIGN
DEVICE
         9**DCL         6--PROC     1737>>ASSIGN
ER_GDCB
      1764**LABEL    1729--CALLALT  1732--CALLALT
ER_OPEN
      1764**LABEL    1751--GOTO     1765--CALLALT
F$DCB.ACTPOS
      1151**DCL      1151--REDEF
F$DCB.ARS#
      1125**DCL      1125--REDEF
F$DCB.ATTR
      1144**DCL      1145--REDEF
F$DCB.BORROW
      1159**DCL      1159--REDEF    1159--REDEF    1159--REDEF
F$DCB.DCBNAME.L
      1173**DCL      1173--IMP-SIZ
F$DCB.EOMCHAR#
      1129**DCL      1129--REDEF
F$DCB.FCD#
      1138**DCL      1756>>IF
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:154  
F$DCB.FLDID
      1154**DCL      1154--REDEF
F$DCB.FORM$
      1148**DCL      1148--REDEF
F$DCB.FSECT
      1164**DCL      1164--REDEF
F$DCB.FSN#
      1141**DCL      1141--REDEF    1141--REDEF    1142--REDEF
F$DCB.HEADER$
      1147**DCL      1147--REDEF
F$DCB.IXTNSIZE#
      1145**DCL      1145--REDEF
F$DCB.LASTSTA$
      1134**DCL      1134--REDEF
F$DCB.LVL
      1160**DCL      1160--REDEF
F$DCB.NAME#.C
      1135**DCL      1135--REDEF
F$DCB.NOEOF
      1157**DCL      1157--REDEF
F$DCB.NRECS#
      1146**DCL      1146--REDEF
F$DCB.NRECX
      1165**DCL      1165--REDEF
F$DCB.OHDR
      1157**DCL      1157--REDEF
F$DCB.ORG#
      1140**DCL      1140--REDEF
F$DCB.PRECNO
      1163**DCL      1163--REDEF
F$DCB.RCSZ
      1169**DCL      1169--REDEF
F$DCB.RES#
      1136**DCL      1136--REDEF
F$DCB.SETX
      1148**DCL      1148--REDEF
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:155  
F$DCB.TAB$
      1148**DCL      1148--REDEF
F$DCB.TDA
      1162**DCL      1163--REDEF
F$DCB.WSN#
      1136**DCL      1136--REDEF
FPT$
      1726**DCL       965--IMP-PTR  1074--IMP-PTR  1733<<ASSIGN   1734>>ASSIGN   1735>>ASSIGN   1736>>ASSIGN
      1737>>ASSIGN   1738>>ASSIGN   1739>>ASSIGN   1740>>ASSIGN   1741>>ASSIGN   1742>>ASSIGN   1743>>ASSIGN
      1744>>ASSIGN   1745>>ASSIGN   1748>>CALL     1750>>ASSIGN   1753>>ASSIGN   1758<<ASSIGN   1759>>ASSIGN
      1760>>ASSIGN   1761>>ASSIGN   1762>>ASSIGN   1763>>ASSIGN   1764>>ASSIGN   1765>>CALL
FPT$GETDCB
       896**DCL      1729<>CALL     1732<>CALL
FPT$GETDCB.V.TEST#
       898**DCL      1728<<ASSIGN   1731<<ASSIGN
FPT$OPEN
      1074**DCL      1765<>CALL
FPT$OPEN.ACSVEH_
      1076**DCL      1077--REDEF
FPT$OPEN.ALTKEYS_
      1082**DCL      1083--REDEF    1083--REDEF
FPT$OPEN.HDR_
      1081**DCL      1082--REDEF
FPT$OPEN.TAB_
      1080**DCL      1081--REDEF
FPT$OPEN.UHL_
      1074**DCL      1075--REDEF    1075--REDEF
FPT$OPEN.V.ACS#
      1094**DCL      1761<<ASSIGN
FPT$OPEN.V.ASN#
      1093**DCL      1762<<ASSIGN
FPT$OPEN.V.DCB#
      1083**DCL      1759<<ASSIGN
FPT$OPEN.V.EXIST#
      1087**DCL      1764<<ASSIGN
FPT$OPEN.V.FSN#
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:156  
      1114**DCL      1114--REDEF    1114--REDEF
FPT$OPEN.V.FUN#
      1093**DCL      1763<<ASSIGN
FPT$OPEN.V.ORG#
      1094**DCL      1760<<ASSIGN
FPT$OPEN.WSN_
      1080**DCL      1080--REDEF
FPT$OPNDFLT
       965**DCL      1748<>CALL
FPT$OPNDFLT.ACSVEH_
       967**DCL       968--REDEF
FPT$OPNDFLT.ALTKEYS_
       973**DCL       974--REDEF     974--REDEF
FPT$OPNDFLT.HDR_
       972**DCL       973--REDEF
FPT$OPNDFLT.TAB_
       971**DCL       972--REDEF
FPT$OPNDFLT.UHL_
       965**DCL       966--REDEF     966--REDEF
FPT$OPNDFLT.V.ASN#
       984**DCL      1738<<ASSIGN
FPT$OPNDFLT.V.CTG#
       978**DCL      1742<<ASSIGN
FPT$OPNDFLT.V.DCB#
       974**DCL      1734<<ASSIGN
FPT$OPNDFLT.V.DISP#
       990**DCL      1741<<ASSIGN
FPT$OPNDFLT.V.EXIST#
       978**DCL      1740<<ASSIGN
FPT$OPNDFLT.V.FSN#
      1005**DCL      1005--REDEF    1005--REDEF
FPT$OPNDFLT.V.FUN#
       984**DCL      1739<<ASSIGN
FPT$OPNDFLT.V.IXTNSIZE#
       993**DCL      1735<<ASSIGN
FPT$OPNDFLT.V.ORG#
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:157  
       985**DCL      1745<<ASSIGN
FPT$OPNDFLT.V.RES#
       989**DCL      1737<<ASSIGN   1750<<ASSIGN   1753<<ASSIGN
FPT$OPNDFLT.V.SHARE#
       979**DCL      1744<<ASSIGN
FPT$OPNDFLT.V.TYPE#
       986**DCL      1743<<ASSIGN
FPT$OPNDFLT.V.XTNSIZE#
       993**DCL      1736<<ASSIGN
FPT$OPNDFLT.WSN_
       971**DCL       971--REDEF
GLOBAL.ACCT
       720**DCL      1747<<ASSIGN
GLOBAL.ACTIVE.DBCB$
       503**DCL       504--REDEF
GLOBAL.ACTIVE.SSS$
       499**DCL       500--REDEF
GLOBAL.DCBNUMBER
       706**DCL      1730>>IF       1734>>ASSIGN   1756--IF       1759>>ASSIGN   1771>>ASSIGN
GLOBAL.FILENAME.LENGTH
       715**DCL      1746<<ASSIGN
GLOBAL.GETDCB$
       768**DCL      1728>>ASSIGN   1729>>CALL     1731>>ASSIGN   1732>>CALL
GLOBAL.KEY
       707**DCL       710--REDEF
GLOBAL.OPEN$
       754**DCL      1758>>ASSIGN
GLOBAL.OPNDFLT$
       755**DCL      1733>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       582**DCL       589--REDEF
GLOBAL.PRINTBUF.BUFFER
       741**DCL       742--REDEF     743--REDEF     744--REDEF
GLOBAL.PRINTBUF.ERR.V
       746**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL.RET.DCB#
PL6.E3A0      #003=ZIO$DFLTOPN File=ZIM$OPEN.:ZIC0TSI                            FRI 09/05/97 13:04 Page:158  
       523**DCL      1771<<ASSIGN
GLOBAL.RET.SYSERR#
       518**DCL      1770<<ASSIGN
GLOBAL$
       801**DCL       497--IMP-PTR  1728>>ASSIGN   1729>>CALL     1730>>IF       1731>>ASSIGN   1732>>CALL
      1733>>ASSIGN   1734>>ASSIGN   1746>>ASSIGN   1747>>ASSIGN   1756>>IF       1758>>ASSIGN   1759>>ASSIGN
      1770>>ASSIGN   1771>>ASSIGN   1771>>ASSIGN
M$GETDCB
       819**DCL-ENT  1729--CALL     1732--CALL
M$OPEN
       813**DCL-ENT  1748--CALL     1765--CALL
RET
      1767**LABEL    1757--GOTO
