VERSION B06

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:1    
        1        1        /*M* VMF$SUBR - These routines handle MAIL IDENTIFICATIONS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*P*
        9        9             NAME: VMF$FROM
       10       10             PURPOSE:
       11       11                  To translate ACCOUNT,UNAME into USER NAME.
       12       12             DESCRIPTION:
       13       13                  This routine takes the ACCOUNT and UNAME for the current user
       14       14                  and looks up the USER NAME in the REVERSE NAME MAP. This
       15       15                  map is contained in :NAME and is keyed like :USERS, i.e.,
       16       16                  ACCOUNT||UNAME. Record text is USER NAME. No structure needed.
       17       17                   If nothing is found, then try again, but assume UNAME is
       18       18                   blanks. This will allow the account to have one default
       19       19                   project-type name.
       20       20
       21       21                  If no USER NAME can be found, then ACCOUNT will be returned.
       22       22
       23       23                  This routine will ALTRETURN in case of severe error.
       24       24
       25       25                   This routine has one parameter.
       26       26                    USER_NAME - a textc field to receive the results.
       27       27                                It must be at least 200 characters long
       28       28                                or lost data is possible.
       29       29        */
       30       30        VMF$FROM: PROC (USER_NAME) ALTRET;
       31       31        /***** Include files *****/
       32       32          %INCLUDE B$JIT;
       33      635          %INCLUDE CP_6;
       34     6194          %INCLUDE CP_6_SUBS;
       35     6734          %INCLUDE VM_MACRO_C;
       36     8002          %INCLUDE VM_DATA_R;
       37     8433        /***** Parameters *****/
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:2    
       38     8434          %TEXTC (NAME=USER_NAME,STCLASS=" ");
       39     8439        /***** Symref data *****/
       40     8440        /***** External routines *****/
       41     8441    1   DCL X$STRIP_BLANKS ENTRY(1);
       42     8442        /***** Macros/fpts *****/
       43     8443          %F$DCB;
       44     8500            %FPT_OPEN (FPTN=OPEN_NAME,
       45     8501            DCB=M$NAME,
       46     8502            REASSIGN=NO,
       47     8503            ASN=FILE,
       48     8504            FUN=IN,
       49     8505            SHARE=ALL,
       50     8506            ACCT=VM_MAIL_ACCT,
       51     8507            NAME=VM_NAME_MAP_NAME);
       52     8616        %FPT_CLOSE (FPTN=CLOSE_NAME,
       53     8617                    DCB=M$NAME,
       54     8618                    DISP=SAVE);
       55     8660        %FPT_READ (FPTN=READ_NAME,
       56     8661                   DCB=M$NAME,
       57     8662                   KEYS=YES,
       58     8663                   KEY=NAME_KEY);
       59     8702          %FPT_MADMUCK (READ=YES, WRITE=NO, DELETE=NO);
       60     8718          %VLP_SN (FPTN=PACKSET,N=1,STCLASS=AUTO);
       61     8731        /***** Dcbs *****/
       62     8732    1   DCL M$NAME DCB;
       63     8733        /***** Local data *****/
       64     8734          %VLP_NAME (FPTN=NAME_KEY,LEN=20,NAME=' ');
       65     8761    1   DCL INDX UBIN;
       66     8762    1   DCL IN_MAD BIT (1);
       67     8763        %EJECT
       68     8764    1       IN_MAD = %YES#;
       69     8765        /*
       70     8766             ***** Open :NAME file ...
       71     8767        */
       72     8768    1       CALL M$OPEN (OPEN_NAME) ALTRET(NO_NAME);
       73     8769        /*
       74     8770             ***** Setup the key ...
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:3    
       75     8771        */
       76     8772    1       CALL CONCAT(NAME_KEY.NAME#,B$JIT.ACCN,B$JIT.UNAME);
       77     8773    1       NAME_KEY.L# = 20;
       78     8774        /*
       79     8775             ***** Read the user name ...
       80     8776        */
       81     8777    1       READ_NAME.BUF_ = VECTOR(USER_NAME.TEXT);
       82     8778    1       CALL M$READ (READ_NAME) ALTRET(TRY_AGAIN);
       83     8779    1       USER_NAME.SIZ = DCBADDR(DCBNUM(M$NAME)) -> F$DCB.ARS#;
       84     8780    1       GOTO CLEANUP;
       85     8781        /*
       86     8782             ***** Try with uname blank ...
       87     8783        */
       88     8784    1   TRY_AGAIN:
       89     8785    1       NAME_KEY.NAME# = B$JIT.ACCN;
       90     8786    1       CALL M$READ (READ_NAME) ALTRET(NO_NAME);
       91     8787    1       USER_NAME.SIZ = DCBADDR(DCBNUM(M$NAME)) -> F$DCB.ARS#;
       92     8788    1       CALL X$STRIP_BLANKS (ADDR(USER_NAME));
       93     8789    1       GOTO CLEANUP;
       94     8790        /*
       95     8791             ***** Use .ACCN as user name ...
       96     8792        */
       97     8793    1   NO_NAME:
       98     8794    1       FPT_MADMUCK.ACCT_ = VECTOR (B$JIT.FACCN);
       99     8795    1       FPT_MADMUCK.SN_ = VECTOR (PACKSET);
      100     8796
      101     8797    1       IF B$JIT.FPSN ~= ' '
      102     8798    2       THEN DO;
      103     8799
      104     8800    2           CALL CONCAT (USER_NAME.TEXT, 'DP#', B$JIT.FPSN);
      105     8801    2           CALL INDEX (INDX, ' ', USER_NAME.TEXT);
      106     8802    2           CALL INSERT (USER_NAME.TEXT, INDX, , '.', B$JIT.FACCN);
      107     8803
      108     8804    2           CALL M$MADMUCK (FPT_MADMUCK)
      109     8805    3           WHENRETURN DO;
      110     8806
      111     8807    3               IF PACKSET.SN#(0) = B$JIT.FPSN
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:4    
      112     8808    3               THEN
      113     8809    3                   IN_MAD = %YES#;
      114     8810    3               ELSE
      115     8811    3                   IN_MAD = %NO#;
      116     8812
      117     8813    3           END;
      118     8814
      119     8815    3           WHENALTRETURN DO;
      120     8816    3               IN_MAD = %NO#;
      121     8817    3           END;
      122     8818
      123     8819    2       END;
      124     8820
      125     8821    2       ELSE DO;
      126     8822
      127     8823    2           CALL M$MADMUCK (FPT_MADMUCK)
      128     8824    3           WHENRETURN DO;
      129     8825
      130     8826    3               CALL CONCAT (USER_NAME.TEXT, '.', B$JIT.FACCN);
      131     8827
      132     8828    3           END;
      133     8829
      134     8830    3           WHENALTRETURN DO;
      135     8831
      136     8832    3               IN_MAD = %NO#;
      137     8833    3               CALL CONCAT (USER_NAME.TEXT, 'DP#', B$JIT.HPSN);
      138     8834    3               CALL INDEX (INDX, ' ', USER_NAME.TEXT);
      139     8835    3               CALL INSERT (USER_NAME.TEXT, INDX, , '.', B$JIT.FACCN);
      140     8836
      141     8837    3           END;
      142     8838
      143     8839    2       END;
      144     8840
      145     8841    1       CALL X$STRIP_BLANKS (ADDR(USER_NAME));
      146     8842        /*
      147     8843             ***** If :NAME is open, then close it ...
      148     8844        */
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:5    
      149     8845    1   CLEANUP:
      150     8846    1       IF DCBADDR(DCBNUM(M$NAME)) -> F$DCB.FCD#
      151     8847    1       THEN
      152     8848    1           CALL M$CLOSE (CLOSE_NAME) ALTRET(IGNORE_ALTRET);
      153     8849    1   IGNORE_ALTRET: ;
      154     8850        /**/
      155     8851    1       RETURN;
      156     8852    1   END VMF$FROM;
      157     8853        %EOD;

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:6    
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$FROM.

   Procedure VMF$FROM requires 225 words for executable code.
   Procedure VMF$FROM requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:7    

 Object Unit name= VMF$FROM                                   File name= VMF$SUBR.:VMB6TOU
 UTS= AUG 20 '97 15:15:37.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   116    164  VMF$FROM
   12   DCB   even  none     0      0  M$NAME
   13  RoData even  UTS      1      1  VMF$FROM
   14   Proc  even  none   225    341  VMF$FROM
   15  RoData even  none     6      6  VMF$FROM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes    yes     yes      Std        1  VMF$FROM
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:8    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 X$STRIP_BLANKS
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                      M$NAME
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:9    

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:10   


        1        1        /*M* VMF$SUBR - These routines handle MAIL IDENTIFICATIONS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*P*
        9        9             NAME: VMF$FROM
       10       10             PURPOSE:
       11       11                  To translate ACCOUNT,UNAME into USER NAME.
       12       12             DESCRIPTION:
       13       13                  This routine takes the ACCOUNT and UNAME for the current user
       14       14                  and looks up the USER NAME in the REVERSE NAME MAP. This
       15       15                  map is contained in :NAME and is keyed like :USERS, i.e.,
       16       16                  ACCOUNT||UNAME. Record text is USER NAME. No structure needed.
       17       17                   If nothing is found, then try again, but assume UNAME is
       18       18                   blanks. This will allow the account to have one default
       19       19                   project-type name.
       20       20
       21       21                  If no USER NAME can be found, then ACCOUNT will be returned.
       22       22
       23       23                  This routine will ALTRETURN in case of severe error.
       24       24
       25       25                   This routine has one parameter.
       26       26                    USER_NAME - a textc field to receive the results.
       27       27                                It must be at least 200 characters long
       28       28                                or lost data is possible.
       29       29        */
       30       30        VMF$FROM: PROC (USER_NAME) ALTRET;

     30 14 000000   000000 700200 xent  VMF$FROM     TSX0  ! X66_AUTO_1
        14 000001   000014 000001                    ZERO    12,1

       31       31        /***** Include files *****/
       32       32          %INCLUDE B$JIT;
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:11   
       33      635          %INCLUDE CP_6;
       34     6194          %INCLUDE CP_6_SUBS;
       35     6734          %INCLUDE VM_MACRO_C;
       36     8002          %INCLUDE VM_DATA_R;
       37     8433        /***** Parameters *****/
       38     8434          %TEXTC (NAME=USER_NAME,STCLASS=" ");
       39     8439        /***** Symref data *****/
       40     8440        /***** External routines *****/
       41     8441    1   DCL X$STRIP_BLANKS ENTRY(1);
       42     8442        /***** Macros/fpts *****/
       43     8443          %F$DCB;
       44     8500            %FPT_OPEN (FPTN=OPEN_NAME,
       45     8501            DCB=M$NAME,
       46     8502            REASSIGN=NO,
       47     8503            ASN=FILE,
       48     8504            FUN=IN,
       49     8505            SHARE=ALL,
       50     8506            ACCT=VM_MAIL_ACCT,
       51     8507            NAME=VM_NAME_MAP_NAME);
       52     8616        %FPT_CLOSE (FPTN=CLOSE_NAME,
       53     8617                    DCB=M$NAME,
       54     8618                    DISP=SAVE);
       55     8660        %FPT_READ (FPTN=READ_NAME,
       56     8661                   DCB=M$NAME,
       57     8662                   KEYS=YES,
       58     8663                   KEY=NAME_KEY);
       59     8702          %FPT_MADMUCK (READ=YES, WRITE=NO, DELETE=NO);
       60     8718          %VLP_SN (FPTN=PACKSET,N=1,STCLASS=AUTO);
       61     8731        /***** Dcbs *****/
       62     8732    1   DCL M$NAME DCB;
       63     8733        /***** Local data *****/
       64     8734          %VLP_NAME (FPTN=NAME_KEY,LEN=20,NAME=' ');
       65     8761    1   DCL INDX UBIN;
       66     8762    1   DCL IN_MAD BIT (1);
       67     8763        %EJECT
       68     8764    1       IN_MAD = %YES#;

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:12   
   8764 14 000002   400000 236003                    LDQ     -131072,DU
        14 000003   200011 756100                    STQ     IN_MAD,,AUTO

       69     8765        /*
       70     8766             ***** Open :NAME file ...
       71     8767        */
       72     8768    1       CALL M$OPEN (OPEN_NAME) ALTRET(NO_NAME);

   8768 14 000004   000000 630400 11                 EPPR0   OPEN_NAME
        14 000005   450000 713400                    CLIMB   alt,open
        14 000006   410400 401760                    pmme    nvectors=18
        14 000007   000102 702000 14                 TSX2    NO_NAME

       73     8769        /*
       74     8770             ***** Setup the key ...
       75     8771        */
       76     8772    1       CALL CONCAT(NAME_KEY.NAME#,B$JIT.ACCN,B$JIT.UNAME);

   8772 14 000010   000000 470400 xsym               LDP0    B$JIT$
        14 000011   040000 100500                    MLR     fill='040'O
        14 000012   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        14 000013   000156 200010 11                 ADSC9   NAME_KEY                 cn=1,n=8
        14 000014   040000 100500                    MLR     fill='040'O
        14 000015   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        14 000016   000160 200014 11                 ADSC9   NAME_KEY+2               cn=1,n=12

       77     8773    1       NAME_KEY.L# = 20;

   8773 14 000017   024000 236003                    LDQ     10240,DU
        14 000020   000156 552040 11                 STBQ    NAME_KEY,'40'O

       78     8774        /*
       79     8775             ***** Read the user name ...
       80     8776        */
       81     8777    1       READ_NAME.BUF_ = VECTOR(USER_NAME.TEXT);

   8777 14 000021   200003 470500                    LDP0    @USER_NAME,,AUTO
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:13   
        14 000022   000100 101500                    MRL     fill='000'O
        14 000023   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000024   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000025   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000026   000000 635010                    EAA     0,X0
        14 000027   000002 771000                    ARL     2
        14 000030   000140 135007                    SBLA    96,DL
        14 000031   200003 236100                    LDQ     @USER_NAME,,AUTO
        14 000032   200000 036007                    ADLQ    65536,DL
        14 000033   000134 757000 11                 STAQ    READ_NAME+4

       82     8778    1       CALL M$READ (READ_NAME) ALTRET(TRY_AGAIN);

   8778 14 000034   000130 630400 11                 EPPR0   READ_NAME
        14 000035   440000 713400                    CLIMB   alt,read
        14 000036   401400 401760                    pmme    nvectors=4
        14 000037   000051 702000 14                 TSX2    TRY_AGAIN

       83     8779    1       USER_NAME.SIZ = DCBADDR(DCBNUM(M$NAME)) -> F$DCB.ARS#;

   8779 14 000040   000000 236007 xsym               LDQ     M$NAME,DL
        14 000041   000000 470400 15                 LDP0    0
        14 000042   000000 471500                    LDP1    0,,PR0
        14 000043   100000 473506                    LDP3    0,QL,PR1
        14 000044   200003 474500                    LDP4    @USER_NAME,,AUTO
        14 000045   000100 101500                    MRL     fill='000'O
        14 000046   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
        14 000047   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

       84     8780    1       GOTO CLEANUP;

   8780 14 000050   000325 710000 14                 TRA     CLEANUP

       85     8781        /*
       86     8782             ***** Try with uname blank ...
       87     8783        */
       88     8784    1   TRY_AGAIN:
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:14   
       89     8785    1       NAME_KEY.NAME# = B$JIT.ACCN;

   8785 14 000051   000000 470400 xsym  TRY_AGAIN    LDP0    B$JIT$
        14 000052   040000 100500                    MLR     fill='040'O
        14 000053   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        14 000054   000156 200024 11                 ADSC9   NAME_KEY                 cn=1,n=20

       90     8786    1       CALL M$READ (READ_NAME) ALTRET(NO_NAME);

   8786 14 000055   000130 630400 11                 EPPR0   READ_NAME
        14 000056   440000 713400                    CLIMB   alt,read
        14 000057   401400 401760                    pmme    nvectors=4
        14 000060   000102 702000 14                 TSX2    NO_NAME

       91     8787    1       USER_NAME.SIZ = DCBADDR(DCBNUM(M$NAME)) -> F$DCB.ARS#;

   8787 14 000061   000000 236007 xsym               LDQ     M$NAME,DL
        14 000062   000000 470400 15                 LDP0    0
        14 000063   000000 471500                    LDP1    0,,PR0
        14 000064   100000 473506                    LDP3    0,QL,PR1
        14 000065   200003 474500                    LDP4    @USER_NAME,,AUTO
        14 000066   000100 101500                    MRL     fill='000'O
        14 000067   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
        14 000070   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

       92     8788    1       CALL X$STRIP_BLANKS (ADDR(USER_NAME));

   8788 14 000071   200003 236100                    LDQ     @USER_NAME,,AUTO
        14 000072   200012 756100                    STQ     IN_MAD+1,,AUTO
        14 000073   200012 633500                    EPPR3   IN_MAD+1,,AUTO
        14 000074   200013 453500                    STP3    IN_MAD+2,,AUTO
        14 000075   200013 630500                    EPPR0   IN_MAD+2,,AUTO
        14 000076   000001 631400 15                 EPPR1   1
        14 000077   000000 701000 xent               TSX1    X$STRIP_BLANKS
        14 000100   000000 011000                    NOP     0

       93     8789    1       GOTO CLEANUP;
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:15   

   8789 14 000101   000325 710000 14                 TRA     CLEANUP

       94     8790        /*
       95     8791             ***** Use .ACCN as user name ...
       96     8792        */
       97     8793    1   NO_NAME:
       98     8794    1       FPT_MADMUCK.ACCT_ = VECTOR (B$JIT.FACCN);

   8794 14 000102   000002 235000 15    NO_NAME      LDA     2
        14 000103   000000 236000 xsym               LDQ     B$JIT$
        14 000104   000006 036003                    ADLQ    6,DU
        14 000105   000150 757000 11                 STAQ    FPT_MADMUCK+2

       99     8795    1       FPT_MADMUCK.SN_ = VECTOR (PACKSET);

   8795 14 000106   000003 235000 15                 LDA     3
        14 000107   200012 452500                    STP2    IN_MAD+1,,AUTO
        14 000110   200012 236100                    LDQ     IN_MAD+1,,AUTO
        14 000111   000004 036003                    ADLQ    4,DU
        14 000112   000152 757000 11                 STAQ    FPT_MADMUCK+4

      100     8796
      101     8797    1       IF B$JIT.FPSN ~= ' '

   8797 14 000113   000000 470400 xsym               LDP0    B$JIT$
        14 000114   040000 106500                    CMPC    fill='040'O
        14 000115   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        14 000116   000004 000001 15                 ADSC9   4                        cn=0,n=1
        14 000117   000212 600000 14                 TZE     s:8823

      102     8798    2       THEN DO;

      103     8799
      104     8800    2           CALL CONCAT (USER_NAME.TEXT, 'DP#', B$JIT.FPSN);

   8800 14 000120   200003 471500                    LDP1    @USER_NAME,,AUTO
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:16   
        14 000121   000100 101500                    MRL     fill='000'O
        14 000122   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000123   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000124   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000125   040140 100400                    MLR     fill='040'O
        14 000126   000000 000003 13                 ADSC9   0                        cn=0,n=3
        14 000127   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        14 000130   000000 636010                    EAQ     0,X0
        14 000131   000022 772000                    QRL     18
        14 000132   000004 116007                    CMPQ    4,DL
        14 000133   000140 602000 14                 TNC     s:8801
        14 000134   777775 621010                    EAX1    -3,X0
        14 000135   040140 100500                    MLR     fill='040'O
        14 000136   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        14 000137   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1

      105     8801    2           CALL INDEX (INDX, ' ', USER_NAME.TEXT);

   8801 14 000140   000100 101500                    MRL     fill='000'O
        14 000141   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000142   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000143   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000144   000000 124540                    SCM     mask='000'O
        14 000145   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        14 000146   000004 000001 15                 ADSC9   4                        cn=0,n=1
        14 000147   200010 000100                    ARG     INDX,,AUTO

      106     8802    2           CALL INSERT (USER_NAME.TEXT, INDX, , '.', B$JIT.FACCN);

   8802 14 000150   000100 101500                    MRL     fill='000'O
        14 000151   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000152   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000153   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000154   000000 636010                    EAQ     0,X0
        14 000155   000022 772000                    QRL     18
        14 000156   200010 136100                    SBLQ    INDX,,AUTO
        14 000157   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:17   
        14 000160   200010 235100                    LDA     INDX,,AUTO
        14 000161   040145 100400                    MLR     fill='040'O
        14 000162   000005 000001 15                 ADSC9   5                        cn=0,n=1
        14 000163   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        14 000164   000001 116007                    CMPQ    1,DL
        14 000165   000172 604400 14                 TMOZ    s:8804
        14 000166   777777 621006                    EAX1    -1,QL
        14 000167   040145 100500                    MLR     fill='040'O
        14 000170   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
        14 000171   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1

      107     8803
      108     8804    2           CALL M$MADMUCK (FPT_MADMUCK)

   8804 14 000172   000146 630400 11                 EPPR0   FPT_MADMUCK
        14 000173   460005 713400                    CLIMB   alt,+24581
        14 000174   401000 401760                    pmme    nvectors=3
        14 000175   000210 702000 14                 TSX2    s:8816

      109     8805    3           WHENRETURN DO;

      110     8806
      111     8807    3               IF PACKSET.SN#(0) = B$JIT.FPSN

   8807 14 000176   000000 470400 xsym               LDP0    B$JIT$
        14 000177   040100 106500                    CMPC    fill='040'O
        14 000200   200005 000006                    ADSC9   PACKSET+1,,AUTO          cn=0,n=6
        14 000201   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        14 000202   000206 601000 14                 TNZ     s:8811

      112     8808    3               THEN
      113     8809    3                   IN_MAD = %YES#;

   8809 14 000203   400000 236003                    LDQ     -131072,DU
        14 000204   200011 756100                    STQ     IN_MAD,,AUTO
        14 000205   000207 710000 14                 TRA     s:8813

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:18   
      114     8810    3               ELSE
      115     8811    3                   IN_MAD = %NO#;

   8811 14 000206   200011 450100                    STZ     IN_MAD,,AUTO

      116     8812
      117     8813    3           END;

   8813 14 000207   000211 710000 14                 TRA     s:8819

      118     8814
      119     8815    3           WHENALTRETURN DO;

      120     8816    3               IN_MAD = %NO#;

   8816 14 000210   200011 450100                    STZ     IN_MAD,,AUTO

      121     8817    3           END;

      122     8818
      123     8819    2       END;

   8819 14 000211   000315 710000 14                 TRA     s:8841

      124     8820
      125     8821    2       ELSE DO;

      126     8822
      127     8823    2           CALL M$MADMUCK (FPT_MADMUCK)

   8823 14 000212   000146 630400 11                 EPPR0   FPT_MADMUCK
        14 000213   460005 713400                    CLIMB   alt,+24581
        14 000214   401000 401760                    pmme    nvectors=3
        14 000215   000240 702000 14                 TSX2    s:8832

      128     8824    3           WHENRETURN DO;

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:19   
      129     8825
      130     8826    3               CALL CONCAT (USER_NAME.TEXT, '.', B$JIT.FACCN);

   8826 14 000216   200003 470500                    LDP0    @USER_NAME,,AUTO
        14 000217   000100 101500                    MRL     fill='000'O
        14 000220   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000221   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000222   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000223   040140 100400                    MLR     fill='040'O
        14 000224   000005 000001 15                 ADSC9   5                        cn=0,n=1
        14 000225   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000226   000000 636010                    EAQ     0,X0
        14 000227   000022 772000                    QRL     18
        14 000230   000002 116007                    CMPQ    2,DL
        14 000231   000237 602000 14                 TNC     s:8828
        14 000232   777777 621010                    EAX1    -1,X0
        14 000233   000000 471400 xsym               LDP1    B$JIT$
        14 000234   040140 100500                    MLR     fill='040'O
        14 000235   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8
        14 000236   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1

      131     8827
      132     8828    3           END;

   8828 14 000237   000315 710000 14                 TRA     s:8841

      133     8829
      134     8830    3           WHENALTRETURN DO;

      135     8831
      136     8832    3               IN_MAD = %NO#;

   8832 14 000240   200011 450100                    STZ     IN_MAD,,AUTO

      137     8833    3               CALL CONCAT (USER_NAME.TEXT, 'DP#', B$JIT.HPSN);

   8833 14 000241   200003 470500                    LDP0    @USER_NAME,,AUTO
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:20   
        14 000242   000100 101500                    MRL     fill='000'O
        14 000243   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000244   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000245   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000246   040140 100400                    MLR     fill='040'O
        14 000247   000000 000003 13                 ADSC9   0                        cn=0,n=3
        14 000250   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000251   000000 636010                    EAQ     0,X0
        14 000252   000022 772000                    QRL     18
        14 000253   000004 116007                    CMPQ    4,DL
        14 000254   000262 602000 14                 TNC     s:8834
        14 000255   777775 621010                    EAX1    -3,X0
        14 000256   000000 471400 xsym               LDP1    B$JIT$
        14 000257   040140 100500                    MLR     fill='040'O
        14 000260   100234 000006                    ADSC9   156,,PR1                 cn=0,n=6
        14 000261   000001 000011                    ADSC9   1,,PR0                   cn=0,n=*X1

      138     8834    3               CALL INDEX (INDX, ' ', USER_NAME.TEXT);

   8834 14 000262   000100 101500                    MRL     fill='000'O
        14 000263   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000264   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000265   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000266   000000 124540                    SCM     mask='000'O
        14 000267   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000270   000004 000001 15                 ADSC9   4                        cn=0,n=1
        14 000271   200010 000100                    ARG     INDX,,AUTO

      139     8835    3               CALL INSERT (USER_NAME.TEXT, INDX, , '.', B$JIT.FACCN);

   8835 14 000272   000100 101500                    MRL     fill='000'O
        14 000273   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000274   200012 000002                    ADSC9   IN_MAD+1,,AUTO           cn=0,n=2
        14 000275   200012 220100                    LDX0    IN_MAD+1,,AUTO
        14 000276   000000 636010                    EAQ     0,X0
        14 000277   000022 772000                    QRL     18
        14 000300   200010 136100                    SBLQ    INDX,,AUTO
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:21   
        14 000301   000000 621006                    EAX1    0,QL
        14 000302   200010 235100                    LDA     INDX,,AUTO
        14 000303   040145 100400                    MLR     fill='040'O
        14 000304   000005 000001 15                 ADSC9   5                        cn=0,n=1
        14 000305   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        14 000306   000001 116007                    CMPQ    1,DL
        14 000307   000315 604400 14                 TMOZ    s:8841
        14 000310   777777 621006                    EAX1    -1,QL
        14 000311   000000 471400 xsym               LDP1    B$JIT$
        14 000312   040145 100500                    MLR     fill='040'O
        14 000313   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8
        14 000314   000000 400011                    ADSC9   0,A,PR0                  cn=2,n=*X1

      140     8836
      141     8837    3           END;

      142     8838
      143     8839    2       END;

      144     8840
      145     8841    1       CALL X$STRIP_BLANKS (ADDR(USER_NAME));

   8841 14 000315   200003 236100                    LDQ     @USER_NAME,,AUTO
        14 000316   200012 756100                    STQ     IN_MAD+1,,AUTO
        14 000317   200012 630500                    EPPR0   IN_MAD+1,,AUTO
        14 000320   200013 450500                    STP0    IN_MAD+2,,AUTO
        14 000321   200013 630500                    EPPR0   IN_MAD+2,,AUTO
        14 000322   000001 631400 15                 EPPR1   1
        14 000323   000000 701000 xent               TSX1    X$STRIP_BLANKS
        14 000324   000000 011000                    NOP     0

      146     8842        /*
      147     8843             ***** If :NAME is open, then close it ...
      148     8844        */
      149     8845    1   CLEANUP:
      150     8846    1       IF DCBADDR(DCBNUM(M$NAME)) -> F$DCB.FCD#

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:22   
   8846 14 000325   000000 236007 xsym  CLEANUP      LDQ     M$NAME,DL
        14 000326   000000 470400 15                 LDP0    0
        14 000327   000000 471500                    LDP1    0,,PR0
        14 000330   100000 473506                    LDP3    0,QL,PR1
        14 000331   300031 236100                    LDQ     25,,PR3
        14 000332   020000 316007                    CANQ    8192,DL
        14 000333   000340 600000 14                 TZE     IGNORE_ALTRET

      151     8847    1       THEN
      152     8848    1           CALL M$CLOSE (CLOSE_NAME) ALTRET(IGNORE_ALTRET);

   8848 14 000334   000072 630400 11                 EPPR0   CLOSE_NAME
        14 000335   450001 713400                    CLIMB   alt,close
        14 000336   406000 401760                    pmme    nvectors=13
        14 000337   000340 702000 14                 TSX2    IGNORE_ALTRET

   8846 14 000340                       IGNORE_ALTR* null
      153     8849    1   IGNORE_ALTRET: ;
      154     8850        /**/
      155     8851    1       RETURN;

   8851 14 000340   000000 702200 xent               TSX2  ! X66_ARET

OPEN_NAME
 Sect OctLoc
  11     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
  11     004   000000 177640   000000 006014   000001 377640   000000 006000    ................
  11     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     024*  000001 777640   000000 006000   000000 177640   000000 006014    ................
  11     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     044*  000000 000052   000000 002001   252525 000000   000040 252520    ...*......... ..
  11     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
  11     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  11     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  11     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
  11     070   000000 000000   ****** ******                                    ........

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:23   
CLOSE_NAME
 Sect OctLoc
  11     072   000003 777640   000124 006000   000000 177640   000000 006014    .....T..........
  11     076   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     122*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
  11     126   000220 000000   000000 000000                                    ........

READ_NAME
 Sect OctLoc
  11     130   000005 777640   000140 006000   000005 177640   000156 006000    .....`.......n..
  11     134   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     140   000000 600000   000000 000000   000000 000000   000000 000000    ................
  11     144   000000 000000   000000 000000                                    ........

FPT_MADMUCK
 Sect OctLoc
  11     146   000001 777640   000154 006000   000000 177640   000000 006014    .....l..........
  11     152   000000 177640   000000 006014   000000 400000   000000 000000    ................

NAME_KEY
 Sect OctLoc
  11     156   001040 040040   040040 040040   040040 040040   040040 040040    .
  11     162   040040 040040   040*** ******                                         ...

(unnamed)
 Sect OctLoc
  13     000   104120 043040                                                    DP#

(unnamed)
 Sect OctLoc
  15     000   000000 006003   000001 000000   000001 777640   000003 777640    ................
  15     004   040040 040040   056040 040040                                        .
      156     8852    1   END VMF$FROM;
      157     8853        %EOD;

PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:24   
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$FROM.
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:25   

 **** Variables and constants ****

  ****  Section 011  Data  VMF$FROM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_NAME               146-0-0/d STRC(288)   r     1 FPT_MADMUCK
   156-0-0/c STRC(189)   r     1 NAME_KEY                   0-0-0/d STRC(2088)  r     1 OPEN_NAME
   130-0-0/d STRC(504)   r     1 READ_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @USER_NAME                10-0-0/w UBIN        r     1 INDX
    11-0-0/b BIT         r     1 IN_MAD                     4-0-0/d STRC(90)    r     1 PACKSET
    *0-0-0/c ASTR(9)     r     1 USER_NAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:26   
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)    r     1 VM_MAIL_ACCT
     0-0-0/c STRC(54)    r     1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$MAIL_CENTRAL             0-0-0N  NULL        r     1 M$MAIL_COMGROUP
     0-0-0N  NULL        r     1 M$MAIL_FILE                0-0-0N  NULL        r     1 M$MAIL_GLOBAL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NAME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMF$FROM requires 225 words for executable code.
   Procedure VMF$FROM requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:27   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:28   
          MINI XREF LISTING

B$JIT.ACCN
       359**DCL      8772>>CALLBLT  8785>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       453**DCL       453--REDEF
B$JIT.ERR.MID
       360**DCL       360--REDEF
B$JIT.FACCN
       359**DCL      8794--ASSIGN   8802>>CALLBLT  8826>>CALLBLT  8835>>CALLBLT
B$JIT.FPSN
       440**DCL      8797>>IF       8800>>CALLBLT  8807>>IF
B$JIT.HPSN
       527**DCL      8833>>CALLBLT
B$JIT.JRESPEAK
       521**DCL       522--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       630**DCL       630--REDEF     631--REDEF
B$JIT.PNR
       534**DCL       534--REDEF
B$JIT.TSLINE
       628**DCL       629--REDEF
B$JIT.UNAME
       359**DCL      8772>>CALLBLT
B$JIT$
      8209**DCL       354--IMP-PTR  8772>>CALLBLT  8772>>CALLBLT  8785>>ASSIGN   8794>>ASSIGN   8797>>IF
      8800>>CALLBLT  8802>>CALLBLT  8807>>IF       8826>>CALLBLT  8833>>CALLBLT  8835>>CALLBLT
CLEANUP
      8846**LABEL    8780--GOTO     8789--GOTO
CLOSE_NAME
      8641**DCL      8848<>CALL
CLOSE_NAME.SN_
      8641**DCL      8641--REDEF
CLOSE_NAME.UTL_
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:29   
      8642**DCL      8642--REDEF
CLOSE_NAME.V
      8646**DCL      8641--DCLINIT
CLOSE_NAME.V.EXPIRE#
      8656**DCL      8656--REDEF
CLOSE_NAME.V.TYPE#
      8654**DCL      8654--REDEF
CLOSE_NAME.V.XTNSIZE#
      8651**DCL      8651--REDEF    8653--REDEF
ERRMSG_FID.L#
      8278**DCL      8278--IMP-SIZ
F$DCB.ACTPOS
      8476**DCL      8476--REDEF
F$DCB.ARS#
      8450**DCL      8450--REDEF    8779>>ASSIGN   8787>>ASSIGN
F$DCB.ATTR
      8469**DCL      8470--REDEF
F$DCB.BORROW
      8484**DCL      8484--REDEF    8484--REDEF    8484--REDEF
F$DCB.DCBNAME.L
      8498**DCL      8498--IMP-SIZ
F$DCB.EOMCHAR#
      8454**DCL      8454--REDEF
F$DCB.FCD#
      8463**DCL      8846>>IF
F$DCB.FLDID
      8479**DCL      8479--REDEF
F$DCB.FORM$
      8473**DCL      8473--REDEF
F$DCB.FSECT
      8489**DCL      8489--REDEF
F$DCB.FSN#
      8466**DCL      8466--REDEF    8466--REDEF    8467--REDEF
F$DCB.HEADER$
      8472**DCL      8472--REDEF
F$DCB.IXTNSIZE#
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:30   
      8470**DCL      8470--REDEF
F$DCB.LASTSTA$
      8459**DCL      8459--REDEF
F$DCB.LVL
      8485**DCL      8485--REDEF
F$DCB.NAME#.C
      8460**DCL      8460--REDEF
F$DCB.NOEOF
      8482**DCL      8482--REDEF
F$DCB.NRECS#
      8471**DCL      8471--REDEF
F$DCB.NRECX
      8490**DCL      8490--REDEF
F$DCB.OHDR
      8482**DCL      8482--REDEF
F$DCB.ORG#
      8465**DCL      8465--REDEF
F$DCB.PRECNO
      8488**DCL      8488--REDEF
F$DCB.RCSZ
      8494**DCL      8494--REDEF
F$DCB.RES#
      8461**DCL      8461--REDEF
F$DCB.SETX
      8473**DCL      8473--REDEF
F$DCB.TAB$
      8473**DCL      8473--REDEF
F$DCB.TDA
      8487**DCL      8488--REDEF
F$DCB.WSN#
      8461**DCL      8461--REDEF
FPT_MADMUCK
      8713**DCL      8804<>CALL     8823<>CALL
FPT_MADMUCK.ACCT_
      8713**DCL      8794<<ASSIGN
FPT_MADMUCK.SN_
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:31   
      8713**DCL      8795<<ASSIGN
FPT_MADMUCK.V
      8714**DCL      8713--DCLINIT
IGNORE_ALTRET
      8846**LABEL    8848--CALLALT
INDX
      8761**DCL      8801<<CALLBLT  8802>>CALLBLT  8834<<CALLBLT  8835>>CALLBLT
IN_MAD
      8762**DCL      8764<<ASSIGN   8809<<ASSIGN   8811<<ASSIGN   8816<<ASSIGN   8832<<ASSIGN
M$CLOSE
      6122**DCL-ENT  8848--CALL
M$MADMUCK
      6130**DCL-ENT  8804--CALL     8823--CALL
M$NAME
      8732**DCL      8779--ASSIGN   8787--ASSIGN   8846--IF
M$OPEN
      6122**DCL-ENT  8768--CALL
M$READ
      6123**DCL-ENT  8778--CALL     8786--CALL
NAME_KEY
      8759**DCL      8680--DCLINIT  8681--DCLINIT
NAME_KEY.L#
      8759**DCL      8773<<ASSIGN
NAME_KEY.NAME#
      8759**DCL      8772<<CALLBLT  8785<<ASSIGN
NO_NAME
      8794**LABEL    8768--CALLALT  8786--CALLALT
OPEN_NAME
      8572**DCL      8768<>CALL
OPEN_NAME.ACSVEH_
      8574**DCL      8575--REDEF
OPEN_NAME.ALTKEYS_
      8580**DCL      8581--REDEF    8581--REDEF
OPEN_NAME.HDR_
      8579**DCL      8580--REDEF
OPEN_NAME.TAB_
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:32   
      8578**DCL      8579--REDEF
OPEN_NAME.UHL_
      8572**DCL      8573--REDEF    8573--REDEF
OPEN_NAME.V
      8581**DCL      8572--DCLINIT
OPEN_NAME.V.FSN#
      8612**DCL      8612--REDEF    8612--REDEF
OPEN_NAME.WSN_
      8578**DCL      8578--REDEF
PACKSET
      8729**DCL      8795--ASSIGN
PACKSET.SN#
      8729**DCL      8807>>IF
READ_NAME
      8680**DCL      8778<>CALL     8786<>CALL
READ_NAME.BUF_
      8682**DCL      8777<<ASSIGN
READ_NAME.STATION_
      8683**DCL      8684--REDEF
READ_NAME.V
      8684**DCL      8680--DCLINIT
READ_NAME.V.DVBYTE.REREAD#
      8695**DCL      8695--REDEF
READ_NAME.V.INDX#
      8693**DCL      8693--REDEF
TRY_AGAIN
      8785**LABEL    8778--CALLALT
USER_NAME
      8435**DCL        30--PROC     8788--CALL     8841--CALL
USER_NAME.SIZ
      8436**DCL      8437--IMP-SIZ  8777>>ASSIGN   8779<<ASSIGN   8787<<ASSIGN   8800>>CALLBLT  8801>>CALLBLT
      8802>>CALLBLT  8826>>CALLBLT  8833>>CALLBLT  8834>>CALLBLT  8835>>CALLBLT
USER_NAME.TEXT
      8437**DCL      8777--ASSIGN   8800<<CALLBLT  8801>>CALLBLT  8802<<CALLBLT  8826<<CALLBLT  8833<<CALLBLT
      8834>>CALLBLT  8835<<CALLBLT
VM_MAIL_ACCT
PL6.E3A0      #001=VMF$FROM File=VMF$SUBR.:VMB6TSI                               WED 08/20/97 15:15 Page:33   
      8224**DCL      8577--DCLINIT
VM_NAME_MAP_NAME
      8251**DCL      8573--DCLINIT
X$STRING.SIZ
      8124**DCL      8125--IMP-SIZ
X$STRIP_BLANKS
      8441**DCL-ENT  8788--CALL     8841--CALL

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:34   
      158        1        /*T***********************************************************/
      159        2        /*T*                                                         */
      160        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      161        4        /*T*                                                         */
      162        5        /*T***********************************************************/
      163        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      164        7        /*P*
      165        8             NAME: VMF$MAKE_ADDRESS1
      166        9             ENTRY: VMF$MAKE_ADDRESS1PASS
      167       10             ENTRY: VMF$MAKE_ADDRESS1SITE
      168       11             PURPOSE:
      169       12                   This routine generates a MAIL ADDRESS.
      170       13             DESCRIPTION:
      171       14                   Given two parameters as input, this routine will
      172       15                   generate a MAIL ADDRESS. The parameters are:
      173       16
      174       17                      ADDRESS    - contains the result. A TEXTC string of len 256.
      175       18                      VM_FOLDER_INFO - information to use to create the address.
      176       19        */
      177       20        VMF$MAKE_ADDRESS1: PROC (ADDRESS,VM_FOLDER_INFO);
      178       21        /***** Include files *****/
      179       22          %INCLUDE CP_6;
      180     5581          %INCLUDE CP_6_SUBS;
      181     6121          %INCLUDE VM_MACRO_C;
      182     7389          %INCLUDE VM_DATA_R;
      183     7820            %include B$TABLES_C;
      184     7928
      185     7929        %B$SR_NON_BLANK;
      186     7933        %B$SR_NON_ALPHA;
      187     7937        /***** Parameters *****/
      188     7938             %TEXTC (NAME=ADDRESS,STCLASS=" ");
      189     7943             %VM_FOLDER_INFO (STCLASS=" ");
      190     7995        /***** Local variables *****/
      191     7996    1   DCL NEXT UBIN WORD AUTO;
      192     7997    1   DCL FOUND BIT(1) AUTO;
      193     7998    1   DCL ACCTSET BIT(1) AUTO;
      194     7999    1   DCL INDX UBIN AUTO;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:35   
      195     8000    1   DCL CHAR1 CHAR(1) BASED;
      196     8001    1   dcl ADDPASS BIT(1) aligned;
      197     8002    1   dcl ADDSITE BIT(1) aligned;
      198     8003        %EJECT;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:36   
      199     8004    1       ADDPASS = '0'B;                    /**  Don't include password  **/
      200     8005    1       ADDSITE = '0'B;                    /**  Don't include sitename  **/
      201     8006    1       goto START_OF_PROCEDURE;
      202     8007
      203     8008    1   VMF$MAKE_ADDRESS1PASS: entry(ADDRESS,VM_FOLDER_INFO);
      204     8009
      205     8010    1       ADDPASS = '1'B;                    /**  Include the password    **/
      206     8011    1       ADDSITE = '0'B;                    /**  Don't include sitename  **/
      207     8012    1       goto START_OF_PROCEDURE;
      208     8013
      209     8014    1   VMF$MAKE_ADDRESS1SITE: entry(ADDRESS,VM_FOLDER_INFO);
      210     8015
      211     8016    1       ADDPASS = '0'B;                    /**  Don't include password  */
      212     8017    1       ADDSITE = '1'B;                    /**  Include the sitename    */
      213     8018
      214     8019
      215     8020    1   START_OF_PROCEDURE:
      216     8021
      217     8022    1       ADDRESS.TEXT = ' ';
      218     8023    1       ACCTSET = '0'B;
      219     8024        /*
      220     8025              ***** Insert the  packset name if any.
      221     8026        */
      222     8027    1       IF VM_FOLDER_INFO.PSID = ' '
      223     8028    1       THEN
      224     8029    1           INDX = 0;
      225     8030
      226     8031    2       ELSE DO;
      227     8032
      228     8033    2           CALL CONCAT (ADDRESS.TEXT, 'DP#', VM_FOLDER_INFO.PSID);
      229     8034    2           CALL INDEX (INDX, ' ', ADDRESS.TEXT);
      230     8035
      231     8036    2       END;
      232     8037
      233     8038        /*
      234     8039             ***** Insert the folder name ...
      235     8040        */
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:37   
      236     8041    1       INDX=0;
      237     8042    1       IF VM_FOLDER_INFO.FLAGS.FOLDER_SPEC
      238     8043    1       THEN
      239     8044    2       DO;
      240     8045    2           CALL CONCAT(ADDRESS.TEXT,'/',VM_FOLDER_INFO.FOLDER);
      241     8046    2           CALL INDEX (INDX,' ',ADDRESS.TEXT);
      242     8047    2       END;
      243     8048        /*
      244     8049             ***** Insert the user name or account ...
      245     8050        */
      246     8051    1       IF VM_FOLDER_INFO.USER_NAME.COUNT > 0
      247     8052    1       THEN
      248     8053    2       DO;                                /* Use user name rather than acct */
      249     8054    2           NEXT = VM_FOLDER_INFO.USER_NAME.COUNT;
      250     8055    3           if NEXT > 0 then do;
      251     8056    3               call INSERT_NAME(VM_FOLDER_INFO.USER_NAME.TEXT,NEXT);
      252     8057    3               IF VM_FOLDER_INFO.FOLDER = ' '
      253     8058    3               THEN
      254     8059    3                   INDX = 0;
      255     8060    3               ELSE
      256     8061    3                   CALL INSERT(ADDRESS.TEXT,NEXT,,'/',VM_FOLDER_INFO.FOLDER);
      257     8062    3           END;
      258     8063    2           NEXT=NEXT+INDX;
      259     8064    2       END;
      260     8065    1       ELSE
      261     8066    2       DO;                                /* Use acct */
      262     8067    2           ACCTSET = '1'B;
      263     8068    2           CALL INDEX (NEXT,' ',VM_FOLDER_INFO.ACCT);
      264     8069    2           CALL INSERT (ADDRESS.TEXT,INDX,,'.',SUBSTR(VM_FOLDER_INFO.ACCT,0,NEXT));
      265     8070    2           NEXT=NEXT+1+INDX;
      266     8071    2       END;
      267     8072    1       if ADDPASS and VM_FOLDER_INFO.PASS ~= ' ' then
      268     8073    2       do;                                /**  Need to add the password  **/
      269     8074    2           if not ACCTSET then
      270     8075    3           do;                           /**  Add the first '.'  **/
      271     8076    3               substr(ADDRESS.TEXT,NEXT,1) = '.';
      272     8077    3               NEXT = NEXT + 1;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:38   
      273     8078    3           end;
      274     8079    2           substr(ADDRESS.TEXT,NEXT,1) = '.';
      275     8080    2           substr(ADDRESS.TEXT,NEXT+1,8) = VM_FOLDER_INFO.PASS;
      276     8081    2           call index(INDX,' ',VM_FOLDER_INFO.PASS);
      277     8082    2           NEXT = NEXT + INDX + 1;
      278     8083    2           ACCTSET = '0'B;
      279     8084    2       end;
      280     8085        /*
      281     8086             ***** Insert the sitename ...
      282     8087        */
      283     8088    1       IF VM_FOLDER_INFO.SITENAME ~= ' ' AND ADDSITE
      284     8089    2       THEN DO;
      285     8090    2           IF ACCTSET THEN
      286     8091    2               CALL INSERT (ADDRESS.TEXT,NEXT,,'@',VM_FOLDER_INFO.SITENAME);
      287     8092    2           ELSE CALL INSERT (ADDRESS.TEXT,NEXT,,' @',VM_FOLDER_INFO.SITENAME);
      288     8093    2           CALL INDEX (NEXT,' ',ADDRESS.TEXT,NEXT+1);
      289     8094    2       END;
      290     8095        /*
      291     8096             ***** Set ADDRESS.SIZ to proper value ...
      292     8097        */
      293     8098    1       ADDRESS.SIZ = NEXT;
      294     8099    1       RETURN;
      295     8100        %EJECT;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:39   
      296     8101        /*I*
      297     8102             NAME:       VMF$INSERT_NAME
      298     8103             PURPOSE:    To copy a registered name into a textc
      299     8104                         field that is the legal input form for that
      300     8105                         name.
      301     8106
      302     8107             DESCRIPTION:
      303     8108                         The three parameters are:
      304     8109
      305     8110                         NAME     a text field containing the name
      306     8111                                  to be moved.
      307     8112                         LEN      On input: the length of the name
      308     8113                                  in NAME;  on output, the length
      309     8114                                  of the name in ADDRESS.
      310     8115                         ADDRESS  a textc field to hold the legal input
      311     8116                                  form for a name.
      312     8117
      313     8118                         In order to make the legal input form, the NAME
      314     8119                         is searched for non-alphanumerics and non-blanks
      315     8120                         and if any appear, the output in ADDRESS is
      316     8121                         quoted.  If any quotes appear, they are doubled.
      317     8122        */
      318     8123
      319     8124
      320     8125
      321     8126    1   INSERT_NAME: proc(NAME, LEN);
      322     8127
      323     8128    2   dcl  NAME        char(L);
      324     8129    2   dcl  LEN         sbin;
      325     8130
      326     8131    2   dcl  QUOTED      bit(1);
      327     8132    2   dcl  L           sbin;
      328     8133    2   dcl  I           sbin;
      329     8134    2   dcl  INS         sbin;
      330     8135    2   dcl  DUMMY       ubin;
      331     8136    2   dcl  J           sbin;
      332     8137    2   dcl  S           sbin;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:40   
      333     8138
      334     8139    2       QUOTED = '0'b;
      335     8140    2       L   = LEN;
      336     8141    2       I   = 0;
      337     8142
      338     8143    2       call searchr(L, DUMMY,B$SR_NON_BLANK,NAME)
      339     8144    3       whenaltreturn do;
      340     8145    3           L = 0;
      341     8146    3       end;
      342     8147    2       L = L + 1;
      343     8148
      344     8149    2       INS = 0;
      345     8150
      346     8151    3       do while I < L;
      347     8152
      348     8153    3           S = I;
      349     8154    3           if substr(NAME,I,1) = ' ' then S = S + 1;
      350     8155
      351     8156    3           call search(S, DUMMY, B$SR_NON_ALPHA, NAME, S)
      352     8157    4           whenaltreturn do;
      353     8158    4               J = L - I;
      354     8159    4               substr(ADDRESS.TEXT,INS,J) = substr(NAME,I);
      355     8160    4               INS = INS + J;
      356     8161    5               if QUOTED then do;
      357     8162    5                   substr(ADDRESS.TEXT,INS,1) = '''';
      358     8163    5                   INS = INS + 1;
      359     8164    5               end;
      360     8165    4               LEN = INS;
      361     8166    4               return;
      362     8167    4           end;
      363     8168
      364     8169    3           if substr(NAME,S,1) ~= ' ' then
      365     8170    4               if ( binbit(DUMMY,9) & %B$SR#SYM ) = '0'b and not QUOTED then do;
      366     8171    4                   substr(ADDRESS.TEXT,0,1) = '''';
      367     8172    4                   substr(ADDRESS.TEXT,1,INS) = NAME;
      368     8173    4                   QUOTED = '1'b;
      369     8174    4                   INS = INS + 1;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:41   
      370     8175    4               end;
      371     8176
      372     8177    3           J = S - I + 1;
      373     8178    3           substr(ADDRESS.TEXT,INS,J) = substr(NAME,I,J);
      374     8179    3           INS = INS + J;
      375     8180    3           I = I + J;
      376     8181    4           if substr(NAME,S,1) = '''' then do;
      377     8182    4               substr(ADDRESS.TEXT,INS,1) = '''';
      378     8183    4               INS = INS + 1;
      379     8184    4           end;
      380     8185
      381     8186    3       end;
      382     8187
      383     8188    3       if QUOTED then do;
      384     8189    3           substr(ADDRESS.TEXT,INS,1) = '''';
      385     8190    3           INS = INS + 1;
      386     8191    3       end;
      387     8192
      388     8193    2       LEN = INS;
      389     8194    2       return;
      390     8195
      391     8196    2   end INSERT_NAME;
      392     8197
      393     8198    1   END VMF$MAKE_ADDRESS1;
      394     8199        %EOD;

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:42   
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$MAKE_ADDRESS1.

   Procedure VMF$MAKE_ADDRESS1 requires 449 words for executable code.
   Procedure VMF$MAKE_ADDRESS1 requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:43   

 Object Unit name= VMF$MAKE_ADDRESS1                          File name= VMF$SUBR.:VMB6TOU
 UTS= AUG 20 '97 15:15:58.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11  RoData even  UTS      2      2  VMF$MAKE_ADDRESS1
   12   Proc  even  none   449    701  VMF$MAKE_ADDRESS1
   13  RoData even  none     6      6  VMF$MAKE_ADDRESS1

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        2  VMF$MAKE_ADDRESS1
    12      5                  yes      Std        2  VMF$MAKE_ADDRESS1PASS
    12     13                  yes      Std        2  VMF$MAKE_ADDRESS1SITE
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:44   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                 r    B$SR_NON_BLANK$
r    B$SR_NON_ALPHA$
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:45   


      158        1        /*T***********************************************************/
      159        2        /*T*                                                         */
      160        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      161        4        /*T*                                                         */
      162        5        /*T***********************************************************/
      163        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      164        7        /*P*
      165        8             NAME: VMF$MAKE_ADDRESS1
      166        9             ENTRY: VMF$MAKE_ADDRESS1PASS
      167       10             ENTRY: VMF$MAKE_ADDRESS1SITE
      168       11             PURPOSE:
      169       12                   This routine generates a MAIL ADDRESS.
      170       13             DESCRIPTION:
      171       14                   Given two parameters as input, this routine will
      172       15                   generate a MAIL ADDRESS. The parameters are:
      173       16
      174       17                      ADDRESS    - contains the result. A TEXTC string of len 256.
      175       18                      VM_FOLDER_INFO - information to use to create the address.
      176       19        */
      177       20        VMF$MAKE_ADDRESS1: PROC (ADDRESS,VM_FOLDER_INFO);

     20 12 000000   000000 700200 xent  VMF$MAKE_AD* TSX0  ! X66_AUTO_2
        12 000001   000030 000002                    ZERO    24,2

      178       21        /***** Include files *****/
      179       22          %INCLUDE CP_6;
      180     5581          %INCLUDE CP_6_SUBS;
      181     6121          %INCLUDE VM_MACRO_C;
      182     7389          %INCLUDE VM_DATA_R;
      183     7820            %include B$TABLES_C;
      184     7928
      185     7929        %B$SR_NON_BLANK;
      186     7933        %B$SR_NON_ALPHA;
      187     7937        /***** Parameters *****/
      188     7938             %TEXTC (NAME=ADDRESS,STCLASS=" ");
      189     7943             %VM_FOLDER_INFO (STCLASS=" ");
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:46   
      190     7995        /***** Local variables *****/
      191     7996    1   DCL NEXT UBIN WORD AUTO;
      192     7997    1   DCL FOUND BIT(1) AUTO;
      193     7998    1   DCL ACCTSET BIT(1) AUTO;
      194     7999    1   DCL INDX UBIN AUTO;
      195     8000    1   DCL CHAR1 CHAR(1) BASED;
      196     8001    1   dcl ADDPASS BIT(1) aligned;
      197     8002    1   dcl ADDSITE BIT(1) aligned;
      198     8003        %EJECT;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:47   
      199     8004    1       ADDPASS = '0'B;                    /**  Don't include password  **/

   8004 12 000002   200011 450100                    STZ     ADDPASS,,AUTO

      200     8005    1       ADDSITE = '0'B;                    /**  Don't include sitename  **/

   8005 12 000003   200012 450100                    STZ     ADDSITE,,AUTO

      201     8006    1       goto START_OF_PROCEDURE;

   8006 12 000004   000020 710000 12                 TRA     START_OF_PROCEDURE

      202     8007
      203     8008    1   VMF$MAKE_ADDRESS1PASS: entry(ADDRESS,VM_FOLDER_INFO);

   8008 12 000005   000000 700200 xent  VMF$MAKE_AD* TSX0  ! X66_AUTO_2
        12 000006   000030 000002                    ZERO    24,2

      204     8009
      205     8010    1       ADDPASS = '1'B;                    /**  Include the password    **/

   8010 12 000007   400000 236003                    LDQ     -131072,DU
        12 000010   200011 756100                    STQ     ADDPASS,,AUTO

      206     8011    1       ADDSITE = '0'B;                    /**  Don't include sitename  **/

   8011 12 000011   200012 450100                    STZ     ADDSITE,,AUTO

      207     8012    1       goto START_OF_PROCEDURE;

   8012 12 000012   000020 710000 12                 TRA     START_OF_PROCEDURE

      208     8013
      209     8014    1   VMF$MAKE_ADDRESS1SITE: entry(ADDRESS,VM_FOLDER_INFO);

   8014 12 000013   000000 700200 xent  VMF$MAKE_AD* TSX0  ! X66_AUTO_2
        12 000014   000030 000002                    ZERO    24,2
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:48   

      210     8015
      211     8016    1       ADDPASS = '0'B;                    /**  Don't include password  */

   8016 12 000015   200011 450100                    STZ     ADDPASS,,AUTO

      212     8017    1       ADDSITE = '1'B;                    /**  Include the sitename    */

   8017 12 000016   400000 236003                    LDQ     -131072,DU
        12 000017   200012 756100                    STQ     ADDSITE,,AUTO

      213     8018
      214     8019
      215     8020    1   START_OF_PROCEDURE:
      216     8021
      217     8022    1       ADDRESS.TEXT = ' ';

   8022 12 000020   200003 470500       START_OF_PR* LDP0    @ADDRESS,,AUTO
        12 000021   000100 101500                    MRL     fill='000'O
        12 000022   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000023   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000024   200026 220100                    LDX0    S+1,,AUTO
        12 000025   040140 100400                    MLR     fill='040'O
        12 000026   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000027   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      218     8023    1       ACCTSET = '0'B;

   8023 12 000030   200007 450100                    STZ     ACCTSET,,AUTO

      219     8024        /*
      220     8025              ***** Insert the  packset name if any.
      221     8026        */
      222     8027    1       IF VM_FOLDER_INFO.PSID = ' '

   8027 12 000031   200004 471500                    LDP1    @VM_FOLDER_INFO,,AUTO
        12 000032   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:49   
        12 000033   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
        12 000034   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000035   000040 601000 12                 TNZ     s:8033

      223     8028    1       THEN
      224     8029    1           INDX = 0;

   8029 12 000036   200010 450100                    STZ     INDX,,AUTO
        12 000037   000067 710000 12                 TRA     s:8041

      225     8030
      226     8031    2       ELSE DO;

      227     8032
      228     8033    2           CALL CONCAT (ADDRESS.TEXT, 'DP#', VM_FOLDER_INFO.PSID);

   8033 12 000040   000100 101500                    MRL     fill='000'O
        12 000041   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000042   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000043   200026 220100                    LDX0    S+1,,AUTO
        12 000044   040140 100400                    MLR     fill='040'O
        12 000045   000000 000003 11                 ADSC9   0                        cn=0,n=3
        12 000046   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 000047   000000 636010                    EAQ     0,X0
        12 000050   000022 772000                    QRL     18
        12 000051   000004 116007                    CMPQ    4,DL
        12 000052   000057 602000 12                 TNC     s:8034
        12 000053   777775 621010                    EAX1    -3,X0
        12 000054   040140 100500                    MLR     fill='040'O
        12 000055   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
        12 000056   000001 000011                    ADSC9   1,,PR0                   cn=0,n=*X1

      229     8034    2           CALL INDEX (INDX, ' ', ADDRESS.TEXT);

   8034 12 000057   000100 101500                    MRL     fill='000'O
        12 000060   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000061   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:50   
        12 000062   200026 220100                    LDX0    S+1,,AUTO
        12 000063   000000 124540                    SCM     mask='000'O
        12 000064   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 000065   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000066   200010 000100                    ARG     INDX,,AUTO

      230     8035
      231     8036    2       END;

      232     8037
      233     8038        /*
      234     8039             ***** Insert the folder name ...
      235     8040        */
      236     8041    1       INDX=0;

   8041 12 000067   200010 450100                    STZ     INDX,,AUTO

      237     8042    1       IF VM_FOLDER_INFO.FLAGS.FOLDER_SPEC

   8042 12 000070   100023 236100                    LDQ     19,,PR1
        12 000071   040000 316003                    CANQ    16384,DU
        12 000072   000122 600000 12                 TZE     s:8051

      238     8043    1       THEN
      239     8044    2       DO;

      240     8045    2           CALL CONCAT(ADDRESS.TEXT,'/',VM_FOLDER_INFO.FOLDER);

   8045 12 000073   000100 101500                    MRL     fill='000'O
        12 000074   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000075   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000076   200026 220100                    LDX0    S+1,,AUTO
        12 000077   040140 100400                    MLR     fill='040'O
        12 000100   000001 000001 13                 ADSC9   1                        cn=0,n=1
        12 000101   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 000102   000000 636010                    EAQ     0,X0
        12 000103   000022 772000                    QRL     18
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:51   
        12 000104   000002 116007                    CMPQ    2,DL
        12 000105   000112 602000 12                 TNC     s:8046
        12 000106   777777 621010                    EAX1    -1,X0
        12 000107   040140 100500                    MLR     fill='040'O
        12 000110   100003 400031                    ADSC9   3,,PR1                   cn=2,n=25
        12 000111   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1

      241     8046    2           CALL INDEX (INDX,' ',ADDRESS.TEXT);

   8046 12 000112   000100 101500                    MRL     fill='000'O
        12 000113   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000114   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000115   200026 220100                    LDX0    S+1,,AUTO
        12 000116   000000 124540                    SCM     mask='000'O
        12 000117   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 000120   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000121   200010 000100                    ARG     INDX,,AUTO

      242     8047    2       END;

      243     8048        /*
      244     8049             ***** Insert the user name or account ...
      245     8050        */
      246     8051    1       IF VM_FOLDER_INFO.USER_NAME.COUNT > 0

   8051 12 000122   100024 236100                    LDQ     20,,PR1
        12 000123   777000 316003                    CANQ    -512,DU
        12 000124   000177 600000 12                 TZE     s:8067

      247     8052    1       THEN
      248     8053    2       DO;                                /* Use user name rather than acct */

      249     8054    2           NEXT = VM_FOLDER_INFO.USER_NAME.COUNT;

   8054 12 000125   100024 236100                    LDQ     20,,PR1
        12 000126   000033 772000                    QRL     27
        12 000127   200005 756100                    STQ     NEXT,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:52   

      250     8055    3           if NEXT > 0 then do;

   8055 12 000130   000173 600000 12                 TZE     s:8063

      251     8056    3               call INSERT_NAME(VM_FOLDER_INFO.USER_NAME.TEXT,NEXT);

   8056 12 000131   200005 633500                    EPPR3   NEXT,,AUTO
        12 000132   200016 453500                    STP3    @NAME+1,,AUTO
        12 000133   200004 236100                    LDQ     @VM_FOLDER_INFO,,AUTO
        12 000134   000002 036000 13                 ADLQ    2
        12 000135   200015 756100                    STQ     ADDSITE+3,,AUTO
        12 000136   000421 701000 12                 TSX1    INSERT_NAME
        12 000137   000000 011000                    NOP     0

      252     8057    3               IF VM_FOLDER_INFO.FOLDER = ' '

   8057 12 000140   200004 470500                    LDP0    @VM_FOLDER_INFO,,AUTO
        12 000141   040000 106500                    CMPC    fill='040'O
        12 000142   000003 400031                    ADSC9   3,,PR0                   cn=2,n=25
        12 000143   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000144   000147 601000 12                 TNZ     s:8061

      253     8058    3               THEN
      254     8059    3                   INDX = 0;

   8059 12 000145   200010 450100                    STZ     INDX,,AUTO
        12 000146   000173 710000 12                 TRA     s:8063

      255     8060    3               ELSE
      256     8061    3                   CALL INSERT(ADDRESS.TEXT,NEXT,,'/',VM_FOLDER_INFO.FOLDER);

   8061 12 000147   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000150   000100 101500                    MRL     fill='000'O
        12 000151   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000152   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000153   200026 220100                    LDX0    S+1,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:53   
        12 000154   000000 636010                    EAQ     0,X0
        12 000155   000022 772000                    QRL     18
        12 000156   200005 136100                    SBLQ    NEXT,,AUTO
        12 000157   000000 621006                    EAX1    0,QL
        12 000160   200005 235100                    LDA     NEXT,,AUTO
        12 000161   040145 100400                    MLR     fill='040'O
        12 000162   000001 000001 13                 ADSC9   1                        cn=0,n=1
        12 000163   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        12 000164   000001 116007                    CMPQ    1,DL
        12 000165   000173 604400 12                 TMOZ    s:8063
        12 000166   777777 621006                    EAX1    -1,QL
        12 000167   200005 235100                    LDA     NEXT,,AUTO
        12 000170   040145 100500                    MLR     fill='040'O
        12 000171   000003 400031                    ADSC9   3,,PR0                   cn=2,n=25
        12 000172   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1

      257     8062    3           END;

      258     8063    2           NEXT=NEXT+INDX;

   8063 12 000173   200005 236100                    LDQ     NEXT,,AUTO
        12 000174   200010 036100                    ADLQ    INDX,,AUTO
        12 000175   200005 756100                    STQ     NEXT,,AUTO

      259     8064    2       END;

   8064 12 000176   000234 710000 12                 TRA     s:8072

      260     8065    1       ELSE
      261     8066    2       DO;                                /* Use acct */

      262     8067    2           ACCTSET = '1'B;

   8067 12 000177   400000 236003                    LDQ     -131072,DU
        12 000200   200007 756100                    STQ     ACCTSET,,AUTO

      263     8068    2           CALL INDEX (NEXT,' ',VM_FOLDER_INFO.ACCT);
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:54   

   8068 12 000201   000000 124500                    SCM     mask='000'O
        12 000202   100001 400010                    ADSC9   1,,PR1                   cn=2,n=8
        12 000203   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000204   200005 000100                    ARG     NEXT,,AUTO

      264     8069    2           CALL INSERT (ADDRESS.TEXT,INDX,,'.',SUBSTR(VM_FOLDER_INFO.ACCT,0,NEXT));

   8069 12 000205   000100 101500                    MRL     fill='000'O
        12 000206   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000207   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000210   200026 220100                    LDX0    S+1,,AUTO
        12 000211   000000 636010                    EAQ     0,X0
        12 000212   000022 772000                    QRL     18
        12 000213   200010 136100                    SBLQ    INDX,,AUTO
        12 000214   000000 621006                    EAX1    0,QL
        12 000215   200010 235100                    LDA     INDX,,AUTO
        12 000216   040145 100400                    MLR     fill='040'O
        12 000217   000003 000001 13                 ADSC9   3                        cn=0,n=1
        12 000220   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        12 000221   000001 116007                    CMPQ    1,DL
        12 000222   000230 604400 12                 TMOZ    s:8070
        12 000223   777777 621006                    EAX1    -1,QL
        12 000224   200005 722100                    LXL2    NEXT,,AUTO
        12 000225   040145 100540                    MLR     fill='040'O
        12 000226   100001 400012                    ADSC9   1,,PR1                   cn=2,n=*X2
        12 000227   000000 400011                    ADSC9   0,A,PR0                  cn=2,n=*X1

      265     8070    2           NEXT=NEXT+1+INDX;

   8070 12 000230   200005 236100                    LDQ     NEXT,,AUTO
        12 000231   200010 036100                    ADLQ    INDX,,AUTO
        12 000232   000001 036007                    ADLQ    1,DL
        12 000233   200005 756100                    STQ     NEXT,,AUTO

      266     8071    2       END;

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:55   
      267     8072    1       if ADDPASS and VM_FOLDER_INFO.PASS ~= ' ' then

   8072 12 000234   200011 234100                    SZN     ADDPASS,,AUTO
        12 000235   000312 605000 12                 TPL     s:8088
        12 000236   200004 470500                    LDP0    @VM_FOLDER_INFO,,AUTO
        12 000237   040000 106500                    CMPC    fill='040'O
        12 000240   000011 600010                    ADSC9   9,,PR0                   cn=3,n=8
        12 000241   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000242   000312 600000 12                 TZE     s:8088

      268     8073    2       do;                                /**  Need to add the password  **/

      269     8074    2           if not ACCTSET then

   8074 12 000243   200007 234100                    SZN     ACCTSET,,AUTO
        12 000244   000260 604000 12                 TMI     s:8079

      270     8075    3           do;                           /**  Add the first '.'  **/

      271     8076    3               substr(ADDRESS.TEXT,NEXT,1) = '.';

   8076 12 000245   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000246   000100 101500                    MRL     fill='000'O
        12 000247   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000250   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000251   200026 220100                    LDX0    S+1,,AUTO
        12 000252   040106 100400                    MLR     fill='040'O
        12 000253   000003 000001 13                 ADSC9   3                        cn=0,n=1
        12 000254   100000 200001                    ADSC9   0,Q,PR1                  cn=1,n=1

      272     8077    3               NEXT = NEXT + 1;

   8077 12 000255   200005 235100                    LDA     NEXT,,AUTO
        12 000256   000001 035007                    ADLA    1,DL
        12 000257   200005 755100                    STA     NEXT,,AUTO

      273     8078    3           end;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:56   

      274     8079    2           substr(ADDRESS.TEXT,NEXT,1) = '.';

   8079 12 000260   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000261   000100 101500                    MRL     fill='000'O
        12 000262   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000263   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000264   200026 220100                    LDX0    S+1,,AUTO
        12 000265   200005 235100                    LDA     NEXT,,AUTO
        12 000266   040105 100400                    MLR     fill='040'O
        12 000267   000003 000001 13                 ADSC9   3                        cn=0,n=1
        12 000270   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1

      275     8080    2           substr(ADDRESS.TEXT,NEXT+1,8) = VM_FOLDER_INFO.PASS;

   8080 12 000271   000100 101500                    MRL     fill='000'O
        12 000272   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000273   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000274   200026 220100                    LDX0    S+1,,AUTO
        12 000275   200005 235100                    LDA     NEXT,,AUTO
        12 000276   040105 100500                    MLR     fill='040'O
        12 000277   000011 600010                    ADSC9   9,,PR0                   cn=3,n=8
        12 000300   100000 400010                    ADSC9   0,A,PR1                  cn=2,n=8

      276     8081    2           call index(INDX,' ',VM_FOLDER_INFO.PASS);

   8081 12 000301   000000 124500                    SCM     mask='000'O
        12 000302   000011 600010                    ADSC9   9,,PR0                   cn=3,n=8
        12 000303   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000304   200010 000100                    ARG     INDX,,AUTO

      277     8082    2           NEXT = NEXT + INDX + 1;

   8082 12 000305   200005 236100                    LDQ     NEXT,,AUTO
        12 000306   200010 036100                    ADLQ    INDX,,AUTO
        12 000307   000001 036007                    ADLQ    1,DL
        12 000310   200005 756100                    STQ     NEXT,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:57   

      278     8083    2           ACCTSET = '0'B;

   8083 12 000311   200007 450100                    STZ     ACCTSET,,AUTO

      279     8084    2       end;

      280     8085        /*
      281     8086             ***** Insert the sitename ...
      282     8087        */
      283     8088    1       IF VM_FOLDER_INFO.SITENAME ~= ' ' AND ADDSITE

   8088 12 000312   200004 470500                    LDP0    @VM_FOLDER_INFO,,AUTO
        12 000313   040000 106500                    CMPC    fill='040'O
        12 000314   000013 600010                    ADSC9   11,,PR0                  cn=3,n=8
        12 000315   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000316   000414 600000 12                 TZE     s:8098
        12 000317   200012 234100                    SZN     ADDSITE,,AUTO
        12 000320   000414 605000 12                 TPL     s:8098

      284     8089    2       THEN DO;

      285     8090    2           IF ACCTSET THEN

   8090 12 000321   200007 234100                    SZN     ACCTSET,,AUTO
        12 000322   000350 605000 12                 TPL     s:8092

      286     8091    2               CALL INSERT (ADDRESS.TEXT,NEXT,,'@',VM_FOLDER_INFO.SITENAME);

   8091 12 000323   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000324   000100 101500                    MRL     fill='000'O
        12 000325   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000326   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000327   200026 220100                    LDX0    S+1,,AUTO
        12 000330   000000 636010                    EAQ     0,X0
        12 000331   000022 772000                    QRL     18
        12 000332   200005 136100                    SBLQ    NEXT,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:58   
        12 000333   000000 621006                    EAX1    0,QL
        12 000334   200005 235100                    LDA     NEXT,,AUTO
        12 000335   040145 100400                    MLR     fill='040'O
        12 000336   000004 000001 13                 ADSC9   4                        cn=0,n=1
        12 000337   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        12 000340   000001 116007                    CMPQ    1,DL
        12 000341   000347 604400 12                 TMOZ    s:8091+20
        12 000342   777777 621006                    EAX1    -1,QL
        12 000343   200005 235100                    LDA     NEXT,,AUTO
        12 000344   040145 100500                    MLR     fill='040'O
        12 000345   000013 600010                    ADSC9   11,,PR0                  cn=3,n=8
        12 000346   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
        12 000347   000374 710000 12                 TRA     s:8093

      287     8092    2           ELSE CALL INSERT (ADDRESS.TEXT,NEXT,,' @',VM_FOLDER_INFO.SITENAME);

   8092 12 000350   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000351   000100 101500                    MRL     fill='000'O
        12 000352   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000353   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000354   200026 220100                    LDX0    S+1,,AUTO
        12 000355   000000 636010                    EAQ     0,X0
        12 000356   000022 772000                    QRL     18
        12 000357   200005 136100                    SBLQ    NEXT,,AUTO
        12 000360   000000 621006                    EAX1    0,QL
        12 000361   200005 235100                    LDA     NEXT,,AUTO
        12 000362   040145 100400                    MLR     fill='040'O
        12 000363   000001 000002 11                 ADSC9   1                        cn=0,n=2
        12 000364   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        12 000365   000002 116007                    CMPQ    2,DL
        12 000366   000374 604400 12                 TMOZ    s:8093
        12 000367   777776 621006                    EAX1    -2,QL
        12 000370   200005 235100                    LDA     NEXT,,AUTO
        12 000371   040145 100500                    MLR     fill='040'O
        12 000372   000013 600010                    ADSC9   11,,PR0                  cn=3,n=8
        12 000373   100000 600011                    ADSC9   0,A,PR1                  cn=3,n=*X1

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:59   
      288     8093    2           CALL INDEX (NEXT,' ',ADDRESS.TEXT,NEXT+1);

   8093 12 000374   000100 101500                    MRL     fill='000'O
        12 000375   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000376   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000377   200026 220100                    LDX0    S+1,,AUTO
        12 000400   000000 636010                    EAQ     0,X0
        12 000401   000022 772000                    QRL     18
        12 000402   200005 136100                    SBLQ    NEXT,,AUTO
        12 000403   777777 621006                    EAX1    -1,QL
        12 000404   200005 236100                    LDQ     NEXT,,AUTO
        12 000405   000001 036007                    ADLQ    1,DL
        12 000406   200005 235100                    LDA     NEXT,,AUTO
        12 000407   000000 124545                    SCM     mask='000'O
        12 000410   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
        12 000411   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000412   200005 000100                    ARG     NEXT,,AUTO
        12 000413   200005 056100                    ASQ     NEXT,,AUTO

      289     8094    2       END;

      290     8095        /*
      291     8096             ***** Set ADDRESS.SIZ to proper value ...
      292     8097        */
      293     8098    1       ADDRESS.SIZ = NEXT;

   8098 12 000414   200003 471500                    LDP1    @ADDRESS,,AUTO
        12 000415   000100 101500                    MRL     fill='000'O
        12 000416   200005 000004                    ADSC9   NEXT,,AUTO               cn=0,n=4
        12 000417   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      294     8099    1       RETURN;

   8099 12 000420   000000 702200 xent               TSX2  ! X66_ARET

      295     8100        %EJECT;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:60   
      296     8101        /*I*
      297     8102             NAME:       VMF$INSERT_NAME
      298     8103             PURPOSE:    To copy a registered name into a textc
      299     8104                         field that is the legal input form for that
      300     8105                         name.
      301     8106
      302     8107             DESCRIPTION:
      303     8108                         The three parameters are:
      304     8109
      305     8110                         NAME     a text field containing the name
      306     8111                                  to be moved.
      307     8112                         LEN      On input: the length of the name
      308     8113                                  in NAME;  on output, the length
      309     8114                                  of the name in ADDRESS.
      310     8115                         ADDRESS  a textc field to hold the legal input
      311     8116                                  form for a name.
      312     8117
      313     8118                         In order to make the legal input form, the NAME
      314     8119                         is searched for non-alphanumerics and non-blanks
      315     8120                         and if any appear, the output in ADDRESS is
      316     8121                         quoted.  If any quotes appear, they are doubled.
      317     8122        */
      318     8123
      319     8124
      320     8125
      321     8126    1   INSERT_NAME: proc(NAME, LEN);

   8126 12 000421   200014 741300       INSERT_NAME  STX1  ! ADDSITE+2,,AUTO

      322     8127
      323     8128    2   dcl  NAME        char(L);
      324     8129    2   dcl  LEN         sbin;
      325     8130
      326     8131    2   dcl  QUOTED      bit(1);
      327     8132    2   dcl  L           sbin;
      328     8133    2   dcl  I           sbin;
      329     8134    2   dcl  INS         sbin;
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:61   
      330     8135    2   dcl  DUMMY       ubin;
      331     8136    2   dcl  J           sbin;
      332     8137    2   dcl  S           sbin;
      333     8138
      334     8139    2       QUOTED = '0'b;

   8139 12 000422   200017 450100                    STZ     QUOTED,,AUTO

      335     8140    2       L   = LEN;

   8140 12 000423   200016 470500                    LDP0    @LEN,,AUTO
        12 000424   000000 235100                    LDA     0,,PR0
        12 000425   200020 755100                    STA     L,,AUTO

      336     8141    2       I   = 0;

   8141 12 000426   200021 450100                    STZ     I,,AUTO

      337     8142
      338     8143    2       call searchr(L, DUMMY,B$SR_NON_BLANK,NAME)

   8143 12 000427   200020 236100                    LDQ     L,,AUTO
        12 000430   000000 471400 xsym               LDP1    B$SR_NON_BLANK$
        12 000431   200015 473500                    LDP3    @NAME,,AUTO
        12 000432   000000 620006                    EAX0    0,QL
        12 000433   000000 165540                    TCTR
        12 000434   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
        12 000435   100000 000100                    ARG     0,,PR1
        12 000436   200020 000100                    ARG     L,,AUTO
        12 000437   200020 235100                    LDA     L,,AUTO
        12 000440   000033 771000                    ARL     27
        12 000441   200023 755100                    STA     DUMMY,,AUTO
        12 000442   200020 551140                    STBA    L,'40'O,AUTO
        12 000443   000447 606400 12                 TTN     s:8145
        12 000444   200020 054100                    AOS     L,,AUTO
        12 000445   200020 156100                    SSQ     L,,AUTO
        12 000446   000450 710000 12                 TRA     s:8147
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:62   

      339     8144    3       whenaltreturn do;

      340     8145    3           L = 0;

   8145 12 000447   200020 450100                    STZ     L,,AUTO

      341     8146    3       end;

      342     8147    2       L = L + 1;

   8147 12 000450   200020 054100                    AOS     L,,AUTO

      343     8148
      344     8149    2       INS = 0;

   8149 12 000451   200022 450100                    STZ     INS,,AUTO

      345     8150
      346     8151    3       do while I < L;

   8151 12 000452   200021 236100                    LDQ     I,,AUTO
        12 000453   200020 116100                    CMPQ    L,,AUTO
        12 000454   000660 605000 12                 TPL     s:8188

      347     8152
      348     8153    3           S = I;

   8153 12 000455   200021 235100                    LDA     I,,AUTO
        12 000456   200025 755100                    STA     S,,AUTO

      349     8154    3           if substr(NAME,I,1) = ' ' then S = S + 1;

   8154 12 000457   200015 470500                    LDP0    @NAME,,AUTO
        12 000460   040000 106505                    CMPC    fill='040'O
        12 000461   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        12 000462   000000 000001 13                 ADSC9   0                        cn=0,n=1
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:63   
        12 000463   000465 601000 12                 TNZ     s:8156

   8154 12 000464   200025 054100                    AOS     S,,AUTO

      350     8155
      351     8156    3           call search(S, DUMMY, B$SR_NON_ALPHA, NAME, S)

   8156 12 000465   200020 236100                    LDQ     L,,AUTO
        12 000466   200025 136100                    SBLQ    S,,AUTO
        12 000467   200026 756100                    STQ     S+1,,AUTO
        12 000470   200025 236100                    LDQ     S,,AUTO
        12 000471   000000 471400 xsym               LDP1    B$SR_NON_ALPHA$
        12 000472   200026 720100                    LXL0    S+1,,AUTO
        12 000473   000000 164546                    TCT
        12 000474   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
        12 000475   100000 000100                    ARG     0,,PR1
        12 000476   200025 000100                    ARG     S,,AUTO
        12 000477   200025 235100                    LDA     S,,AUTO
        12 000500   000033 771000                    ARL     27
        12 000501   200023 755100                    STA     DUMMY,,AUTO
        12 000502   200025 551140                    STBA    S,'40'O,AUTO
        12 000503   200025 056100                    ASQ     S,,AUTO
        12 000504   000506 606400 12                 TTN     s:8158
        12 000505   000551 710000 12                 TRA     s:8169

      352     8157    4           whenaltreturn do;

      353     8158    4               J = L - I;

   8158 12 000506   200020 236100                    LDQ     L,,AUTO
        12 000507   200021 136100                    SBLQ    I,,AUTO
        12 000510   200024 756100                    STQ     J,,AUTO

      354     8159    4               substr(ADDRESS.TEXT,INS,J) = substr(NAME,I);

   8159 12 000511   200003 470500                    LDP0    @ADDRESS,,AUTO
        12 000512   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:64   
        12 000513   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000514   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000515   200026 220100                    LDX0    S+1,,AUTO
        12 000516   200020 236100                    LDQ     L,,AUTO
        12 000517   200021 136100                    SBLQ    I,,AUTO
        12 000520   200015 471500                    LDP1    @NAME,,AUTO
        12 000521   000000 621006                    EAX1    0,QL
        12 000522   200021 235100                    LDA     I,,AUTO
        12 000523   200024 722100                    LXL2    J,,AUTO
        12 000524   200022 236100                    LDQ     INS,,AUTO
        12 000525   040146 100545                    MLR     fill='040'O
        12 000526   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
        12 000527   000000 200012                    ADSC9   0,Q,PR0                  cn=1,n=*X2

      355     8160    4               INS = INS + J;

   8160 12 000530   200024 036100                    ADLQ    J,,AUTO
        12 000531   200022 756100                    STQ     INS,,AUTO

      356     8161    5               if QUOTED then do;

   8161 12 000532   200017 234100                    SZN     QUOTED,,AUTO
        12 000533   000544 605000 12                 TPL     s:8165

      357     8162    5                   substr(ADDRESS.TEXT,INS,1) = '''';

   8162 12 000534   000100 101500                    MRL     fill='000'O
        12 000535   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000536   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000537   200026 220100                    LDX0    S+1,,AUTO
        12 000540   040106 100400                    MLR     fill='040'O
        12 000541   000005 000001 13                 ADSC9   5                        cn=0,n=1
        12 000542   000000 200001                    ADSC9   0,Q,PR0                  cn=1,n=1

      358     8163    5                   INS = INS + 1;

   8163 12 000543   200022 054100                    AOS     INS,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:65   

      359     8164    5               end;

      360     8165    4               LEN = INS;

   8165 12 000544   200016 473500                    LDP3    @LEN,,AUTO
        12 000545   200022 236100                    LDQ     INS,,AUTO
        12 000546   300000 756100                    STQ     0,,PR3

      361     8166    4               return;

   8166 12 000547   200014 221300                    LDX1  ! ADDSITE+2,,AUTO
        12 000550   000001 702211                    TSX2  ! 1,X1

      362     8167    4           end;
      363     8168
      364     8169    3           if substr(NAME,S,1) ~= ' ' then

   8169 12 000551   200025 236100                    LDQ     S,,AUTO
        12 000552   040000 106506                    CMPC    fill='040'O
        12 000553   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        12 000554   000000 000001 13                 ADSC9   0                        cn=0,n=1
        12 000555   000612 600000 12                 TZE     s:8177

      365     8170    4               if ( binbit(DUMMY,9) & %B$SR#SYM ) = '0'b and not QUOTED then do;

   8170 12 000556   200023 236100                    LDQ     DUMMY,,AUTO
        12 000557   000033 736000                    QLS     27
        12 000560   000022 772000                    QRL     18
        12 000561   000000 621006                    EAX1    0,QL
        12 000562   002000 361003                    ANX1    1024,DU
        12 000563   000612 601000 12                 TNZ     s:8177
        12 000564   200017 234100                    SZN     QUOTED,,AUTO
        12 000565   000612 604000 12                 TMI     s:8177

      366     8171    4                   substr(ADDRESS.TEXT,0,1) = '''';

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:66   
   8171 12 000566   200003 473500                    LDP3    @ADDRESS,,AUTO
        12 000567   000100 101500                    MRL     fill='000'O
        12 000570   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000571   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000572   200026 221100                    LDX1    S+1,,AUTO
        12 000573   040100 100400                    MLR     fill='040'O
        12 000574   000005 000001 13                 ADSC9   5                        cn=0,n=1
        12 000575   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

      367     8172    4                   substr(ADDRESS.TEXT,1,INS) = NAME;

   8172 12 000576   000100 101500                    MRL     fill='000'O
        12 000577   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000600   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000601   200026 220100                    LDX0    S+1,,AUTO
        12 000602   200020 721100                    LXL1    L,,AUTO
        12 000603   200022 722100                    LXL2    INS,,AUTO
        12 000604   040140 100540                    MLR     fill='040'O
        12 000605   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        12 000606   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2

      368     8173    4                   QUOTED = '1'b;

   8173 12 000607   400000 236003                    LDQ     -131072,DU
        12 000610   200017 756100                    STQ     QUOTED,,AUTO

      369     8174    4                   INS = INS + 1;

   8174 12 000611   200022 054100                    AOS     INS,,AUTO

      370     8175    4               end;

      371     8176
      372     8177    3           J = S - I + 1;

   8177 12 000612   200025 236100                    LDQ     S,,AUTO
        12 000613   200021 136100                    SBLQ    I,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:67   
        12 000614   000001 036007                    ADLQ    1,DL
        12 000615   200024 756100                    STQ     J,,AUTO

      373     8178    3           substr(ADDRESS.TEXT,INS,J) = substr(NAME,I,J);

   8178 12 000616   200003 473500                    LDP3    @ADDRESS,,AUTO
        12 000617   000100 101500                    MRL     fill='000'O
        12 000620   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000621   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000622   200026 220100                    LDX0    S+1,,AUTO
        12 000623   000000 621006                    EAX1    0,QL
        12 000624   200021 236100                    LDQ     I,,AUTO
        12 000625   200024 722100                    LXL2    J,,AUTO
        12 000626   200022 235100                    LDA     INS,,AUTO
        12 000627   040145 100546                    MLR     fill='040'O
        12 000630   000000 000011                    ADSC9   0,Q,PR0                  cn=0,n=*X1
        12 000631   300000 200012                    ADSC9   0,A,PR3                  cn=1,n=*X2

      374     8179    3           INS = INS + J;

   8179 12 000632   200022 236100                    LDQ     INS,,AUTO
        12 000633   200024 036100                    ADLQ    J,,AUTO
        12 000634   200022 756100                    STQ     INS,,AUTO

      375     8180    3           I = I + J;

   8180 12 000635   200021 236100                    LDQ     I,,AUTO
        12 000636   200024 036100                    ADLQ    J,,AUTO
        12 000637   200021 756100                    STQ     I,,AUTO

      376     8181    4           if substr(NAME,S,1) = '''' then do;

   8181 12 000640   200025 235100                    LDA     S,,AUTO
        12 000641   040000 106505                    CMPC    fill='040'O
        12 000642   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        12 000643   000005 000001 13                 ADSC9   5                        cn=0,n=1
        12 000644   000656 601000 12                 TNZ     s:8186
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:68   

      377     8182    4               substr(ADDRESS.TEXT,INS,1) = '''';

   8182 12 000645   000100 101500                    MRL     fill='000'O
        12 000646   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000647   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000650   200026 220100                    LDX0    S+1,,AUTO
        12 000651   200022 235100                    LDA     INS,,AUTO
        12 000652   040105 100400                    MLR     fill='040'O
        12 000653   000005 000001 13                 ADSC9   5                        cn=0,n=1
        12 000654   300000 200001                    ADSC9   0,A,PR3                  cn=1,n=1

      378     8183    4               INS = INS + 1;

   8183 12 000655   200022 054100                    AOS     INS,,AUTO

      379     8184    4           end;

      380     8185
      381     8186    3       end;

   8186 12 000656   200020 116100                    CMPQ    L,,AUTO
        12 000657   000455 604000 12                 TMI     s:8153

      382     8187
      383     8188    3       if QUOTED then do;

   8188 12 000660   200017 234100                    SZN     QUOTED,,AUTO
        12 000661   000674 605000 12                 TPL     s:8193

      384     8189    3           substr(ADDRESS.TEXT,INS,1) = '''';

   8189 12 000662   200003 470500                    LDP0    @ADDRESS,,AUTO
        12 000663   000100 101500                    MRL     fill='000'O
        12 000664   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000665   200026 000002                    ADSC9   S+1,,AUTO                cn=0,n=2
        12 000666   200026 220100                    LDX0    S+1,,AUTO
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:69   
        12 000667   200022 235100                    LDA     INS,,AUTO
        12 000670   040105 100400                    MLR     fill='040'O
        12 000671   000005 000001 13                 ADSC9   5                        cn=0,n=1
        12 000672   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1

      385     8190    3           INS = INS + 1;

   8190 12 000673   200022 054100                    AOS     INS,,AUTO

      386     8191    3       end;

      387     8192
      388     8193    2       LEN = INS;

   8193 12 000674   200016 470500                    LDP0    @LEN,,AUTO
        12 000675   200022 235100                    LDA     INS,,AUTO
        12 000676   000000 755100                    STA     0,,PR0

      389     8194    2       return;

   8194 12 000677   200014 221300                    LDX1  ! ADDSITE+2,,AUTO
        12 000700   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
  11     000   104120 043040   040100 040040                                    DP#  @

(unnamed)
 Sect OctLoc
  13     000   040040 040040   057040 040040   000024 200000   056040 040040        /   .....
  13     004   100040 040040   047040 040040                                    @   '
      390     8195
      391     8196    2   end INSERT_NAME;
      392     8197
      393     8198    1   END VMF$MAKE_ADDRESS1;
      394     8199        %EOD;

PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:70   
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$MAKE_ADDRESS1.
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:71   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ADDRESS                  16-0-0/w PTR         r     1 @LEN
    15-0-0/w PTR         r     1 @NAME                      4-0-0/w PTR         r     1 @VM_FOLDER_INFO
     7-0-0/b BIT         r     1 ACCTSET                   11-0-0/w BIT         r     1 ADDPASS
    *0-0-0/c ASTR(9)     r     1 ADDRESS                   12-0-0/w BIT         r     1 ADDSITE
    23-0-0/w UBIN        r     1 DUMMY                      6-0-0/b BIT               1 FOUND
    21-0-0/w SBIN        r     1 I                         10-0-0/w UBIN        r     1 INDX
    22-0-0/w SBIN        r     1 INS                       24-0-0/w SBIN        r     1 J
    20-0-0/w SBIN        r     1 L                         *0-0-0/w SBIN        r     1 LEN
    *0-0-0/c ACHR        r     1 NAME                       5-0-0/w UBIN        r     1 NEXT
    17-0-0/b BIT         r     1 QUOTED                    25-0-0/w SBIN        r     1 S
    *0-0-0/w STRC(2529)  r     1 VM_FOLDER_INFO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_ALPHA$
     0-0-0/w PTR         r     1 B$SR_NON_BLANK$            0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:72   
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 B$SR_NON_ALPHA             0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK
     0-0-0/c CHAR              1 CHAR1                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMF$MAKE_ADDRESS1 requires 449 words for executable code.
   Procedure VMF$MAKE_ADDRESS1 requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:73   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:74   
          MINI XREF LISTING

ACCTSET
      7998**DCL      8023<<ASSIGN   8067<<ASSIGN   8074>>IF       8083<<ASSIGN   8090>>IF
ADDPASS
      8001**DCL      8004<<ASSIGN   8010<<ASSIGN   8016<<ASSIGN   8072>>IF
ADDRESS
      7939**DCL        20--PROC     8008--ENTRY    8014--ENTRY
ADDRESS.SIZ
      7940**DCL      7941--IMP-SIZ  8022>>ASSIGN   8033>>CALLBLT  8034>>CALLBLT  8045>>CALLBLT  8046>>CALLBLT
      8061>>CALLBLT  8069>>CALLBLT  8076>>ASSIGN   8079>>ASSIGN   8080>>ASSIGN   8091>>CALLBLT  8092>>CALLBLT
      8093>>CALLBLT  8098<<ASSIGN   8159>>ASSIGN   8162>>ASSIGN   8171>>ASSIGN   8172>>ASSIGN   8178>>ASSIGN
      8182>>ASSIGN   8189>>ASSIGN
ADDRESS.TEXT
      7941**DCL      8022<<ASSIGN   8033<<CALLBLT  8034>>CALLBLT  8045<<CALLBLT  8046>>CALLBLT  8061<<CALLBLT
      8069<<CALLBLT  8076<<ASSIGN   8079<<ASSIGN   8080<<ASSIGN   8091<<CALLBLT  8092<<CALLBLT  8093>>CALLBLT
      8159<<ASSIGN   8162<<ASSIGN   8171<<ASSIGN   8172<<ASSIGN   8178<<ASSIGN   8182<<ASSIGN   8189<<ASSIGN
ADDSITE
      8002**DCL      8005<<ASSIGN   8011<<ASSIGN   8017<<ASSIGN   8088>>IF
B$SR_NON_ALPHA
      7935**DCL      8156>>CALLBLT
B$SR_NON_ALPHA$
      7934**DCL      7935--IMP-PTR  8156>>CALLBLT
B$SR_NON_BLANK
      7931**DCL      8143>>CALLBLT
B$SR_NON_BLANK$
      7930**DCL      7931--IMP-PTR  8143>>CALLBLT
DUMMY IN PROCEDURE INSERT_NAME
      8135**DCL      8143<<CALLBLT  8156<<CALLBLT  8170>>IF
ERRMSG_FID.L#
      7665**DCL      7665--IMP-SIZ
I IN PROCEDURE INSERT_NAME
      8133**DCL      8141<<ASSIGN   8151>>DOWHILE  8153>>ASSIGN   8154>>IF       8158>>ASSIGN   8159>>ASSIGN
      8177>>ASSIGN   8178>>ASSIGN   8180<<ASSIGN   8180>>ASSIGN
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:75   
INDX
      7999**DCL      8029<<ASSIGN   8034<<CALLBLT  8041<<ASSIGN   8046<<CALLBLT  8059<<ASSIGN   8063>>ASSIGN
      8069>>CALLBLT  8070>>ASSIGN   8081<<CALLBLT  8082>>ASSIGN
INS IN PROCEDURE INSERT_NAME
      8134**DCL      8149<<ASSIGN   8159>>ASSIGN   8160<<ASSIGN   8160>>ASSIGN   8162>>ASSIGN   8163<<ASSIGN
      8163>>ASSIGN   8165>>ASSIGN   8172>>ASSIGN   8174<<ASSIGN   8174>>ASSIGN   8178>>ASSIGN   8179<<ASSIGN
      8179>>ASSIGN   8182>>ASSIGN   8183<<ASSIGN   8183>>ASSIGN   8189>>ASSIGN   8190<<ASSIGN   8190>>ASSIGN
      8193>>ASSIGN
INSERT_NAME
      8126**PROC     8056--CALL
J IN PROCEDURE INSERT_NAME
      8136**DCL      8158<<ASSIGN   8159>>ASSIGN   8160>>ASSIGN   8177<<ASSIGN   8178>>ASSIGN   8178>>ASSIGN
      8179>>ASSIGN   8180>>ASSIGN
L IN PROCEDURE INSERT_NAME
      8132**DCL      8128--IMP-SIZ  8140<<ASSIGN   8143<<CALLBLT  8143>>CALLBLT  8145<<ASSIGN   8147<<ASSIGN
      8147>>ASSIGN   8151>>DOWHILE  8154>>IF       8156>>CALLBLT  8158>>ASSIGN   8159>>ASSIGN   8169>>IF
      8172>>ASSIGN   8178>>ASSIGN   8181>>IF
LEN IN PROCEDURE INSERT_NAME
      8129**DCL      8126--PROC     8140>>ASSIGN   8165<<ASSIGN   8193<<ASSIGN
NAME IN PROCEDURE INSERT_NAME
      8128**DCL      8126--PROC     8143>>CALLBLT  8154>>IF       8156>>CALLBLT  8159>>ASSIGN   8169>>IF
      8172>>ASSIGN   8178>>ASSIGN   8181>>IF
NEXT
      7996**DCL      8054<<ASSIGN   8055>>IF       8056<>CALL     8061>>CALLBLT  8063<<ASSIGN   8063>>ASSIGN
      8068<<CALLBLT  8069>>CALLBLT  8070<<ASSIGN   8070>>ASSIGN   8076>>ASSIGN   8077<<ASSIGN   8077>>ASSIGN
      8079>>ASSIGN   8080>>ASSIGN   8082<<ASSIGN   8082>>ASSIGN   8091>>CALLBLT  8092>>CALLBLT  8093<<CALLBLT
      8093>>CALLBLT  8098>>ASSIGN
QUOTED IN PROCEDURE INSERT_NAME
      8131**DCL      8139<<ASSIGN   8161>>IF       8170>>IF       8173<<ASSIGN   8188>>IF
S IN PROCEDURE INSERT_NAME
      8137**DCL      8153<<ASSIGN   8154<<ASSIGN   8154>>ASSIGN   8156<<CALLBLT  8156>>CALLBLT  8169>>IF
      8177>>ASSIGN   8181>>IF
START_OF_PROCEDURE
      8022**LABEL    8006--GOTO     8012--GOTO
VM_FOLDER_INFO
      7953**DCL        20--PROC     8008--ENTRY    8014--ENTRY
PL6.E3A0      #002=VMF$MAKE_ADDRESS1 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:15 Page:76   
VM_FOLDER_INFO.ACCT
      7956**DCL      8068>>CALLBLT  8069>>CALLBLT
VM_FOLDER_INFO.FLAGS.FOLDER_SPEC
      7983**DCL      8042>>IF
VM_FOLDER_INFO.FOLDER
      7958**DCL      8045>>CALLBLT  8057>>IF       8061>>CALLBLT
VM_FOLDER_INFO.PASS
      7960**DCL      8072>>IF       8080>>ASSIGN   8081>>CALLBLT
VM_FOLDER_INFO.PSID
      7954**DCL      8027>>IF       8033>>CALLBLT
VM_FOLDER_INFO.SITENAME
      7962**DCL      8088>>IF       8091>>CALLBLT  8092>>CALLBLT
VM_FOLDER_INFO.USER_NAME.COUNT
      7992**DCL      8051>>IF       8054>>ASSIGN
VM_FOLDER_INFO.USER_NAME.TEXT
      7993**DCL      8056<>CALL
X$STRING.SIZ
      7511**DCL      7512--IMP-SIZ

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:77   
      395        1        /*T***********************************************************/
      396        2        /*T*                                                         */
      397        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      398        4        /*T*                                                         */
      399        5        /*T***********************************************************/
      400        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      401        7        /*P*
      402        8             NAME: VMF$MAKE_ADDRESS2
      403        9             PURPOSE:
      404       10                   This routine generates a MAIL ADDRESS.
      405       11             DESCRIPTION:
      406       12                   Given two parameters as input, this routine will
      407       13                   generate a MAIL ADDRESS. The parameters are:
      408       14
      409       15                      ADDRESS    - contains the result. A TEXTC string of len 256.
      410       16                      VM_RADDRESS   - information to use to create the address.
      411       17                                      VM_RADDRESS may be VM_UADDRESS.
      412       18                      RESOLVE - indicates if a user name should be returned instead of .acct
      413       19        */
      414       20        VMF$MAKE_ADDRESS2: PROC (ADDRESS,VM_RADDRESS,RESOLVE);
      415       21        /***** Include files *****/
      416       22          %INCLUDE CP_6;
      417     5581          %INCLUDE CP_6_SUBS;
      418     6121          %INCLUDE VM_MACRO_C;
      419     7389          %INCLUDE VM_DATA_R;
      420     7820          %INCLUDE VM_SUBS_C;
      421     8080          %INCLUDE B$TABLES_C;
      422     8188
      423     8189         %B$SR_NON_BLANK;
      424     8193        /***** Parameters *****/
      425     8194          %TEXTC (NAME=ADDRESS,STCLASS=" ");
      426     8199          %VM_ADDTYPES;
      427     8203          %VM_RADDRESS (STCLASS=" ");
      428     8238    1   DCL RESOLVE BIT(1);
      429     8239        /***** Local variables *****/
      430     8240    1   DCL NEXT UBIN WORD AUTO;
      431     8241    1   DCL PTR$ PTR AUTO;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:78   
      432     8242    1   DCL ACCTSET BIT(1) AUTO;
      433     8243    1   DCL DOMSET BIT(1) AUTO;
      434     8244    1   DCL INDX UBIN AUTO;
      435     8245    1   DCL DUMMY SBIN;
      436     8246    1   DCL FOLDER CHAR (25);
      437     8247    1   DCL NAME_IN DCB;
      438     8248        /***** Mail structures *****/
      439     8249          %VM_UADDRESS (NAME=VM_UADDRESS,STCLASS="BASED(PTR$)");
      440     8286          %FPT_OPEN (FPTN=OPEN_NAME,
      441     8287                     DCB=NAME_IN,
      442     8288                     REASSIGN=NO,
      443     8289                     ASN=FILE,
      444     8290                     FUN=IN,
      445     8291                     SHARE=ALL,
      446     8292                     ACCT=VM_MAIL_ACCT,
      447     8293                     NAME=VM_NAME_MAP_NAME);
      448     8402          %FPT_CLOSE (FPTN=CLOSE_NAME,
      449     8403                      DCB=NAME_IN,
      450     8404                      DISP=SAVE);
      451     8446          %FPT_READ (FPTN=READ_NAME,
      452     8447                     DCB=NAME_IN,
      453     8448                     BUF=WORK_TEXTC.NAME#,
      454     8449                     KEYS=YES,
      455     8450                     KEY=NAME_KEY);
      456     8489          %VLP_NAME (FPTN=NAME_KEY,LEN=20,NAME=' ');
      457     8516          %VLP_NAME (FPTN=WORK_TEXTC,LEN=256);
      458     8543          %F$DCB;
      459     8600        %EJECT;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:79   
      460     8601    1       PTR$ = ADDR(VM_RADDRESS);
      461     8602    1       ADDRESS.TEXT = ' ';
      462     8603        /*
      463     8604              ***** Unpack the folder&packset information, and insert the
      464     8605                    packset name if any.
      465     8606        */
      466     8607    1       IF VM_RADDRESS.NOMAD.DELIM = ' ' AND VM_RADDRESS.NOMAD.PSID ~= ' '
      467     8608    2       THEN DO;
      468     8609
      469     8610    2           FOLDER = VM_RADDRESS.NOMAD.FOLDER;
      470     8611    2           CALL CONCAT (ADDRESS.TEXT, 'DP#', VM_RADDRESS.NOMAD.PSID);
      471     8612    2           CALL INDEX (INDX, ' ', ADDRESS.TEXT);
      472     8613
      473     8614    2       END;
      474     8615
      475     8616    2       ELSE DO;
      476     8617
      477     8618    2           FOLDER = VM_RADDRESS.FOLDER;
      478     8619    2           INDX = 0;
      479     8620
      480     8621    2       END;
      481     8622        /*
      482     8623             ***** Insert the folder name ...
      483     8624        */
      484     8625    1       ACCTSET = %NO#;
      485     8626    1       DOMSET = %NO#;
      486     8627    1       IF FOLDER ~= ' '
      487     8628    1       THEN
      488     8629    2       DO;
      489     8630    2           CALL INSERT(ADDRESS.TEXT,INDX,,'/',FOLDER);
      490     8631    2           CALL INDEX (INDX,' ',ADDRESS.TEXT);
      491     8632    2       END;
      492     8633        /*
      493     8634             ***** Insert the user name or account ...
      494     8635        */
      495     8636    1       IF VM_RADDRESS.TYPE = %VM_ADD_RESOLVED
      496     8637    1       THEN                               /* Use acct */
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:80   
      497     8638    2       DO;
      498     8639    2           IF ADDR(RESOLVE) ~= ADDR(NIL)  AND RESOLVE = %YES#
      499     8640    2           THEN
      500     8641        /*
      501     8642             ***** Look up the user name in the reverse name map (:NAME).
      502     8643        */
      503     8644    2               CALL GET_NAME
      504     8645    3               WHENRETURN DO;
      505     8646    3                   NEXT = WORK_TEXTC.L#;
      506     8647    3                   ADDRESS.TEXT = SUBSTR(WORK_TEXTC.NAME#,0,NEXT);
      507     8648    3                   CALL SEARCHR (NEXT, DUMMY, B$SR_NON_BLANK,
      508     8649    3                     SUBSTR(ADDRESS.TEXT, 0, NEXT));
      509     8650    3                   NEXT=NEXT+1;
      510     8651    3                   IF FOLDER = ' '
      511     8652    3                   THEN
      512     8653    3                       INDX = 0;
      513     8654    4                   ELSE DO;
      514     8655    4                       CALL INSERT (ADDRESS.TEXT,NEXT,,'/',FOLDER);
      515     8656    4                       CALL INDEX (INDX,' ',FOLDER);
      516     8657    4                       NEXT=NEXT+INDX+1;
      517     8658    4                   END;
      518     8659    3                   GOTO PASS;
      519     8660    3               END;
      520     8661    2           IF VM_RADDRESS.ACCT = ' ' THEN NEXT = INDX;
      521     8662    3           ELSE DO;
      522     8663    3               ACCTSET = '1'B;
      523     8664    3               CALL INDEX (NEXT,' ',VM_RADDRESS.ACCT);
      524     8665    3               CALL INSERT(ADDRESS.TEXT,INDX,,'.',SUBSTR(VM_RADDRESS.ACCT,0,NEXT));
      525     8666    3               NEXT = NEXT + INDX + 1;
      526     8667    3           END;
      527     8668    2       END;
      528     8669    1       ELSE                               /* Use user name rather than acct */
      529     8670    2       DO;
      530     8671    2           NEXT = VM_UADDRESS.USER_NAME.COUNT;
      531     8672    2           IF NEXT > 0
      532     8673    3           THEN DO;                      /* use user name */
      533     8674    3               CALL SEARCHR (NEXT, DUMMY, B$SR_NON_BLANK,
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:81   
      534     8675    3                 SUBSTR (VM_UADDRESS.USER_NAME.TEXT, 0, NEXT));
      535     8676    3               NEXT = NEXT + 1;
      536     8677    3               CALL INSERT (ADDRESS.TEXT,0,,SUBSTR(VM_UADDRESS.USER_NAME.TEXT,0,NEXT));
      537     8678    3               IF FOLDER ~= ' '
      538     8679    4               THEN DO;
      539     8680    4                   NEXT=NEXT+1;
      540     8681    4                   CALL INSERT (ADDRESS.TEXT,NEXT,,'/',FOLDER);
      541     8682    4               END;
      542     8683    4               ELSE DO;
      543     8684    4                   CALL INDEX1R (INDX, '%', SUBSTR(ADDRESS.TEXT,0,NEXT))
      544     8685    5                   WHENRETURN DO;
      545     8686    5                       DOMSET = %YES#;
      546     8687    5                       SUBSTR(ADDRESS.TEXT,INDX,1) = '@';
      547     8688    5                   END;
      548     8689    4                   INDX = 0;
      549     8690    4               END;
      550     8691    3           END;
      551     8692    2           NEXT=NEXT+INDX;
      552     8693    2       END;
      553     8694    1   PASS:
      554     8695        /*
      555     8696             ***** Insert the sitename ...
      556     8697        */
      557     8698    1       IF VM_RADDRESS.SITENAME ~= ' '
      558     8699    1       THEN
      559     8700    2       DO;
      560     8701    2           IF ACCTSET THEN
      561     8702    2               CALL INSERT (ADDRESS.TEXT,NEXT,,'@',VM_RADDRESS.SITENAME);
      562     8703    2           ELSE
      563     8704    2               IF DOMSET THEN
      564     8705    2                   CALL INSERT (ADDRESS.TEXT,NEXT,,'.',VM_RADDRESS.SITENAME);
      565     8706    2               ELSE
      566     8707    2                   CALL INSERT (ADDRESS.TEXT,NEXT,,' @',VM_RADDRESS.SITENAME);
      567     8708    2           CALL INDEX (NEXT,' ',ADDRESS.TEXT,NEXT+1);
      568     8709    2       END;
      569     8710        /*
      570     8711             ***** Set ADDRESS.SIZ to proper value ...
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:82   
      571     8712        */
      572     8713    1       ADDRESS.SIZ = NEXT;
      573     8714    1       RETURN;
      574     8715        %EJECT;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:83   
      575     8716    1   GET_NAME: PROC ALTRET;
      576     8717        /*
      577     8718             ***** Look up the user name in the reverse name map (:NAME).
      578     8719        */
      579     8720    2       CALL M$OPEN(OPEN_NAME)  ALTRET(BAD_NAME);
      580     8721    2       NAME_KEY.L# = LENGTHC(VM_RADDRESS.NAME_KEY);
      581     8722    2       NAME_KEY.NAME# = VM_RADDRESS.NAME_KEY;
      582     8723    2       CALL M$READ(READ_NAME)  ALTRET(TRY_AGAIN);
      583     8724    2       WORK_TEXTC.L# = DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.ARS#;
      584     8725    2       CALL M$CLOSE(CLOSE_NAME);
      585     8726    2       RETURN;
      586     8727        /*
      587     8728             ***** Try account name.
      588     8729        */
      589     8730    2   TRY_AGAIN:
      590     8731    2       NAME_KEY.NAME# = VM_RADDRESS.ACCT;
      591     8732    2       CALL M$READ(READ_NAME)  ALTRET(BAD_NAME);
      592     8733    2       WORK_TEXTC.L# = DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.ARS#;
      593     8734    2       CALL M$CLOSE(CLOSE_NAME);
      594     8735    2       RETURN;
      595     8736    2   BAD_NAME:
      596     8737    2       IF DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.FCD# THEN
      597     8738    2           CALL M$CLOSE(CLOSE_NAME);
      598     8739    2       ALTRETURN;
      599     8740    2   END GET_NAME;
      600     8741    1   END VMF$MAKE_ADDRESS2;

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:84   
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$MAKE_ADDRESS2.

   Procedure VMF$MAKE_ADDRESS2 requires 431 words for executable code.
   Procedure VMF$MAKE_ADDRESS2 requires 24 words of local(AUTO) storage.

    No errors detected in file VMF$SUBR.:VMB6TSI    .

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:85   

 Object Unit name= VMF$MAKE_ADDRESS2                          File name= VMF$SUBR.:VMB6TOU
 UTS= AUG 20 '97 15:16:15.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   DCB   even  none     0      0  NAME_IN
   12   Data  even  none   173    255  VMF$MAKE_ADDRESS2
   13  RoData even  UTS      2      2  VMF$MAKE_ADDRESS2
   14   Proc  even  none   431    657  VMF$MAKE_ADDRESS2
   15  RoData even  none     8     10  VMF$MAKE_ADDRESS2

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes            yes      Std        3  VMF$MAKE_ADDRESS2
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:86   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                 r    B$SR_NON_BLANK$
     NAME_IN
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:87   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:88   


      395        1        /*T***********************************************************/
      396        2        /*T*                                                         */
      397        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      398        4        /*T*                                                         */
      399        5        /*T***********************************************************/
      400        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      401        7        /*P*
      402        8             NAME: VMF$MAKE_ADDRESS2
      403        9             PURPOSE:
      404       10                   This routine generates a MAIL ADDRESS.
      405       11             DESCRIPTION:
      406       12                   Given two parameters as input, this routine will
      407       13                   generate a MAIL ADDRESS. The parameters are:
      408       14
      409       15                      ADDRESS    - contains the result. A TEXTC string of len 256.
      410       16                      VM_RADDRESS   - information to use to create the address.
      411       17                                      VM_RADDRESS may be VM_UADDRESS.
      412       18                     RESOLVE - indicates if a user name should be returned instead of .acct
      413       19        */
      414       20        VMF$MAKE_ADDRESS2: PROC (ADDRESS,VM_RADDRESS,RESOLVE);

     20 14 000000   000000 700200 xent  VMF$MAKE_AD* TSX0  ! X66_AUTO_3
        14 000001   000030 000003                    ZERO    24,3

      415       21        /***** Include files *****/
      416       22          %INCLUDE CP_6;
      417     5581          %INCLUDE CP_6_SUBS;
      418     6121          %INCLUDE VM_MACRO_C;
      419     7389          %INCLUDE VM_DATA_R;
      420     7820          %INCLUDE VM_SUBS_C;
      421     8080          %INCLUDE B$TABLES_C;
      422     8188
      423     8189         %B$SR_NON_BLANK;
      424     8193        /***** Parameters *****/
      425     8194          %TEXTC (NAME=ADDRESS,STCLASS=" ");
      426     8199          %VM_ADDTYPES;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:89   
      427     8203          %VM_RADDRESS (STCLASS=" ");
      428     8238    1   DCL RESOLVE BIT(1);
      429     8239        /***** Local variables *****/
      430     8240    1   DCL NEXT UBIN WORD AUTO;
      431     8241    1   DCL PTR$ PTR AUTO;
      432     8242    1   DCL ACCTSET BIT(1) AUTO;
      433     8243    1   DCL DOMSET BIT(1) AUTO;
      434     8244    1   DCL INDX UBIN AUTO;
      435     8245    1   DCL DUMMY SBIN;
      436     8246    1   DCL FOLDER CHAR (25);
      437     8247    1   DCL NAME_IN DCB;
      438     8248        /***** Mail structures *****/
      439     8249          %VM_UADDRESS (NAME=VM_UADDRESS,STCLASS="BASED(PTR$)");
      440     8286          %FPT_OPEN (FPTN=OPEN_NAME,
      441     8287                     DCB=NAME_IN,
      442     8288                     REASSIGN=NO,
      443     8289                     ASN=FILE,
      444     8290                     FUN=IN,
      445     8291                     SHARE=ALL,
      446     8292                     ACCT=VM_MAIL_ACCT,
      447     8293                     NAME=VM_NAME_MAP_NAME);
      448     8402          %FPT_CLOSE (FPTN=CLOSE_NAME,
      449     8403                      DCB=NAME_IN,
      450     8404                      DISP=SAVE);
      451     8446          %FPT_READ (FPTN=READ_NAME,
      452     8447                     DCB=NAME_IN,
      453     8448                     BUF=WORK_TEXTC.NAME#,
      454     8449                     KEYS=YES,
      455     8450                     KEY=NAME_KEY);
      456     8489          %VLP_NAME (FPTN=NAME_KEY,LEN=20,NAME=' ');
      457     8516          %VLP_NAME (FPTN=WORK_TEXTC,LEN=256);
      458     8543          %F$DCB;
      459     8600        %EJECT;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:90   
      460     8601    1       PTR$ = ADDR(VM_RADDRESS);

   8601 14 000002   200004 236100                    LDQ     @VM_RADDRESS,,AUTO
        14 000003   200007 756100                    STQ     PTR$,,AUTO

      461     8602    1       ADDRESS.TEXT = ' ';

   8602 14 000004   200003 470500                    LDP0    @ADDRESS,,AUTO
        14 000005   000100 101500                    MRL     fill='000'O
        14 000006   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000007   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000010   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000011   040140 100400                    MLR     fill='040'O
        14 000012   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000013   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      462     8603        /*
      463     8604              ***** Unpack the folder&packset information, and insert the
      464     8605                    packset name if any.
      465     8606        */
      466     8607    1       IF VM_RADDRESS.NOMAD.DELIM = ' ' AND VM_RADDRESS.NOMAD.PSID ~= ' '

   8607 14 000014   200004 471500                    LDP1    @VM_RADDRESS,,AUTO
        14 000015   100014 236100                    LDQ     12,,PR1
        14 000016   777000 376003                    ANQ     -512,DU
        14 000017   040000 116003                    CMPQ    16384,DU
        14 000020   000060 601000 14                 TNZ     s:8618
        14 000021   040000 106500                    CMPC    fill='040'O
        14 000022   100014 200006                    ADSC9   12,,PR1                  cn=1,n=6
        14 000023   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000024   000060 600000 14                 TZE     s:8618

      467     8608    2       THEN DO;

      468     8609
      469     8610    2           FOLDER = VM_RADDRESS.NOMAD.FOLDER;

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:91   
   8610 14 000025   040100 100500                    MLR     fill='040'O
        14 000026   100007 400022                    ADSC9   7,,PR1                   cn=2,n=18
        14 000027   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25

      470     8611    2           CALL CONCAT (ADDRESS.TEXT, 'DP#', VM_RADDRESS.NOMAD.PSID);

   8611 14 000030   000100 101500                    MRL     fill='000'O
        14 000031   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000032   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000033   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000034   040140 100400                    MLR     fill='040'O
        14 000035   000000 000003 13                 ADSC9   0                        cn=0,n=3
        14 000036   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000037   000000 636010                    EAQ     0,X0
        14 000040   000022 772000                    QRL     18
        14 000041   000004 116007                    CMPQ    4,DL
        14 000042   000047 602000 14                 TNC     s:8612
        14 000043   777775 621010                    EAX1    -3,X0
        14 000044   040140 100500                    MLR     fill='040'O
        14 000045   100014 200006                    ADSC9   12,,PR1                  cn=1,n=6
        14 000046   000001 000011                    ADSC9   1,,PR0                   cn=0,n=*X1

      471     8612    2           CALL INDEX (INDX, ' ', ADDRESS.TEXT);

   8612 14 000047   000100 101500                    MRL     fill='000'O
        14 000050   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000051   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000052   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000053   000000 124540                    SCM     mask='000'O
        14 000054   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000055   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000056   200012 000100                    ARG     INDX,,AUTO

      472     8613
      473     8614    2       END;

   8614 14 000057   000064 710000 14                 TRA     s:8625
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:92   

      474     8615
      475     8616    2       ELSE DO;

      476     8617
      477     8618    2           FOLDER = VM_RADDRESS.FOLDER;

   8618 14 000060   040100 100500                    MLR     fill='040'O
        14 000061   100007 400031                    ADSC9   7,,PR1                   cn=2,n=25
        14 000062   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25

      478     8619    2           INDX = 0;

   8619 14 000063   200012 450100                    STZ     INDX,,AUTO

      479     8620
      480     8621    2       END;

      481     8622        /*
      482     8623             ***** Insert the folder name ...
      483     8624        */
      484     8625    1       ACCTSET = %NO#;

   8625 14 000064   200010 450100                    STZ     ACCTSET,,AUTO

      485     8626    1       DOMSET = %NO#;

   8626 14 000065   200011 450100                    STZ     DOMSET,,AUTO

      486     8627    1       IF FOLDER ~= ' '

   8627 14 000066   040000 106500                    CMPC    fill='040'O
        14 000067   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000070   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000071   000124 600000 14                 TZE     s:8636

      487     8628    1       THEN
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:93   
      488     8629    2       DO;

      489     8630    2           CALL INSERT(ADDRESS.TEXT,INDX,,'/',FOLDER);

   8630 14 000072   000100 101500                    MRL     fill='000'O
        14 000073   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000074   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000075   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000076   000000 636010                    EAQ     0,X0
        14 000077   000022 772000                    QRL     18
        14 000100   200012 136100                    SBLQ    INDX,,AUTO
        14 000101   000000 621006                    EAX1    0,QL
        14 000102   200012 235100                    LDA     INDX,,AUTO
        14 000103   040145 100400                    MLR     fill='040'O
        14 000104   000001 000001 15                 ADSC9   1                        cn=0,n=1
        14 000105   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        14 000106   000001 116007                    CMPQ    1,DL
        14 000107   000114 604400 14                 TMOZ    s:8631
        14 000110   777777 621006                    EAX1    -1,QL
        14 000111   040145 100500                    MLR     fill='040'O
        14 000112   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000113   000000 400011                    ADSC9   0,A,PR0                  cn=2,n=*X1

      490     8631    2           CALL INDEX (INDX,' ',ADDRESS.TEXT);

   8631 14 000114   000100 101500                    MRL     fill='000'O
        14 000115   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000116   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000117   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000120   000000 124540                    SCM     mask='000'O
        14 000121   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        14 000122   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000123   200012 000100                    ARG     INDX,,AUTO

      491     8632    2       END;

      492     8633        /*
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:94   
      493     8634             ***** Insert the user name or account ...
      494     8635        */
      495     8636    1       IF VM_RADDRESS.TYPE = %VM_ADD_RESOLVED

   8636 14 000124   100002 236100                    LDQ     2,,PR1
        14 000125   000777 376003                    ANQ     511,DU
        14 000126   000001 116003                    CMPQ    1,DU
        14 000127   000313 601000 14                 TNZ     s:8671

      496     8637    1       THEN                               /* Use acct */
      497     8638    2       DO;

      498     8639    2           IF ADDR(RESOLVE) ~= ADDR(NIL)  AND RESOLVE = %YES#

   8639 14 000130   200005 236100                    LDQ     @RESOLVE,,AUTO
        14 000131   000002 116000 15                 CMPQ    2
        14 000132   000244 600000 14                 TZE     s:8661
        14 000133   200005 473500                    LDP3    @RESOLVE,,AUTO
        14 000134   000000 066500                    CMPB    filb='0'B
        14 000135   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
        14 000136   000003 000022 15                 BDSC    3                        by=0,bit=0,n=18
        14 000137   000244 600000 14                 TZE     s:8661

      499     8640    2           THEN
      500     8641        /*
      501     8642             ***** Look up the user name in the reverse name map (:NAME).
      502     8643        */
      503     8644    2               CALL GET_NAME

   8644 14 000140   000564 701000 14                 TSX1    GET_NAME
        14 000141   000244 702000 14                 TSX2    s:8661

      504     8645    3               WHENRETURN DO;

      505     8646    3                   NEXT = WORK_TEXTC.L#;

   8646 14 000142   000154 236000 12                 LDQ     WORK_TEXTC
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:95   
        14 000143   000033 772000                    QRL     27
        14 000144   200006 756100                    STQ     NEXT,,AUTO

      506     8647    3                   ADDRESS.TEXT = SUBSTR(WORK_TEXTC.NAME#,0,NEXT);

   8647 14 000145   200003 470500                    LDP0    @ADDRESS,,AUTO
        14 000146   000100 101500                    MRL     fill='000'O
        14 000147   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000150   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000151   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000152   000000 621006                    EAX1    0,QL
        14 000153   040140 100440                    MLR     fill='040'O
        14 000154   000154 200011 12                 ADSC9   WORK_TEXTC               cn=1,n=*X1
        14 000155   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      507     8648    3                   CALL SEARCHR (NEXT, DUMMY, B$SR_NON_BLANK,

   8648 14 000156   000100 101500                    MRL     fill='000'O
        14 000157   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000160   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000161   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000162   200006 236100                    LDQ     NEXT,,AUTO
        14 000163   000000 471400 xsym               LDP1    B$SR_NON_BLANK$
        14 000164   000000 621006                    EAX1    0,QL
        14 000165   000000 165540                    TCTR
        14 000166   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
        14 000167   100000 000100                    ARG     0,,PR1
        14 000170   200006 000100                    ARG     NEXT,,AUTO
        14 000171   200006 235100                    LDA     NEXT,,AUTO
        14 000172   000033 771000                    ARL     27
        14 000173   200013 755100                    STA     DUMMY,,AUTO
        14 000174   200006 551140                    STBA    NEXT,'40'O,AUTO
        14 000175   000200 606400 14                 TTN     s:8650
        14 000176   200006 054100                    AOS     NEXT,,AUTO
        14 000177   200006 156100                    SSQ     NEXT,,AUTO

      508     8649    3                     SUBSTR(ADDRESS.TEXT, 0, NEXT));
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:96   
      509     8650    3                   NEXT=NEXT+1;

   8650 14 000200   200006 236100                    LDQ     NEXT,,AUTO
        14 000201   000001 036007                    ADLQ    1,DL
        14 000202   200006 756100                    STQ     NEXT,,AUTO

      510     8651    3                   IF FOLDER = ' '

   8651 14 000203   040000 106500                    CMPC    fill='040'O
        14 000204   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000205   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000206   000211 601000 14                 TNZ     s:8655

      511     8652    3                   THEN
      512     8653    3                       INDX = 0;

   8653 14 000207   200012 450100                    STZ     INDX,,AUTO
        14 000210   000243 710000 14                 TRA     s:8659

      513     8654    4                   ELSE DO;

      514     8655    4                       CALL INSERT (ADDRESS.TEXT,NEXT,,'/',FOLDER);

   8655 14 000211   000100 101500                    MRL     fill='000'O
        14 000212   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000213   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000214   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000215   000000 636010                    EAQ     0,X0
        14 000216   000022 772000                    QRL     18
        14 000217   200006 136100                    SBLQ    NEXT,,AUTO
        14 000220   000000 621006                    EAX1    0,QL
        14 000221   200006 235100                    LDA     NEXT,,AUTO
        14 000222   040145 100400                    MLR     fill='040'O
        14 000223   000001 000001 15                 ADSC9   1                        cn=0,n=1
        14 000224   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        14 000225   000001 116007                    CMPQ    1,DL
        14 000226   000233 604400 14                 TMOZ    s:8656
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:97   
        14 000227   777777 621006                    EAX1    -1,QL
        14 000230   040145 100500                    MLR     fill='040'O
        14 000231   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000232   000000 400011                    ADSC9   0,A,PR0                  cn=2,n=*X1

      515     8656    4                       CALL INDEX (INDX,' ',FOLDER);

   8656 14 000233   000000 124500                    SCM     mask='000'O
        14 000234   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000235   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000236   200012 000100                    ARG     INDX,,AUTO

      516     8657    4                       NEXT=NEXT+INDX+1;

   8657 14 000237   200006 236100                    LDQ     NEXT,,AUTO
        14 000240   200012 036100                    ADLQ    INDX,,AUTO
        14 000241   000001 036007                    ADLQ    1,DL
        14 000242   200006 756100                    STQ     NEXT,,AUTO

      517     8658    4                   END;

      518     8659    3                   GOTO PASS;

   8659 14 000243   000434 710000 14                 TRA     PASS

      519     8660    3               END;
      520     8661    2           IF VM_RADDRESS.ACCT = ' ' THEN NEXT = INDX;

   8661 14 000244   200004 470500                    LDP0    @VM_RADDRESS,,AUTO
        14 000245   040000 106500                    CMPC    fill='040'O
        14 000246   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        14 000247   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000250   000254 601000 14                 TNZ     s:8663

   8661 14 000251   200012 235100                    LDA     INDX,,AUTO
        14 000252   200006 755100                    STA     NEXT,,AUTO
        14 000253   000434 710000 14                 TRA     PASS
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:98   

      521     8662    3           ELSE DO;

      522     8663    3               ACCTSET = '1'B;

   8663 14 000254   400000 236003                    LDQ     -131072,DU
        14 000255   200010 756100                    STQ     ACCTSET,,AUTO

      523     8664    3               CALL INDEX (NEXT,' ',VM_RADDRESS.ACCT);

   8664 14 000256   000000 124500                    SCM     mask='000'O
        14 000257   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        14 000260   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000261   200006 000100                    ARG     NEXT,,AUTO

      524     8665    3               CALL INSERT(ADDRESS.TEXT,INDX,,'.',SUBSTR(VM_RADDRESS.ACCT,0,NEXT));

   8665 14 000262   200003 471500                    LDP1    @ADDRESS,,AUTO
        14 000263   000100 101500                    MRL     fill='000'O
        14 000264   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000265   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000266   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000267   000000 636010                    EAQ     0,X0
        14 000270   000022 772000                    QRL     18
        14 000271   200012 136100                    SBLQ    INDX,,AUTO
        14 000272   000000 621006                    EAX1    0,QL
        14 000273   200012 235100                    LDA     INDX,,AUTO
        14 000274   040145 100400                    MLR     fill='040'O
        14 000275   000004 000001 15                 ADSC9   4                        cn=0,n=1
        14 000276   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        14 000277   000001 116007                    CMPQ    1,DL
        14 000300   000306 604400 14                 TMOZ    s:8666
        14 000301   777777 621006                    EAX1    -1,QL
        14 000302   200006 722100                    LXL2    NEXT,,AUTO
        14 000303   040145 100540                    MLR     fill='040'O
        14 000304   000021 600012                    ADSC9   17,,PR0                  cn=3,n=*X2
        14 000305   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:99   

      525     8666    3               NEXT = NEXT + INDX + 1;

   8666 14 000306   200006 236100                    LDQ     NEXT,,AUTO
        14 000307   200012 036100                    ADLQ    INDX,,AUTO
        14 000310   000001 036007                    ADLQ    1,DL
        14 000311   200006 756100                    STQ     NEXT,,AUTO

      526     8667    3           END;

      527     8668    2       END;

   8668 14 000312   000434 710000 14                 TRA     PASS

      528     8669    1       ELSE                               /* Use user name rather than acct */
      529     8670    2       DO;

      530     8671    2           NEXT = VM_UADDRESS.USER_NAME.COUNT;

   8671 14 000313   200007 473500                    LDP3    PTR$,,AUTO
        14 000314   300021 236100                    LDQ     17,,PR3
        14 000315   000777 376007                    ANQ     511,DL
        14 000316   200006 756100                    STQ     NEXT,,AUTO

      531     8672    2           IF NEXT > 0

   8672 14 000317   000431 600000 14                 TZE     s:8692

      532     8673    3           THEN DO;                      /* use user name */

      533     8674    3               CALL SEARCHR (NEXT, DUMMY, B$SR_NON_BLANK,

   8674 14 000320   000000 474400 xsym               LDP4    B$SR_NON_BLANK$
        14 000321   000000 620006                    EAX0    0,QL
        14 000322   000000 165540                    TCTR
        14 000323   300022 000010                    ADSC9   18,,PR3                  cn=0,n=*X0
        14 000324   400000 000100                    ARG     0,,PR4
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:100  
        14 000325   200006 000100                    ARG     NEXT,,AUTO
        14 000326   200006 235100                    LDA     NEXT,,AUTO
        14 000327   000033 771000                    ARL     27
        14 000330   200013 755100                    STA     DUMMY,,AUTO
        14 000331   200006 551140                    STBA    NEXT,'40'O,AUTO
        14 000332   000335 606400 14                 TTN     s:8676
        14 000333   200006 054100                    AOS     NEXT,,AUTO
        14 000334   200006 156100                    SSQ     NEXT,,AUTO

      534     8675    3                 SUBSTR (VM_UADDRESS.USER_NAME.TEXT, 0, NEXT));
      535     8676    3               NEXT = NEXT + 1;

   8676 14 000335   200006 235100                    LDA     NEXT,,AUTO
        14 000336   000001 035007                    ADLA    1,DL
        14 000337   200006 755100                    STA     NEXT,,AUTO

      536     8677    3              CALL INSERT (ADDRESS.TEXT,0,,SUBSTR(VM_UADDRESS.USER_NAME.TEXT,0,NEXT));

   8677 14 000340   000100 101500                    MRL     fill='000'O
        14 000341   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000342   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000343   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000344   000000 621005                    EAX1    0,AL
        14 000345   040140 100540                    MLR     fill='040'O
        14 000346   300022 000011                    ADSC9   18,,PR3                  cn=0,n=*X1
        14 000347   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      537     8678    3               IF FOLDER ~= ' '

   8678 14 000350   040000 106500                    CMPC    fill='040'O
        14 000351   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000352   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000353   000401 600000 14                 TZE     s:8684

      538     8679    4               THEN DO;

      539     8680    4                   NEXT=NEXT+1;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:101  

   8680 14 000354   200006 235100                    LDA     NEXT,,AUTO
        14 000355   000001 035007                    ADLA    1,DL
        14 000356   200006 755100                    STA     NEXT,,AUTO

      540     8681    4                   CALL INSERT (ADDRESS.TEXT,NEXT,,'/',FOLDER);

   8681 14 000357   000100 101500                    MRL     fill='000'O
        14 000360   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000361   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000362   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000363   000000 636010                    EAQ     0,X0
        14 000364   000022 772000                    QRL     18
        14 000365   200006 136100                    SBLQ    NEXT,,AUTO
        14 000366   000000 621006                    EAX1    0,QL
        14 000367   040145 100400                    MLR     fill='040'O
        14 000370   000001 000001 15                 ADSC9   1                        cn=0,n=1
        14 000371   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        14 000372   000001 116007                    CMPQ    1,DL
        14 000373   000400 604400 14                 TMOZ    s:8682
        14 000374   777777 621006                    EAX1    -1,QL
        14 000375   040145 100500                    MLR     fill='040'O
        14 000376   200014 000031                    ADSC9   FOLDER,,AUTO             cn=0,n=25
        14 000377   000000 400011                    ADSC9   0,A,PR0                  cn=2,n=*X1

      541     8682    4               END;

   8682 14 000400   000431 710000 14                 TRA     s:8692

      542     8683    4               ELSE DO;

      543     8684    4                   CALL INDEX1R (INDX, '%', SUBSTR(ADDRESS.TEXT,0,NEXT))

   8684 14 000401   000100 101500                    MRL     fill='000'O
        14 000402   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000403   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000404   200026 220100                    LDX0    FOLDER+10,,AUTO
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:102  
        14 000405   200006 236100                    LDQ     NEXT,,AUTO
        14 000406   200006 721100                    LXL1    NEXT,,AUTO
        14 000407   000000 125540                    SCMR    mask='000'O
        14 000410   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
        14 000411   000005 000001 15                 ADSC9   5                        cn=0,n=1
        14 000412   200012 000100                    ARG     INDX,,AUTO
        14 000413   000430 606400 14                 TTN     s:8689
        14 000414   200012 054100                    AOS     INDX,,AUTO
        14 000415   200012 156100                    SSQ     INDX,,AUTO

      544     8685    5                   WHENRETURN DO;

      545     8686    5                       DOMSET = %YES#;

   8686 14 000416   400000 236003                    LDQ     -131072,DU
        14 000417   200011 756100                    STQ     DOMSET,,AUTO

      546     8687    5                       SUBSTR(ADDRESS.TEXT,INDX,1) = '@';

   8687 14 000420   000100 101500                    MRL     fill='000'O
        14 000421   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000422   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000423   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000424   200012 235100                    LDA     INDX,,AUTO
        14 000425   040105 100400                    MLR     fill='040'O
        14 000426   000006 000001 15                 ADSC9   6                        cn=0,n=1
        14 000427   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1

      547     8688    5                   END;

      548     8689    4                   INDX = 0;

   8689 14 000430   200012 450100                    STZ     INDX,,AUTO

      549     8690    4               END;

      550     8691    3           END;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:103  

      551     8692    2           NEXT=NEXT+INDX;

   8692 14 000431   200006 236100                    LDQ     NEXT,,AUTO
        14 000432   200012 036100                    ADLQ    INDX,,AUTO
        14 000433   200006 756100                    STQ     NEXT,,AUTO

      552     8693    2       END;

      553     8694    1   PASS:
      554     8695        /*
      555     8696             ***** Insert the sitename ...
      556     8697        */
      557     8698    1       IF VM_RADDRESS.SITENAME ~= ' '

   8698 14 000434   200004 470500       PASS         LDP0    @VM_RADDRESS,,AUTO
        14 000435   040000 106500                    CMPC    fill='040'O
        14 000436   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        14 000437   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000440   000557 600000 14                 TZE     s:8713

      558     8699    1       THEN
      559     8700    2       DO;

      560     8701    2           IF ACCTSET THEN

   8701 14 000441   200010 234100                    SZN     ACCTSET,,AUTO
        14 000442   000467 605000 14                 TPL     s:8704

      561     8702    2               CALL INSERT (ADDRESS.TEXT,NEXT,,'@',VM_RADDRESS.SITENAME);

   8702 14 000443   200003 471500                    LDP1    @ADDRESS,,AUTO
        14 000444   000100 101500                    MRL     fill='000'O
        14 000445   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000446   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000447   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000450   000000 636010                    EAQ     0,X0
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:104  
        14 000451   000022 772000                    QRL     18
        14 000452   200006 136100                    SBLQ    NEXT,,AUTO
        14 000453   000000 621006                    EAX1    0,QL
        14 000454   200006 235100                    LDA     NEXT,,AUTO
        14 000455   040145 100400                    MLR     fill='040'O
        14 000456   000006 000001 15                 ADSC9   6                        cn=0,n=1
        14 000457   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        14 000460   000001 116007                    CMPQ    1,DL
        14 000461   000466 604400 14                 TMOZ    s:8702+19
        14 000462   777777 621006                    EAX1    -1,QL
        14 000463   040145 100500                    MLR     fill='040'O
        14 000464   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        14 000465   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
        14 000466   000540 710000 14                 TRA     s:8708

      562     8703    2           ELSE
      563     8704    2               IF DOMSET THEN

   8704 14 000467   200011 234100                    SZN     DOMSET,,AUTO
        14 000470   000515 605000 14                 TPL     s:8707

      564     8705    2                   CALL INSERT (ADDRESS.TEXT,NEXT,,'.',VM_RADDRESS.SITENAME);

   8705 14 000471   200003 471500                    LDP1    @ADDRESS,,AUTO
        14 000472   000100 101500                    MRL     fill='000'O
        14 000473   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000474   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000475   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000476   000000 636010                    EAQ     0,X0
        14 000477   000022 772000                    QRL     18
        14 000500   200006 136100                    SBLQ    NEXT,,AUTO
        14 000501   000000 621006                    EAX1    0,QL
        14 000502   200006 235100                    LDA     NEXT,,AUTO
        14 000503   040145 100400                    MLR     fill='040'O
        14 000504   000004 000001 15                 ADSC9   4                        cn=0,n=1
        14 000505   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        14 000506   000001 116007                    CMPQ    1,DL
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:105  
        14 000507   000514 604400 14                 TMOZ    s:8705+19
        14 000510   777777 621006                    EAX1    -1,QL
        14 000511   040145 100500                    MLR     fill='040'O
        14 000512   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        14 000513   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
        14 000514   000540 710000 14                 TRA     s:8708

      565     8706    2               ELSE
      566     8707    2                   CALL INSERT (ADDRESS.TEXT,NEXT,,' @',VM_RADDRESS.SITENAME);

   8707 14 000515   200003 471500                    LDP1    @ADDRESS,,AUTO
        14 000516   000100 101500                    MRL     fill='000'O
        14 000517   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000520   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000521   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000522   000000 636010                    EAQ     0,X0
        14 000523   000022 772000                    QRL     18
        14 000524   200006 136100                    SBLQ    NEXT,,AUTO
        14 000525   000000 621006                    EAX1    0,QL
        14 000526   200006 235100                    LDA     NEXT,,AUTO
        14 000527   040145 100400                    MLR     fill='040'O
        14 000530   000001 000002 13                 ADSC9   1                        cn=0,n=2
        14 000531   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
        14 000532   000002 116007                    CMPQ    2,DL
        14 000533   000540 604400 14                 TMOZ    s:8708
        14 000534   777776 621006                    EAX1    -2,QL
        14 000535   040145 100500                    MLR     fill='040'O
        14 000536   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        14 000537   100000 600011                    ADSC9   0,A,PR1                  cn=3,n=*X1

      567     8708    2           CALL INDEX (NEXT,' ',ADDRESS.TEXT,NEXT+1);

   8708 14 000540   000100 101500                    MRL     fill='000'O
        14 000541   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000542   200026 000002                    ADSC9   FOLDER+10,,AUTO          cn=0,n=2
        14 000543   200026 220100                    LDX0    FOLDER+10,,AUTO
        14 000544   000000 636010                    EAQ     0,X0
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:106  
        14 000545   000022 772000                    QRL     18
        14 000546   200006 136100                    SBLQ    NEXT,,AUTO
        14 000547   777777 621006                    EAX1    -1,QL
        14 000550   200006 236100                    LDQ     NEXT,,AUTO
        14 000551   000001 036007                    ADLQ    1,DL
        14 000552   000000 124545                    SCM     mask='000'O
        14 000553   100000 400011                    ADSC9   0,A,PR1                  cn=2,n=*X1
        14 000554   000000 000001 15                 ADSC9   0                        cn=0,n=1
        14 000555   200006 000100                    ARG     NEXT,,AUTO
        14 000556   200006 056100                    ASQ     NEXT,,AUTO

      568     8709    2       END;

      569     8710        /*
      570     8711             ***** Set ADDRESS.SIZ to proper value ...
      571     8712        */
      572     8713    1       ADDRESS.SIZ = NEXT;

   8713 14 000557   200003 471500                    LDP1    @ADDRESS,,AUTO
        14 000560   000100 101500                    MRL     fill='000'O
        14 000561   200006 000004                    ADSC9   NEXT,,AUTO               cn=0,n=4
        14 000562   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      573     8714    1       RETURN;

   8714 14 000563   000000 702200 xent               TSX2  ! X66_ARET

      574     8715        %EJECT;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:107  
      575     8716    1   GET_NAME: PROC ALTRET;

   8716 14 000564   200024 741300       GET_NAME     STX1  ! FOLDER+8,,AUTO

      576     8717        /*
      577     8718             ***** Look up the user name in the reverse name map (:NAME).
      578     8719        */
      579     8720    2       CALL M$OPEN(OPEN_NAME)  ALTRET(BAD_NAME);

   8720 14 000565   000000 630400 12                 EPPR0   OPEN_NAME
        14 000566   450000 713400                    CLIMB   alt,open
        14 000567   410400 401760                    pmme    nvectors=18
        14 000570   000643 702000 14                 TSX2    BAD_NAME

      580     8721    2       NAME_KEY.L# = LENGTHC(VM_RADDRESS.NAME_KEY);

   8721 14 000571   024000 236003                    LDQ     10240,DU
        14 000572   000146 552040 12                 STBQ    NAME_KEY,'40'O

      581     8722    2       NAME_KEY.NAME# = VM_RADDRESS.NAME_KEY;

   8722 14 000573   200004 470500                    LDP0    @VM_RADDRESS,,AUTO
        14 000574   040000 100500                    MLR     fill='040'O
        14 000575   000002 400024                    ADSC9   2,,PR0                   cn=2,n=20
        14 000576   000146 200024 12                 ADSC9   NAME_KEY                 cn=1,n=20

      582     8723    2       CALL M$READ(READ_NAME)  ALTRET(TRY_AGAIN);

   8723 14 000577   000130 630400 12                 EPPR0   READ_NAME
        14 000600   440000 713400                    CLIMB   alt,read
        14 000601   401400 401760                    pmme    nvectors=4
        14 000602   000617 702000 14                 TSX2    TRY_AGAIN

      583     8724    2       WORK_TEXTC.L# = DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.ARS#;

   8724 14 000603   000000 236007 xsym               LDQ     NAME_IN,DL
        14 000604   000007 470400 15                 LDP0    7
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:108  
        14 000605   000000 471500                    LDP1    0,,PR0
        14 000606   100000 473506                    LDP3    0,QL,PR1
        14 000607   300000 236100                    LDQ     0,,PR3
        14 000610   000033 736000                    QLS     27
        14 000611   000154 552040 12                 STBQ    WORK_TEXTC,'40'O

      584     8725    2       CALL M$CLOSE(CLOSE_NAME);

   8725 14 000612   000072 630400 12                 EPPR0   CLOSE_NAME
        14 000613   050001 713400                    CLIMB   close
        14 000614   406000 401760                    pmme    nvectors=13

      585     8726    2       RETURN;

   8726 14 000615   200024 221300                    LDX1  ! FOLDER+8,,AUTO
        14 000616   000001 702211                    TSX2  ! 1,X1

      586     8727        /*
      587     8728             ***** Try account name.
      588     8729        */
      589     8730    2   TRY_AGAIN:
      590     8731    2       NAME_KEY.NAME# = VM_RADDRESS.ACCT;

   8731 14 000617   200004 470500       TRY_AGAIN    LDP0    @VM_RADDRESS,,AUTO
        14 000620   040000 100500                    MLR     fill='040'O
        14 000621   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        14 000622   000146 200024 12                 ADSC9   NAME_KEY                 cn=1,n=20

      591     8732    2       CALL M$READ(READ_NAME)  ALTRET(BAD_NAME);

   8732 14 000623   000130 630400 12                 EPPR0   READ_NAME
        14 000624   440000 713400                    CLIMB   alt,read
        14 000625   401400 401760                    pmme    nvectors=4
        14 000626   000643 702000 14                 TSX2    BAD_NAME

      592     8733    2       WORK_TEXTC.L# = DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.ARS#;

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:109  
   8733 14 000627   000000 236007 xsym               LDQ     NAME_IN,DL
        14 000630   000007 470400 15                 LDP0    7
        14 000631   000000 471500                    LDP1    0,,PR0
        14 000632   100000 473506                    LDP3    0,QL,PR1
        14 000633   300000 236100                    LDQ     0,,PR3
        14 000634   000033 736000                    QLS     27
        14 000635   000154 552040 12                 STBQ    WORK_TEXTC,'40'O

      593     8734    2       CALL M$CLOSE(CLOSE_NAME);

   8734 14 000636   000072 630400 12                 EPPR0   CLOSE_NAME
        14 000637   050001 713400                    CLIMB   close
        14 000640   406000 401760                    pmme    nvectors=13

      594     8735    2       RETURN;

   8735 14 000641   200024 221300                    LDX1  ! FOLDER+8,,AUTO
        14 000642   000001 702211                    TSX2  ! 1,X1

      595     8736    2   BAD_NAME:
      596     8737    2       IF DCBADDR(DCBNUM(NAME_IN)) -> F$DCB.FCD# THEN

   8737 14 000643   000000 236007 xsym  BAD_NAME     LDQ     NAME_IN,DL
        14 000644   000007 470400 15                 LDP0    7
        14 000645   000000 471500                    LDP1    0,,PR0
        14 000646   100000 473506                    LDP3    0,QL,PR1
        14 000647   300031 236100                    LDQ     25,,PR3
        14 000650   020000 316007                    CANQ    8192,DL
        14 000651   000655 600000 14                 TZE     s:8739

      597     8738    2           CALL M$CLOSE(CLOSE_NAME);

   8738 14 000652   000072 630400 12                 EPPR0   CLOSE_NAME
        14 000653   050001 713400                    CLIMB   close
        14 000654   406000 401760                    pmme    nvectors=13

      598     8739    2       ALTRETURN;
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:110  

   8739 14 000655   200024 221300                    LDX1  ! FOLDER+8,,AUTO
        14 000656   000000 702211                    TSX2  ! 0,X1

OPEN_NAME
 Sect OctLoc
  12     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
  12     004   000000 177640   000000 006014   000001 377640   000000 006000    ................
  12     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
  12     024*  000001 777640   000000 006000   000000 177640   000000 006014    ................
  12     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
  12     044*  000000 000052   000000 002001   252525 000000   000040 252520    ...*......... ..
  12     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
  12     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  12     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  12     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
  12     070   000000 000000   ****** ******                                    ........

CLOSE_NAME
 Sect OctLoc
  12     072   000003 777640   000124 006000   000000 177640   000000 006014    .....T..........
  12     076   000000 177640   000000 006014   000000 177640   000000 006014    ................
  12     122*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
  12     126   000220 000000   000000 000000                                    ........

READ_NAME
 Sect OctLoc
  12     130   000005 777640   000140 006000   000005 177640   000146 006000    .....`.......f..
  12     134   000077 777640   000154 206000   000000 177640   000000 006014    .?...l..........
  12     140   000000 600000   000000 000000   000000 000000   000000 000000    ................
  12     144   000000 000000   000000 000000                                    ........

NAME_KEY
 Sect OctLoc
  12     146   001040 040040   040040 040040   040040 040040   040040 040040    .
  12     152   040040 040040   040*** ******                                         ...

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:111  
WORK_TEXTC
 Sect OctLoc
  12     154   037040 040040   040040 040040   040040 040040   040040 040040    .
  12     160   040040 040040   040040 040040   040040 040040   040040 040040
  12     254*  040*** ******                                                     ...

(unnamed)
 Sect OctLoc
  13     000   104120 043040   040100 040040                                    DP#  @

(unnamed)
 Sect OctLoc
  15     000   040040 040040   057040 040040   000000 006014   000000 000000        /   ........
  15     004   056040 040040   045040 040040   100040 040040   000000 006003    .   %   @   ....
      599     8740    2   END GET_NAME;
      600     8741    1   END VMF$MAKE_ADDRESS2;

PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:112  
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMF$MAKE_ADDRESS2.
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:113  

 **** Variables and constants ****

  ****  Section 012  Data  VMF$MAKE_ADDRESS2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_NAME               146-0-0/c STRC(189)   r     1 NAME_KEY
     0-0-0/d STRC(2088)  r     1 OPEN_NAME                130-0-0/d STRC(504)   r     1 READ_NAME
   154-0-0/c STRC(2313)  r     1 WORK_TEXTC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ADDRESS                   5-0-0/w PTR         r     1 @RESOLVE
     4-0-0/w PTR         r     1 @VM_RADDRESS              10-0-0/b BIT         r     1 ACCTSET
    *0-0-0/c ASTR(9)     r     1 ADDRESS                   11-0-0/b BIT         r     1 DOMSET
    13-0-0/w SBIN        r     1 DUMMY                     14-0-0/c CHAR(25)    r     1 FOLDER
    12-0-0/w UBIN        r     1 INDX                       6-0-0/w UBIN        r     1 NEXT
     7-0-0/w PTR         r     1 PTR$                      *0-0-0/b BIT         r     1 RESOLVE
    *0-0-0/w STRC(711)   r     1 VM_RADDRESS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$
     0-0-0/w PTR               1 B$TCB$                     0-0-0/c ASTR(9)     r     1 ERRMSG_FID
     0-0-0/w UBIN              1 M$DO_NUM                   0-0-0/w UBIN              1 M$LO_NUM
     0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM         0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM
     0-0-0/w UBIN              1 M$MAIL_FILE_NUM            0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM
     0-0-0/w UBIN              1 M$ME_NUM                   0-0-0/w UBIN              1 M$NODE_NUM
     0-0-0/w UBIN              1 M$SI_NUM                   0-0-0/w UBIN              1 M$WORK_NUM
     0-0-0/w PTR               1 VM_ADDLIST$                0-0-0/d VECT              1 VM_ADDLIST_
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:114  
     0-0-0/w PTR               1 VM_ADDREC$                 0-0-0/d VECT              1 VM_ADDREC_
     0-0-0/w PTR               1 VM_COPY$                   0-0-0/d VECT              1 VM_COPY_
     0-0-0/w PTR               1 VM_ENCLLIST$               0-0-0/d VECT              1 VM_ENCLLIST_
     0-0-0/w PTR               1 VM_ENCLREC$                0-0-0/d VECT              1 VM_ENCLREC_
     0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME       0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME
     0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS       0-0-0/w PTR               1 VM_HEADER$
     0-0-0/d VECT              1 VM_HEADER_                 0-0-0/d VECT              1 VM_HEADER_INIT_
     0-0-0/w PTR               1 VM_INPUT$                  0-0-0/d VECT              1 VM_INPUT_
     0-0-0/c STRC(72)          1 VM_MAILCG_NAME             0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA
     0-0-0/c STRC(72)    r     1 VM_MAIL_ACCT               0-0-0/c STRC(54)    r     1 VM_NAME_MAP_NAME
     0-0-0/w PTR               1 VM_PARSEAREA$              0-0-0/d VECT              1 VM_PARSEAREA_
     0-0-0/w PTR               1 VM_PROFILE$                0-0-0/d VECT              1 VM_PROFILE_
     0-0-0/w PTR               1 VM_SELECT$                 0-0-0/d VECT              1 VM_SELECT_
     0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME          0-0-0/c CHAR(8)           1 VM_SITENAME
     0-0-0/w PTR               1 VM_WORK$                   0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK             0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$MAIL_CENTRAL             0-0-0N  NULL        r     1 M$MAIL_COMGROUP
     0-0-0N  NULL        r     1 M$MAIL_FILE                0-0-0N  NULL        r     1 M$MAIL_GLOBAL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$WORK                     0-0-0N  NULL        r     1 NAME_IN
     0-0-0/w STRC(2448)  r     1 VM_UADDRESS                0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMF$MAKE_ADDRESS2 requires 431 words for executable code.
   Procedure VMF$MAKE_ADDRESS2 requires 24 words of local(AUTO) storage.

    No errors detected in file VMF$SUBR.:VMB6TSI    .
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:116  
          MINI XREF LISTING

ACCTSET
      8242**DCL      8625<<ASSIGN   8663<<ASSIGN   8701>>IF
ADDRESS
      8195**DCL        20--PROC
ADDRESS.SIZ
      8196**DCL      8197--IMP-SIZ  8602>>ASSIGN   8611>>CALLBLT  8612>>CALLBLT  8630>>CALLBLT  8631>>CALLBLT
      8647>>ASSIGN   8648>>CALLBLT  8655>>CALLBLT  8665>>CALLBLT  8677>>CALLBLT  8681>>CALLBLT  8684>>CALLBLT
      8687>>ASSIGN   8702>>CALLBLT  8705>>CALLBLT  8707>>CALLBLT  8708>>CALLBLT  8713<<ASSIGN
ADDRESS.TEXT
      8197**DCL      8602<<ASSIGN   8611<<CALLBLT  8612>>CALLBLT  8630<<CALLBLT  8631>>CALLBLT  8647<<ASSIGN
      8648>>CALLBLT  8655<<CALLBLT  8665<<CALLBLT  8677<<CALLBLT  8681<<CALLBLT  8684>>CALLBLT  8687<<ASSIGN
      8702<<CALLBLT  8705<<CALLBLT  8707<<CALLBLT  8708>>CALLBLT
B$SR_NON_BLANK
      8191**DCL      8648>>CALLBLT  8674>>CALLBLT
B$SR_NON_BLANK$
      8190**DCL      8191--IMP-PTR  8648>>CALLBLT  8674>>CALLBLT
BAD_NAME IN PROCEDURE GET_NAME
      8737**LABEL    8720--CALLALT  8732--CALLALT
CLOSE_NAME
      8427**DCL      8725<>CALL     8734<>CALL     8738<>CALL
CLOSE_NAME.SN_
      8427**DCL      8427--REDEF
CLOSE_NAME.UTL_
      8428**DCL      8428--REDEF
CLOSE_NAME.V
      8432**DCL      8427--DCLINIT
CLOSE_NAME.V.EXPIRE#
      8442**DCL      8442--REDEF
CLOSE_NAME.V.TYPE#
      8440**DCL      8440--REDEF
CLOSE_NAME.V.XTNSIZE#
      8437**DCL      8437--REDEF    8439--REDEF
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:117  
DOMSET
      8243**DCL      8626<<ASSIGN   8686<<ASSIGN   8704>>IF
DUMMY
      8245**DCL      8648<<CALLBLT  8674<<CALLBLT
ERRMSG_FID.L#
      7665**DCL      7665--IMP-SIZ
F$DCB.ACTPOS
      8576**DCL      8576--REDEF
F$DCB.ARS#
      8550**DCL      8550--REDEF    8724>>ASSIGN   8733>>ASSIGN
F$DCB.ATTR
      8569**DCL      8570--REDEF
F$DCB.BORROW
      8584**DCL      8584--REDEF    8584--REDEF    8584--REDEF
F$DCB.DCBNAME.L
      8598**DCL      8598--IMP-SIZ
F$DCB.EOMCHAR#
      8554**DCL      8554--REDEF
F$DCB.FCD#
      8563**DCL      8737>>IF
F$DCB.FLDID
      8579**DCL      8579--REDEF
F$DCB.FORM$
      8573**DCL      8573--REDEF
F$DCB.FSECT
      8589**DCL      8589--REDEF
F$DCB.FSN#
      8566**DCL      8566--REDEF    8566--REDEF    8567--REDEF
F$DCB.HEADER$
      8572**DCL      8572--REDEF
F$DCB.IXTNSIZE#
      8570**DCL      8570--REDEF
F$DCB.LASTSTA$
      8559**DCL      8559--REDEF
F$DCB.LVL
      8585**DCL      8585--REDEF
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:118  
F$DCB.NAME#.C
      8560**DCL      8560--REDEF
F$DCB.NOEOF
      8582**DCL      8582--REDEF
F$DCB.NRECS#
      8571**DCL      8571--REDEF
F$DCB.NRECX
      8590**DCL      8590--REDEF
F$DCB.OHDR
      8582**DCL      8582--REDEF
F$DCB.ORG#
      8565**DCL      8565--REDEF
F$DCB.PRECNO
      8588**DCL      8588--REDEF
F$DCB.RCSZ
      8594**DCL      8594--REDEF
F$DCB.RES#
      8561**DCL      8561--REDEF
F$DCB.SETX
      8573**DCL      8573--REDEF
F$DCB.TAB$
      8573**DCL      8573--REDEF
F$DCB.TDA
      8587**DCL      8588--REDEF
F$DCB.WSN#
      8561**DCL      8561--REDEF
FOLDER
      8246**DCL      8610<<ASSIGN   8618<<ASSIGN   8627>>IF       8630>>CALLBLT  8651>>IF       8655>>CALLBLT
      8656>>CALLBLT  8678>>IF       8681>>CALLBLT
GET_NAME
      8716**PROC     8644--CALL
INDX
      8244**DCL      8612<<CALLBLT  8619<<ASSIGN   8630>>CALLBLT  8631<<CALLBLT  8653<<ASSIGN   8656<<CALLBLT
      8657>>ASSIGN   8661>>ASSIGN   8665>>CALLBLT  8666>>ASSIGN   8684<<CALLBLT  8687>>ASSIGN   8689<<ASSIGN
      8692>>ASSIGN
M$CLOSE
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:119  
      5509**DCL-ENT  8725--CALL     8734--CALL     8738--CALL
M$OPEN
      5509**DCL-ENT  8720--CALL
M$READ
      5510**DCL-ENT  8723--CALL     8732--CALL
NAME_IN
      8247**DCL      8724--ASSIGN   8733--ASSIGN   8737--IF
NAME_KEY
      8514**DCL      8467--DCLINIT  8468--DCLINIT
NAME_KEY.L#
      8514**DCL      8721<<ASSIGN
NAME_KEY.NAME#
      8514**DCL      8722<<ASSIGN   8731<<ASSIGN
NEXT
      8240**DCL      8646<<ASSIGN   8647>>ASSIGN   8648<<CALLBLT  8648>>CALLBLT  8650<<ASSIGN   8650>>ASSIGN
      8655>>CALLBLT  8657<<ASSIGN   8657>>ASSIGN   8661<<ASSIGN   8664<<CALLBLT  8665>>CALLBLT  8666<<ASSIGN
      8666>>ASSIGN   8671<<ASSIGN   8672>>IF       8674<<CALLBLT  8674>>CALLBLT  8676<<ASSIGN   8676>>ASSIGN
      8677>>CALLBLT  8680<<ASSIGN   8680>>ASSIGN   8681>>CALLBLT  8684>>CALLBLT  8692<<ASSIGN   8692>>ASSIGN
      8702>>CALLBLT  8705>>CALLBLT  8707>>CALLBLT  8708<<CALLBLT  8708>>CALLBLT  8713>>ASSIGN
OPEN_NAME
      8358**DCL      8720<>CALL
OPEN_NAME.ACSVEH_
      8360**DCL      8361--REDEF
OPEN_NAME.ALTKEYS_
      8366**DCL      8367--REDEF    8367--REDEF
OPEN_NAME.HDR_
      8365**DCL      8366--REDEF
OPEN_NAME.TAB_
      8364**DCL      8365--REDEF
OPEN_NAME.UHL_
      8358**DCL      8359--REDEF    8359--REDEF
OPEN_NAME.V
      8367**DCL      8358--DCLINIT
OPEN_NAME.V.FSN#
      8398**DCL      8398--REDEF    8398--REDEF
OPEN_NAME.WSN_
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:120  
      8364**DCL      8364--REDEF
PASS
      8698**LABEL    8659--GOTO
PTR$
      8241**DCL      8259--IMP-PTR  8601<<ASSIGN   8671>>ASSIGN   8674>>CALLBLT  8677>>CALLBLT
READ_NAME
      8467**DCL      8723<>CALL     8732<>CALL
READ_NAME.STATION_
      8470**DCL      8471--REDEF
READ_NAME.V
      8471**DCL      8467--DCLINIT
READ_NAME.V.DVBYTE.REREAD#
      8482**DCL      8482--REDEF
READ_NAME.V.INDX#
      8480**DCL      8480--REDEF
RESOLVE
      8238**DCL        20--PROC     8639--IF       8639>>IF
TRY_AGAIN IN PROCEDURE GET_NAME
      8731**LABEL    8723--CALLALT
VM_MAIL_ACCT
      7611**DCL      8363--DCLINIT
VM_NAME_MAP_NAME
      7638**DCL      8359--DCLINIT
VM_RADDRESS
      8213**DCL        20--PROC     8601--ASSIGN
VM_RADDRESS.ACCT
      8236**DCL      8661>>IF       8664>>CALLBLT  8665>>CALLBLT  8731>>ASSIGN
VM_RADDRESS.FOLDER
      8228**DCL      8229--REDEF    8618>>ASSIGN
VM_RADDRESS.NAME_KEY
      8226**DCL      8721--ASSIGN   8722>>ASSIGN
VM_RADDRESS.NOMAD.DELIM
      8231**DCL      8607>>IF
VM_RADDRESS.NOMAD.FOLDER
      8230**DCL      8610>>ASSIGN
VM_RADDRESS.NOMAD.PSID
PL6.E3A0      #003=VMF$MAKE_ADDRESS2 File=VMF$SUBR.:VMB6TSI                      WED 08/20/97 15:16 Page:121  
      8232**DCL      8607>>IF       8611>>CALLBLT
VM_RADDRESS.SITENAME
      8235**DCL      8698>>IF       8702>>CALLBLT  8705>>CALLBLT  8707>>CALLBLT
VM_RADDRESS.TYPE
      8225**DCL      8636>>IF
VM_UADDRESS.FOLDER
      8274**DCL      8275--REDEF
VM_UADDRESS.USER_NAME.COUNT
      8283**DCL      8671>>ASSIGN
VM_UADDRESS.USER_NAME.TEXT
      8284**DCL      8674>>CALLBLT  8677>>CALLBLT
WORK_TEXTC.L#
      8541**DCL      8646>>ASSIGN   8724<<ASSIGN   8733<<ASSIGN
WORK_TEXTC.NAME#
      8541**DCL      8469--DCLINIT  8470--DCLINIT  8647>>ASSIGN
X$STRING.SIZ
      7511**DCL      7512--IMP-SIZ
