VERSION E05

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:1    
        1        1        /*M* QQA$SETFP - Perform M$SETFP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$SETFP
        9        9
       10       10             PURPOSE:     To perform an M$SETFP for a TP station.
       11       11        */
       12       12        /*D* NAME:        QQA$SETFP
       13       13             CALL:        CALL QQA$SETFP(STA$,QT_FORM);
       14       14             INPUT:       STA$ - A pointer to the TP$STATION block needing an
       15       15                                 M$SETFP.
       16       16                          QT_FORM - A structure containing fid information for
       17       17                                    the rununit to be M$SETFP.
       18       18             DESCRIPTION: QQA$SETFP performs the necessary M$SETFP on the
       19       19                          TP$STATION passed in via STA$. The information
       20       20                          necessary to do the M$SETFP is found in QT_FORM.
       21       21
       22       22                          Since the QT_FORM information has previously been
       23       23                          validated via QQA$BYTYPE who filled it in, this
       24       24                          M$SETFP should not ALTRET. If it does for any reason
       25       25                          other than terminal disconnect, this procedure will
       26       26                          call QQC$SCREECH screeching TPA.
       27       27        */
       28       28        %EJECT;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:2    
       29       29        QQA$SETFP: PROC(STA$,QT_FORM);
       30       30        %INCLUDE Q_PAGE_C;
       31       62        %SET LISTEXP = '1'B;
       32       63        %PAGE(ARG="Includes");

                80        /***************************************************************************
                81         *                                                                         *
                82         *                                  Includes                               *
                83         *                                                                         *
                84         ***************************************************************************/

       33       88        %INCLUDE CP_6;
       34      169        %INCLUDE QQ_MACROS_C;
       35      594        %INCLUDE QQ_DATA_R;
       36      840        %INCLUDE B_ERRORS_C;
       37     1967        %INCLUDE QT_MACROS_C;
       38     2125        %INCLUDE QQ_PERR_C;
       39     2286        %INCLUDE Q_ERRCODE_C;
       40     2309        %PAGE(ARG="Parameters");

              2326    1   /***************************************************************************
              2327    1    *                                                                         *
              2328    1    *                                 Parameters                              *
              2329    1    *                                                                         *
              2330    1    ***************************************************************************/

       41     2334    1   DCL STA$ PTR;
       42     2335        %QT$FORM(FPTN=QT_FORM,STCLASS=PARAM);
       43     2374        %PAGE(ARG="Externally defined routines");

              2391    1   /***************************************************************************
              2392    1    *                                                                         *
              2393    1    *                        Externally defined routines                      *
              2394    1    *                                                                         *
              2395    1    ***************************************************************************/

       44     2399    1   DCL QQC$SCREECH ENTRY;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:3    
       45     2400    1   DCL QQC$BLDMSG ENTRY(1);
       46     2401    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       47     2402        %PAGE(ARG="Symrefs");

              2419    1   /***************************************************************************
              2420    1    *                                                                         *
              2421    1    *                                  Symrefs                                *
              2422    1    *                                                                         *
              2423    1    ***************************************************************************/

       48     2427    1   DCL B$TCB$ PTR SYMREF;
       49     2428        %PAGE(ARG="DCBs");

              2445    1   /***************************************************************************
              2446    1    *                                                                         *
              2447    1    *                                    DCBs                                 *
              2448    1    *                                                                         *
              2449    1    ***************************************************************************/

       50     2453    1   DCL M$CG DCB;
       51     2454    1   DCL M$FPRG DCB;
       52     2455        %PAGE(ARG="Based");

              2472    1   /***************************************************************************
              2473    1    *                                                                         *
              2474    1    *                                   Based                                 *
              2475    1    *                                                                         *
              2476    1    ***************************************************************************/

       53     2480        %B$TCB;
       54     2483        %B$ALT;
       55     2491        %TP$STATION;
       56     2564        %PAGE(ARG="Static",PAGE=YES);

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:4    
              2581    1   /***************************************************************************
              2582    1    *                                                                         *
              2583    1    *                                   Static                                *
              2584    1    *                                                                         *
              2585    1    ***************************************************************************/

       57     2589    1   DCL UNFID_SIZE UBIN WORD STATIC;        /*  FPT_UNFID                         */
       58     2590    1   DCL FID        CHAR(100) STATIC;
       59     2591        %PAGE(ARG="Auto");

              2608    1   /***************************************************************************
              2609    1    *                                                                         *
              2610    1    *                                    Auto                                 *
              2611    1    *                                                                         *
              2612    1    ***************************************************************************/

       60     2616        %MSGBLK;
       61     2706        %VLP_NAME(FPTN=TEXTC_STATION,STCLASS=AUTO,LEN=8);
       62     2733        %VLP_NAME(FPTN=TEXTC_FID,STCLASS=AUTO,LEN=100);
       63     2760        %PAGE(ARG="Error codes",PAGE=YES);

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:5    
              2777    1   /***************************************************************************
              2778    1    *                                                                         *
              2779    1    *                                Error codes                              *
              2780    1    *                                                                         *
              2781    1    ***************************************************************************/

       64     2785        %ERRCODE(NAME=CODE_UTLFP,CODE#=%E$UTLFP,FCG#=%FCG_QQ,MID#=%MID_A);
       65     2792        %ERRCODE(NAME=CODE_UTLCFP,CODE#=%E$UTLCFP,FCG#=%FCG_QQ,MID#=%MID_A);
       66     2799        %PAGE(ARG="FPTs");

              2816    1   /***************************************************************************
              2817    1    *                                                                         *
              2818    1    *                                    FPTs                                 *
              2819    1    *                                                                         *
              2820    1    ***************************************************************************/

       67     2824        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE,DCB=M$CG,DISCONNECT=YES);
       68     2847        %FPT_OPEN(DCB=M$FPRG,ASN=FILE,FUN=IN,SCRUB=YES,TEST=YES,
       69     2848                  NAME=VLP_FPRG.NAME,ACCT=VLP_FPRG.ACCT#,PASS=VLP_FPRG.PASS#,
       70     2849                  SN=VLP_SN);
       71     2958        %FPT_UNFID(TEXTFID=FID,NAME=VLP_FPRG.NAME,ACCT=VLP_FPRG.ACCT#,
       72     2959                   PASS=VLP_FPRG.PASS#,SN=VLP_SN,WSN=VLP_WSN,ASN=FPT_OPEN.V.ASN#,
       73     2960                   RES=FPT_OPEN.V.RES#,LEN=UNFID_SIZE);
       74     2978        %FPT_SETFP(DCB=M$CG, FPRG=VLP_FPRG, STATION=VLP_STATION);
       75     2991        %PAGE(ARG="VLPs");

              3008    1   /***************************************************************************
              3009    1    *                                                                         *
              3010    1    *                                    VLPs                                 *
              3011    1    *                                                                         *
              3012    1    ***************************************************************************/

       76     3016        %VLP_FPRG;
       77     3037        %VLP_STATION;
       78     3064        %VLP_WSN;
       79     3077        %VLP_SN;
       80     3090        %PAGE(ARG="QQA$SETFP",PAGE=YES);
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:6    

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:7    
              3107    1   /***************************************************************************
              3108    1    *                                                                         *
              3109    1    *                                 QQA$SETFP                               *
              3110    1    *                                                                         *
              3111    1    ***************************************************************************/

       81     3115    1           S$ = STA$;
       82     3116    1           VLP_STATION.STATION# = TP$STATION.ID;
       83     3117    1           VLP_FPRG = '0'B;
       84     3118    1           VLP_FPRG.NAME.C# = QT_FORM.FP.NAME.TEXT;
       85     3119    1           VLP_FPRG.NAME.L# = QT_FORM.FP.NAME.COUNT;
       86     3120    1           VLP_FPRG.ACCT# = QT_FORM.FP.ACCT;
       87     3121    1           VLP_FPRG.PASS# = QT_FORM.FP.PASS;
       88     3122    1           VLP_FPRG.PSN# = QT_FORM.FP.SN;
       89     3123    1           TP$STATION.FLAGS.IS_DEBUGGING = '0'B;
       90     3124    1           IF TP$STATION.FLAGS.SET_DEBUG THEN
       91     3125    2             DO;
       92     3126    2               TP$STATION.FLAGS.SET_DEBUG = '0'B;
       93     3127    2               TP$STATION.FLAGS.IS_DEBUGGING = '1'B;
       94     3128    2               VLP_FPRG.FLGS.DEBUG# = '1'B;
       95     3129    2             END;
       96     3130    2           CALL M$SETFP(FPT_SETFP) WHENALTRETURN DO;
       97     3131    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
       98     3132    2               IF TP$STATION.DFLT_FP = '*DFLT' OR
       99     3133    2                   (TP$STATION.FP ='(name)' AND TP$STATION.FPLDTRC$ = ADDR(NIL)) THEN
      100     3134    2                 MSGBLK.FLAGS.DEST.STATION = '1'B;
      101     3135    2               MSGBLK.ID = TP$STATION.ID;
      102     3136    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLFP;
      103     3137    2               MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      104     3138    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      105     3139    2               TEXTC_STATION.L# = 8;
      106     3140    2               TEXTC_STATION.NAME# = TP$STATION.ID;
      107     3141    2               CALL M$OPEN(FPT_OPEN) ALTRET(ERR_OUT);
      108     3142    2   ERR_OUT:    ;
      109     3143    2               CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);
      110     3144    2               TEXTC_FID.L# = UNFID_SIZE;
      111     3145    2               TEXTC_FID.NAME# = FID;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:8    
      112     3146    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_FID);
      113     3147    2               CALL QQC$BLDMSG(MSGBLK);
      114     3148
      115     3149                  /*  We should only deactivate if the default forms
      116     3150                  program is TP$STATION.DFLT_FP ~= '*DFLT' and
      117     3151                  TP$STATION.PEND_FP = TP$STATION.DFLT_FP         */
      118     3152
      119     3153    3               IF TP$STATION.PEND_FP = TP$STATION.DFLT_FP THEN DO;
      120     3154    3                   FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);
      121     3155    4                   CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;
      122     3156    4                       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= 1154 /* E$CGANFS */
              3156                                THEN
      123     3157    4                         GOTO MON_ERR;
      124     3158    4                     END;
      125     3159    3                 END;
      126     3160    3               ELSE DO;                    /*  get user back to default program  */
      127     3161    3                   VLP_FPRG.NAME = QQ_GLOBAL.CFP_RU.NAME;
      128     3162    3                   VLP_FPRG.ACCT# = QQ_GLOBAL.CFP_RU.ACCT;
      129     3163    3                   VLP_FPRG.PASS# = QQ_GLOBAL.CFP_RU.PASS;
      130     3164    3                   VLP_FPRG.PSN# = QQ_GLOBAL.CFP_RU.PSN;
      131     3165    4                   CALL M$SETFP(FPT_SETFP) WHENALTRETURN DO;
      132     3166    4                       CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      133     3167    4                       MSGBLK.ERRINFO.ERR(0) = CODE_UTLCFP;
      134     3168    4                       MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      135     3169    4                       MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      136     3170    4                       TEXTC_STATION.L# = 8;
      137     3171    4                       TEXTC_STATION.NAME# = TP$STATION.ID;
      138     3172    4                       CALL QQC$BLDMSG(MSGBLK);
      139     3173                                                /* Deactivate the Station             */
      140     3174    4                       FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);
      141     3175    5                       CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;
      142     3176    5                         END;
      143     3177    4                       RETURN;
      144     3178    4                     END;
      145     3179    3                   TP$STATION.FP = '*DFLT   ';
      146     3180    3                   TP$STATION.PEND_FP = ' ';
      147     3181    3                 END;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:9    
      148     3182    2               RETURN;
      149     3183    2   MON_ERR:
      150     3184    2               QQ_GLOBAL.ERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      151     3185    2               CALL QQC$SCREECH;
      152     3186    2             END;
      153     3187    1           TP$STATION.FP = TP$STATION.PEND_FP;
      154     3188    1           TP$STATION.PEND_FP = ' ';
      155     3189    1           RETURN;
      156     3190    1   END QQA$SETFP;

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:10   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$SETFP.

   Procedure QQA$SETFP requires 218 words for executable code.
   Procedure QQA$SETFP requires 60 words of local(AUTO) storage.

    No errors detected in file QQA$SETFP.:E05TSI    .

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:11   

 Object Unit name= QQA$SETFP                                  File name= QQA$SETFP.:E05TOU
 UTS= JUL 30 '97 05:26:35.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$FPRG
    3   Data  even  none   166    246  QQA$SETFP
    4  RoData even  UTS      6      6  QQA$SETFP
    5   Proc  even  none   218    332  QQA$SETFP
    6  RoData even  none     5      5  QQA$SETFP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        2  QQA$SETFP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QQC$BLDMSG
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$BLDMSG_ERRBLK
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:12   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             B$TCB$
     M$CG                                  M$FPRG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:13   


        1        1        /*M* QQA$SETFP - Perform M$SETFP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$SETFP
        9        9
       10       10             PURPOSE:     To perform an M$SETFP for a TP station.
       11       11        */
       12       12        /*D* NAME:        QQA$SETFP
       13       13             CALL:        CALL QQA$SETFP(STA$,QT_FORM);
       14       14             INPUT:       STA$ - A pointer to the TP$STATION block needing an
       15       15                                 M$SETFP.
       16       16                          QT_FORM - A structure containing fid information for
       17       17                                    the rununit to be M$SETFP.
       18       18             DESCRIPTION: QQA$SETFP performs the necessary M$SETFP on the
       19       19                          TP$STATION passed in via STA$. The information
       20       20                          necessary to do the M$SETFP is found in QT_FORM.
       21       21
       22       22                          Since the QT_FORM information has previously been
       23       23                          validated via QQA$BYTYPE who filled it in, this
       24       24                          M$SETFP should not ALTRET. If it does for any reason
       25       25                          other than terminal disconnect, this procedure will
       26       26                          call QQC$SCREECH screeching TPA.
       27       27        */
       28       28        %EJECT;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:14   
       29       29        QQA$SETFP: PROC(STA$,QT_FORM);

     29  5 000000   000000 700200 xent  QQA$SETFP    TSX0  ! X66_AUTO_2
         5 000001   000074 000002                    ZERO    60,2

       30       30        %INCLUDE Q_PAGE_C;
       31       62        %SET LISTEXP = '1'B;
       32       63        %PAGE(ARG="Includes");

                80        /***************************************************************************
                81         *                                                                         *
                82         *                                  Includes                               *
                83         *                                                                         *
                84         ***************************************************************************/

       33       88        %INCLUDE CP_6;
       34      169        %INCLUDE QQ_MACROS_C;
       35      594        %INCLUDE QQ_DATA_R;
       36      840        %INCLUDE B_ERRORS_C;
       37     1967        %INCLUDE QT_MACROS_C;
       38     2125        %INCLUDE QQ_PERR_C;
       39     2286        %INCLUDE Q_ERRCODE_C;
       40     2309        %PAGE(ARG="Parameters");

              2326    1   /***************************************************************************
              2327    1    *                                                                         *
              2328    1    *                                 Parameters                              *
              2329    1    *                                                                         *
              2330    1    ***************************************************************************/

       41     2334    1   DCL STA$ PTR;
       42     2335        %QT$FORM(FPTN=QT_FORM,STCLASS=PARAM);
       43     2374        %PAGE(ARG="Externally defined routines");

              2391    1   /***************************************************************************
              2392    1    *                                                                         *
              2393    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:15   
              2394    1    *                                                                         *
              2395    1    ***************************************************************************/

       44     2399    1   DCL QQC$SCREECH ENTRY;
       45     2400    1   DCL QQC$BLDMSG ENTRY(1);
       46     2401    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       47     2402        %PAGE(ARG="Symrefs");

              2419    1   /***************************************************************************
              2420    1    *                                                                         *
              2421    1    *                                  Symrefs                                *
              2422    1    *                                                                         *
              2423    1    ***************************************************************************/

       48     2427    1   DCL B$TCB$ PTR SYMREF;
       49     2428        %PAGE(ARG="DCBs");

              2445    1   /***************************************************************************
              2446    1    *                                                                         *
              2447    1    *                                    DCBs                                 *
              2448    1    *                                                                         *
              2449    1    ***************************************************************************/

       50     2453    1   DCL M$CG DCB;
       51     2454    1   DCL M$FPRG DCB;
       52     2455        %PAGE(ARG="Based");

              2472    1   /***************************************************************************
              2473    1    *                                                                         *
              2474    1    *                                   Based                                 *
              2475    1    *                                                                         *
              2476    1    ***************************************************************************/

       53     2480        %B$TCB;
       54     2483        %B$ALT;
       55     2491        %TP$STATION;
       56     2564        %PAGE(ARG="Static",PAGE=YES);
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:16   

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:17   
              2581    1   /***************************************************************************
              2582    1    *                                                                         *
              2583    1    *                                   Static                                *
              2584    1    *                                                                         *
              2585    1    ***************************************************************************/

       57     2589    1   DCL UNFID_SIZE UBIN WORD STATIC;        /*  FPT_UNFID                         */
       58     2590    1   DCL FID        CHAR(100) STATIC;
       59     2591        %PAGE(ARG="Auto");

              2608    1   /***************************************************************************
              2609    1    *                                                                         *
              2610    1    *                                    Auto                                 *
              2611    1    *                                                                         *
              2612    1    ***************************************************************************/

       60     2616        %MSGBLK;
       61     2706        %VLP_NAME(FPTN=TEXTC_STATION,STCLASS=AUTO,LEN=8);
       62     2733        %VLP_NAME(FPTN=TEXTC_FID,STCLASS=AUTO,LEN=100);
       63     2760        %PAGE(ARG="Error codes",PAGE=YES);

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:18   
              2777    1   /***************************************************************************
              2778    1    *                                                                         *
              2779    1    *                                Error codes                              *
              2780    1    *                                                                         *
              2781    1    ***************************************************************************/

       64     2785        %ERRCODE(NAME=CODE_UTLFP,CODE#=%E$UTLFP,FCG#=%FCG_QQ,MID#=%MID_A);
       65     2792        %ERRCODE(NAME=CODE_UTLCFP,CODE#=%E$UTLCFP,FCG#=%FCG_QQ,MID#=%MID_A);
       66     2799        %PAGE(ARG="FPTs");

              2816    1   /***************************************************************************
              2817    1    *                                                                         *
              2818    1    *                                    FPTs                                 *
              2819    1    *                                                                         *
              2820    1    ***************************************************************************/

       67     2824        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE,DCB=M$CG,DISCONNECT=YES);
       68     2847        %FPT_OPEN(DCB=M$FPRG,ASN=FILE,FUN=IN,SCRUB=YES,TEST=YES,
       69     2848                  NAME=VLP_FPRG.NAME,ACCT=VLP_FPRG.ACCT#,PASS=VLP_FPRG.PASS#,
       70     2849                  SN=VLP_SN);
       71     2958        %FPT_UNFID(TEXTFID=FID,NAME=VLP_FPRG.NAME,ACCT=VLP_FPRG.ACCT#,
       72     2959                   PASS=VLP_FPRG.PASS#,SN=VLP_SN,WSN=VLP_WSN,ASN=FPT_OPEN.V.ASN#,
       73     2960                   RES=FPT_OPEN.V.RES#,LEN=UNFID_SIZE);
       74     2978        %FPT_SETFP(DCB=M$CG, FPRG=VLP_FPRG, STATION=VLP_STATION);
       75     2991        %PAGE(ARG="VLPs");

              3008    1   /***************************************************************************
              3009    1    *                                                                         *
              3010    1    *                                    VLPs                                 *
              3011    1    *                                                                         *
              3012    1    ***************************************************************************/

       76     3016        %VLP_FPRG;
       77     3037        %VLP_STATION;
       78     3064        %VLP_WSN;
       79     3077        %VLP_SN;
       80     3090        %PAGE(ARG="QQA$SETFP",PAGE=YES);
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:19   

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:20   
              3107    1   /***************************************************************************
              3108    1    *                                                                         *
              3109    1    *                                 QQA$SETFP                               *
              3110    1    *                                                                         *
              3111    1    ***************************************************************************/

       81     3115    1           S$ = STA$;

   3115  5 000002   200003 470500                    LDP0    @STA$,,AUTO
         5 000003   000000 236100                    LDQ     0,,PR0
         5 000004   200005 756100                    STQ     S$,,AUTO

       82     3116    1           VLP_STATION.STATION# = TP$STATION.ID;

   3116  5 000005   200005 471500                    LDP1    S$,,AUTO
         5 000006   040000 100500                    MLR     fill='040'O
         5 000007   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         5 000010   000230 000010 3                  ADSC9   VLP_STATION              cn=0,n=8

       83     3117    1           VLP_FPRG = '0'B;

   3117  5 000011   000000 100400                    MLR     fill='000'O
         5 000012   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000013   000206 000104 3                  ADSC9   VLP_FPRG                 cn=0,n=68

       84     3118    1           VLP_FPRG.NAME.C# = QT_FORM.FP.NAME.TEXT;

   3118  5 000014   200004 473500                    LDP3    @QT_FORM,,AUTO
         5 000015   040000 100500                    MLR     fill='040'O
         5 000016   300002 200037                    ADSC9   2,,PR3                   cn=1,n=31
         5 000017   000210 200037 3                  ADSC9   VLP_FPRG+2               cn=1,n=31

       85     3119    1           VLP_FPRG.NAME.L# = QT_FORM.FP.NAME.COUNT;

   3119  5 000020   300002 236100                    LDQ     2,,PR3
         5 000021   000210 552040 3                  STBQ    VLP_FPRG+2,'40'O

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:21   
       86     3120    1           VLP_FPRG.ACCT# = QT_FORM.FP.ACCT;

   3120  5 000022   040000 100500                    MLR     fill='040'O
         5 000023   300012 000010                    ADSC9   10,,PR3                  cn=0,n=8
         5 000024   000220 000010 3                  ADSC9   VLP_FPRG+10              cn=0,n=8

       87     3121    1           VLP_FPRG.PASS# = QT_FORM.FP.PASS;

   3121  5 000025   040000 100500                    MLR     fill='040'O
         5 000026   300014 000010                    ADSC9   12,,PR3                  cn=0,n=8
         5 000027   000222 000010 3                  ADSC9   VLP_FPRG+12              cn=0,n=8

       88     3122    1           VLP_FPRG.PSN# = QT_FORM.FP.SN;

   3122  5 000030   040000 100500                    MLR     fill='040'O
         5 000031   300016 000006                    ADSC9   14,,PR3                  cn=0,n=6
         5 000032   000206 400006 3                  ADSC9   VLP_FPRG                 cn=2,n=6

       89     3123    1           TP$STATION.FLAGS.IS_DEBUGGING = '0'B;

   3123  5 000033   000000 236000 6                  LDQ     0
         5 000034   100022 356100                    ANSQ    18,,PR1

       90     3124    1           IF TP$STATION.FLAGS.SET_DEBUG THEN

   3124  5 000035   100022 236100                    LDQ     18,,PR1
         5 000036   010000 316003                    CANQ    4096,DU
         5 000037   000046 600000 5                  TZE     s:3130

       91     3125    2             DO;

       92     3126    2               TP$STATION.FLAGS.SET_DEBUG = '0'B;

   3126  5 000040   000001 236000 6                  LDQ     1
         5 000041   100022 356100                    ANSQ    18,,PR1

       93     3127    2               TP$STATION.FLAGS.IS_DEBUGGING = '1'B;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:22   

   3127  5 000042   004000 236003                    LDQ     2048,DU
         5 000043   100022 256100                    ORSQ    18,,PR1

       94     3128    2               VLP_FPRG.FLGS.DEBUG# = '1'B;

   3128  5 000044   000400 236003                    LDQ     256,DU
         5 000045   000206 256000 3                  ORSQ    VLP_FPRG

       95     3129    2             END;

       96     3130    2           CALL M$SETFP(FPT_SETFP) WHENALTRETURN DO;

   3130  5 000046   000172 630400 3                  EPPR0   FPT_SETFP
         5 000047   560021 713400                    CLIMB   alt,+57361
         5 000050   401400 401760                    pmme    nvectors=4
         5 000051   000053 702000 5                  TSX2    s:3131
         5 000052   000321 710000 5                  TRA     s:3187

       97     3131    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3131  5 000053   200006 630500                    EPPR0   MSGBLK,,AUTO
         5 000054   200070 450500                    STP0    TEXTC_FID+26,,AUTO
         5 000055   200070 630500                    EPPR0   TEXTC_FID+26,,AUTO
         5 000056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000057   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 000060   000000 011000                    NOP     0

       98     3132    2               IF TP$STATION.DFLT_FP = '*DFLT' OR

   3132  5 000061   200005 470500                    LDP0    S$,,AUTO
         5 000062   040000 106500                    CMPC    fill='040'O
         5 000063   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         5 000064   000002 000005 4                  ADSC9   CODE_UTLCFP+1            cn=0,n=5
         5 000065   000075 600000 5                  TZE     s:3134
         5 000066   040000 106500                    CMPC    fill='040'O
         5 000067   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:23   
         5 000070   000004 000006 4                  ADSC9   CODE_UTLCFP+3            cn=0,n=6
         5 000071   000077 601000 5                  TNZ     s:3135
         5 000072   000017 236100                    LDQ     15,,PR0
         5 000073   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000074   000077 601000 5                  TNZ     s:3135

       99     3133    2                   (TP$STATION.FP ='(name)' AND TP$STATION.FPLDTRC$ = ADDR(NIL)) THEN
      100     3134    2                 MSGBLK.FLAGS.DEST.STATION = '1'B;

   3134  5 000075   000100 236003                    LDQ     64,DU
         5 000076   200010 256100                    ORSQ    MSGBLK+2,,AUTO

      101     3135    2               MSGBLK.ID = TP$STATION.ID;

   3135  5 000077   040100 100500                    MLR     fill='040'O
         5 000100   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000101   200006 000010                    ADSC9   MSGBLK,,AUTO             cn=0,n=8

      102     3136    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLFP;

   3136  5 000102   000000 236000 4                  LDQ     CODE_UTLFP
         5 000103   200014 756100                    STQ     MSGBLK+6,,AUTO

      103     3137    2               MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3137  5 000104   000000 471400 xsym               LDP1    B$TCB$
         5 000105   100000 473500                    LDP3    0,,PR1
         5 000106   000100 100500                    MLR     fill='000'O
         5 000107   300102 000004                    ADSC9   66,,PR3                  cn=0,n=4
         5 000110   200023 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      104     3138    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3138  5 000111   000002 235000 6                  LDA     2
         5 000112   200070 452500                    STP2    TEXTC_FID+26,,AUTO
         5 000113   200070 236100                    LDQ     TEXTC_FID+26,,AUTO
         5 000114   000033 036003                    ADLQ    27,DU
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:24   
         5 000115   200072 757100                    STAQ    TEXTC_FID+28,,AUTO
         5 000116   000100 100500                    MLR     fill='000'O
         5 000117   200072 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         5 000120   200015 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      105     3139    2               TEXTC_STATION.L# = 8;

   3139  5 000121   010000 236003                    LDQ     4096,DU
         5 000122   200033 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      106     3140    2               TEXTC_STATION.NAME# = TP$STATION.ID;

   3140  5 000123   040100 100500                    MLR     fill='040'O
         5 000124   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000125   200033 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      107     3141    2               CALL M$OPEN(FPT_OPEN) ALTRET(ERR_OUT);

   3141  5 000126   000052 630400 3                  EPPR0   FPT_OPEN
         5 000127   450000 713400                    CLIMB   alt,open
         5 000130   410400 401760                    pmme    nvectors=18
         5 000131   000132 702000 5                  TSX2    ERR_OUT

   3140  5 000132                       ERR_OUT      null
      108     3142    2   ERR_OUT:    ;
      109     3143    2               CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);

   3143  5 000132   000144 630400 3                  EPPR0   FPT_UNFID
         5 000133   420021 713400                    CLIMB   alt,+8209
         5 000134   404400 401760                    pmme    nvectors=10
         5 000135   000312 702000 5                  TSX2    MON_ERR

      110     3144    2               TEXTC_FID.L# = UNFID_SIZE;

   3144  5 000136   000000 236000 3                  LDQ     UNFID_SIZE
         5 000137   000033 736000                    QLS     27
         5 000140   200036 552140                    STBQ    TEXTC_FID,'40'O,AUTO
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:25   

      111     3145    2               TEXTC_FID.NAME# = FID;

   3145  5 000141   040100 100400                    MLR     fill='040'O
         5 000142   000001 000144 3                  ADSC9   FID                      cn=0,n=100
         5 000143   200036 200144                    ADSC9   TEXTC_FID,,AUTO          cn=1,n=100

      112     3146    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_FID);

   3146  5 000144   000003 235000 6                  LDA     3
         5 000145   200070 452500                    STP2    TEXTC_FID+26,,AUTO
         5 000146   200070 236100                    LDQ     TEXTC_FID+26,,AUTO
         5 000147   000036 036003                    ADLQ    30,DU
         5 000150   200072 757100                    STAQ    TEXTC_FID+28,,AUTO
         5 000151   000100 100500                    MLR     fill='000'O
         5 000152   200072 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         5 000153   200021 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      113     3147    2               CALL QQC$BLDMSG(MSGBLK);

   3147  5 000154   200006 630500                    EPPR0   MSGBLK,,AUTO
         5 000155   200070 450500                    STP0    TEXTC_FID+26,,AUTO
         5 000156   200070 630500                    EPPR0   TEXTC_FID+26,,AUTO
         5 000157   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000160   000000 701000 xent               TSX1    QQC$BLDMSG
         5 000161   000000 011000                    NOP     0

      114     3148
      115     3149                  /*  We should only deactivate if the default forms
      116     3150                  program is TP$STATION.DFLT_FP ~= '*DFLT' and
      117     3151                  TP$STATION.PEND_FP = TP$STATION.DFLT_FP         */
      118     3152
      119     3153    3               IF TP$STATION.PEND_FP = TP$STATION.DFLT_FP THEN DO;

   3153  5 000162   200005 470500                    LDP0    S$,,AUTO
         5 000163   040100 106500                    CMPC    fill='040'O
         5 000164   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:26   
         5 000165   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         5 000166   000206 601000 5                  TNZ     s:3161

      120     3154    3                   FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);

   3154  5 000167   000004 235000 6                  LDA     4
         5 000170   200005 236100                    LDQ     S$,,AUTO
         5 000171   000034 757000 3                  STAQ    FPT_DEACTIVATE+2

      121     3155    4                   CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;

   3155  5 000172   000032 630400 3                  EPPR0   FPT_DEACTIVATE
         5 000173   500001 713400                    CLIMB   alt,+32769
         5 000174   401400 401760                    pmme    nvectors=4
         5 000175   000177 702000 5                  TSX2    s:3156
         5 000176   000205 710000 5                  TRA     s:3159

      122     3156    4                       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= 1154 /* E$CGANFS */
              3156                                THEN

   3156  5 000177   000000 470400 xsym               LDP0    B$TCB$
         5 000200   000000 471500                    LDP1    0,,PR0
         5 000201   100102 236100                    LDQ     66,,PR1
         5 000202   377770 376007                    ANQ     131064,DL
         5 000203   022020 116007                    CMPQ    9232,DL
         5 000204   000312 601000 5                  TNZ     MON_ERR

      123     3157    4                         GOTO MON_ERR;
      124     3158    4                     END;

      125     3159    3                 END;

   3159  5 000205   000311 710000 5                  TRA     s:3182

      126     3160    3               ELSE DO;                    /*  get user back to default program  */

      127     3161    3                   VLP_FPRG.NAME = QQ_GLOBAL.CFP_RU.NAME;
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:27   

   3161  5 000206   000000 100400                    MLR     fill='000'O
         5 000207   000357 000040 xsym               ADSC9   QQ_GLOBAL+239            cn=0,n=32
         5 000210   000210 000040 3                  ADSC9   VLP_FPRG+2               cn=0,n=32

      128     3162    3                   VLP_FPRG.ACCT# = QQ_GLOBAL.CFP_RU.ACCT;

   3162  5 000211   040000 100400                    MLR     fill='040'O
         5 000212   000367 000010 xsym               ADSC9   QQ_GLOBAL+247            cn=0,n=8
         5 000213   000220 000010 3                  ADSC9   VLP_FPRG+10              cn=0,n=8

      129     3163    3                   VLP_FPRG.PASS# = QQ_GLOBAL.CFP_RU.PASS;

   3163  5 000214   040000 100400                    MLR     fill='040'O
         5 000215   000371 000010 xsym               ADSC9   QQ_GLOBAL+249            cn=0,n=8
         5 000216   000222 000010 3                  ADSC9   VLP_FPRG+12              cn=0,n=8

      130     3164    3                   VLP_FPRG.PSN# = QQ_GLOBAL.CFP_RU.PSN;

   3164  5 000217   040000 100400                    MLR     fill='040'O
         5 000220   000373 000006 xsym               ADSC9   QQ_GLOBAL+251            cn=0,n=6
         5 000221   000206 400006 3                  ADSC9   VLP_FPRG                 cn=2,n=6

      131     3165    4                   CALL M$SETFP(FPT_SETFP) WHENALTRETURN DO;

   3165  5 000222   000172 630400 3                  EPPR0   FPT_SETFP
         5 000223   560021 713400                    CLIMB   alt,+57361
         5 000224   401400 401760                    pmme    nvectors=4
         5 000225   000227 702000 5                  TSX2    s:3166
         5 000226   000301 710000 5                  TRA     s:3179

      132     3166    4                       CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3166  5 000227   200006 630500                    EPPR0   MSGBLK,,AUTO
         5 000230   200070 450500                    STP0    TEXTC_FID+26,,AUTO
         5 000231   200070 630500                    EPPR0   TEXTC_FID+26,,AUTO
         5 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:28   
         5 000233   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 000234   000000 011000                    NOP     0

      133     3167    4                       MSGBLK.ERRINFO.ERR(0) = CODE_UTLCFP;

   3167  5 000235   000001 236000 4                  LDQ     CODE_UTLCFP
         5 000236   200014 756100                    STQ     MSGBLK+6,,AUTO

      134     3168    4                       MSGBLK.ERRINFO.ERR(1) = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3168  5 000237   000000 470400 xsym               LDP0    B$TCB$
         5 000240   000000 471500                    LDP1    0,,PR0
         5 000241   000100 100500                    MLR     fill='000'O
         5 000242   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         5 000243   200023 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      135     3169    4                       MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3169  5 000244   000002 235000 6                  LDA     2
         5 000245   200070 452500                    STP2    TEXTC_FID+26,,AUTO
         5 000246   200070 236100                    LDQ     TEXTC_FID+26,,AUTO
         5 000247   000033 036003                    ADLQ    27,DU
         5 000250   200072 757100                    STAQ    TEXTC_FID+28,,AUTO
         5 000251   000100 100500                    MLR     fill='000'O
         5 000252   200072 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         5 000253   200015 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      136     3170    4                       TEXTC_STATION.L# = 8;

   3170  5 000254   010000 236003                    LDQ     4096,DU
         5 000255   200033 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      137     3171    4                       TEXTC_STATION.NAME# = TP$STATION.ID;

   3171  5 000256   200005 471500                    LDP1    S$,,AUTO
         5 000257   040100 100500                    MLR     fill='040'O
         5 000260   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:29   
         5 000261   200033 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      138     3172    4                       CALL QQC$BLDMSG(MSGBLK);

   3172  5 000262   200006 633500                    EPPR3   MSGBLK,,AUTO
         5 000263   200070 453500                    STP3    TEXTC_FID+26,,AUTO
         5 000264   200070 630500                    EPPR0   TEXTC_FID+26,,AUTO
         5 000265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000266   000000 701000 xent               TSX1    QQC$BLDMSG
         5 000267   000000 011000                    NOP     0

      139     3173                                                /* Deactivate the Station             */
      140     3174    4                       FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);

   3174  5 000270   000004 235000 6                  LDA     4
         5 000271   200005 236100                    LDQ     S$,,AUTO
         5 000272   000034 757000 3                  STAQ    FPT_DEACTIVATE+2

      141     3175    5                       CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;

   3175  5 000273   000032 630400 3                  EPPR0   FPT_DEACTIVATE
         5 000274   500001 713400                    CLIMB   alt,+32769
         5 000275   401400 401760                    pmme    nvectors=4
         5 000276   000300 702000 5                  TSX2    s:3177
         5 000277   000300 710000 5                  TRA     s:3177

      142     3176    5                         END;

      143     3177    4                       RETURN;

   3177  5 000300   000000 702200 xent               TSX2  ! X66_ARET

      144     3178    4                     END;
      145     3179    3                   TP$STATION.FP = '*DFLT   ';

   3179  5 000301   200005 470500                    LDP0    S$,,AUTO
         5 000302   000002 237000 4                  LDAQ    CODE_UTLCFP+1
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:30   
         5 000303   000002 755100                    STA     2,,PR0
         5 000304   000003 756100                    STQ     3,,PR0

      146     3180    3                   TP$STATION.PEND_FP = ' ';

   3180  5 000305   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000306   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000307   000006 755100                    STA     6,,PR0
         5 000310   000007 756100                    STQ     7,,PR0

      147     3181    3                 END;

      148     3182    2               RETURN;

   3182  5 000311   000000 702200 xent               TSX2  ! X66_ARET

      149     3183    2   MON_ERR:
      150     3184    2               QQ_GLOBAL.ERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3184  5 000312   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         5 000313   000000 471500                    LDP1    0,,PR0
         5 000314   100102 236100                    LDQ     66,,PR1
         5 000315   000000 756000 xsym               STQ     QQ_GLOBAL

      151     3185    2               CALL QQC$SCREECH;

   3185  5 000316   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000317   000000 701000 xent               TSX1    QQC$SCREECH
         5 000320   000000 011000                    NOP     0

      152     3186    2             END;

      153     3187    1           TP$STATION.FP = TP$STATION.PEND_FP;

   3187  5 000321   200005 470500                    LDP0    S$,,AUTO
         5 000322   040100 100500                    MLR     fill='040'O
         5 000323   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:31   
         5 000324   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      154     3188    1           TP$STATION.PEND_FP = ' ';

   3188  5 000325   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000326   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000327   000006 755100                    STA     6,,PR0
         5 000330   000007 756100                    STQ     7,,PR0

      155     3189    1           RETURN;

   3189  5 000331   000000 702200 xent               TSX2  ! X66_ARET
      156     3190    1   END QQA$SETFP;

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:32   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$SETFP.
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:33   

 **** Variables and constants ****

  ****  Section 003  Data  QQA$SETFP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR(100)   r     1 FID                       32-0-0/d STRC(576)   r     1 FPT_DEACTIVATE
    52-0-0/d STRC(2088)  r     1 FPT_OPEN                 172-0-0/d STRC(432)   r     1 FPT_SETFP
   144-0-0/d STRC(792)   r     1 FPT_UNFID                  0-0-0/w UBIN        r     1 UNFID_SIZE
   206-0-0/d STRC(612)   r     1 VLP_FPRG                 242-0-0/d STRC(90)    r     1 VLP_SN
   230-0-0/w STRC(288)   r     1 VLP_STATION              240-0-0/c STRC(72)    r     1 VLP_WSN

  ****  Section 004 RoData QQA$SETFP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 CODE_UTLCFP                0-0-0/b STRC        r     1 CODE_UTLFP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @QT_FORM                   3-0-0/w PTR         r     1 @STA$
     6-0-0/w STRC(738)   r     1 MSGBLK                    *0-0-0/w STRC(828)   r     1 QT_FORM
     5-0-0/w PTR         r     1 S$                        *0-0-0/w PTR         r     1 STA$
    36-0-0/c STRC(909)   r     1 TEXTC_FID                 33-0-0/c STRC(81)    r     1 TEXTC_STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:34   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$CG                       0-0-0N  NULL        r     1 M$FPRG
     0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQA$SETFP requires 218 words for executable code.
   Procedure QQA$SETFP requires 60 words of local(AUTO) storage.

    No errors detected in file QQA$SETFP.:E05TSI    .
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:35   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:36   
          MINI XREF LISTING

B$ALT.CODE
      2485**DCL      2485--REDEF    2486--REDEF    2486--REDEF
B$ALT.ERR
      2486**DCL      3137>>ASSIGN   3168>>ASSIGN   3184>>ASSIGN
B$ALT.ERR.CODE
      2487**DCL      3156>>IF
B$ALT.ERR.ERR#
      2487**DCL      2487--REDEF
B$ALT.EVID
      2486**DCL      2486--REDEF    2486--REDEF
B$TCB.ALT$
      2481**DCL      3137>>ASSIGN   3156>>IF       3168>>ASSIGN   3184>>ASSIGN
B$TCB$
      2427**DCL      3137>>ASSIGN   3156>>IF       3168>>ASSIGN   3184>>ASSIGN
CODE_UTLCFP
      2793**DCL      3167>>ASSIGN
CODE_UTLFP
      2786**DCL      3136>>ASSIGN
ERR_OUT
      3140**LABEL    3141--CALLALT
FID
      2590**DCL      2971--DCLINIT  3145>>ASSIGN
FPT_DEACTIVATE
      2835**DCL      3155<>CALL     3175<>CALL
FPT_DEACTIVATE.STATION_
      2835**DCL      3154<<ASSIGN   3174<<ASSIGN
FPT_DEACTIVATE.V
      2836**DCL      2835--DCLINIT
FPT_DEACTIVATE.V.DVBYTE.REREAD#
      2838**DCL      2838--REDEF
FPT_OPEN
      2914**DCL      3141<>CALL
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:37   
FPT_OPEN.ACSVEH_
      2916**DCL      2917--REDEF
FPT_OPEN.ALTKEYS_
      2922**DCL      2923--REDEF    2923--REDEF
FPT_OPEN.HDR_
      2921**DCL      2922--REDEF
FPT_OPEN.TAB_
      2920**DCL      2921--REDEF
FPT_OPEN.UHL_
      2914**DCL      2915--REDEF    2915--REDEF
FPT_OPEN.V
      2923**DCL      2914--DCLINIT
FPT_OPEN.V.ASN#
      2933**DCL      2974--DCLINIT
FPT_OPEN.V.FSN#
      2954**DCL      2954--REDEF    2954--REDEF
FPT_OPEN.V.RES#
      2938**DCL      2974--DCLINIT
FPT_OPEN.WSN_
      2920**DCL      2920--REDEF
FPT_SETFP
      2987**DCL      3130<>CALL     3165<>CALL
FPT_SETFP.V
      2988**DCL      2987--DCLINIT
FPT_UNFID
      2971**DCL      3143<>CALL
FPT_UNFID.V
      2975**DCL      2971--DCLINIT
M$DEACTIVATE
       117**DCL-ENT  3155--CALL     3175--CALL
M$OPEN
        97**DCL-ENT  3141--CALL
M$SETFP
       126**DCL-ENT  3130--CALL     3165--CALL
M$UNFID
       160**DCL-ENT  3143--CALL
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:38   
MON_ERR
      3184**LABEL    3143--CALLALT  3157--GOTO
MSGBLK
      2617**DCL      3131<>CALL     3147<>CALL     3166<>CALL     3172<>CALL
MSGBLK.ERRINFO.ERR
      2695**DCL      3136<<ASSIGN   3137<<ASSIGN   3167<<ASSIGN   3168<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      2699**DCL      3138<<ASSIGN   3169<<ASSIGN
MSGBLK.ERRINFO.FIELD3
      2703**DCL      3146<<ASSIGN
MSGBLK.FLAGS.DEST.STATION
      2659**DCL      3134<<ASSIGN
MSGBLK.ID
      2618**DCL      3135<<ASSIGN
QQC$BLDMSG
      2400**DCL-ENT  3147--CALL     3172--CALL
QQC$BLDMSG_ERRBLK
      2401**DCL-ENT  3131--CALL     3166--CALL
QQC$SCREECH
      2399**DCL-ENT  3185--CALL
QQ_GLOBAL.CFP_RU.ACCT
       692**DCL      3162>>ASSIGN
QQ_GLOBAL.CFP_RU.NAME
       692**DCL      3161>>ASSIGN
QQ_GLOBAL.CFP_RU.PASS
       692**DCL      3163>>ASSIGN
QQ_GLOBAL.CFP_RU.PSN
       692**DCL      3164>>ASSIGN
QQ_GLOBAL.DS1$_BITS
       614**DCL       614--REDEF
QQ_GLOBAL.DS2$_BITS
       614**DCL       615--REDEF
QQ_GLOBAL.DS3$_BITS
       615**DCL       615--REDEF
QQ_GLOBAL.DS4$_BITS
       615**DCL       616--REDEF
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:39   
QQ_GLOBAL.ERR
       604**DCL      3184<<ASSIGN
QT_FORM
      2346**DCL        29--PROC
QT_FORM.FP.ACCT
      2363**DCL      3120>>ASSIGN
QT_FORM.FP.NAME.COUNT
      2361**DCL      3119>>ASSIGN
QT_FORM.FP.NAME.TEXT
      2362**DCL      3118>>ASSIGN
QT_FORM.FP.PASS
      2365**DCL      3121>>ASSIGN
QT_FORM.FP.SN
      2367**DCL      3122>>ASSIGN
S$
      2503**DCL      2505--IMP-PTR  3115<<ASSIGN   3116>>ASSIGN   3123>>ASSIGN   3124>>IF       3126>>ASSIGN
      3127>>ASSIGN   3132>>IF       3132>>IF       3132>>IF       3135>>ASSIGN   3140>>ASSIGN   3153>>IF
      3153>>IF       3154>>ASSIGN   3171>>ASSIGN   3174>>ASSIGN   3179>>ASSIGN   3180>>ASSIGN   3187>>ASSIGN
      3187>>ASSIGN   3188>>ASSIGN
STA$
      2334**DCL        29--PROC     3115>>ASSIGN
TEXTC_FID
      2758**DCL      3146--ASSIGN
TEXTC_FID.L#
      2758**DCL      3144<<ASSIGN
TEXTC_FID.NAME#
      2758**DCL      3145<<ASSIGN
TEXTC_STATION
      2731**DCL      3138--ASSIGN   3169--ASSIGN
TEXTC_STATION.L#
      2731**DCL      3139<<ASSIGN   3170<<ASSIGN
TEXTC_STATION.NAME#
      2731**DCL      3140<<ASSIGN   3171<<ASSIGN
TP$STATION.DFLT_FP
      2510**DCL      3132>>IF       3153>>IF
TP$STATION.FLAGS.IS_DEBUGGING
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:40   
      2545**DCL      3123<<ASSIGN   3127<<ASSIGN
TP$STATION.FLAGS.SET_DEBUG
      2543**DCL      3124>>IF       3126<<ASSIGN
TP$STATION.FP
      2508**DCL      3132>>IF       3179<<ASSIGN   3187<<ASSIGN
TP$STATION.FPLDTRC$
      2525**DCL      3132>>IF
TP$STATION.ID
      2506**DCL      3116>>ASSIGN   3135>>ASSIGN   3140>>ASSIGN   3154--ASSIGN   3171>>ASSIGN   3174--ASSIGN
TP$STATION.PEND_FP
      2512**DCL      3153>>IF       3180<<ASSIGN   3187>>ASSIGN   3188<<ASSIGN
UNFID_SIZE
      2589**DCL      2975--DCLINIT  3144>>ASSIGN
VLP_FPRG
      3027**DCL      2988--DCLINIT  3117<<ASSIGN
VLP_FPRG.ACCT#
      3033**DCL      2919--DCLINIT  2972--DCLINIT  3120<<ASSIGN   3162<<ASSIGN
VLP_FPRG.FLGS.DEBUG#
      3031**DCL      3128<<ASSIGN
VLP_FPRG.NAME
      3032**DCL      2915--DCLINIT  2972--DCLINIT  3161<<ASSIGN
VLP_FPRG.NAME.C#
      3033**DCL      3118<<ASSIGN
VLP_FPRG.NAME.L#
      3032**DCL      3119<<ASSIGN
VLP_FPRG.PASS#
      3034**DCL      2916--DCLINIT  2973--DCLINIT  3121<<ASSIGN   3163<<ASSIGN
VLP_FPRG.PSN#
      3032**DCL      3122<<ASSIGN   3164<<ASSIGN
VLP_SN
      3088**DCL      2914--DCLINIT  2973--DCLINIT
VLP_STATION
      3049**DCL      2987--DCLINIT
VLP_STATION.MSGIDXT
      3059**DCL      3062--REDEF
VLP_STATION.STATION#
PL6.E3A0      #001=QQA$SETFP File=QQA$SETFP.:E05TSI                              WED 07/30/97 05:26 Page:41   
      3053**DCL      3116<<ASSIGN
VLP_WSN
      3075**DCL      2973--DCLINIT
