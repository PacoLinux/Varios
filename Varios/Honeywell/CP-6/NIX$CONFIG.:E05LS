VERSION E05

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:1    
        1        1        /*M* NIX$CONFIG - Updates the config table of AARDVARK's devices */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*T*/
        8        8        /*X* DMR */
        9        9        /*P*
       10       10              NAME:  NIX$CONFIG
       11       11              PURPOSE:  Contains routines necessary for changing AARDVARK's list
       12       12                        of current devices in IT_CONFIG.  After the list is updated,
       13       13                        AARDVARK is called to update its tables.
       14       14        */
       15       15
       16       16        NIX$CHANCONFIG: PROC ( PAR, RESULTS, NEWLA ) ;
       17       17
       18       18        /*F*  NAME:  NIX$CHANCONFIG
       19       19              CALL:  CALL NIX$CHANCONFIG ( DQH, RESULTS, NEWLA ) ;
       20       20              ENVIRONMENT:
       21       21              INPUT:  PAR - DQH
       22       22                      RESULTS - VLR_SYSCON structure that returns the CODE,
       23       23                                and old and new IOM and channel numbers.
       24       24                      NEWLA - Flag indicating that the new channel should be
       25       25                              on a different physical channel (LA).
       26       26              DESCRIPTION:
       27       27                 This routine checks to see if the channel that was just
       28       28                 partitioned is one of AARDVARK's boot channels that must
       29       29                 be changed.  AARDVARK's boot channels that must be changed
       30       30                 are the system disk path (for disk boots, recovery, etc.)
       31       31                 and the unit record controller path (for loading firmware
       32       32                 during a boot).  (The tape channel and FEP channels are
       33       33                 only used during a boot (and no other time), so AARDVARK
       34       34                 is not rewritten if these channels are partitioned.)
       35       35
       36       36                 If the channel that was just partitioned is one of these
       37       37                 paths, then OLD is set, and the current boot-time component
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:2    
       38       38                 values are stored in RESULTS.
       39       39
       40       40                 If an alternate is found, AARDVARK is rewritten to disk with
       41       41                 the new values, NEW is set, and the new boot-time component
       42       42                 values are stored in RESULTS.
       43       43
       44       44                 If an alternate is not found, AARDVARK is not rewritten to disk,
       45       45                 and NEW is not set.
       46       46
       47       47                 If an error occurs in rewriting AARDVARK to the system disk,
       48       48                 DP#CP-6's may be corrupt!!!   A Reconfiguration (MXT) boot
       49       49                 needs to be done ASAP.   In this case, AARDVARK has not been
       50       50                 successfully rewritten to the system disk, and ERR is set.
       51       51
       52       52        */
       53       53
       54       54        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:3    
       55       55        /*
       56       56                Includes
       57       57        */
       58       58        %INCLUDE                HF_LOCK_C ;
       59       72        %INCLUDE                IT$CONFIG ;
       60      141        %INCLUDE                NI_DATA_C ;
       61      254        %INCLUDE                NI_DATA_R ;
       62      691        %INCLUDE                NI_MACROS_C ;
       63      958        %INCLUDE                OC_SUBS_C ;
       64     1689        %INCLUDE                SS_SCHED_C ;
       65     1922        %INCLUDE                TD$CP6V_C ;
       66     1958        %INCLUDE                TD_ERRORS_C ;
       67     2041        /*
       68     2042                Parameters
       69     2043        */
       70     2044    1   DCL 1 NEWLA             BIT(1) ALIGNED PARAM ;
       71     2045    1   DCL 1 PAR               PTR ALIGNED PARAM ;
       72     2046        %VLR$SYSCON_V           ( FPTN = RESULTS, BASED = PARAM ) ;
       73     2051        /*
       74     2052                Entries
       75     2053        */
       76     2054    1   DCL 1 NIM$CHNGAARD      ENTRY ALTRET ;
       77     2055    1   DCL 1 NIW$MPCSTART      ENTRY(1)  ;
       78     2056    1   DCL 1 NIW$MPCSTOP       ENTRY(1)  ;
       79     2057    1   DCL 1 OCI$MK_WRTM       ENTRY(8)  ;
       80     2058    1   DCL 1 SSR$REG           ENTRY(3) ALTRET  ;
       81     2059        /*
       82     2060                Based
       83     2061        */
       84     2062        %NI$CHT                 ( NAME="CHT(0:%(N_MAXCHANS-1))", STCLASS="BASED(NI$CHT$)" )
              2062            ;
       85     2065        %NI$CONNECT             ( NAME=NI$CONNECT,     STCLASS="BASED(NI$CONNECT$)" ) ;
       86     2077        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
       87     2100        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
       88     2148        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)") ;
       89     2161        /*
       90     2162                Symrefs
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:4    
       91     2163        */
       92     2164    1   DCL 1 B_SCDCTX          UBIN SYMREF;
       93     2165        %IT$CONFIG              ( NAME=IT_CONFIG, STCLASS=SYMREF ) ;
       94     2226    1   DCL 1 IT_SYSDISK        UBIN WORD SYMREF ;
       95     2227    1   DCL 1 NK_MXLOCAL        UBIN(36) SYMREF;
       96     2228    1   DCL 1 S_TIMR            UBIN WORD SYMREF ;
       97     2229        /*
       98     2230                Auto
       99     2231        */
      100     2232    1   DCL 1 DCT$              PTR ALIGNED AUTO;
      101     2233    1   DCL 1 DEVDCT$           PTR ALIGNED AUTO;
      102     2234    1   DCL 1 DQH$              PTR ALIGNED AUTO;
      103     2235    1   DCL 1 MPCDCT$           PTR ALIGNED AUTO;
      104     2236    1   DCL 1 SQH$              PTR ALIGNED AUTO;
      105     2237    1   DCL 1 I                 UBIN ALIGNED AUTO;
      106     2238    1   DCL 1 J                 UBIN ALIGNED AUTO;
      107     2239    1   DCL 1 CHANENTRY         BIT(1) ALIGNED AUTO;
      108     2240    1   DCL 1 IOCHANX           UBIN(9) CALIGNED AUTO;
      109     2241    1   DCL 1 IOCHAN            REDEF IOCHANX,
      110     2242    1         2 IOM             UBIN(2) UNAL,
      111     2243    1         2 CHANNEL         UBIN(7) UNAL ;
      112     2244        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:5    
      113     2245    1           RESULTS.BOOTINFO = '0'B ;
      114     2246
      115     2247    1           IF S_TIMR = 2 THEN
      116     2248    1              RETURN ;
      117     2249    2           ELSE DO ;
      118     2250    2              CHANENTRY = '1'B ;
      119     2251    2              DQH$ = ADDR(PAR) ;
      120     2252    2              SQH$ = DQH.SQH$ ;
      121     2253    2              GOTO COMMON_CONFIG ;
      122     2254    2              END ;
      123     2255
      124     2256        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:6    
      125     2257    1   NIX$DEVCONFIG: ENTRY ( PAR, RESULTS ) ;
      126     2258        /*D*  NAME:  NIX$DEVCONFIG
      127     2259              CALL:  CALL NIX$DEVCONFIG ( DCT, RESULTS ) ;
      128     2260              ENVIRONMENT:
      129     2261              INPUT:  PAR - DCT
      130     2262                      RESULTS - VLR_SYSCON structure that returns the CODE,
      131     2263                                and old and new IOM and channel numbers.
      132     2264              DESCRIPTION:
      133     2265                 This routine checks to see if the device that was just
      134     2266                 partitioned is one of AARDVARK's devices that must be
      135     2267                 changed.  AARDVARK's devices that must be changed are the
      136     2268                 system console (used by XDELTA, recovery, etc.), the line
      137     2269                 printer (used by XDELTA), and the card reader (used by
      138     2270                 XDELTA).
      139     2271
      140     2272                 If the device that was just partitioned is one of these
      141     2273                 devices, then OLD is set, and the current boot-time component
      142     2274                 values are stored in RESULTS.
      143     2275
      144     2276                 If an alternate is found, AARDVARK is rewritten to disk with
      145     2277                 the new values, NEW is set, and the new boot-time component
      146     2278                 values are stored in RESULTS.
      147     2279
      148     2280                 If an alternate is not found, AARDVARK is not rewritten to disk,
      149     2281                 and NEW is not set.
      150     2282
      151     2283                 If an error occurs in rewriting AARDVARK to the system disk,
      152     2284                 DP#CP-6's may be corrupt!!!   A Reconfiguration (MXT) boot
      153     2285                 needs to be done ASAP.   In this case, AARDVARK has not been
      154     2286                 successfully rewritten to the system disk, and ERR is set.
      155     2287        */
      156     2288
      157     2289        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:7    
      158     2290    1           RESULTS.BOOTINFO = '0'B ;
      159     2291
      160     2292    1           IF S_TIMR = 2 THEN
      161     2293    1              RETURN ;
      162     2294    2           ELSE DO ;
      163     2295    2              CHANENTRY = '0'B ;
      164     2296    2              DCT$ = ADDR(PAR) ;
      165     2297    2              DQH$ = DCT.DQH$ ;
      166     2298    2              SQH$ = DCT.DQH$ ;
      167     2299    2              END ;
      168     2300
      169     2301        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:8    
      170     2302    1   COMMON_CONFIG:
      171     2303
      172     2304        %LOCK (G#=IT_CONFIG.GATE) ;
      173     2307
      174     2308        /*N*  This could be replaced by a new SQR scheduler queue.  */
      175     2309    2           DO WHILE NI_CHANCONFIG ;
      176     2310                   %UNLOCK ( G#=IT_CONFIG.GATE ) ;
      177     2313    2              CALL SSR$REG ( %SS_SL, , 1 ) ;
      178     2314                   %LOCK ( G#=IT_CONFIG.GATE ) ;
      179     2317    2              END ;
      180     2318
      181     2319    1           NI_CHANCONFIG = '1'B ;
      182     2320
      183     2321    1           IF CHANENTRY THEN CALL CHANCONFIG ALTRET ( ALT ) ;
      184     2322    1           ELSE CALL DEVCONFIG  ALTRET ( ALT ) ;
      185     2323
      186     2324        %UNLOCK ( G#=IT_CONFIG.GATE ) ;
      187     2327
      188     2328    1           IF RESULTS.BOOTINFO.NEW THEN
      189     2329    1              CALL WRITECONFIG ;
      190     2330
      191     2331        %LOCK   ( G#=IT_CONFIG.GATE ) ;
      192     2334    1   ALT:    NI_CHANCONFIG = '0'B ;
      193     2335        %UNLOCK ( G#=IT_CONFIG.GATE ) ;
      194     2338
      195     2339    1           RETURN ;
      196     2340        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:9    
      197     2341    1   CHANCONFIG: PROC ALTRET ;
      198     2342
      199     2343    2           IF ( DQH.IOCHAN.IOM = IT_CONFIG.DC01.IOM ) AND
      200     2344    3             ( DQH.IOCHAN.CHANNEL = IT_CONFIG.DC01.CHAN ) THEN DO ;
      201     2345    3              RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.DC01.IOM ;
      202     2346    3              RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.DC01.CHAN ;
      203     2347    3              RESULTS.BOOTINFO.OLD = '1'B ;
      204     2348    3              CALL FINDALTPATH     ALTRET ( ALT ) ;
      205     2349    3              IT_CONFIG.DC01.IOM   = IOCHAN.IOM ;
      206     2350    3              IT_CONFIG.DC01.CHAN  = IOCHAN.CHANNEL ;
      207     2351    3              IT_CONFIG.DC01.FWNAME = MPCDCT$->DCT.MPC.FWNAME ;
      208     2352    3              RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;
      209     2353    3              RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;
      210     2354    3              RESULTS.BOOTINFO.NEW = '1'B ;
      211     2355    3              END ;
      212     2356
      213     2357    2           ELSE IF ( DQH.IOCHAN.IOM = IT_CONFIG.UC01.IOM ) AND
      214     2358    3                ( DQH.IOCHAN.CHANNEL = IT_CONFIG.UC01.CHAN ) THEN DO ;
      215     2359    3                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.UC01.IOM ;
      216     2360    3                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.UC01.CHAN ;
      217     2361    3                 RESULTS.BOOTINFO.OLD = '1'B ;
      218     2362    3                 CALL FINDALTPATH  ALTRET ( ALT ) ;
      219     2363    3                 IT_CONFIG.UC01.IOM = IOCHAN.IOM ;
      220     2364    3                 IT_CONFIG.UC01.CHAN = IOCHAN.CHANNEL ;
      221     2365    3                 IT_CONFIG.UC01.FWNAME = MPCDCT$->DCT.MPC.FWNAME ;
      222     2366    3                 IT_CONFIG.UC01.LPNAME = MPCDCT$->DCT.MPC.LPNAME ;
      223     2367    3                 IT_CONFIG.UC01.CRPNAME = MPCDCT$->DCT.MPC.CRPNAME ;
      224     2368    3                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;
      225     2369    3                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;
      226     2370    3                 RESULTS.BOOTINFO.NEW = '1'B ;
      227     2371    3                 END ;
      228     2372
      229     2373    2              ELSE ;
              2373                     /* This is not one of AARDVARK's channels which need to be changed.  */
      230     2374
      231     2375    2   RET:    RETURN ;
      232     2376
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:10   
      233     2377    2   ALT:    ALTRETURN ;
      234     2378
      235     2379    2   END CHANCONFIG ;
      236     2380        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:11   
      237     2381    1   DEVCONFIG: PROC ALTRET ;
      238     2382
      239     2383    3           DO CASE (DCT.TYPE) ;
      240     2384
      241     2385    3            CASE (%DV_SC) ;
      242     2386    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.SC01.IOM ) AND
      243     2387    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.SC01.CHAN ) THEN DO ;
      244     2388    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.SC01.IOM ;
      245     2389    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.SC01.CHAN ;
      246     2390    4                 RESULTS.BOOTINFO.OLD  = '1'B ;
      247     2391    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;
      248     2392    4                 IT_CONFIG.SC01.IOM    = IOCHAN.IOM ;
      249     2393    4                 IT_CONFIG.SC01.CHAN   = IOCHAN.CHANNEL ;
      250     2394    4                 B_SCDCTX              = DEVDCT$->DCT.DCTX ;
      251     2395    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;
      252     2396    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;
      253     2397    4                 RESULTS.BOOTINFO.NEW  = '1'B ;
      254     2398    4                 END ;
      255     2399
      256     2400    3            CASE (%DV_LP) ;
      257     2401    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.LP01.IOM ) AND
      258     2402    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.LP01.CHAN ) THEN DO ;
      259     2403    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.LP01.IOM ;
      260     2404    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.LP01.CHAN ;
      261     2405    4                 RESULTS.BOOTINFO.OLD  = '1'B ;
      262     2406    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;
      263     2407    4                 IT_CONFIG.LP01.IOM    = IOCHAN.IOM ;
      264     2408    4                 IT_CONFIG.LP01.CHAN   = IOCHAN.CHANNEL ;
      265     2409    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;
      266     2410    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;
      267     2411    4                 RESULTS.BOOTINFO.NEW  = '1'B ;
      268     2412    4                 END ;
      269     2413
      270     2414    3            CASE (%DV_CR) ;
      271     2415    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.CR01.IOM ) AND
      272     2416    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.CR01.CHAN ) THEN DO ;
      273     2417    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.CR01.IOM ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:12   
      274     2418    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.CR01.CHAN ;
      275     2419    4                 RESULTS.BOOTINFO.OLD  = '1'B ;
      276     2420    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;
      277     2421    4                 IT_CONFIG.CR01.IOM    = IOCHAN.IOM ;
      278     2422    4                 IT_CONFIG.CR01.CHAN   = IOCHAN.CHANNEL ;
      279     2423    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;
      280     2424    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;
      281     2425    4                 RESULTS.BOOTINFO.NEW  = '1'B ;
      282     2426    4                 END ;
      283     2427
      284     2428    3            CASE ( ELSE ) ;
      285     2429    3            END ;
      286     2430
      287     2431    2   RET:    RETURN ;
      288     2432
      289     2433    2   ALT:    ALTRETURN ;
      290     2434
      291     2435    2   END DEVCONFIG ;
      292     2436        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:13   
      293     2437    1   FINDALTDEV: PROC ALTRET ;
      294     2438
      295     2439    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      296     2440
      297     2441    3           DO I = 1 TO NK_MXLOCAL ;
      298     2442    4              IF ( N$DCT$(I) ~= ADDR(NIL) ) THEN DO ;
      299     2443    4                 IF ( N$DCT$(I)->DCT.TYPE = DCT.TYPE ) AND
      300     2444    5                   NOT N$DCT$(I)->DCT.STATUS.DOWN THEN DO ;
      301     2445    5                    DEVDCT$ = N$DCT$(I) ;
      302     2446    5                    IOCHANX = DEVDCT$->DCT.DQH$->DQH.IOCHANX ;
      303     2447    5                    RETURN ;
      304     2448    5                    END ;
      305     2449    4                 END ;
      306     2450    3              END ;
      307     2451
      308     2452    2           ALTRETURN ;
      309     2453
      310     2454    2   END FINDALTDEV ;
      311     2455        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:14   
      312     2456    1   FINDALTPATH: PROC ALTRET ;
      313     2457
      314     2458    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      315     2459    2   DCL 1 J                 SBIN WORD ALIGNED AUTO ;
      316     2460    2   DCL 1 K                 SBIN WORD ALIGNED AUTO ;
      317     2461    2   DCL 1 KEND              SBIN WORD ALIGNED AUTO ;
      318     2462    2   DCL 1 SAMELA            BIT(1) ALIGNED AUTO ;
      319     2463
      320     2464    2           IF NEWLA THEN KEND = 1 ;
      321     2465    2           ELSE KEND = 0 ;
      322     2466
      323     2467    2           SAMELA = ~NEWLA ;
      324     2468
      325     2469    3           DO K = 0 TO KEND ;
      326     2470    4              DO I = 0 TO 1 ;
      327     2471    5                 IF SQH.MPC$(I) ~= ADDR(NIL) THEN DO ;
      328     2472    6                    DO J = 0 TO %N_CHANSPERMPC-1 ;
      329     2473    6                       IOCHANX = SQH.MPC$(I)->DCT.MPC.IOCHANX(J) ;
      330     2474    6                       IF ( IOCHANX ~= 0 )       AND
      331     2475    6                         ( IOCHANX ~= DQH.IOCHANX ) THEN
      332     2476    6                          IF NOT CHT.DQH$(IOCHANX)->DQH.STATUS.DOWN AND
      333     2477    6                            ( SAMELA OR
      334     2478    6                            CHT.DQH$(IOCHANX)->DQH.LA ~= DQH.LA OR
      335     2479    7                            CHT.DQH$(IOCHANX)->DQH.MPC$ ~= DQH.MPC$ ) THEN DO ;
      336     2480    7                             MPCDCT$ = SQH.MPC$(I) ;
      337     2481    7                             RETURN ;
      338     2482    7                             END ;
      339     2483    6                       END ;
      340     2484    5                    END ;
      341     2485    4                 END ;
      342     2486    3              SAMELA = ~SAMELA ;
      343     2487    3              END ;
      344     2488
      345     2489    2           ALTRETURN ;
      346     2490
      347     2491    2   END FINDALTPATH ;
      348     2492        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:15   
      349     2493    1   WRITECONFIG: PROC ;
      350     2494
      351     2495        %NI$SQH (NAME=SYSSQH,STCLASS="BASED(SYSSQH$)") ;
      352     2508
      353     2509    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      354     2510    2   DCL 1 SYSDCT$           PTR ALIGNED AUTO ;
      355     2511    2   DCL 1 SYSSQH$           PTR ALIGNED AUTO ;
      356     2512
      357     2513    2           SYSDCT$ = N$DCT$(IT_SYSDISK) ;
      358     2514    2           SYSSQH$ = SYSDCT$->DCT.SQH$ ;
      359     2515
      360     2516    3           DO I = 0 TO 1 ;
      361     2517    3              IF SYSSQH.MPC$(I) ~= ADDR(NIL) AND
      362     2518    4                NOT SYSSQH.MPC$(I)->DCT.STATUS.DOWN THEN DO ;
      363     2519    4                 SYSSQH.MPC$(I)->DCT.DFLG.RELOAD = '0'B ; /* Dont reload FW */
      364     2520    4                 CALL NIW$MPCSTOP ( SYSSQH.MPC$(I)->DCT ) ;
      365     2521    5                 DO WHILE NOT SYSSQH.MPC$(I)->DCT.DFLG.MPCSTOP ;
      366     2522    5                    CALL SSR$REG ( %SS_SL, , 1 ) ;
      367     2523    5                    END ;
      368     2524    4                 END ;
      369     2525    3              END ;
      370     2526
      371     2527                %LOCK ( G#=NI$CONNECT.GATE ) ;
      372     2530    2           CALL NIM$CHNGAARD
      373     2531    3           WHENALTRETURN DO ;
      374     2532    3              RESULTS.BOOTINFO.ERR = '1'B ;
      375     2533    3              END ;
      376     2534                %UNLOCK ( G#=NI$CONNECT.GATE ) ;
      377     2537    2           IF RESULTS.BOOTINFO.ERR THEN
      378     2538    2              CALL OCI$MK_WRTM ( M_DEVC, CHNGAARD_MSG#, 0, '000'O, '000'O,
      379     2539    2                IT_SYSDISK, /* WSN */, SYSDCT$->DCT.MSG# ) ;
      380     2540
      381     2541    3           DO I = 0 TO 1 ;
      382     2542    3              IF SYSSQH.MPC$(I) ~= ADDR(NIL) AND
      383     2543    3                NOT SYSSQH.MPC$(I)->DCT.STATUS.DOWN THEN
      384     2544    3                 CALL NIW$MPCSTART ( SYSSQH.MPC$(I)->DCT ) ;
      385     2545    3              END ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:16   
      386     2546
      387     2547    2           RETURN ;
      388     2548
      389     2549    2   END WRITECONFIG ;
      390     2550    1   END NIX$CHANCONFIG;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:17   
--  Include file information  --

   TD_ERRORS_C.:E05TOU  is referenced.
   TD$CP6V_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IT$CONFIG.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIX$CHANCONFIG.

   Procedure NIX$CHANCONFIG requires 574 words for executable code.
   Procedure NIX$CHANCONFIG requires 32 words of local(AUTO) storage.

    No errors detected in file NIX$CONFIG.:E05TSI    .

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:18   

 Object Unit name= NIX$CHANCONFIG                             File name= NIX$CONFIG.:E05TOU
 UTS= JUL 30 '97 03:41:14.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   574   1076  NIX$CHANCONFIG
    1  RoData even  none    14     16  NIX$CHANCONFIG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        3  NIX$CHANCONFIG
     0     22                  yes      Std        2  NIX$DEVCONFIG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
         yes           Std       1 NIW$MPCSTOP
         yes           Std       8 OCI$MK_WRTM
         yes           Std       1 NIW$MPCSTART
 yes     yes           Std       0 NIM$CHNGAARD
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$CHT$
     NI$CONNECT$                           NI$FQ$                                NI$IBUF$
     NI$RP$                                NI_CHANCONFIG                         B_SCDCTX
     IT_CONFIG                             IT_SYSDISK                            NK_MXLOCAL
     S_TIMR                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:20   


        1        1        /*M* NIX$CONFIG - Updates the config table of AARDVARK's devices */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*T*/
        8        8        /*X* DMR */
        9        9        /*P*
       10       10              NAME:  NIX$CONFIG
       11       11              PURPOSE:  Contains routines necessary for changing AARDVARK's list
       12       12                        of current devices in IT_CONFIG.  After the list is updated,
       13       13                        AARDVARK is called to update its tables.
       14       14        */
       15       15
       16       16        NIX$CHANCONFIG: PROC ( PAR, RESULTS, NEWLA ) ;

     16  0 000000   000000 700200 xent  NIX$CHANCON* TSX0  ! X66_AUTO_3
         0 000001   000040 000003                    ZERO    32,3

       17       17
       18       18        /*F*  NAME:  NIX$CHANCONFIG
       19       19              CALL:  CALL NIX$CHANCONFIG ( DQH, RESULTS, NEWLA ) ;
       20       20              ENVIRONMENT:
       21       21              INPUT:  PAR - DQH
       22       22                      RESULTS - VLR_SYSCON structure that returns the CODE,
       23       23                                and old and new IOM and channel numbers.
       24       24                      NEWLA - Flag indicating that the new channel should be
       25       25                              on a different physical channel (LA).
       26       26              DESCRIPTION:
       27       27                 This routine checks to see if the channel that was just
       28       28                 partitioned is one of AARDVARK's boot channels that must
       29       29                 be changed.  AARDVARK's boot channels that must be changed
       30       30                 are the system disk path (for disk boots, recovery, etc.)
       31       31                 and the unit record controller path (for loading firmware
       32       32                 during a boot).  (The tape channel and FEP channels are
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:21   
       33       33                 only used during a boot (and no other time), so AARDVARK
       34       34                 is not rewritten if these channels are partitioned.)
       35       35
       36       36                 If the channel that was just partitioned is one of these
       37       37                 paths, then OLD is set, and the current boot-time component
       38       38                 values are stored in RESULTS.
       39       39
       40       40                 If an alternate is found, AARDVARK is rewritten to disk with
       41       41                 the new values, NEW is set, and the new boot-time component
       42       42                 values are stored in RESULTS.
       43       43
       44       44                 If an alternate is not found, AARDVARK is not rewritten to disk,
       45       45                 and NEW is not set.
       46       46
       47       47                 If an error occurs in rewriting AARDVARK to the system disk,
       48       48                 DP#CP-6's may be corrupt!!!   A Reconfiguration (MXT) boot
       49       49                 needs to be done ASAP.   In this case, AARDVARK has not been
       50       50                 successfully rewritten to the system disk, and ERR is set.
       51       51
       52       52        */
       53       53
       54       54        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:22   
       55       55        /*
       56       56                Includes
       57       57        */
       58       58        %INCLUDE                HF_LOCK_C ;
       59       72        %INCLUDE                IT$CONFIG ;
       60      141        %INCLUDE                NI_DATA_C ;
       61      254        %INCLUDE                NI_DATA_R ;
       62      691        %INCLUDE                NI_MACROS_C ;
       63      958        %INCLUDE                OC_SUBS_C ;
       64     1689        %INCLUDE                SS_SCHED_C ;
       65     1922        %INCLUDE                TD$CP6V_C ;
       66     1958        %INCLUDE                TD_ERRORS_C ;
       67     2041        /*
       68     2042                Parameters
       69     2043        */
       70     2044    1   DCL 1 NEWLA             BIT(1) ALIGNED PARAM ;
       71     2045    1   DCL 1 PAR               PTR ALIGNED PARAM ;
       72     2046        %VLR$SYSCON_V           ( FPTN = RESULTS, BASED = PARAM ) ;
       73     2051        /*
       74     2052                Entries
       75     2053        */
       76     2054    1   DCL 1 NIM$CHNGAARD      ENTRY ALTRET ;
       77     2055    1   DCL 1 NIW$MPCSTART      ENTRY(1)  ;
       78     2056    1   DCL 1 NIW$MPCSTOP       ENTRY(1)  ;
       79     2057    1   DCL 1 OCI$MK_WRTM       ENTRY(8)  ;
       80     2058    1   DCL 1 SSR$REG           ENTRY(3) ALTRET  ;
       81     2059        /*
       82     2060                Based
       83     2061        */
       84     2062        %NI$CHT                 ( NAME="CHT(0:%(N_MAXCHANS-1))", STCLASS="BASED(NI$CHT$)" )
              2062            ;
       85     2065        %NI$CONNECT             ( NAME=NI$CONNECT,     STCLASS="BASED(NI$CONNECT$)" ) ;
       86     2077        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
       87     2100        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
       88     2148        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)") ;
       89     2161        /*
       90     2162                Symrefs
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:23   
       91     2163        */
       92     2164    1   DCL 1 B_SCDCTX          UBIN SYMREF;
       93     2165        %IT$CONFIG              ( NAME=IT_CONFIG, STCLASS=SYMREF ) ;
       94     2226    1   DCL 1 IT_SYSDISK        UBIN WORD SYMREF ;
       95     2227    1   DCL 1 NK_MXLOCAL        UBIN(36) SYMREF;
       96     2228    1   DCL 1 S_TIMR            UBIN WORD SYMREF ;
       97     2229        /*
       98     2230                Auto
       99     2231        */
      100     2232    1   DCL 1 DCT$              PTR ALIGNED AUTO;
      101     2233    1   DCL 1 DEVDCT$           PTR ALIGNED AUTO;
      102     2234    1   DCL 1 DQH$              PTR ALIGNED AUTO;
      103     2235    1   DCL 1 MPCDCT$           PTR ALIGNED AUTO;
      104     2236    1   DCL 1 SQH$              PTR ALIGNED AUTO;
      105     2237    1   DCL 1 I                 UBIN ALIGNED AUTO;
      106     2238    1   DCL 1 J                 UBIN ALIGNED AUTO;
      107     2239    1   DCL 1 CHANENTRY         BIT(1) ALIGNED AUTO;
      108     2240    1   DCL 1 IOCHANX           UBIN(9) CALIGNED AUTO;
      109     2241    1   DCL 1 IOCHAN            REDEF IOCHANX,
      110     2242    1         2 IOM             UBIN(2) UNAL,
      111     2243    1         2 CHANNEL         UBIN(7) UNAL ;
      112     2244        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:24   
      113     2245    1           RESULTS.BOOTINFO = '0'B ;

   2245  0 000002   200004 470500                    LDP0    @RESULTS,,AUTO
         0 000003   000100 100400                    MLR     fill='000'O
         0 000004   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000005   000000 600005                    ADSC9   0,,PR0                   cn=3,n=5

      114     2246
      115     2247    1           IF S_TIMR = 2 THEN

   2247  0 000006   000000 235000 xsym               LDA     S_TIMR
         0 000007   000002 115007                    CMPA    2,DL
         0 000010   000012 601000 0                  TNZ     s:2250

      116     2248    1              RETURN ;

   2248  0 000011   000000 702200 xent               TSX2  ! X66_ARET

      117     2249    2           ELSE DO ;

      118     2250    2              CHANENTRY = '1'B ;

   2250  0 000012   400000 236003                    LDQ     -131072,DU
         0 000013   200015 756100                    STQ     CHANENTRY,,AUTO

      119     2251    2              DQH$ = ADDR(PAR) ;

   2251  0 000014   200003 236100                    LDQ     @PAR,,AUTO
         0 000015   200010 756100                    STQ     DQH$,,AUTO

      120     2252    2              SQH$ = DQH.SQH$ ;

   2252  0 000016   200010 471500                    LDP1    DQH$,,AUTO
         0 000017   100013 236100                    LDQ     11,,PR1
         0 000020   200012 756100                    STQ     SQH$,,AUTO

      121     2253    2              GOTO COMMON_CONFIG ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:25   

   2253  0 000021   000043 710000 0                  TRA     COMMON_CONFIG

      122     2254    2              END ;
      123     2255
      124     2256        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:26   
      125     2257    1   NIX$DEVCONFIG: ENTRY ( PAR, RESULTS ) ;

   2257  0 000022   000000 700200 xent  NIX$DEVCONF* TSX0  ! X66_AUTO_3
         0 000023   000040 000003                    ZERO    32,3

      126     2258        /*D*  NAME:  NIX$DEVCONFIG
      127     2259              CALL:  CALL NIX$DEVCONFIG ( DCT, RESULTS ) ;
      128     2260              ENVIRONMENT:
      129     2261              INPUT:  PAR - DCT
      130     2262                      RESULTS - VLR_SYSCON structure that returns the CODE,
      131     2263                                and old and new IOM and channel numbers.
      132     2264              DESCRIPTION:
      133     2265                 This routine checks to see if the device that was just
      134     2266                 partitioned is one of AARDVARK's devices that must be
      135     2267                 changed.  AARDVARK's devices that must be changed are the
      136     2268                 system console (used by XDELTA, recovery, etc.), the line
      137     2269                 printer (used by XDELTA), and the card reader (used by
      138     2270                 XDELTA).
      139     2271
      140     2272                 If the device that was just partitioned is one of these
      141     2273                 devices, then OLD is set, and the current boot-time component
      142     2274                 values are stored in RESULTS.
      143     2275
      144     2276                 If an alternate is found, AARDVARK is rewritten to disk with
      145     2277                 the new values, NEW is set, and the new boot-time component
      146     2278                 values are stored in RESULTS.
      147     2279
      148     2280                 If an alternate is not found, AARDVARK is not rewritten to disk,
      149     2281                 and NEW is not set.
      150     2282
      151     2283                 If an error occurs in rewriting AARDVARK to the system disk,
      152     2284                 DP#CP-6's may be corrupt!!!   A Reconfiguration (MXT) boot
      153     2285                 needs to be done ASAP.   In this case, AARDVARK has not been
      154     2286                 successfully rewritten to the system disk, and ERR is set.
      155     2287        */
      156     2288
      157     2289        %EJECT;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:27   
      158     2290    1           RESULTS.BOOTINFO = '0'B ;

   2290  0 000024   200004 470500                    LDP0    @RESULTS,,AUTO
         0 000025   000100 100400                    MLR     fill='000'O
         0 000026   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000027   000000 600005                    ADSC9   0,,PR0                   cn=3,n=5

      159     2291
      160     2292    1           IF S_TIMR = 2 THEN

   2292  0 000030   000000 235000 xsym               LDA     S_TIMR
         0 000031   000002 115007                    CMPA    2,DL
         0 000032   000034 601000 0                  TNZ     s:2295

      161     2293    1              RETURN ;

   2293  0 000033   000000 702200 xent               TSX2  ! X66_ARET

      162     2294    2           ELSE DO ;

      163     2295    2              CHANENTRY = '0'B ;

   2295  0 000034   200015 450100                    STZ     CHANENTRY,,AUTO

      164     2296    2              DCT$ = ADDR(PAR) ;

   2296  0 000035   200003 236100                    LDQ     @PAR,,AUTO
         0 000036   200006 756100                    STQ     DCT$,,AUTO

      165     2297    2              DQH$ = DCT.DQH$ ;

   2297  0 000037   200006 471500                    LDP1    DCT$,,AUTO
         0 000040   100023 236100                    LDQ     19,,PR1
         0 000041   200010 756100                    STQ     DQH$,,AUTO

      166     2298    2              SQH$ = DCT.DQH$ ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:28   
   2298  0 000042   200012 756100                    STQ     SQH$,,AUTO

      167     2299    2              END ;

      168     2300
      169     2301        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:29   
      170     2302    1   COMMON_CONFIG:
      171     2303
      172     2304        %LOCK (G#=IT_CONFIG.GATE) ;

   2305  0 000043   000000 630400 1     COMMON_CONF* EPPR0   0
         0 000044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000045   000000 701000 xent               TSX1    HFC$LOCK
         0 000046   000000 011000                    NOP     0

      173     2307
      174     2308        /*N*  This could be replaced by a new SQR scheduler queue.  */
      175     2309    2           DO WHILE NI_CHANCONFIG ;

   2309  0 000047   000000 234000 xsym               SZN     NI_CHANCONFIG
         0 000050   000074 605000 0                  TPL     s:2319

      176     2310                   %UNLOCK ( G#=IT_CONFIG.GATE ) ;

   2311  0 000051   000000 630400 1                  EPPR0   0
         0 000052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000053   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000054   000000 011000                    NOP     0

      177     2313    2              CALL SSR$REG ( %SS_SL, , 1 ) ;

   2313  0 000055   000002 236000 1                  LDQ     2
         0 000056   200032 756100                    STQ     SAMELA+3,,AUTO
         0 000057   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000060   000003 235000 1                  LDA     3
         0 000061   200030 757100                    STAQ    SAMELA+1,,AUTO
         0 000062   200030 630500                    EPPR0   SAMELA+1,,AUTO
         0 000063   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000064   000000 701000 xent               TSX1    SSR$REG
         0 000065   000000 011000                    NOP     0

      178     2314                   %LOCK ( G#=IT_CONFIG.GATE ) ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:30   
   2315  0 000066   000000 630400 1                  EPPR0   0
         0 000067   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000070   000000 701000 xent               TSX1    HFC$LOCK
         0 000071   000000 011000                    NOP     0

      179     2317    2              END ;

   2317  0 000072   000000 234000 xsym               SZN     NI_CHANCONFIG
         0 000073   000051 604000 0                  TMI     s:2311

      180     2318
      181     2319    1           NI_CHANCONFIG = '1'B ;

   2319  0 000074   400000 236003                    LDQ     -131072,DU
         0 000075   000000 756000 xsym               STQ     NI_CHANCONFIG

      182     2320
      183     2321    1           IF CHANENTRY THEN CALL CHANCONFIG ALTRET ( ALT ) ;

   2321  0 000076   200015 234100                    SZN     CHANENTRY,,AUTO
         0 000077   000103 605000 0                  TPL     s:2322

   2321  0 000100   000131 701000 0                  TSX1    CHANCONFIG
         0 000101   000123 702000 0                  TSX2    ALT
         0 000102   000105 710000 0                  TRA     s:2325

      184     2322    1           ELSE CALL DEVCONFIG  ALTRET ( ALT ) ;

   2322  0 000103   000304 701000 0                  TSX1    DEVCONFIG
         0 000104   000123 702000 0                  TSX2    ALT

      185     2323
      186     2324        %UNLOCK ( G#=IT_CONFIG.GATE ) ;

   2325  0 000105   000000 630400 1                  EPPR0   0
         0 000106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000107   000000 701000 xent               TSX1    HFC$UNLOCK
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:31   
         0 000110   000000 011000                    NOP     0

      187     2327
      188     2328    1           IF RESULTS.BOOTINFO.NEW THEN

   2328  0 000111   200004 470500                    LDP0    @RESULTS,,AUTO
         0 000112   000000 236100                    LDQ     0,,PR0
         0 000113   000200 316007                    CANQ    128,DL
         0 000114   000117 600000 0                  TZE     s:2332

      189     2329    1              CALL WRITECONFIG ;

   2329  0 000115   000734 701000 0                  TSX1    WRITECONFIG
         0 000116   000000 011000                    NOP     0

      190     2330
      191     2331        %LOCK   ( G#=IT_CONFIG.GATE ) ;

   2332  0 000117   000000 630400 1                  EPPR0   0
         0 000120   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000121   000000 701000 xent               TSX1    HFC$LOCK
         0 000122   000000 011000                    NOP     0

      192     2334    1   ALT:    NI_CHANCONFIG = '0'B ;

   2334  0 000123   000000 450000 xsym  ALT          STZ     NI_CHANCONFIG

      193     2335        %UNLOCK ( G#=IT_CONFIG.GATE ) ;

   2336  0 000124   000000 630400 1                  EPPR0   0
         0 000125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000126   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000127   000000 011000                    NOP     0

      194     2338
      195     2339    1           RETURN ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:32   
   2339  0 000130   000000 702200 xent               TSX2  ! X66_ARET

      196     2340        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:33   
      197     2341    1   CHANCONFIG: PROC ALTRET ;

   2341  0 000131   200020 741300       CHANCONFIG   STX1  ! IOCHANX+2,,AUTO

      198     2342
      199     2343    2           IF ( DQH.IOCHAN.IOM = IT_CONFIG.DC01.IOM ) AND

   2343  0 000132   200010 470500                    LDP0    DQH$,,AUTO
         0 000133   000001 236100                    LDQ     1,,PR0
         0 000134   000031 772000                    QRL     25
         0 000135   000003 376007                    ANQ     3,DL
         0 000136   000021 116000 xsym               CMPQ    IT_CONFIG+17
         0 000137   000214 601000 0                  TNZ     s:2357
         0 000140   000001 236100                    LDQ     1,,PR0
         0 000141   000022 772000                    QRL     18
         0 000142   000177 376007                    ANQ     127,DL
         0 000143   000022 116000 xsym               CMPQ    IT_CONFIG+18
         0 000144   000214 601000 0                  TNZ     s:2357

      200     2344    3             ( DQH.IOCHAN.CHANNEL = IT_CONFIG.DC01.CHAN ) THEN DO ;

      201     2345    3              RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.DC01.IOM ;

   2345  0 000145   200004 471500                    LDP1    @RESULTS,,AUTO
         0 000146   000021 236000 xsym               LDQ     IT_CONFIG+17
         0 000147   000042 736000                    QLS     34
         0 000150   100001 676100                    ERQ     1,,PR1
         0 000151   600000 376003                    ANQ     -65536,DU
         0 000152   100001 656100                    ERSQ    1,,PR1

      202     2346    3              RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.DC01.CHAN ;

   2346  0 000153   000022 236000 xsym               LDQ     IT_CONFIG+18
         0 000154   000033 736000                    QLS     27
         0 000155   100001 676100                    ERQ     1,,PR1
         0 000156   177000 376003                    ANQ     65024,DU
         0 000157   100001 656100                    ERSQ    1,,PR1
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:34   

      203     2347    3              RESULTS.BOOTINFO.OLD = '1'B ;

   2347  0 000160   000400 236007                    LDQ     256,DL
         0 000161   100000 256100                    ORSQ    0,,PR1

      204     2348    3              CALL FINDALTPATH     ALTRET ( ALT ) ;

   2348  0 000162   000606 701000 0                  TSX1    FINDALTPATH
         0 000163   000302 702000 0                  TSX2    ALT

      205     2349    3              IT_CONFIG.DC01.IOM   = IOCHAN.IOM ;

   2349  0 000164   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000165   000042 772000                    QRL     34
         0 000166   000021 756000 xsym               STQ     IT_CONFIG+17

      206     2350    3              IT_CONFIG.DC01.CHAN  = IOCHAN.CHANNEL ;

   2350  0 000167   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000170   000033 772000                    QRL     27
         0 000171   000177 376007                    ANQ     127,DL
         0 000172   000022 756000 xsym               STQ     IT_CONFIG+18

      207     2351    3              IT_CONFIG.DC01.FWNAME = MPCDCT$->DCT.MPC.FWNAME ;

   2351  0 000173   200011 470500                    LDP0    MPCDCT$,,AUTO
         0 000174   000041 236100                    LDQ     33,,PR0
         0 000175   000023 756000 xsym               STQ     IT_CONFIG+19

      208     2352    3              RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;

   2352  0 000176   200004 471500                    LDP1    @RESULTS,,AUTO
         0 000177   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000200   000022 772000                    QRL     18
         0 000201   100001 676100                    ERQ     1,,PR1
         0 000202   600000 376007                    ANQ     -65536,DL
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:35   
         0 000203   100001 656100                    ERSQ    1,,PR1

      209     2353    3              RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;

   2353  0 000204   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000205   000022 772000                    QRL     18
         0 000206   100001 676100                    ERQ     1,,PR1
         0 000207   177000 376007                    ANQ     65024,DL
         0 000210   100001 656100                    ERSQ    1,,PR1

      210     2354    3              RESULTS.BOOTINFO.NEW = '1'B ;

   2354  0 000211   000200 236007                    LDQ     128,DL
         0 000212   100000 256100                    ORSQ    0,,PR1

      211     2355    3              END ;

   2355  0 000213   000300 710000 0                  TRA     RET

      212     2356
      213     2357    2           ELSE IF ( DQH.IOCHAN.IOM = IT_CONFIG.UC01.IOM ) AND

   2357  0 000214   000001 236100                    LDQ     1,,PR0
         0 000215   000031 772000                    QRL     25
         0 000216   000003 376007                    ANQ     3,DL
         0 000217   000003 116000 xsym               CMPQ    IT_CONFIG+3
         0 000220   000300 601000 0                  TNZ     RET
         0 000221   000001 236100                    LDQ     1,,PR0
         0 000222   000022 772000                    QRL     18
         0 000223   000177 376007                    ANQ     127,DL
         0 000224   000004 116000 xsym               CMPQ    IT_CONFIG+4
         0 000225   000300 601000 0                  TNZ     RET

      214     2358    3                ( DQH.IOCHAN.CHANNEL = IT_CONFIG.UC01.CHAN ) THEN DO ;

      215     2359    3                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.UC01.IOM ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:36   
   2359  0 000226   200004 471500                    LDP1    @RESULTS,,AUTO
         0 000227   000003 236000 xsym               LDQ     IT_CONFIG+3
         0 000230   000042 736000                    QLS     34
         0 000231   100001 676100                    ERQ     1,,PR1
         0 000232   600000 376003                    ANQ     -65536,DU
         0 000233   100001 656100                    ERSQ    1,,PR1

      216     2360    3                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.UC01.CHAN ;

   2360  0 000234   000004 236000 xsym               LDQ     IT_CONFIG+4
         0 000235   000033 736000                    QLS     27
         0 000236   100001 676100                    ERQ     1,,PR1
         0 000237   177000 376003                    ANQ     65024,DU
         0 000240   100001 656100                    ERSQ    1,,PR1

      217     2361    3                 RESULTS.BOOTINFO.OLD = '1'B ;

   2361  0 000241   000400 236007                    LDQ     256,DL
         0 000242   100000 256100                    ORSQ    0,,PR1

      218     2362    3                 CALL FINDALTPATH  ALTRET ( ALT ) ;

   2362  0 000243   000606 701000 0                  TSX1    FINDALTPATH
         0 000244   000302 702000 0                  TSX2    ALT

      219     2363    3                 IT_CONFIG.UC01.IOM = IOCHAN.IOM ;

   2363  0 000245   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000246   000042 772000                    QRL     34
         0 000247   000003 756000 xsym               STQ     IT_CONFIG+3

      220     2364    3                 IT_CONFIG.UC01.CHAN = IOCHAN.CHANNEL ;

   2364  0 000250   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000251   000033 772000                    QRL     27
         0 000252   000177 376007                    ANQ     127,DL
         0 000253   000004 756000 xsym               STQ     IT_CONFIG+4
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:37   

      221     2365    3                 IT_CONFIG.UC01.FWNAME = MPCDCT$->DCT.MPC.FWNAME ;

   2365  0 000254   200011 470500                    LDP0    MPCDCT$,,AUTO
         0 000255   000041 236100                    LDQ     33,,PR0
         0 000256   000005 756000 xsym               STQ     IT_CONFIG+5

      222     2366    3                 IT_CONFIG.UC01.LPNAME = MPCDCT$->DCT.MPC.LPNAME ;

   2366  0 000257   000042 236100                    LDQ     34,,PR0
         0 000260   000006 756000 xsym               STQ     IT_CONFIG+6

      223     2367    3                 IT_CONFIG.UC01.CRPNAME = MPCDCT$->DCT.MPC.CRPNAME ;

   2367  0 000261   000043 236100                    LDQ     35,,PR0
         0 000262   000007 756000 xsym               STQ     IT_CONFIG+7

      224     2368    3                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;

   2368  0 000263   200004 471500                    LDP1    @RESULTS,,AUTO
         0 000264   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000265   000022 772000                    QRL     18
         0 000266   100001 676100                    ERQ     1,,PR1
         0 000267   600000 376007                    ANQ     -65536,DL
         0 000270   100001 656100                    ERSQ    1,,PR1

      225     2369    3                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;

   2369  0 000271   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000272   000022 772000                    QRL     18
         0 000273   100001 676100                    ERQ     1,,PR1
         0 000274   177000 376007                    ANQ     65024,DL
         0 000275   100001 656100                    ERSQ    1,,PR1

      226     2370    3                 RESULTS.BOOTINFO.NEW = '1'B ;

   2370  0 000276   000200 236007                    LDQ     128,DL
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:38   
         0 000277   100000 256100                    ORSQ    0,,PR1

      227     2371    3                 END ;

      228     2372
      229     2373    2              ELSE ;
              2373                     /* This is not one of AARDVARK's channels which need to be changed. */
      230     2374
      231     2375    2   RET:    RETURN ;

   2375  0 000300   200020 221300       RET          LDX1  ! IOCHANX+2,,AUTO
         0 000301   000001 702211                    TSX2  ! 1,X1

      232     2376
      233     2377    2   ALT:    ALTRETURN ;

   2377  0 000302   200020 221300       ALT          LDX1  ! IOCHANX+2,,AUTO
         0 000303   000000 702211                    TSX2  ! 0,X1

      234     2378
      235     2379    2   END CHANCONFIG ;
      236     2380        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:39   
      237     2381    1   DEVCONFIG: PROC ALTRET ;

   2381  0 000304   200020 741300       DEVCONFIG    STX1  ! IOCHANX+2,,AUTO

      238     2382
      239     2383    3           DO CASE (DCT.TYPE) ;

   2383  0 000305   200006 470500                    LDP0    DCT$,,AUTO
         0 000306   000007 236100                    LDQ     7,,PR0
         0 000307   000006 772000                    QRL     6
         0 000310   000077 376007                    ANQ     63,DL
         0 000311   000004 116007                    CMPQ    4,DL
         0 000312   000314 602006 0                  TNC     s:2383+7,QL
         0 000313   000541 710000 0                  TRA     RET
         0 000314   000320 710000 0                  TRA     s:2386
         0 000315   000462 710000 0                  TRA     s:2415
         0 000316   000541 710000 0                  TRA     RET
         0 000317   000403 710000 0                  TRA     s:2401

      240     2384
      241     2385    3            CASE (%DV_SC) ;

      242     2386    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.SC01.IOM ) AND

   2386  0 000320   000023 471500                    LDP1    19,,PR0
         0 000321   100001 236100                    LDQ     1,,PR1
         0 000322   000031 772000                    QRL     25
         0 000323   000003 376007                    ANQ     3,DL
         0 000324   000001 116000 xsym               CMPQ    IT_CONFIG+1
         0 000325   000541 601000 0                  TNZ     RET
         0 000326   100001 236100                    LDQ     1,,PR1
         0 000327   000022 772000                    QRL     18
         0 000330   000177 376007                    ANQ     127,DL
         0 000331   000002 116000 xsym               CMPQ    IT_CONFIG+2
         0 000332   000541 601000 0                  TNZ     RET

      243     2387    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.SC01.CHAN ) THEN DO ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:40   

      244     2388    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.SC01.IOM ;

   2388  0 000333   200004 473500                    LDP3    @RESULTS,,AUTO
         0 000334   000001 236000 xsym               LDQ     IT_CONFIG+1
         0 000335   000042 736000                    QLS     34
         0 000336   300001 676100                    ERQ     1,,PR3
         0 000337   600000 376003                    ANQ     -65536,DU
         0 000340   300001 656100                    ERSQ    1,,PR3

      245     2389    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.SC01.CHAN ;

   2389  0 000341   000002 236000 xsym               LDQ     IT_CONFIG+2
         0 000342   000033 736000                    QLS     27
         0 000343   300001 676100                    ERQ     1,,PR3
         0 000344   177000 376003                    ANQ     65024,DU
         0 000345   300001 656100                    ERSQ    1,,PR3

      246     2390    4                 RESULTS.BOOTINFO.OLD  = '1'B ;

   2390  0 000346   000400 236007                    LDQ     256,DL
         0 000347   300000 256100                    ORSQ    0,,PR3

      247     2391    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;

   2391  0 000350   000545 701000 0                  TSX1    FINDALTDEV
         0 000351   000543 702000 0                  TSX2    ALT

      248     2392    4                 IT_CONFIG.SC01.IOM    = IOCHAN.IOM ;

   2392  0 000352   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000353   000042 772000                    QRL     34
         0 000354   000001 756000 xsym               STQ     IT_CONFIG+1

      249     2393    4                 IT_CONFIG.SC01.CHAN   = IOCHAN.CHANNEL ;

   2393  0 000355   200016 236100                    LDQ     IOCHANX,,AUTO
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:41   
         0 000356   000033 772000                    QRL     27
         0 000357   000177 376007                    ANQ     127,DL
         0 000360   000002 756000 xsym               STQ     IT_CONFIG+2

      250     2394    4                 B_SCDCTX              = DEVDCT$->DCT.DCTX ;

   2394  0 000361   200007 470500                    LDP0    DEVDCT$,,AUTO
         0 000362   000006 236100                    LDQ     6,,PR0
         0 000363   000025 772000                    QRL     21
         0 000364   000000 756000 xsym               STQ     B_SCDCTX

      251     2395    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;

   2395  0 000365   200004 471500                    LDP1    @RESULTS,,AUTO
         0 000366   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000367   000022 772000                    QRL     18
         0 000370   100001 676100                    ERQ     1,,PR1
         0 000371   600000 376007                    ANQ     -65536,DL
         0 000372   100001 656100                    ERSQ    1,,PR1

      252     2396    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;

   2396  0 000373   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000374   000022 772000                    QRL     18
         0 000375   100001 676100                    ERQ     1,,PR1
         0 000376   177000 376007                    ANQ     65024,DL
         0 000377   100001 656100                    ERSQ    1,,PR1

      253     2397    4                 RESULTS.BOOTINFO.NEW  = '1'B ;

   2397  0 000400   000200 236007                    LDQ     128,DL
         0 000401   100000 256100                    ORSQ    0,,PR1

      254     2398    4                 END ;

   2398  0 000402   000541 710000 0                  TRA     RET

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:42   
      255     2399
      256     2400    3            CASE (%DV_LP) ;

      257     2401    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.LP01.IOM ) AND

   2401  0 000403   000023 471500                    LDP1    19,,PR0
         0 000404   100001 236100                    LDQ     1,,PR1
         0 000405   000031 772000                    QRL     25
         0 000406   000003 376007                    ANQ     3,DL
         0 000407   000010 116000 xsym               CMPQ    IT_CONFIG+8
         0 000410   000541 601000 0                  TNZ     RET
         0 000411   100001 236100                    LDQ     1,,PR1
         0 000412   000022 772000                    QRL     18
         0 000413   000177 376007                    ANQ     127,DL
         0 000414   000011 116000 xsym               CMPQ    IT_CONFIG+9
         0 000415   000541 601000 0                  TNZ     RET

      258     2402    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.LP01.CHAN ) THEN DO ;

      259     2403    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.LP01.IOM ;

   2403  0 000416   200004 473500                    LDP3    @RESULTS,,AUTO
         0 000417   000010 236000 xsym               LDQ     IT_CONFIG+8
         0 000420   000042 736000                    QLS     34
         0 000421   300001 676100                    ERQ     1,,PR3
         0 000422   600000 376003                    ANQ     -65536,DU
         0 000423   300001 656100                    ERSQ    1,,PR3

      260     2404    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.LP01.CHAN ;

   2404  0 000424   000011 236000 xsym               LDQ     IT_CONFIG+9
         0 000425   000033 736000                    QLS     27
         0 000426   300001 676100                    ERQ     1,,PR3
         0 000427   177000 376003                    ANQ     65024,DU
         0 000430   300001 656100                    ERSQ    1,,PR3

      261     2405    4                 RESULTS.BOOTINFO.OLD  = '1'B ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:43   

   2405  0 000431   000400 236007                    LDQ     256,DL
         0 000432   300000 256100                    ORSQ    0,,PR3

      262     2406    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;

   2406  0 000433   000545 701000 0                  TSX1    FINDALTDEV
         0 000434   000543 702000 0                  TSX2    ALT

      263     2407    4                 IT_CONFIG.LP01.IOM    = IOCHAN.IOM ;

   2407  0 000435   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000436   000042 772000                    QRL     34
         0 000437   000010 756000 xsym               STQ     IT_CONFIG+8

      264     2408    4                 IT_CONFIG.LP01.CHAN   = IOCHAN.CHANNEL ;

   2408  0 000440   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000441   000033 772000                    QRL     27
         0 000442   000177 376007                    ANQ     127,DL
         0 000443   000011 756000 xsym               STQ     IT_CONFIG+9

      265     2409    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;

   2409  0 000444   200004 470500                    LDP0    @RESULTS,,AUTO
         0 000445   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000446   000022 772000                    QRL     18
         0 000447   000001 676100                    ERQ     1,,PR0
         0 000450   600000 376007                    ANQ     -65536,DL
         0 000451   000001 656100                    ERSQ    1,,PR0

      266     2410    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;

   2410  0 000452   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000453   000022 772000                    QRL     18
         0 000454   000001 676100                    ERQ     1,,PR0
         0 000455   177000 376007                    ANQ     65024,DL
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:44   
         0 000456   000001 656100                    ERSQ    1,,PR0

      267     2411    4                 RESULTS.BOOTINFO.NEW  = '1'B ;

   2411  0 000457   000200 236007                    LDQ     128,DL
         0 000460   000000 256100                    ORSQ    0,,PR0

      268     2412    4                 END ;

   2412  0 000461   000541 710000 0                  TRA     RET

      269     2413
      270     2414    3            CASE (%DV_CR) ;

      271     2415    3              IF ( DCT.DQH$->DQH.IOCHAN.IOM = IT_CONFIG.CR01.IOM ) AND

   2415  0 000462   000023 471500                    LDP1    19,,PR0
         0 000463   100001 236100                    LDQ     1,,PR1
         0 000464   000031 772000                    QRL     25
         0 000465   000003 376007                    ANQ     3,DL
         0 000466   000012 116000 xsym               CMPQ    IT_CONFIG+10
         0 000467   000541 601000 0                  TNZ     RET
         0 000470   100001 236100                    LDQ     1,,PR1
         0 000471   000022 772000                    QRL     18
         0 000472   000177 376007                    ANQ     127,DL
         0 000473   000013 116000 xsym               CMPQ    IT_CONFIG+11
         0 000474   000541 601000 0                  TNZ     RET

      272     2416    4                ( DCT.DQH$->DQH.IOCHAN.CHANNEL = IT_CONFIG.CR01.CHAN ) THEN DO ;

      273     2417    4                 RESULTS.BOOTINFO.OLDIOM = IT_CONFIG.CR01.IOM ;

   2417  0 000475   200004 473500                    LDP3    @RESULTS,,AUTO
         0 000476   000012 236000 xsym               LDQ     IT_CONFIG+10
         0 000477   000042 736000                    QLS     34
         0 000500   300001 676100                    ERQ     1,,PR3
         0 000501   600000 376003                    ANQ     -65536,DU
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:45   
         0 000502   300001 656100                    ERSQ    1,,PR3

      274     2418    4                 RESULTS.BOOTINFO.OLDCHAN = IT_CONFIG.CR01.CHAN ;

   2418  0 000503   000013 236000 xsym               LDQ     IT_CONFIG+11
         0 000504   000033 736000                    QLS     27
         0 000505   300001 676100                    ERQ     1,,PR3
         0 000506   177000 376003                    ANQ     65024,DU
         0 000507   300001 656100                    ERSQ    1,,PR3

      275     2419    4                 RESULTS.BOOTINFO.OLD  = '1'B ;

   2419  0 000510   000400 236007                    LDQ     256,DL
         0 000511   300000 256100                    ORSQ    0,,PR3

      276     2420    4                 CALL FINDALTDEV       ALTRET ( ALT ) ;

   2420  0 000512   000545 701000 0                  TSX1    FINDALTDEV
         0 000513   000543 702000 0                  TSX2    ALT

      277     2421    4                 IT_CONFIG.CR01.IOM    = IOCHAN.IOM ;

   2421  0 000514   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000515   000042 772000                    QRL     34
         0 000516   000012 756000 xsym               STQ     IT_CONFIG+10

      278     2422    4                 IT_CONFIG.CR01.CHAN   = IOCHAN.CHANNEL ;

   2422  0 000517   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000520   000033 772000                    QRL     27
         0 000521   000177 376007                    ANQ     127,DL
         0 000522   000013 756000 xsym               STQ     IT_CONFIG+11

      279     2423    4                 RESULTS.BOOTINFO.NEWIOM = IOCHAN.IOM ;

   2423  0 000523   200004 470500                    LDP0    @RESULTS,,AUTO
         0 000524   200016 236100                    LDQ     IOCHANX,,AUTO
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:46   
         0 000525   000022 772000                    QRL     18
         0 000526   000001 676100                    ERQ     1,,PR0
         0 000527   600000 376007                    ANQ     -65536,DL
         0 000530   000001 656100                    ERSQ    1,,PR0

      280     2424    4                 RESULTS.BOOTINFO.NEWCHAN = IOCHAN.CHANNEL ;

   2424  0 000531   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000532   000022 772000                    QRL     18
         0 000533   000001 676100                    ERQ     1,,PR0
         0 000534   177000 376007                    ANQ     65024,DL
         0 000535   000001 656100                    ERSQ    1,,PR0

      281     2425    4                 RESULTS.BOOTINFO.NEW  = '1'B ;

   2425  0 000536   000200 236007                    LDQ     128,DL
         0 000537   000000 256100                    ORSQ    0,,PR0

      282     2426    4                 END ;

   2426  0 000540   000541 710000 0                  TRA     RET

      283     2427
      284     2428    3            CASE ( ELSE ) ;

      285     2429    3            END ;

      286     2430
      287     2431    2   RET:    RETURN ;

   2431  0 000541   200020 221300       RET          LDX1  ! IOCHANX+2,,AUTO
         0 000542   000001 702211                    TSX2  ! 1,X1

      288     2432
      289     2433    2   ALT:    ALTRETURN ;

   2433  0 000543   200020 221300       ALT          LDX1  ! IOCHANX+2,,AUTO
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:47   
         0 000544   000000 702211                    TSX2  ! 0,X1

      290     2434
      291     2435    2   END DEVCONFIG ;
      292     2436        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:48   
      293     2437    1   FINDALTDEV: PROC ALTRET ;

   2437  0 000545   200022 741300       FINDALTDEV   STX1  ! I+1,,AUTO

      294     2438
      295     2439    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      296     2440
      297     2441    3           DO I = 1 TO NK_MXLOCAL ;

   2441  0 000546   000001 235007                    LDA     1,DL
         0 000547   200023 755100                    STA     I,,AUTO
         0 000550   000600 710000 0                  TRA     s:2450+1

      298     2442    4              IF ( N$DCT$(I) ~= ADDR(NIL) ) THEN DO ;

   2442  0 000551   000000 470400 xsym               LDP0    N$DCT$$
         0 000552   200023 720100                    LXL0    I,,AUTO
         0 000553   000000 236110                    LDQ     0,X0,PR0
         0 000554   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000555   000577 600000 0                  TZE     s:2450

      299     2443    4                 IF ( N$DCT$(I)->DCT.TYPE = DCT.TYPE ) AND

   2443  0 000556   000000 471510                    LDP1    0,X0,PR0
         0 000557   200006 473500                    LDP3    DCT$,,AUTO
         0 000560   100007 236100                    LDQ     7,,PR1
         0 000561   300007 676100                    ERQ     7,,PR3
         0 000562   007700 376007                    ANQ     4032,DL
         0 000563   000577 601000 0                  TNZ     s:2450
         0 000564   100027 234100                    SZN     23,,PR1
         0 000565   000577 604000 0                  TMI     s:2450

      300     2444    5                   NOT N$DCT$(I)->DCT.STATUS.DOWN THEN DO ;

      301     2445    5                    DEVDCT$ = N$DCT$(I) ;

   2445  0 000566   000000 236110                    LDQ     0,X0,PR0
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:49   
         0 000567   200007 756100                    STQ     DEVDCT$,,AUTO

      302     2446    5                    IOCHANX = DEVDCT$->DCT.DQH$->DQH.IOCHANX ;

   2446  0 000570   200007 474500                    LDP4    DEVDCT$,,AUTO
         0 000571   400023 475500                    LDP5    19,,PR4
         0 000572   500001 236100                    LDQ     1,,PR5
         0 000573   000011 736000                    QLS     9
         0 000574   200016 552140                    STBQ    IOCHANX,'40'O,AUTO

      303     2447    5                    RETURN ;

   2447  0 000575   200022 221300                    LDX1  ! I+1,,AUTO
         0 000576   000001 702211                    TSX2  ! 1,X1

      304     2448    5                    END ;
      305     2449    4                 END ;
      306     2450    3              END ;

   2450  0 000577   200023 054100                    AOS     I,,AUTO
         0 000600   000000 236000 xsym               LDQ     NK_MXLOCAL
         0 000601   000551 604000 0                  TMI     s:2442
         0 000602   200023 116100                    CMPQ    I,,AUTO
         0 000603   000551 605000 0                  TPL     s:2442

      307     2451
      308     2452    2           ALTRETURN ;

   2452  0 000604   200022 221300                    LDX1  ! I+1,,AUTO
         0 000605   000000 702211                    TSX2  ! 0,X1

      309     2453
      310     2454    2   END FINDALTDEV ;
      311     2455        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:50   
      312     2456    1   FINDALTPATH: PROC ALTRET ;

   2456  0 000606   200022 741300       FINDALTPATH  STX1  ! I+1,,AUTO

      313     2457
      314     2458    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      315     2459    2   DCL 1 J                 SBIN WORD ALIGNED AUTO ;
      316     2460    2   DCL 1 K                 SBIN WORD ALIGNED AUTO ;
      317     2461    2   DCL 1 KEND              SBIN WORD ALIGNED AUTO ;
      318     2462    2   DCL 1 SAMELA            BIT(1) ALIGNED AUTO ;
      319     2463
      320     2464    2           IF NEWLA THEN KEND = 1 ;

   2464  0 000607   200005 470500                    LDP0    @NEWLA,,AUTO
         0 000610   000000 234100                    SZN     0,,PR0
         0 000611   000615 605000 0                  TPL     s:2465

   2464  0 000612   000001 235007                    LDA     1,DL
         0 000613   200026 755100                    STA     KEND,,AUTO
         0 000614   000616 710000 0                  TRA     s:2467

      321     2465    2           ELSE KEND = 0 ;

   2465  0 000615   200026 450100                    STZ     KEND,,AUTO

      322     2466
      323     2467    2           SAMELA = ~NEWLA ;

   2467  0 000616   000000 236100                    LDQ     0,,PR0
         0 000617   400000 376003                    ANQ     -131072,DU
         0 000620   400000 676003                    ERQ     -131072,DU
         0 000621   200027 756100                    STQ     SAMELA,,AUTO

      324     2468
      325     2469    3           DO K = 0 TO KEND ;

   2469  0 000622   200025 450100                    STZ     K,,AUTO
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:51   
         0 000623   000727 710000 0                  TRA     s:2487+1

      326     2470    4              DO I = 0 TO 1 ;

   2470  0 000624   200023 450100                    STZ     I,,AUTO

      327     2471    5                 IF SQH.MPC$(I) ~= ADDR(NIL) THEN DO ;

   2471  0 000625   200012 470500                    LDP0    SQH$,,AUTO
         0 000626   200023 720100                    LXL0    I,,AUTO
         0 000627   000005 236110                    LDQ     5,X0,PR0
         0 000630   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000631   000716 600000 0                  TZE     s:2485

      328     2472    6                    DO J = 0 TO %N_CHANSPERMPC-1 ;

   2472  0 000632   200024 450100                    STZ     J,,AUTO
         0 000633   000713 710000 0                  TRA     s:2483+1

      329     2473    6                       IOCHANX = SQH.MPC$(I)->DCT.MPC.IOCHANX(J) ;

   2473  0 000634   200012 470500                    LDP0    SQH$,,AUTO
         0 000635   200023 720100                    LXL0    I,,AUTO
         0 000636   000005 471510                    LDP1    5,X0,PR0
         0 000637   200024 235100                    LDA     J,,AUTO
         0 000640   000100 100505                    MLR     fill='000'O
         0 000641   100031 000001                    ADSC9   25,A,PR1                 cn=0,n=1
         0 000642   200016 000001                    ADSC9   IOCHANX,,AUTO            cn=0,n=1

      330     2474    6                       IF ( IOCHANX ~= 0 )       AND

   2474  0 000643   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000644   777000 316003                    CANQ    -512,DU
         0 000645   000712 600000 0                  TZE     s:2483
         0 000646   200010 473500                    LDP3    DQH$,,AUTO
         0 000647   300001 236100                    LDQ     1,,PR3
         0 000650   000022 772000                    QRL     18
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:52   
         0 000651   000777 376007                    ANQ     511,DL
         0 000652   200030 756100                    STQ     SAMELA+1,,AUTO
         0 000653   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000654   000033 772000                    QRL     27
         0 000655   200030 116100                    CMPQ    SAMELA+1,,AUTO
         0 000656   000712 600000 0                  TZE     s:2483

      331     2475    6                         ( IOCHANX ~= DQH.IOCHANX ) THEN
      332     2476    6                          IF NOT CHT.DQH$(IOCHANX)->DQH.STATUS.DOWN AND

   2476  0 000657   000001 736000                    QLS     1
         0 000660   000000 471400 xsym               LDP1    NI$CHT$
         0 000661   100000 474506                    LDP4    0,QL,PR1
         0 000662   400001 236100                    LDQ     1,,PR4
         0 000663   200000 316003                    CANQ    65536,DU
         0 000664   000712 601000 0                  TNZ     s:2483
         0 000665   200027 234100                    SZN     SAMELA,,AUTO
         0 000666   000706 604000 0                  TMI     s:2480
         0 000667   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000670   000032 772000                    QRL     26
         0 000671   001776 376007                    ANQ     1022,DL
         0 000672   100000 474506                    LDP4    0,QL,PR1
         0 000673   400020 236100                    LDQ     16,,PR4
         0 000674   300020 676100                    ERQ     16,,PR3
         0 000675   003000 376003                    ANQ     1536,DU
         0 000676   000706 601000 0                  TNZ     s:2480
         0 000677   200016 236100                    LDQ     IOCHANX,,AUTO
         0 000700   000032 772000                    QRL     26
         0 000701   001776 376007                    ANQ     1022,DL
         0 000702   100000 474506                    LDP4    0,QL,PR1
         0 000703   400015 236100                    LDQ     13,,PR4
         0 000704   300015 116100                    CMPQ    13,,PR3
         0 000705   000712 600000 0                  TZE     s:2483

      333     2477    6                            ( SAMELA OR
      334     2478    6                            CHT.DQH$(IOCHANX)->DQH.LA ~= DQH.LA OR
      335     2479    7                            CHT.DQH$(IOCHANX)->DQH.MPC$ ~= DQH.MPC$ ) THEN DO ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:53   

      336     2480    7                             MPCDCT$ = SQH.MPC$(I) ;

   2480  0 000706   000005 236110                    LDQ     5,X0,PR0
         0 000707   200011 756100                    STQ     MPCDCT$,,AUTO

      337     2481    7                             RETURN ;

   2481  0 000710   200022 221300                    LDX1  ! I+1,,AUTO
         0 000711   000001 702211                    TSX2  ! 1,X1

      338     2482    7                             END ;
      339     2483    6                       END ;

   2483  0 000712   200024 054100                    AOS     J,,AUTO
         0 000713   200024 235100                    LDA     J,,AUTO
         0 000714   000017 115007                    CMPA    15,DL
         0 000715   000634 604400 0                  TMOZ    s:2473

      340     2484    5                    END ;

      341     2485    4                 END ;

   2485  0 000716   200023 054100                    AOS     I,,AUTO
         0 000717   200023 235100                    LDA     I,,AUTO
         0 000720   000001 115007                    CMPA    1,DL
         0 000721   000625 604400 0                  TMOZ    s:2471

      342     2486    3              SAMELA = ~SAMELA ;

   2486  0 000722   200027 236100                    LDQ     SAMELA,,AUTO
         0 000723   400000 376003                    ANQ     -131072,DU
         0 000724   400000 676003                    ERQ     -131072,DU
         0 000725   200027 756100                    STQ     SAMELA,,AUTO

      343     2487    3              END ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:54   
   2487  0 000726   200025 054100                    AOS     K,,AUTO
         0 000727   200025 236100                    LDQ     K,,AUTO
         0 000730   200026 116100                    CMPQ    KEND,,AUTO
         0 000731   000624 604400 0                  TMOZ    s:2470

      344     2488
      345     2489    2           ALTRETURN ;

   2489  0 000732   200022 221300                    LDX1  ! I+1,,AUTO
         0 000733   000000 702211                    TSX2  ! 0,X1

      346     2490
      347     2491    2   END FINDALTPATH ;
      348     2492        %EJECT ;
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:55   
      349     2493    1   WRITECONFIG: PROC ;

   2493  0 000734   200020 741300       WRITECONFIG  STX1  ! IOCHANX+2,,AUTO

      350     2494
      351     2495        %NI$SQH (NAME=SYSSQH,STCLASS="BASED(SYSSQH$)") ;
      352     2508
      353     2509    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
      354     2510    2   DCL 1 SYSDCT$           PTR ALIGNED AUTO ;
      355     2511    2   DCL 1 SYSSQH$           PTR ALIGNED AUTO ;
      356     2512
      357     2513    2           SYSDCT$ = N$DCT$(IT_SYSDISK) ;

   2513  0 000735   000000 470400 xsym               LDP0    N$DCT$$
         0 000736   000000 720000 xsym               LXL0    IT_SYSDISK
         0 000737   000000 236110                    LDQ     0,X0,PR0
         0 000740   200022 756100                    STQ     SYSDCT$,,AUTO

      358     2514    2           SYSSQH$ = SYSDCT$->DCT.SQH$ ;

   2514  0 000741   200022 471500                    LDP1    SYSDCT$,,AUTO
         0 000742   100022 236100                    LDQ     18,,PR1
         0 000743   200023 756100                    STQ     SYSSQH$,,AUTO

      359     2515
      360     2516    3           DO I = 0 TO 1 ;

   2516  0 000744   200021 450100                    STZ     I,,AUTO

      361     2517    3              IF SYSSQH.MPC$(I) ~= ADDR(NIL) AND

   2517  0 000745   200023 470500                    LDP0    SYSSQH$,,AUTO
         0 000746   200021 720100                    LXL0    I,,AUTO
         0 000747   000005 236110                    LDQ     5,X0,PR0
         0 000750   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000751   001005 600000 0                  TZE     s:2525
         0 000752   000005 471510                    LDP1    5,X0,PR0
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:56   
         0 000753   100027 234100                    SZN     23,,PR1
         0 000754   001005 604000 0                  TMI     s:2525

      362     2518    4                NOT SYSSQH.MPC$(I)->DCT.STATUS.DOWN THEN DO ;

      363     2519    4                 SYSSQH.MPC$(I)->DCT.DFLG.RELOAD = '0'B ; /* Dont reload FW */

   2519  0 000755   000004 236000 1                  LDQ     4
         0 000756   100006 356100                    ANSQ    6,,PR1

      364     2520    4                 CALL NIW$MPCSTOP ( SYSSQH.MPC$(I)->DCT ) ;

   2520  0 000757   000005 471510                    LDP1    5,X0,PR0
         0 000760   200030 451500                    STP1    SAMELA+1,,AUTO
         0 000761   200030 630500                    EPPR0   SAMELA+1,,AUTO
         0 000762   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000763   000000 701000 xent               TSX1    NIW$MPCSTOP
         0 000764   000000 011000                    NOP     0

      365     2521    5                 DO WHILE NOT SYSSQH.MPC$(I)->DCT.DFLG.MPCSTOP ;

   2521  0 000765   000777 710000 0                  TRA     s:2523

      366     2522    5                    CALL SSR$REG ( %SS_SL, , 1 ) ;

   2522  0 000766   000002 236000 1                  LDQ     2
         0 000767   200032 756100                    STQ     SAMELA+3,,AUTO
         0 000770   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000771   000003 235000 1                  LDA     3
         0 000772   200030 757100                    STAQ    SAMELA+1,,AUTO
         0 000773   200030 630500                    EPPR0   SAMELA+1,,AUTO
         0 000774   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000775   000000 701000 xent               TSX1    SSR$REG
         0 000776   000000 011000                    NOP     0

      367     2523    5                    END ;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:57   
   2523  0 000777   200023 470500                    LDP0    SYSSQH$,,AUTO
         0 001000   200021 720100                    LXL0    I,,AUTO
         0 001001   000005 471510                    LDP1    5,X0,PR0
         0 001002   100006 236100                    LDQ     6,,PR1
         0 001003   001000 316007                    CANQ    512,DL
         0 001004   000766 600000 0                  TZE     s:2522

      368     2524    4                 END ;

      369     2525    3              END ;

   2525  0 001005   200021 054100                    AOS     I,,AUTO
         0 001006   200021 235100                    LDA     I,,AUTO
         0 001007   000001 115007                    CMPA    1,DL
         0 001010   000745 604400 0                  TMOZ    s:2517

      370     2526
      371     2527                %LOCK ( G#=NI$CONNECT.GATE ) ;

   2528  0 001011   000000 630400 xsym               EPPR0   NI$CONNECT$
         0 001012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001013   000000 701000 xent               TSX1    HFC$LOCK
         0 001014   000000 011000                    NOP     0

      372     2530    2           CALL NIM$CHNGAARD

   2530  0 001015   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 001016   000000 701000 xent               TSX1    NIM$CHNGAARD
         0 001017   001021 702000 0                  TSX2    s:2532
         0 001020   001024 710000 0                  TRA     s:2535

      373     2531    3           WHENALTRETURN DO ;

      374     2532    3              RESULTS.BOOTINFO.ERR = '1'B ;

   2532  0 001021   200004 470500                    LDP0    @RESULTS,,AUTO
         0 001022   000100 236007                    LDQ     64,DL
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:58   
         0 001023   000000 256100                    ORSQ    0,,PR0

      375     2533    3              END ;

      376     2534                %UNLOCK ( G#=NI$CONNECT.GATE ) ;

   2535  0 001024   000000 630400 xsym               EPPR0   NI$CONNECT$
         0 001025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001026   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001027   000000 011000                    NOP     0

      377     2537    2           IF RESULTS.BOOTINFO.ERR THEN

   2537  0 001030   200004 470500                    LDP0    @RESULTS,,AUTO
         0 001031   000000 236100                    LDQ     0,,PR0
         0 001032   000100 316007                    CANQ    64,DL
         0 001033   001052 600000 0                  TZE     s:2541

      378     2538    2              CALL OCI$MK_WRTM ( M_DEVC, CHNGAARD_MSG#, 0, '000'O, '000'O,

   2538  0 001034   200022 236100                    LDQ     SYSDCT$,,AUTO
         0 001035   000007 036000 1                  ADLQ    7
         0 001036   000001 235000 xsym               LDA     B_VECTNIL+1
         0 001037   200036 757100                    STAQ    SAMELA+7,,AUTO
         0 001040   000010 237000 1                  LDAQ    8
         0 001041   200034 757100                    STAQ    SAMELA+5,,AUTO
         0 001042   000012 237000 1                  LDAQ    10
         0 001043   200032 757100                    STAQ    SAMELA+3,,AUTO
         0 001044   000014 237000 1                  LDAQ    12
         0 001045   200030 757100                    STAQ    SAMELA+1,,AUTO
         0 001046   200030 630500                    EPPR0   SAMELA+1,,AUTO
         0 001047   000026 631400 xsym               EPPR1   B_VECTNIL+22
         0 001050   000000 701000 xent               TSX1    OCI$MK_WRTM
         0 001051   000000 011000                    NOP     0

      379     2539    2                IT_SYSDISK, /* WSN */, SYSDCT$->DCT.MSG# ) ;
      380     2540
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:59   
      381     2541    3           DO I = 0 TO 1 ;

   2541  0 001052   200021 450100                    STZ     I,,AUTO

      382     2542    3              IF SYSSQH.MPC$(I) ~= ADDR(NIL) AND

   2542  0 001053   200023 470500                    LDP0    SYSSQH$,,AUTO
         0 001054   200021 720100                    LXL0    I,,AUTO
         0 001055   000005 236110                    LDQ     5,X0,PR0
         0 001056   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001057   001070 600000 0                  TZE     s:2545
         0 001060   000005 471510                    LDP1    5,X0,PR0
         0 001061   100027 234100                    SZN     23,,PR1
         0 001062   001070 604000 0                  TMI     s:2545

      383     2543    3                NOT SYSSQH.MPC$(I)->DCT.STATUS.DOWN THEN
      384     2544    3                 CALL NIW$MPCSTART ( SYSSQH.MPC$(I)->DCT ) ;

   2544  0 001063   200030 451500                    STP1    SAMELA+1,,AUTO
         0 001064   200030 630500                    EPPR0   SAMELA+1,,AUTO
         0 001065   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001066   000000 701000 xent               TSX1    NIW$MPCSTART
         0 001067   000000 011000                    NOP     0

      385     2545    3              END ;

   2545  0 001070   200021 054100                    AOS     I,,AUTO
         0 001071   200021 235100                    LDA     I,,AUTO
         0 001072   000001 115007                    CMPA    1,DL
         0 001073   001053 604400 0                  TMOZ    s:2542

      386     2546
      387     2547    2           RETURN ;

   2547  0 001074   200020 221300                    LDX1  ! IOCHANX+2,,AUTO
         0 001075   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:60   
(unnamed)
 Sect OctLoc
   1     000   000030 006000   000000 000031   000003 006000   000001 006000    ................
   1     004   777777 773777   100000 000000   000000 000425   000027 400000    ....@...........
   1     010   000002 006000   000000 006000   000002 006000   000002 006000    ................
   1     014   000005 006000   000006 006000                                    ........
      388     2548
      389     2549    2   END WRITECONFIG ;
      390     2550    1   END NIX$CHANCONFIG;

PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:61   
--  Include file information  --

   TD_ERRORS_C.:E05TOU  is referenced.
   TD$CP6V_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   IT$CONFIG.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIX$CHANCONFIG.
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:62   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @NEWLA                     3-0-0/w PTR         r     1 @PAR
     4-0-0/w PTR         r     1 @RESULTS                  15-0-0/w BIT         r     1 CHANENTRY
     6-0-0/w PTR         r     1 DCT$                       7-0-0/w PTR         r     1 DEVDCT$
    10-0-0/w PTR         r     1 DQH$                      23-0-0/w SBIN        r     1 I
    23-0-0/w SBIN        r     1 I                         21-0-0/w SBIN        r     1 I
    16-0-0/c STRC(9)     r     1 IOCHAN                    16-0-0/c UBIN(9)     r     1 IOCHANX
    24-0-0/w SBIN        r     1 J                         25-0-0/w SBIN        r     1 K
    26-0-0/w SBIN        r     1 KEND                      11-0-0/w PTR         r     1 MPCDCT$
    *0-0-0/w BIT         r     1 NEWLA                     *0-0-0/w PTR         r     1 PAR
    *0-0-0/d STRC(72)    r     1 RESULTS                   27-0-0/w BIT         r     1 SAMELA
    12-0-0/w PTR         r     1 SQH$                      22-0-0/w PTR         r     1 SYSDCT$
    23-0-0/w PTR         r     1 SYSSQH$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 B_SCDCTX                   0-0-0/d STRC(936)   r     1 IT_CONFIG
     0-0-0/w UBIN        r     1 IT_SYSDISK                 0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$CHT$
     0-0-0/w PTR         r     1 NI$CONNECT$                0-0-0/w PTR         r     1 NI$FQ$
     0-0-0/w PTR         r     1 NI$IBUF$                   0-0-0/w PTR         r     1 NI$RP$
     0-0-0/w BIT         r     1 NI_CHANCONFIG              0-0-0/w UBIN        r     1 NK_MXLOCAL
     0-0-0/w UBIN        r     1 S_TIMR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:63   

     0-0-0/w STRC(72)    r     1 CHT(0:127)                 0-0-0/w STRC(1332)  r     1 DCT
     0-0-0/w STRC(648)   r     1 DQH                        0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/w STRC(144)   r     1 NI$CONNECT                 0-0-0/w STRC(252)   r     1 SQH
     0-0-0/w STRC(252)   r     1 SYSSQH


   Procedure NIX$CHANCONFIG requires 574 words for executable code.
   Procedure NIX$CHANCONFIG requires 32 words of local(AUTO) storage.

    No errors detected in file NIX$CONFIG.:E05TSI    .
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:64   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:65   
          MINI XREF LISTING

ALT
      2334**LABEL    2321--CALLALT  2322--CALLALT
ALT IN PROCEDURE CHANCONFIG
      2377**LABEL    2348--CALLALT  2362--CALLALT
ALT IN PROCEDURE DEVCONFIG
      2433**LABEL    2391--CALLALT  2406--CALLALT  2420--CALLALT
B_SCDCTX
      2164**DCL      2394<<ASSIGN
CHANCONFIG
      2341**PROC     2321--CALL
CHANENTRY
      2239**DCL      2250<<ASSIGN   2295<<ASSIGN   2321>>IF
CHT.DQH$
      2063**DCL      2476>>IF       2476>>IF       2476>>IF
COMMON_CONFIG
      2305**LABEL    2253--GOTO
DCT
      2109**DCL      2520<>CALL     2544<>CALL
DCT.DCTX
      2110**DCL      2394>>ASSIGN
DCT.DFLG.MPCSTOP
      2114**DCL      2521>>DOWHILE
DCT.DFLG.RELOAD
      2113**DCL      2519<<ASSIGN
DCT.DP
      2129**DCL      2136--REDEF    2139--REDEF    2140--REDEF    2142--REDEF    2142--REDEF    2143--REDEF
      2144--REDEF    2144--REDEF
DCT.DQH$
      2125**DCL      2297>>ASSIGN   2298>>ASSIGN   2386>>IF       2386>>IF       2401>>IF       2401>>IF
      2415>>IF       2415>>IF       2446>>ASSIGN
DCT.MPC.CRPNAME
      2139**DCL      2367>>ASSIGN
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:66   
DCT.MPC.FWNAME
      2139**DCL      2351>>ASSIGN   2365>>ASSIGN
DCT.MPC.IOCHANX
      2137**DCL      2137--REDEF    2473>>ASSIGN
DCT.MPC.LPNAME
      2139**DCL      2366>>ASSIGN
DCT.MSG#
      2129**DCL      2538<>CALL
DCT.SQH$
      2124**DCL      2514>>ASSIGN
DCT.STATUS.DOWN
      2126**DCL      2443>>IF       2517>>IF       2542>>IF
DCT.TYPE
      2119**DCL      2383>>DOCASE   2443>>IF       2443>>IF
DCT$
      2232**DCL      2109--IMP-PTR  2296<<ASSIGN   2297>>ASSIGN   2298>>ASSIGN   2383>>DOCASE   2386>>IF
      2386>>IF       2401>>IF       2401>>IF       2415>>IF       2415>>IF       2443>>IF
DEVCONFIG
      2381**PROC     2322--CALL
DEVDCT$
      2233**DCL      2394>>ASSIGN   2445<<ASSIGN   2446>>ASSIGN
DQH.IOCHAN.CHANNEL
      2089**DCL      2343>>IF       2357>>IF       2386>>IF       2401>>IF       2415>>IF
DQH.IOCHAN.IOM
      2089**DCL      2343>>IF       2357>>IF       2386>>IF       2401>>IF       2415>>IF
DQH.IOCHANX
      2088**DCL      2089--REDEF    2446>>ASSIGN   2474>>IF
DQH.LA
      2096**DCL      2476>>IF       2476>>IF
DQH.MBX$
      2097**DCL      2098--REDEF
DQH.MPC$
      2093**DCL      2476>>IF       2476>>IF
DQH.SQH$
      2092**DCL      2252>>ASSIGN
DQH.STATUS.DOWN
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:67   
      2086**DCL      2476>>IF
DQH$
      2234**DCL      2086--IMP-PTR  2251<<ASSIGN   2252>>ASSIGN   2297<<ASSIGN   2343>>IF       2343>>IF
      2357>>IF       2357>>IF       2474>>IF       2476>>IF       2476>>IF
FINDALTDEV
      2437**PROC     2391--CALL     2406--CALL     2420--CALL
FINDALTPATH
      2456**PROC     2348--CALL     2362--CALL
HFC$LOCK
        71**DCL-ENT  2305--CALL     2315--CALL     2332--CALL     2528--CALL
HFC$UNLOCK
        71**DCL-ENT  2311--CALL     2325--CALL     2336--CALL     2535--CALL
I IN PROCEDURE FINDALTDEV
      2439**DCL      2441<<DOINDEX  2442>>IF       2443>>IF       2443>>IF       2445>>ASSIGN
I IN PROCEDURE FINDALTPATH
      2458**DCL      2470<<DOINDEX  2471>>IF       2473>>ASSIGN   2480>>ASSIGN
I IN PROCEDURE WRITECONFIG
      2509**DCL      2516<<DOINDEX  2517>>IF       2517>>IF       2519>>ASSIGN   2520>>CALL     2521>>DOWHILE
      2541<<DOINDEX  2542>>IF       2542>>IF       2544>>CALL
IOCHAN.CHANNEL
      2243**DCL      2350>>ASSIGN   2353>>ASSIGN   2364>>ASSIGN   2369>>ASSIGN   2393>>ASSIGN   2396>>ASSIGN
      2408>>ASSIGN   2410>>ASSIGN   2422>>ASSIGN   2424>>ASSIGN
IOCHAN.IOM
      2242**DCL      2349>>ASSIGN   2352>>ASSIGN   2363>>ASSIGN   2368>>ASSIGN   2392>>ASSIGN   2395>>ASSIGN
      2407>>ASSIGN   2409>>ASSIGN   2421>>ASSIGN   2423>>ASSIGN
IOCHANX
      2240**DCL      2241--REDEF    2446<<ASSIGN   2473<<ASSIGN   2474>>IF       2474>>IF       2476>>IF
      2476>>IF       2476>>IF
IT_CONFIG.CR01.CHAN
      2205**DCL      2415>>IF       2418>>ASSIGN   2422<<ASSIGN
IT_CONFIG.CR01.IOM
      2204**DCL      2415>>IF       2417>>ASSIGN   2421<<ASSIGN
IT_CONFIG.DC01.CHAN
      2216**DCL      2343>>IF       2346>>ASSIGN   2350<<ASSIGN
IT_CONFIG.DC01.FWNAME
      2217**DCL      2351<<ASSIGN
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:68   
IT_CONFIG.DC01.IOM
      2215**DCL      2343>>IF       2345>>ASSIGN   2349<<ASSIGN
IT_CONFIG.GATE
      2224**DCL      2305<>CALL     2311<>CALL     2315<>CALL     2325<>CALL     2332<>CALL     2336<>CALL
IT_CONFIG.LP01.CHAN
      2202**DCL      2401>>IF       2404>>ASSIGN   2408<<ASSIGN
IT_CONFIG.LP01.IOM
      2201**DCL      2401>>IF       2403>>ASSIGN   2407<<ASSIGN
IT_CONFIG.SC01.CHAN
      2193**DCL      2386>>IF       2389>>ASSIGN   2393<<ASSIGN
IT_CONFIG.SC01.IOM
      2192**DCL      2386>>IF       2388>>ASSIGN   2392<<ASSIGN
IT_CONFIG.UC01.CHAN
      2196**DCL      2357>>IF       2360>>ASSIGN   2364<<ASSIGN
IT_CONFIG.UC01.CRPNAME
      2199**DCL      2367<<ASSIGN
IT_CONFIG.UC01.FWNAME
      2197**DCL      2365<<ASSIGN
IT_CONFIG.UC01.IOM
      2195**DCL      2357>>IF       2359>>ASSIGN   2363<<ASSIGN
IT_CONFIG.UC01.LPNAME
      2198**DCL      2366<<ASSIGN
IT_SYSDISK
      2226**DCL      2513>>ASSIGN   2538<>CALL
J IN PROCEDURE FINDALTPATH
      2459**DCL      2472<<DOINDEX  2473>>ASSIGN
K IN PROCEDURE FINDALTPATH
      2460**DCL      2469<<DOINDEX
KEND IN PROCEDURE FINDALTPATH
      2461**DCL      2464<<ASSIGN   2465<<ASSIGN   2469>>DOINDEX
MPCDCT$
      2235**DCL      2351>>ASSIGN   2365>>ASSIGN   2366>>ASSIGN   2367>>ASSIGN   2480<<ASSIGN
N$DCT$
       686**DCL      2442>>IF       2443>>IF       2443>>IF       2445>>ASSIGN   2513>>ASSIGN
N$DCT$$
       552**DCL       686--IMP-PTR  2442>>IF       2443>>IF       2443>>IF       2445>>ASSIGN   2513>>ASSIGN
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:69   
N$FQ$
       552**DCL       687--IMP-PTR
N$REQ_INIT.BUFADDR
       571**DCL       572--REDEF     572--REDEF
N$REQ_INIT.DLA.DRELADDR
       563**DCL       563--REDEF
N$REQ_INIT.DVE.EOMCHAR
       600**DCL       601--REDEF
N$REQ_INIT.EAINFO
       594**DCL       594--REDEF
N$REQ_INIT.EAINFOX
       594**DCL       595--REDEF
N$REQ_INIT.EVNTINFO
       595**DCL       595--REDEF
N$REQ_INIT.STATUS
       576**DCL       582--REDEF
NEWLA
      2044**DCL        16--PROC     2464>>IF       2467>>ASSIGN
NI$CHT$
       611**DCL      2063--IMP-PTR  2476>>IF       2476>>IF       2476>>IF
NI$CONNECT.GATE
      2074**DCL      2528<>CALL     2535<>CALL
NI$CONNECT$
       611**DCL      2074--IMP-PTR  2528>>CALL     2535>>CALL
NI$FQ$
       612**DCL       688--IMP-PTR
NI$IBUF$
       612**DCL       688--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
       622**DCL       623--REDEF     623--REDEF
NI$IMXMBX_INIT.SIZE
       624**DCL       624--REDEF
NI$REQ_INIT.DCW
       646**DCL       649--REDEF
NI$REQ_INIT.DCW.TALLY
       647**DCL       647--REDEF
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:70   
NI$REQ_INIT.IDCW.EXTA
       649**DCL       649--REDEF
NI$REQ_INIT.PCW
       651**DCL       655--REDEF
NI$REQ_INIT.SEEK
       656**DCL       657--REDEF     658--REDEF
NI$RP$
       660**DCL       690--IMP-PTR
NIM$CHNGAARD
      2054**DCL-ENT  2530--CALL
NIW$MPCSTART
      2055**DCL-ENT  2544--CALL
NIW$MPCSTOP
      2056**DCL-ENT  2520--CALL
NI_CHANCONFIG
       660**DCL      2309>>DOWHILE  2319<<ASSIGN   2334<<ASSIGN
NI_MBX_INIT.DCW.CONTROL.AE
       682**DCL       682--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
       678**DCL       678--REDEF
NK_MXLOCAL
      2227**DCL      2441>>DOINDEX
OCI$MK_WRTM
      2057**DCL-ENT  2538--CALL
PAR
      2045**DCL        16--PROC     2251--ASSIGN   2257--ENTRY    2296--ASSIGN
RESULTS
      2047**DCL        16--PROC     2257--ENTRY
RESULTS.BOOTINFO
      2048**DCL      2245<<ASSIGN   2290<<ASSIGN
RESULTS.BOOTINFO.ERR
      2048**DCL      2532<<ASSIGN   2537>>IF
RESULTS.BOOTINFO.NEW
      2048**DCL      2328>>IF       2354<<ASSIGN   2370<<ASSIGN   2397<<ASSIGN   2411<<ASSIGN   2425<<ASSIGN
RESULTS.BOOTINFO.NEWCHAN
      2049**DCL      2353<<ASSIGN   2369<<ASSIGN   2396<<ASSIGN   2410<<ASSIGN   2424<<ASSIGN
PL6.E3A0      #001=NIX$CHANCONFIG File=NIX$CONFIG.:E05TSI                        WED 07/30/97 03:41 Page:71   
RESULTS.BOOTINFO.NEWIOM
      2049**DCL      2352<<ASSIGN   2368<<ASSIGN   2395<<ASSIGN   2409<<ASSIGN   2423<<ASSIGN
RESULTS.BOOTINFO.OLD
      2048**DCL      2347<<ASSIGN   2361<<ASSIGN   2390<<ASSIGN   2405<<ASSIGN   2419<<ASSIGN
RESULTS.BOOTINFO.OLDCHAN
      2048**DCL      2346<<ASSIGN   2360<<ASSIGN   2389<<ASSIGN   2404<<ASSIGN   2418<<ASSIGN
RESULTS.BOOTINFO.OLDIOM
      2048**DCL      2345<<ASSIGN   2359<<ASSIGN   2388<<ASSIGN   2403<<ASSIGN   2417<<ASSIGN
SAMELA IN PROCEDURE FINDALTPATH
      2462**DCL      2467<<ASSIGN   2476>>IF       2486<<ASSIGN   2486>>ASSIGN
SQH.DOOR
      2157**DCL      2157--REDEF
SQH.MPC$
      2159**DCL      2471>>IF       2473>>ASSIGN   2480>>ASSIGN
SQH$
      2236**DCL      2157--IMP-PTR  2252<<ASSIGN   2298<<ASSIGN   2471>>IF       2473>>ASSIGN   2480>>ASSIGN
SSR$REG
      2058**DCL-ENT  2313--CALL     2522--CALL
SYSDCT$ IN PROCEDURE WRITECONFIG
      2510**DCL      2513<<ASSIGN   2514>>ASSIGN   2538>>CALL
SYSSQH.DOOR IN PROCEDURE WRITECONFIG
      2504**DCL      2504--REDEF
SYSSQH.MPC$ IN PROCEDURE WRITECONFIG
      2506**DCL      2517>>IF       2517>>IF       2519>>ASSIGN   2520>>CALL     2521>>DOWHILE  2542>>IF
      2542>>IF       2544>>CALL
SYSSQH$ IN PROCEDURE WRITECONFIG
      2511**DCL      2504--IMP-PTR  2514<<ASSIGN   2517>>IF       2517>>IF       2519>>ASSIGN   2520>>CALL
      2521>>DOWHILE  2542>>IF       2542>>IF       2544>>CALL
S_TIMR
      2228**DCL      2247>>IF       2292>>IF
WRITECONFIG
      2493**PROC     2329--CALL
