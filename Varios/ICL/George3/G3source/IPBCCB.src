  10 22FL     SEG  IPBCCB,,PHILIP TURNER 
  17 22_=    [    (C) COPYRIGHT INTERNATIONAL COMPUTERS LIMITED 1982 
  16 23DW    #LIS           K0IPBCCB>K0IPB>K0ALLGEO>K0GREATGEO   
  10 23YG                   8HIPBCCB70   
  10 24D6          SEGENTRY K1IPBCCB,XK1 
   6 24XQ    #UNS  CLSKI 
   9 25CB    ZTEMK          #40000007
   9 25X2    XMSK1          #77000   
   9 26BL    XMSK7          #77000777
   9 26W=    XMSK9          #777000  
   9 27*W    XMSK33         #40000020
   9 27TG    XMSK37         #44000002
   9 28*6    XMSK46         #4000001 
   9 28SQ    XMSK47         #70000001
   9 29#B    XMSK48         #7770000 
   9 29S2    XMSK49         #30004312
   9 2=?L    XMSK50         #40000040
   9 2=R=    ZIN            #2400000 
   9 2?=W    ZOUT           #4300000 
  15 2?QG    TABLE BRN      S0                  [INITIALISE  
  16 2#=6          BRN      S1                  [ARE YOU THERE   
   8 2#PQ          BRN      XCC3 
   8 2*9B          BRN      XCC3 
   8 2*P2          BRN      XIL17
   8 2B8L          BRN      XIL17
   8 2BN=          BRN      XIL17
   8 2C7W          BRN      XIL17
   8 2CMG          BRN      XIL17
  15 2D76          BRN      S9                  [CLOSE DOWN  
   8 2DLQ          BRN      XCC3 
   8 2F6B          BRN      XCC3 
  18 2FL2          BRN      XCC3                 [CONFIGURATION REQUEST  
   8 2G5L          BRN      XIL17
   8 2GK=          BRN      XIL17
  13 2H4W          BRN      XCC3               [NULL 
  14 2HJG          BRN      XCC3                 [OPEN   
   8 2J46          BRN      XCC3 
   8 2JHQ          BRN      XCC3 
   8 2K3B          BRN      XCC3 
   8 2KH2          BRN      XCC3 
   8 2L2L          BRN      XIL17
  14 2LG=          BRN      XCC3                 [CLOSE  
  15 2L_W          BRN      XCC3                 [CRASH CLOSE
  15 2MFG          BRN      XCC3                 [CHANGE MODE
  16 2M_6          BRN      XCC3                 [SET PRIORITY   
   8 2NDQ          BRN      XIL17
   8 2NYB          BRN      XIL17
   8 2PD2          BRN      XIL17
   8 2PXL          BRN      XIL17
   8 2QC=          BRN      XIL17
   8 2QWW          BRN      XIL17
  16 2RBG          BRN      S32                 [(CANCEL ATTACH) 
  14 2RW6          BRN      S33                 [(ATTACH)
   8 2S*Q          BRN      XCC3 
   8 2STB          BRN      XCC3 
   8 2T*2          BRN      NFREE
  14 2TSL          BRN      S37                 [ILLEGAL 
   8 2W#=          BRN      NFREE
   8 2WRW          BRN      NFREE
  21 2X?G          BRN      S43A                [(OPERABLE ROUTINE RETURN ADDRESS)   
  15 2XR6          BRN      S41                 [DATA LOST   
  15 2Y=Q          BRN      S42                 [(INOPERABLE)
  15 2YQB          BRN      S43                 [(OPERABLE)  
  21 2_=2          BRN      S42A                [(INOPERABLE ROUTINE RETURN ADDRESS) 
  15 2_PL          BRN      XSET                [LINE CHANGED
   8 329=          BRN      NFREE
  13 32NW          BRN      NFREE               [NULL
  17 338G          BRN      S48                 [IDENTIFIER OPENED   
  16 33N6          BRN      S49                 [CLOSE IDENTIFIER
  14 347Q          BRN      S50                 [WARNING 
  14 34MB          BRN      S51                 [CONTINUE
  16 3572          BRN      S52                 [INPUT CLEARED   
  13 35LL          BRN      S53                 [FAIL
  17 366=          BRN      S54                 [CLOSE IMPLEMENTED   
   8 36KW          BRN      NFREE
  15 375G          BRN      S56                 [MODE CHANGED
  16 37K6          BRN      S57                 [DEVICE AVAILABLE
  17 384Q          BRN      S58                 [DEVICE UNAVAILABLE  
  16 38JB          BRN      S59                 [IDENTIFIER FREE 
  15 3942          BRN      S60                 [OUTPUT SENT 
   6 39HL    #UNS  CLSKI 
   4 3=3=    (   
  15 3=GW          BRN      ZRTDH              [CC AH RETURN 
  14 3?2G          BRN      ZRELE               [RELEASE 
   4 3?G6    )   
  21 3?_Q    VRCLO SMO     A1+FPTR(2)          [SET CLOSED AND IF NOT CLOSED SET CLOS
   9 3#FB          LDX   0  FOURTHWD 
   8 3#_2          SRL   0  12   
   7 3*DL          ANDN  0  4
   7 3*Y=          ERN   0  5
  11 3BCW          ORS   0  A1+IDSTATUS(2)   
   7 3BXG          EXIT  5  0
  12 3CC6    WARN  HUNT2J   1,AMXOR,IOUT,6,(5)   
  17 3CWQ    SVAN  LDX   6  1                   [BY-PASS FIRST BLOCK 
  15 3DBB    SVARN LDX   2  4                   [CONDCB ENTRY
  12 3DW2          HUNT2J   1,AMXOR,IOUT,6,(5)   
   9 3F*L          LDX   0  IPBIDE(1)
  15 3FT=          ANDN  0  #7777               [IDENT NO.   
  10 3G#W          TXU   0  A1+IDNUM(2)  
  17 3GSG          BCS      SVAN                [J IF NOT SAME IDENT.
   9 3H#6          LDX   6  BPTR(1)  
   7 3HRQ          BCHX  1  /
  16 3J?B          LDCH  0  IPBIDE(1)           [SUPERVISORY CODE
   9 3JR2          ANDX  1  BITS22LS 
   7 3K=L          EXIT  5  1
  16 3KQ=    [                                  FREE SAVED BLOCKS
   4 3L9W    VWR 
   7 3LPG          LDX   4  2
  16 3M96          CALL  5  SVARN               [FIND NEXT BLOCK 
   8 3MNQ          BRN      ZX33 
   8 3N8B          ERN   0  24   
  19 3NN2          BNZ   0  S50V                [J TO FREE BLOCK IF NOT CM   
   7 3P7L          LDCT  0  1
  16 3PM=          SBS   0  A1+IDSTATUS+1(2)    [DECREMENT CM CT.
  15 3Q6W          BRN      S50V                [FREE BLOCK  
   8 3QLG    ZX33  LDX   1  FX1  
   7 3R66          EXIT  3  0
   8 3RKQ    WVREE LDX   2  FX2  
  18 3S5B ...      LDX   0  A1+IDNUM(3)            [LOWEST IDENT NUMBER  
   9 3SK2          STO   0  AWORK2(2)
   8 3T4L          BRN      ZXVRE
  20 3TJ=    ZCLCK LDX   0  ZTEMK(1)            [CHECK WHETHER COSED ,AND CM CT  
  11 3W3W          ANDX  0  A1+IDSTATUS(2)   
   7 3WHG          ERN   0  1
  18 3X36          BNZ   0  ZEX2                [J IF NOT ENTIRELY CLOSED
   8 3XGQ          LDCT  0  #77  
  11 3Y2B          ANDX  0  A1+IDSTATUS+1(2) 
  17 3YG2          BZE   0  (5)                 [EXIT IF CM CT ZERO  
   7 3Y_L    ZEX1  EXIT  5  1
   7 3_F=    ZEX2  EXIT  5  2
  21 3_YW    ZTESCLO                            [DEAL WITH CLOSE-DOWN AND INITIALISE 
   8 42DG          LDCT  0  #20  
  11 42Y6          ANDX  0  A1+IDSTATUS(3)   
  19 43CQ          BZE   0  ZEX1                [EXIT 1 IF NOT CLOSING DOWN  
   7 43XB          LDN   0  1
  19 44C2          SBS   0  A1+IDSTATUS(3)      [DECREASE CLOSE-DOWN COUNT   
  11 44WL          LDEX  0  A1+IDSTATUS(3)   
  18 45B=          BNZ   0  (5)                 [EXIT IF CD CT NOT ZERO  
   8 45TW          LDCT  0  #40  
  11 46*G          ANDX  0  A1+IDSTATUS(3)   
  18 46T6          BZE   0  (5)                 [EXIT UNLESS INITIALISING
   8 47#Q          LDCT  0  #20  
  16 47SB          ERS   0  A1+IDSTATUS(3)      [UNSET CLOSE-DOWN
  19 48#2          LDN   6  #140                [ SUPERVISORY CODE ^READY^   
   7 48RL          LDN   5  8
  18 49?=          BRN      XCCA                [SEND READY TO PROGRAM   
   8 49QW    ZFREE LDX   2  FX2  
   9 4==G          STOZ     AWORK2(2)
   9 4=Q6    ZXVRE STO   4  AWORK3(2)
  11 4?9Q    XFREE MHUNTW   1,AMXOR,ICONIN   
  10 4?PB          LDX   6  ALOGLEN(1)   
   7 4#92          FREECORE 1
  20 4#NL          SBS   6  INLOAD(2)           [DECREMENT INPUT OVERLOAD COUNT  
   7 4*8=          EXIT  5  0
   8 4*MW    XIL1  LDN   4  #100 
   8 4B7G          BRN      XILL 
   8 4BM6    XIL2  LDN   4  #200 
   8 4C6Q          BRN      XILL 
   8 4CLB    XIL7  LDN   4  #700 
   8 4D62          BRN      XILL 
   8 4DKL    XIL17 LDN   4  #2100
   8 4F5=          BRN      XILL 
   8 4FJW    XIL18 LDN   4  #2200
   8 4G4G          BRN      XILL 
   8 4GJ6    XIL19 LDN   4  #2300
   8 4H3Q          BRN      XILL 
   8 4HHB    XIL28 LDN   4  #3400
   8 4J32          LDN   0  #200 
  17 4JGL          ORS   0  A1+IDSTATUS(2)      [SET C-OSE IDENTIFIER
  16 4K2=    XILL  LDN   5  0                   [INPUT ILLEGAL   
   8 4KFW          BRN      XCCA 
   7 4K_G    OUTM  LDCT  0  1
  19 4LF6          ADS   0  A1+IDSTATUS+1(2)    [INCREMENT CHANGE MODE COUNT 
   8 4LYQ          LDCT  4  #200 
   7 4MDB          LDN   3  4
   8 4MY2          BRN      OUTV 
   8 4NCL    OUTY  NGN   0  #101 
  17 4NX=          ANDS  0  A1+IDSTATUS(2)      [UNSET ONE SHOT INPUT
   8 4PBW          BNZ   4  OUTW 
  10 4PWG    OUTX  LDCH  0  A1+IDADIN(3) 
  20 4QB6          BNZ   0  (5)                 [J. IF INPUT OVERLOAD SITUATION  
   7 4QTQ    OUTW  LDN   3  3
   8 4R*B    OUTV  SBX   5  FX1  
  16 4RT2          DOWN     IPBCCC,1            [PASS BLOCK ON   
  11 4S#L          MHUNTW   2,AMXOR,CONDCB   
  15 4SS=          LDX   3  2                   [CONDCB ADDR 
  19 4T?W          ADX   2  7                   [ADDR OF ENTRY FOR THIS IDENT
   7 4TRG          LDX   6  2
   7 4W?6          ADX   5  1
   7 4WQQ          EXIT  5  0
   8 4X=B    XSC1  LDN   0  #2000
  15 4XQ2          ERS   0  A1+IDSTATUS(2)      [FLIP FREE   
   9 4Y9L    XSCAN ADN   7  CONDCBLEN
  10 4YP=          TXL   7  ALOGLEN(3)   
  18 4_8W          BCS      XSCRM               [J IF NOT FINISHED BLOCK 
   8 4_NG          LDX   0  CACT 
   8 5286          SMO      FX2  
  20 52MQ          ANDS  0  CONREL              [UNSET RETURN ADDRESS FOR IPBCCA 
  17 537B          BRN      NXTBL               [J IF FINISHED SCAN  
   5 53M2    XSCRM   
   7 546L          LDX   2  3
   7 54L=          ADX   2  7
   7 555W          LDN   0  1
   8 55KG          SMO      FX2  
   9 5656          ADS   0  AWORK2   
  11 56JQ          LDX   0  A1+IDSTATUS(2)   
   9 574B          ANDX  0  XMSK48(1)
   8 57J2          SMO      FX2  
  20 583L          BXU   0  AWORK3,XSCAN        [J. UNLESS ATTACHED TO THIS IPB  
  11 58H=          LDX   0  A1+IDSTATUS(2)   
   7 592W          EXIT  5  0
   9 59GG    XCLOS ANDX  4  BITS22LS 
   8 5=26    RCLCL LDCT  5  #20  
  11 5=FQ          ANDX  5  A1+IDSTATUS(3)   
  11 5=_B          ORS   0  A1+IDSTATUS(3)   
  18 5?F2          BZE   5  ZCLNAL              [J IF NOT ALREADY CL DOWN
  17 5?YL          BPZ   4  (4)                 [EXIT IF NOT RELEASE 
   8 5#D=          ORX   4  CACT 
   8 5#XW          LDN   5  #777 
   5 5*CG    ZCLNAL  
  21 5*X6          LDCT  0  #570                [UNSET STOP REMOTE INPUT AND ZEROISE 
   7 5BBQ          ORX   0  5
  19 5BWB          ANDS  0  A1+IDSTATUS(3)      [SRI AND CLOSE DOWN COUNTS   
   9 5CB2    XCL1  ADN   7  CONDCBLEN
  18 5CTL          BXGE  7  ALOGLEN(3),(4)      [J. IF END OF CONDCB SCAN
   7 5D*=          LDX   2  3
   7 5DSW          ADX   2  7
  10 5F#G          LDX   0  A1+BPTR(2)   
  18 5FS6          BZE   0  XCL1B               [J. IF NULL IDENTIFIER   
   8 5G?Q          SMO      FX2  
  15 5GRB          STO   4  ACOMMUNE9           [SAVE LINK   
  14 5H?2          LDX   6  3                   [CONDCB  
  17 5HQL          CALL  3  VWR                 [FREE SAVED BLOCKS   
   7 5J==          LDX   3  2
  17 5JPW          SBX   3  7                   [RESTORE CONDCB ADDR.
   8 5K9G          SMO      FX2  
  15 5KP6          LDX   4  ACOMMUNE9           [RESTORE LINK
  11 5L8Q          LDX   0  A1+IDSTATUS(2)   
   8 5LNB          ANDN  0  #400 
  17 5M82          BZE   0  XCL4                [J IF CCAH NOT SET   
  18 5MML          BPZ   4  (4)                 [FINISH UNLESS RELEASING 
   8 5N7=          BRN      XCL3 
  11 5NLW    XCL4  LDX   0  A1+IDSTATUS(2)   
   8 5P6G          ANDN  0  #3000
  18 5PL6          BZE   0  XCL5                [J IF NOT INOP NOR FREE  
   8 5Q5Q          CALL  5  VRCLO
   8 5QKB          NGN   0  #201 
  17 5R52          ANDS  0  A1+IDSTATUS(2)      [UNSET CLOSE IDENT   
   8 5RJL          BPZ   4  XCL1 
   8 5S4=    XCLVT CALL  5  ZCLCK
  17 5SHW          BRN      XCL1                [J IF OK TO RELEASE  
   8 5T3G          NGN   0  #3001
  16 5TH6          ANDS  0  A1+IDSTATUS(2)      [UNSET INOP,FREE 
  11 5W2Q          LDX   0  A1+IDSTATUS(2)   
  20 5WGB          ANDN  0  2                   [CR CL BIT STILL IN X0 IF EXIT 2 
  18 5X22          BZE   0  XCL2                [J IF NOT CRASH CLOSING  
   8 5XFL          BRN      XCL3 
  11 5X_=    XCL5  LDX   0  A1+IDSTATUS(2)   
   7 5YDW          SRC   0  1
  16 5YYG          BNG   0  XCL1D               [J IF CLOSED SET 
   7 5_D6          ANDN  0  1
   8 5_XQ          BZE   0  XCL2 
   8 62CB    XCL6A LDCT  0  #200 
   7 62X2          ANDX  0  4
  20 63BL          BZE   0  XCL3                [J UNLESS ALREADY CLOSING DOWN   
   8 63W=          BRN      XCLAL
   8 64*W    XCL1B NGN   5  #401 
  11 64TG    XCL1C ANDS  5  A1+IDSTATUS(2)   
   8 65*6          BRN      XCL1 
   7 65SQ    XCL1D SRC   0  1
  18 66#B          BNG   0  XCL6A               [J. IF CRASH CLOSING SET 
   7 66S2          SRC   0  1
  15 67?L          BNG   0  XCL2                [J IF CLOSING
   7 67R=          SLC   0  3
  16 68=W          BNG   0  XCL2                [J IF OPENING[   
   8 68QG          BPZ   4  XCL1 
   8 69=6          LDCT  0  #77  
  11 69PQ          ANDX  0  A1+IDSTATUS+1(2) 
  16 6=9B          BZE   0  XCL1                [J IF CM CT ZERO 
   8 6=P2          BRN      XCL3 
   7 6?8L    XCL2  NGNC  0  1
  11 6?N=          ANDS  0  A1+IDSTATUS(2)   
   7 6#7W          LDN   0  3
  11 6#MG          ORS   0  A1+IDSTATUS(2)   
  16 6*76    [                                   SET CR CL,CLOSED
  17 6*LQ          LDN   6  #127                [OUTPUT CRASH CLOSE  
   8 6B6B          SBX   4  FX1  
   2 6BL2
   8 6C5L          CALL  5  OUTW 
   8 6CK=          ADX   4  FX1  
   7 6D4W    XCL3  LDN   0  1
  19 6DJG          ADS   0  A1+IDSTATUS(3)      [INCREMENT CLOSE DOWN COUNT  
  17 6F46          BPZ   4  XCL1                [J UNLESS RELEASING  
   8 6FHQ    XCLAL LDN   0  #401 
  20 6G3B          ORS   0  A1+IDSTATUS(2)     [SET CANCEL-ATTACH IF RELEASING   
   6 6GH2    #UNS  AHRET 
   4 6H2L    (   
   9 6HG=          SEGENTRY K91IPBCCB
   9 6H_W          LDN   0  AHRETREL 
  18 6JFG          BNZ   0  XCL1                [J IF AH TO BE RETAINED  
   8 6J_6          LDN   0  #400 
  11 6KDQ          ORS   0  A1+IDSTATUS+1(2) 
   4 6KYB    )   
   8 6LD2          BRN      XCL1 
  11 6LXL    [*****  K1 ENTRY POINT ******   
   4 6MC=    XK1 
  11 6MWW          MHUNTW   2,AMXOR,CONDCB   
   7 6NBG          LDX   3  2
   7 6NW6          ADX   2  7
   7 6P*Q          SMO      6
  18 6PTB          BRN      TABLE               [J. ON SUPERVISORY CODE  
   7 6Q*2    S0    LDN   6  2
   7 6QSL    S0A   LDX   0  4
   8 6R#=          ANDN  0  #7777
   7 6RRW          SBN   0  4
   8 6S?G          BNG   0  XIL18
   9 6SR6          SEGENTRY K50IPBCCB
   9 6T=Q          SBN   0  INPUSIZE 
  21 6TQB          BPZ   0  XIL18               [ILLEGAL 18 IF BUFFER SIZES NOT IN   
  17 6W=2          SRC   4  12                  [RANGE 4 TO NPUSIZE+3
   8 6WPL          BCT   6  S0A  
  10 6X9=          STO   4  A1+IDMDNPU(3)
  20 6XNW          LDCT  0  #60                 [SET INITIALISE AND CLOSE DOWN   
  18 6Y8G          CALL  4  XCLOS               [CLOSE ALL IDENTIFIERS   
   8 6YN6          LDN   5  15   
   8 6_7Q    SETV  LDCT  6  #200 
  10 6_MB          SMO      A1+BPTR(3)   
   9 7272          ANDX  6  IPSTATUS 
  19 72LL          BNZ   6  XCCA                [J. IF INTERNAL CLOSE DOWN   
   8 736=          LDN   6  #140 
   8 73KW          LDCT  0  #20  
   8 745G    SETW  LDN   1  #777 
  11 74K6    SETS  ANDX  1  A1+IDSTATUS(3)   
  20 754Q          BNZ   1  XCCA                [J. UNLESS RELEVANT COUNT ZERO   
   7 75JB          SBN   5  1
  11 7642    SETP  ERS   0  A1+IDSTATUS(3)   
   4 76HL    XCCA
   9 773=          ACROSS   IPBCCD,1 
  17 77GW    S1    LDN   6  #141                [OUTPUT ACKNOWLEDGE  
   8 782G          LDN   5  14   
   8 78G6          BRN      XCCA 
   8 78_Q    S9    SMO      FX2  
   9 79FB          LDX   3  IPBRING  
   9 79_2          SBN   3  IPBRING  
  19 7=DL    ZHJ   HUNT2J   3,AMXOR,ICONIN,,NOCONIN [FIND ICONINS AFTER OLPA 
  20 7=Y=          FREECORE 3                   [FREE THEM (ALL DATA DISCARDED   
  16 7?CW                                       [...AT CLOSE DOWN
  13 7?XG                                       [)   
  17 7#C6          BRN      S9                  [ GO TO SEE ANY MORE 
   5 7#WQ    NOCONIN 
  11 7*BB          MHUNTW   2,AMXOR,CONDCB   
   7 7*W2          LDX   3  2
  20 7B*L          ADX   2  7                   [RESET ACCS TO CONTINUE CLOSEDOWN
   8 7BT=          LDCT  0  #20  
   9 7C#W          NGX   5  XMSK46(1)
  21 7CSG          ANDS  5  A1+IDSTATUS(3)      [UNSET INITIALISE AND SET CLOSE DOWN 
  18 7D#6          CALL  4  XCLOS               [CLOSE ALL IDENTIFIERS   
   8 7DRQ    XBACK LDN   5  15   
   8 7F?B          BRN      XCCA 
  17 7FR2    S16X  ORS   5  A1+IDSTATUS(2)      [SET APPROPRIATE BITS
   8 7G=L    XKEEP LDX   6  GSIGN
   7 7GQ=          LDN   5  4
   9 7H9W          ACROSS   IPBCCA,2 
   7 7HPG    S23W  LDN   5  3
   8 7J96          BRN      S16X 
   6 7JNQ    #UNS  CLSKI 
   4 7K8B    #SKI
   4 7KN2    (   
  11 7L7L    S32   LDX   0  A1+IDSTATUS(2)   
   9 7LM=          NGX   5  XMSK47(1)
  21 7M6W          ANDS  5  A1+IDSTATUS+1(2)    [UNSET OUTPUT SENT,CHANGE MODE,NPU   
   8 7MLG          SRC   0  11   
  20 7N66          BXL   0  BITS22LS,S32A       [J. UNLESS INOPERABLE OR FREE SET
   8 7NKQ          NGN   0  #2001
  15 7P5B          ANDS  0  A1+IDSTATUS(2)      [UNSET FREE  
   8 7PK2    S32C  CALL  5  XFREE
   8 7Q4L          LDN   5  11   
   8 7QJ=          BRN      XCCA 
   8 7R3W    S32A  SLC   0  10   
   8 7RHG          LDN   6  #127 
  17 7S36          BPZ   0  S32B                [J. UNLESS CLOSED SET
   7 7SGQ          SRC   0  1
  18 7T2B          BNG   0  NFREE               [J. IF CRASH CLOSING SET 
   7 7TG2          SRC   0  1
  18 7T_L          BPZ   0  S32C                [J. UNLESS CLOSING SET   
  17 7WF=          CALL  5  OUTW                [OUTPUT CRASH CLOSE  
   8 7WYW          BRN      NFREE
  17 7XDG    S32B  CALL  5  OUTW                [OUTPUT CRASH CLOSE  
  11 7XY6          LDX   0  A1+IDSTATUS(2)   
  17 7YCQ          BNG   0  NFREE               [J. IF OPENING SET   
   8 7YXB          CALL  5  XFREE
   7 7_C2          LDN   5  6
   8 7_WL          BRN      XCCA 
   4 82B=    )   
   6 82TW    #UNS  CLSKI 
   4 83*G    (   
   8 83T6    S32   LDN   0  #400 
  11 84#Q          ANDX  0  A1+IDSTATUS(2)   
  19 84SB          BZE   0  NALDI               [J UNLESS ID ALREADY BEING...
  19 85#2    [                                   ...DISCONNECTED FROM PROGRAM
  11 85RL          ORS   0  A1+IDSTATUS+1(2) 
  19 86?=    [                                   ENSURE TO BE DETACHED IS SET
   8 86QW          LONGON #133   
   8 87=G          BRN      NFREE
   5 87Q6    NALDI   
  18 889Q    [                                   J IF CC AH ALREADY SET  
   9 88PB          NGX   0  XMSK47(1)
  18 8992          ANDS  0  A1+IDSTATUS+1(2)   [CLEAR OUTPUT SENT,CM,NPU 
  16 89NL          LDX   4  2                  [SAVE CONDCB ADDR 
  15 8=8=          CALL  5  XFREE              [FREE ICONIN  
   7 8=MW          LDX   2  4
   8 8?7G          CALL  5  ZCLCK
   9 8?M6          BRN      XCCA25   
   9 8#6Q          BRN      XCCA26   
  19 8#LB          BCT   0  XCCA26              [J UNLESS JUST BIT 23 NEEDED 
   8 8*62          LDCT  0  #77  
  11 8*KL          ANDX  0  A1+IDSTATUS+1(2) 
  17 8B5=          BNZ   0  XCCA26              [J IF CM CT NON ZERO 
  10 8BJW          SMO      A1+BPTR(2)   
   9 8C4G          LDX   0  FOURTHWD 
   8 8CJ6          ANDX  0  BIT9 
   9 8D3Q          BNZ   0  XCCA25   
  15 8DHB    [                                  J IF CLOSED  
   5 8F32    XCCA26  
   8 8FGL          LDN   5  26   
   8 8G2=          BRN      XCCA 
   5 8GFW    XCCA25  
   8 8G_G          LDN   5  25   
   8 8HF6          BRN      XCCA 
  17 8HYQ    ZRTDH                              [RETURN FROM IPBCCA  
   8 8JDB    YSCLO CALL  5  ZCLCK
  15 8JY2          BRN      NXTBE               [J IF CLOSED 
  17 8KCL          BRN      NXTBE               [REGARDLESS OF CM CT 
  11 8KX=          LDX   0  A1+IDSTATUS(2)   
   8 8LBW          ANDN  0  #3000
  17 8LWG          BNZ   0  S321                [J IF INOP OR FREE   
  21 8MB6          CALL  5  ZTESCLO             [DEAL WITH CLOSEDOWN AND INITIALISE  
  17 8MTQ          BRN      NXTBE               [J IF CLOSING DOWN   
   7 8N*B          LDX   6  3
   8 8NT2          CALL  3  VWR  
  18 8P#L    [                                   FREE ANY SAVED BLOCKS   
   7 8PS=          LDX   3  2
  17 8Q?W          SBX   3  7                   [RESET CONDCB POINTER
   7 8QRG    S321  LDN   0  1
  15 8R?6          ORS   0  A1+IDSTATUS(2)      [SET CLOSED  
  11 8RQQ          LDX   0  A1+IDSTATUS(2)   
   7 8S=B          ANDN  0  2
   8 8SQ2          BNZ   0  NXTBE
   7 8T9L          LDN   0  2
  17 8TP=          ORS   0  A1+IDSTATUS(2)      [SET CRASH CLOSING   
   8 8W8W          LDN   6  #127 
  16 8WNG          CALL  5  OUTW                [SEND CRASH CLOSE
   8 8X86    NXTBE NGN   0  #3001
  16 8XMQ          ANDS  0  A1+IDSTATUS(2)      [UNSET INOP,FREE 
   8 8Y7B          BRN      NXTBL
   4 8YM2    )   
  10 8_6L    S33   SMO      A1+IDADIN(2) 
   8 8_L=          LDX   0  IPBSW
  16 925W          BPZ   0  SOK33               [J IF NOT INOP   
   8 92KG          LDN   0  #1000
  14 9356          ORS   0  A1+IDSTATUS(2)      [SET INOP
   8 93JQ          BRN      NFREE
  11 944B    SOK33 LDX   0  A1+IDSTATUS(2)   
   8 94J2          SRC   0  11   
  19 953L          BXGE  0  BITS22LS,NFREE      [J. IF INOPERABLE OR FREE SET
   8 95H=          SLC   0  10   
  16 962W          BPZ   0  NFREE               [J. UNLESS CLOSED
   8 96GG          NGN   0  #201 
  18 9726          ANDS  0  A1+IDSTATUS(2)      [UNSET CLOSE IDENTIFIER  
   8 97FQ          CALL  5  XFREE
  18 97_B          LDN   6  #173                [INPUT IDENTIFIER FREE   
   7 98F2          LDN   5  7
   8 98YL          BRN      XCCA 
   4 99D=    S37 
   9 99XW          ACROSS   IPBCCC,2 
   8 9=CG    S41   LDCT  0  #60  
  11 9=X6          ANDX  0  A1+IDSTATUS(3)   
  21 9?BQ          BNZ   0  NFREE               [J. IF INITIALISE OR CLOSE DOWN SET  
   8 9?WB          BRN      XSET 
  20 9#B2    S42   CALL  5  WVREE               [FREE ICONIN AND SETUP IDENT CT. 
   7 9#TL          BCHX  2  /
   8 9**=          LDN   0  44   
  21 9*SW          DCH   0  CONREL(2)           [SET RETURN ADDR. IN CASE USE IPBCCA 
   8 9B#G    S42NE CALL  5  XSCAN
   8 9BS6          ANDN  0  #3400
  18 9C?Q          BZE   0  TENAL               [J IF NOT INOP,FREE,CCAH 
   7 9CRB          LDX   5  0
   8 9D?2          ANDN  5  #400 
  17 9DQL          BNZ   5  S42NE               [IGNORE IF CC AH SET 
   7 9F==          LDX   5  0
   8 9FPW          ANDN  5  #2000
  16 9G9G          ERS   5  A1+IDSTATUS(2)      [LEAVE FREE UNSET
   8 9GP6          ANDN  0  #1000
  19 9H8Q          SLL   0  1                   [SET FREE IF INOP ALREADY SET
   8 9HNB          ORN   0  #1000
  15 9J82          ORS   0  A1+IDSTATUS(2)      [SET INOP.   
  17 9JML          BRN      S42NE               [GO ON TO NEXT IDENT 
  17 9K7=    TENAL CALL  5  ZCLCK               [CHECK STATE OF IDENT
  19 9KLW          BRN      S42A                [J IF CLOSED AND CM CT ZERO  
  17 9L6G          BRN      ZCLINCM             [J IF CM CT NONZERO  
  21 9LL6          CALL  5  ZTESCLO             [DEAL WITH CLOSE-DOWN AND INITIALISE 
  17 9M5Q          BRN      S42A                [J IF CLOSING DOWN   
   5 9MKB    ZCLINCM 
   8 9N52          LDN   5  26   
  17 9NJL          BRN      XCCA                [GO TO TELL PROGRAM  
  18 9P4=    S42A                               [RETURN HERE FROM IPBCCA 
   7 9PHW          LDX   6  3
  21 9Q3G          CALL  3  VWR                 [DEAL WITH BLOCKS SAVED FOR WARNING  
   7 9QH6          LDX   3  2
   7 9R2Q          SBX   3  7
  19 9RGB          LDXC  0  A1+IDSTATUS(2)      [SET CLOSED IF OPENING SET   
   8 9S22          LDN   0  #1000
  16 9SFL          ORS   0  A1+IDSTATUS(2)      [SET INOPERABLE  
  17 9S_=          BRN      S42NE               [GO ON TO NEXT IDENT 
  14 9TDW    S43                                [OPERABLE
  21 9TYG          CALL  5  WVREE               [FREE ICONIN AND PRESET IDENT COUNT  
   7 9WD6          BCHX  2  /
   8 9WXQ          LDN   0  40   
  21 9XCB          DCH   0  CONREL(2)           [SET RETURN ADDR. IN CASE GO TO IPBCA
  19 9XX2    S43NE CALL  5  XSCAN               [FIND NEXT RELEVANT IDENT.   
   8 9YBL          LDN   0  #400 
  11 9YW=          ANDX  0  A1+IDSTATUS(2)   
  17 9_*W          BNZ   0  S42NE               [IGNORE IF CCAH SET  
   8 9_TG          LDN   0  #2000
  11 =2*6          ANDX  0  A1+IDSTATUS(2)   
  18 =2SQ          BNZ   0  S436                [J IF FREE ALREADY SET   
  17 =3#B          CALL  5  ZCLCK               [CHECK STATE OF IDENT
  18 =3S2          BRN      S431                [CLOSED AND CM CT ZERO   
  18 =4?L          BRN      S434                [CLOSED AND CM CT NONZERO
  15 =4R=    [                                   NOT CLOSED  
   7 =5=W          LDN   0  2
  11 =5QG          ANDX  0  A1+IDSTATUS(2)   
  19 =6=6          BNZ   0  S434                [J IF ALREADY CRASH CLOSING  
   8 =6PQ          LDN   6  #127 
  15 =79B          CALL  5  OUTW                [CRASH CLOSE 
   7 =7P2          LDN   0  2
  17 =88L          ORS   0  A1+IDSTATUS(2)      [SET CRASH CLOSING   
   8 =8N=    S434  LDN   0  #2000
  14 =97W          ORS   0  A1+IDSTATUS(2)      [SET FREE
  17 =9MG    S43A                               [RETURN FROM IPBCCA  
   8 ==76    S433  NGN   0  #1001
  15 ==LQ    S4361 ANDS  0  A1+IDSTATUS(2)      [UNSET INOP  
  16 =?6B          BRN      S43NE               [GO TO NEXT IDENT
  15 =?L2    S436  NGN   0  #2001               [UNSET FREE  
   8 =#5L          BRN      S4361
   8 =#K=    S431  LDN   0  #200 
  11 =*4W          ANDX  0  A1+IDSTATUS(2)   
  18 =*JG          BZE   0  S433                [J IF CLOSE IDENT NOT SET
  14 =B46          ERS   0  A1+IDSTATUS(2)      [UNSET IT
  16 =BHQ          LDN   6  #173                [IDEN FREE CODE  
   7 =C3B          LDN   5  8
  18 =CH2          BRN      XCCA                [TELL PROGRAM IDENT FREE 
   8 =D2L    S48   LDXC  0  GSIGN
   9 =DG=          NGX   0  XMSK50(1)
  18 =D_W          ANDS  0  A1+IDSTATUS(2)      [UNSET OPENING,WARNING   
   8 =FFG          SRL   4  12   
   8 =F_6          ANDN  4  #4000
  19 =GDQ          ORS   4  A1+IDSTATUS(2)      [REMEMBER DEVICE AVAILABILITY
   8 =GYB          LDCT  4  #200 
  11 =HD2          ANDX  4  A1+IDSTATUS+1(2) 
  18 =HXL          BNZ   4  S48B                [J. IF CHANGE MODE SET   
   7 =JC=          LDN   0  6
  11 =JWW          ANDX  0  A1+IDSTATUS(2)   
  20 =KBG          BNZ   0  S48B                [J IF CLOSING OR CRASH CLOSING   
   8 =KW6          LDN   0  #200 
  11 =L*Q          ANDX  0  A1+IDSTATUS+1(2) 
  19 =LTB          ERS   0  A1+IDSTATUS+1(2)    [UNSET M4DETERMINED MARKER   
  20 =M*2          BNZ   0  ZN4                 [J IF M4STATUS ALREADY DETERMINED
   7 =MSL          LDX   0  5
   8 =N#=          SRL   0  15   
   7 =NRW          ANDN  0  7
   7 =P?G          SBN   0  4
   8 =PR6          LDN   6  #100 
  11 =Q=Q          ORS   6  A1+IDSTATUS+1(2) 
  14 =QQB          BZE   0  ZN4                 [J IF  M4
  14 =R=2          ERS   6  A1+IDSTATUS+1(2)    [UNSET M4
   4 =RPL    ZN4 
  10 =S9=          LDX   6  A1+IDMDNPU(3)
   8 =SNW          SRL   6  12   
   7 =T8G          SBN   6  3
   8 =TN6          ANDN  5  #7777
  20 =W7Q          BXGE  6  5,S48A              [J. IF I/P BUFFER SIZE-4>NPUSIZE 
  16 =WMB          CALL  5  OUTM                [CHANGE NPUSIZE  
  16 =X72    S48B  ERS   4  A1+IDSTATUS+1(2)    [FLIP CHANGE MODE
  11 =XLL    S48A  LDX   0  A1+IDSTATUS(2)   
   7 =Y6=          SRC   0  9
  19 =YKW          BPZ   0  XOPEN                [J. UNLESS CANCEL ATTACH SET
   7 =_5G          LDN   5  9
   8 =_K6          BRN      XCCA 
   8 ?24Q    XOPEN BRN      XSET 
   8 ?2JB    S49   LDN   1  #200 
   8 ?342    S49X  LDN   0  1(1) 
  11 ?3HL    S49Y  ANDX  0  A1+IDSTATUS(2)   
   8 ?43=          BNZ   0  NFREE
  11 ?4GW          ERS   1  A1+IDSTATUS(2)   
   7 ?52G    XSET  LDN   5  3
   8 ?5G6          BRN      XCCA 
   8 ?5_Q    S50 LDN   0  #100   
  11 ?6FB          ANDX  0  A1+IDSTATUS+1(2) 
  21 ?6_2          BNZ   0  XSET                  [J IF MOP MODE 4 TO JUST PASS ON   
  10 ?7DL          SMO      A1+IDADIN(2) 
   9 ?7Y=          LDX   6  IPBRING  
  16 ?8CW          SBN   6  IPBRING             [IPBOUT ADDRESS  
   7 ?8XG          LDX   4  2
   7 ?9C6          LDN   0  2
  11 ?9WQ          ANDX  0  A1+IDSTATUS(2)   
  18 ?=BB          BZE   0  S501                [J IF NOT CRASH CLOSING  
   8 ?=W2    S50CC CALL  5  WARN 
  19 ??*L    S50CA BRN      S509                [J IF NO MORE FOR THIS IDENT 
   8 ??T=          SBN   0  23   
  16 ?##W          BZE   0  S509                [J IF CRASH CLOSE
  18 ?#SG          BNG   0  S50V                [J IF NOT SET PRI NOR CM 
   7 ?*#6          SBN   0  3
   8 ?*RQ          BNG   0  S50V 
   7 ?B?B          LDX   6  1
  16 ?BR2    [                                   POINT PAST BLOCK
   8 ?C=L          BRN      SVARN
   4 ?CQ=    S50V
  10 ?D9W          LDX   0  ALOGLEN(1)   
  21 ?DPG          LDXC  2  IMOPTY(1)           [SET C IF  CONTINUE SEG BEING REFLECT
  18 ?F96          LDX   2  FX2                 [FX2 + 1 FOR CONTINUE SEG
  21 ?FNQ          SBS   0  IOUTLOAD(2)         [INLOAD (= IOUTLOAD + 1) FOR CONTINUE
   7 ?G8B          FREECORE 1
  17 ?GN2          BRN      SVARN               [LOOK FOR NEXT SEG   
   7 ?H7L    S501  LDN   0  4
  11 ?HM=          ANDX  0  A1+IDSTATUS(2)   
  19 ?J6W          BNZ   0  NFREE               [IGNORE WARNING IF CLOSING   
   8 ?JLG          SMO      FX2  
   9 ?K66          LDX   3  ACTRING  
   9 ?KKQ          SBN   3  ACTRING  
  17 ?L5B          CALL  5  WARN                [LOOK FOR OUTPUT SEGS
  16 ?LK2          BRN      S506                [J IF NONE LEFT  
   9 ?M4L          LDXC  0  IMOPTY(1)
  17 ?MJ=          BCS      S50V                [FREE CONTINUE BLOCK 
   8 ?N3W          BNG   7  S503 
   9 ?NHG          LDCH  0  IPBIDE(1)
  17 ?P36          BNZ   0  SVAN                [J IF SUPERVISORY SEG
  10 ?PGQ          LDX   0  IPBIDE+1(1)  
   8 ?Q2B          ANDX  0  CACT 
  17 ?QG2          BZE   0  SVAN                [J IF NOT END OF NPU 
   4 ?Q_L    S502
  17 ?RF=          ORX   7  GSIGN               [SET END OF NPU FOUND
  16 ?RYW          BRN      SVAN                [J FOR NEXT BLOCK
   4 ?SDG    S503
  17 ?SY6          CHAIN    1,BPTR(3)           [RECHIN AFTER CONDCB 
  17 ?TCQ          BRN      SVARN               [LOOK FOR MORE BLOCKS
   4 ?TXB    S506
   7 ?WC2          LDXC  7  7
  18 ?WWL          BCS      S509                [J IF FOUND AN END OF NPU
   8 ?XB=          LDCT  0  #100 
  11 ?XTW          ANDX  0  A1+IDSTATUS+1(2) 
  16 ?Y*G          BZE   0  S509                [J UNLESS NPU SET
   8 ?YT6          LDN   0  #40  
  11 ?_#Q          ORS   0  A1+IDSTATUS+1(2) 
   8 ?_SB          BRN      S5092
  19 #2#2    S509  BNG   7  S23W                [J IF CAME FROM CRASH CLOSE  
   8 #2RL          LDN   0  #40  
  15 #3?=          ORS   0  A1+IDSTATUS(2)      [SET WARNING 
   5 #3QW    S5092   
   8 #4=G          LDN  0  #20   
  11 #4Q6          ANDX  0  A1+IDSTATUS+1(2) 
  21 #59Q          BZE   0  XSET                [J UNLESS STILL REFLECTING CONTINUE  
  11 #5PB          ERS   0  A1+IDSTATUS+1(2) 
  21 #692          BRN      NFREE               [DO NOT PASS ON IF STILL REFLECTING C
  14 #6NL    S51                                [CONTINUE
   8 #78=          LDN   0  #100 
  11 #7MW          ANDX  0  A1+IDSTATUS+1(2) 
  19 #87G          BNZ   0  XSET                [JUST PASS ON IF MODE 4 MOP  
  11 #8M6          MHUNTW   1,AMXOR,ICONIN   
   9 #96Q          LDX   0  IMOPTY(1)
  18 #9LB          BNG   0  S51N                [J IF REFLECTED BY IPBOUT
  11 #=62          LDX   0  A1+IDSTATUS(2)   
  11 #=KL          ORX   0  A1+IDSTATUS+1(2) 
   8 #?5=          ANDN  0  #40  
  21 #?JW          BZE   0  NFREE               [IGNORE CONTINUE IF WARNING NOT SET  
   7 ##4G          LDN   0  2
  11 ##J6          ANDX  0  A1+IDSTATUS(2)   
  18 #*3Q          BZE   0  S51Y                [J IF NOT CRASH CLOSING  
   8 #*HB          NGN   0  #41  
  11 #B32          ANDS  0  A1+IDSTATUS(2)   
   8 #BGL          BRN      S51NY
   8 #C2=    S51Y  NGN   0  #41  
  16 #CFW          ANDS  0  A1+IDSTATUS(2)      [UNSET WARNING   
  15 #C_G          ANDS  0  A1+IDSTATUS+1(2)    [AND WARNNPU 
   7 #DF6          LDX   6  3
   7 #DYQ          LDX   4  2
  10 #FDB          SMO      A1+IDADIN(2) 
   9 #FY2          LDX   3  IPBRING  
  16 #GCL          LDX   3  ACTRING-IPBRING(3)  [ACT AFTER IPBOUT
   9 #GX=          SBN   3  ACTRING  
  17 #HBW          CALL  5  SVARN               [FIND SAVED BLOCKS   
  15 #HWG          BRN      S519                [J IF NONE   
  17 #JB6          ANDN  0  #76                 [IGNORE B23 IF CCOSE 
   8 #JTQ          ERN   0  22   
   8 #K*B          BNZ   0  S51SC
  16 #KT2    [                                   J IF NOT CLOSE  
   7 #L#L          LDN   5  0
  16 #LS=    S51SC CHAIN    1,BPTR(3)           [PASS TO IPBOUT  
  21 #M?W          BNZ   5  SVARN               [GET NEXT BLOCK UNLESS JUST HAD CLOSE
  15 #MRG    S519  LDX   2  4                   [CONDCB ADDR 
  13 #N?6          SMO      A1+IDADIN(2)        [AMOP
   9 #NQQ          LDX   2  IPBRING  
  14 #P=B          SBN   2  IPBRING             [IPBOUT  
   8 #PQ2          LDCT  0  #100 
   9 #Q9L          ANDX  0  IPBSW(2) 
  17 #QP=          BZE   0  ZIPBAWAKE           [J IF IPBOUT AWAKE   
   9 #R8W          ERS   0  IPBSW(2) 
  16 #RNG          FPUT                         [ELSE WAKE IT UP 
   6 #S86    ZIPBAWAKE   
   7 #SMQ          LDX   2  4
   8 #T7B          BNG   7  S54CI
  11 #TM2          MHUNTW   1,AMXOR,ICONIN   
   7 #W6L          LDX   2  4
  11 #WL=          LDX   0  A1+IDSTATUS(2)   
   7 #X5W          ANDN  0  6
  20 #XKG          BNZ   0  S51NY                [J IF CLOSING OR CRASH CLOSING  
  18 #Y56          NAME     1,AMXOR,IOUT        [RENAME AS OUTPUT BLOCK  
  10 #YJQ          LDX   0  A1+IDNUM(2)  
   9 #_4B          DSA   0  IPBIDE(1)
   8 #_J2          LDN   0  #20  
  16 *23L          ORS   0  A1+IDSTATUS+1(2)    [SET REFLECTING  
   8 *2H=          LDCT  0  #400 
   7 *32W          ORN   0  1
  19 *3GG          STO   0  IMOPTY(1)           [SET SO IPBOUT REFLECTS IT   
  16 *426          CHAIN    1,BPTR(3)           [PASS TO IPBOUT  
   8 *4FQ          BRN      NXTBL
   8 *4_B    S51N  LDN   0  #40  
  11 *5F2          ANDX  0  A1+IDSTATUS(2)   
  19 *5YL          BNZ   0  NFREE               [IGNORE IF WARNING NOW SET   
   8 *6D=          LDN   0  #20  
  11 *6XW          ANDX  0  A1+IDSTATUS+1(2) 
  19 *7CG          BZE   0  NFREE               [FREE IF NREFLECTING NOT SET 
  17 *7X6          ERS   0  A1+IDSTATUS+1(2)     [UNSET REFLECTING   
  21 *8BQ    S51NY STOZ     IMOPTY(1)           [[B0 HAS DIFFERENT MEANING FOR CONIPB
  17 *8WB          UNLOCK   1                   [WAS LOCKED BY IPBOUT
  17 *9B2          BRN      XSET                [PASS ON TO PROGRAM  
  11 *9TL    S51X  ANDX  1  A1+IDSTATUS(2)   
   8 *=*=          BZE   1  NFREE
   8 *=SW          BRN      S49Y 
  11 *?#G    S52   LDX   0  A1+IDSTATUS(2)   
   7 *?S6          SRC   0  4
  18 *#?Q          BPZ   0  NFREE               [J. UNLESS NOT CLEARED   
   8 *#RB          NGN   5  #11  
  17 **?2          ANDS  5  A1+IDSTATUS(2)      [UNSET NOT CLEARED   
   8 **QL          LDN   5  #20  
  15 *B==          ORS   5  A1+IDSTATUS(2)      [SET STOPPED 
   8 *BPW          LDCT  5  #200 
  11 *C9G          ANDX  5  A1+IDSTATUS(3)   
  19 *CP6          BZE   5  XSET                [J. IF STOP REMOTE INPUT SET 
   7 *D8Q          SLC   0  5
  17 *DNB          BPZ   0  S52A                [J. UNLESS SRI SET   
   8 *F82          CALL  5  XFREE
   7 *FML          LDN   5  1
   8 *G7=          BRN      XCCA 
   8 *GLW    S52A  LDCT  0  #200 
  14 *H6G          ORS   0  A1+IDSTATUS(2)      [SET SRI 
   7 *HL6          LDN   5  2
   8 *J5Q          BRN      XCCA 
  15 *JKB    S53   LDN   1  #4000                  [FAIL CODE
  18 *K52          ORS   1  A1+IDSTATUS(2)         [ENSURE UNAVAIL SET   
  18 *KJL          BRN      XSET                   [PASS ON TO PROGRAM   
   8 *L4=    S54   LDCT  5  #20  
  11 *LHW          ANDX  5  A1+IDSTATUS(3)   
  18 *M3G          BZE   5  S54C                [J. UNLESS CLOSE DOWN SET
  11 *MH6    S54D  LDX   0  A1+IDSTATUS(2)   
   7 *N2Q          SRC   0  1
  16 *NGB          BNG   0  S54A                [J. IF CLOSED SET
   7 *P22          NGNC  0  7
  11 *PFL          ANDS  0  A1+IDSTATUS(2)   
   7 *P_=          LDN   0  1
  15 *QDW          ORS   0  A1+IDSTATUS(2)      [SET CLOSED  
   8 *QYG    S54A  CALL  5  XFREE
   8 *RD6          LDN   5  19   
   7 *RXQ    S54X  LDN   0  1
  19 *SCB          SBS   0  A1+IDSTATUS(3)      [DECREMENT CLOSE DOWN COUNT  
   8 *SX2    ZS54X LDCT  0  #40  
  11 *TBL          ANDX  0  A1+IDSTATUS(3)   
  18 *TW=          BZE   0  XCCA                [J. UNLESS INITIALISE SET
   8 *W*W          BRN      SETV 
  11 *WTG    S54C  LDX   0  A1+IDSTATUS(2)   
   8 *X*6          ORX   7  GSIGN
  20 *XSQ          BRN      S51Y                [RELEASE BLOCKS SAVED FOR WARNING
   9 *Y#B    S54CI ANDX  7  BITS22LS 
   7 *YS2          LDX   3  2
  17 *_?L          SBX   3  7                   [RESET CONDCB ADDR.  
  11 *_R=          LDX   0  A1+IDSTATUS(2)   
   7 B2=W          ANDN  0  6
   8 B2QG          LDN   5  23   
  20 B3=6          BNZ   0  SETT                [J. IF CLOSING OR CRASH CLOSING  
   8 B3PQ    S54B  CALL  5  XFREE
   8 B49B          LDN   5  24   
   8 B4P2          BRN      XCCA 
   4 B4WT ...S56 
   8 B54N ...      LDCT  0  #77  
  11 B5=H ...      ANDX  0  A1+IDSTATUS+1(2) 
   8 B5DB ...      BZE   0  S56B 
   7 B5L9 ...      LDCT  0  1
  11 B5S4 ...      SBS   0  A1+IDSTATUS+1(2) 
   4 B5_X ...S56B
   8 B67W          LDCT  0  #200 
  11 B6MG          ANDX  0  A1+IDSTATUS+1(2) 
   8 B776          LDN   5  #400 
  11 B7LQ          ANDX  5  A1+IDSTATUS(2)   
  19 B86B          BZE   5  S56A                [J. UNLESS CANCEL ATTACH SET 
  19 B8L2    S56Y  BZE   0  NFREE               [J. UNLESS CHANGE MODE SET   
   8 B95L    S56X  LDN   5  13   
   8 B9K=          BRN      XCCA 
  19 B=4W    S56A  BZE   0  XSET                [J. UNLESS CHANGE MODE SET   
  11 B=JG          ERS   0  A1+IDSTATUS+1(2) 
  11 B?46          LDX   0  A1+IDSTATUS(2)   
  17 B?HQ          BNG   0  XSET                [J. IF OPENING SET   
   8 B#3B    NFREE CALL  5  XFREE
   8 B#H2    NXTBL LDN   5  17   
   8 B*2L          BRN      XCCA 
   8 B*G=    S57   LDN   1  #4000
   8 B*_W    S57X  LDN   0  #2401
   8 BBFG          BRN      S51X 
   8 BB_6    S58   LDN   1  #4000
   8 BCDQ          BRN      S49X 
   8 BCYB    S59   LDN   1  #200 
   8 BDD2          LDN   0  #2400
   8 BDXL          BRN      S51X 
  11 BFC=    S60   LDX   0  A1+IDSTATUS+1(2) 
  19 BFWW          BPZ   0  S60A                [J. UNLESS OUTPUT SENT SET   
   9 BGBG          ANDX  0  XMSK1(1) 
  19 BGW6          BZE   0  S60B                [J. IF OUTPUT SENT COUNT ZERO
   4 BH3# ...S60A
  11 BH8G ...      LDX   0  A1+IDSTATUS+1(2) 
   9 BH*N ...      ANDX  0  XMSK1(1) 
   8 BHGW ...      BZE   0  XSET 
   8 BHN4 ...      LDN   0  #1000
  19 BHTB          SBS   0  A1+IDSTATUS+1(2)    [DECREMENT OUTPUT SENT COUNT 
   8 BJ*2          BRN      XSET 
   8 BJSL    S60B  LDX   0  GSIGN
  17 BK#=          ERS   0  A1+IDSTATUS+1(2)    [UNSET OUTPUT SENT   
   8 BKRW          CALL  5  XFREE
   8 BL?G          LDN   5  17   
   7 BLR6          LDX   2  3
   7 BM=Q          ADX   2  7
   8 BMQB    SETT  LDCT  0  #100 
  11 BN=2          ANDX  0  A1+IDSTATUS(2)   
  17 BNPL          BZE   0  XCCA                [J. UNLESS EOIO SET  
  11 BP9=          ERS   0  A1+IDSTATUS(2)   
   8 BPNW          LDCT  0  #20  
  11 BQ8G          ANDX  0  A1+IDSTATUS(3)   
  17 BQN6          BNZ   0  XCCA                [J. IF CLOSE DOWN SET
   7 BR7Q          LDN   0  1
  17 BRMB          SBS   0  A1+IDSTATUS(3)      [DECREMENT EOIO COUNT
   7 BS72    SETR  LDN   0  0
  19 BSLL          LDN   6  #143                [INPUT END OF REMOTE OUTPUT  
   8 BT6=          BRN      SETW 
  21 BTKW    ZRELE LDN   4  ZRELS(1)            [RETURN ADDR FROM XCLOS SUBROUTINE   
   8 BW5G          ORX   4  GSIGN
   8 BWK6          LDCT  0  #20  
   9 BX4Q          NGX   5  XMSK46(1)
  11 BXJB          ANDS  5  A1+IDSTATUS(3)   
   8 BY42          BRN      RCLCL
   8 BYHL    ZRELS LDX   0  CACT 
   8 B_3=          SMO      FX2  
   9 B_GW          ORS   0  CONREL   
  16 C22G    [                       LET CPAT(IN CDCIPB)CONTINUE 
  18 C2G6          COOR1                       [WAIT FOR CPA TO RELEASE  
   5 C2_Q    SMNCL   
   8 C3FB          BRN      NXTBL
   4 C3_2    XCC3
   9 C4DL          ACROSS   IPBCCC,3 
  10 C4Y=          MENDAREA 50,K100IPBCCB
   4 C5CW    #END
   6 ____ ...534164630005
