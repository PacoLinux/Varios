  17 22FL ...#SEG  CHARGESC841                  [OWEN N JOHN  :CENT  
   4 22KH ...[   
  15 22PD ...[ (C) COPYRIGHT INTERNATIONAL COMPUTERS LTD 1983
   4 22T* ...[   
   8 22_=    #OPT  K0CHARGESC=0  
  11 23DW    #LIS  K0CHARGESC>K0ALLGEO>K0LLS 
   7 23YG          8HCHARGESC
   4 24D6    #   
  21 24XQ    #     ENTRY POINT FROM BLANKET ACTIVITY TO DETERMINE WHETHER A SPRING   
  21 25CB    #     CLEAN,ENGAGE BUTTON OR CONSOLE INTERRUPT HAS OCCURRED AND TO TAKE 
  10 25X2    #     THE APPROPRIATE ACTION
   4 26BL    #   
  11 26W=          SEGENTRY K1CHARGESC,XX1C  
  11 27*W          SEGENTRY K2CHARGESC,XX2C  
  11 27TG          SEGENTRY K9CHARGESC,XX9C  
  11 28*6          SEGENTRY K7CHARGESC,XX7C  
  11 28SQ          SEGENTRY K13CHARGESC,MRED1
   6 28X* ...#UNS AV7900S
   4 28_Y ...(   
  20 294H ...      SEGENTRY K14CHARGESC,TIMOUTRETUR [RETURN FROM K4VIPBPERI WHICH
  20 2976 ...                                   [TIMES OUT VIRTUAL 7900 TRANSFERS
   4 299P ...)   
  10 29#B          SEGENTRY K90CHARGESC  
   4 29S2    XX1C
   6 2=?L          NULL  
   7 2=*4 ...#UNS  ENHOPER   
   4 2=BG ...(   
  19 2=CY ...      BSON     IGNORENGAGE,TEMS    [IF ENGMESS(X) IN PROGRESS ..
  19 2=FB ...                                   [THEN LEAVE EBA FOR IT TO USE
   4 2=GS ...)   
   7 2=J= ...#UNS  ENHOPER   
  17 2=KN ...#SKI                               [TESTED AT 'NOTOC'   
   4 2=M* ...(   
  10 2=R=          BSON     EMSBIT,TEMS  
   4 2?34 ...)   
   8 2?=W          LDX   5  EBAL 
   7 2?QG          SLL   5  4
   8 2#=6          LDX   3  EBAL 
   7 2#PQ          SLL   3  3
   7 2*9B          ADX   5  3
  19 2*P2          SBN   5  24                  [SO THAT [X5]=([EBAL]-1)*24  
   8 2B8L          LDX   3  EBAL 
  17 2BN=    TEST  LDX   4  EBA-1(3)            [LOAD WORD IN E.B.A  
  17 2C7W          BNZ   4  SFOUND              [JUMP IF ANY BIT SET 
   8 2CMG    NOCO1 SBN   5  24   
  15 2D76          BCT   3  TEST                [ROUND AGAIN 
   4 2DLQ    #   
  18 2F6B    #     IF NO ENGAGE BUTTON BIT FOUND,TEST FOR SPRING CLEAN   
   4 2FL2    #   
  18 2FM3 ...#SKI JSKI34                        [IMPROVED ERROR LOGGING  
   4 2FN4 ...(   
   8 2FP5 ...TEMS  SMO      ELPIA
  18 2FQ6 ...      LDX   3  ELCPT               [LOAD CPPTR WORD OF PIA  
  18 2FR7 ...      BZE   3  TSEAN               [JUMP IF NO ERROR LOGGED 
   9 2FSW ...      JENVNOT TEMSA,DME 
   9 2FWK ...      LDX   0  BELOGACT 
  21 2FY# ...      BZE   0  TSEAN             [DONT ATTEMPT DME ERROR LOGGING UNTIL  
  18 2G23 ...                                 [ACTIVITY FOR IT IS SET UP 
   5 2G3Q ...TEMSA   
  10 2G5F ...      ACROSS   PERFLOGS,3   
   8 2GCR ...TSEAN NGN   5  24   
   4 2GDS ...)   
   7 2GFT ...#SKI  JSKI34<1$1
   8 2GGW ...TEMS  NGN   5  24   
   4 2GHX ...)   
   7 2GH_ ...#UNS   ADUALDME 
   4 2GJ3 ...(   
  20 2GJ5 ...#              CHECK APROCNO FOR ANY PROCESSOR FAILS OR RECOVERIES  
  18 2GJ7 ...#              AND ARRANGE FOR PERFAIL,4 TO OUTPUT MESSAGES 
   4 2GJ9 ...#   
  12 2GJ? ...      MBSXD    0,BPROCFAIL,BPROCREC 
   9 2GJ* ...      ANDX  0  APROCNO  
  21 2GJC ...      BZE   0  SPRCLN              [BR IF NO PROCESSOR FAILS OR RECOVERI
  21 2GJF ...      GETACTOP SPRCLN,IPCA,IPCOP   [OPTIONALLY SETUP ACT. BLOCK BR TO   
  21 2GJH ...                                   [SPRCLN IF NOT SETUP (BLANKET CANNOT 
  16 2GJK ...                                   [WAIT FOR CORE   
   9 2GJM ...      LDX   2  BPTR(2)  
  11 2GJP ...      LINKSET  2,OCPFAILINK(1)  
   6 2GJR ...      FPUT  
   5 2GJT ...SPRCLN  
   4 2GJX ...)   
  21 2GK=          LDX   3  JTIME               [LOAD NO. OF SPRING CLEAN INTERRUPTS 
  19 2H4W          SBX   3  CLEANCT             [SUBTRACT REMEMBERED COUNT   
   8 2HJG          BNZ   3  XX9C 
  20 2J46          STO   5  K5                  [SET K5 NEGATIVE AND COORDINATE  
   6 2JHQ          COOR1Y
   8 2K3B          BRN      XX1C 
   4 2K7? ...#   
  14 2K?8 ...#              ENGAGE BUTTON BIT FOUND SET  
   4 2KC5 ...#   
   5 2KH2    SFOUND  
   7 2L2L          LDN   1  0
   8 2LG=    NEXT  LDCT  6  256  
   8 2L_W          SRL   6  0(1) 
  21 2MFG          BZE   6  NOCO1               [NECESSARY IN CASE WE SKIPPED A BIT  
   9 2M_6          ANDX  6  EBA-1(3) 
   8 2NDQ          BNZ   6  THIS 
   8 2NYB    NOCO2 BUX   1  NEXT 
  20 2PD2    THIS  STO   1  ACOMMUNE7(2)        [DUMP MODS. IN CASE IT IS A FREE 
  20 2PXL          STO   3  ACOMMUNE8(2)        [PERIPHERAL FOR WHICH AN ACTIVITY
  20 2QC=          STO   5  ACOMMUNE9(2)        [CANNOT BE SET UP(I.E. NO CORE)  
  20 2QWW          ADX   5  1                   [X5 NOW GEOG. NO. OF PERIPHERAL  
  16 2RBG          ERS   6  EBA-1(3)            [CLEAR MARKER BIT
  21 2RNX ...      FINDPEREC   3,APINT,5,,,,PZERO        [GET POINTER TO DEVICE LIST 
   5 2S3# ...PZERO   
   9 2S*Q ...#SKI  K6CHARGESC>99-99  
   4 2SFM ...(   
   6 2SKJ ...#UNS ENHOPER
  17 2SPF ...      BSON     EMSBIT,NEMSTRACE    [DON'T TRACE IN EMS  
  10 2STB          TRACE    3,!EBUTTON   
   7 2S_? ...#UNS  ENHOPER   
   6 2T58 ...NEMSTRACE   
   4 2T95 ...)   
  17 2T*2          LTYPE    3,6                 [GET PERIPHERAL TYPE 
   8 2TSL          ERN   6  #77  
  16 2W#=          BNZ   6  NOTOC               [JUMP IF NOT O/C 
   8 2WRW          FON      #50  
   8 2X?G          ON       CONSW
   8 2XR6          BRN      XX1C 
   5 2Y=Q    NOTOC   
   4 2Y=X ...#   
  20 2Y?4 ...#     FOR THE SHARED FILESTORE ENHANCEMENT WE MUST RECOGNISE ENGAGE 
  21 2Y?9 ...#     BUTTONS ON THE IPB (DEVICE TYPE 28) DURING EMS ON THE 'B' MACHINE 
   4 2Y?B ...#   
  21 2Y?H ...#     NB  THIS MODIFICATION RELIES ON THE INCLUSION OF THE DME 'OPER'   
  16 2Y?N ...#     ENHANCEMENT (COMPILED WHEN 'ENHOPER' IS SET)  
   4 2Y?T ...#   
   4 2Y#2 ...#   
   4 2Y*C ...)   
   7 2Y*W ...#UNS  ENHOPER   
   4 2YF2 ...(   
  17 2YFJ ...      BSON     EMSBIT,XX2D         [RE-INSERT BIT IF EMS
   4 2YM= ...)   
  18 2YQB          ACROSS   ENGAGE,1            [DEAL WITH ENGAGE BUTTON 
   4 2YQQ ...#   
   4 2YR6 ...XX2D
   4 2_=2    #   
  20 2_PL    #     ACTIVITY BLOCK CANNOT BE SET UP FOR FREE DEVICE AT THE MOMENT 
   4 329=    XX2C
  15 32NW          LDX   1  ACOMMUNE7(2)        [RESTORE MODS
  10 338G          LDX   3  ACOMMUNE8(2) 
  10 33N6          LDX   5  ACOMMUNE9(2) 
   8 347Q          LDCT  6  256  
   8 34MB          SRL   6  0(1) 
  19 3572          ORS   6  EBA-1(3)            [RE-INSERT ENGAGE BUTTON BIT 
  18 35LL          BRN      NOCO2               [CHECK REMAINING DEVICES 
   4 366=    #   
   4 36KW    #   
  21 375G    #           THIS SEGMENT IS MAINLY CONCERNED WITH A NUMBER OF SPRING CLE
  21 37K6    #     TASKS AND IS ENTERED WHEN GEORGE RECIEVES A PERIODIC INTERRUPT FRO
  21 384Q    #     EXECUTIVE. ALSO CONTAINED IN THIS SEGMENT ARE THE ROUTINES FOR CHA
   8 38JB    #     TIME TO JOBS. 
   4 3942    #   
   4 39HL    #   
  19 3=3=    P4    PAIR     EVENTS,4            [FOR GEORGE INITIATED EVENT  
  21 3?G6    TD5   PAIR     EVENTS,3            [MESSAGE OUTPUT AND VARIOUS UPDATES  
   7 3?JP ...#UNS  ADUALDME  
   4 3?M# ...(   
   6 3?PX ...OCPFAILINK  
  10 3?SG ...      LINK     PERFLOGS,2   
   4 3?X5 ...)   
  20 3?_Q    WTIME          +FONINTP*1000       [TIME BETWEEN WAKE UPS(MILLISECS)
   9 3#_2    TCJC           +CJMOD   
   9 3*DL    SCADJ          +8000000 
   8 3BCW    PK9            +K9  
  17 3BXG    MIDNIGHT       1000*60*60*2/K9*12  [NO. OF K9'S IN 1 DAY
   9 3CWQ    TJDECAY        +FDECAY  
   9 3DBB    XINDIC         #40004000
   8 3DW2    TON            +100 
   8 3F*L    THOU           +1000
  16 3FT=    XINCDT         #10001              [ADTO INCREMENTOR
  17 3FWS ...[     MASK FOR ASTOP BITS ASTOPTIM,ASTOPJOB,ASTOPBIN &  
  12 3FYB ...[     B15-23 (PERIPHERAL FAILURE)   
   4 3F_Y ...[   
   9 3G3G ...MASTOP1        #30004777
   4 3G54 ...[   
  17 3G6L ...[      MASK FOR ASTOP BITS ASTOPEXEC,ASTOPTP,ASTOPPUC & 
  11 3G88 ...[     UNUSED BITS(B4 & B6-11)   
   4 3G9Q ...[   
   9 3G?# ...MASTOP2        #42773000
  19 3G?K ...TOPAMRHP       #40007777           [MAX AMR FOR HI PRI MEMBERS  
  18 3G?N ...TOPAMR         #00007777           [MAX AMR FOR ORD MEMBERS 
   4 3G?W ...[   
   4 3G?_ ...[   
  14 3G#4 ...[ LOCAL IDENTIFIERS FOR WORK SPACE IN BAT   
   4 3G#7 ...[   
   4 3G#= ...[   
  21 3G#D ...#DEF  MILLAVAIL=ACOMMUNE1          [AMOUNT OF MILL TIME AVAILABLE TO THI
   4 3G#W    [   
  12 3GSG    [     EXCEPTION CASES FROM LATER ON 
   4 3H#6    [   
  16 3HRQ    PHAIL                              [SET REMEMBRANCE 
  10 3J?B          BS       ,CDTGAFAIL   
   8 3JR2          BRN      XEND 
   5 3K=L    NOMIN   
  18 3KQ=          JBS      MIDN,,CDTMIDN       [JIF WE MISSED MIDNIGHT  
   9 3L9W          LDX   4  AWORK1(2)
   9 3LPG          BNZ   4  TRYAGAIN 
  19 3M96          JBS      TRYAGAIN,,CDTGAFAIL [J IF GETACT FAILED LAST TIME
   8 3MNQ          BRN      XEND 
   4 3N8B    #   
   4 3NN2    #   
  13 3P7L    #     SUBROUTINES USED IN TIME CHARCING 
   4 3PM=    #   
  21 3Q6W    #     FIRSTLY : CONVERT COUNT OF CHAP CHANGES IN X6,INCLUDING REMAINDER 
  10 3QLG    #     FROM LAST TIME IN X7  
  14 3R66    #     STORE NEW REMAINDER IN ATUSE OF CPA   
  21 3RKQ    #     LINK X4,U3->JOBBLOCK,X2->CPA,INCREMENTS X5 (= TOTAL TIME FOR JOB) 
   5 3S5B    XCHARGE 
   8 3SK2          FCAJO    2,3  
   5 3T4L    XCHARGE1
   9 3TJ=          LDX   7  ATUSE(2) 
   9 3W3W          MPA   6  CHAPTIME 
  16 3WHG          DVD   6  BEATTIME             [CONVERT TIME   
  17 3X36          ADX   5  7                   [INCREMENT TOTAL USED
  16 3XGQ          STO   6  ATUSE(2)            [STORE REMAINDER 
   7 3Y2B          EXIT  4  0
  21 5#F2 ...[ SUBROUTINE TO DECANT PROGRAM TIMERS, CONVERT TO MILLISECONDS,ACCUMULAT
  13 5#F8 ...[ AND UPDATE TIME USED FOR EACH MEMBER. 
  21 5#FB ...[ X1 -> PCA, LINK X7 (MOVED), [ X1 -> PCA, LINK X7 (MOVED), X4,X5,X6,X7 
   5 5#FJ ...TIMERS  
  16 5#FQ ...      STO   7  GEN3                [REMEMBER LINK   
  18 5#FY ...                                   [STARTING AT LAST MEMBER 
  18 5#G6 ...      LDN   7  ATM4-ATM1           [-> MEL RELATIVE TO ATM1 
  16 5#G# ...      LDN   6  4                   [NUMBER OF MEMBER
   7 5#GG ...TM1   SMO      7
   9 5#GN ...      LDXC  5  ASU1(1)  
  15 5#GW ...      BCS      TM2                 [NO MEMBER   
   7 5#H4 ...      SMO      7
  15 5#H= ...      LDX   5  ATM1(1)             [TIME USED   
  18 5#HD ...      DVS   4  BEATTIME            [CONVERT TO MILLISECONDS 
   7 5#HL ...      SMO      7
  16 5#HS ...      STO   4  ATM1(1)             [LEAVE REMAINDER 
   7 5#J2 ...      SMO      6
  15 5#J8 ...      ADS   5  ATU1-1(1)           [TIME USED   
  17 5#JB ...      ADS   5  GEN1                [ACCUMULATE TIME USED
  17 5#JJ ...TM2   SBN   7  ATM2-ATM1           [UPDATE TO NEXT MEL  
  15 5#JQ ...      BCT   6  TM1                 [NEXT MEMBER 
   9 5#JY ...      BRN      (GEN3)   
   4 5#K6 ...[   
  18 5#K# ...[ SUBROUTINE TO CALCULATE NEW RATINGS FOR ALL MEMBERS IN PCA
  19 5#KG ...[X1 -> PCA, LINK X7 (MOVED), X0,X4,X5,X6,X7 DESTROYED, X2=FX2   
  15 5#KN ...[RATING:=K*RATING+(1-K)TIME USED/TIME AVAILABLE 
  17 5#KW ...[FORMATS - K AND RATING ARE FRACTIONS E.G. 1/2=#20000000
  14 5#L4 ...[        - TIMES ARE SINGLE LENGTH INTEGERS 
  21 5#L= ...[RATING FROM THIS CALCULATION IS TRANSFORMED TO FORM USED IN AMR BY :-  
  16 5#LD ...[    A.MULT FRACTION BY 64 -> INTEGER FROM 0 TO 63  
  14 5#LL ...[    B. SUB FROM 63 -> INTEGER FROM 63 TO 0 
  21 5#LS ...[I.E. SMALL MILL USE GIVES LARGE NUMBER AND POSITION NEAR FRONT OF RING.
   4 5#M2 ...[   
  20 5#M5 ...      SEGENTRY K50CHARGESC         [ FOR CPIFORMS RESTORE TIME MACRO
   5 5#M8 ...RATINGS 
  13 5#MB ...      STO   7  GEN3                [LINK
  19 5#MJ ...      LDXC  0  ATU1(1)             [J IF NOT PLUGGED IN DURING  
  16 5#MQ ...      BCC      (GEN3)              [ LAST 1/5 SEC   
  18 5#MY ...      JBS XPLUG,3,JBPLUG           [J IF STILL PLUGGED IN   
   9 5#N6 ...      LDX   0  BITS22LS 
  19 5#N# ...      ANDS  0  ATU1(1)             [CLEAR BEEN PLUGGED IN MARKER
   5 5#NG ...XPLUG   
  20 5#NN ...      LDX   2  1                   [SET X2->PCA TO ACCESS ASU WORDS 
  15 5#NW ...      LDN   7  4                   [4 MEMBERS   
  15 5#P4 ...      LDCT  0  #600                [-> CHAR 3   
  18 5#P= ...      ORX   1  0                   [CHAR PTR TO MILL RATING 
   4 5#PF ...RAT1
  19 5#PL ...      LDXC  0  ASU1(2)             [J IF MEMBER DOESN'T EXIST   
   8 5#PS ...      BCS      RAT4 
  16 5#Q2 ...      LDCH  6  AMR1(1)             [OLD MILL RATING 
  21 5#Q8 ...      LDN   4  63                  [CONVERT TO A FRACTION APPROXIMATING 
  17 5#QB ...      SBX   4  6                   [PROPORTION OF MILL  
  16 5#QJ ...      SRC   4  7                   [MEMBER CAN USE  
  21 5#QQ ...      MPY   4  AMILLDECAY1         [K*RATING AS DOUBLE LENGTH FRACTION  
  20 5#QY ...                                   [MOST SIG PART IN X4 USED ONLY   
  15 5#R6 ...      LDXC  5  ATU1(1)             [TIME USED   
  18 5#R# ...      ERS   5  ATU1(1)             [ATU1 SET IF ALREADY SET 
  21 5#RG ...      MPY   5  AMILLDECAY2         [(1-K)TIME USED AS DOUBLE LENGTH MIXE
  20 5#RN ...                                   [X5 INTEGRAL PART, X6 FRACTIONAL 
  19 5#RW ...      DVR   5  AMILLAVAIL          [QUOTIENT IN X6 IS A FRACTION
   8 5#S4 ...      BVCR     RAT2 
  16 5#S= ...      LDN   6  0                   [MIN POSS RATING 
   8 5#SD ...      BRN      RAT3 
   4 5#SL ...RAT2
   7 5#SS ...      ADX   4  6
  14 5#T2 ...[CONVERT TO INTEGER < 63 - SEE SR ANNOTATION
  17 5#T8 ...      SLC   4  7                   [CONVERT TO ONE CHAR 
   8 5#TB ...      ANDN  4  #77  
   8 5#TJ ...      LDN   6  63   
   7 5#TQ ...      SBX   6  4
  15 5#TY ...RAT3  DCH   6  AMR1(1)             [NEW RATING  
   7 5#W6 ...RAT4  ADN   1  1
   9 5#W# ...      ADN   2  AFW2-AFW1
  15 5#WG ...      BCT   7  RAT1                [NEXT MEMBER 
  15 5#WN ...      SBN   1  4                   [X1 -> PCA   
   8 5#WW ...      LDX   2  FX2  
   9 5#X4 ...      BRN      (GEN3)   
   6 5#X? ...#UNS AV7900S
   4 5#X# ...(   
   4 5#X* ...#   
  21 5#XB ...#     SUBROUTINE TO TEST FOR THE EXISTENCE OF VIRTUAL 7900'S AND IF TRUE
  21 5#XC ...#     TO CALL ON K4VIPBPERI TO PERFORM THE TIMING OUT OF VIRTUAL 7900   
  20 5#XD ...#     WMC TRANSFERS WHICH HAVE BEEN STORED FOR 3 FONINTP SECONDS.   
  11 5#XF ...#     ON EXIT X2 IS -VE OR = FX2
   7 5#XG ...#     LINK IN X7
   6 5#XH ...TIMOUTV7900 
  11 5#XJ ...      HUNTMISB 2,APERI,AV7900   
  21 5#XK ...      BNG   2  (7)                 [NO VIRTUAL 7900 DEVICE LIST PRESENT 
  13 5#XL ...      ACROSS   VIPBPERI,4          [>>>>
  12 5#XM ...#     RETURN IS TO LABEL TIMOUTRETUR
   4 5#XN ...)   
   4 5#XW    [   
   4 5#YJ ...[   
  19 5#_= ...[     SUBROUTINE TO TEST TYPE OF PCA & IF TP TO POINT TO PUC.   
   4 5#_Y ...[   
   5 5*2L ...TESTPCA 
  10 5*3# ...      PCATEST  1,NORM,,PUC  
   8 5*42 ...      FINDPUC  1,1  
   7 5*4N ...PUC   EXIT  7  1
   7 5*5B ...NORM  EXIT  7  0
   4 5*64 ...[   
   4 5*6Q ...[   
  21 5*7D ...[     SUBROUTINE TO LOCATE TP, REMEMBERING IF PUC IS CURRENT ACTIVITY   
   4 5*86 ...[   
   5 5*8S ...TPLOC   
   8 5*9G ...      FPCAJO   2,3  
   9 5*=8 ...      TESTTP   2,TPLOC1 
  17 5*=W ...      LDX   5  2                   [X5 = PUC PCA ADDRESS
   8 5*?J ...      FINDTP   2,2  
   5 5*#= ...TPLOC1  
  14 5*#Y ...      LDX   1  ADATUM(2)           [TP DATUM
   7 5**L ...      EXIT  6  0
   4 5*B# ...[   
  10 5*CG    [  RCTP SPASMODIC INTERRUPTS
   4 5*X6    [   
   7 5BBQ    RCTP  LDN   4  0
  10 5BWB          SBS   3  ASPASMODIC   
  10 5CB2          NGX   0  ASPASMODIC   
  21 5CTL          BNG   0  RCTP1               [JUMP UNLESS TIME FOR SPASMODIC INTER
   9 5D*=          LDX   0  INTERRUPT
  10 5DSW          STO   0  ASPASMODIC   
   7 5F#G          LDN   4  1
   7 5FS6    RCTP1 LDX   7  3
   8 5G?Q          LDN   3  BJOBQ
   9 5GRB    RCTP2 LDX   3  FPTR(3)  
   8 5H?2          TXU   3  CXJO 
  18 5HQL          BCC      RCTP10              [JUMP IF END OF JOB QUEUE
  16 5J==          JBC      RCTP2,3,JBRCTP      [J IF NOT RCTP   
   7 5JPW    RCTP3 LDN   5  0
  20 5K9G          BZE   4  RCTP5               [JUMP IF NO SPASMODIC INTERRUPT  
  17 5KP6          JBC      RCTP2,3,JBSI        [J IF NOT SWAPPED IN 
  15 5L8Q ...      CALL  6  TPLOC               [LOCATE TP   
   8 5NLW          LDCT  0  #10  
  18 5P6G          ORS   0  31(1)               [SET BIT 5 OF TP WORD 31 
  17 5PL6    RCTP5  JBC      RCTP2,3,JBPLUG      [J IF NOT PLUGGED IN
  21 5Q5Q          BNZ   4  RCTP7               [JUMP IF WE HAVE JUST SET TP WORD 31 
  15 5QKB ...      CALL  6  TPLOC               [LOCATE TP   
   8 5T3G          LDX   0  31(1)
  20 5TH6          BZE   0  RCTP2               [JUMP IF NO EVENT TO DEAL WITH   
  20 5W2Q    RCTP7 BNZ   5  RCTP8               [JUMP IF PUC IS CURRENT ACTIVITY 
   9 5WGB          LDX   0  ASU1(2)  
   8 5X22          BZE   0  STP  
   8 5XFL          LDCT  0  #40  
   9 5X_=          ANDX  0  ASU1(2)  
   8 5YDW          BNZ   0  SMP  
  15 5YYG    STP   SETBIT   16,ARM1(2)          [SET 'P' BIT 
   8 5_D6          BRN      RCTP2
  17 5_XQ    SMP   ERS   0  ASU1(2)             [TICKLE TP MEMBER 0  
   8 62CB          BRN      RCTP2
  17 62X2    RCTP8 LDX   6  1                   [PRESERVE TP DATUM   
  17 63BL          LDX   1  5                   [RESTORE PUC PCA ADDR
   9 63W=          LDX   0  ASTOP(1) 
  21 6445 ...      BNG   0  RCTP2               [JUMP IF PUC DEALING WITH AN EVENT   
   4 649Y ...[   
  20 64CR ...[   THE FOLLOWING CORRECTS B2996  WHICH STOPS CHARGESC SETTING WRONG
  17 64KL ...[    BIT IN PUC - ASTOP AND THUS SETTING ALL OF B0-15   
  14 64RF ...[          16TH   JUNE   1975       :CENT   
   4 64_# ...[   
   9 6577 ...      BS       1,ASTOPTP
   9 65*6          ISSTOP   1,RCTP9  
   9 65SQ          LDX   0  ASTOP(1) 
  20 66#B          BNG   0  RCTP9               [JUMP IF PUC DEALING WITH EVENT  
   9 66S2          LDX   0  ANM(1)   
   7 67?L          ANDN  0  3
   7 67R=          SLL   0  6
   7 68=W          SMO      6
  20 68QG          ORS   0  31                  [SET TP WORD 31 = CURRENT PUC MEM
   8 69=6          LDCT  0  #600 
   7 69PQ          ORX   1  0
  21 6=9B          LDCH  6  ALMT(1)             [PICK UP MODES OF CURRENT PUC MEMBER 
   7 6=P2          SRC   6  8
   7 6?3C ...      SMO   5   
   9 6?*S ...      LDX   1  ADATUM   
   8 6?N=          LDX   0  GMSK1
   8 6#7W          ANDS  0  9(1) 
  19 6#MG          ORS   6  9(1)                [SET PUC MODES IN PUC WORD 9 
   7 6*76          LDX   1  5
   9 6*LQ          LDX   0  ASTOP(1) 
   8 6B6B          ANDX  0  GMSK2
   8 6BL2          ADN   0  #1000
  18 6C5L          ERS   0  ASTOP(1)            [SET B14 OF PUC STOP WORD
   8 6CK=          SBN   0  #2000
  19 6D4W          ADS   0  ASTOP(2)            [TRANSFER PUC STOP BITS TO TP
   7 6DJG          RINGTP   5
   7 6F46          LDX   1  5
  10 6FHQ ...RCTP9  BC       1,ASTOPTP   
   8 6G3B          BRN      RCTP2
   5 6GH2    RCTP10  
  17 6H2L          LDX   3  7                   [RESTORE COUNT OF K9S
   8 6HG=          LDX   1  FX1  
   8 6H_W          LDX   2  FX2  
   9 6JFG          BRN      RCTP11   
   4 6J_6    [   
  10 6KDQ    [  YER ACTUAL SPRING CLEAN  
  10 6KYB    [   THAT IS : UPDATE TIMERS 
  13 6LD2    [             CHECK IF TIME FOR OUTPUTS 
  11 6LXL    [             AND COREJAMS ETC  
  10 6MC=    [             AND SCHEDULE  
   4 6MWW    [   
  18 6NBG    XX9C                                [ENTRY FROM SPRING CLEAN
   8 6NW6          ANYRCTPS RCTP 
   5 6P*Q    RCTP11  
   9 6PTB          ADS   3  CLEANCT  
  16 6Q*2          ADS   3  APROCTIME           [STEP P.C. CLOCK 
  20 6QSL          SBS   3  CJDELAYCNT1         [ADJUST DELAY COUNTS FOR CORE JAM
  20 6R#=          SBS   3  CJDELAYCNT2         [RECLAIMING ROUTINES ONE AND TWO 
  10 6RRW          SBS   3  CJDELAYCNT3  
  20 6S3N ...      SBS   3  AMRREORDER          [TIMER FOR REORDER OF PROG. RING 
   7 6S?G          REDUCELL 3
   8 6SR6          LDX   1  FX1  
  21 6T5H ...      BSON     EMSBIT,NOCYCLE      [ELSE NON-EXISTENT ASWINT FPUT BY SCH
   9 6W=2          ADS   3  CYCLECORE
   5 6WPL ...NOCYCLE 
  21 745G          MPY   3  PK9(1)              [TIME SINCE LAST ENTERED IN MILLISECS
  18 74K6          SBS   4  FONINT              [STEP DOWN FON INTERVAL  
   6 74Q# ...#UNS  IMR   
  21 74XG ...      STO   4  AMILLAVAIL          [REMEMBER FOR CALCULATING MILL RATING
   2 754Q
  17 75JB          LDN   4  0                   [CLEAR MARKER WORD   
   7 7642          COBJUSE   
  16 76HL          BXL   0  COBJQUOTA,NOCAN     [J IF OQ NOT MET 
  14 773=          JMBAC    NOCAN,,ASWOQMISS,ASWREALBAD  
  17 77GW          LDN   4  1                   [B23 = > OK MESSAGE  
   5 782G    NOCAN   
   9 78G6          STO   4  AWORK1(2)
  11 78_Q          TIMESET  XX7C,MINUTE,NOMIN
   4 79FB    MIDN
  21 79_2          BS       ,CDTMIDN             [MIDNIGHT MARK IN CASE GETACT FAILS 
   9 7=DL          LDX   0  XINDIC(1)
  18 7=Y=          ORS   0  ADTO                [SO TIME AND DATE AENT   
  15 7?CW          ORN   0  #10                 [DATE CHANGE 
  17 7?XG          ORS   0  AWORK1(2)           [MIDNIGHT SET MARKERS
   5 7#C6    MINUTE  
   9 7#WQ          LDX   0  XINCDT(1)
  21 7*BB          ADS   0  ADTO                [INCREMENT TIME & DATE O/P COUNTERS  
   7 7*DK ...#UNS  ENHOPER   
   4 7*GS ...(   
  18 7*K3 ...      ON       GNUTIME             [SET 'REFRESH OPER TIME' 
  18 7*M= ...      FON      #50                 [WAKE CONSOLE ACTIVITY   
  21 7*PF ...                                   [(ONLY LOOKS AT SWITCH IN DME ELSE RE
   4 7*RN ...)   
   5 7*W2    TRYAGAIN
  10 7B*L          GETACTOP PHAIL,ACTCDT 
  15 7BT=          BC       ,CDTMIDN             [ALL CLEAR  
  18 7C#W          BC       ,CDTGAFAIL           [CLEAR FAILED GETACT BIT
   7 7CSG          LDN   4  2
  16 7D#6          ORS   4  AWORK1(2)           [GNT UPDATE :B22 
   8 7DRQ          LDX   0  ADTO 
   8 7F?B          ANDN  0  #7777
  10 7FR2          BXL   0  ATINT,NOTIM  
   8 7G=L          ERS   0  ADTO 
  16 7GQ=          LDN   4  #4000               [MARKER TIME O/P 
   9 7H9W          ORS   4  AWORK1(2)
   8 7HPG    NOTIM LDX   0  ADTO 
   8 7J96          SRL   0  12   
  10 7JNQ          BXL   0  ADINT,NODAT  
   8 7K8B          SLL   0  12   
   8 7KN2          ERS   0  ADTO 
  16 7L7L          LDX   4  GSIGN               [MARKER DATE O/P 
   9 7LM=          ORS   4  AWORK1(2)
   7 7M6W    NODAT LDN   0  1
   9 7MLG ...      LDX   5  APERCOUNT
  11 7N66 ...      BXL   5  IPROGREP,NOPRO   
  16 7PK2          LDN   4  4                   [PERCOUNT MARKER 
   9 7Q4L          ORS   4  AWORK1(2)
   9 7QJ=          STOZ     APERCOUNT
   5 7R3W    NOPRO   
   9 7R?N ...      ADS   0  APERCOUNT
   9 7RHG          LDX   4  AWORK1(2)
   9 7S36          LDX   2  BPTR(2)  
   9 7SGQ          LINKSET  2,TD5(1) 
   9 7T2B          STO   4  ACC4(2)  
   6 7TG2          FPUT  
   4 7TPS ...XEND
  19 7T_L ...      BSON     EMSBIT,T10          [OMIT TICKLING ETC. IF EMS   
   7 7W9D ...      FREZKICK  
  21 7WF=          COOR2    #41                 [WAKE UP ANY ACTIVITY WAITING IN UNPL
  19 7WYW                                       [END OF ON-LINE PERI TRANSFER
   4 7XDG    [   
   4 7XY6    [   
  19 7YCQ    [BASICALLY THIS WAKES UP PROGRAMS WHICH HAVE DONE A MODE #200   
  21 7YXB    [PERI TO A CONCEPTUAL SCANNER. MODE #200 REQUESTS THE PROGRAM BE GIVEN A
  21 7_C2    [& WOKEN UP @ REGULAR INTERVALS. SEGMENT COMMXC PROCESSES THE PERI & SET
  21 7_WL    [AMXOR/INTRPT BLOCK CONTAINING THE INFORMATION NECESSARY FOR CHARGESC TO
   9 82B=    [THE PROGRAM AS REQUIRED
  11 82TW    R5    HUNTMISB 3,AMXOR,INTRPT   
   8 83*G          BNG   3  TICK6
   9 83T6          LDX   6  INTENT(3)
   7 84#Q    TICK4 LDN   7  1
  10 84SB          LDN   5  INTRECLEN(3) 
  10 85#2          SBSC  7  INTNEXT(3)   
   8 85RL          BCC      TICK5
  13 86?=          FINDJOBQ 1,INTJOBNO(3),(GEOERR)   
   8 86QW          FPCAJO   1,1  
  10 86WR ...      PCATEST  1,NORM5,NORM5
   8 872N ...      FINDTP   1,1  
   5 876K ...NORM5   
  11 87=G          ADDRESS  1,INTFLAG(3),1   
  10 87Q6          LDX   4  INTTIME(3)   
  10 889Q          ADSC  4  INTNEXT(3)   
   8 88PB          ORS   7  0(1) 
   3 88_8 ...
   4 8992 ...[   
  18 89DS ...[        THE  FOLLOWING CURES B3222 CONCERNING FACT THAT NEW
  16 89NL ...[       CHARGESC USED TICKLE MACRO BUT NO JOBNUM !! 
  16 89YD ...[         DONE    11TH    JULY   75         :CENT   
   4 8=8= ...[   
  10 8=D4 ...      TICKLE   INTJOBNO(3)  
   7 8=MW    TICK5 LDX   3  5
   8 8?7G          BCT   6  TICK4
   8 8?M6          LDX   1  FX1  
   8 8#6Q          LDX   2  FX2  
   5 8#LB    TICK6   
   4 8*62    [   
   4 8*KL    [   
   4 8B5=    #   
  14 8BJW    #     STEP BACK THE P.C. CLOCK IF NECESSARY 
   4 8C4G    #   
   4 8CJ6    #   
  18 8D3Q    #     SET X6 = AMOUNT TO STEP BACK PC CLOCK AND ADJUST JCTLR
  15 8DHB    #           OR ZERO IF NO STEPPING BACK REQUIRED
  14 8F32    #           USED BY NEXT SEARCH OF JOB QUEUE
   4 8FGL    #   
   9 8G2=          LDX   0  SCADJ(1) 
   7 8GFW          LDN   6  0
  21 8G_G          BXGE  0  APROCTIME,R1                                   [J IF NO A
   7 8HF6          LDX   6  0
  18 8HYQ          SRL   6  1                   [HALT TO BE SUBTRACTED   
   9 8JDB          SBS   6  APROCTIME
   4 8JY2    #   
  16 8KCL    #     EMPTY EXECUTIVE OBJ PROG TIMERS INTO JOB BLOCK
  21 8KX=    #     THEN (FOR EACH JOB WITH A PLUGGED IN CORE IMAGE) CHECK ITS STOP WO
  21 8LBW    #     SEE WHETHER IT IS NECESSARY TO ACTIVATE THE PCA TO DEAL WITH A PSE
  21 8LWG    #     PROGRAM EVENT, I.E. ONE WHICH IS NOT THE RESULT OF OBEYED OBJECT P
   4 8MB6    #   
   4 8MTQ    R1  
  20 8N2Y ...      STOZ     AWORK2(2)           [ FOR CPIFORMS RESTORE TIME MACRO
  21 8N86 ...      STOZ     AWORK3(2)             [ FOR CPIFORMS RESTORE TIME MACRO  
   9 8N*B          STO   6  AWORK1(2)
   8 8NT2          LDN   3  BJOBQ
  17 8P#L    T11   LDX   3  FPTR(3)             [GET NEXT IN JOB Q   
  18 8PS=          BXE   3  CXJO,T10                [TEST IF EQUALS BASE 
   9 8Q?W          LDEX  4  JMISC(3) 
  16 8QRG          BZE   4  T11                 [J NO CORE IMAGE 
   8 8R?6          SMO      FX2  
   9 8RQQ          LDX   0  AWORK1   
   9 8S=B          SBS   0  JCTLR(3) 
  12 8SQ2          HLSAV    3,SET,SAVING,JOBQ,T11
  15 8T9L          FCAJO    2,3                 [X2 -> CPA   
  10 8TP=          LDX   6  ACTCHCH(2)   
  10 8W8W          STOZ     ACTCHCH(2)   
  16 8WNG          JBS      PLUG,3,JBPLUG       [J IF PLUGGED IN 
   7 8X86          LDN   5  0
   9 8XMQ          CALL  4  XCHARGE1 
   7 8Y7B          LDN  4  0 
  10 8YM2          ADSC  5  HTIMEJ+1(3)  
   9 8_6L          ADS   4  HTIMEJ(3)
  11 9822 ...      JBC      RATE1,3,JBDORM   
   9 9827 ...      LDX   0  JCTLR(3) 
   9 982# ...      ADN   0  1000/K9*3
  11 982F ...      BXGE  0  APROCTIME,RATE1  
   6 982L ...#UNS ISTDP  
   4 982R ...#SKI
  16 982Y ...      BC       3,JBRUN             [MRK NON RUNNABLE
   6 9835 ...#UNS  ISTDP 
  21 983= ...      TRUEDORM 3                   [MAKE TRUELY DORM.AS DORM.FOR > 3SECS
   8 983C ...      BRN      T11  
   9 983J ...[ CALCULATE MILL RATING 
   8 983P ...RATE1 FPCAJO   1,3  
  15 983W ...      CALL  7  TESTPCA             [CHECK RCTP  
   8 9843 ...      BRN      NORM2
  20 9848 ...PUC2  CALL  7  RATINGS             [CALCULATE MILL RATINGS FOR PUC  
  16 984* ...      FINDTP   1,1                 [SET UP FOR TP   
  18 984G ...NORM2 CALL  7  RATINGS             [CALCULATE MILL RATINGS  
   8 984M ...      LDX   1  FX1  
   8 984S ...      BRN      T11  
   8 984_ ...PLUG  FPCAJO   1,3  
  17 9853 ...      STO   1  GEN4                [REMEMBER CURRENT PCA
  16 9856 ...      STO   6  GEN2                 [REMEMBER CHCHS 
  17 985? ...[ EMPTY PROGRAM MILL TIMERS AND CALCULATE MILL RATING   
  18 985D ...      STOZ     GEN1                [TO ACCUMULATE TIME YSED 
  15 985K ...      CALL  7  TESTPCA             [CHECK PCTP  
   8 985Q ...      BRN      NORM3
  17 985X ...PUC3  CALL  7  TIMERS              [DECANT FOR PUC PCA  
  20 9864 ...      CALL  7  RATINGS             [CALCULATE MILL RATINGS FOR PUC  
  17 9869 ...      FINDTP   1,1                 [SET UP FOR TP PCA   
  16 986B ...NORM3 CALL  7  TIMERS              [DECANT TIMERS   
  18 986H ...      CALL  7  RATINGS             [CALCULATE MILL RATINGS  
  16 986N ...      LDX   5  GEN1                [TOTAL MILL USED 
   7 986T ...      LDN   4  0
  18 9872 ...      ADSC  5  GPROGTIME+1         [UPDATE VARIOUS TIMERS   
   9 9877 ...      ADS   4  GPROGTIME
  11 987# ...      ADSC  5  HCLOCKTIME+1(3)  
  10 987F ...      ADS   4  HCLOCKTIME(3)
   4 987L ...[   
  12 987R ...[ CHARGE TIME SPENT IN PCA AND OLPAS
   4 987Y ...[   
   8 988= ...      LDX   6  GEN2 
  15 988C ...      CALL  7  TESTPCA             [CHECK RCTP  
   8 988J ...      BRN      NORM1
  10 988P ...PUC1  ADX   6  ACTCHCH(1)   
  10 988W ...      STOZ     ACTCHCH(1)   
   8 9893 ...      FINDTP   1,1  
  10 9898 ...NORM1 ADX   6  ACTCHCH(1)   
  10 989* ...      STOZ     ACTCHCH(1)   
  15 989G ...      LDX   1  APRB(1)             [X1 -> PRB   
   8 989M ...TOUR  LDXC  0  0(1) 
  14 989S ...      BCS      PRBEND              [J IF END
   8 989_ ...      LDXC  2  1(1) 
  15 98=6 ...      BCC      ROUND               [J IF ONLINE 
  12 98=? ...      ADX   6  ACTCHCH-CHAINADD(2)  
  12 98=D ...      STOZ     ACTCHCH-CHAINADD(2)  
  15 98=K ...ROUND BDX   1  TOUR                [BACK AGAIN  
   5 98=Q ...PRBEND  
  18 98=X ...      CALL  4  XCHARGE             [CONVERT TO MILLISECONDS 
  16 98?4 ...      LDX   2  GEN4              [X2 -> CURRENT PCA 
   8 98?9 ...      LDX   1  FX1  
   4 98?B ...[   
  20 98?H ...[ UPDATE TIMERS IN JOB BLOCK AND SET STOP WORD IF TIME-UP CONDITION 
   4 98?N ...[   
   7 98?T ...      LDN   4  0
  16 98#2 ...      ADSC  5  HTIMEJ+1(3)             [JOB TIMER   
   9 98#7 ...      ADS   4  HTIMEJ(3)
  17 98## ...      SBSC  5  APROGTIME+1(3)          [PROGRAM TIMER   
  10 98#F ...      SBS   4  APROGTIME(3) 
  16 98#L ...      ADS   5  HTIMES(3)           [SLOT TIME USED  
  10 98*5 ...      LA       ASTOPTIM,5   
  10 98*= ...      LDX   6  APROGTIME(3) 
  18 98*C ...      BNG   6  STOPIT                  [J IF PROG TIME UP   
  10 98*J ...      LA       ASTOPJOB,5   
  10 98*P ...      LDXC  7  HTIMEJ+1(3)  
   9 98*W ...      LDX   6  HTIMEJ(3)
  10 98B3 ...      TXL   7  ATIMEJ+1(3)  
   9 98B8 ...      TXL   6  ATIMEJ(3)
  16 98B* ...      BCS      T12                 [NOT JOBTIME UP  
   5 98BG ...STOPIT  
   9 98BM ...      ORS   5  ASTOP(2) 
   9 98F2    T12   LDX   5  ASTOP(2) 
  17 9=CG          BZE   5  T11                 [J NO STOP BITS SET  
  15 9*SW          BNG   5  T11                 [J IF B0 SET 
  19 9BJ2 ...[     IF ANY OF ASTOPTIM,ASTOPJOB,ASTOPBIN OR B15-23(PERIPHERAL 
  19 9BM= ...[     FAILURE) SET IN ASTOP,THEN WE NEED TO FPUT PCA.UNLESS??   
   4 9BQG ...[   
  10 9BTQ ...      LDX   0  MASTOP1(1)   
   9 9B_2 ...      ANDX  0  ASTOP(2) 
   8 9C4= ...      BZE   0  T11  
  20 9C7G ...[      UNLESS ANY OF ASTOPEXEC,ASTOPTP,ASTOPPUC OR UNUSED BITS SET  
  10 9C=Q ...[     AS WELL(B4 & B6-11)   
   4 9CB2 ...[   
  10 9CF= ...      LDX   0  MASTOP2(1)   
   9 9CJG ...      ANDX  0  ASTOP(2) 
   8 9CMQ ...      BNZ   0  T11  
   4 9CRB    T11A
  21 9D?2          ISSTOP   2,T11               [TEST IF PROGRAM REALLY STOPPED (3D) 
   9 9DQL          LDX   5  ASTOP(2) 
  20 9F==          BNG   5  T11                 [J IF B0 TYPE EVENT JUST HAPPENED
  17 9GP6          LDN   1  P4(1)               [LINK FOR K4CHARGESC 
   4 9H8Q    T15 
   9 9HNB          LINKSET  2,0(1)   
  18 9J82          FLIPS    ASTOP(2),,0         [SET 'ACTIVE' STOP BIT   
  16 9JML          FPUT                         [PUT PCA ON LIST 
   8 9K7=          BRN      T11  
   4 9N52    #   
   4 9NJL    #   
   6 9NKS ...#UNS AV7900S
   4 9NM2 ...(   
  20 9NN8 ...#     DECANT GEORGES TIMER(K7) INTO GEOTIME(DOUBLE LENGTH FIXED CORE
   6 9NPB ...#     WORD).
  17 9NQJ ...#     CHECK IF FONINTP SECONDS HAVE ELAPSED AND IF SO   
  19 9NRQ ...#     WAKE UP THE ACTIVITIES WHICH ARE WAITING IN CERTAIN STYLES
  21 9NSY ...#     AND TIME OUT VIRTUAL 7900 WMC TRANSFERS WHICH HAVE BEEN STORED FOR
   9 9NW6 ...#     3 FONINTP SECONDS.
   4 9NX# ...)   
   6 9NYG ...#UNS AV7900S
   4 9N_N ...#SKI
   4 9P2W ...(   
  21 9P4=    #     CHECK IF FONINTP SECONDS HAVE ELAPSED AND IF SO WAKE UP THE ACTIVI
  21 9PHW    #     WHICH ARE WAITING IN CERTAIN STYLES. ALSO DECANT GEORGES TIMER(K7)
  15 9Q3G    #     GEOTIME(DOUBLE LENGTH FIXED CORE WORD).   
   4 9Q?# ...)   
   4 9QH6    #   
   4 9R2Q    #   
   4 9R*X ...T10 
   4 9RP4 ...[   
  21 9S49 ...[     THIS CURES BUG 2780,WHEREBY EXEC IDLE TIME(K30+K45) EXCEEDS 8.6M  
  20 9SCB ...[     IN TIME PERIOD FONINT(4SECS) IT WILL NOW BE UPDATED EVERY S-C 
  15 9SQH ...[            DONE  16TH MAY 75          :CENT   
   4 9T5N ...[   
  19 9T7N ...[       WITH CME, OVERFLOW WORD INCLUDED. THIS ZERO IN NON-CME. 
   9 9T9N ...      LDXC  5  K30+K45  
  20 9T?N ...      LDX   4  K30+K35+15         [SAFEGUARD- SEE COMMENT ON GEOTIME
   9 9T*N ...      SBSC  5  K30+K45  
  10 9TCN ...      SBS   4  K30+K35+15   
   4 9TFS ...[   
  20 9TMW ...[      THE  FOLLOWING CURES BUG 3342 - EXEC NOW TIMES IN MILLI SECS 
   8 9TTY ...[         NOT  BEATS
   4 9W42 ...[   
   9 9W#M ...      DVD   4  THOU(1)  
   9 9WK# ...      ADSC  4  K30+K45  
   7 9WT_ ...      LDN   4  0
  10 9X6L ...      ADS   4  K30+K35+15   
   8 9X#Q ...      SRL   56 24   
  10 9XGW ...      ADSC  6  EXECIDLE+1   
   9 9XP2 ...      ADS   5  EXECIDLE 
   4 9XX6 ...[   
  18 9XX= ...[      IN CME,DECANT SYSTEM IDLE SIMILARLY TO EXEC IDLE TIME
   4 9XXB ...[   
  10 9XXG ...      JENVNOT   NOTCME,CME  
   9 9XXL ...      LDX   5  K30+K45+1
   9 9XXQ ...      DVS   4  THOU(1)  
   9 9XXW ...      STO   4  K30+K45+1
   7 9XY2 ...      LDN   4  0
   9 9XY6 ...      ADSC  5  IDLESYS+1
   9 9XY= ...      ADS   4  IDLESYS  
   5 9XYB ...NOTCME  
   5 9XYJ ...#UNS ICT
   4 9Y26 ...(   
  18 9Y3N ...#      FOR ICT ENHANCEMENT:  ACCUMULATE GEORGE'S MILL TIME  
  12 9Y5= ...#      FROM ALL GEORGE'S MILL TIMERS
   8 9Y6S ...      GETGMILL  4,5 
   4 9Y8B ...)   
   5 9Y9Y ...#UNS ICT
   4 9Y?G ...#SKI
   4 9Y*4 ...(   
   8 9YBL          LDXC  5  K7   
   8 9YW=          LDX   4  K7X  
  21 9_*W          SBSC  5  K7                  [ SAFEGUARD 'COS EXEC CAN INCREMENT..
  20 9_TG          SBS   4  K7X                 [ MILL TIME BETWEEN ANY TWO...   
  17 =2*6                                       [ GEORGE INSTRUCTIONS
  21 =2SQ          DVD   4  BEATTIME            [CONVERT GEORGE TIME TO MILLISECONDS 
  18 =3#B          ADSC  4  K7                  [ SAFEGUARD AS ABOVE...  
  19 =3S2          LDN   4  0                   [ STORE REMAINING BEATS IN K7
   8 =4?L          ADS   4  K7X  
   4 =4HD ...)   
   2 =4R=
  16 =5=W          SRL   56 24                  [DOUBLE LENGTH   
   9 =5QG          ADSC  6  GEOTIME+1
  18 =6=6          ADS   5  GEOTIME             [UPDATE MILLISEC COUNT   
   9 =6*= ...      LDX   4  FONINT   
  18 =6C# ...      BPZ   4  T10A                [J NO WAKING NECESSARY   
   9 =6HG ...      LDX   0  WTIME(1) 
  17 =6LL ...      ADS   0  FONINT              [RESET FON INTERVAL  
   9 =6PQ    #SKI  K6CHARGESC>12-12  
   4 =79B    (   
  12 =7P2          TRACE    GEOTIME+1,######SC   
  11 =88L          TRACE    CHCHCOUNT,CHCHCT 
   4 =8N=    )   
  17 =97W          FON1                         [AWAKEN THE SLEEPING 
   8 =9MG          LDN   2  BFREE
  21 ==76          LDN   0  0                   [FOR COUNT OF NUMBER OF F/C BLOCKS   
  14 ==LQ    ZAG   LDX   2  FPTR(2)             [GET NEXT
  16 =?6B          ADN   0  1                   [INCREMENT COUNT 
  16 =?L2          TXU   2  BFREE+1             [ARE WE AT END?  
  16 =#5L          BCS      ZAG                 [IF NOT JUMP BACK
  15 =#K=          SRA   0  1                   [DIVIDE BY 2 
   8 =*4W          LDN   2  BFREE
  16 =*JG    QUIK  LDX   2  FPTR(2)             [LOCATE MID POINT
   8 =B46          BCT   0  QUIK 
  14 =BHQ          STO   2  CMIDFREE            [STORE IT
   9 =C3B    #SKI  K6CHARGESC>199-199
  10 =CH2          TRACE    2,CMIDFREE   
   6 =CH3 ...#UNS AV7900S
   4 =CH4 ...(   
  10 =CH5 ...      CALL  7  TIMOUTV7900  
  18 =CH6 ...TIMOUTRETUR                        [RETURN FROM K4VIPBPERI  
   4 =CH7 ...)   
   4 =CH8 ...T10A
   4 =CHM ...[   
  19 =CHW ...[ CHECK IF PROGRAM RING CORRECTLY ORDERED MOVING AS NECESSARY   
   4 =CJ5 ...[   
  10 =CJ6 ...      NGX   0  AMRREORDER   
  18 =CJ7 ...      BNG   0  T10B                [J IF NOT TIME TO REORDER
  20 =CJ8 ...      SEGENTRY K53CHARGESC         [FOR CPIFORMS REST. TIME MACRO   
   9 =CJ9 ...      LDN   0  AMRTIME  
  10 =CJ= ...      STO   0  AMRREORDER   
   7 =CJ# ...#UNS  IMRSTAT   
   4 =CJH ...(   
  18 =CJQ ...      STOZ     GEN1                [NO. OF PLUGGED IN PROGS 
  17 =CJ_ ...      STOZ     GEN2                [NO. OF RE-ORDERINGS 
   4 =CK8 ...)   
  18 =CKC ...      LDN   3  BPROG               [START WITH HIGH PRIORITY
  19 =CKL ...      LDX   4  TOPAMRHP(1)         [CONTAINS AMR OF LAST MEMBER 
  16 =CKT ...      LDN   7  GMEL                [FINISHING POINT 
   9 =CL4 ...ORDER LDX   3  FPTR(3)  
   9 =CL? ...      BXE   3  7,SECTEND
   6 =CL# ...#UNS  ICT   
   4 =CL* ...(   
   8 =CLB ...      LDN   0  GPDA 
  18 =CLC ...      BXE   0  APD(3),ORDER  [IGNORE GEORGE MEMBER ELEMENTS 
   4 =CLD ...)   
   7 =CLG ...#UNS  IMRSTAT   
   4 =CLP ...(   
   7 =CLY ...      LDN   0  1
   8 =CM7 ...      ADS   0  GEN1 
   4 =CMB ...)   
  16 =CMK ...      LDCH  2  ARM(3)              [MEMBER NUMBER   
   9 =CMS ...      SMO      APD(3)   
  10 =CN3 ...      LDX   5  AMR1-ASTOP(2)
  18 =CN= ...      BXGE  4  5,OKORD             [J IF IN CORRECT ORDER   
   9 =CNF ...      LDX   5  APD(3)   
  14 =CNN ...      SBN   5  ASTOP               [-> PCA  
  15 =CNX ...      LDX   6  2                   [MEMBER NO   
   8 =CP6 ...      MELRERING 5,6 
   7 =CP* ...#UNS  IMRSTAT   
   4 =CPJ ...(   
   7 =CPR ...      LDN   0  1
   8 =CQ2 ...      ADS   0  GEN2 
   4 =CQ9 ...)   
  18 =CQD ...OKORD LDX   4  5                   [RESET AMR OF LAST MEMBER
   8 =CQM ...      BRN      ORDER
   5 =CQW ...SECTEND 
  20 =CR5 ...[ REORDERING IS FINISHED IF FINISHING POINT IS FOR ORDINARY MEMBERS 
  13 =CR# ...[ IF NOT RESET TO DO ORDINARY MEMBERS   
  10 =CRH ...      BXU   7  GMELPTR,SCHED
   9 =CRQ ...      LDX   4  TOPAMR(1)
   8 =CR_ ...      LDN   7  BPROG
   8 =CS8 ...      BRN      ORDER
  16 =CS9 ...      NULL                         [ FOUR WORD GAP  
  14 =CS= ...      NULL                         [   FOR  
  15 =CS? ...      NULL                         [   CPIFORMS 
  18 =CS# ...      NULL                         [   RESTORE TIME MACRO   
   5 =CSC ...SCHED   
  20 =CSG ...      SEGENTRY K54CHARGESC         [FOR CPIFORMS RESTORE TIME MACRO 
   7 =CSL ...#UNS  IMRSTAT   
   4 =CST ...(   
   7 =CT4 ...      LDN   4  1
  19 =CT? ...      ADS   4  IMRCHECK            [NO. OF TIMES ORDER CHECKED  
   8 =CTG ...      LDX   0  GEN1 
   7 =CTP ...      SRL   0  1
  10 =CTY ...      BXGE  0  GEN2,SCHED1  
  16 =CW7 ...      ADS   4  IMRCHAOS            [HALF MELS MOVED 
   5 =CWB ...SCHED1  
  11 =CWK ...[ADD NO OF REORDERS TO A VECTOR 
  11 =CWS ...      LDN   0  IMRMOVEN-IMRMOVE 
  10 =CX3 ...      BXGE  0  GEN2,SCHED2  
  19 =CX= ...      ADS   4  IMRMOVEN            [MORE MOVES THAN ALLOWED FOR 
   8 =CXF ...      BRN     SCHED3
   5 =CXN ...SCHED2  
   8 =CXX ...      SMO      GEN2 
   9 =CY6 ...      ADS   4  IMRMOVE  
   5 =CY* ...SCHED3  
   4 =CYJ ...)   
   4 =D2L    #   
  21 =DG=    #     SET CORE UNJAMMING SUM USING COUNT OF NUMBER OF ACTIVITIES ON QUEU
  21 =D_W    #     OR OTHERWISE WHICH HAVE BEEN REFUSED A REQUEST FOR CORE(CFAIL), AN
  21 =FFG    #     NECESSARY ENTER CORE UNJAMMER; OTHERWISE ENTER PROGRAM CONTROLLER 
  12 =F_6    #     REVIEW RUNNING OF PROGRAMS.   
   4 =GDQ    #   
   4 =GYB ...T10B
  21 =HD2          LDX   5  CFAIL               [LOAD COUNT OF OUTSTANDING CORE REQUE
  21 =HXL          LDX   7  CJCLAST             [LOAD LAST COUNT OF WAITING ACTIVITIE
  16 =JC=          STO   5  CJCLAST             [STORE NEW COUNT 
  18 =JWW          BZE   5  WC50                [J NO ACTIVITIES WAITING 
  21 =KBG          TXL   5  7                   [TEST IF LESS WAITING THAN LAST TIME 
  13 =KW6          BCC      WC100               [NO  
  16 =L*Q    WC50  LDX   6  CJSUM               [LOAD CURRENT SUM
  10 =LTB          MPY   6  TJDECAY(1)   
  14 =M*2          DVR   6  TON(1)              [DECAY IT
  20 =MSL          STO   7  CJSUM               [STORE DECAYED PART OF NEW SUM   
   5 =N#=    WC100   
   6 =NRW    #SKI  JPSCF 
   4 =P?G    (   
   4 =PR6    [   
   4 =Q=Q    [   
   4 =QQB    [   
   7 =R=2          LDN   3  0
   6 =RC8 ...#UNS  ISTDP 
   7 =RJB ...      COBJUNUSE 
  21 =RWS ...      ADX   0  CFREE               [ IF 'CFREE+ACHAP'<CHAPQUOTA' THEN:- 
  21 =S9=          ADX   0  ACHAP               [ TREAT CFAIL AS THOUGH 1 MORE ...   
  19 =SNW          BXGE  0  CHAPQUOTA,OK        [ ...WHEN AND ONLY WHEN ...  
  18 =T8G          ADN   3  1                   [ ...CALCULATING CJSUM   
   7 =TN6    OK    ADX   5  3
   4 =W7Q    [   
   4 =WMB    [   
   4 =X72    [   
   4 =XLL    )   
   9 =Y6=          MPY   5  TCJC(1)  
  16 =YKW          ADS   6  CJSUM               [NEW SUM CREATED 
   7 =_5G          SCHEDULE  
  11 =_K6          MENDAREA 50,K99CHARGESC   
   4 ?24Q    #END
   6 ____ ...215741340003
