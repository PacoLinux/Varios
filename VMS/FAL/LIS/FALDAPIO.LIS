FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   0
TABLE OF CONTENTS   

   (2)      43  DECLARATIONS
   (3)      66  FAL$RECEIVE - RECEIVE DAP MESSAGE
   (4)     131  FAL$TRANSMIT - TRANSMIT DAP MESSAGE
   (5)     196  FAL$MBX_READ - READ THE ASSOCIATED MAILBOX
   (6)     252  FAL$MBX_AST - MAILBOX AST SERVICE ROUTINE
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   1
X0.1-10                                                                                                                          (1)

                                     0000     1 	.TITLE	FALDAPIO - DAP MESSAGE I/O ROUTINES
                                     0000     2 	.IDENT	/X0.1-10/
                                     0000     3 
                                     0000     4 ;
                                     0000     5 ;			  COPYRIGHT (c) 1977, 1978 BY
                                     0000     6 ;	      DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
                                     0000     7 ;
                                     0000     8 ; THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND  COPIED
                                     0000     9 ; ONLY  IN  ACCORDANCE  WITH  THE  TERMS  OF  SUCH  LICENSE AND WITH THE
                                     0000    10 ; INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE OR  ANY  OTHER
                                     0000    11 ; COPIES  THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY
                                     0000    12 ; OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE  IS  HEREBY
                                     0000    13 ; TRANSFERRED.
                                     0000    14 ;
                                     0000    15 ; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITHOUT  NOTICE
                                     0000    16 ; AND  SHOULD  NOT  BE  CONSTRUED  AS  A COMMITMENT BY DIGITAL EQUIPMENT
                                     0000    17 ; CORPORATION.
                                     0000    18 ;
                                     0000    19 ; DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE OR  RELIABILITY  OF  ITS
                                     0000    20 ; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.
                                     0000    21 ;
                                     0000    22 
                                     0000    23 ;++
                                     0000    24 ; FACILITY: DECNET FILE ACCESS LISTENER (FAL)
                                     0000    25 ;
                                     0000    26 ; ABSTRACT:
                                     0000    27 ;
                                     0000    28 ;	THIS MODULE IS RESPONSIBLE FOR RECEIVING AND TRANSMITTING DAP
                                     0000    29 ;	MESSAGE AND FOR RECEIVING MESSAGES IN THE MAILBOX ASSOCIATED
                                     0000    30 ;	WITH THE LINK.
                                     0000    31 ;
                                     0000    32 ; ENVIRONMENT:
                                     0000    33 ;
                                     0000    34 ;	THE FAL IMAGE EXECUTES IN THE CONTEXT OF A PROCESS CREATED BY
                                     0000    35 ;	NETACP. IT RUNS IN USER MODE AND REQUIRES NETWORK PRIVILEGE.
                                     0000    36 ;
                                     0000    37 ; AUTHOR: JAMES A. KRYCKA,	CREATION DATE: 16-JUN-77
                                     0000    38 ;
                                     0000    39 ; MODIFICATIONS:
                                     0000    40 ;
                                     0000    41 ;--
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   2
X0.1-10         DECLARATIONS                                                                                                     (2)

                                     0000    43 	.SBTTL	DECLARATIONS
                                     0000    44 
                                     0000    45 ;
                                     0000    46 ; INCLUDE FILES:
                                     0000    47 ;
                                     0000    48 	$FALWRKDEF			; DEFINE FAL WORK AREA SYMOBLS
                                     0000    49 	$FALSTBDEF			; DEFINE STATISTICS BLOCK SYMBOLS
                                     0000    50 	$MSGDEF				; DEFINE MAILBOX MESSAGE ID CODES
                                     0000    51 	MISC_SYMBOLS			; DEFINE MISCELLANEOUS FAL SYMBOLS
                                     0000    52 ;	.LIST	MEB
                                     0000    53 ;
                                     0000    54 ; MACROS:
                                     0000    55 ;
                                     0000    56 ;	NONE
                                     0000    57 ;
                                     0000    58 ; EQUATED SYMBOLS:
                                     0000    59 ;
                                     0000    60 ;	NONE
                                     0000    61 ;
                                     0000    62 ; OWN STORAGE:
                                     0000    63 ;
                                     0000    64 ;	NONE
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   3
X0.1-10         FAL$RECEIVE - RECEIVE DAP MESSAGE                                                                                (3)

                                     0000    66 	.SBTTL	FAL$RECEIVE - RECEIVE DAP MESSAGE
                                 00000000    67 	.PSECT	FAL$CODE	NOSHR,EXE,RD,NOWRT,BYTE
                                     0000    68 
                                     0000    69 ;++
                                     0000    70 ; FUNCTIONAL DESCRIPTION:
                                     0000    71 ;
                                     0000    72 ;	FAL$RECEIVE ISSUES A QIO READ REQUEST WITH AN AST ON THE
                                     0000    73 ;	SPECIFIED LINK TO OBTAIN THE NEXT DAP MESSAGE FROM THE OTHER NODE.
                                     0000    74 ;
                                     0000    75 ; CALLING SEQUENCE:
                                     0000    76 ;
                                     0000    77 ;	BSB/JSB	FAL$RECEIVE
                                     0000    78 ;
                                     0000    79 ; INPUT PARAMETERS:
                                     0000    80 ;
                                     0000    81 ;	R8	ADDRESS OF FAL WORK AREA
                                     0000    82 ;	R9	ADDRESS OF DAP CONTROL BLOCK
                                     0000    83 ;	R10	ADDRESS OF FAB CONTROL BLOCK
                                     0000    84 ;	R11	ADDRESS OF RAB CONTROL BLOCK
                                     0000    85 ;
                                     0000    86 ; IMPLICIT INPUTS:
                                     0000    87 ;
                                     0000    88 ;	NONE
                                     0000    89 ;
                                     0000    90 ; OUTPUT PARAMETERS:
                                     0000    91 ;
                                     0000    92 ;	NONE
                                     0000    93 ;
                                     0000    94 ; IMPLICIT OUTPUTS:
                                     0000    95 ;
                                     0000    96 ;	NONE
                                     0000    97 ;
                                     0000    98 ; COMPLETION CODES:
                                     0000    99 ;
                                     0000   100 ;	NONE
                                     0000   101 ;
                                     0000   102 ; SIDE EFFECTS:
                                     0000   103 ;
                                     0000   104 ;	NONE
                                     0000   105 ;
                                     0000   106 ;--
                                     0000   107 
                                     0000   108 FAL$RECEIVE::				; CONTROL POINT
                                     0000   109 					; ***** CHANGE TO QIO WITH AST
                                     0000   110 	$QIOW_S	EFN=#RCVEFN-		; ISSUE THE RECEIVE REQUEST
                                     0000   111 		CHAN=FAL$W_LNKCHN(R8)-	;
                                     0000   112 		FUNC=#IO$_READVBLK-	;
                                     0000   113 		IOSB=FAL$Q_LNKIOSB(R8)- ;
                                     0000   114 		P1=@FAL$Q_RCV+4(R8)-	; BUFFER ADDRESS
                                     0000   115 		P2=FAL$W_MAXDAPSIZ(R8)	; BUFFER SIZE
                                     0021   116 	CHECK_SS			; BRANCH ON FAILURE
                                 3C  0024   117 	MOVZWL	FAL$Q_LNKIOSB+2(R8),-	; STORE MESSAGE SIZE
         3C A8         1E A8         0025   118 		FAL$Q_RCV(R8)		; "
            57       00C0 C8     DE  0029   119 	MOVAL	FAL$L_STB(R8),R7	; GET ADDRESS OF STATISTICS BLOCK
                          67     D6  002E   120 	INCL	FAL$L_RCV_MSG(R7)	; INCREMENT RCV MESSAGE COUNT
                                 C0  0030   121 	ADDL2	FAL$Q_RCV(R8),-		; UPDATE RCV MESSAGE BYTE COUNT
         08 A7         3C A8         0031   122 		FAL$L_RCV_BYTE(R7)	;
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   4
X0.1-10         FAL$RECEIVE - RECEIVE DAP MESSAGE                                                                                (3)

                       3C A8     DD  0035   123 	PUSHL	FAL$Q_RCV(R8)		; SIZE OF MESSAGE IN BYTES
                       40 A8     DD  0038   124 	PUSHL	FAL$Q_RCV+4(R8)		; ADDRESS OF MESSAGE
                          01     DD  003B   125 	PUSHL	#1			; DENOTE A RECEIVE
                          14     DD  003D   126 	PUSHL	#20			; MAXIMUM # BYTES TO DISPLAY
       0000'CF            04     FB  003F   127 	CALLS	#4,W^FAL$DISPLAY_MSG	; PRINT MESSAGE
            50            01     D0  0044   128 	MOVL	#1,R0			; RETURN SUCCESS STATUS
                                 05  0047   129 	RSB				; EXIT
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   5
X0.1-10         FAL$TRANSMIT - TRANSMIT DAP MESSAGE                                                                              (4)

                                     0048   131 	.SBTTL	FAL$TRANSMIT - TRANSMIT DAP MESSAGE
                                 00000048   132 	.PSECT	FAL$CODE	NOSHR,EXE,RD,NOWRT,BYTE
                                     0048   133 
                                     0048   134 ;++
                                     0048   135 ; FUNCTIONAL DESCRIPTION:
                                     0048   136 ;
                                     0048   137 ;	FAL$TRANSMIT ISSUES A QIO WRITE REQUEST WITH AN AST ON THE
                                     0048   138 ;	SPECIFIED LINK TO SEND THE NEXT DAP MESSAGE TO THE OTHER NODE.
                                     0048   139 ;
                                     0048   140 ; CALLING SEQUENCE:
                                     0048   141 ;
                                     0048   142 ;	BSB/JSB	FAL$TRANSMIT
                                     0048   143 ;
                                     0048   144 ; INPUT PARAMETERS:
                                     0048   145 ;
                                     0048   146 ;	R8	ADDRESS OF FAL WORK AREA
                                     0048   147 ;	R9	ADDRESS OF DAP CONTROL BLOCK
                                     0048   148 ;	R10	ADDRESS OF FAB CONTROL BLOCK
                                     0048   149 ;	R11	ADDRESS OF RAB CONTROL BLOCK
                                     0048   150 ;
                                     0048   151 ; IMPLICIT INPUTS:
                                     0048   152 ;
                                     0048   153 ;	NONE
                                     0048   154 ;
                                     0048   155 ; OUTPUT PARAMETERS:
                                     0048   156 ;
                                     0048   157 ;	NONE
                                     0048   158 ;
                                     0048   159 ; IMPLICIT OUTPUTS:
                                     0048   160 ;
                                     0048   161 ;	NONE
                                     0048   162 ;
                                     0048   163 ; COMPLETION CODES:
                                     0048   164 ;
                                     0048   165 ;	NONE
                                     0048   166 ;
                                     0048   167 ; SIDE EFFECTS:
                                     0048   168 ;
                                     0048   169 ;	NONE
                                     0048   170 ;
                                     0048   171 ;--
                                     0048   172 
                                     0048   173 FAL$TRANSMIT::				; CONTROL POINT
                                     0048   174 					; ***** CHANGE TO QIO WITH AST
                                     0048   175 	$QIOW_S	EFN=#XMTEFN-		; ISSUE THE TRANSMIT REQUEST
                                     0048   176 		CHAN=FAL$W_LNKCHN(R8)-	;
                                     0048   177 		FUNC=#IO$_WRITEVBLK-	;
                                     0048   178 		IOSB=FAL$Q_LNKIOSB(R8)- ;
                                     0048   179 		P1=@FAL$Q_XMT+4(R8)-	; BUFFER ADDRESS
                                     0048   180 		P2=FAL$Q_XMT(R8)	; BUFFER SIZE
                                     0069   181 	CHECK_SS			; BRANCH ON FAILURE
                                 3C  006C   182 	MOVZWL	FAL$Q_LNKIOSB+2(R8),-	; STORE MESSAGE SIZE
         44 A8         1E A8         006D   183 		FAL$Q_XMT(R8)		; "
            57       00C0 C8     DE  0071   184 	MOVAL	FAL$L_STB(R8),R7	; GET ADDRESS OF STATISTICS BLOCK
                       04 A7     D6  0076   185 	INCL	FAL$L_XMT_MSG(R7)	; INCREMENT XMT MESSAGE COUNT
                                 C0  0079   186 	ADDL2	FAL$Q_XMT(R8),-		; UPDATE XMT MESSAGE BYTE COUNT
         0C A7         44 A8         007A   187 		FAL$L_XMT_BYTE(R7)	;
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   6
X0.1-10         FAL$TRANSMIT - TRANSMIT DAP MESSAGE                                                                              (4)

                       44 A8     DD  007E   188 	PUSHL	FAL$Q_XMT(R8)		; SIZE OF MESSAGE IN BYTES
                       48 A8     DD  0081   189 	PUSHL	FAL$Q_XMT+4(R8)		; ADDRESS OF MESSAGE
                          00     DD  0084   190 	PUSHL	#0			; DENOTE A TRANSMIT
                          14     DD  0086   191 	PUSHL	#20			; MAXIMUM # BYTES TO DISPLAY
       0000'CF            04     FB  0088   192 	CALLS	#4,W^FAL$DISPLAY_MSG	; PRINT MESSAGE
            50            01     D0  008D   193 	MOVL	#1,R0			; RETURN SUCCESS STATUS
                                 05  0090   194 	RSB				; EXIT
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   7
X0.1-10         FAL$MBX_READ - READ THE ASSOCIATED MAILBOX                                                                       (5)

                                     0091   196 	.SBTTL	FAL$MBX_READ - READ THE ASSOCIATED MAILBOX
                                 00000091   197 	.PSECT	FAL$CODE	NOSHR,EXE,RD,NOWRT,BYTE
                                     0091   198 
                                     0091   199 ;++
                                     0091   200 ; FUNCTIONAL DESCRIPTION:
                                     0091   201 ;
                                     0091   202 ;	FAL$MBX_READ ISSUES A QIO READ REQUEST WITH AN AST FOR THE
                                     0091   203 ;	MAILBOX ASSOCIATED WITH THE LINK.
                                     0091   204 ;
                                     0091   205 ; CALLING SEQUENCE:
                                     0091   206 ;
                                     0091   207 ;	BSB/JSB	FAL$MBX_READ
                                     0091   208 ;
                                     0091   209 ; INPUT PARAMETERS:
                                     0091   210 ;
                                     0091   211 ;	R8	ADDRESS OF FAL WORK AREA
                                     0091   212 ;	R9	ADDRESS OF DAP CONTROL BLOCK
                                     0091   213 ;	R10	ADDRESS OF FAB CONTROL BLOCK
                                     0091   214 ;	R11	ADDRESS OF RAB CONTROL BLOCK
                                     0091   215 ;	R9=R11	ARE NOT USED
                                     0091   216 ;
                                     0091   217 ; IMPLICIT INPUTS:
                                     0091   218 ;
                                     0091   219 ;	NONE
                                     0091   220 ;
                                     0091   221 ; OUTPUT PARAMETERS:
                                     0091   222 ;
                                     0091   223 ;	NONE
                                     0091   224 ;
                                     0091   225 ; IMPLICIT OUTPUTS:
                                     0091   226 ;
                                     0091   227 ;	NONE
                                     0091   228 ;
                                     0091   229 ; COMPLETION CODES:
                                     0091   230 ;
                                     0091   231 ;	NONE
                                     0091   232 ;
                                     0091   233 ; SIDE EFFECTS:
                                     0091   234 ;
                                     0091   235 ;	NONE
                                     0091   236 ;
                                     0091   237 ;--
                                     0091   238 
                                     0091   239 FAL$MBX_READ::				; CONTROL POINT
                                     0091   240 	CSB	#FAL$V_MBXAST,FAL$Q_FLG(R8) ; CLEAR MAILBOX AST FLAG
                                     0095   241 	$QIO_S	EFN=#MBXEFN-		; ISSUE READ WITH AST
                                     0095   242 		CHAN=FAL$W_MBXCHN(R8)-	;
                                     0095   243 		FUNC=#IO$_READVBLK-	;
                                     0095   244 		IOSB=FAL$Q_MBXIOSB(R8)-	;
                                     0095   245 		ASTADR=W^FAL$MBX_AST-	;
                                     0095   246 		ASTPRM=R8-		; FAL WORK AREA ADDRESS
                                     0095   247 		P1=FAL$T_MBXBUF(R8)-	; MAILBOX BUFFER ADDRESS
                                     0095   248 		P2=#FAL$K_MBXBUF	; MAILBOX BUFFER SIZE
                                     00BE   249 	CHECK_SS			; CHECK STATUS CODE
                                 05  00C1   250 	RSB				; EXIT
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   8
X0.1-10         FAL$MBX_AST - MAILBOX AST SERVICE ROUTINE                                                                        (6)

                                     00C2   252 	.SBTTL	FAL$MBX_AST - MAILBOX AST SERVICE ROUTINE
                                 000000C2   253 	.PSECT	FAL$CODE	NOSHR,EXE,RD,NOWRT,BYTE
                                     00C2   254 
                                     00C2   255 ;++
                                     00C2   256 ; FUNCTIONAL DESCRIPTION:
                                     00C2   257 ;
                                     00C2   258 ;	FAL$MBX_AST PROCESSES AN AST FOR THE MAILBOX ASSOCIATED WITH
                                     00C2   259 ;	THE LINK. DEPENDING ON THE TYPE OF MESSAGE, ONE OF THREE COURSES
                                     00C2   260 ;	OF ACTION IS TAKEN:
                                     00C2   261 ;	1)  IF IT IS AN INTERRUPT MESSAGE, A DESCRIPTOR IS FORMED TO
                                     00C2   262 ;	    POINT TO IT AND THE RECEIVE MAILBOX MESSAGE FLAG IS SET.
                                     00C2   263 ;	2)  IF THE MESSAGE INDICATES THAT THE LINK HAS BEEN BROKEN, FAL
                                     00C2   264 ;	    EXITS.
                                     00C2   265 ;	3)  IF IT AN EXTRANEOUS MESSAGE, IT IS DISCARDED AND A QIO READ
                                     00C2   266 ;	    MAILBOX WITH AST IS ISSUED.
                                     00C2   267 ;
                                     00C2   268 ; CALLING SEQUENCE:
                                     00C2   269 ;
                                     00C2   270 ;	CALL	#5,FAL$MBX_AST	(INVOKED BY VAX/VMS AS AN AST)
                                     00C2   271 ;
                                     00C2   272 ; INPUT PARAMETERS:
                                     00C2   273 ;
                                     00C2   274 ;	4(AP)	ADDRESS OF FAL WORK AREA
                                     00C2   275 ;
                                     00C2   276 ; IMPLICIT INPUTS:
                                     00C2   277 ;
                                     00C2   278 ;	NONE
                                     00C2   279 ;
                                     00C2   280 ; OUTPUT PARAMETERS:
                                     00C2   281 ;
                                     00C2   282 ;	NONE
                                     00C2   283 ;
                                     00C2   284 ; IMPLICIT OUTPUTS:
                                     00C2   285 ;
                                     00C2   286 ;	FAL$Q_MBX
                                     00C2   287 ;	FAL$V_MBXAST
                                     00C2   288 ;
                                     00C2   289 ; COMPLETION CODES:
                                     00C2   290 ;
                                     00C2   291 ;	NONE
                                     00C2   292 ;
                                     00C2   293 ; SIDE EFFECTS:
                                     00C2   294 ;
                                     00C2   295 ;	FAL MAY EXIT TO VMS.
                                     00C2   296 ;
                                     00C2   297 ;--
                                     00C2   298 
                               0180' 00C2   299 	.ENTRY	FAL$MBX_AST,^M<R7,R8>	; ENTRY POINT FROM EXECUTIVE
            58         04 AC     D0  00C4   300 	MOVL	4(AP),R8		; GET ADDESS OF FAL WORK AREA
            51       0080 C8     9E  00C8   301 	MOVAB	FAL$T_MBXBUF(R8),R1	; GET ADDRESS OF MAILBOX BUFFER
                                     00CD   302 		ASSUME	MSG$_ABORT EQ 48
                                     00CD   303 		ASSUME	MSG$_CONFIRM EQ 49
                                     00CD   304 		ASSUME	MSG$_CONNECT EQ 50
                                     00CD   305 		ASSUME	MSG$_DISCON EQ 51
                                     00CD   306 		ASSUME	MSG$_EXIT EQ 52
                                     00CD   307 		ASSUME	MSG$_INTMSG EQ 53
                                     00CD   308 		ASSUME	MSG$_PATHLOST EQ 54
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page   9
X0.1-10         FAL$MBX_AST - MAILBOX AST SERVICE ROUTINE                                                                        (6)

                                     00CD   309 		ASSUME	MSG$_PROTOCOL EQ 55
                                     00CD   310 		ASSUME	MSG$_REJECT EQ 56
                                     00CD   311 		ASSUME	MSG$_THIRDPARTY EQ 57
                                     00CD   312 	$CASEW	SELECTOR=(R1)+,BASE=#MSG$_ABORT,DISPL=<- ;
                                     00CD   313 		LINK_GONE-		; DISCONNECT ABORT
                                     00CD   314 		IGNORE-			; CONNECT CONFIRM
                                     00CD   315 		IGNORE-			; CONNECT INITIATE
                                     00CD   316 		LINK_GONE-		; SYNCHRONOUS DISCONNECT
                                     00CD   317 		LINK_GONE-		; PARTNER EXITED PREMATURELY
                                     00CD   318 		INTERRUPT-		; INTERRUPT MESSAGE
                                     00CD   319 		LINK_GONE-		; PARTNER NO LONGER ACCESSIBLE
                                     00CD   320 		LINK_GONE-		; PROTOCOL ERROR
                                     00CD   321 		IGNORE-			; CONNECT REJECT
                                     00CD   322 		LINK_GONE-		; THIRDPARTY
                                     00CD   323 		>			;
                                     00E5   324 IGNORE:					; DISCARD JUNK MAIL AND
                          FFA9   30  00E5   325 	BSBW	FAL$MBX_READ		;  RE-ISSUE MAILBOX READ WITH AST
                                 04  00E8   326 	RET				; EXIT
                                     00E9   327 INTERRUPT:				;
                          81     B5  00E9   328 	TSTW	(R1)+			; SKIP OVER UNIT #
            50            81     9A  00EB   329 	MOVZBL	(R1)+,R0		; SKIP OVER DEVICE NAME STORED
            51            50     C0  00EE   330 	ADDL2	R0,R1			;  AS A COUNTED ASCII STRING
            50            81     9A  00F1   331 	MOVZBL	(R1)+,R0		; GET SIZE OF INTERRUPT DATA FIELD
         2C A8            50     7D  00F4   332 	MOVQ	R0,FAL$Q_MBX(R8)	; STORE DESCRIPTOR OF INT. DATA
            57       00C0 C8     DE  00F8   333 	MOVAL	FAL$L_STB(R8),R7	; GET ADDRESS OF STATISTICS BLOCK
                          67     D6  00FD   334 	INCL	FAL$L_RCV_MSG(R7)	; INCREMENT RCV MESSAGE COUNT
                                 C0  00FF   335 	ADDL2	FAL$Q_MBX(R8),-		; UPDATE RCV MESSAGE BYTE COUNT
         08 A7         2C A8         0100   336 		FAL$L_RCV_BYTE(R7)	;
                       2C A8     DD  0104   337 	PUSHL	FAL$Q_MBX(R8)		; SIZE OF MESSAGE IN BYTES
                       30 A8     DD  0107   338 	PUSHL	FAL$Q_MBX+4(R8)		; ADDRESS OF MESSAGE
                          03     DD  010A   339 	PUSHL	#3			; DENOTE A RECEIVE
                          10     DD  010C   340 	PUSHL	#16			; MAXIMUM # BYTES TO DISPLAY
       0000'CF            04     FB  010E   341 	CALLS	#4,W^FAL$DISPLAY_MSG	; PRINT MESSAGE
                                     0113   342 	SSB	#FAL$V_MBXAST,FAL$Q_FLG(R8) ; SET MAILBOX MESSAGE RECEIVED FLAG
                                 04  0117   343 	RET				; EXIT
                                     0118   344 LINK_GONE:				;
                          FEE5'  31  0118   345 	BRW	FAL$TERMINATE		; CLEAN-UP AND EXIT TO VMS
                                     011B   346 	.END
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page  10
SYMBOL TABLE                                                                                                                     (6)

$$COUNT        = 0000000A            FAL$V_EOF      = 0000000A            
$$T1           = 00000000            FAL$V_FILE_MODE= 00000008            
BIT...         = 0000003B            FAL$V_LOG_MSG  = 00000001            
FAL$B_VALUE      00000010            FAL$V_LOG_STAT = 00000000            
FAL$CHECK_SS     ********   X   03   FAL$V_MBXAST   = 00000012            
FAL$C_STBBLN     00000020            FAL$V_RCVAST   = 00000010            
FAL$C_WRKBLN     00000400            FAL$V_XMTAST   = 00000011            
FAL$DISPLAY_MSG  ********   X   03   FAL$W_ACTUALSIZ  00000016            
FAL$K_BUFFERSIZ= 00000080            FAL$W_LNKCHN     00000018            
FAL$K_DAP      = 000000C0            FAL$W_MAXDAPSIZ  00000014            
FAL$K_FAB      = 00000050            FAL$W_MBXCHN     0000001A            
FAL$K_MBXBUF   = 00000040            GBL...         = 00000000            
FAL$K_MBXPROT  = 00000000            IGNORE           000000E5 R     03   
FAL$K_MBXQUOTA = 00000200            INTERRUPT        000000E9 R     03   
FAL$K_NAM      = 00000038            IO$_READVBLK     ********   X   03   
FAL$K_NCBBUF   = 00000040            IO$_WRITEVBLK    ********   X   03   
FAL$K_RAB      = 00000044            LINK_GONE        00000118 R     03   
FAL$K_RESULTSIZ= 00000080            MBXEFN         = 00000003            
FAL$K_STB      = 00000020            MSG$_ABOOPR    = 00000011            
FAL$K_STBBLN     00000020            MSG$_ABORT     = 00000030            
FAL$K_WRKBLN     00000400            MSG$_ACCRSP    = 00000021            
FAL$L_FAB        00000200            MSG$_CONFIRM   = 00000031            
FAL$L_NAM        00000294            MSG$_CONNECT   = 00000032            
FAL$L_RAB        00000250            MSG$_CRUNSOLIC = 00000002            
FAL$L_RCV_BYTE   00000008            MSG$_DELPROC   = 00000003            
FAL$L_RCV_DATA   00000018            MSG$_DELSMB    = 00000014            
FAL$L_RCV_MSG    00000000            MSG$_DEVOFFLIN = 00000005            
FAL$L_RCV_REC    00000010            MSG$_DEVONLIN  = 00000007            
FAL$L_SPARE      0000004C            MSG$_DISCON    = 00000033            
FAL$L_STB        000000C0            MSG$_EXIT      = 00000034            
FAL$L_XMT_BYTE   0000000C            MSG$_INIOPR    = 00000010            
FAL$L_XMT_DATA   0000001C            MSG$_INTMSG    = 00000035            
FAL$L_XMT_MSG    00000004            MSG$_OPREPLY   = 00000009            
FAL$L_XMT_REC    00000014            MSG$_OPRQST    = 00000008            
FAL$MBX_AST      000000C2 RG    03   MSG$_PATHLOST  = 00000036            
FAL$MBX_READ     00000091 RG    03   MSG$_PROTOCOL  = 00000037            
FAL$Q_BOUNDS     00000034            MSG$_REJECT    = 00000038            
FAL$Q_FLG        00000000            MSG$_RESOPR    = 00000013            
FAL$Q_LNKIOSB    0000001C            MSG$_SCANBAD   = 00000028            
FAL$Q_MBX        0000002C            MSG$_SCANRSP   = 00000029            
FAL$Q_MBXIOSB    00000024            MSG$_SMBDON    = 00000009            
FAL$Q_NCB        0000002C            MSG$_SMBINI    = 00000008            
FAL$Q_RCV        0000003C            MSG$_SMBRSP    = 00000020            
FAL$Q_STATE_CTX  00000008            MSG$_SNDACC    = 0000000A            
FAL$Q_XMT        00000044            MSG$_SNDSMB    = 00000004            
FAL$RECEIVE      00000000 RG    03   MSG$_SUSOPR    = 00000012            
FAL$TERMINATE    ********   X   03   MSG$_THIRDPARTY= 00000039            
FAL$TRANSMIT     00000048 RG    03   MSG$_TIMEOUT   = 0000003A            
FAL$T_BUFFER     00000380            MSG$_TRMHANGUP = 00000006            
FAL$T_DAP        00000100            MSG$_TRMUNSOLIC= 00000001            
FAL$T_MBXBUF     00000080            MSG$_XM_ATTN   = 0000000D            
FAL$T_NCBBUF     00000080            MSG$_XM_DATAVL = 0000000B            
FAL$T_RESULTANT  00000300            MSG$_XM_SHUTDN = 0000000C            
FAL$V_ATT_MSG  = 00000001            RCVEFN         = 00000001            
FAL$V_BLOCK_IO = 00000009            SYS$QIO          ********   X   03   
FAL$V_CNF_MSG  = 00000000            SYS$QIOW         ********   X   03   
FAL$V_CONNECT  = 00000002            XMTEFN         = 00000002            
FALDAPIO        - DAP MESSAGE I/O ROUTINES                       22-AUG-1978 01:11:02   VAX-11 MACRO X0.3-11               Page  11
PROGRAM SECTION SYNOPSIS                                                                                                         (6)



PROGRAM SECTION SYNOPSIS

.  ABS  .        00000000      00     NOPIC   USR   CON   ABS   LCL NOSHR NOEXE NORD  NOWRT BYTE  
. BLANK .        00000000      01     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD    WRT BYTE  
$ABS$            00000400      02     NOPIC   USR   CON   ABS   LCL NOSHR   EXE   RD    WRT BYTE  
FAL$CODE         0000011B      03     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD  NOWRT BYTE  


THERE WERE NO ERRORS OR WARNINGS.
20802. BYTES LEFT IN FREE MEMORY POOL.
1262. BYTES OF RECLAIMED MEMORY.
OBJ$:FALDAPIO,LIS$:FALDAPIO/-SP=LIB$:FAL.MLB/ML,SRC$:FALDAPIO
35 MLB DIR RDS - 351 GETS TO DEFINE 24 MACROS. 16 INTER. FILE WRITES. 
