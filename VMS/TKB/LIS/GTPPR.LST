GTPPR	MACRO M1110  22-AUG-78 01:43  PAGE 2


      1						.TITLE	GTPPR
      2						.IDENT	/05/
      3					                                                                                ;**-1
      4					;
      5					; COPYRIGHT   1973,  DIGITAL  EQUIPMENT  CORP.,  MAYNARD,   MASS.
      6					;
      7					; THIS SOFTWARE IS FURNISHED TO PURCHASER UNDER A LICENSE FOR USE
      8					; ON A  SINGLE COMPUTER SYSTEM AND CAN BE COPIED (WITH INCLUSION
      9					; OF DEC'S COPYRIGHT NOTICE) ONLY FOR USE IN SUCH SYSTEM, EXCEPT
     10					; AS MAY OTHERWISE BE PROVIDED IN WRITING BY DEC.
     11					;
     12					; THE  INFORMATION IN THIS DOCUMENT IS SUBJECT TO CHANGE WITHOUT
     13					; NOTICE AND  SHOULD NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
     14					; EQUIPMENT CORPORATION.
     15					;
     16					; DEC  ASSUMES NO  RESPONSIBILITY  FOR  THE  USE  OR RELIABILITY
     17					; OF ITS  SOFTWARE ON  EQUIPMENT WHICH  IS NOT SUPPLIED BY DEC.
     18					;
     19					; VERSION 05
     20					;                                                                               ;**-1
     21					; C. MONIA 21-DEC-73
     22					;
     23					; MODIFICATIONS:
     24					;
     25					; NO.		DATE		PROGRAMMER
     26					; ---		----		----------
     27					;
     28					; 041		16-MAY-75	C. MONIA
     29					;
     30					; SUBROUTINE TO RETURN PARTITION PARAMETERS
     31					;
     32					;
     33					;
     34					; MACRO LIBRARY CALLS
     35					;
     36
     37						.MCALL	DIR$,GPRT$
     38
     39					;
     40					; LOCAL DATA
     41					;
     42					;
     43					; DEFAULT PARTITION NAME
     44					;
     45
     46	000000	026226 	000000 		DFPAR:	.RAD50	/GEN   /	;
     47
     48					;
     49					; DPB-'GET PARTITION PARAMETERS' DIRECTIVE
     50					;
     51
     52	000004				PRDPB:	GPRT$	,PRBF		;
     53
     54					;
     55					; BUFFER TO RECEIVE PARTITION DATA
     56					;
     57
GTPPR	MACRO M1110  22-AUG-78 01:43  PAGE 2-1


     58	000014				PRBF:	.BLKW	3		;
     59
     60					;
     61					;+
     62					; **-$GTPPR - 'GET PARTITION PARAMETERS' SUBROUTINE
     63					;
     64					; INPUTS:
     65					;
     66					;	R0:	POINTS TO PARTITION NAME IN 2-WORD
     67					;		RADIX 50 FORMAT. IF R0 IS ZERO
     68					;		THE DEFAULT PARTITION IS RETURNED.
     69					;
     70					; OUTPUTS:
     71					;
     72					;	C-CLEAR:	SPECIFIED PARTITION FOUND
     73					;
     74					;		R0:	UNMODIFIED
     75					;		R1:	BASE ADDRESS OF PARTITION
     76					;		R2:	PARTITION SIZE IN 32W BLOCKS                            ;**NEW**
     77					;		   	(SET TO 0 FOR SYSTEM CONTROLLED PARTITION)
     78					;
     79					;                                                                               ;**-1
     80					;	$PNAME-$PNAME+2: NAME OF DEFAULT PARTITION (IF REQUESTED)
     81					;
     82					;	C-SET:	REQUESTED PARTITION DOES NOT EXIST IN HOST SYSTEM.
     83					;
     84					;-
     85					;
     86
     87	000022				$GTPPR::			;
     88	000022	005767 	000000G			TST	$RSXSY		; TEST SYSTEM RUNNING ON
     89	000026	000261 				SEC			; ASSUME RSX-11D
     90	000030	100035 				BPL	40$		; IF PL RSX-11D, ERROR
     91	000032					SAVRG			; SAVE NON-VOLATILE REGISTERS
     92	000036	010046 				MOV	R0,-(SP)	; SAVE POINTER TO NAME
     93	000040	001007 				BNE	20$		; IF NE NAME SPECIFIED
     94	000042	012704 	000000G			MOV	#$PNAME,R4	; GET LOCATION FOR NAME
     95	000046	012700 	000000'			MOV	#DFPAR,R0	; GET ADDRESS OF DEFAULT NAME
     96	000052	011024 				MOV	(R0),(R4)+	; SET DEFAULT NAME
     97	000054	016024 	000002 			MOV	2(R0),(R4)+	;
     98	000060				20$:				;
     99	000060	012704 	000006'			MOV	#PRDPB+G.PRPN,R4 ; GET ADDRESS OF NAME IN DPB
    100	000064	012024 				MOV	(R0)+,(R4)+	; SETUP NAME
    101	000066	012024 				MOV	(R0)+,(R4)+	;
    102	000070					DIR$	#PRDPB		; ISSUE DIRECTIVE
    103	000076	103411 				BCS	35$		; IF C/S NO SUCH PARTITION
    104	000100	013701 	000000G			MOV	@#$DSW,R1	; GET VIRTUAL PARTITION ADDRESS
    105	000104	016702 	177706 			MOV	PRBF+G.PRPS,R2	;++041 GET LENGTH/64
    106	000110	032767 	000001 	177702 		BIT	#1,PRBF+G.PRFW	;++041 SYSTEM CONTROLLED PARTITION?
    107	000116	001001 				BNE	35$		;++041 IF NE NO
    108	000120	005002 				CLR	R2		;++041 SET LENGTH TO ZERO
    109	000122				35$:				;                                               ;**-5
    110	000122	012600 				MOV	(SP)+,R0	; RESTORE NAME POINTER
    111	000124				40$:				;
    112	000124					RETURN			;
    113					                                                                                ;**-11
    114		000001 				.END
GTPPR	MACRO M1110  22-AUG-78 01:43  PAGE 2-2
SYMBOL TABLE

CR    = 000015   	G.PRPB= 000000   	PRBF    000014R  	VT    = 000013   	$RSXSY= ****** GX
DFPAR   000000R  	G.PRPN= 000002   	PRDPB   000004R  	$DSW  = ****** GX	$SAVRG= ****** GX
FF    = 000014   	G.PRPS= 000002   	R$$11M= 000000   	$GTPPR  000022RG 	$$$OST= 000006
G.PRBA= 000006   	HT    = 000011   	SPA   = 000040   	$PNAME= ****** GX	$$$T1 = 000000
G.PRFW= 000004   	LF    = 000012

. ABS.	000000	   000
      	000126	   001
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  1054 WORDS  ( 5 PAGES)
DYNAMIC MEMORY:  2772 WORDS  ( 10 PAGES)
ELAPSED TIME:  00:00:07
OBJ$:GTPPR,LIS$:GTPPR/-SP=SRC$:MACFLM,GTPPR
