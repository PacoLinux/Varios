TASKB	MACRO M1110  22-AUG-78 02:01  PAGE 3


      1						.TITLE	TASKB
      2						.IDENT	/M29/
      3					                                                                                ;**-1
      4					;
      5					; COPYRIGHT (C) 1976,1977
      6					; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
      7					;
      8					; THIS SOFTWARE IS FURNISHED UNDER A LICENSE FOR USE ONLY ON A
      9					; SINGLE COMPUTER SYSTEM AND MAY  BE  COPIED   ONLY  WITH  THE
     10					; INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE,  OR
     11					; ANY OTHER COPIES THEREOF, MAY NOT BE PROVIDED  OR  OTHERWISE
     12					; MADE AVAILABLE TO ANY OTHER PERSON   EXCEPT FOR  USE ON SUCH
     13					; SYSTEM AND TO ONE WHO AGREES TO THESE LICENSE  TERMS.  TITLE
     14					; TO AND OWNERSHIP OF THE SOFTWARE SHALL AT ALL  TIMES  REMAIN
     15					; IN DEC.
     16					;
     17					; THE INFORMATION IN THIS DOCUMENT IS SUBJECT TO CHANGE WITHOUT
     18					; NOTICE AND SHOULD NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
     19					; EQUIPMENT CORPORATION.
     20					;
     21					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF
     22					; ITS SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
     23					;
     24					; VERSION M27
     25					;                                                                               ;**-1
     26					; D. N. CUTLER/C. MONIA 14-FEB-74
     27					;
     28					; RSX-11D/M TASK BUILDER
     29					;
     30					;
     31					;
     32					; MODIFICATIONS
     33					;
     34					;
     35					; NO.		DATE		PROGRAMMER
     36					; ---		----		----------
     37					;
     38					; 002		3-JUL-73	C. MONIA
     39					; 006		4-AUG-73	C. MONIA
     40					; 034		07-JAN-75	C. MONIA
     41					; 036		14-JAN-75	C. MONIA
     42					; 037		15-MAR-75	C. MONIA                                        ;**NEW**
     43					; 040		24-APR-75	C. MONIA
     44					; 041		15-APR-75	C. MONIA
     45					; 042		29-JUL-75	C. MONIA
     46					; 043		23-SEP-75	C. MONIA
     47					; 044		21-JAN-76	C. MONIA
     48					; 048		10-FEB-76	C. MONIA
     49					; 051		02-FEB-76	C. MONIA
     50					; 052		01-APR-76	C. MONIA
     51					; 058		27-APR-76	C. MONIA
     52					; 061		16-MAY-76	C. MONIA
     53					; 063		31-MAY-76	C. MONIA
     54					; 067		31-JUL-76	C. MONIA
     55					; 075		22-OCT-76	C. MONIA
     56					; JAK106	31-AUG-77	EXIT WITH STATUS
     57					;
TASKB	MACRO M1110  22-AUG-78 02:01  PAGE 3-1


     58					;
     59					;
     60					;
     61					; MACRO LIBRARY CALLS
     62					;
     63
     64						.IF	NDF	R$$11M
     65
     66						.MCALL	CLOSE$,EXIT$S,OPEN$W
     67
     68						.IFF
     69
     70						.MCALL	CLOSE$,EXIT$S
     71
     72						.ENDC
     73					;
     74					; LOCAL DATA
     75					;
     76
     77	000000				SPSAV:	.BLKW	1		;SAVED INITIAL STACK POINTER
     78	000002	000000 			$VERSN::.WORD	0		;++037 VERSION IDENTIFICATION
     79	000004	000000 				.WORD	0		;++037
     80						.EVEN
     81
     82					;+
     83					; **-$TASKB-ENTRY TO TASK BUILDER
     84					;-
     85
     86	000006				$TASKB::
     87	000006	012700 	000002'			MOV	#$VERSN,R0	;++037 GET ADDRESS OF VERSION NUMBER
     88	000012	005710 				TST	(R0)		;++037 RESTART?
     89	000014	001002 				BNE	10$		;++037 IF NE NO
     90	000016	010320 				MOV	R3,(R0)+	;++037 SET FIRST HALF OF VERSION
     91	000020	010410 				MOV	R4,(R0)		;++037 SET SECOND HALF OF VERSION
     92	000022				10$:				;++037
     93
     94						.IF	NDF	R$$11M
     95
     96						OPEN$W	$CMOPT		; OPEN COMMAND OUTPUT FILE
     97						BCS	$QUIT		; IF C/S LEAVE QUIETELY
     98
     99						.ENDC
    100
    101	000022	010667 	177752 			MOV	SP,SPSAV	;SAVE INITIAL STACK POINTER
    102	000026	012767 	000000G	000000G		MOV	#EX$SUC,$EXSTS	; ASSUME SUCCESS				;JAK106
    103	000034	016706 	177740 		TASKB1:	MOV	SPSAV,SP	;RETRIEVE SAVED STACK POINTER
    104	000040	012705 	000000G			MOV	#$SWTCH,R5	;GET ADDRESS OF SWITCH OPTION WORD
    105	000044	012704 	000000G			MOV	#$PHASE,R4	;GET ADDRESS OF PHASE NUMBER
    106	000050					CALL	$BLDSG		;BUILD SEGMENT DESCRIPTION
    107	000054	062714 	000002 			ADD	#2,(R4)		;UPDATE PHASE NUMBER
    108	000060					CALL	$P2OPT		;PROCESS OPTIONS
    109	000064	005214 				INC	(R4)		;INCREMENT PHASE NUMBER
    110	000066					CALL	$P3PRE		; PERFORM PREPROCESSING FOR PHASE 3
    111	000072					CALL	$P3MDS		;CALL PHASE 3 MODULE SCAN
    112	000076	005214 				INC	(R4)		;INCREMENT PHASE NUMBER
    113	000100					CALL	$P4MAL		;CALL PHASE 4 MEMORY ALLOCATION
    114	000104	005214 				INC	(R4)		;INCREMENT PHASE NUMBER
TASKB	MACRO M1110  22-AUG-78 02:01  PAGE 3-2


    115	000106	032715 	000000G			BIT	#TS$KF,(R5)	;TASK IMAGE FILE SPECIFIED?
    116	000112	001402 				BEQ	20$		;IF EQ NO
    117	000114				10$:	CALL	$P5MDS		;CALL PHASE 5 MODULE SCAN
    118	000120				20$:				;
    119	000120					CALL	$P5MAP		; OUTPUT MAP FILE, UNDEFINED SYMBOLS
    120	000124				30$:				;
    121	000124	005214 				INC	(R4)		; INCREMENT PHASE NUMBER
    122	000126	032715 	000000G			BIT	#ST$BF,(R5)	;SYMBOL FILE SPECIFIED?
    123	000132	001402 				BEQ	$RSTRT		;IF EQ NO
    124	000134					CALL	$P6STB		;CALL PHASE 6 SYMBOL TABLE ROUTINE
    125	000140				$RSTRT::			;
    126	000140					CLOSE$	$WRKPT		; CLOSE WORK FILE
    127	000150	032767 	000000G	000000G		BIT	#EN$DR,$SWTCH	; END OF RUN?
    128	000156	001726 				BEQ	TASKB1		;IF EQ NO
    129	000160				$QUIT::
    130
    131						.IF	NDF	R$$11M
    132
    133						CLOSE$	$CMOPT		; CLOSE COMMAND OUTPUT FILE
    134
    135						.ENDC
    136
    137	000160					CLOSE$	$CMIPT		;CLOSE COMMAND INPUT FILE
    138	000170					CLOSE$	$WRKPT		; CLOSE WORK FILE
    139	000200	016700 	000000G			MOV	$EXSTS,R0	; GET EXIT STATUS				;JAK106
    140	000204					CALL	$EXST		; EXIT AND RETURN STATUS			;JAK106
    141															;**-1
    142		000006'				.END	$TASKB
TASKB	MACRO M1110  22-AUG-78 02:01  PAGE 3-3
SYMBOL TABLE

B.BBFS= 000010   	FD.PLC= 000004   	F.CHR = 000075   	F.URBD= 000020   	S.FATT= 000016
B.BFST= 000015   	FD.PRN= 000004   	F.CNTG= 000034   	F.VBN = 000064   	S.FDB = 000140
B.NXBD= 000012   	FD.PSE= 010000   	F.DFNB= 000046   	F.VBSZ= 000060   	S.FNAM= 000006
B.VBN = 000004   	FD.RAH= 000001   	F.DSPT= 000044   	HT    = 000011   	S.FNB = 000036
CH.AND= 000001   	FD.RAN= 000002   	F.DVNM= 000134   	LF    = 000012   	S.FNBW= 000017
CR    = 000015   	FD.REC= 000001   	F.EFBK= 000010   	NB.DEV= 000200   	S.FNTY= 000004
EN$DR = ****** GX	FD.RWM= 000001   	F.EFN = 000050   	NB.DIR= 000100   	S.FTYP= 000002
EX$SUC= ****** GX	FD.SDI= 000020   	F.EOBB= 000032   	NB.NAM= 000004   	S.NFEN= 000020
FA.APD= 000100   	FD.SQD= 000040   	F.ERR = 000052   	NB.SD1= 000400   	TASKB1  000034R
FA.CRE= 000010   	FD.TTY= 000004   	F.FACC= 000043   	NB.SD2= 001000   	TS$KF = ****** GX
FA.DLK= 001000   	FD.WBH= 000002   	F.FFBY= 000014   	NB.SNM= 000040   	VT    = 000013
FA.ENB= 100000   	FF    = 000014   	F.FNAM= 000110   	NB.STP= 000020   	$BLDSG= ****** GX
FA.EXC= 002000   	FF.CHR= 000005   	F.FNB = 000102   	NB.SVR= 000010   	$CMIPT= ****** GX
FA.EXT= 000004   	FF.NV = 000003   	F.FTYP= 000116   	NB.TYP= 000002   	$EXST = ****** GX
FA.NSP= 000100   	FF.POE= 000002   	F.FVER= 000120   	NB.VER= 000001   	$EXSTS= ****** GX
FA.POS= 010000   	FF.RWD= 000001   	F.HIBK= 000004   	N.DID = 000024   	$PHASE= ****** GX
FA.RD = 000001   	FF.RWF= 000006   	F.LUN = 000042   	N.DVNM= 000032   	$P2OPT= ****** GX
FA.RWD= 004000   	FF.SPC= 000004   	F.MBCT= 000054   	N.FID = 000000   	$P3MDS= ****** GX
FA.SEQ= 040000   	FO.APD= 000106   	F.MBC1= 000055   	N.FNAM= 000006   	$P3PRE= ****** GX
FA.SHR= 000040   	FO.MFY= 000002   	F.MBFG= 000056   	N.FTYP= 000014   	$P4MAL= ****** GX
FA.TMP= 000020   	FO.RD = 000001   	F.NRBD= 000024   	N.FVER= 000016   	$P5MAP= ****** GX
FA.WCK= 020000   	FO.UPD= 000006   	F.NREC= 000030   	N.NEXT= 000022   	$P5MDS= ****** GX
FA.WRT= 000002   	FO.WRT= 000016   	F.OVBS= 000030   	N.STAT= 000020   	$P6STB= ****** GX
FD.BLK= 000010   	F.ACTL= 000076   	F.RACC= 000016   	N.UNIT= 000034   	$QUIT   000160RG
FD.CCL= 000002   	F.ALOC= 000040   	F.RATT= 000001   	PAR$$$= 000067   	$RSTRT  000140RG
FD.COM= 020000   	F.BBFS= 000062   	F.RCNM= 000034   	R$$11M= 000000   	$SWTCH= ****** GX
FD.CR = 000002   	F.BDB = 000070   	F.RCTL= 000017   	R.FIX = 000001   	$TASKB  000006RG
FD.DIR= 000010   	F.BGBC= 000057   	F.RSIZ= 000002   	R.SEQ = 000003   	$VERSN  000002RG
FD.FTN= 000001   	F.BKDN= 000026   	F.RTYP= 000000   	R.VAR = 000002   	$WRKPT= ****** GX
FD.F11= 040000   	F.BKDS= 000020   	F.SEQN= 000100   	SPA   = 000040   	$$    = 000001
FD.INS= 000010   	F.BKEF= 000050   	F.SPDV= 000072   	SPSAV   000000R  	.CLOSE= ****** G
FD.ISP= 002000   	F.BKP1= 000051   	F.SPUN= 000074   	ST$BF = ****** GX	...GBL= 000000
FD.MNT= 100000   	F.BKST= 000024   	F.STBK= 000036   	S.BFHD= 000020   	...TPC= 000140
FD.OSP= 004000   	F.BKVB= 000064   	F.UNIT= 000136

. ABS.	000000	   000
      	000210	   001
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  2254 WORDS  ( 9 PAGES)
DYNAMIC MEMORY:  2772 WORDS  ( 10 PAGES)
ELAPSED TIME:  00:00:17
OBJ$:TASKB,LIS$:TASKB/-SP=SRC$:MACFLM,FCSPR,TASKB
