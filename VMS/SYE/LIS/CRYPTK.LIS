
                22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 1   
					CRYPTK.FOR.19       

0001    	SUBROUTINE 	CRYPTK(LUN,NAME,REG,I)
0002    	BYTE		LUN
0003    	CHARACTER*8	NAME
0004    	INTEGER*4	REG(I)
0005    	INTEGER*2	I
         
        C++
        C	FACILITY:
        C		Error logging.
         
        C
        C	ABSTRACT:
        C
         
        C
        C
        C	AUTHOR:	WM P STOREY,	CREATION DATE:
        C
        C	MODIFIED BY:
        C
        C	 , VERSION  ,
        C	01	-
        C
        C--
         
        C
        C	INCLUDE FILES:
        C
0006    	INCLUDE 'SRC$:EMBDEF.FOR/NOLIST'
0163    	INCLUDE 'SRC$:SYECOM.FOR/NOLIST'
         
        C
        C	EQUATED SYMBOLS:
        C
        C					NONE.
         
        C
        C	OWN STORAGE:
        C
0177    	INTEGER*2	LENGTH
0178    	INTEGER*2	MAXIMUM
         
0179    	CHARACTER*3	CONTROL
0180    	CHARACTER*8	OLDNAME
0181    	CHARACTER*8	OUT(20)
0182    	CHARACTER*8	STRING
0183    	CHARACTER*24	TIME
         
        C
        C	EXTERNAL REFERENCES:
        C
0184    	LOGICAL*4	SYS$ASCTIM
         
         
0185    	ENTRY CRYPTK4(LUN,NAME,REG,I)
         

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 2   
					CRYPTK.FOR.19       

0186    	CONTROL	= '!XW'
         
0187    	LENGTH	= 4
         
0188    	IF(TTY)
        	1	THEN
0189    			MAXIMUM = 12
0190    		ELSE
0191    			MAXIMUM = 20
0192    	ENDIF
         
0193    	GO TO 100
         
         
0194    	ENTRY CRYPTK8(LUN,NAME,REG,I)
         
0195    	CONTROL	= '!XL'
         
0196    	LENGTH	= 8
         
0197    	IF(TTY)
        	1	THEN
0198    			MAXIMUM = 7
0199    		ELSE
0200    			MAXIMUM = 11
0201    	ENDIF
         
         
0202     100	CONTINUE
         
         
0203    	IF(NAME .EQ. OLDNAME)
        	1	THEN
0204    			STRING = '        '	! 8* ' '
0205    		ELSE
0206    			STRING = NAME
0207    	ENDIF
         
0208    	OLDNAME = NAME
         
0209    	L	= MIN(MAXIMUM,MAX(1,I))
         
0210    	DO 400, J=1,L
0211    	    OUT(J) = ' '
0212    	    CALL SYS$FAO(CONTROL,LEN,%DESCR(OUT(J)),%VAL(REG(J)))
0213     400	CONTINUE
         
0214    	IF (TTY)
        	1  THEN
0215    		WRITE(LUN,501) STRING,(OUT(J)(1:LENGTH),J=1,L)
0216    	   ELSE
0217    		IF(.NOT. SYS$ASCTIM(,%DESCR(TIME),EMB$Q_HD_TIME,0))
        	1			TIME = 'INVALID TIME: SYS$ASCTIM'
         
0218    		WRITE(LUN,501) STRING,(OUT(J)(1:LENGTH),J=1,L),TIME(1:22)
0219    	ENDIF

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 3   
					CRYPTK.FOR.19       

0220     501	FORMAT(' ',A,T10,<L>(A,X):,T111,A)
         
0221    	RETURN
0222    	END

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 4   
					CRYPTK.FOR.19       

		.TITLE	CRYPTK
		.IDENT	01

    0000	.PSECT	EMB
    0000  EMB:

    0000	.PSECT	SYECOM
    0000  L_QUESTION:
    0004  TTY:
    0008  DEVSUMCNT:
    000A  RECCNT:
    000C  NAMDEVSUM:
    0160  VOLNAM:

    0004	.PSECT	EMB
    0004  EMB$W_HD_ENTRY:
    0004  EMB$B_HD_ENTRY:
    0004  EMB$W_DV_ENTRY:
    0004  EMB$B_DV_ENTRY:
    0004  EMB$W_TS_ENTRY:
    0004  EMB$B_TS_ENTRY:
    0004  EMB$W_SS_ENTRY:
    0004  EMB$B_SS_ENTRY:
    0004  EMB$W_VM_ENTRY:
    0004  EMB$B_VM_ENTRY:
    0010  EMB$L_SU_DAYTIM:
    000E  EMB$W_SU_ERRSEQ:
    0006  EMB$Q_SU_TIME:
    0004  EMB$W_SU_ENTRY:
    0032  EMB$T_VM_LABEL:
    0030  EMB$W_VM_NUMSET:
    002E  EMB$W_VM_VOLNUM:
    001F  EMB$T_VM_NAMTXT:
    001E  EMB$B_VM_NAMLNG:
    001C  EMB$W_VM_UNIT:
    0018  EMB$L_VM_OPRCNT:
    0014  EMB$L_VM_ERRCNT:
    0010  EMB$L_VM_OWNUIC:
    000E  EMB$W_VM_ERRSEQ:
    0006  EMB$Q_VM_TIME:
    0012  EMB$B_SS_MSGTXT:
    0010  EMB$W_SS_MSGSZ:
    000E  EMB$W_SS_ERRSEQ:
    0006  EMB$Q_SS_TIME:
    000E  EMB$W_TS_ERRSEQ:
    0006  EMB$Q_TS_TIME:
    004E  EMB$L_DV_REGSAV:
    003E  EMB$T_DV_NAME:
    003C  EMB$W_DV_FUNC:
    003A  EMB$B_DV_SLAVE:
    0036  EMB$L_DV_CHAR:
    0032  EMB$L_DV_OWNUIC:
    002E  EMB$L_DV_OPCNT:
    002C  EMB$W_DV_ERRCNT:
    002A  EMB$W_DV_UNIT:
    0026  EMB$L_DV_MEDIA:

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 5   
					CRYPTK.FOR.19       

    0024  EMB$W_DV_BCNT:
    0022  EMB$W_DV_BOFF:
    001E  EMB$L_DV_RQPID:
    001D  EMB$B_DV_TYPE:
    001C  EMB$B_DV_CLASS:
    001A  EMB$W_DV_DEVSTS:
    0012  EMB$Q_DV_IOSB:
    0011  EMB$B_DV_ERTMAX:
    0010  EMB$B_DV_ERTCNT:
    000E  EMB$W_DV_ERRSEQ:
    0006  EMB$Q_DV_TIME:
    000E  EMB$W_HD_ERRSEQ:
    0006  EMB$Q_HD_TIME:
    0000  EMB$L_SID:

    0000	.PSECT	$PDATA
    0000	.LONG	^X00000000

    00DC	.PSECT	$LOCAL
    00DC	.LONG	^X010E0008
    00E0	.LONG	^X00000000
    00E4	.LONG	^X00000000,^X00000000
    00EC	.LONG	^X04080004
    00F0	.LONG	^X00000000
    00F4	.LONG	^X01E00000,^X00000000
    00FC	.LONG	^X00000000
    0100	.LONG	^X00000000,^X00000001,^X00000000
    010C	.LONG	^X010E0003
    0110	.ADDR	CONTROL
    0114	.LONG	^X010E0008
    0118	.ADDR	STRING
    011C	.LONG	^X010E0018
    0120	.ADDR	TIME
    0124	.LONG	^X010E0008
    0128	.LONG	^X00000000
    012C	.LONG	^X00000004
    0130	.ADDR	$LOCAL+^X10C
    0134	.ADDR	LEN
    0138	.ADDR	$LOCAL+^X124
    013C	.LONG	^X00000000
    0140	.LONG	^X010E0000
    0144	.LONG	^X00000000
    0148	.LONG	^X00000004
    014C	.LONG	^X00000000
    0150	.ADDR	$LOCAL+^X11C
    0154	.ADDR	EMB$Q_HD_TIME
    0158	.ADDR	$PDATA
    015C	.LONG	^X010E0016
    0160	.ADDR	TIME

    0004	.PSECT	$PDATA
    0004  .501:
    0004	.XBYTE	0F,01,20,29,0D,0A,01,82,80
    000D	.ADDR	L$DCFC
    0011	.XBYTE	29,0E,01,03,07,0D,6F,29,04


CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 6   
					CRYPTK.FOR.19       

    0000	.PSECT	$CODE
    0000  CRYPTK::
    0000	.WORD	^M<IV,R2,R3,R4,R5,R7,R8,R9,R10,R11>
    0002	MOVAL	$LOCAL+^XD0, R11
    0009	MOVQ	@NAME(AP), R0
    000D	MOVL	R1, $LOCAL+^XE0(R11)
    0011	BSBW	L$IAGD
    0014	BRB	L$PBOC
    0016  CRYPTK4::
    0016	.WORD	^M<IV,R2,R3,R4,R5,R7,R8,R9,R10,R11>
    0018	MOVAL	$LOCAL+^XD0, R11
    001F	MOVQ	@NAME(AP), R0
    0023	MOVL	R1, $LOCAL+^XE0(R11)
    0027	BSBW	L$IAGD
    002A  L$PBOC:
									    ; 0186
    002A	MOVC3	#3, $PDATA+^X1A, CONTROL(R11)
									    ; 0187
    0033	MOVW	#4, LENGTH(R11)
									    ; 0188
    0037	BLBC	TTY, L$PBLD
									    ; 0189
    003E	MOVW	#12, MAXIMUM(R11)
									    ; 0190
    0042	BRB	L$PBBE
    0044  L$PBLD:
									    ; 0191
    0044	MOVW	#20, MAXIMUM(R11)
									    ; 0192
    0048  L$PBBE:
									    ; 0193
    0048	BRB	.100
    004A  CRYPTK8::
    004A	.WORD	^M<IV,R2,R3,R4,R5,R7,R8,R9,R10,R11>
    004C	MOVAL	$LOCAL+^XD0, R11
    0053	MOVQ	@NAME(AP), R0
    0057	MOVL	R1, $LOCAL+^XE0(R11)
    005B	BSBW	L$IAGD
    005E  L$PBFF:
									    ; 0195
    005E	MOVC3	#3, $PDATA+^X1D, CONTROL(R11)
									    ; 0196
    0067	MOVW	#8, LENGTH(R11)
									    ; 0197
    006B	BLBC	TTY, L$PBCG
									    ; 0198
    0072	MOVW	#7, MAXIMUM(R11)
									    ; 0199
    0076	BRB	L$PBIG
    0078  L$PBCG:
									    ; 0200
    0078	MOVW	#11, MAXIMUM(R11)
									    ; 0201
    007C  L$PBIG:
									    ; 0202
    007C  .100:

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 7   
					CRYPTK.FOR.19       

									    ; 0203
    007C	CMPC3	#8, @$LOCAL+^XE0(R11), OLDNAME(R11)
    0082	BNEQ	L$PBOG
									    ; 0204
    0084	MOVQ	#^X2020202020202020, STRING(R11)
									    ; 0205
    0090	BRB	L$PBEH
    0092  L$PBOG:
									    ; 0206
    0092	MOVQ	@$LOCAL+^XE0(R11), STRING(R11)
									    ; 0207
    0097  L$PBEH:
									    ; 0208
    0097	MOVQ	@$LOCAL+^XE0(R11), OLDNAME(R11)
									    ; 0209
    009C	MOVW	#1, R0
    009F	CMPW	R0, @I(AP)
    00A3	BGEQ	$CODE+^XA9
    00A5	MOVW	@I(AP), R0
    00A9	CMPW	R0, MAXIMUM(R11)
    00AD	BLEQ	$CODE+^XB3
    00AF	MOVW	MAXIMUM(R11), R0
    00B3	CVTWL	R0, L(R11)
									    ; 0210
    00B6	MOVL	L(R11), R7
    00B9	MOVL	#1, R9
    00BC	MOVAL	@$LOCAL+^XFC(R11), R8
    00C0  L$PBAL:
									    ; 0211
    00C0	MULL3	#8, R9, R10
    00C4	MOVC5	#0, (SP), #^X20, #8, OUT-8(R11)[R10]
									    ; 0212
    00CD	MOVAB	OUT-8(R11)[R10], $LOCAL+^X128(R11)
    00D4	MOVL	(R8)[R9], $LOCAL+^X13C(R11)
    00D9	CALLG	$LOCAL+^X12C(R11), SYS$FAO
									    ; 0213
    00E1	AOBLEQ	R7, R9, L$PBAL
									    ; 0214
    00E5	BLBC	TTY, L$PBJN
									    ; 0215
    00EC	PUSHAL	.501
    00F2	CVTBL	@LUN(AP), -(SP)
    00F6	CALLS	#2, FOR$WRITE_SF
    00FD	PUSHAB	$LOCAL+^X114(R11)
    0100	CALLS	#1, FOR$IO_T_DS
    0107	MOVL	#1, R9
    010A	CVTWL	LENGTH(R11), R10
    010E  L$PBFO:
    010E	MULL3	#8, R9, R0
    0112	MOVW	R10, $LOCAL+^X140(R11)
    0116	MOVAB	OUT-8(R11)[R0], $LOCAL+^X144(R11)
    011D	PUSHAB	$LOCAL+^X140(R11)
    0120	CALLS	#1, FOR$IO_T_DS
    0127	AOBLEQ	L(R11), R9, L$PBFO
    012B	CALLS	#0, FOR$IO_END
									    ; 0216

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 8   
					CRYPTK.FOR.19       

    0132	BRB	L$DCAA
    0134  L$PBJN:
									    ; 0217
    0134	CALLG	$LOCAL+^X148(R11), SYS$ASCTIM
    013C	BLBS	R0, L$DCGA
    013F	MOVC3	#24, $PDATA+^X20, TIME(R11)
    0148  L$DCGA:
									    ; 0218
    0148	PUSHAL	.501
    014E	CVTBL	@LUN(AP), -(SP)
    0152	CALLS	#2, FOR$WRITE_SF
    0159	PUSHAB	$LOCAL+^X114(R11)
    015C	CALLS	#1, FOR$IO_T_DS
    0163	MOVL	#1, R9
    0166	CVTWL	LENGTH(R11), R10
    016A  L$DCMA:
    016A	MULL3	#8, R9, R0
    016E	MOVW	R10, $LOCAL+^X140(R11)
    0172	MOVAB	OUT-8(R11)[R0], $LOCAL+^X144(R11)
    0179	PUSHAB	$LOCAL+^X140(R11)
    017C	CALLS	#1, FOR$IO_T_DS
    0183	AOBLEQ	L(R11), R9, L$DCMA
    0187	PUSHAB	$LOCAL+^X15C(R11)
    018B	CALLS	#1, FOR$IO_T_DS
    0192	CALLS	#0, FOR$IO_END
									    ; 0219
    0199  L$DCAA:
    0199	MOVL	R9, J(R11)
									    ; 0221
    019D	RET	
    019E  L$IAGD:
    019E	MOVL	@I(AP), $LOCAL+^X108(R11)
    01A3	MOVL	REG(AP), $LOCAL+^XF0(R11)
    01A8	MOVAL	$LOCAL+^XEC(R11), R0
    01AC	JMP	FOR$INI_DES1_R2
    01B2  L$DCFC:
    01B2	.WORD	^M<IV>
    01B4	MOVL	L, R0
    01BB	RET	

    001A	.PSECT	$PDATA
    001A	.XBYTE	21,58,57
    001D	.XBYTE	21,58,4C
    0020	.XBYTE	49,4E,56,41,4C,49,44,20,54,49,4D,45,3A,20,53,59
    0030	.XBYTE	53,24,41,53,43,54,49,4D
		.END

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 9   
					CRYPTK.FOR.19       

PROGRAM SECTIONS

    Name                 Bytes   Attributes

  0 $CODE                  444   PIC CON REL LCL   SHR   EXE   RD NOWRT LONG
  1 $PDATA                  56   PIC CON REL LCL   SHR NOEXE   RD NOWRT LONG
  2 $LOCAL                 356   PIC CON REL LCL NOSHR NOEXE   RD   WRT LONG
  3 EMB                    500   PIC OVR REL GBL   SHR NOEXE   RD   WRT LONG
  4 SYECOM                2272   PIC OVR REL GBL   SHR NOEXE   RD   WRT LONG


ENTRY POINTS

    Address  Type Name               Address  Type Name               Address  Type Name           

  0-00000000      CRYPTK           0-00000016      CRYPTK4          0-0000004A      CRYPTK8        


VARIABLES

    Address  Type Name               Address  Type Name               Address  Type Name               Address  Type Name           

  2-000000A0  CHR CONTROL          4-00000008  I*2 DEVSUMCNT        3-0000001C  L*1 EMB$B_DV_CLASS   3-00000004  L*1 EMB$B_DV_ENTRY 
  3-00000010  L*1 EMB$B_DV_ERTCNT  3-00000011  L*1 EMB$B_DV_ERTMAX  3-0000003A  L*1 EMB$B_DV_SLAVE   3-0000001D  L*1 EMB$B_DV_TYPE  
  3-00000004  L*1 EMB$B_HD_ENTRY   3-00000004  L*1 EMB$B_SS_ENTRY   3-00000012  L*1 EMB$B_SS_MSGTXT  3-00000004  L*1 EMB$B_TS_ENTRY 
  3-00000004  L*1 EMB$B_VM_ENTRY   3-0000001E  L*1 EMB$B_VM_NAMLNG  3-00000036  I*4 EMB$L_DV_CHAR    3-00000026  I*4 EMB$L_DV_MEDIA 
  3-0000002E  I*4 EMB$L_DV_OPCNT   3-00000032  I*4 EMB$L_DV_OWNUIC  3-0000004E  I*4 EMB$L_DV_REGSAV  3-0000001E  I*4 EMB$L_DV_RQPID 
  3-00000000  I*4 EMB$L_SID        3-00000010  I*4 EMB$L_SU_DAYTIM  3-00000014  I*4 EMB$L_VM_ERRCNT  3-00000018  I*4 EMB$L_VM_OPRCNT
  3-00000010  I*4 EMB$L_VM_OWNUIC  3-00000012  R*8 EMB$Q_DV_IOSB    3-00000006  I*4 EMB$Q_DV_TIME    3-00000006  R*8 EMB$Q_HD_TIME  
  3-00000006  R*8 EMB$Q_SS_TIME    3-00000006  R*8 EMB$Q_SU_TIME    3-00000006  R*8 EMB$Q_TS_TIME    3-00000006  R*8 EMB$Q_VM_TIME  
  3-00000024  I*2 EMB$W_DV_BCNT    3-00000022  I*2 EMB$W_DV_BOFF    3-0000001A  I*2 EMB$W_DV_DEVSTS  3-00000004  I*2 EMB$W_DV_ENTRY 
  3-0000002C  I*2 EMB$W_DV_ERRCNT  3-0000000E  I*2 EMB$W_DV_ERRSEQ  3-0000003C  I*2 EMB$W_DV_FUNC    3-0000002A  I*2 EMB$W_DV_UNIT  
  3-00000004  I*2 EMB$W_HD_ENTRY   3-0000000E  I*2 EMB$W_HD_ERRSEQ  3-00000004  I*2 EMB$W_SS_ENTRY   3-0000000E  I*2 EMB$W_SS_ERRSEQ
  3-00000010  I*2 EMB$W_SS_MSGSZ   3-00000004  I*2 EMB$W_SU_ENTRY   3-0000000E  I*2 EMB$W_SU_ERRSEQ  3-00000004  I*2 EMB$W_TS_ENTRY 
  3-0000000E  I*2 EMB$W_TS_ERRSEQ  3-00000004  I*2 EMB$W_VM_ENTRY   3-0000000E  I*2 EMB$W_VM_ERRSEQ  3-00000030  I*2 EMB$W_VM_NUMSET
  3-0000001C  I*2 EMB$W_VM_UNIT    3-0000002E  I*2 EMB$W_VM_VOLNUM AP-00000010@ I*2 I                2-000000D4  I*4 J              
  2-000000D0  I*4 L                2-000000D8  I*4 LEN              2-000000CC  I*2 LENGTH          AP-00000004@ L*1 LUN            
  4-00000000  L*4 L_QUESTION       2-000000CE  I*2 MAXIMUM         AP-00000008@ CHR NAME             2-000000A3  CHR OLDNAME        
  4-0000000A  I*2 RECCNT           2-000000AB  CHR STRING           2-000000B3  CHR TIME             4-00000004  L*4 TTY            


ARRAYS

    Address  Type Name		       Bytes  Dimensions

  3-00000000  L*1 EMB                    500  (0:499)
  3-0000003E  L*1 EMB$T_DV_NAME           16  (0:15)
  3-00000032  L*1 EMB$T_VM_LABEL          12  (12)
  3-0000001F  L*1 EMB$T_VM_NAMTXT         15  (15)
  4-0000000C  L*1 NAMDEVSUM              340  (20,0:16)
  2-00000000  CHR OUT                    160  (20)
 AP-0000000C@ I*4 REG                     **  (*)
  4-00000160  L*1 VOLNAM                1920  (20,0:7,12)


LABELS

CRYPTK          22-Aug-1978 02:50:08	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 10  
					CRYPTK.FOR.19       


    Address   Label       Address   Label       Address   Label   

  0-0000007C  100           **      400       1-00000004  501'    


FUNCTIONS AND SUBROUTINES REFERENCED

SYS$ASCTIM        SYS$FAO        


Total Space Allocated = 3628 Bytes


COMPILER OPTIONS

/CHECK=(NOBOUNDS,OVERFLOW)
/DEBUG=(NOSYMBOLS,TRACEBACK)
/OPTIMIZE  /WARNINGS  /I4  /NOD_LINES  
