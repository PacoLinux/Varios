
                22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 1   
					HEADER.FOR.13       

0001    	SUBROUTINE HEADER (LUN,ERROR)
         
        C
        C	INCLUDE FILES:
        C
0002    	INCLUDE 'SRC$:EMBDEF.FOR/NOLIST'
0159    	INCLUDE 'SRC$:SYECOM.FOR/NOLIST'
         
        C
        C	EQUATED SYMBOLS:
        C
        C			None.
         
        C
        C	OWN STORAGE:
        C
0173    	INTEGER*2	W_FUDGE
0174    	BYTE		STAR(36)
0175    	INTEGER*4	ISTAR(9)
0176    	EQUIVALENCE(	ISTAR,STAR)
         
0177    	BYTE		B_LOCAL
         
         
0178    	CHARACTER*24	TIME
         
        C
        C	EXTERNAL ROUTINES:
        C
0179    	LOGICAL		SYS$ASCTIM		! SYSTEM SERVICE
         
0180    	DATA		ISTAR/9*'*   '/
         
        C++
        C
        C	FUNCTIONAL DESCRIPTION:
        C		The subroutine HEADER prints out the SYE entry-type
        C		independent header on the logical unit number 
        C		specified by formal parameter LUN.
        C
         
        C
        C	FORMAL PARAMETERS:
        C
0181    	BYTE		LUN
0182    	CHARACTER*(*)	ERROR
        C
         
        C
        C	IMPLICIT INPUTS:
        C
        C				None.
         
        C
        C	IMPLICIT OUTPUTS:
        C

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 2   
					HEADER.FOR.13       

        C				None.
         
        C
        C	SIDE EFFECTS:
        C
        C--
         
0183    	IF(L_QUESTION)			! IF TRUE, ENTRY IS QUESTIONABLE
        	1	THEN
0184    			B_LOCAL = '?'
0185    		ELSE
0186    			B_LOCAL = '*'
0187    	ENDIF
         
0188    	DO 400, I=1,33,4
0189    	    STAR(I) = B_LOCAL
0190     400	CONTINUE
           
           
0191    	CALL LINCHK(LUN,6)
         
0192    	WRITE(LUN,501) (STAR(I),I=1,23),RECCNT,(STAR(I),I=1,33)
0193     501	FORMAT(//'0',23A1,' Entry',I7,'. ',33A1)
         
0194    	IF( .NOT. SYS$ASCTIM(,%DESCR(TIME),EMB$Q_HD_TIME,0))
        	1		TIME = 'invalid time: SYS$ASCTIM'
         
0195    	WRITE(LUN,511) ERROR,TIME
0196     511	FORMAT(' ',A,T40,'Logged at ',A)
         
0197    	IF(EMB$W_HD_ERRSEQ .LE. 0)	! IF LE 0, PROTECT AGAINST EXCEPTION
        	1	THEN
0198    			W_FUDGE = 0
0199    		ELSE
0200    			W_FUDGE = INT(LOG10(FLOAT(EMB$W_HD_ERRSEQ)))
0201    	ENDIF
         
0202    	WRITE(LUN,521)  EMB$W_HD_ERRSEQ,EMB$L_SID		
0203     521	FORMAT(T<11+W_FUDGE>,I7,'.',
        	1	T1,' Error sequence',
        	2	T40,'On Processor 0., Serial #',Z8)
         
         
         
0204    	RETURN
0205    	END

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 3   
					HEADER.FOR.13       

		.TITLE	HEADER
		.IDENT	01

    0000	.PSECT	EMB
    0000  EMB:

    0000	.PSECT	SYECOM
    0000  L_QUESTION:
    0004  TTY:
    0008  DEVSUMCNT:
    000A  RECCNT:
    000C  NAMDEVSUM:
    0160  VOLNAM:

    0000	.PSECT	$LOCAL
    0000  STAR:
    0000  ISTAR:

    0004	.PSECT	EMB
    0004  EMB$W_HD_ENTRY:
    0004  EMB$B_HD_ENTRY:
    0004  EMB$W_DV_ENTRY:
    0004  EMB$B_DV_ENTRY:
    0004  EMB$W_TS_ENTRY:
    0004  EMB$B_TS_ENTRY:
    0004  EMB$W_SS_ENTRY:
    0004  EMB$B_SS_ENTRY:
    0004  EMB$W_VM_ENTRY:
    0004  EMB$B_VM_ENTRY:
    0010  EMB$L_SU_DAYTIM:
    000E  EMB$W_SU_ERRSEQ:
    0006  EMB$Q_SU_TIME:
    0004  EMB$W_SU_ENTRY:
    0032  EMB$T_VM_LABEL:
    0030  EMB$W_VM_NUMSET:
    002E  EMB$W_VM_VOLNUM:
    001F  EMB$T_VM_NAMTXT:
    001E  EMB$B_VM_NAMLNG:
    001C  EMB$W_VM_UNIT:
    0018  EMB$L_VM_OPRCNT:
    0014  EMB$L_VM_ERRCNT:
    0010  EMB$L_VM_OWNUIC:
    000E  EMB$W_VM_ERRSEQ:
    0006  EMB$Q_VM_TIME:
    0012  EMB$B_SS_MSGTXT:
    0010  EMB$W_SS_MSGSZ:
    000E  EMB$W_SS_ERRSEQ:
    0006  EMB$Q_SS_TIME:
    000E  EMB$W_TS_ERRSEQ:
    0006  EMB$Q_TS_TIME:
    004E  EMB$L_DV_REGSAV:
    003E  EMB$T_DV_NAME:
    003C  EMB$W_DV_FUNC:
    003A  EMB$B_DV_SLAVE:
    0036  EMB$L_DV_CHAR:
    0032  EMB$L_DV_OWNUIC:

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 4   
					HEADER.FOR.13       

    002E  EMB$L_DV_OPCNT:
    002C  EMB$W_DV_ERRCNT:
    002A  EMB$W_DV_UNIT:
    0026  EMB$L_DV_MEDIA:
    0024  EMB$W_DV_BCNT:
    0022  EMB$W_DV_BOFF:
    001E  EMB$L_DV_RQPID:
    001D  EMB$B_DV_TYPE:
    001C  EMB$B_DV_CLASS:
    001A  EMB$W_DV_DEVSTS:
    0012  EMB$Q_DV_IOSB:
    0011  EMB$B_DV_ERTMAX:
    0010  EMB$B_DV_ERTCNT:
    000E  EMB$W_DV_ERRSEQ:
    0006  EMB$Q_DV_TIME:
    000E  EMB$W_HD_ERRSEQ:
    0006  EMB$Q_HD_TIME:
    0000  EMB$L_SID:

    0000	.PSECT	$PDATA
    0000	.LONG	^X00000006
    0004	.LONG	^X00000000

    0044	.PSECT	$LOCAL
    0044	.LONG	^X010E0000
    0048	.LONG	^X00000000
    004C	.LONG	^X010E0018
    0050	.ADDR	TIME
    0054	.LONG	^X00000002
    0058	.LONG	^X00000000
    005C	.ADDR	$PDATA
    0060	.LONG	^X00000004
    0064	.LONG	^X00000000
    0068	.ADDR	$LOCAL+^X4C
    006C	.ADDR	EMB$Q_HD_TIME
    0070	.ADDR	$PDATA+^X4

    0008	.PSECT	$PDATA
    0008  .501:
    0008	.XBYTE	05,05,0F,01,30,95,01,17,01,0F,06,20,45,6E,74,72
    0018	.XBYTE	79,18,07,0F,02,2E,20,95,01,21,01,04
    0024  .511:
    0024	.XBYTE	0F,01,20,29,0D,28,0F,0A,4C,6F,67,67,65,64,20,61
    0034	.XBYTE	74,20,29,04
    0038  .521:
    0038	.XBYTE	8D,40
    003A	.ADDR	L$ACHJ
    003E	.XBYTE	18,07,0F,01,2E,0D,01,0F,0F,20,45,72,72,6F,72,20
    004E	.XBYTE	73,65,71,75,65,6E,63,65,0D,28,0F,19,4F,6E,20,50
    005E	.XBYTE	72,6F,63,65,73,73,6F,72,20,30,2E,2C,20,53,65,72
    006E	.XBYTE	69,61,6C,20,23,19,08,04

    0000	.PSECT	$LOCAL
    0000  ISTAR:
    0000	.XBYTE	2A,20,20,20
    0004	.XBYTE	2A,20,20,20

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 5   
					HEADER.FOR.13       

    0008	.XBYTE	2A,20,20,20
    000C	.XBYTE	2A,20,20,20
    0010	.XBYTE	2A,20,20,20
    0014	.XBYTE	2A,20,20,20
    0018	.XBYTE	2A,20,20,20
    001C	.XBYTE	2A,20,20,20
    0020	.XBYTE	2A,20,20,20

    0000	.PSECT	$CODE
    0000  HEADER::
    0000	.WORD	^M<IV,R2,R3,R4,R5,R9,R10,R11>
    0002	MOVAL	$LOCAL+^X40, R11
    0009	MOVQ	@ERROR(AP), R0
    000D	MOVL	R1, $LOCAL+^X48(R11)
    0011	MOVW	R0, $LOCAL+^X44(R11)
									    ; 0183
    0015	MOVB	B_LOCAL(R11), R9
    0019	BLBC	L_QUESTION, L$NBHO
									    ; 0184
    0020	MOVB	#63, R9
									    ; 0185
    0023	BRB	L$NBNO
    0025  L$NBHO:
									    ; 0186
    0025	MOVB	#42, R9
									    ; 0187
    0028  L$NBNO:
									    ; 0188
    0028	MOVL	#1, R10
    002B  L$ACIA:
									    ; 0189
    002B	MOVB	R9, STAR-1(R11)[R10]
									    ; 0190
    0030	ACBL	#33, #4, R10, L$ACIA
    0036	MOVB	R9, B_LOCAL(R11)
									    ; 0191
    003A	MOVAB	@LUN(AP), $LOCAL+^X58(R11)
    003F	CALLG	$LOCAL+^X54(R11), LINCHK
									    ; 0192
    0047	PUSHAL	.501
    004D	CVTBL	@LUN(AP), -(SP)
    0051	CALLS	#2, FOR$WRITE_SF
    0058	MOVL	#1, R10
    005B  L$ACHC:
    005B	PUSHAB	STAR-1(R11)[R10]
    005F	CALLS	#1, FOR$IO_B_R
    0066	AOBLEQ	#23, R10, L$ACHC
    006A	PUSHAW	RECCNT
    0070	CALLS	#1, FOR$IO_W_R
    0077	MOVL	#1, R10
    007A  L$ACID:
    007A	PUSHAB	STAR-1(R11)[R10]
    007E	CALLS	#1, FOR$IO_B_R
    0085	AOBLEQ	#33, R10, L$ACID
    0089	MOVL	R10, I(R11)
    008C	CALLS	#0, FOR$IO_END

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 6   
					HEADER.FOR.13       

									    ; 0194
    0093	CALLG	$LOCAL+^X60(R11), SYS$ASCTIM
    009B	BLBS	R0, L$ACJE
    009E	MOVC3	#24, $PDATA+^X76, TIME(R11)
    00A7  L$ACJE:
									    ; 0195
    00A7	PUSHAL	.511
    00AD	CVTBL	@LUN(AP), R10
    00B1	PUSHL	R10
    00B3	CALLS	#2, FOR$WRITE_SF
    00BA	PUSHAB	$LOCAL+^X44(R11)
    00BD	CALLS	#1, FOR$IO_T_DS
    00C4	PUSHAB	$LOCAL+^X4C(R11)
    00C7	CALLS	#1, FOR$IO_T_DS
    00CE	CALLS	#0, FOR$IO_END
									    ; 0197
    00D5	TSTW	EMB$W_HD_ERRSEQ
    00DB	BGTR	L$ACFF
									    ; 0198
    00DD	CLRW	W_FUDGE(R11)
									    ; 0199
    00E0	BRB	L$ACLF
    00E2  L$ACFF:
									    ; 0200
    00E2	CVTWF	EMB$W_HD_ERRSEQ, R0
    00E9	JSB	MTH$ALOG10_R5
    00EF	CVTFL	R0, R0
    00F2	CVTLW	R0, W_FUDGE(R11)
									    ; 0201
    00F6  L$ACLF:
									    ; 0202
    00F6	PUSHAL	.521
    00FC	PUSHL	R10
    00FE	CALLS	#2, FOR$WRITE_SF
    0105	PUSHAW	EMB$W_HD_ERRSEQ
    010B	CALLS	#1, FOR$IO_W_R
    0112	PUSHAL	EMB$L_SID
    0118	CALLS	#1, FOR$IO_L_R
    011F	CALLS	#0, FOR$IO_END
									    ; 0204
    0126	RET	
    0127  L$ACHJ:
    0127	.WORD	^M<IV>
    0129	ADDW3	#11, W_FUDGE, R0
    0131	CVTWL	R0, R0
    0134	RET	

    0076	.PSECT	$PDATA
    0076	.XBYTE	69,6E,76,61,6C,69,64,20,74,69,6D,65,3A,20,53,59
    0086	.XBYTE	53,24,41,53,43,54,49,4D
		.END

HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 7   
					HEADER.FOR.13       

PROGRAM SECTIONS

    Name                 Bytes   Attributes

  0 $CODE                  309   PIC CON REL LCL   SHR   EXE   RD NOWRT LONG
  1 $PDATA                 142   PIC CON REL LCL   SHR NOEXE   RD NOWRT LONG
  2 $LOCAL                 116   PIC CON REL LCL NOSHR NOEXE   RD   WRT LONG
  3 EMB                    500   PIC OVR REL GBL   SHR NOEXE   RD   WRT LONG
  4 SYECOM                2272   PIC OVR REL GBL   SHR NOEXE   RD   WRT LONG


ENTRY POINTS

    Address  Type Name           

  0-00000000      HEADER         


VARIABLES

    Address  Type Name               Address  Type Name               Address  Type Name               Address  Type Name           

  2-00000024  L*1 B_LOCAL          4-00000008  I*2 DEVSUMCNT        3-0000001C  L*1 EMB$B_DV_CLASS   3-00000004  L*1 EMB$B_DV_ENTRY 
  3-00000010  L*1 EMB$B_DV_ERTCNT  3-00000011  L*1 EMB$B_DV_ERTMAX  3-0000003A  L*1 EMB$B_DV_SLAVE   3-0000001D  L*1 EMB$B_DV_TYPE  
  3-00000004  L*1 EMB$B_HD_ENTRY   3-00000004  L*1 EMB$B_SS_ENTRY   3-00000012  L*1 EMB$B_SS_MSGTXT  3-00000004  L*1 EMB$B_TS_ENTRY 
  3-00000004  L*1 EMB$B_VM_ENTRY   3-0000001E  L*1 EMB$B_VM_NAMLNG  3-00000036  I*4 EMB$L_DV_CHAR    3-00000026  I*4 EMB$L_DV_MEDIA 
  3-0000002E  I*4 EMB$L_DV_OPCNT   3-00000032  I*4 EMB$L_DV_OWNUIC  3-0000004E  I*4 EMB$L_DV_REGSAV  3-0000001E  I*4 EMB$L_DV_RQPID 
  3-00000000  I*4 EMB$L_SID        3-00000010  I*4 EMB$L_SU_DAYTIM  3-00000014  I*4 EMB$L_VM_ERRCNT  3-00000018  I*4 EMB$L_VM_OPRCNT
  3-00000010  I*4 EMB$L_VM_OWNUIC  3-00000012  R*8 EMB$Q_DV_IOSB    3-00000006  I*4 EMB$Q_DV_TIME    3-00000006  R*8 EMB$Q_HD_TIME  
  3-00000006  R*8 EMB$Q_SS_TIME    3-00000006  R*8 EMB$Q_SU_TIME    3-00000006  R*8 EMB$Q_TS_TIME    3-00000006  R*8 EMB$Q_VM_TIME  
  3-00000024  I*2 EMB$W_DV_BCNT    3-00000022  I*2 EMB$W_DV_BOFF    3-0000001A  I*2 EMB$W_DV_DEVSTS  3-00000004  I*2 EMB$W_DV_ENTRY 
  3-0000002C  I*2 EMB$W_DV_ERRCNT  3-0000000E  I*2 EMB$W_DV_ERRSEQ  3-0000003C  I*2 EMB$W_DV_FUNC    3-0000002A  I*2 EMB$W_DV_UNIT  
  3-00000004  I*2 EMB$W_HD_ENTRY   3-0000000E  I*2 EMB$W_HD_ERRSEQ  3-00000004  I*2 EMB$W_SS_ENTRY   3-0000000E  I*2 EMB$W_SS_ERRSEQ
  3-00000010  I*2 EMB$W_SS_MSGSZ   3-00000004  I*2 EMB$W_SU_ENTRY   3-0000000E  I*2 EMB$W_SU_ERRSEQ  3-00000004  I*2 EMB$W_TS_ENTRY 
  3-0000000E  I*2 EMB$W_TS_ERRSEQ  3-00000004  I*2 EMB$W_VM_ENTRY   3-0000000E  I*2 EMB$W_VM_ERRSEQ  3-00000030  I*2 EMB$W_VM_NUMSET
  3-0000001C  I*2 EMB$W_VM_UNIT    3-0000002E  I*2 EMB$W_VM_VOLNUM AP-00000008@ CHR ERROR            2-00000040  I*4 I              
 AP-00000004@ L*1 LUN              4-00000000  L*4 L_QUESTION       4-0000000A  I*2 RECCNT           2-00000025  CHR TIME           
  4-00000004  L*4 TTY              2-0000003E  I*2 W_FUDGE        


ARRAYS

    Address  Type Name		       Bytes  Dimensions

  3-00000000  L*1 EMB                    500  (0:499)
  3-0000003E  L*1 EMB$T_DV_NAME           16  (0:15)
  3-00000032  L*1 EMB$T_VM_LABEL          12  (12)
  3-0000001F  L*1 EMB$T_VM_NAMTXT         15  (15)
  2-00000000  I*4 ISTAR                   36  (9)
  4-0000000C  L*1 NAMDEVSUM              340  (20,0:16)
  2-00000000  L*1 STAR                    36  (36)
  4-00000160  L*1 VOLNAM                1920  (20,0:7,12)


LABELS


HEADER          22-Aug-1978 02:49:01	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 8   
					HEADER.FOR.13       

    Address   Label       Address   Label       Address   Label       Address   Label   

      **      400       1-00000008  501'      1-00000024  511'      1-00000038  521'    


FUNCTIONS AND SUBROUTINES REFERENCED

LINCHK            MTH$ALOG10        SYS$ASCTIM     


Total Space Allocated = 3339 Bytes


COMPILER OPTIONS

/CHECK=(NOBOUNDS,OVERFLOW)
/DEBUG=(NOSYMBOLS,TRACEBACK)
/OPTIMIZE  /WARNINGS  /I4  /NOD_LINES  
