
                22-Aug-1978 02:48:57	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 1   
					DEVCHK.FOR.11       

0001    	INTEGER*2 FUNCTION DEVCHK(NAME)
0002    	BYTE		NAME(0:15)
         
        C
        C	INCLUDE FILES:
        C
0003    	INCLUDE 'SRC$:SYECOM.FOR/NOLIST'
         
        C
        C	EQUATED SYMBOLS:
        C
        C			None.
         
        C
        C	OWN STORAGE:
        C			None.
         
         
         
0017    	DO 720, I=1,DEVSUMCNT
0018    	   IF(NAME(0) .EQ. NAMDEVSUM(I,0))
        	1	THEN
         
0019    		    DO 710, J=1,NAMDEVSUM(I,0)
0020    			IF(NAME(J)
        	1			.NE.
        	2		   NAMDEVSUM(I,J))  GO TO 720
0021     710		    CONTINUE
         
         
0022    		    DEVCHK = I
0023    		    RETURN
0024    	   ENDIF
         
0025     720	CONTINUE
         
         
        C
        C	Device name is not a known name.
        C	Enter name to make it 'known'.
        C
0026       	DEVSUMCNT = DEVSUMCNT + 1
         
0027    	IF(DEVSUMCNT .GT. DEVSUMMAX)  STOP 'MAX EXCEEDED'
         
0028    	DEVCHK = DEVSUMCNT
         
0029    	DO 740, I=0,NAME(0)+1
0030    	   NAMDEVSUM(DEVCHK,I) = NAME(I)
0031     740   CONTINUE
         
         
         
0032    	RETURN
         
0033    	END

DEVCHK          22-Aug-1978 02:48:57	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 2   
					DEVCHK.FOR.11       

		.TITLE	DEVCHK
		.IDENT	01

    0000	.PSECT	SYECOM
    0000  L_QUESTION:
    0004  TTY:
    0008  DEVSUMCNT:
    000A  RECCNT:
    000C  NAMDEVSUM:
    0160  VOLNAM:

    0000	.PSECT	$PDATA
    0000	.XBYTE	4D,41,58,20,45,58,43,45,45,44,45,44

    000C	.PSECT	$LOCAL
    000C	.LONG	^X04020001
    0010	.LONG	^X00000000
    0014	.LONG	^X01200000,^X00000010
    001C	.LONG	^X00000000
    0020	.LONG	^X010E000C
    0024	.ADDR	$PDATA

    0000	.PSECT	$CODE
    0000  DEVCHK::
    0000	.WORD	^M<IV,R7,R8,R9,R10,R11>
    0002	MOVAL	$LOCAL+^X4, R11
    0009	MOVL	NAME(AP), $LOCAL+^X10(R11)
    000E	MOVL	NAME(AP), $LOCAL+^X1C(R11)
									    ; 0017
    0013	CVTWL	DEVSUMCNT, $LOCAL+^X28(R11)
    001B	MOVL	#1, I(R11)
    001E  L$IAJJ:
									    ; 0018
    001E	MOVAB	@$LOCAL+^X1C(R11), R8
    0022	MOVL	I(R11), R10
    0025	CMPB	(R8), NAMDEVSUM-1[R10]
    002D	BNEQ	L$IACL
									    ; 0019
    002F	CVTBL	NAMDEVSUM-1[R10], R9
    0037	MOVL	#1, J(R11)
    003B  L$IAGM:
									    ; 0020
    003B	MULL3	#20, J(R11), R0
    0040	ADDL2	R10, R0
    0043	MOVL	J(R11), R1
    0047	CMPB	(R8)[R1], NAMDEVSUM-1[R0]
    0050	BNEQ	.720
									    ; 0021
    0052	AOBLEQ	R9, J(R11), L$IAGM
									    ; 0022
    0057	CVTLW	R10, DEVCHK(R11)
									    ; 0023
    005B	MOVW	R10, R0
    005E	RET	
									    ; 0024
    005F  L$IACL:

DEVCHK          22-Aug-1978 02:48:57	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 3   
					DEVCHK.FOR.11       

									    ; 0025
    005F  .720:
    005F	AOBLEQ	$LOCAL+^X28(R11), I(R11), L$IAJJ
									    ; 0026
    0064	INCW	DEVSUMCNT
									    ; 0027
    006A	CMPW	DEVSUMCNT, #20
    0071	BLEQ	L$IAPN
    0073	PUSHAL	$LOCAL+^X20(R11)
    0076	CALLS	#1, FOR$STOP
    007D  L$IAPN:
									    ; 0028
    007D	MOVW	DEVSUMCNT, DEVCHK(R11)
									    ; 0029
    0085	MOVAB	@$LOCAL+^X1C(R11), R9
    0089	ADDB3	#1, (R9), R0
    008D	CVTBL	R0, R7
    0090	CLRL	R10
    0092	CVTWL	DEVCHK(R11), R8
    0096  L$IALO:
									    ; 0030
    0096	MULL3	#20, R10, R0
    009A	ADDL2	R8, R0
    009D	MOVB	(R9)[R10], NAMDEVSUM-1[R0]
									    ; 0031
    00A6	AOBLEQ	R7, R10, L$IALO
    00AA	MOVL	R10, I(R11)
									    ; 0032
    00AD	MOVW	DEVCHK(R11), R0
    00B1	RET	
		.END

DEVCHK          22-Aug-1978 02:48:57	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 4   
					DEVCHK.FOR.11       

PROGRAM SECTIONS

    Name                 Bytes   Attributes

  0 $CODE                  178   PIC CON REL LCL   SHR   EXE   RD NOWRT LONG
  1 $PDATA                  12   PIC CON REL LCL   SHR NOEXE   RD NOWRT LONG
  2 $LOCAL                  44   PIC CON REL LCL NOSHR NOEXE   RD   WRT LONG
  3 SYECOM                2272   PIC OVR REL GBL   SHR NOEXE   RD   WRT LONG


ENTRY POINTS

    Address  Type Name           

  0-00000000  I*2 DEVCHK         


VARIABLES

    Address  Type Name               Address  Type Name               Address  Type Name               Address  Type Name           

  3-00000008  I*2 DEVSUMCNT        2-00000004  I*4 I                2-00000008  I*4 J                3-00000000  L*4 L_QUESTION     
  3-0000000A  I*2 RECCNT           3-00000004  L*4 TTY            


ARRAYS

    Address  Type Name		       Bytes  Dimensions

  3-0000000C  L*1 NAMDEVSUM              340  (20,0:16)
 AP-00000004@ L*1 NAME                    16  (0:15)
  3-00000160  L*1 VOLNAM                1920  (20,0:7,12)


LABELS

    Address   Label       Address   Label       Address   Label   

      **      710       0-0000005F  720           **      740     


Total Space Allocated = 2506 Bytes


COMPILER OPTIONS

/CHECK=(NOBOUNDS,OVERFLOW)
/DEBUG=(NOSYMBOLS,TRACEBACK)
/OPTIMIZE  /WARNINGS  /I4  /NOD_LINES  
