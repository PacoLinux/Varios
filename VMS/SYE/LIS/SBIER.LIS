
                22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 1   
					SBIER.FOR.12        

0001    	SUBROUTINE SBIER (LUN,REG)
0002    	BYTE	LUN
0003    	INTEGER*4	REG
         
        C
        C	INCLUDE FILES:
        C
         
        C
        C	OWN STORAGE:
        C
0004    	INTEGER*4	TO_CODE
0005    	INTEGER*4	TEMP
0006    	INTEGER*4	BIT(0:31)
0007    	CHARACTER*20	TIME_OUT (0:3)
0008    	CHARACTER*32	SBIERR_BITS (0:15)
        C	EXTERNAL ROUTINES:
0009    	INTEGER*2 BITCNT
0010    	INTEGER*2 VBITCNT
        C
         
0011    	DATA	SBIERR_BITS(1)	/'NOT BUSY<1>'/
0012    	DATA	SBIERR_BITS(2)	/'MULTIPLE ERRORS<2>'/
0013    	DATA	SBIERR_BITS(3)	/'IB ERR CNF<3>'/
0014    	DATA	SBIERR_BITS(4)	/'IB TIMEOUT STATUS<5:4>:'/
0015    	DATA	SBIERR_BITS(6)	/'IB TIMEOUT<6>'/
0016    	DATA	SBIERR_BITS(7)	/'IB RDS<7>'/
0017    	DATA	SBIERR_BITS(8)	/'CPU ERR CNF<8>'/
0018    	DATA	SBIERR_BITS(10)	/'CPU TIMEOUT STATUS<11:10>:'/
0019    	DATA	SBIERR_BITS(12)	/'CPU TIMEOUT<12>'/
0020    	DATA	SBIERR_BITS(13)	/'READ DATA SUBSTITUTE<13>'/
0021    	DATA	SBIERR_BITS(14)	/'CORRECTED READ DATA<14>'/
0022    	DATA	SBIERR_BITS(15)	/'RDS/CRD INTERRUPT ENABLE<15>'/
         
         
0023    	DATA	TIME_OUT(0)	/'DEVICE NO RESPONSE'/
0024    	DATA	TIME_OUT(1)	/'DEVICE WAS BUSY'/
0025    	DATA	TIME_OUT(2)	/'WAITING FOR READ DATA'/
0026    	DATA	TIME_OUT(3)	/'IMPOSSIBLE CODE'/
         
0027    	DATA		BIT(0)	/'00000001'X/
0028    	DATA		BIT(1)	/'00000002'X/
0029    	DATA		BIT(2)	/'00000004'X/
0030    	DATA		BIT(3)	/'00000008'X/
0031    	DATA		BIT(4)	/'00000010'X/
0032    	DATA		BIT(5)	/'00000020'X/
0033    	DATA		BIT(6)	/'00000040'X/
0034    	DATA		BIT(7)	/'00000080'X/
0035    	DATA		BIT(8)	/'00000100'X/
0036    	DATA		BIT(9)	/'00000200'X/
0037    	DATA		BIT(10) /'00000400'X/
0038    	DATA		BIT(11) /'00000800'X/
0039    	DATA		BIT(12) /'00001000'X/
0040    	DATA		BIT(13) /'00002000'X/
0041    	DATA		BIT(14) /'00004000'X/
0042    	DATA		BIT(15) /'00008000'X/

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 2   
					SBIER.FOR.12        

0043    	DATA		BIT(16)	/'00010000'X/
0044    	DATA		BIT(17) /'00020000'X/
0045    	DATA		BIT(18) /'00040000'X/
0046    	DATA		BIT(19) /'00080000'X/
0047    	DATA		BIT(20) /'00100000'X/
0048    	DATA		BIT(21) /'00200000'X/
0049    	DATA		BIT(22) /'00400000'X/
0050    	DATA		BIT(23)	/'00800000'X/
0051    	DATA		BIT(24) /'01000000'X/
0052    	DATA		BIT(25) /'02000000'X/
0053    	DATA		BIT(26)	/'04000000'X/
0054    	DATA		BIT(27)	/'08000000'X/
0055    	DATA		BIT(28) /'10000000'X/
0056    	DATA		BIT(29) /'20000000'X/
0057    	DATA		BIT(30) /'40000000'X/
0058    	DATA		BIT(31) /'80000000'X/
        C	SBIERR REGISTER
        C
0059    	TEMP=BITCNT(REG .AND. '0000F1CE'X)
0060    	IF ((REG .AND. BIT(12)) .NE. 0) TEMP=TEMP+1
0061    	IF ((REG .AND. BIT(06)) .NE. 0)TEMP=TEMP+1
0062    	CALL LINCHK (LUN,TEMP+1)
0063    	WRITE (LUN,210)'SBIER(ID#19)',REG
0064    210	FORMAT (' ',T10,A,T23,Z8)
0065    	CALL BITS_OUTPUT (LUN,REG,SBIERR_BITS(13),13,15,0)
0066    	IF ((REG .AND. BIT(12)) .NE. 0)
        	1	THEN
0067    			TO_CODE=LIB$EXTZV (10,2,REG)
0068    			WRITE (LUN,320)SBIERR_BITS(12)
0069    			WRITE (LUN,320)SBIERR_BITS(10),TO_CODE
0070    			WRITE (LUN,330) TIME_OUT (TO_CODE)
0071    	ENDIF
0072    320	FORMAT (' ',T40,A,:,T72,Z1)
0073    330	FORMAT (' ',T45,A)
0074    	CALL BITS_OUTPUT (LUN,REG,SBIERR_BITS(7),7,8,0)
0075    	IF ((REG .AND. BIT(06)) .NE. 0)
        	1	THEN
0076    			TO_CODE=LIB$EXTZV (4,2,REG)
0077    			WRITE (LUN,320)SBIERR_BITS(6)
0078    			WRITE (LUN,320) SBIERR_BITS(4),TO_CODE
0079    			WRITE (LUN,330) TIME_OUT (TO_CODE)
0080    	ENDIF
0081    	CALL BITS_OUTPUT (LUN,REG,SBIERR_BITS(0),0,3,0)
0082    	RETURN
0083    	END

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 3   
					SBIER.FOR.12        

		.TITLE	SBIER
		.IDENT	01

    0000	.PSECT	$PDATA
    0000	.XBYTE	53,42,49,45,52,28,49,44,23,31,39,29
    000C	.LONG	^X0000000D
    0010	.LONG	^X0000000F
    0014	.LONG	^X00000000
    0018	.LONG	^X0000000A
    001C	.LONG	^X00000002
    0020	.LONG	^X00000007
    0024	.LONG	^X00000008
    0028	.LONG	^X00000004
    002C	.LONG	^X00000003

    02DC	.PSECT	$LOCAL
    02DC	.LONG	^X00000001
    02E0	.LONG	^X00000000
    02E4	.LONG	^X00000002
    02E8	.LONG	^X00000000
    02EC	.LONG	^X00000000
    02F0	.LONG	^X010E000C
    02F4	.ADDR	$PDATA
    02F8	.LONG	^X010E0020
    02FC	.ADDR	SBIERR_BITS+416
    0300	.LONG	^X00000006
    0304	.LONG	^X00000000
    0308	.LONG	^X00000000
    030C	.ADDR	$LOCAL+^X2F8
    0310	.ADDR	$PDATA+^XC
    0314	.ADDR	$PDATA+^X10
    0318	.ADDR	$PDATA+^X14
    031C	.LONG	^X00000003
    0320	.ADDR	$PDATA+^X18
    0324	.ADDR	$PDATA+^X1C
    0328	.LONG	^X00000000
    032C	.LONG	^X010E0000
    0330	.LONG	^X00000000
    0334	.LONG	^X010E0020
    0338	.ADDR	SBIERR_BITS+224
    033C	.LONG	^X00000006
    0340	.LONG	^X00000000
    0344	.LONG	^X00000000
    0348	.ADDR	$LOCAL+^X334
    034C	.ADDR	$PDATA+^X20
    0350	.ADDR	$PDATA+^X24
    0354	.ADDR	$PDATA+^X14
    0358	.LONG	^X00000003
    035C	.ADDR	$PDATA+^X28
    0360	.ADDR	$PDATA+^X1C
    0364	.LONG	^X00000000
    0368	.LONG	^X010E0020
    036C	.ADDR	SBIERR_BITS
    0370	.LONG	^X00000006
    0374	.LONG	^X00000000
    0378	.LONG	^X00000000

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 4   
					SBIER.FOR.12        

    037C	.ADDR	$LOCAL+^X368
    0380	.ADDR	$PDATA+^X14
    0384	.ADDR	$PDATA+^X2C
    0388	.ADDR	$PDATA+^X14

    0030	.PSECT	$PDATA
    0030  .210:
    0030	.XBYTE	0F,01,20,0D,0A,29,0D,17,19,08,04
    003B  .320:
    003B	.XBYTE	0F,01,20,0D,28,29,07,0D,48,19,01,04
    0047  .330:
    0047	.XBYTE	0F,01,20,0D,2D,29,04

    00F0	.PSECT	$LOCAL
    00F0  SBIERR_BITS+32:
    00F0	.XBYTE	4E,4F,54,20,42,55,53,59,3C,31,3E
    00FB	.XBYTE	20 [21]
    0110  SBIERR_BITS+64:
    0110	.XBYTE	4D,55,4C,54,49,50,4C,45,20,45,52,52,4F,52,53,3C
    0120	.XBYTE	32,3E
    0122	.XBYTE	20 [14]
    0130  SBIERR_BITS+96:
    0130	.XBYTE	49,42,20,45,52,52,20,43,4E,46,3C,33,3E
    013D	.XBYTE	20 [19]
    0150  SBIERR_BITS+128:
    0150	.XBYTE	49,42,20,54,49,4D,45,4F,55,54,20,53,54,41,54,55
    0160	.XBYTE	53,3C,35,3A,34,3E,3A
    0167	.XBYTE	20 [9]
    0190  SBIERR_BITS+192:
    0190	.XBYTE	49,42,20,54,49,4D,45,4F,55,54,3C,36,3E
    019D	.XBYTE	20 [19]
    01B0  SBIERR_BITS+224:
    01B0	.XBYTE	49,42,20,52,44,53,3C,37,3E
    01B9	.XBYTE	20 [23]
    01D0  SBIERR_BITS+256:
    01D0	.XBYTE	43,50,55,20,45,52,52,20,43,4E,46,3C,38,3E
    01DE	.XBYTE	20 [18]
    0210  SBIERR_BITS+320:
    0210	.XBYTE	43,50,55,20,54,49,4D,45,4F,55,54,20,53,54,41,54
    0220	.XBYTE	55,53,3C,31,31,3A,31,30,3E,3A
    022A	.XBYTE	20 [6]
    0250  SBIERR_BITS+384:
    0250	.XBYTE	43,50,55,20,54,49,4D,45,4F,55,54,3C,31,32,3E
    025F	.XBYTE	20 [17]
    0270  SBIERR_BITS+416:
    0270	.XBYTE	52,45,41,44,20,44,41,54,41,20,53,55,42,53,54,49
    0280	.XBYTE	54,55,54,45,3C,31,33,3E
    0288	.XBYTE	20 [8]
    0290  SBIERR_BITS+448:
    0290	.XBYTE	43,4F,52,52,45,43,54,45,44,20,52,45,41,44,20,44
    02A0	.XBYTE	41,54,41,3C,31,34,3E
    02A7	.XBYTE	20 [9]
    02B0  SBIERR_BITS+480:
    02B0	.XBYTE	52,44,53,2F,43,52,44,20,49,4E,54,45,52,52,55,50
    02C0	.XBYTE	54,20,45,4E,41,42,4C,45,3C,31,35,3E
    02CC	.XBYTE	20 [4]

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 5   
					SBIER.FOR.12        

    0080  TIME_OUT:
    0080	.XBYTE	44,45,56,49,43,45,20,4E,4F,20,52,45,53,50,4F,4E
    0090	.XBYTE	53,45
    0092	.XBYTE	20 [2]
    0094  TIME_OUT+20:
    0094	.XBYTE	44,45,56,49,43,45,20,57,41,53,20,42,55,53,59
    00A3	.XBYTE	20 [5]
    00A8  TIME_OUT+40:
    00A8	.XBYTE	57,41,49,54,49,4E,47,20,46,4F,52,20,52,45,41,44
    00B8	.XBYTE	20,44,41,54
    00BC  TIME_OUT+60:
    00BC	.XBYTE	49,4D,50,4F,53,53,49,42,4C,45,20,43,4F,44,45
    00CB	.XBYTE	20 [5]
    0000  BIT:
    0000	.LONG	^X00000001
    0004  BIT+4:
    0004	.LONG	^X00000002
    0008  BIT+8:
    0008	.LONG	^X00000004
    000C  BIT+12:
    000C	.LONG	^X00000008
    0010  BIT+16:
    0010	.LONG	^X00000010
    0014  BIT+20:
    0014	.LONG	^X00000020
    0018  BIT+24:
    0018	.LONG	^X00000040
    001C  BIT+28:
    001C	.LONG	^X00000080
    0020  BIT+32:
    0020	.LONG	^X00000100
    0024  BIT+36:
    0024	.LONG	^X00000200
    0028  BIT+40:
    0028	.LONG	^X00000400
    002C  BIT+44:
    002C	.LONG	^X00000800
    0030  BIT+48:
    0030	.LONG	^X00001000
    0034  BIT+52:
    0034	.LONG	^X00002000
    0038  BIT+56:
    0038	.LONG	^X00004000
    003C  BIT+60:
    003C	.LONG	^X00008000
    0040  BIT+64:
    0040	.LONG	^X00010000
    0044  BIT+68:
    0044	.LONG	^X00020000
    0048  BIT+72:
    0048	.LONG	^X00040000
    004C  BIT+76:
    004C	.LONG	^X00080000
    0050  BIT+80:
    0050	.LONG	^X00100000
    0054  BIT+84:

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 6   
					SBIER.FOR.12        

    0054	.LONG	^X00200000
    0058  BIT+88:
    0058	.LONG	^X00400000
    005C  BIT+92:
    005C	.LONG	^X00800000
    0060  BIT+96:
    0060	.LONG	^X01000000
    0064  BIT+100:
    0064	.LONG	^X02000000
    0068  BIT+104:
    0068	.LONG	^X04000000
    006C  BIT+108:
    006C	.LONG	^X08000000
    0070  BIT+112:
    0070	.LONG	^X10000000
    0074  BIT+116:
    0074	.LONG	^X20000000
    0078  BIT+120:
    0078	.LONG	^X40000000
    007C  BIT+124:
    007C	.LONG	^X80000000

    0000	.PSECT	$CODE
    0000  SBIER::
    0000	.WORD	^M<IV,R10,R11>
    0002	MOVAL	$LOCAL+^X2D4, R11
									    ; 0059
    0009	BICL3	#^XFFFF0E31, @REG(AP), -(SP)
    0012	MOVL	SP, $LOCAL+^X2E0(R11)
    0016	CALLG	$LOCAL+^X2DC(R11), BITCNT
    001E	ADDL2	#4, SP
    0021	CVTWL	R0, R10
									    ; 0060
    0024	BITL	@REG(AP), BIT+48(R11)
    002A	BEQL	L$IAII
    002C	INCL	R10
    002E  L$IAII:
									    ; 0061
    002E	BITL	@REG(AP), BIT+24(R11)
    0034	BEQL	L$IAOI
    0036	INCL	R10
    0038  L$IAOI:
									    ; 0062
    0038	MOVAB	@LUN(AP), $LOCAL+^X2E8(R11)
    003D	ADDL3	#1, R10, -(SP)
    0041	MOVL	R10, TEMP(R11)
    0045	MOVL	SP, $LOCAL+^X2EC(R11)
    0049	CALLG	$LOCAL+^X2E4(R11), LINCHK
    0051	ADDL2	#4, SP
									    ; 0063
    0054	PUSHAL	.210
    005A	CVTBL	@LUN(AP), -(SP)
    005E	CALLS	#2, FOR$WRITE_SF
    0065	PUSHAB	$LOCAL+^X2F0(R11)
    0068	CALLS	#1, FOR$IO_T_DS
    006F	PUSHAL	@REG(AP)

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 7   
					SBIER.FOR.12        

    0072	CALLS	#1, FOR$IO_L_R
    0079	CALLS	#0, FOR$IO_END
									    ; 0065
    0080	MOVAB	@LUN(AP), $LOCAL+^X304(R11)
    0085	MOVAL	@REG(AP), $LOCAL+^X308(R11)
    008A	CALLG	$LOCAL+^X300(R11), BITS_OUTPUT
									    ; 0066
    0092	BITL	@REG(AP), BIT+48(R11)
    0098	BNEQ	$CODE+^X9D
    009A	BRW	L$IAKK
									    ; 0067
    009D	MOVAL	@REG(AP), $LOCAL+^X328(R11)
    00A2	CALLG	$LOCAL+^X31C(R11), LIB$EXTZV
    00AA	MOVL	R0, TO_CODE(R11)
									    ; 0068
    00AD	PUSHAL	.320
    00B3	CVTBL	@LUN(AP), R10
    00B7	PUSHL	R10
    00B9	CALLS	#2, FOR$WRITE_SF
    00C0	MOVW	#32, $LOCAL+^X32C(R11)
    00C4	MOVAB	SBIERR_BITS+384(R11), $LOCAL+^X330(R11)
    00CA	PUSHAB	$LOCAL+^X32C(R11)
    00CD	CALLS	#1, FOR$IO_T_DS
    00D4	CALLS	#0, FOR$IO_END
									    ; 0069
    00DB	PUSHAL	.320
    00E1	PUSHL	R10
    00E3	CALLS	#2, FOR$WRITE_SF
    00EA	MOVW	#32, $LOCAL+^X32C(R11)
    00EE	MOVAB	SBIERR_BITS+320(R11), $LOCAL+^X330(R11)
    00F4	PUSHAB	$LOCAL+^X32C(R11)
    00F7	CALLS	#1, FOR$IO_T_DS
    00FE	PUSHAL	TO_CODE(R11)
    0100	CALLS	#1, FOR$IO_L_R
    0107	CALLS	#0, FOR$IO_END
									    ; 0070
    010E	PUSHAL	.330
    0114	PUSHL	R10
    0116	CALLS	#2, FOR$WRITE_SF
    011D	MULL3	#20, TO_CODE(R11), R0
    0121	MOVW	#20, $LOCAL+^X32C(R11)
    0125	MOVAB	TIME_OUT(R11)[R0], $LOCAL+^X330(R11)
    012C	PUSHAB	$LOCAL+^X32C(R11)
    012F	CALLS	#1, FOR$IO_T_DS
    0136	CALLS	#0, FOR$IO_END
									    ; 0071
    013D  L$IAKK:
									    ; 0074
    013D	MOVAB	@LUN(AP), $LOCAL+^X340(R11)
    0142	MOVAL	@REG(AP), $LOCAL+^X344(R11)
    0147	CALLG	$LOCAL+^X33C(R11), BITS_OUTPUT
									    ; 0075
    014F	BITL	@REG(AP), BIT+24(R11)
    0155	BNEQ	$CODE+^X15A
    0157	BRW	L$IAEM
									    ; 0076

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 8   
					SBIER.FOR.12        

    015A	MOVAL	@REG(AP), $LOCAL+^X364(R11)
    0160	CALLG	$LOCAL+^X358(R11), LIB$EXTZV
    0169	MOVL	R0, TO_CODE(R11)
									    ; 0077
    016C	PUSHAL	.320
    0172	CVTBL	@LUN(AP), R10
    0176	PUSHL	R10
    0178	CALLS	#2, FOR$WRITE_SF
    017F	MOVW	#32, $LOCAL+^X32C(R11)
    0183	MOVAB	SBIERR_BITS+192(R11), $LOCAL+^X330(R11)
    0189	PUSHAB	$LOCAL+^X32C(R11)
    018C	CALLS	#1, FOR$IO_T_DS
    0193	CALLS	#0, FOR$IO_END
									    ; 0078
    019A	PUSHAL	.320
    01A0	PUSHL	R10
    01A2	CALLS	#2, FOR$WRITE_SF
    01A9	MOVW	#32, $LOCAL+^X32C(R11)
    01AD	MOVAB	SBIERR_BITS+128(R11), $LOCAL+^X330(R11)
    01B3	PUSHAB	$LOCAL+^X32C(R11)
    01B6	CALLS	#1, FOR$IO_T_DS
    01BD	PUSHAL	TO_CODE(R11)
    01BF	CALLS	#1, FOR$IO_L_R
    01C6	CALLS	#0, FOR$IO_END
									    ; 0079
    01CD	PUSHAL	.330
    01D3	PUSHL	R10
    01D5	CALLS	#2, FOR$WRITE_SF
    01DC	MULL3	#20, TO_CODE(R11), R0
    01E0	MOVW	#20, $LOCAL+^X32C(R11)
    01E4	MOVAB	TIME_OUT(R11)[R0], $LOCAL+^X330(R11)
    01EB	PUSHAB	$LOCAL+^X32C(R11)
    01EE	CALLS	#1, FOR$IO_T_DS
    01F5	CALLS	#0, FOR$IO_END
									    ; 0080
    01FC  L$IAEM:
									    ; 0081
    01FC	MOVAB	@LUN(AP), $LOCAL+^X374(R11)
    0202	MOVAL	@REG(AP), $LOCAL+^X378(R11)
    0208	CALLG	$LOCAL+^X370(R11), BITS_OUTPUT
									    ; 0082
    0211	RET	
		.END

SBIER           22-Aug-1978 02:53:15	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 9   
					SBIER.FOR.12        

PROGRAM SECTIONS

    Name                 Bytes   Attributes

  0 $CODE                  530   PIC CON REL LCL   SHR   EXE   RD NOWRT LONG
  1 $PDATA                  78   PIC CON REL LCL   SHR NOEXE   RD NOWRT LONG
  2 $LOCAL                 908   PIC CON REL LCL NOSHR NOEXE   RD   WRT LONG


ENTRY POINTS

    Address  Type Name           

  0-00000000      SBIER          


VARIABLES

    Address  Type Name               Address  Type Name               Address  Type Name               Address  Type Name           

 AP-00000004@ L*1 LUN             AP-00000008@ I*4 REG              2-000002D8  I*4 TEMP             2-000002D4  I*4 TO_CODE        
  2-000002D0  I*2 VBITCNT        


ARRAYS

    Address  Type Name		       Bytes  Dimensions

  2-00000000  I*4 BIT                    128  (0:31)
  2-000000D0  CHR SBIERR_BITS            512  (0:15)
  2-00000080  CHR TIME_OUT                80  (0:3)


LABELS

    Address   Label       Address   Label       Address   Label   

  1-00000030  210'      1-0000003B  320'      1-00000047  330'    


FUNCTIONS AND SUBROUTINES REFERENCED

BITCNT            BITS_OUTPUT       LIB$EXTZV         LINCHK         


Total Space Allocated = 1516 Bytes


COMPILER OPTIONS

/CHECK=(NOBOUNDS,OVERFLOW)
/DEBUG=(NOSYMBOLS,TRACEBACK)
/OPTIMIZE  /WARNINGS  /I4  /NOD_LINES  
