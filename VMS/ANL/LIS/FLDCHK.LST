FORTRAN IV-PLUS V02-51D		02:23:06    22-AUG-78		PAGE 1   
FLDCHK.FTN   	/TR:BLOCKS/WR

        C
        C
        C	FLDCHK  --  ROUTINE TO CHECK NAME FIELDS
        C
        C
        C
        C	COPYRIGHT (C) 1976
        C	DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
        C
        C	THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
        C	SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
        C	SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
        C	OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
        C	AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
        C	AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
        C	OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
        C
        C	THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
        C	NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
        C	EQUIPMENT CORPORATION.
        C
        C	DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
        C	SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
        C
        C
        C	T.J. PORTER AND K.D. MORSE  07-NOV-76
        C
        C
        C	THIS SUBROUTINE VALIDATES NAME FIELDS.
        C
        C
        C
0001    	SUBROUTINE	FLDCHK(ICOUNT,IELMNT,ARRAY,I)
        C
        C		SUBROUTINE TO CHECK VALIDITY OF A NAME
        C	STRING.	INPUT:
        C			ICOUNT =	CHARACTER COUNT
        C			IELMNT =	STARTING ELEMENT OF ARRAY
        C			ARRAY =		CHARACTER STRING.
        C
        C		OUTPUT:
        C			I =		NEGATIVE IF ICOUNT < = 0
        C					OR > NAMMAX
        C
        C			I = ARRAY ELEMENT IF CHARACTER IS
        C				NOT IN SET _$0-9,A-Z
        C					AND BLANK
        C
        C			I = 0		WHEN ALL CHARACTERS ARE
        C						CHECKED.
        C
        C
0002    	BYTE	USCORE,DOLLAR,BLANK,ZERO,NINE,AYE,ZEE,DOT
0003    	BYTE	ARRAY(15+IELMNT)
        C
0004    	DATA	USCORE,DOLLAR,BLANK,DOT/'_','$',' ','.'/
FORTRAN IV-PLUS V02-51D		02:23:06    22-AUG-78		PAGE 2   
FLDCHK.FTN   	/TR:BLOCKS/WR

0005    	DATA	ZERO,NINE,AYE,ZEE/'0','9','A','Z'/
0006    	DATA	NAMMAX/15/
        C
0007    	IF(ICOUNT .LE. 0 .OR. (ICOUNT .GT. NAMMAX))GO TO 200
0008    	DO 100 I = IELMNT,IELMNT+ICOUNT-1
0009    	IF(ARRAY(I) .EQ. DOT .OR. (ARRAY(I) .EQ. BLANK))  GO TO 100
0010    	IF(ARRAY(I) .EQ. USCORE .OR. (ARRAY(I) .EQ. DOLLAR))GO TO 100
0011    	IF(ARRAY(I) .GE. ZERO .AND. (ARRAY(I) .LE. NINE))GO TO 100
0012    	IF(ARRAY(I) .GE. AYE .AND. (ARRAY(I) .LE. ZEE))GO TO 100
0013    	GO TO 300
0014    100	CONTINUE
0015    	I = 0
0016    	GO TO 300
0017    200	I = -1
0018    300	RETURN
0019    	END
FORTRAN IV-PLUS V02-51D		02:23:06    22-AUG-78		PAGE 3   
FLDCHK.FTN   	/TR:BLOCKS/WR

PROGRAM SECTIONS

NUMBER	 NAME	    SIZE		ATTRIBUTES

  1	$CODE1	000264    90		RW,I,CON,LCL
  3	$IDATA	000020     8		RW,D,CON,LCL
  4	$VARS	000012     5		RW,D,CON,LCL
  5	$TEMPS	000002     1		RW,D,CON,LCL


ENTRY POINTS

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 FLDCHK	      1-000000


VARIABLES

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 AYE	L*1   4-000005	 BLANK	L*1   4-000002	 DOLLAR	L*1   4-000001	 DOT	L*1   4-000007	 I	I*2   F-000010*
 ICOUNT	I*2   F-000002*	 IELMNT	I*2   F-000004*	 NAMMAX	I*2   4-000010	 NINE	L*1   4-000004	 USCORE	L*1   4-000000
 ZEE	L*1   4-000006	 ZERO	L*1   4-000003


ARRAYS

 NAME   TYPE  ADDRESS	    SIZE 	DIMENSIONS

 ARRAY	L*1   F-000006*	     **     	(*)


LABELS

 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	

 100	 1-000220	 200	 1-000250	 300	 1-000262


TOTAL SPACE ALLOCATED = 000320   104

NO FPP INSTRUCTIONS GENERATED

OBJ$:FLDCHK.OBI,LIS$:FLDCHK.LST/-SP=SRC$:FLDCHK
