
                22-Aug-1978 02:33:21	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 1   
					HEXDMP.FTN.2        

        C
        C
        C	HEXDMP  --  DUMPS HEXADECIMAL DATA
        C
        C
        C
        C	COPYRIGHT (C) 1976
        C	DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
        C
        C	THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
        C	SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
        C	SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
        C	OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
        C	AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
        C	AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
        C	OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
        C
        C	THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
        C	NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
        C	EQUIPMENT CORPORATION.
        C
        C	DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
        C	SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
        C
        C
        C	T.J. PORTER 	01-AUG-76
        C
        C
        C	THIS SUBROUTINE DUMPS "LENGTH" BYTES IN
        C	HEXADECIMAL FORMAT. THE PARAMETER "LINWID" DETERMINES
        C	THE NUMBER OF BYTES PER LINE.
        C
        C	THE DUMP BEGINS AT ELEMENT "ISTART" OF "ARRAY."
        C
        C
        C
        C
        C  MODIFICATIONS:
        C
        C
        C NO.		DATE		PROGRAMMER		PURPOSE
        C --		----		----------		-------
        C
        C 01		20-AUG-76	K.D. MORSE		REMOVE PRMODE CHECKS
        C							AND TYPE VS WRITE
        C
        C
        C
        C
0001    	SUBROUTINE HEXDMP(ARRAY,ISTART,LENGTH,IOUT)
        C
        C
0002    	BYTE	ARRAY(ISTART - 1 + LENGTH),PRBUF(32)
        C
0003    	DATA	LINWID/10/
        C

HEXDMP          22-Aug-1978 02:33:21	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 2   
					HEXDMP.FTN.2        

0004    10	FORMAT(' ',I4,2X,<LINWID>(2X,A1,A1))
0005    20	FORMAT(T8,<LINWID>(2X,I2))
0006    30	FORMAT(T8,<LINWID>('----'))
0007    40	FORMAT(/)
        C
0008    	DO 200 I = 1,LINWID
        C
0009    		PRBUF(I) = I-1
        C
0010    200	CONTINUE
0011    	WRITE(2,20) (PRBUF(I) , I = 1,LINWID)
0012    	WRITE(2,30)
        C
0013    230	LINE = 0
        C
0014    	DO 500 I = ISTART,ISTART -1 + LENGTH
0015    		IZ = I + 1 - ISTART
0016    		IX = (IZ - 1)/LINWID
0017    		J = IZ - LINWID*IX
0018    		IK = 2*J - 1
0019    		DO 350 K = IK,IK+1
0020    			ICHAR = ARRAY(I) .AND. (240+225*(IK-K))
0021    			ICHAR = ICHAR/(16+15*(IK-K))
0022    			IF(ICHAR .GT. 9)GO TO 250
0023    				ICHAR = ICHAR + 48
0024    				GO TO 300
0025    250				ICHAR = ICHAR + 55
0026    300			PRBUF(K) = ICHAR
0027    350		CONTINUE
0028    		IY = IZ/LINWID
0029    		IF(LINWID*IY .EQ. IZ) GO TO 400
0030    		IF(IZ .NE. LENGTH) GO TO 500
0031    400		WRITE(2,10) LINE, (PRBUF(N) , N = 1,IK+1)
0032    430		LINE = LINE + LINWID
0033    500	CONTINUE
        C
        C----->		OUTPUT A BLANK LINE
        C
0034    	WRITE(2,40)
0035    600	RETURN
0036    	END

HEXDMP          22-Aug-1978 02:33:21	VAX-11 FORTRAN IV-PLUS V1.0-2      Page 3   
					HEXDMP.FTN.2        

PROGRAM SECTIONS

    Name                 Bytes   Attributes

  0 $CODE                  439   PIC CON REL LCL   SHR   EXE   RD NOWRT LONG
  1 $PDATA                  56   PIC CON REL LCL   SHR NOEXE   RD NOWRT LONG
  2 $LOCAL                  98   PIC CON REL LCL NOSHR NOEXE   RD   WRT LONG


ENTRY POINTS

    Address  Type Name           

  0-00000000      HEXDMP         


VARIABLES

    Address  Type Name               Address  Type Name               Address  Type Name               Address  Type Name           

  2-00000022  I*2 I                2-00000030  I*2 ICHAR            2-0000002C  I*2 IK              AP-00000010@ I*2 IOUT           
 AP-00000008@ I*2 ISTART           2-00000028  I*2 IX               2-00000032  I*2 IY               2-00000026  I*2 IZ             
  2-0000002A  I*2 J                2-0000002E  I*2 K               AP-0000000C@ I*2 LENGTH           2-00000024  I*2 LINE           
  2-00000020  I*2 LINWID           2-00000034  I*2 N              


ARRAYS

    Address  Type Name		       Bytes  Dimensions

 AP-00000004@ L*1 ARRAY                   **  (*)
  2-00000000  L*1 PRBUF                   32  (32)


LABELS

    Address   Label       Address   Label       Address   Label       Address   Label       Address   Label       Address   Label   

  1-00000000  10'       1-00000016  20'       1-00000025  30'       1-00000036  40'           **      200           **      230     
  0-00000100  250       0-00000103  300           **      350       0-00000137  400           **      430       0-0000017A  500     
      **      600     


Total Space Allocated = 593 Bytes


COMPILER OPTIONS

/CHECK=(NOBOUNDS,OVERFLOW)
/DEBUG=(NOSYMBOLS,TRACEBACK)
/OPTIMIZE  /WARNINGS  /NOI4  /NOD_LINES  
