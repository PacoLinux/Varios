PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30
TABLE OF CONTENTS

     7-    1	**** PIP VERSION M1335 ****
     8-   68	ASSEMBLY PARAMETERS
     9-  121	READ/WRITE DATA AND WORKING STORAGE
    10-  241	READ ONLY TABLES
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 7


      1						.TITLE	PIP M1335, RSX FILE UTILITY
						.SBTTL	**** PIP VERSION M1335 ****
						.IDENT	/M1335/
      2					; ALTERED:
      3					; ANDREW C. GOLDSTEIN  16-AUG-78  14:51
      4					; BLS001	30-MAR-77
      5					;		FIX PROBLEMS WITH /PU: OR /PU:0 (DON'T REALLY
      6					;		DELETE EVERY FILE--DEFAULT TO /PU:1)
      7					; BLS002	30-MAR-77
      8					;		MAKE /FU:N WORK A LITTLE BETTER
      9					; BLS003	DELETE /MF SWITCH AND ALL REFERENCES TO MFDBIT.
     10					;		THIS SWITCH WAS AN UNDOCUMENTED HACK TO SET THE
     11					;		DEFAULT DIRECTORY TO THE MFD (/DF/MF), WHICH MAY
     12					;		BE DONE VIA ([0,0]/DF).  ADD /SB (SPAN BLOCKS)
     13					;		SWITCH (DEFAULT IS TO SPAN BLOCKS)
     14					; BLS011	8-JUN-77
     15					;		ON ALL COPIES EXCEPT APPENDS, READ ATTRIBUTES
     16					;		FROM INPUT FILE AND WRITE ON OUTPUT FILE.
     17					; BLS025	ADD EXIT WITH STATUS
     18					; BLS026	WHEN COPYING FILES, INSTEAD OF CHECKING FOR LP:
     19					;		CHECK THE F.RCTL BITS (IN CASE LP IS NAMED LQ:, ETC.)
     20					;
     21					;	B. SCHREIBER	3-JUN-78
     22					;
     23					;		BLS052 -- INTEGRATE A. GOLDSTEIN/E. MARISON CHANGES FOR
     24					;			ODS-2 UNDER CONDITIONAL 'O$$DS2'
     25					;
     26					; COPYRIGHT (C) 1978, DIGITAL EQUIPMENT CORP., MAYNARD, MASS.
     27					; COPYRIGHT (C) 1977, DIGITAL EQUIPMENT CORP., MAYNARD, MASS.
     28					; COPYRIGHT 1975, DIGITAL EQUIPMENT CORP., MAYNARD MASS.
     29					; COPYRIGHT 1974, DIGITAL EQUIPMENT CORP., MAYNARD MASS.
     30
     31					; THIS SOFTWARE IS FURNISHED TO PURCHASER UNDER A LICENSE FOR USE
     32					; ON A SINGLE COMPUTER SYSTEM AND CAN BE COPIED (WITH INCLUSION
     33					; OF DEC'S COPYRIGHT NOTICE) ONLY FOR USE IN SUCH SYSTEM, EXCEPT
     34					; AS MAY OTHERWISE BE PROVIDED IN WRITING BY DEC.
     35
     36					; THE INFORMATION IN THIS DOCUMENT IS SUBJECT TO CHANGE WITHOUT
     37					; NOTICE AND SHOULD NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
     38					; EQUIPMENT CORPORATION.
     39
     40					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY
     41					; OF ITS SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
     42					;
     43					; PETER H. LIPMAN 4-JAN-73;
     44					;
     45					; MACROS
     46					;
     47					; INVOKE FCS MACROS
     48					;
     49	000002					FLDSOF			;DEFINE THE FILE DESCRIPTOR OFFSETS
     50						.MCALL	FDOFF$,CSI$,GCMLD$,FCSBT$
     51	000002					FDOFF$	DEF$L
     52	000002					CSI$			;DEFINE THE CSI BLOCK OFFSETS
     53	000002					GCMLD$			;DEFINE THE GET COMMAND LINE OFFSETS
     54	000002					FCSBT$	DEF$L
     55					;
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 7-1
**** PIP VERSION M1335 ****

     56						.MCALL	CSI$SV,CSI$SW,CSI$ND,GCMLB$
     57						.MCALL	FDAT$A,FDBDF$,FDOP$A,FDRC$A,FSRSZ$,NMBLK$
     58					;
     59					; DEFINE THE COMMAND BITS, THE FIRST ARGUMENT IS THE ROUTINE
     60					; ADDRESS TO JMP OFF TO.  THE SECOND IS THE BIT NAME
     61					; BITVAL IS ASSUMED SET UP TO THE FIRST BIT NUMBER TO BE USED.
     62						.MACRO	CMDBIT	ROUTIN,BITNAM
     63						.WORD	ROUTIN
     64						BITNAM==BITVAL
     65						BITVAL=BITVAL*2
     66						.ENDM	CMDBIT
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 8
ASSEMBLY PARAMETERS

     68						.SBTTL	ASSEMBLY PARAMETERS
     69					;
     70		000003 				INLUN==3		;LUN FOR INPUT FILE
     71		000004 				OUTLUN==4		;LUN FOR OUTPUT FILE
     72		000002 				CMOLUN==2		;LUN FOR COMMAND OUTPUT
     73		000001 				FNAEFN==1		;EVENT FLAG USED FOR FIND IN DIR LIST
     74		000002 				RATEFN==2		;EVENT FLAG USED FOR READ ATTRIBUTES (/LI)
     75		000003 				RWEFN==3		;EVENT FLAG FOR READ WRITE MODE COPY
     76						.IF DF	O$$DS2								;BLS052
     77		000037 				DFDRSZ==31.		;SIZE OF LARGEST DEFAULT DIR STRING		;BLS052
     78						.IFF									;BLS052
     79						DFDRSZ==9.		;SIZE OF LARGEST DEFAULT DIR STRING		;BLS052
     80						.ENDC									;BLS052
     81		000011 				TAB=='I-100		;TAB CHARACTER					;**-1
     82		054523 				SYDEV=="SY		;SYSTEM DEVICE
     83		000000 				SYUNIT==0		;SYSTEM UNIT NO.
     84		000056 				S.WUIC==S.FNB+16.	;SIZE OF WILD UIC SCRATCH STORAGE
     85		001400 				NB.SDI==NB.SD1!NB.SD2	;WILD CARD DIRECTORY
     86		001470 				NB.SFL==NB.SVR!NB.STP!NB.SNM!NB.SDI ;* IN NAME, TYPE, VERS, DIR
     87		000070 				NB.SFN==NB.SNM!NB.STP!NB.SVR ;* IN NAME, TYPE, VER
     88
     89
     90					;
     91					; COPY CONTROL WORD BITS- LOCAL SWITCHES ON EACH FILE SPECIFIER
     92		000001 				BSZBIT==1		;BLOCK SIZE SPECIFIED FOR FILE
     93		000002 				UFDBIT==2		;SET TO CREATE UFD'S AS NEEDED
     94		000004 				CNTGBT==4		;SET TO FORCE CONTIGUOUS OUTPUT FILE
     95		000010 				SPANBT==10		; RECORDS MAY SPAN BLOCK BOUNDS
     96					; ***** THE FOLLOWING FOUR VALUES MUST REMAIN IN THEIR CURRENT ORDER
     97		000020 				WOPROB==20		;WORLD PROTECTION SPECIFIED
     98		000040 				GRPROB==40		;GROUP PROTECTION SPECIFIED
     99		000100 				OWPROB==100		;OWNER PROTECTION SPECIFED
    100		000200 				SYPROB==200		;SYSTEM PROTECTION SPECIFIED
    101					; ***** THE PRECEEDING FOUR VALUES MUST REMAIN IN THEIR CURRENT ORDER
    102		000400 				RWDBIT==400		;REWIND BEFORE OPEN
    103		001000 				FIDBIT==1000		;FILE ID MANUALLY SPECIFIED
    104		002000 				BLKBIT==2000		;SIZE OF OUTPUT FILE SPECIFIED TO COPY
    105		004000 				NTCNTG==4000		;NOT CONTIGUOUS CONTROL BIT (COPY)
    106		010000 				NVERBT==10000		;SET IF NOT PRESERVING VERSION ON COPY
    107		020000 				SPSDBT==20000		;SET IF SUPERSEDE FILE ON COPY
    108		040000 				FOWNBT==40000		;SET TO FORCE FILE OWNER TO OUTPUT UIC
    109		100000 				FRSTIM==100000		;FIRST TIME THROUGH A GIVEN OPERATION
    110					;
    111		000401 				FILCL ==BSZBIT!RWDBIT	;FILE LOCAL SWITCHES THAT DO NOT DEFAULT
    112					;
    113					; DEFINITIONS OF OFFSETS USED IN  FILE HEADER
    114		001001 				HA.UI==2*400+1		;WRITE USER ATTRIBUTES
    115		001002 				HA.FP==2*400+2		;SET FILE PROTECTION ATTRIBUTE CODE
    116		000403 				HA.CHU==1*400+3		;SET FILE CHARACTERISTICS ATTRIBUTE CODE
    117									;FOR WRITING THE USER CHARACTERISTICS
    118		000012 				S.STBK==10.		;SIZE OF STATISTICS BLOCK IN BYTES
    119		004010 				ILCLSW==NTCNTG!SPANBT	; INIT LOCAL SWITCHES TO THIS
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 9
READ/WRITE DATA AND WORKING STORAGE

    121						.SBTTL	READ/WRITE DATA AND WORKING STORAGE
    122	000002					.PSECT
    123	000002					FSRSZ$	0		;FILE STORAGE REGION IS DYNAMICALLY SET UP
    124									;GET CMD LINE NOW CLOSES FILE EACH TIME
    125	000002					IMPURE
    126					;
    127					;
    128	000000				FDBOUT::FDBDF$			;ALLOCATE SPACE FOR THE OUTPUT FDB
    129	000140					FDOP$A	OUTLUN,OFNPT	;LUN, FNPT
    130
    131	000140				FDBIN::	FDBDF$
    132	000300					FDRC$A	FD.PLC		;PARTIAL LOCATE MODE
    133	000300					FDOP$A	INLUN,IFNPT	;LUN, FNPT
    134
    135	000300				DIFDB::	FDBDF$			;FDB FOR CREATING DIRECTORIES ONLY
    136	000440					FDOP$A	OUTLUN		;USE LUN OF OUTPUT FILE
    137	000440					FDAT$A	R.FIX,,16.	;16 BYTE FIXED LENGTH RECORDS
    138	000440					FDRC$A	FD.RWM		;READ/WRITE MODE TO AVOID I/O BUFFER
    139
    140	000440				STBLK::	.BLKB	S.STBK
    141	000452				IOSTBK::.BLKW	2		;I/O STATUS BLOCK FOR READ/WRITE MD COPY
    142	000456				FNASTS::.BLKW	2		;I/O STATUS BLOCK FOR FIND QI/O (/LI)
    143					;
    144					; ***** DO NOT SEPARATE THE FOLLOWING LINES
    145					;
    146	000462				CODEV::	.BLKW	1		;SAVED CMD OUTPUT DEVICE NAME
    147	000464				COUNIT::.BLKW	1		;CMD OUTPUT UNIT
    148	000466				LINBUF::.BLKB	144.		;LINE BUFFER USED BY DIR LIST
    149									;UP TO 2 TTY LINES LONG
    150		000220 				LINBFS==.-LINBUF
    151					;
    152					; ***** DO NOT SEPARATE THE PRECEEDING LINES
    153					;
    154
    155					; ***** DO NOT SEPARATE THE FOLLOWING LINES
    156	000706				IFNPT::	.BLKB	S.FIDS+S.APPD	;INPUT FILE AND DEVICE DESIGNATORS
    157		000722'				INSPEC==IFNPT+N.SPEC
    158	000732				IWUIC::	.BLKB	S.WUIC		;SCRATCH STORAGE FOR WILD UIC LOGIC
    159	001010				OFNPT::	.BLKB	S.FIDS+S.APPD	;OUTPUT FILE AND DEVICE DESIGNATORS
    160		001024'				OUSPEC==OFNPT+N.SPEC
    161	001034				OWUIC::	.BLKB	S.WUIC
    162					; ***** DO NOT SEPARATE THE PRECEEDING LINES
    163
    164	001112				SYDFLT::NMBLK$			;DEFAULT DEVICE = SYSTEM DEVICE
    165	001150				NAMBLK::NMBLK$			;SCRATCH NAME BLOCK
    166	001206				NMBLK1::NMBLK$
    167					;
    168	001244				GCMLCB::GCMLB$	4,PIP		;CONTROL BLOCK FOR GET COMMAND LINE
    169									;UP TO 4 LEVELS OF INDIRECTION
    170	001734				CSIBLK::.BLKB	C.SIZE		;CONTROL BLK FOR CMD STRING INTERPRETER
    171					;
    172					; OTHER SCRATCH LOCATIONS
    173	002010				CMDWRD::.BLKW	2		;COMMAND BITS ARE HERE
    174	002014				CPYCTL::.BLKW	1		;CONTROLLING BITS ARE HERE
    175	002016				SAVSP::	.BLKW	1		;SAVE THE STACK POINTER
    176	002020	177777 			.EXSTS::.WORD	-1		;MAY BE MODIFIED BY ERROR CONDITIONS
    177	002022				VERSAV::.BLKW	1		;SAVE VERSION NUMBER FROM PARSE
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 9-1
READ/WRITE DATA AND WORKING STORAGE

    178	002024				INRACC::.BLKW	1		;F.RACC FOR THE INPUT FDB
    179	002026				OURACC::.BLKW	1		;F.RACC FOR THE OUTPUT FDB
    180	002030				DEFDIR::.BLKB	DFDRSZ		;DEFAULT DIRECTORY STRING STORED HERE
    181						.EVEN
    182					;
    183					; ***** DO NOT SEPARATE OR REORDER THE FOLLOWING
    184	002070				WORPRO::.BLKB	4
    185	002074				GROPRO::.BLKB	4
    186	002100				OWNPRO::.BLKB	4
    187	002104				SYSPRO::.BLKB	4
    188	002110	177777 			PROWRD::.WORD	-1
    189					; ***** DO NOT SEPARATE OR REORDER THE PRECEEDING LINES
    190					;
    191	002112	000000 			SPLCNT::.WORD	0		;NO. OF COPIES TO SPOOL
    192	002114	000000 			BUFSIZ::.WORD	0		;SIZE OF BLOCK BUFFER
    193	002116	000000 			OBFSIZ::.WORD	0		; SIZE OF OUTPUT BUFFER
    194	002120	000001 			PURGCT::.WORD	1		;NO. OF VERSIONS TO PRESERVE
    195	002122	000120 			LPTLEN::.WORD	80.		;DEFAULT DIRECTORY LISTING WIDTH
    196	002124				BLKCNT::.BLKW	2		;NO. OF BLOCKS TO ALLOCATE TO OUT FILE
    197	002130				.LCLSW::.BLKW	1		;INITIAL VALUE FOR LOCAL SWITCHES
    198	002132				.OULCL::.BLKW	1		;LOCAL SWITCHES ON 1ST OUTPUT SPEC
    199	002134	054523 			.DEFDV::.WORD	SYDEV		;DEFAULT DEVICE
    200	002136	000000 			.DEFUN::.WORD	SYUNIT		;DEFAULT UNIT
    201	002140				.EXTSZ::.BLKW	3		;SIZE OF INPUT FILE (3RD WORD IS CNTG FLAG)
    202	002146				.FOWNR::.BLKW	1		;UIC FOR THE FILE OWNER IF /FO SWITCH
    203	002150	000000 	000000 		.DYBLK::.LIMIT			;BLOCKS OF DYNAMIC MEMORY AVAILABLE
    204		002152'				.TOPAD==.DYBLK+2	;ADDRESS OF DYNAMIC MEMORY BUFFER(S)
    205	002154				.DYSIZ::.BLKW	1		;SIZE IN BYTES OF DYNAMIC MEMORY REGION
    206	002156				.DYBUF::.BLKW	1		;ADDRESS OF DYNAMIC BUFFER IN USE
    207	002160				.DYBYT::.BLKW	1		;SIZE IN BYTES OF DYNAMIC BUFFER IN USE
    208					;
    209					; READ ATTRIBUTE CONTROL BLOCK
    210					;
    211						.IF	GT,R$$DPB	;IF NEW DPB FORMATS
    212						.IF DF	O$$DS2								;BLS052
    213	002162	000000 			.HDRAD::.WORD	0		;ADDRESS OF ATTRIBUTE AREA			;BLS052
    214	002164	   367 	   012 		RATCTL::.BYTE	-9.,S.STBK	;READ ATTRIBUTES - STATISTICS BLOCK		;BLS052
    215	002166	000440'				.WORD	STBLK								;BLS052
    216	002170	   374 	   040 			.BYTE	-4,32.		;RECORD ATTRIBUTES				;BLS052
    217	002172	000000 			.UAT::	.WORD	0								;BLS052
    218	002174	   377 	   005 			.BYTE	-1,5		;UIC, PROTECTION, AND CHARACTERISTICS		;BLS052
    219	002176	000000 			.UIC::	.WORD	0								;BLS052
    220	002200	   363 	   043 			.BYTE	-13.,35.	;REVISION COUNT AND ALL DATES			;BLS052
    221	002202	000000 			.REV::	.WORD	0								;BLS052
    222						.IFF									;BLS052
    223					RATCTL::.BYTE	-9.,S.STBK	;READ ATTRIBUTES - STATISTICS BLOCK
    224						.WORD	STBLK
    225						.BYTE	-10.,0		;FILE HEADER
    226					.HDRAD::.WORD	0
    227						.ENDC									;BLS052
    228	002204	000000 				.WORD	0		;END OF ATTRIBUTE LIST
    229						.ENDC
    230
    231	002206	   374 	   040 		RATUFA::.BYTE	-4.,32.		;READ/WRITE USER FILE ATTRIBUTES
    232	002210	000466'				.WORD	LINBUF		;BUFFER TO READ/WRITE
    233	002212	000000 				.WORD	0		;MARK END OF ACP QIO FN LIST
    234						.IF	EQ,R$$DYM	;IF NO DYNAMIC MEMORY FACILITY
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 9-2
READ/WRITE DATA AND WORKING STORAGE

    235						.PSECT	$$DYB1,D
    236					DYB1::
    237						.PSECT	$$DYB2,D
    238					DYB2::
    239						.ENDC
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 10
READ ONLY TABLES

    241						.SBTTL	READ ONLY TABLES
    242	002214					PURE.D
    243					;
    244					; READ ONLY TABLES AND CONTROL BLOCKS
    245					; COMMAND TABLE - FORMAT COMMAND,BIT
    246		000001 				BITVAL=1
    247	000036				CMDTBL::
    248	000036					CMDBIT	DIRLST,LSTBIT	;ON IF LISTING DIRECTORY
    249	000040					CMDBIT	DIRLST,SHTLST	;ON IF LISTING DIRECTORY BRIEF MODE
    250	000042					CMDBIT	DIRLST,EVRYBT	;ON IF LISTING DIRECTORY FULL MODE
    251	000044					CMDBIT	DIRLST,TOTLBT	;ON IF LISTING DIRECTORY TOTAL BLOCKS ONLY
    252	000046					CMDBIT	DELETE,DELBIT	;ON IF DELETING THE OUTPUT FILE(S)
    253	000050					CMDBIT	DELETE,PURGBT	;ON IF PURGING FILES
    254	000052					CMDBIT	REMOVE,RMVBIT	;REMOVE A DIRECTORY ENTRY
    255	000054					CMDBIT	PIPID,IDBIT	;TYPE THE PIP IDENTIFIER
    256	000056					CMDBIT	.SETDF,DFLTBT	;CHANGE DEFAULT DEVICE OR UIC
    257	000060					CMDBIT	UNLOCK,UNLKBT	;UNLOCK A LOCKED FILE
    258	000062					CMDBIT	PROTCT,PROTBT	;SET FILE  PROTECTION
    259					;
    260					; TABLE FOR COMMAND BITS IN SECOND WORD
    261					;
    262		000001 				BITVAL=1
    263	000064				CMDTB2::
    264	000064					CMDBIT	SPOOL,SPLBIT	;SPOOL FOR PRINTING AND DELETE
    265	000066					CMDBIT	RENAME,RNMBIT	;RENAME INPUT FILE TO OUTPUT NAME
    266	000070					CMDBIT	ENTER,ENTRBT	;ENTER A DIRECTORY ENTRY
    267	000072					CMDBIT	COPY,MERGBT	;MERGE COMMAND
    268	000074					CMDBIT	COPY,APPDBT	;APPEND FILES
    269	000076					CMDBIT	COPY,UPDTBT	;UPDATE (REWRITE) FILE
    270	000100					CMDBIT	.FREE,FREEBT	;PRINT FREE SPACE ON VOLUME
    271	000102					CMDBIT	TRUNC,TRNBIT	;TRUNCATE FILE TO EOF
    272					;
    273					; COMMAND STRING INTERPRETER SWITCH TABLE
    274	000104				CSISWT::CSI$SW	DI,LSTBIT,CMDWRD,SET,,0 ;DIRECTORY LISTING SWITCH
    275	000114					CSI$SW	LI,LSTBIT,CMDWRD,SET,,0 ;SYNONYM FOR DIR LISTING CMD
    276	000124					CSI$SW	BR,SHTLST,CMDWRD,SET,,0 ;SHORT FORM DIRECTORY LISTING
    277	000134					CSI$SW	FU,EVRYBT,CMDWRD,SET,,FULVAL ;FULL DIRECTORY LISTING
    278	000144					CSI$SW	TB,TOTLBT,CMDWRD,SET,,0 ;LIST DIRECTORY TOTALS ONLY
    279	000154					CSI$SW	DE,DELBIT,CMDWRD,SET,,0 ;DELETE SWITCH
    280	000164					CSI$SW	PU,PURGBT,CMDWRD,SET,,PURGVL ;PURGE ALL BUT NEWEST VERSION
    281	000174					CSI$SW	RM,RMVBIT,CMDWRD,SET,,0 ;REMOVE A DIRECTORY ENTRY
    282	000204					CSI$SW	ID,IDBIT,CMDWRD,SET,,0 ;ID SWITCH - TYPE PIP'S IDENT
    283	000214					CSI$SW	DF,DFLTBT,CMDWRD,SET,,0 ;SET DEFAULT DEVICE OR UIC
    284	000224					CSI$SW	UI,DFLTBT,CMDWRD,SET,,0 ;SET DEFAULT UIC
    285	000234					CSI$SW	UN,UNLKBT,CMDWRD,SET,,0 ;UNLOCK A LOCKED FILE
    286	000244					CSI$SW	PR,PROTBT,CMDWRD,SET,,PRVAL ;SET FILE PROTECTION
    287	000254					CSI$SW	SP,SPLBIT,CMDWRD+2,SET,,SPVAL ;SPOOL THE FILES FOR PRINTING
    288	000264					CSI$SW	RE,RNMBIT,CMDWRD+2,SET,,0 ;RENAME SWITCH
    289	000274					CSI$SW	EN,ENTRBT,CMDWRD+2,SET,,0 ;ENTER A DIRECTORY ENTRY
    290	000304					CSI$SW	ME,MERGBT,CMDWRD+2,SET,,0 ;MERGE INPUT FILES
    291	000314					CSI$SW	AP,APPDBT,CMDWRD+2,SET,,0 ;APPEND COMMAND
    292	000324					CSI$SW	UP,UPDTBT,CMDWRD+2,SET,,0 ;UPDATE (REWRITE) CMD
    293	000334					CSI$SW	FR,FREEBT,CMDWRD+2,SET,,0 ;FREE SPACE ON VOLUME
    294	000344					CSI$SW	TR,TRNBIT,CMDWRD+2,SET,,0 ;TRUNCATE FILE TO EOF
    295					;
    296					; CPYCTL SWITCHES, MODIFY COMMANDS, LOCAL TO THE SPECIFIER
    297	000354					CSI$SW	UF,UFDBIT,CPYCTL,SET,,0 ;CREATE UFD'S AS NEEDED
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 10-1
READ ONLY TABLES

    298	000364					CSI$SW	CO,CNTGBT!NTCNTG,CPYCTL,SET,NEG,0 ;FORCE CONTIGUOUS COPY
    299	000374					CSI$SW	SB,SPANBT,CPYCTL,SET,NEG,0 ;RECORDS SPAN BLOCKS
    300	000404					CSI$SW	WO,WOPROB,CPYCTL,SET,,WOVAL ;WORLD PROTECTION
    301	000414					CSI$SW	GR,GRPROB,CPYCTL,SET,,GRVAL ;GROUP PROTECTION
    302	000424					CSI$SW	OW,OWPROB,CPYCTL,SET,,OWVAL ;OWNER PROTECTION
    303	000434					CSI$SW	SY,SYPROB,CPYCTL,SET,,SYVAL ;SYSTEM PROTECTION
    304	000444					CSI$SW	BS,BSZBIT,CPYCTL,SET,,BSVAL ;BLOCK SIE SPECIFIED
    305	000454					CSI$SW	RW,RWDBIT,CPYCTL,SET,,0 ;REWIND BEFORE OPEN
    306	000464					CSI$SW	FI,FIDBIT,CPYCTL,SET,,FIDVAL ;FILE ID SPECIFIED
    307	000474					CSI$SW	BL,BLKBIT,CPYCTL,SET,,BLKVAL ;NO OF BLOCKS TO ALLOCATE
    308	000504					CSI$SW	NV,NVERBT,CPYCTL,SET,,0 ;COPY TO NEW VERSION
    309	000514					CSI$SW	SU,SPSDBT,CPYCTL,SET,,0 ;SUPERSEDE EXISTING FILES ON COPY
    310	000524					CSI$SW	FO,FOWNBT,CPYCTL,SET,,0 ;FORCE FILE OWNER TO OUTPUT UIC
    311	000534					CSI$ND			;END OF SWITCHES
    312					; VALUE TABLES FOR PROTECTION CODES
    313	000536				WOVAL::	CSI$SV	ASCII,WORPRO,4
    314	000542					CSI$ND
    315	000544				GRVAL::	CSI$SV	ASCII,GROPRO,4
    316	000550					CSI$ND
    317	000552				OWVAL::	CSI$SV	ASCII,OWNPRO,4
    318	000556					CSI$ND
    319	000560				SYVAL::	CSI$SV	ASCII,SYSPRO,4
    320	000564					CSI$ND
    321	000566				PRVAL::	CSI$SV	NUMERIC,PROWRD,2
    322	000572					CSI$ND
    323					;
    324					; VALUE TABLE FOR PURGE SWITCH, NO OF VERSIONS TO PRESERVE
    325	000574				PURGVL::CSI$SV	NUMERIC,PURGCT,2
    326	000600					CSI$ND
    327					;
    328					; VALUE TABLE FOR SPOOL SWITCH - NUMBER OF COPIES
    329	000602				SPVAL::	CSI$SV	NUMERIC,SPLCNT,2
    330	000606					CSI$ND
    331					;
    332					; VALUE TABLE FOR BLOCK SIZE SWITCH
    333	000610				BSVAL:	CSI$SV	NUMERIC,BUFSIZ,2
    334	000614					CSI$ND
    335					;
    336					; VALUE TABLE FOR FILE ID SWITCH
    337	000616				FIDVAL::CSI$SV	NUMERIC,FILID,2
    338	000622					CSI$SV	NUMERIC,FILID+2,2
    339	000626					CSI$SV	NUMERIC,FILID+4,2
    340	000632					CSI$ND
    341					;
    342					; VALUE TABLE FOR /FULL DIRECTORY LISTING SWITCH (OUTPUT WIDTH)
    343	000634				FULVAL::CSI$SV	NUMERIC,LPTLEN,2
    344	000640					CSI$ND
    345					;
    346					; VALUE TABLE FOR /BLOCK SWITCH TO COPY (SPECIFY OUTPUT FILE SIZE)
    347	000642				BLKVAL::CSI$SV	NUMERIC,BLKCNT,2
    348	000646					CSI$SV	NUMERIC,BLKCNT+2,2
    349	000652					CSI$ND
    350
    351	000654	000000 			SSTTAB::.WORD	0		;ODD ADDRESS TRAP
    352	000656	000000 				.WORD	0		;MEMORY PROTECTION VIOLATION
    353	000660	000000 				.WORD	0		;T BIT OR BPT INSTRUCTION
    354	000662	000000 				.WORD	0		;IOT INSTRUCTION
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 10-2
READ ONLY TABLES

    355	000664	000000 				.WORD	0		;RESERVED INSTRUCTION
    356	000666	000000 				.WORD	0		;NON RSX EMT
    357	000670	000000G				.WORD	.ERTRP		;TRAP INSTRUCTION
    358
    359		000007 				SSTENT=<.-SSTTAB>/2	;NO. OF SST ENTRIES IN TABLE
    360
    361	000672	000000G			.ABORT::.WORD	.RSTAR		;ERRPX AND ERROUX RETURN BY JMP @ .ABORT
    362
    363	000674					PURE.I
    364	000000	000167 	000000G		START::	JMP	.INIT
    365	000004				CLOSX::
    366	000004	000167 	000000G		AGAIN::	JMP	.RSTAR
    367	000010	022767 	000000G	002020'	SETWAR::CMP	#EX$WAR,.EXSTS	;ALREADY WORSE THAN WARNING?
    368	000016	003403 				BLE	10$		;IF LE YES
    369	000020	012767 	000000G	002020'		MOV	#EX$WAR,.EXSTS	;NO--SET WARNING
    370	000026	000207 			10$:	RETURN
    371					;
    372					;
    373		000000'				.END	START
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 10-3
SYMBOL TABLE

AB.CDT  000105   	DELETE= ****** GX	FILID = ****** GX	F.URBD= 000020   	NB.SNM= 000040
AB.CHU  000064   	DFDRSZ= 000037 G 	FNAEFN= 000001 G 	F.VBN = 000064   	NB.STP= 000020
AB.EXP  000122   	DFLTBT= 000400 G 	FNASTS  000456RG    005	F.VBSZ= 000060   	NB.SVR= 000010
AB.FNU  000000   	DIFDB   000300RG    005	FOWNBT= 040000 G 	GCMLCB  001244RG    005	NB.TYP= 000002
AB.FP   000062   	DIRLST= ****** GX	FO.APD= 000106   	GE.BIF= 177775   	NB.VER= 000001
AB.FSQ  000002   	ENTER = ****** GX	FO.MFY= 000002   	GE.CLO= 000004   	NB.WLV= 010000
AB.GC   000061   	ENTRBT= 000004 G 	FO.RD = 000001   	GE.COM= 000001   	NMBLK1  001206RG    005
AB.NAM  000006   	EVRYBT= 000004 G 	FO.UPD= 000006   	GE.CON= 000020   	NTCNTG= 004000 G
AB.PC   000060   	EX$WAR= ****** GX	FO.WRT= 000016   	GE.EOF= 177766   	NVERBT= 010000 G
AB.RDT  000070   	FA.APD= 000100   	FREEBT= 000100 G 	GE.IND= 000002   	N.DEVD= 000000
AB.REV  000066   	FA.CRE= 000010   	FRSTIM= 100000 G 	GE.IOR= 177777   	N.DID = 000024
AB.UAT  000020   	FA.DLK= 001000   	FULVAL  000634RG    003	GE.LC = 000010   	N.DIRD= 000004
AGAIN   000004RG    006	FA.ENB= 100000   	F.ACTL= 000076   	GE.MDE= 177774   	N.DVNM= 000032
APPDBT= 000020 G 	FA.EXC= 002000   	F.ALOC= 000040   	GE.OPR= 177776   	N.FID = 000000
BITVAL= 000400   	FA.EXT= 000004   	F.BBFS= 000062   	GE.RBG= 177730   	N.FLID= 000016
BLKBIT= 002000 G 	FA.NSP= 000100   	F.BDB = 000070   	GE.SIZ= 000040   	N.FNAM= 000006
BLKCNT  002124RG    005	FA.POS= 010000   	F.BGBC= 000057   	GROPRO  002074RG    005	N.FNMD= 000010
BLKVAL  000642RG    003	FA.RD = 000001   	F.BKDN= 000026   	GRPROB= 000040 G 	N.FTYP= 000014
BSVAL   000610R     003	FA.RWD= 004000   	F.BKDS= 000020   	GRVAL   000544RG    003	N.FVER= 000016
BSZBIT= 000001 G 	FA.SEQ= 040000   	F.BKEF= 000050   	G.CMLD= 000146   	N.NEXT= 000022
BUFSIZ  002114RG    005	FA.SHR= 000040   	F.BKP1= 000051   	G.DPRM= 000160   	N.SPEC= 000014
CHR$$ = 000117   	FA.TMP= 000020   	F.BKST= 000024   	G.ERR = 000140   	N.STAT= 000020
CH.AND= 000001   	FA.WCK= 020000   	F.BKVB= 000064   	G.ISIZ= 000020   	N.UNIT= 000034
CLOSX   000004RG    006	FA.WRT= 000002   	F.CHR = 000075   	G.LPDL= 000120   	OBFSIZ  002116RG    005
CMDTBL  000036RG    003	FDBIN   000140RG    005	F.CNTG= 000034   	G.MODE= 000141   	OFNPT   001010RG    005
CMDTB2  000064RG    003	FDBOUT  000000RG    005	F.DFNB= 000046   	G.PSDS= 000142   	OURACC  002026RG    005
CMDWRD  002010RG    005	FD.BLK= 000010   	F.DSPT= 000044   	G.SIZE= 000224   	OUSPEC= 001024RG    005
CMOLUN= 000002 G 	FD.CCL= 000002   	F.DVNM= 000134   	HA.CHU= 000403 G 	OUTLUN= 000004 G
CNTGBT= 000004 G 	FD.COM= 020000   	F.EFBK= 000010   	HA.FP = 001002 G 	OWNPRO  002100RG    005
CNT$$ = 000002   	FD.CR = 000002   	F.EFN = 000050   	HA.UI = 001001 G 	OWPROB= 000100 G
CODEV   000462RG    005	FD.DIR= 000010   	F.EOBB= 000032   	IDBIT = 000200 G 	OWUIC   001034RG    005
COPY  = ****** GX	FD.FTN= 000001   	F.ERR = 000052   	IDNTMG= 000000RG    002	OWVAL   000552RG    003
COUNIT  000464RG    005	FD.F11= 040000   	F.FACC= 000043   	IDNTSZ= 000021 G 	O$$DS2= 000001
CPYCTL  002014RG    005	FD.INS= 000010   	F.FFBY= 000014   	IFNPT   000706RG    005	PIPID = ****** GX
CSIBLK  001734RG    005	FD.ISP= 002000   	F.FNAM= 000110   	ILCLSW= 004010 G 	PROTBT= 002000 G
CSISWT  000104RG    003	FD.MNT= 100000   	F.FNB = 000102   	INLUN = 000003 G 	PROTCT= ****** GX
CS.DIF= 000002   	FD.OSP= 004000   	F.FTYP= 000116   	INRACC  002024RG    005	PROWRD  002110RG    005
CS.DVF= 000004   	FD.PLC= 000004   	F.FVER= 000120   	INSPEC= 000722RG    005	PRVAL   000566RG    003
CS.EQU= 000040   	FD.PRN= 000004   	F.HIBK= 000004   	IOSTBK  000452RG    005	PURGBT= 000040 G
CS.INP= 000001   	FD.PSE= 010000   	F.LUN = 000042   	IWUIC   000732RG    005	PURGCT  002120RG    005
CS.MOR= 000020   	FD.RAH= 000001   	F.MBCT= 000054   	LINBFS= 000220 G 	PURGVL  000574RG    003
CS.NMF= 000001   	FD.RAN= 000002   	F.MBC1= 000055   	LINBUF  000466RG    005	RATCTL  002164RG    005
CS.OUT= 000002   	FD.REC= 000001   	F.MBFG= 000056   	LPTLEN  002122RG    005	RATEFN= 000002 G
CS.WLD= 000010   	FD.RWM= 000001   	F.NRBD= 000024   	LSTBIT= 000001 G 	RATUFA  002206RG    005
C.CMLD= 000002   	FD.SDI= 000020   	F.NREC= 000030   	MERGBT= 000010 G 	REMOVE= ****** GX
C.DEVD= 000006   	FD.SQD= 000040   	F.OVBS= 000030   	MOIDMG= 000021RG    002	RENAME= ****** GX
C.DIRD= 000012   	FD.TTY= 000004   	F.RACC= 000016   	MOIDSZ= 000007 G 	RMVBIT= 000100 G
C.DSDS= 000006   	FD.WBH= 000002   	F.RATT= 000001   	NAMBLK  001150RG    005	RNMBIT= 000002 G
C.FILD= 000016   	FF.CHR= 000005   	F.RCNM= 000034   	NB.DEV= 000200   	RWDBIT= 000400 G
C.MKW1= 000024   	FF.NV = 000003   	F.RCTL= 000017   	NB.DIR= 000100   	RWEFN = 000003 G
C.MKW2= 000026   	FF.POE= 000002   	F.RSIZ= 000002   	NB.NAM= 000004   	R$$DPB= 000001
C.SIZE= 000054   	FF.RWD= 000001   	F.RTYP= 000000   	NB.NXD= 020000   	R$$DYM= 000001
C.STAT= 000001   	FF.RWF= 000006   	F.SEQN= 000100   	NB.SDI= 001400 G 	R$$EIS= 000000
C.SWAD= 000022   	FF.SPC= 000004   	F.SPDV= 000072   	NB.SD1= 000400   	R$$MSG= 000000
C.TYPR= 000000   	FIDBIT= 001000 G 	F.SPUN= 000074   	NB.SD2= 001000   	R$$VMS= 000001
DEFDIR  002030RG    005	FIDVAL  000616RG    003	F.STBK= 000036   	NB.SFL= 001470 G 	R$$11M= 000001
DELBIT= 000020 G 	FILCL = 000401 G 	F.UNIT= 000136   	NB.SFN= 000070 G 	R.FIX = 000001
PIP M1335, RSX FILE UTILITY	MACRO M1110  22-AUG-78 01:30  PAGE 10-4
SYMBOL TABLE

R.SEQ = 000003   	SYDEV = 054523 G 	S.NFEN= 000020   	$$    = 000000   	.INIT = ****** GX
R.VAR = 000002   	SYDFLT  001112RG    005	S.STBK= 000012 G 	$$$   = 001424R     005	.LCLSW  002130RG    005
SAVSP   002016RG    005	SYPROB= 000200 G 	S.WUIC= 000056 G 	.ABORT  000672RG    003	.MSGFN  000000RG    003
SETWAR  000010RG    006	SYSPRO  002104RG    005	TAB   = 000011 G 	.DEFDV  002134RG    005	.OULCL  002132RG    005
SHTLST= 000002 G 	SYUNIT= 000000 G 	TOTLBT= 000010 G 	.DEFUN  002136RG    005	.REV    002202RG    005
SIZ$$ = 000002   	SYVAL   000560RG    003	TRNBIT= 000200 G 	.DYBLK  002150RG    005	.RSTAR= ****** GX
SPANBT= 000010 G 	S.APPD= 000010   	TRUNC = ****** GX	.DYBUF  002156RG    005	.SETDF= ****** GX
SPLBIT= 000001 G 	S.BFHD= 000020   	UFDBIT= 000002 G 	.DYBYT  002160RG    005	.TOPAD= 002152RG    005
SPLCNT  002112RG    005	S.FATT= 000016   	UNLKBT= 001000 G 	.DYSIZ  002154RG    005	.UAT    002172RG    005
SPOOL = ****** GX	S.FDB = 000140   	UNLOCK= ****** GX	.ERTRP= ****** GX	.UIC    002176RG    005
SPSDBT= 020000 G 	S.FIDS= 000014   	UPDTBT= 000040 G 	.EXSTS  002020RG    005	...GBL= 000000
SPVAL   000602RG    003	S.FNAM= 000006   	VERSAV  002022RG    005	.EXTSZ  002140RG    005	...PC1= 001244R     005
SSTENT= 000007   	S.FNB = 000036   	WOPROB= 000020 G 	.FOWNR  002146RG    005	...PC2= 001446R     005
SSTTAB  000654RG    003	S.FNBW= 000017   	WORPRO  002070RG    005	.FREE = ****** GX	...PC3= 001244R     005
START   000000RG    006	S.FNTY= 000004   	WOVAL   000536RG    003	.FSRCB= ****** G 	...TPC= 000020
STBLK   000440RG    005	S.FTYP= 000002   	$IDR50  000000RG 	.HDRAD  002162RG    005

. ABS.	000131	   000
      	000002	   001
MSGSTR	000030	   002
PURE$D	000674	   003
$$FSR1	000000	   004
IMPURE	002214	   005
PURE$I	000030	   006
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  6937 WORDS  ( 28 PAGES)
DYNAMIC MEMORY:  8052 WORDS  ( 30 PAGES)
ELAPSED TIME:  00:01:12
OBJ$:PIP,LIS$:PIP/-SP=SRC$:PIPMAC,PIP
