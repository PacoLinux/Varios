FORMAT	MACRO M1110  22-AUG-78 02:12
TABLE OF CONTENTS

     1-  300	OBJECT LANGUAGE DEFS
FORMAT	MACRO M1110  22-AUG-78 02:12  PAGE 1


    100						.TITLE	FORMAT
    200						.IDENT	/X0300/
    300						.SBTTL	OBJECT LANGUAGE DEFS
FORMAT	MACRO M1110  22-AUG-78 02:12  PAGE 3


      1					; COPYRIGHT (C) 1976, 1977
      2					; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
      3					;
      4					; THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
      5					; SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
      6					; SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
      7					; OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
      8					; AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
      9					; AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
     10					; OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
     11					;
     12					; THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
     13					; NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
     14					; EQUIPMENT CORPORATION.
     15					;
     16					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
     17					; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
LIBINI	MACRO M1110  22-AUG-78 02:12  PAGE 4


      1						.TITLE	LIBINI
      2						.IDENT	/03/
      3
      4					; COPYRIGHT (C) 1976, 1977
      5					; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
      6					;
      7					; THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
      8					; SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
      9					; SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
     10					; OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
     11					; AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
     12					; AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
     13					; OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
     14					;
     15					; THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
     16					; NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
     17					; EQUIPMENT CORPORATION.
     18					;
     19					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
     20					; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
     21					;
     22					; VERSION 03
     23					;
     24					; WRITTEN BY:
     25					;	GEORGE W. BERRY
     26					;
     27					; MODIFIED BY:
     28					;	C.A. D'ELIA	13-MAY-74
     29					;	C.A. D'ELIA	30-JUN-74 (VIRTUAL TABLES)
     30					;	T.J. MILLER	16-JUL-75 (USE GTSK FOR CALCULATING SIZE)
     31					;
     32					;
     33
     34					;
     35					; MACRO LIBRARY CALLS
     36					;
     37
     38						.MCALL	FDOFF$,GPRT$C,GTSK$C
     39	000000					FDOFF$	DEF$L
     40
     41					;
     42					; LOCAL DATA
     43					;
     44
     45	000000	000000 	000000 		ADRBND:	.LIMIT			;TKB WILL PROVIDE TASK'S ADDRESS LIMITS
     46
     47
     48					;+
     49					;
     50					; *-$INIT-*-INITIALIZATION ROUTINE
     51					;
     52					; THIS ROUTINE INITIALIZES THE LIBRARIAN'S DATA BASE,
     53					; READS A COMMAND, AND PERFORMS A SYNTAX CHECK ON IT.
     54					;
     55					; INPUTS:
     56					;	NONE
     57					;
LIBINI	MACRO M1110  22-AUG-78 02:12  PAGE 4-1


     58					; OUTPUTS:
     59					;	R1 = ADDRESS OF CSI BLOCK ($CSIBK)
     60					;	R5 = ADDRESS OF SWITCH WORD ($SWTCH)
     61					;
     62					;-
     63
     64	000004				$INIT::
     65	000004	012700 	000000G			MOV	#LIBPT,R0
     66	000010	005060 	000036 			CLR	F.STBK(R0)	;CLEAR STATBK POINTER
     67	000014	010067 	000000G			MOV	R0,$LIBPT	;RESTORE $LIBPT
     68	000020	004567 	000000G			JSR	R5,$CLEAR	;CLEAR DATA BASE
     69	000024	000000G				.WORD	DBASE
     70	000026	000000G				.WORD	DSIZE
     71	000030	004567 	000000G			JSR	R5,$CLEAR	;CLEAR L$BUF
     72	000034	000000G				.WORD	L$BUF
     73	000036	000400 				.WORD	256.
     74
     75	000040				10$:	CALL	$GTCML		;GET A COMMAND LINE
     76	000044	103002 				BCC	20$		;BRANCH IF GOOD READ
     77	000046	000167 	000000G			JMP	$QUIT		;ELSE EXIT
     78
     79	000052	012701 	000000G		20$:	MOV	#$CSIBK,R1	;POINT R1 TO CSI BLOCK
     80	000056					CALL	$SYNTX		;ANALYSE LINE SYNTAX
     81	000062	103766 				BCS	10$		;BRANCH IF BAD SYNTAX
     82	000064	016700 	177712 			MOV	ADRBND+2,R0	;PUT ADDR OF FREE MEMORY IN R0
     83	000070					GTSK$C	$OUTBF		;GET TASK PARAMETERS
     84	000076	016746 	000032G			MOV	$OUTBF+G.TSTS,-(SP) ;PUSH TASK SIZE
     85	000102					GPRT$C	,$OUTBF		;GET PARTITION PARAMETERS
     86	000110	063716 	000000G			ADD	@#$DSW,(SP)	;CALC ADDR OF END OF PARTITION
     87	000114	160016 				SUB	R0,(SP)		;CALC SIZE OF FREE MEMORY
     88	000116	010067 	000000G			MOV	R0,$FRHD	;SETUP FREE MEMORY LIST HEAD
     89	000122	005020 				CLR	(R0)+		;IT'S ONE CHUNK--ZERO LINK WORD
     90	000124	012610 				MOV	(SP)+,(R0)	;PUT IT'S SIZE IN NEXT WORD
     91	000126					CALL	$INIVM		;INITIALIZE WORK FILE SUB-SYSTEM
     92	000132	103010 				BCC	40$		;BRANCH IF ALL WENT O.K.
     93	000134	012701 				MOV	(PC)+,R1	;ASSUME WORK FILE OPEN FAILURE
     94	000136	   000G	   000G			.BYTE	E$R31,S$V2	;THAT IS FATAL
     95	000140	005500 				ADC	R0		;CHECK ALTERNATE STATUS RETURN
     96	000142	002402 				BLT	30$		;BRANCH IF ASSUMPTION WAS CORRECT
     97	000144	012701 				MOV	(PC)+,R1	;ELSE, MARK FOR DELETE FAILURE
     98	000146	   000G	   000G			.BYTE	E$R32,S$V0	;IT'S ONLY A DIAGNOSTIC
     99	000150				30$:	CALL	$ERMSG		;NOTIFY USER (POSSIBLE RETURN)
    100	000154	012705 	000000G		40$:	MOV	#$SWTCH,R5	;POINT R5 TO LIBRARIAN'S SWITCH WORD
    101	000160	012701 	000000G			MOV	#$CSIBK,R1	;POINT R1 TO CSI BLOCK
    102	000164					RETURN
    103
    104
    105		000001 				.END
LIBINI	MACRO M1110  22-AUG-78 02:12  PAGE 4-2
SYMBOL TABLE

ADRBND  000000R  	F.MBFG= 000056   	G.TSTS= 000032   	PF$OVL= 000004   	S$SFL1  000004      007
CTLGRP= 000120   	F.NRBD= 000024   	G.TSVA= 000026   	PF$PIC= 000001   	S$V0  = ****** GX
DBASE = ****** GX	F.NREC= 000030   	G.TSVL= 000030   	PF$RD = 000200   	S$V2  = ****** GX
DSIZE = ****** GX	F.OVBS= 000030   	LIBPT = ****** GX	PF$REL= 000010   	S$$LIB= 000000
EOM$MX= 000007   	F.RACC= 000016   	L$BUF = ****** GX	PF$SHR= 000040   	S.FATT= 000016
E$OMAD  000003      012	F.RATT= 000001   	MAXALI= 000011   	PF$UNI= 000002   	S.FDB = 000140
E$OMER  000001      012	F.RCNM= 000034   	MHD$MX= 000111   	PF$WRT= 000001   	S.FNAM= 000006
E$OMPS  000002      012	F.RCTL= 000017   	MH$CPY= 000004   	PF$XEQ= 000100   	S.FNB = 000036
E$R31 = ****** GX	F.RSIZ= 000002   	MH$GTX= 000006   	PSD$MX= 000031   	S.FNBW= 000017
E$R32 = ****** GX	F.RTYP= 000000   	MH$LNM= 000001   	P$SALI  000002      006	S.FNTY= 000004
F.ACTL= 000076   	F.SEQN= 000100   	MH$MHD= 000000   	P$SALO  000005      006	S.FTYP= 000002
F.ALOC= 000040   	F.SPDV= 000072   	MH$MTC= 000005   	P$SFL0  000003      006	S.NFEN= 000020
F.BBFS= 000062   	F.SPUN= 000074   	MH$SRC= 000002   	P$SFL1  000004      006	TIRMAX= 000121
F.BDB = 000070   	F.STBK= 000036   	MH$TTL= 000003   	P$SNAM  000012      006	T$CHAR= 000005
F.BGBC= 000057   	F.UNIT= 000136   	MTC$MX= 000213   	P$SNLN  000011      006	T$HEAD= 000000
F.BKDN= 000026   	F.URBD= 000020   	M$HDMS  000003      003	Q$$CMO= 000000   	T$SLEN= 000004
F.BKDS= 000020   	F.VBN = 000064   	M$HDNM  000005      003	RX$IAS= 000003   	T$SMBL= 000004
F.BKEF= 000050   	F.VBSZ= 000060   	M$HDSL  000002      003	RX$11D= 000000   	V$MEML= 000002
F.BKP1= 000051   	GS$ARG= 000003   	M$HDST  000001      003	RX$11M= 000001   	$     = 000000      012
F.BKST= 000024   	GS$EPM= 000002   	M$TCPN  000002      004	RX$11S= 000002   	$CLEAR= ****** GX
F.BKVB= 000064   	GS$PSC= 000000   	N.DID = 000024   	R$MXLN= 001000   	$CSIBK= ****** GX
F.CHR = 000075   	GS$SYM= 000001   	N.DVNM= 000032   	R$$11M= 000000   	$DSW  = ****** GX
F.CNTG= 000034   	G$SDTY  000001      005	N.FID = 000000   	SDF$MX= 000032   	$ERMSG= ****** GX
F.DFNB= 000046   	G.PRBA= 000006   	N.FNAM= 000006   	SF$DEF= 000002   	$FRHD = ****** GX
F.DSPT= 000044   	G.PRFW= 000004   	N.FTYP= 000014   	SF$REL= 000010   	$GTCML= ****** GX
F.DVNM= 000134   	G.PRPB= 000000   	N.FVER= 000016   	SF$UNI= 000004   	$INIT   000004RG
F.EFBK= 000010   	G.PRPN= 000002   	N.NEXT= 000022   	SF$VAL= 000020   	$INIVM= ****** GX
F.EFN = 000050   	G.PRPS= 000002   	N.STAT= 000020   	SF$WK = 000001   	$LIBPT= ****** GX
F.EOBB= 000032   	G.TSBA= 000002   	N.UNIT= 000034   	SRF$MX= 000025   	$OUTBF= ****** GX
F.ERR = 000052   	G.TSDU= 000036   	OBJ$SL= 000000   	STAGRP= 000000   	$QUIT = ****** GX
F.FACC= 000043   	G.TSFW= 000024   	OB$DBG= 000004   	STOGRP= 000024   	$SWTCH= ****** GX
F.FFBY= 000014   	G.TSGC= 000017   	OB$EOM= 000003   	S$DNAM  000013      011	$SYNTX= ****** GX
F.FNAM= 000110   	G.TSMT= 000022   	OB$GSD= 000001   	S$DNLN  000012      011	$$    = 000001
F.FNB = 000102   	G.TSNL= 000020   	OB$HDR= 000000   	S$DPSI  000005      011	$$S   = 000005
F.FTYP= 000116   	G.TSPC= 000016   	OB$LNK= 000005   	S$DVAL  000006      011	$$$   = 000004R     013
F.FVER= 000120   	G.TSPN= 000004   	OB$TIR= 000002   	S$MXLN= 000017   	$$$OST= 000006
F.HIBK= 000004   	G.TSPR= 000014   	OPRGRP= 000062   	S$RNAM  000006      010	$$$T1 = 000000
F.LUN = 000042   	G.TSRN= 000010   	O$BJTY  000000      002	S$RNLN  000005      010	$$0   = 000002
F.MBCT= 000054   	G.TSSY= 000034   	PAGALI= 000011   	S$SDTY  000002      007	$$1   = 000002
F.MBC1= 000055   	G.TSTN= 000000   	PF$GBL= 000020   	S$SFL0  000003      007	...TPC= 000140

. ABS.	000000	   000
      	000166	   001
OBJREC	000001	   002
MHDREC	000111	   003
MTCREC	000213	   004
GSDREC	000002	   005
PSDEF 	000031	   006
SYMBOL	000005	   007
SYMREF	000025	   010
SYMDEF	000032	   011
EOMREC	000007	   012
$DPB$$	000014	   013
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  2491 WORDS  ( 10 PAGES)
DYNAMIC MEMORY:  3828 WORDS  ( 14 PAGES)
ELAPSED TIME:  00:00:14
LIBINI	MACRO M1110  22-AUG-78 02:12  PAGE 4-3
SYMBOL TABLE

OBJ$:LIBINI,LIS$:LIBINI/-SP=SRC$:NEWFORMAT.,LIBPRE,LIBINI
