FORMAT	MACRO M1110  22-AUG-78 02:10
TABLE OF CONTENTS

     1-  300	OBJECT LANGUAGE DEFS
FORMAT	MACRO M1110  22-AUG-78 02:10  PAGE 1


    100						.TITLE	FORMAT
    200						.IDENT	/X0300/
    300						.SBTTL	OBJECT LANGUAGE DEFS
FORMAT	MACRO M1110  22-AUG-78 02:10  PAGE 3


      1					; COPYRIGHT (C) 1976, 1977
      2					; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
      3					;
      4					; THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
      5					; SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
      6					; SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
      7					; OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
      8					; AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
      9					; AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
     10					; OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
     11					;
     12					; THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
     13					; NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
     14					; EQUIPMENT CORPORATION.
     15					;
     16					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
     17					; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
LIBERF	MACRO M1110  22-AUG-78 02:10  PAGE 4


      1						.TITLE	LIBERF
      2						.IDENT	/03/
      3
      4					; COPYRIGHT (C) 1976, 1977
      5					; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
      6					;
      7					; THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
      8					; SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
      9					; SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
     10					; OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
     11					; AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
     12					; AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
     13					; OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
     14					;
     15					; THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
     16					; NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
     17					; EQUIPMENT CORPORATION.
     18					;
     19					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
     20					; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
     21					;
     22					; VERSION 03
     23					;
     24					;
     25					; WRITTEN BY:
     26					;	GEORGE W. BERRY
     27					;
     28					; MODIFIED BY:
     29					;	C.A. D'ELIA	10-JUN-74
     30					;	C.A. D'ELIA	30-JUN-74 (VIRTUAL TABLES)
     31					;	THOMAS J MILLER	30-DEC-74
     32					;
     33					;
     34					; ERROR MESSAGE FORMATTING ROUTINE
     35					;
     36
     37					;
     38					; MACRO LIBRARY CALLS
     39					;
     40
     41						.MCALL	FCSBT$
     42	000000					FCSBT$
     43						.MCALL	FDOFF$
     44	000000					FDOFF$	DEF$L
     45
     46
     52
     53
     54					;
     55					; LOCAL DATA
     56					;
     57
     58	000000					.PSECT	TXT
     59	000000	   015 	   012 	   114 	DIAG:	.ASCIZ	<15><12>/LIB -- *DI/  ;DIAGNOSTIC PREFIX
	000003	   111 	   102 	   040
	000006	   055 	   055 	   040
	000011	   052 	   104 	   111
LIBERF	MACRO M1110  22-AUG-78 02:10  PAGE 4-1


	000014	   000
     60	000015	   101 	   107 	   052 		.ASCII	/AG*-/		;NOTE: NULL CHAR MUST BE 4 BYTES FROM ...
	000020	   055
     61									;      ... END OF STRING
     62	000021	   015 	   012 	   114 	FATAL:	.ASCIZ	<15><12>/LIB -- *FAT/  ;FATAL PREFIX
	000024	   111 	   102 	   040
	000027	   055 	   055 	   040
	000032	   052 	   106 	   101
	000035	   124 	   000
     63	000037	   101 	   114 	   052 		.ASCII	/AL*-/		;NOTE: PLACEMENT OF NULL CHAR AGAIN
	000042	   055
     64
     65	000000					.PSECT
     66
     67
     99
    100
    101					;+
    102					;
    103					; **-$FMTER- FORMAT AN ERROR MESSAGE
    104					;
    105					; THIS ROUTINE IS CALLED BY '$ERMSG'.  THE DESCRIPTION ON ITS
    106					; USE IS FOUND IN THAT MODULE.
    107					;
    108					;-
    109
    110	000000				$FMTER::
    111	000000	005005 				CLR	R5		;
    112	000002	150105 				BISB	R1,R5		;GET ERROR NUMBER
    113	000004	005004 				CLR	R4		;
    114	000006	000301 				SWAB	R1		;SWAP HALVES
    115	000010	150104 				BISB	R1,R4		;GET SEVERITY
    116	000012	016703 	000000G			MOV	$CMIPT,R3	;GET COMMAND INPUT RECORD BLOCK
    117	000016	132763 	000004 	000017 		BITB	#FD.TTY,F.RCTL(R3);TERMINAL DEVICE?
    118	000024	001001 				BNE	40$		;IF NE YES
    119	000026	005204 				INC	R4		;INCREMENT SEVERITY
    120	000030	012701 	000000'		40$:	MOV	#DIAG,R1	;ASSUME DIAGNOSTIC MESSAGE
    121	000034	020427 	000000G			CMP	R4,#S$V2	;FATAL ERROR?
    122	000040	002402 				BLT	50$		;IF LT NO
    123	000042	012701 	000021'			MOV	#FATAL,R1	;GET ADDRESS OF FATAL MESSAGE
    124	000046	012700 	000000G		50$:	MOV	#$OUTBF,R0	;GET ADDRESS OF OUTPUT BUFFER
    125	000052	112120 			60$:	MOVB	(R1)+,(R0)+	;INSERT PREFIX
    126	000054	001376 				BNE	60$		;
    127	000056	005300 				DEC	R0		;BACKUP BUFFER ADDRESS
    128
    129
    167
    168	000060	112120 				MOVB	(R1)+,(R0)+	;MOVE REMAINDER OF ...
    169	000062	112120 				MOVB	(R1)+,(R0)+	;... PREFIX STRING ...
    170	000064	112120 				MOVB	(R1)+,(R0)+	;... INTO THE MESSAGE ...
    171	000066	111120 				MOVB	(R1),(R0)+	;... BUFFER
    172	000070	006305 				ASL	R5		;CONVERT ERROR NUMBER INTO AN OFFSET
    173	000072	016501 	000000G			MOV	$MGLST(R5),R1	;POINT R1 TO ERROR MESSAGE FORMAT STRING
    174	000076					CALL	$EDMSG		;GENERATE THE ERROR MESSAGE
    175	000102	010002 				MOV	R0,R2		;PUT ADDR OF END OF MESSAGE IN R2
    176	000104	162702 	000000G			SUB	#$OUTBF,R2	;CALCULATE LENGTH OF ERROR MESSAGE STRING
    177
LIBERF	MACRO M1110  22-AUG-78 02:10  PAGE 4-2


    178
    180
    181
    182	000110					RETURN
    183
    184
    185
    186		000001 				.END
LIBERF	MACRO M1110  22-AUG-78 02:10  PAGE 4-3
SYMBOL TABLE

CH.AND= 000001   	FF.CHR= 000005   	F.RACC= 000016   	N.DID = 000024   	SF$UNI= 000004
CTLGRP= 000120   	FF.NV = 000003   	F.RATT= 000001   	N.DVNM= 000032   	SF$VAL= 000020
DIAG    000000R     013	FF.POE= 000002   	F.RCNM= 000034   	N.FID = 000000   	SF$WK = 000001
EOM$MX= 000007   	FF.RWD= 000001   	F.RCTL= 000017   	N.FNAM= 000006   	SRF$MX= 000025
E$OMAD  000003      012	FF.RWF= 000006   	F.RSIZ= 000002   	N.FTYP= 000014   	STAGRP= 000000
E$OMER  000001      012	FF.SPC= 000004   	F.RTYP= 000000   	N.FVER= 000016   	STOGRP= 000024
E$OMPS  000002      012	FO.APD= 000106   	F.SEQN= 000100   	N.NEXT= 000022   	S$DNAM  000013      011
FATAL   000021R     013	FO.MFY= 000002   	F.SPDV= 000072   	N.STAT= 000020   	S$DNLN  000012      011
FA.APD= 000100   	FO.RD = 000001   	F.SPUN= 000074   	N.UNIT= 000034   	S$DPSI  000005      011
FA.CRE= 000010   	FO.UPD= 000006   	F.STBK= 000036   	OBJ$SL= 000000   	S$DVAL  000006      011
FA.DLK= 001000   	FO.WRT= 000016   	F.UNIT= 000136   	OB$DBG= 000004   	S$MXLN= 000017
FA.ENB= 100000   	F.ACTL= 000076   	F.URBD= 000020   	OB$EOM= 000003   	S$RNAM  000006      010
FA.EXC= 002000   	F.ALOC= 000040   	F.VBN = 000064   	OB$GSD= 000001   	S$RNLN  000005      010
FA.EXT= 000004   	F.BBFS= 000062   	F.VBSZ= 000060   	OB$HDR= 000000   	S$SDTY  000002      007
FA.NSP= 000100   	F.BDB = 000070   	GS$ARG= 000003   	OB$LNK= 000005   	S$SFL0  000003      007
FA.POS= 010000   	F.BGBC= 000057   	GS$EPM= 000002   	OB$TIR= 000002   	S$SFL1  000004      007
FA.RD = 000001   	F.BKDN= 000026   	GS$PSC= 000000   	OPRGRP= 000062   	S$V2  = ****** GX
FA.RWD= 004000   	F.BKDS= 000020   	GS$SYM= 000001   	O$BJTY  000000      002	S$$LIB= 000000
FA.SEQ= 040000   	F.BKEF= 000050   	G$SDTY  000001      005	PAGALI= 000011   	S.FATT= 000016
FA.SHR= 000040   	F.BKP1= 000051   	MAXALI= 000011   	PF$GBL= 000020   	S.FDB = 000140
FA.TMP= 000020   	F.BKST= 000024   	MHD$MX= 000111   	PF$OVL= 000004   	S.FNAM= 000006
FA.WCK= 020000   	F.BKVB= 000064   	MH$CPY= 000004   	PF$PIC= 000001   	S.FNB = 000036
FA.WRT= 000002   	F.CHR = 000075   	MH$GTX= 000006   	PF$RD = 000200   	S.FNBW= 000017
FD.BLK= 000010   	F.CNTG= 000034   	MH$LNM= 000001   	PF$REL= 000010   	S.FNTY= 000004
FD.CCL= 000002   	F.DFNB= 000046   	MH$MHD= 000000   	PF$SHR= 000040   	S.FTYP= 000002
FD.COM= 020000   	F.DSPT= 000044   	MH$MTC= 000005   	PF$UNI= 000002   	S.NFEN= 000020
FD.CR = 000002   	F.DVNM= 000134   	MH$SRC= 000002   	PF$WRT= 000001   	TIRMAX= 000121
FD.DIR= 000010   	F.EFBK= 000010   	MH$TTL= 000003   	PF$XEQ= 000100   	T$CHAR= 000005
FD.FTN= 000001   	F.EFN = 000050   	MTC$MX= 000213   	PSD$MX= 000031   	T$HEAD= 000000
FD.F11= 040000   	F.EOBB= 000032   	M$HDMS  000003      003	P$SALI  000002      006	T$SLEN= 000004
FD.INS= 000010   	F.ERR = 000052   	M$HDNM  000005      003	P$SALO  000005      006	T$SMBL= 000004
FD.ISP= 002000   	F.FACC= 000043   	M$HDSL  000002      003	P$SFL0  000003      006	V$MEML= 000002
FD.MNT= 100000   	F.FFBY= 000014   	M$HDST  000001      003	P$SFL1  000004      006	$     = 000000      012
FD.OSP= 004000   	F.FNAM= 000110   	M$TCPN  000002      004	P$SNAM  000012      006	$CMIPT= ****** GX
FD.PLC= 000004   	F.FNB = 000102   	NB.DEV= 000200   	P$SNLN  000011      006	$EDMSG= ****** GX
FD.PRN= 000004   	F.FTYP= 000116   	NB.DIR= 000100   	Q$$CMO= 000000   	$FMTER  000000RG
FD.PSE= 010000   	F.FVER= 000120   	NB.NAM= 000004   	R$MXLN= 001000   	$MGLST= ****** GX
FD.RAH= 000001   	F.HIBK= 000004   	NB.SD1= 000400   	R$$11M= 000000   	$OUTBF= ****** GX
FD.RAN= 000002   	F.LUN = 000042   	NB.SD2= 001000   	R.FIX = 000001   	$$    = 000001
FD.REC= 000001   	F.MBCT= 000054   	NB.SNM= 000040   	R.SEQ = 000003   	$$S   = 000005
FD.RWM= 000001   	F.MBC1= 000055   	NB.STP= 000020   	R.VAR = 000002   	$$0   = 000002
FD.SDI= 000020   	F.MBFG= 000056   	NB.SVR= 000010   	SDF$MX= 000032   	$$1   = 000002
FD.SQD= 000040   	F.NRBD= 000024   	NB.TYP= 000002   	SF$DEF= 000002   	...GBL= 000000
FD.TTY= 000004   	F.NREC= 000030   	NB.VER= 000001   	SF$REL= 000010   	...TPC= 000140
FD.WBH= 000002   	F.OVBS= 000030

. ABS.	000000	   000
      	000112	   001
OBJREC	000001	   002
MHDREC	000111	   003
MTCREC	000213	   004
GSDREC	000002	   005
PSDEF 	000031	   006
SYMBOL	000005	   007
SYMREF	000025	   010
SYMDEF	000032	   011
EOMREC	000007	   012
LIBERF	MACRO M1110  22-AUG-78 02:10  PAGE 4-4
SYMBOL TABLE

TXT   	000043	   013
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  2465 WORDS  ( 10 PAGES)
DYNAMIC MEMORY:  3828 WORDS  ( 14 PAGES)
ELAPSED TIME:  00:00:13
OBJ$:LIBERF,LIS$:LIBERF/-SP=SRC$:NEWFORMAT.,LIBPRE,LIBERF
