NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   0
TABLE OF CONTENTS   

   (1)    3500  HISTORY
   (1)    4300  DECLARATIONS
   (1)    8700  DISPATCHING
   (1)   21500  UTILITY ROUTINES
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   1
X01                                                                                                                              (1)

                                     0000   100 
                                     0000   200 	.TITLE	NETCTLQIO - DISPATCH ACP CONTROL QIO'S
                                     0000   300 	.IDENT	/X01/
                                     0000   400 
                                     0000   500 ;
                                     0000   600 ; COPYRIGHT (C) 1977, 1978
                                     0000   700 ; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS 01754
                                     0000   800 ;
                                     0000   900 ; THIS SOFTWARE IS FURNISHED  UNDER A LICENSE FOR USE ONLY ON A SINGLE
                                     0000  1000 ; COMPUTER  SYSTEM AND  MAY BE  COPIED ONLY WITH  THE INCLUSION OF THE
                                     0000  1100 ; ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE, OR ANY OTHER COPIES THEREOF,
                                     0000  1200 ; MAY NOT BE PROVIDED OR  OTHERWISE MADE AVAILABLE TO ANY OTHER PERSON
                                     0000  1300 ; EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO AGREES TO THESE LICENSE
                                     0000  1400 ; TERMS.  TITLE TO AND  OWNERSHIP OF THE  SOFTWARE  SHALL AT ALL TIMES
                                     0000  1500 ; REMAIN IN DEC.
                                     0000  1600 ;
                                     0000  1700 ; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE WITHOUT NOTICE
                                     0000  1800 ; AND SHOULD  NOT BE CONSTRUED  AS A COMMITMENT  BY DIGITAL  EQUIPMENT
                                     0000  1900 ; CORPORATION.
                                     0000  2000 ;
                                     0000  2100 ; DEC ASSUMES  NO  RESPONSIBILITY  FOR  THE USE OR  RELIABILITY OF ITS
                                     0000  2200 ; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
                                     0000  2300 
                                     0000  2400 ;++
                                     0000  2500 ; FACILITY:	NETWORK ACP
                                     0000  2600 ;
                                     0000  2700 ; ABSTRACT:
                                     0000  2800 ;	THIS MODULE PROCESSES CONTROL QIO'S TO NETACP.
                                     0000  2900 ;	IT DISPATCHES TO THE APPROPRIATE PROCESSING ROUTINE.
                                     0000  3000 ;
                                     0000  3100 ; ENVIRONMENT:
                                     0000  3200 ;	MODE = KERNEL
                                     0000  3300 ;--
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   2
X01             HISTORY                                                                                                          (1)

                                     0000  3500 	.SBTTL	HISTORY
                                     0000  3600 ; AUTHOR:	SCOTT G. DAVIS, CREATION DATE: 17-NOV-77
                                     0000  3700 ;
                                     0000  3800 ; MODIFIED BY:
                                     0000  3900 ;
                                     0000  4000 ;	, : VERSION
                                     0000  4100 ; 01	- 
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   3
X01             DECLARATIONS                                                                                                     (1)

                                     0000  4300 	.SBTTL	DECLARATIONS
                                     0000  4400 ;
                                     0000  4500 ; INCLUDE FILES:
                                     0000  4600 ;
                                     0000  4700 	$ABDDEF
                                     0000  4800 	$CCBDEF
                                     0000  4900 	$IRPDEF
                                     0000  5000 	$NDBDEF
                                     0000  5100 	$UCBDEF
                                     0000  5200 
                                     0000  5300 ;
                                     0000  5400 ; MACROS:
                                     0000  5500 ;
                                     0000  5600 
                                     0000  5700 ;
                                     0000  5800 ; EQUATED SYMBOLS:
                                     0000  5900 ;
                                     0000  6000 	$EQULST	NET_,,,,<-
                                     0000  6100 		<MINPATH,4>,-		; MIN SIZE OF GET PATH BUFFER
                                     0000  6200 >
                                     0000  6300 
                                     0000  6400 ;
                                     0000  6500 ; OWN STORAGE:
                                     0000  6600 ;
                                     0000  6700 
                                 00000000  6800 	.PSECT	NET_IMPURE,WRT,NOEXE
                                     0000  6900 
                                     0000  7000 ;*****
                                     0000  7100 ; NOTE - THE FOLLOWING 8 LONGWORDS MUST BE TOGETHER, IN ORDER.
                                     0000  7200 ;	THE LENGTHS COULD BE WORDS BUT ARE LONGWORDS FOR CONVENIENCE
                                     0000  7300 ;	IN ADDRESS COMPARISONS.
                                     0000  7400 ;*****
                           00000004  0000  7500 NET$GL_RES_LTH::	.BLKL	1	; LENGTH OF RES (P4)
                           00000008  0004  7600 NET$GL_RES_PTR::	.BLKL	1	; POINTER TO RES (P4)
                           0000000C  0008  7700 RESL_LTH:		.BLKL	1	; LENGTH OF RESL (P3): 0=> NOT THERE
                           00000010  000C  7800 RESL_PTR:		.BLKL	1	; POINTER TO RESL (P3)
                           00000014  0010  7900 NET$GL_NAME_LTH::	.BLKL	1	; LENGTH OF NAME (P2)
                           00000018  0014  8000 NET$GL_NAME_PTR::	.BLKL	1	; POINTER TO NAME (P2)
                           0000001C  0018  8100 	NFB_LTH:	.BLKL	1	; LENGTH OF NFB (P1)
                           00000020  001C  8200 NFB_PTR:		.BLKL	1	; POINTER TO NET FUNCTION BLOCK (FIB) (P1)
                                     0020  8300 
                           00000022  0020  8400 NET$GW_CTLCOUNT::	.BLKW	1	; COUNT OF ITEMS TO BE RETURNED
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   4
X01             DECLARATIONS                                                                                                     (1)

                                 00000000  8600 	.PSECT	NET_CONTROL,NOWRT
                                     0000  8700 	.SBTTL	DISPATCHING
                                     0000  8800 ;++
                                     0000  8900 ; FUNCTIONAL DESCRIPTION:
                                     0000  9000 ;
                                     0000  9100 ; NET$CONTROL_QIO - DETERMINE WHICH CONTROL FUNCTION HAS BEEN
                                     0000  9200 ;	REQUESTED AND DISPATCH TO IT.
                                     0000  9300 ;
                                     0000  9400 ; CALLING SEQUENCE:
                                     0000  9500 ;
                                     0000  9600 ;	BSB	NET$CONTROL_QIO
                                     0000  9700 ;
                                     0000  9800 ; INPUT PARAMETERS:
                                     0000  9900 ;
                                     0000 10000 ;	R3 - IRP ADDRESS
                                     0000 10100 ;	R5 - UCB ADDRESS
                                     0000 10200 ;
                                     0000 10300 ;	ACP CONTROL BLOCK - GENERALLY HAS THE FOLLOWING ARGS:
                                     0000 10400 ;		P1 - (FIB) 1 BYTE OF FUNCTION CODE, 4 BYTES OF PARAMETER
                                     0000 10500 ;		P2 - NAME (NODENAMES ARE COUNTED STRINGS, LINE NAMES 
                                     0000 10600 ;		     ARE 4 ASCII CHARACTERS)
                                     0000 10700 ;		P3 - RESULT LENGTH
                                     0000 10800 ;		P4 - RESULT BUFFER
                                     0000 10900 ;
                                     0000 11000 ; IMPLICIT INPUTS:
                                     0000 11100 ;
                                     0000 11200 ;	NETWORK DATA BASE
                                     0000 11300 ;
                                     0000 11400 ; OUTPUT PARAMETERS:
                                     0000 11500 ;
                                     0000 11600 ;	NONE
                                     0000 11700 ;
                                     0000 11800 ; IMPLICIT OUTPUTS:
                                     0000 11900 ;
                                     0000 12000 ;	NONE
                                     0000 12100 ;
                                     0000 12200 ; COMPLETION CODES:
                                     0000 12300 ;
                                     0000 12400 ;	SS$_BADPARAM - BAD PARAMETER
                                     0000 12500 ;	SS$_DEVMOUNT - ATTEMPT TO SET LOCAL ON AFTER SET LOCAL OFF
                                     0000 12600 ;	SS$_DEVNOTMOUNT - ATTEMPT TO SET LOCAL OFF AFTER SET LOCAL OFF
                                     0000 12700 ;	SS$_DIRFULL - NO ROOM IN CONNECT NAME TABLE
                                     0000 12800 ;	SS$_ILLCNTRFUNC - ILLEGAL CONTROL FUNCTION
                                     0000 12900 ;	SS$_INSFMEM - COULDN'T ALLOCATE NDB
                                     0000 13000 ;	SS$_NOMBX - NO ASSOCIATED MBX FOR INBOUND CONNECT NAME DECLARATION
                                     0000 13100 ;	SS$_NOPRIV - NO PRIVILEGE FOR REQUESTED OPERATION (OR DATABASE LOCKED)
                                     0000 13200 ;	SS$_NORMAL - NORMAL COMPLETION
                                     0000 13300 ;	SS$_NOSUCHNODE - UNKNOWN NODE
                                     0000 13400 ;	SS$_RESULTOVF - SUPPLIED RESULT BFR TOO SHORT
                                     0000 13500 ;	OTHER CODES FROM $ASSIGN, $QIO
                                     0000 13600 ;
                                     0000 13700 ; SIDE EFFECTS:
                                     0000 13800 ;
                                     0000 13900 ;	NONE
                                     0000 14000 ;
                                     0000 14100 ;--
                                     0000 14200 
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   5
X01             DISPATCHING                                                                                                      (1)

                                     0000 14300 NET$CONTROL_QIO::
                                     0000 14400 ;
                                     0000 14500 ; SET UP POINTERS TO ALL STRINGS IN THE FUNNY ACP BUFFER
                                     0000 14600 ;
            50         2C B3     D0  0000 14700 	MOVL	@IRP$L_SVAPTE(R3),R0	; GET THE COMPLEX BFR ADDRESS
            52            04     9A  0004 14800 	MOVZBL	#ABD$C_RES,R2		; GET VALUE OF P4 TYPE FOR LOOP
            5B       0000'CF     9E  0007 14900 	MOVAB	W^NET$GL_RES_LTH,R11	; GET TABLE ADDRESS FOR LOOP
                                     000C 15000 10$:
                                     000C 15100 
                                     000C 15200 	ASSUME ABD$W_TEXT EQ 0
                                     000C 15300 
            52            08     7A  000C 15400 	EMUL	#ABD$C_LENGTH,R2,R0,R6	; GET ADDRESS OF OFFSET
            56            50         000F       
            7E            66     3C  0011 15500 	MOVZWL	(R6),-(SP)		; GET OFFSET
            8B         02 A6     3C  0014 15600 	MOVZWL	ABD$W_COUNT(R6),(R11)+	; STORE THE PARAMETER LTH
            56            8E     C0  0018 15700 	ADDL	(SP)+,R6		; GET ADDRESS OF TEXT
            8B         01 A6     DE  001B 15800 	MOVAL	1(R6),(R11)+		; STORE POINTER TO TEXT AREA (BIASED FOR ACC MODE)
            EA            52     F5  001F 15900 	SOBGTR	R2,10$			; LOOP
                                     0022 16000 
       0000'CF            00'    7D  0022 16100 	MOVQ	S^#SS$_NORMAL,W^NET$GQ_USR_STAT ; ASSUME SUCCESS AND CLEAR COUNT
            5B       001C'CF     D0  0027 16200 	MOVL	W^NFB_PTR,R11		; GET ADDRESS OF NFB
                     0020'CF     B4  002C 16300 	CLRW	W^NET$GW_CTLCOUNT	; INIT COUNT
                     0008'CF     D5  0030 16400 	TSTL	W^RESL_LTH		; WAS THERE A RESL?
                          04     13  0034 16500 	BEQL	20$			; IF EQL NO
                     000C'DF     B4  0036 16600 	CLRW	@W^RESL_PTR		; INIT RESL
                                     003A 16700 20$:
         55'AF            00     FB  003A 16800 	CALLS	#0,B^DISPATCH		; SET UP FOR RETURN VIA RET
                                     003E 16900 ;
                                     003E 17000 ; CLEANUP AFTER PROCESSING
                                     003E 17100 ;
         2A A3            02     A8  003E 17200 	BISW	#IRP$M_FUNC,IRP$W_STS(R3) ; SET FOR WRITEBACK
            50         2C B3     D0  0042 17300 	MOVL	@IRP$L_SVAPTE(R3),R0	; GET THE BUFFER ADDRESS BACK
                       02 A0     B4  0046 17400 	CLRW	<ABD$C_LENGTH*ABD$C_WINDOW>+ABD$W_COUNT(R0) ; NO WINDOW
                       12 A0     B4  0049 17500 	CLRW	<ABD$C_LENGTH*ABD$C_NAME>+ABD$W_COUNT(R0) ; NO NAME
         01 AB       0020'CF     3C  004C 17600 	MOVZWL	W^NET$GW_CTLCOUNT,1(R11) ; STORE THE COUNT BACK
                          FFAB'  31  0052 17700 	BRW	NET$IODONE		; POST THE I/O AND RETURN
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   6
X01             DISPATCHING                                                                                                      (1)

                                     0055 17900 ;
                                     0055 18000 ; DISPATCH TO PROPER PROCESSOR
                                     0055 18100 ;
                               0828  0055 18200 DISPATCH:	.WORD	^M<R3,R5,R11>	; ENTRY
       0018'CF            05     B1  0057 18300 	CMPW	#5,W^NFB_LTH		; ENOUGH BYTES?
                          72     12  005C 18400 	BNEQ	BADPARAM		; IF NEQ NO
                                     005E 18500 	CASE	(R11)+,LIMIT=#1,TYPE=B,<- ;
                                     005E 18600 		NET$SET_LIN_STA,-	; 1 PHYSICAL LINE FUNCTIONS
                                     005E 18700 		NET$GET_LIN_STA,-	; 2
                                     005E 18800 		NET$GET_LIN_CTR,-	; 3
                                     005E 18900 		NET$CLR_LIN_CTR,-	; 4
                                     005E 19000 		NET$UPD_OBJECT,-	; 5 - LOCAL NODE FUNCTIONS
                                     005E 19100 		NET$UPD_REMOTE,-	; 6
                                     005E 19200 		NET$GET_LOC_NAM,-	; 7
                                     005E 19300 		NET$GET_LNBYNOD,-	; 8 - REMOTE NODE FUNCTIONS
                                     005E 19400 		NET$GET_LOGLNKS,-	; 9
                                     005E 19500 		NET$SET_LOC_STA,-	; A - LOCAL NODE FUNCTIONS
                                     005E 19600 		NET$GET_LOC_STA,-	; B
                                     005E 19700 		NET$GET_LOC_CTR,-	; C
                                     005E 19800 		NET$CLR_LOC_CTR,-	; D
                                     005E 19900 		NET$GET_NODNAMS,-	; E
                                     005E 20000 		NET$GET_LINNAMS,-	; F
                                     005E 20100 		NET$DISC_LINK,-		; 10
                                     005E 20200 		NET$GET_NAMENUM,-	; 11 MISCELLANEOUS
                                     005E 20300 		NET$GET_NUMNAME,-	; 12
                                     005E 20400 		NET$GET_VERSION,-	; 13
                                     005E 20500 		NET$GET_NODBYLN,-	; 14
                                     005E 20600 		NET$DECLARE_NAM,-	; 15
                                     005E 20700 >
                                     008C 20800 ;
                                     008C 20900 ; ILLEGAL FUNCTION CODE
                                     008C 21000 ;
                                     008C 21100 UNUSED:
       0000'CF       0000'8F     B0  008C 21200 	MOVW	#SS$_ILLCNTRFUNC,W^NET$GQ_USR_STAT ; BAD FUNCTION CODE
                                 04  0093 21300 	RET				; DONE
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   7
X01             UTILITY ROUTINES                                                                                                 (1)

                                     0094 21500 	.SBTTL	UTILITY ROUTINES
                                     0094 21600 
                                     0094 21700 ;++
                                     0094 21800 ;
                                     0094 21900 ; NET$CTL_UPD_CNT - UPDATES BUFFER AND ITEM COUNTS.  CHECKS TO SEE IF NEXT
                                     0094 22000 ; ITEM WILL FIT IN BUFFER - IF NOT, RESULTOVF IS RETURNED, AND
                                     0094 22100 ; OPERATION IS TERMINATED.
                                     0094 22200 ;
                                     0094 22300 ; INPUTS:	R10 - NO. OF BYTES TO BE ADDED TO BUFFER
                                     0094 22400 ;
                                     0094 22500 ;--
                                     0094 22600 
                                     0094 22700 	.ENABL	LSB
                                     0094 22800 
                                     0094 22900 NET$CTL_UPD_CNT::
       0000'CF            5A     A2  0094 23000 	SUBW	R10,W^NET$GL_RES_LTH	; CHECK REMAINING SPACE IN BFR
                          07     18  0099 23100 	BGEQ	20$			; IF GEQ OK
                                     009B 23200 RESULTOVF:
            50       0000'8F     B0  009B 23300 	MOVW	#SS$_RESULTOVF,R0	; MARK ERROR
                          31     11  00A0 23400 	BRB	CONTROL_ERROR		; FINISH IN COMMON CODE
                                     00A2 23500 20$:
       0002'CF            5A     A0  00A2 23600 	ADDW	R10,W^NET$GQ_USR_STAT+2	; MORE BYTES IN BFR
                     0020'CF     B6  00A7 23700 	INCW	W^NET$GW_CTLCOUNT	; ANOTHER ITEM RETURNED
                     0008'CF     D5  00AB 23800 	TSTL	W^RESL_LTH		; WAS THERE A RESL?
                          05     13  00AF 23900 	BEQL	RETURN			; IF EQL NO
       000C'DF            5A     A0  00B1 24000 	ADDW	R10,@W^RESL_PTR		; HERE, TOO
                                 05  00B6 24100 RETURN:	RSB				; DONE
                                     00B7 24200 
                                     00B7 24300 	.DSABL	LSB
                                     00B7 24400 
                                     00B7 24500 ;++
                                     00B7 24600 ; NET$CTL_CHKNAM - SEE IF THE COUNTED STRING THE USER GAVE IS ALL THERE AND NOT NULL
                                     00B7 24700 ;
                                     00B7 24800 ; OUTPUTS:	R6 - ADDRESS OF NAME STRING
                                     00B7 24900 ;--
                                     00B7 25000 
                                     00B7 25100 	.ENABL	LSB
                                     00B7 25200 
                                     00B7 25300 NET$CTL_CHKNAM::
            56       0014'CF     D0  00B7 25400 	MOVL	W^NET$GL_NAME_PTR,R6	; INIT FOR COMPARISON
            57            66     9A  00BC 25500 	MOVZBL	(R6),R7			; GET THE NAME LTH
                          0F     15  00BF 25600 	BLEQ	10$			; IF LEQ NG
            57            00'    91  00C1 25700 	CMPB	S^#NET$C_MAXNODLTH,R7	; TOO MANY CHARS?
                          0A     1F  00C4 25800 	BLSSU	10$			; IF LSSU YES
                                     00C6 25900 	CMPAL	1(R7),W^NET$GL_NAME_LTH	; DID THE USER LIE ABOUT THE STRING?
                          E6     13  00CE 26000 	BEQL	RETURN			; IF EQL NO
                                     00D0 26100 10$:
                                     00D0 26200 BADPARAM:
            50            00'    3C  00D0 26300 	MOVZWL	S^#SS$_BADPARAM,R0	; BAD PARAMETER
                                     00D3 26400 CONTROL_ERROR:
       0000'CF            50     D0  00D3 26500 	MOVL	R0,W^NET$GQ_USR_STAT	; STUFF THE STATUS
                                 04  00D8 26600 	RET				; DONE
                                     00D9 26700 
                                     00D9 26800 	.DSABL	LSB
                                     00D9 26900 
                                     00D9 27000 ;++
                                     00D9 27100 ;
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   8
X01             UTILITY ROUTINES                                                                                                 (1)

                                     00D9 27200 ; NET$CTL_FNDNDB - FINDS NDB ASSOCIATED WITH NAME POINTED TO BY NET$GL_NAME_PTR
                                     00D9 27300 ; NET$FND_NDB_NAM - SAME, BUT NAME LENGTH IS NOT CHECKED
                                     00D9 27400 ;
                                     00D9 27500 ; INPUTS:	NET$GL_NAME_PTR - ADDRESS OF COUNTED ASCII NODENAME
                                     00D9 27550 ;		R6 -			DITTO (NET$FND_NDB_NAM)
                                     00D9 27600 ;
                                     00D9 27700 ; OUTPUTS:	R9 - NDB ADDRESS, OR 0 ; CONDITION CODES REFLECT R9
                                     00D9 27800 ;
                                     00D9 27900 ;--
                                     00D9 28000 
                                     00D9 28100 NET$CTL_FNDNDB::
                          DC     10  00D9 28200 	BSBB	NET$CTL_CHKNAM		; SEE IF NAME IS OK
                                     00DB 28300 
                                     00DB 28400 NET$FND_NDB_NAM::
                       FD'AF     9F  00DB 28500 	PUSHAB	B^NET$CTL_NEXTNDB	; INIT FOR COROUTINE CALL
                                     00DE 28600 10$:
                          9E     16  00DE 28700 	JSB	@(SP)+			; GET THE NEXT NDB
                          0C     13  00E0 28800 	BEQL	20$			; IF EQL ERROR
            57         1A A9     9E  00E2 28900 	MOVAB	NDB$T_NAME(R9),R7	; SET TO COMPARE NAMES
                          FF17'  30  00E6 29000 	BSBW	NET$COMP_STRING		; COMPARE NAMES
                          F3     12  00E9 29100 	BNEQ	10$			; IF NEQ NOT A MATCH
            8E            59     D0  00EB 29200 	MOVL	R9,(SP)+		; CLEAN UP THE STACK AND SET CONDITION CODES
                                     00EE 29300 20$:
                                 05  00EE 29400 	RSB				; RETURN
                                     00EF 29500 
                                     00EF 29600 
                                     00EF 29700 ;++
                                     00EF 29800 ;
                                     00EF 29900 ; NET$CTL_MOV_NAM - CHECKS BUFFER, UPDATES COUNTS AND MOVES NAME INTO BFR
                                     00EF 30000 ; NET$CTL_MOV_PTH - SAME, BUT R1 SET UP FOR SOURCE STRING
                                     00EF 30100 ;
                                     00EF 30200 ; INPUTS:	R1 - SOURCE STRING ADDRESS (NET$CTL_MOV_PTH)
                                     00EF 30300 ;		R3 - TARGET BUFFER ADDRESS
                                     00EF 30400 ;		R9 - NDB ADDRESS (NET$CTL_MOV_NAM)
                                     00EF 30500 ;
                                     00EF 30600 ;--
                                     00EF 30700 
                                     00EF 30800 NET$CTL_MOV_NAM::
            51         1A A9     9E  00EF 30900 	MOVAB	NDB$T_NAME(R9),R1	; GET ADDRESS OF COUNTED STRING NAME
                                     00F3 31000 
                                     00F3 31100 NET$CTL_MOV_PTH::
            5A            61     9A  00F3 31200 	MOVZBL	(R1),R10		; GET THE LENGTH OF THE STRING
                          5A     D6  00F6 31300 	INCL	R10			; ACCOUNT FOR COUNT BYTE
                          9A     10  00F8 31400 	BSBB	NET$CTL_UPD_CNT		; FIX COUNTS
                          FF03'  31  00FA 31500 	BRW	NET$MOVE_STRING		; MOVE THE STRING TO THE BUFFER AND RETURN
                                     00FD 31600 
                                     00FD 31700 
                                     00FD 31800 ;++
                                     00FD 31900 ;
                                     00FD 32000 ; NET$CTL_NEXTNDB - COROUTINE TO FIND THE NEXT NDB
                                     00FD 32100 ;
                                     00FD 32200 ; INPUTS:	R9 POINTS AT AN NDB (EXCEPT INITIAL CALL)
                                     00FD 32300 ;
                                     00FD 32400 ; OUTPUTS:	R9 CONTAINS NEXT NDB ADDRESS OR 0
                                     00FD 32500 ;		CONDITION CODES REFLECT R9 VALUE
                                     00FD 32600 ;
                                     00FD 32700 ;--
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page   9
X01             UTILITY ROUTINES                                                                                                 (1)

                                     00FD 32800 
                                     00FD 32900 NET$CTL_NEXTNDB::
            59       0000'CF     9E  00FD 33000 	MOVAB	W^NET$GL_NODLST-NDB$L_NEXT,R9 ; SEED SEARCH
                                     0102 33100 10$:
            59            69     D0  0102 33200 	MOVL	NDB$L_NEXT(R9),R9	; GET NEXT NDB ADDRESS
                          16     13  0105 33300 	BEQL	GOBACK			; IF EQL NONE - TERMINATE
                          9E     16  0107 33400 	JSB	@(SP)+			; CALL BACK THE CALLER
                          F7     11  0109 33500 	BRB	10$			; LOOP
                                     010B 33600 
                                     010B 33700 
                                     010B 33800 ;++
                                     010B 33900 ; NET$CTL_NDBLINE - FIND NDB BY LINE NAME
                                     010B 34000 ;
                                     010B 34100 ; INPUTS:	NET$GL_NAME_PTR - ADDRESS OF LINE NAME
                                     010B 34200 ;
                                     010B 34300 ; OUTPUTS:	R9 - NDB ADDRESS OR 0 IF NONE; CONDITION CODES REFLECT R9
                                     010B 34400 ;
                                     010B 34500 ;--
                                     010B 34600 
                                     010B 34700 NET$CTL_NDBLINE::
                       EF AF     9F  010B 34800 	PUSHAB	B^NET$CTL_NEXTNDB	; INIT FOR COROUTINE CALL
                                     010E 34900 10$:
                          9E     16  010E 35000 	JSB	@(SP)+			; GET THE NEXT NDB
                          0B     13  0110 35100 	BEQL	GOBACK			; IF EQL DONE
       0014'DF         04 A9     D1  0112 35200 	CMPL	NDB$L_LINE_NAME(R9),@W^NET$GL_NAME_PTR ; IS THAT THE NAME?
                          F4     12  0118 35300 	BNEQ	10$			; IF NEQ NO
            8E            59     D0  011A 35400 	MOVL	R9,(SP)+		; SET THE CONDITION CODES AND CLEAR STACK
                                 05  011D 35500 GOBACK:	RSB				; DONE
                                     011E 35600 
                                     011E 35700 
                                     011E 35800 ;++
                                     011E 35900 ; NET$CTL_CHKPRV - CHECK PROCESS'S PRIVILEGE TO PERFORM FUNCTION
                                     011E 36000 ;
                                     011E 36100 ; INPUTS:	R0 - BIT POSITION OF (SINGLE) PRIVILEGE BIT
                                     011E 36200 ;		R3 - IRP ADDRESS
                                     011E 36300 ;
                                     011E 36400 ; COMPLETION CODE - SS$_NOPRIV - PRIVILEGE BIT NOT SET
                                     011E 36500 ;
                                     011E 36600 ;--
                                     011E 36700 
                                     011E 36800 NET$CTL_CHKPRV::
         3C A3            50     E0  011E 36900 	BBS	R0,IRP$Q_NT_PRVMSK(R3),GOBACK ; IF BS THEN PRIVILEGE IS THERE
                          FA         0122       
            50            00'    3C  0123 37000 	MOVZWL	S^#SS$_NOPRIV,R0	; SET THE ERROR
                          AB     11  0126 37100 	BRB	CONTROL_ERROR		; POST THE ERROR
                                     0128 37200 
                                     0128 37300 
                                     0128 37400 ;++
                                     0128 37500 ; NET$CTL_SET_OFF - SET STATE OF A LINE OFF
                                     0128 37600 ;
                                     0128 37700 ; INPUTS:	R9 - NDB ADDRESS
                                     0128 37800 ;
                                     0128 37900 ;--
                                     0128 38000 
                                     0128 38100 NET$CTL_SET_OFF::
         17 A9            01     E2  0128 38200 	BBSS	#NDB$V_OFF,NDB$B_STATUS(R9),GOBACK ; IF BS, ALREADY OFF
                          F0         012C       
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page  10
X01             UTILITY ROUTINES                                                                                                 (1)

       0000'CF         14 A9     B0  012D 38300 	MOVW	NDB$W_CHANNEL(R9),W^NET$GW_CHANNEL ; SET UP CHANNEL NO.
                          E8     13  0133 38400 	BEQL	GOBACK			; IF EQL NOTHING MORE TO DO
                          FEC8'  31  0135 38500 	BRW	NET$CHECK_LINEA		; SEE IF ANY CONNECTS ON THIS LINE AND RETURN
                                     0138 38600 
                                     0138 38700 	.END
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page  11
SYMBOL TABLE                                                                                                                     (1)

ABD$C_ATTRIB   = 00000005            IRP$M_SWAPIO   = 00000040            NDB$L_NEXT       00000000            
ABD$C_FIB      = 00000001            IRP$M_VIRTUAL  = 00000010            NDB$M_CTL_LOOP = 00000008            
ABD$C_LENGTH     00000008            IRP$Q_NT_PRVMSK  0000003C            NDB$M_LOOPBACK = 00000001            
ABD$C_NAME     = 00000002            IRP$S_FCODE    = 00000006            NDB$M_OFF      = 00000002            
ABD$C_RES      = 00000004            IRP$S_FMOD     = 0000000A            NDB$M_SHUT     = 00000004            
ABD$C_RESL     = 00000003            IRP$S_MODE     = 00000002            NDB$Q_AST        0000000C            
ABD$C_WINDOW   = 00000000            IRP$V_BUFIO    = 00000000            NDB$Q_ZEROTIME   000000AC            
ABD$K_LENGTH     00000008            IRP$V_CHAINED  = 00000005            NDB$T_NAME       0000001A            
ABD$L_USERVA     00000004            IRP$V_COMPLX   = 00000003            NDB$T_SYSVER     0000002E            
ABD$W_COUNT      00000002            IRP$V_DIAGBUF  = 00000007            NDB$V_CTL_LOOP = 00000003            
ABD$W_TEXT       00000000            IRP$V_FCODE    = 00000000            NDB$V_LOOPBACK = 00000000            
BADPARAM         000000D0 R     04   IRP$V_FMOD     = 00000006            NDB$V_OFF      = 00000001            
BIT...         = 00000000            IRP$V_FUNC     = 00000001            NDB$V_SHUT     = 00000002            
CCB$B_AMOD       00000009            IRP$V_MBXIO    = 0000000A            NDB$W_BLKSIZE    00000022            
CCB$B_STS        00000008            IRP$V_MODE     = 00000000            NDB$W_BUFSIZE    000000A8            
CCB$C_LENGTH     00000010            IRP$V_PAGIO    = 00000002            NDB$W_CHANNEL    00000014            
CCB$K_LENGTH     00000010            IRP$V_PHYSIO   = 00000008            NDB$W_CHAR       000000AA            
CCB$L_DIRP       0000000C            IRP$V_PRIVIO   = 00000009            NDB$W_HISBLKSIZ  000000B8            
CCB$L_UCB        00000000            IRP$V_SWAPIO   = 00000006            NDB$W_HISNSPSIZ  000000BA            
CCB$L_WIND       00000004            IRP$V_VIRTUAL  = 00000004            NDB$W_MAXLNK     00000026            
CCB$W_IOC        0000000A            IRP$W_ABCNT      0000003C            NDB$W_NODEADDR   00000018            
CONTROL_ERROR    000000D3 R     04   IRP$W_BCNT       00000032            NDB$W_NSPSIZE    00000024            
DISPATCH         00000055 R     04   IRP$W_BOFF       00000030            NDB$W_RCVBLKS    000000B4            
GBL...         = 00000000            IRP$W_CHAN       00000028            NDB$W_SIZE       00000008            
GOBACK           0000011D R     04   IRP$W_FUNC       00000020            NDB$W_XMTBLKS    000000B6            
IRP$B_CARCON     00000038            IRP$W_OBCNT      0000003E            NET$CHECK_LINEA  ********   X   04   
IRP$B_EFN        00000022            IRP$W_SIZE       00000008            NET$CLR_LIN_CTR  ********   X   04   
IRP$B_PRI        00000023            IRP$W_STS        0000002A            NET$CLR_LOC_CTR  ********   X   04   
IRP$B_RMOD       0000000B            IRP$W_TT_PRMPT   0000003C            NET$COMP_STRING  ********   X   04   
IRP$B_TYPE       0000000A            NDB$B_COMMVER    0000002B            NET$CONTROL_QIO  00000000 RG    04   
IRP$C_LENGTH     0000004C            NDB$B_CONNTMO    0000004F            NET$CTL_CHKNAM   000000B7 RG    04   
IRP$K_LENGTH     0000004C            NDB$B_FUNC       00000021            NET$CTL_CHKPRV   0000011E RG    04   
IRP$L_AST        00000010            NDB$B_NONPRVACC  00000050            NET$CTL_FNDNDB   000000D9 RG    04   
IRP$L_ASTPRM     00000014            NDB$B_NUMBUF     0000000B            NET$CTL_MOV_NAM  000000EF RG    04   
IRP$L_DIAGBUF    00000044            NDB$B_PRVACC     0000007C            NET$CTL_MOV_PTH  000000F3 RG    04   
IRP$L_IOQBL      00000004            NDB$B_RTEVER     00000028            NET$CTL_NDBLINE  0000010B RG    04   
IRP$L_IOQFL      00000000            NDB$B_STATE      00000016            NET$CTL_NEXTNDB  000000FD RG    04   
IRP$L_IOSB       00000024            NDB$B_STATUS     00000017            NET$CTL_SET_OFF  00000128 RG    04   
IRP$L_IOST1      00000034            NDB$B_TYPE       0000000A            NET$CTL_UPD_CNT  00000094 RG    04   
IRP$L_IOST2      00000038            NDB$C_CTL_LOOP = 00000005            NET$C_MAXNODLTH  ********   X   04   
IRP$L_MEDIA      00000034            NDB$C_LENGTH     000000BC            NET$DECLARE_NAM  ********   X   04   
IRP$L_PID        0000000C            NDB$C_LOOP     = 00000003            NET$DISC_LINK    ********   X   04   
IRP$L_SEGVBN     00000040            NDB$C_MAINT    = 00000004            NET$FND_NDB_NAM  000000DB RG    04   
IRP$L_SEQNUM     00000048            NDB$C_MSG_DCHK = 00000009            NET$GET_LINNAMS  ********   X   04   
IRP$L_SVAPTE     0000002C            NDB$C_MSG_DOWN = 00000003            NET$GET_LIN_CTR  ********   X   04   
IRP$L_TT_TERM    00000038            NDB$C_MSG_DSRCH= 00000007            NET$GET_LIN_STA  ********   X   04   
IRP$L_UCB        0000001C            NDB$C_MSG_LOOPB= 00000008            NET$GET_LNBYNOD  ********   X   04   
IRP$L_WIND       00000018            NDB$C_MSG_MAINT= 00000002            NET$GET_LOC_CTR  ********   X   04   
IRP$M_BUFIO    = 00000001            NDB$C_MSG_NGINI= 00000004            NET$GET_LOC_NAM  ********   X   04   
IRP$M_CHAINED  = 00000020            NDB$C_MSG_OKINI= 00000005            NET$GET_LOC_STA  ********   X   04   
IRP$M_COMPLX   = 00000008            NDB$C_MSG_SHUT = 00000006            NET$GET_LOGLNKS  ********   X   04   
IRP$M_DIAGBUF  = 00000080            NDB$C_MSG_START= 00000001            NET$GET_NAMENUM  ********   X   04   
IRP$M_FUNC     = 00000002            NDB$C_OFF      = 00000001            NET$GET_NODBYLN  ********   X   04   
IRP$M_MBXIO    = 00000400            NDB$C_ON       = 00000000            NET$GET_NODNAMS  ********   X   04   
IRP$M_PAGIO    = 00000004            NDB$C_SHUT     = 00000002            NET$GET_NUMNAME  ********   X   04   
IRP$M_PHYSIO   = 00000100            NDB$K_LENGTH     000000BC            NET$GET_VERSION  ********   X   04   
IRP$M_PRIVIO   = 00000200            NDB$L_LINE_NAME  00000004            NET$GL_NAME_LTH  00000010 RG    03   
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page  12
SYMBOL TABLE                                                                                                                     (1)

NET$GL_NAME_PTR  00000014 RG    03   UCB$L_DDB        00000024            UCB$M_UNLOAD   = 00001000            
NET$GL_NODLST    ********   X   04   UCB$L_DEVCHAR    00000034            UCB$M_VALID    = 00000800            
NET$GL_RES_LTH   00000000 RG    03   UCB$L_DEVDEPEND  0000003C            UCB$S_LNKPRI   = 00000002            
NET$GL_RES_PTR   00000004 RG    03   UCB$L_DPC        00000080            UCB$S_LTYPE    = 00000002            
NET$GQ_USR_STAT  ********   X   04   UCB$L_DUETIM     0000005C            UCB$T_PARTNER    0000000C            
NET$GW_CHANNEL   ********   X   04   UCB$L_DX_BFPNT   0000009C            UCB$V_BACKP    = 00000005            
NET$GW_CTLCOUNT  00000020 RG    03   UCB$L_DX_BUF     00000098            UCB$V_BSY      = 00000008            
NET$IODONE       ********   X   04   UCB$L_DX_RXDB    000000A0            UCB$V_CANCEL   = 00000003            
NET$MOVE_STRING  ********   X   04   UCB$L_EMB        00000078            UCB$V_DEADMO   = 0000000A            
NET$SET_LIN_STA  ********   X   04   UCB$L_FIRST      00000014            UCB$V_DELMBX   = 00000001            
NET$SET_LOC_STA  ********   X   04   UCB$L_FPC        0000000C            UCB$V_DIAGBUF  = 00000001            
NET$UPD_OBJECT   ********   X   04   UCB$L_FQBL       00000004            UCB$V_DX_WRITE = 00000003            
NET$UPD_REMOTE   ********   X   04   UCB$L_FQFL       00000000            UCB$V_ECC      = 00000000            
NET_MINPATH    = 00000004            UCB$L_FR3        00000010            UCB$V_ERLOGIP  = 00000002            
NFB_LTH          00000018 R     03   UCB$L_FR4        00000014            UCB$V_INT      = 00000001            
NFB_PTR          0000001C R     03   UCB$L_IOQBL      00000044            UCB$V_INTTYPE  = 00000007            
RESL_LTH         00000008 R     03   UCB$L_IOQFL      00000040            UCB$V_JOB      = 00000000            
RESL_PTR         0000000C R     03   UCB$L_IRP        0000004C            UCB$V_LNKPRI   = 00000006            
RESULTOVF        0000009B R     04   UCB$L_LINK       0000002C            UCB$V_LTYPE    = 00000000            
RETURN           000000B6 R     04   UCB$L_LOGADR     00000064            UCB$V_MOUNTING = 00000009            
SS$_BADPARAM     ********   X   04   UCB$L_MAXBLOCK   00000084            UCB$V_MSGACK   = 00000004            
SS$_ILLCNTRFUNC  ********   X   04   UCB$L_MEDIA      0000008C            UCB$V_MSGFLO   = 00000003            
SS$_NOPRIV       ********   X   04   UCB$L_NT_DATSSB  00000074            UCB$V_NOCNVRT  = 00000002            
SS$_NORMAL       ********   X   04   UCB$L_NT_INTSSB  00000078            UCB$V_NT_BFROVF= 00000002            
SS$_RESULTOVF    ********   X   04   UCB$L_OPCNT      00000060            UCB$V_NT_BREAK = 00000005            
UCB$B_AMOD       00000053            UCB$L_OWNUIC     0000001C            UCB$V_NT_NAME  = 00000004            
UCB$B_CEX        00000077            UCB$L_PID        00000028            UCB$V_ONLINE   = 00000004            
UCB$B_CM1        0000004A            UCB$L_RQBL       00000004            UCB$V_POWER    = 00000005            
UCB$B_CM2        0000004B            UCB$L_RQFL       00000000            UCB$V_PRMMBX   = 00000000            
UCB$B_DEVCLASS   00000038            UCB$L_SVAPTE     00000068            UCB$V_SEGFLO   = 00000002            
UCB$B_DEVTYPE    00000039            UCB$L_SVPN       00000064            UCB$V_TIM      = 00000000            
UCB$B_DIPL       00000052            UCB$L_TTCHAR     0000003C            UCB$V_TIMOUT   = 00000006            
UCB$B_DX_SCTCNT  000000A6            UCB$L_VCB        00000030            UCB$V_TT_NOTIF = 00000002            
UCB$B_ERTCNT     00000070            UCB$M_BACKP    = 00000020            UCB$V_TT_TIMO  = 00000001            
UCB$B_ERTMAX     00000071            UCB$M_BSY      = 00000100            UCB$V_UNLOAD   = 0000000C            
UCB$B_ESCAPE     0000004B            UCB$M_CANCEL   = 00000008            UCB$V_VALID    = 0000000B            
UCB$B_FEX        00000076            UCB$M_DEADMO   = 00000400            UCB$W_BCNT       0000006E            
UCB$B_FIPL       0000000B            UCB$M_DELMBX   = 00000002            UCB$W_BCR        00000096            
UCB$B_LOCSRV     0000003C            UCB$M_DIAGBUF  = 00000002            UCB$W_BOFF       0000006C            
UCB$B_OFFNDX     00000094            UCB$M_DX_WRITE = 00000008            UCB$W_BUFQUO     00000018            
UCB$B_OFFRTC     00000095            UCB$M_ECC      = 00000001            UCB$W_BYTESTOGO  0000003E            
UCB$B_REMSRV     0000003D            UCB$M_ERLOGIP  = 00000004            UCB$W_CHARGE     0000004A            
UCB$B_SECTORS    0000003C            UCB$M_INT      = 00000002            UCB$W_CYLINDERS  0000003E            
UCB$B_SLAVE      00000074            UCB$M_INTTYPE  = 00000080            UCB$W_DA         0000008C            
UCB$B_SPR        00000075            UCB$M_JOB      = 00000001            UCB$W_DC         0000008E            
UCB$B_STATE      00000052            UCB$M_MOUNTING = 00000200            UCB$W_DEVBUFSIZ  0000003A            
UCB$B_TRACKS     0000003D            UCB$M_NOCNVRT  = 00000004            UCB$W_DEVSTS     0000005A            
UCB$B_TYPE       0000000A            UCB$M_NT_BFROVF= 00000004            UCB$W_DIRSEQ     00000088            
UCB$B_VERTSZ     0000003F            UCB$M_NT_BREAK = 00000020            UCB$W_DSTADDR    00000018            
UCB$C_LENGTH     00000074            UCB$M_NT_NAME  = 00000010            UCB$W_DX_BCR     000000A4            
UCB$C_LOGLNK   = 00000001            UCB$M_ONLINE   = 00000010            UCB$W_EC1        00000090            
UCB$K_LENGTH     00000074            UCB$M_POWER    = 00000020            UCB$W_EC2        00000092            
UCB$L_AMB        00000054            UCB$M_PRMMBX   = 00000001            UCB$W_ERRCNT     00000072            
UCB$L_ASTQBL     00000010            UCB$M_TIM      = 00000001            UCB$W_FUNC       0000007E            
UCB$L_ASTQFL     0000000C            UCB$M_TIMOUT   = 00000040            UCB$W_MB_SEED    FFFFFFFC            
UCB$L_CPID       0000005C            UCB$M_TT_NOTIF = 00000004            UCB$W_MSGCNT     00000016            
UCB$L_CRB        00000020            UCB$M_TT_TIMO  = 00000002            UCB$W_MSGMAX     00000014            
NETCTLQIO       - DISPATCH ACP CONTROL QIO'S                     22-AUG-1978 00:53:13   VAX-11 MACRO X0.3-11               Page  13
SYMBOL TABLE                                                                                                                     (1)

UCB$W_NT_CHAN    0000007C            
UCB$W_OFFSET     0000008A            
UCB$W_REFC       00000050            
UCB$W_SIZE       00000008            
UCB$W_SRCADDR    0000001A            
UCB$W_STS        00000058            
UCB$W_UNIT       00000048            
UCB$W_VPROT      0000001A            
UNUSED           0000008C R     04   


PROGRAM SECTION SYNOPSIS

.  ABS  .        00000000      00     NOPIC   USR   CON   ABS   LCL NOSHR NOEXE NORD  NOWRT BYTE  
. BLANK .        00000000      01     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD    WRT BYTE  
$ABS$            FFFFFFFE      02     NOPIC   USR   CON   ABS   LCL NOSHR   EXE   RD    WRT BYTE  
NET_IMPURE       00000022      03     NOPIC   USR   CON   REL   LCL NOSHR NOEXE   RD    WRT BYTE  
NET_CONTROL      00000138      04     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD  NOWRT BYTE  


THERE WERE NO ERRORS OR WARNINGS.
16032. BYTES LEFT IN FREE MEMORY POOL.
2200. BYTES OF RECLAIMED MEMORY.
OBJ$:NETCTLQIO,LIS$:NETCTLQIO/-SP=EXECML$/ML,M1/ML,M2/ML,SRC$:NETCTLQIO
52 MLB DIR RDS - 541 GETS TO DEFINE 17 MACROS. 33 INTER. FILE WRITES. 
