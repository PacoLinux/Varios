
; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 1
; Digital Equipment Corporation
;
;00100  0001	MODULE LNK_MAIN (IDENT='X01.20',MAIN=LNK$START) =
;00200  0002	
;00300  0003	BEGIN
;00400  0004	!
;00500  0005	!
;00600  0006	! Copyright (C) 1976, 1977, 1978
;00700  0007	! Digital Equipment Corporation,  Maynard, Massachusetts  01754
;00800  0008	!
;00900  0009	! This software is furnished under a license for use only on  a
;01000  0010	! single computer system and may be copied only with the inclu-
;01100  0011	! sion of the above copyright notice.  This  software,  or  any
;01200  0012	! other  copies  thereof, may not be provided or otherwise made
;01300  0013	! available to any other person except for use on  such  system
;01400  0014	! and  to  one who agrees to these license terms.  Title to and
;01500  0015	! ownership of the software shall at all times remain in DEC.
;01600  0016	!
;01700  0017	! The information in this software is subject to change without
;01800  0018	! notice and should not be construed as a commitment by Digital
;01900  0019	! Equipment Corporation.
;02000  0020	!
;02100  0021	! DEC assumes no responsibility for the use or  reliability  of
;02200  0022	! its software on equipment which is not supplied by DEC.
;02300  0023	!
;02400  0024	!
;02500  0025	!
;02600  0026	!
;02700  0027	!
;02800  0028	!++
;02900  0029	!
;03000  0030	! MODULE: LNK_MAIN
;03100  0031	!
;03200  0032	! FACILITY: LINKER
;03300  0033	!
;03400  0034	! ABSTRACT:	THIS IS THE MAINLINE CONTROL ROUTINE WHICH CALLS EVERYTHING ELSE
;03500  0035	!
;03600  0036	! HISTORY:
;03700  0037	!
;03800  0038	!	VERSION: X01.00
;03900  0039	!
;04000  0040	!	AUTHOR: T.J. PORTER 03-JAN-77
;04100  0041	!
;04200  0042	!	MODIFICATIONS:
;04300  0043	!
;04400  0044	! NO.	DATE		PROGRAMMER	PURPOSE
;04500  0045	! ---	----		----------	-------
;04600  0046	! 001	26-JUN-77	T.J. PORTER	DEFINE EXIT CODES
;04700  0047	! 002	27-JUN-77	T.J. PORTER	GATHER TIMINGS
;04800  0048	! 003	18-JUL-77	T.J. PORTER	ADD CPU TIMES AND PAGE FAULTS TO STATISTICS
;04900  0049	! 004	13-SEP-77	T.J. PORTER	ADD OPTION FILE PROCESSING
;05000  0050	! 005	19-SEP-77	T.J. PORTER	REMOVE LIMIT ON IMAGE SIZE
;05100  0051	! 006	20-OCT-77	T.J. PORTER	BUGS, SYMBOLIC BASE ADDRESS, DEBUG SUPPRESION
;05200  0052	!						/FULL QUALIFIER, IMAGE HEADER UPDATE
;05300  0053	!						IMAGE NAME + IDENT.,
;05400  0054	!						P-SECT AND OFFSET IN TRUNC. ERRORS
;05500  0055	! 007	01-DEC-77	T.J. PORTER	ACCESS VIOL. ON STB WITH NO IMAGE

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 1-1
; Digital Equipment Corporation
;
;05600  0056	!						INFINITE LOOP IN CRF
;05700  0057	! 008			T.J. PORTER	RE-WORK DEFAULT MAP, NO P-SECTS BUG
;05800  0058	!						SHAREABLE IMAGE ALLOCATION
;05900  0059	!						AND USE GETJPI FOR CPU TIMES AND FAULTS
;06000  0060	! 009	06-FEB-78	T.J. PORTER	DEBUG/TRACEBACK DATA SEPARATION
;06100  0061	!						AND MORE OPTIONS.
;06200  0062	! 010	18-MAR-78	T.J. PORTER	IOSEG AND STACK OPTIONS
;06300  0063	! 011	30-MAR-78	T.J. PORTER	NRL SPR. BUG IF MODULE IN A CONCATENATED
;06400  0064	!						OBJ HAS NO BINARY
;06500  0065	! 012	18-APR-78	T.J. PORTER	CONVERT TO NATIVE BLISS-32 COMPILER
;06600  0066	!						WITH NO OTHER CHANGES
;06700  0067	! 013	20-APR-78	T.J. PORTER	REQUIRE FILE CLEAN UP AND ADD THE
;06800  0068	!						LOGIC FOR SUPPRESSION OF UNINITIALIZED
;06900  0069	!						PAGES OF IMAGE
;07000  0070	! 014	16-MAY-78	T.J. PORTER	IMAGE STORE ERROR BUG FIX
;07100  0071	! 015	14-MAY-78	T.J. PORTER	SHAREABLE IMAGE INPUT AS CLUSTERS
;07200  0072	! 016	08-JUN-78	T.J. PORTER	FIX BUGS IN ARGUMENT CO-ERCION
;07300  0073	! 017	16-JUN-78	K.D. MORSE	ADD LOGIC FOR ERROR MESSAGES IN FILE
;07400  0074	! 018	16-JUL-78	T.J. PORTER	RELEASE IN HOUSE
;07500  0075	! 019	25-JUL-78	T.J. PORTER	COPY SHAREABLE IMAGES AND
;07600  0076	!						FIX VARIOUS BUGS
;07610  0077	! 020	01-AUG-78	T.J. PORTER	SOLVE SELECTIVE VMSRTL PROBLEM
;07700  0078	!--
;07800  0079	     
;00200  0081	!
;00300  0082	!++
;00400  0083	!
;00500  0084	! FUNCTIONAL DESCRIPTION:
;00600  0085	!
;00700  0086	!
;00800  0087	! THIS MODULE CONTAINS THE MAINLINE AND THE TERMINATION ROUTINE
;00900  0088	! OF THE LINKER.
;01000  0089	!
;01100  0090	!--
;01200  0091	!
;01300  0092	LIBRARY
;01400  0093		'SYS$LIBRARY:LIB.L32';			! SYSTEM SERVICES MACROS
;01500  0094	REQUIRE
;01600  0095		'PREFIX';		! VARIABLES, MACROS ETC.
;01700  0287	REQUIRE
;01800  0288		'DATBAS';		! INTERNAL DATA BASE
;01900  0520	!
;02000  0521	FORWARD ROUTINE
;02100  0522		LNK$EXIT : NOVALUE;			! TERMINATION ROUTINE
;02200  0523	!
;02300  0524	EXTERNAL ROUTINE
;02400  0525		!**PCHISTB,
;02500  0526		!**PCHISTE,
;02600  0527		LNK$CLOSCURFIL,				! CLOSE THE CURRENT OBJ FILE
;02700  0528		LNK$CLOSMAPFIL,				! CLOSE THE MAP FILE
;02800  0529		LNK$CLOSIMGFIL,				! CLOSE THE IMAGE FILE
;02900  0530		LNK$CLOSERRFIL,				! CLOSE THE ERROR MESSAGE FILE
;03000  0531		LNK$CLOSYMOUT,				! CLOSE SYMBOL TABLE OUTPUT
;03100  0532		LNK$IMGINIT,				! INITIALIZATION OF IMAGE IN MEMORY
;03200  0533		LNK$INIT,				! INITIALIZATION ROUTINE

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2
; Digital Equipment Corporation
;
;03300  0534		LNK$FLUSHIMG,				! WRITE AND COMPRESS THE IMAGE FILE
;03400  0535		LNK$GETCMD,				! GET COMMAND PARAMETERS
;03500  0536		LNK$MAPINIT,				! INITILIZE THE MAP OUTPUT
;03600  0537		LNK$MAPISCTS,				! MAP IMAGE SECTIONS
;03700  0538		LNK$MAPPSCTS,				! MAP THE P-SECTIONS
;03800  0539		LNK$MAPSTATS,				! OUTPUT THE STATISTICS
;03900  0540		LNK$MAPSYMS,				! MAP THE SYMBOL TABLE
;04000  0541		LNK$OBJPASS1,				! OBJECT MODULE PASS 1
;04100  0542		LNK$OBJPASS2,				! AND PASS 2
;04200  0543		LNK$SYMTBLOUT,				! OUTPUT SYMBOL TABLES
;04300  0544		LNK$VMALLO,				! VIRTUAL MEMORY ALLOCATION AND RELOCATION
;04400  0545		LNK$WRTIMGHDR;				! WRITE THE IMAGE HEADER BLOCK(S)
;04500  0546	!
;04600  0547	EXTERNAL LITERAL
;04700  0548		LNK$S_IMAGE : SHORT,			! PRODUCE AN IMAGE FLAG
;04800  0549		LNK$S_MAP : SHORT,			! PRODUCE A MAP FLAG
;04900  0550		LNK$S_MAPOPN : SHORT;			! FLAG THAT MAP IS STILL OPEN
;05000  0551	!
;05100  0552	EXTERNAL
;05200  0553		LNK$GB_PASS : BYTE,			! PASS NUMBER
;05300  0554		LNK$GB_MAXERCOD : BYTE,			! RECORDED ERROR CODE
;05400  0555		LNK$GL_CTLMSK;				! CONTROL MASK
;05500  0556	!
;05600  0557	GLOBAL LITERAL
;05700  0558		LNK$_SUBSYSNUM = 100;			! SUB SYSTEM NUMBER ASSIGNED FOR LINKER
;05800  0559	LITERAL
;05900  0560		INFOR = 3,
;06000  0561		WARN  = 0,
;06100  0562		ERROR = 2,
;06200  0563		FATAL = 4,
;06300  0564		MASK  = LNK$_SUBSYSNUM^16 + 1^15;
;06400  0565	EXTERNAL LITERAL
;06500  0566		LNK$_TMPBUGCHK,				! TEMPORARY BUG CHECK EXIT
;06600  0567		LNK$_INITFAIL,				! INITIALIZATION FAILURE
;06700  0568		LNK$_ERRORFILE,				! UNABLE TO OPEN ERROR OUTPUT FILE
;06800  0569		LNK$_FATALERROR,			! FATAL ERROR MESSAGE ISSUED.
;06900  0570		LNK$_BADIMGSYM,				! IMAGE FILE AND/OR STB FILE CORRUPT
;07000  0571		LNK$_DIAGSISUED;			! COMPLETED BUT WITH DIAGNOSTICS
;07100  0572	!
;07200  0573	GLOBAL
;07300  0574		LNK$AW_VERSION : BLOCK[LID$C_SIZE,BYTE]	! LINKER VERSION ARRAY
;07400  0575				    INITIAL(INIT_LID(	! INITIALIZE IT TO
;07500P 0576					%ASCII '01',	! CURRENT VERSION
;07600P 0577					%ASCII '20')),	! AND ALTERATION NUMBER
;07700  0578	!
;07800  0579	! STARTING REAL TIMES:
;07900  0580	!
;08000  0581		LNK$GQ_STARTIM : VECTOR[2],		! START TIME
;08100  0582		LNK$GQ_PS1STIM : VECTOR[2],		! PASS 1 START TIME
;08200  0583		LNK$GQ_ALOSTIM : VECTOR[2],		! ALLOCATION PHASE START TIME
;08300  0584		LNK$GQ_PS2STIM : VECTOR[2],		! PASS 2 START TIME
;08400  0585		LNK$GQ_MAPSTIM : VECTOR[2],		! REMAINDER OF MAP BEGINS
;08500  0586		LNK$GQ_STBSTIM : VECTOR[2],		! SYMBOL TABLE OUTPUT BEGINS
;08600  0587	!
;08700  0588	! CPU TIMES:

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-1
; Digital Equipment Corporation
;
;08800  0589	!
;08900  0590		LNK$GL_CPUSTIM,				! CPU TIME AT THE START OF LINK
;09000  0591		LNK$GL_PS1CPUT,				! PASS 1 CPU TIME (AT THE START)
;09100  0592		LNK$GL_ALOCPUT,				! ALLOCATION PHASE CPU TIME
;09200  0593		LNK$GL_PS2CPUT,				! PASS 2 CPU TIME
;09300  0594		LNK$GL_MAPCPUT,				! MAP OUTPUT CPU TIME
;09400  0595		LNK$GL_STBCPUT,				! SYMBOL TABLE OUTPUT CPU TIME
;09500  0596		LNK$GL_ENDCPUT,				! END CPU TIME
;09600  0597	!
;09700  0598	! PAGE FAULT COUNTS:
;09800  0599	!
;09900  0600		LNK$GL_SPAGFLTS,			! PAGE FAULT COUNT AT START OF LINK
;10000  0601		LNK$GL_PS1FLTS,				! PAGE FAULT COUNT AT START OF PASS 1
;10100  0602		LNK$GL_ALOFLTS,				! DURING ALLOCATION/RELOCATION
;10200  0603		LNK$GL_PS2FLTS,				! PASS 2 PAGE FAULTS
;10300  0604		LNK$GL_MAPFLTS,				! MAP OUTPUT PAGE FAULTS
;10400  0605		LNK$GL_STBFLTS,				! SYMBOL TABLE OUTPUT PAGE FAULT COUNT
;10500  0606		LNK$GL_ENDFLTS;				! END PAGE FAULTS
;10600  0607	!
;10700  0608	GLOBAL ROUTINE LNK$START(ARGLIST) : NOVALUE =
;10800  0609	BEGIN
;10900  0610	!
;11000  0611	!	THIS IS THE MAIN ROUTINE OF THE LINKER, ITS PURPOSE
;11100  0612	!	BEING MERELY TO CALL THE ROUTINES THAT DO
;11200  0613	!	ALL THE WORK AND TO MONITOR THE PERFORMANCE OF EACH.
;11300  0614	!		ARGLIST IS THE ARGUMENT LIST PROVIDED ON ACTIVATION
;11400  0615	!		BY CLI. IT CONTAINS (AT OFFSET CLI$A_UTILSERV)
;11500  0616	!		THE CLI RE-CALL ADDRESS REQUIRED FOR OBTAINING
;11600  0617	!		THE COMMAND PARAMETERS.
;11700  0618	!
;11800  0619	OWN	PASS1 : DESCRIPTOR('	PASS 1'),
;11900  0620		PASS2 : DESCRIPTOR('	PASS 2'),
;12000  0621		MAPDAT : DESCRIPTOR('	MAP AFTER OBJ LIST'),
;12100  0622		CURCPUTIM,				! CPU TIME BUFFER
;12200  0623		CURPAGEFLTS,				! PAGE FAULT COUNT BUFFER
;12300  0624		DATALIST : BLOCK[7] INITIAL(		! ITEM DESCRIPTOR LIST
;12400  0625				WORD(4),WORD(JPI$_CPUTIM),	! LONGWORD OF CPU TIME
;12500  0626				LONG(CURCPUTIM),LONG(0),	!
;12600  0627				WORD(4),WORD(JPI$_PAGEFLTS),	! LONGWORD OF PAGE FAULTS
;12700  0628				LONG(CURPAGEFLTS),LONG(0),	!
;12800  0629				LONG(JPI$C_LISTEND));		! END OF ITEM DESCRIPTOR LIST
;12900  0630	!
;13000  0631	$GETTIM(TIMADR=LNK$GQ_STARTIM);				! GET START VALUES
;13100  0632	$GETJPI(ITMLST=DATALIST);
;13200  0633	LNK$GL_CPUSTIM = .CURCPUTIM;
;13300  0634	LNK$GL_SPAGFLTS = .CURPAGEFLTS;
;13400  0635	LNK$INIT();						! PERFORM INITIALIZATION
;13500  0636	LNK$GETCMD(ARGLIST-4);					! GO GET THE COMMAND PARAMETERS
;13600  0637								! WITH NO RETURN IF IN ERROR
;13700  0638	LNK$GB_PASS = 1;					! SET PASS NUMBER
;13800  0639	$GETTIM(TIMADR=LNK$GQ_PS1STIM);				! GET START VALUES FOR PASS 1
;13900  0640	$GETJPI(ITMLST=DATALIST);
;14000  0641	LNK$GL_PS1CPUT = .CURCPUTIM;
;14100  0642	LNK$GL_PS1FLTS = .CURPAGEFLTS;
;14200  0643	!**PCHISTB(PASS1);

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-2
; Digital Equipment Corporation
;
;14300  0644	LNK$OBJPASS1(ARGLIST-4);				! EXECUTE PASS1
;14400  0645	!**PCHISTE();
;14500  0646	$GETTIM(TIMADR=LNK$GQ_ALOSTIM);				! GET THE START VALUES OF ALLOCATION/RELOCATION PHASE
;14600  0647	$GETJPI(ITMLST=DATALIST);
;14700  0648	LNK$GL_ALOCPUT = .CURCPUTIM;
;14800  0649	LNK$GL_ALOFLTS = .CURPAGEFLTS;
;14900  0650	LNK$VMALLO();						! ALLOCATE VIRTUAL MEMORY
;15000  0651	IF .LNK$GL_CTLMSK<LNK$S_IMAGE,1,0>			! IF AN IMAGE IS REQUIRED
;15100  0652	THEN LNK$IMGINIT();					! GO GET IT STARTED
;15200  0653	IF .LNK$GL_CTLMSK<LNK$S_MAP,1,0>			! IF A MAP IS REQUIRED
;15300  0654	THEN LNK$MAPINIT();						! START THE MAP
;15400  0655	LNK$GB_PASS = 2;					! SET PASS 2
;15500  0656	$GETTIM(TIMADR=LNK$GQ_PS2STIM);				! GET START VALUES FOR PASS 2
;15600  0657	$GETJPI(ITMLST=DATALIST);
;15700  0658	LNK$GL_PS2CPUT = .CURCPUTIM;
;15800  0659	LNK$GL_PS2FLTS = .CURPAGEFLTS;
;15900  0660	!**PCHISTB(PASS2);
;16000  0661	LNK$OBJPASS2();						! EXECUTE PASS 2
;16100  0662	!**PCHISTE();
;16200  0663	IF .LNK$GL_CTLMSK<LNK$S_IMAGE,1,0>			! IF IMAGE PRODUCTION STILL ENABLED
;16300  0664	THEN LNK$FLUSHIMG();					! COMPRESS AND WRITE THE IMAGE FILE
;16400  0665	$GETTIM(TIMADR=LNK$GQ_MAPSTIM);				! START VALUES FOR BULK OF MAP OUTPUT
;16500  0666	$GETJPI(ITMLST=DATALIST);
;16600  0667	LNK$GL_MAPCPUT = .CURCPUTIM;
;16700  0668	LNK$GL_MAPFLTS = .CURPAGEFLTS;
;16800  0669	!**PCHISTB(MAPDAT);
;16900  0670	IF .LNK$GL_CTLMSK<LNK$S_MAPOPN,1,0>			! IF THE MAP IS STILL OPEN
;17000  0671	THEN BEGIN
;17100  0672		LNK$MAPISCTS();					! OUTPUT IMAGE SECTION SYNOPSIS
;17200  0673		LNK$MAPPSCTS();					! PRINT THE P-SECTION SYNOPSIS
;17300  0674		LNK$MAPSYMS();					! OUTPUT THE SYMBOL TABLE
;17400  0675	     END;
;17500  0676	!**PCHISTE();
;17600  0677	$GETTIM(TIMADR=LNK$GQ_STBSTIM);				! GET START VALUES FOR STB OUTPUT
;17700  0678	$GETJPI(ITMLST=DATALIST);
;17800  0679	LNK$GL_STBCPUT = .CURCPUTIM;
;17900  0680	LNK$GL_STBFLTS = .CURPAGEFLTS;
;18000  0681	LNK$SYMTBLOUT();					! OUTPUT THE SYMBOL TABLE
;18100  0682	IF .LNK$GL_CTLMSK<LNK$S_IMAGE,1,0>			! IF THE IMAGE IS STILL OPEN
;18200  0683	THEN LNK$WRTIMGHDR();					! OUTPUT THE HEADER AND CLOSE IT
;18300  0684	$GETJPI(ITMLST=DATALIST);
;18400  0685	LNK$GL_ENDCPUT = .CURCPUTIM;
;18500  0686	LNK$GL_ENDFLTS = .CURPAGEFLTS;
;18600  0687	IF .LNK$GL_CTLMSK<LNK$S_MAPOPN,1,0>			! IF THE MAP IS STILL OPEN
;18700  0688	THEN BEGIN
;18800  0689		LNK$MAPSTATS();					! THEN STATISTICS OF THIS RUN
;18900  0690		LNK$CLOSMAPFIL();				! FINALLY CLOSE THE MAP FILE
;19000  0691	     END;
;19100  0692	IF .LNK$GB_MAXERCOD EQL 0				! IF NO ERRORS WERE ISSUED
;19200  0693	THEN LNK$EXIT(SS$_NORMAL);				! EXIT NORMALLY
;19300  0694	IF .LNK$GB_MAXERCOD<7,1,0>				! IF HIGH ORDER BIT IS SET
;19400  0695	THEN LNK$EXIT(LNK$_BADIMGSYM)				! THEN IMAGE AND/OR STB FILE USELESS
;19500  0696	ELSE LNK$EXIT(LNK$_DIAGSISUED);				! OTHERWISE DIAGNOSTICS WERE ISSUED
;19600  0697	END;


; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-3
; Digital Equipment Corporation
;

							    .TITLE  LNK_MAIN
							    .IDENT  \X01.20\

							    .PSECT  $PLIT$,NOWRT,NOEXE,2

					      00000 P.AAA:  .ASCII  <9>\PASS 1\<0>					      ;
					      00008 P.AAB:  .ASCII  <9>\PASS 2\<0>					      ;
					      00010 P.AAC:  .ASCII  <9>\MAP AFTER OBJ LIST\<0>				      ;

							    .PSECT  $OWN$,NOEXE,2

					      00000 PASS1:  .LONG   7							      ;
					      00004 	    .ADDRESS  P.AAA						      ;
					      00008 PASS2:  .LONG   7							      ;
					      0000C 	    .ADDRESS  P.AAB						      ;
					      00010 MAPDAT: .LONG   19							      ;
					      00014 	    .ADDRESS  P.AAC						      ;
					      00018 CURCPUTIM:
							    .BLKB   4
					      0001C CURPAGEFLTS:
							    .BLKB   4
					      00020 DATALIST:
							    .WORD   4							      ;
					      00022 	    .WORD   1031						      ;
					      00024 	    .ADDRESS  CURCPUTIM						      ;
					      00028 	    .LONG   0							      ;
					      0002C 	    .WORD   4							      ;
					      0002E 	    .WORD   1034						      ;
					      00030 	    .ADDRESS  CURPAGEFLTS					      ;
					      00034 	    .LONG   0							      ;
					      00038 	    .LONG   0							      ;

							    .PSECT  $GLOBAL$,NOEXE,2

					      00000 LNK$AW_VERSION::
							    .ASCII  \01\						      ;
					      00002 	    .ASCII  \20\						      ;
					      00004 LNK$GQ_STARTIM::
							    .BLKB   8
					      0000C LNK$GQ_PS1STIM::
							    .BLKB   8
					      00014 LNK$GQ_ALOSTIM::
							    .BLKB   8
					      0001C LNK$GQ_PS2STIM::
							    .BLKB   8
					      00024 LNK$GQ_MAPSTIM::
							    .BLKB   8
					      0002C LNK$GQ_STBSTIM::
							    .BLKB   8
					      00034 LNK$GL_CPUSTIM::
							    .BLKB   4
					      00038 LNK$GL_PS1CPUT::
							    .BLKB   4
					      0003C LNK$GL_ALOCPUT::

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-4
; Digital Equipment Corporation
;
							    .BLKB   4
					      00040 LNK$GL_PS2CPUT::
							    .BLKB   4
					      00044 LNK$GL_MAPCPUT::
							    .BLKB   4
					      00048 LNK$GL_STBCPUT::
							    .BLKB   4
					      0004C LNK$GL_ENDCPUT::
							    .BLKB   4
					      00050 LNK$GL_SPAGFLTS::
							    .BLKB   4
					      00054 LNK$GL_PS1FLTS::
							    .BLKB   4
					      00058 LNK$GL_ALOFLTS::
							    .BLKB   4
					      0005C LNK$GL_PS2FLTS::
							    .BLKB   4
					      00060 LNK$GL_MAPFLTS::
							    .BLKB   4
					      00064 LNK$GL_STBFLTS::
							    .BLKB   4
					      00068 LNK$GL_ENDFLTS::
							    .BLKB   4

						    SYM$C_MAXLNG==	15
						    FDB$C_SIZE==	75
						    LNK$S_NEWUDF==	0
						    LNK$S_LIBR==	1
						    LNK$S_SHR==		2
						    LNK$S_SELSER==	3
						    LNK$S_OPTION==	4
						    LNK$S_DEBUGER==	5
						    LNK$S_LIBEXTR==	6
						    LNK$S_LIBSRCH==	7
						    LNK$M_NEWUDF==	1
						    LNK$M_LIBR==	2
						    LNK$M_SHR==		4
						    LNK$M_SELSER==	8
						    LNK$M_OPTION==	16
						    LNK$M_DEBUGER==	32
						    LNK$M_LIBEXTR==	64
						    LNK$M_LIBSRCH==	128
						    PMT$L_PSCDES==	0
						    PMT$L_MODCON==	1
						    PMT$L_SYMLST==	1
						    PMT$C_SIZE==	8
						    OMD$C_SIZE==	2080
						    OMD$M_NOPSCT==	1
						    OMD$S_NOPSCT==	0
						    OMD$M_NOBIN==	2
						    OMD$S_NOBIN==	1
						    OMD$M_SHRIMG==	4
						    OMD$S_SHRIMG==	2
						    OMD$M_SELSER==	8
						    OMD$S_SELSER==	3

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-5
; Digital Equipment Corporation
;
						    OMD$M_MAPMOD==	16
						    OMD$S_MAPMOD==	4
						    OMD$M_DEBUGER==	32
						    OMD$S_DEBUGER==	5
						    PSC$C_SIZE==	43
						    MPC$C_SIZE==	17
						    LID$C_SIZE==	4
						    CLU$C_SIZE==	55
						    CLU$S_BASED==	0
						    CLU$S_SYMBAS==	1
						    CLU$S_SHRIMG==	2
						    CLU$S_PIC==		3
						    CLU$S_COPY==	4
						    CLU$S_OPEN==	5
						    CLU$S_PENDING==	6
						    FVM$C_SIZE==	12
						    LNK$_SUBSYSNUM==	100
							    .GLOBL  LNK$CLOSCURFIL, LNK$CLOSMAPFIL, LNK$CLOSIMGFIL
							    .GLOBL  LNK$CLOSERRFIL, LNK$CLOSYMOUT, LNK$IMGINIT, LNK$INIT
							    .GLOBL  LNK$FLUSHIMG, LNK$GETCMD, LNK$MAPINIT, LNK$MAPISCTS
							    .GLOBL  LNK$MAPPSCTS, LNK$MAPSTATS, LNK$MAPSYMS, LNK$OBJPASS1
							    .GLOBL  LNK$OBJPASS2, LNK$SYMTBLOUT, LNK$VMALLO, LNK$WRTIMGHDR
							    .GLOBL  LNK$S_IMAGE, LNK$S_MAP, LNK$S_MAPOPN, LNK$GB_PASS
							    .GLOBL  LNK$GB_MAXERCOD, LNK$GL_CTLMSK, LNK$_TMPBUGCHK
							    .GLOBL  LNK$_INITFAIL, LNK$_ERRORFILE, LNK$_FATALERROR
							    .GLOBL  LNK$_BADIMGSYM, LNK$_DIAGSISUED, SYS$GETTIM, SYS$GETJPI

							    .PSECT  $CODE$,NOWRT,2

					 0FE0 00000 	    .ENTRY  LNK$START, Save R5,R6,R7,R8,R9,R10,R11		      ; 0608
		         55	       00  D0 00002 	    MOVL    #LNK$S_MAPOPN, R5					      ;
		         56	0000G  CF  9E 00005 	    MOVAB   LNK$GL_CTLMSK, R6					      ;
		         57	       00  D0 0000A 	    MOVL    #LNK$S_IMAGE, R7					      ;
		         58 00000000G  9F  9E 0000D 	    MOVAB   @#SYS$GETTIM, R8					      ;
		         59 00000000G  9F  9E 00014 	    MOVAB   @#SYS$GETJPI, R9					      ;
		         5A	0000'  CF  9E 0001B 	    MOVAB   LNK$GQ_STARTIM, R10					      ;
		         5B	0000'  CF  9E 00020 	    MOVAB   DATALIST, R11					      ;
				       5A  DD 00025 	    PUSHL   R10							      ; 0631
		         68	       01  FB 00027 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 0002A 	    CLRQ    -(SP)						      ; 0632
				       7E  D4 0002C 	    CLRL    -(SP)						      ;
				       5B  DD 0002E 	    PUSHL   R11							      ;
				       7E  7C 00030 	    CLRQ    -(SP)						      ;
				       7E  D4 00032 	    CLRL    -(SP)						      ;
		         69	       07  FB 00034 	    CALLS   #7, SYS$GETJPI					      ;
		    30   AA	  F8   AB  D0 00037 	    MOVL    CURCPUTIM, LNK$GL_CPUSTIM				      ; 0633
		    4C   AA	  FC   AB  D0 0003C 	    MOVL    CURPAGEFLTS, LNK$GL_SPAGFLTS			      ; 0634
		  0000G  CF	       00  FB 00041 	    CALLS   #0, LNK$INIT					      ; 0635
				       5C  DD 00046 	    PUSHL   AP							      ; 0636
		  0000G  CF	       01  FB 00048 	    CALLS   #1, LNK$GETCMD					      ;
		  0000G  CF	       01  90 0004D 	    MOVB    #1, LNK$GB_PASS					      ; 0638
				  08   AA  9F 00052 	    PUSHAB  LNK$GQ_PS1STIM					      ; 0639
		         68	       01  FB 00055 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 00058 	    CLRQ    -(SP)						      ; 0640
				       7E  D4 0005A 	    CLRL    -(SP)						      ;

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-6
; Digital Equipment Corporation
;
				       5B  DD 0005C 	    PUSHL   R11							      ;
				       7E  7C 0005E 	    CLRQ    -(SP)						      ;
				       7E  D4 00060 	    CLRL    -(SP)						      ;
		         69	       07  FB 00062 	    CALLS   #7, SYS$GETJPI					      ;
		    34   AA	  F8   AB  D0 00065 	    MOVL    CURCPUTIM, LNK$GL_PS1CPUT				      ; 0641
		    50   AA	  FC   AB  D0 0006A 	    MOVL    CURPAGEFLTS, LNK$GL_PS1FLTS				      ; 0642
				       5C  DD 0006F 	    PUSHL   AP							      ; 0644
		  0000G  CF	       01  FB 00071 	    CALLS   #1, LNK$OBJPASS1					      ;
				  10   AA  9F 00076 	    PUSHAB  LNK$GQ_ALOSTIM					      ; 0646
		         68	       01  FB 00079 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 0007C 	    CLRQ    -(SP)						      ; 0647
				       7E  D4 0007E 	    CLRL    -(SP)						      ;
				       5B  DD 00080 	    PUSHL   R11							      ;
				       7E  7C 00082 	    CLRQ    -(SP)						      ;
				       7E  D4 00084 	    CLRL    -(SP)						      ;
		         69	       07  FB 00086 	    CALLS   #7, SYS$GETJPI					      ;
		    38   AA	  F8   AB  D0 00089 	    MOVL    CURCPUTIM, LNK$GL_ALOCPUT				      ; 0648
		    54   AA	  FC   AB  D0 0008E 	    MOVL    CURPAGEFLTS, LNK$GL_ALOFLTS				      ; 0649
		  0000G  CF	       00  FB 00093 	    CALLS   #0, LNK$VMALLO					      ; 0650
	   05	         66	       57  E1 00098 	    BBC     R7, LNK$GL_CTLMSK, 1$				      ; 0651
		  0000G  CF	       00  FB 0009C 	    CALLS   #0, LNK$IMGINIT					      ; 0652
	   05	         66	       00  E1 000A1 1$:     BBC     #LNK$S_MAP, LNK$GL_CTLMSK, 2$			      ; 0653
		  0000G  CF	       00  FB 000A5 	    CALLS   #0, LNK$MAPINIT					      ; 0654
		  0000G  CF	       02  90 000AA 2$:     MOVB    #2, LNK$GB_PASS					      ; 0655
				  18   AA  9F 000AF 	    PUSHAB  LNK$GQ_PS2STIM					      ; 0656
		         68	       01  FB 000B2 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 000B5 	    CLRQ    -(SP)						      ; 0657
				       7E  D4 000B7 	    CLRL    -(SP)						      ;
				       5B  DD 000B9 	    PUSHL   R11							      ;
				       7E  7C 000BB 	    CLRQ    -(SP)						      ;
				       7E  D4 000BD 	    CLRL    -(SP)						      ;
		         69	       07  FB 000BF 	    CALLS   #7, SYS$GETJPI					      ;
		    3C   AA	  F8   AB  D0 000C2 	    MOVL    CURCPUTIM, LNK$GL_PS2CPUT				      ; 0658
		    58   AA	  FC   AB  D0 000C7 	    MOVL    CURPAGEFLTS, LNK$GL_PS2FLTS				      ; 0659
		  0000G  CF	       00  FB 000CC 	    CALLS   #0, LNK$OBJPASS2					      ; 0661
	   05	         66	       57  E1 000D1 	    BBC     R7, LNK$GL_CTLMSK, 3$				      ; 0663
		  0000G  CF	       00  FB 000D5 	    CALLS   #0, LNK$FLUSHIMG					      ; 0664
				  20   AA  9F 000DA 3$:     PUSHAB  LNK$GQ_MAPSTIM					      ; 0665
		         68	       01  FB 000DD 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 000E0 	    CLRQ    -(SP)						      ; 0666
				       7E  D4 000E2 	    CLRL    -(SP)						      ;
				       5B  DD 000E4 	    PUSHL   R11							      ;
				       7E  7C 000E6 	    CLRQ    -(SP)						      ;
				       7E  D4 000E8 	    CLRL    -(SP)						      ;
		         69	       07  FB 000EA 	    CALLS   #7, SYS$GETJPI					      ;
		    40   AA	  F8   AB  D0 000ED 	    MOVL    CURCPUTIM, LNK$GL_MAPCPUT				      ; 0667
		    5C   AA	  FC   AB  D0 000F2 	    MOVL    CURPAGEFLTS, LNK$GL_MAPFLTS				      ; 0668
	   0F	         66	       55  E1 000F7 	    BBC     R5, LNK$GL_CTLMSK, 4$				      ; 0670
		  0000G  CF	       00  FB 000FB 	    CALLS   #0, LNK$MAPISCTS					      ; 0672
		  0000G  CF	       00  FB 00100 	    CALLS   #0, LNK$MAPPSCTS					      ; 0673
		  0000G  CF	       00  FB 00105 	    CALLS   #0, LNK$MAPSYMS					      ; 0674
				  28   AA  9F 0010A 4$:     PUSHAB  LNK$GQ_STBSTIM					      ; 0677
		         68	       01  FB 0010D 	    CALLS   #1, SYS$GETTIM					      ;
				       7E  7C 00110 	    CLRQ    -(SP)						      ; 0678
				       7E  D4 00112 	    CLRL    -(SP)						      ;

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-7
; Digital Equipment Corporation
;
				       5B  DD 00114 	    PUSHL   R11							      ;
				       7E  7C 00116 	    CLRQ    -(SP)						      ;
				       7E  D4 00118 	    CLRL    -(SP)						      ;
		         69	       07  FB 0011A 	    CALLS   #7, SYS$GETJPI					      ;
		    44   AA	  F8   AB  D0 0011D 	    MOVL    CURCPUTIM, LNK$GL_STBCPUT				      ; 0679
		    60   AA	  FC   AB  D0 00122 	    MOVL    CURPAGEFLTS, LNK$GL_STBFLTS				      ; 0680
		  0000G  CF	       00  FB 00127 	    CALLS   #0, LNK$SYMTBLOUT					      ; 0681
	   05	         66	       57  E1 0012C 	    BBC     R7, LNK$GL_CTLMSK, 5$				      ; 0682
		  0000G  CF	       00  FB 00130 	    CALLS   #0, LNK$WRTIMGHDR					      ; 0683
				       7E  7C 00135 5$:     CLRQ    -(SP)						      ; 0684
				       7E  D4 00137 	    CLRL    -(SP)						      ;
				       5B  DD 00139 	    PUSHL   R11							      ;
				       7E  7C 0013B 	    CLRQ    -(SP)						      ;
				       7E  D4 0013D 	    CLRL    -(SP)						      ;
		         69	       07  FB 0013F 	    CALLS   #7, SYS$GETJPI					      ;
		    48   AA	  F8   AB  D0 00142 	    MOVL    CURCPUTIM, LNK$GL_ENDCPUT				      ; 0685
		    64   AA	  FC   AB  D0 00147 	    MOVL    CURPAGEFLTS, LNK$GL_ENDFLTS				      ; 0686
	   0A	         66	       55  E1 0014C 	    BBC     R5, LNK$GL_CTLMSK, 6$				      ; 0687
		  0000G  CF	       00  FB 00150 	    CALLS   #0, LNK$MAPSTATS					      ; 0689
		  0000G  CF	       00  FB 00155 	    CALLS   #0, LNK$CLOSMAPFIL					      ; 0690
				0000G  CF  95 0015A 6$:     TSTB    LNK$GB_MAXERCOD					      ; 0692
				       07  12 0015E 	    BNEQ    7$							      ;
				       01  DD 00160 	    PUSHL   #1							      ; 0693
		  0000V  CF	       01  FB 00162 	    CALLS   #1, LNK$EXIT					      ;
	   08	  0000G  CF	       07  E1 00167 7$:     BBC     #7, LNK$GB_MAXERCOD, 8$				      ; 0694
			    00000000G  8F  DD 0016D 	    PUSHL   #LNK$_BADIMGSYM					      ; 0695
				       06  11 00173 	    BRB     9$							      ;
			    00000000G  8F  DD 00175 8$:     PUSHL   #LNK$_DIAGSISUED					      ; 0696
		  0000V  CF	       01  FB 0017B 9$:     CALLS   #1, LNK$EXIT					      ;
					   04 00180 	    RET     							      ; 0608

; Routine Size:  385 bytes


;19700  0698	GLOBAL ROUTINE LNK$EXIT (EXITCODE) : NOVALUE=
;19800  0699	BEGIN
;19900  0700	!
;20000  0701	! LINKER TERMINATION ROUTINE
;20100  0702	!
;20200  0703	BUILTIN	ACTUALCOUNT;
;20300  0704	!
;20400  0705	LOCAL	CODE;
;20500  0706	!
;20600  0707	IF ACTUALCOUNT() EQL 0
;20700  0708	THEN CODE = LNK$_TMPBUGCHK
;20800  0709	ELSE CODE = .EXITCODE;
;20900  0710	IF .CODE NEQ SS$_NORMAL
;21000  0711	THEN BEGIN
;21100  0712		LNK$CLOSCURFIL();				! CLOSE THE CURRENT OBJ FILE
;21200  0713		LNK$CLOSYMOUT(0);				! CLOSE ANY SYMBOL TABLE OUTPUT
;21300  0714		LNK$CLOSIMGFIL();				! CLOSE THE IMAGE FILE
;21400  0715		LNK$CLOSMAPFIL();				! CLOSE THE MAP FILE
;21500  0716	     END;
;21600  0717	LNK$CLOSERRFIL();				! AND FINALLY THE ERROR MESSAGE FILE
;21700  0718	$EXIT(CODE = .CODE);

; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-8
; Digital Equipment Corporation
;
;21800  0719	END;



							    .GLOBL  SYS$EXIT

					 0004 00181 	    .ENTRY  LNK$EXIT, Save R2					      ; 0698
				       6C  95 00183 	    TSTB    (AP)						      ; 0707
				       09  12 00185 	    BNEQ    1$							      ;
		         52 00000000G  8F  D0 00187 	    MOVL    #LNK$_TMPBUGCHK, CODE				      ; 0708
				       04  11 0018E 	    BRB     2$							      ; 0707
		         52	  04   AC  D0 00190 1$:     MOVL    EXITCODE, CODE					      ; 0709
		         01	       52  D1 00194 2$:     CMPL    CODE, #1						      ; 0710
				       16  13 00197 	    BEQL    3$							      ;
		  0000G  CF	       00  FB 00199 	    CALLS   #0, LNK$CLOSCURFIL					      ; 0712
				       7E  D4 0019E 	    CLRL    -(SP)						      ; 0713
		  0000G  CF	       01  FB 001A0 	    CALLS   #1, LNK$CLOSYMOUT					      ;
		  0000G  CF	       00  FB 001A5 	    CALLS   #0, LNK$CLOSIMGFIL					      ; 0714
		  0000G  CF	       00  FB 001AA 	    CALLS   #0, LNK$CLOSMAPFIL					      ; 0715
		  0000G  CF	       00  FB 001AF 3$:     CALLS   #0, LNK$CLOSERRFIL					      ; 0717
				       52  DD 001B4 	    PUSHL   CODE						      ; 0718
	      00000000G  9F	       01  FB 001B6 	    CALLS   #1, @#SYS$EXIT					      ;
					   04 001BD 	    RET     							      ; 0698

; Routine Size:  61 bytes


;21900  0720	END ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  $GLOBAL$       	   108    WRT,  RD ,NOEXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)
;  $PLIT$         	    36  NOWRT,  RD ,NOEXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)
;  $OWN$          	    60    WRT,  RD ,NOEXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)
;  $CODE$         	   446  NOWRT,  RD ,  EXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)




;				LIBRARY STATISTICS
;
;					     -------- Symbols --------    Blocks
;	File				     Total    Loaded   Percent      Read
;
;  DBA4:[SYSLIB]LIB.L32;1		      5582         8         0       227




; Bliss-32 7.352	Saturday 22-AUG-1978 04:47:45	DBB3:[LINKER.SRC]LINKER.B32;16					Page 2-9
; Digital Equipment Corporation
;


; Size:		446 code + 204 data bytes
; Run Time:	00:21.4
; Elapsed Time:	00:25.2
; Memory Used:	368 pages
; Compilation Complete
