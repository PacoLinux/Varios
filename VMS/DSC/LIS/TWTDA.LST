TWTDA	X0003 - WRITE FILE DATA	MACRO M1110  21-AUG-78 21:22  PAGE 3


      1	000000					$BEGIN	TWTDA,0003,<WRITE FILE DATA TO TAPE>
						.TITLE	TWTDA	X0003 - WRITE FILE DATA TO TAPE
						.IDENT	"X0003"
      2
      3					;
      4					; COPYRIGHT (C) 1976 BY DIGITAL EQUIPMENT CORPORATION,
      5					; MAYNARD, MASSACHUSETTS
      6					;
      7					; THIS SOFTWARE IS FURNISHED UNDER A LICENSE FOR USE ONLY ON A
      8					; SINGLE  COMPUTER  SYSTEM AND MAY BE COPIED ONLY WITH THE IN-
      9					; CLUSION OF THE ABOVE COPYRIGHT NOTICE.   THIS  SOFTWARE,  OR
     10					; ANY  OTHER  COPIES THEREOF, MAY NOT BE PROVIDED OR OTHERWISE
     11					; MADE AVAILABLE TO ANY OTHER PERSON EXCEPT FOR  USE  ON  SUCH
     12					; SYSTEM  AND TO ONE WHO AGREES TO THESE LICENSE TERMS.  TITLE
     13					; TO AND OWNERSHIP OF THE SOFTWARE SHALL AT ALL  TIMES  REMAIN
     14					; IN DIGITAL.
     15					;
     16					; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITH-
     17					; OUT  NOTICE  AND  SHOULD NOT BE CONSTRUED AS A COMMITMENT BY
     18					; DIGITAL EQUIPMENT CORPORATION.
     19					;
     20					; DIGITAL EQUIPMENT CORPORATION ASSUMES NO RESPONSIBILITY  FOR
     21					; THE USE OR RELIABILITY OF ITS SOFTWARE ON EQUIPMENT WHICH IS
     22					; NOT SUPPLIED BY DIGITAL.
     23					;
     24					; ANDREW C. GOLDSTEIN  12-AUG-76  21:54
TWTDA	X0003 - WRITE FILE DATA	MACRO M1110  21-AUG-78 21:22  PAGE 4


     26					;+
     27					;
     28					; *** - $TWTDA	WRITE FILE DATA TO TAPE
     29					;
     30					; *** - $TWTID	WRITE INDEX FILE DATA TO TAPE
     31					;
     32					; THIS ROUTINE WRITES THE ACCUMULATED INDEX FILE DATA TO THE OUTPUT
     33					; TAPE.
     34					;
     35					; INPUTS:
     36					;
     37					;	R4 = BUFFER DESCRIPTOR ADDRESS
     38					;
     39					; OUTPUTS:
     40					;
     41					;	WRITE OPERATION INITIATED
     42					;	R4 PRESERVED, OTHER REGISTERS CLOBBERED
     43					;
     44					;-
     45
     46	000000				$TWTDA::
     47	000000				$TWTID::
     48	000000					LET R0 := R4
     49	000002					THRU R1 := #B.SIZ*3/2		; CLEAN OUT SPARE BCB'S,
     50	000006					  LET -(R0) := #0		; AS THEY ARE NOT NEEDED
     51	000010					END LOOP
     52	000014					LET B.STAT(R4) := #0		; INVALIDATE BUFFER AFTER COMPLETION
     53	000020					LET R1 := B.SIZ+P.CNT(R4)
     54	000024					IF RESULT IS EQ GOTO EXIT
     55	000026					LET R1 := R1 + #P.SIZ		 ; TOTAL BYTE COUNT
     56	000032					$CALL $WRITE <,R1,,,R4>		; START THE WRITE
     57	000036				EXIT:	RETURN
     58
     59
     60
     61		000001 				.END
TWTDA	X0003 - WRITE FILE DATA	MACRO M1110  21-AUG-78 21:22  PAGE 4-1
SYMBOL TABLE

A3    = 000001   	IIII  = 177777   	$EF$  = 000000   	$R    = 177777   	$T2   = 000000
B.SIZ = ****** GX	LBLS0 = 000000   	$E$   = 000001   	$SUPMC= 000043   	$WRITE= ****** GX
B.STAT= ****** GX	P.CNT = ****** GX	$I$   = 000001   	$T    = 000000   	$Y$   = 000000
B0      000006R  	P.SIZ = ****** GX	$L    = 000001   	$TWTDA  000000RG 	$Z$   = 000000
EXIT    000036R  	TYPS0 = 000000   	$L$   = 000000   	$TWTID  000000RG 	$$TT  = 000000
E0      000014R  	$DIDDO= 000000   	$O$   = 000000   	$T1   = 000006   	.$T   = 000005

. ABS.	000000	   000
      	000040	   001
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  11238 WORDS  ( 44 PAGES)
DYNAMIC MEMORY:  12276 WORDS  ( 47 PAGES)
ELAPSED TIME:  00:00:29
EXE$:TWTDA,LIS$:TWTDA/-SP=SRC$:SMAC/PA:1,DSCPRE,TWTDA
