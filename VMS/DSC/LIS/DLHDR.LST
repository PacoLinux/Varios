DLHDR	X0001 - DELETE FILE HEA	MACRO M1110  21-AUG-78 20:08  PAGE 3


      1	000000					$BEGIN	DLHDR,0001,<DELETE FILE HEADER>
						.TITLE	DLHDR	X0001 - DELETE FILE HEADER
						.IDENT	"X0001"
      2
      3					;
      4					; COPYRIGHT (C) 1976 BY DIGITAL EQUIPMENT CORPORATION,
      5					; MAYNARD, MASSACHUSETTS
      6					;
      7					; THIS SOFTWARE IS FURNISHED UNDER A LICENSE FOR USE ONLY ON A
      8					; SINGLE  COMPUTER  SYSTEM AND MAY BE COPIED ONLY WITH THE IN-
      9					; CLUSION OF THE ABOVE COPYRIGHT NOTICE.   THIS  SOFTWARE,  OR
     10					; ANY  OTHER  COPIES THEREOF, MAY NOT BE PROVIDED OR OTHERWISE
     11					; MADE AVAILABLE TO ANY OTHER PERSON EXCEPT FOR  USE  ON  SUCH
     12					; SYSTEM  AND TO ONE WHO AGREES TO THESE LICENSE TERMS.  TITLE
     13					; TO AND OWNERSHIP OF THE SOFTWARE SHALL AT ALL  TIMES  REMAIN
     14					; IN DIGITAL.
     15					;
     16					; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITH-
     17					; OUT  NOTICE  AND  SHOULD NOT BE CONSTRUED AS A COMMITMENT BY
     18					; DIGITAL EQUIPMENT CORPORATION.
     19					;
     20					; DIGITAL EQUIPMENT CORPORATION ASSUMES NO RESPONSIBILITY  FOR
     21					; THE USE OR RELIABILITY OF ITS SOFTWARE ON EQUIPMENT WHICH IS
     22					; NOT SUPPLIED BY DIGITAL.
     23					;
     24					; ANDREW C. GOLDSTEIN  13-AUG-76  19:26
     25
     26						.MCALL	FHDL2$
     27	000000					FHDL2$				; DEFINE FILE HEADER OFFSETS
DLHDR	X0001 - DELETE FILE HEA	MACRO M1110  21-AUG-78 20:08  PAGE 4


     29					;+
     30					;
     31					; *** - $DLHDR	DELETE FILE HEADER
     32					;
     33					; THIS ROUTINE MAKES THE INDICATED FILE HEADER A DELETED ONE. IT TURNS
     34					; ON MARK FOR DELETE, ZEROES THE FILE NUMBER AND CHECKSUM, AND WRITES
     35					; IT TO THE INDEX FILE. NOTE THAT THE INDEX FILE BITMAP BIT IS ASSUMED
     36					; TO BE OFF.
     37					;
     38					; INPUTS:
     39					;
     40					;	OUTLUN ASSIGNED TO DISK
     41					;	R4 = BCB FOR FILE HEADER
     42					;	R5 = BUFFER ADDRESS OF HEADER
     43					;
     44					; OUTPUTS:
     45					;
     46					;	DELETED HEADER WRITTEN
     47					;	R4,R5 PRESERVED, OTHER REGISTERS CLOBBERED
     48					;
     49					;-
     50
     51	000000				$DLHDR::
     52	000000					LET R3 := H.FNUM(R5)		; GET FILE NUMBER
     53	000004					LET H.FNUM(R5) := #0		; ZERO IN HEADER
     54	000010					LET H.CKSM(R5) := #0		; ZERO THE CHECKSUM
     55	000014					LET H.SCHA(R5) :B= H.SCHA(R5) SET.BY #SC.MDL ; MARK FOR DELETE
     56	000022					$CALL $WRHD1 <,,,R3,R4,R5>	; WRITE THE HEADER
     57	000026					RETURN
     58
     59
     60
     61		000001 				.END
DLHDR	X0001 - DELETE FILE HEA	MACRO M1110  21-AUG-78 20:08  PAGE 4-1
SYMBOL TABLE

FP.DEL= 000010   	H.FPRO= 000100   	H.SEMK= 000104   	I.ULAB= 000062   	$E$   = 000001
FP.EXE= 000004   	H.FRVN= 000014   	H.SMMX= 000110   	SC.BAD= 000100   	$L    = 000000
FP.RDV= 000001   	H.FSEG= 000004   	H.UCHA= 000064   	SC.DIR= 000040   	$L$   = 000000
FP.WRV= 000002   	H.FSEQ= 000012   	H.UFAT= 000024   	SC.MDL= 000200   	$R    = 177777
H.ACOF= 000002   	H.IDOF= 000000   	H.USE = 000072   	S.HDHD= 000114   	$SUPMC= 000043
H.CKSM= 000776   	H.MPOF= 000001   	IIII  = 177777   	S.IDHD= 000202   	$T    = 000000
H.EFNU= 000016   	H.PRIV= 000073   	I.BKDT= 000052   	S.MPHD= 000000   	$WRHD1= ****** GX
H.EFSQ= 000020   	H.PROG= 000074   	I.CRDT= 000022   	UC.CON= 000200   	$Y$   = 000000
H.ERVN= 000022   	H.PROJ= 000076   	I.EXDT= 000042   	UC.DLK= 000100   	$Z$   = 000000
H.FCHA= 000064   	H.RPRO= 000102   	I.FNAM= 000000   	$DIDDO= 000000   	.$T   = 000006
H.FLEV= 000006   	H.RSOF= 000003   	I.RVDT= 000032   	$DLHDR  000000RG 	...GBL= 000000
H.FNUM= 000010   	H.SCHA= 000065   	I.RVNO= 000020   	$EF$  = 000000   	...TPC= 000000
H.FOWN= 000074

. ABS.	000000	   000
      	000030	   001
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  12673 WORDS  ( 50 PAGES)
DYNAMIC MEMORY:  14388 WORDS  ( 55 PAGES)
ELAPSED TIME:  00:00:30
EXE$:DLHDR,LIS$:DLHDR/-SP=SRC$:SMAC/PA:1,DSCPRE,DLHDR
