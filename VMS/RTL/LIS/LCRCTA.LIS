
; Bliss-32 10.1-416	Monday 21-AUG-1978 19:32:45	DBB3:[RTL.SRC]LCRCTA.B32;5					Page 1
;
;	0001	MODULE LIB$CRC_TABLE (	! Library CRC table genarator 
;	0002		IDENT = '0-02',	! File: LCRCTA.B3S
;	0003		LINKAGE(FORTRAN)
;	0004			) =
;	0005	BEGIN
;	0006	
;	0007	!
;	0008	!			  COPYRIGHT (c) 1977 BY
;	0009	!	      DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
;	0010	!
;	0011	! THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND  COPIED
;	0012	! ONLY  IN  ACCORDANCE  WITH  THE  TERMS  OF  SUCH  LICENSE AND WITH THE
;	0013	! INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE OR  ANY  OTHER
;	0014	! COPIES  THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY
;	0015	! OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE  IS  HEREBY
;	0016	! TRANSFERRED.
;	0017	!
;	0018	! THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITHOUT  NOTICE
;	0019	! AND  SHOULD  NOT  BE  CONSTRUED  AS  A COMMITMENT BY DIGITAL EQUIPMENT
;	0020	! CORPORATION.
;	0021	!
;	0022	! DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE OR  RELIABILITY  OF  ITS
;	0023	! SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.
;	0024	!
;	0025	
;	0026	!++
;	0027	! FACILITY:  General Utility Library
;	0028	!
;	0029	! ABSTRACT:
;	0030	!
;	0031	!
;	0032	! Given a polynomial, a table is constructed which can be
;	0033	! used by the LIB$CRC module for generating the CRC value for an
;	0034	! input stream.
;	0035	!
;	0036	! ENVIRONMENT:  User Mode - AST re-entrant
;	0037	!
;	0038	! AUTHOR:  Donald G. Petersen, CREATION DATE:  09-Jan-78
;	0039	!
;	0040	! MODIFIED BY:
;	0041	!
;	0042	! 	Donald G. Petersen, 09-Jan-78: VERSION 0
;	0043	! 01	- original
;	0044	! 0-02	- Change REQUIRE files for VAX system build.  DGP 28-Apr-78
;	0045	!--

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:32:45	DBB3:[RTL.SRC]LCRCTA.B32;5					Page 2
;
;	0046	!
;	0047	! TABLE OF CONTENTS:
;	0048	!
;	0049	
;	0050	FORWARD ROUTINE
;	0051		LIB$CRC_TABLE:NOVALUE;	! CRC table build routine 
;	0052	
;	0053	!
;	0054	! INCLUDE FILES:
;	0055	!
;	0056		REQUIRE 'RTLIN:LPSECT.B32';	! Define DECLARE_PSECT macros
; %PRINT:	 REQUIRE FILE: LPSECT.B32, VERSION 01-5, TNH, 27-Jun-78
;65535  0110	!
;65535  0111	! MACROS:
;65535  0112	!
;65535  0113	!	NONE	
;65535  0114	!
;65535  0115	! EQUATED SYMBOLS:
;65535  0116	!
;65535  0117	!	NONE	
;65535  0118	!
;65535  0119	! PSECT DECLARATIONS:
;65535  0120	!
;65535  0121	
;65535  0122		DECLARE_PSECTS (LIB);		! declare PSECTs for LIB$ facility
;65535  0123	
;65535  0124	!
;65535  0125	! OWN STORAGE:
;65535  0126	!
;65535  0127	!	NONE	
;65535  0128	!
;65535  0129	! EXTERNAL REFERENCES:
;65535  0130	!
;65535  0131	!	NONE	

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:32:45	DBB3:[RTL.SRC]LCRCTA.B32;5					Page 3
;
;65535  0132	GLOBAL ROUTINE LIB$CRC_TABLE  (	! Build a table for the CRC routine 
;65535  0133	    POLY,			! Adr of CRC polynomial input
;65535  0134	    TABLE)			! Adr of where table is to be built
;65535  0135		:NOVALUE =		! No value is returned
;65535  0136	!++
;65535  0137	! FUNCTIONAL DESCRIPTION:
;65535  0138	!
;65535  0139	! The input polynomial is used to produce a table with 16 longword entries
;65535  0140	! which is the proper format to be used by the LIB$CRC routine for
;65535  0141	! calculating the CRC for a data stream.
;65535  0142	!
;65535  0143	! FORMAL PARAMETERS:
;65535  0144	!
;65535  0145	!	poly.rl.r		input CRC polynomial
;65535  0146	!	table.wl.ar		Adr of where table of 16 longwords

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:32:45	DBB3:[RTL.SRC]LCRCTA.B32;5					Page 4
;
;65535  0147	!
;65535  0148	! IMPLICIT INPUTS:
;65535  0149	!
;65535  0150	!	NONE
;65535  0151	!
;65535  0152	! IMPLICIT OUTPUTS:
;65535  0153	!
;65535  0154	!	NONE
;65535  0155	!
;65535  0156	! ROUTINE VALUE:
;65535  0157	! COMPLETION CODES:
;65535  0158	!
;65535  0159	!	NONE
;65535  0160	!
;65535  0161	! SIDE EFFECTS:
;65535  0162	!
;65535  0163	!	NONE
;65535  0164	!
;65535  0165	!--
;65535  0166	
;65535  0167	    BEGIN
;65535  0168	    MAP
;65535  0169		TABLE: REF VECTOR [16],
;65535  0170		POLY: REF VECTOR [1];
;65535  0171	    LOCAL
;65535  0172		TMP,			! temporary
;65535  0173		X,			! used as a flag
;65535  0174		INDEX,			! index into the CRC table
;65535  0175		I;			! iteration index for making each entry
;65535  0176	    INCR INDEX FROM 0 TO 15 DO
;65535  0177		BEGIN
;65535  0178		TMP = .INDEX;
;65535  0179		INCR I FROM 1 TO 4 DO
;65535  0180		    BEGIN
;65535  0181		    X = .TMP AND 1;
;65535  0182		    TMP = .TMP ^ -1;
;65535  0183		    IF .X EQL 1 THEN
;65535  0184			TMP = .TMP XOR .POLY[0]
;65535  0185		    END;
;65535  0186		TABLE[.INDEX] = .TMP
;65535  0187		END;
;65535  0188	    RETURN;
;65535  0189	    END;


							    .TITLE  LIB$CRC_TABLE
							    .IDENT  \0-02\



							    .PSECT  LIB$CODE,NOWRT,  SHR,  PIC,2

					 000C 00000 	    .ENTRY  LIB$CRC_TABLE, Save R2,R3				      ; 0132
				       50  D4 00002 	    CLRL    INDEX						      ; 0176
		         51 	       50  D0 00004 1$:     MOVL    INDEX, TMP						      ; 0178

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:32:45	DBB3:[RTL.SRC]LCRCTA.B32;5					Page 4-1
;
		         52 	       01  D0 00007 	    MOVL    #1, I						      ; 0179
	   51 	         01 	       00  EF 0000A 2$:     EXTZV   #0, #1, TMP, X					      ; 0181
				       53     0000E									      ;
	   51 	         51 	  FF   8F  78 0000F 	    ASHL    #-1, TMP, TMP					      ; 0182
		         01 	       53  D1 00014 	    CMPL    X, #1						      ; 0183
				       04  12 00017 	    BNEQ    3$							      ;
		         51 	  04   BC  CC 00019 	    XORL2   @POLY, TMP						      ; 0184
	   E9 	         52 	       04  F3 0001D 3$:     AOBLEQ  #4, I, 2$						      ; 0179
		    08 BC40	       51  D0 00021 	    MOVL    TMP, @TABLE[INDEX]					      ; 0186
	   DA 	         50 	       0F  F3 00026 	    AOBLEQ  #15, INDEX, 1$					      ; 0176
					   04 0002A 	    RET     							      ; 0132

; Routine Size:  43 bytes


;65535  0190	   END
;65535  0191	   ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  LIB$CODE       	    43  NOWRT,  RD ,  EXE,  SHR,  LCL,  REL,  CON,  PIC,ALIGN(2)





; Size:		43 code + 0 data bytes
; Run Time:	00:01.7
; Elapsed Time:	00:04.7
; Memory Used:	22 pages
; Compilation Complete
