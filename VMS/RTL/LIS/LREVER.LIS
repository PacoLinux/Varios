
; Bliss-32 10.1-416	Monday 21-AUG-1978 19:36:07	DBB3:[RTL.SRC]LREVER.B32;6					Page 1
;
;	0001	MODULE LIB$REVERT (	! Revert handler
;	0002		IDENT = '0-06'	! file: LREVER.B32
;	0003			) =
;	0004	BEGIN
;	0005	
;	0006	!
;	0007	!			  COPYRIGHT (c) 1977 BY
;	0008	!	      DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
;	0009	!
;	0010	! THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND  COPIED
;	0011	! ONLY  IN  ACCORDANCE  WITH  THE  TERMS  OF  SUCH  LICENSE AND WITH THE
;	0012	! INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE OR  ANY  OTHER
;	0013	! COPIES  THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY
;	0014	! OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE  IS  HEREBY
;	0015	! TRANSFERRED.
;	0016	!
;	0017	! THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITHOUT  NOTICE
;	0018	! AND  SHOULD  NOT  BE  CONSTRUED  AS  A COMMITMENT BY DIGITAL EQUIPMENT
;	0019	! CORPORATION.
;	0020	!
;	0021	! DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE OR  RELIABILITY  OF  ITS
;	0022	! SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.
;	0023	!
;	0024	
;	0025	!++
;	0026	! FACILITY:	Utility Library
;	0027	!
;	0028	! ABSTRACT:
;	0029	!
;	0030	!	LIB$REVERT deletes the handler associated with
;	0031	!	the procedure activation of the caller.  This is done
;	0032	!	by clearing the handler address in the stack frame 
;	0033	!	of the caller.  The handler address which had been
;	0034	!	associated with the caller is returned as the value.
;	0035	!
;	0036	! ENVIRONMENT:	User mode, re-entrant, AST level or not or mixed.
;	0037	!
;	0038	! AUTHOR:	Thomas N. Hastings	CREATION DATE: 8-Oct-77
;	0039	!
;	0040	! MODIFIED BY:
;	0041	!
;	0042	! 	Thomas N. Hastings, 8-Oct-77: VERSION 0
;	0043	! 01	-	original 
;	0044	! 0-2	- Added SF$ symbols.  TNH 8-Oct-77
;	0045	! 0-3	- Declare PSECTs.  TNH 19-Dec-77.
;	0046	! 0-04	- Change to STARLET library.  DGP 20-Apr-78
;	0047	! 0-05	- Change REQUIRE files for VAX system build.  DGP 28-Apr-78
;	0048	! 0-06	- Change STARLET to RTLSTARLE to avoid conflicts.  DGP 1-May-78
;	0049	!--

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:36:07	DBB3:[RTL.SRC]LREVER.B32;6					Page 2
;
;	0050	!
;	0051	! TABLE OF CONTENTS:
;	0052	!
;	0053	
;	0054	FORWARD ROUTINE
;	0055	
;	0056		LIB$REVERT;			! Revert error handler
;	0057	
;	0058	!
;	0059	! INCLUDE FILES:
;	0060	!
;	0061		REQUIRE	'RTLIN:LPSECT';		! Define DECLARE_PSECTS macro
; %PRINT:	 REQUIRE FILE: LPSECT.B32, VERSION 01-5, TNH, 27-Jun-78
;65535  0115		LIBRARY	'RTLSTARLE';		! STARLET library for macros and symbols
;65535  0116	
;65535  0117	!
;65535  0118	! MACROS:
;65535  0119	!
;65535  0120	
;65535  0121	!
;65535  0122	! EQUATED SYMBOLS:
;65535  0123	!
;65535  0124	
;65535  0125	
;65535  0126	!
;65535  0127	! Declare PSECTs
;65535  0128	!
;65535  0129	
;65535  0130		DECLARE_PSECTS (LIB);	! Declare LIB$CODE and LIB$DATA PSECTs
;65535  0131	
;65535  0132	!
;65535  0133	! OWN STORAGE:
;65535  0134	!
;65535  0135	
;65535  0136	!
;65535  0137	! EXTERNAL REFERENCES:
;65535  0138	!
;65535  0139	

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:36:07	DBB3:[RTL.SRC]LREVER.B32;6					Page 3
;
;65535  0140	GLOBAL ROUTINE LIB$REVERT 
;65535  0141		=		! Value is old handler
;65535  0142	
;65535  0143	!++
;65535  0144	! FUNCTIONAL DESCRIPTION:
;65535  0145	!
;65535  0146	!	LIB$REVERT deletes the handler associated with
;65535  0147	!	the procedure activation of the caller.  This is done
;65535  0148	!	by clearing the handler address in the stack frame 
;65535  0149	!	of the caller.  The handler address which had been
;65535  0150	!	associated with the caller is returned as the value.
;65535  0151	!
;65535  0152	! FORMAL PARAMETERS:
;65535  0153	!
;65535  0154	!	None
;65535  0155	!
;65535  0156	! IMPLICIT INPUTS:
;65535  0157	!
;65535  0158	!	NONE
;65535  0159	!
;65535  0160	! IMPLICIT OUTPUTS:
;65535  0161	!
;65535  0162	!	NONE
;65535  0163	!
;65535  0164	! ROUTINE VALUE:
;65535  0165	!
;65535  0166	!	OLD_HANDLER.wa.v		previous contents of SF$A_HANDLER
;65535  0167	!					of the callers frame.
;65535  0168	!
;65535  0169	! COMPLETION CODES:
;65535  0170	!
;65535  0171	!	NONE
;65535  0172	!
;65535  0173	! SIDE EFFECTS:
;65535  0174	!
;65535  0175	!	The callers stack frame will be modified.
;65535  0176	!
;65535  0177	!--
;65535  0178	
;65535  0179	    BEGIN
;65535  0180	
;65535  0181	    LOCAL
;65535  0182		OLD_HANDLER;		! store the old handler address
;65535  0183	    BUILTIN
;65535  0184		FP;
;65535  0185	    MAP
;65535  0186		FP: REF BLOCK[,BYTE];
;65535  0187	    OLD_HANDLER = ..FP[SF$L_SAVE_FP];
;65535  0188	    .FP[SF$L_SAVE_FP] = 0;
;65535  0189	    RETURN .OLD_HANDLER;
;65535  0190	    END;			!End of LIB$REVERT


							    .TITLE  LIB$REVERT
							    .IDENT  \0-06\

; Bliss-32 10.1-416	Monday 21-AUG-1978 19:36:07	DBB3:[RTL.SRC]LREVER.B32;6					Page 3-1
;



							    .PSECT  LIB$CODE,NOWRT,  SHR,  PIC,2

					 0000 00000 	    .ENTRY  LIB$REVERT, Save nothing				      ; 0140
		         50 	  0C   BE  D0 00002 	    MOVL    @12(FP), OLD_HANDLER				      ; 0187
				  0C   BE  D4 00006 	    CLRL    @12(FP)						      ; 0188
					   04 00009 	    RET     							      ; 0140

; Routine Size:  10 bytes



; Bliss-32 10.1-416	Monday 21-AUG-1978 19:36:07	DBB3:[RTL.SRC]LREVER.B32;6					Page 4
;
;65535  0191	END				!End of module
;65535  0192	ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  LIB$CODE       	    10  NOWRT,  RD ,  EXE,  SHR,  LCL,  REL,  CON,  PIC,ALIGN(2)




;				LIBRARY STATISTICS
;
;					     -------- Symbols --------    Blocks
;	File				     Total    Loaded   Percent      Read
;
;  DBA4:[SYSLIB]STARLET.L32;1		      2688         1         0       108





; Size:		10 code + 0 data bytes
; Run Time:	00:02.0
; Elapsed Time:	00:06.5
; Memory Used:	119 pages
; Compilation Complete
