OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   0
TABLE OF CONTENTS   

   (2)     100  HISTORY		; Detailed Current Edit History
   (3)     100  DECLARATIONS
   (4)     100  COMPLEX / COMPLEX giving COMPLEX result
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   1
0-04                                                                                                                             (1)

                                     0000   100 	.TITLE	OTS$DIVC - COMPLEX / COMPLEX DIVISION ROUTINE
                                     0000   200 	.IDENT	/0-04/		; File: OTSDIVC.MAR
                                     0000   300 
                                     0000   400 ;
                                     0000   500 ; Copyright (C) 1977
                                     0000   600 ; Digital Equipment Corporation, Maynard, Massachusetts 01754
                                     0000   700 ;
                                     0000   800 ; This software is furnished under a license for use only on a single
                                     0000   900 ; computer  system  and  may be copied only with the inclusion of the
                                     0000  1000 ; above copyright notice. This software, or any other copies thereof,
                                     0000  1100 ; may not be provided or otherwise made available to any other person
                                     0000  1200 ; except for use on such system and to one who agree to these license 
                                     0000  1300 ; terms.  Title to  and  ownership of the software shall at all times 
                                     0000  1400 ; remain in DEC.
                                     0000  1500 ;
                                     0000  1600 ; The information in the software is subject to change without notice
                                     0000  1700 ; and should  not  be construed  as a commitment by Digital Equipment 
                                     0000  1800 ; Corporation.
                                     0000  1900 ;
                                     0000  2000 ; DEC assumes  no  responsibility  for the use or  reliability of its
                                     0000  2100 ; software on equipment which is not supplied by DEC.
                                     0000  2200 ;
                                     0000  2300 ;
                                     0000  2400 ; FACILITY: MATH LIBRARY
                                     0000  2500 ;++
                                     0000  2600 ; ABSTRACT:
                                     0000  2700 ;
                                     0000  2800 ;	Perform COMPLEX division
                                     0000  2900 ;
                                     0000  3000 ;--
                                     0000  3100 ;
                                     0000  3200 ; VERSION: 0
                                     0000  3300 ;
                                     0000  3400 ; HISTORY:
                                     0000  3500 ;
                                     0000  3600 ; AUTHOR:
                                     0000  3700 ;	Jonathan Taylor, 28-Jun-77: Version 0
                                     0000  3800 ;
                                     0000  3900 ; MODIFIED BY:
                                     0000  4000 ;
                                     0000  4200 ;
                                     0000  4300 ;
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   2
0-04            HISTORY  ; Detailed Current Edit History                                                                         (2)

                                     0000   100 	.SBTTL	HISTORY		; Detailed Current Edit History
                                     0000   200 
                                     0000   300 
                                     0000   400 ; Edit History for Version 0 of OTSDIVC
                                     0000   500 ;
                                     0000   600 
                                     0000   700 ; 0-04	- Change FOR$FLAG_JACKET to MTH$FLAG_JACKET.  TNH 17-July-78
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   3
0-04            DECLARATIONS                                                                                                     (3)

                                     0000   100 	.SBTTL	DECLARATIONS
                                     0000   200 
                                     0000   300 ;
                                     0000   400 ; INCLUDE FILES:
                                     0000   500 ;
                                     0000   600 ;	OERR.MAR			; OTS error codes
                                     0000   700 
                                     0000   800 ;
                                     0000   900 ; EXTERNAL SYMBOLS:
                                     0000  1000 ;
                                     0000  1100 ;	none
                                     0000  1200 
                                     0000  1300 ;
                                     0000  1400 ; MACROS:
                                     0000  1500 ;
                                     0000  1600 ;	none
                                     0000  1700 
                                     0000  1800 ;
                                     0000  1900 ; PSECT DECLARATIONS:
                                     0000  2000 ;
                                 00000000  2100 	.PSECT	OTS$CODE	PIC, SHR, LONG, EXE, NOWRT
                                     0000  2200 					; Program section for OTS$ code
                                     0000  2300 
                                     0000  2400 ;
                                     0000  2500 ; EQUATED SYMBOLS:
                                     0000  2600 ;
                           00000004  0000  2700 	a	= 4			; real part of dividend
                           00000008  0000  2800 	b	= 8			; imag part of dividend
                           0000000C  0000  2900 	c	= 12			; real part of divisor
                           00000010  0000  3000 	d	= 16			; imag part of divisor
                                     0000  3100 
                                     0000  3200 ;
                                     0000  3300 ; OWN STORAGE:
                                     0000  3400 ;
                                     0000  3500 ;	none
                                     0000  3600 
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   4
0-04            COMPLEX / COMPLEX giving COMPLEX result                                                                          (4)

                                     0000   100 	.SBTTL	COMPLEX / COMPLEX giving COMPLEX result
                                     0000   200 
                                     0000   300 ;++
                                     0000   400 ; FUNCTIONAL DESCRIPTION:
                                     0000   500 ;
                                     0000   600 ;	OTS$DIVC - COMPLEX / COMPLEX giving COMPLEX result
                                     0000   700 ;
                                     0000   800 ;
                                     0000   900 ;	The COMPLEX result is computed as follows:
                                     0000  1000 ;
                                     0000  1100 ;	1)  Let (a, b) represent the COMPLEX dividend.
                                     0000  1200 ;	2)  Let (c, d) represent the COMPLEX divisor.
                                     0000  1300 ;	3)  Let (r, i) represent the COMPLEX quotient.
                                     0000  1400 ;
                                     0000  1500 ;	Then:
                                     0000  1600 ;
                                     0000  1700 ;	r = (ac + bd) / (cc + dd)
                                     0000  1800 ;	i = (bc - ad) / (cc + dd)
                                     0000  1900 ;
                                     0000  2000 ; CALLING SEQUENCE:
                                     0000  2100 ;
                                     0000  2200 ;	Complex_quotient.wfc.w = OTS$DIVC(dividend.rfc.v, divisor.rfc.v)
                                     0000  2300 ;
                                     0000  2400 ; INPUT PARAMETERS:
                                     0000  2500 ;
                                     0000  2600 ;	Dividend and divisor parameters are represented as standard
                                     0000  2700 ;	FORTRAN COMPLEX numbers and are CALL BY VALUE.
                                     0000  2800 ;
                                     0000  2900 ; IMPLICIT INPUTS:
                                     0000  3000 ;	NONE
                                     0000  3100 ;
                                     0000  3200 ; OUTPUT PARAMETERS:
                                     0000  3300 ;	NONE
                                     0000  3400 ;
                                     0000  3500 ; IMPLICIT OUTPUTS:
                                     0000  3600 ;	NONE
                                     0000  3700 ;
                                     0000  3800 ; FUNCTIONAL VALUE:
                                     0000  3900 ;
                                     0000  4000 ;	The COMPLEX value returned is (a, b) / (c, d)
                                     0000  4100 ;
                                     0000  4200 ; SIDE EFFECTS:
                                     0000  4300 ;
                                     0000  4400 ;	SS$ARITH is SIGNALed by hardware on floating zero divide
                                     0000  4500 ;	SS$ARITH is SIGNALed by hardware on floating overflow
                                     0000  4600 ;--
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   5
0-04            COMPLEX / COMPLEX giving COMPLEX result                                                                          (5)

                               003C' 0000   100 	.ENTRY	OTS$DIVC, ^M<R2,R3,R4,R5>	; disable integer overflow
                                     0002   200 	MTH$FLAG_JACKET			; establish math error handler
                                     0002      
            6D       0000'CF     3E  0002       	MOVAW	W^MTH$$JACKET_HND, (FP)
                                     0007       					; set handler address to jacket
                                     0007       					; handler
                                     0007       
            54         0C AC     7D  0007   300 	MOVQ	c(AP), R4		; R4/R5 = divisor
                                     000B   400 
                                     000B   500 ; Perform scaling of all operands before division
                                     000B   600 ;
            08            07     EF  000B   700 	EXTZV	#7, #8, R4, R2		; R2 = R4<exp>  0,1,...377
            52            54         000E       
            08            07     EF  0010   800 	EXTZV	#7, #8, R5, R1		; R1 = R5<exp>  0,1,...377
            51            55         0013       
            52            51     B1  0015   900 	CMPW	R1, R2			; R1 = MAX (c<exp>, d<exp>)
                          03     14  0018  1000 	BGTR	2$
            51            52     B0  001A  1100 	MOVW	R2, R1
            51            51     8E  001D  1200 2$:	MNEGB	R1, R1			; R1 = scaling exponent  0,377,376,...,1
            51            07     9C  0020  1300 	ROTL	#7, R1, R1		; build a floating scale factor
                          51         0023       
                                     0024  1400 					; scale all operands
            54            51     44  0024  1500 	MULF	R1, R4			; c
            55            51     44  0027  1600 	MULF	R1, R5			; d
         04 AC            51     45  002A  1700 	MULF3	R1, a(AP), R2		; a
                          52         002E       
            51         08 AC     44  002F  1800 	MULF	b(AP), R1		; b
                                     0033  1900 
            54            52     45  0033  2000 	MULF3	R2,R4,R0		; R0 = ac
                          50         0036       
            55            51     45  0037  2100 	MULF3	R1, R5, R3		; R3 = bd
                          53         003A       
            50            53     40  003B  2200 	ADDF	R3, R0			; R0 = ac+bd
            52            55     44  003E  2300 	MULF	R5, R2			; R2 = ad
            51            54     44  0041  2400 	MULF	R4, R1			; R1 = bc
            51            52     42  0044  2500 	SUBF	R2, R1			; R1 = bc - ad
            54            54     44  0047  2600 	MULF	R4, R4			; R4 = cc
            55            55     44  004A  2700 	MULF	R5, R5			; R5 = dd
            55            54     40  004D  2800 	ADDF	R4, R5			; R5 = cc + dd
            50            55     46  0050  2900 	DIVF	R5, R0			; R0 = (ac+bd) / (cc+dd)
            51            55     46  0053  3000 	DIVF	R5, R1			; R1 = (bc-ad) / (cc+dd)
                                     0056  3100 
                                 04  0056  3200 	RET				; (R0, R1) = (r, i)
                                     0057  3300 
                                     0057  3400 	.END
OTS$DIVC        - COMPLEX / COMPLEX DIVISION ROUTINE             21-AUG-1978 19:09:24   VAX-11 MACRO X0.3-11               Page   6
SYMBOL TABLE                                                                                                                     (5)

A              = 00000004            
B              = 00000008            
C              = 0000000C            
D              = 00000010            
FOR$K_ERR_PREFX= 00000018            
MTH$$JACKET_HND  ********   X   02   
MTH$K_ERR_PREFX= 00000016            
MTH__FLOOVEMAT = 00000058            
MTH__FLOUNDMAT = 00000059            
MTH__INVARG    = 00000051            
MTH__LOGZERNEG = 00000053            
MTH__SINSIGLOS = 00000057            
MTH__SQUROONEG = 00000054            
MTH__UNDEXP    = 00000052            
MTH__WRONUMARG = 00000050            
OTS$DIVC         00000000 RG    02   


PROGRAM SECTION SYNOPSIS

.  ABS  .        00000000      00     NOPIC   USR   CON   ABS   LCL NOSHR NOEXE NORD  NOWRT BYTE  
. BLANK .        00000000      01     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD    WRT BYTE  
OTS$CODE         00000057      02       PIC   USR   CON   REL   LCL   SHR   EXE   RD  NOWRT LONG  


THERE WERE NO ERRORS OR WARNINGS.
27976. BYTES LEFT IN FREE MEMORY POOL.
OBJ$:OTSDIVC,LIS$:OTSDIVC/-SP=LIB$:S/ML,SRC$:P,OTSDIVC
0 MLB DIR RDS - 0 GETS TO DEFINE 0 MACROS. 2 INTER. FILE WRITES. 
