RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   0
TABLE OF CONTENTS   

   (1)      42  DECLARATIONS
   (1)      69  RMS$RMSRUNDWN  -  RMS I/O RUN DOWN
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   1
012                                                                                                                              (1)

                                     0000     1 	$BEGIN	RMS0RNDWN,012,F$RMSCLOSERNDN,<RMS IO RUN DOWN>
                                     0000     2 
                                     0000     3 ;
                                     0000     4 ; COPYRIGHT (C) 1977
                                     0000     5 ; DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS 01754
                                     0000     6 ;
                                     0000     7 ; THIS SOFTWARE IS FURNISHED  UNDER A LICENSE FOR USE ONLY ON A SINGLE
                                     0000     8 ; COMPUTER  SYSTEM AND  MAY BE  COPIED ONLY WITH  THE INCLUSION OF THE
                                     0000     9 ; ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE, OR ANY OTHER COPIES THEREOF,
                                     0000    10 ; MAY NOT BE PROVIDED OR  OTHERWISE MADE AVAILABLE TO ANY OTHER PERSON
                                     0000    11 ; EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO AGREES TO THESE LICENSE
                                     0000    12 ; TERMS.  TITLE TO AND  OWNERSHIP OF THE  SOFTWARE  SHALL AT ALL TIMES
                                     0000    13 ; REMAIN IN DEC.
                                     0000    14 ;
                                     0000    15 ; THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE WITHOUT NOTICE
                                     0000    16 ; AND SHOULD  NOT BE CONSTRUED  AS A COMMITMENT  BY DIGITAL  EQUIPMENT
                                     0000    17 ; CORPORATION.
                                     0000    18 ;
                                     0000    19 ; DEC ASSUMES  NO  RESPONSIBILITY  FOR  THE USE OR  RELIABILITY OF ITS
                                     0000    20 ; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
                                     0000    21 ;
                                     0000    22 ;++
                                     0000    23 ; FACILITY: RMS32
                                     0000    24 ;
                                     0000    25 ; ABSTRACT: THIS MODULE INSURES ALL RMS I/O ACTIVITY IS COMPLETE,
                                     0000    26 ;	    CLOSES ALL FILES, AND RESETS THE IFAB AND IRAB TABLES.
                                     0000    27 ;
                                     0000    28 ; ENVIRONMENT:
                                     0000    29 ;		STAR PROCESSOR RUNNING STARLET EXEC.
                                     0000    30 ;
                                     0000    31 ; AUTHOR: L F LAVERDURE,	 CREATION DATE: 5-5-77
                                     0000    32 ;
                                     0000    33 ; MODIFIED BY:
                                     0000    34 ;
                                     0000    35 ;	R A NEWELL,      2-AUG-78  9:56
                                     0000    36 ;	L F LAVERDURE,      26-JUL-78  17:54
                                     0000    37 ;	L F LAVERDURE,      26-JUL-78  14:25	CANCEL I/O ON IFAB BUSY
                                     0000    38 ;	L F LAVERDURE,   13-JUL-78  15:48
                                     0000    39 ; 01	- 
                                     0000    40 ;--
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   2
012             DECLARATIONS                                                                                                     (1)

                                     0000    42 	.SBTTL	DECLARATIONS
                                     0000    43 ;
                                     0000    44 ; INCLUDE FILES:
                                     0000    45 ;
                                     0000    46 
                                     0000    47 ;
                                     0000    48 ; MACROS:
                                     0000    49 ;
                                     0000    50 	$FABDEF
                                     0000    51 	$IFBDEF
                                     0000    52 	$IRBDEF
                                     0000    53 	$DEVDEF
                                     0000    54 	$IMPDEF
                                     0000    55 	$PIODEF
                                     0000    56 	$PSLDEF
                                     0000    57 	$RMSDEF
                                     0000    58 	.LIST MEB
                                     0000    59 
                                     0000    60 ;
                                     0000    61 ; EQUATED SYMBOLS:
                                     0000    62 ;
                                     0000    63 
                                     0000    64 ;
                                     0000    65 ; OWN STORAGE:
                                     0000    66 ;
                                     0000    67 
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   3
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0000    69 	.SBTTL RMS$RMSRUNDWN  -  RMS I/O RUN DOWN
                                     0000    70 ;++
                                     0000    71 ; FUNCTIONAL DESCRIPTION:
                                     0000    72 ;
                                     0000    73 ; THIS ROUTINE FIRST DETERMINES THE TYPE OF RUNDOWN DESIRED, BASED
                                     0000    74 ; UPON THE SECOND ARGUMENT.  IF THE TYPE IS "ABORT RMS I/O", A BRANCH
                                     0000    75 ; IS MADE TO RM$LAST_CHANCE, OTHERWISE THE ROUTINE CHECKS THAT ALL IFABS AND IRABS
                                     0000    76 ; ARE INACTIVE.  IF ANY FOUND ACTIVE THIS ROUTINE AWAITS THEIR COMPLETION AFTER
                                     0000    77 ; FIRST PERFORMING A $CANCEL I/O IF NOT A FILE-ORIENTED DEVICE.
                                     0000    78 ; WHEN ALL I/O ACTIVITY FOR THE FILE IS COMPLETE, $CLOSE IS
                                     0000    79 ; PERFORMED FOR THE FILE.  IF THE CLOSE FAILED FOR AN OUTPUT FILE
                                     0000    80 ; ON A FILES-OREIENTED DEVICE, AN ERROR IS RETURNED TO THE CALLER
                                     0000    81 ; WHO SHOULD NOTE THE ERROR AND RECALL THIS ROUTINE TO RUN DOWN
                                     0000    82 ; FURTHER FILES.  IF ALL FILES ARE SUCCESSFULLY RUN DOWN THE
                                     0000    83 ; IMAGE IFAB & IRAB TABLES ARE RESET AND RETURN IS MADE TO THE
                                     0000    84 ; CALLER WITH A SUCCESS CODE.
                                     0000    85 ;
                                     0000    86 ; FILES ARE RUN DOWN IN THIS ORDER:
                                     0000    87 ;
                                     0000    88 ;	1.  INDIRECT PROCESS PERMANENT FILES
                                     0000    89 ;	    ('ERROR' SHOULD BE FIRST)
                                     0000    90 ;	2.  IMAGE FILES
                                     0000    91 ;	3.  (ONLY IF CALLER'S MODE IS NOT USER AND ARG2=1)
                                     0000    92 ;	    PROCESS PERMANENT FILES
                                     0000    93 ;
                                     0000    94 ; CALLING SEQUENCE:
                                     0000    95 ;
                                     0000    96 ;	CALLS	#2, SYS$RMSRUNDWN
                                     0000    97 ;
                                     0000    98 ; INPUT PARAMETERS:
                                     0000    99 ;
                                     0000   100 ;	AP	USERS ARGUMENT LIST (2 ARGUMENTS)
                                     0000   101 ;
                                     0000   102 ;	ARG1	DESCRIPTOR FOR 22-CHARACTER BUFFER
                                     0000   103 ;		TO RECEIVE INFORMATION ABOUT
                                     0000   104 ;		UNSUCCESSFULLY CLOSED OUTPUT FILE
                                     0000   105 ;		(DEVICE ID AND FILE ID)
                                     0000   106 ;	ARG2	RUNDOWN TYPE, AS FOLLOWS:
                                     0000   107 ;
                                     0000   108 ;		0 - RUN DOWN OF IMAGE AND INDIRECT I/O FOR PROCESS PERMANENT FILES
                                     0000   109 ;		1 - RUN DOWN OF IMAGE AND PROCESS PERMANENT FILES
                                     0000   110 ;		    (CALLER'S MODE MUST BE OTHER THAN USER)
                                     0000   111 ;		2 - ABORT RMS I/O (CALLER'S MODE MUST BE EXEC OR KERNEL)
                                     0000   112 ;
                                     0000   113 ;		ALL OTHERS ARE RESERVED, BUT CURRENTLY BEHAVE AS TYPE 0
                                     0000   114 ;
                                     0000   115 ; IMPLICIT INPUTS:
                                     0000   116 ;
                                     0000   117 ;	CALLER'S MODE.
                                     0000   118 ;
                                     0000   119 ; OUTPUT PARAMETERS:
                                     0000   120 ;
                                     0000   121 ;	R0	STATUS CODE
                                     0000   122 ;	R1	DESTROYED
                                     0000   123 ;
                                     0000   124 ; IMPLICIT OUTPUTS:
                                     0000   125 ;
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   4
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0000   126 ; INFORMATION DESCRIBING AN OUTPUT FILE UNSUCCESSFULLY CLOSED IS
                                     0000   127 ; STORED IN THE CALLER-PROVIDED BUFFER IN EXACTLY THE SAME
                                     0000   128 ; FORMAT AS THE DVI, DID, AND FID FIELDS OF THE NAM BLOCK.
                                     0000   129 ;
                                     0000   130 ; COMPLETION CODES:
                                     0000   131 ;
                                     0000   132 ;	STANDARD RMS, IN PARTICULAR:
                                     0000   133 ;
                                     0000   134 ;	RMS$_SUC  -  ALL FILES CLOSED
                                     0000   135 ;	RMS$_CCF  -  AN OUTPUT FILE COULD NOT BE CLOSED
                                     0000   136 ;		     SUCCESSFULLY.  CALLER-PROVIDED BUFFER
                                     0000   137 ;		     HAS INFORMATION IDENTIFYING THE FILE
                                     0000   138 ;	RMS$_IAL  -  SAME AS RMS$_CCF EXCEPT COULD NOT
                                     0000   139 ;		     ACCESS CALLER'S BUFFER TO STORE FILE
                                     0000   140 ;		     ID INFORMATION.
                                     0000   141 ;
                                     0000   142 ; SIDE EFFECTS:
                                     0000   143 ;
                                     0000   144 ;	RUNS SYNCHRONOUSLY IN EXEC MODE INHIBITING
                                     0000   145 ;	AND ENABLING ASTS AS REQUIRED.
                                     0000   146 ;
                                     0000   147 ;--
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   5
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0000   149 	$ENTRY	RMS$RMSRUNDWN
                                 00000000       	.PSECT	F$RMSCLOSERNDN,GBL,NOWRT
                                     0000   150 	$TSTPT	RUNDWN
                 00000200'9F     D6  0000       		INCL	@#PIO$GL_FMLH+512+TPT$L_RUNDWN
                          5B     DC  0006   151 	MOVPSL	R11
            02            16     EF  0008   152 	EXTZV	#PSL$V_PRVMOD,#PSL$S_PRVMOD,R11,R7	; SAVE CALLER'S MODE
            57            5B         000B       
            02         08 AC     D1  000D   153 	CMPL	8(AP),#2			; ABORT RMS I/O?
                          5E     13  0011   154 	BEQL	RMSABORT			; BRANCH IF YES
                          71     10  0013   155 5$:	BSBB	INHAST				; INHIBIT RMS AST'S
                                     0015   156 ;
                                     0015   157 ; START BY RUNNING DOWN INDIRECT I/O ON
                                     0015   158 ; PROCESS-PERMANENT FILES
                                     0015   159 ;
            5B   00000000'9F     DE  0015   160 	MOVAL	@#PIO$GW_PIOIMPA,R11		; GET PIO IMPURE AREA ADDRESS
                                     001C   161 	ASSUME	IMP$W_RMSSTATUS EQ 0
            58            01     D0  001C   162 	MOVL	#1,R8				; INDICATE INDIRECT RUN DOWN
                          0083   30  001F   163 	BSBW	RUNDWN				; DO THE RUN DOWN
                                     0022   164 						; (NOTE: CLEARS R8)
                                     0022   165 ;
                                     0022   166 ; NOW RUN DOWN THE IMAGE
                                     0022   167 ;
            5B       0000'CB     DE  0022   168 	MOVAL	W^PIO$GW_IIOIMPA-PIO$GW_PIOIMPA(R11),R11
                                     0027   169 						; POINT TO IMAGE IMPURE AREA
                          007B   30  0027   170 	BSBW	RUNDWN				; DO THE RUN DOWN
                       18 BB     D4  002A   171 	CLRL	@IMP$L_IFABTBL(R11)		; RESET IFAB TABLE LINK
                       1C BB     D4  002D   172 	CLRL	@IMP$L_IRABTBL(R11)		; RESET IRAB TABLE LINK
                                     0030   173 ;
                                     0030   174 ; RETURN ANY EMPTY PROCESS I/O SEGMENT PAGES FROM
                                     0030   175 ; FREE SPACE TO FREE PAGE LIST
                                     0030   176 ;	(THEY MAY HAVE BEEN ALLOCATED FOR ASB'S)
                                     0030   177 ;
            5B       0000'CB     DE  0030   178 	MOVAL	W^PIO$GW_PIOIMPA-PIO$GW_IIOIMPA(R11),R11
                                     0035   179 						; POINT TO PROCESS
                                     0035   180 						; I/O IMPURE AREA AGAIN
            5A       0000'CB     DE  0035   181 	MOVAL	W^PIO$GL_FMLH-PIO$GW_PIOIMPA(R11),R10
                                     003A   182 						; GET FREE SPACE LIST
                                     003A   183 						; HEADER ADDR
            54            6A     D0  003A   184 	MOVL	(R10),R4			; GET 1ST HOLE ADDR
            5A            54     B1  003D   185 10$:	CMPW	R4,R10				; BACK AT LIST HEAD?
                          18     13  0040   186 	BEQL	30$				; BRANCH IF SO (DONE)
            56            64     D0  0042   187 	MOVL	(R4),R6				; GET NEXT HOLE ADDR
   00000200 8F         08 A4     D1  0045   188 	CMPL	8(R4),#512			; IS HOLE = A WHOLE PAGE?
                          06     12  004D   189 	BNEQ	20$				; BRANCH IF NOT
            54            64     0F  004F   190 	REMQUE	(R4),R4				; YES - REMOVE FROM LIST
                          FFAB'  30  0052   191 	BSBW	RM$RET1PAG			; AND RETURN TO FREE PAGE LIST
            54            56     D0  0055   192 20$:	MOVL	R6,R4				; GET NEXT HOLE ADDR
                          E3     11  0058   193 	BRB	10$				; & TRY AGAIN
                                     005A   194 30$:
                                     005A   195 ;
                                     005A   196 ; NOW RUN DOWN DIRECT I/O ON PROCESS-PERMANENT FILES IF DESIRED
                                     005A   197 ;
            01         08 AC     91  005A   198 	CMPB	8(AP),#1			; PPF RUNDOWN?
                          07     12  005E   199 	BNEQ	XITSUC				; BRANCH IF NOT
            03            57     91  0060   200 	CMPB	R7,#PSL$C_USER			; CALLER SUFFICIENTLY PRIVILEGED?
                          02     13  0063   201 	BEQL	XITSUC				; BRANCH IF NOT
                          3E     10  0065   202 60$:	BSBB	RUNDWN				; DO THE RUN DOWN
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   6
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0067   203 XITSUC:	RMSSUC
            50            01     D0  0067       		MOVL	#1,R0
                                     006A   204 EXIT:
                                     006A   205 	SSB	#16, R0				; STAMP 'RMS' ON STATUS CODE
            50            10     E2  006A       		BBSS	#16,R0,30000$
                          00         006D       
                                     006E       30000$:
                          04     10  006E   206 	BSBB	ENBAST				; ENABLE ASTS
                                 04  0070   207 	RET					; BACK TO CALLER
                                     0071   208 ;
                                     0071   209 ;  BRANCH TO RM$LAST_CHANCE TO DO ASYNC PROCESS DELETION RMS I/O ABORT
                                     0071   210 ;
                                     0071   211 RMSABORT:
                          FF8C'  31  0071   212 	BRW	RM$LAST_CHANCE
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   7
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0074   214 ;
                                     0074   215 ; ENABLE RMS AST'S, REENABLING EXEC AST'S IF NECESSARY.
                                     0074   216 ;
   00000000'9F            00     E4  0074   217 ENBAST:	BBSC	#PIO$V_INHAST, @#PIO$GW_STATUS, 10$
                          09         007B       
                                     007C   218 						; CLEAR AST INHIBIT
                                     007C   219 						; IF ALREADY CLEAR MUST ENABLE ASTS
                                     007C   220 	$SETAST_S	#1			; ENABLE EXEC MODE ASTS
                          01     DD  007C       		PUSHL	#1
   00000000'GF            01     FB  007E       		CALLS	#1,G^SYS$SETAST
                                 05  0085   221 10$:	RSB
                                     0086   222 ;
                                     0086   223 ; INHIBIT RMS ASTS
                                     0086   224 ;
   00000000'9F            01     A8  0086   225 INHAST:	BISW2	#1@PIO$V_INHAST, @#PIO$GW_STATUS
                                 05  008D   226 	RSB
                                     008E   227 ;
                                     008E   228 ; WAIT FOR RMS OPERATION COMPLETION
                                     008E   229 ;
                                     008E   230 WAIT:	$CLREF_S	#IMP$C_IOREFN		; CLEAR RMS EVENT FLAG
                          1E     DD  008E       		PUSHL	#IMP$C_IOREFN
   00000000'GF            01     FB  0090       		CALLS	#1,G^SYS$CLREF
                          DB     10  0097   231 	BSBB		ENBAST			; ENABLE ASTS
                                     0099   232 	$WAITFR_S	#IMP$C_IOREFN		; WAIT FOR FLAG
                          1E     DD  0099       		PUSHL	#IMP$C_IOREFN
   00000000'GF            01     FB  009B       		CALLS	#1,G^SYS$WAITFR
                          E2     10  00A2   233 	BSBB		INHAST			; RE-INHIBIT ASTS
                                 05  00A4   234 	RSB
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   8
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     00A5   236 ;++
                                     00A5   237 ;
                                     00A5   238 ; RUN DOWN SUBROUTINE:
                                     00A5   239 ;
                                     00A5   240 ; CHECKS IFAB TABLE FOR ACTIVE FILES.
                                     00A5   241 ; IF ANY FOUND WAITS FOR ANY I/O ACTIVITY TO FINISH
                                     00A5   242 ; (DOING A CANCELL I/O FOR NON FILES-ORIENTED DEVICES)
                                     00A5   243 ; AND THEN ISSUES A $CLOSE REQUEST.
                                     00A5   244 ;
                                     00A5   245 ; WHEN ALL FILES RUN DOWN PERFORMS A SANITY CHECK BY SEEING IF ALL IRAB
                                     00A5   246 ; TABLE ENTRIES ARE ALSO ZERO.
                                     00A5   247 ;
                                     00A5   248 ; INPUTS:
                                     00A5   249 ;	R11 - IMPURE AREA ADDR
                                     00A5   250 ;	R8 - BIT 0 SET IF INDIRECT PPF RUN DOWN
                                     00A5   251 ;	AP - CALLER'S ARG LIST
                                     00A5   252 ;	R7 - CALLER'S MODE
                                     00A5   253 ;
                                     00A5   254 ; OUTPUTS:
                                     00A5   255 ;	RETURNS ONLY IF NOERROR ENCOUNTERED.
                                     00A5   256 ;	IMP$V_PPFINDRD CLEARED
                                     00A5   257 ;	R0 - R6, R9, R10 DESTROYED
                                     00A5   258 ;--
                                     00A5   259 RUNDWN:
                                     00A5   260 	SSB	#IMP$V_IORUNDOWN,(R11)		; SET I/O RUNDOWN IN PROGRESS FLAG
            6B            04     E2  00A5       		BBSS	#IMP$V_IORUNDOWN,(R11),30001$
                          00         00A8       
                                     00A9       30001$:
                                     00A9   261 						; TO SYNC WITH AST-DRIVEN RMS
                                     00A9   262 						; OPERATIONS
            55         18 AB     D0  00A9   263 	MOVL	IMP$L_IFABTBL(R11),R5		; GET IFAB TABLE ADDR
                          56     D4  00AD   264 	CLRL	R6				; BUILD IFI VALUE HERE
            52            85     D0  00AF   265 NXTSEG:	MOVL	(R5)+,R2			; SAVE ADDR NEXT TABLE SEG IN R2
            54         20 AB     3C  00B2   266 	MOVZWL	IMP$W_ENTPERSEG(R11),R4		; GET # ENTRIES/SEG
                       22 AB     B5  00B6   267 NXTENT:	TSTW	IMP$W_NUM_IFABS(R11)		; ANY IFABS ACTIVE?
                          0F     13  00B9   268 	BEQL	CHKIRB				; BRANCH IF NONE
                          56     D6  00BB   269 	INCL	R6				; BUMP IFI
            5A            85     D0  00BD   270 	MOVL	(R5)+,R10			; GET IFAB ADDR
                          28     12  00C0   271 	BNEQ	RDIFAB				; BRANCH IF ONE
            F1            54     F5  00C2   272 NXTSOB:	SOBGTR	R4,NXTENT			; KEEP SCANNING SEGMENT
                                     00C5   273 ;
                                     00C5   274 ; NO MORE IFABS THIS SEGMENT, TRY NEXT
                                     00C5   275 ;
            55            52     D0  00C5   276 	MOVL	R2,R5				; GET NEXT SEGMENT ADDR
                          E5     12  00C8   277 	BNEQ	NXTSEG				; BRANCH IF ONE
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page   9
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     00CA   279 ;
                                     00CA   280 ; ALL IFABS HAVE BEEN RUN DOWN NOW.
                                     00CA   281 ;
                                     00CA   282 ; UNLESS THIS IS INDIRECT RUN DOWN OF PPF'S,
                                     00CA   283 ; CHECK THAT ALL IRABS ARE ALSO GONE.
                                     00CA   284 ;
                                     00CA   285 CHKIRB:
                           00000008  00CA   286 	.IF NE $$RMSTEST&$$RMS_TBUGCHK
            58            00     E4  00CA   287 	BBSC	#0,R8,30$			; BRANCH IF INDIRECT RUN DOWN
                          17         00CD       
            55         1C AB     D0  00CE   288 	MOVL	IMP$L_IRABTBL(R11),R5		; GET IRAB TABLE ADDR
            52            85     D0  00D2   289 10$:	MOVL	(R5)+,R2			; SAVE ADDR NEXT TABLE SEG.
            54         20 AB     3C  00D5   290 	MOVZWL	IMP$W_ENTPERSEG(R11),R4		; GET # ENTRIES/SEG.
                          85     D5  00D9   291 20$:	TSTL	(R5)+				; ENTRY ZERO?
                          55     12  00DB   292 	BNEQ	ERRBUG				; BRANCH IF NOT
            F9            54     F5  00DD   293 	SOBGTR	R4,20$				; BRANCH IF MORE ENTRIES
            55            52     D0  00E0   294 	MOVL	R2,R5				; GET NEXT SEG ADDR
                          ED     12  00E3   295 	BNEQ	10$				; BRANCH IF ONE
                                     00E5   296 30$:	CSB	#IMP$V_IORUNDOWN,(R11)		; TURN OFF RUNDOWN IN PROGRESS FLAG
            6B            04     E5  00E5       		BBCC	#IMP$V_IORUNDOWN,(R11),30002$
                          00         00E8       
                                     00E9       30002$:
                                     00E9   297 	.ENDC
                                 05  00E9   298 	RSB					; ALL O.K.
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  10
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     00EA   300 ;
                                     00EA   301 ; FOUND AN IFAB.  CHECK FOR ACTIVE AND IF SO ALLOW OPERATION TO FINISH
                                     00EA   302 ;
                                     00EA   303 	ASSUME	IMP$W_RMSSTATUS EQ 0
                                     00EA   304 RDIFAB:
            1A            58     E8  00EA   305 	BLBS	R8,RDIRAB			; BRANCH IF INDIRECT PPF
            6A            20     E1  00ED   306 10$:	BBC	#IFB$V_BUSY,(R10),RDIRAB
                          16         00F0       
                                     00F1   307 ;
                                     00F1   308 ; ALLOW THE FAB FUNCTION TO FINISH
                                     00F1   309 ; \NOTE: THIS CODE SHOULD BE MODIFIED TO
                                     00F1   310 ; PROPERLY RUN DOWN READ-AHEAD AND WRITE-BEHIND
                                     00F1   311 ; OPERATIONS TO UNIT RECORD DEVICES.\
                                     00F1   312 ;
                                     00F1   313 20$:	$CANCEL_S	IFB$W_CHNL(R10)		; CANCEL I/O (E.G. MAGTAPE CREATE)
            7E         20 AA     3C  00F1       		MOVZWL	IFB$W_CHNL(R10),-(SP)
   00000000'GF            01     FB  00F5       		CALLS	#1,G^SYS$CANCEL
                          90     10  00FC   314 	BSBB	WAIT				; WAIT FOR AN OPERATION TO FINISH
                       FC A5     D5  00FE   315 	TSTL	-4(R5)				; IFAB DISAPPEAR? (CLOSE)
                          BF     13  0101   316 	BEQL	NXTSOB				; BRANCH IF YES
            6A            20     E0  0103   317 	BBS	#IFB$V_BUSY,(R10),20$
                          EA         0106       
                                     0107   318 						; BRANCH IF STILL BUSY
                                     0107   319 ;
                                     0107   320 ; RUN DOWN IRABS
                                     0107   321 ;
                                     0107   322 RDIRAB:
            59            5A     D0  0107   323 	MOVL	R10,R9				; COPY IFAB ADDR
            59         1C A9     D0  010A   324 10$:	MOVL	IRB$L_IRAB_LNK(R9),R9		; GET NEXT IRAB
                          26     13  010E   325 	BEQL	QUIET				; BRANCH IF NONE
            69            20     E1  0110   326 	BBC	#IRB$V_BUSY,(R9),10$		; BRANCH IF IDLE
                          F6         0113       
            07            6B     E8  0114   327 	BLBS	(R11), 20$			; BRANCH IF IMAGE I/O SEGMENT
            69            22     E0  0117   328 	BBS	#IRB$V_PPF_IMAGE,(R9),20$
                          03         011A       
                                     011B   329 						; BRANCH IF INDIRECT I/O
            EC            58     E9  011B   330 	BLBC	R8,10$				; BRANCH IF ONLY INDIRECT PPFS
                                     011E   331 						; TO BE RUN DOWN
            6A            1C     E0  011E   332 20$:	BBS	#DEV$V_RND,IFB$L_PRIM_DEV(R10),30$
                          0B         0121       
                                     0122   333 						; BRANCH IF DISK DEVICE
                                     0122   334 	$CANCEL_S	IFB$W_CHNL(R10)		; CANCEL I/O
            7E         20 AA     3C  0122       		MOVZWL	IFB$W_CHNL(R10),-(SP)
   00000000'GF            01     FB  0126       		CALLS	#1,G^SYS$CANCEL
                          FF5E   30  012D   335 30$:	BSBW	WAIT
                          D5     11  0130   336 	BRB	RDIRAB				; START FROM TOP OF IRAB
                                     0132   337 						; CHAIN AGAIN (COULD
                                     0132   338 						; HAVE BEEN DISCONNECT)
                                     0132   339 ;
                                     0132   340 ; CLOSE FAILED TO ZERO IFAB OR IRAB TABLE ENTRY
                                     0132   341 ;
                                     0132   342 ERRBUG:	RMSTBUG	FTL$_IORNDN
                                     0132       	.SAVE
                                 0000006C       	.PSECT	$ABS$,ABS
                           00000000  006C       	.=0
                                 00000132       	.RESTORE
                          FECB'  30  0132       		BSBW	RM$BUG
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  11
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                 EE  0135       		.BYTE	FTL$_IORNDN
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  12
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                                     0136   344 ;
                                     0136   345 ; ALL ACTIVITY CEASED FOR THIS FILE.
                                     0136   346 ; FORCE A CLOSE BY CONSTRUCTING A FAB AND CALLING CLOSE.
                                     0136   347 ;
            6A            30     E1  0136   348 QUIET:	BBC	#IFB$V_WRTACC,(R10),NOERR
                          39         0139       
            6A            03     E1  013A   349 	BBC	#DEV$V_DIR, IFB$L_PRIM_DEV(R10), NOERR
                          35         013D       
            6A            25     E1  013E   350 	BBC	#IFB$V_ACCESSED,(R10),NOERR	; BRANCH IF FILE NOT ACCESSED
                          31         0141       
            50         04 AC     D0  0142   351 	MOVL	4(AP),R0			; GET DESCRIPTOR ADDR
                                     0146   352 	IFNORD	#8, (R0), NOERR1, R7
            08            57     0C  0146       		PROBER	R7,#8,(R0)
                          60         0149       
                          20     13  014A       		BEQL	NOERR1
            1C            60     B1  014C   353 	CMPW	(R0), #28			; AT LEAST 22 BYTES LONG?
                          1B     1F  014F   354 	BLSSU	NOERR1
            53         04 A0     D0  0151   355 	MOVL	4(R0),R3			; GET BUFFER ADDRESS
            59            5A     D0  0155   356 	MOVL	R10,R9				; IFAB TO RIGHT REGISTER
                                     0158   357 	IFNOWRT	#22,(R3),NOERR1,R7		; BRANCH IF BUFFER NOT WRITABLE
            16            57     0D  0158       		PROBEW	R7,#22,(R3)
                          63         015B       
                          0E     13  015C       		BEQL	NOERR1
                          04     BB  015E   358 	PUSHR	#^M<R2>				; SAVE R2 (PTR TO NEXT IFI SEG)
                          FE9D'  30  0160   359 	BSBW	RM$GETDVIFID			; GO FILL BUFFER WITH DVI AND FID
                          04     BA  0163   360 	POPR	#^M<R2>				; RESTORE R2
                                     0165   361 	RMSERR	CCF,R3				; GET SET FOR CLOSE FAILURE
            53       C0DC 8F     3C  0165       		MOVZWL	#<RMS$_CCF&^XFFFF>,R3
                          0A     11  016A   362 	BRB	CLOSE
                                     016C   363 NOERR1:	RMSERR	IAL,R3				; IF CLOSE FAILURE, RETURN IAL
            53       854C 8F     3C  016C       		MOVZWL	#<RMS$_IAL&^XFFFF>,R3
                          03     11  0171   364 	BRB	CLOSE
                                     0173   365 NOERR:	RMSSUC	SUC,R3				; CAN'T FAIL
            53            01     D0  0173       		MOVL	#1,R3
                                     0176   366 CLOSE:
            5E         B0 AE     DE  0176   367 	MOVAL	-FAB$C_BLN(SP),SP		; CREATE FAB ON STACK
            6E       5003 8F     B0  017A   368 	MOVW	#FAB$C_BID+<FAB$C_BLN @8>,(SP)
                                     017F   369 						; FAB BLOCK ID AND LENGTH
         02 AE            56     B0  017F   370 	MOVW	R6, FAB$W_IFI(SP)		; IFI
            0B            6B     E8  0183   371 	BLBS	(R11),10$			; BRANCH IF IIO SEG
                                     0186   372 	SSB	#15+<FAB$W_IFI*8>,(SP)		; SET PIO FLAG
            6E            1F     E2  0186       		BBSS	#15+<FAB$W_IFI*8>,(SP),30003$
                          00         0189       
                                     018A       30003$:
            04            58     E9  018A   373 	BLBC	R8,10$				; BRANCH IF DIRECT ACCESS
                                     018D   374 	SSB	#FAB$V_PPF_IND+<FAB$W_IFI*8>,(SP)	; ELSE MAKE INDIRECT IFI
            6E            1E     E2  018D       		BBSS	#FAB$V_PPF_IND+<FAB$W_IFI*8>,(SP),30004$
                          00         0190       
                                     0191       30004$:
                          3C     BB  0191   375 10$:	PUSHR	#^M<R2,R3,R4,R5>			; SAVE REGS
            6E            00     2C  0193   376 	MOVC5	#0,(SP),#0,#FAB$C_BLN-4,4+<4*4>(SP)	; ZERO REMAINDER OF FAB
       004C 8F            00         0196       
                       14 AE         019A       
                          3C     BA  019C   377 	POPR	#^M<R2,R3,R4,R5>			; RESTORE R5
                          FED3   30  019E   378 	BSBW	ENBAST
                          5E     DD  01A1   379 	PUSHL	SP				; ADDR OF FAB
   00000000'9F            01     FB  01A3   380 	CALLS	#1,@#SYS$CLOSE			; CLOSE IT
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  13
012             RMS$RMSRUNDWN  -  RMS I/O RUN DOWN                                                                               (1)

                          FED9   30  01AA   381 	BSBW	INHAST
            5E   00000050 8F     C0  01AD   382 	ADDL	#FAB$C_BLN,SP			; 'POP' FAB
            05            58     E8  01B4   383 	BLBS	R8,15$				; OMIT CHECK IF INDIRECT PPF
                       FC A5     D5  01B7   384 	TSTL	-4(R5)				; DID IFAB GO AWAY?
                          0F     12  01BA   385 	BNEQ	ERRBUG_BR			; BRANCH IF NOT
            03            50     E9  01BC   386 15$:	BLBC	R0,30$				; BRANCH ON ERROR
                          FF00   31  01BF   387 20$:	BRW	NXTSOB				; GET NEXT IFAB
            50            53     D0  01C2   388 30$:	MOVL	R3, R0				; GET SAVED ERROR CODE
            F7            50     E8  01C5   389 	BLBS	R0, 20$				; NO PROBLEM IF NOT
                                     01C8   390 						; WRITE-ACCESSED FILE
                          FE9F   31  01C8   391 	BRW	EXIT				; RETURN ERROR TO CALLER
                                     01CB   392 ERRBUG_BR:
                          FF64   31  01CB   393 	BRW	ERRBUG				; EXTENDED BRANCH
                                     01CE   394 	.END
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  14
SYMBOL TABLE                                                                                                                     (1)

$$.PSECT_EP    = 00000000            DEV$V_WCK      = 0000001F            FAB$M_GET      = 00000002            
$$RMSTEST      = 0000001A            ENBAST           00000074 R     02   FAB$M_INP      = 00080000            
$$RMS_PBUGCHK  = 00000010            ERRBUG           00000132 R     02   FAB$M_JNL      = 00400000            
$$RMS_TBUGCHK  = 00000008            ERRBUG_BR        000001CB R     02   FAB$M_KFO      = 40000000            
$$RMS_UMODE    = 00000004            EXIT             0000006A R     02   FAB$M_MSE      = 00000010            
BIT...         = 00000000            FAB$B_BID        00000000            FAB$M_MXV      = 00000002            
CHKIRB           000000CA R     02   FAB$B_BKS        0000003E            FAB$M_NAM      = 01000000            
CLOSE            00000176 R     02   FAB$B_BLN        00000001            FAB$M_NEF      = 00000400            
DEV$M_ALL      = 00800000            FAB$B_DNS        00000035            FAB$M_NFS      = 00010000            
DEV$M_AVL      = 00040000            FAB$B_FAC        00000016            FAB$M_NIL      = 00000020            
DEV$M_CCL      = 00000002            FAB$B_FNS        00000034            FAB$M_OFP      = 20000000            
DEV$M_DIR      = 00000008            FAB$B_FSZ        0000003F            FAB$M_POS      = 00000100            
DEV$M_DMT      = 00200000            FAB$B_ORG        0000001D            FAB$M_PPF      = 00040000            
DEV$M_ELG      = 00400000            FAB$B_RAT        0000001E            FAB$M_PPF_IND  = 00004000            
DEV$M_FOD      = 00004000            FAB$B_RFM        0000001F            FAB$M_PPF_RAT  = 00003FC0            
DEV$M_FOR      = 01000000            FAB$B_RTV        0000001C            FAB$M_PRN      = 00000004            
DEV$M_GEN      = 00020000            FAB$B_SHR        00000017            FAB$M_PUT      = 00000001            
DEV$M_IDV      = 04000000            FAB$C_BID      = 00000003            FAB$M_RCK      = 00800000            
DEV$M_MBX      = 00100000            FAB$C_BLN        00000050            FAB$M_RWC      = 00000800            
DEV$M_MNT      = 00080000            FAB$C_FIX      = 00000001            FAB$M_RWO      = 00000080            
DEV$M_NET      = 00002000            FAB$C_HSH      = 00000030            FAB$M_SCF      = 00004000            
DEV$M_ODV      = 08000000            FAB$C_IDX      = 00000020            FAB$M_SHRDEL   = 00000004            
DEV$M_RCK      = 40000000            FAB$C_MAXRFM   = 00000003            FAB$M_SHRGET   = 00000002            
DEV$M_REC      = 00000001            FAB$C_REL      = 00000010            FAB$M_SHRPUT   = 00000001            
DEV$M_RND      = 10000000            FAB$C_RFM_DFLT = 00000002            FAB$M_SHRUPD   = 00000008            
DEV$M_RTM      = 20000000            FAB$C_SEQ      = 00000000            FAB$M_SPL      = 00002000            
DEV$M_SDI      = 00000010            FAB$C_UDF      = 00000000            FAB$M_SQO      = 00000040            
DEV$M_SHR      = 00010000            FAB$C_VAR      = 00000002            FAB$M_SUP      = 00000004            
DEV$M_SPL      = 00000040            FAB$C_VFC      = 00000003            FAB$M_TEF      = 10000000            
DEV$M_SQD      = 00000020            FAB$K_BLN        00000050            FAB$M_TMD      = 00000010            
DEV$M_SWL      = 02000000            FAB$L_ALQ        00000010            FAB$M_TMP      = 00000008            
DEV$M_TRM      = 00000004            FAB$L_CTX        00000018            FAB$M_TRN      = 00000010            
DEV$M_WCK      = 80000000            FAB$L_DEV        00000040            FAB$M_UFM      = 04000000            
DEV$V_ALL      = 00000017            FAB$L_DNA        00000030            FAB$M_UFO      = 00020000            
DEV$V_AVL      = 00000012            FAB$L_FNA        0000002C            FAB$M_UPD      = 00000008            
DEV$V_CCL      = 00000001            FAB$L_FOP        00000004            FAB$M_UPI      = 00000040            
DEV$V_DIR      = 00000003            FAB$L_JNL        00000020            FAB$M_WCK      = 00000200            
DEV$V_DMT      = 00000015            FAB$L_MRN        00000038            FAB$S_ORG      = 00000004            
DEV$V_ELG      = 00000016            FAB$L_NAM        00000028            FAB$S_PPF_RAT  = 00000008            
DEV$V_FOD      = 0000000E            FAB$L_SDC        00000044            FAB$V_BIO      = 00000005            
DEV$V_FOR      = 00000018            FAB$L_STS        00000008            FAB$V_BLK      = 00000003            
DEV$V_GEN      = 00000011            FAB$L_STV        0000000C            FAB$V_BRO      = 00000006            
DEV$V_IDV      = 0000001A            FAB$L_XAB        00000024            FAB$V_CBT      = 00000015            
DEV$V_MBX      = 00000014            FAB$M_BIO      = 00000020            FAB$V_CIF      = 00000019            
DEV$V_MNT      = 00000013            FAB$M_BLK      = 00000008            FAB$V_CR       = 00000001            
DEV$V_NET      = 0000000D            FAB$M_BRO      = 00000040            FAB$V_CTG      = 00000014            
DEV$V_ODV      = 0000001B            FAB$M_CBT      = 00200000            FAB$V_DEL      = 00000002            
DEV$V_RCK      = 0000001E            FAB$M_CIF      = 02000000            FAB$V_DFW      = 00000005            
DEV$V_REC      = 00000000            FAB$M_CR       = 00000002            FAB$V_DLT      = 0000000F            
DEV$V_RND      = 0000001C            FAB$M_CTG      = 00100000            FAB$V_DMO      = 0000000C            
DEV$V_RTM      = 0000001D            FAB$M_DEL      = 00000004            FAB$V_ESC      = 0000001B            
DEV$V_SDI      = 00000004            FAB$M_DFW      = 00000020            FAB$V_EXE      = 00000007            
DEV$V_SHR      = 00000010            FAB$M_DLT      = 00008000            FAB$V_FTN      = 00000000            
DEV$V_SPL      = 00000006            FAB$M_DMO      = 00001000            FAB$V_GET      = 00000001            
DEV$V_SQD      = 00000005            FAB$M_ESC      = 08000000            FAB$V_INP      = 00000013            
DEV$V_SWL      = 00000019            FAB$M_EXE      = 00000080            FAB$V_JNL      = 00000016            
DEV$V_TRM      = 00000002            FAB$M_FTN      = 00000001            FAB$V_KFO      = 0000001E            
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  15
SYMBOL TABLE                                                                                                                     (1)

FAB$V_MSE      = 00000004            FTL$_RELEASFAIL= FFFFFFEA            IFB$L_NWA_PTR    00000028            
FAB$V_MXV      = 00000001            FTL$_SETPRTFAIL= FFFFFFFF            IFB$L_PRIM_DEV   00000000            
FAB$V_NAM      = 00000018            FTL$_STKTOOBIG = FFFFFFFE            IFB$L_RLB_LNK    0000002C            
FAB$V_NEF      = 0000000A            FTL$_XFERSIZE  = FFFFFFED            IFB$L_RNS_LEN    00000050            
FAB$V_NFS      = 00000010            GBL...         = 00000000            IFB$M_BIO      = 00000020            
FAB$V_NIL      = 00000005            IFB$B_AMAX       00000059            IFB$M_BRO      = 00000040            
FAB$V_OFP      = 0000001D            IFB$B_AVBN       00000058            IFB$M_DEL      = 00000004            
FAB$V_ORG      = 00000004            IFB$B_BID        00000008            IFB$M_EXE      = 00000080            
FAB$V_POS      = 00000008            IFB$B_BKS        0000004A            IFB$M_GET      = 00000002            
FAB$V_PPF      = 00000012            IFB$B_BLN        00000009            IFB$M_PUT      = 00000001            
FAB$V_PPF_IND  = 0000000E            IFB$B_EFN        0000000B            IFB$M_TRN      = 00000010            
FAB$V_PPF_RAT  = 00000006            IFB$B_EXTRABUF   0000005D            IFB$M_UPD      = 00000008            
FAB$V_PRN      = 00000002            IFB$B_FAC        00000022            IFB$S_ORG      = 00000004            
FAB$V_PUT      = 00000000            IFB$B_FSZ        0000004B            IFB$S_RFM      = 00000004            
FAB$V_RCK      = 00000017            IFB$B_KBUFSZ     0000005C            IFB$V_ACCESSED = 00000025            
FAB$V_RWC      = 0000000B            IFB$B_MODE       0000000A            IFB$V_ANSI_D   = 00000026            
FAB$V_RWO      = 00000007            IFB$B_NUM_KEYS   0000005A            IFB$V_ASYNC    = 00000023            
FAB$V_SCF      = 0000000E            IFB$B_ORGCASE    00000023            IFB$V_ASYNCWAIT= 00000024            
FAB$V_SHRDEL   = 00000002            IFB$B_RAT        0000003D            IFB$V_BIO      = 00000005            
FAB$V_SHRGET   = 00000001            IFB$B_RFMORG     0000003C            IFB$V_BRO      = 00000006            
FAB$V_SHRPUT   = 00000000            IFB$B_UBUFSZ     0000005B            IFB$V_BUSY     = 00000020            
FAB$V_SHRUPD   = 00000003            IFB$C_BID      = 0000000B            IFB$V_CREATE   = 00000032            
FAB$V_SPL      = 0000000D            IFB$C_BLN        00000060            IFB$V_DAP      = 0000003E            
FAB$V_SQO      = 00000006            IFB$C_BLN_IDX    00000060            IFB$V_DAP_OPEN = 0000003D            
FAB$V_SUP      = 00000002            IFB$C_BLN_REL    00000060            IFB$V_DEL      = 00000002            
FAB$V_TEF      = 0000001C            IFB$C_BLN_SEQ    0000005C            IFB$V_DFW      = 0000002C            
FAB$V_TMD      = 00000004            IFB$C_DIR      = 00000003            IFB$V_DLT      = 0000002B            
FAB$V_TMP      = 00000003            IFB$C_FHAEND     00000050            IFB$V_DMO      = 00000028            
FAB$V_TRN      = 00000004            IFB$C_IDX      = 00000002            IFB$V_EOF      = 00000021            
FAB$V_UFM      = 0000001A            IFB$C_MAXORG   = 00000002            IFB$V_EXE      = 00000007            
FAB$V_UFO      = 00000011            IFB$C_REL      = 00000001            IFB$V_GET      = 00000001            
FAB$V_UPD      = 00000003            IFB$C_SEQ      = 00000000            IFB$V_MSE      = 00000031            
FAB$V_UPI      = 00000006            IFB$K_BLN        00000060            IFB$V_NORECLK  = 00000033            
FAB$V_WCK      = 00000009            IFB$K_BLN_IDX    00000060            IFB$V_NSP      = 0000003F            
FAB$W_BLS        0000003C            IFB$K_BLN_REL    00000060            IFB$V_NWA      = 0000003C            
FAB$W_DEQ        00000014            IFB$K_BLN_SEQ    0000005C            IFB$V_ORG      = 00000004            
FAB$W_IFI        00000002            IFB$K_FHAEND     00000050            IFB$V_PPF_IMAGE= 00000022            
FAB$W_MRS        00000036            IFB$L_ARGLST     00000018            IFB$V_PPF_INPUT= 0000002E            
FTL$_ASBALLFAIL= FFFFFFF9            IFB$L_ASBADDR    00000014            IFB$V_PUT      = 00000000            
FTL$_BADASTPRM = FFFFFFF8            IFB$L_AS_DEV     00000054            IFB$V_RFM      = 00000000            
FTL$_BADBDB    = FFFFFFFA            IFB$L_BDB_BLNK   00000034            IFB$V_RWC      = 00000027            
FTL$_BADBUFSIZ = FFFFFFF3            IFB$L_BDB_FLNK   00000030            IFB$V_RW_ATTR  = 00000034            
FTL$_BADIFAB   = FFFFFFFD            IFB$L_BKPBITS    00000004            IFB$V_SCF      = 0000002A            
FTL$_BADLEVEL  = FFFFFFE6            IFB$L_BWB        0000000C            IFB$V_SPL      = 00000029            
FTL$_BADORGCASE= FFFFFFFB            IFB$L_DVBN       00000058            IFB$V_SQO      = 0000002D            
FTL$_CANTDOAST = FFFFFFF7            IFB$L_EBK        00000044            IFB$V_TEF      = 00000036            
FTL$_DEALLERR  = FFFFFFEF            IFB$L_FRB_PTR    00000028            IFB$V_TMP      = 00000035            
FTL$_GTCHNFAIL = FFFFFFFC            IFB$L_FWA_BDB    00000050            IFB$V_TRN      = 00000004            
FTL$_IORNDN    = FFFFFFEE            IFB$L_HBK        00000040            IFB$V_UPD      = 00000003            
FTL$_LOCKFAILED= FFFFFFE7            IFB$L_IDX_PTR    00000054            IFB$V_WRTACC   = 00000030            
FTL$_NOASB     = FFFFFFF5            IFB$L_IOS        0000000C            IFB$W_ASDEVBSIZ  0000005A            
FTL$_NODIDORFID= FFFFFFEB            IFB$L_IOS4       00000010            IFB$W_BKS_BYTES  0000005C            
FTL$_NOLOCKBDB = FFFFFFE9            IFB$L_IRAB_LNK   0000001C            IFB$W_BKS_RECS   0000005E            
FTL$_NONETWORK = FFFFFFE8            IFB$L_LAST_FAB   00000024            IFB$W_CHNL       00000020            
FTL$_NONXTBDB  = FFFFFFF4            IFB$L_LOCK_BDB   00000050            IFB$W_DEQ        0000004E            
FTL$_NOSTRUCT  = FFFFFFF6            IFB$L_MRN        00000054            IFB$W_DEVBUFSIZ  00000038            
FTL$_NOTLOCKED = FFFFFFEC            IFB$L_NRP_LNK    00000050            IFB$W_EBK0       00000044            
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  16
SYMBOL TABLE                                                                                                                     (1)

IFB$W_EBK2       00000046            IRB$K_BLN_SEQ    0000004C            IRB$W_OWN_ISI    0000003E            
IFB$W_FFB        00000048            IRB$L_ARGLST     00000018            IRB$W_ROVHDSZ    00000044            
IFB$W_IOS2       0000000E            IRB$L_ASBADDR    00000014            IRB$W_RP_OFF     00000038            
IFB$W_LRL        0000003E            IRB$L_BKPBITS    00000004            IRB$W_RTOTLSZ    00000046            
IFB$W_MRS        0000004C            IRB$L_BWB        0000000C            IRB$W_SAVE_POS   00000052            
IFB$W_RTDEQ      0000003A            IRB$L_CURBDB     00000020            NOERR            00000173 R     02   
IMP$B_PROT       00000002            IRB$L_CURVBN     00000030            NOERR1           0000016C R     02   
IMP$C_ASYEFN   = 0000001E            IRB$L_IFAB_LNK   00000000            NXTENT           000000B6 R     02   
IMP$C_ASYQIOEFN= 0000001F            IRB$L_IOS        0000000C            NXTSEG           000000AF R     02   
IMP$C_ENTPERSEG= 0000000F            IRB$L_IOS4       00000010            NXTSOB           000000C2 R     02   
IMP$C_IOREFN   = 0000001E            IRB$L_IRAB_LNK   0000001C            PIO$GL_FMLH      ********   X   02   
IMP$C_MBXEFN   = 0000001A            IRB$L_KEYBUF     00000048            PIO$GW_IIOIMPA   ********   X   02   
IMP$C_NPIOFILES= 0000000C            IRB$L_LAST_RAB   00000024            PIO$GW_PIOIMPA   ********   X   02   
IMP$C_SYNCEFN  = 0000001B            IRB$L_LOCK_BDB   0000005C            PIO$GW_STATUS    ********   X   02   
IMP$L_FREEPGLH   0000000C            IRB$L_NRP        0000002C            PIO$V_EOD      = 00000001            
IMP$L_IFABTBL    00000018            IRB$L_NRP_OFF    00000030            PIO$V_INHAST   = 00000000            
IMP$L_IFBTBLINK  00000024            IRB$L_NRP_VBN    0000002C            PIO$V_SYNC1    = 00000002            
IMP$L_IOSEGADDR  00000004            IRB$L_NXTBDB     00000028            PIO$V_SYNC2    = 00000003            
IMP$L_IOSEGLEN   00000008            IRB$L_OWNER_ID   0000003C            PSL$C_EXEC     = 00000001            
IMP$L_IRABTBL    0000001C            IRB$L_RFA_VBN    00000054            PSL$C_KERNEL   = 00000000            
IMP$L_IRBTBLINK  00000064            IRB$L_RLB_ADDR   00000044            PSL$C_SUPER    = 00000002            
IMP$L_SAVED_SP   00000014            IRB$L_RP         00000034            PSL$C_USER     = 00000003            
IMP$V_AST      = 00000001            IRB$L_RP_OFF     00000038            PSL$M_CM       = 80000000            
IMP$V_IIOS     = 00000000            IRB$L_RP_VBN     00000034            PSL$M_CURMOD   = 03000000            
IMP$V_IORUNDOWN= 00000004            IRB$L_RRV_VBN    0000004C            PSL$M_DV       = 00000080            
IMP$V_NOP0BUFS = 00000005            IRB$L_TEMP0      00000044            PSL$M_FPD      = 08000000            
IMP$V_TEMP1    = 00000002            IRB$L_TEMP1      00000048            PSL$M_FU       = 00000040            
IMP$V_TEMP2    = 00000003            IRB$V_ASYNC    = 00000023            PSL$M_IPL      = 001F0000            
IMP$W_ENTPERSEG  00000020            IRB$V_ASYNCWAIT= 00000024            PSL$M_IS       = 04000000            
IMP$W_NUM_IFABS  00000022            IRB$V_BIO_LAST = 00000027            PSL$M_IV       = 00000020            
IMP$W_RMSSTATUS  00000000            IRB$V_BRO_SW   = 00000028            PSL$M_PRVMOD   = 00C00000            
INHAST           00000086 R     02   IRB$V_BUSY     = 00000020            PSL$M_SAFBITS  = 000037FF            
IRB$B_BCNT       00000040            IRB$V_DAP_CONN = 0000003E            PSL$M_TBIT     = 00000010            
IRB$B_BID        00000008            IRB$V_DAP_FMODE= 0000003F            PSL$M_TP       = 40000000            
IRB$B_BLN        00000009            IRB$V_DUP      = 0000002C            PSL$S_CURMOD   = 00000002            
IRB$B_EFN        0000000B            IRB$V_EOF      = 00000021            PSL$S_IPL      = 00000005            
IRB$B_KEYSZ      00000051            IRB$V_FIND     = 00000029            PSL$S_PRVMOD   = 00000002            
IRB$B_MBC        00000041            IRB$V_FIND_LAST= 00000025            PSL$V_CM       = 0000001F            
IRB$B_MODE       0000000A            IRB$V_IDX_ERR  = 00000031            PSL$V_CURMOD   = 00000018            
IRB$B_NRP_ID     00000030            IRB$V_LOCKABOVE= 00000002            PSL$V_DV       = 00000007            
IRB$B_NRP_KREF   00000031            IRB$V_NEW_IDX  = 00000003            PSL$V_FPD      = 0000001B            
IRB$B_NVBNS      00000048            IRB$V_POSINSERT= 00000000            PSL$V_FU       = 00000006            
IRB$B_POST_CCTL  00000045            IRB$V_PPF_EOF  = 0000002E            PSL$V_IPL      = 00000010            
IRB$B_PPF_ISI    0000003E            IRB$V_PPF_FNDSV= 00000030            PSL$V_IS       = 0000001A            
IRB$B_PRE_CCTL   00000044            IRB$V_PPF_IMAGE= 00000022            PSL$V_IV       = 00000005            
IRB$B_RFA_ID     00000058            IRB$V_PPF_SKIP = 0000002F            PSL$V_PRVMOD   = 00000016            
IRB$B_RP_ID      00000038            IRB$V_PUTS_LAST= 00000026            PSL$V_TBIT     = 00000004            
IRB$B_RP_KREF    00000039            IRB$V_RAHWBH   = 0000002A            PSL$V_TP       = 0000001E            
IRB$B_RRV_ID     00000050            IRB$V_SKIP_NEXT= 0000002B            QUIET            00000136 R     02   
IRB$B_SRCHFLAGS  00000043            IRB$V_SRCHGT   = 00000001            RDIFAB           000000EA R     02   
IRB$B_STOPLEVEL  00000042            IRB$V_UNLOCK_RP= 0000002D            RDIRAB           00000107 R     02   
IRB$C_BID      = 0000000A            IRB$V_WRITE    = 00000029            RM$BUG           ********   X   02   
IRB$C_BLN_IDX    0000006C            IRB$W_CSIZ       00000042            RM$GETDVIFID     ********   X   02   
IRB$C_BLN_REL    00000048            IRB$W_DUP_POS    00000032            RM$LAST_CHANCE   ********   X   02   
IRB$C_BLN_SEQ    0000004C            IRB$W_IOS2       0000000E            RM$RET1PAG       ********   X   02   
IRB$K_BLN_IDX    0000006C            IRB$W_NRP_OFF    00000030            RMS$RMSRUNDWN  = FFFFFFFE RG    02   
IRB$K_BLN_REL    00000048            IRB$W_OWN_ID     0000003C            RMS$V_STVSTATUS= 0000000E            
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  17
SYMBOL TABLE                                                                                                                     (1)

RMS$_ABO       = 000183EC            RMS$_ESS       = 00018504            RMS$_PENDING   = 00018009            
RMS$_ACC       = 0001C002            RMS$_EXP       = 000182C2            RMS$_PLG       = 0001861C            
RMS$_ACT       = 0001825A            RMS$_EXT       = 0001C022            RMS$_PLV       = 0001872C            
RMS$_AID       = 000183F4            RMS$_FAB       = 0001850C            RMS$_POS       = 00018624            
RMS$_ALN       = 000183FC            RMS$_FAC       = 00018514            RMS$_PRM       = 0001862C            
RMS$_ALQ       = 00018404            RMS$_FEX       = 00018282            RMS$_PRV       = 0001829A            
RMS$_ANI       = 0001840C            RMS$_FLG       = 0001851C            RMS$_QUO       = 00018634            
RMS$_AOP       = 00018414            RMS$_FLK       = 0001828A            RMS$_RAB       = 0001863C            
RMS$_ATR       = 0001C0CC            RMS$_FNA       = 00018524            RMS$_RAC       = 00018644            
RMS$_ATW       = 0001C0D4            RMS$_FND       = 0001C02A            RMS$_RAT       = 0001864C            
RMS$_BKS       = 0001841C            RMS$_FNF       = 00018292            RMS$_RBF       = 00018654            
RMS$_BKZ       = 00018424            RMS$_FNM       = 0001852C            RMS$_RER       = 0001C0F4            
RMS$_BLN       = 0001842C            RMS$_FOP       = 0001853C            RMS$_REX       = 000182A2            
RMS$_BOF       = 00018198            RMS$_FSZ       = 00018534            RMS$_RFA       = 0001865C            
RMS$_BUG       = 00018434            RMS$_FUL       = 00018544            RMS$_RFM       = 00018664            
RMS$_BUG_DAP   = 00018444            RMS$_IAL       = 0001854C            RMS$_RHB       = 0001866C            
RMS$_BUG_DDI   = 0001843C            RMS$_IAN       = 00018554            RMS$_RLF       = 00018674            
RMS$_BUG_XX2   = 0001844C            RMS$_IBF       = 00018754            RMS$_RLK       = 000182AA            
RMS$_BUG_XX3   = 00018454            RMS$_IDX       = 0001855C            RMS$_RMV       = 0001C0FC            
RMS$_BUG_XX4   = 0001845C            RMS$_IFA       = 0001C124            RMS$_RNF       = 000182B2            
RMS$_BUG_XX5   = 00018464            RMS$_IFI       = 00018564            RMS$_RNL       = 000181A0            
RMS$_BUG_XX6   = 0001846C            RMS$_IMX       = 0001856C            RMS$_ROP       = 0001867C            
RMS$_BUG_XX7   = 00018474            RMS$_IOP       = 00018574            RMS$_RPL       = 0001C104            
RMS$_BUG_XX8   = 0001847C            RMS$_IRC       = 0001857C            RMS$_RRV       = 00018684            
RMS$_BUG_XX9   = 00018484            RMS$_ISI       = 00018584            RMS$_RSA       = 000182DA            
RMS$_CAA       = 0001848C            RMS$_KBF       = 0001858C            RMS$_RSL       = 0001873C            
RMS$_CCF       = 0001C0DC            RMS$_KEY       = 00018594            RMS$_RSS       = 00018694            
RMS$_CCR       = 00018494            RMS$_KFF       = 00018031            RMS$_RST       = 0001869C            
RMS$_CDA       = 0001C0E4            RMS$_KRF       = 0001859C            RMS$_RSZ       = 000186A4            
RMS$_CHG       = 0001849C            RMS$_KSZ       = 000185A4            RMS$_RTB       = 000181A8            
RMS$_CHK       = 000184A4            RMS$_LAN       = 000185AC            RMS$_SEQ       = 000186AC            
RMS$_CHN       = 0001C0EC            RMS$_LBL       = 000185B4            RMS$_SHR       = 000186B4            
RMS$_COD       = 000184AC            RMS$_LNE       = 000185BC            RMS$_SIZ       = 000186BC            
RMS$_CONTROLC  = 00010651            RMS$_LOC       = 000185C4            RMS$_SPL       = 0001C042            
RMS$_CONTROLO  = 00010609            RMS$_MBC       = 00018734            RMS$_SQO       = 000186C4            
RMS$_CONTROLY  = 00010611            RMS$_MKD       = 0001C032            RMS$_STALL     = 00018001            
RMS$_CRE       = 0001C00A            RMS$_MRN       = 000185CC            RMS$_STK       = 000186CC            
RMS$_CREATED   = 00010619            RMS$_MRS       = 000185D4            RMS$_SUC       = 00010001            
RMS$_CUR       = 000184B4            RMS$_NAM       = 000185DC            RMS$_SUP       = 000182D2            
RMS$_DAC       = 0001C012            RMS$_NEF       = 000185E4            RMS$_SUPERSEDE = 00010631            
RMS$_DAN       = 000184BC            RMS$_NET       = 0001874C            RMS$_SYN       = 000186D4            
RMS$_DEL       = 00018262            RMS$_NID       = 000185EC            RMS$_SYS       = 0001C10C            
RMS$_DEV       = 000184C4            RMS$_NMF       = 000182CA            RMS$_TEMP1     = 0001826A            
RMS$_DIR       = 000184CC            RMS$_NOD       = 000185F4            RMS$_TEMP2     = 0001868C            
RMS$_DME       = 000184D4            RMS$_NORMAL    = 00010001            RMS$_TMO       = 000181B0            
RMS$_DNA       = 000184DC            RMS$_NPK       = 000185FC            RMS$_TRE       = 000186DC            
RMS$_DNF       = 0001C04A            RMS$_OK_ALK    = 00018039            RMS$_TYP       = 000186E4            
RMS$_DNR       = 00018272            RMS$_OK_DEL    = 00018041            RMS$_UBF       = 000186EC            
RMS$_DPE       = 0001C03A            RMS$_OK_DUP    = 00018011            RMS$_USZ       = 000186F4            
RMS$_DTP       = 000184E4            RMS$_OK_IDX    = 00018019            RMS$_VER       = 000186FC            
RMS$_DUP       = 000184EC            RMS$_OK_LIM    = 00018051            RMS$_VOL       = 00018704            
RMS$_DVI       = 000184F4            RMS$_OK_RLK    = 00018021            RMS$_WBE       = 0001C12C            
RMS$_ENT       = 0001C01A            RMS$_OK_RNF    = 00018049            RMS$_WER       = 0001C114            
RMS$_ENV       = 00018724            RMS$_OK_RRV    = 00018029            RMS$_WLD       = 00018744            
RMS$_EOF       = 0001827A            RMS$_ORD       = 00018604            RMS$_WLK       = 000182BA            
RMS$_ESA       = 000184FC            RMS$_ORG       = 0001860C            RMS$_WPL       = 0001C11C            
RMS$_ESL       = 00018714            RMS$_PBF       = 00018614            RMS$_WSF       = 0001871C            
RMS0RNDWN       RMS IO RUN DOWN                                  21-AUG-1978 22:10:28   VAX-11 MACRO X0.3-11               Page  18
SYMBOL TABLE                                                                                                                     (1)

RMS$_XAB       = 0001870C            
RMSABORT         00000071 R     02   
RUNDWN           000000A5 R     02   
SYS$CANCEL       ********   X   02   
SYS$CLOSE        ********   X   02   
SYS$CLREF        ********   X   02   
SYS$SETAST       ********   X   02   
SYS$WAITFR       ********   X   02   
TPT$L_RUNDWN     ********   X   02   
WAIT             0000008E R     02   
XITSUC           00000067 R     02   


PROGRAM SECTION SYNOPSIS

.  ABS  .        00000000      00     NOPIC   USR   CON   ABS   LCL NOSHR NOEXE NORD  NOWRT BYTE  
. BLANK .        00000000      01     NOPIC   USR   CON   REL   LCL NOSHR   EXE   RD    WRT BYTE  
F$RMSCLOSERNDN   000001CE      02     NOPIC   USR   CON   REL   GBL NOSHR   EXE   RD  NOWRT BYTE  
$ABS$            0000006C      03     NOPIC   USR   CON   ABS   LCL NOSHR   EXE   RD    WRT BYTE  


THERE WERE NO ERRORS OR WARNINGS.
7476. BYTES LEFT IN FREE MEMORY POOL.
2398. BYTES OF RECLAIMED MEMORY.
OBJ$:RMS0RNDWN,LIS$:RMS0RNDWN/-SP=EXECML$/ML,LIB$:R/ML,SRC$:RMS0RNDWN
46 MLB DIR RDS - 1120 GETS TO DEFINE 34 MACROS. 90 INTER. FILE WRITES. 
