FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 1   
SLPOUT.FTN   	/TR:BLOCKS/WR

        C
        C
        C
        C	SLPOUT -- OUTPUT A SLP INSERT LINE
        C
        C
        C
        C	COPYRIGHT (C) 1976
        C	DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
        C
        C	THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
        C	SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
        C	SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
        C	OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
        C	AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
        C	AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
        C	OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
        C
        C	THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
        C	NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
        C	EQUIPMENT CORPORATION.
        C
        C	DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
        C	SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
        C
        C
        C	K.D. MORSE	23-NOV-76
        C
        C
        C
        C	THIS ROUTINE OUTPUTS A LINE OF SLP INSERT DATA.
        C
        C
        C
        C  MODIFICATIONS:
        C
        C  NO.		DATE		PROGRAMMER		PURPOSE
        C
        C  --		----		----------		-------
        C
        C
FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 2   
SLPOUT.FTN   	/TR:BLOCKS/WR

         
        C
        C  VARIABLES:
        C
        C	IERR1--ERROR INDICATOR FROM FORTRAN ROUTINES
        C	IERR2--ERROR INDICATOR FROM MACRO ROUTINES
        C	ILUN--LOGICAL UNIT NUMBER FOR OPENING INPUT FILE CHANNEL
        C	INMLNG--LENGTH OF THE INPUT FILE SPECIFICATION
        C	INPNAM--ASCII INPUT FILE SPECIFICATION
        C	IRECNM--CURRENT INPUT FILE RECORD NUMBER
        C	IRECSZ--NUMBER OF CHARACTERS IN AN I/O BUFFER
        C	ISTAT--INDICATOR OF TYPE OF CLOSE FOR INPUT FILE CHANNEL
        C	ITYPE--TYPE OF OPEN FOR INPUT FILE (0=INPUT, 1=OUTPUT)
        C	LENINP--LENGTH OF INPUT FILE RECORD
        C	OLUN--LOGICAL UNIT NUMBER FOR OPENING OUTPUT FILE CHANNEL
        C	RECORD--I/O BUFFER
        C
        C
FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 3   
SLPOUT.FTN   	/TR:BLOCKS/WR

         
0001    	SUBROUTINE SLPOUT(ILUN,RECORD,LENINP,ISTAT,INPNAM,INMLNG,ITYPE,
        	1IRECNM)
0002    	COMMON MAP(100,2),NUMLIN,MAPTOP(2),LSTMAP(2),MLUN,
        	1IHOLD(30,2),NINCOR,IFREE(2),IFIRST(2),LAST(2),MAXBUF,
        	2BUFR,ISWTCH,COMCHR,NSWVAL(10),LSTMAT(2),IRECSZ,
        	3MRKPNT(2,4),INOUT,MAPEND(2),LINSIZ,MAPNAM,MNMLNG,MTYPE,MSTAT
        	4,IERR1,IERR2,IKIND,OLUN,MAPMRK(3,2),MPRINT,BARCHR
         
0003    	BYTE BUFR(7680,2),COMCHR(16),BARCHR
0004    	BYTE INPNAM(1),RECORD(1),MAPNAM(12)
0005    	INTEGER OLUN
         
0006    104	FORMAT('<',<LINSIZ>A1)
0007    111	FORMAT(<LINSIZ>A1)
0008    121	FORMAT(' SLP--WARNING--SLP INSERT LINE IS MORE THAN 80. CHARACTERS')
        C
        C	GET THE OUTPUT LINE.
        C
0009    	CALL GETLIN(ILUN,RECORD,LENINP,ISTAT,INPNAM,INMLNG,
        	1ITYPE,IRECNM)
0010    	IF (IERR2 .EQ. 0) GOTO 700
0011    	IF (IERR1 .LT. 0) GOTO 1000
        C
        C	WRITE OUT INSERT LINE AND A WARNING MESSAGE IF LINE > 80 CHARS.
        C
0012    	IF (LENINP .LE. 0) GOTO 100
0013    	IF ((RECORD(1) .NE. '-') .AND. (RECORD(1) .NE. '/') .AND.
        	1(RECORD(1) .NE. '@'))WRITE(OLUN,111,ERR=918)
        	2(RECORD(I),I=1,LENINP)
0014    	IF ((RECORD(1) .EQ. '-') .OR. (RECORD(1) .EQ. '/') .OR.
        	1(RECORD(1) .EQ. '@'))WRITE(OLUN,104,ERR=918)
        	2(RECORD(I),I=1,LENINP)
0015    	IF (LENINP .GT. 80)WRITE(5,121)
0016    	GOTO 1000
        C
        C	WRITE A BLANK LINE.
        C
0017    100	WRITE(OLUN,111,ERR=918)
0018    	GOTO 1000
        C
        C	DISREGARD EOF AS AN ERROR.
        C
0019    700	IERR1=1
0020    	IRECNM=0
0021    	GOTO 1000
        C
        C
        C	ERROR CODES
        C
        C
        C
        C	OLUN WRITE ERROR.
        C
0022    918	IERR1=-18
0023    1000	RETURN
FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 4   
SLPOUT.FTN   	/TR:BLOCKS/WR

0024    	END
FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 5   
SLPOUT.FTN   	/TR:BLOCKS/WR

PROGRAM SECTIONS

NUMBER	 NAME	    SIZE		ATTRIBUTES

  1	$CODE1	000640   208		RW,I,CON,LCL
  3	$IDATA	000162    57		RW,D,CON,LCL
  4	$VARS	000002     1		RW,D,CON,LCL
  5	$TEMPS	000002     1		RW,D,CON,LCL
  6	.$$$$.	037222  8009		RW,D,OVR,GBL


ENTRY POINTS

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 SLPOUT	      1-000000


VARIABLES

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 BARCHR	L*1   6-037220	 I	I*2   4-000000	 IERR1	I*2   6-037172	 IERR2	I*2   6-037174	 IKIND	I*2   6-037176
 ILUN	I*2   F-000002*	 INMLNG	I*2   F-000014*	 INOUT	I*2   6-037140	 IRECNM	I*2   F-000020*	 IRECSZ	I*2   6-037116
 ISTAT	I*2   F-000010*	 ISWTCH	I*2   6-037044	 ITYPE	I*2   F-000016*	 LENINP	I*2   F-000006*	 LINSIZ	I*2   6-037146
 MAXBUF	I*2   6-001042	 MLUN	I*2   6-000632	 MNMLNG	I*2   6-037164	 MPRINT	I*2   6-037216	 MSTAT	I*2   6-037170
 MTYPE	I*2   6-037166	 NINCOR	I*2   6-001024	 NUMLIN	I*2   6-000620	 OLUN	I*2   6-037200


ARRAYS

 NAME   TYPE  ADDRESS	    SIZE 	DIMENSIONS

 BUFR	L*1   6-001044	036000  7680	(7680,2)
 COMCHR	L*1   6-037046	000020     8	(16)
 IFIRST	I*2   6-001032	000004     2	(2)
 IFREE	I*2   6-001026	000004     2	(2)
 IHOLD	I*2   6-000634	000170    60	(30,2)
 INPNAM	L*1   F-000012*	000001     0	(1)
 LAST	I*2   6-001036	000004     2	(2)
 LSTMAP	I*2   6-000626	000004     2	(2)
 LSTMAT	I*2   6-037112	000004     2	(2)
 MAP	I*2   6-000000	000620   200	(100,2)
 MAPEND	I*2   6-037142	000004     2	(2)
 MAPMRK	I*2   6-037202	000014     6	(3,2)
 MAPNAM	L*1   6-037150	000014     6	(12)
 MAPTOP	I*2   6-000622	000004     2	(2)
 MRKPNT	I*2   6-037120	000020     8	(2,4)
 NSWVAL	I*2   6-037066	000024    10	(10)
 RECORD	L*1   F-000004*	000001     0	(1)


LABELS

 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	

FORTRAN IV-PLUS V02-51D		02:47:18    22-AUG-78		PAGE 6   
SLPOUT.FTN   	/TR:BLOCKS/WR

 100	 1-000526	 104'	 3-000000	 111'	 3-000010	 121'	 3-000016	 700	 1-000564
 918	 1-000606	 1000	 1-000622


FUNCTIONS AND SUBROUTINES REFERENCED

 GETLIN


TOTAL SPACE ALLOCATED = 040250  8276

NO FPP INSTRUCTIONS GENERATED

OBJ$:SLPOUT,LIS$:SLPOUT/-SP=SRC$:SLPOUT
