FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 1   
INEDIT.FTN   	/TR:BLOCKS/WR

        C
        C
        C
        C	INEDIT --  GET A LINE OF FILE
        C
        C
        C
        C
        C	COPYRIGHT (C) 1976
        C	DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
        C
        C	THIS SOFTWARE IS FURNISHED UNDER  A LICENSE FOR USE ONLY  ON  A
        C	SINGLE COMPUTER SYSTEM AND MAY BE  COPIED ONLY WITH  THE INCLU-
        C	SION OF  THE  ABOVE  COPYRIGHT NOTICE.  THIS SOFTWARE,  OR  ANY
        C	OTHER COPIES THEREOF, MAY NOT BE  PROVIDED  OR  OTHERWISE  MADE
        C	AVAILABLE TO ANY OTHER PERSON EXCEPT  FOR  USE  ON  SUCH SYSTEM
        C	AND TO  ONE WHO AGREES  TO  THESE LICENSE  TERMS.  TITLE TO AND
        C	OWNERSHIP OF THE SOFTWARE SHALL AT ALL TIMES REMAIN IN DEC.
        C
        C	THE INFORMATION IN THIS SOFTWARE  IS  SUBJECT TO CHANGE WITHOUT
        C	NOTICE AND SHOULD NOT BE CONSTRUED  AS  A COMMITMENT BY DIGITAL
        C	EQUIPMENT CORPORATION.
        C
        C	DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
        C	SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
        C
        C
        C	K.D. MORSE  07-NOV-76
        C
        C
        C
        C
        C	THIS SUBROUTINE GETS A LINE OF INPUT FROM A FILE OPENED VIA
        C	THE ROUTINE OPNFIL.  IT THEN EDITS THE LINE BASED ON THE SWITCH
        C	VALUE PROVIDED BY THE CALLER.  IF AN ERROR OCCURS, THE VARIABLE
        C	IERR1 IS SET TO THE APPROPRIATE CODE.  THE EDIT MAY INCLUDE THE
        C	REMOVAL OF COMMENTS DESIGNATED BY A SEMICOLON, FORMFEEDS,
        C	TRAILING BLANKS AND TABS, AND MULTIPLE BLANKS AND TABS.
        C
        C
        C
        C
        C  MODIFICATIONS:
        C
        C NO		DATE		PROGRAMMER		PURPOSE
        C --		-----		----------		-------
        C
FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 2   
INEDIT.FTN   	/TR:BLOCKS/WR

         
        C
        C
        C  VARIABLES:
        C
        C
        C	BLANK--OCTAL VALUE OF ASCII SPACE (BLANK)
        C	EXCLAM--OCTAL VALUE OF ASCII EXCLAMATION POINT
        C	FF--OCTAL VALUE OF ASCII FORMFEED
        C	COMCHR--NUMERICAL VALUE OF ASCII CHARACTER DELIMITING COMMENTS
        C	HYPHEN--NUMERICAL VALUE OF ACSII HYPHEN
        C	IERR1--ERROR CODE BETWEEN FORTRAN ROUTINES, <1 = ERROR
        C	IERR2--ERROR CODE FROM MACRO ROUTINES, <1 = ERROR
        C	ILUN--CHANNEL ON WHICH FILE IS OPEN
        C	IRECSZ--SIZE OF INPUT BUFFER PROVIDED BY CALLER
        C	ISWTCH--SWITCH VALUE
        C	LENINP--LENGTH OF RECORD RETURNED TO CALLER
        C	NOHYP--COUNTER FOR NUMBER OF HYPHENS IN ONE LINE
        C	RECORD--INPUT BUFFER TO RETURN RECORD TO CALLER
        C	SEMI--NUMERICAL VALUE OF ASCII SEMICOLON
        C	NSWVAL--TABLE OF SWITCH POSSIBLE SWITCH VALUES
        C	TAB--NUMERICAL VALUE OF ASCII HORIZONTAL TAB
        C
        C
        C
        C
FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 3   
INEDIT.FTN   	/TR:BLOCKS/WR

         
0001    	SUBROUTINE INEDIT(ILUN,RECORD,LENINP)
        C
0002    	COMMON MAP(100,2),NUMLIN,MAPTOP(2),LSTMAP(2),MLUN,
        	1IHOLD(30,2),NINCOR,IFREE(2),IFIRST(2),LAST(2),MAXBUF,
        	2BUFR,ISWTCH,COMCHR,NSWVAL(10),LSTMAT(2),IRECSZ,
        	3MRKPNT(4,2),INOUT,MAPEND(2),LINSIZ,MAPNAM,MNMLNG,MTYPE,MSTAT
        	4,IERR1,IERR2,IKIND,OLUN,MAPMRK(3,2),MPRINT,BARCHR
        C
        C
0003    	BYTE RECORD(512),SEMI,BLANK,TAB,FF,EXCLAM,COMCHR(16),BUFR(7680,2)
0004    	BYTE MAPNAM(12),BARCHR,HYPHEN
0005    	INTEGER OLUN
0006    	DATA SEMI/59/,BLANK/32/,TAB/9/,FF/12/,EXCLAM/33/,HYPHEN/45/
        C
        C	GET A RECORD.
        C
0007    	CALL GETREC(ILUN,RECORD,IRECSZ,LENINP,IERR2)
0008    	IF (IRECSZ NEQ 0) WRITE(5,1661)ILUN,(RECORD(NNN),NNN=1,IRECSZ)
0009    1661	FORMAT(' ILUN=',I5,'RECORD = ',<IRECSZ>A1)
0010    	IF (IERR2.LE.0) GOTO 920
0011    	IF (LENINP .EQ. 0) GOTO 900
        C
        C	CHECK FOR COMMENTS ON ENDS OF LINES.
        C ****  I HAVE TAKEN OUT THE CHECK FOR HYPHENS.  DON'T REMEMBER WHY IT WAS
        C ****	IN THE FIRST PLACE.  THEREFORE, I HAVE ONLY COMMENTED IT OUT. ******
        C
0012    	IF ((ISWTCH .AND. NSWVAL(2)) .NE. NSWVAL(2)) GOTO 100
0013    	DO 70 J=1,8,2
0014    	IF ((COMCHR(J) .NE. SEMI) .AND. (COMCHR(J) .NE. EXCLAM)) GOTO 70
0015    	IF (RECORD(1) .EQ. COMCHR(J)) GOTO 100
        C	NOHYP=0
0016    	DO 50 I=1,LENINP
        C	IF (RECORD(I) .EQ. HYPHEN) NOHYP=NOHYP+1
0017    50	IF (RECORD(I) .EQ. COMCHR(J)) GOTO 60
        C50	IF ((RECORD(I) .EQ. COMCHR(J)) .AND. (MOD(NOHYP,2) .EQ. 0)) GOTO 60
0018    60	LENINP=I-1
0019    70	CONTINUE
        C
        C	CHECK FOR TRAILING BLANKS AND TABS.
        C
0020    100	IF ((ISWTCH .AND. NSWVAL(6)) .NE. NSWVAL(6)) GOTO 200
0021    	DO 150 I=LENINP,1,-1
0022    150	IF ((RECORD(I) .NE. TAB) .AND. (RECORD(I) .NE. BLANK)) GOTO 160
0023    160	LENINP=I
0024    	IF (LENINP .EQ. 0) GOTO 1000
        C
        C	CHECK FOR MULTIPLE TABS AND BLANKS.
        C
0025    200	IF ((ISWTCH .AND. NSWVAL(5)) .NE. NSWVAL(5)) GOTO 300
0026    	IF (RECORD(1).EQ.TAB) RECORD(1)=BLANK
0027    	N=2
0028    210	DO 220 I=N,LENINP
0029    220	IF ((RECORD(I) .EQ. BLANK) .OR. (RECORD(I) .EQ. TAB)) GOTO 230
0030    	GOTO 300
0031    230	N=I
FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 4   
INEDIT.FTN   	/TR:BLOCKS/WR

0032    	IF (RECORD(N-1) .EQ. BLANK) GOTO 240
0033    	RECORD(N)=BLANK
0034    	N=N+1
0035    	GOTO 260
0036    240	DO 250 J=N+1,LENINP
0037    250	RECORD(J-1)=RECORD(J)
0038    	LENINP=LENINP-1
0039    260	IF (N .LE. LENINP) GOTO 210
0040    	IF (LENINP .EQ. 0) GOTO 900
        C
        C	CHECK FOR FORM FEEDS.
        C
0041    300	IF ((ISWTCH .AND. NSWVAL(3)) .NE. NSWVAL(3)) GOTO 1000
0042    	N=1
0043    310	DO 320 I=N,LENINP
0044    320	IF (RECORD(I) .EQ. FF) GOTO 330
0045    	GOTO 1000
0046    330	N=I
0047    	DO 340 J=N+1,LENINP
0048    340	RECORD(J-1)=RECORD(J)
0049    	LENINP=LENINP-1
0050    	IF (N .LE. LENINP) GOTO 310
0051    	IF (LENINP .EQ. 0) GOTO 900
0052    	GOTO 1000
        C
        C	MUST CLEAR BUFFER AS HAD A BLANK LINE.
        C
0053    900	DO 910 I=1,IRECSZ
0054    910	RECORD(I)=127
0055    	GOTO 1000
0056    920	IERR1=-(10+4*ILUN)
0057    1000	RETURN
0058    	END
FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 5   
INEDIT.FTN   	/TR:BLOCKS/WR

PROGRAM SECTIONS

NUMBER	 NAME	    SIZE		ATTRIBUTES

  1	$CODE1	001452   405		RW,I,CON,LCL
  3	$IDATA	000062    25		RW,D,CON,LCL
  4	$VARS	000016     7		RW,D,CON,LCL
  5	$TEMPS	000002     1		RW,D,CON,LCL
  6	.$$$$.	037222  8009		RW,D,OVR,GBL


ENTRY POINTS

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 INEDIT	      1-000000


VARIABLES

 NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS    NAME   TYPE  ADDRESS   

 BARCHR	L*1   6-037220	 BLANK	L*1   4-000001	 EXCLAM	L*1   4-000004	 FF	L*1   4-000003	 HYPHEN	L*1   4-000005
 I	I*2   4-000012	 IERR1	I*2   6-037172	 IERR2	I*2   6-037174	 IKIND	I*2   6-037176	 ILUN	I*2   F-000002*
 INOUT	I*2   6-037140	 IRECSZ	I*2   6-037116	 ISWTCH	I*2   6-037044	 J	I*2   4-000010	 LENINP	I*2   F-000006*
 LINSIZ	I*2   6-037146	 MAXBUF	I*2   6-001042	 MLUN	I*2   6-000632	 MNMLNG	I*2   6-037164	 MPRINT	I*2   6-037216
 MSTAT	I*2   6-037170	 MTYPE	I*2   6-037166	 N	I*2   4-000014	 NINCOR	I*2   6-001024	 NNN	I*2   4-000006
 NUMLIN	I*2   6-000620	 OLUN	I*2   6-037200	 SEMI	L*1   4-000000	 TAB	L*1   4-000002


ARRAYS

 NAME   TYPE  ADDRESS	    SIZE 	DIMENSIONS

 BUFR	L*1   6-001044	036000  7680	(7680,2)
 COMCHR	L*1   6-037046	000020     8	(16)
 IFIRST	I*2   6-001032	000004     2	(2)
 IFREE	I*2   6-001026	000004     2	(2)
 IHOLD	I*2   6-000634	000170    60	(30,2)
 LAST	I*2   6-001036	000004     2	(2)
 LSTMAP	I*2   6-000626	000004     2	(2)
 LSTMAT	I*2   6-037112	000004     2	(2)
 MAP	I*2   6-000000	000620   200	(100,2)
 MAPEND	I*2   6-037142	000004     2	(2)
 MAPMRK	I*2   6-037202	000014     6	(3,2)
 MAPNAM	L*1   6-037150	000014     6	(12)
 MAPTOP	I*2   6-000622	000004     2	(2)
 MRKPNT	I*2   6-037120	000020     8	(4,2)
 NSWVAL	I*2   6-037066	000024    10	(10)
 RECORD	L*1   F-000004*	001000   256	(512)


LABELS

 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	 LABEL   ADDRESS 	

FORTRAN IV-PLUS V02-51D		02:41:36    22-AUG-78		PAGE 6   
INEDIT.FTN   	/TR:BLOCKS/WR

 50	    **   	 60	 1-000404	 70	 1-000424	 100	 1-000450	 150	    **   
 160	 1-000554	 200	 1-000576	 210	 1-000656	 220	    **   	 230	 1-000746
 240	 1-001014	 250	    **   	 260	 1-001072	 300	 1-001116	 310	 1-001154
 320	    **   	 330	 1-001234	 340	    **   	 900	 1-001340	 910	    **   
 920	 1-001412	 1000	 1-001442	 1661'	 3-000000


FUNCTIONS AND SUBROUTINES REFERENCED

 GETREC


TOTAL SPACE ALLOCATED = 040776  8447

NO FPP INSTRUCTIONS GENERATED

OBJ$:INEDIT,LIS$:INEDIT/-SP=SRC$:INEDIT
