
; Bliss-32 7.352	Saturday 22-AUG-1978 00:08:44	DBB3:[MOUNT.SRC]MRDBLK.B32;8					Page 1
; Digital Equipment Corporation
;
;	0001	MODULE MRDBLK (
;	0002			LANGUAGE (BLISS32),
;	0003			IDENT = 'X0001'
;	0004			) =
;	0005	BEGIN
;	0006	
;	0007	!
;	0008	! Copyright (c) 1977
;	0009	! Digital Equipment Corporation, Maynard, Massachusetts 01754
;	0010	!
;	0011	! This software is furnished  under a license for use only on a single
;	0012	! computer  system and  may be  copied only with  the inclusion of the
;	0013	! above copyright notice.  This software, or any other copies thereof,
;	0014	! may not be provided or  otherwise made available to any other person
;	0015	! except for use on such system and to one who agrees to these license
;	0016	! terms.  Title to and  ownership of the  software  shall at all times
;	0017	! remain in DEC.
;	0018	!
;	0019	! The information in this software is subject to change without notice
;	0020	! and should  not be construed  as a commitment  by Digital  Equipment
;	0021	! Corporation.
;	0022	!
;	0023	! DEC assumes  no  responsibility  for  the use or  reliability of its
;	0024	! software on equipment which is not supplied by DEC.
;	0025	
;	0026	!++
;	0027	!
;	0028	! FACILITY:  MOUNT Utility Structure Levels 1 & 2
;	0029	!
;	0030	! ABSTRACT:
;	0031	!
;	0032	!	This routine reads a block from the disk being mounted.
;	0033	!
;	0034	! ENVIRONMENT:
;	0035	!
;	0036	!	STARLET operating system, including privileged system services
;	0037	!	and internal exec routines.
;	0038	!
;	0039	!--
;	0040	!
;	0041	!
;	0042	! AUTHOR:  Andrew C. Goldstein,	 CREATION DATE:  18-Oct-1977  11:35
;	0043	!
;	0044	! REVISION HISTORY:
;	0045	!
;	0046	!**
;	0047	
;	0048	
;	0049	LIBRARY 'SYS$LIBRARY:LIB.L32';
;	0050	REQUIRE 'SRC$:MOUDEF.B32';
;	0357	REQUIRE 'LIBD$:[VMSLIB.OBJ]MOUNTMSG.B32';

; Bliss-32 7.352	Saturday 22-AUG-1978 00:08:44	DBB3:[MOUNT.SRC]MRDBLK.B32;8					Page 2
; Digital Equipment Corporation
;
;	0457	GLOBAL ROUTINE READ_BLOCK (LBN, BUFFER) =
;	0458	
;	0459	!++
;	0460	!
;	0461	! FUNCTIONAL DESCRIPTION:
;	0462	!
;	0463	!	This routine reads the indicated block from the device that
;	0464	!	CHANNEL is assigned to.
;	0465	!
;	0466	! CALLING SEQUENCE:
;	0467	!	READ_BLOCK (ARG1, ARG2)
;	0468	!
;	0469	! INPUT PARAMETERS:
;	0470	!	ARG1: LBN of block
;	0471	!	ARG2: address of buffer to read into
;	0472	!
;	0473	! IMPLICIT INPUTS:
;	0474	!	CHANNEL: channel number to use
;	0475	!
;	0476	! OUTPUT PARAMETERS:
;	0477	!	NONE
;	0478	!
;	0479	! IMPLICIT OUTPUTS:
;	0480	!	NONE
;	0481	!
;	0482	! ROUTINE VALUE:
;	0483	!	I/O or system service status of request
;	0484	!
;	0485	! SIDE EFFECTS:
;	0486	!	block read
;	0487	!
;	0488	!--
;	0489	
;	0490	BEGIN
;	0491	
;	0492	LOCAL
;	0493		STATUS,				! system status code
;	0494		IO_STATUS	: VECTOR [2];	! I/O status block
;	0495	
;	0496	EXTERNAL
;	0497		CHANNEL;			! channel number for I/O
;	0498	
;	0499	STATUS = $QIOW (CHAN = .CHANNEL,
;     P 0500			FUNC = IO$_READLBLK,
;     P 0501			IOSB = IO_STATUS[0],
;     P 0502			P1   = .BUFFER,
;     P 0503			P2   = 512,
;     P 0504			P3   = .LBN);
;	0505	
;	0506	IF .STATUS THEN STATUS = .(IO_STATUS[0])<0,16>;
;	0507	RETURN .STATUS;
;	0508	
;	0509	END;					! end of routine READ_BLOCK



; Bliss-32 7.352	Saturday 22-AUG-1978 00:08:44	DBB3:[MOUNT.SRC]MRDBLK.B32;8					Page 2-1
; Digital Equipment Corporation
;
							    .TITLE  MRDBLK
							    .IDENT  \X0001\

							    .GLOBL  CHANNEL, SYS$QIOW

							    .PSECT  $CODE$,NOWRT,2

					 0000 00000 	    .ENTRY  READ_BLOCK, Save nothing				      ; 0457
		         5E	       08  C2 00002 	    SUBL2   #8, SP						      ;
				       7E  7C 00005 	    CLRQ    -(SP)						      ; 0504
				       7E  D4 00007 	    CLRL    -(SP)						      ;
				  04   AC  DD 00009 	    PUSHL   LBN							      ;
		         7E	0200   8F  3C 0000C 	    MOVZWL  #512, -(SP)						      ;
				  08   AC  DD 00011 	    PUSHL   BUFFER						      ;
				       7E  7C 00014 	    CLRQ    -(SP)						      ;
				  20   AE  9F 00016 	    PUSHAB  IO_STATUS						      ;
				       21  DD 00019 	    PUSHL   #33							      ;
				0000G  CF  DD 0001B 	    PUSHL   CHANNEL						      ;
				       7E  D4 0001F 	    CLRL    -(SP)						      ;
	      00000000G  9F	       0C  FB 00021 	    CALLS   #12, @#SYS$QIOW					      ;
		         03	       50  E9 00028 	    BLBC    STATUS, 1$						      ; 0506
		         50	       6E  3C 0002B 	    MOVZWL  IO_STATUS, STATUS					      ;
					   04 0002E 1$:     RET     							      ; 0457

; Routine Size:  47 bytes


;	0510	
;	0511	END
;	0512	ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  $CODE$         	    47  NOWRT,  RD ,  EXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)




;				LIBRARY STATISTICS
;
;					     -------- Symbols --------    Blocks
;	File				     Total    Loaded   Percent      Read
;
;  DBA4:[SYSLIB]LIB.L32;1		      5582         6         0       225





; Bliss-32 7.352	Saturday 22-AUG-1978 00:08:44	DBB3:[MOUNT.SRC]MRDBLK.B32;8					Page 2-2
; Digital Equipment Corporation
;

; Size:		47 code + 0 data bytes
; Run Time:	00:11.2
; Elapsed Time:	00:31.2
; Memory Used:	268 pages
; Compilation Complete
