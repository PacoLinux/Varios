SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 2


    100						.TITLE	SOSTTY - TERMINAL I/O - LISTEN
    200						.IDENT	/020501/
    300					;
    400					; COPYRIGHT 1978, DIGITAL EQUIPMENT CORP., MAYNARD, MASS. 01754
    500					;
    600					; DEC ASSUMES NO RESPONSIBILITY FOR THE USE OR RELIABILITY OF ITS
    700					; SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
    800					;
    900					; THIS SOFTWARE IS FURNISHED TO PURCHASER UNDER A LICENSE FOR USE
   1000					; ON A SINGLE COMPUTER SYSTEM AND CAN BE COPIED (WITH INCLUSION
   1100					; OF DEC'S COPYRIGHT NOTICE) ONLY FOR USE IN SUCH SYSTEM, EXCEPT
   1200					; AS MAY OTHERWISE BE PROVIDED IN WRITING BY DEC.
   1300					;
   1400					; THE INFORMATION IN THIS DOCUMENT IS SUBJECT TO CHANGE WITHOUT
   1500					; NOTICE AND SHOULD NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
   1600					; EQUIPMENT CORPORATION.
   1700					;
   1800					; PETER H. LIPMAN	19-AUG-76
   1900
   2000						.MCALL	FDOF$L,FCSBT$,QIOSY$,GCMLD$
   2100	000000					FDOF$L
   2200	000000					FCSBT$
   2300	000000					QIOSY$
   2400	000000					GCMLD$
   2410
   2420		000152 				G.CDEP=G.ERR+10.		;CURRENT DEPTH FOR EOF RECOVERY
   2500
   2600						.MCALL	QIO$,DIR$,WTSE$S
   2700
   2800	000000					PLIT$	TTY
   2900
   3000						.IF	NDF,R$$STS
   3100	000000				RNEPAL:	QIO$	IO.RAL!IO.RNE,TIOLUN,2,,IOSTS,,<TTIBUF,1,,,,>
   3200	000030				IORST:	QIO$	IO.RST,TIOLUN,2,,IOSTS,,<TTIBUF,80.,,,,>
   3300						.ENDC
   3400
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3
TTY I/O ROUTINES - LISTEN

    100						.SBTTL	TTY I/O ROUTINES - LISTEN
    200					;
    300					;	FLAG WORD PASSED TO LISTEN ROUTINE
    400					;
    500					;	BIT VALUE	MEANING
    600					;	  1		IF OFF, READ NO ECHO, PASS ALL
    700					;	  2		RAISE LOWER CASE TO UPPER
    800					;	  4		INDIRECT COMMAND OK
    900					;	 10		READ WITH SPECIAL TERMINATORS
   1000					;	 20		DO NOT ABORT ON ^C
   1100					;
   1200
   1300	000060					CODE$	TTY
   1400
   1500						.ENABL	LSB
   1600
   1700	000000				ENTRY	LISTEN
   1800	000000	016600 	000002 			MOV	2(SP),R0		;COPY ECHO FLAG
   1900	000004	032767 	000000G	000000G		BIT	#NOLOW,SOSFLG		;ALLOWING LOWER CASE?
   2000	000012	001402 				BEQ	5$			;BRANCH IF YES
   2100	000014	052700 	000002 			BIS	#2,R0			;NO, RAISE LOWER TO UPPER
   2200	000020	010146 			5$:	MOV	R1,-(SP)		;SAVE SOME REGS
   2300	000022	010246 				MOV	R2,-(SP)		;
   2400	000024	010046 				MOV	R0,-(SP)		;SAVE THE ECHO FLAG
   2500	000026	012701 	000000G		10$:	MOV	#TTICTL,R1		;CHANNEL ENTRY FOR TTY
   2600	000032	005761 	000002 			TST	2(R1)			;ANYTHING THERE ALREADY
   2700	000036	003116 				BGT	66$			;YES.  USE IT
   2800	000040	032716 	000001 			BIT	#1,(SP)			;SHOULD WE ECHO NEW CHAR
   2900	000044	001117 				BNE	80$			;YES.  DO NORMAL READ
   3000	000046	132767 	000004 	000017G		BITB	#FD.TTY,GCMLB+F.RCTL	;IF COMMANDS FROM A FILE
   3100	000054	001513 				BEQ	80$			;THEN DO NORMAL READ
   3200
   3300						.IF	DF,R$$STS		;RSTS ONLY
   3400						.TTDDT				;SWITCH INTO DDT SUBMODE
   3500						.TTNCH				;AND DO NOT ECHO
   3600						MOV	#XRB,R2			;POINT TO XRB
   3700						MOV	TTOCTL+2,(R2)		;PROMPT STRING LENGTH
   3800						BEQ	30$			;NOTHING TO PROMPT
   3900						TST	(R2)+
   4000						MOV	TTOCTL+2,(R2)+		;XRBC AND XRLEN
   4100						MOV	#TTOBUF,(R2)+
   4200						CLR	(R2)+
   4300						CLR	(R2)+
   4400						CLR	(R2)+			;XRCI, XRBLK,XRTIME
   4500						.WRITE
   4600						MOV	#TTOBUF,TTOCTL
   4700						CLR	TTOCTL+2
   4800						MOV	#XRB,R2			;RESET XRB POINTER
   4900					30$:	MOV	#2,(R2)+		;XRLEN=200
   5000						CLR	(R2)+			;XRBC=0
   5100						MOV	#TTIBUF,(R1)		;RESET BUFFER ADDRESS
   5200						MOV	(R1),(R2)+		;XRPTR
   5300						CLR	(R2)+			;XRCI
   5400						CLR	(R2)+			;XRBLK
   5500						CLR	(R2)+			;XRTIME
   5600						.READ
   5700						.TTECH				;TURN ON ECHOING
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-1
TTY I/O ROUTINES - LISTEN

   5800						TST	CTLCFL			;WAS A CTL-C HIT
   5900						BEQ	34$
   6000						JMP	190$
   6100					34$:	CMPB	IOSTS,#EOF		;WAS A CTL-Z HIT?
   6200						BNE	35$			;NO
   6300						MOV	#1,2(R1)		;YES, COUNT = 1
   6400						MOVB	#32,@(R1)		;STORE CONTROL Z
   6500						BR	170$
   6600					35$:	JSR	PC,IOCHK
   6700						MOV	XRB+XRBC,R2		;GUESS AT LENGTH GOOD
   6800						CMPB	TTIBUF,#015		;UNLESS CR CHARACTER
   6900						BNE	37$
   7000						DEC	R2			;STRIP LF WITH IT
   7100					37$:
   7200						MOV	R2,2(R1)		;RESET CURRENT COUNT
   7300
   7400						.IFF				;RSX ONLY
   7500	000056	016767 	000002G	000016G		MOV	TTOCTL+2,TYPDPB+Q.IOPL+2 ;SET SIZE OF PROMPT IF ANY
   7600	000064	001414 				BEQ	50$			;BRANCH IF NO PROMPT
   7700	000066				40$:	DIR$	#TYPDPB			;QUEUE THE PROMPT
   7800	000074	103003 				BCC	45$			;BRANCH IF OK
   7900	000076	004767 	000000G			JSR	PC,QIOERR		;HANDLE "OUT OF NODES"
   8000	000102	000771 				BR	40$			;TRY AGAIN, ALREADY WAITED
   8100	000104	005067 	000002G		45$:	CLR	TTOCTL+2		;NOTE THAT BUFFER IS EMPTY
   8200	000110	012767 	000000G	000000G		MOV	#TTOBUF,TTOCTL
   8300	000116	032716 	000010 		50$:	BIT	#10,(SP)		;READ WITH SPECIAL TERMINATORS?
   8400	000122	001406 				BEQ	52$			;BRANCH IF NOT
   8500	000124	105267 	000000G			INCB	NOECHO			;TERM DRIVER WILL ECHO ALL BUT LAST
   8600	000130					DIR$	#IORST			;READ WITH SPECIAL TERMINAORS
   8700	000136	000405 				BR	54$
   8800	000140	156716 	000000G		52$:	BISB	RAISLC,(SP)		;RAISE LC IF DESIRED
   8900	000144					DIR$	#RNEPAL			;QUEUE THE READ, 1 CHAR, NO ECHO
   9000	000152	103003 			54$:	BCC	60$			;BRANCH IF ALL IS WELL
   9100	000154	004767 	000000G			JSR	PC,QIOERR		;IF OUT OF NODES, WAIT
   9200	000160	000756 				BR	50$			;AND RETRY
   9300	000162				60$:	WTSE$S	#2			;WAIT FOR THE READ TO COMPLETE
   9400	000174	105767 	000000G			TSTB	IOSTS			;ANY ERROR?
   9500	000200	003436 				BLE	68$			;BRANCH IF YES, TREAT LIKE CONTROL C ABORT
   9600	000202	016702 	000002G			MOV	IOSTS+2,R2		;GET NO. OF BYTES READ
   9700										;NOT INCLUDING TERMINATOR IF ANY
   9800	000206	012721 	000000G			MOV	#TTIBUF,(R1)+		;RESET POINTER TO BUFFER
   9900	000212	010211 				MOV	R2,(R1)			;AND COUNT OF CHARACTERS
  10000	000214	064102 				ADD	-(R1),R2		;POINT AT END OF INPUT BUFFER
  10100	000216	116712 	000001G			MOVB	IOSTS+1,(R2)		;STORE TERMINATOR IF ANY
  10200	000222	001403 				BEQ	62$			;BRANCH IF NONE
  10300	000224	005261 	000002 			INC	2(R1)			;COUNT THE TERMINATOR
  10400	000230	005202 				INC	R2			;POINT AT END OF INPUT BUFFER
  10500	000232	114200 			62$:	MOVB	-(R2),R0		;LAST DATA BYTE
  10600	000234	042700 	177600 			BIC	#177600,R0		;CLEAR OUT PARITY BIT
  10605	000240	122700 	000003 			CMPB	#'C-100,R0		;CHECK FOR CONTROL C
  10610	000244	001414 				BEQ	68$			;BRANCH IF CONTROL C SEEN
  10630	000246	162700 	000175 			SUB	#175,R0			;OLD "TTY" ALTMODE?
  10640	000252	002575 				BLT	168$			;BRANCH IF NOT EITHER OF THEM
  10645	000254	132767 	000002 	000000G		BITB	#2,RAISLC		;TERM DRIVER CONVERTING LC TO UC?
  10650	000262	001571 				BEQ	168$			;BRANCH IF NOT
  10660	000264	005300 				DEC	R0			;IF 175 OR 176, THEN OLD ALTMODE
  10670	000266	003167 				BGT	168$			;BRANCH IF NOT AN OLD ALTMODE
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-2
TTY I/O ROUTINES - LISTEN

  10680	000270	112712 	000033 			MOVB	#33,(R2)		;REPLACE OLD ALTMODE WITH CORRECT CODE
  10780
  10790						.IFTF				;RSX AND RSTS BOTH
  10800	000274	000567 			66$:	BR	170$			;GO GET CHARACTER
  10810
  10820						.IFF				;RSX ONLY
  10900	000276	005267 	000000G		68$:	INC	CTLCFL			;CONTROL C SEEN
  10950	000302	000561 				BR	168$			;IT IS, TERMINATE
  10960						.ENDC
  11500	000304				80$:
  11600						.IF	NDF,R$$STS
  11700	000304	105067 	000001G			CLRB	GCMLB+F.RATT		;IN ORDER TO TELL IF OPEN HAPPENS IN GCML
  11800	000310	004767 	000000G			JSR	PC,ATTACH		;IN CASE WE DETACHED SOMEWHERE
  11900						.ENDC
  12000
  12100	000314	032716 	000004 			BIT	#4,(SP)			;IND CMD FILE OK?
  12200	000320	001404 				BEQ	90$			;NO.
  12300	000322	152767 	000003 	000141G		BISB	#GE.IND!GE.COM,GCMLB+G.MODE
  12400
  12500						.IF	DF,R$$STS
  12600						.TTRST				;RESET ^O EFFECTS
  12700						.ENDC
  12800
  12900	000330	000403 				BR	100$
  13000	000332	142767 	000003 	000141G	90$:	BICB	#GE.IND!GE.COM,GCMLB+G.MODE
  13100	000340	012700 	000000G		100$:	MOV	#TTOCTL,R0		;ADR OF OUTPUT BUF ADR AND SIZE
  13200	000344	012710 	000000G			MOV	#TTOBUF,(R0)		;RESET STARTING BUF ADR
  13300	000350	012067 	000144G			MOV	(R0)+,GCMLB+G.PSDS+2	;SET PROMPT ADDRESS
  13400	000354	011067 	000142G			MOV	(R0),GCMLB+G.PSDS	;AND SIZE
  13500	000360	001004 				BNE	110$			;BRANCH IF NOT NULL PROMPT
  13600	000362	005267 	000142G			INC	GCMLB+G.PSDS		;1 BYTE OF NULL REQUIRED
  13700	000366	105070 	177776 			CLRB	@-2(R0)			;STORE NULL BYTE
  13800	000372	005010 			110$:	CLR	(R0)			;RESET OUTPUT BUFFER SIZE
  13900	000374	012700 	000000G			MOV	#GCMLB,R0
  14000	000400	000167 	000000G			JMP	LISTN1			;ISSUE GCML CALL FROM ROOT
  14100	000404				LISTN2::
  14200	000404	010102 				MOV	R1,R2			;ADR OF INPUT DESCRIPTOR
  14300	000406	016700 	000150G			MOV	GCMLB+G.CMLD+2,R0	;GET INPUT BUFFER ADDRESS
  14350	000412	010022 				MOV	R0,(R2)+		;STORE INPUT BUFFER ADDRESS
  14400	000414	006026 				ROR	(SP)+			;RECOVER CARRY FROM GCML
  14500	000416	103035 				BCC	150$			;BRANCH IF GOOD COMMAND LINE
  14600	000420	122767 	177766 	000140G		CMPB	#GE.EOF,GCMLB+G.ERR	;END OF FILE?
  14700	000426	001014 				BNE	120$			;BRANCH IF NOT
  14710	000430	105367 	000152G			DECB	GCMLB+G.CDEP		;FORCE CURRENT DEPTH TO INIT VALUE
  14800	000434	005012 				CLR	(R2)			;ZERO BYTE COUNT (INC LATER)
  14900	000436	112710 	000032 			MOVB	#'Z-100,(R0)		;STORE A CONTROL Z
  14910	000442	032716 	000004 			BIT	#4,(SP)			;IS THIS A COMMAND LINE?
  14920	000446	001476 				BEQ	165$			;BRANCH IF NOT
  14930	000450	012720 	006505 			MOV	#<15*400+'E>,(R0)+	;FORM AN "E" COMMAND
  14950	000454	005212 				INC	(R2)			;COUNT ONE OF THE CHARACTERS
  14960
  14970						.IF	DF,R$$STS		;RSTS ONLY
  14980						BR	165$
  14990						.IFF				;RSX ONLY
  15000	000456	000455 				BR	161$
  15010						.ENDC
  15020
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-3
TTY I/O ROUTINES - LISTEN

  15100	000460	122767 	177730 	000140G	120$:	CMPB	#IE.RBG,GCMLB+G.ERR	;THIS ERROR RETURNED FOR CMD LINE
  15200										;ENDED BY BYTE COUNT EXHAUSTED
  15300	000466	001007 				BNE	130$			;BRANCH IF OTHER ERROR
  15400	000470	016700 	000070G			MOV	GCMLB+F.BDB,R0		;GET I/O STATUS BLOCK ADR
  15500	000474	022720 	000001 			CMP	#IS.SUC,(R0)+		;SUCCESSFUL COMPLETION?
  15600	000500	001002 				BNE	130$			;BRANCH IF NOT
  15700	000502	011012 				MOV	(R0),(R2)		;GET SIZE OF DATA READ
  15800	000504	000460 				BR	168$			;AND GO PROCESS THE LINE
  15900	000506	000167 	000000G		130$:	JMP	LISTN3			;REPORT OTHER GCML ERROR
  16000										;WILL RETURN TO LISTN4 BELOW
  16100					;
  16200					; COMMAND LINE WAS SUCCESSFULLY READ
  16300					;
  16400	000512	016712 	000146G		150$:	MOV	GCMLB+G.CMLD,(R2)	;LEN OF COMMAND
  16600	000516	061200 				ADD	(R2),R0			;ADR OF LAST+1 CHARACTER
  16700
  16800	000520	112710 	000015 			MOVB	#15,(R0)		;ASSUME CR TERMINATOR FOR INDIRECT FILES
  16900						.IF	NDF,R$$STS		; RSX ONLY
  17000	000524	105767 	000001G			TSTB	GCMLB+F.RATT		;IF GCML DETACH MAY HAVE OCCURRED
  17100	000530	001402 				BEQ	155$
  17200	000532	004767 	000000G			JSR	PC,ATACH1		;REATTACH THE TERMINAL
  17300	000536				155$:
  17400						.IFTF				;BOTH RSX AND RSTS
  17500	000536	132767 	000004 	000017G		BITB	#FD.TTY,GCMLB+F.RCTL	;IF NOT TTY, TERMINATOR AT END OF RECORD
  17600
  17700						.IFT				;RSX
  17800	000544	001422 				BEQ	161$
  17900
  18000						.IFF				;RSTS
  18100						BEQ	159$
  18200
  18300						.IFTF				;BOTH
  18400	000546	017746 	000070G			MOV	@GCMLB+F.BDB,-(SP)	;1(SP) GETS TERMINATOR BYTE
  18500	000552	000316 				SWAB	(SP)
  18600	000554	112610 				MOVB	(SP)+,(R0)		;STORE TERMINATOR AT END OF BUFFER
  18700
  18800						.IFF				;RSTS ONLY
  18900					159$:	CMPB	(R0),-(R0)		;CHECK THAT IT'S NOT ALREADY THERE
  19000						BEQ	168$			;BRANCH IF IT WAS
  19100						CMPB	(R0),#12		;WAS TERM A LF CHAR
  19200						BEQ	168$			; YES - IT CAME WITH DATA
  19300						BITB	#FD.TTY,GCMLB+F.RCTL	;   IF INPUT WAS A FILE, DON'T
  19400						BEQ	165$			;   TERMINATE RECORD WITH ALTMODE
  19500										;    TREAT #33 AS A NORMAL DATA CHAR
  19600						CMPB	(R0),#33		;WAS TERM A ALTMODE?
  19700						BEQ	168$			; YES - IT CAME WITH DATA ALSO
  19800										;  ONLY CR MUST BE KLUDGED
  19900
  20000						.IFT				;RSX ONLY
  20100	000556	122710 	000033 			CMPB	#33,(R0)		;ALTMODE?
  20200	000562	001010 				BNE	160$			;BRANCH IF NOT
  20250	000564	012700 	000000G			MOV	#TTOCTL,R0		;ADDRESS OF OUT BUF ADR AND SIZE
  20300	000570	116730 	000000G			MOVB	ALTECO,@(R0)+		;ECHO "$" IF NECESSARY
  20400	000574	001423 				BEQ	165$			;BRANCH IF NO ECHO REQUIRED
  20500	000576	005210 				INC	(R0)			;COUNT THE CHARACTER
  20600	000600	005240 				INC	-(R0)			;ADJUST BUFFER POINTER
  20700	000602	000420 				BR	165$
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-4
TTY I/O ROUTINES - LISTEN

  20800	000604	122710 	000015 		160$:	CMPB	#15,(R0)		;CR TERMINATOR?
  20900	000610	001015 				BNE	165$			;BRANCH IF NOT
  21000	000612	004767 	000000G		161$:	JSR	PC,INITCR		;SET UP TO ECHO CR, LF
  21100	000616	032716 	000004 			BIT	#4,(SP)			;COMMAND LINE?
  21200	000622	001410 				BEQ	165$			;BRANCH IF NOT
  21300	000624	005712 				TST	(R2)			;EMPTY LINE, ENDED WITH CR?
  21400	000626	001404 				BEQ	162$			;BRANCH IF YES, RETURN LF
  21500	000630	122740 	000012 			CMPB	#12,-(R0)		;LAST CHAR = LF
  21600	000634	001404 				BEQ	168$			;BRANCH IF YES, DON'T ADD CR
  21700	000636	000402 				BR	165$			;NO, APPEND THE CR
  21800	000640	112710 	000012 		162$:	MOVB	#12,(R0)		;RETURN LF FOR EMPTY CMD LINE ENDED WITH CR
  21900						.ENDC
  22000
  22100	000644	005212 			165$:	INC	(R2)			;ADD IN LINE TERMINATOR
  22200	000646	005767 	000000G		168$:	TST	CTLCFL			;CONTROL C HERE?
  22300	000652	001040 				BNE	190$			;YES.  KILL CMD
  22400	000654	113100 			170$:	MOVB	@(R1)+,R0		;COPY NEXT CHAR IN BUFFER
  22500	000656	005311 				DEC	(R1)			;DECR LEN LEFT
  22600
  22700						.IF	NDF,R$$STS
  22800	000660	003002 				BGT	175$			;BRANCH IF NOT LAST CHARACTER
  22900	000662	105067 	000000G			CLRB	NOECHO			;ECHO TERMINATOR IN ALTER INSERT
  23000										;EVEN IF READING WITH SPECIAL TERM
  23100	000666				175$:
  23200						.ENDC
  23300
  23400	000666	005241 				INC	-(R1)			;INC POINTER
  23500	000670	042700 	177600 			BIC	#-177-1,R0		;CLEAR PARITY BIT
  23600	000674	001002 				BNE	178$			;BRANCH IF NOT NULL
  23700	000676	000167 	177124 			JMP	10$			;IGNORE NULLS
  23800	000702	032716 	000002 		178$:	BIT	#2,(SP)			;UPPER CASE?
  23900	000706	001410 				BEQ	180$			;NO.  LEAVE AS IS
  24000	000710	020027 	000141 			CMP	R0,#'A+40		;LOWER
  24100	000714	002405 				BLT	180$			;CASE
  24200	000716	020027 	000172 			CMP	R0,#'Z+40		;LETTER
  24300	000722	003002 				BGT	180$			;??
  24400	000724	042700 	000040 			BIC	#40,R0			;CAPITALIZE IT
  24500	000730				180$:
  24600	000730	032716 	000001 			BIT	#1,(SP)			; ALTER MODE??
  24700	000734	001434 				BEQ	200$			;SKIP BELL TEST IF ALTER
  24800	000736	020027 	000007 			CMP	R0,#7			;IS CHAR A BELL?
  24900	000742	001031 				BNE	200$			;NO.
  25000	000744	127127 	000000 	000007 		CMPB	@(R1),#7		;DOUBLE BELL?
  25100	000752	001025 				BNE	200$			;NO.
  25200	000754				190$:
  25300						.IF	NDF,R$$STS		;RSX
  25320	000754	032767 	000000G	000000G		BIT	#SYSCME,SYSTEM		;IF VAX/VMS CME
  25340	000762	001002 				BNE	195$			;THEN NO CRLF REQUIRED
  25400	000764	004767 	000000G			JSR	PC,INITCR		;CR, LF MSG IN RESPONSE TO ^C
  25500						.ENDC
  25600	000770				LISTN4::
  25650	000770	005061 	000002 		195$:	CLR	2(R1)			;KILL REST OF LINE
  25700	000774	032716 	000020 			BIT	#20,(SP)		; LISTEN TO ^C TRAPS??
  25800	001000	001010 				BNE	198$			; NO.. PASS THEM TO CALLER
  25900	001002	012746 	000002 			MOV	#2,-(SP)		;SET SEVERITY - ABORT CMDT
  26100	001006	012746 	177777 			MOV	#-1,-(SP)		;NO MESSAGE
  26200	001012	005067 	000000G			CLR	CTLCFL			;RESET CC FLAG
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-5
TTY I/O ROUTINES - LISTEN

  26300	001016	004767 	000000G			JSR	PC,SOSERR		;ABORT THE COMMAND
  26350	001022	012700 	000003 		198$:	MOV	#3,R0			;RETURN CONTROL C
  26400	001026	005726 			200$:	TST	(SP)+			; DUMP FLAG PARAMETER
  26500	001030	012602 				MOV	(SP)+,R2		;RESTORE
  26600	001032	012601 				MOV	(SP)+,R1		;THE SAVED REGS
  26700	001034	000207 				RTS	PC			;AND RETURN
  26800
  26900						.DSABL	LSB
  27000
  27100		000001 				.END
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-6
SYMBOL TABLE

ALTECO= ****** GX	F.BGBC= 000057   	G.CDEP= 000152   	IE.IFU= 177747   	IE.ULN= 177773
ATACH1= ****** GX	F.BKDN= 000026   	G.CMLD= 000146   	IE.ILL= 177726   	IE.UNS= 177774
ATTACH= ****** GX	F.BKDS= 000020   	G.DPRM= 000160   	IE.ILU= 177640   	IE.UPN= 177777
CH.AND= 000001   	F.BKEF= 000050   	G.ERR = 000140   	IE.ILV= 177755   	IE.VER= 177774
CTLCFL= ****** GX	F.BKP1= 000051   	G.ISIZ= 000020   	IE.INS= 177776   	IE.WAC= 177743
FA.APD= 000100   	F.BKST= 000024   	G.MODE= 000141   	IE.IOP= 177655   	IE.WAT= 177741
FA.CRE= 000010   	F.BKVB= 000064   	G.PSDS= 000142   	IE.IPR= 177641   	IE.WCK= 177652
FA.DLK= 001000   	F.CHR = 000075   	G.SIZE= 000224   	IE.ISQ= 177703   	IE.WER= 177737
FA.ENB= 100000   	F.CNTG= 000034   	IE.ABO= 177761   	IE.ITI= 177643   	IE.WLK= 177764
FA.EXC= 002000   	F.DFNB= 000046   	IE.ACT= 177771   	IE.ITP= 177650   	IE.WOV= 177653
FA.EXT= 000004   	F.DSPT= 000044   	IE.ADP= 177636   	IE.ITS= 177770   	IE.2DV= 177720
FA.NSP= 000100   	F.DVNM= 000134   	IE.ALC= 177654   	IE.IUI= 177645   	INITCR= ****** GX
FA.POS= 010000   	F.EFBK= 000010   	IE.ALG= 177654   	IE.LCK= 177745   	IORST   000030R     002
FA.RD = 000001   	F.EFN = 000050   	IE.ALN= 177736   	IE.LNL= 177646   	IOSTS = ****** GX
FA.RWD= 004000   	F.EOBB= 000032   	IE.AST= 177660   	IE.MAP= 177657   	IO.ACE= 007400
FA.SEQ= 040000   	F.ERR = 000052   	IE.BAD= 177777   	IE.MOD= 177753   	IO.ACR= 006400
FA.SHR= 000040   	F.FACC= 000043   	IE.BBE= 177710   	IE.NBF= 177731   	IO.ACW= 007000
FA.TMP= 000020   	F.FFBY= 000014   	IE.BCC= 177676   	IE.NBK= 177727   	IO.ADS= 014000
FA.WCK= 020000   	F.FNAM= 000110   	IE.BDI= 177714   	IE.NDR= 177670   	IO.APC= 014000
FA.WRT= 000002   	F.FNB = 000102   	IE.BDR= 177716   	IE.NFI= 177704   	IO.APV= 014010
FD.BLK= 000010   	F.FTYP= 000116   	IE.BDV= 177711   	IE.NFW= 177673   	IO.ATA= 001410
FD.CCL= 000002   	F.FVER= 000120   	IE.BHD= 177700   	IE.NLK= 177661   	IO.ATT= 001400
FD.COM= 020000   	F.HIBK= 000004   	IE.BLB= 177672   	IE.NLN= 177733   	IO.CAS= 015420
FD.CR = 000002   	F.LUN = 000042   	IE.BLK= 177754   	IE.NNC= 177663   	IO.CBO= 015510
FD.DIR= 000010   	F.MBCT= 000054   	IE.BNM= 177712   	IE.NNL= 177662   	IO.CCI= 014000
FD.FTN= 000001   	F.MBC1= 000055   	IE.BTF= 177664   	IE.NNN= 177674   	IO.CCO= 000440
FD.F11= 040000   	F.MBFG= 000056   	IE.BTP= 177725   	IE.NOD= 177751   	IO.CIN= 016500
FD.INS= 000010   	F.NRBD= 000024   	IE.BVR= 177701   	IE.NSF= 177746   	IO.CLK= 015000
FD.ISP= 002000   	F.NREC= 000030   	IE.BYT= 177755   	IE.NST= 177660   	IO.CLN= 003400
FD.MNT= 100000   	F.OVBS= 000030   	IE.CKP= 177766   	IE.NSW= 177756   	IO.CNT= 017000
FD.OSP= 004000   	F.RACC= 000016   	IE.CKS= 177742   	IE.NVR= 177652   	IO.CON= 015400
FD.PLC= 000004   	F.RATT= 000001   	IE.CLO= 177732   	IE.NVW= 177651   	IO.CPR= 015410
FD.PRN= 000004   	F.RCNM= 000034   	IE.CNR= 177667   	IE.OFL= 177677   	IO.CPW= 016520
FD.PSE= 010000   	F.RCTL= 000017   	IE.CON= 177752   	IE.ONP= 177773   	IO.CRC= 001040
FD.RAH= 000001   	F.RSIZ= 000002   	IE.DAA= 177770   	IE.OVR= 177756   	IO.CRE= 012000
FD.RAN= 000002   	F.RTYP= 000000   	IE.DAO= 177763   	IE.PES= 177655   	IO.CRJ= 015440
FD.REC= 000001   	F.SEQN= 000100   	IE.DFU= 177750   	IE.PNS= 177642   	IO.CSI= 013000
FD.RWM= 000001   	F.SPDV= 000072   	IE.DNA= 177771   	IE.PRI= 177760   	IO.CSM= 016470
FD.SDI= 000020   	F.SPUN= 000074   	IE.DNR= 177775   	IE.PTS= 177775   	IO.CTI= 015400
FD.SQD= 000040   	F.STBK= 000036   	IE.DUN= 177767   	IE.RAC= 177724   	IO.CTL= 016400
FD.TTY= 000004   	F.UNIT= 000136   	IE.DUP= 177707   	IE.RAT= 177723   	IO.CTR= 015610
FD.WBH= 000002   	F.URBD= 000020   	IE.EOF= 177766   	IE.RBG= 177730   	IO.CTY= 003400
FF.CHR= 000005   	F.VBN = 000064   	IE.EOT= 177702   	IE.RBS= 177761   	IO.DAC= 010000
FF.NV = 000003   	F.VBSZ= 000060   	IE.EOV= 177765   	IE.RCN= 177722   	IO.DCI= 014400
FF.POE= 000002   	GCMLB = ****** GX	IE.EXP= 177665   	IE.RER= 177740   	IO.DEL= 012400
FF.RWD= 000001   	GE.BIF= 177775   	IE.FEX= 177717   	IE.RNM= 177715   	IO.DET= 002000
FF.RWF= 000006   	GE.CLO= 000004   	IE.FHE= 177705   	IE.RSU= 177757   	IO.DIS= 016000
FF.SPC= 000004   	GE.COM= 000001   	IE.FIX= 177767   	IE.SDP= 177635   	IO.DLB= 016540
FO.APD= 000106   	GE.CON= 000020   	IE.FLN= 177657   	IE.SNC= 177735   	IO.DSI= 013400
FO.MFY= 000002   	GE.EOF= 177766   	IE.FOP= 177713   	IE.SPC= 177772   	IO.DTI= 016000
FO.RD = 000001   	GE.IND= 000002   	IE.HFU= 177744   	IE.SQC= 177734   	IO.DTY= 006400
FO.UPD= 000006   	GE.IOR= 177777   	IE.HWR= 177772   	IE.SRE= 177762   	IO.ENA= 006000
FO.WRT= 000016   	GE.LC = 000010   	IE.IBS= 177647   	IE.STK= 177706   	IO.EOF= 003000
F.ACTL= 000076   	GE.MDE= 177774   	IE.IDU= 177644   	IE.TCH= 177765   	IO.EXT= 011400
F.ALOC= 000040   	GE.OPR= 177776   	IE.IEF= 177637   	IE.TMM= 177671   	IO.FDX= 003020
F.BBFS= 000062   	GE.RBG= 177730   	IE.IES= 177656   	IE.TMO= 177666   	IO.FLN= 012400
F.BDB = 000070   	GE.SIZ= 000040   	IE.IFC= 177776   	IE.ULK= 177653   	IO.FNA= 004400
SOSTTY - TERMINAL I/O - LISTEN	MACRO M1110  22-AUG-78 05:35  PAGE 3-7
SYMBOL TABLE

IO.GLC= 016430   	IO.RBC= 003000   	IO.STA= 015400   	IS.ESQ= 115401   	Q.IOEF= 000006
IO.GLI= 016420   	IO.RCI= 015000   	IO.STC= 002500   	IS.PES= 100001   	Q.IOFN= 000002
IO.GNI= 016410   	IO.RCV= 015000   	IO.STP= 016400   	IS.PND= 000000   	Q.IOLU= 000004
IO.GRC= 016450   	IO.RDB= 001200   	IO.SYN= 003040   	IS.RDD= 000002   	Q.IOPL= 000014
IO.GRI= 016440   	IO.RDD= 010010   	IO.TRM= 002410   	IS.SET= 000002   	Q.IOPR= 000007
IO.GRN= 016460   	IO.RDN= 000022   	IO.UDI= 011410   	IS.SPD= 000002   	Q.IOSB= 000010
IO.GTS= 002400   	IO.REL= 013400   	IO.UEI= 011450   	IS.SUC= 000001   	RAISLC= ****** GX
IO.HDX= 003010   	IO.RHD= 001010   	IO.UER= 011440   	IS.TAB= 004401   	RNEPAL  000000R     002
IO.HIS= 015000   	IO.RLB= 001000   	IO.ULK= 005000   	IS.TMO= 000002   	RONLY$= 000001
IO.HNG= 003000   	IO.RLV= 001100   	IO.UNL= 000042   	LISTEN  000000RG    003	R$$EIS= 000001
IO.INI= 014400   	IO.RMT= 010020   	IO.USI= 011460   	LISTN1= ****** GX	R$$SHR= 000001
IO.INL= 002400   	IO.RNA= 005400   	IO.UTI= 011420   	LISTN2  000404RG    003	R.FIX = 000001
IO.ITI= 017000   	IO.RNC= 001040   	IO.UTY= 011430   	LISTN3= ****** GX	R.SEQ = 000003
IO.KIL= 000012   	IO.RNE= 001020   	IO.WAL= 000410   	LISTN4  000770RG    003	R.VAR = 000002
IO.LDI= 007000   	IO.RNS= 001020   	IO.WAT= 013400   	NB.DEV= 000200   	SOSERR= ****** GX
IO.LED= 012000   	IO.RPB= 001040   	IO.WBT= 000500   	NB.DIR= 000100   	SOSFLG= ****** GX
IO.LEI= 007410   	IO.RPR= 004400   	IO.WDD= 000444   	NB.NAM= 000004   	SYSCME= ****** GX
IO.LKE= 012000   	IO.RST= 001001   	IO.WLB= 000400   	NB.SD1= 000400   	SYSTEM= ****** GX
IO.LOD= 014000   	IO.RTC= 003400   	IO.WLC= 000420   	NB.SD2= 001000   	S.FATT= 000016
IO.LOV= 001010   	IO.RTI= 016400   	IO.WLS= 000410   	NB.SNM= 000040   	S.FDB = 000140
IO.LSI= 011000   	IO.RTK= 000060   	IO.WLT= 000410   	NB.STP= 000020   	S.FNAM= 000006
IO.LTI= 007400   	IO.RTM= 001200   	IO.WLV= 000500   	NB.SVR= 000010   	S.FNB = 000036
IO.LTK= 000050   	IO.RVB= 010400   	IO.WMS= 000420   	NB.TYP= 000002   	S.FNBW= 000017
IO.LTY= 010000   	IO.RWD= 002400   	IO.WNS= 000420   	NB.VER= 000001   	S.FNTY= 000004
IO.MAO= 003410   	IO.RWU= 002540   	IO.WPB= 000440   	NOECHO= ****** GX	S.FTYP= 000002
IO.MCS= 013400   	IO.R1C= 002400   	IO.WVB= 011000   	NOLOW = ****** GX	S.NFEN= 000020
IO.MDA= 016000   	IO.SAO= 004000   	IO.XMT= 014400   	N.DID = 000024   	TIOLUN= ****** GX
IO.MDI= 014400   	IO.SCS= 013000   	IO.XNA= 014410   	N.DVNM= 000032   	TTIBUF= ****** GX
IO.MDO= 015400   	IO.SDI= 013000   	IQ.Q  = 000002   	N.FID = 000000   	TTICTL= ****** GX
IO.MLO= 006000   	IO.SDO= 012400   	IQ.S  = 000004   	N.FNAM= 000006   	TTOBUF= ****** GX
IO.MOD= 003000   	IO.SEC= 002520   	IQ.UMD= 000004   	N.FTYP= 000014   	TTOCTL= ****** GX
IO.MSO= 005000   	IO.SET= 000030   	IQ.X  = 000001   	N.FVER= 000016   	TYPDPB= ****** GX
IO.NLB= 016530   	IO.SLO= 005400   	IS.BV = 000005   	N.NEXT= 000022   	$$MSG = 000000
IO.NLK= 011400   	IO.SMO= 002560   	IS.CC = 001401   	N.STAT= 000020   	$$$ARG= 000006
IO.ONL= 017400   	IO.SPB= 002420   	IS.CLR= 000000   	N.UNIT= 000034   	$$$OST= 000014
IO.RAD= 010400   	IO.SPF= 002440   	IS.CR = 006401   	QIOERR= ****** GX	...GBL= 000000
IO.RAL= 001010   	IO.SPW= 016510   	IS.EOT= 002001   	Q.IOAE= 000012   	...TPC= 000140
IO.RAT= 013000   	IO.SSO= 004400   	IS.ESC= 015401

. ABS.	000000	   000
      	000000	   001
PLIT  	000060	   002
CODE  	001036	   003
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  5511 WORDS  ( 22 PAGES)
DYNAMIC MEMORY:  6996 WORDS  ( 26 PAGES)
ELAPSED TIME:  00:00:23
OBJ$:SOSTTY,LIS$:SOSTTY/-SP/NL:TOC=SRC$:PREFIX,SOSTTY
