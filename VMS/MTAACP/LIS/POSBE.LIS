
; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:02	DBB3:[MTAACP.SRC]POSBE.B32;5					Page 1
; Digital Equipment Corporation
;
;	0001	MODULE POSBE (
;	0002			LANGUAGE (BLISS32),
;	0003			IDENT = 'A0002'
;	0004			) =
;	0005	BEGIN
;	0006	
;	0007	!
;	0008	! COPYRIGHT (C) 1977
;	0009	! DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS 01754
;	0010	!
;	0011	! THIS SOFTWARE IS FURNISHED  UNDER A LICENSE FOR USE ONLY ON A SINGLE
;	0012	! COMPUTER  SYSTEM AND  MAY BE  COPIED ONLY WITH  THE INCLUSION OF THE
;	0013	! ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE, OR ANY OTHER COPIES THEREOF,
;	0014	! MAY NOT BE PROVIDED OR  OTHERWISE MADE AVAILABLE TO ANY OTHER PERSON
;	0015	! EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO AGREES TO THESE LICENSE
;	0016	! TERMS.  TITLE TO AND  OWNERSHIP OF THE  SOFTWARE  SHALL AT ALL TIMES
;	0017	! REMAIN IN DEC.
;	0018	!
;	0019	! THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE WITHOUT NOTICE
;	0020	! AND SHOULD  NOT BE CONSTRUED  AS A COMMITMENT  BY DIGITAL  EQUIPMENT
;	0021	! CORPORATION.
;	0022	!
;	0023	! DEC ASSUMES  NO  RESPONSIBILITY  FOR  THE USE OR  RELIABILITY OF ITS
;	0024	! SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
;	0025	
;	0026	!++
;	0027	!
;	0028	! FACILITY:  MTAACP
;	0029	!
;	0030	! ABSTRACT:
;	0031	!	THIS MODULE POSITIONS TO THE BEGINNING OR TO THE END OF THE VOLUME SET
;	0032	!
;	0033	!
;	0034	! ENVIRONMENT:
;	0035	!
;	0036	!	STARLET OPERATING SYSTEM, INCLUDING PRIVILEGED SYSTEM SERVICES
;	0037	!	AND INTERNAL EXEC ROUTINES.
;	0038	!
;	0039	!--
;	0040	!
;	0041	!
;	0042	! AUTHOR:  D. H. GILLESPIE,	 CREATION DATE:  14-JUL-1977  
;	0043	!
;	0044	! REVISION HISTORY:
;	0045	!
;	0046	!   D. H. Gillespie, 28-Feb-1978  10:53
;	0047	!   X0002 - CHANGE LOGIC THAT RECOGNIZES DUMMY FILE SO CAN USE 11-M NEWLY INITIALIZED TAPES
;	0048	!
;	0049	!   D. H. Gillespie, 12-May-78  14:46
;	0050	!   A0001 - change CURRENT_VCB to a register
;	0051	!
;	0052	!   D. H. Gillespie, 23-May-78  13:30
;	0053	!   A0002 - change linkage to GET_START_HDR
;	0054	!
;	0055	!**

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:02	DBB3:[MTAACP.SRC]POSBE.B32;5					Page 1-1
; Digital Equipment Corporation
;
;	0056	
;	0057	LIBRARY 'SYS$LIBRARY:LIB.L32';
;	0058	REQUIRE 'SRC$:MTADEF.B32';
;	0354	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:02	DBB3:[MTAACP.SRC]POSBE.B32;5					Page 2
; Digital Equipment Corporation
;
;	0355	GLOBAL ROUTINE POSITION_TO_END : COMMON_CALL NOVALUE =
;	0356	
;	0357	!++
;	0358	!
;	0359	! FUNCTIONAL DESCRIPTION:
;	0360	!	THIS ROUTINE POSITIONS THE VOLUME SET AT THE END
;	0361	!
;	0362	! CALLING SEQUENCE:
;	0363	!	POSITION_TO_END()
;	0364	!
;	0365	! INPUT PARAMETERS:
;	0366	!	NONE
;	0367	!
;	0368	! IMPLICIT INPUTS:
;	0369	!	CURRENT_VCB - ADDRESS OF CURRENT VCB
;	0370	!	CURRENT_WCB - ADDRESS OF CURRENT WCB
;	0371	!
;	0372	! OUTPUT PARAMETERS:
;	0373	!	NONE
;	0374	!
;	0375	! IMPLICIT OUTPUTS:
;	0376	!	NONE
;	0377	!
;	0378	! ROUTINE VALUE:
;	0379	!	NONE
;	0380	!
;	0381	! SIDE EFFECTS:
;	0382	!	THE VOLUME SET IS POSITIONED TO THE END
;	0383	!	IF THE DUMMY FILE IS FOUND, THEN THE TAPE IS POSITIONED BEFORE THE DUMMY FILE
;	0384	!
;	0385	! USER ERRORS:
;	0386	!	SS$_FILALRACC - CAN NOT POSTION TO END IF A FILE IS ALREADY ACCESSED
;	0387	!
;	0388	!--
;	0389	
;	0390	BEGIN
;	0391	
;	0392	EXTERNAL REGISTER
;	0393		COMMON_REG;
;	0394	
;	0395	
;	0396	LOCAL
;	0397		MVL		: REF BBLOCK,		!MAG TAPE VOLUME LIST
;	0398		LASTVOL;				!RVN OF LAST VOLUME
;	0399	
;	0400	EXTERNAL
;	0401		CURRENT_WCB	: REF BBLOCK;		!ADDRESS OF CURRENT WINDOW CONTROL BLOCK
;	0402	
;	0403	EXTERNAL ROUTINE
;	0404		CLOSE_FILE	: L$CLOSE_FILE,		!CLOSE FILE
;	0405		GET_START_HDR	: L$GET_START_HDR,	!GET START HEADERS
;	0406		SPACE_EOF;				!SPACE TO END OF FILE
;	0407	
;	0408	! THIS FUNCTION IS NOT LEGAL IF A FILE IS OPEN
;	0409	IF .CURRENT_WCB NEQU 0 THEN ERR_EXIT(SS$_FILALRACC);

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:02	DBB3:[MTAACP.SRC]POSBE.B32;5					Page 2-1
; Digital Equipment Corporation
;
;	0410	IF .CURRENT_VCB[VCB$V_PARTFILE] THEN CLOSE_FILE();
;	0411	WHILE 1 DO
;	0412	    BEGIN
;	0413	    IF NOT GET_START_HDR() THEN EXITLOOP;
;	0414	    IF .CURRENT_VCB[VCB$W_CUR_NUM] EQLU 0 THEN EXITLOOP;
;	0415	    SPACE_EOF();				!SPACE TO END OF CURRENT FILE
;	0416	    END;
;	0417	END;						!END OF ROUTINE


							    .TITLE  POSBE
							    .IDENT  \A0002\

							    .GLOBL  CURRENT_WCB, CLOSE_FILE, GET_START_HDR, SPACE_EOF

							    .PSECT  $CODE$,NOWRT,2

					 0400 00000 	    .ENTRY  POSITION_TO_END, Save R10				      ; 0355
				0000G  CF  D5 00002 	    TSTL    CURRENT_WCB						      ; 0409
				       04  13 00006 	    BEQL    1$							      ;
				00A4   8F  BF 00008 	    CHMU    #164						      ;
		         03	  0B   AB  E9 0000C 1$:     BLBC    11(CURRENT_VCB), 2$					      ; 0410
				     0000  30 00010 	    BSBW    CLOSE_FILE						      ;
				     0000  30 00013 2$:     BSBW    GET_START_HDR					      ; 0413
		         0C	       50  E9 00016 	    BLBC    R0, 3$						      ;
				  24   AB  B5 00019 	    TSTW    36(CURRENT_VCB)					      ; 0414
				       07  13 0001C 	    BEQL    3$							      ;
		  0000G  CF	       00  FB 0001E 	    CALLS   #0, SPACE_EOF					      ; 0415
				       EE  11 00023 	    BRB     2$							      ; 0411
					   04 00025 3$:     RET     							      ; 0355

; Routine Size:  38 bytes



; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:02	DBB3:[MTAACP.SRC]POSBE.B32;5					Page 3
; Digital Equipment Corporation
;
;	0418	END
;	0419	ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  $CODE$         	    38  NOWRT,  RD ,  EXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)




;				LIBRARY STATISTICS
;
;					     -------- Symbols --------    Blocks
;	File				     Total    Loaded   Percent      Read
;
;  DBA4:[SYSLIB]LIB.L32;1		      5582         9         0       227





; Size:		38 code + 0 data bytes
; Run Time:	00:04.5
; Elapsed Time:	00:23.0
; Memory Used:	253 pages
; Compilation Complete
