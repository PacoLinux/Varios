
; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 1
; Digital Equipment Corporation
;
;	0001	MODULE PRSTRN (
;	0002			LANGUAGE (BLISS32),
;	0003			IDENT = 'A0001'
;	0004			) =
;	0005	BEGIN
;	0006	
;	0007	!
;	0008	! COPYRIGHT (C) 1977
;	0009	! DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS 01754
;	0010	!
;	0011	! THIS SOFTWARE IS FURNISHED  UNDER A LICENSE FOR USE ONLY ON A SINGLE
;	0012	! COMPUTER  SYSTEM AND  MAY BE  COPIED ONLY WITH  THE INCLUSION OF THE
;	0013	! ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE, OR ANY OTHER COPIES THEREOF,
;	0014	! MAY NOT BE PROVIDED OR  OTHERWISE MADE AVAILABLE TO ANY OTHER PERSON
;	0015	! EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO AGREES TO THESE LICENSE
;	0016	! TERMS.  TITLE TO AND  OWNERSHIP OF THE  SOFTWARE  SHALL AT ALL TIMES
;	0017	! REMAIN IN DEC.
;	0018	!
;	0019	! THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE WITHOUT NOTICE
;	0020	! AND SHOULD  NOT BE CONSTRUED  AS A COMMITMENT  BY DIGITAL  EQUIPMENT
;	0021	! CORPORATION.
;	0022	!
;	0023	! DEC ASSUMES  NO  RESPONSIBILITY  FOR  THE USE OR  RELIABILITY OF ITS
;	0024	! SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DEC.
;	0025	
;	0026	!++
;	0027	!
;	0028	! FACILITY:  MTAACP
;	0029	!
;	0030	! ABSTRACT:
;	0031	!	THIS MODULE PARSES AND TRANSLATES CHARACTERS IN EITHER THE FILE
;	0032	!	IDENTIFICATION FIELD IN THE HDR1 OR FILE NAME STRING TO A
;	0033	!	DESCRIPTOR FOR THE FILE NAME, THE FILE TYPE, AND BINARY VERSION
;	0034	!
;	0035	! ENVIRONMENT:
;	0036	!
;	0037	!	STARLET OPERATING SYSTEM, INCLUDING PRIVILEGED SYSTEM SERVICES
;	0038	!	AND INTERNAL EXEC ROUTINES.
;	0039	!
;	0040	!--
;	0041	!
;	0042	!
;	0043	! AUTHOR:  D. H. GILLESPIE,	 CREATION DATE:  19-MAY-17:35  
;	0044	!
;	0045	! REVISION HISTORY:
;	0046	!
;	0047	!**
;	0048	
;	0049	LIBRARY 'SYS$LIBRARY:LIB.L32';
;	0050	REQUIRE 'SRC$:MTADEF.B32';
;	0346	
;	0347	LINKAGE
;	0348		CALL2 = JSB(REGISTER = 0) : GLOBAL(INPLEN = 5),
;	0349		CALL4 = JSB() : GLOBAL(INPPTR = 3,OUTPTR = 4,INPLEN = 5,MAX = 6),
;	0350		JSBR2 = JSB(REGISTER = 2) : NOPRESERVE(0,1);

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 1-1
; Digital Equipment Corporation
;
;	0351	
;	0352	FORWARD ROUTINE
;	0353		PARSE_TRANS_FNS : NOVALUE,			!PARSE AND TRANSLATE FILE NAME STRING
;	0354		PARSE_TRANS_FID	: NOVALUE,			!PARSE AND TRANSLATE FILE ID
;	0355		TRANS_FILE_ID	: NOVALUE,			!TRANSLATE NON-RAD50 CHAR IN FID
;	0356		PARSE_FILE_ID	: NOVALUE,			!PARSE FID INTO FILE NAME AND TYPE
;	0357		PARSE_TRANS_FNM	: NOVALUE,			!PARSE AND TRANSLATE A FILE NAME STRING
;	0358		MTC		: CALL4,				!MOVES TRANSLATED CHARACTERS
;	0359		CHKTERM		: CALL2 NOVALUE,			!CHECK TERMINATOR
;	0360		TRANS		: JSBR2,			!TRANSLATE
;	0361		TYPE		: JSBR2,			!CLASSIFY CHAR
;	0362		GETGP		: CALL4;			!GET GROUP OF CHARACTERS
;	0363	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 2
; Digital Equipment Corporation
;
;	0364	GLOBAL ROUTINE PARSE_TRANS_FID(BUFFER,DESFN,DESTY,BINVER) : NOVALUE  =
;	0365	
;	0366	!++
;	0367	!
;	0368	! FUNCTIONAL DESCRIPTION:
;	0369	!	THIS ROUTINE PARSES AND TRANSLATES NON-RAD50 CHAR OF THE FILE
;	0370	!	IDENTIFICATION FIELD IN HDR1, TRAILING BLANKS ARE STRIPPED
;	0371	!
;	0372	! CALLING SEQUENCE:
;	0373	!	PARSE_TRANS_FID(ARG1,ARG2,ARG3,ARG4)
;	0374	!
;	0375	! INPUT PARAMETERS:
;	0376	!	ARG1 - ADDRESS OF BUFFER FOR TRANSLATED OUTPUT STRING
;	0377	!	ARG2 - ADDRESS OF DESCRIPTOR FOR FILE NAME
;	0378	!	ARG3 - ADDRESS OF DESCRIPTOR FOR FILE TYPE
;	0379	!	ARG4 - ADDRESS OF 2 BYTES FOR BINARY VERSION NUMBER
;	0380	!
;	0381	! IMPLICIT INPUTS:
;	0382	!	NONE
;	0383	!
;	0384	! OUTPUT PARAMETERS:
;	0385	!	ARG1 - ADDRESS OF BUFFER FOR TRANSLATED OUTPUT STRING
;	0386	!	ARG2 - ADDRESS OF DESCRIPTOR FOR FILE NAME
;	0387	!	ARG3 - ADDRESS OF DESCRIPTOR FOR FILE TYPE
;	0388	!	ARG4 - ADDRESS OF 2 BYTES FOR BINARY VERSION NUMBER
;	0389	!
;	0390	! IMPLICIT OUTPUTS:
;	0391	!	NONE
;	0392	!
;	0393	! ROUTINE VALUE:
;	0394	!	NONE
;	0395	!
;	0396	! SIDE EFFECTS:
;	0397	!	ARG1-ARG4 RECEIVE THE APPROPRIATE DATA
;	0398	!
;	0399	!--
;	0400	
;	0401	BEGIN
;	0402	
;	0403	MAP
;	0404		DESFN	:	REF VECTOR [2],	!DESCRIPTOR FOR FILE NAME
;	0405		DESTY	:	REF VECTOR [2];	!DESCRIPTOR FOR FILE TYPE
;	0406	
;	0407	EXTERNAL ROUTINE
;	0408		CALC_VERSION;			!CALCULATE VERSION NUMBER
;	0409	
;	0410	PARSE_FILE_ID(.DESFN,.DESTY);		!GET DESCRIPTORS FOR FILE ID
;	0411	TRANS_FILE_ID(.BUFFER,.DESFN);		!TRANSLATE FILE NAME
;	0412	DESFN[1] = .BUFFER;
;	0413	BUFFER = .BUFFER + .DESFN[0];
;	0414	TRANS_FILE_ID(.BUFFER,.DESTY);		!TRANSLATE FILE TYPE
;	0415	DESTY[1] = .BUFFER;
;	0416	CALC_VERSION(.BINVER);
;	0417	
;	0418	END;					!END OF ROUTINE

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 2-1
; Digital Equipment Corporation
;


							    .TITLE  PRSTRN
							    .IDENT  \A0001\

							    .GLOBL  CALC_VERSION

							    .PSECT  $CODE$,NOWRT,2

					 000C 00000 	    .ENTRY  PARSE_TRANS_FID, Save R2,R3				      ; 0364
		         53	  0C   AC  D0 00002 	    MOVL    DESTY, R3						      ; 0410
				       53  DD 00006 	    PUSHL   R3							      ;
		         52	  08   AC  D0 00008 	    MOVL    DESFN, R2						      ;
				       52  DD 0000C 	    PUSHL   R2							      ;
		  0000V  CF	       02  FB 0000E 	    CALLS   #2, PARSE_FILE_ID					      ;
				       52  DD 00013 	    PUSHL   R2							      ; 0411
				  04   AC  DD 00015 	    PUSHL   BUFFER						      ;
		  0000V  CF	       02  FB 00018 	    CALLS   #2, TRANS_FILE_ID					      ;
		    04   A2	  04   AC  D0 0001D 	    MOVL    BUFFER, 4(R2)					      ; 0412
		    04   AC	       62  C0 00022 	    ADDL2   (R2), BUFFER					      ; 0413
				       53  DD 00026 	    PUSHL   R3							      ; 0414
				  04   AC  DD 00028 	    PUSHL   BUFFER						      ;
		  0000V  CF	       02  FB 0002B 	    CALLS   #2, TRANS_FILE_ID					      ;
		    04   A3	  04   AC  D0 00030 	    MOVL    BUFFER, 4(R3)					      ; 0415
				  10   AC  DD 00035 	    PUSHL   BINVER						      ; 0416
		  0000G  CF	       01  FB 00038 	    CALLS   #1, CALC_VERSION					      ;
					   04 0003D 	    RET     							      ; 0364

; Routine Size:  62 bytes


;	0419	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 3
; Digital Equipment Corporation
;
;	0420	ROUTINE TRANS_FILE_ID(OUTPTR,DESC1) : NOVALUE  =
;	0421	
;	0422	!++
;	0423	!
;	0424	! FUNCTIONAL DESCRIPTION:
;	0425	!	TRANSLATE CHAR FROM DESCRIPTOR TO OUTPUT BUFFER
;	0426	!	ALL NON-RAD50 CHAR ARE TRANSLATED TO Z'S, SMALL ALPHABETICS CAPITALIZED
;	0427	!
;	0428	! CALLING SEQUENCE:
;	0429	!	TRANS_FILE_ID(ARG1,ARG2)
;	0430	!
;	0431	! INPUT PARAMETERS:
;	0432	!	ARG1 - ADDRESS OF OUTPUT BUFFER
;	0433	!	ARG2 - ADDRESS OF DESCRIPTOR QUAD WORD OF INPUT
;	0434	!
;	0435	! IMPLICIT INPUTS:
;	0436	!	NONE
;	0437	!
;	0438	! OUTPUT PARAMETERS:
;	0439	!	ARG1
;	0440	!
;	0441	! IMPLICIT OUTPUTS:
;	0442	!	NONE
;	0443	!
;	0444	! ROUTINE VALUE:
;	0445	!	NONE
;	0446	!
;	0447	! SIDE EFFECTS:
;	0448	!	OUTPUT BUFFER RECEIVES TRANSLATED STRING
;	0449	!
;	0450	!--
;	0451	
;	0452	BEGIN
;	0453	
;	0454	
;	0455	LOCAL
;	0456		LENGTH,					!LENGTH OF STRING
;	0457		OPTER	:	REF VECTOR [,BYTE],	!PTER TO OUTPUT
;	0458		PTER	:	REF VECTOR [,BYTE],	!PTER TO INPUT
;	0459		CHAR;					!CHARACTER FROM INPUT
;	0460	
;	0461	MAP
;	0462		DESC1	:	REF VECTOR [2];		!DESCRIPTOR TO BE TRANSLATED
;	0463	
;	0464	! SETUP POINTERS
;	0465	OPTER = .OUTPTR;
;	0466	PTER = .DESC1[1];
;	0467	LENGTH = .DESC1[0] ;
;	0468	IF .LENGTH LEQU 0 THEN RETURN;
;	0469	
;	0470	INCRU COUNT FROM 0 TO .LENGTH - 1 DO
;	0471	    BEGIN
;	0472	    CHAR = .PTER[.COUNT];
;	0473	    OPTER[.COUNT] = TRANS(.CHAR);
;	0474	    END;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 3-1
; Digital Equipment Corporation
;
;	0475	
;	0476	END;					!END OF ROUTINE





					 0FFC 0003E TRANS_FILE_ID:
							    .WORD   Save R2,R3,R4,R5,R6,R7,R8,R9,R10,R11		      ; 0420
		         53	  04   AC  D0 00040 	    MOVL    OUTPTR, OPTER					      ; 0465
		         50	  08   AC  D0 00044 	    MOVL    DESC1, R0						      ; 0466
		         55	  04   A0  D0 00048 	    MOVL    4(R0), PTER						      ;
		         50	       60  D0 0004C 	    MOVL    (R0), LENGTH					      ; 0467
				       50  D5 0004F 	    TSTL    LENGTH						      ; 0468
				       18  1B 00051 	    BLEQU   3$							      ;
	   56	         50	       01  C3 00053 	    SUBL3   #1, LENGTH, R6					      ; 0470
				       54  D4 00057 	    CLRL    COUNT						      ;
				       0B  11 00059 	    BRB     2$							      ;
		         52	     6445  9A 0005B 1$:     MOVZBL  (COUNT)[PTER], CHAR					      ; 0472
				     0000  30 0005F 	    BSBW    TRANS						      ; 0473
		       8443	       50  90 00062 	    MOVB    R0, (COUNT)+[OPTER]					      ;
		         56	       54  D1 00066 2$:     CMPL    COUNT, R6						      ; 0470
				       F0  1B 00069 	    BLEQU   1$							      ;
					   04 0006B 3$:     RET     							      ; 0420

; Routine Size:  46 bytes



; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 4
; Digital Equipment Corporation
;
;	0477	ROUTINE TRANS(CHAR) : JSBR2  =
;	0478	
;	0479	!++
;	0480	!
;	0481	! FUNCTIONAL DESCRIPTION:
;	0482	!	TRANSLATE FID CHARACTER TO ACCEPTABLE FILES_11 CHARACTER
;	0483	!
;	0484	! CALLING SEQUENCE:
;	0485	!	TRANS(ARG1)
;	0486	!
;	0487	! INPUT PARAMETERS:
;	0488	!	ARG1 - CHAR TO TRANSLATE
;	0489	!
;	0490	! IMPLICIT INPUTS:
;	0491	!	NONE
;	0492	!
;	0493	! OUTPUT PARAMETERS:
;	0494	!	NONE
;	0495	!
;	0496	! IMPLICIT OUTPUTS:
;	0497	!	NONE
;	0498	!
;	0499	! ROUTINE VALUE:
;	0500	!	TRANSLATED CHAR
;	0501	!	NON-RAD50 BECOME Z, SMALL ALPAHBETICS ARE CAPITALIZED
;	0502	!
;	0503	! SIDE EFFECTS:
;	0504	!	NONE
;	0505	!
;	0506	!--
;	0507	
;	0508	BEGIN
;	0509	
;	0510	CASE TYPE(.CHAR) FROM 0 TO 6 OF
;	0511	    SET
;	0512	    [0,4,5,6]:	RETURN 'Z';			!NON-RAD50, ASTERICS, PERIODS, SEMICOLONS
;	0513	    [1,3]:	RETURN .CHAR;			!CAPITAL LETTERS, NUMERICS
;	0514	    [2]:	RETURN .CHAR - 32;		!TRANSLATE TO CAPITALS
;	0515	    TES
;	0516	
;	0517	END;						!END OF ROUTINE





				       04  BB 0006C TRANS:  PUSHR   #^M<R2>						      ; 0477
				     0000  30 0006E 	    BSBW    TYPE						      ; 0510
	   06	         00	       50  CF 00071 	    CASEL   R0, #0, #6						      ; 0508
	 0014	       0017	     000E     00075 1$:     .WORD   2$-1$,-						      ;
	 000E	       000E	     0017     0007B		    4$-1$,-						      ;
				     000E     00081		    3$-1$,-						      ;
								    4$-1$,-						      ;
								    2$-1$,-						      ;
								    2$-1$,-						      ;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 4-1
; Digital Equipment Corporation
;
								    2$-1$						      ;
		         50	  5A   8F  9A 00083 2$:     MOVZBL  #90, R0						      ; 0512
				       06  11 00087 	    BRB     5$							      ;
		         52	       20  C2 00089 3$:     SUBL2   #32, R2						      ; 0514
		         50	       52  D0 0008C 4$:     MOVL    R2, R0						      ;
				       04  BA 0008F 5$:     POPR    #^M<R2>						      ; 0477
					   05 00091 	    RSB     							      ;

; Routine Size:  38 bytes


;	0518	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 5
; Digital Equipment Corporation
;
;	0519	GLOBAL ROUTINE PARSE_FILE_ID(DESC1,DESC2) : NOVALUE =
;	0520	
;	0521	!++
;	0522	!
;	0523	! FUNCTIONAL DESCRIPTION:
;	0524	!	THIS ROUTINE PARSES THE FILE IDENTIFIER FIELD IN HDR1
;	0525	!	TRAILING BLANKS ARE STRIPPED
;	0526	!
;	0527	! CALLING SEQUENCE:
;	0528	!	PARSE_FILE_ID(ARG1,ARG2)
;	0529	!
;	0530	! INPUT PARAMETERS:
;	0531	!	ARG1 - ADDRESS OF FILE NAME OUTPUT DESCRIPTOR
;	0532	!	ARG2 - ADDRESS OF FILE TYPE OUTPUT DESCRIPTOR
;	0533	!
;	0534	! IMPLICIT INPUTS:
;	0535	!
;	0536	! OUTPUT PARAMETERS:
;	0537	!	ARG1,ARG2
;	0538	!
;	0539	! IMPLICIT OUTPUTS:
;	0540	!	NONE
;	0541	!
;	0542	! ROUTINE VALUE:
;	0543	!	NONE
;	0544	!
;	0545	! SIDE EFFECTS:
;	0546	!	THE DESCRIPTORS ARE FILLED IN
;	0547	!
;	0548	!--
;	0549	
;	0550	BEGIN
;	0551	
;	0552	EXTERNAL
;	0553		HDR1:		REF BBLOCK;			!ADDRESS OF HDR1(EOF1) LABEL
;	0554	
;	0555	MAP
;	0556		DESC1:		REF VECTOR [2],			!RECEIVES FILE NAME DESCRIPTOR
;	0557		DESC2:		REF VECTOR [2];			!RECEIVES FILE TYPE DESCRIPTOR
;	0558	
;	0559	
;	0560	LOCAL
;	0561		FILEID:		REF VECTOR [HD1$S_FILEID,BYTE],	!ADDRESS OF FILE IDENTIFICATION FIELD
;	0562		COUNT;						!CHARACTER COUNT
;	0563	
;	0564	! SCANE FILE IDENTIFIER TO SETUP DESCRIPTORS
;	0565	FILEID = HDR1[HD1$T_FILEID];			!SETUP ADDRESS
;	0566	
;	0567	! SCANE UP TO 9 CHARACTERS OR UNTIL A PERIOD IS FOUND
;	0568	COUNT = 0;
;	0569	INCRU I FROM 0 TO 8 DO
;	0570	    BEGIN
;	0571	    IF .FILEID[.I] EQL %C'.'
;	0572	    THEN EXITLOOP;
;	0573	    COUNT = .COUNT + 1;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 5-1
; Digital Equipment Corporation
;
;	0574	    END;
;	0575	
;	0576	! HAVE FILE NAME DELIMITED
;	0577	DESC1[1] = .FILEID;
;	0578	DESC2[1] = FILEID[.COUNT];
;	0579	
;	0580	! STRIP OFF TRAILING BLANKS
;	0581	IF .COUNT NEQU 0 THEN
;	0582	    BEGIN
;	0583	    DECR I FROM .COUNT - 1 TO 0 DO
;	0584	        BEGIN
;	0585	        IF  .FILEID[.I] NEQ ' '
;	0586	        THEN EXITLOOP;
;	0587	        COUNT = .COUNT - 1;
;	0588	        END;						!END DECR LOOP
;	0589	    END;
;	0590	
;	0591	DESC1[0] = .COUNT ;
;	0592	
;	0593	! NOW DELIMIT FILE TYPE.  DO NOT INCLUDE TRAILING BLANKS
;	0594	FILEID = .DESC2[1];					!PICKUP START OF TYPE
;	0595	IF .FILEID[0] EQLU '.'
;	0596	THEN
;	0597	    BEGIN
;	0598	    FILEID = .FILEID + 1;
;	0599	    DESC2[1] = .FILEID;
;	0600	    END;
;	0601	COUNT = 3;
;	0602	DECR I FROM 2 TO 0 DO
;	0603	    BEGIN
;	0604	    IF .FILEID[.I] NEQ ' ' THEN EXITLOOP;
;	0605	    COUNT = .COUNT - 1;
;	0606	    END;
;	0607	DESC2[0] = .COUNT;
;	0608	END;							!END OF ROUTINE



							    .GLOBL  HDR1

					 001C 00092 	    .ENTRY  PARSE_FILE_ID, Save R2,R3,R4			      ; 0519
	   50	  0000G  CF	       04  C1 00094 	    ADDL3   #4, HDR1, FILEID					      ; 0565
				       54  D4 0009A 	    CLRL    COUNT						      ; 0568
				       51  D4 0009C 	    CLRL    I							      ; 0569
		         2E	     6140  91 0009E 1$:     CMPB    (I)[FILEID], #46					      ; 0571
				       09  13 000A2 	    BEQL    2$							      ;
				       54  D6 000A4 	    INCL    COUNT						      ; 0573
				       51  D6 000A6 	    INCL    I							      ; 0569
		         08	       51  D1 000A8 	    CMPL    I, #8						      ;
				       F1  1B 000AB 	    BLEQU   1$							      ;
		         53	  04   AC  D0 000AD 2$:     MOVL    DESC1, R3						      ; 0577
		    04   A3	       50  D0 000B1 	    MOVL    FILEID, 4(R3)					      ;
		         51	  08   AC  D0 000B5 	    MOVL    DESC2, R1						      ; 0578
      04   A1	         50	       54  C1 000B9 	    ADDL3   COUNT, FILEID, 4(R1)				      ;
				       54  D5 000BE 	    TSTL    COUNT						      ; 0581

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 5-2
; Digital Equipment Corporation
;
				       10  13 000C0 	    BEQL    5$							      ;
		         52	       54  D0 000C2 	    MOVL    COUNT, I						      ; 0583
				       08  11 000C5 	    BRB     4$							      ;
		         20	     6240  91 000C7 3$:     CMPB    (I)[FILEID], #32					      ; 0585
				       05  12 000CB 	    BNEQ    5$							      ;
				       54  D7 000CD 	    DECL    COUNT						      ; 0587
		         F5	       52  F4 000CF 4$:     SOBGEQ  I, 3$						      ; 0583
		         63	       54  D0 000D2 5$:     MOVL    COUNT, (R3)						      ; 0591
		         50	  04   A1  D0 000D5 	    MOVL    4(R1), FILEID					      ; 0594
		         2E	       60  91 000D9 	    CMPB    (FILEID), #46					      ; 0595
				       06  12 000DC 	    BNEQ    6$							      ;
				       50  D6 000DE 	    INCL    FILEID						      ; 0598
		    04   A1	       50  D0 000E0 	    MOVL    FILEID, 4(R1)					      ; 0599
		         54	       03  D0 000E4 6$:     MOVL    #3, COUNT						      ; 0601
		         53	       02  D0 000E7 	    MOVL    #2, I						      ; 0602
		         20	     6340  91 000EA 7$:     CMPB    (I)[FILEID], #32					      ; 0604
				       05  12 000EE 	    BNEQ    8$							      ;
				       54  D7 000F0 	    DECL    COUNT						      ; 0605
		         F5	       53  F4 000F2 	    SOBGEQ  I, 7$						      ; 0602
		         61	       54  D0 000F5 8$:     MOVL    COUNT, (R1)						      ; 0607
					   04 000F8 	    RET     							      ; 0519

; Routine Size:  103 bytes



; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 6
; Digital Equipment Corporation
;
;	0609	GLOBAL ROUTINE PARSE_TRANS_FNM(OUTP,DESFN,DESTY,BINVER,LENGTH,INPUT) : NOVALUE  =
;	0610	
;	0611	!++
;	0612	!
;	0613	! FUNCTIONAL DESCRIPTION:
;	0614	!	PARSE AND TRANSLATE CHARACTERS IN A FILE NAME STRING
;	0615	!	SMALL ALPHABETICS ARE CAPITALIZED
;	0616	!
;	0617	! CALLING SEQUENCE:
;	0618	!	PARSE_TRANS_FNM(ARG1,ARG2,ARG3,ARG4,ARG5,ARG6)
;	0619	!
;	0620	! INPUT PARAMETERS:
;	0621	!	ARG1 - ADDRESS OF OUTPUT BUFFER
;	0622	!	ARG2 - ADDRESS OF DESCRIPTOR FOR FILE NAME
;	0623	!	ARG3 - ADDRESS OF DESCRIPTOR FOR FILE TYPE
;	0624	!	ARG4 - ADDRESS FOR BINARY VERSION NUMBER
;	0625	!	ARG5 - ADDRESS OF INPUT
;	0626	!	ARG6 - LENGTH OF INPUT
;	0627	!
;	0628	! IMPLICIT INPUTS:
;	0629	!	NONE
;	0630	!
;	0631	! OUTPUT PARAMETERS:
;	0632	!	ARG1,ARG2,ARG3,ARG4
;	0633	!
;	0634	! IMPLICIT OUTPUTS:
;	0635	!	NONE
;	0636	!
;	0637	! ROUTINE VALUE:
;	0638	!	NONE
;	0639	!
;	0640	! SIDE EFFECTS:
;	0641	!	NONE
;	0642	!
;	0643	!--
;	0644	
;	0645	BEGIN
;	0646	
;	0647	EXTERNAL ROUTINE
;	0648		LIB$CVT_DTB	:	ADDRESSING_MODE(ABSOLUTE);
;	0649	MAP
;	0650		DESFN		:	REF VECTOR [2],	!DESCRIPTOR FOR FILE NAME
;	0651		DESTY		:	REF VECTOR [2];	!DESCRIPTOR FOR FILE TYPE
;	0652	
;	0653	LOCAL
;	0654		CHAR,
;	0655		COUNT;
;	0656	
;	0657	GLOBAL REGISTER
;	0658		INPPTR	=	3	: REF VECTOR [,BYTE],	!INPUT POINTER
;	0659		OUTPTR	=	4	: REF VECTOR [,BYTE],	!OUTPUT POINTER
;	0660		INPLEN	=	5,				!LENGTH OF INPUT STRING
;	0661		MAX	=	6;				!MAXIMUM NUMBER OF CHARACTERS
;	0662	
;	0663	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 6-1
; Digital Equipment Corporation
;
;	0664	OUTPTR = .OUTP;				!SETUP PTER TO OUTPUT
;	0665	INPPTR = .INPUT;			!SETUP PTER TO INPUT
;	0666	INPLEN = .LENGTH;			!LENGTH OF INPUT
;	0667	
;	0668	! THERE MUST BE ONE CHARACTER
;	0669	IF .INPLEN EQL 0 THEN ERR_EXIT(SS$_BADFILENAME);
;	0670	
;	0671	! INITIALIZE VERSION NUMBER TO ZERO
;	0672	(.BINVER)<0,16> = 0;
;	0673	
;	0674	! GET FILE NAME
;	0675	MAX = 9;
;	0676	CHAR = GETGP(.DESFN);
;	0677	
;	0678	! PUT PERIOD IN 
;	0679	CH$WCHAR_A('.',OUTPTR);	!GOES TO FILE ID IN HDR1
;	0680	
;	0681	
;	0682	CHKTERM(.CHAR);
;	0683	IF .INPLEN LEQU 0 THEN RETURN;
;	0684	IF .CHAR EQLU '.' THEN
;	0685	    BEGIN
;	0686	    MAX = 3;
;	0687	    CHAR = GETGP(.DESTY);
;	0688	    END;
;	0689	CHKTERM(.CHAR);
;	0690	
;	0691	! NOW CONVERT VERSION NUMBER
;	0692	IF .INPPTR[0] NEQ '*' AND .INPLEN GTRU 0
;	0693	THEN
;	0694	    BEGIN
;	0695	    IF NOT LIB$CVT_DTB(.INPLEN,.INPPTR,COUNT)
;	0696	    THEN ERR_EXIT(SS$_BADFILEVER);
;	0697	    IF .COUNT GTRU 32767 THEN ERR_EXIT(SS$_BADFILEVER);
;	0698	    (.BINVER)<0,16> = (.COUNT)<0,16>;
;	0699	    END;
;	0700	
;	0701	END;					!END OF ROUTINE



							    .GLOBL  LIB$CVT_DTB

					 0FFC 000F9 	    .ENTRY  PARSE_TRANS_FNM, Save R2,R3,R4,R5,R6,R7,R8,R9,R10,R11     ; 0609
		         5E	       04  C2 000FB 	    SUBL2   #4, SP						      ;
		         54	  04   AC  D0 000FE 	    MOVL    OUTP, OUTPTR					      ; 0664
		         53	  18   AC  D0 00102 	    MOVL    INPUT, INPPTR					      ; 0665
		         55	  14   AC  D0 00106 	    MOVL    LENGTH, INPLEN					      ; 0666
				       04  12 0010A 	    BNEQ    1$							      ; 0669
				0818   8F  BF 0010C 	    CHMU    #2072						      ;
				  10   BC  B4 00110 1$:     CLRW    @BINVER						      ; 0672
		         56	       09  D0 00113 	    MOVL    #9, MAX						      ; 0675
				  08   AC  DD 00116 	    PUSHL   DESFN						      ; 0676
				     0000  30 00119 	    BSBW    GETGP						      ;
		         5E	       04  C0 0011C 	    ADDL2   #4, SP						      ;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 6-2
; Digital Equipment Corporation
;
		         52	       50  D0 0011F 	    MOVL    R0, CHAR						      ;
		         84	       2E  90 00122 	    MOVB    #46, (OUTPTR)+					      ; 0679
		         50	       52  D0 00125 	    MOVL    CHAR, R0						      ; 0682
				     0000  30 00128 	    BSBW    CHKTERM						      ;
				       55  D5 0012B 	    TSTL    INPLEN						      ; 0683
				       48  1B 0012D 	    BLEQU   5$							      ;
		         2E	       52  D1 0012F 	    CMPL    CHAR, #46						      ; 0684
				       0F  12 00132 	    BNEQ    2$							      ;
		         56	       03  D0 00134 	    MOVL    #3, MAX						      ; 0686
				  0C   AC  DD 00137 	    PUSHL   DESTY						      ; 0687
				     0000  30 0013A 	    BSBW    GETGP						      ;
		         5E	       04  C0 0013D 	    ADDL2   #4, SP						      ;
		         52	       50  D0 00140 	    MOVL    R0, CHAR						      ;
		         50	       52  D0 00143 2$:     MOVL    CHAR, R0						      ; 0689
				     0000  30 00146 	    BSBW    CHKTERM						      ;
		         2A	       63  91 00149 	    CMPB    (INPPTR), #42					      ; 0692
				       29  13 0014C 	    BEQL    5$							      ;
				       55  D5 0014E 	    TSTL    INPLEN						      ;
				       25  1B 00150 	    BLEQU   5$							      ;
				4008   8F  BB 00152 	    PUSHR   #^M<R3,SP>						      ; 0695
				       55  DD 00156 	    PUSHL   INPLEN						      ;
	      00000000G  9F	       03  FB 00158 	    CALLS   #3, @#LIB$CVT_DTB					      ;
		         04	       50  E8 0015F 	    BLBS    R0, 3$						      ;
				0820   8F  BF 00162 	    CHMU    #2080						      ; 0696
	      00007FFF   8F	       6E  D1 00166 3$:     CMPL    COUNT, #32767					      ; 0697
				       04  1B 0016D 	    BLEQU   4$							      ;
				0820   8F  BF 0016F 	    CHMU    #2080						      ;
		    10   BC	       6E  B0 00173 4$:     MOVW    COUNT, @BINVER					      ; 0698
					   04 00177 5$:     RET     							      ; 0609

; Routine Size:  127 bytes


;	0702	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 7
; Digital Equipment Corporation
;
;	0703	ROUTINE GETGP(DESCRIP) : CALL4  =
;	0704	
;	0705	!++
;	0706	!
;	0707	! FUNCTIONAL DESCRIPTION:
;	0708	!	THIS ROUTINE GETS A GROUP OF CHARACTERS TERMINATED BY EITHER A PERIOD OR SEMI-COLON
;	0709	!
;	0710	! CALLING SEQUENCE:
;	0711	!	GETGP(DESCRIP)
;	0712	!
;	0713	! INPUT PARAMETERS:
;	0714	!	ARG1 - ADDRESS OF DESCRIPTOR FOR GROUP
;	0715	!
;	0716	! IMPLICIT INPUTS:
;	0717	!	MAX - MAX NUMBER OF CHARACTERS IN GROUP
;	0718	!	OUTPTR - ADDRESS OF OUTPUT CHARACTERS
;	0719	!	INPPTR - ADDRESS OF INPUT CHARACTERS
;	0720	!	INPLEN - LEN OF REMAINING INPUT CHARACTERS
;	0721	!
;	0722	! OUTPUT PARAMETERS:
;	0723	!	NONE
;	0724	!
;	0725	! IMPLICIT OUTPUTS:
;	0726	!	TRANSLATED CHARACTERS IN GROUP MOVED FROM INPUT TO OUTPUT
;	0727	!	DESCRIPTOR SETUP TO DESCRIBE OUTPUT
;	0728	!	OUTPTR, INPPTR, INPLEN UPDATED
;	0729	!
;	0730	! ROUTINE VALUE:
;	0731	!	TERMINATOR
;	0732	!
;	0733	! SIDE EFFECTS:
;	0734	!	NONE
;	0735	!
;	0736	!--
;	0737	
;	0738	BEGIN
;	0739	EXTERNAL REGISTER
;	0740		INPPTR	=	3	: REF VECTOR [,BYTE],	!INPUT POINTER
;	0741		OUTPTR	=	4	: REF VECTOR [,BYTE],	!OUTPUT POINTER
;	0742		INPLEN	=	5,				!LENGTH OF INPUT STRING
;	0743		MAX	=	6;				!MAXIMUM NUMBER OF CHARACTERS
;	0744	
;	0745	MAP
;	0746		DESCRIP:		REF VECTOR [2];		!DESCRIPTOR TO RECEIVE OUTPUT DESCRIPTION
;	0747	
;	0748	LOCAL
;	0749		COUNT,						!NUMBER OF CHARACTERS IN GROUP
;	0750		CHAR;						!ONE CHAR
;	0751	
;	0752	IF .MAX GTRU .INPLEN THEN MAX = .INPLEN;
;	0753	COUNT = MTC();
;	0754	
;	0755	! CAN NOW FORMAT NAME DESCRIPTOR
;	0756	DESCRIP[0] = .COUNT;
;	0757	DESCRIP[1] = .OUTPTR;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 7-1
; Digital Equipment Corporation
;
;	0758	
;	0759	! BUMP PTRS AND ADJUST INPUT LENGTH REMAINING
;	0760	INPLEN = .INPLEN - .COUNT - 1;			!ONE FOR TERMINATOR
;	0761	INPPTR = .INPPTR + .COUNT;
;	0762	OUTPTR = .OUTPTR + .COUNT;
;	0763	RETURN CH$RCHAR_A(INPPTR);			!GET TERMINATOR
;	0764	END;						!END OF ROUTINE





		         55	       56  D1 00178 GETGP:  CMPL    MAX, INPLEN						      ; 0752
				       03  1B 0017B 	    BLEQU   1$							      ;
		         56	       55  D0 0017D 	    MOVL    INPLEN, MAX						      ;
				     0000  30 00180 1$:     BSBW    MTC							      ; 0753
		         51	       50  D0 00183 	    MOVL    R0, COUNT						      ;
		         50	  04   AE  D0 00186 	    MOVL    DESCRIP, R0						      ; 0756
		         60	       51  D0 0018A 	    MOVL    COUNT, (R0)						      ;
		    04   A0	       54  D0 0018D 	    MOVL    OUTPTR, 4(R0)					      ; 0757
	   50	         55	       51  C3 00191 	    SUBL3   COUNT, INPLEN, R0					      ; 0760
	   55	         50	       01  C3 00195 	    SUBL3   #1, R0, INPLEN					      ;
		         53	       51  C0 00199 	    ADDL2   COUNT, INPPTR					      ; 0761
		         54	       51  C0 0019C 	    ADDL2   COUNT, OUTPTR					      ; 0762
		         50	       83  9A 0019F 	    MOVZBL  (INPPTR)+, R0					      ; 0763
					   05 001A2 	    RSB     							      ; 0703

; Routine Size:  43 bytes


;	0765	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 8
; Digital Equipment Corporation
;
;	0766	ROUTINE MTC : CALL4  =
;	0767	
;	0768	!++
;	0769	!
;	0770	! FUNCTIONAL DESCRIPTION:
;	0771	!	THIS ROUTINE MOVES TRANSLATED CHARACTERS UNTIL A DELIMITER IS FOUND
;	0772	!
;	0773	! CALLING SEQUENCE:
;	0774	!	MTC()
;	0775	!
;	0776	! INPUT PARAMETERS:
;	0777	!	NONE
;	0778	!
;	0779	! IMPLICIT INPUTS:
;	0780	!	INPPTR - ADDRESS OF INPUT
;	0781	!	OUTPTR - ADDRESS OF OUTPUT
;	0782	!	MAX - MAXIMUM NUMBER OF CHARACTERS IN STRING
;	0783	!
;	0784	! OUTPUT PARAMETERS:
;	0785	!	NONE
;	0786	!
;	0787	! IMPLICIT OUTPUTS:
;	0788	!	NONE
;	0789	!
;	0790	! ROUTINE VALUE:
;	0791	!	THE NUMBER OF CHARACTERS PRECEDING THE DELIMITER
;	0792	!
;	0793	! SIDE EFFECTS:
;	0794	!	NONE
;	0795	!
;	0796	!--
;	0797	
;	0798	BEGIN
;	0799	EXTERNAL REGISTER
;	0800		INPPTR	=	3	: REF VECTOR [,BYTE],	!INPUT POINTER
;	0801		OUTPTR	=	4	: REF VECTOR [,BYTE],	!OUTPUT POINTER
;	0802		INPLEN	=	5,				!LENGTH OF INPUT STRING
;	0803		MAX	=	6;				!MAXIMUM NUMBER OF CHARACTERS
;	0804	
;	0805	LOCAL
;	0806		CHAR;
;	0807	
;	0808	INCRU I FROM 0 TO .MAX - 1 DO
;	0809	    BEGIN
;	0810	    CHAR = .INPPTR[.I];
;	0811	    CASE TYPE(.CHAR) FROM 0 TO 6 OF
;	0812		SET
;	0813		[0]:	ERR_EXIT(SS$_BADFILENAME);		!NON_RAD50
;	0814		[1,3]:	OUTPTR[.I] = .CHAR;			!CAPS OR NUMERICS
;	0815		[2]:	OUTPTR[.I] = .CHAR - 32;		!SMALL ALPHA'S
;	0816		[5,6]:	RETURN .I;				!DELIMITER
;	0817		[4]:	BEGIN
;	0818			IF .I NEQ 0 THEN ERR_EXIT(SS$_BADFILENAME);!STAR MUST BE ONLY CHARACTER IN STRING
;	0819			OUTPTR[.I] = .CHAR;
;	0820			RETURN .I + 1;

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 8-1
; Digital Equipment Corporation
;
;	0821			END;
;	0822		TES
;	0823		
;	0824	    END;
;	0825	
;	0826	RETURN .MAX					!IF NO DELIMITER FOUND IN CHAR SET
;	0827	END;						!END OF ROUTINE





				0184   8F  BB 001A3 MTC:    PUSHR   #^M<R2,R7,R8>					      ; 0766
	   58	         56	       01  C3 001A7 	    SUBL3   #1, MAX, R8						      ; 0808
				       57  D4 001AB 	    CLRL    I							      ;
				       45  11 001AD 	    BRB     10$							      ;
		         52	     6743  9A 001AF 1$:     MOVZBL  (I)[INPPTR], CHAR					      ; 0810
				     0000  30 001B3 	    BSBW    TYPE						      ; 0811
	   06	         00	       50  CF 001B6 	    CASEL   R0, #0, #6						      ;
	 001A	       0014	     000E     001BA 2$:     .WORD   3$-2$,-						      ;
	 0021	       0026	     0014     001C0		    4$-2$,-						      ;
				     0021     001C6		    5$-2$,-						      ;
								    4$-2$,-						      ;
								    7$-2$,-						      ;
								    6$-2$,-						      ;
								    6$-2$						      ;
				0818   8F  BF 001C8 3$:     CHMU    #2072						      ; 0813
				       24  11 001CC 	    BRB     9$							      ; 0811
		       6744	       52  90 001CE 4$:     MOVB    CHAR, (I)[OUTPTR]					      ; 0814
				       1E  11 001D2 	    BRB     9$							      ; 0811
	 6744	         52	       20  83 001D4 5$:     SUBB3   #32, CHAR, (I)[OUTPTR]				      ; 0815
				       17  11 001D9 	    BRB     9$							      ; 0811
		         50	       57  D0 001DB 6$:     MOVL    I, R0						      ; 0816
				       1C  11 001DE 	    BRB     11$							      ;
				       57  D5 001E0 7$:     TSTL    I							      ; 0818
				       04  13 001E2 	    BEQL    8$							      ;
				0818   8F  BF 001E4 	    CHMU    #2072						      ;
		       6744	       52  90 001E8 8$:     MOVB    CHAR, (I)[OUTPTR]					      ; 0819
	   50	         57	       01  C1 001EC 	    ADDL3   #1, I, R0						      ; 0820
				       0A  11 001F0 	    BRB     11$							      ;
				       57  D6 001F2 9$:     INCL    I							      ; 0808
		         58	       57  D1 001F4 10$:    CMPL    I, R8						      ;
				       B6  1B 001F7 	    BLEQU   1$							      ;
		         50	       56  D0 001F9 	    MOVL    MAX, R0						      ; 0826
				0184   8F  BA 001FC 11$:    POPR    #^M<R2,R7,R8>					      ; 0766
					   05 00200 	    RSB     							      ;

; Routine Size:  94 bytes


;	0828	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 9
; Digital Equipment Corporation
;
;	0829	ROUTINE TYPE(CHAR) : JSBR2  =
;	0830	
;	0831	!++
;	0832	!
;	0833	! FUNCTIONAL DESCRIPTION:
;	0834	!	THIS ROUTINE DETERMINES THE CLASS OF CHAR WITH DELIMITERS INCLUDED
;	0835	!
;	0836	! CALLING SEQUENCE:
;	0837	!	TYPE(ARG1)
;	0838	!
;	0839	! INPUT PARAMETERS:
;	0840	!	ARG1 - CHAR TO CLASSIFY
;	0841	!
;	0842	! IMPLICIT INPUTS:
;	0843	!	NONE
;	0844	!
;	0845	! OUTPUT PARAMETERS:
;	0846	!	NONE
;	0847	!
;	0848	! IMPLICIT OUTPUTS:
;	0849	!	NONE
;	0850	!
;	0851	! ROUTINE VALUE:
;	0852	!	THE CLASSIFICATION OF THE CHARACTER
;	0853	!	0 - NON-RAD50 CHARACTER
;	0854	!	1 - CAPITAL ALPHABETIC
;	0855	!	2 - SMALL ALPHABETIC
;	0856	!	3 - NUMERIC
;	0857	!	4 - ASTERICS
;	0858	!	5 - PERIOD
;	0859	!	6 - SEMICOLON
;	0860	!
;	0861	! SIDE EFFECTS:
;	0862	!	NONE
;	0863	!
;	0864	!--
;	0865	
;	0866	BEGIN
;	0867	
;	0868	
;	0869	BIND
;	0870		LOWCHAR = UPLIT BYTE(0,'Aa0*.;')	:VECTOR [,BYTE],
;	0871		HIGHCHAR= UPLIT BYTE(0,'Zz9*.;')	:VECTOR [,BYTE];
;	0872	
;	0873	INCRU I FROM 1 TO 6 DO
;	0874	    BEGIN
;	0875	    IF .CHAR GEQU .LOWCHAR[.I]
;	0876	    AND .CHAR LEQU .HIGHCHAR[.I]
;	0877	    THEN RETURN .I;
;	0878	    END;
;	0879	RETURN 0;
;	0880	END;




; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 9-1
; Digital Equipment Corporation
;
					      00201	    .BLKB   3
					      00204 P.AAA:  .BYTE   0							      ;
					      00205 	    .ASCII  \Aa0*.;\						      ;
					      0020B	    .BLKB   1
					      0020C P.AAB:  .BYTE   0							      ;
					      0020D 	    .ASCII  \Zz9*.;\						      ;
					      00213	    .BLKB   1

						    LOWCHAR=		P.AAA
						    HIGHCHAR=		P.AAB


				       04  BB 00214 TYPE:   PUSHR   #^M<R2>						      ; 0829
		         50	       01  D0 00216 	    MOVL    #1, I						      ; 0873
      E5 AF40	         08	       00  ED 00219 1$:     CMPZV   #0, #8, LOWCHAR[I], CHAR				      ; 0875
				       52     0021F									      ;
				       09  1A 00220 	    BGTRU   2$							      ;
      E4 AF40	         08	       00  ED 00222 	    CMPZV   #0, #8, HIGHCHAR[I], CHAR				      ; 0876
				       52     00228									      ;
				       09  1E 00229 	    BGEQU   3$							      ;
				       50  D6 0022B 2$:     INCL    I							      ; 0873
		         06	       50  D1 0022D 	    CMPL    I, #6						      ;
				       E7  1B 00230 	    BLEQU   1$							      ;
				       50  D4 00232 	    CLRL    R0							      ; 0879
				       04  BA 00234 3$:     POPR    #^M<R2>						      ; 0829
					   05 00236 	    RSB     							      ;

; Routine Size:  35 bytes



; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 10
; Digital Equipment Corporation
;
;	0881	ROUTINE CHKTERM(CHAR) : CALL2 NOVALUE  =
;	0882	
;	0883	!++
;	0884	!
;	0885	! FUNCTIONAL DESCRIPTION:
;	0886	!
;	0887	!
;	0888	! CALLING SEQUENCE:
;	0889	!	CHKTERM()
;	0890	!
;	0891	! INPUT PARAMETERS:
;	0892	!	R0 - CHARACTER TO CHECK
;	0893	!	R5 - LENGTH REMAINING IN INPUT STRING
;	0894	!
;	0895	! IMPLICIT INPUTS:
;	0896	!	NONE
;	0897	!
;	0898	! OUTPUT PARAMETERS:
;	0899	!	NONE
;	0900	!
;	0901	! IMPLICIT OUTPUTS:
;	0902	!	NONE
;	0903	!
;	0904	! ROUTINE VALUE:
;	0905	!	NONE
;	0906	!
;	0907	! SIDE EFFECTS:
;	0908	!	IF THE CHARACTER IS NOT A PERIOD OR SEMI-COLON THEN THE ERROR EXIT
;	0909	!	IS TAKEN WITH USER_STATUS = SS$_BADFILENAME
;	0910	!
;	0911	!--
;	0912	
;	0913	BEGIN
;	0914	
;	0915	EXTERNAL REGISTER
;	0916		INPLEN	= 5;				!LENGTH REMAINING IN INPUT STRING
;	0917	
;	0918	IF .INPLEN GEQU 0 THEN
;	0919	    IF .CHAR NEQU '.' AND .CHAR NEQU ';'
;	0920	    THEN ERR_EXIT(SS$_BADFILENAME);
;	0921	END;						!END OF ROUTINE





		         2E	       50  D1 00237 CHKTERM:CMPL    CHAR, #46						      ; 0919
				       09  13 0023A 	    BEQL    1$							      ;
		         3B	       50  D1 0023C 	    CMPL    CHAR, #59						      ;
				       04  13 0023F 	    BEQL    1$							      ;
				0818   8F  BF 00241 	    CHMU    #2072						      ; 0920
					   05 00245 1$:     RSB     							      ; 0881

; Routine Size:  15 bytes


; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 10-1
; Digital Equipment Corporation
;

;	0922	

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 11
; Digital Equipment Corporation
;
;	0923	GLOBAL ROUTINE PARSE_TRANS_FNS(OUTPUT,NAME_DESCR,TYPE_DESCR,VERSION) : NOVALUE  =
;	0924	
;	0925	!++
;	0926	!
;	0927	! FUNCTIONAL DESCRIPTION:
;	0928	!	THIS ROUTINE PARSES AND TRANSLATES CHARACTERS OF THE INPUT FILE NAME STRING
;	0929	!
;	0930	! CALLING SEQUENCE:
;	0931	!	PARSE_TRANS_FNS(ARG1,ARG2,ARG3,ARG4)
;	0932	!
;	0933	! INPUT PARAMETERS:
;	0934	!	ARG1 - ADDRESS OF BUFFER FOR TRANSLATED OUTPUT STRING
;	0935	!	ARG2 - ADDRESS OF DESCRIPTOR FOR FILE NAME
;	0936	!	ARG3 - ADDRESS OF DESCRIPTOR FOR FILE TYPE
;	0937	!	ARG4 - ADDRESS OF 2 BYTES FOR BINARY VERSION NUMBER
;	0938	!
;	0939	! IMPLICIT INPUTS:
;	0940	!	NONE
;	0941	!
;	0942	! OUTPUT PARAMETERS:
;	0943	!	ARG1 - ADDRESS OF BUFFER FOR TRANSLATED OUTPUT STRING
;	0944	!	ARG2 - ADDRESS OF DESCRIPTOR FOR FILE NAME
;	0945	!	ARG3 - ADDRESS OF DESCRIPTOR FOR FILE TYPE
;	0946	!	ARG4 - ADDRESS OF 2 BYTES FOR BINARY VERSION NUMBER
;	0947	!
;	0948	! IMPLICIT OUTPUTS:
;	0949	!	NONE
;	0950	!
;	0951	! ROUTINE VALUE:
;	0952	!	NONE
;	0953	!
;	0954	! SIDE EFFECTS:
;	0955	!	ARG1-ARG4 RECEIVE THE APPROPRIATE DATA
;	0956	!
;	0957	!--
;	0958	
;	0959	BEGIN
;	0960	
;	0961	LOCAL
;	0962		ABD		: REF BBLOCKVECTOR[,ABD$C_LENGTH],
;	0963		INPUT_ADDR,			!ADDRESS OF INPUT FILE NAME STRING
;	0964		INPUT_LENGTH;			!LENGTH OF INPUT FILE NAME STRING
;	0965	
;	0966	EXTERNAL
;	0967		IO_PACKET	: REF BBLOCK;
;	0968	
;	0969	ABD = .BBLOCK[.IO_PACKET[IRP$L_SVAPTE],AIB$L_DESCRIPT];
;	0970	INPUT_LENGTH = .ABD[ABD$C_NAME,ABD$W_COUNT];
;	0971	INPUT_ADDR = .ABD[ABD$C_NAME,ABD$W_TEXT] + ABD[ABD$C_NAME,ABD$W_TEXT] + 1;
;	0972	PARSE_TRANS_FNM(.OUTPUT,.NAME_DESCR,.TYPE_DESCR,.VERSION,.INPUT_LENGTH,.INPUT_ADDR);
;	0973	END;				!END OF ROUTINE



							    .GLOBL  IO_PACKET

; Bliss-32 7.352	Saturday 21-AUG-1978 23:42:44	DBB3:[MTAACP.SRC]PRSTRN.B32;4					Page 11-1
; Digital Equipment Corporation
;

					 0004 00246 	    .ENTRY  PARSE_TRANS_FNS, Save R2				      ; 0923
		         50	0000G  CF  D0 00248 	    MOVL    IO_PACKET, R0					      ; 0969
		         50	  2C   B0  D0 0024D 	    MOVL    @44(R0), ABD					      ;
		         51	  12   A0  3C 00251 	    MOVZWL  18(ABD), INPUT_LENGTH				      ; 0970
		         50	       10  C0 00255 	    ADDL2   #16, R0						      ; 0971
		         52	       60  3C 00258 	    MOVZWL  (R0), R2						      ;
		         50	       52  C0 0025B 	    ADDL2   R2, R0						      ;
				       50  D6 0025E 	    INCL    INPUT_ADDR						      ;
				       50  DD 00260 	    PUSHL   INPUT_ADDR						      ; 0972
				       51  DD 00262 	    PUSHL   INPUT_LENGTH					      ;
		         7E	  0C   AC  7D 00264 	    MOVQ    TYPE_DESCR, -(SP)					      ;
		         7E	  04   AC  7D 00268 	    MOVQ    OUTPUT, -(SP)					      ;
		  FE88   CF	       06  FB 0026C 	    CALLS   #6, PARSE_TRANS_FNM					      ;
					   04 00271 	    RET     							      ; 0923

; Routine Size:  44 bytes


;	0974	
;	0975	END
;	0976	ELUDOM






;				       PSECT SUMMARY
;
;	Name		 Bytes			       Attributes
;
;  $CODE$         	   626  NOWRT,  RD ,  EXE,NOSHR,  LCL,  REL,  CON,NOPIC,ALIGN(2)




;				LIBRARY STATISTICS
;
;					     -------- Symbols --------    Blocks
;	File				     Total    Loaded   Percent      Read
;
;  DBA4:[SYSLIB]LIB.L32;1		      5582        16         0       229





; Size:		607 code + 19 data bytes
; Run Time:	00:16.9
; Elapsed Time:	00:47.9
; Memory Used:	278 pages
; Compilation Complete
